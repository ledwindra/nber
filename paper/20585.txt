NBER WORKING PAPER SERIES

BEYOND RICARDO: ASSIGNMENT MODELS IN INTERNATIONAL TRADE
Arnaud Costinot
Jonathan Vogel
Working Paper 20585
http://www.nber.org/papers/w20585
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
October 2014

We thank Pol Antràs, Ariel Burstein, Jonathan Dingel, Dave Donaldson, Samuel Kortum, Andrés
Rodríguez-Clare, and Bernard Salanié for helpful comments as well as Rodrigo Adao for excellent
research assistance. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2014 by Arnaud Costinot and Jonathan Vogel. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
© notice, is given to the source.

Beyond Ricardo: Assignment Models in International Trade
Arnaud Costinot and Jonathan Vogel
NBER Working Paper No. 20585
October 2014, Revised March 2015
JEL No. F1
ABSTRACT
International trade has experienced a Ricardian revival. In this article, we offer a user guide to assignment
models, which we will refer to as Ricardo-Roy (R-R) models, that have contributed to this revival.
Arnaud Costinot
Department of Economics, E17-232
MIT
77 Massachusetts Avenue
Cambridge MA 02139
and NBER
costinot@mit.edu
Jonathan Vogel
Department of Economics
Columbia University
420 West 118th Street
New York, NY 10027
and NBER
jvogel@columbia.edu

1

Introduction

International trade has experienced a Ricardian revival. For almost two hundred years,
David Ricardo’s theory of comparative advantage has been perceived as a useful pedagogical tool with little empirical content. The seminal work of Eaton & Kortum (2002)
has shattered this perception and lead to a boom in quantitative work in the field, nicely
surveyed in Eaton & Kortum (2012). As part of this Ricardian revival, trade economists
have also developed assignment models that incorporate multiple factors of production
into Ricardo’s original model. In recent years, these models have been used to study a
broad set of issues ranging from the impact of trade on the distribution of earnings to its
mitigating effect on the consequences of climate change in agricultural markets. The goal
of this article is to offer a user guide to these multi-factor generalizations of the Ricardian
model, which we will refer to as Ricardo-Roy (R-R) models.
By an R-R model, we formally mean a trade model in which production functions are
linear, as in the original Ricardian model, but one in which countries may be endowed
with more than one factor, as in the Roy model. Total output in any given sector and
country, say wine in Portugal, can thus be expressed as
Q(Wine, Portugal) =

Â A( f , Wine, Portugal) L( f , Wine, Portugal),
f

where A( f , Wine, Portugal) denotes the productivity of factor f , if employed in the wine
sector in Portugal, and L( f , Wine, Portugal) denotes the employment of that factor. When
the number of factors in each country is equal to one, the R-R model collapses to the Ricardian model. Depending on the particular application, different factors may correspond
to different types of labor, capital, or land, whereas different sectors may correspond to
different industries, occupations, or tasks. But regardless of what the particular application may be, the key feature of R-R models is that factors’ marginal products, and
hence marginal rates of technical substitution, are constant. As a result, comparative
advantage—i.e., relative differences in productivity—drives the assignment of factors to
sectors around the world.
The first part of our survey uses R-R models to revisit a number of classical questions
in the field. Among other things, we discuss how cross-country differences in technologies and factor endowments affect the pattern of international trade, as in Costinot (2009),
as well as how changes in the economic environment—including opening up to trade—
affect factor allocation and factor prices, as in Costinot & Vogel (2010). Answering these
questions in the context of an R-R model requires new tools and techniques. Because
1

of the linearity of the production function, corner solutions in R-R models are the norm
rather than the exception. Hence, the main issue when solving for competitive equilibria is to characterize the extensive margin, that is the set of sectors to which a given
factor should be assigned. Fortunately, standard mathematical notions and results from
the monotone comparative statics literature, such as log-supermodularity and Milgrom
& Shannon (1994)’s Monotonicity Theorem, are well suited to deal with this and other
related issues. We briefly review these mathematical tools in Section 2.
Compared to previous neoclassical trade models, R-R models offer a useful compromise. They are more general than Ricardian models, which makes them amenable to
study how factor endowments shape international specialization as well as the distributional consequences of trade, yet since marginal rates of technical substitution are constant, they remain significantly more tractable than general neoclassical trade models
with arbitrary numbers of goods and factors. Predictions derived in such general models
tend to be either weak or unintuitive. For example, the “Friends and Enemies” result of
Jones & Scheinkman (1977) states that a rise in the price of some good causes a disproportionately larger increase in the price of some factor; but depending on the number of
goods and factors, it may or may not lead to a disproportionately larger decrease in the
price of some other factor. A common theme in that older literature, reviewed by Ethier
(1984), is that predictions in high-dimensional environments hinge on the answer to one
fairly abstract question: Are there more goods than factors in the world?
In Section 3, we demonstrate that R-R models deliver sharp predictions in economies
with large numbers of goods and factors. First, they offer variations of classical theorems—
e.g., Factor Price Equalization, Rybczynski, and Stolper-Samuelson theorems—whose empirical content is no weaker than their famous counterparts in the two-good-two-factor
Heckscher-Ohlin model. Second, R-R models offer new predictions regarding the impact
of changes in the distribution of prices, factor endowments, or factor demands with no
counterparts in the two-good-two-factor Heckscher-Ohlin model. These theoretical results are useful because they open the door for general equilibrium analyses of recent
phenomena that have been documented in the labor and public finance literatures, but
would otherwise fall outside the scope of standard trade theory. These recent phenomena include changes in inequality at the top of the income distribution as well as wage
and job polarization; see e.g. Piketty & Saez (2003), Autor, Katz & Kearney (2008), and
Goos & Manning (2007), respectively.
Section 4 presents various extensions of R-R models. We first introduce imperfect
competition, as in Sampson (2014). When good markets are monopolistically competitive
à la Melitz (2003), we show how the same tools and techniques can also shed light on the
2

relationship between firm heterogeneity, worker heterogeneity, and international trade.
We also incorporate sequential production, as in Costinot, Vogel & Wang (2013), to study
how vertical specialization shapes inequality and the interdependence of nations. We
conclude by discussing a number of generalizations and variations of the basic linear
production functions at the core of R-R models.
The last two sections focus on quantitative and empirical work. In Section 5, we emphasize parametric applications of R-R models using Generalized Extreme Value (GEV)
distributions of productivity shocks. We draw a distinction between models that feature
unobserved heterogeneity across goods, as in the influential Ricardian model of Eaton &
Kortum (2002), and models that feature unobserved heterogeneity across factors, as in the
more recent work of Lagakos & Waugh (2013), Hsieh et al. (2013), or Burstein, Morales
& Vogel (2014). In both cases, we discuss how to conduct counterfactual and welfare
analysis and highlight the key differences associated with these two distinct approaches.
In Section 6, we turn to non-parametric applications of R-R models to agricultural markets based on detailed micro-level data from the Food and Agriculture Organization’s
(FAO) Global Agro-Ecological Zones (GAEZ) project. These non-parametric applications
include empirical tests of Ricardo’s theory of comparative advantage (Costinot & Donaldson, 2012), the measurement of the gains from economic integration (Costinot & Donaldson, 2014), and a quantitative analysis of the consequences of climate change (Costinot,
Donaldson & Smith, 2014).
R-R models are related to an older literature on linear programming in economics, see
Dorfman, Samuelson & Solow (1958). Since production functions are linear in R-R models, solving for efficient allocations in such models amount to solving linear programming
problems, an observation made by Whitin (1953) in the context of the Ricardian model.
Ruffin (1988) was the first to point out that multiple-factor generalizations of the Ricardian model may provide a useful alternative to Heckscher-Ohlin models with arbitrary
neoclassical production functions. He offers a number of examples with two countries
and two or three factors in which simpler theorems about trade, welfare, and factor payments can be derived. A similar idea can be found in Ohnsorge & Trefler (2007) who use
the log-normal specification of the Roy model to derive variations of the Rybczynski and
Heckscher-Ohlin theorems in economies with heterogeneous workers.
Though labor markets are not the only possible application of R-R models, it is an
important one. Assignment models, in general, and the Roy model, in particular, have
been fruitfully applied by labor economists to study the effect of self-selection on the distribution of earnings as well as the assignment of workers to tasks; see e.g. Roy (1951),
Heckman & Sedlacek (1985), Borjas (1987), Heckman & Honore (1990), Teulings (1995),
3

Teulings (2005), and Acemoglu & Autor (2011). Sattinger (1993) provides an early survey
of that literature that clarifies the relationship between the Roy model and other assignment models. Some of these alternative assignment models, such as Becker (1973), Lucas
(1978), and Garicano (2000), have also been fruitfully applied in an open economy context to study the effects of international trade and offshoring on heterogeneous workers
or entrepreneurs; see e.g. Grossman & Maggi (2000), Kremer & Maskin (2006), Antras,
Garicano & Rossi-Hansberg (2006), Nocke & Yeaple (2008), Monte (2011), and Grossman,
Helpman & Kircher (2013). Like R-R models, these alternative assignment models can be
thought of as very simple neoclassical models—in the sense that very strong assumptions
on the complementarity between factors of production are imposed—which makes them
well-suited to study economies with a large number of factors of production. The surveys
of Antras & Rossi-Hansberg (2009) and Garicano & Rossi-Hansberg (2014) in this journal
as well as Grossman (2013) offer nice overviews of recent work in this area.

2

The Mathematics of Comparative Advantage

The premise of David Ricardo’s theory of comparative advantage is that some individuals or countries are relatively more productive in some activities than others. In his famous
example, England is relatively better than Portugal at producing cloth than wine. Assuming that labor is the only factor of production in each country and that technology is
subject to constant returns to scale, the previous statement can be expressed as
A(Cloth, England)/A(Wine, England)

A(Cloth, Portugal)/A(Wine, Portugal),

(1)

where A(·, ·) denotes labor productivity in a given sector and country. According to inequality (1), England has a comparative advantage in cloth and, if inequality (1) did not
hold, it would have a comparative advantage in wine.
Now let us move beyond David Ricardo’s example and consider a world economy
with any number of goods and countries. How would one generalize inequality (1) to
formalize the notion that some countries may have a comparative comparative advantage
in some sectors? A fruitful way to proceed is to assume that each country and sector can
be described by a scalar, call them g and s, respectively. For instance, g and s may reflect
the quality of a country’s financial institutions and the dependence of a sector on external
financing, as in Matsuyama (2005); the level of rigidities in a country’s labor market and
the volatility of sectoral productivity or demand shocks, as in Melitz & Cunat (2012); or
more generally, the level of development of a country and the technological intensity of
4

a sector, as in Krugman (1986). In such environments, statements about the comparative
advantage of high-g countries in high-s sectors can still be expressed as
A(s0 , g0 )/A(s, g0 )

A(s0 , g)/A(s, g), for all s0

s and g0

g.

(2)

Mathematically, inequality (2) implies that A is log-supermodular in (s, g). This particular form of complementarity captures the idea that increasing one variable is relatively
more important when the other variables are high and is intimately related to the notion
of comparative advantage introduced by David Ricardo.
The previous idea easily extends to situations in which s and g are multi-dimensional.
For any x, x 0 2 R n , let max ( x, x 0 ) be the vector of R n whose ith component is max xi ,xi0 ,
and min ( x, x 0 ) be the vector whose ith component is min xi ,xi0 . Given the previous
notation, a function g: R n ! R + is log-supermodular if for all x, x 0 2 R n ,
g max x, x 0

· g min x, x 0

g ( x ) · g ( x 0 ).

Inequality (2) above corresponds to the special case in which x ⌘ (s0 , g) and x 0 ⌘ (s, g0 ).
If g is strictly positive, then g is log-supermodular if and only if ln g is supermodular.
Accordingly, g is log-supermodular if and only if for all i and j, g is log-supermodular
in xi , x j when regarded as a function of the arguments xi , x j only. If g also is twice
∂2 ln g

0. If the above inequality
differentiable, then the latter condition is equivalent to ∂x ∂x
i j
holds with a strict inequality, we say that g is strictly log-supermodular and if the above
inequality is reversed, we say that g is log-submodular.
Most of our theoretical results build on three properties of log-supermodular functions:
Property 1. If g, h : R n ! R + are log-supermodular, then gh is log-supermodular.
´
Property 2. If g : R n ! R + is log-supermodular, then G ( x i ) ⌘ g ( xi , x i ) dxi is logsupermodular, where x i denotes the vector x with the ith component removed.
Property 3. If g : R n ! R + is log-supermodular, then xi⇤ ( x i ) ⌘ arg maxxi 2R g ( xi , x i ) is
increasing in x i with respect to the component-wise order.
Properties 1 and 2 state that log-supermodularity is preserved by multiplication and
integration. Property 1 derives from the definition of log-supermodularity. A general
proof of Property 2 can be found in Karlin & Rinott (1980). Since log-supermodularity is
a strong form of complementarity—stronger than quasi-supermodularity and the single
crossing property—Property 3 derives from Milgrom & Shannon’s (1994) Monotonicity
Theorem. Note that in Property 3, xi⇤ ( x i ) may not be a singleton. If so, the monotonicity
5

of xi⇤ ( x i ) is expressed in terms of the strong set order. In this case, both the supremum
and the infimum of the set xi⇤ ( x i ) are increasing in x i .
As we demonstrate next, log-supermodularity offers a powerful way to parametrize
cross-country differences in technology, preferences, and endowments in order to study
their implications for the global allocation of factors and the distribution of earnings.

3

The R-R Model

In this section we introduce our baseline version of the R-R model and derive crosssectional and comparative static predictions in this environment.

3.1

Assumptions

Consider a world economy with many countries indexed by g 2 G ⇢ R3 . The vector
of country characteristics, g, comprises a technology shifter, g A , a taste shifter, gD , and
a factor endowment shifter, gL . These three variables capture all potential sources of international specialization. Each country is populated by a representative agent endowed
with multiple factors indexed by w 2 W ⇢ R. The representative agent has homothetic preferences over multiple goods or sectors indexed by s 2 S ⇢ R. All markets are
perfectly competitive and all goods are freely traded across countries.1 p(s ) denotes the
world price of good s. Factors are immobile across countries and perfectly mobile across
0 denotes the inelastic supply of factor w in country g and w(w, g)
sectors. L(w, g L )
denotes the price of factor w in country g.
The defining feature of R-R models is that production functions are linear. Output of
good s in country g is given by
Q(s, g) =

´

W

A(w, s, g A ) L(w, s, g)dw,

(3)

0 denotes the exogenous productivity of factor w in country g if
where A(w, s, g A )
employed in sector s and L(w, s, g) denotes the endogenous quantity of factor w used to
produce good s in country g.2
1 Free trade in goods will play the same role in an R-R model as in a standard neoclassical trade model.
It will be crucial for R-R versions of the Factor Price Equalization and the Heckscher-Ohlin Theorems,
which rely on good prices being equalized around the world. It will play no role for predictions like the
Stolper-Samuelson Theorem, which hold for arbitrary vectors of good prices. Like in the Ricardian model,
trade costs can be easily incorporated into R-R models when productivity shocks are drawn from a GEV
distribution, as in Eaton & Kortum (2002). We discuss such parametric applications in Section 5.
´
2 There may be a continuum or a discrete number of factors in W. Whenever the integral sign “
W”

6

Good 2

Good 2

Good 2

Good 1
(a) N = 1.

Good 1
(b) N = 2.

Good 1
(c) N = •.

Figure 1: PPF in R-R model with 2 goods and N = 1, 2, • factors.
The Ricardian model corresponds to the special case in which there is only one factor
of production in each country. In this situation, the production possibility frontier in
any country g reduces to a straight line; see Figure 1a. In an R-R model more generally,
countries may be endowed with multiple factors of production, leading to kinks in the
production possibility frontier; see Figure 1b. As the number of factors goes to infinity,
the production possibility frontier becomes smooth, as in a standard Heckscher-Ohlin or
specific factor model; see Figure 1c.3
This is an important observation. Holding the number of factors fixed, an R-R model
with a linear production function is necessarily more restrictive than a standard neoclassical trade model. But the number of factors needs not be fixed. In particular, an R-R
model with a continuum of factors does not impose more a priori restrictions on the data
than a Heckscher-Ohlin model with two factors. To take an analogy from the literature on
discrete choice models in industrial organization, assuming that a continuum of heterogeneous consumers have constant marginal rates of substitution may not lead to different
implications for aggregate demand than assuming a representative agent with a general
utility function; see e.g. Anderson, de Palma & Thisse (1992). We come back to related
issues in Section 5 when discussing parametric applications of R-R models.

´
appears, one should therefore think of a Lebesgue integral. If there is a finite number of factors, “ W ”
is simply equivalent to “ÂW .” Integrals over country and sector characteristics should be interpreted in a
similar manner.
3 In an Arrow-Debreu economy, which R-R models are special cases of, one can always think of factors
located in different countries as different factors. In the absence of trade costs and cross-country differences
in preferences, the closed economy of an R-R model with N factors is therefore equivalent to the world
economy of a Ricardian model with N countries.

7

3.2

Competitive Equilibrium

In a competitive equilibrium, consumers maximize utility, firms maximize profits, and
markets clear.
Consumers. Let D ( p, I (g)|s, gD ) denote the Marshallian demand for good s in country
g as a function of the schedule of world prices, p ⌘ { p(s )}, and the income of country
´
g’s representative agent, I (g) ⌘ W w (w, g) L(w, gL )dw. By definition of the Marshallian
demand, utility maximization requires the consumption of good s in country g to satisfy
D (s, g) = D ( p, I (g)|s, gD ).

(4)

Firms. For future reference, it is useful to start by studying the cost minimization problem of a representative firm, which is a necessary condition for profit maximization. By
equation (3), the unit-cost function of a firm producing good s in country g is given by
c(s, g) ⌘

min

´

l (w,s,g) 0

W w ( w, g ) l ( w, s, g ) dw |

´

W

A(w, s, g A )l (w, s, g)dw

1 .

The linearity of the production function immediately implies
c(s, g) = min {w(w, g)/A(w, s, g A )} .
w 2W

(5)

In turn, the set of factors, W(s, g) ⌘ {w 2 W : L(w, s, g) > 0}, demanded by firms producing good s in country g satisfies
W(s, g) ⇢ arg min {w(w, g)/A(w, s, g A )} .
w 2W

(6)

Having characterized the unit-cost function of a representative firm, its profit function can
be expressed as p (s, g) ⌘ maxq 0 { p(s)q c(s, g)q}. Profit maximization then requires
p(s )  c(s, g), with equality if W(s, g) 6= ∆.

(7)

Market clearing. Factor and good market clearing finally require
´

S

L(w, s, g)ds = L(w, gL ), for all w, g,
´
´
G D ( s, g ) dg =
G Q ( s, g ) dg, for all s.

(8)
(9)

To summarize, a competitive equilibrium corresponds to consumption, D : S ⇥ G ! R + ,
output, Q : S ⇥ G ! R + , factor allocation, L : W ⇥ S ⇥ G ! R + , good prices, p : S ! R + ,
8

and factor prices, w : W ⇥ G ! R + , such that equations (3)-(9) hold.

3.3

Cross-Sectional Predictions

In this section, we follow Costinot (2009) and focus on the cross-sectional predictions of
an R-R model. Formally, we take good prices, p(s), as given and explore how factor
allocation, factor prices, and aggregate output vary across countries and industries in
a competitive equilibrium. Accordingly, demand considerations and the good market
clearing conditions—equations (4) and (8)—play no role here.
3.3.1

Factor allocation

A central question in assignment models is: Who works where? In the context of an R-R
model, one may be interested in characterizing the set of workers employed in particular sectors or, conversely, the set of goods produced by particular countries. To make
progress on these issues, a common practice in the literature is to impose restrictions on
technology that generate Positive Assortative Matching (PAM).
Assumption 1. A(w, s, g A ) is strictly log-supermodular in (w, s ) and (s, g A ).
According to Assumption 1, high-w factors are relatively more productive in high-s sectors and high-g countries are relatively more productive in high-s sectors. A simple
example of a log-supermodular function is A(w, s, g A ) ⌘ exp(ws) or exp(sg A ), as in
Krugman (1986), Teulings (1995), and Ohnsorge & Trefler (2007).4
By Property 3, Assumption 1 implies that arg minw 2W {w(w, g)/A(w, s, g A )} is increasing in s in any country g. Since the log-supermodularity of A in (w, s ) is strict, one
can further show that for any pair of sectors, s 6= s0 , there can be at most one factor w0
such that w0 2 arg minw 2W {w(w, g)/A(w, s, g A )} \ arg minw 2W {w(w, g)/A(w, s0 , g A )}.
Combining the two previous observations, we obtain our first result.
PAM (I). Suppose that Assumption 1 holds. Then for any country g, W(s, g) is increasing in s.
This is intuitive. In a competitive equilibrium, high-w factors should be employed in
the high-s sectors in which they have a comparative advantage.
4 The

strict log-supermodularity of A(w, s, g A ) in (w, s ) formally rules out the possibility that two distinct factors are perfect substitutes across all sectors. At a theoretical level, this restriction is purely semantic.
If two workers only differ in terms of their absolute advantage, one can always refer to them as one factor
and let the efficiency units that they are endowed with vary. This is the convention we adopt in this article.
Since we assume the existence of a representative agent, the distribution of these efficiency units is irrelevant for any of our theoretical results and is, therefore, omitted. At an empirical level, though, one should
keep in mind that the distribution of earnings depends both on the schedule of prices per efficiency units,
which we refer to as the factor price, w (w, g), and the distribution of these efficiency units.

9

We can follow a similar strategy to analyze patterns of international specialization. Let
S(w, g) ⌘ {s : L(w, s, g) > 0} denote the set of sectors in which factor w is employed in

country g. Conditions (5) and (7) imply that the value of the marginal product of a factor
w in any sector s should be weakly less than its price,
p(s) A(w, s, g A )  w(w, g), for all s,

(10)

with equality if factor w is employed in that sector, w 2 W(s, g). Since s 2 S(w, g) if and
only if w 2 W(s, g), condition (10) further implies that
S(w, g) ⇢ arg max { p(s) A(w, s, g A )} .
s

(11)

This condition states that factors from any country should be employed in the sector that
maximizes the value of their marginal product, an expression of the efficiency of perfectly
competitive markets.
Starting from condition (11) and using the exact same logic as above, we obtain the
following prediction.
PAM (II). Suppose that Assumption 1 holds. Then for any factor w, S(w, g) is increasing in g A .
In a competitive equilibrium, there must also be a “ladder” of countries with high-g
countries in high-s sectors. This is the prediction at the heart of many Ricardian models
such as the technology gap model developed by Krugman (1986) as well as many models
in the institutions and trade literature reviewed by Nunn & Trefler (2014). As discussed
in Costinot (2009), Assumption 1 is critical for such patterns in the sense that it cannot be
dispensed with for PAM to arise in all economic environments satisfying the assumptions
of Section 3.1.5
An important special case in the literature is the case in which S(w, g) is a singleton.
This corresponds to a situation in which each factor is only assigned to one sector. A
sufficient condition for S(w, g) to be a singleton is that arg maxs { p(s ) A(w, s, g A )} is
itself a singleton. Graphically, this situation arises when production occurs at a vertex
of the production possibility frontier in Figure 1. As the numbers of factors and hence
vertices increase, this restriction becomes milder and milder. If there is a continuum of
factors, then S(w, g) must be a singleton for almost all w.6
5 The symmetry between PAM (I) and PAM (II) should not be surprising. As already discussed earlier,
factors in different countries can always be defined as different factors in an Arrow-Debreu economy. Under
this alternative interpretation, PAM within and between countries are two sides of the same coin.
6 This is true regardless of whether there is a finite number of goods or a continuum of goods with finite
measure. To see this, note for any w 6= w 0 , the overlap between S (w, g) and S (w 0 , g) must be measure

10

3.3.2

Factor prices

Conditions (5) and (7) also have strong implications for the distribution of factor prices
within and between countries. Starting from condition (10) and noting that there must
exist a s such that w 2 W(s, g) by factor market clearing, we obtain
w(w, g) = max { p(s) A(w, s, g A )} .
s

(12)

Now consider two countries with the same technology, g A = g0A , but potentially different
endowments and preferences. Equation (12) immediately implies w(w, g) = w(w, g0 ) ⌘
w(w ). In other words, we always have factor price equalization (FPE), as originally noted
by Ruffin (1988) and summarized below.
R-R FPE Theorem. If there are no technological differences between countries, then factor prices
are equalized under free trade, w(w, g) = w(w ) for all g.
For all subsequent results, we restrict ourselves to an economy with a continuum of
factors. As discussed above, this implies that S(w, g) is a singleton. Thus, the allocation
of factors to sectors can be summarized by a matching function, M, such that S(w, g) =
{ M(w, g)}. In Section 3.4, we will add the assumption of a continuum of goods.
Under the assumption of a continuum of factors, we can analyze the distribution of
factor prices within each country by differentiating equation (12) with respect w. By the
Envelope Theorem, we must have
∂ ln A(w, M (w, g), g A )
d ln w(w, g)
.
=
dw
∂w

(13)

Equation (13) is one of the key equilibrium conditions used in our comparative static
analysis. Intuitively, if two distinct factors, w1 and w2 , were to be employed in the
same sector s, then their relative prices should exactly equal their relative productivities,
w(w1 , g)/w(w2 , g) = A(w1 , s, g A )/A(w2 , s, g A ), or in logs,
Dlnw(w1 , g)

Dlnw(w2 , g) = DlnA(w1 , s, g A )

DlnA(w2 , s, g A ).

Equation (13) expands on this observation by using the fact that reallocations of factors
across sectors must have second-order effects on the value of a factor’s marginal product.7
zero under Assumption 1. So if the set of factors for which S (w, g) is not a singleton had strictly positive
measure, the set of goods to which they are assigned would have to have infinite measure.
7 Here, we implicitly assume that w (·, g ) is differentiable. In economies with a continuum of goods, this
property follows from assuming that A(w, s, g) is differentiable. In economies with a discrete number of
goods, w(·, g) would necessarily feature a discrete number of kinks. In such environments, the Envelope

11

Finally, note that whereas equation (12) relies on perfect competition in good markets—
through the first-order condition (7)—equation (13) does not. Condition (5) and factor
market clearing alone imply that w(w, g) = maxs {c(s, g) A(w, s, g A )}. Starting from
this expression and invoking the Envelope Theorem, we again obtain equation (13). This
observation will play a central role in extending R-R models to environments with imperfectly competitive good markets.
3.3.3

Aggregate output

We have already established that Assumption 1 imposes PAM. PAM, however, only imposes a restriction on the extensive margin of employment, that is whether a factor should
be employed in a sector in a particular country; it does not impose any restriction on the
intensive margin of employment, and in turn, aggregate output.
To derive cross-sectional predictions about aggregate output, we now impose the following restriction on the distribution of factor endowments.
Assumption 2. L(w, gL ) is log-supermodular.
For any pair of countries, g0L

gL , and factors, w 0

Assumption 2 implies
L(w 0 , g0L )/L(w, g0L )

w, such that L(w, gL ), L(w, g0L ) 6= 0,

L(w 0 , gL )/L(w, g L ).

According to Assumption 2, high-gL countries are relatively abundant in high-w factors.
Formally, it is equivalent to the assumption that the densities of countries’ factor endowments can be ranked in terms of monotone likelihood ratio dominance. Milgrom (1981)
offers many examples of density function that satisfy this assumption including the normal (with mean gL ) and the uniform (on [0, gL ]). This is the natural generalization of the
notion of skill abundance in a two-factor model. Note that Assumption 2 also allows us
to consider situations in which different sets of factor are available in countries g and g0 .
In such situations, the highest-w factor must be in country g and the lowest-w factor in
country g0 .
Since S(w, g) is a singleton, employment of a factor w in a particular sector s must
now be equal to the total endowment of that factor, L(w, gL ), whenever w 2 W(s, g).
Thus, output of good s can be expressed as
Q(s, g) =

´

W(s,g)

A(w, s, g A ) L(w, g L )dw.

Theorem of Milgrom & Segal (2002) provides a strict generalization of equation (13).

12

If there are no technological differences between countries, FPE further implies that the
allocation of factors to sectors must be the same in all countries, W(s, g) ⌘ W(s), so that

the previous expression simplifies into
Q(s, g) =

´

W(s)

A(w, s, g A ) L(w, g L )dw.

(14)

Using equation (14) together with PAM and Properties 1 and 2, which imply that logsupermodularity is preserved by multiplication and integration, Costinot (2009) establishes the following Rybczynski-type result.
R-R Rybczynski Theorem. Suppose that Assumptions 1 and 2 hold. Then Q(s, g) is logsupermodular in (s, gL ).
For any pair of goods, s  s0 , and any pair of countries with identical technology,
g A = g0A , but different endowments, gL  g0L , the previous property implies that
Q(s0 , g0 )
Q(s, g0 )

Q(s0 , g)
.
Q(s, g)

In other words, the country that is relatively more abundant in the high-w factors, i.e.
country g0 , produces relatively more in the sector that is “intensive” in those factors under PAM, i.e. sector s0 . This is akin to the predictions of the Rybczynski Theorem in a
two-by-two Heckscher-Ohlin model. Here, however, the previous prediction holds for
an arbitrarily large number of goods and factors. If one further assumes that countries
have identical preferences, gD = g0D , the Rybczynski Theorem above implies that high-gL
countries are net exporters of high-s goods, whereas low-g L countries are net exporters of
low-sL goods, in line with the predictions of the two-by-two Heckscher-Ohlin Theorem,
a point emphasized by Ohnsorge & Trefler (2007).
As shown in Costinot (2009), one can use a similar logic to establish that aggregate employment and aggregate revenue in a country and sector must also be log-supermodular
functions of (s, g L ). Using U.S. data on cities’ skill distributions, sectors’ skill intensities, and cities’ sectoral employment, Davis & Dingel (2013) provide empirical support
for such predictions.

3.4

Comparative Static Predictions

The goal of this subsection is to go from cross-sectional predictions to comparative static
predictions about the effects of various shocks on factor allocation and factor prices. We
start by revisiting the Stolper-Samuelson Theorem, which emphasizes shocks to good
13

prices. We then turn to the consequences of factor endowment and taste shocks.8 Following Costinot & Vogel (2010), we do so in the case of a continuum of both goods and
factors: S = [s, s̄] and W = [w, w̄ ]. Under mild regularity conditions on productivity,
endowments, and demand functions, this guarantees that the schedule of factor prices
and the matching function are differentiable, which we assume throughout. Comparative static results in the discrete case can be found in Costinot & Vogel (2009).
3.4.1

Price shocks

Consider a small open economy whose characteristics g are held fixed, whereas country characteristics in the rest of the world, which we summarize by f, are subject to a
shock. Using this parametrization, a foreign shock to technology, tastes, or factor endowments simply corresponds to a change from f to f0 . In a neoclassical environment,
foreign shocks only affect the small open economy g through their effects on world prices.
To make that relationship explicit here, we now let p(s, f) denote the world price of good
s as a function of foreign characteristics f.
In line with the analysis with the analysis of Section 3.3, we restrict ourselves to foreign
shocks that satisfy the following restriction.
Assumption 3. p(s, f) is log-supermodular in (s, f).
s, a shock from f to f0
f corresponds to an increase in
For any pair of goods, s0
the relative price of good s0 , which is the good intensive in high-w factors under PAM. In
the context of the two-by-two Heckscher-Ohlin model, the Stolper-Samuelson Theorem
predicts that the relative price of the skill-intensive good should lead to an increase in the
relative price of skilled workers. We now demonstrate that in an R-R model, a similar
prediction extends to economies with an arbitrary large number of goods and factors.
For the purposes of this subsection, and this subsection only, we let w(·, g, f) and
M (·, g, f) denote the schedule of factor prices and the matching function in country g as
a function of the foreign shock, f. Using this notation, we can rewrite equation (12) as
w(w, g, f) = max { A(w, s, g A ) p(s, f)} .
s

Starting from the previous equation and invoking the Envelope Theorem, now with re-

8 If

one reinterprets goods as tasks used to produce a unique final good, as in Costinot & Vogel (2010),
then taste shocks can also be interpreted as technological shocks to that final good production function.

14

spect to a change in f, we obtain
d ln w(w, g, f)
∂ ln p( M(w, g, f), f)
.
=
df
∂f

(15)

Since PAM implies that M is increasing in w, Assumption 3 further implies that
d
dw

✓

∂ ln p( M (w, g, f), f)
∂f

◆

=

dM (w, g, f) ∂2 ln p( M(w, g, f), f)
dw
∂s∂f

0.

Combining the previous inequality with equation (15), we obtain the following StolperSamuelson-type result.
R-R Stolper-Samuelson Theorem. Suppose that Assumptions 1 and 3 hold. Then w(w, g, f)
is log-supermodular in (w, f).
Economically speaking, the previous result states that increase in the relative price of
high-s goods (caused by a shock from f to f0 ) must be accompanied by an increase in
the relative price of high-w factors (that tend to be employed in the production of these
goods). The intuition is again simple. Take two factors, w 0 w, employed in two sectors,
s0 s, before the shock. If both factors were to remain employed in the same sector after
the shock, then the change in their relative prices would just be equal to the change in the
relative prices of the goods they produce,


w(w 0 , g, f0 )
ln
w(w, g, f0 )




w(w 0 , g, f)
p(s0 , f0 )
ln
= ln
w(w, g, f)
p(s, f0 )

ln



p(s0 , f)
.
p(s, f)

Hence, an increase in the relative price of good s0 would mechanically increase the relative price of factor w 0 . Like in Section 3.3.2, the previous Stolper-Samuelson-type result
expands on this observation by using the fact that factor reallocations across sectors must
have second-order effects on the value of a factor’s marginal product.
Under the assumption that the small open economy is fully diversified, both before
and after the shock, the previous result further implies the existence of a factor w ⇤ 2
(w, w̄ ) such that real factor returns decrease for all factors below w ⇤ and increase for
all factors above w ⇤ . In other words, a foreign shock must create winners and losers.
Intuitively, factor w must lose because it keeps producing good s, whose price decreases
relative to all other prices. Conversely, factor w̄ must win because it keeps producing
good s̄, whose price increases relative to all other prices.

15

3.4.2

Endowment and taste shocks

We proceed in two steps. We first study the consequences of endowment and taste shocks
in a closed economy. Using the fact that the free trade equilibrium reproduces the integrated equilibrium, we then discuss how these comparative static results under autarky
can be used to study the effects of opening up to trade.
Consider a closed economy with characteristic g. A competitive equilibrium under
autarky corresponds to ( D a , Q a , L a , p a , w a ) such that equations (3)-(8) hold and the good
market clearing condition (9) is given by
D a (s, g) = Q a (s, g), for all s and g.

(16)

We start by expressing the competitive equilibrium of a closed economy in a compact
form as a system of two differential equations in the schedule of factor prices, w a , and the
matching function, M a .
Given PAM, the factor market clearing condition (8) can be rearranged as
ˆ

M a (w,g)
s

a

⇣

a

Q (s, g) /A ( M )

1

⌘

(s, g) , s, g A ds =

ˆ

w
w

L(v, g L )dv, for all w,

(17)

From utility maximization and the good market clearing condition—equations (4) and
(16)—we also know that
Q a (s, g) = D a ( p a , I a (g)|s, gD )
Substituting into equation (17) and differentiating with respect to w, we obtain after rearrangements,
A (w, M a (w, g) , g A ) L(w, g L )
dM a (w, g)
=
.
(18)
dw
D ( p a , I a (g)| M a (w, g), gD )
In a competitive equilibrium, the slope of the matching function is set such that factor
supply equals factor demand. The higher the supply of a given factor, L(w, g L ), relative
to its demand, D ( p a , I a (g)| M a (w, g), gD ) /A (w, M a (w, g) , g A ), the “faster” it should
get assigned to sectors for markets to clear.
Costinot & Vogel (2010) derive a number of comparative static predictions in the case
in which demand functions are CES:
D ( p, I (g)|s, gD ) =

B(s, gD ) p # (s ) I (g)
,
P1 # ( g D )

16

(19)

´
where B(s, gD ) is a demand-shifter of good s and P(gD ) = ( S B(s, gD ) p1 # (s)ds )1/(1 #)
denotes the CES price index. In the rest of this article, we refer to an economy in which
equation (19) holds as a CES economy. In such an economy, normalizing the CES price
index to one, equation (18) can be rearranged as
A1 # (w, M a (w, g) , g A ) (w a (w, g))# L(w, g L )
dM a (w, g)
´
,
=
dw
B( M a (w, g) , gD ) W w a (w 0 , g) L(w 0 , gL )dw 0

(20)

where we have used p a ( M a (w, g)) = w a (w, g)/A (w, M a (w, g) , g A ), by conditions (5)
´
and (7), and I a (g) = W w a (w 0 , g) L(w 0 , gL )dw 0 .
Equations (13) and (20) offer a system of two differential equations in ( M a , w a ). The
characterization of a competitive equilibrium is completed by the two boundary conditions, M a (w, g) = s and M a (w̄, g) = s̄, which state that the lowest and highest factors
should be employed in the lowest and highest sectors, an implication of PAM.
Given equations (13) and (20), one can study how shocks to factor supply and factor demand, parametrized as changes in g L and gD , respectively, affect factor allocation,
M a (w, g), and factor prices, w a (w, g). As we did for technology and factor endowments,
we impose the following restriction on how demand shocks, gD , affect the relative consumption of various goods.
Assumption 4. B(s, gD ) is log-submodular in (s, gD ).
Given equation (19), Assumption 4 implies that an increase in gD lowers the relative
g D , such
demand for high-s goods.9 For any pair of goods, s s0 , and countries, g0D
0
that B(s, gD ), B(s, gD ) 6= 0, we must have
D p, I (g)|s0 , g0D /D p, I (g)|s, g0D  D p, I (g)|s0 , g D /D ( p, I (g)|s, g D ) .
In this environment, Costinot & Vogel (2010) show the two following comparative static
results about factor allocation and factor prices.
Comparative Statics (I): Factor Allocation. Suppose that Assumptions 1, 2, and 4 hold in a
CES economy under autarky. Then M a (w, g) is decreasing in gD and gL .
Comparative Statics (II): Factor Prices. Suppose that Assumptions 1, 2, and 4 hold in a CES
economy under autarky. Then w a (w, g) is log-submodular in (w, gD ) and (w, g L ).
gL . By Assumption 2, this corConsider first an endowment shock from gL to g0L
responds to an increase in the relative supply of high-w factors. In the new equilibrium,
9 Assuming log-submodularity rather than log-supermodularity is purely expositional.

This convention
guarantees that changes in g L and gD have symmetric effects on factor allocation and factor prices.

17

this must be accompanied by an increase in the set of sectors employing higher-w factors,
which is achieved by a downward shift in the matching function. Having established that
the matching function must shift down, one can then use equation (13) to sign the effect
of a change in relative factor supply on relative factor prices:
dM a (w, g) ∂2 ln A(w, M a (w, g), g A )
d2 ln w a (w, g)
=
 0,
dgL dw
dgL
∂s∂w
dM a (w,g)

∂2 ln A(w,M a (w,g),g )

A
 0 and
0 by Assumpwhere the previous inequality uses dg
∂s∂w
L
tion 1. As intuition would suggest, if the relative supply of high-w factors go up, their
relative price must go down.

The intuition regarding the effect of a taste shock is similar. By Assumption 4, an increase in gD corresponds to a decrease in the relative demand for high-s goods. This
change in factor demand must be accompanied by factors moving into lower-s sectors,
which explains why M a (w, g) is decreasing in gD . Conditional on the change in the
matching function, the effects on relative factors prices are the same as in the case of a
shock to factor endowments. If factors move into lower-s sectors in which low-w factors
have a comparative advantage, low-w factors will be relatively better off.
As shown in Costinot & Vogel (2010), the same approach can be used to study richer
endowment and taste shocks, e.g. shocks that disproportionately affect “middle” factors
or sectors. While the economic forces at play are similar to those presented here, such extensions are important since they allow for the analysis of recent labor market phenomena
such as job and wage polarization, as emphasized by Acemoglu & Autor (2011).
To go from the previous closed-economy results to the effect of opening up to trade,
we can use the fact that under factor price equalization, the free trade equilibrium replicates the integrated equilibrium. Hence in the absence of technological differences across
countries, factor allocation and prices in any country g, M (w, g) and w(w, g), must be
equal to those of a fictitious world economy under autarky, M a (w, gw ) and w a (w, gw ),
with
A1 # w, M a (w, gw ) , gw
(w a (w, gw ))# L(w, gw
L)
A
´
,
a
0
w
0
w
w
a
w
B( M (w, g ) , gD ) W w (w , g ) L(w , gL )dw 0
∂ ln A(w, M a (w, gw ), gw
d ln w a (w, gw )
A)
.
=
dw
∂w
dM a (w, gw )
=
dw

(21)
(22)

In the previous system of equations,gw
A corresponds to the technological parameter com-

18

w
mon across countries, whereas gw
L and gD are implicitly defined such that

L(w, gw
L) =

L(w, g L )dgL ,
´
´ W w a (w, gw ) L(w, g L )dw #
w
P
B (s, gD ) = G ´
a
w
w
W w ( w, g ) L ( w, g L ) dw
´

G

1 ( g ) B ( s, g

D ) dgD .

In the two-country case, one can check that if g  g0 , then gw 2 [g, g0 ]. This simple
observation implies that the consequences of opening up to trade in country g are isomorphic to an increase in gD and gL under autarky, with effects on factor allocation and
factor prices as described above. Trade will lead to sector downgrading for all factors, i.e.
a downward shift in the matching function, and to a pervasive decrease in the relative
price of high-w factors. The opposite is true in country g0 . Like in the case of a closed
economy, the previous logic can also be used to study the effects of trade integration between countries that differ in terms of “diversity,” as emphasized in Grossman & Maggi
(2000).
We conclude by pointing out that although we have presented the above comparative static results as closed economy results in an R-R model with a continuum of factors,
they can always be interpreted as open economy results in a Ricardian model with a continuum of countries, as in Matsuyama (1996) and Yanagawa (1996). To do so, one simply
needs to define factors in different countries as different factors. Under this interpretation,
the previous results can be used, for instance, to shed light on the impact of growth in a
subset of countries on patterns of specialization—as captured by the matching function—
and the world income distribution—as captured by the schedule of factor prices.

4

Theoretical Extensions

The baseline R-R model presented above is special along two dimensions: good markets
are perfectly competitive and production functions are linear. In this section, we relax
these assumptions about market structure and technology and show how to apply the
tools and techniques introduced in Section 3 to these alternative environments.

4.1

Monopolistic Competition

We first follow Sampson (2014) and introduce monopolistic competition with firm-level
heterogeneity à la Melitz (2003) into an otherwise standard R-R model.10 We focus on
10 Other

recent papers introducing monopolistic competition into an R-R model include Edwards & Perroni (2014), Gaubert (2014), and Grossman & Helpman (2014).

19

a world economy comprising n + 1 symmetric countries and omit for now the vector of
country characteristics g. Goods markets are monopolistically competitive and preferences are CES over a continuum of symmetric varieties. There is an unbounded pool of
potential entrants that are ex-ante identical. To enter, a firm incurs a sunk cost, f e > 0.
Entry costs and all other fixed costs are proportional to the CES price index, which we
normalize to one. Upon entry, a firm randomly draws a blueprint with characteristic s
from a distribution G. If the firm incurs an additional fixed cost f > 0, it can produce a
differentiated variety for the domestic market using the same linear production function
as in Section 3.1,
´
q(s) = W A(w, s)l (w, s )dw,

where A(w, s ) denotes the productivity of the firm if it were to hire l (w, s ) units of factor
w 2 [w, w̄ ]. We further assume that A(w, s ) is strictly increasing in s so that s is an index
of firm-level productivity. The production function in Melitz (2003) corresponds to the
special case in which there is only one factor of production and A(w, s ) ⌘ s. Finally, in
0 per market and a per-unit iceberg
order to export, a firm must incur a fixed cost f x
trade cost t 1.
Like in Section 3.2, consumers maximize their utility, firms maximize their profits, and
markets clear. The key difference is that firms have market power. Thus profit maximization now requires marginal cost to be equal to marginal revenue rather than price,
w(w )
dr (q, s)
=
,
dq
A(w, s )
tw (w )
dr x (q x , s )
=
,
dq x
A (w, s )

where r (q, s) and r x (q x , s ) denote a firm’s revenue if it sells q > 0 and q x > 0 units in the
domestic and foreign markets, respectively. In contrast, the cost minimization problem
of the firm is unchanged. Given the linearity of the production function, conditions (5)
and (6) must still hold. Under Assumption 1, this immediately implies that we must have
PAM in this alternative environment: high-w factors will be employed in high-s firms.
Since high-s firms will also be larger in terms of sales and more likely to be exporters,
as in Melitz (2003), R-R models with monopolistic competition therefore provide simple
micro-foundations for the well-documented firm-size and exporter wage premia.11
11 Yeaple (2005) provides an early example of a monopolistically competitive model with firm and worker

heterogeneity in which PAM arises under Assumption 1. Alternative micro-foundations for the firm-size
and exporter wage premia based on extensions of Melitz (2003) with imperfectly competitive labor markets
can be found in Davidson, Matusz & Shevchenko (2008), Helpman, Itskhoki & Redding (2010), and Egger
& Kreickemeier (2012), among others.

20

As discussed in Section 3.3, since equation (5) still holds, we must also have w(w ) =
maxs { A(w, s )c(s )}. By the Envelope Theorem, this implies
d ln w(w )
∂ ln A(w, M (w ))
,
=
dw
∂w
exactly as in the baseline R-R model. Combining the goods and factor market clearing
conditions, which are unchanged, one can then use the same strategy as in Section 3.4 to
show that

A (w, M (w )) Lw (w )
dM(w )
=
,
dw
D w ( p, Ew | M(w ))

where Lw (w ) denotes world endowment of factor w; Ew denotes world expenditure,
which includes both spending by consumers and firms; and D w ( p, Ew |s) denotes world
absorption for s varieties. In short, the two key differential equations characterizing factor prices and the matching function remain unchanged under monopolistic competition.
Of course, one should not infer from the previous observation that monopolistically
competitive models do not have new implications. In the present environment, world absorption, D w ( p, Ew |s ), depends both on the level of variable trade costs, t, as well as the
the fixed costs, f e , f , and f x , which determine the entry and exit decisions of firms across
markets. This opens up new and interesting channels through which trade integration—
modeled as a change in t, f x , or n—may affect the distribution of earnings.
Let s denote the productivity cut-off above which firms choose to produce and s x
denote the productivity cut-off above which they choose to export. Under the assumption
that preferences are CES, one can then express world demand for s varieties as
D w ( p, Ew |s ) = ´

#
w
Bw (s, gw
D ) p (s) g(s) E
,
w ( s 0 , gw ) p1 # ( s 0 ) g ( s 0 ) ds 0
B
D
S

w
w
where world demand characteristics, gw
D , and the demand shifter for s varieties, B ( s, g D ),

are such that
gw
D ⌘ ( t, n, s, s x ),
⇣
⌘
1 #
1
I [s,•) (s ) .
)
⌘
+
nt
I
s
Bw (s, gw
(
)
[s x ,•)
D

In the previous expression, I [s,•) (·) and I [s x ,•) (·) are indicator functions that capture the
selection of different firms into domestic production and export, respectively. Although
the cut-offs s and s x are themselves endogenous objects that depend on fixed and variable
trade costs through standard zero-profit conditions, it will be convenient to study how
21

trade integration shapes inequality in two steps: (i ) treat the demand shifters, Bw , as
functions of s and gw
D ⌘ ( t, n, s, s x ); and (ii ) analyze how s and s x vary with t, f , and
fx.
Bw

To apply the results of Section 3.4.2 in this environment, one only needs to check that
is log-submodular in (s, t ) and log-supermodular in (s, n), (s, s ), and (s, s x ), which

is a matter of simple algebra. From our previous analysis, we then obtain that ceteris
paribus, a decrease in trade costs, t, or an increase in the number of countries, n, and the
productivity cut-offs, s and s x , should lead to an upward shift in the matching function
and a pervasive increase in the relative price of high-w factors around the world.
This is an important difference between the models in Sections 3 and 4.1. Whereas
trade integration in Section 3.4 leads to lead to opposite effects at home and abroad—
because endowments and demand in the integrated economy lie in-between the endowments and demand in the two countries—selection effects à la Melitz (2003) imply that
trade integration—modeled as a reduction in trade costs or an increase in the number of
countries—have the same effects on the distribution of earnings around the world. Intuitively, if trade integration increases the relative demand for high-s firms everywhere,
it must also increase the relative price of the high-w factors that are employed in these
firms.
As alluded to above, the total effect of a change in variable trade costs or the number
of countries is more subtle. In addition to their direct effects, they also indirectly affect
entry and exit decisions, which is reflected in changes in s and s x . This last effect tends to
work in the opposite direction: when variable trade costs fall, this lowers the export cutoff, s x , which then increases the relative demand of firms below that cut-off. Sampson
(2014) analyzes these countervailing forces and provides further extensions, including
endogenous technology adoption as in Yeaple (2005).

4.2

Vertical Specialization

Up to this point, we have focused on the implications of R-R models for trade in goods.
Although these goods may be intermediate goods or tasks, the previous analysis abstracts
from global supply chains in which countries specialize in different stages of a good’s production sequence, a phenomenon which Hummels, Ishii & Yi (2001) refer to as vertical
specialization. Building on earlier work by Dixit & Grossman (1982) and Sanyal (1983),
Costinot, Vogel & Wang (2012) and Costinot, Vogel & Wang (2013) develop variants of
R-R models with sequential production to study how vertical specialization shapes inequality and the interdependence of nations. We now briefly describe their framework
22

and summarize their results.12
There is a unique final good whose production requires a continuum of stages s2
[s, s̄]. At the end of each stage s, firms can use factors of production and the input from
that stage in order to perform the next stage, s + ds. If firms from country g combine
Q(w, s, g) units of intermediate good s with L(w, s, g) units of factor w for all w 2 W,
then total output of intermediate good s + ds in country g is equal to
Q(s + ds, g) =

ˆ

W

A(w, g A )min{ Q(w, s, g), L(w, s, g)/ds }dw,

(23)

where total factor productivity, A(w, g A ), is such that
A(w, g A ) ⌘ exp( l(w, g A )/ds ).

(24)

l(w, g A ) can be interpreted as the constant Poisson rate at which “mistakes” occur along
a given supply chain, as in Sobel (1992) and Kremer (1993). At any given stage, the likelihood of such mistakes may depend on the quality of workers and machines, indexed by
w, as well as the quality of infrastructure and institutions in a country, indexed by g A , but
is assumed to be constant across stages.
When l(w, g A ) is strictly decreasing in w and g A , so that high-w factors and high-g A
countries have an absolute advantage in all stages, there must be vertical specialization
in any free trade equilibrium with more productive factors or countries specializing in
later stages of production. Mathematically, PAM arises for the same reason as in earlier
sections. By equations (23) and (24), the cumulative amount of factor w necessary to
produce all stages from s to s in country g is equal to exp((s s)l(w, g)), which is logsubmodular in both (w, s ) and (s, g). Because of the sequential nature of production,
absolute productivity differences are a source of comparative advantage.13
Once PAM has been established, competitive equilibria can still be described as a system of differential equations that jointly characterize the schedule of factor prices and the
matching function. In a Ricardian version of this model—with only one factor of production per country—Costinot, Vogel & Wang (2013) use this system to contrast the effects
of technological change in countries located at the bottom and the top of a supply chain.
In a two-country version of this model with a continuum of factors, Costinot, Vogel &
12 Yi (2003), Yi (2010), and Johnson & Moxnes (2013) offer examples of quantitative work using Ricardian
models with sequential production. The implications of contractual imperfections in such environments
are explored in Antras & Chor (2013).
13 Costinot, Vogel & Wang (2013) also study cases in which the rate of mistakes, and hence factor productivity, vary across stages. If the stage-varying Poisson rate, l(w, s, g A ), is submodular in (w, s ) and (s, g A ),
then factor productivity is log-supermodular in these variables and PAM still applies.

23

Wang (2012) use a similar approach to analyze the consequences of trade integration between countries with different factor endowments. While the effects of trade integration
on the matching function are the same as in Section 3.4, sequential production leads to
new and richer predictions about the effects of trade on inequality. Namely, standard
Stolper-Samuelson forces operate at the bottom of the chain, but the opposite is true at
the top.

4.3

Other Extensions

In the baseline R-R model as well as the previous extensions, factors of production are
characterized by their exogenous productivity in various economic activities. In practice, productivity may be neither exogenous nor the only source of heterogeneity among
factors. The marginal product of labor may vary with the stock of capital; workers may
have different preferences over working conditions; and workers may vary in terms of
how costly it is for them to acquire skills. Fortunately, such considerations can all be
incorporated into an R-R model.
As shown in our online Appendix, the tools and techniques of Section 3 can be used
to derive similar cross-sectional and comparative static predictions in economies with:
i. Factor complementarity, if output of good s in country g is given by
Q (s, g) = F [K agg (s, g), L agg (s, g) |s, g] ,
where F (·, ·|s, g) is a constant returns to scale production function; K agg (s, g) and
L agg (s, g) denote the aggregate amounts of capital and labor, respectively, with
L

agg

(s, g) =

ˆ

W

A (w, s, g A ) L (w, s, g) dw.

ii. Heterogeneous preferences, if the utility of a worker with characteristic w receiving
a wage wc (s, g) in sector s and country g is given by
V (w, s, g) ⌘ wc (s, g)U (w, s, gU ) ,
where gU is a new exogenous preference shifter and U (w, s, gU ) is strictly logsupermodular in (w, s ) and (s, gU ).14
14 When

thinking about heterogeneity in preferences, a natural interpretation of s is location rather than
industry. In practice, different individuals may choose to live in different cities because they value their
various amenities differently. With this interpretation in mind, R-R models also provide a useful framework

24

iii. Endogenous skills, if firms from country g need to pay S (w, s, gS ) > 0 in order to
train a worker of type w in sector s—with learning costs proportional to the consumer price index—and S(w, s, gS ) is strictly submodular in (w, s ) and (s, gS ).15

5

Parametric Applications

The two previous sections have derived a number of sharp cross-sectional and comparative static predictions, especially in economies with a continuum of goods and factors.
In the data, however, one always observes a discrete number of factors and sectors. Furthermore, PAM never perfectly holds for these observed groups of factors and sectors; all
factors are likely to be employed in all sectors, albeit with different intensity.
One way to bridge the gap between theory and data is to maintain the assumption that
there is a continuum of factors or goods that are perfectly observed by consumers and
firms, but add the assumption that the econometrician only observes coarser measures of
these characteristics. Under these assumptions, there may therefore be unobserved heterogeneity, from the point of view of the econometrician, within a given group of factors
or goods.
A number of papers in the trade literature have followed the previous approach. The
empirical content of such papers then crucially depends on the distributional assumptions imposed on unobserved heterogeneity across goods or factors. By far the most common assumption in the existing literature is to assume Generalized Extreme Value (GEV)
distributions of productivity, as in the influential work of Eaton & Kortum (2002).16 Sections 5.1 and 5.2 discuss the implications of GEV distributions of productivity shocks
across goods and factors, respectively.

5.1

Unobserved Productivity Shocks across Goods

Consider first a R-R model with a discrete number of factors and countries and a continuum of goods. For notational convenience, true characteristics, which are perfectly obto analyze the relationship between migration and trade, both within and between countries.
15 This is the approach followed by Blanchard & Willmann (2013).
16 This distributional assumption is standard in the analysis of discrete choice models in industrial organization, see e.g. McFadden (1974) and Berry (1994), as well as in the matching literature, see e.g. Choo
& Siow (2006). Following the seminal work of Roy (1951), numerous papers in the labor literature have
focused instead on environments in which the distribution of worker skills is log-normally distributed, see
e.g. Heckman & Sedlacek (1985). In the international trade literature, Ohnsorge & Trefler (2007) also impose
log-normality. Liu & Trefler (2011) propose an alternative empirical approach based on linearized versions
of the Roy model’s estimating equations.

25

served by all market participants, are now indexed by (w ⇤ , s⇤ , g⇤ ), whereas characteristics observed by the econometrician are indexed by (w, s, g). We maintain this convention
throughout this section. Here, factor and country characteristics are perfectly observed by
the econometrician, w ⇤ = w and g⇤ = g, but good characteristics are not, s⇤ 6= s. Specifically, for each observed value of s, we assume that there exists a continuum of goods
s⇤ 2 [0, 1] with the same observable characteristic and refer to this measure one of goods
as an industry. In practice, the pair of observables (w, g) may refer to “worker with a college degree from the United States,” whereas the observable s may measure “the share
of the total wage bill associated with workers with a college degree” in a given industry.
In this case, unobserved heterogeneity across goods may reflect the fact that goods with
different unobservable characteristic, s⇤ , but identical observable characteristic, s, may
employ different types of workers w in a competitive equilibrium.
Factor productivity, A (w ⇤ , s⇤ , g⇤A ), is independently drawn across all factors, goods,
and countries from a Fréchet distribution. Given observables (w, s, g), we assume that
Pr{ A (w, s⇤ , g A )  a|s} = exp
where T (w, s, g A )

⇣

[ a/T (w, s, g A )]

q (s)

⌘

,

(25)

0 and q (s ) > #(s ) 1, with #(s) the elasticity of demand to be introduced below. The first parameter, T (w, s, g A ), is a locational shifter that can be thought
of as the fundamental productivity of a given factor and country in an industry. The second parameter, q (s) > 1, is a shape parameter that captures the extent of intra-industry
heterogeneity and is assumed to be constant across factors and countries. The Ricardian
model developed by Eaton & Kortum (2002) corresponds to the special case in which
there is only one factor, i.e. a unique w, and one industry, i.e. a unique s. Multi-industry
extensions considered in Levchenko & Zhang (2011), Costinot, Donaldson & Komunjer
(2012), and Caliendo & Parro (2014), among others, correspond to cases in which s can
take multiple values. Here we further allow for multiple factors within each country.
In line with the existing literature, we assume a two-tier utility function in which the
upper-level is Cobb-Douglas—across industries with observables s—and the lower-level
is CES—across goods s⇤ within the same industry. Specifically, the demand function for
a good s⇤ with observable characteristic s is given by
D ( p, I (g)|s⇤ , gD ) =

B(s, gD ) p #(s) (s⇤ ) I (g)
,
P1 # ( s ) ( s )

(26)

´1
where P(s ) ⌘ ( 0 p1 #(s) (s⇤ )ds⇤ )1/(1 #(s)) denotes the industry-level price index and
B(s, gD ) 2 [0, 1] now refers to the exogenous share of expenditure on all goods with
26

observable characteristic s. The rest of the assumptions are the same as in Section 3.
Since none of the equilibrium conditions derived in Section 3.2 depend on either the
number of goods, factors, and countries or the distribution of productivity across goods,
factors, and countries, a competitive equilibrium remains characterized by the same system of equations. Given the specific distributional assumptions imposed by equation (25),
however, one can further show that for an industry with observable characteristic s, the
probability that factor w in country g offers the minimum cost of producing a good s⇤ is
given by
p (w, g|s) =

[w (w, g) /T (w, s, g A )] q (s)
⇥
⇤
Âg0 Âw 0 w (w 0 , g0 ) /T (w 0 , s, g0A )

q (s)

.

(27)

As is well-known, equation (25) also implies that conditional on offering the minimum
cost of producing a good, the distribution of unit costs across goods s⇤ is the same for all
factors and countries. Thus p (w, g|s ) is also equal to the share of expenditure on goods
with observable characteristics s that are produced using factor w in country g.17
Using the previous observation and equation (26), which implies that a share B(s, gD )
of total expenditure in country g is allocated to industry s, one can rearrange the factor
market clearing condition (8) as
w (w, g) L (w, gL ) =

Â0 Â p (w, g|s) B(s, g0D ) I (g0 ), for all w, g.

(28)

s

g

Equations (27) and (28) uniquely pin down the schedule of factor prices w (w, g) up to a
choice of numeraire. To go from good prices to factor prices, one can then use the fact that
the lower-level utility is CES. Under this assumption, equation (25) implies that the CES
price index associated with goods with observable characteristic s is given by
P (s) = c (s) ⇥

Â Â [w (w, g) /T (w, s, g A )]
g

w

q (s)

!

1/q (s)

,

(29)

⇣ ⇣
⌘⌘1/(1 #(s))
q (s)+1 #(s)
with c (s) ⌘ G
.18 Knowledge of factor prices, w (w, g), and
q (s)
price indices, P (s), is then sufficient to conduct welfare analysis.
Compared to Section 3.3, equation (27) implies a weaker form of PAM in the cross17 In line with the analysis of Section 3, we assume that all goods are freely traded. Therefore shares of
expenditures are constant across all importing countries, as can be seen from equation (27). As shown in
Eaton & Kortum (2002) and as already mentioned in Section 3.1, it is easy to introduce iceberg trade costs
in such an environment. It is equally easy to introduce
´ them in the R-R models considered in Section 5.2.
18 G (·) denotes the gamma function, i.e., G ( t ) = • ut 1 exp( u ) du.
0

27

section. Consider the following “stochastic” version of Assumption 1.
Assumption 1 [Fréchet]. T (w, s, g A ) is strictly log-supermodular in (w, s ) and (s, g A ).
This new version of Assumption 1 also captures the idea that high-w factors and highg A countries are relatively more productive in high-s industries, but it does not require
this to be true for all goods s⇤ within an industry. Starting from equation (27), one can
check that if this version of Assumption 1 holds and q (s ) does not vary across industries, q (s) ⌘ q, then p (w, g|s) is also strictly log-supermodular in (w, s ) and (s, g A ).
This implies that high-w factors and high-g A countries should tend to sell relatively more
in high-s industries. Because of equation (25) and the assumption of a continuum of
goods with the same observable characteristic s, all factors in all countries will now be
used in all industries. But for a given factor, w, if one compares the distribution of sales
g A , then p (w, g0A |·) must dominate
across industries of two countries such that g0A
p (w, g A |·) in terms of the Monotone Likelihood Ratio Property. This is the idea behind
the revealed measure of comparative advantage developed in Costinot, Donaldson & Komunjer (2012).
Equation (27) also creates a tight connection between good prices and factor prices.
Combining equations (27) and (29) yields
h
i
w (w, g) = P (s) T (w, s, g A ) g (s )q (s) p (w, g|s)

1/q (s)

, for all s.

(30)

This is akin to equation (12) in Section 3.3 with two important differences. First, P (s )
corresponds to the CES price index of all goods with characteristics s. Second, the term
h
i 1/q (s)
adjusts for the effect of self-selection of factors from different
g (s)q (s) p (w, g|s )
countries across industries, which creates a wedge between fundamental productivity,
T (w, s, g A ), and average productivity.
Last but not least, starting from equations (27) and (28), one can use the “exact hat
algebra,” as in Dekle, Eaton & Kortum (2008) and other quantitative trade models discussed in Costinot & Rodrı́guez-Clare (2013), to conduct comparative static and welfare
analysis. Although few analytical results are available in this environment, counterfactual simulations can be performed using only estimates of q (s ) that can be obtained from
the value of trade elasticities in a gravity equation. In the next subsection, we discuss how
richer analytical results can be obtained when one goes from unobserved heterogeneity
across goods to unobserved heterogeneity across factors.

28

5.2

Unobserved Productivity Shocks across Factors

Consider now the polar case of an R-R model with a discrete number of sectors and countries and a continuum of factors. Compared to Section 5.1, sector and country characteristics are perfectly observed by the econometrician, s⇤ = s and g⇤ = g, but factor
characteristics are not, w ⇤ 6= w. In line with the analysis of the previous subsection, for
each value of w, we assume that there exists a continuum of factors w ⇤ 2 [0, 1] with the
same observable characteristic. In this environment, factors with different unobservable
characteristic, w ⇤ , but identical observable characteristic, w, may therefore be allocated to
sectors with different characteristics s in a competitive equilibrium.
The distributional assumption imposed on factor productivity, A (w ⇤ , s⇤ , g⇤A ), is similar to the one imposed in Section 5.1. Factor productivity remains independently drawn
across all factors, goods and countries from a Fréchet distribution, but given observables
(w, s, g), we now assume that
⇤

Pr { A (w , s, g A )  a|w } = exp
with T (w, s, g A )

⇣

[ a/T (w, s, g A )]

q (w,g A )

⌘

,

(31)

0 and q (w, g A ) > 1. Besides the fact that unobserved heterogeneity now derives from w ⇤ rather than s⇤ , the only difference between equations (25) and
(31) is that the shape parameter q is now specific to a group of factors within a country.
Fréchet distributions of productivity shocks across factors have been imposed in the recent closed-economy models of Lagakos & Waugh (2013) and Hsieh et al. (2013) as well
as the open economy models of Burstein, Morales & Vogel (2014), Costinot, Donaldson &
Smith (2014), and Fajgelbaum & Redding (2014).
In line with earlier sections, we restrict ourselves to CES demand functions. Here
again, a competitive equilibrium is characterized by the same system of equations as in
Section 3.2. Similarly, for a factor with observable characteristic w in country g, the probability that the value of the marginal product is maximized in sector s is given by
p (s|w, g) =

[ p (s) T (w, s, g A )]q (w,g A )
Âs0 [ p (s0 ) T (w, s0 , g A )]

q (w,g A )

.

(32)

Because of equation (31), the distribution of prices for factors with observable characteristic w in country g is now the same across all sectors s. Hence, p (s|w, g) is also the
share of income of factors from country g with observable characteristic w that is earned
in sector s. Together with the assumption of CES demand functions, this implies that the

29

goods market clearing condition (9) can be rearranged as

Â B(s, gD ) ( p (s))1
g

#

I (g) =

Â0 Â w̄
g

w

w, g0 p s|w, g0 L w, g0L , for all s,

(33)

where w̄ (w, g) denotes the average return across all factors w ⇤ from country g with observable characteristic w, which is constant across all sectors, and the CES price index has
been normalized to one. Finally, equation (31) implies that w̄ (w, g) satisfies
w̄ (w, g) = c (w, g A ) ⇥

Â [ p (s) T (w, s, g A )]

q (w,g A )

s

!1/q (w,g A )

,

(34)

⇣
⌘
q (w,g ) 1
where c (w, g A ) ⌘ G q (w,gA ) . Equations (32)-(34) fully pin down good prices, p (s ),
A
and average factor prices, w̄ (w, g), up to a normalization.
Before studying the differences between the models of Sections 5.1 and 5.2, it is useful
to understand their similarities. Like equation (27) in Section 5.1, equation (32) provides
a simple relationship between fundamental productivities, Ts, shape parameters, qs, and
factor allocations, ps.19 Under the Fréchet version of Assumption 1 and the restriction
that q (w, g A ) ⌘ q, equation (32) also generates a weaker form of PAM: p (s|w, g) is
strictly log-supermodular in (w, s ) and (s, g A ). In terms of price predictions, equations
(32) and (34) imply that
h
i
w̄ (w, g) = p (s ) T (w, s, g A ) g (w, g A )q (w,g A ) p (s |w, g)

1/q (w,g A )

, for all s,

(35)

which again highlights the importance of self-selection. Furthermore, given the “CESlike” functional forms in equations (32)-(34), one can still use the exact algebra of Dekle,
Eaton & Kortum (2008) to conduct comparative static and welfare analysis in this environment, an approach implemented by Burstein, Morales & Vogel (2014).20
Given these similarities, it would be tempting to view this subsection as a simple relabeling of factors and goods in Section 5.1. It is not. The equilibrium system of equations
here—equations (32)-(34)—cannot be obtained by permutations of s, w, and g in equations (27)-(29). To take one example, w̄ (w, g) here is an arithmetic average, whereas P(s )
in Section 5.1 is not. Such distinctions are consequential. Whereas we have very few an19 Hsieh et al. (2013) and Burstein, Morales & Vogel (2014) use this relationship, estimates of qs, and data
on factor allocation to recover the productivity of different worker groups across occupations as well as the
implicit taxes or wedges that they may face.
20 Galle, Rodrı́guez-Clare & Yi (2014) follow a similar strategy in a quantitative trade model that combines both unobserved good and factor heterogeneity drawn from Fréchet distributions.

30

alytical results about the effects of trade integration or other shocks in the environment
considered in Section 5.1, our online Appendix establishes that the FPE Theorem, the Rybczynski Theorem, as well as the the Stolper-Samuelson Theorem all generalize to the
present environment.
Similar results can be derived in an environment with unobserved preference shocks,
as in Artuc, Chaudhuri & McLaren (2010), Dix-Carneiro (2014), and Redding (2014). Such
extensions are important since they provide a natural framework to pursue quantitative
work on the consequences of international trade in economies with imperfect factor mobility across sectors and locations. We also discuss them in details in our online Appendix.

6

Non-Parametric Applications

Ideally, when applying R-R models to the analysis of counterfactual questions, one would
like to have information about the productivity of all factors in all sectors and countries.
Unfortunately, such detailed information is rarely available. Typically, researchers may
be able to observe “factual” productivity, that is the productivity of factors in the sectors
in which they are currently employed, but not their “counterfactual” productivity, that
is their productivity in the sectors to which they would be reallocated in response to a
counterfactual shock.
In Section 5, we have discussed parametric applications of R-R models that deal with
the previous issue by assuming that unobserved factor productivity is drawn from Fréchet
distributions. We now turn to alternative applications of R-R models that aim to dispense
as much as possible with functional-form assumptions. The basic idea behind these applications is to focus on agriculture, a sector of the economy in which the scientific knowledge of how essential inputs such as water, soil and climatic conditions map into outputs
is uniquely well understood. As a result, agronomists are able to predict with great accuracy how productive various parcels of land would be were they to be used to grow any
one of a set of crops. In short, both factual and counterfactual productivities are known
in this particular context.
All applications in this section are based on detailed micro-level data from the Food
and Agriculture Organization’s (FAO) Global Agro-Ecological Zones (GAEZ) project. This
dataset records potential crop yields for millions of 5 arc-minute grid-cells covering the
surface of the earth; see Nunn & Qian (2011) and Costinot & Donaldson (2014) for additional information. In Section 6.1, we first illustrate how the GAEZ data can be used to
test the cross-sectional implications of David Ricardo’s theory of comparative advantage.
In Sections 6.2 and 6.3, we then discuss how the same agronomic data can be used to
31

measure the historical gains from economic integration as well as to quantify the consequences of climate change in agricultural markets, respectively.

6.1

Testing Ricardo’s Theory of Comparative Advantage

David Ricardo’s theory of comparative advantage, upon which R-R models build, is one
of the oldest and most distinguished theories in economics. However, it is a difficult
theory to confront to the data. As already noted by Deardorff (1984): “Problems arise,
however, most having to do with the observability of [productivity by industry and country]. The...problem is implicit in the Ricardian model itself...[because] the model implies
complete specialization in equilibrium... This in turn means that the differences in labor
requirements cannot be observed, since imported goods will almost never be produced
in the importing country.” Accordingly, empirical work on the cross-sectional implications of the Ricardian model has proceeded by imposing ad-hoc specifications, as in MacDougall (1951), Stern (1962), Balassa (1963), and Golub & Hsieh (2000), or strong distributional assumptions on the extent of unobserved labor productivity, as in Costinot,
Donaldson & Komunjer (2012).
Costinot & Donaldson (2012) propose an alternative empirical strategy that relies instead on productivity and price data from the FAO for 17 major agricultural crops and
55 major agricultural countries. As discussed above, the GAEZ project reports “total
production capacity” in tons per hectare for each 5 arc-minute grid cell within these 55
countries. Costinot & Donaldson (2012) interpret each grid-cell as a distinct factor w and
“total production capacity” and the area of each grid-cell as the empirical counterparts
of A(w, s, g A ) and L(w, gL ), respectively. Under the assumption that S(w, g) is a singleton,21 the aggregate output of crop s in country g is given
Q(s, g) =

´

W(s,g)

A(w, s, g A ) L(w, g L )dw,

(36)

where W(s, g) is the set of factors allocated to crop s in country g,
W(s, g) = w 2 W| A(w, s, g A )/A(w, s0 , g A ) > p(s0 , g)/p(s, g) for all s0 6= s .

(37)

In the previous expression, p(s, g) denotes the local price of crop s in country g, which
is allowed to vary across countries because of transportation costs or taxes and subsidies.
Combining equations (36) and (37) with productivity and price data, Costinot & Donaldson (2012) then compute predicted output levels for all crops and countries and com21 This

assumption is satisfied for all but two grid cells in Brazil.

32

pare them to those observed in the data. Their empirical results show that the output levels predicted by Ricardo’s theory of comparative advantage agree reasonably well with
actual data on worldwide agricultural production.

6.2

Measuring the Gains from Economic Integration

In Section 6.1, we have shown how to use data on agricultural output, productivity, and
prices to “test” the cross-sectional predictions of R-R models. Alternatively, in the absence of price data, one could use the cross-sectional predictions of R-R models, together
with agricultural output and productivity data, in order to “back out” model-consistent
prices. This is the approach followed by Costinot & Donaldson (2014) in the context of
U.S. agricultural markets from 1880 to 1997.
Combining agronomic data from the GAEZ project with historical data from the U.S.
Census, the authors first demonstrate how to identify the spatial distribution of crop
prices across U.S. counties over time, while still allowing for crop-county-year specific
productivity shocks. By comparing local crop prices, estimated from the model, and
prices in major wholesale markets, observed in historical data, the authors then estimate
trade costs for each U.S. county from 1880 to 1997. Finally, armed with the previous estimates, they compute the aggregate productivity gains due to changes in trade costs over
that time period, which they refer to as the gains from economic integration.
In terms of the empirical validity of R-R models, Costinot & Donaldson (2014) find a
robust, positive correlation between county-level prices inferred from the model and historical state-level prices, which are the most disaggregated price data available over the
long time period. Since the estimation of local prices in Costinot & Donaldson (2014) does
not use any direct information on prices—it relies instead on information about historical
output levels and modern productivity—these additional empirical results also suggest
that R-R models have significant explanatory power in the data.

6.3

Quantifying the Consequences of Climate Change

Another attractive feature of the GAEZ dataset is that potential crop yields are available
under various climate change scenarios. Hence, using both pre- and post-climate change
crop yields as inputs into an R-R model, one can explore the macro-level consequences
of climate change in agricultural markets. This is the starting point of the quantitative
analysis in Costinot, Donaldson & Smith (2014).
The authors develop an R-R model that combines detailed micro-level data with otherwise parsimonious parametric assumptions. Compared to the applications reviewed
33

in Sections 6.1 and 6.2, it features observed productivity heterogeneity across grid-cells,
as reported in the GAEZ dataset, but also unobserved productivity heterogeneity within
grid-cells, which is assumed to be drawn from a Fréchet distribution across a continuum
of parcels. Closed-form solutions for factor allocation and aggregate output levels are
therefore akin to those presented in Section 5.2, which dramatically simplifies the computation of competitive equilibria in an environment with 10 crops, 50 countries, and 1.7
million grid-cells.
Using this trade model, Costinot, Donaldson & Smith (2014) quantify the impact of
climate change on agricultural markets. This new type of Computational General Equilibrium (CGE) models—based on rich micro-level data and a tight connection between
theory and empirics—could be applied to many other outstanding questions in the field.
Sotelo (2013) provides an interesting example. By combining the GAEZ data with a theoretical framework similar to the one in Costinot, Donaldson & Smith (2014), he quantifies
the contribution of trade frictions to the low agricultural productivity of Peru.

7

Concluding Remarks

In this article, we have provided a user guide to multi-factor generalizations of the Ricardian model of international trade, which we have referred to as Ricardo-Roy (R-R) models. We have presented tools and techniques for theoretical, quantitative, and empirical
work in this class of assignment models. We have also reviewed a number of applications
of these models. We conclude by discussing a number of open questions and promising
avenues for future research.
On the theoretical front, we have described how the baseline R-R model could be extended along a number of dimensions, including the introduction of monopolistic competition and sequential production. R-R models could also accommodate many of the
other features that have previously been studied in a Ricardian environment, such as external economies of scale as in Ethier (1982), Grossman & Rossi-Hansberg (2010), and
Matsuyama (2013), or learning by doing, as in Krugman (1987) and Young (1991). R-R
models could also be used to study the relationship between trade and labor market frictions, perhaps building on the closed economy models of Teulings (2003) and Teulings &
Gautier (2004), or endogenous technological change, as in the work of Acemoglu (2002).
In an R-R model, technological change may be biased towards particular tasks rather than
factors, as in Atkinson & Stiglitz (1969), with factors endogenously reallocating between
these tasks. It would also be interesting to explore the implications of R-R models for
trade policy, both from a positive and a normative perspective. Such models may provide
34

a useful alternative to the traditional specific-factor model. The methodology developed
by Costinot et al. (2014) to characterize optimal trade taxes in a Ricardian model should
prove helpful in this more general environment.
On the empirical front, R-R models are particularly well-suited to study the distributional consequences of international trade. Building on the important work of Artuc,
Chaudhuri & McLaren (2010), one could imagine using variations of the parametric models and methods presented in Section 5 to quantify the importance of previous trade
liberalization episodes across sectors and regions. These simple static models may offer a useful compromise between reduced-form work, as in Goldberg & Pavcnik (2007),
and richer dynamic structural models, as in Dix-Carneiro (2014). As shown in Sampson
(2014), R-R models can also accommodate firm-level heterogeneity in imperfectly competitive markets. One could also imagine using parametric versions of such R-R models
to help analyze the increasing number of matched employer-employee datasets that have
become available.
Of course, future empirical and quantitative work does not have to be limited to parametric applications. It is well-known that GEV distributions impose strong restrictions
on own-price and cross-price elasticities. Galichon & Salanié (2012) offer an example of
how to relax these distributional assumptions in one-to-one matching models. It may be
interesting to follow a similar approach when studying the effects of international trade
in local labor markets. Finally, agricultural trade policy is one of the most salient issues
in today’s world economy. R-R models and the GAEZ data described in Section 6 offer
a unique opportunity to shed light on this key policy issue. What are the effects on the
Common Agricultural Policy on the misallocation of resources in European agricultural
markets? How do agricultural trade policies set in developed economies affect households in developing countries? These are central questions about which we know fairly
little, but that could be addressed using R-R models.
In sum, much remains to be done.

35

References
Acemoglu D. 2002. Directed Technical Change. Review of Economic Studies 69:781–809
Acemoglu D, Autor D. 2011. Skills, tasks, and technologies: Implications for employment
and earnings, vol. 4 of Handbook of Labor Economics. Elsevier
Anderson S, de Palma A, Thisse J. 1992. Discrete choice theory of product differentiation.
MIT Press
Antras P, Chor D. 2013. Organizing the global value chain. Econometrica 81:2127–2204
Antras P, Garicano L, Rossi-Hansberg E. 2006. Offshoring in a knowledge economy. Quarterly Journal of Economics 121:31–77
Antras P, Rossi-Hansberg E. 2009. Organizations and trade. Annual Review of Economics
1:43–64
Artuc E, Chaudhuri S, McLaren J. 2010. Trade shocks and labor adjustment: A structural
empirical approach. American Economic Review 100:1008–1045
Atkinson AB, Stiglitz JE. 1969. A New View of Technological Change. Economic Journal
79:573–78
Autor D, Katz L, Kearney M. 2008. Trends in u.s. wage inequality: Revising the revisionists. Review of Economics and Statistics 90:300–323
Balassa B. 1963. An empirical demonstration of classical comparative cost theory. Review
of Economics and Statistics 45:231–238
Becker GS. 1973. A theory of mariage: Part 1. Journal of Political Economy 81:813–846
Berry S. 1994. Estimating discrete-choice models of product differentiation. RAND Journal
of Economics 25:242–262
Blanchard E, Willmann G. 2013. Trade, Education, and The Shrinking Middle Class. Kiel
Working Papers 1831, Kiel Institute for the World Economy
Borjas GJ. 1987. Self-selection and the earnings of immigrants. The American Economic Review 77:531–553
Burstein A, Morales E, Vogel J. 2014. Accounting for changes in between-group inequality.
Unpublished manuscript, Columbia University
36

Caliendo L, Parro F. 2014. Estimates of the trade and welfare effects of NAFTA. Review of
Economic Studies. In press
Choo E, Siow A. 2006. Who Marries Whom and Why. Journal of Political Economy 114:175–
201
Costinot A. 2009. An elementary theory of comparative advantage. Econometrica 77:1165–
1192
Costinot A, Donaldson D. 2012. Ricardo’s theory of comparative advantage: Old idea,
new evidence. American Economic Review, Papers and Proceedings 102:453–458
Costinot A, Donaldson D. 2014. How large are the gains from economic integration? theory and evidence from u.s. agriculture, 1880-1997. Unpublished manuscript, MIT
Costinot A, Donaldson D, Komunjer I. 2012. What goods do countries trade? a quantitative exploration of ricardo’s ideas. Review of Economic Studies 79:581–608
Costinot A, Donaldson D, Smith C. 2014. Evolving comparative advantage and the impact
of climate change in agricultural markets: Evidence from a 1.7 million fields around the
world. Journal of Political Economy. In press
Costinot A, Donaldson D, Vogel J, Werning I. 2014. Comparative advantage and optimal
trade policy. Unpublished manuscript, MIT
Costinot A, Rodrı́guez-Clare A. 2013. Trade theory with numbers: Quantifying the consequences of globalization, vol. 4 of Handbook of International Economics. Elsevier
Costinot A, Vogel J. 2009. Matching and inequality in the world economy. NBER Work.
Pap. 14672
Costinot A, Vogel J. 2010. Matching and inequality in the world economy. Journal of Political Economy 118:747–786
Costinot A, Vogel J, Wang S. 2012. Global supply chains and wage inequality. American
Economic Review, Papers and Proceedings 102:396–401
Costinot A, Vogel J, Wang S. 2013. An elementary theory of global supply chains. Review
of Economic Studies 80:109–144
Davidson C, Matusz S, Shevchenko A. 2008. Globalization and firm level adjustment with
imperfect labor markets. Journal of International Economics 75:295–309
37

Davis DR, Dingel JI. 2013. The comparative advantage of cities. Unpublished manuscript,
Columbia University
Deardorff A. 1984. Testing trade theories and predicting trade flows, vol. 1 of Handbook of
International Economics. North Holland, Amsterdam
Dekle R, Eaton J, Kortum S. 2008. Global rebalancing with gravity: Measuring the burden
of adjustment. IMF Staff Papers 55:511–540
Dix-Carneiro R. 2014. Trade liberalization and labor market dynamics. Econometrica
82:825–885
Dixit AK, Grossman GM. 1982. Trade and Protection with Multistage Production. Review
of Economic Studies 49:583–94
Dorfman R, Samuelson PA, Solow R. 1958. Linear programming and economic analysis.
New York: McGraw Hill
Eaton J, Kortum S. 2002. Technology, geography and trade. Econometrica 70:1741–1779
Eaton J, Kortum S. 2012. Putting ricardo to work. Journal of Economic Perspectives 26:65–90
Edwards TH, Perroni C. 2014. Market integration, wage concentration, and the cost and
volume of traded machines. Unpublished manuscript, University of Warwick
Egger H, Kreickemeier U. 2012. Fairness, trade, and inequality. Journal of Intermational
Economics 86:184–196
Ethier WJ. 1982. Decreasing costs in international trade and frank graham’s argument for
protection. Econometrica 50:1243–1268
Ethier WJ. 1984. Higher dimensional issues in trade theory, vol. 1 of Handbook of International Economics. Amsterdam: North-Holland
Fajgelbaum P, Redding SJ. 2014. External integration, structural transformation and economic development: Evidence from argentina 1870-1914. Unpublished manuscript,
Princeton University
Galichon A, Salanié B. 2012. Cupid’s Invisible Hand: Social Surplus and Identification in
Matching Models. Unpublished manuscript, Columbia University
Galle S, Rodrı́guez-Clare A, Yi M. 2014. Slicing the pie: Quantifying the aggregate and
distributional effects of trade. Unpublished manuscript, UC Berkeley
38

Garicano L. 2000. Hierarchies and the organization of knowledge in production. Journal
of Political Economy 108:874–904
Garicano L, Rossi-Hansberg E. 2014. Knowledge-based hierarchies: Using organizations
to understand the economy. Annual Review of Economics. In press
Gaubert C. 2014. Firm sorting and agglomeration. Unpublished manuscript, Princeton
University
Goldberg P, Pavcnik N. 2007. Distributional effects of globalization in developing countries. Journal of Economics Literature 45:39–82
Golub SS, Hsieh CT. 2000. Classical ricardian theory of comparative advantage revisited.
Review of International Economics 8:221–234
Goos M, Manning A. 2007. Lousy and lovely jobs: The rising polarization of work in
britain. Review of Economics and Statistics 89:118–133
Grossman GM. 2013. Heterogeneous workers in international trade. Review of World Economics 149:211–245
Grossman GM, Helpman E. 2014. Growth, trade, and inequality. Unpublished
manuscript, Princeton University
Grossman GM, Helpman E, Kircher P. 2013. Matching and Sorting in a Global Economy.
NBER Work. Pap. 19513
Grossman GM, Maggi G. 2000. Diversity and trade. American Economic Review 90:1255–
1275
Grossman GM, Rossi-Hansberg E. 2010. External economies and international trade redux. Quarterly Journal of Economics 125:829–858
Heckman JJ, Honore BE. 1990. The empirical content of the roy model. Econometrica
58:1121–1149
Heckman JJ, Sedlacek G. 1985. Heterogeneity, aggregation, and market wage functions:
An empirical model of self-selection in the labor market. Journal of Political Economy
93:1077–1125
Helpman E, Itskhoki O, Redding S. 2010. Inequality and unemployment in a global economy. Econometrica 78:1239–1283
39

Hsieh CT, Hurst E, Klenow P, Jones C. 2013. The allocation of talent and u.s. economic
growth. Unpublished manuscript, Stanford University
Hummels DL, Ishii J, Yi KM. 2001. The nature and growth of vertical specialization in
world trade. Journal of Intermational Economics 54:75–96
Johnson RC, Moxnes A. 2013. Technology, trade costs, and the pattern of trade with multistage production. Unpublished manuscript, Dartmouth
Jones R, Scheinkman J. 1977. The relevance of the two-sector model in trade theory. Journal
of Political Economy 85:909–935
Karlin S, Rinott Y. 1980. Classes of orderings of measures and related correlation inequalities i. multivariate totally positive distributions. Journal of Multivariate Analysis 10:467–
498
Kremer M. 1993. The o-ring theory of economic development. Quarterly Journal of Economics 108:551–575
Kremer M, Maskin E. 2006. Globalization and inequality. Unpublished manuscript, Harvard University
Krugman P. 1986. A ’technology gap’ model of international trade. Structural Adjustment
in Advanced Economies. London: Mcmillan
Krugman P. 1987. The narrow moving band, the dutch disease, and the competitive consequences of mrs. thatcher. Journal of Development Economics 27:41–55
Lagakos D, Waugh ME. 2013. Selection, agriculture, and cross-country productivity differences. American Economic Review 103:948–980
Levchenko AA, Zhang J. 2011. The evolution of comparative advantage: Measurement
and welfare implications. Unpublished manuscript, University of Michigan
Liu R, Trefler D. 2011. A Sorted Tale of Globalization: White Collar Jobs and the Rise of
Service Offshoring. NBER Work. Pap. 17559
Lucas RE. 1978. On the size distribution of business firms. Bell Journal of Economics 9:508–
523
MacDougall G. 1951. British and american exports: A study suggested by the theory of
comparative costs. part i. Economic Journal 61:697–724
40

Matsuyama K. 1996. Why are there rich and poor countries?: Symmetry-breaking in the
world economy. Journal of the Japanese and International Economies 10:419–439
Matsuyama K. 2005. Credit market imperfections and patterns of international trade and
capital flows. Journal of the European Economic Association 3:714–723
Matsuyama K. 2013. Endogenous ranking and equilibrium lorentz curve across (ex ante)
identical countries. Econometrica 81:2009–2031
McFadden D. 1974. Conditional logit analysis of qualitative choice behavior. Frontiers in
Econometrics. New York: Academic Press
Melitz M, Cunat A. 2012. Volatility, labor market flexibility, and the pattern of comparative advantage. Journal of the European Economic Association 10:225–254
Melitz MJ. 2003. The impact of trade on intra-industry reallocations and aggregate industry productivity. Econometrica 71:1695–1725
Milgrom P. 1981. Good news and bad news: Representation theorems and applications.
The Bell Journal of Economics :380–391
Milgrom P, Segal I. 2002. Envelope theorems for arbitrary choice sets. Econometrica 70:583–
601
Milgrom P, Shannon C. 1994. Monotone comparative statics. Econometrica 62:157–180
Monte F. 2011. Skill bias, trade, and wage dispersion. Journal of International Economics
83:202–218
Nocke V, Yeaple S. 2008. An assignment theory of foreign direct investment. Review of
Economic Studies 75:529–557
Nunn N, Qian N. 2011. The potato’s contribution to population and urbanization: Evidence from a historical experiment. Quarterly Journal of Economics 126:593–650
Nunn N, Trefler D. 2014. Domestic institutions as a source of comparative advantage,
vol. 4 of Handbook of International Economics. Elsevier
Ohnsorge F, Trefler D. 2007. Sorting it out: International trade with heterogeneous workers. Journal of Political Economy 115:868–892
Piketty T, Saez E. 2003. Income inequality in the united states, 1913-1998. Quarterly Journal
of Economics 118:1–39
41

Redding SJ. 2014. Goods trade, factor mobility and welfare. Unpublished manuscript,
Princeton University
Roy A. 1951. Some thoughts on the distribution of earnings. Oxford Economic Papers 3:135–
146
Ruffin RJ. 1988. The missing link: The ricardian approach to the factor endowments theory of trade. American Economic Review :759–772
Sampson T. 2014. Selection into trade and wage inequality. American Economic Journal:
Microeconomics. In press
Sanyal K. 1983. Vertical specialization in a ricardian model with a continuum of stages of
production. Economica 50:71–78
Sattinger M. 1993. Assignment models of the distribution of earnings. Journal of Economic
Literature 31:831–880
Sobel J. 1992. How to count to one thousand. Economic Journal 102:1–8
Sotelo S. 2013. Trade frictions and agricultural productivity: Theory and evidence from
peru. Unpublished manuscript, University of Chicago
Stern R. 1962. British and american productivity and comparative costs in international
trade. Oxford Economic Papers 14:275–296
Teulings CN. 1995. The wage distribution in a model of the assignment of skills to job.
Journal of Political Economy 103:280–313
Teulings CN. 2003. The contribution of minimum wages to increasing wage inequality.
Economic Journal 113:801–833
Teulings CN. 2005. Comparative advantage, relative wages, and the accumulation of human capital. Journal of Political Economy 113:425–461
Teulings CN, Gautier PA. 2004. The right man for the job. Review of Economic Studies
71:553–580
Whitin T. 1953. Classical theory, graham’s theory, and linear programming in international trade. Quarterly Journal of Economics 67:520–544
Yanagawa N. 1996. Economic development in a ricardian world with many countries.
Journal of Development Economics 49:271–288
42

Yeaple SR. 2005. A simple model of firm heterogeneity, international trade, and wages.
Journal of International Economics 65:1–20
Yi KM. 2003. Can vertical specialization explain the growth of world trade? Journal of
Political Economy 111:52–102
Yi KM. 2010. Can multi-stage production explain the home-bias in trade? American Economic Review 100:364–393
Young A. 1991. Learning by doing and the dynamic effects of international trade. Quarterly Journal of Economics 106:396–406

43

