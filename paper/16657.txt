NBER WORKING PAPER SERIES

THE PROPAGATION OF REGIONAL RECESSIONS
James D. Hamilton
Michael T. Owyang
Working Paper 16657
http://www.nber.org/papers/w16657

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2011

The authors benefited from conversations with Michael Dueker, Jeremy Piger, and Justin Tobias.
Kristie M. Engemann provided research assistance. The views expressed herein do not reflect the
official positions of the Federal Reserve Bank of St. Louis, the Federal Reserve System, or the National
Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2011 by James D. Hamilton and Michael T. Owyang. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including Â© notice, is given to the source.

The Propagation of Regional Recessions
James D. Hamilton and Michael T. Owyang
NBER Working Paper No. 16657
January 2011
JEL No. E32
ABSTRACT
This paper develops a framework for inferring common Markov-switching components in a panel
data set with large cross-section and time-series dimensions. We apply the framework to studying
similarities and differences across U.S. states in the timing of business cycles. We hypothesize that
there exists a small number of cluster designations, with individual states in a given cluster sharing
certain business cycle characteristics. We find that although oil-producing and agricultural states can
sometimes experience a separate recession from the rest of the United States, for the most part, differences
across states appear to be a matter of timing, with some states entering recession or recovering before
others.

James D. Hamilton
Department of Economics, 0508
University of California, San Diego
9500 Gilman Drive
La Jolla, CA 92093-0508
and NBER
jhamilton@ucsd.edu
Michael T. Owyang
Research Department
Federal Reserve Bank of St. Louis
P.O. Box 442
St. Louis, MO 63166-0442
Michael.T.Owyang@stls.frb.org

1

Introduction

The formation of the European Monetary Union has sparked a resurgence of interest in regional
business cycles, both in Europe and in the United States, where longer time series are available. A
number of these recent studies have characterized the U.S. national economy as an agglomeration
of distinct but interrelated regional economies. While some idiosyncrasies exist, regional business
cycles in the United States, for the most part, bear a reasonable resemblance to the national cycle
identified by the National Bureau of Economic Research (NBER) using aggregate data. Disparities
in regional business cycles have often been attributed either to idiosyncratic shocks or to differences
in characteristics such as the industrial composition of the regions. Conversely, commonality can
be attributed to responses to common aggregate shocks for which the state responses vary but the
timing is identical.1
Characterizing regional business cycles using a panel data set with large cross-section and timeseries dimensions raises two separate questions. The first is how to model the comovements that are
common across geographic divisions. In Owyang, Piger, and Wall (2005) and Owyang, Piger, Wall,
and Wheeler (2008), the unit of analysis is taken to be individual states and cities, respectively.
Regional similarities were noted but not modeled explicitly.

One alternative for characterizing

common elements across geographic divisions is to rely on factor analysis, as in Forni and Reichlin
(2001) and Del Negro (2002).

Another approach is to use exogenously defined regions such as

those adopted by the Bureau of Economic Analysis (BEA) as either the basic unit of analysis (e.g.,
Kouparitsas, 1999) or an additional observable restriction on the state-level factor structure (Del
Negro, 2002).

A few studies define regions endogenously.

Crone (2005) used kâˆ’means cluster

analysis of state business cycle movements to define regions.

While his regional definitions are

similar to those used by the BEA, Crone found some discrepancies (in particular, Arizona, which
may be taken as a region unto itself).

Partridge and Rickman (2005) used cyclical indices to

uncover common currency areas in the United States. Similarly, van Dijk et al. (2007) constructed
clusters for regional housing markets in the Netherlands.
A second question concerns the manner in which the business cycle itself is defined.

What

exactly are we claiming to have measured when we compare the timing of a recession in one state
1

Monetary shocks, for example, are aggregate shocks that have common timing but varying effect [see Carlino and
DeFina (1998)].

1

with that observed in another? In a standard factor model, the cyclical component is viewed as a
continuous-valued random variable, defined in terms of its ability to capture certain comovements
across states. Kouparitsas (1999) and Carlino and DeFina (2004) used band-pass filters to extract
the business cycle frequency from disaggregate data. Carlino and Sill (2001) and Partridge and
Rickman (2005) relied on trend-cycle decompositions.
Hamilton (2005) argued that the defining characteristic of the business cycle as understood, for
example, by Burns and Mitchell (1946) is a transition between distinct, discrete phases of expansion
and contraction. Owyang, Piger, and Wall (2005) and Owyang, Piger, Wall, and Wheeler (2008)
adopted this perspective in their application of the Markov-switching model of Hamilton (1989)
to data for individual states and cities, respectively.

The contribution of the present paper is

to extend that effort to characterize the interactions across states in these shifts.

Our paper

could alternatively be viewed as an extension of factor or cluster analysis to this kind of nonlinear
framework.
We account for the correlation across states by modeling both national and regional recessions.
In our setup, following FruÌˆhwirth-Schnatter and Kaufmann (2008), we allow the data to define
regional groupings (which we designate as â€œclustersâ€) on the basis of comovement in state employment growth rates and other observable, fixed state characteristics. In particular, we model the
probability of a stateâ€™s inclusion in any region as a logistic variable, in which state-level characteristics affect the prior probability of state membership in a region-cluster and observed employment
growth comovements inform the posterior inference about those probabilities.
The model is estimated using Bayesian methods, and we report five main findings. First, most
state-level business cycle experiences are similar to those of the nation. Second, most idiosyncratic
recession experiences amount to differentials in timing around the national recessions. For example, some states enter some recessions before the rest of the nation.

Third, a cluster of states,

characterized by an important role for oil production in their economies, does enter and exit recessions independently from the nation. Fourth, the regional clusters we find are not exclusive, i.e., a
state can belong to more than one region. However, the overlapping of states in multiple regions is
infrequent. Finally, while industrial composition matters for cluster determination, other factors
such as the share of employment coming from small firms may also be important.
The remainder of this paper is organized as follows.
2

Section 2 presents our characterization

of regional business cycles with particular focus on endogenous region determination.

Section 3

details the estimation technique. Section 4 presents the empirical results. Section 5 concludes.

2

Characterizing regional business cycles.

Let ytn denote the employment growth rate for state n observed at date t. We group observations
for all states at date t in an (N Ã— 1) vector yt = (yt1 , ..., ytN )0 , where N denotes the number of
states. Let st be an (N Ã— 1) vector of date t recession indicators (so stn = 1 when state n is in
recession and stn = 0 when state n is in expansion). Suppose that

yt = Âµ0 + Âµ1

st + Îµt ,

(1)

where the nth element of the (N Ã— 1) vector Âµ0 + Âµ1 is the average employment growth in state
n during recession, the nth element of the (N Ã— 1) vector Âµ0 is the average employment growth in
state n during expansion, and

represents the Hadamard product. We assume that Îµt âˆ¼ i.i.d.

N (0, â„¦), with Îµt independent of sÏ„ for all dates and that st follows a Markov chain.
Equation (1) postulates that recessions are the sole source of dynamics in state employment
growth. There is no conceptual problem with adding lagged values of ytâˆ’j or stâˆ’j to this equation,
though that would greatly increase the number of parameters and regimes for which one needs to
draw an inference. We regard the parsimonious formulation (1) as more robust than more richly
parameterized models for purposes of characterizing the broad features of business cycles across
states. We also adopt the simplifying assumption that â„¦ is diagonal:
ï£®
ï£¯
ï£¯
ï£¯
ï£¯
â„¦=ï£¯
ï£¯
ï£¯
ï£°

Ïƒ 21 0

Â·Â·Â·

0

0
..
.

Ïƒ 22

Â·Â·Â·

..
.

Â·Â·Â·

0
..
.

0

0

Â·Â·Â·

Ïƒ 2N

ï£¹
ï£º
ï£º
ï£º
ï£º
ï£º.
ï£º
ï£º
ï£»

This reduces the number of variance parameters from N (N + 1)/2 down to N , and, unfortunately,
is necessary for the particular algorithms we employ to be valid.

Our model thus assumes that

coincident recessions, or the tendency of a recession in one state to lead to a recession in another,

3

are the only reason that employment growth would be correlated across states.

Again, this is

a stronger formulation than one might like, though we think nevertheless an interesting one for
getting a broad summary of some of the ways that the business cycle may be propagated across
regions.
Despite these assumptions, the model (1) is numerically intractable without further simplification. If state 1 can be in recession while 2 and 3 are not, or 1 and 2 in recession while 3 is not,
there are Î· = 2N different possibilities, or 2.8 Ã— 1014 different configurations in the case of the 48
contiguous states. Implementing the algorithm for inference and likelihood evaluation in Hamilton
(1994, p. 692) would require calculation of an (Î· Ã— 1) vector Î¾ t and an (Î· Ã— Î·) matrix P, which is
not remotely feasible. Even if it somehow could be implemented, such a formulation is trying to
infer much more information from a (T Ã— N ) data set than can be reasonably justified.2
Our approach, as in FruÌˆhwirth-Schnatter and Kaufmann (2008), is to assume that recession
dynamics can be characterized in terms of a small number K << 2N of different clusters and by an
aggregate indicator zt âˆˆ {1, 2, ..., K} signifying which cluster is in recession at date t. We associate
with cluster 1 an (N Ã— 1) vector h1 = (h11 , ..., hN 1 )0 whose nth element is unity when state n is
associated with cluster 1 and 0 if state n is not associated with the cluster. When zt = 1, all the
states associated with cluster 1 would be in recession. In general,

yt |zt = k âˆ¼ N (mk , â„¦),

where
mk = Âµ0 + Âµ1

hk .

Conditional on knowing the values of h1 , ..., hK , this is a standard Markov-switching framework
for which inference methods are well known. The new question is how to infer the configurations
of h1 , ..., hK from the data. We impose two of these configurations a priori, stipulating that hK is
a column of all zeros (so that every state is in expansion when zt = K), and hKâˆ’1 is a column of
all ones (every state is in recession when zt = K âˆ’ 1). We will refer to clusters other than those
characterized by hKâˆ’1 and hK as â€œidiosyncraticâ€ clusters and let Îº = K âˆ’ 2 denote the number of
2

Others have posited alternative methods for estimating large panel Markov-switching models. See, for example,
Sims, Waggoner, and Zha (2008) and Kaufmann (2010).

4

idiosyncratic clusters. Thus, when zt = 1, 2, ..., Îº, some states are in recession and others are not.
The values of h1 , ..., hÎº are unobserved variables that influence the probability distribution of the
observed data {yt }Tt=1 .
We postulate that there is a (Pk Ã— 1) vector xnk that influences whether state n experiences a
recession when zt = k according to
ï£±
h

i
ï£´
ï£² 1/ 1 + exp x0 Î² k
if hnk = 0
nk
p(hnk ) =
 0
 h
 0
i
ï£´
ï£³ exp x Î² k / 1 + exp x Î² k
if hnk = 1
nk
nk

(2)

for n = 1, ..., N ; k = 1, ..., Îº. Note that state n could be affiliated with more than one idiosyncratic
cluster.3 Alternatively, state n would participate only in national recessions if hn1 = Â· Â· Â· = hnÎº = 0.
We think of Î² k as a population parameter â€“ prior to the generation of any data, nature generated
a value of hnk according to (2).
population parameter Î² k .

We will then draw a Bayesian posterior inference about the

Following Holmes and Held (2006), it is convenient for purposes of

the estimation algorithm to represent this generation of hnk given Î² k as the outcome of another
unobserved pair of latent variables, denoted Î¾ nk and Ïˆ nk .

The ability to do so comes from the

following observation by Andrews and Mallows (1974). Let Ïˆ nk have the limiting distribution of
the Kolmogorov-Smirnov test statistic, whose density Devroye (1986, p. 161) writes as

p (Ïˆ nk ) = 8

âˆ
X


(âˆ’1)j+1 j 2 Ïˆ nk exp âˆ’2j 2 Ïˆ 2nk .

(3)

j=1
0

Andrews and Mallows showed that if Ïˆ nk âˆ¼ KS and enk âˆ¼ N (0, 1), then Î¾ nk = xnk Î² k + 2Ïˆ nk enk
0

has a logistic distribution with mean xnk Î² k and unit scale parameter, for which the cdf is
Pr (Î¾ nk â‰¤ z) =

1
.
0
1 + exp xnk Î² k âˆ’ z

Thus, as in Holmes and Held (2006), we have that

Pr (Î¾ nk > 0) =

 0

exp xnk Î² k
0

1 + exp xnk Î² k

3

.

This approach stands in contrast with the typical notion of a â€œregionâ€. Government agencies (BEA, Bureau of
Labor Statistics, Census, etc.) define their regions such that any state can be a member of only one region. Empirical
studies (e.g., Crone, 2005) make a similar exclusivity restriction.

5


 0
In other words, if we thought of nature as having generated Î¾ nk from a N xnk Î² k , Î»nk distribution
where Î»nk = 4Ïˆ 2nk for Ïˆ nk âˆ¼ KS, and then selected hnk to be unity if Î¾ nk > 0, that is equivalent
to claiming that the value of hnk was generated according to the probability specified in (2).

3

Bayesian posterior inference.

The task of data analysis is to draw a Bayesian posterior inference about the values of both
population parameters and the unobserved latent variables.

We divide these unknown objects

into several categories. The set Î¸ = {Âµ0 , Âµ1 , â„¦} characterizes the growth rates for each state in
recession and expansion and the standard deviation Ïƒ n of employment growth rates for state n
around those means.

The (K Ã— K) matrix P contains the transition probabilities for regimes,

with row i, column j element
pji = p (zt = j|ztâˆ’1 = i) ,
where as in Hamilton (1994, p. 679) each column of P sums to unity.
There are also two groups of unobserved latent variables. The (T Ã— 1) vector z = (z1 , ..., zT )0
summarizes which clusters are in recession at each date, while h = {h1 , ..., hÎº } summarizes the
cluster affiliation of each state where hk = (h1k , ..., hN k )0 denotes the (N Ã— 1) vector characterizing
which states participate in cluster k. There are also three other sets of variables and parameters
associated with that realization of h. Let Î¾ k = (Î¾ 1k , ..., Î¾ N k )0 and Î»k = (Î»1k , ..., Î»N k )0 denote the
associated auxiliary variables [see Tanner and Wong (1987)] that are viewed as having determined
hk according to:
hnk =

ï£±
ï£´
ï£² 1 if Î¾ > 0
nk

,

(4)

ï£´
ï£³ 0 otherwise

 0
Î¾ nk |Î² k , Î»nk âˆ¼ N xnk Î² k , Î»nk ,

(5)

Î»nk = 4Ïˆ/2nk ,
Ïˆ nk âˆ¼ KS.
Collect all the latent variables associated with the cluster affiliations in a set H = {h, Î¾, Î»}, where
Î¾ = {Î¾ 1 , ..., Î¾ Îº } and Î» = {Î»1 , ..., Î»Îº }, while Î² = {Î² 1 , ..., Î² Îº } denotes the set of all the logistic
6

coefficient vectors.

3.1

Priors.

Recall that a positive scalar x is said to have a Î“ (Î±, Î²) distribution if its density is

p(x) =

ï£±
ï£´
ï£² [Î² Î± /Î“ (Î±)] xÎ±âˆ’1 eâˆ’Î²x
0

ï£´
ï£³

for x > 0

.

(6)

otherwise

We adopt a Î“ (Î½/2, Î´/2) prior for Ïƒ âˆ’2
n :


p Ïƒ âˆ’2
âˆ Ïƒ âˆ’Î½+2
exp âˆ’Î´Ïƒ âˆ’2
n
n
n /2 .

(7)

We use a N (m, Ïƒ 2 M) prior for Âµn = (Âµn0 , Âµn1 )0 :
p (Âµn |Ïƒ n ) âˆ Ïƒ 2n M

âˆ’1/2

n
o

âˆ’1
exp âˆ’ (Âµn âˆ’ m)0 Ïƒ 2n M
(Âµn âˆ’ m) /2 .

(8)

With independent priors across states, we then have

p (Î¸) =

N
Y


p (Âµn |Ïƒ n ) p Ïƒ âˆ’2
.
n

n=1

We model transition probabilities using a Dirichlet prior. Recall that for w = (w1 , ..., wm )0 with
P
wi âˆˆ [0, 1] and m
i=1 wi = 1, we say that w has a Dirichlet distribution with parameter vector Î±,
denoted w âˆ¼ D (Î±), if the joint density of {w1 , ..., wmâˆ’1 } is given by

p (w1 , ..., wmâˆ’1 ) =

Î“ (Î±1 + Â· Â· Â· + Î±m ) Î±1 âˆ’1
Î±m âˆ’1
w
Â· Â· Â· wm
.
Î“ (Î±1 ) Â· Â· Â· Î“ (Î±m ) 1

We adopt the diffuse Dirichlet prior (D (0)) for each column of P:
âˆ’1
p (P) âˆ pâˆ’1
11 Â· Â· Â· pKK .

7

Our prior distribution for Î² k is characterized by independent Normal distributions,

Î² k âˆ¼ N (bk , Bk )

for k = 1, ..., Îº,

(9)

with p (Î²) the product of (9) over k = 1, ..., Îº. Then,

p (H, Î²) = p (H|Î²) p (Î²) ,

where p (H|Î²) is the product of (3) through (5) over k = 1, ..., Îº and n = 1, ..., N .
Numerical values for the prior parameters are summarized in Table 1. Our prior expectation
is that the average employment growth rate in an expansion (reported at an annual rate) would be
+1%, and likely between -1% and +3%, while average employment growth in a recession would be
between -3% and +1%. The prior mean for Î² kj implies that variable xnj has no effect on whether
state n is included in cluster k, and the prior distribution regards the variable as equally likely to
increase or decrease the probability of state nâ€™s inclusion in the cluster. The explanatory variables
xn are normalized to have unit mean, so that if the first element of Î² k is unity (a high value for
its prior range) and others are at zero, a state for which xn is at the average value for all states
would be included in cluster k with probability e/(1 + e) = 0.73; a low value (âˆ’1) would imply an
unconditional probability of eâˆ’1 /(1 + eâˆ’1 ) = 0.27. Diffuse priors were used for Ïƒ âˆ’2
n and P.

3.2

Joint distribution.

Let Y denote the (T Ã— N ) matrix consisting of the observed growth rates for all states at all dates,
where T is the length of the time series. The joint density-distribution for data, parameters, and
latent variables for the logistic clustering formulation is given by

p (Y, Î¸, P, z, H, Î²) = p (Y|Î¸, P, z, H, Î²) p (z|Î¸, P, H, Î²) p (Î¸|P,H, Î²) p (P|H, Î²) p (H, Î²)
= p (Y|Î¸, z, h) p (z|P) p (Î¸) p (P) p (H, Î²) .

(10)

Note that Î¾ and Î» affect the likelihood only through the value of h and are only relevant as auxiliary
parameters to facilitate generation of posterior values of Î².

8

Specifically, one can integrate (10)

over all possible values of Î¾ and Î» to obtain
Z
p (Y, Î¸, P, z, h, Î²) =

p (Y|Î¸, z, h) p (z|P) p (Î¸) p (P) p (H, Î²) dÎ¾ dÎ»
Z
= p (Y|Î¸, z, h) p (z|P) p (Î¸) p (P) p (H, Î²) dÎ¾ dÎ»
= p (Y|Î¸, z, h) p (z|P) p (Î¸) p (P) p (h|Î²) p (Î²) ,

(11)

where p (h|Î²) is the product of (2) over k = 1, ..., Îº and n = 1, ..., N .
The conditional likelihood p (Y|Î¸, z, h) can be written as follows. Collect the state n observa0
tions for all dates in a (T Ã— 1) vector Yn = (y1n , ..., yT n )0 and let Î¸ n = Âµn0 , Âµn1 , Ïƒ âˆ’2
. Then,
n

p (Y|Î¸, z, h) =

N
Y

p (Yn |Î¸ n , z, h)

(12)

n=1

p (Yn |Î¸ n , z, h) =

T
Y

p (ytn |Î¸ n , zt , h)

t=1

h
i2 ï£¹
0
âˆ’
y
âˆ’
Âµ
w
(z
,
h)
tn
t
n
ï£¯
ï£º
p (ytn |Î¸ n , zt , h) âˆ Ïƒ âˆ’1
ï£»
n exp ï£°
2
2Ïƒ n
ï£®

w (zt , h) = (1, hn,zt )0 .
The unconditional probabilities for z are given by

p (z|P) = p (z1 )

T
Y

pztâˆ’1 ,zt

t=2

for pztâˆ’1 ,zt the row zt , column ztâˆ’1 element of P. The t = 1 aggregate regime is set to expansion
a priori:
p(z1 ) =

ï£±
ï£´
ï£² 1 for z1 = K

.

ï£´
ï£³ 0 otherwise
The algorithm is initialized with empty clusters and aggregate recessions (zt = K âˆ’ 1) set to match
the NBER recession dates. Regimes for all other time periods are randomized.4
4

Results randomizing the regimes for all time periods were similar but converged more slowly.

9

3.3

Drawing â„¦ given Y,Âµ, P, z, H, Î².

Our general Bayesian inference is via the Gibbs sampler [see Gelfand and Smith (1990); Casella
and George (1992); Carter and Kohn (1994)], in which we will generate a draw for one block of
parameters or latent variables conditional on the others. This subsection discusses generation of
â„¦ conditional on the data Y and on the values for Âµ, P, z, H, and Î² that were, in turn, generated
by the previous step of the iteration. In the next subsection, we will discuss how to draw Âµ given
Y, â„¦, P, z, H, Î². Both distributions can be derived from

p (Î¸|Y, P, z, H, Î²) = R
where the numerator is given by (10) and
sible values for Î¸.

R

p (Î¸, Y, P, z, H, Î²)
,
p (Î¸, Y, P, z, H, Î²) dÎ¸

(13)

[.] dÎ¸ denotes the definite integral over all the pos-

But multiplicative terms not involving Î¸ cancel from the numerator and the

denominator of (13), so that

p (Î¸|Y, P, z, H, Î²) âˆ p (Y|Î¸, z, h) p (Î¸)
=

N
Y

p (Yn |Î¸ n , z, h) p (Î¸ n ) .

n=1

Hence, the Î¸ n given Y, P, z, H, Î² are independent across n with

p (Î¸ n |Y, P, z, H, Î²) âˆ p (Yn |Î¸ n , z, h) p (Î¸ n )
" T
#
X

0
âˆ p (Î¸ n ) Ïƒ âˆ’T
[ytn âˆ’ Âµn w (zt , h)]2 / 2Ïƒ 2n .
n exp âˆ’

(14)

t=1

Substituting (7) into (14) and dividing by the integral over Âµn , we have
h 

i

âˆ’T âˆ’Î½+2
âˆ’2
p Ïƒ âˆ’2
|Y,Âµ,
P,
z,
H
âˆ
Ïƒ
exp
âˆ’
Î´
+
Î´Ì‚
Ïƒ
/2
n
n
n

for Î´Ì‚ =

PT

t=1

h

i2


 
0
ytn âˆ’ Âµn w (zt , h) . Recalling (6), we thus generate Ïƒ âˆ’2
from
a
Î“
(Î½
+
T
)
/2,
Î´
+
Î´Ì‚
/2
n

distribution, a standard result as in Kim and Nelson (1999, p. 181).

10

3.4

Drawing Âµ given Y, â„¦, P, z, H, Î².

Using (8) in (14) and this time dividing by the integral over Ïƒ n , we again see, as in Kim and Nelson
(1999, p. 181), that
Âµn |Y, â„¦, P, z, H, Î² âˆ¼ N mâˆ—n , Ïƒ 2n Mâˆ—n



(15)

for
Mâˆ—n = Mâˆ’1 + Cn

âˆ’1

mâˆ—n = Mâˆ—n Mâˆ’1 m + cn
"
Cn =

T
X


#

w (zt , h) w (zt , h)0

t=1

"
cn =

T
X

#
w (zt , h) ytn .

t=1

3.5

Drawing P given Y,Î¸, z, H, Î².

Conditional on H and z, this is again a standard inference problem for a K-state Markov switching
process, as in Chib (1996, p. 84). From (10),

p (P|Y, Î¸, z, H) âˆ p (z|P) p (P) ,

column i of which will be recognized as D(Î±âˆ—i ) distribution, where the jth element of the vector
Î±âˆ—i is given by
Î±âˆ—ij

PT
=

t=2 Î´ (ztâˆ’1 = i, zt =
PT
t=2 Î´ (ztâˆ’1 = i)

j)

,

which is just the fraction of times that regime i is observed to be followed by regime j among the
sequence {z1 , ..., zT }.

3.6

Drawing z given Y,Î¸, P,H, Î².

Here,
p (z|Y, Î¸, P, H, Î²) âˆ p (Y|Î¸, z, h) p (z|P) .
Again as in Chib (1996, p. 83),

11

p (z|Y, Î¸, P, H, Î²) = p (zT |Y, Î¸, P, h)

TY
âˆ’1

p (zt |zt+1 , ..., zT , Y,Î¸, P, h) .

t=1

But zt+1 conveys all the information about zt embodied by future z or y. Thus if Yt = {yÏ„ n : Ï„ â‰¤ t; n = 1, ..., N }
collects observations from all states for all dates through t,

p (z|Y, Î¸, P, H, Î²) = p (zT |YT , Î¸, P, h)

TY
âˆ’1

p (zt |zt+1 , Yt ,Î¸, P, h) .

(16)

t=1

One can calculate p (zt |Yt , Î¸, P, h) by iterating on equation [22.4.5] in Hamilton (1994)5 , the terminal
value of which (t = T ) gives us p (zT |YT , Î¸, P, h), the first term in (16). Furthermore,

p (zt |zt+1 , Yt ,Î¸, P, h) = PK

pzt ,zt+1 p (zt |Yt , Î¸, P, h)

j=1 pj,zt+1 p (zt

= j|Yt , Î¸, P, h)

,

allowing us to generate zT , zT âˆ’1 , ..., z1 sequentially.

3.7

Generating H.


We now define Hk = {hk , Î¾ k , Î»k } and H [k] = hj , Î¾ j , Î»j : j = 1, ..., Îº; j 6= k .

Our strategy will

be to generate the elements associated with cluster k (denoted Hk ) conditional on all the elements
of all the other clusters (denoted H [k] ). We will, in turn, break down the generation of Hk given
Y, H [k] , Î¸, P, z, Î² into a series of steps, first generating hk , then Î¾ k conditional on hk , and finally
Î»k conditional on hk and Î»k , all conditioning on H [k] .
3.7.1

Drawing hk given Y, H [k] , Î¸, P, z, Î².

From (11),


p hk |Y, H [k] , Î¸, P, z, Î²
âˆ p (Y|Î¸, z, h) p (hk |Î² k )
=

N


Y
p Yn |hnk , h[k] , Î¸, z p (hnk |Î² k ) .
n=1

5
Here, Î¾t is a (K Ã— 1) vector
zero otherwise, while Î· t is a (K Ã— 1)
Q whose kth element is unity when zt = k and
0
vector whose kth element is N
p(y
|Î¸,
z
=
k,
h),
while
Î¾Ì‚
=
(0,
0,
...,
1)
.
tn
t
0|0
n=1

12

In other words, we can generate hnk for n = 1, ..., N independently across states from


Pr hnk


p Yn |hnk = 1, h[k] , Î¸, z Pr (hnk = 1|Î² k )
= 1|Y, h , Î¸, P, z, Î² = P1
,

[k]
j=0 p Yn |hnk = j, h , Î¸, z Pr (hnk = j|Î² k )

where
Pr(hnk

3.7.2

[k]



ï£±
h

i
ï£´
ï£² 1/ 1 + exp x0 Î² k
for j = 0
nk
= j|Î² k ) =
.
 0
 h
 0
i
ï£´
ï£³ exp x Î² k / 1 + exp x Î² k
for
j
=
1
nk
nk

Drawing Î¾ k given Y, hk , H [k] , Î¸, P, z, Î².

Here, we have


p Î¾ k |Y, hk , H [k] , Î¸, P, z, Î²
= p (Î¾ k |hk , Î²)
=

N
Y

p (Î¾ nk |hnk , Î² k ) .

n=1

Note that if we had conditioned on Î»nk , then Î¾ nk would have a Normal distribution. However, without that conditioning, we are back to the logistic distribution that motivates the parameterization
in terms of (Î»nk, Î¾ nk ). Holmes and Held (2006) argued that generating Î¾ nk from the unconditional
distribution and then generating Î»nk conditional on Î¾ nk will give the algorithm better convergence
0

properties. For the posterior distribution given hnk , we know that Î¾ nk is logistic with mean xnk Î² k
and truncated by Î¾ nk â‰¥ 0 if hnk = 1 and Î¾ nk < 0 if hnk = 0. Recall that if u âˆ¼ U [0, 1], then

Î¾ = A âˆ’ log uâˆ’1 âˆ’ 1 has a logistic distribution with mean E (Î¾) = A.6 Furthermore, Î¾ â‰¥ 0 iff
u â‰¥ 1/ (1 + exp (A)). In other words, we want to generate u from a uniform distribution over the
interval [0, 1/ (1 + exp (A))] when hnk = 0 and u âˆ¼ U [1/ (1 + exp (A)) , 1] when hnk = 1.
finally that if uâˆ— âˆ¼ U [0, 1], then a + (b âˆ’ a) uâˆ— âˆ¼ U [a, b].
6

Thus, we generate uâˆ—nk âˆ¼ U [0, 1] and

This claim may be verified directly as follows:
Pr(Î¾ â‰¤ z)

=
=
=
=
=

Ë†
Ëœ
Pr A âˆ’ log(uâˆ’1 âˆ’ 1) â‰¤ z
Ë†
Ëœ
Pr log(uâˆ’1 âˆ’ 1) â‰¥ A âˆ’ z
Ë† âˆ’1
Ëœ
Pr u â‰¥ 1 + exp(A âˆ’ z)
â€“
Â»
1
Pr u â‰¤
1 + exp(A âˆ’ z)
1
,
1 + exp(A âˆ’ z)

which will be recognized as the cdf of a logistic variable with mean A.

13

Note

define
unk =

ï£±
ï£´
ï£´
ï£²
ï£´
ï£´
ï£³

1
uâˆ—
0
1+exp(xnk Î² k ) nk
1
0
1+exp(xnk Î² k )

+

if hnk = 0
.

â€œ 0
â€
exp xnk Î² k
0
xnk Î² k

1+exp(

)

uâˆ—nk if hnk = 1


0
Then, Î¾ nk = xnk Î² k âˆ’ log uâˆ’1
nk âˆ’ 1 .
3.7.3

Drawing Î»k given Y, Î¾ k , hk , H [k] , Î¸, P, z, Î².

Now,


p Î»k |Y, Î¾ k , hk , H [k] , Î¸, P, z, Î²
= p (Î»k |Î¾ k , Î² k )
âˆ p (Î¾ k |Î»k , Î² k ) p (Î»k )
=

N
Y

p (Î¾ nk |Î»nk , Î² k ) p (Î»nk ) .

n=1


2
0
2 = Î¾
âˆ’
x
Î²
and use as a proposal density
Again, as in Holmes and Held (2006), we set rnk
nk
nk k
a Generalized Inverse Gaussian density,


Î»Ì‚nk âˆ¼ GIG 1/2, 1, r2 ,

for which a draw can be generated as follows. Generate wnk the square of a standard Normal and
set
vnk = 1 +

wnk âˆ’

p
wnk (4r + Y )
.
2r

Generate a separate uÌ‚nk âˆ¼ U [0, 1], and set

Î»Ì‚nk =

ï£±
ï£´
ï£² r/vnk if uÌ‚nk â‰¤ 1/ (1 + vnk )
ï£´
ï£³ rvnk

.

otherwise

We then decide to accept Î»Ì‚nk (or else repeat the above steps) using the algorithm described by
Holmes and Held (2006, p. 165).

14

3.8

Drawing Î² given Y, Î¸, P, z, H.

Notice
p (Î²|Y, Î¸, P, z, H) =

Îº
Y

p (Î² k |Î¾ k , Î»k ) ,

k=1

which is just a standard Normal regression model for each Î² k of the form

Î¾ k = Xk Î² k + Îµk ,
ï£®
ï£¯
ï£¯
=ï£¯
ï£¯
(N Ã—Pk )
ï£°
Xk

0

ï£¹

0

ï£º
ï£º
ï£º,
ï£º
ï£»

x1k
..
.
xN k

Îµk âˆ¼ N (0, Wk ) ,
Wk
(N Ã—N )

= diag [Î»1k , ..., Î»N k ] .

Thus,
Î² k |Y, Î¸, P, z, H âˆ¼ N (bâˆ—k , Bâˆ—k ) ,
where
âˆ’1


0
âˆ’1
âˆ’1
0
X
Bâˆ’1
+
X
W
bâˆ—k = Bâˆ’1
k
k
k bk + Xk Wk Î¾ k
k
k
and
âˆ’1
0
Bâˆ—k = Bâˆ’1
k + Xk Wk Xk

3.9

âˆ’1

.

Label switching.

The model described above is unidentified in two respects. First, if we were to switch the values
of Âµ0 with Âµ1 , and correspondingly switch the last two columns and then the last two rows of P,
the likelihood function would be unchanged.

Likewise, switching the definition of clusters (e.g.,

switching h1 with h2 and switching the first two columns and first two rows of P), the likelihood
function would be unchanged.
The first is a familiar issue in the literature, and we deal with it in a typical way, by normalizing
Âµn1 â‰¤ 0. We implement this by rejecting any generated Âµn that does not satisfy the restriction

15

and redrawing from (15) until obtaining a draw that satisfies the normalization restriction.
The second issue is unique to our clustering approach. We mitigate this in part by imposing
the restriction that the process cannot transition from one idiosyncratic regime to another, that
is, imposing pij = 0 if i and j are both less than K âˆ’ 1 and if i 6= j.

We are thus ruling out

transitions in which recession for a subset of states is followed by those states going out of recession
and a different set of states going into recession. We find that once these restrictions are imposed,
for this data set, the posterior distribution is sufficiently tightly concentrated in the vicinity of a
given representation that a given Monte Carlo Markov chain does not jump across to an alternative
representation. However, different starting values can converge to different representations of the
same system.

3.10

Cross-validation.

Our next objective is to choose the number of clusters. For this, we utilize cross validation [see
Picard and Cook (1984); Gelfand, Dey, and Chang (1992); Shao (1993); and Bernardo and Smith
(1994)], which computes a quasi-out-of-sample score by estimating the model with a subset of data
and validating with the omitted data, and has been adapted for similar econometric models [e.g.,
Geweke and Keane (2007)]. We described above an algorithm to generate a draw for {ZT , Î¸, P,h}
conditional on the full data set YT . We now partition the data YT into R blocks,7

YT =


Y1 Y2 Â· Â· Â·

YR

for

Yr =


ytr

ytr +1 Â· Â· Â·

ytr+1 âˆ’1

,

and let Y (r) denote the full set of observations with block Yr deleted:

Y

(r)




=

Y1 Â· Â· Â·

Yrâˆ’1 Yr+1 Â· Â· Â·

7

YR

.

The method used here is sometimes described as R-fold cross validation where R is the number of subsamples
over which validation is computed.

16

Likewise define Z (r) to be a matrix of realizations for ZT with block r deleted:

Z



(r)

=


Z1 Â· Â· Â·

Zrâˆ’1 Zr+1 Â· Â· Â·

ZR

.

We propose to use the principle of cross-validation see how well a particular model that was based
on data Y (r) predicts the observed value of Yr using an entropy-based loss function. Specifically,
we will first generate a series of draws for {Z (r) , Î¸, P,h} from the posterior distribution conditional
on only Y (r) , implemented by running our basic procedure on the subset of data that omits block r
as if the only data available were that contained in Y (r) . Let {Z [r,m] , Î¸[r,m] , P[r,m] ,h[r,m] } denote a
particular draw from this posterior distribution. We will then generate a draw from the distribution
[r,m]

of {Zr } conditional on {Z [r,m] , Î¸[r,m] , P[r,m] ,h[r,m] , Y (r) }. Let zt

denote the value so generated

for observation t, which implies a forecast mz [r,m] for the value of yt . We will judge a model to be
t

superior when

M

âˆ’1

M X
R tr+1
X
Xâˆ’1 

[r,m]

log â„¦



+ yt âˆ’ mz [r,m]

0 

[r,m]

â„¦

âˆ’1 

(17)

t

t

m=1 r=1 t=tr

yt âˆ’ mz [r,m]



is smaller.
[r,m]

The necessary step for this process is to generate values for zt

. Note first that the values

for Z [r,m] and P[r,m] are the only relevant conditioning information:

p(Zr |Z [r,m] , Î¸[r,m] , P[r,m] ,h[r,m] , Y (r) ) = p(Zr |Z [r,m] , P[r,m] ).

Consider first generation for the last block (r = R).
[r,m]

{zt }, this is trivially accomplished by setting zt
[r,m]

t = tR , tR+1 , ..., T, where pij

From the Markov chain property of

= k with probability p

[r,m]
[r,m]

ztâˆ’1 ,k

sequentially for

denotes the transition probability for a transition from ztâˆ’1 = i to
[r,m]

zt = j associated with the draw m from the posterior distribution given Y (r) and ztâˆ’1 denotes
[r,m]

the previously generated value. This iteration begins for t = tR by setting ztR âˆ’1 to the draw r, m
value for ztR âˆ’1 .
Consider next generation for the first block (r = 1). Here, we make use of the reverse transition
probabilities
[r,m]

qij

= Pr(zt = i|zt+1 = j, P[r,m] ),
17

which can be calculated from the following considerations:
Pr(zt = i, zt+1 = j)
Pr(zt+1 = j)
Pr(zt = i) Pr(zt+1 = j|zt = i)
Pr(zt+1 = j)
Ï€ i pij
Ï€j

Pr(zt = i|zt+1 = j) =
=
=

for pij the forward transition probabilities and Ï€ i the ergodic probabilities.

The latter can be

calculated as in Hamilton (1994, eq. [22.2.26]):
ï£®
ï£¯
ï£¯
ï£¯
ï£¯
ï£°

ï£¹
Ï€1
..
.

ï£º
ï£º
ï£º = (A0 A)âˆ’1 A0 eK+1
ï£º
ï£»

Ï€K

ï£®

ï£¹

ï£¯ IK âˆ’ P ï£º
A =ï£°
ï£»
10
for 1 a (K Ã— 1) vector of ones and eK+1 a (K + 1) Ã— 1 vector whose K + 1 element is unity and
others are all zero. Thus,
[r,m]
qij

[1,m]

We thus generate zt

=

= k with probability q

[r,m] [r,m]
pij
.
[r,m]
Ï€j

Ï€i

[1,m]
[r,1]

k,zt+1

sequentially backwards for t = t2 âˆ’1, t2 âˆ’2, ..., 1.

We can generate zâ€™s for the middle blocks r = 2, ..., R âˆ’ 1 adapting the approach in Hamilton
(1994, p. 701). For t = tr , tr + 1, ...., tr+1 , let
[r,m]

pÌƒk,t

[r,m]

= Pr(zt = k|Z1
[r,m]

and collect these scalars in the vector Î¾Ìƒ t

=



[r,m]

, ..., Zrâˆ’1 , P[r,m] )

[r,m]

[r,m]


[r,m] 0

pÌƒ1,t , pÌƒ2,t , ..., pÌƒK,t

.

This can be calculated

recursively from
[r,m]

Î¾Ìƒ t

[r,m]

= P[r,m] Î¾Ìƒ tâˆ’1

[r,m]

[r,m]

for t = tr , tr + 1, ..., tr+1 starting from Î¾Ìƒ tr âˆ’1 the (K Ã— 1) vector whose element in position ztr âˆ’1

is unity and all other elements are zero, and where P[r,m] is the matrix of transition probabilities
18

(arranged so that columns sum to unity).

n
o
[r,m]
[r,m]
Let S [r,m] = Z1 , ..., Zrâˆ’1 , P[r,m] and notice next

that for any t âˆˆ {tr , ..., tr+1 âˆ’ 1},
Pr(zt = j|zt+1 = i, S [r,m] ) =

Pr(zt = j, zt+1 = i|S [r,m] )
Pr(zt+1 = i|S [r,m] )
[r,m] [r,m]

=

pÌƒj,t pji
pÌƒi,t+1

from which

[r,m] [r,m]

[r,m]

Pr(zt = j|Z1

[r,m]

[r,m]

[r,m]

, ..., Zrâˆ’1 , Zr+1 , ..., ZR

, P[r,m] } =

pÌƒj,t pji

pÌƒz [r,m] ,t+1

.

t+1

[r,m]

We can thus generate a value for ztr+1 âˆ’1 from the above equation for t = tr+1 âˆ’ 1 given the known
[r,m]

value ztr+1 and can generate the values for t = tr+1 âˆ’ 2, tr+1 âˆ’ 3, ..., tr recursively by iterating on
the equation backwards.

4

Empirical results.

The data used to measure state-level business cycles are the seasonally adjusted, annualized quarterto-quarter growth rates of payroll employment.8,9 The sample period is 1956:Q2 to 2007:Q4; Alaska
and Hawaii are excluded. These data were obtained from the Bureau of Labor Statistics (BLS).
In addition to the time series data, the model in the preceding section requires a set of state-level
covariates characterizing the ex ante likelihood of membership in a given cluster. We report results
for a specification with Pk = 4 covariates used to explain the cluster affiliations of each state, with
the same vector of explanatory variables used for each cluster (xnk = xn for k = 1, ..., Îº).

The

vector xn includes barrels of oil produced per 100 dollars of state GDP, manufacturing employment
share, financial activities employment share, and the share of total state employment accounted for
by small firms.10 We normalize each variable by dividing by the sample mean. Values for these
8

The measure most synonymous with GDP at the state level is Gross State Product (GSP). Unfortunately, GSP
is available only at an annual frequency and at a two-year lag, making it nonviable for a study of business cycles.
9
Even at the quarterly frequency, the growth rate in state-level employment can experience large swings caused
by idiosyncratic state experiences (for example, mining strikes in West Virginia). To focus on the estimation of the
business cycle, we check for outliers defined as observations more than three standard deviations from each seriesâ€™
mean. We then set these values at two standard deviations from the series mean.
10
The oil share was calculated as 100 times the number of barrels of crude oil produced in the state in 1984 (from the
Energy Information Administration, http://tonto.eia.doe.gov/dnav/pet/pet crd crpdn adc mbbl m.htm) divided by
1984 state personal income (from the Census Bureau, http://www.census.gov/compendia/statab/tables/08s0658.xls).
The manufacturing and financial activities shares of employment by state were calculated as the average of the annual

19

explanatory variables are displayed in Figure 1.
We report results for some of the parameters and unobserved latent variables of interest based
on the five pooled runs of 25,000 Gibbs sampler iterations, having discarded an initial burn-in of
250,000 iterations each.

Table 2 displays the cross validation results using R = 10 subsamples

for various values of k, the number of idiosyncratic clusters.

Cross validation chooses Îº = 3

idiosyncratic clusters with Îº = 4 being the second closest alternative.

We also calculated the

comparable cross-validation measure when a single-equation Markov-switching model is estimated
separately for each state.11 Note that the latter specification estimates 96 separate regime transition probabilities (pn,11 and pn,22 for n = 1, 2, ..., 48), whereas the cluster specification requires
only 2(Îº + 1) + Îº(Îº âˆ’ 1) transition probabilities â€“ for example, 14 parameters for our favored case
of Îº = 3.

Although the cluster specification is much less richly parameterized, its substantially

better fit reflects the feature in the data that knowing whether state n is in recession at date t is
extremely helpful for predicting whether state ` will be in recession at date t + 1.
Table 3 shows the posterior medians and means for the model parameters Âµ0 , Âµ1 , and Ïƒ 2
for each state.

Table 4 gives the posterior means of the logistic coefficients Î² k associated with

each of the idiosyncratic clusters (k = 1, ..., 3), with a bold entry signifying that 68 percent of the
posterior draws were on the same side of zero as the reported posterior mean. We also translate
these coefficients into discrete derivatives (denoted Î´ k ). The ith element of Î´ k has the following
P
interpretation. Let xi = N âˆ’1 N
n=1 xin denote the average value for the ith explanatory variable.
Suppose we compare two states, each of which has xjn = xj for all j 6= i, but in the first state,
characteristic i is one standard deviation below the average xi , and in the other state, characteristic
i is one standard deviation above the average. How would the probability of inclusion in cluster
k, as calculated from (2), differ between the two states?

The value for this magnitude implied

by the posterior mean for Î² k is reported as the ith element of the vector Î´ k in Table 4.

For

example, a state that was average in all respects but one standard deviation below average in the
importance of oil production would be rather unlikely to be included in cluster 1, whereas a state
one standard deviation above the average would be quite likely to be included. An important role
industry (NAICS) shares of total payroll employment from 1990-2006, also from the BLS. The share of small firms
was computed as an average of the share of total employment in firms with fewer than 100 employees and was taken
from the Statistics of U.S. Businesses data set.
11
For the standard Markov-switching model, the cross validation is taken as the sum of (17) over all 48 states.

20

for manufacturing or finance makes a state less likely to be part of this cluster.

States with an

important role for finance were less likely to be part of cluster 2 and more likely to be included in
cluster 3.
Table 5 reports posterior means of the regime transition probabilities pij .

Starting with the

first column, suppose that zt = 1 in quarter t, which would mean that only those states that are
included in cluster 1 would be in recession. We have ruled out a priori the possibility that these
states go out of recession and a new different subset of states begins a recession at t + 1 (that is,
we imposed p12 = p13 = 0). Although we did not impose p14 = 0, the posterior mean of p14 , in fact,
turns out to be quite close to zero. Thus, if the states in cluster 1 go into recession, a national
recession is unlikely. Moreover, the cluster 1 recession is relatively persistent, lasting an average of
3.2 quarters. By contrast, if the states in cluster 2 are in recession (i.e., zt = 2), we see a national
recession eventually arrive, usually within two and a half quarters (p24 = 0.40, p25 = 0). Similarly,
the regime zt = 3 would be characterized as the subset of states that have extended recessions.
The regime zt = 3 can be entered either through expansion or recession and typically signals a
forthcoming national recession.
Figure 2 plots the posterior means for the regime probabilities given the data. The top panel
is calculated as the fraction out of the 125,000 simulations for which zt for the indicated quarter is
equal to 4 â€“ that is, it shows the posterior probability of a national recession. These correspond
fairly closely to the traditional NBER dates, which are indicated by shaded regions in the top
panel, with the exception of a few short downturns (no longer than one quarter) based on state
employment data that are not characterized by the NBER as a national recession.

Also, our

framework would date both the 1990-91 and 2001 recessions as substantially longer based on state
employment growth than the traditional NBER dates specify.12 Interestingly, the recession that
the NBER dates as 2007:Q4-2009:Q2 was recognized by this algorithm as beginning in 2007:Q2,
and this assessment was made using data only through 2007:Q4. The approach thus provided an
earlier signal of the most recent downturn than was provided by most other approaches at the time.
The shaded regions in the bottom three panels of Figure 2 are based on the zt = 4 dates (when
Pr(zt = 4) > 0.99) rather than the NBER dates, to clarify the nature of the estimated dynamics.
12

This result is consistent with the so-called jobless recovery periods [see Koenders and Rogerson (2005) for a
survey].

21

The cluster 1 states experienced a uniquely idiosyncratic recession during the oil price collapse in
the mid-1980s, as well as several briefer episodes in the 1950s and 1960s. The recession of 1957-58
was preceded by a downturn in the cluster 2 states, and there is also some possibility that the
recessions of 1980 and 2001 began in these states.

By contrast, a downturn in cluster 3 states

preceded the national downturns in 1973-75, 1990-91, and 2007-09, suggesting a possible role of
financial factors in precipitating those recessions.

Cluster 3 was also slow to recover from the

1990-91 recession.
Figure 3 indicates which states are affected by the respective idiosyncratic regimes and conveys
some idea of the role played by the exogenous state characteristics xn and observed employment
growth rates Y in associating states with particular clusters. The first column of Figure 3 summarizes the inference we would draw if we knew nothing about the state other than the state
characteristics xn and the likely values for Î² k as inferred from the employment data; that is, it
reports for each state n and cluster k the value of
Z

0

exp(xn Î² k )
f (Î² k |Y).
1 + exp(x0n Î² k )

The second column of Figure 3 reports the posterior probability of cluster designations given all
the observed data:
p(hnk = 1|Y).

The information based on state characteristics alone â€“ specifically, the importance of oil for the
state â€“ gives a fairly sharp designation for the states included in cluster 1 (see row 1, column 1
of Figure 3).

The first and second columns of the first row of Figure 3 have much in common.

However, this appears to be because the particular pattern for the employment behavior of states
in this cluster is so closely aligned with the importance of oil production for the state. A cluster
designation similar to what we see in the first row of Figure 3 has emerged from virtually all
of the specifications we have studied.

Specifically, we also estimated a version of the model

with no explanatory variables at all and found a similar grouping of states that experienced their
own separate recession in the mid-1980s. For that matter, we found the same pattern when we

22

estimated models separately for each state in isolation.

The conclusion that the oil-producing

states experienced their own recession at the time of the oil price collapse appears to be fairly
robust.
For cluster 2, the information content in the prior based on the state characteristics is not as
sharp. A priori, states belonging to cluster 2 appear to be those not belonging to the oil-producing
cluster. The observed employment growth rates refine and sharpen these designations considerably
(row 2, column 2).

Based on both information from the prior and the state-level employment

data, the cluster appears to include primarily the manufacturing states in the southeast, Indiana,
Michigan, and a few scattered states around the Pacific Northwest and Maine.
Based on state-level characteristics, cluster 3 appears a priori likely to consist of states with a
higher employment share in financial industries but without a high component of oil production
(row 3, column 1). Again, the business cycle data refine these designations. The posterior cluster
probabilities for cluster 3 place high likelihood on including a number of states on the East Coast
with the addition of California and Arizona.
Results for Îº = 4 clusters have a similar character, with one cluster capturing the mid-1980s
recession in the oil-producing states, and the other three clusters characterized by groups of states
that go into recession a little earlier or come out of recession a little later than other states.

It

is interesting that this feature â€“ i.e., that recessions tend to be a national phenomenon, with
idiosyncrasies manifest in the timing of when they start or stop in each state â€“ is a broad finding
from different specifications of our approach. This suggests that although different recessions may
have different original causes, the key defining characteristic may be their breadthâ€“ what makes an
episode a recession is the fact that everybody is experiencing problems at about the same time.

5

Conclusion

Two broad conclusions emerge from our results.
across recessions.

First, we have found substantial heterogeneity

Different recessions seemed to begin in different ways.

In distinct episodes,

different parts of the country could have manifested the first signs of a downturn, and the oil and
agricultural states have on occasion experienced a recession while the rest of the country appears
to be doing fine. Based on the geographic patterns, recessions are not all alike, but appear to differ

23

in their causes and propagation.
On the other hand, we were surprised that, despite this clear heterogeneity, there nevertheless
appears to be a strong national component to most recessions. Although our framework allowed
for the possibility of groups of states at times moving in complete isolation of the rest of the nation,
we find such behavior to be the exception rather than the rule. The primary differences we find
across states come down to timing â€“ when did the recession begin and end for that state â€“ and
not whether the state was able to avoid a national downturn altogether. This suggests to us that
although recessions are different in terms of their causes, there is something similar about the event
itself.

We would propose that a salient characteristic of a recession is the comovement across

states and the eventual tendency for the entire nation or at least a very large region to experience
contraction at the same time.

24

References
[1] Andrews, D.F. and Mallows, C.L. â€œScale Mixtures of Normal Distributions.â€ Journal of the
Royal Statistical Society: Series B, 1974, 36(1), pp. 99-102.
[2] Bernardo, JoseÌ M. and Smith, Adrian F. M. Bayesian Theory. Chichester: Wiley, 1994.
[3] Burns, Arthur F. and Mitchell, Wesley C. Measuring Business Cycles. New York: National
Bureau of Economic Research, 1946.
[4] Carlino, Gerald and DeFina, Robert. â€œThe Differential Regional Effects of Monetary Policy.â€
Review of Economics and Statistics, November 1998, 80(4), pp. 572-587.
[5] Carlino, Gerald A. and DeFina, Robert H. â€œHow Strong Is Co-movement in Employment over
the Business Cycle? Evidence from State/Sector Data.â€ Journal of Urban Economics, March
2004, 55(2), pp. 298-315.
[6] Carlino, Gerald and Sill, Keith. â€œRegional Income Fluctuations: Common Trends and Common
Cycles.â€ Review of Economics and Statistics, August 2001, 83(3), pp. 446-456.
[7] Carter, C.K. and Kohn, R. â€œOn Gibbs Sampling for State Space Models.â€ Biometrika, August
1994, 81(3), pp. 541-553.
[8] Casella, George and George, Edward I. â€œExplaining the Gibbs Sampler.â€ American Statistician, August 1992, 46(3), pp. 167-174.
[9] Chib, Siddhartha. â€œCalculating Posterior Distributions and Modal Estimates in Markov Mixture Models.â€ Journal of Econometrics, November 1996, 75(1), pp. 79-97.
[10] Crone, Theodore M. â€œAn Alternative Definition of Economic Regions in the United States
Based on Similarities in State Business Cycles.â€ Review of Economics and Statistics, November
2005, 87(4), pp. 617-626.
[11] Del Negro, Marco. â€œAsymmetric Shocks among U.S. States.â€ Journal of International Economics, March 2002, 56(2), pp. 273-297.
[12] Devroye, Luc. Non-Uniform Random Variate Generation. New York: Springer-Verlag, 1986.
[13] Forni, Mario and Reichlin, Lucrezia. â€œFederal Policies and Local Economies: Europe and the
US.â€ European Economic Review, January 2001, 45(1), pp. 109-134.
[14] FruÌˆhwirth-Schnatter, Sylvia and Kaufmann, Sylvia. â€œModel-Based Clustering of Multiple
Times Series.â€ Journal of Business and Economic Statistics, January 2008, 26(1), pp. 78-89.
[15] Gelfand, Alan E.; Dey, Dipak K.; and Chang, Hong. â€œModel Determination Using Predictive
Distributions with Implementation via Sampling-Based Methods.â€ J.M. Bernardo, J.O. Berger,
A.P. Dawid and A.F.M. Smith (eds.), Bayesian Statistics 4. Oxford: Oxford University Press,
1992.

25

[16] Gelfand, Alan E. and Smith, Adrian F.M. â€œSampling-Based Approaches to Calculating
Marginal Densities.â€ Journal of the American Statistical Association, June 1990, 85(410), pp.
398-409.
[17] Geweke, John and Keane, Michael. â€œSmoothly Mixing Regressionsâ€ Journal of Econometrics,
May 2007, 138(1), pp. 252-291
[18] Hamilton, James D. â€œA New Approach to the Economic Analysis of Nonstationary Time Series
and the Business Cycle.â€ Econometrica, March 1989, 57(2), pp. 357-384.
[19] Hamilton, James D. Time Series Analysis. Princeton, NJ: Princeton University Press, 1994.
[20] Hamilton, James D. â€œWhatâ€™s Real About the Business Cycle?â€ Federal Reserve Bank of St.
Louis Review, July/August 2005, 87(4), pp. 435-452.
[21] Holmes, Chris C. and Held, Leonhard. â€œBayesian Auxiliary Variable Models for Binary and
Multinomial Regression.â€ Bayesian Analysis, 2006, 1(1), pp. 145-168.
[22] Kaufmann, Sylvia. â€œDating and Forecasting Turning Points by Bayesian Clustering with Dynamic Structure: A Suggestion with an Application to Austrian Data.â€ Journal of Applied
Econometrics, March 2010, 25(2), pp. 309-344.
[23] Kim, Chang-Jin and Nelson, Charles R. State-Space Models with Regime Switching. Cambridge,
MA: The MIT Press, 1999.
[24] Koenders, Kathryn and Rogerson, Richard. â€œOrganizational Dynamics over the Business Cycle:
A View on Jobless Recoveries.â€ Federal Reserve Bank of St. Louis Review, July/August 2005,
87(4), pp. 555-579.
[25] Kouparitsas, Michael A. â€œIs the United States an Optimal Currency Area?â€ Chicago Fed Letter,
October 1999, No. 146, pp. 1-3.
[26] Owyang, Michael T.; Piger, Jeremy; and Wall, Howard J. â€œBusiness Cycle Phases in U.S.
States.â€ Review of Economics and Statistics, November 2005, 87(4), pp. 604-616.
[27] Owyang, Michael T.; Piger, Jeremy M.; Wall, Howard J.; and Wheeler, Christopher H.
â€œThe Economic Performance of Cities: A Markov-Switching Approach.â€ Journal of Urban
Economics, November 2008, 64(3), pp. 538-550.
[28] Partridge, Mark D. and Rickman, Dan S. â€œRegional Cyclical Asymmetries in an Optimal
Currency Area: An Analysis Using US State Data.â€ Oxford Economic Papers, July 2005,
57(3), pp. 373-397.
[29] Picard, Richard R. and Cook, R. Dennis. â€œCross-Validation of Regression Models.â€ Journal of
the American Statistical Association, September 1984, 79(387), 575-583.
[30] Shao, Jun. â€œLinear Model Selection by Cross-Validation.â€ Journal of the American Statistical
Association, June 1993, 88(422), pp. 486-494.
[31] Sims, Christopher A.; Waggoner, Daniel F.; and Zha, Tao. â€œMethods for Inference in
Large Multiple-Equation Markov-Switching Models.â€ Journal of Econometrics, October 2008,
146(2), pp. 255-274.

26

[32] Tanner, Martin A. and Wong, Wing Hung. â€œThe Calculation of Posterior Distributions by
Data Augmentation.â€ Journal of the American Statistical Association, June 1987, 82(398),
pp. 528-540.
[33] van Dijk, Bram; Franses, Philip Hans; Paap, Richard; and van Dijk, Dick. â€œModeling Regional
House Prices.â€ Econometric Institute Report EI 2007-55, 2007.

27

Parameter
[Âµ0n , Âµ1n ]0
Ïƒ âˆ’2
n
P
Î²k

Score2

2
2122.4

3
2056.3

Table 1: Priors for Estimation
Prior Distribution
Hyperparameters

2
N m, Ïƒ M
m = [1, âˆ’2]0 ; M = I2

Î½ Î´
Î“ 2, 2
Î½=0; Î´=0
D (Î±)
Î±i = 0
N (b, B)
b = 0p ; B = 12 Ip

Table 2: Cross-Validation Results1
Number of Clusters
4
5
6
7
2071.5 2160.2 2146.3 2167.6

âˆ€n
âˆ€n
âˆ€i
âˆ€k

Markov3
2179.1

1 Cross validation uses 10 subsample splits.
2

Score =

PR Ptr+1 âˆ’1
P
M âˆ’1 M
t=tr
r=1
m=1


log

â„¦[r,m]



+ yt âˆ’ mz [r,m]
t

0

âˆ’1
â„¦[r,m]



yt âˆ’ mz [r,m]
t

3 Markov is the model with independent Markov-switching states [e.g., Owyang, Piger, and Wall (2005)].

28



29

Alabama
Arizona
Arkansas
California
Colorado
Connecticut
Delaware
Florida
Georgia
Idaho
Illinois
Indiana
Iowa
Kansas
Kentucky
Louisiana
Maine
Maryland
Massachusetts
Michigan
Minnesota
Mississippi
Missouri
Montana

Âµ0
2.92
5.88
3.40
3.54
4.20
2.41
3.05
5.06
4.12
3.82
1.93
2.70
2.52
2.68
3.03
2.86
2.67
3.24
2.28
2.35
3.19
3.17
2.38
2.92

Âµ1
âˆ’3.96
âˆ’4.20
âˆ’3.58
âˆ’3.76
âˆ’2.88
âˆ’3.78
âˆ’3.32
âˆ’3.71
âˆ’4.09
âˆ’3.07
âˆ’3.78
âˆ’5.07
âˆ’3.55
âˆ’3.33
âˆ’4.13
âˆ’2.99
âˆ’3.48
âˆ’3.56
âˆ’3.72
âˆ’5.03
âˆ’4.04
âˆ’3.75
âˆ’3.75
âˆ’2.97

Median

4.82
10.21
6.59
4.09
6.84
4.92
10.56
7.18
4.71
9.16
4.11
9.08
4.96
5.93
7.59
10.09
5.78
4.87
4.26
14.24
4.06
6.89
3.72
9.04

Ïƒ2
Âµ0
2.92
5.88
3.40
3.54
4.20
2.41
3.05
5.05
4.12
3.82
1.93
2.70
2.52
2.68
3.03
2.85
2.67
3.24
2.28
2.36
3.19
3.17
2.38
2.91

Âµ1
âˆ’3.96
âˆ’4.20
âˆ’3.58
âˆ’3.76
âˆ’2.89
âˆ’3.78
âˆ’3.32
âˆ’3.71
âˆ’4.09
âˆ’3.08
âˆ’3.79
âˆ’5.08
âˆ’3.56
âˆ’3.33
âˆ’4.14
âˆ’2.99
âˆ’3.47
âˆ’3.56
âˆ’3.72
âˆ’5.07
âˆ’4.04
âˆ’3.75
âˆ’3.76
âˆ’2.98

Mean

4.86
10.28
6.64
4.12
6.89
4.95
10.63
7.23
4.74
9.20
4.14
9.15
5.00
5.96
7.64
10.17
5.82
4.90
4.29
14.30
4.09
6.93
3.75
9.10

Ïƒ2
Nebraska
Nevada
New Hampshire
New Jersey
New Mexico
New York
North Carolina
North Dakota
Ohio
Oklahoma
Oregon
Pennsylvania
Rhode Island
South Carolina
South Dakota
Tennessee
Texas
Utah
Vermont
Virginia
Washington
West Virginia
Wisconsin
Wyoming

Âµ0
2.68
6.17
3.82
2.49
3.55
1.56
3.68
2.83
2.21
3.03
3.71
1.74
2.20
3.59
2.90
3.35
3.90
4.17
3.28
3.74
3.55
1.53
2.83
3.06

Âµ1
âˆ’2.77
âˆ’4.27
âˆ’4.45
âˆ’3.27
âˆ’2.26
âˆ’2.68
âˆ’4.23
âˆ’2.08
âˆ’4.93
âˆ’3.06
âˆ’4.92
âˆ’3.69
âˆ’3.75
âˆ’4.37
âˆ’2.70
âˆ’4.15
âˆ’3.11
âˆ’3.38
âˆ’3.86
âˆ’3.43
âˆ’3.96
âˆ’3.19
âˆ’4.26
âˆ’2.65

Median

3.91
11.49
7.56
3.21
5.89
2.74
4.66
6.92
6.31
6.54
6.03
4.48
7.30
5.71
5.72
5.32
4.45
6.50
5.79
3.45
8.16
11.59
3.79
17.92

Ïƒ2

Table 3: Estimated model coefficients (posterior medians and means)
Âµ0
2.68
6.16
3.82
2.49
3.55
1.56
3.68
2.83
2.21
3.01
3.70
1.74
2.20
3.59
2.92
3.36
3.90
4.18
3.28
3.74
3.56
1.54
2.83
3.06

Âµ1
âˆ’2.78
âˆ’4.27
âˆ’4.45
âˆ’3.27
âˆ’2.26
âˆ’2.68
âˆ’4.23
âˆ’2.07
âˆ’4.94
âˆ’3.06
âˆ’4.92
âˆ’3.69
âˆ’3.74
âˆ’4.38
âˆ’2.69
âˆ’4.16
âˆ’3.12
âˆ’3.37
âˆ’3.86
âˆ’3.43
âˆ’3.96
âˆ’3.19
âˆ’4.27
âˆ’2.64

Mean

Ïƒ2
3.94
11.57
7.61
3.23
5.93
2.75
4.69
6.97
6.36
6.59
6.07
4.51
7.35
5.75
5.74
5.35
4.48
6.54
5.83
3.48
8.21
11.67
3.82
18.03

Table 4: Estimated logistic coefficients and derivatives
(posterior means)
Cluster 1
Cluster 2
Cluster 3
Î²1
Î´1
Î²2
Î´2
Î²3
Î´3
Constant
-0.62
-0.24
-0.02
Oil Production
1.22 0.84 -0.16 -0.17 -1.02
-0.76
Manufacturing
-1.03 -0.11
0.35
0.05 -0.98
-0.11
Finance
-0.61 -0.04 -0.64 -0.06 0.75
0.06
Small Firms
-0.34 -0.02 -0.11 -0.01 -0.09
0.00
Notes: Bold indicates zero is outside the 68 percent coverage interval.
Oil production is measured as the share of income.
Manufacturing and Finance are measured as the industry share of employment.
Small firms are measured as share of employment in firms with < 100 employees.

Table 5: Estimated regime transition probabilities (posterior means)
from
from
from
from
from
Cluster 1
Cluster 2
Cluster 3 Recession
Expansion
to Cluster 1
0.69
0
0
0.03
0.02
to Cluster 2
0
0.60
0
0.00
0.00
to Cluster 3
0
0
0.73
0.03
0.02
to Recession
0.01
0.40
0.24
0.76
0.06
to Expansion
0.29
0.00
0.03
0.18
0.89
NOTES: pij for i = 1, ..., 3 and i 6= j were restricted a priori to be zero (indicated by boldface).

30

Figure 1. Values of explanatory variables for logistic probabilities across states.
Oil
17

Manufacturing
1.7

2

1.3

0.5

1

0.1

0.8

0

0.3

Finance

Small Firm Share
2

1.5

1.15

1.1

1

1

0.85

0.9

0.65

0.8

Figure 2. Posterior Probabilities of aggregate regimes.
National Recession

1.00
0.75
0.50
0.25
0.00
1956

1960

1964

1968

1972

1976

1980

1984

1988

1992

1996

2000

2004

1988

1992

1996

2000

2004

1988

1992

1996

2000

2004

1988

1992

1996

2000

2004

Cluster 1

1.00
0.75
0.50
0.25
0.00
1956

1960

1964

1968

1972

1976

1980

1984

Cluster 2

1.00
0.75
0.50
0.25
0.00
1956

1960

1964

1968

1972

1976

1980

1984

Cluster 3

1.00
0.75
0.50
0.25
0.00
1956

1960

1964

1968

1972

1976

1980

1984

Notes to Figure 2. Top panel: posterior probability that zt = 4, with shaded regions
corresponding to dates of NBER recessions. Bottom three panels: posterior probability
that zt = 1, 2, 3, with shaded regions corresponding to dates for which posterior
probability that zt = 4 is greater than 0.99.

Figure 3. Probabilities of cluster affiliations based on exogenous explanatory variables
alone (first column) and based on exogenous explanatory variables plus observed
employment growth patterns (second column).
Cluster 1

Cluster 1
1

1

0.75

0.75

0.5

0.5

0.25

0.25

0

0

Cluster 2

Cluster 2
1

1

0.75

0.75

0.5

0.5

0.25

0.25

0

0

Cluster 3

Cluster 3
1

1

0.75

0.75

0.5

0.5

0.25

0.25

0

0

Notes to Figure 3. First column: the color for state n for cluster k indicates the average
value of exp(xâ€²n Î² k ) / [1 + exp(xâ€²n Î² k ) ] across 125,000 simulated draws for Î² k . Second
column: the color for state n for cluster k indicates the average value of hnk across
125,000 simulated draws for hnk .

