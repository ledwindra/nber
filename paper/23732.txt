NBER WORKING PAPER SERIES

INCOME AND WEALTH DISTRIBUTION IN MACROECONOMICS:
A CONTINUOUS-TIME APPROACH
Yves Achdou
Jiequn Han
Jean-Michel Lasry
Pierre-Louis Lions
Benjamin Moll
Working Paper 23732
http://www.nber.org/papers/w23732

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2017

This version supersedes an earlier version of the paper entitled “Heterogeneous Agent Models in
Continuous Time.” We are grateful to Fernando Alvarez, Adrien Auclert, Dave Backus, Roland
Bénabou, Jess Benhabib, Jocelyn Boussard, Paco Buera, Lorenzo Caliendo, Dan Cao, Wouter
Den Haan, Xavier Gabaix, Mark Huggett, Mariacristina De Nardi, Greg Kaplan, Nobu Kiyotaki,
Ellen McGrattan, Giuseppe Moscarini, Galo Nuño, Ezra Oberfield, Alan Olivi, Jesse Perla,
Matt Rognlie, Tony Smith, Ivan Werning, Wei Xiong, Stan Zin and seminar participants at
various institutions for useful comments. We also thank Déborah Sanchez for stimulating
discussions in early stages of this project and SeHyoun Ahn, Riccardo Cioffi, Xiaochen Feng
and Max Vogler for outstanding research assistance. The views expressed herein are those of
the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2017 by Yves Achdou, Jiequn Han, Jean-Michel Lasry, Pierre-Louis Lions, and Benjamin
Moll. All rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted
without explicit permission provided that full credit, including © notice, is given to the source.

Income and Wealth Distribution in Macroeconomics: A Continuous-Time Approach
Yves Achdou, Jiequn Han, Jean-Michel Lasry, Pierre-Louis Lions, and Benjamin Moll
NBER Working Paper No. 23732
August 2017
JEL No. D31,E00,E21
ABSTRACT
We recast the Aiyagari-Bewley-Huggett model of income and wealth distribution in continuous
time. This workhorse model – as well as heterogeneous agent models more generally – then boils
down to a system of partial differential equations, a fact we take advantage of to make two types
of contributions. First, a number of new theoretical results: (i) an analytic characterization of the
consumption and saving behavior of the poor, particularly their marginal propensities to
consume; (ii) a closed-form solution for the wealth distribution in a special case with two income
types; (iii) a proof that there is a unique stationary equilibrium if the intertemporal elasticity of
substitution is weakly greater than one; (iv) characterization of “soft” borrowing constraints.
Second, we develop a simple, efficient and portable algorithm for numerically solving for
equilibria in a wide class of heterogeneous agent models, including – but not limited to – the
Aiyagari-Bewley-Huggett model.
Yves Achdou
UFR de Mathématiques
Université Paris Diderot
bureau 5D19
175 rue du Chevaleret
75013 Paris
France
achdou@ljll.univ-paris-diderot.fr
Jiequn Han
Program in Applied and
Computational Mathematics
Princeton University
Princeton, NJ 08540
jiequnh@princeton.edu
Jean-Michel Lasry
Université Paris Dauphine
Institut de Finance
Place du Marechal de Lattre de Tassigny
75775 Paris Cedex 16, France
2007lasry@gmail.com

Pierre-Louis Lions
College de France
Rue d’Ulm 3
75005 Paris Cedex 05, France
pierre-louis.lions@college-de-france.fr
Benjamin Moll
Department of Economics
Princeton University
192 Julis Romo Rabinowitz Building
Princeton, NJ 08544
and NBER
moll@princeton.edu

Introduction
One of the key developments in macroeconomics research over the last three decades has been
the incorporation of explicit heterogeneity into models of the macroeconomy. Fueled by the
increasing availability of high-quality micro data, the advent of more powerful computing
methods as well as rising inequality in many advanced economies, such heterogeneous agent
models have proliferated and are now ubiquitous. This is a welcome development for a
number of reasons. First, it opens up the door to bringing micro data to the table in order
to empirically discipline macro theories. Second, macroeconomists often want to analyze the
welfare implications of particular shocks or policies. This is impossible without asking “who
gains and who loses?”, that is, distributional considerations often cannot be ignored. Third,
models with heterogeneity often deliver strikingly different aggregate implications than do
representative agent models, for example with respect to monetary and fiscal policies.1
Despite the continuously increasing popularity of macroeconomic models with rich heterogeneity, the literature has suffered from a dearth of theoretical and analytical results.
Little is known about the properties of consumption and saving behavior in the presence of
borrowing constraints, those of the resulting wealth distribution, and equilibrium uniqueness
(or lack thereof). Instead, most studies rely on purely numerical analyses to characterize the
implications of such theories. But even such computational approaches are often difficult
and costly, particularly if the question at hand requires solving for the economy’s transition
dynamics or if the model features non-differentiabilities or non-convexities.
In this paper we make some progress on these issues by recasting the standard incomplete
market model of Aiyagari (1994), Bewley (1986) and Huggett (1993) in continuous time. Our
main contributions are twofold. First, we prove a number of new theoretical results about
this workhorse model.2 Second, we develop a simple, efficient and portable algorithm for
numerically solving both stationary equilibria and transition dynamics of a wide class of
heterogeneous agent models, including – but not limited to – the Aiyagari-Bewley-Huggett
model.
Both types of contributions make use of an important property: when recast in continuous
time, heterogeneous agent models boil down to systems of two coupled partial differential
equations. The first of these is a Hamilton-Jacobi-Bellman (HJB) equation for the optimal
choices of a single atomistic individual who takes the evolution of the distribution and hence
prices as given. And the second is a Kolmogorov Forward (KF) equation characterizing
1

Deaton (2016) succinctly summarizes the second and third reasons: “While we often must focus on
aggregates for macroeconomic policy, it is impossible to think coherently about national well-being while ignoring inequality and poverty, neither of which is visible in aggregate data. Indeed, and except in exceptional
cases, macroeconomic aggregates themselves depend on distribution.”
2
Of course and as is well-known, the unadorned Aiyagari-Bewley-Huggett model is not sufficiently rich to
be an empirically realistic theory of income and wealth distribution. Understanding its theoretical properties
is nevertheless important, simply because it forms the backbone of much of modern macroeconomics.

1

the evolution of the distribution, given optimal choices of individuals.3 In the context of
the Aiyagari-Bewley-Huggett model, the HJB equation characterizes individuals’ optimal
consumption and saving behavior given a stochastic process for income; and the KF equation
characterizes the evolution of the joint distribution of income and wealth. The two equations
are coupled because optimal consumption and saving depend on the interest rate which is
determined in equilibrium and hence depends on the wealth distribution. We start with a
particularly parsimonious case: a Huggett (1993) economy in which idiosyncratic income
risk takes the form of exogenous endowment shocks that follow a two-state Poisson process
and in which individuals save in unproductive bonds that are in fixed supply. Later in the
paper, we extend many of our results to more general stochastic processes and to an Aiyagari
(1994) economy in which individuals save in productive capital and income takes the form
of labor income.
We prove four new theoretical results about the Aiyagari-Bewley-Huggett model. First,
we provide an analytic characterization of the consumption and saving behavior of the poor.
We show that, under natural assumptions,4 an individual’s saving policy function behaves
√
like − 2νa in the vicinity of the borrowing constraint where a is her wealth in deviations
from this constraint and ν is a constant that depends on parameters. Equivalently, her con√
sumption function behaves like her total income plus 2νa. This characterization implies
that: (i) individuals necessarily hit the borrowing constraint in finite time after a long enough
sequence of low income shocks, (ii) we have an intuitive characterization of the speed ν at
which an individual does so as well as her marginal propensity to consume (MPC) out of a
windfall income gain. This MPC is higher the lower is the interest rate relative to the rate of
time preference, the more willing to intertemporally substitute individuals are, or the higher
is the likelihood of getting a high income draw; it is non-monotone in the income received
in low-income states (e.g. unemployment benefits). Understanding the theoretical determinants of MPCs is, of course, important for a large body of applied work.5 Second, we derive
an analytic solution for the wealth distribution for a special case with two income types. This
analytic solution provides a clean characterization of various properties of the wealth distribution, particularly the behavior of its left and right tails. For example, a direct corollary
3

Lasry and Lions (2007) have termed such systems “Mean Field Games” in analogy to the continuum
limit often taken in statistical mechanics and physics, e.g. when solving the Ising model. We build on their
earlier work. Also see Guéant, Lasry, and Lions (2011) and Cardialaguet (2013) and the references cited
therein. The “Kolmogorov Forward equation” is also often called “Fokker-Planck equation.” Because the
term “Kolmogorov Forward equation” seems to be somewhat more widely used in economics, we will use
this convention throughout the paper. But these are really two different names for the same equation.
4
Namely that either the borrowing constraint is tighter than the natural borrowing constraint or the
coefficient of absolute risk aversion is bounded as consumption approaches zero (or both).
5
The distribution of MPCs determines, for example, the efficacy of fiscal stimulus (e.g. Kaplan and
Violante, 2014; Hagedorn, Manovski, and Mitman, 2017), the transition mechanism of monetary policy (e.g.
Auclert, 2017; Kaplan, Moll, and Violante, 2016), the effect of a credit crunch or house price movements on
consumer spending (e.g. Guerrieri and Lorenzoni, 2017; Berger, Guerrieri, Lorenzoni, and Vavra, 2015) and
the extent to which inequality affects aggregate demand (e.g. Auclert and Rognlie, 2016, 2017).

2

of individuals hitting the borrowing constraint in finite time is that the wealth distribution
features a Dirac point mass at this constraint. Third, we prove existence and uniqueness of a
stationary equilibrium for general utility functions and income processes under the intuitive
condition that the intertemporal elasticity of substitution (IES) −u0 (c)/(u00 (c)c) is weakly
greater than one for all consumption levels c.6 Without a uniqueness result the economy
could, in principle, be subject to poverty traps and history dependence.7 Fourth, we consider “soft borrowing constraints”, i.e. a wedge between borrowing and saving rates, and
characterize their implication for saving behavior and the wealth distribution. This form of
constraint can explain the empirical observation that wealth distributions typically have a
spike at zero net worth and mass both to the left and the right of zero.
In addition to these results, which are new also relative to the existing discrete-time
literature, we extend some useful existing discrete-time results and concepts to continuous
time. First, we adapt a number of results from Aiyagari (1994), e.g. that the wealth
distribution has a finite upper bound and that a stationary equilibrium exists. Second, we
characterize the saving behavior of the wealthy and show that, with constant relative risk
aversion (CRRA) utility, consumption and saving policy functions become linear for high
wealth (Benhabib, Bisin, and Zhu, 2015; Benhabib and Bisin, 2016). Third, we show how
to define in continuous time marginal propensities to consume and save over discrete time
intervals. This is not obvious and, at the same time, important for bringing the model to the
data. Finally, a methodological contribution of our paper is to show how to handle borrowing
constraints in continuous time: conveniently, the borrowing constraint never binds in the
interior of the state space and only shows up in a boundary condition.8 The consumption
first-order condition always holds with equality, thereby sidestepping any complications due
to “occasionally binding constraints.” Many of our proofs exploit this fact.
As already mentioned, our second main contribution is the development of a simple,
efficient and portable numerical algorithm for computing a wide class of heterogeneous agent
models. The algorithm is based on a finite difference method and applies to the computation
of both stationary and time-varying equilibria.9 We explain this algorithm in the context
of the Aiyagari-Bewley-Huggett model. But the algorithm is, in fact, considerably more
6
In addition we assume for the uniqueness result that individuals cannot borrow. A key step in our proof
is an important result by Olivi (2017). Contemporaneous work by Light (2017) derives a uniqueness result
under more restrictive assumptions in a discrete-time setting: he proves uniqueness for an Aiyagari economy
with CRRA utility and Cobb-Douglas production (as well as no borrowing) under the assumption that the
constant IES is greater than one.
7
For the same reasons, one of the first result that every graduate student learns is that the neoclassical
growth model – the representative-agent counterpart to the Aiyagari model – features a unique steady state.
8
This is in contrast to discrete-time formulations where there is typically a critical level of wealth, strictly
bigger than the borrowing constraint, such that the constraint binds for all lower levels of wealth.
9
Our numerical method is based on Achdou and Capuzzo-Dolcetta (2010) and Achdou (2013) but modified
to handle the particular features of heterogeneous agent models, in particular borrowing constraints. Candler
(1999) has previously used a finite difference method to solve HJB equations arising in economics and we
discuss the relation to his work in Section 3.7.

3

general and applies to any heterogeneous agent model with a continuum of atomistic agents
(and without aggregate shocks). In Section 4 we demonstrate the algorithm’s generality by
applying it to other theories that feature non-convexities, a fat-tailed wealth distribution and
multiple assets. Codes for these applications (and many more) are available from http://
www.princeton.edu/∼moll/HACTproject.htm in Matlab as well as Python, Julia and C++.
The first step of the algorithm is to solve the HJB equation for a given time path of
prices. The second step is to solve the KF equation for the evolution of the joint distribution
of income and wealth. Conveniently, after having solved the HJB equation, one obtains the
time path of the distribution essentially “for free,” i.e. with very few lines of code. This is
because the KF equation is the “transpose problem” of the HJB equation.10 The third step
is to iterate and repeat the first two steps until an equilibrium fixed point for the time path
of prices is found. For the first step, we make use of the theory of “viscosity solutions” to
HJB equations (Crandall and Lions, 1983), and the corresponding theory for their numerical
solution using finite difference methods (Barles and Souganidis, 1991). While our paper can
be read without knowledge of the theory of viscosity solutions, Online Appendix C.1 provides
an “economist-friendly” introduction and lists a number of relatively accessible references.
Continuous time imparts a number of computational advantages relative to discrete time.
As explained in more detail in Section 3.1, these relate to the handling of borrowing constraints, the numerical solution of first-order conditions and the fact that continuous-time
problems with discretized state space are, by construction, very “sparse.” These computational advantages are reflected in the algorithm’s efficiency. Just to give a flavor, computing
the stationary equilibrium of Huggett’s economy with two income types and 1,000 grid points
in the wealth dimension using Matlab takes around a quarter second on a Macbook Pro laptop computer. At the same time, the algorithm is simple. Implementing it requires only
some basic knowledge of matrix algebra and access to a software package that can solve
sparse linear systems (e.g. Matlab). Finally, the algorithm is portable. For example, it
applies without change to problems that involve non-differentiabilities and non-convexities.
These are difficult to handle with standard discrete-time methods.11 In contrast, viscosity
solutions and finite difference methods are designed to handle non-differentiable and nonconvex problems. To illustrate this, we use the same algorithm to compute equilibria of an
economy in which the interplay of indivisible housing and mortgages with a down-payment
constraint cause a non-convexity which can result in individual poverty traps and multiple
stationary distributions (Section 4.3).
Besides hopefully being useful in their own right, our paper’s contributions also constitute the foundation for a number of generalizations that go beyond the setup that we
10
More precisely, the differential operator in the KF equation is the adjoint of the differential operator in
the HJB equation. The adjoint of an operator is the infinite-dimensional analogue of a matrix transpose.
11
Because first-order conditions are no longer sufficient and standard envelope theorems do not apply.

4

consider in the present paper. First, building on the finite difference method developed
here, Ahn, Kaplan, Moll, Winberry, and Wolf (2017) develop a computational method for
solving heterogeneous agent models with aggregate uncertainty in addition to idiosyncratic
risk (as in Den Haan, 1997; Krusell and Smith, 1998). Second, Kaplan, Moll, and Violante (2016) incorporate multiple assets and kinked adjustment costs. Third, Olivi (2017)
leverages our continuous-time formulation to obtain powerful comparative statics and sufficient statistics in incomplete markets models – results we build on in our uniqueness
proof. Fourth, Parra-Alvarez, Posch, and Wang (2017) discuss how to identify and estimate continuous-time Aiyagari-Bewley-Huggett models. Fifth, Nuño and Moll (2017) and
Nuño and Thomas (2017) devise a method for computing social optima in such environments. Sixth, Shaker Akhtekhane (2017) extends our computational approach to economies
with heterogeneous firms à la Hopenhayn (1992). Seventh, Ahn (2017) computes equilibria
in economies with a large number of individual state variables (four or more) by marrying
our finite difference method with a sparse grid approach (Bungartz and Griebel, 2004; Gerstner and Griebel, 2010). All of these generalizations build on the tools developed in the
present paper.
A large theoretical and quantitative literature studies environments in which heterogeneous households are subject to uninsurable idiosyncratic shocks. See Heathcote, Storesletten, and Violante (2009), Guvenen (2011), Quadrini and Rı́os-Rull (2015) and Krueger,
Mitman, and Perri (2015) for recent surveys, and the textbook treatment in Ljungqvist and
Sargent (2004). All of these are set in discrete time.
Much fewer papers have studied equilibrium models with heterogeneous households in
continuous time.12 All of these papers make “just the right assumptions” about the environment being studied so that equilibria can be solved explicitly (or at least characterized
tightly).13 In contrast, our aim is to develop tools for solving and analyzing models that do
not permit closed-form solutions. Our methods apply as long as the model under consideration can be boiled down to an HJB equation and a KF equation, a feature shared by a
wide class of heterogeneous agent models. These two approaches are clearly complimentary:
on the one hand, having explicit solutions is often extremely valuable for gaining intuition;
on the other hand, restricting attention to environments for which these can be found may
represent a sort of “analytic straitjacket” for some applications and the availability of more
12

See for example Jovanovic (1979), Moscarini (2005), Alvarez and Shimer (2011), Moll (2014), Stokey
(2014), Vindigni, Scotti, and Tealdi (2014), Jones and Kim (2014), Jones (2015), Toda and Walsh (2015),
Benhabib, Bisin, and Zhu (2016), Cao and Luo (2017) and Kasa and Lei (2017). Luttmer (2007, 2011, 2015)
and Benhabib, Perla, and Tonetti (2017) analyze theories with heterogeneous producers. These papers, like
ours, all study economies with a continuum of heterogeneous agents giving rise to a system of coupled HJB
and KF equations. In contrast, other papers study environments with a finite number of heterogeneous
agents (typically equal to two). For example, see Scheinkman and Weiss (1986) and applications of their
framework by Conze, Lasry, and Scheinkman (1993) and Lippi, Ragni, and Trachter (2013).
13
Similarly, there are also several discrete-time approaches for retaining tractability in environments with
heterogeneous households (e.g. Bénabou, 2002; Krebs, 2003; Heathcote, Storesletten, and Violante, 2014).

5

general methods may prove useful in such contexts.
One other paper by Bayer and Wälde (2010) also studies a continuous-time version of
an Aiyagari-Bewley-Huggett model. The main differences between their paper and ours
are: (i) they analyze a partial equilibrium framework whereas we consider a general equilibrium framework, and (ii) we develop a numerical algorithm for solving both stationary
and time-varying equilibria, thereby actually “operationalizing” the analysis of this class
of models.14,15 Also closely related, Rocheteau, Weill, and Wong (2015) propose an elegant
alternative general equilibrium model with incomplete markets in continuous time. Market
incompleteness in their framework stems from lumpy consumption expenditure shocks (e.g.
health events) rather than idiosyncratic income risk. As a result their model features only
one individual state variable and many results can be derived in closed form. The tradeoff
is that their theory is further from the standard Aiyagari-Bewley-Huggett model that forms
the backbone of much of modern macroeconomics.16
Section 1 lays out our continuous-time version of the workhorse macroeconomic model
of income and wealth distribution in the parsimonious form due to Huggett (1993). Section
2 contains our new theoretical results. Section 3 describes our computational algorithm for
both stationary and time-varying equilibria and discusses computational advantages relative
to existing discrete-time methods. Section 4 demonstrates the algorithm’s generality by
applying it to a number of other economies. Section 5 concludes.

1

The Workhorse Model of Income and Wealth Distribution in Macroeconomics

To explain the logic of our approach in the simplest possible fashion, we present it in a
context that should be very familiar to many economists: a general equilibrium model with
incomplete markets and uninsured idiosyncratic labor income risk as in Aiyagari (1994),
Bewley (1986) and Huggett (1993). We first do this in the context of an economy in which
individuals save in unproductive bonds that are in fixed supply as in Huggett (1993). We
14
Additionally, Bayer and Wälde study a version of the model with the “natural borrowing constraint”
implying that individuals never actually hit that constraint. Another difference is that they characterize
individuals’ saving behavior in terms of a differential equation for its consumption policy function. In
contrast, we do this in terms of the HJB equation for the value function, thereby allowing us to take
advantage of the theory of viscosity solutions. Of course the two approaches are related and their equation
for consumption can be derived from the envelope condition of the HJB equation.
15
Also Lise (2013) studies heterogeneous households in continuous time but in partial equilibrium.
16
Wang (2007) proposes an elegant continuous-time Aiyagari-Bewley-Huggett model that can be solved
analytically but at the cost of making two non-standard assumptions on preferences: that individuals have
CARA utility and that current discount rates are increasing in past consumption (in the absence of the
second assumption, CARA utility implies exploding wealth inequality and no stationary wealth distribution
exists).

6

later consider different ways of closing the model.

1.1

Setup

Individuals There is a continuum of individuals that are heterogeneous in their wealth a
and income y. The state of the economy is the joint distribution of income and wealth. Individuals have standard preferences over utility flows from future consumption ct discounted
at rate ρ ≥ 0:
ˆ
∞

e−ρt u(ct )dt.

E0

(1)

0

The function u is strictly increasing and strictly concave. An individual has an income yt
which is simply an endowment of the economy’s final good. His wealth takes the form of
bonds and evolves according to
ȧt = yt + rt at − ct ,
(2)
where rt is the interest rate. Individuals also face a borrowing limit
at ≥ a,

(3)

where −∞ < a < 0.17 Finally, an individual’s income evolves stochastically over time. In
particular, we assume that income follows a two-state Poisson process yt ∈ {y1 , y2 }, with
y2 > y1 . The process jumps from state 1 to state 2 with intensity λ1 and vice versa with
intensity λ2 . The two states can be interpreted as employment and unemployment so that
λ1 is the job-finding rate and λ2 the job destruction rate. The two-state Poisson process is
chosen for simplicity and Section 4 shows how the setup can be extended to more general
income processes.
Individuals maximize (1) subject to (2), (3) and the process for yt , taking as given the
evolution of the equilibrium interest rate rt for t ≥ 0. For future reference, we denote by
gj (a, t), j = 1, 2 the joint distribution of income yj and wealth a.18
Equilibrium The economy can be closed in a variety of ways. We here present the simplest
possible way of doing this following Huggett (1993). We assume that the only price in this
economy is the interest rate rt which is determined by the requirement that, in equilibrium,
17

As discussed in detail in Aiyagari (1994), if the borrowing limit a is less tight than the so-called “natural
borrowing limit”, the constraint at ≥ a will never bind and the “natural borrowing limit” will be the effective
borrowing limit. In a stationary equilibrium with r > 0, the “natural borrowing limit” is at ≥ −y1 /r where y1
is the lowest income.
In ´an equilibrium
with a time-varying interest rate rt the natural borrowing constraint

´∞
s
is at ≥ −y1 t exp − t rτ dτ ds. The natural borrowing constraint ensures that at never becomes so
negative that the individual cannot repay
´ ∞ her debt even
´ ∞ if she chooses zero consumption thereafter.
18
This joint distribution satisfies a g1 (a, t)da + a g2 (a, t)da = 1, that is gj (a, t) is the unconditional
distribution of wealth for a given productivity type j = 1, 2.

7

bonds must be in fixed supply:
ˆ ∞

ˆ

∞

ag1 (a, t)da +
a

ag2 (a, t)da = B,

(4)

a

where 0 ≤ B < ∞. B = 0 means that bonds are in zero net supply. Alternatively, B can be
positive. For instance, a government could issue debt and sell it to individuals or there could
be saving opportunities abroad.19 We later consider alternative ways of closing the economy.
For instance Section 4.2 assumes that wealth takes the form of productive capital hired by a
representative firm so that the interest rate equals the aggregate marginal product of capital
as in Aiyagari (1994).
Useful Utility Functions We have not imposed any assumptions on the utility function
u besides it being strictly increasing and strictly concave. But in later parts of the paper,
it will sometimes be instructive to specialize this utility function to either constant relative
risk aversion (CRRA) utility
c1−γ
, γ > 0,
(5)
u(c) =
1−γ
or to exponential utility
u(c) = −θe−θc ,

θ > 0,

(6)

and we state these here for future reference.

1.2

Stationary Equilibrium

Individuals’ consumption-saving decision and the evolution of the joint distribution of their
income and wealth can be summarized with two differential equations: a Hamilton-JacobiBellman (HJB) equation and a Kolmogorov Forward (or Fokker-Planck) equation. In a
19

In the scenario with government debt we assume that this debt is financed with a lump-sum tax on all
individuals and income yt is net of this tax.

8

stationary equilibrium these take the form:20
ρvj (a) = max u(c) + vj0 (a)(yj + ra − c) + λj (v−j (a) − vj (a)),

(7)

d
[sj (a)gj (a)] − λj gj (a) + λ−j g−j (a),
da

(8)

c

0=−

for j = 1, 2 and where, throughout this paper, we adopt the convention that −j = 2 when
j = 1 and vice versa. The derivations of the HJB equation (7) and the KF equation (8)
can be found in Appendix B. The function sj in (8) is the saving policy function, i.e. the
optimally chosen drift of wealth
sj (a) = yj + ra − cj (a),

where cj (a) = (u0 )−1 (vj0 (a)).

(9)

The domain of the two ordinary differential equations (7) and (8) is (a, ∞) where a is the
borrowing limit in (3).
The reader may wonder why the borrowing constraint (3) does not feature in the HJB
equation (7). The reason is that, in our continuous-time formulation, the borrowing constraint never binds in the interior of the state space, i.e. for a > a and as a result an
undistorted first-order condition u0 (cj (a)) = vj0 (a) holds everywhere.21 Intuitively, since
wealth a is a continuously moving state variable, if it is strictly above the borrowing constraint today, it will still be strictly above the constraint an infinitesimal time interval later.
Instead, the borrowing constraint gives rise to a state constraint boundary condition 22
vj0 (a) ≥ u0 (yj + ra),

j = 1, 2.

(10)

To see why this is the appropriate boundary condition, note that the first-order condition
u0 (cj (a)) = vj0 (a) still holds at a = a. The boundary condition (10) therefore implies sj (a) =
yj + ra − cj (a) ≥ 0, i.e. it ensures that the borrowing constraint is never violated. Online
20

A more compact way of writing this is to define the Hamiltonian H(p) = maxc u(c) − pc and to write
the saving policy function as sj (a) = yj + ra + H 0 (vj0 (a)). The HJB and KF equations (7) and (8) can then
be expressed as two non-linear partial differential equations in vj and gj only, that do not involve a max
operator:
ρvj (a) = H(vj0 (a)) + vj0 (a)(yj + ra) + λj (v−j (a) − vj (a)),
d
0 = − [(yj + ra + H 0 (vj0 (a)))gj (a)] − λj gj (a) + λ−j g−j (a).
da
This is in contrast to discrete-time formulations where there is a set [a, a∗ ) with a∗ > a such that type
1’s borrowing constraint binds for all a ∈ [a, a∗ ) and hence the first-order condition is distorted.
22
Note that this inequality has very little to do with the inequality in discrete-time first-order conditions
due to occasionally binding borrowing constraints – see e.g. equation (47) later in the paper. In fact, the two
inequalities go in opposite directions. Even though both inequalities result from the presence of borrowing
constraints, the logic behind them is completely different.
21

9

Appendix C.1 derives the state constraint boundary condition (10) more rigorously and
makes the connection to a somewhat more general strategy for imposing state constraints
used in the mathematics literature, namely to look for a constrained viscosity solution of
(7).23 The remainder of our paper can be read without knowledge of the theory of viscosity
solutions. The KF equation (8) requires no boundary condition at a: the state constraint is
satisfied by virtue of sj being the optimal saving policy function from the HJB equation (7).
Finally, the stationary interest rate r must satisfy the analogue of the market clearing
condition (4)
ˆ ∞
ˆ ∞
S(r) :=
ag1 (a)da +
ag2 (a)da = B.
(11)
a

a

The two ordinary differential equations (7) and (8) together with (9), (10), and the equilibrium relationship (11) fully characterize the stationary equilibrium of our economy. This
system is an instance of what Lasry and Lions (2007) have called a “Mean Field Game,”
here in its stationary form. We next turn to its time-dependent analogue, and discuss more
of the properties of such systems.

1.3

Transition Dynamics

Many interesting questions require studying transition dynamics, that is the evolution of the
economy when the initial distribution of income and wealth does not equal the stationary
distribution. The time-dependent analogue of the stationary system (7) to (11) is24
ρvj (a, t) = max u(c) + ∂a vj (a, t)(yj + r(t)a − c) + λj (v−j (a, t) − vj (a, t)) + ∂t vj (a, t), (12)
c

∂t gj (a, t) = − ∂a [sj (a, t)gj (a, t)] − λj gj (a, t) + λ−j g−j (a, t),
sj (a, t) = yj + r(t)a − cj (a, t),

cj (a, t) = (u0 )−1 (∂a vj (a, t)),

(13)
(14)

for j = 1, 2, and together with the equilibrium condition (4). We here use the short-hand
notation ∂a v = ∂v/∂a and so on, and as before sj denotes the optimal saving policy function.
The domain of the two partial differential equations (12) and (13) is (a, ∞) × R+ (though
more on the time domain momentarily). The function vj again satisfies a state constraint
23

See Soner (1986a,b) and Capuzzo-Dolcetta and Lions (1990).
As in the stationary case, there is again a more compact way of writing this system as two non-linear
partial differential equations in vj and gj only, that do not involve a max operator:
24

ρvj (a, t) = H(∂a vj (a, t)) + ∂a vj (a, t)(yj + r(t)a) + λj (v−j (a, t) − vj (a, t)) + ∂t vj (a, t),
∂t gj (a, t) = −∂a [(yj + r(t)a + H 0 (∂a vj (a, t)))gj (a, t)] − λj gj (a, t) + λ−j g−j (a, t),
with the Hamiltonian H given by H(p) := maxc u(c) − pc.

10

boundary condition similar to (10)
∂a vj (a, t) ≥ u0 (yj + r(t)a),

j = 1, 2.

(15)

The density gj satisfies the initial condition
gj (a, 0) = gj,0 (a).

(16)

The value function satisfies a terminal condition. In principle, the time domain is R+ but in
practice we work with (0, T ) for T “large” and impose
vj (a, T ) = vj,∞ (a),

(17)

where vj,∞ is the stationary value function, i.e. the solution to the stationary problem (7)
to (11).
The two partial differential equations (12) and (13) together with (14), the equilibrium
relationship (4) and the boundary conditions (15) to (17) fully characterize the evolution
of our economy. This “Mean Field Game” has two properties that are worth emphasizing.
First, the two equations (12) and (13) are coupled: on one hand, an individual’s consumptionsaving decision depends on the evolution of the interest rate which is in turn determined by
the evolution of the distribution; on the other hand, the evolution of the distribution depends
on individuals’ saving decisions. Second, the two equations run in opposite directions in
time: the Kolmogorov Forward equation runs forward (as indicated by its name) and looks
backwards – it answers the question “given the wealth distribution today, savings decisions
and the random evolution of income, what is the wealth distribution tomorrow?” In contrast,
the Hamilton-Jacobi-Bellman equation (12) runs backwards and looks forward – it answers
the question “given an individual’s valuation of income and wealth tomorrow, how much will
she save today and what is the corresponding value function today?”

1.4

Classical versus Weak Solutions of HJB and KF equations

A classical solution to a PDE or ODE is a solution that is differentiable as many times as
needed to satisfy the corresponding equation. In particular, classical solutions to the firstorder HJB and KF equations (12) and (13) would need to be once differentiable. Similarly,
classical solutions to second-order equations that arise for example if y follows a diffusion
process as in Section 4.1 would need to be twice differentiable. In general, we do not expect
to find such classical solutions to either HJB or KF equations. For instance, the value
function vj may have kinks and the distribution gj may feature Dirac point masses. Instead,
we generally look for certain weak solutions of these equations, that is solutions that may
not be continuously differentiable or even continuous but still satisfy these equations in some
11

sense. As we explain in more detail in Online Appendix C, the correct notion for a weak
solution of the HJB equation is a viscosity solution and that of the KF equation is a measurevalued solution.25 See Evans (2010, Section 1.3) and Tao (2008) for illuminating discussions
on the role of weak solutions in the study of partial differential equations more generally.
That being said, most of our paper employs classical methods. And, with the preceding
paragraph in hand, the reader is well-equipped for those parts that do not.

2

Theoretical Results: Consumption, Saving and Inequality

This Section presents theoretical results about our continuous-time version of the AiyagariBewley-Huggett model, including the four new results emphasized in the introduction. Sections 2.1 to 2.5 analyze the HJB and KF equations (7) and (8) in partial equilibrium, i.e.
taking as given a fixed interest rate r (assumed to be less than ρ which will be the equilibrium outcome). Section 2.6 then imposes market clearing (11) and considers the stationary
equilibrium, particularly its existence and uniqueness. Section 2.7 considers “soft” borrowing
constraints.

2.1

An Euler Equation

Our first few theoretical results concern the consumption and saving behavior of individuals.
Our characterization of individual behavior uses the following Lemma.
Lemma 1 The consumption and saving policy functions cj (a) and sj (a) for j = 1, 2 corresponding to the HJB equation (7) satisfy
(ρ − r)u0 (cj (a)) = u00 (cj (a))c0j (a)sj (a) + λj (u0 (c−j (a)) − u0 (cj (a))),
sj (a) = yj + ra − cj (a).

(18)

Proof: Differentiate the HJB equation (7) with respect to a (envelope condition) and use
that vj0 (a) = u0 (cj (a)) and hence vj00 (a) = u00 (cj (a))c0j (a).
The differential equation (18) is an Euler equation. The right-hand side is simply the
expected change of individual marginal utility of consumption Et [du0 (cj (at ))]/dt.26 Therefore
25

The standard notion of a measure-valued solution is only defined on the interior of the state space
and therefore cannot be used to deal with a Dirac point mass at the boundary, a feature that arises in
our application. We show in Appendix C.2 how to extend the standard notion to take into account this
possibility.
26
This uses the extension of Ito’s formula to Poisson processes: Et [du0 (cj (at ))] = [u00 (cj (at ))c0j (at )sj (at ) +
λj (u0 (c−j (at )) − u0 (cj (at )))]dt.

12

(18) can be written in the more standard form
Et [du0 (cj (at ))]
= (ρ − r)dt.
u0 (cj (at ))

2.2

Consumption and Saving Behavior of the Poor

Our first main result is obtained by analyzing the Euler equation (18) close to the borrowing
constraint. The interesting case is when the behavior at the constraint differs qualitatively
from that of rich individuals. Whether this is the case depends crucially on two factors:
the tightness of the borrowing constraint a, and the properties of the utility function at low
levels of consumption. To focus on the interesting case, we make the following assumption.
Assumption 1 The coefficient of absolute risk aversion R(c) := −u00 (c)/u0 (c) when wealth
a approaches the borrowing limit a is finite, that is
u00 (y1 + ra)
< ∞.
a→a u0 (y1 + ra)

R := − lim

For any utility function, a sufficient condition for Assumption 1 is that the borrowing constraint is tighter than the “natural borrowing constraint” a > −y1 /r. For example, with
CRRA utility (5) we have R = γ/(y1 + ra) which is finite whenever a > −y1 /r. However,
Assumption 1 is considerably weaker than this. In particular, it is also satisfied if the borrowing constraint equals the natural borrowing constraint a = −y1 /r and the coefficient
of absolute risk aversion −u00 (c)/u0 (c) is bounded as consumption goes to zero. This is for
example the case with exponential utility (6) in which case R = θ < ∞ regardless of the
tightness of the borrowing constraint. The only case in which Assumption 1 is not satisfied
is if both (i) the borrowing constraint equals the natural borrowing constraint and (ii) risk
aversion becomes unbounded as consumption goes to zero. For completeness, this case is
covered in Proposition 1’ in the Appendix.
In what follows as well as elsewhere in the paper, we use the following asymptotic notation: for any two functions f and g, “f (a) ∼ g(a) as a → a” is short-hand notation for
lima→a f (a)/g(a) = 1, i.e. f “behaves like” g for a close to a.
Proposition 1 (MPCs and Saving at Borrowing Constraint) Assume that r < ρ, y1 <
y2 and that Assumption 1 holds. Then the solution to the HJB equation (7) and the corresponding policy functions have the following properties:
1. s1 (a) = 0 but s1 (a) < 0 all a > a. That is, only individuals exactly at the borrowing
constraint are constrained, whereas those with wealth a > a are unconstrained and
decumulate assets.
13

2. as a → a, the saving and consumption policy function of the low income type and the
corresponding instantaneous marginal propensity to consume satisfy
√ √
s1 (a) ∼ − 2ν1 a − a,
√ √
c1 (a) ∼ y1 + ra + 2ν1 a − a,
r
ν1
0
c1 (a) ∼ r +
,
2(a − a)
(ρ − r)u0 (c1 ) + λ1 (u0 (c1 ) − u0 (c2 ))
ν1 : =
−u00 (c1 )

(19)

(20)

(21)

≈ (ρ − r)IES(c1 )c1 + λ1 (c2 − c1 ),
where cj = cj (a), j = 1, 2 is consumption of the two types at the borrowing constraint
and IES(c) := −u0 (c)/(u00 (c)c) is the intertemporal elasticity of substitution (IES).27
This implies that the derivatives of c1 and s1 are unbounded at the borrowing constraint,
c01 (a) → ∞ and s01 (a) → −∞ as a → a.
The proof of the Proposition, like that of all others, is in the Appendix. The proof of the first
part follows straight from the state constraint boundary condition (10). The second part
of the proof follows from characterizing the limiting behavior of the squared saving policy
function (s1 (a))2 as wealth a approaches the borrowing constraint a – hence the square root.
The consumption and saving behavior in the Proposition is illustrated in Figure 1. Imc1 (a)
c2 (a)

Saving, sj (a)

Consumption, cj (a)

s1 (a)
s2 (a)

a

a

Wealth, a

(a) Consumption Policy Function

Wealth, a

(b) Saving Policy Function

Figure 1: Consumption and Saving Behavior with r < ρ
portantly, the derivatives of type 1’s consumption and saving policy functions become un27

Type 1’s consumption at the borrowing constraint is given by c1 = y1 + ra and type 2’s consumption
c2 > c1 is a more complicated object determined by the HJB equation (7) for j = 2.

14

bounded at the borrowing constraint. This unbounded derivative has an important implication, namely that individuals hit the borrowing constraint in finite time.
Corollary 1 (Hit Constraint in Finite Time) Assume that r < ρ, y1 < y2 and that Assumption 1 holds. Then the wealth of an individual with initial wealth a0 and successive low
income draws y1 converges to the borrowing constraint in finite time at speed governed by ν1 :
ν1
a(t) − a ∼
(T − t)2 ,
2

s
T :=

2(a0 − a)
,
ν1

0 ≤ t ≤ T,

(22)

where T is the “hitting time.”
The result that the borrowing constraint is reached in finite time bears some similarity to
optimal stopping time problems (see e.g. Stokey, 2009). Just like in stopping time problems,
continuous time avoids a type of integer problem arising in discrete time: the borrowing
constraint would be reached after a non-integer time period, but discrete time forces this to
occur after an integer number of periods.
Proposition 1 features an intuitive formula (21) for the speed at which individuals hit the
borrowing constraint, ν1 . In Section 2.4 we show that ν1 is also the key quantity determining
the marginal propensity to consume (MPC) out of a windfall income gain. We therefore
postpone the discussion of formula (21) until that Section.
Intuition for Proposition 1 and Corollary 1: Two Useful Special Cases. To understand the intuition for the square root in Proposition 1, the implied saving behavior in
Corollary 1 and the role of Assumption 1 it is useful to consider two special cases for which
analytic solutions are available. Both abstract from income uncertainty which is not essential
to the main point.28
In the first special case, an individual has exponential utility (6), receives a deterministic
income stream y > 0, faces a strict no borrowing constraint a ≥ 0 and starts with some
initial wealth a0 > 0. The corresponding Euler equation and budget constraint are
1
ċ = (r − ρ),
θ
ȧ = y + ra − c.

(23)
(24)

Conjecture that at some time T > 0, individuals hit the borrowing constraint, i.e. a(T ) = 0
28

We are indebted to Xavier Gabaix for coming up with the first special case. Also see Holm (2017) who
provides an elegant analytical characterization of consumption behavior with deterministic income and a
borrowing constraint when utility is in the HARA class.

15

and hence c(T ) = y. From the Euler equation (23) consumption for t ≤ T is
c(t) = y + ν(T − t),

ν :=

ρ−r
>0
θ

(25)

Substituting into the budget constraint (24), we have ȧ(t) = ra(t) − ν(T − t). Consider first
the case r = 0 which contains all the intuition. In this case, we have ȧ(t) = −ν(T − t) with
solution
ν
(26)
a(t) = (T − t)2
2
for t ≤ T and where the constant of integration is zero because a(T ) = 0. Since a(0) = a0 ,
p
the hitting time is given by T = 2a0 /ν. Note that (26) is the same expression as (22) in
Corollary 1. Figure 2 plots the time paths of consumption, saving and wealth for this special
case. Panels (a) and (b) show that consumption c(t) decreases linearly toward c(T ) = y
and savings ȧ(t) increase linearly toward ȧ(T ) = 0. Panel (c) plots the resulting wealth
(a) Consumption

(c) Wealth

(b) Savings

Wealth, a(t)

Savings, ȧ(t)

Consumption, c(t)

0

0

y
Time, t

Time, t

Time, t

Figure 2: First special case in which borrowing constraint binds in finite time

0

(c) Wealth

(b) Savings

Wealth, a(t)

Savings, ȧ(t)

Consumption, c(t)

(a) Consumption

0

0
Time, t

Time, t

Time, t

Figure 3: Second special case in which borrowing constraint never binds
dynamics and shows the quadratic shape of equation (26).
16

To understand the square root in the saving and consumption policy functions in Proposition 1, consider an individual at t = 0 with some initial wealth a0 . From (25) and (26),
p
we have c(0) = y + νT and ȧ(0) = −νT with T = 2a0 /ν. Writing consumption and
√
saving in terms of the state variable a rather than calendar time, we have c(a) = y + 2νa
√
and s(a) = − 2νa which are the square-root expressions from Proposition 1. This simple
derivation also explains why the consumption policy function is concave in wealth a (Figure 1). As the individual approaches the borrowing constraint, both her consumption and
wealth decline. If both consumption and wealth declined at the same speed, then consumption would be a linear function of wealth. But this is not the case: instead, wealth declines
more rapidly than consumption – quadratically rather than linearly – see Figures 2(a) and
(c). Therefore, consumption is a strictly concave function of wealth. Given this logic, it is
then also clear that the consumption policy function must be more concave the higher is the
speed at which individuals hit the borrowing constraint ν.

In the case r 6= 0, (26) generalizes to a(t) = rν2 r(T − t) − 1 + e−r(T −t) which converges
to (26) as r → 0; individuals still hit the borrowing constraint in finite time and, in fact,
a(t) ∼ ν2 (T − t)2 as t → T .29 Also all other properties of consumption and saving behavior
are unchanged for t close to T or, equivalently, for wealth close to the borrowing constraint.
In contrast, consider a second special which is identical except that y = 0 and that the
individual has CRRA utility (5). In this case, the Euler equation and budget constraint
change from (23) and (24) to
ċ
1
= (r − ρ),
c
γ

ȧ = ra − c.

It is easy to show that savings and consumption are ȧ(t) = −ηa(t), c(t) = (r + η) a(t) where
η := ρ−r
. Therefore wealth is
γ
a(t) = a0 e−ηt , t ≥ 0.
(27)
The situation is depicted in Figure 3. As wealth decumulates towards the borrowing constraint, the rate of decumulation slows down more and more and individuals never actually
hit the borrowing constraint in finite time. This is an immediate consequence of a linear
saving policy function s(a) = −ηa. Turning this logic around, the consumption policy function is linear in wealth because both consumption and wealth decline toward the borrowing
constraint at the same speed – see Figures 3 (a) and (c) – rather than wealth declining faster
than consumption as in the exponential case.
Our first special case with exponential utility also illustrates the role of Assumption 1
29
To see that the expression converges
to (26) as r → 0 use l’Hôpital’s rule twice: limr→0 a(t; r) =

ν
limr→0 rν2 r(T − t) − 1 + e−r(T −t) = limr→0 2r
1 − e−r(T −t) (T − t) = ν2 (T − t)2 . Similarly, we have
 ν
ν
−r(T −t)
limt→T (Ta(t)
= 2 where the last equality again uses l’Hôpital’s
−t)2 = limt→T r 2 (T −t)2 r(T − t) − 1 + e
ν
2
rule twice; equivalently a(t) ∼ 2 (T − t) as t → T .

17

and how it differs from the assumption that the borrowing constraint is tighter than the
natural borrowing constraint. To this end, assume that y = 0 so that a ≥ −y/r = 0 is
also the natural borrowing constraint. Nevertheless, if utility is exponential, this does not
change the individual’s saving behavior and she still hits the borrowing constraint in finite
time. This is because with exponential utility Assumption 1 is satisfied regardless of the
borrowing constraint’s tightness.

2.3

Consumption and Saving Behavior of the Wealthy

Proposition 1 characterizes the consumption and saving behavior close to the borrowing
constraint. The following Proposition 2 characterizes consumption and saving behavior for
large wealth levels. This will be useful below, when we characterize the upper tail of the
wealth distribution.
Proposition 2 (Consumption and Saving Behavior of the Wealthy) Assume that r <
ρ, y1 < y2 and that relative risk aversion −cu00 (c)/u0 (c) is bounded above for all c.
1. Then there exists amax < ∞ such that sj (a) < 0 for all a ≥ amax , j = 1, 2, and
s2 (a) ∼ ζ2 (amax −a) as a → amax for some constant ζ2 . The wealth of an individual with
initial wealth a0 and successive high income draws y2 converges to amax asymptotically
(i.e. not in finite time): a(t) − amax ∼ e−ζ2 t (a0 − amax ).
2. In the special case of CRRA utility (5) individual policy functions are asymptotically
linear in a. As a → ∞, they satisfy
sj (a) ∼

r−ρ
a,
γ

cj (a) ∼

ρ − (1 − γ)r
a.
γ

(28)

The first part of the Proposition is the analogue of Proposition 4 in Aiyagari (1993). The
condition that −cu00 (c)/u0 (c) is bounded above for all c for example rules out exponential
utility (6) in which case γ(c) = θc.
The second part of the Proposition extends to continuous time a result by Benhabib,
Bisin, and Zhu (2015) who have shown that, with CRRA utility, consumption and saving
policy functions are asymptotically linear for large wealth. The proof makes use of a simple
homogeneity property: it shows that, for all ξ > 0, the value function v expressed as a
function of wealth a and income y satisfies v(ξa, y) = ξ 1−γ v(a, y/ξ). That is, doubling
wealth a, besides scaling everything by a factor 21−γ , effectively halves income y. Therefore,
as wealth becomes large, it is as if the individual had no labor income. And it is well-known
that the consumption-saving problem with CRRA and without labor income has an analytic
solution with linear policy functions given by (28).
18

Another way of appreciating the asymptotic linearity is again with a simple special case
without income risk. Assume that individuals have CRRA utility, (5) a deterministic stream
of labor income y > 0, and the borrowing constraint equals the natural borrowing constraint
a = −y/r. Consumption and saving policy functions then have a closed-form solution given
by
y
ρ − (1 − γ)r 
y
r−ρ
a+
,
c(a) =
a+
.
(29)
s(a) =
γ
r
γ
r
As a → ∞, y/r becomes irrelevant relative to a and the policy functions indeed satisfy (28).
The asymptotic linearity of consumption and saving policy functions with CRRA utility
has played a key role in the literature. For instance, Krusell and Smith (1998) argue that this
linearity explains their finding that the business cycle properties of their baseline heterogeneous agent model are virtually indistinguishable from its representative agent counterpart
(see Figure 2 and surrounding discussion in their paper). Future studies may want to gauge
the robustness of this result by relaxing the assumption of CRRA utility.

2.4

Marginal Propensities to Consume and Save

We now characterize further the consumption and saving policy functions and in particular
the corresponding marginal propensities to consume and save, defined as the changes in consumption and saving in response to a windfall increase in available funds a. Propositions 1
and 2 characterize the slope of the consumption function c0j (a) or, equivalently, the instantaneous MPC which captures the consumption gain (per time unit) after such a windfall
over an infinitesimally small time interval. This is an interesting object but it does not
correspond to what is measured in the data, namely the fraction of income consumed out of
a windfall income gain over a discrete time interval. We here show how to characterize this
more empirically relevant object.
Definition 1 The Marginal Propensity to Consume over a period τ is given by
0
MPCj,τ (a) = Cj,τ
(a), where
ˆ τ

Cj,τ (a) = E
cj (at )dt a0 = a, y0 = yj .

(30)
(31)

0

Similarly, the Marginal Propensity to Save over a period τ is given by
0
MPSj,τ (a) = Sj,τ
(a), where
h
i
Sj,τ (a) = E aτ a0 = a, y0 = yj .

(32)
(33)

To get a feel for the behavior of these objects and to see how they differ from their
instantaneous counterparts c0j (a) and s0j (a), it is instructive to consider a time interval τ
19

that is sufficiently small so that individuals in the low income state do not switch income
state. In this case, expected saving over a period τ for the low income type, S1,τ (a) defined
in (33), is simply given by aτ starting from a0 = a. But from Corollary 1 we know that
p
2
aτ − a ∼ ν21 ((T − τ )+ ) with T = 2(a0 − a)/ν1 , i.e.
s

S1,τ (a) ∼

ν1 
2

+ 2

2(a − a)
− τ   + a.
ν1

(34)

Differentiating this expression and using the budget constraint, we get the following result.
Corollary 2 Assume τ is sufficiently small that individuals with current income draw y1 do
not receive the high-income draw y2 ,30 that r < ρ, and that Assumption 1 holds. Then
 r

ν1
MPC1,τ (a) ∼ min τ
, 1 + τ r = min{τ c01 (a), 1 + τ r}, as a → a,
(35)
2(a − a)
where c01 (a) is the instantaneous MPC characterized in Proposition 1. Similarly MPS1,τ (a) ∼
1 + τ r − MPC1,τ (a). Alternatively, (35) holds with equality in the special case in Section 2.2
with exponential utility, deterministic income and a = r = 0.
This result yields a number of useful observations. First, in contrast to the instantaneous
MPC c01 (a) which becomes unbounded as a → a, the MPC over a time period τ in (35) is
bounded between zero and 1 + τ r. Second, for a > a and τ small enough, the marginal
propensity to consume (35) is strictly decreasing in wealth a; that is, consumption over a
period τ , C1,τ (a), is strictly concave in wealth a. Third, the key quantity determining the
size of the MPC is ν1 , the speed at which individuals hit the borrowing constraint. The
intuition for the last two properties is the same as that discussed in Section 2.2: because
wealth declines toward the borrowing constraint faster than consumption, the mapping from
wealth to consumption is concave; and the faster wealth declines, the more concave this
mapping.
In contrast, consider the second special case of Section 2.2 in which individuals never hit
the borrowing constraint in finite time. From the expression for wealth dynamics (27) we
have that savings over a period τ are given by Sτ (a) = ae−ητ where η =: (ρ − r)/γ. That
is, both consumption and saving over a period τ are linear in wealth a and therefore, the
marginal propensities to save and consume are independent of wealth:31
MPSτ (a) = e−ητ ≈ 1 − ητ,

MPCτ (a) = 1 − e−ητ + τ r ≈ τ (η + r),

30

η :=

ρ−r
.
γ

Alternatively we can take λ1 → 0 so that the low income state is close to being absorbing.
Similar expressions can be obtained in the special case from Section 2.3 in which saving and consumption
policy functions are linear throughout the wealth distribution and given by (29).
31

20

Summarizing, when people hit the borrowing constraint in finite time, MPCs depend on
wealth and, in particular, are higher for poorer people.
When individuals experience new income draws within the time interval τ , it is no longer
possible to characterize the MPC and MPS as tightly as in Corollary 2 because we lack a
characterization of c2 (a) in the vicinity of the borrowing constraint. However, the following
Lemma shows how to easily compute the MPC numerically. The key idea is that Cj,τ (a)
defined in (31) is a conditional expectation that can be easily computed using the FeynmanKac formula which establishes a link between conditional expectations of stochastic processes
and solutions to partial differential equations. Given knowledge of Cj,τ (a), we can then
0
immediately compute MPCj,τ (a) = Cj,τ
(a).
Lemma 2 (Computation of MPCs using Feynman-Kac formula) The conditional expectation Cj,τ (a) defined in (31) and therefore the MPC defined in (30) can be computed as
Cj,τ (a) = Γj (a, 0) where Γj (a, t) satisfies the system of two PDEs
0 = cj (a) + ∂a Γj (a, t)sj (a) + λj (Γ−j (a, t) − Γj (a, t)) + ∂t Γj (a, t),

j = 1, 2

on (a, ∞) × (0, τ ), with terminal condition Γj (a, τ ) = 0 for all a.
Proof: This follows from a direct application of the Feynman-Kac formula for computing
conditional expectations as solutions to partial differential equations.
Figure 4(a) plots the MPC computed according to this numerical strategy for the two
income types and assuming that individuals have CRRA utility (5). For comparison, Figure
4(b) plots the “instantaneous MPC”, i.e. the slope of the consumption function. As expected,
1
1.2

MPC1,τ (a)
MPC2,τ (a)
τ (η + r)

0.9
0.8

c′1 (a)
c′2 (a)
η+r

1

0.8

0.6

c′j (a)

MPCj,τ (a)

0.7

0.5

0.6

0.4
0.4

0.3
0.2

0.2

0.1
0

a

0

Wealth, a

a

Wealth, a

(b) Instantaneous MPC c0j (a)

(a) MPC over time period τ , MPCj,τ (a)

Figure 4: MPCs across the Wealth Distribution
the former is a smoother version of the latter and, in contrast to the latter, does not exceed
21

1 + τ r. As wealth a → ∞ the borrowing constraint becomes irrelevant and the slope of
the consumption function converges to η + r with η = (ρ − r)/γ and therefore the MPC
to τ (η + r). Finally, the strategy for computing MPCs using the Feynman-Kac formula in
Lemma 2 is extremely general. For instance, Kaplan, Moll, and Violante (2016) apply it in
a considerably more complicated setting with two assets and kinked adjustment costs.
As an aside, in some applications a slightly altered version of the MPCs in Definition
1 may be easier to map to the data. Empirical studies do not typically observe marginal
propensities to consume out of an infinitesimal increase in resources. Instead, they observe
the increase in consumption in response to a discrete increase in resources, say by $500. To
this end, define MPCxj,τ (a) := (Cj,τ (a + x) − Cj,τ (a))/x. This is the MPC out of x dollars
over a period τ , i.e. a discrete counterpart to the MPC in (30). Kaplan, Moll, and Violante
(2016) compute such discrete MPCs and compare them to various empirical studies such as
Broda and Parker (2014), Misra and Surico (2014), Blundell, Pistaferri, and Saporta-Eksten
(2016), and Fagereng, Holm, and Natvik (2016).

1

1

0.9

0.9

0.8

0.8

0.7

0.7

MPC1,τ (a)

MPC1,τ (a)

Using the Analytic Expression for ν1 to Better Understand MPCs. As part of
Proposition 1 we obtained an analytic expression (21) for ν1 , the speed of hitting the borrowing constraint. As just discussed, ν1 is also the key quantity governing the size of MPCs.
The formula (21) is therefore also useful to examine how MPCs depend on various model
parameters. In particular, it can be used to shed some light on various numerical results that
may seem counterintuitive at first. For instance, consider the dependence of the low-income
type’s MPC1,τ (a) on the low income realization y1 . This low income realization may, for
example, represent the size of unemployment benefits. Figure 5(a) graphs this relationship

0.6
0.5
0.4
0.3

0.6
0.5
0.4
0.3

Lowest Wealth
50th Percentile Wealth
95th Percentile Wealth

0.2
0.1

0.1

0
0.05

0.1

0.15

Lowest Wealth
50th Percentile Wealth
95th Percentile Wealth

0.2

0.2

Low Income Realization y1

0
0.1

0.15

0.2

0.25

High Income Realization y2

(a) MPCs and Low Income Realization

(b) MPCs and Tightness of Constraint

Figure 5: Dependence of MPCs on Parameters

22

0.3

for y1 ranging between 0 and y2 = 0.2 separately for various percentiles of the wealth distribution and assuming that individuals have CRRA utility (5). Perhaps surprisingly, the
MPC is a hump-shaped function of the low income realization y1 . But formula (21) easily
resolves the apparent mystery. With CRRA utility (5) so that the IES is constant
ν1 ≈ (ρ − r)

c1
+ λ1 (c2 − c1 ),
γ

where c1 = y1 + ra. An increase in y1 has two offsetting effects. The intuitive part is that as
y1 increases, individuals are better insured against idiosyncratic income risk and therefore
have a low MPC (as in models without risk and borrowing constraints). In the formula,
as y1 increases toward y2 , λ1 (c2 − c1 ) converges to zero and this results in a lower ν1 . But
there is an offsetting effect captured by the term (ρ − r)c1 /γ: if consumption conditional
on hitting the constraint c1 is high, individuals do not mind hitting the constraint as much.
Hence they converge to it faster or, equivalently, have a higher MPC.
Figure 5(b) instead graphs the dependence of the low income type’s MPC on the realization of the high income y2 . The MPC is increasing in y2 and the intuition can again be seen
from our formula for ν1 which shows that the MPC is higher the larger is the consumption
gain from getting a high income draw λ1 (c2 − c1 ). Other comparative statics are as follows:
individuals have higher MPCs, the lower is the interest rate r relative to the rate of rate of
time preference ρ, and the higher is the likelihood λ1 of getting a high income draw (so that
getting stuck at the constraint is less likely). Similarly, MPCs tend to be higher the higher
is the IES and the tighter is the borrowing constraint, i.e. the closer to zero is a.

2.5

The Stationary Wealth Distribution

We now present the paper’s second main theoretical result: an analytic solution to the
Kolmogorov Forward equation characterizing the stationary distribution with two income
types (8) for any given individual saving policy functions. This analytic solution yields a
number of insights about properties of the stationary wealth distribution, particularly at the
borrowing constraint and in the right tail.
The derivation of this analytic solution is constructive and straightforward and we therefore present it in the main text. Summing the KF equation (8) for the two income types,
d
we have da
[s1 (a)g1 (a) + s2 (a)g2 (a)] = 0 for all a, which implies that s1 (a)g1 (a) + s2 (a)g2 (a)
equals a constant. Because any stationary distribution must be bounded, we must then have
s1 (a)g1 (a) + s2 (a)g2 (a) = 0 for all a. Substituting into (8) and rearranging, we have
gj0 (a)


=−

s0j (a)
λj
λ−j
+
+
sj (a) sj (a) s−j (a)

23


gj (a),

j = 1, 2.

(36)

g1 (a)
g2 (a)

Saving, sj (a)

Densities, gj (a)

s1 (a)
s2 (a)

a

a

Wealth, a

(a) Stationary Saving Policy Function

Wealth, a

(b) Stationary Densities

Figure 6: Saving Behavior and Stationary Wealth Distribution with r < ρ
Importantly, (36) are two independent ODEs for g1 and g2 rather than the coupled system
of two ODEs (8) we started out with. Together with two boundary conditions they can be
solved separately. To obtain these boundary conditions, we simply impose that the densities
integrate to the mass of agents with the respective income types:
ˆ ∞
ˆ ∞
λ2
λ1
dG1 (a) =
,
dG2 (a) =
,
(37)
λ1 + λ2
λ1 + λ2
a
a
where G1 , G2 are the CDFs corresponding to g1 , g2 . We here allow for the possibility of Dirac
point masses in the distributions which will be relevant momentarily. Using the fact that
the two ODEs (36) can be solved analytically and our characterization of the optimal saving
policy functions from Section 2.2 we obtain our second main theoretical result.
Proposition 3 (Stationary Wealth Distribution with Two Income Types) Assume
that r < ρ, y1 < y2 , that relative risk aversion −cu00 (c)/u0 (c) is bounded above for all c, and
that Assumption 1 holds. Then there exists a unique stationary distribution given by
 !
ˆ a
κj
λ1
λ2
exp −
+
dx , j = 1, 2
(38)
gj (a) =
sj (a)
s1 (x) s2 (x)
a
for some constants of integration κ1 < 0 and κ2 > 0 which satisfy κ1 +κ2 = 0 and are uniquely
pinned down by (37). The stationary wealth distribution has the following properties:
1. (Close to the borrowing constraint) The stationary distribution of low income types
g1 (a) has a Dirac point mass m1 at the borrowing constraint a. More precisely, the
24

corresponding cumulative distribution function satisfies
 p

G1 (a) ∼ m1 exp λ1 2(a − a)/ν1
as a ↓ a, with
(39)
!)
(

ˆ amax
ˆ a
λ2
1
λ2
1
λ1
m1 =
m̃1 ,
= λ2
exp −
+
dx
da.
λ1 + λ2
m̃1
s2 (a)
s1 (x) s2 (x)
a
a
The stationary density of high income types at the borrowing constraint is bounded,
g2 (a) < ∞.
2. (In the right tail) The stationary wealth distribution is bounded above at some amax < ∞
defined in Proposition 2. The wealth distribution g(a) := g1 (a) + g2 (a) satisfies
g(a) ∼ ξ(amax − a)λ2 /ζ2 −1

as a → amax

(40)

where ζ2 = |s02 (amax )| and ξ is a constant. Therefore g(amax ) = 0 for large λ2 (so that
λ2 > ζ2 ). In contrast, g2 (a) → ∞ as a → amax for small λ2 . In neither case is there a
Dirac mass.
3. (Smoothness) In contrast to the analogous discrete-time economy, the density of wealth
is smooth everywhere except exactly at the borrowing constraint, i.e. for all a > a.
4. (Shape of the wealth distribution) The exact shape of g1 and g2 is ambiguous. However, both g1 and g2 are ratios of well-understood
functions,
 ´ 
 in
 particular gj (a) =
a
λ1
λ2
κj f (a)/sj (a), j = 1, 2 where f (a) := exp − a s1 (x) + s2 (x) dx and κ1 < 0, κ2 > 0.
The function f is strictly log-concave and single-peaked with f 0 (a)/f (a) → ∞ as a ↓ a
and f 0 (a)/f (a) → −∞ as a ↑ amax .
5. (Joint distribution of labor income and wealth) For any given wealth level a, the fraction
g2 (a)
of individuals that have the high income y2 , Pr(y2 |a) := g1 (a)+g
satisfies Pr(y2 |a) =
2 (a)
1
1
and similarly Pr(y1 |a) = 1 − Pr(y2 |a) = 1−s1 (a)/s2 (a) .
1−s2 (a)/s1 (a)
The Dirac property in part 1 of the Proposition follows immediately from Proposition 1 and
that individuals hit the borrowing constraint in finite time. If Assumption 1 is satisfied,
then (i) g1 in (38) explodes as a → a and (ii) there is a Dirac mass at a, G1 (a) = m1 > 0.
This is illustrated in panel (b) of Figure 6. In particular, note the spike in the density
g1 (a) at a = a. In contrast, if Assumption 1 is violated, then there is no Dirac mass. The
derivation of (39) is simple and instructive so we state it here. First, (8) implies that G1
satisfies 0 = −s1 (a)G01 (a) − λ1 G1 (a) + λ2 G2 (a). As a ↓ a, G2 (a) → 0 and hence G1 satisfies
G01 (a)/G1 (a) ∼ −λ1 /s1 (a) with solution
ˆ
G1 (a) ∼ m1 exp −
a

25

a

!
λ1
dx ,
s1 (x)

√ √
for a constant of integration m1 > 0. From Proposition 1, s1 (a) ∼ − 2ν1 a − a. Substituting in and integrating yields (39). At the end of this subsection, we discuss in more detail
the role of Assumption 1 by making use of our two simple special cases from Section 2.2.
Part 2 of the Proposition states that the stationary wealth distribution in our economy
is bounded above. Like discrete-time versions of Aiyagari-Bewley-Huggett economies with
idiosyncratic labor income risk only, our model therefore has difficulties explaining the high
observed wealth concentration in developed economies like the United States (e.g. that the
top one percent of the population own roughly thirty-five percent of total wealth). In particular, the wealth distribution in the data appears to feature a fat Pareto tail. Motivated
by this observation, we show in Section 4.4 how to extend the model to feature a stationary distribution with a Pareto tail by introducing a second, risky asset. This caveat aside,
Proposition 3 provides a complete characterization of the wealth distribution’s tail in the
vicinity of its upper bound. From (40) top wealth inequality is high (g declines towards zero
at amax only slowly) if individuals face a high likelihood of dropping out of the high income
state (λ2 is high) and if high-income types accumulate wealth only slowly (ζ2 is low). Intuitively, wealth accumulation requires both time and luck (consecutive high income draws).
And under the circumstances just mentioned, only a few individuals obtain sufficiently long
enough high income spells to accumulate large riches. Hence, wealth inequality is high.
Part 3, which can also be seen in Figure 1, highlights an important difference between our
continuous-time formulation and the traditional discrete-time one: except for the Dirac mass
exactly at the borrowing constraint a, the wealth distribution is smooth for all a > a. This is
true even though income follows a process with discrete states (a two-state Poisson process).
In contrast, the wealth distribution in discrete-time versions of Aiyagari-Bewley-Huggett
models with discrete-state income processes, tends to feature “spikes” on the interior of the
state space. See for example Figure 17.7.1 in Ljungqvist and Sargent (2004).32
Part 4 characterizes the wealth distribution for intermediate wealth levels. It shows
that the shapes of g1 and g2 in Figure 6 are not simply due to a particular numerical
example. Instead both density functions are simple ratios of well-understood functions
gj (a) = κj f (a)/sj (a) where f is defined in the Proposition and hump-shaped. For instance
consider g1 as a increases: as in Figure 6, g1 tends to be first decreasing, then increasing again
and finally decreasing. Similarly, consider g2 as a increases: it tends to be first increasing
and then decreasing (hump-shaped), again as in the Figure.
32

To see why this must happen in discrete time, consider a discrete-time Huggett economy with two income
states. All individuals with wealth a = a who get the high income draw choose the same wealth level a0 > a.
So if there is a Dirac mass at a, there must also be a Dirac mass at a0 . But all individuals with wealth a0
who get the high income draw, also choose the same wealth level a00 . So there must also be a Dirac mass
at a00 > a0 . And so on. Through this mechanism the Dirac mass at the borrowing constraint “spreads
into the rest of the state space.” In continuous time this does not happen because individuals leave the
borrowing constraint in a smooth fashion (here according to a Poisson process, i.e. a process with a random
and continuously distributed arrival time).

26

Part 5 characterizes the joint distribution of income and wealth. The fraction of high
income types conditional on wealth Pr(y2 |a) depends only on the saving rates s1 and s2 but,
perhaps surprisingly and in contrast to the fraction of high income types in the population
1
Pr(y2 ) = λ1λ+λ
, it does not depend directly on the intensities λ1 and λ2 .
2
Our Two Special Cases Again. We now briefly return to part 1 of Proposition 3 and
illustrate in more detail when and, if so, why the wealth distribution features a Dirac mass at
the borrowing constraint. To this end, consider again the two special cases without income
√
risk from Section 2.2. In the first special case with exponential utility s(a) = − 2νa. in
the second special case with CRRA utility s(a) = −ηa. To obtain a stationary wealth
distribution in the absence of income risk, assume that individuals die at rate λ. When an
individual dies, she is replaced by a newborn with starting wealth amax .33 Because r < ρ so
that everyone decumulates wealth, amax is also the upper bound of the wealth distribution
(hence the notation).
It turns out to be convenient to work with the cumulative distribution function G(a)
which satisfies34
0 = −s(a)G0 (a) − λG(a), 0 < a < amax
(41)
with boundary condition G(amax ) = 1. This equation can be solved easily: integrating
G0 (a)/G(a) = −λ/s(a) with G(amax ) = 1 we have
ˆ

amax

G(a) = exp
a


λ
dx .
s(x)

√
In the first special case with s(a) = − 2νa, the CDF in (42) becomes
 p

p
G(a) = exp λ 2a/ν − λ 2amax /ν .

(42)

(43)




p
Note in particular that m := G(0) = exp −λ 2amax /ν > 0, i.e. there is a Dirac mass
at the borrowing constraint a = 0. In contrast, in the second special case s(a) = ηa, (42)
becomes

λ/η
a
.
(44)
G(a) =
amax
Therefore G(0) = 0 i.e. there are no individuals at the borrowing constraint. As can be
seen clearly in their derivations, the difference between (43) and (44) is solely due to the
saving behavior (linearity versus unbounded derivative at a = 0) which determines whether
33

Alternatively, we could assume that newborns draw their starting wealth from some distribution Ψ with
support [0, amax ]. In this case, (41) below is identical but with an additional term +λΨ(a).
´a
34
The KF equation is 0 = −(s(a)g(a))0 − λg(a) for 0 < a < amax . Integrating and using G(a) = 0 g(x)dx
yields (41). Working with the CDF is only more convenient in this special case. In the case with two income
types above, it is instead more convenient to work with the densities.

27

individuals hit the borrowing constraint in finite time (see Section 2.2).
The special case with exponential utility and no income risk also yields some instructive
comparative statics that carry over to numerical solutions of the more general case. Death
risk at rate λ results in a higher effective discount rate ρ + λ and hence the natural formula
for the parameter governing the speed at which individuals hit the constraint is ν = (ρ −
r+
λ)/θ.qUsing 
this, the number of individuals at the borrowing constraint is m = G(0) =
exp −λ

2θamax
ρ−r+λ

. This quantity is decreasing in the coefficient of absolute risk aversion θ,

increasing in the gap ρ − r and decreasing in the Poisson rate λ.35 Numerical experiments
in the model with a two-state Poisson process for income show that the same comparative
static holds with respect to λ1 , the Poisson rate of leaving the low income state.

2.6

Stationary Equilibrium: Existence and Uniqueness

We construct stationary equilibria along the same lines as in Aiyagari (1994). That is, we fix
an interest rate r < ρ, solve the individual optimization problem (7), find the corresponding
stationary distribution from (8), and then find the interest rate r that satisfies the market
clearing condition (11), i.e. S(r) = B. While we continue to focus on the case of two
income types for the sake of continuity, all results in this section generalize to any stationary
Markovian process for income y, e.g. continuous diffusion or jump-diffusion processes.
Figure 7 illustrates the typical effect of an increase in r on the solutions to the HJB
equation (7) and the KF equation (8). An increase in r from rL to rH > rL leads to an
increase in individual saving at most wealth levels and the stationary distribution shifts to
the right. Aggregate saving S(r) as a function of the interest rate r typically looks like in
Figure 8, i.e. it is increasing. A stationary equilibrium is then an interest rate r such that
S(r) = B. But we have so far not proven that S(r) is increasing or that it intersects B
and hence there may, in principle, be no or multiple equilibria. Existence of a stationary
equilibrium can be proved with a graphical argument due to Aiyagari (1994) that is also the
foundation for a number of existence results in the literature (e.g. Acikgoz, 2016).
Proposition 4 (Existence of Stationary Equilibrium) Assume that relative risk aversion −cu00 (c)/u0 (c) is bounded above for all c and that Assumption 1 holds. Then there exists
a stationary equilibrium in our continuous-time version of Huggett’s economy.
The logic behind the proof is simple. One can show that the function S(r) defined in (11)
is continuous. To guarantee that there is at least one r such that S(r) = B, it then suffices
35

An increase in λ has two offsetting effects: on one hand, individuals approach the borrowing constraint
faster (ν), thereby increasing m; on the other hand, individuals are more likely to die before they reach the
constraint, thereby decreasing m. Differentiation of the expression for m shows that the latter effect always
dominates.

28

g1 (a; rL )
g2 (a; rL )
g1 (a; rH )
g2 (a; rH )

s2 (a; rL )

s1 (a; rH )

Densities, gj (a)

Saving, sj (a)

s2 (a; rH )

s1 (a; rL )
a

a

Wealth, a

(a) Stationary Saving Policy Function

Wealth, a

(b) Stationary Densities

Figure 7: Effect of an Increase in r on Saving Behavior and Stationary Distribution
to show that
lim S(r) = ∞,

lim S(r) = a.

r↑ρ

r↓−∞

We next turn to our third main theoretical result, namely a proof of uniqueness of a
stationary equilibrium.
Proposition 5 (Uniqueness of Stationary Equilibrium) Assume that the intertemporal elasticity of substitution is weakly greater than one for all consumption levels
IES(c) := −

u0 (c)
≥ 1 for all c ≥ 0,
u00 (c)c

(45)

and that the borrowing constraint takes the form of a strict no-borrowing limit a ≥ 0. Then:
1. Individual consumption cj (a; r) is strictly decreasing in r for all a > 0 and j = 1, 2.
2. Individual saving sj (a; r) is strictly increasing in r for all a > 0 and j = 1, 2.
3. An increase in the interest rate leads to a rightward shift in the stationary distribution
in the sense of first-order stochastic dominance: Gj (a; r), j = 1, 2 is strictly decreasing
in r for all a in its support.
4. Aggregate saving S(r) is strictly increasing and hence our continuous-time version of
Huggett’s economy has at most one stationary equilibrium.
We briefly sketch key steps in the proof. Part 1 makes use of an important result by
Olivi (2017) who analyzes the continuous-time income fluctuation problem put forth in the
29

r=ρ

r

a=a
S(r)

B

Figure 8: Equilibrium in the Bond Market
current paper and shows that the consumption response to a change in the interest rate can
be decomposed into substitution and income effects as:
1
∂cj (a)
= 00
E0
∂r
u (c0 )
|

ˆ

τ
−

0

e
{z

´t
0

1
u (ct )dt + 00
E0
u (c0 )
} |

ˆ

ξs ds 0

substitution effect<0

τ

e−
0

´t

ξs ds 00

u (ct )(∂a ct )at dt
{z
}

0

income effect>0

with ξt := ρ − r + ∂a ct > 0 and where τ := inf{t ≥ 0|at = 0} is the stopping time at which
wealth reaches the borrowing constraint. Here the expectations are over sample paths of
(at , yt ) starting from (a0 , y0 ) = (a, yj ) and ∂a ct is short-hand notation for the instantaneous
MPC ∂a ct = c0j (at ). Olivi (2017) further simplifies these substitution and income effects
and expresses them in terms of potentially observable sufficient statistics like the MPC. We
instead pursue a different avenue: we show that a sufficient condition for the substitution
effect dominating the income effect and hence ∂cj (a)/∂r < 0 for all a > 0 is that the IES is
weakly greater than one.
Part 2 uses the budget constraint sj (a) = yj + ra − cj (a). If consumption is decreasing in
r then this immediately implies that saving is increasing in r for a ≥ 0. Because there is a
positive mechanical effect of r on saving through interest income ra, the assumption that the
IES is greater than one is likely overly strong and saving may also be increasing in r if the
IES is less than one. Consistent with this idea, consider the simple deterministic example
with CRRA utility in (29): whether consumption is increasing in r depends on the IES 1/γ;
but saving s(a) is increasing in a independently of 1/γ.36 Future work should try to prove
uniqueness under weaker assumptions than the IES being greater than one. Either way,
36

Differentiating s(a) in (29) yields

∂s(a)
∂r

=

1
γ

a+

yρ
r r

30



which is positive for all a ≥ −y/r as long as r < ρ.

IES(c) ≥ 1 is an intuitive assumption and it includes the commonly used case of logarithmic
utility IES(c) = 1.
Part 3, first-order stochastic dominance, uses a method for characterizing the dependence
of solutions to partial differential equations on parameters, i.e. doing “comparative statics,”
without solving them. Since this method may be useful in other applications, we explain it
briefly in the context of the simple example without income uncertainty (41). The key idea
is to derive an equation for f (a) := ∂G(a)
and to prove that f (a) < 0 for all a ∈ (0, amax ).
∂r
g(a) − s(a)f 0 (a) − λf (a) with
Differentiating (41) with respect to r we have 0 = − ∂s(a)
∂r
f (amax ) = 0. Next and to obtain a contradiction, suppose that f (a) ≥ 0 for some a. Since
f (amax ) = 0 and if f (0) = 0,37 f has to attain a maximum at some interior a∗ at which
∗)
f (a∗ ) ≥ 0 and f 0 (a∗ ) = 0. Therefore λf (a∗ ) = − ∂s(a
g(a∗ ) < 0 but this contradicts the
∂r
assumption that f (a∗ ) ≥ 0 and hence proves the result. Again, the method is considerably
more general.
Finally, first-order stochastic dominance of the wealth distribution immediately implies
that aggregate asset supply is increasing in the interest rate and hence uniqueness of the
stationary equilibrium (Part 4).38

2.7

Soft Borrowing Constraints and Non-Participation

Empirical wealth distributions typically have the following properties: there are individuals
with both positive and negative net worth but there is a spike at close to zero net worth.
This empirical observation does not square well with the Aiyagari-Bewley-Huggett model
we have considered thus far. If we set the borrowing constraint to a = 0, we get the spike
at zero but there are no individuals with negative net worth; if we set a < 0, we get a spike
at a strictly negative wealth level. Both are counterfactual. A simple way of generating the
empirical observation just mentioned is to model a “soft” borrowing constraint as opposed
to the “hard” constraint (3), that is, a wedge between borrowing and saving rates. This
form of constraint is used in a number of recent papers including Alonso (2016) and Kaplan,
Moll, and Violante (2016). In this section, we provide the first theoretical characterization
of such soft borrowing constraints.
Consider the Huggett model from Section 1 with one modification: there is a wedge
between borrowing and lending rates. That is, we replace the budget constraint (2) by

r ,
a≥0
+
ȧt = yt + r(at )at − ct , r(a) =
,
r− > r+ .
r− ,
a<0
Since G(0) > 0, it is typically not true that f (0) = ∂G(0)
∂r = 0 but this assumption can be easily relaxed.
Acikgoz (2016) provides a numerical example of multiple steady states in an Aiyagari-Bewley-Huggett
model with an IES of 1/6.5, i.e. considerably below one, as well as a somewhat special income process.
37

38

31

We show below that, in order to obtain a stationary wealth distribution with a spike at zero
and positive mass on both sides of zero, it is necessary to introduce more than two income
types. In particular, the simplest extension of the model that yields the desired result is to
have three income types i.e. yt ∈ {y0 , y1 , y2 } with y0 < y1 < y2 .
The next Proposition characterizes the saving behavior with a soft borrowing constraint.
To avoid the somewhat cluttered notation resulting from considering three income types, it
only considers the deterministic case yt = y for all t. This case has all the intuition and the
extension to stochastic income is straightforward.
Proposition 6 (Saving Behavior with Soft Borrowing Constraint) Assume that r+ <
ρ < r− , that yt = y for all t and that y > 0 (so that −u00 (y)/u0 (y) < ∞, the analogue of
Assumption 1). Then the solution to the HJB equation (7) and the corresponding saving
policy function (9) have the following properties:
1. s(0) = 0 but s(a) < 0 all a > 0 and s(a) > 0 all a < 0.
2. close to a = 0, the saving and consumption policy functions satisfy
p
s(a) ∼ − 2ν+ a,
s(a) ∼

p

2ν− a,

1
c (a) ∼ r +
2

r

1
c0 (a) ∼ r +
2

r

0

2ν+
,
a

ν+ :=

(ρ − r+ )u0 (y)
>0
−u00 (y)

as a ↓ 0,

2ν−
,
a

ν− :=

(ρ − r− )u0 (y)
<0
−u00 (y)

as a ↑ 0.

This implies that the derivatives of s and c are unbounded at zero, with s0 (a) → −∞
and c0 (a) → ∞ both as a ↑ 0 and a ↓ 0.
3. Individuals with a > 0 decumulate wealth and hit a = 0 in finite time. Individuals with
a < 0 instead accumulate wealth and also hit a = 0 in finite time.
The main takeaway from the Proposition is that a soft borrowing constraint results in an
interesting symmetry in the saving policy function around zero net worth. To understand
this property consider the blue solid line labelled s1 (a) in Figure 9(a) (we will return to the
other two lines below). The behavior for a > 0 with a soft borrowing constraint is identical
√
to that with a hard borrowing constraint but at a = 0: as a ↓ 0 it behaves like − a. See for
example Figure 1(b). The main takeaway from the Proposition is that the behavior of the
saving policy function for a < 0 is simply a mirror image around the forty-five degree line
√
of the behavior for a > 0: as a ↑ 0 it behaves like −a.39 A simple extension of Corollary
1 then implies that individuals with a > 0 decumulate wealth and hit a = 0 in finite time;
individuals with a < 0 instead accumulate wealth and also hit a = 0 in finite time.
0
Interestingly, for a < 0 the consumption function is convex, that is, the instantaneous
p MPC c (a) is
0
increasing in wealth a. See the Proposition which, ignoring constants, shows that c (a) ∼ 1/(−a) as a ↑ 0.
39

32

s0 (a)
s1 (a)
s2 (a)
Saving, sj (a)

Densities, gj (a)

g0 (a)
g1 (a)
g2 (a)

Wealth, a

Wealth, a

(a) Stationary Saving Policy Function

(b) Stationary Densities

Figure 9: Saving Behavior and Wealth Distribution with Soft Borrowing Constraint
Of course with only one income type, the stationary wealth distribution will only be a
Dirac point mass at a = 0. With two income types, it will be a Dirac mass at a = 0 combined
with some mass either to the left (a < 0) or to the right (a > 0) but not both. Therefore to
speak to the empirical observation of a spike at zero combined with mass both to the left and
the right of zero it is necessary to introduce (at least) another income type. Figure 9(a) plots
the saving policy functions in such a version with three income types y0 < y1 < y2 . Figure
9(b) plots the resulting wealth densities g0 , g1 and g2 . The unconditional wealth distribution
is the sum of these three densities. As expected, it has a spike at zero and mass both to the
left and the right.

3

Computation

We now describe our algorithm for numerically computing equilibria of continuous-time heterogeneous agent models. We use a finite difference method based on work by Achdou and
Capuzzo-Dolcetta (2010) and Achdou (2013) which is simple, efficient and easily extended
to other environments. We explain our method in the context of the baseline heterogeneous
agent model of Section 1. But the algorithm is, in fact, considerably more general and
applies to any heterogeneous agent model with a continuum of atomistic agents (and without aggregate shocks). It is particularly well-suited for computing transition dynamics and
solving problems with non-convexities, a fact we illustrate in Section 4 by computing equilibria of such economies. Codes for these applications (and many more) are available from
http://www.princeton.edu/∼moll/HACTproject.htm in Matlab as well as Python, Julia and
C++.
33

3.1

Computational Advantages relative to Discrete Time

Before explaining our algorithm, we provide a brief overview of some of its computational
advantages relative to traditional discrete-time methods. We here list four computational
advantages that we consider crucial and that contribute notably to the efficiency gains over
traditional methods. The first of these advantages is special to the solution of problems with
borrowing constraints. The second to fourth advantages concern the solution of heterogeneous agent models more broadly (e.g. models with heterogeneous firms).
To appreciate the first two advantages, contrast the first-order condition of the continuoustime income fluctuation problem (7) with that in the analogous discrete-time problem. For
concreteness also assume CRRA utility (5) so that the two conditions are
c−γ = vj0 (a),
c

−γ

≥β

2
X

j = 1, 2
πjk vk0 (a0 ),

in continuous time and
a0 = yj + (1 + r)a − c,

j = 1, 2

(46)
(47)

k=1

in discrete time, where 0 < β < 1 is a discount factor and πjk = Pr(y 0 = yk |y = yj ) are
the entries of the Markov transition matrix for the analogous discrete-time income process.
The first advantage of our continuous-time approach is that, as explained in Section 1.2, the
borrowing constraint (3) only shows up in the boundary condition (10) and therefore the
first-order condition (46) holds with equality everywhere in the interior of the state space.
In contrast, the discrete-time first-order condition (47) holds with complementary slackness
and therefore is an inequality. This is because the borrowing constraint may bind one time
period ahead. Continuous time allows us to completely sidestep any technical difficulties
arising due to such occasionally binding constraints.
Second and related, the first-order condition in (46) is “static” in the sense that it only
involves contemporaneous variables. Given (a guess for) the value function vj (a) it can
be solved by hand: cj (a) = (vj0 (a))−1/γ , j = 1, 2. In contrast, the discrete-time condition
(47) defines the optimal choice only implicitly. Typical solution methods therefore employ
costly root-finding operations. Our continuous-time approach again sidesteps this difficulty.40
Intuitively, discrete time distinguishes between “today” and “tomorrow” but in continuous
time, “tomorrow” is “today.”41
The third advantage of continuous time is a form of “sparsity.” To solve the HJB and
KF equations (7) and (8), we discretize these so that their solution boils down to solving
40

In this regard, it shares some similarities with the “endogenous grid method” of Carroll (2006). The
difference is that in continuous time this also works with “exogenous grids.”
41
Related, (46) also does not involve an expectation operator as in (47) that makes it necessary to calculate
a summation over future income states or a costly numerical integral (in the context of more general income
processes). Instead the HJB equation (7) captures the evolution of the stochastic process for yt with an
additive terms λj (v−j (a) − vj (a)) that does not affect the first-order condition.

34

systems of linear equations. The resulting matrices are typically extremely sparse, namely
“tridiagonal” or at least “block-tridiagonal.” This sparsity generates considerable efficiency
gains because there are well-developed routines for solving sparse linear systems, either
implemented as part of commercial software packages like Matlab or open-source libraries
like SuiteSparse. The reason that tridiagonal matrices arise is that a discretized continuoustime process either stays at the current grid point, takes one step to the left or one step to
the right. But it never jumps.42
Fourth, in all heterogeneous agent models, there is a tight link between solving the HJB
and KF equations. One can typically “kill two birds with one stone” in the sense that,
having computed the solution to the HJB equation one gets the solution to the KF equation
“for free”: the matrix in the discretized version of the latter is the transpose of the matrix
in that of the former. The underlying mathematical reason is that the KF equation is the
“transpose problem” of the HJB equation or, more precisely, that the differential operator
in the KF equation is the adjoint of the operator in the HJB equation.43

3.2

Bird’s Eye View of Algorithm for Stationary Equilibria

Our aim is to calculate stationary equilibria – functions v1 , v2 and g1 , g2 and a scalar r
satisfying (7), (8) and (11) – given a specified function u, and values for the parameters
ρ, λ1 , λ2 and a. Transition dynamics are the subject of Section 3.5. Before we describe the
algorithm in detail, we provide a bird’s eye view of the algorithm’s general structure. We
focus on two distinct challenges. First, the HJB and KF equations describing a stationary
equilibrium are coupled and one therefore has to iterate on them somehow. Second, solving
these differential equations requires approximating the value function and distribution.
Iterating on the Equilibrium System From a bird’s eye perspective our algorithm for
solving the stationary equilibrium shares many similarities with algorithms typically used
to solve discrete-time heterogeneous agent models. In the context of our Huggett economy,
we use a bisection algorithm on the stationary interest rate. We begin an iteration with an
initial guess r0 . Then for ` = 0, 1, 2, ... we follow
1. Given r` , solve the HJB equation (7) using a finite difference method. Calculate the
saving policy function s`j (a).
42

Except of course if the process is a Poisson process, i.e. if jumps are “built in.” That being said, the
sparsity property survives as long as there is at least one continuously moving state variable (like wealth),
i.e. not all individual state variables follow discrete-state Poisson processes.
43
In principle, one can use an analogous approach in discrete time: form the endogenous Markov transition
matrix between states and use it both to iterate backward over value functions (or Euler equations) and to
iterate forward over distributions. This method does not appear to be very popular and researchers typically
use Monte-Carlo simulation to solve for the distribution. A possible reason is that transition matrices are
not (or less) sparse resulting in a less dramatic efficiency gain.

35

2. Given s`j (a), solve the KF equation (8) for gj` (a) using a finite difference method.
´∞
3. Given gj` (a), compute the net supply of bonds S(r` ) = a a(g1` (a) + g2` (a))da and
update the interest rate: if S(r` ) > B, decrease it to r`+1 < r` and vice versa.
When r`+1 is close enough to r` , we call (r` , v1` , v2` , g1` , g2` ) a stationary equilibrium. As
already noted, this algorithm is extremely close to typical algorithms used to solve a discretetime Huggett economy. The difference of our continuous-time approach – and the resulting
efficiency gains – instead lie in the solutions of the dynamic programming equation and the
equation describing the distribution.
Discretization of the Equilibrium System In order to solve the differential equations
(7) and (8), the value function and distribution need to be approximated in some fashion.
We explain our approach – a finite difference method – in more detail in the next two
subsections. But a brief sketch is as follows. In a nutshell, the key idea is that this finite
difference method transforms our system of differential equations into a system of sparse
matrix equations. With this goal in mind, we approximate both v1 , v2 and g1 , g2 at I discrete
points in the space dimension, ai , i = 1, ..., I. Denote the value function and distribution
along this discrete grid using the vectors v = (v1 (a1 ), ..., v1 (aI ), v2 (a1 ), ..., v2 (aI ))T and g =
(g1 (a1 ), ..., g1 (aI ), g2 (a1 ), ..., g2 (aI ))T ; both v and g are of dimension 2I × 1, the total number
of grid points in the individual state space. The end product of our discretization method
will then be the following system of matrix equations:
ρv = u(v) + A(v; r)v,

(48)

0 = A(v; r)T g,

(49)

B = S(g; r).

(50)

The first equation is the discretized HJB equation (7), the second equation is the discretized
KF equation (8) and the third equation is the discretized market clearing condition (11).
The 2I × 2I matrix A(v; r) will have the interpretation of a transition matrix that captures
the evolution of the idiosyncratic state variables in the discretized state space. It will turn
out to be extremely sparse. A(v; r)T in the second equation denotes the transpose of that
same matrix, i.e. the discretized KF equation is the “transpose problem” of the discretized
HJB equation. As already noted, (48) to (50) is simply a system of sparse matrix equations
that can be easily solved on a computer by following (the analogues of) Steps 1 to 3 described
in the previous paragraph.

36

3.3

Step 1: Solving the HJB Equation

For step 1, we solve the HJB equation (7) using a finite difference method. We now explain
this approach. The Online Appendix contains a more detailed explanation.
Theory for Numerical Solution of HJB Equations (Barles-Souganidis) Before
we explain our approach we should note that there is a well-developed theory concerning
the numerical solution of HJB equations using finite difference schemes in the same way as
there is a well-developed theory concerning the numerical solution of discrete-time Bellman
equations. The key result is due to Barles and Souganidis (1991) who have proven that,
under certain conditions, the solution to a finite difference scheme converges to the (unique
viscosity) solution of the HJB equation.44 The interested reader should consult Barles and
Souganidis’ original (and relatively accessible) paper or the introduction by Tourin (2013). In
short, for their result to hold, the finite difference scheme needs to satisfy three conditions: (i)
“monotonicity”, (ii) “stability” and (iii) “consistency.” These are spelled out in the Online
Appendix. Here it suffices to note that (ii) and (iii) are typically easy to satisfy and, in
practice, the main difficulty for the numerical solution of HJB equations is to design a finite
difference scheme that satisfies (iii), the monotonicity condition.
Finite Difference Method We here explain the finite difference method for solving the
stationary HJB equation for a special case we have already examined earlier in the paper,
namely the one with no income uncertainty y1 = y2 = y. The generalization to income risk
is straightforward. The HJB equation in this special case is
ρv(a) = max u(c) + v 0 (a)(y + ra − c).

(51)

c

As already mentioned, the finite difference method approximates the function v at I discrete
points in the space dimension, ai , i = 1, ..., I. We use equispaced grids, denote by ∆a the
distance between grid points, and use the short-hand notation vi := v(ai ). The derivative
vi0 = v 0 (ai ) is approximated with either a forward or a backward difference approximation
v 0 (ai ) ≈

vi+1 − vi
0
=: vi,F
∆a

or

v 0 (ai ) ≈

vi − vi−1
0
=: vi,B
.
∆a

The finite difference approximation to (51) is then
ρvi = u(ci ) + vi0 si ,
44

si := y + rai − ci ,

ci = (u0 )−1 (vi0 ),

i = 1, ..., I

See Appendix C.1 for an “economist-friendly” introduction to the theory of viscosity solutions.

37

(52)

where vi0 is either the forward or backward difference approximation. Which of the two
approximations is used and where in the state space is extremely important. The reason
is that this choice determines whether Barles and Souganidis’ monotonicity condition is
satisfied.
Upwinding As just mentioned, it is important whether and when a forward or a backward
difference approximation is used. The ideal solution to this problem is to use a so-called
“upwind scheme.” The rough idea is to use a forward difference approximation whenever the
drift of the state variable (here, saving si = y + rai − ci ) is positive and to use a backward
difference whenever it is negative. This is intuitive: if saving is positive, what matters is
how the value function changes when wealth increases by a small amount; and vice versa
when saving is negative. The right thing to do is therefore to approximate the derivative in
the direction of the movement of the state. To this end use the notation s+
i = max{si , 0},
+
−
i.e. si is “the positive part of si ” and analogously si = min{si , 0}. The upwind version of
(52) is then
vi+1 − vi + vi − vi−1 −
si +
si ,
i = 1, ..., I,
(53)
ρvi = u(ci ) +
∆a
∆a
where also the finite difference approximation vi0 used to compute ci = (u0 )−1 (vi0 ) depends on
the sign of si in the same way. This simplified exposition ignores two important and related
issues. First, that the HJB equation (51) is highly non-linear due to the presence of the max
operator, and therefore so is its finite difference approximation (53). It therefore has to be
solved using an iterative scheme and one faces a choice between using so-called “explicit”
and “implicit” schemes. Related, from the first-order condition ci = (u0 )−1 (vi0 ), saving si
and consumption ci themselves depend on whether the forward or backward approximation
is used so (53) has a circular element to it. The solution to both these issues is described in
detail in the Online Appendix.
The upwind finite difference scheme for the HJB equation (53) can be conveniently written
in matrix notation. Denoting by v = (v1 , ..., vI )T the vector collecting the value function at
different grid points, we have the matrix equation (48). The matrix A(v; r) has a special
structure: first, it is sparse; more precisely, it is tridiagonal: all entries are zero except
for those on the main diagonal, the first diagonal below this, and the first diagonal above
s−
s+
i
i
the main diagonal. Second, all diagonal entries are negative and given by ∆a
− ∆a
≤ 0
s−

s+

i
i
and all off-diagonal entries are positive and given by − ∆a
≥ 0 and ∆a
≥ 0. Third, all
rows of A(v; r) sum to zero. All these properties are extremely intuitive. In effect, the
finite difference method approximates the law of motion for the continuous state variable
a with a discrete-state Poisson process on the grid ai , i = 1, ..., I and the matrix A(v; r)
summarizes the corresponding Poisson intensities. The properties noted above are precisely
the properties that a Poisson transition matrix needs to satisfy. For these reasons we will
sometimes refer to A(v; r) as “Poisson transition matrix” or “intensity matrix.” All this will

38

be useful in Section 3.4 below when we solve the KF equation (8).
Boundary Conditions and Handling the Borrowing Constraint Besides guaranteeing that the Barles-Souganidis monotonicity condition holds, an upwind scheme like (53)
has an additional great advantage: the handling of boundary conditions. First, consider the
upper end of the state space aI . If this upper end is large enough, saving will be negative
45
sI < 0 so that s+
It can then be seen from (53) that the forward difference is never
I = 0.
used at the upper end of the state space. As a result no boundary condition needs to be
imposed. Next, consider the lower end of the state space and in particular the question how
to impose the state constraint boundary condition (10) which holds with equality only when
the constraint binds. To impose this, we can exploit the special structure of the upwind
scheme: set the boundary condition
0
v1,B
= u0 (y + ra1 )

but only for the backward difference approximation and not for the forward difference ap0
which is instead computed as (v2 − v1 )/∆a. Then let the upwind scheme
proximation v1,F
itself select whether this boundary condition is used. From (53) we can see that the boundary condition is only imposed if it would be the case that s1 < 0; but it is not used if s1 > 0.
This ensures that the borrowing constraint is never violated.

3.4

Step 2: Solving the Kolmogorov Forward Equation

For step 2, consider the stationary Kolmogorov Forward equation (8). We again discretize
the equation using a finite difference scheme. In contrast to the HJB equation which is
non-linear in v, the KF equation is linear in g. Its discretized counterpart can therefore
be solved in one iteration. There are a number of potentially admissible finite difference
schemes, but one of these is particularly convenient and deeply rooted in mathematical
theory: the discretization (49) which involves the transpose of A(v, r), the transition matrix
of the discretized stochastic process in (a, yj )-space.
The deep underlying reason for this choice of discretization is that the KF equation
actually is the “transpose” problem of the HJB equation. More precisely, the differential
operator in the KF equation (8) is the adjoint of the operator in the HJB equation (7),
the “infinitesimal generator.”46 Our transpose discretization of the KF equation (49) is not
45
In fact, in the special case without uncertainty analyzed in the present section and under the assumption
r < ρ, saving is negative everywhere in the state space. The condition that aI needs to be large enough
really only matters for the case with uncertainty. That the case without uncertainty is special also applies
to the subsequent discussion: without uncertainty the state constraint (10) always holds with equality.
46
The “infinitesimal generator” is the continuous-time analogue of a discrete-time transition matrix, and
the adjoint of an operator is the infinite-dimensional analogue of a matrix transpose. In our context, the

39

only well-founded in mathematics; it is also extremely convenient: having solved the HJB
equation, the solution of the Kolmogorov Forward equation is essentially “for free.”
The same numerical method – building the matrix A and then working with its transpose
– can also be used when solving problems that involve only the KF equation, e.g. because
the optimal decision rules can be solved for analytically. This approach is, for example,
pursued in Jones and Kim (2014) and Gabaix, Lasry, Lions, and Moll (2016).47
Finally, some readers may be concerned that the presence of a Dirac point mass in the
stationary wealth distribution g1 may cause problems for our finite difference method. We
show in Appendix D that this is not the case. First, we show theoretically that the only
implication of the Dirac mass is that some care is required when interpreting the output of
the numerical algorithm, in particular the first element of the vector g (corresponding to
the density of income type y1 at the point a = a). Second, we use the analytic solution for
the wealth distribution in Proposition 3 as a test case for our numerical algorithm and show
that it performs extremely well in practice unless the wealth grid is very coarse.

3.5

Computing Transition Dynamics

The algorithm we use to calculate time-varying equilibria – functions v1 , v2 , g1 , g2 and r
satisfying (4), (12) and (13) given an initial condition (16) and a terminal condition (17) –
is the natural generalization of that used to compute stationary equilibria. We again use a
bisection method, this time on the entire function r(t). We begin an iteration with an initial
guess r0 (t), t ∈ (0, T ). Then for ` = 0, 1, 2, ... we follow
1. Given r` (t) and the terminal condition (17), solve the HJB equation (12), marching
backward in time. Calculate the saving policy function s`j (a, t).
2. Given s`j (a, t) and the initial condition (16), solve the KF equation, marching forward
in time, for gj` (a, t).
´∞
3. Given gj` (a, t), compute the net supply of bonds S ` (t) = a a(g1` (a, t) + g1` (a, t))da and
`

update the interest rate as r`+1 (t) = r` (t) − ξ dSdt(t) where ξ > 0.
infinitesimal generator captures the evolution of the process in (a, yj )-space. This operator – let us denote
it by A – is defined as follows: for any vector of functions [f1 (a), f2 (a)]T


  0
f (a)
f (a)s1 (a) + λ1 (f2 (a) − f1 (a))
.
A 1
= 10
f2 (a)s2 (a) + λ2 (f1 (a) − f2 (a))
f2 (a)
∗
Next, one can show that the operator

in the KF equation (8) is the adjoint of this operator: denoting by A
g (a)
the adjoint of A, (8) is 0 = A∗ 1
. Equation (49) is the discretized version of this problem.
g2 (a)
47
Festa, Gomes, and Velho (2017) develop the idea of exploiting the adjoint property of the KF equation
more systematically, also in the context of alternative numerical schemes (e.g. a semi-Lagrangean scheme).

40

When r`+1 (t) is close enough to r` (t) for all t, we call (r` , v1` , v2` , g1` , g2` ) an equilibrium.
The finite difference method used for computing the time-dependent HJB and KF equations for a given time path r` (t) is similar to those used to compute their stationary counterparts. In addition to discretizing wealth a, we now also discretize time t on a grid
tn , n = 1, ..., N , for instance with equal-sized time steps of length ∆t. Denoting by vn and
gn the stacked, discretized value function and distribution at time tn , the time-dependent
version of the discretized equilibrium system (48) to (50) becomes
ρvn = u(vn+1 ) + A(vn+1 ; rn )vn +

vn+1 − vn
,
∆t

gn+1 − gn
= A(vn ; rn )T gn+1 ,
∆t
B = S(gn ; rn ),
for time steps n = 1, ..., N , with terminal condition vN = v where v is the steady state
solution to (48) and with initial condition g1 = g0 . All this is explained in more detail in
the Online Appendix.

3.6

The Method’s Performance: Some Illustrative Results

All of Figures 1, 6 and 8 for the Huggett economy in Section 1 earlier in the paper were
computed using a Matlab implementation of the algorithm just laid out. Even though we
work with a fine wealth grid with I = 1000 grid points, solving for a stationary equilibrium
takes about 0.25 seconds on a MacBook Pro laptop computer. Next, consider the corresponding transition dynamics. With I = 1000 wealth grid points, N = 400 time steps and
the same hardware, computing (12) and (13) for a fixed time path r(t) takes about 2 seconds.
Iterating on r(t) until an equilibrium transition is found takes about 4 minutes (even though
market clearing conditions like (4) that implicitly define prices are notoriously difficult to
impose during transitions).48
48

In contrast, computing transitions for the Aiyagari model in Section 4.2, where prices are explicit
functions of the aggregate capital stock as in (61), takes only 1 minute and 40 seconds. The code
for the stationary equilibrium and transition dynamics of the Huggett model are available at http:
//www.princeton.edu/∼moll/HACTproject/huggett equilibrium iterate.m and http://www.princeton.edu/
∼moll/HACTproject/huggett transition.m. The code for the Aiyagari model is at http://www.princeton.
edu/∼moll/HACTproject/aiyagari poisson MITshock.m.

41

3.7

Relation to Candler (1999) and Alternatives to Finite Difference Method

Candler (1999) has previously used a finite difference method to solve HJB equations arising
in economics (with the neoclassical growth model as his prime example) and also discusses
upwinding. Our numerical method adds to his in three dimensions. First and most obviously,
we consider coupled HJB and KF equations rather than just the HJB equation in isolation:
the system (7), (8) and (11) rather than just (7). We show that there is a tight mapping
between the KF equation and the HJB equation and that this mapping can be conveniently
exploited in finite difference schemes (the adjoint/transpose property discussed in Section
3.4). Candler, in contrast, does not discuss Kolmogorov Forward equations. Second, even
when considered in isolation, our HJB equation differs from Candler’s and this is reflected
in the solution method. In particular, we show how to handle borrowing constraints by
mathematically casting them as state constraints (a step that requires using the notion of
viscosity solution) and designing an upwind method that respects these constraints. Borrowing constraints are, of course, a ubiquitous feature of heterogeneous agent models. Third,
we show that our solution method has well-developed theoretical underpinnings by making
the connection to the Barles and Souganidis (1991) convergence theory.
Besides the finite difference method, there are many alternative methods for solving
partial differential equations in general and HJB and KF equations in particular. Examples include finite-element, finite-volume, semi-Lagrangean, and Markov-chain approximation methods as well as approximation via orthogonal (e.g. Chebyshev) polynomials.49 In
principle, these other methods can also be used to solve heterogeneous agent models of the
type discussed here; in particular by following the same Steps 1 to 3 laid out in Section 3.2
but simply exchanging the solution method used within Steps 1 and 2.
There is no sense in which the finite difference method laid out here dominates these
other methods. In fact, some of these other methods may even be more accurate for coarse
discretizations of the value function and distribution. We nevertheless prefer it over other
methods for two reasons. First, the finite difference method is transparent and easy to
implement. In case the algorithm spits out junk, it is usually easy to track down the problem. Second, and as explained in Section 3.4, the finite difference method delivers a useful
symmetry in the solution methods for the HJB and KF equations (that the matrix in the
latter is the transpose of that in the former). Other methods typically do not have this
property. Finally, because the finite difference method is fast, choosing fine grids is usually
49

Some of these methods have also been used in economics. For example, Golosov and Lucas (2007) and
Barczyk and Kredler (2014) use the Markov Chain approximation method of Kushner and Dupuis (2013).
Because some of our paper’s readers have wondered about this in the past, we should emphasize that a finite
difference method is different from the Kushner-Dupuis method: their approach essentially transforms the
continuous-time problem into a discrete-time problem and then solves it using value function iteration.

42

not costly and hence it is not a concern that other methods may be more accurate with
coarse discretizations.

4

Generalizations and Other Applications

Sections 4.1 and 4.2 discuss generalizations of the baseline Huggett model we have analyzed
thus far. Sections 4.3 to 4.6 present a number of other theories, mostly to showcase the
portability of our computational algorithm.

4.1

More General Income Processes

Our baseline model assumed that income yt takes one of two values, high and low. We now
extend many of our results to an environment with a continuum of productivity types.50 In
particular, the computational algorithm laid out in Section 3 carries over without change.
This is true even though the system of equations describing an equilibrium will be a system
of PDEs rather than a system of ODEs.
As in Section 1.1, there is a continuum of individuals that are heterogeneous in their
wealth a and income y. The state of the economy is the joint distribution of income and
wealth g(a, y, t). The simplest way of introducing a continuum of income types is to work
with a continuous diffusion process. Individual income evolves stochastically over time on a
bounded interval [y, ȳ] with ȳ > y ≥ 0, according to the stationary diffusion process51
dyt = µ(yt )dt + σ(yt )dWt .

(54)

This is simply the continuous-time analogue of a Markov process (without jumps). Wt is a
Wiener process or standard Brownian motion and the functions µ and σ are called the drift
and the diffusion of the process. We normalize the process such that its stationary mean
equals one. An individual’s problem is now to maximize (1) subject to (2), (3) and (54),
taking as given the evolution of the interest rate rt for t ≥ 0.52
Similarly to Section 1, a stationary equilibrium can be written as a system of partial
differential equations. The problem of individuals and the joint distribution of income and
50
Among the theoretical results, we extend Propositions 1, 2, 4 and 5. That is, all Propositions from
Section 2 with the exception of Propositions 3 (the analytic solution for the stationary distribution with two
income types) and 6 (soft borrowing constraint with deterministic income).
51
The process (54) either stays in the interval [y, ȳ] by itself or is reflected at y and ȳ. From a theoretical
perspective there is no need for restricting the process to a bounded interval, and unbounded processes can
be easily analyzed. Instead the motivation for this assumption is purely practical: we ultimately solve the
problem numerically and any computations necessarily require income to´lie in a bounded
interval.

´s
∞
52
The corresponding “natural borrowing constraint” is now at ≥ −y t exp − t rτ dτ ds. As before,
the borrowing constraint a only binds if it is tighter than this “natural” borrowing limit.

43

wealth satisfy stationary HJB and KF equations:
1
ρv(a, y) = max u(c) + ∂a v(a, y)(y + ra − c) + ∂y v(a, y)µ(y) + ∂yy v(a, y)σ 2 (y),
c
2
1
2
0 = − ∂a (s(a, y)g(a, y)) − ∂y (µ(y)g(a, y)) + ∂yy (σ (y)g(a, y)).
2

(55)
(56)

on (a, ∞) × (y, ȳ). The function s is the saving policy function
s(a, y) = y + ra − c(a, y),

where c(a, y) = (u0 )−1 (∂a v(a, y)).

(57)

The function v again satisfies a state constraint boundary condition at a = a which is now
∂a v(a, y) ≥ u0 (y + ra),

all y.

(58)

Because the diffusion is reflected at y and ȳ, the value function also satisfies the boundary
conditions
∂y v(a, y) = 0,
∂y v(a, ȳ) = 0, all a.
(59)
A stationary equilibrium is a scalar r and functions v and g satisfying the PDEs (55) and
(56) with s given by (57), boundary conditions (58), (59), with an equilibrium condition
´ ȳ ´ ∞
analogous to (11), namely y a ag(a, y)dady = B. Transition dynamics again satisfy a
system of time-dependent PDEs analogous to that in Section 1.
Importantly, the computational algorithm laid out in Section 3 carries over without
change: from a computational perspective it is immaterial whether we solve a system of
ODEs like (7) and (8) or a system of PDEs like (55) and (56). This would not be true if we
had relied on an pre-built ODE solver (say one that is part of Matlab) to solve the ODEs
(7) and (8).
Other income processes are possible as well. For instance, Kaplan, Moll, and Violante
(2016) consider a “jump-drift process” with transitory and permanent components. As in
(54) there is a continuum of types for each component; but rather than moving continuously
over time as in (54), each component is subject to Poisson jumps. Income could also follow
a jump-diffusion process.
Figure 10 plots the stationary saving policy function and wealth distribution when income
follows a diffusion. Both inherit all important properties of the saving policy function and
wealth distribution from the baseline model with two income types from Sections 1 and 2.
This is not just a numerical result. Instead Propositions 7 and 8 in Appendix E.1 generalize
Propositions 1 and 2 from the case with a two-state Poisson process to other processes
including the diffusion process (54). It shows, for example, that – as can be seen in panel (a)
of the Figure – the saving policy function has an unbounded derivative at a = a for income y
below some threshold, and that therefore individuals with persistent low income realizations
44

0.5

0.35

Density g(a, y)

Savings s(a, y)

0.3

0

0.25
0.2
0.15
0.1
0.05

-0.5

0

Wealth, a

Income, y

Wealth, a

(a) Saving as Function of Income and Wealth

Income, y

(b) Distribution of Income and Wealth

Figure 10: Stationary Equilibrium of Huggett Model with Diffusion Process
hit the borrowing constraint in finite time. This results in the spike in the wealth distribution
at a = a in panel (b).53 Finally, Proposition 7 also shows that formula (21) governing the
MPC generalizes to


σ 2 (y)
σ 2 (y) 00
c (y),
ν(y) = (ρ − r)IES(c(y))c(y) + µ(y) −
P(c(y)) c0 (y) +
2
2
where c(y) := c(a, y) and P(c) := −u000 (c)/u00 (c) is absolute prudence.

4.2

An Alternative Way of Closing the Model: Aiyagari (1994)

Section 1 assumed that wealth takes the form of bonds that are in fixed supply. It is, of
course, possible to make other assumptions. In particular, we can assume as in Aiyagari
(1994) that wealth takes the form of productive capital that is used by a representative firm
which also hires labor. Each individual’s income is the product of an economy-wide wage wt
and her idiosyncratic labor productivity zt and her wealth follows (2) with yt = wt zt . The
total amount of capital supplied in the economy equals the total amount of wealth. In a
stationary equilibrium it is given by
ˆ

z̄

ˆ

K=

∞

ag(a, z)dadz := S(r, w).
z

(60)

a

53

Given that the figure plots the density g(a, y), some readers may wonder why the spike representing the
Dirac mass at a = a is finite. The answer is that the figure plots the output of our numerical scheme, gi,j
over grids ai , i = 0, ..., I and yj , j = 1, ..., J. As explained in Appendix D the correct interpretation is that
gi,j ≈ g(ai , yj ) for all grid points in the interior i > 0. But at the boundary g0,j ∆a ≈ m(yj ) where m(y) is the
Dirac mass. In the figure for example, g0,j equals about 0.35 at its highest point. The correct interpretation
is: since the computation uses ∆a = 0.3, the corresponding Dirac mass is g0,j ∆a = 0.35 × 0.3 = 0.105.

45

Capital depreciates at rate δ. There is a representative firm with a constant returns to scale
production function Y = F (K, L). Since factor markets are competitive, the wage and the
interest rate are given by
r = ∂K F (K, 1) − δ,

w = ∂L F (K, 1),

(61)

where we use that the mean of the stationary distribution of productivities z equals one.
Because the income fluctuation problem at the heart of the Aiyagari model is the same
as that in the Huggett model all of Propositions 1 to 3 apply without change. So does
Proposition 4. Proposition 5 applies by exploiting a homogeneity property noted by Auclert
and Rognlie (2016), namely that individual policy functions and therefore aggregate saving
is homothetic in the wage rate, S(r, w) = wS(r, 1) for all w > 0.54 The computational
algorithm is again unchanged except that, in Step 3, it imposes (60) and (61) rather than
(11).

4.3

Non-Convexities: Indivisible Housing, Mortgages, Poverty Traps

An important class of economic theories involves non-convexities as in Skiba (1978). Another
important class features prices in financial constraints as in Kiyotaki and Moore (1997).
We here provide a parsimonious example of a theory that features both model elements:
individuals can take out a mortgage to buy houses subject to a down-payment constraint
– hence the price in the constraint – and housing is indivisible – hence the non-convexity.
The purpose of this subsection is not to propose a quantitatively realistic model of housing;
rather it is to showcase what kind of models can be solved with our computational algorithm.
In particular, viscosity solutions and finite difference methods are designed to handle nondifferentiable and non-convex problems like the one analyzed here.
Setup Individuals have preferences over consumption ct and housing services ht :
ˆ ∞
E0
e−ρt u(ct , ht )dt.
0

They can borrow and save in a riskless bond bt and buy housing at price p. The key restriction
is that there are no houses below some threshold size hmin > 0. That is, an individual can
54

Uniqueness requires one additional technical assumption about the production function F . To see this
note that the homotheticity property implies that (60) becomes S(r, 1) = k(r) where k(r) := K(r)/w(r) is
normalized capital demand. Since S(r, 1) slopes upward by Proposition 5, the equilibrium is unique if k(r)
slopes downward. Auclert and Rognlie show that this is indeed the case if α < ε where α is the capital share
and ε is the elasticity of substitution corresponding to F (both of which may depend on K/L).

46

either not own a house ht = 0 or one that is larger than hmin ; compactly:
ht ∈ {0, [hmin , ∞)}.
An individual’s budget constraint is
ḃt + pḣt = yt + rbt − ct .
As before yt ∈ {y1 , y2 } follows a two-state Poisson process. When buying a house, the
individual can take out a mortgage and borrow up to a fraction θ ∈ [0, 1] of the value of the
house:
−bt ≤ θpht .
Equivalently the down-payment needs to be at least a fraction 1 − θ of the house’s value.
The interest rate r and house price p are determined in equilibrium. Housing is in fixed
supply normalized to unity and bonds are in zero net supply.
Stationary Equilibrium It is convenient to work with net worth at := bt + pht which
follows ȧt = yt + r(at − pht ) − ct . Similarly, the borrowing constraint becomes pht ≤ φat
1
where φ := 1−θ
. Denote by H(a) the set of admissible housing choices. We have
H(a) = {h : ph ≤ φa} ∩ {0, [hmin , ∞)}.
A stationary equilibrium is fully characterized by the following system of equations
ρvj (a) = max

c,h∈H(a)

0=−

u(c, h) + vj0 (a)(yj + r(a − ph) − c) + λj (v−j (a) − vj (a)),

(62)

d
[sj (a)gj (a)] − λj gj (a) + λ−j g−j (a),
da
ˆ
∞

1=

(h1 (a)g1 (a) + h2 (a)g2 (a))da,
ˆ0 ∞

0=

(b1 (a)g1 (a) + b2 (a)g2 (a))da,
0

where cj (a), hj (a), sj (a) = yj + r(a − phj (a)) − cj (a) and bj (a) = a − phj (a) are the optimal
consumption, housing, saving and bond holding policy functions.
In what follows we solve this equilibrium system under the additional assumption that
utility is quasi-linear u(c, h) = ũ(c + f (h)). This assumption is convenient because the optimal housing choice separates from the consumption-saving problem and allows for a simple
connection to theories in the development literature with non-convex production technologies. That being said, the model can easily be solved numerically for general preferences

47

u(c, h). Assuming quasi-linear utility and defining x = c + f (h), (62) becomes
ρvj (a) = max ũ(x) + vj0 (a)(yj + f˜(a) + ra − x) + λj (v−j (a) − vj (a)),
x

f˜(a) = max {f (h) − rph}.
h∈H(a)

The function f˜ is the pecuniary equivalent of the utility benefit of housing (net of the
opportunity cost of holding housing rather than interest-bearing bonds). Figures 11(a) and
(b) plot the solution to the optimal housing choice problem as a function of wealth a: panel
(a) plots the housing policy function h(a) (the maximand of the second equation) and panel
(b) plots the benefit from housing f˜(a) (the corresponding maximum). The vertical line in
the two graphs is at a∗ := phmin /φ which is the down-payment necessary to buy the smallest
available house hmin . An individual with wealth at below this threshold simply cannot buy
a house at time t, as reflected by the fact that both the housing policy function and the
benefit from housing are zero, h(a) = 0 and f˜(a) = 0 for a ≤ a∗ . As her wealth increases
above a∗ , the individual is first up against the constraint ph(a) = φa so that the size of
her house increases linearly with wealth; when her wealth is large enough, she chooses the
unconstrained house size given by the solution to the unconstrained first-order condition
f 0 (h) = rp.
Importantly the function f˜ in panel (b) is convex-concave as a function of wealth a.
Note the similarity to theories of economic growth with convex-concave production functions (Skiba, 1978) and to theories of entrepreneurship with financial constraints and nonconvexities in production, either due to fixed costs in production or to an occupational choice
(see e.g. Buera, 2009; Buera, Kaboski, and Shin, 2011; Buera and Shin, 2013; Buera, Kaboski, and Shin, 2015). In fact, our computational method again carries over to the solution
of such theories.
Figure 11(c) plots the resulting saving policy function. The black, dashed horizontal line
is at zero, i.e. savings are positive above that line and negative below. Optimal saving has the
typical feature of problems with non-convexities: for each income type, there is a threshold
wealth level (the “Skiba point”) below which individuals decumulate assets and above which
they accumulate assets. In panel (c) this point is where the saving policy functions intersect
zero while sloping upward. As usual, the “Skiba point” is strictly below the point of the nonconvexity a∗ (the dashed vertical line). Figure 11(d) plots the corresponding value functions:
importantly, they feature convex kinks both at the “Skiba point” and at the non-convexity
a∗ . Since derivatives of vj do not exist at these kink points, it becomes necessary to explicitly
invoke the theory of viscosity solutions. However, the Barles-Souganidis theory still applies
in the presence of kinks and therefore our computational algorithm can be applied without
change.
Since the theory features classic poverty trap dynamics, there can be multiple stationary
48

Pecuniary Benefit from Housing, f (a)

Housing, hj (a)

Wealth, a

Wealth, a

(a) Housing Policy Function

(b) Pecuniary Benefit from Housing

Saving, sj (a)

Value Function, vj (a)

s1 (a)
s2 (a)

v1 (a)
v2 (a)
Wealth, a

Wealth, a

(c) Saving Policy Function

(d) Value Function
g1 (a)
g2 (a)
Densities, gj (a)

Densities, gj (a)

g1 (a)
g2 (a)

Wealth, a

(e) First Example of Stationary Densities

Wealth, a

(f) Second Example of Stationary Densities

Figure 11: Model with Indivisible Housing: Policy and Value Functions and Multiple Stationary Distributions
49

wealth distributions. Figures 11 (e) and (f) confirm this possibility: they plot two possible
stationary wealth distributions. In fact there is a continuum of stationary wealth distributions. In results not shown here due to space constraints, we have also computed the model’s
transition dynamics. Not surprisingly given the discussion thus far, the economy features
history dependence in the sense that initial conditions determine where the economy ends
up in the long run. As already noted, the point of this subsection is not to argue quantitatively that the presence of indivisible housing and down-payment constraints creates history
dependence. Rather it is to showcase the possibilities of our computational algorithm.

4.4

Fat Tails

As shown in Proposition 3, the stationary wealth distribution in the Huggett economy with a
bounded income process is bounded above. More generally, any income process with a thintailed stationary distribution results in a thin-tailed wealth distribution.55 This property
of the model is, of course, problematic vis-à-vis wealth distributions observed in the data
which are typically heavily skewed and feature fat upper tails. In Online Appendix E.2 we
show how to extend the Huggett model of Section 1 to feature a fat-tailed stationary wealth
distribution. We do this by introducing a risky asset in addition to the riskless bond. The
insight that the introduction of “investment risk” into a Bewley model generates a Pareto
tail for the wealth distribution is due to Benhabib, Bisin, and Zhu (2015) and our argument
mimics several of their steps. Also see Jones (2015) and De Nardi and Fella (2017).

4.5

Multiple Assets with Adjustment Costs

The models discussed in Sections 4.3 and 4.4 featured two assets: bonds and housing in
the former; bonds and a risky asset in the latter. But in both cases portfolio adjustment
between the two assets was costless and we could therefore collapse the two assets into
one state variable, net worth. Costless portfolio adjustment may be a bad assumption
in many applications. For instance, buying a house may entail both fixed and variable
transaction costs. The same is true for illiquid assets more generally. For example, an
individual withdrawing funds from her retirement account typically incurs a penalty. Kaplan,
Moll, and Violante (2016) show how to extend the computational algorithm developed here
to handle multiple assets with kinked (but convex) adjustment costs and argue that the
two-asset structure is important for understanding the monetary transmission mechanism.
55
As discussed by Benhabib and Bisin (2016) the only exception to this is if income itself has a stationary
distribution with a fat (Pareto) tail. However, this assumption would generate the counterfactual prediction
that the tail of the wealth distribution is equally fat as that of the income distribution. In the data, instead,
the wealth distribution has a considerably fatter tail than the income distribution.

50

4.6

Stopping Time Problems

In models with multiple assets like the one discussed above, one may want to allow for nonconvex adjustment costs, e.g. fixed costs. In work in progress we show how our algorithm also
generalizes to solve such problems. Non-convex adjustment costs result in the individual’s
problem becoming a stopping time problem rather than a standard dynamic optimization
problem (Stokey, 2009). The value function then no longer solves an HJB equation; instead
it solves a so-called “HJB Variational Inequality” (Øksendal, 1995; Tourin, 2013).56 Nevertheless, the algorithm developed here can be generalized in a relatively straightforward
manner to solve these type of stopping time problems.57 The computational method for
solving stopping time problems also promises to be useful in other applications, e.g. problems involving default by individuals (see e.g. Livshits, MacGee, and Tertilt, 2007) or by
sovereign states (see e.g. Aguiar, Amador, Farhi, and Gopinath, 2013, for a continuous-time
formulation).

5

Conclusion

This paper makes two types of contributions. First, we prove a number of new theoretical results about the Aiyagari-Bewley-Huggett model, the workhorse theory of income and
wealth distribution in macroeconomics: (i) an analytic characterization of the consumption
and saving behavior of the poor, particularly their marginal propensities to consume; (ii) a
closed-form solution for the wealth distribution in a special case with two income types; (iii)
a proof that there is a unique stationary equilibrium if the intertemporal elasticity of substitution is weakly greater than one; (iv) a characterization of “soft” borrowing constraints.
Second, we develop a simple, efficient and portable algorithm for numerically solving both
stationary equilibria and transition dynamics of a wide class of heterogeneous agent models,
including – but not limited to – this model. Both types of contributions were made possible
by recasting the Aiyagari-Bewley-Huggett model in continuous time, thereby transforming
the model into a system of partial differential equations.
56

Economists typically tackle these types of problems by splitting the state space into an inaction region
and an adjustment region, postulate that the value function satisfies an HJB equation in the adjustment
region and a “smooth pasting” condition on the boundary. This approach is restrictive: in one dimension,
the boundary of the inaction region is just a threshold; but as soon as there is more than one state variable, it
becomes exceedingly hard to find the boundaries of the adjustment region. The approach is even somewhat
misleading: using the HJB Variational Inequality formulation the smooth pasting condition is a result
rather than an exogenously imposed axiom (Øksendal, 1995). Solving stopping time problems in multiple
dimensions then poses no conceptual problem over solving one-dimensional ones.
57
See the applications labelled “Stopping Time Problem” here http://www.princeton.edu/∼moll/
HACTproject.htm, particularly a simple problem of exercising an option borrowed from Stokey (2009)
http://www.princeton.edu/∼moll/HACTproject/option simple.pdf and a model with two assets and nonconvex adjustment costs http://www.princeton.edu/∼moll/HACTproject/liquid illiquid numerical.pdf.

51

It is our hope that the methods developed in this paper, particularly the numerical
algorithm, will also prove useful in other applications. One potential application is to spatial
theories of trade and development as in Rossi-Hansberg (2005) and Allen and Arkolakis
(2014). These theories typically feature a continuum of producers and households distributed
over a continuum of locations. In dynamic versions, space would simply be an additional
variable in the HJB and KF equations. A challenge would be how to solve for equilibrium
prices which are typically functions of space rather than a small number of (potentially timevarying) scalars. Related, a second avenue for future research is to explore richer interactions
between individuals. In the class of theories we have considered here, individuals interact
only through prices. But for many questions of interest, richer interactions may be important:
for instance there may be more “local” interactions in the form of knowledge spillovers or
diffusion (see e.g. Perla and Tonetti, 2014; Lucas and Moll, 2014; Burger, Lorz, and Wolfram,
2016; Benhabib, Perla, and Tonetti, 2017). In principle, the apparatus put forward in this
paper – the Mean Field Game system of coupled HJB and KF equations – is general enough
to encompass richer models such as these.

References
Achdou, Y. (2013): “Finite difference methods for mean field games,” in Hamilton-Jacobi equations: approximations, numerical analysis and applications, vol. 2074 of Lecture Notes in Math.,
pp. 1–47. Springer, Heidelberg.
Achdou, Y., and I. Capuzzo-Dolcetta (2010): “Mean field games: numerical methods,” SIAM
J. Numer. Anal., 48(3), 1136–1162.
Acikgoz, O. (2016): “On the Existence and Uniqueness of Stationary Equilibrium in Bewley
Economies with Production,” Working paper, Yeshiva University.
Aguiar, M., M. Amador, E. Farhi, and G. Gopinath (2013): “Crisis and Commitment:
Inflation Credibility and the Vulnerability to Sovereign Debt Crises,” NBER Working Papers
19516, National Bureau of Economic Research, Inc.
Ahn, S. (2017): “Sparse Grid Methods for Continuous-Time Heterogeneous Agent Models,” Working paper, Norges Bank.
Ahn, S., G. Kaplan, B. Moll, T. Winberry, and C. Wolf (2017): “When Inequality Matters
for Macro and Macro Matters for Inequality,” in NBER Macroeconomics Annual 2017, volume
32, NBER Chapters. National Bureau of Economic Research, Inc.
Aiyagari, S. R. (1993): “Uninsured idiosyncratic risk and aggregate saving,” Working Papers
502, Federal Reserve Bank of Minneapolis.
Aiyagari, S. R. (1994): “Uninsured Idiosyncratic Risk and Aggregate Saving,” The Quarterly
Journal of Economics, 109(3), 659–84.
Allen, T., and C. Arkolakis (2014): “Trade and the Topography of the Spatial Economy,”
The Quarterly Journal of Economics, 129(3), 1085–1140.
Alonso, C. (2016): “Hard vs. Soft Financial Constraints: Implications for the Effects of a Credit
Crunch,” Working paper, Princeton.
Alvarez, F., and R. Shimer (2011): “Search and Rest Unemployment,” Econometrica, 79(1),
75–122.

52

Auclert, A. (2017): “Monetary Policy and the Redistribution Channel,” NBER Working Papers
23451, National Bureau of Economic Research, Inc.
Auclert, A., and M. Rognlie (2016): “Inequality and Aggregate Demand,” Work in progress.
(2017): “Aggregate Demand and the Top 1 Percent,” American Economic Review, 107(5),
588–592.
Barczyk, D., and M. Kredler (2014): “Altruistically Motivated Transfers under Uncertainty,”
Quantitative Economics, 5(3), 705–749.
Barles, G., and P. E. Souganidis (1991): “Convergence of approximation schemes for fully
nonlinear second order equations,” Asymptotic Analysis, 4, 271–283.
Bayer, C., and K. Wälde (2010): “Matching and Saving in Continuous Time: Theory,” CESifo
Working Paper Series 3026, CESifo Group Munich.
Bénabou, R. (2002): “Tax and Education Policy in a Heterogeneous-Agent Economy: What
Levels of Redistribution Maximize Growth and Efficiency?,” Econometrica, 70(2), 481–517.
Benhabib, J., and A. Bisin (2016): “Skewed Wealth Distributions: Theory and Empirics,”
Working paper.
Benhabib, J., A. Bisin, and S. Zhu (2011): “The Distribution of Wealth and Fiscal Policy in
Economies With Finitely Lived Agents,” Econometrica, 79(1), 123–157.
(2015): “The Wealth Distribution in Bewley Economies with Capital Income Risk,”
Journal of Economic Theory, 159(PA), 489–515.
(2016): “The Distribution Of Wealth In The Blanchard?Yaari Model,” Macroeconomic
Dynamics, 20(02), 466–481.
Benhabib, J., J. Perla, and C. Tonetti (2017): “Reconciling Models of Diffusion and Innovation: A Theory of the Productivity Distribution and Technology Frontier,” NBER Working
Papers 23095, National Bureau of Economic Research, Inc.
Berger, D., V. Guerrieri, G. Lorenzoni, and J. Vavra (2015): “House Prices and Consumer
Spending,” NBER Working Papers 21667, National Bureau of Economic Research, Inc.
Bewley, T. (1986): “Stationary Monetary Equilibrium with a Continuum of Independently Fluctuating Consumers,” in Contributions to Mathematical Economics in Honor of Gerard Debreu,
ed. by W. Hildenbrand, and A. Mas-Collel. North-Holland, Amsterdam.
Blundell, R., L. Pistaferri, and I. Saporta-Eksten (2016): “Consumption Inequality and
Family Labor Supply,” American Economic Review, 106(2), 387–435.
Broda, C., and J. A. Parker (2014): “The Economic Stimulus Payments of 2008 and the
Aggregate Demand for Consumption,” Journal of Monetary Economics, 68, S20–S36.
Buera, F. (2009): “A dynamic model of entrepreneurship with borrowing constraints: theory and
evidence,” Annals of Finance, 5(3), 443–464.
Buera, F. J., J. P. Kaboski, and Y. Shin (2011): “Finance and Development: A Tale of Two
Sectors,” American Economic Review, 101(5), 1964–2002.
(2015): “Entrepreneurship and Financial Frictions: A Macrodevelopment Perspective,”
Annual Review of Economics, 7(1), 409–436.
Buera, F. J., and Y. Shin (2013): “Financial Frictions and the Persistence of History: A
Quantitative Exploration,” Journal of Political Economy, 121(2), 221–272.
Bungartz, H.-J., and M. Griebel (2004): “Sparse grids,” Acta Numerica, 13, 147–269.
Burger, M., A. Lorz, and M.-T. Wolfram (2016): “On a Boltzmann Mean Field Model for
Knowledge Growth,” SIAM Journal on Applied Mathematics, 76(5), 1799–1818.
Candler, G. V. (1999): “Finite-Difference Methods for Dynamic Programming Problems,” in
Computational Methods for the Study of Dynamic Economies. Cambridge University Press, Cambridge, England.

53

Cao, D., and W. Luo (2017): “Persistent Heterogeneous Returns and Top End Wealth Inequality,” Working paper, Georgetown.
Capuzzo-Dolcetta, I., and P. L. Lions (1990): “Hamilton-Jacobi Equations with State Constraints,” Transactions of the American Mathematical Society, 318(2), 643+.
Cardialaguet, P. (2013): “Notes on mean-field games (from P.-L. Lions’ lectures at Collège de
France),” https://www.ceremade.dauphine.fr/∼cardaliaguet/MFG20130420.pdf.
Carroll, C. D. (2006): “The Method of Endogenous Gridpoints for Solving Dynamic Stochastic
Optimization Problems,” Economics Letters, 91(3), 312–320.
Conze, A., J. M. Lasry, and J. Scheinkman (1993): “Borrowing Constraints and International
Comovements,” Hitotsubashi Journal of Economics, 34(Special I), 23–47.
Crandall, M. G., and P. L. Lions (1983): “Viscosity Solutions of Hamilton-Jacobi Equations,”
Transactions of the American Mathematical Society, 277(1), 1–42.
De Nardi, M., and G. Fella (2017): “Saving and Wealth Inequality,” CEPR Discussion Papers
11746, C.E.P.R. Discussion Papers.
Deaton, A. (2016): “Measuring and Understanding Behavior, Welfare, and Poverty,” American
Economic Review, 106(6), 1221–1243.
Den Haan, W. J. (1997): “Solving Dynamic Models With Aggregate Shocks And Heterogeneous
Agents,” Macroeconomic Dynamics, 1(02), 355–386.
Evans, L. (2010): Partial Differential Equations. American Mathematical Society.
Fagereng, A., M. B. Holm, and G. J. Natvik (2016): “MPC Heterogeneity and Household
Balance Sheets,” Discussion paper, Statistics Norway.
Festa, A., D. A. Gomes, and R. M. Velho (2017): “An Adjoint-based Numerical Method for
a class of nonlinear Fokker-Planck Equations,” ArXiv e-prints.
Gabaix, X., J.-M. Lasry, P.-L. Lions, and B. Moll (2016): “The Dynamics of Inequality,”
Econometrica, 84(6), 2071–2111.
Gerstner, T., and M. Griebel (2010): Sparse GridsJohn Wiley & Sons, Ltd.
Golosov, M., and R. E. Lucas (2007): “Menu Costs and Phillips Curves,” Journal of Political
Economy, 115, 171–199.
Guéant, O., J.-M. Lasry, and P.-L. Lions (2011): Mean Field Games and Applicationspp.
205–266. Springer Berlin Heidelberg, Berlin, Heidelberg.
Guerrieri, V., and G. Lorenzoni (2017): “Credit Crises, Precautionary Savings, and the
Liquidity Trap*,” The Quarterly Journal of Economics, 132(3), 1427–1467.
Guvenen, F. (2011): “Macroeconomics With Heterogeneity: A Practical Guide,” NBER Working
Papers 17622, National Bureau of Economic Research, Inc.
Hagedorn, M., I. Manovski, and K. Mitman (2017): “The Fiscal Multiplier,” Working paper.
Heathcote, J., K. Storesletten, and G. L. Violante (2009): “Quantitative Macroeconomics with Heterogeneous Households,” Annual Review of Economics, 1(1), 319–354.
(2014): “Consumption and Labor Supply with Partial Insurance: An Analytical Framework,” American Economic Review, 104(7), 2075–2126.
Holm, M. B. (2017): “Consumption with Liquidity Constraints: An Analytical Characterization,”
Discussion paper, Statistics Norway.
Hopenhayn, H. A. (1992): “Entry, Exit, and Firm Dynamics in Long Run Equilibrium,” Econometrica, 60(5), 1127–50.
Huggett, M. (1993): “The risk-free rate in heterogeneous-agent incomplete-insurance economies,”
Journal of Economic Dynamics and Control, 17(5-6), 953–969.
Jones, C. I. (2015): “Pareto and Piketty: The Macroeconomics of Top Income and Wealth
Inequality,” Journal of Economic Perspectives, 29(1), 29–46.

54

Jones, C. I., and J. Kim (2014): “A Schumpeterian Model of Top Income Inequality,” NBER
Working Papers 20637, National Bureau of Economic Research, Inc.
Jovanovic, B. (1979): “Job Matching and the Theory of Turnover,” Journal of Political Economy,
87(5), 972–90.
Kaplan, G., B. Moll, and G. L. Violante (2016): “Monetary Policy According to HANK,”
Working Paper 21897, National Bureau of Economic Research.
Kaplan, G., and G. Violante (2014): “A Model Of The Consumption Response To Fiscal
Stimulus Payments,” Econometrica, forthcoming.
Kasa, K., and X. Lei (2017): “Risk, Uncertainty, and the Dynamics of Inequality,” Discussion
Papers dp17-06, Department of Economics, Simon Fraser University.
Kiyotaki, N., and J. Moore (1997): “Credit Cycles,” Journal of Political Economy, 105(2),
211–48.
Krebs, T. (2003): “Human Capital Risk And Economic Growth,” The Quarterly Journal of
Economics, 118(2), 709–744.
Krueger, D., K. Mitman, and F. Perri (2015): “Macroeconomics and Heterogeneity, Including
Inequality,” Working paper.
Krusell, P., and A. A. Smith (1998): “Income and Wealth Heterogeneity in the Macroeconomy,” Journal of Political Economy, 106(5), 867–896.
Kushner, H. J., and P. Dupuis (2013): Numerical Methods for Stochastic Control Problems in
Continuous Time. Springer.
Lasry, J.-M., and P.-L. Lions (2007): “Mean field games,” Japanese Journal of Mathematics,
2, 229–260.
Light, B. (2017): “Uniqueness of Equilibrium in a Bewley-Aiyagari Model,” Discussion paper,
Stanford.
Lippi, F., S. Ragni, and N. Trachter (2013): “State Dependent Monetary Policy,” Working
Paper 13-17, Federal Reserve Bank of Richmond.
Lise, J. (2013): “On-the-Job Search and Precautionary Savings,” Review of Economic Studies,
80(3), 1086–1113.
Livshits, I., J. MacGee, and M. Tertilt (2007): “Consumer Bankruptcy: A Fresh Start,”
American Economic Review, 97(1), 402–418.
Ljungqvist, L., and T. J. Sargent (2004): Recursive Macroeconomic Theory. The MIT Press.
Lucas, R. E., and B. Moll (2014): “Knowledge Growth and the Allocation of Time,” Journal
of Political Economy, 122(1), 1–51.
Luttmer, E. G. J. (2007): “Selection, Growth, and the Size Distribution of Firms,” The Quarterly
Journal of Economics, 122(3), 1103–1144.
(2011): “On the Mechanics of Firm Growth,” Review of Economic Studies, 78(3), 1042–
1068.
(2015): “An Assignment Model of Knowledge Diffusion and Income Inequality,” Staff
Report 509, Federal Reserve Bank of Minneapolis.
Misra, K., and P. Surico (2014): “Consumption, Income Changes, and Heterogeneity: Evidence
from Two Fiscal Stimulus Programs,” American Economic Journal: Macroeconomics, 6(4), 84–
106.
Moll, B. (2014): “Productivity Losses from Financial Frictions: Can Self-financing Undo Capital
Misallocation?,” American Economic Review, forthcoming.
Moscarini, G. (2005): “Job Matching and the Wage Distribution,” Econometrica, 73(2), 481–516.
Nuño, G., and B. Moll (2017): “Social Optima in Economies with Heterogeneous Agents,”
Working paper, Bank of Spain.

55

Nuño, G., and C. Thomas (2017): “Optimal Monetary Policy with Heterogeneous Agents,”
Working paper, Bank of Spain.
Øksendal, B. (1995): Stochastic Differential Equations. Springer Berlin Heidelberg, Berlin, Heidelberg.
Olivi, A. (2017): “Sufficient Statistics for Heterogeneous Agent Models,” Work in progress, MIT.
Parra-Alvarez, J., O. Posch, and M.-C. Wang (2017): “Identification and estimation of
heterogeneous agent models: A likelihood approach,” Working paper, Aarhus University.
Perla, J., and C. Tonetti (2014): “Equilibrium Imitation and Growth,” Journal of Political
Economy, 122(1), 52–76.
Quadrini, V., and J.-V. Rı́os-Rull (2015): “Inequality in Macroeconomics,” Handbook of Income Distribution, 2, 1229 – 1302, Handbook of Income Distribution.
Rocheteau, G., P.-O. Weill, and T.-N. Wong (2015): “Working through the Distribution:
Money in the Short and Long Run,” NBER Working Papers 21779, National Bureau of Economic
Research, Inc.
Rossi-Hansberg, E. (2005): “A Spatial Theory of Trade,” American Economic Review, 95(5),
1464–1491.
Scheinkman, J. A., and L. Weiss (1986): “Borrowing Constraints and Aggregate Economic
Activity,” Econometrica, 54(1), 23–45.
Shaker Akhtekhane, S. (2017): “Firm Entry and Exit in Continuous Time,” Working paper,
Ohio State University.
Skiba, A. K. (1978): “Optimal Growth with a Convex-Concave Production Function,” Econometrica, 46(3), 527–39.
Soner, H. M. (1986a): “Optimal Control with State-Space Constraint I,” SIAM Journal on
Control and Optimization, 24(3), 552–561.
(1986b): “Optimal Control with State-Space Constraint II,” SIAM J. Control Optim.,
24(6), 1110–1122.
Stokey, N. (2014): “The Race Between Technology and Human Capital,” Working paper, University of Chicago.
Stokey, N. L. (2009): The Economics of Inaction. Princeton University Press, Princeton, NJ.
Tao, T. (2008): “Generalized Solutions,” in The Princeton Companion to Mathematics, ed. by
T. Gowers, J. Barrow-Green, and I. Leader. Princeton University Press, http://www.math.ucla.
edu/∼tao/preprints/generalized solutions.pdf.
Toda, A. A., and K. Walsh (2015): “The Double Power Law in Consumption and Implications
for Testing Euler Equations,” Journal of Political Economy, 123(5), 1177–1200.
Tourin, A. (2013): “An Introduction to Finite Difference Methods for PDEs in Finance,” in
Optimal Stochastic Target problems, and Backward SDE, ed. by N. Touzi, Fields Institute
Monographs. Springer, available online at http://papers.ssrn.com/sol3/papers.cfm?abstract id=
2396142.
Vindigni, A., S. Scotti, and C. Tealdi (2014): “Uncertainty and the Politics of Employment
Protection,” Journal of Labor Economics.
Wang, N. (2007): “An Equilibrium Model of Wealth Distribution,” Journal of Monetary Economics, 54(7), 1882–1904.

56

