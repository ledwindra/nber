NBER WORKING PAPER SERIES

OPTIMAL DYNAMIC TAXES
Mikhail Golosov
Maxim Troshkin
Aleh Tsyvinski
Working Paper 17642
http://www.nber.org/papers/w17642

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2011

We thank Stefania Albanesi, Fernando Alvarez, V.V. Chari, Dirk Krueger, Larry Jones, Igor Livshits,
Stephen Morris, James Poterba, Emmanuel Saez, Ali Shourideh, Nancy Qian, Hongda Xiao, Pierre
Yared, and audiences at ASU, Bank of Japan, Boston University, Chicago, Chicago Booth, Chicago
Fed, Cornell, Cowles, EIEF, Gerzensee, Minnesota Macro, NBER PF, Northwestern, NY Fed, NYU,
Princeton, Rochester, SED, Texas, UCSD. Marianne Bruins, James Duffy and Nicolas Werquin provided
outstanding research assistance. We gratefully acknowledge the use of software licences provided
at the Institute on Computational Economics. Golosov and Tsyvinski thank EIEF for hospitality and
NSF for support. Troshkin thanks Minneapolis Fed for hospitality and support. Tsyvinski thanks IMES
of the Bank of Japan and John Simon Guggenheim Foundation. The views expressed herein are those
of the authors and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2011 by Mikhail Golosov, Maxim Troshkin, and Aleh Tsyvinski. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Optimal Dynamic Taxes
Mikhail Golosov, Maxim Troshkin, and Aleh Tsyvinski
NBER Working Paper No. 17642
December 2011
JEL No. E62,H21,H24,H31
ABSTRACT
We study optimal labor and savings distortions in a lifecycle model with idiosyncratic shocks. We
show a tight connection between its recursive formulation and a static Mirrlees model with two goods,
which allows us to derive elasticity-based expressions for the dynamic optimal distortions. We derive
a generalization of a savings distortion for non-separable preferences and show that, under certain
conditions, the labor wedge tends to zero for sufficiently high skills. We estimate skill distributions
using individual data on the U.S. taxes and labor incomes. Computed optimal distortions decrease
for sufficiently high incomes and increase with age.

Mikhail Golosov
Department of Economics
Princeton University
111 Fisher Hall
Princeton, NJ 08544
and NBER
golosov@princeton.edu
Maxim Troshkin
Cowles Foundation
Yale University
28 Hillhouse Avenue B9
New Haven, CT 06511
maxim.troshkin@yale.edu

Aleh Tsyvinski
Department of Economics
Yale University
Box 208268
New Haven, CT 06520-8268
and NBER
a.tsyvinski@yale.edu

A sizeable New Dynamic Public Finance (NDPF) literature studies optimal
taxation in dynamic settings1 . The models in this literature extend the classic
Mirrlees equity-e¢ ciency trade-o¤s to dynamic settings in which agents’skills
change stochastically over time. A key theoretical insight of our paper is to
show a connection of the dynamic model with a static optimal taxation model
with two goods. A recursive formulation of the optimal problem allows us
to think of the dynamic problem as one in which an agent each period derives utility from two goods, consumption today and a suitably de…ned future
promises, as well as labor. This allows us to derive formulas that facilitate
interpretation of the forces behind the optimal income taxation results in dynamic settings and to generalize the analysis of the savings distortion to the
non-separable preferences as well as to show the conditions under which the
labor wedges for the high skilled agents tend to zero.
In the static model Diamond (1998) derived the expressions for the optimal
labor distortions and showed that they are determined by three key parameters: the shape of the income distribution, the redistributionary objectives of
the government, and labor elasticity. The dynamic model introduces three
signi…cant di¤erences: (i) the use of dynamic incentives adds a force lowering labor wedges; (ii) conditional rather than unconditional distributions of
skills are key determinants of wedges; (iii) persistence of shocks acts as a
more redistributionary motive for the planner. We then show that, under
certain conditions, the labor wedge tends to zero for su¢ ciently high skills.
Importantly, this result relies on understanding the forces and their interactions behind the savings distortion and the labor distortions and highlights the
usefulness of the formulas that we derive. Our results on the wedge tending to
1

See, for example, Golosov, Kocherlakota, and Tsyvinski (2003) or reviews in Golosov,

Tsyvinski, and Werning (2006) and Kocherlakota (2010).

1

zero for the high skills is in sharp contrast to the static case with the Pareto
tail of the skills distribution of Diamond (1998) and Saez (2001), who show
that the taxes on the high skill agents are increasing and tend to high levels
(50-70%) depending on the chosen elasticity of labor supply.
The theoretical analysis points to empirical skill distributions as a crucial
input for a quantitative analysis. We construct a dataset of individual skills
and their evolution over lifetime implied by the observed micro level data for
the U.S. The main di¢ culty in estimating skills from the data is that skills
are unobservable. One can use wages as a proxy for skills but it does not
necessarily correspond to skills which measure the return to e¤ort. We use
the data on the actual U.S. tax code and labor income choices to infer the
unobservable skill level. Since the details of the actual U.S. system of taxes
and transfers are observable, we compute the implied individual skills from
the necessary conditions for the individual optimum. The methodology is a
dynamic extension of that of Saez (2001) who used a similar approach to infer
cross-sectional distribution of skills in the population.
We then numerically simulate the optimal labor and savings wedges in a
realistically calibrated economy based on the empirical income distributions.
The dynamic wedges are signi…cantly di¤erent from the static taxes, emphasizing the importance of the theoretical forces we study. We …nd that the labor
distortion for the early periods are smaller than for the later periods. Importantly, the labor wedges for the high skilled agents tend to zero in our dynamic
model while in calibrated static models of Diamond (1998) and Saez (2001)
they typically reach 50-70%. We provide simulations of the savings wedge
and …nd it numerically signi…cant and increasing with the labor income. The
consideration of conditional rather than the unconditional empirical distributions of income and skills signi…cantly alters the pattern of wedges compared
2

to the static (or the i.i.d.) case. Agents face very di¤erent labor distortions
conditional on the previous shocks. This is due to the di¤erences among the
conditional distributions and also due to the increase of the planner’s redistributionary objectives to deter earlier deviations.
We then compute the welfare gains of using the optimal policy. First, we
follow an important insight of Farhi and Werning (2010) to compare the constrained e¢ cient optimum to that with the optimal linear taxes, and con…rm
their …ndings in our setup. The optimal age-dependent linear labor wedges
yield a welfare loss of 0:9% of consumption compared to the constrained optimum. The optimal age-independent labor distortion yields a welfare loss
of 1:6%. While these magnitudes are non-trivial, linear taxes can still yield
reasonably good policies as in Farhi and Werning (2010). Then, we consider a
case of a more redistributive social planner. The analysis of the static Mirrlees
problems (e.g., Mirrlees (1971), Atkinson and Stiglitz (1976), Tuomala (1990))
also points out that if the planner is more redistributive than utilitarian planner, the tax policy is substantially di¤erent from linear, and nonlinear taxes
may yield large welfare gains. We calculate welfare gains of using optimal
policies when the social planner is more redistributive, in particular Rawlsian.
The optimal age-dependent linear labor wedges yield a welfare loss of 4:6%
compared to the constrained optimum. The optimal age-independent labor
distortion yields a welfare loss of 5:1%. We conclude that the welfare gains of
using optimal nonlinear policies are signi…cant.
There are several papers related to our work. The …rst-order approach for
persistent shocks is developed in Kapiµcka (2010) and Pavan, Segal, and Toikka
(2010). In our numerical simulations we verify its su¢ ciency.
An important contribution of Farhi and Werning (2010) derives a formula
describing a dynamic behavior of the labor income tax rate in both continu3

ous and discrete case, provides a simulation of a lifecycle economy, and derives
additional insights using a continuous time approach. Our work focuses on
a study of cross-sectional properties of optimal wedges, on deriving elasticity
based formulas, and on numerical simulations based on calibrated skill distribution that we estimate from the U.S. data extending the analysis of Diamond
(1998) and Saez (2001) to dynamic settings.
Numerical simulations in our paper are also related to Weinzierl (2011).
He derives theoretically and analyzes numerically an elasticity-based formula
with which he studies optimal age-dependent taxation, in a dynamic Mirrlees
setting. Albanesi and Sleet (2006) is a comprehensive numerical and theoretical study of optimal capital and labor taxes in a dynamic economy with i.i.d.
shocks. Kocherlakota and Pistaferri (2007) and Kocherlakota and Pistaferri
(2009) use micro level data to evaluate predictions of dynamic optimal policy
models. Golosov and Tsyvinski (2006) study a disability insurance model
with fully persistent shocks. Golosov, Tsyvinski, and Werning (2006) is a
two-period numerical study of the determinants of dynamic optimal taxation
in the spirit of Tuomala (1990). Ales and Maziero (2007) numerically solve
a version of a life cycle economy with i.i.d. shocks drawn from a discrete,
two-type distribution, and …nd that the labor distortions are lower earlier in
life. Fukushima (2010) simulates a policy reform which replaces an optimal
‡at tax with an optimal non-linear tax that is age and history dependent and
…nds sizeable welfare gains in a model where the welfare function places zero
Pareto weight on any …nite number of cohorts. Battaglini and Coate (2008)
provide a complete characterization of the optimal program with Markovian
agents. While incorporating persistence in abilities, most of their analysis for
tractability assumes only two ability types and risk neutral individuals.

4

1

Environment

We consider an economy that lasts T periods, denoted by t = 1; :::; T (T <
1)2 . Each agent’s preferences are described by a time separable utility function over consumption good ct

0 and labor lt

E1

T
X

t 1

0,
(1)

U (ct ; lt );

t=1

where

2 (0; 1) is a discount factor, E1 is a period 1 expectations operator,

and U : R2+ ! R.
In period t = 1, agents draw their initial type (skill),
F1 ( ). For t

2, skills follow a Markov process Ft ( j

skill realization in period t
ft ( j

t 1)

1,

t 1 ),

from a distribution

where

t 1

is agent’s

1: We denote the probability density function by

and assume that ft is di¤erentiable in both arguments. We assume

that, in each period t, skills are non-negative:
t

possible histories up to period t is denoted by
An agent of type

t

t

2

= R+ . The set of

.

who supplies lt units of labor produces yt =

t lt

units

of output. The skill shocks and the history of shocks are privately observed by
the agent. Output yt =

t lt

and consumption ct are observed by the planner.

In period t, the agent knows his skill realization only for the …rst t periods
t

= ( 1 ; :::; t ). Denote by ct
t

and by yt
t

t

:

t

t

t

:

! R+ agent’s allocation of consumption

:

t

! R+ agent’s allocation of output in period t. Denote by

!

t

agent’s report in period t. We denote the set of all such

reporting strategies in period t,

1

1

; :::;

t

t

transferred between periods with a rate on savings

by

t

. Resources can be

> 0. The observability of

consumption implies that all savings are publicly observable. Hence, without
2

The recursive formulation of the problem that follows makes it easy to extend the

analysis to the case of in…nitely lived agents. In fact, the calibration and numerical analysis
is greatly simpli…ed in the case of in…nitely lived agents.

5

loss of generality, we can assume that the social planner controls all the savings.
We also assume that the social planner has a social welfare function de…ned
over lifetime utilities of the agents, G : R ! R, where G is increasing and
concave. Since the lifetime utility of the agent is given by (1), the social
R
P
welfare is given by G E1 Tt=1 t 1 U (ct ; lt ) dF1 ( ).
We denote partial derivatives of U with respect to c and l as Uc and Ul

and de…ne all the second derivatives and cross-partials accordingly. Since
U (c; l) = U (c; y= ); we also use notation Uy = Ul 1 and U = Uy

y

to denote

derivatives with respect to y and : We make the following assumptions on U:
Assumption 1. U is twice continuously di¤erentiable in both arguments, satis…es Uc > 0; Ul < 0; Ucc < 0; Ull < 0; Ucl
@ Uy (c; y; )
@ Uc (c; y; )

0; and
0:

These assumptions are standard. The last restriction is the single crossing
property. The assumption that Ucl

0 ensures that consumption and leisure

are substitutes, which is generally considered to be the empirically relevant
case.
In parts of our analysis we will need to use the notion of elasticity of labor
supply, holding current period consumption …xed, which is de…ned as3
1
"

Uyy Uc Ucy Uy Uc
y :
Uy
(Uc )2

(2)

By de…nition, when U is separable in c and y; " is a Frisch elasticity of
labor supply. When U has no income e¤ects then " is the uncompensated
elasticity of labor supply. We make the following assumption on ":
Assumption 2. The elasticity " is positive and bounded away from 0.
3

It is easy to see that this is elasticity of labor supply by di¤erentiating the intratemporal

…rst order conditions for the household.

6

For most of the analysis we assume that Ft is di¤erentiable with the p.d.f.
ft , for all t. We denote the partial derivative of ft with respect to the t
period shock,

1

, by f2;t . For some parts of the analysis we will need further

restrictions on f , in particular, the two assumptions that follow.
Assumption 3. For all t and for all

, (1

Ft ( j

)) = ft ( j

) is bounded

from above.
Assumption 4. For all t, Ft ( j
if

> ^ and f2;t ( j

)=ft ( j

) …rst order stochastically dominates Ft

) is increasing in

j^

:

The …rst assumption is very weak, and most empirically relevant distributions satisfy it. The second assumption ensures that high

types get higher

expected utility and introduces a certain form of persistence. The second part
of the assumption is satis…ed if, for example, the distribution functions have
a property that if

H

>

L

then f ( j

L ) =f

( j

is decreasing in . This

H)

assumption can be further relaxed for many results, but in its current form it
signi…cantly simpli…es the exposition.
The optimal allocations solve the dynamic mechanism design problem (see,
e.g., Golosov, Kocherlakota, and Tsyvinski (2003)):
Z
T
X
t 1
G E1
U c t t ; yt
max
t
t
fct ( );yt ( )g t 2 t ;t=1;::;T
t=1

t

subject to the incentive compatibility constraint:
( T
)
X
t 1
E0
U c t t ; yt t = t
t=1

E0

( T
X

t 1

U ct

t

t

; yt

t

t

=

t

t=1

and the feasibility constraint:
( T
X
t 1
E0
ct
t=1

t

)

E0

( T
X
t=1

7

t 1

yt

t

=

t

)

;8

)

:

!

T

dF1 ( ) (3)

2

T

; (4)

(5)

The expectation E0 above is taken over all possible realizations of histories.
Note that the expectation in the objective function is taken after the …rst
period shocks are realized.
We follow Fernandes and Phelan (2000) and Kapiµcka (2010) to brie‡y describe the recursive formulation and refer to these two papers for the technical
details. Let ! ~j

! R denote promised utility to an agent of skill

:

who reports skill ~. We use notation !( ) and ! to denote functions !( j )

and !( j ), respectively. Let c :

! R+ and y :

! R+ :

The optimal allocations solve the cost minimization problem for period
t = 1:
V1 (! 0 ) = min
c;y;!

Z

(c ( )

y ( ) + V2 (! ( ) ; )) f1 ( ) d

subject to the incentive compatibility constraint:
U (c ( ) ; y ( ) = ) + ! ( j )
U c ~ ;y ~ =

+ ! ~j

; 8~ 2

; 2

; (6)

and to the promise keeping constraint:
Z
!0
G (U (c ( ) ; y ( ) = ) + ! ( j )) f1 ( ) d :
The initial promised utility ! 0 is a solution to V1 (! 0 ) = 0.
For t > 1, the social planner takes the period t

1 realization of the shock

and the chosen promised utility function !
^ ( ) as given and solves:
Z
Vt (^
! ( ) ; ) = min (c ( ) y ( ) + Vt+1 (! ( ) ; )) ft ( j ) d

(7)

c;y;!

subject to the incentive compatibility constraint (6) and
Z
~
!
^ ( j ) = (U (c ( ) ; y ( ) = ) + ! ( j )) ft j~ d for all ~ 2
8

:

(8)

The function VT +1 (! ( ) ; ) = 0, if ! ( ) = 0, and VT +1 (! ( ) ; ) = 1,
otherwise. All other functions Vt are de…ned by backward induction. The
function Vt is the resource cost of delivering promised utilities ! ( ).
The incentive compatibility constraint states that an agent prefers to reveal
his true type , receive utility U (c ( ) ; y ( ) = ) and a continuation utility
! ( j ) rather than claim a di¤erent type ~, receive utility U c ~ ; y ~ =

and continuation utility ! ~j

. The promise keeping constraints (8) ensure

that next period allocations indeed deliver the expected utility ! ~j

to any

type ~ who sends a report :

We proceed in this section by using the …rst order approach developed by
Kapiµcka (2010) and Pavan, Segal, and Toikka (2010) to obtain a more manageable recursive formulation. One needs to keep track only of the "on the path"
promised utility ! ( j ) and the utility from a local deviation ! 2 ( j ), where
! 2 ( j ) is the derivative of ! with respect to its second argument evaluated at
( j ) : Then de…ning functions w :
problem (7) can be re-written as
Z
Vt (w;
^ w^2 ; ) = min
(c ( )
c;y;u;w;w2

! R and w2 :

! R, the maximization

y ( ) + Vt+1 (w ( ) ; w2 ( ); )) ft ( j

)d
(9)

u0 ( ) = U (c( ); y( )= ) + w2 ( ) ;
Z
w^ = u ( ) ft ( j ) d ;
Z
w^2 = u ( ) f2;t ( j )d ;

(10)

u( ) = U (c( ); y( )= ) + w( ):

(13)

(11)
(12)

There are three state variables in this recursive formulation: w^ is the promised utility associated with the promise-keeping constraint (11); w^2 is the state

9

variable associated with the threat-keeping constraint (12);
ted type in period t

is the repor-

1. In what follows we assume that solution to (9) is

di¤erentiable.4
The …rst-order approach is valid only if at the optimum the local constraints (10) are su¢ cient to guarantee that global incentive constraints (6)
are satis…ed. It is well known, that there are no general conditions either in
the static mechanism design problem with multiple goods (see, e.g., Mirrlees
(1976)) or in dynamic models (see, e.g., Kapiµcka (2010)) that guarantee that
only local incentive constraints bind. In the next lemma we show su¢ cient
conditions that the optimal allocations must satisfy to guarantee that local
constraints (10) imply (6).
Assumption 5. The optimal allocation satis…es
c0 ( )

0; ! 1

j^

0; ! 12

j^

0; for all ; ^.

(14)

Lemma 1. Suppose that Assumption 1 and Assumption 5 are satis…ed. Then
(10) implies (6)
In the numerical part of the paper we verify that Assumption 5 is satis…ed
for the calibrated model.
As stated, problem (9) does not need to be convex. However, if it is not,
welfare can be improved by allowing randomizations over w and w2 . Then the
di¤erentiability of Vt can be established following the methods similar to, e.g.,
Acemoglu, Golosov, and Tsyvinski (2008). To avoid cumbersome notation, for
the rest of the paper we make the assumption that follows.
4

It is well known that there are circumstances when solutions to this problems are not

di¤erentiable, for example, when it is optimal to bunch di¤erent types. There are standard methods to characterize this problem in such situations at an expense of introducing
additional notational complexity.

10

Assumption 6. Vt is convex and di¤erentiable in w;
^ w^2 :
Before characterizing the problem, we re-write the optimal problem to
highlight the e¤ects of persistence. To minimize on notation, we drop explicit
conditioning of functions on , and use, for example, notation c instead of c( )
whenever this does not cause confusion.
Lemma 2. Let (c ; y ; u ; w ; w2 ) be a solution to (9) for t > 1.
(c ; y ; u ; w ; w2 ) is a solution to
Z
min
(c y + Vt+1 (w; w2 ; )) ft ( j
(c;y;u;w;w2 )

subject to (10), (13), and
Z
w^ =

1

f2 ( j )
f( j )

uf ( j

Then

(15)

)d

)d ,

(16)

for some constant :
f2 ( j
f( j

In the constraint (16) utility u ( ) is multiplied by the term 1

)
)

.

This pseudo-objective is equivalent to the objective function of a social planner that has (non-normalized) weights 1
weights equal to 1 for all types

f2 ( j
f( j

)
)

instead of the utilitarian

in period t. As we will argue later in our anaf2 ( j
f( j

lysis, the relevant case in most circumstances is > 0: The term 1

)
)

assigns the highest weight to the lowest type and monotonically decreases for
the higher types. In other words, the planner’s objective is more redistributionary towards the lower types in period t. The intuition for this change in
weights is as follows. Consider a marginal deviation in period t
type
on f ( j

+ claims to be type

1. Suppose

for some small . Under the above assumption

), this type is relatively more likely to receive high shocks

latively less likely to receive low shocks

and re-

in period t. The social planner who

is more redistributive in period t and puts higher (pseudo) weights on the low
11

types allocates relatively low utility to this agent. The type
antly a¤ected, since his probability of having high shocks

is not signi…cis relatively low.

This agent bene…ts from more redistribution as for him the high shocks

in

period t are less likely. The same intuition generalizes for other stochastic processes. The main insight is that the social planner allocates relatively higher
pseudo weights on those realizations of shocks

for which there is a relatively

large di¤erence in the probability of occurrence between types
close to

and types

.

Now we de…ne and proceed to characterize optimal distortions. For an
t

agent with the history of shocks
y
t

1

at time t, we de…ne a labor distortion:
Ul ct
t Uc ct

t

t
t

; yt
; yt

t
t

=
=

t

(17)

t

and a savings distortion
t

s
t

1

=

Et

Uc ct
Uc ct+1

t
t+1

; yt t = t
; yt+1 t+1 =

:

(18)

t+1

For some results it will also be useful to de…ne a life-time savings distortion,
s
t,

as
T t

1

2

s
t

t

=

Uc c t
Et Uc cT

t
T

; yt
; yT

t

=
T

t

=

:

(19)

T

Characterization of distortions

In the appendix, we proceed by setting up Hamiltonian to (15) and characterizing the solution under the assumptions made in the previous section. In
this section, we instead provide a heuristic analysis of the problem in which
we emphasize a close connection of the dynamic mechanism design problem
(9) and static tax problem with two goods, as in Mirrlees (1976) and Mirrlees
(1986). We show how the insights from the static model can be used to provide
characterization of the distortions in the dynamic model.
12

We now re-write the problem in a more intuitive form. De…ne function
Ht (r; w^2 ;

) implicitly from Vt (Ht ; w^t ;

) = r and denote by Hr;t =

the partial derivative of H with respect to r. Ht (r; w^2 ;

@Vt
@w

1

) is the maximal

utility that the social planner can provide to an agent in period t if the agent
has r amount of resources. Parameter w^2 captures how much additional redistribution the planner promised in the previous period, as discussed in Lemma
2. That is, Ht (r; w^2 ;
type

) is an indirect utility function for an agent who was

in the previous period, has r units of savings, and faces the optimal

schedule of distortions over his lifetime. With this notation, we can write a
dual problem to (15) as
Ht (^
r; w^2 ;

) = max

u;c;y;r;w2

Z

f2;t ( j )
ft ( j )

1

uft ( j

)d

subject to the incentive compatibility constraint (10), and
Z
(c y + r) ft ( j ) d = r^;

(20)
(21)

u = U (c; y= ) + Ht+1 (r; w2 ; ) :

If we take w2 as being set optimally, the optimization with respect to
(u; c; r; y) in this problem is analogous to the maximization in the static model
with labor and two goods, c and r, which have relative prices 1 and

with

respect to labor y: To simplify notation, we drop explicit notation with respect
to t and
(10),

, whenever this does not cause confusion. If

is the multiplier on (20), and

is a multiplier on

is a multiplier on (21), the necessary

conditions can be written, using notation pc = 1; pr = ; and py =
U j ) = Uj for j 2 fc; yg ;

( f pj

f pr =
1

f2
f

f+
13

(22)
(23)

Hr ;
=

1 as

0

:

(24)

These …rst order conditions are equivalent to those in a static model with
two goods (see Mirrlees (1976); equations (33) and (34)). As Mirrlees (1976)
discusses, generally we expect that the multiplier on the incentive compatibility
constraint

is nonnegative (which corresponds to downward binding incentive

constraints), although it is di¢ cult to rule out that
for some . We proceed by assuming that

can take negative values

is non-negative everywhere, and

show in the online appendix that this is indeed the case when Ucl = 0 or shocks
are independent across periods.

2.1

Savings distortions

We …rst characterize savings distortions. Direct comparison of (22) and (23)
shows that when

0;
1
Uc;t
pc

1
Hr;t+1 ;
pr

(25)

with strict inequality when Ucl = 0: This result has a direct analogue in the
static multi-good model. Mirrlees (1976) shows that when

is non-negative,

it is optimal to distort the good which is more complementary with leisure.
The intuition for this result is as follows. The role of the distortions is to
provide incentives for the agents with the high skill not to pretend to be of
low skill. When such a deviation occurs, a deviating agent enjoys more leisure
than the truth telling agent of the low type5 . Therefore, taxing goods which
are complementary with leisure helps to relax the incentive constraints. In
the context of our model, consumption today, c, is a substitute with leisure,
because Ucl

0; while Hrl = 0: This implies that good r should be more

distorted than good c.
5

See Kaplow (2008) for a detailed discussion of nonseparable preferences in a static

context.

14

To explore the implication of (25) for savings distortions, we now discuss
the relationship between Hr;t+1 and Et Uc;t+1 : By the envelope theorem, Hr;t+1
is equal to an increase in the expected utility from any incentive compatible
allocation of an additional unit of resources tomorrow. An allocation of a unit
of resources equally across for all the realizations of shocks in period t + 1
is generally not incentive compatible, which implies that Hr;t+1 6= Et Uc;t+1 :
When preferences are separable between c and l it can be shown (see, e.g.,
Golosov, Kocherlakota, and Tsyvinski (2003) or Farhi and Werning (2009) that
an incentive compatible perturbation increases utility of consumption, U (c( )),
1
equally for all the realization of ; and that Hr;t+1 = Et Uc;t+1

1

: When there

is uncertainty about consumption in period t + 1; Jensen’s inequality implies
that Hr;t+1 < Et Uc;t+1 ; which, together with (25), implies that

s
t

> 0: When

preferences are non-separable, Hr;t+1 can be greater or less than Et Uc;t+1 ; and
s
t:

in general it is not possible to sign

We show, however, that under some

conditions it is possible to sign the life-time savings distortion,

s
t:

Integrate (24), using the boundary conditions (0) = (1) = 0 and the
R1
R
fact that 0 f2 d = 0, to get
d = 1: If we substitute the expression for
from (23) and the equality Hr;t = , we get
Et

Hr;t
= 1:
Hr;t+1

(26)

This expression is a generalization of the "inverse Euler equation" which is
obtained with separable preferences.6 Similarly to the inverse Euler equation,
it implies that it is optimal to have a positive distortion between marginal
utility of resources in period t, Hr;t ; and period t + 1; Et Hr;t+1 : Iteration of
(26) implies that
T t

Et
6

Hr;t
= 1:
Hr;T

To see this, substitute (25), which holds with equality in separable case.

15

This expressions has important implications for the lifetime savings distortion,

s
t;

in environments in which agents eventually retire. If all agents retire

by period T; Hr;T = Uc (cT ; 0) ; which, combining with inequality (26) implies
that

s
t

> 0: The simplest restriction on fundamentals that ensure retirement

is the assumption that

T

= 0 with probability 1, for any history of shocks.

We summarize this discussion in the following proposition
Proposition 1. Suppose that assumptions 1, 5, and 6 hold. Suppose that
FT (0j

) = 1 for all

and

0: Then

s
t

0, with the strict inequality in

all states in which the incentive constraint (10) is binding and Ucl > 0:
Although it is di¢ cult in general to characterize the cross-sectional implications for the optimal savings wedge
wedge

w

de…ned as

w

= 1+

s

; one can …nd an expression for the

Uy =Hr : By analogy with

ures distortion between labor supply and consumption today,

y

; which measw

measures a

distortion between labor supply and consumption tomorrow. In the appendix
we show that
w

= 1+

" Ucl
" + 1 Uc

y

y

(27)

:

In the next section we derive an expression for the labor wedge
use expression (27) to get insights about dynamics of

w

y

( ) and

. We also will use it

to show an important insights about asymptotic behavior of the wedges. As
long as the degree of substitutability of consumption and leisure, Ucl =Uc does
w

not go to zero, (27) shows that the gap between the two distortions,

=

y

widens if more productive types supply more e¤ort. In the next section, we
show that for some widely used classes of preferences this implies that
go to zero for high

types.

16

y

must

2.2

Labor distortions

Next, we turn to characterization of labor distortions. Again, we can use the
standard arguments of Mirrlees (1971) and Mirrlees (1976) to re-write the …rst
order condition (22) as
y

1
One can then express

y

=

1+

1
"

f

(28)

Uc :

from (22), substitute into (24), and integrate to

obtain the expression for : In the appendix, we describe in details how to
proceed and derive the expression that follows for the labor wedge:
y

=

y

1

1
1+
"

1
where

c

and

1
u

"Z ^
#
Z (
u
F( ) 1
y_
d 0
exp
1
c
f( )
y
!
!
"Z ^
)
#
^)
f2 (^)
U
w
f
(
cc
1
Uc (^) exp
d^; (29)
d 0
1 F( )
(Uc )2
f (^)
1

are compensated and uncompensated elasticities of labor sup-

ply holding savings …xed. We wrote the expression in terms of the elasticities
holding savings …xed to facilitate comparison with the optimal taxes in the
static models, e.g. Diamond (1998) and Saez (2001).
There are three key di¤erences with the formula for the labor wedges in
the static economy such as Saez (2001), Proposition 1. The …rst di¤erence the
hR ^
i
0
Ucc w1
term exp
d
, which depends on the future promised utility and on
(U )2
c

the current realization of the shock. This term is less than 1, which points
out that there is a force that pushes the wedges lower in the dynamic setting.

The second di¤erence is that the social weight that the planner applies to
agents of di¤erent types changes when the shocks are persistent di¤ers from the
true social weight G0 Uc ( ) . We already discussed the intuition behind this
changing the social welfare in Lemma 2. Finally, the expression

17

1 Ft ( j )
ft ( j )

in

(29) depends on the distribution of shocks conditional on last period realization
rather than the cross-sectional distribution of shocks in static models.
Diamond (1998) used the static analogue of (29) to show that if utility is
quasi-linear then the …rst integral in (29) asymptotically converges to 1 and
y
y

1

converges to 1 +

1
"

1 F cs
f cs

from below, where f cs and F cs denote the

cross-sectional distribution of the types. His analysis can easily be extended
to any quasi-linear preferences of the form
U (c; l) = U~ (c

(30)

h(l)) :

As Diamond (1998) and Saez (2001) discuss, the empirical distribution of
income

1 F cs
f cs

is such that the implied asymptotic labor distortions may be

quite high, with

y

! 0:8 for some speci…cations of ": We show next that

the conclusion about the size of the optimal labor distortions may change
signi…cantly in the dynamic models.
Let the preferences have the form (30). In this case, Ucl =Uc =
y

h0 (l) = (1

~ 00 0
U
~ 0 h (l)
U

and

) : Substitute these expressions into (27) to obtain
#
"
Uy
U~ 00
"
y
1+
(1
) y y;
= 1+
Hr
1 + " U~ 0

where we used (28) and (30). The left hand side of this expression is less than
1. Consider the right hand side of this expression. Suppose that
converge to 0: As long as
term (1
~ 00
U

~0
U

y

y

y

did not

is bounded away from 1, this implies that the

) y goes to in…nity. If the coe¢ cient of the absolute risk aversion

is bounded away from zero, this implies that the right hand side of this

expression is unbounded and eventually becomes greater than 1 which leads
to a contradiction. Therefore, we have the following result which we prove
formally in the appendix.

18

Proposition 2. Suppose that assumptions 1, 2, 3, 5, 4, and 6 hold. Suppose
that preferences are of the form (30), and
Suppose that 1
Then

3

y
t

f2 (^)
f (^)

Ucc =Uc is bounded away from zero.

0; or that Uc (^) and

f2 (^)
f (^)

are bounded from above.

! 0 for t < T:

Quantitative analysis

We now turn to the quantitative study of a calibrated model. The theoretical analysis above unambiguously points to empirical skill distributions as a
crucial input for a quantitative analysis. Before we proceed to estimate skill
distributions, we start by constructing a dataset of individual skills, , implied
by the observed micro level data for the U.S.
The main di¢ culty in estimating skills from the data is that skills are
unobservable. One can use wages as a proxy for skills but it is not clear that
this measure corresponds to ; which measures the return to e¤ort. Because of
these conceptual problems with using wage data we chose a di¤erent approach.
We use the data on the actual U.S. tax code and labor income choices to infer
the unobservable skill level. Since the details of the actual U.S. system of
taxes and transfers are observable, we compute the implied individual skills
from the necessary conditions for individual optimum. The methodology is a
dynamic extension of that of Saez (2001) who used a similar approach to infer
cross-sectional distribution of skills in the population.
Both to simplify the analysis and to be directly comparable to previous
work of Diamond (1998) and Saez (2001), we choose quasi-linear preferences
(30) with a constant elasticity of labor supply ": For these preferences, the
implied skill

i;year

for an individual i in a given year is computed from the

19

individual …rst-order conditions as follows:
i;year

yi;year

=
yi;year 1

0
Tyear
(yi;year )

"=(1+")

;

where yi;year is the labor income of individual i observed in a given year, and
0
(yi;year ) is the e¤ective marginal tax rate that the individual faces when
Tyear

she earned her labor income. Since there are no income e¤ects with quasi-linear
preferences (30), an individual labor supply decision is una¤ected by individual
savings choice, and thus a static consumption-labor margin determines the
implied skill.
We brie‡y outline our empirical and computational strategy. The online
appendix contains a complete description of our approach with further details
and summary statistics. Our main data source is the U.S. Panel Study of
Income Dynamics (PSID). We use the data collection waves from 1990 onward
with the latest currently available data wave of 2007, which contains data
from 2006. Recent waves (from 1996) come in two year intervals, hence, we
consider a total of nine waves with two years in between. To be consistent
with the data, a period in our calibrated model correspond to two years, i.e.,
T = 20, and we model 40 years of working life. The labor income, yi;year , is
obtained directly from the PSID waves, converted to constant 1990 dollars. We
consider total labor income, which is a sum of a list of variables in the PSID
that contain data on salaries and wages, separate bonuses, the labor portion of
business income, overtime pay, tips, commissions, professional practice or trade
payments, market gardening, additional job income, and other miscellaneous
labor income.7
0
E¤ective marginal tax rates, Tyear
(yi;year ), are estimated for each individual

using TAXSIM - a National Bureau of Economic Research’s program for cal7

The online appendix contains speci…c details and variable names.

20

culating individual e¤ective liabilities under the U.S. Federal and State income
tax laws from individual data. For each individual with labor income we also
have in the PSID a collection of personal data that are in most cases su¢ cient
to estimate individual and year speci…c e¤ective marginal tax rates. Finally,
we use the constructed total individual labor incomes and the estimated e¤ective marginal tax rates to compute implied skills from the individual optimality
conditions as described above.
Estimation approach. We …rst estimate the initial unconditional distribution of implied skills among the initial young workers, F1 ( ). We consider
the 25 year old from all of the PSID waves to obtain the sample of 8,231
observations. We estimate F1 ( ) non-parametrically using a kernel density estimation. The resulting distribution is shown as "initial young, unconditional"
distribution depicted by a dotted line in Figure 1. One concern with a crosssectional distribution is that high income individuals may be undersampled in
the PSID or that the PSID is "top coded", i.e., there is an income cuto¤ level
above which no observations are collected. To address this concern we …t a
Pareto distribution to the right tail of our skill distribution. Speci…cally, we
let skills to be Pareto distributed above the income level of $150; 000.
To estimate conditional distributions Ft ( j _), i.e. transition probabilities,
we exploit the panel feature of the PSID. We start by considering all individual
skill transitions between adjacent data waves. Furthermore, we break all these
wave-to-wave skill transitions into two age groups – when the individual is
younger than 45 at the beginning of the transition and when the individual is 45
or older at the beginning of the transition. We therefore estimate two separate
conditional distributions Fyoung ( j _) and Fold ( j _). Hence we assume age
dependence between the age groups and age-independent transitions within

21

each age group.8 In other words, we allow younger individuals to experience
di¤erent transition probabilities than older individuals; within each age group,
we assume age-independent transition probabilities.9
0.5
initial y oung, unconditional
y oung, $50K income history
old, $50K income history
y oung, $150K income history
old, $150K income history

0.4

0.3

0.2

0.1

0

0

50

100
150
200
Labor income, $1000s

250

300

Figure 1: Initial unconditional vs. some of the conditional distributions

To provide an easy comparison, Figure 1 displays the initial unconditional
distribution (the dotted line) together with just four examples of the estimated conditional distributions, two from each age group. An old skill distribution conditional on $50; 000 income, with the conditional expected income of
$54; 937, appears as the closest to the initial unconditional distribution. The
di¤erence between the conditional expected income and the unconditional expected income of $23; 963 is primarily due to a signi…cantly thicker right tail.
A young skill distribution conditional on $50; 000 income is the next closest to
the unconditional one with the conditional expected income of $58; 599. The
8

We also check our results for robustness by removing this age dependence in the estim-

ated conditional distributions.
9
We stop at just two age groups to have su¢ cient number of data points to estimate
all conditional distributions. There is nothing in our computational solution method that
would stop us from having a di¤erent transition matrix for each period, provided that we
had enough data to obtain those transition matrices.

22

other two examples of conditional distributions di¤er more signi…cantly from
the initial unconditional distribution. An old skill distribution conditional on
$150; 000 income has the conditional expected income of $109; 893. A young
distribution conditional on $150; 000 income has the conditional expected income of $115; 508. If one were to compare the initial unconditional distribution
with a cross-sectional unconditional distribution, it would reveal that the initial young unconditional distribution appears less unequal with a somewhat
thinner right tail, which is perhaps not surprising for a sample of young 25
year old workers.
The estimated conditional distributions imply a persistent skill shock process. Depending on the speci…cation of the stochastic process, estimates of the
persistence of skills simulated with our conditional distributions range from
0.73 to 0.81. These persistence estimates are not as high as the estimates of
0.95 and higher in Storesletten, Telmer, and Yaron (2004) and are closer to
the estimates around 0.8 in Guvenen (2009). All these estimates are signi…cantly higher than the estimate of 0.5 in Heaton and Lucas (1996), who do not
condition on age.
Calibration. We model a life cycle of 40 years of working life, i.e., the
individuals between the ages of 25 and 65; with one period representing two
years as dictated by our main data source, the PSID. We choose preferences
of the form
1

exp

c

l

:

As we explain in the online appendix, exponential preferences allow to reduce
the dimension of the state space in the recursive formulation. We set the
coe¢ cient of absolute risk aversion, , equal to 10. Numerical simulations are
re-scaled so that consumption ranges from 0:1 to 1 implying that relative risk
aversion ranges from 1 to 10 when

= 10. The elasticity parameter, , is set
23

to 3 with the Frisch elasticity of labor supply then " = 1= (
annual discount factor is

1) = 0:5. The

= 0:9804 and the marginal rate of transformation

across years is = 1:02 so that the social planner at the solution of the optimal
program chooses not to transfer resources between periods.
Finally, in the benchmark analysis we assume that the social welfare criterion is utilitarian. We discuss the implications of relaxing this assumption
later in the section.
Results. Given the parameters of the calibrated model and the empirically
estimated skill distributions, we proceed to solve the model numerically by
exploiting the recursive formulation of the dual problem. Figure 2 presents
the results of numerical simulations. Consider …rst panels A and B. Panel A
displays labor distortions at the initial age of 25 and at ages 27, 35, 45, 55,
and 65 for the agent with a history of shocks up to that period such that
in each previous period he had income of $50; 000. Panel B displays labor
distortions at the same ages for the agent with a history of shocks up to that
period such that in each previous period she had income of $150; 000. Both
for agents with $50; 000 and $150; 000 income histories, the lowest, dotted line
is the unconditional labor wedge at the initial age of 25, which is identical
in both panels, and generally higher lines represent distortions at older ages.
These two examples correspond to the two examples (for each age group) of
the estimated conditional distributions of skills in Figure 1.
There are several key features of interest with the labor wedge results.
First, both for the agent with the history of $50; 000 incomes and for the agent
with the history of $150; 000 incomes, the average conditional labor wedges are
increasing with age. This is consistent with our theoretical …ndings where the
provision of incentives dynamically allows to lower labor wedges early in life.
The planner then wants to distort the provision of the incentives in the future,
24

A. Labor distortions, $50K income history

B. Labor distortions, $150K income history
1

age
age
age
age
age
age

0.8
0.6

25
27
35
45
55
65

Marginal distortion rate

Marginal distortion rate

1

0.4
0.2
0

50

100
150
200
250
Labor income, $1000s

0.8
0.6

0.2

C. Capital distortions, $50K income history

50

100
150
200
250
Labor income, $1000s

300

D. Capital distortions, $150K income history

1

1
age
age
age
age
age

0.8
0.6

25-27
33-35
43-45
53-55
63-65

Marginal distortion rate

Marginal distortion rate

25
27
35
45
55
65

0.4

0

300

age
age
age
age
age
age

0.4
0.2
0

age
age
age
age
age

0.8
0.6

25-27
33-35
43-45
53-55
63-65

0.4
0.2
0

50

100
150
200
250
Labor income, $1000s

300

50

100
150
200
250
Labor income, $1000s

300

Figure 2: Labor and capital distortions with persistent shocks

and therefore to distort the intertemporal margin. The further away the agents
from the end of the working life, the bigger are the planner’s opportunities
to distort the intertemporal margin which also relates to our analysis of the
lifetime savings distortion. This allows the planner to substitute the labor
wedge for the intertemporal wedge. As agents near the end of the working life,
the power of the intertemporal distortions decreases, and the labor wedges are
higher.
Second, the conditional labor wedges for an agent with a history of $50; 000
incomes are generally lower, especially at older ages, than those for an agent
25

of the same age with a history of incomes of $150; 000. In particular at age
65, the distortions for an agent with a $50; 000 income history start from 0:16
and increase to 0:33 at $150; 000 current income before decreasing to 0:27 at
$300; 000 current income. The distortions for an agent with a $150; 000 income
history start from 0:36 and increase to 0:43 at $150; 000 current income before
decreasing to 0:34 at $300; 000 current income. There are two forces driving
these di¤erences that follow from the discussion in the theoretical analysis:
(i) the additional redistribution over time implied by the persistent shocks
and (ii) the di¤erences between conditional and unconditional distributions
of skills as well as the di¤erences in conditional distributions among agents,
speci…cally between those with a history of relatively low incomes and those
with a history of relatively high incomes as is evident from the discussion of
the examples in Figure 1 above.
Third, consistent with Proposition 2, the labor wedge decreases for the high
incomes at every age for any history. Figure 2 shows this for two particular
histories of $50; 000 incomes and $150; 000 incomes with the decrease in wedges
at all ages for incomes above $150; 000.
Next, consider capital wedges in panels C and D of Figure 2. Panel C
presents capital distortions between the initial age of 25 and age 27, and
between ages 33-35, 43-45, 53-55, and 63-65, with generally lower lines representing younger ages, for the agent with a history of shocks up to that period
such that in each previous period he had income of $50; 000. Panel D displays savings distortions at the same ages, once again with generally lower
lines representing younger ages, for the agent with a history of shocks up to
that period such that in each previous period she had income of $150; 000. In
both examples, the conditional savings distortions are generally increasing in
current period realization of income as well as with age. The distortions are
26

close to zero for current incomes below $50; 000. For the agents with a history
of $50; 000 incomes, savings distortions at current income of $300; 000 reach
as high as 0:06 at ages 25-27 and 0:34 at ages 63-65. For the agents with a
history of $150; 000 incomes, savings distortions reach at current income of
$300; 000 as high as 0:07 at ages 25-27 and 0:39 at ages 63-65.
Welfare losses from simple tax policies. Farhi and Werning (2010)
solve a dynamic model with idiosyncratic shocks and argue that in their parametrization the fully optimal non-linear tax system can be well approximated
by simpler linear taxes when the social planner is utilitarian. We use a different stochastic process for skills and assume di¤erent preferences. Still, as
…gure 2, the optimal history-dependent non-linear labor distortions appear to
be mostly ‡at. Next, we explore the magnitude of welfare losses in our model
from using simpler tax instruments.
A natural benchmark for comparison is optimal linear taxes. We keep
optimal savings distortions and transfer all revenues lump sum back to the
agents. First, consider the case of the utilitarian social planner. Using optimal
age-dependent linear labor wedges instead of the constrained optimal wedges
results in a welfare loss of 0:9% of consumption equivalent. Using optimal
age-independent labor distortions increases the welfare loss to 1:6%. While
these magnitudes are non-trivial, linear taxes can still yield reasonably good
policies.
The result that welfare gains from non-linear taxes are small for utilitarian
social planner has parallels in the static Mirrlees models. Mirrlees (1971),
Atkinson and Stiglitz (1976), Tuomala (1990) also found in numerical simulations that the optimal labor distortions appear to be mostly ‡at in this case.
They also argued that as the importance of nonlinearities increases, the social
planner becomes more redistributive. To investigate this in dynamic settings,
27

we compute the welfare gains of using optimal policies when the social planner
is Rawlsian. The optimal age-dependent linear labor wedges yield a welfare
loss of 4:6% of consumption compared to the constrained optimum. The optimal age-independent labor wedges yield a welfare loss of 5:1%. We conclude
that the welfare gains of using optimal non-linear policies are signi…cant.

4

Conclusion

In this paper, we take a step toward reconciling two literatures: the dynamic
optimal taxation literature and the classic static optimal taxation literature.
We show that a dynamic optimal taxation model shares many similarities
with the static model with two goods. A suitably written recursive formulation of the dynamic model separates the analysis as one involving utility
of consumption (and labor) today and the future utility over transferred resources. This allows one to use the insights of the static literature to study
the optimal dynamic labor and savings wedges and extend the analysis of the
forces behind the optimal wedges in Diamond (1998) and Saez (2001) to the
dynamic settings. We show that while there are many similarities, the dynamics importantly alters the prescription of the static optimal taxation literature.
Perhaps, the most important di¤erence is that while the static literature prescribes labor taxes to be as high as 50-70% for the high skilled individuals in
the calibrated models, in the dynamic settings the labor wedge tends to zero
for the high skilled. Other important di¤erences include the use of conditional
rather than unconditional distribution of skills, an ability to use intertemporal
distortions to lower labor wedges, especially, early in the life of the agents,
and the behavior and implications for the savings distortions not present in
the static models.

28

Importantly, we calibrate our model by estimating the skill distribution
and its evolution over the lifetime as this is one of the key determinants of
the dynamic labor and savings distortions. We compute optimal labor and
savings distortions and …nd them signi…cantly di¤erent from the static ones.
As such, we conclude that while conceptually one can think of the dynamic
optimal taxation model in its recursive form as of a static model with two
goods, the dynamics adds important insights that signi…cantly change the
policy prescriptions.
Conesa, Kitao, and Krueger (2009) take a di¤erent approach to the analysis
of the dynamic optimal taxation models. They study tax reforms and the
optimal taxes within a set of the parametrically restricted tax functions. One
advantage of that approach over solving for the full informationally constrained
optimum is that it is computationally more feasible and allows one to study
optimal taxes which are most commonly used in practice. Our paper points
out to the elements that may be important in choosing the parameters of such
functions.

5

Appendix

To keep our analysis here succinct, let x = (c; y), p = (1; 1)0 , pc = 1, py =

1,

and use shorthand notation for utility U (x; ) : Then a Hamiltonian to (9)
H=
where , ;

u 1

f2
f

= , and

(px + V ) f + [u

U

w]

U

w2 ;

are the respective multipliers on (10), (11), (12), and

(13).
The …rst order conditions are as follows: with respect to good j 2 fc; yg:
f pj

U j = Uj ;
29

(31)

with respect to u
f2
f

1

f+

=

0

(32)

;

with respect to w and w2 (where we use V1 and V2 to denote relevant cross
partial derivatives)
V1;t+1 f =

;

(33)

V2;t+1 f =

:

(34)

and

Also, note that the envelope theorem implies that
V1;t+1 =
Use (31) for c to …nd
pc

t ; V2;t+1

py =

y

(35)

= t:

and substitute it into (31) for y
Uy
Uc

py f =

Uy
Uc
Uc

Uy
U c Uy
Uc

=
Since pc UUyc

=

1+

1
"

:

; it implies that
y

1

y

=

1+

1
"

Uc

f

(36)

:

This expression shows that if U satis…es Assumption 1 then the sign of
is equal to the sign of : The expression for the multiplier

y

can be obtained

by integrating (32) with a boundary condition (0) = 0: By substituting
from the FOCs for w or c; we show in the online appendix that
!
#
Z "
f2 (^)
=
1
V1 (^) f (^)d^
^
f
(
)
0
!
!
Z
Z
Uc ( 0 )
f2 (^)
1
=
1
exp
0 d
^ Uc ( )
f (^)
Uc (^)
0
30

(37)
0

f (^)d^

As we already discussed, it is di¢ cult to determine the sign of

and : The

analogous problem arises in the static model with multiple goods, as explained
by Mirrlees (1976). Similar to that literature, we focus on the case of
and

0

0. In the online appendix we show that these assumptions are indeed

satis…ed if preferences are separable or shocks are i.i.d.
We characterize the savings distortions …rst. It is useful to characterize the
distortion

w

, de…ned as
w

1

(38)

V1 Uy :

This is a wedge between the marginal cost of labor today and the marginal
cost of providing one util to this agent tomorrow. Use the …rst order conditions
(31) and (33) to obtain
1
Since Uc = Ucl

y

V1 Uc f =

(39)

Uc :

0;

2

V1;t+1 Uc;t

(40)

1:

We can also rewrite (39) as

1

V1 ( Uy )

Uc
Uy

=

y

and

Substitute (36) and the de…nitions of
w

= 1+

" Ucl
" + 1 Uc

Uc Ucl
f Uc
w

y

y

:

and re-arrange
y

(41)

:

This is the expression (27) in the body of the paper. Since the expression in
square brackets is greater than 1, this implies that

w

y

(see the online

appendix for details).
When Ucl = 0 this expression implies the Inverse Euler Equation. To see
this consider the the second line of (37). The boundary condition (1) implies
31

that

=

R1
0

1
f (^)d^.
Uc (^)

The envelope condition (35) gives the expression for
1

; so that V1;t+1 = Et (Uc;t+1 )

: Combine it with (40) (which holds with

c;t
equality in separable case) to get Et UUc;t+1
= 1:

We now characterize the lifetime saving distortion. Use the …rst line of
(37) with the boundary condition (1) = 0 to get
Et V1;t+1 =

t

(42)

= V1;t

where the second equality follows from (35). Since V1 = 1=Hr ; this equation
implies (26).
We now ready to prove Proposition 1. When there is no labor supply
in the last period, then U (cT ; 0) = w and VT (w) = U
1
:
Uc (cT ;0)

V1;T =

1

Use (42) to show that
T t

2

V1;t =

(w; 0): Therefore,

Et fV1;t+1 g =

Et fEt+1 fV1;t+2 gg =

=

1
Uc;T

Et

:

Then (40) implies that
T t

1

Uc;t Et

1
Uc;T

; for all t;

which by Jensen’s inequality implies that
T t

1
and proves Proposition 1.

Uc;t
;
Et fUc;T g

We now explore the determinants of the labor wedges. A key term in (36)
is Uc ( ) ( ). Use the second line of (37) and the boundary conditions on
to determine Uc :
Uc ( ) ( )
= Uc ( )
exp

Z

1

"Z

(

^

1
U~c (^)

Uc ( 0 )
d
Uc ( 0 )
32

1
0

#

1
)

f (^) d^

f2 (^)
f (^)

!

!

Uc (^)

#
@ ln Uc ( 0 ) 0
1
1
exp
d
=
d 0
"Z ^
#
)
Uc ( 0 ) 0
exp
d f (^) d^
Uc ( 0 )
8
2
3
Z 1<
Z ^ Uc
Ucc ( 0 )c_ + Ucl l_
exp 4
=
d 05
0
:
Uc ( )
!
!
)
^
f2 ( )
1
1
Uc (^) f (^) d^:
f (^)
Z

1

(

" Z

^

!

f2 (^)
f (^)

h
_ w1 + w2 and (10) to derive c_ = U
Use u0 ( ) = Uc c+U
_ l l+

!

Uc (^)

i
w1 =Uc :

Ul l_

This implies that
Z

=
=

Z

Z

^

Ucc ( 0 )c_ + Ucl l_

Uc

d

0

Uc ( )
^

Uc
Uc

^

l

Ucc U
(Uc )2

Ucc Ul
(Uc )2

l

Ucl
Uc

0

Ucl
Uc

Ucc Ul
(Uc )2

y_
Ucc w1
+
y
(Uc )2

Following Saez (2003) we can show that l U(Ucc U)2l
c

Ucc w1
l_ +
(Uc )2

d

0

d 0:
l UUclc

=

c

u
c

and obtain

the expression for the labor wedge (29).
We now proceed to the proof of Proposition 2. If
all ^; or if 1

1

(29) implies that

y

f2 (^)
f (^)

y

y

(43)

) :

is bounded away from 1, l( ) ! 1. Suppose
y

y

does not

is bounded from above, condition (43) implies

that l ! 1: When U is of the form (30), Ucl =Uc =
Ucc
Uc

0; for

is bounded away from 1: With quasi-linear preferences

converge to zero. Then, since

Since

f2 (^)
f (^)

U~c (^) is bounded from above, then expression

h0 (l) = (1
Therefore, as

1

Ucc 0
h
Uc

=

Ucc
Uc

(1

y

) :

is bounded away from zero, this expression becomes arbitrarily large
33

for some

when
w

from some ,
implies that

w

y

does not converge to zero. From (41) this implies that

( ) > 1: However, since Uy

( )

0 and V1

0; expression (38)

1 for all ; which leads to a contradiction.

References
Acemoglu, Daron, Mikhail Golosov, and Aleh Tsyvinski. 2008. “Markets
versus governments.” Journal of Monetary Economics 55 (1):159–189.
Albanesi, Stefania and Christopher Sleet. 2006. “Dynamic optimal taxation
with private information.” Review of Economic Studies 73 (1):1–30.
Ales, Laurence and Pricila Maziero. 2007. “Accounting for private information.” working paper .
Atkinson, Anthony and Joseph E. Stiglitz. 1976. “The design of tax structure:
direct versus indirect taxation.” Journal of Public Economics 6 (1-2):55–75.
Battaglini, Marco and Stephen Coate. 2008. “Pareto e¢ cient income taxation
with stochastic abilities.” Journal of Public Economics 92 (3-4):844–868.
Conesa, Juan Carlos, Sagiri Kitao, and Dirk Krueger. 2009. “Taxing capital?
Not a bad idea after all!” American Economic Review 99 (1):25–48.
Diamond, Peter. 1998. “Optimal Income Taxation: An Example with a UShaped Pattern of Optimal Marginal Tax Rates.” American Economic Review 88 (1):83–95.
Farhi, Emmanuel and Iván Werning. 2009. “Capital Taxation: Quantitative
Explorations of the Inverse Euler Equation.” working paper .
— — — . 2010. “Insurance and Taxation over the Life Cycle.” working paper .
34

Fernandes, Ana and Christopher Phelan. 2000. “A recursive formulation for
repeated agency with history dependence.” Journal of Economic Theory
91 (2):223–247.
Fukushima, Kenichi. 2010. “Quantifying the welfare gains from ‡exible dynamic income tax systems.” mimeo .
Golosov, Mikhail, Narayana Kocherlakota, and Aleh Tsyvinski. 2003. “Optimal Indirect and Capital Taxation.”

Review of Economic Studies

70 (3):569–587.
Golosov, Mikhail and Aleh Tsyvinski. 2006. “Designing optimal disability insurance: A case for asset testing.”Journal of Political Economy 114 (2):257–
279.
Golosov, Mikhail, Aleh Tsyvinski, and Iván Werning. 2006. “New dynamic
public …nance: A user’s guide.” NBER Macroeconomics Annual 21:317–
363.
Guvenen, Fatih. 2009. “An empirical investigation of labor income processes.”
Review of Economic Dynamics 12:58–79.
Heaton, John and Deborah J. Lucas. 1996. “Evaluating the E¤ects of Incomplete Markets on Risk Sharing and Asset Pricing.” Journal of Political
Economy 104:443–487.
Judd, Kenneth L. 1996. “Approximation, perturbation, and projection methods in economic analysis.” Handbook of Computational Economics 1:509–
585.
— — — . 1998. Numerical methods in economics. The MIT Press.

35

Kapiµcka, Marek. 2010. “E¢ cient allocations in dynamic private information
economies with persistent shocks: A …rst order approach.” working paper .
Kaplow, Louis. 2008. The Theory of Taxation and Public Economics. Princeton University Press.
Kocherlakota, Narayana. 2010. The New Dynamic Public Finance. Princeton
University Press, USA. Forthcomming.
Kocherlakota, Narayana and Luigi Pistaferri. 2007. “Household Heterogeneity
and Real Exchange Rates.” The Economic Journal 117 (512):C1–C25.
— — — . 2009. “Asset pricing implications of Pareto optimality with private
information.” Journal of Political Economy 117 (3):555–590.
Mirrlees, James. 1971. “An Exploration in the Theory of Optimum Income
Taxation.” Review of Economic Studies 38 (2):175–208.
— — — . 1976. “Optimal tax theory: A synthesis.”Journal of Public Economics
6 (4):327–358.
— — — . 1986. “The theory of optimal taxation.” Handbook of mathematical
economics 3:1197–1249.
Pavan, Alessandro, Ilya Segal, and Juuso Toikka. 2010. “Dynamic mechanism design: Incentive compatibility, pro…t maximization and information
disclosure.” working paper .
Saez, Emmanuel. 2001. “Using Elasticities to Derive Optimal Income Tax
Rates.” Review of Economic Studies 68 (1):205–229.

36

Storesletten, Kjetil, Christopher I. Telmer, and Amir Yaron. 2004. “Consumption and risksharing over the life cycle.” Journal of Monetary Economics
51:609–633.
Tuomala, Matti. 1990. Optimal income tax and redistribution. Oxford University Press, USA.
Weinzierl, Matthew. 2011. “The Surprising Power of Age-Dependent Taxes.”
Review of Economic Studies 78 (4):1490–1518.

37

A

Appendix For Online Publication

A.1

Proof of Lemma 1

Note that given any solution u ( ) following a sequence of reports

t 1

;

;

we can construct
!

j^ =

Z

1

u

t 1

; ; s ft+1 sj^ ds:

0

We can re-write (6) as
max V ^;
^

If ^ =

max U c(^); y(^);
^

+ !(^j ):

is a local maximum for all ; then

Uc c(^); y(^); ^ c0 ^ + Uy c(^); y(^); ^ y 0 ^ + ! 1 (^j^) = 0, for all ^,
(44)
or equivalently
Uc c(^); y(^); ^ y 0 ^
3
2
Uy c(^); y(^); ^
c0 ^
^
^
!1( j )
1
5 = 0; for all ^:
4
+
+
0
0
^
^
^
^
^
^
^
^
y
Uc c( ); y( );
y
Uc c( ); y( );
Note that from (44) and assumptions 1 and 5 y 0
We argue next that for any
0 for all ^ >
V1 ^;

; V1 ^;

0:

0 for all ^ <

; and V1 ^;

; which establishes the lemma. Di¤erentiating V, one obtains

= Uc c(^); y(^);

c0 ^ + Uy c(^); y(^);

= Uc c(^); y(^);
y0 ^
2
Uy c(^); y(^);
c0 ^
4
+
y0 ^
Uc c(^); y(^);
i

+

y 0 ^ + ! 1 ^j

! 1 ^j
y0

^

1
Uc

c(^); y(^);

3
5

y0 ^
= Uc c(^); y(^);
9
28
< Uy c(^); y(^);
Uy c(^); y(^); ^ =
4
: U c(^); y(^);
Uc c(^); y(^); ^ ;
c
0
13
! 1 ^j^
! 1 ^j
@
A5
+
0
^
^
^
^
^
^
y
Uc c( ); y( );
Uc c( ); y( );
^ for any utility func-

The term in curly brackets takes the sign of

( )^; then Uc c(^); y(^);

tion that satis…es assumption 1. If

)Uc c(^); y(^); ^ , which, together with the assumptions that y 0

(

0 and w1 is

increasing in the second argument, implies that the second term in the square
^: Since uc > 0 and y 0

brackets also takes the same sign as
establishes that V1 ^;

A.2

0; this

^:

has the sign of

Proof of Lemma 2

Consider a Hamiltonian to (9) and use (13) to substitute for w( )
H =

c( )

y ( ) + Vt+1

+ ( ) Ul (c( ); y( )= )
pu ( ) f ( j
=

c( )

y ( ) + Vt+1

p2 f2 ( j
p f( j

and let (c ; y ; w2 ;

(u( )
y( )
2

p2 u ( ) f2 ( j

)

+ ( ) Ul (c( ); y( )= )
1+

1

)
)

U (c( ); y( )= )) ; w2 ( );

U (c( ); y( )= )) ; w2 ( );

)
=

p2 =p : Using direct

substitution it is straightforward to verify that (c ; y ; w2 ;

ii

)

+ w2 ( )

; p ; p2 ) be a solution. Let

to a Hamiltonian for (15).

ft ( j

)

(u( )
y( )

pu ( ) f ( j

)

+ w2 ( )

1

2

ft ( j

; p2 ) is a solution

A.3

Analysis

Here we proved some additional results we referred to in Section 2 and in the
Appendix.
Lemma 3. Suppose that Assumptions 1, 5, and 6 hold.
(i) If either shocks
then

are independent over time; or Ucl = 0; or V1

0;

0;

(ii) If shocks to

are independent over time; or assumption 4 is satis…ed

and Ucl = 0; or assumption 4 and V1

0 and is increasing in ; then

0.

Proof. We prove part (i) …rst. Substitute (33) into (32) (with independent
shocks f2 = 0).
f2
f

1

f

0

V1 f =

:

Integrate using the boundary condition (0) = 0
!
#
Z "
f2 (^)
1
( )=
V1 (^) f (^)d^:
f (^)
0

(45)

Use the other boundary condition (1) = 0 to get
Z 1
V1 (^)f (^)d^;
=

(46)

0

where we used the fact that

R1
0

f2 (^)d^ = 0: V1

0 implies that

0:

Alternatively use the …rst order condition for c, (31), to substitute into
(32) and integrate
( )=

Z

0

1

f2 (^)
f (^)

!

1
Uc (^)

!

exp

Z

^

Uc ( 0 )
d
Uc ( 0 )

0

The boundary condition (1) = 0 implies that
h R
i
R1 1
1 Uc ( 0 )
0
exp
d
f (^)d^
0
^
~c (^)
Uc ( )
0 U
h R
i
= R1
:
1 Uc ( 0 )
f2 (^)
0
^
^
1
exp
d
f
(
)d
0
^
Uc ( )
0
f (^)
iii

f (^)d^: (47)

(48)

When shocks are independent, f2 = 0 and

> 0. When Ucl = 0, then

Uc = 0 and therefore this expression becomes
R1 1
Z 1
^ ^
~c (^) f ( )d
1
0 U
= R1
=
f (^)d^ > 0:
^
Uc (^)
0
1 f2 (^ ) f (^)d^
0

f( )

Next we turn to part (ii). First, suppose that shocks are independent.

By Assumption 5 w( ) is increasing and therefore by assumption 6 V1 ( ) is
increasing in : Choose
all

s.t.

=

V1 ( ): Therefore

and then (45) together with f2 = 0 implies that ( )
: Now consider

R1

V1 (^)

0 for

V1 ( )

0 for all

: Since (1) = 0; we can write ( ) as ( ) =

f (^)d^: The expression in the brackets is positive for all ^

; and therefore ( )

0 for

:

Next, suppose that shocks are persistent, assumption 4 is satis…ed and V1
is increasing in : Consider period 1 …rst. In period 1

t=1

= 0 by the de…nition

of the recursive problem, and equation (45) takes the form
Z
V1 (^) f (^)d^:
( )=
G0 (u( ))
0

Since Ft exhibits …rst order stochastic dominance, u( ) must be increasing
and hence G0 (u( )) decreases in : If V1 is increasing in

in

the same arguments as in i.i.d case to show that

the equation (35) that

t=2

0. Since

t=1

the …rst order condition for w2 , (34) implies that V2

we can apply
0;

0 which implies from

0: Since f satis…es assumption 4,

V1;t=2 ( ) is increasing in . Then we choose

t=1

such that

=

f2;t=2 ( )
ft=2 ( ) t=2
f2;t=2 ( )
ft=2 ( ) t=2

+
+

V1;t=2 ( ) and apply the arguments of the previous paragraph to show that
t=2

0. By iteration we then establish this argument for all t:

Finally, suppose that shocks are persistent, assumption 4 is satis…ed, and
Ucl = 0: In this case, by assumption 5, 1=Uc ( ) is increasing in : Since Uc = 0

iv

we can apply the same arguments as in the previous paragraph to equation
(47).
We state the following lemma to conclude this part of the discussion.
Lemma 4. Suppose assumptions 1, 5, 6 are satis…ed. Then
only if

y

0 if and

0:

Lemma 5. Suppose assumptions 1, 2, 5, and 6 are satis…ed. Suppose that
0: Then
Proof. Since

w

y

:

0 by Lemma 4,

and Assumption 1 that Ucl =Uc

A.4

y

0. Assumption 2 implies that " > 0

0; therefore

w

y

:

Calibration, estimation, and computation

This section follows the general outline of the quantitative analysis section but
…lls in the details to provides a more complete description of the estimation
and computation strategies we used.
Calibrated model. We model a life cycle of 40 years of working life,
i.e., the individuals between the ages of 25 and 65. The parameters of the
calibrated model are summarized in Table 1. Recall that we set the coe¢ cient
of absolute risk aversion,

, equal to 10. Numerical simulations are re-scaled

so that consumption ranges from 0:1 to 1 implying that relative risk aversion
ranges from 1 to 10 when

= 10. The elasticity parameter, , is set to 3

with the Frisch elasticity of labor supply then " = 1= (
annual discount factor is
is

1) = 0:5. The

= 0:9804 and the marginal rate of transformation

= 1:02 so that the social planner at the solution of the optimal program

chooses not to transfer resources between periods.
Empirical strategy. Our main data source is the PSID. We use the data
v

Table 1: Parameters Of The Calibrated Model

Parameter

(explanation)
(absolute risk aversion)

Value
10

Notes
consumption ranges from 0.1 to 1,
implying relative risk aversion
ranges from 1 to 10

(elasticity)

3

(discount factor)

0.9804

(marginal rate of

1.02

transformation)

Frisch elasticity of labor supply 0.5

1= , no transfer of resources
between periods

a1

(age at t = 1)

25

aT

(age at t = T )

65

model 40 years of work life

waves from 1990 onward to the latest currently available data wave, 2006.
Table 2 presents summary statistics for the PSID waves we use. Recent waves
(from 1996) come in two year intervals, hence we consider a total of nine waves
with two years in between. To be consistent with the data, we let one period
in the model correspond to two years, i.e., T = 20 since we model 40 year of
working life.10
Labor income, yi;year , is obtained directly from the PSID waves, converted
to constant 1990 dollars, and is summarized in Table 2. We consider total labor
income, which is a sum of a list of variables in the PSID that contain data
on salaries and wages, separate bonuses, the labor portion of business income,
overtime pay, tips, commissions, professional practice or trade payments, mar10

We check that our results are robust when the number of periods is doubled to T = 40.

When we take one period in the model to be 2 years, the discount factor is
marginal rate of tranformation between periods is

vi

2

.

2

and the

Table 2: Summary Statistics Of The PSID Waves

Age
Number

Labor Income
Standard

Standard

Year

of Individuals

Mean

Deviation

Mean

Deviation

Maximum

1990

4718

38.0

11.4

26,668

26,380

550,000

1992

4936

38.4

11.5

27,411

28,869

759,259

1994

5312

38.7

11.2

27,922

31,537

789,503

1996

5437

39.0

11.3

27,820

29,843

581,612

1998

5785

39.5

11.6

29,405

35,284

1,140,000

2000

6162

39.6

11.9

30,828

38,883

869,699

2002

6362

40.1

12.1

30,832

51,943

2,536,232

2004

6346

40.4

12.5

31,332

54,235

2,054,795

2006

6490

40.6

12.8

31,081

45,965

2,051,282

Notes: The year entries correspond to the year of the data origin of PSID waves. Individuals
are heads of households and their spouses or long-term cohabitants separately. Labor income
is total labor income of an individual, e.g.,.in 2006 it is the sum of PSID variables ER40921
(which is in turn a sum of several variables) and ER40900.

ket gardening, additional job income, and other miscellaneous labor income.
As Table 2 illustrates, mean real total labor income grows about 8.5% over
the sixteen years considered or at about 0.5% per year. The variance of labor
income increases by 0.3% over the same period.
0
E¤ective marginal tax rates, Tyear
(yi;year ), are estimated for each individual

with TAXSIM. TAXSIM is a FORTRAN program of the National Bureau of
Economic Research for estimating individual e¤ective liabilities under U.S.

vii

Table 3: Estimated Marginal Tax Rates and Implied Skills

Estimated E¤ective
Marginal Tax Rate

Implied Skill,
Standard

Standard

Year

Mean

Deviation

Mean

Deviation

1990

21.7

8.7

2.0

1.2

1992

20.4

9.4

2.1

1.3

1994

22.7

11.1

2.2

1.4

1996

21.5

10.9

2.3

1.4

1998

21.5

11.0

2.4

1.6

2000

22.3

10.7

2.6

1.8

2002

20.9

10.9

2.7

2.0

2004

19.1

10.8

2.8

2.1

2006

19.2

10.9

2.9

2.1

Notes: E¤ective marginal tax rates are estimated using TAXSIM.
Implied skills are computed from individual optimality conditions as described in the text.

viii

Federal and State income tax laws from individual data.11 For each individual
with labor income we also have in the PSID a collection of personal data that
are in most cases su¢ cient to estimate individual and year speci…c e¤ective
marginal tax rates. Speci…cally, we input into TAXSIM for each individual
their wage and salary income, wage and salary income of their spouse, dividend income, other property income (e.g., interest), taxable pensions and
social security bene…ts, other transfers (e.g., welfare), unemployment compensation, whether the individual is older than 65, state of residence, marital
status, number of dependents, and tax year. The estimated e¤ective marginal
tax rates for the individuals in the PSID waves are summarized in Table 3.
Notably, mean of the e¤ective marginal tax rate remains (except in 1992) close
to 22% until 2000 and then falls to 20.9 in 2002, 19.1 in 2004, and 19.2 in 2006.
Finally, we use the constructed total individual labor incomes and the
estimated e¤ective marginal tax rates to compute implied skills as described
above. Table 3 provides summaries for each of the PSID waves we consider.
Thus we obtain a data set of implied skills based on empirical U.S. micro
data with the details of our data set sample size provided in Table 4. When
using PSID waves, we treat heads of households and their spouses or longterm cohabitants as separate observations. We …rst restrict the sample to
include only individuals with the total labor income of at least $1; 000 in
1990 dollars and with at least 250 total hours worked in a year. Excluding
individuals that do not have enough data in the PSID to estimate e¤ective
marginal tax rates with TAXSIM results in a sample of 50,624 individuals total
from all waves. We also check our results for robustness with an alternative
sample where individuals older than 65 are excluded. Considering only those
with enough data for TAXSIM results in an alternative sample of just above
11

For more details and to use the program freely see http://www.nber.org/~taxsim/.

ix

Table 4: Sample Sizes

Sample Restriction

Sample Size

At least 250 hours worked, $1,000 income

51,548

- enough personal information for TAXSIM

50,624

Younger than 65

50,277

- enough personal information for TAXSIM

49,396

In at least two adjacent waves
(i.e. at least one skill "transition")

27,664

- younger than 45

20,410

- 45 or older

7,254

Initial young

8,387

- enough personal information for TAXSIM

8,231

x

Table 5: Labor Income, Tax Rates, And Skills Of The Initial Young

Standard
Statistic

Mean

Deviation

23,963

19,929

Estimated E¤ective Marginal Tax Rate

19.3

11.0

Implied Skill,

2.2

1.2

Labor Income

Notes: Labor income is total labor income of an individual
from the PSID. E¤ective marginal tax rates are estimated
using TAXSIM. Implied skills are computed from individual
optimality conditions as described in the text.

forty nine thousand. In contrast, to estimate conditional distributions used
in this section, we use the panel characteristic of the PSID – we consider all
individuals that appear in at least two adjacent waves, that is the individuals
for whom we observe at least one skill "transition".12 We have a total of 27,664
skill transitions. To estimate the initial unconditional distribution of skills we
consider a cross section of 25 year old from all waves to obtain a usable sample
of 8,231. Summary statistics for this last subsample are provided in Table 5.
Estimation approach. As mentioned in the body of the paper, we start
by estimating the initial unconditional distribution of implied skills among
the initial young workers, F1 ( ). We consider the 25 year old from all of
the PSID waves to obtain the sample of 8,231 observations described above
and summarized in Table 5. We estimate F1 ( ) non-parametrically using a
12

The PSID is not a balanced panel - an individual may appear in one wave, stay for

one or more waves, and then disappear. Our data points are all of the separate individual
wave-to-wave skill transitions.

xi

kernel density estimation. We use the normal kernel function and R+ as the
support. The resulting distribution is shown as "initial young, unconditional"
distribution depicted by a dotted line in Figure 1.
To estimate conditional distributions Ft ( j _), i.e., transition probabilities, we exploit the panel feature of the PSID. We start by considering all
individual skill transitions between adjacent data waves to obtain 27,664 transitions as shown in Table 4. Furthermore, we break all these skill transitions
into two age groups – when the individual is younger than 45 at the beginning of the transition and when the individual is 45 or older at the beginning
of the transition. This gives samples of 20,410 "young" skill transitions and
7,254 "old" skill transitions. We therefore estimate two separate conditional
distributions Fyoung ( j _) and Fold ( j _). Hence we assume age dependence
between the age groups and age-independent transitions within each age group.
In other words, we allow younger individuals to experience di¤erent transition
probabilities than older individuals; within each age group, we assume ageindependent transition probabilities.13 We estimate each conditional distribution non-parametrically using a kernel density estimation with the normal
kernel function and R+ as the support.
Computational strategy. To be able to numerically solve the problem of
this size and complexity (i.e., with multitude of periods and correlated shocks)
we exploit the recursive structure of the dual formulation of the planner’s
problem analyzed in Section 1. Hence we need to solve a …nite horizon discrete
time dynamic programming problem with a three-dimensional state vector
13

We stop at just two age groups to have su¢ cient number of data points to estimate

all conditional distributions. There is nothing in our computational solution method that
would stop us from having a di¤erent transition matrix for each period, provided that we
had enough data to obtain those transition matrices.

xii

which is continuous in each dimension. We proceed in three stages.
The …rst stage is a value function iteration. We start from period T and
proceed by backward induction. First, we solve period t = T problem for a
…xed set of values of the state vector and compute VT for each of then. Then
we can approximate VT and proceed to period t = T

1 where we use the

approximation as the basis for the interpolation of VT to any value of the state
vector to solve for VT

1.

We continue until we compute V1 . Speci…cally, with

the exponential preferences we can show that
Vt (w;
^ w^2 ;

w^2
) = at (
j
w^

1 + + ::: +

)

T t

ln ( w)
^

and in particular
VT (w;
^ w^2 ;

w^2
j
w^

) = aT

1

ln( w):
^

This means two things for our computations. First, if we discretize the type
space , we only need to consider w^ and

w
^2
w
^

as the state variables for each type.

That is, our state space is discretized in skill dimension and is continuous in the
other two dimensions. Second, we do not need to approximate Vt as a whole,
rather we only need to approximate at , which signi…cantly improves the quality
of the approximation of Vt . We approximate at ’s using a shape-preserving
least absolute deviation (LAD) method with Chebyshev polynomials. The
evaluation nodes are chosen as the roots of Chebyshev polynomials.14 The
policy functions are similarly approximated at this stage. With our preferences
14

For more on this, see e.g. Judd (1996) and Judd (1998).

xiii

it can be shown that
ct (w;
^ w^2 ;

) = act

yt (w;
^ w^2 ;

) = ayt

wt (w;
^ w^2 ;

) = aw
t

w2t (w;
^ w^2 ;

2
) = aw
t

w^2
j
w^
w^2
j
w^
w^2
j
w^
w^2
j
w^

1

ln( w)
^

w^
w:
^

w2
Once again, we approximate act ’s, ayt ’s, aw
t ’s, and at ’s using a shape-preserving

LAD method with Chebyshev polynomials and the evaluation nodes at Chebyshev roots.
To compute the full constrained optimal allocation, we need to …nd w0
such that V1 (w0 ) = 0. This is the second stage. Given V1 computed in the
…rst stage, we search for an interval containing zero using binary jumps. Then
we converge to w0 with bisection (binary search).15
The third stage is to compute optimal labor and savings distortions. Since
policy functions were approximated during the …rst stage, given Vt ’s and w0
from the …rst two stages, we can now generate the optimal allocations by
forward induction. We start with w0 computed in the second stage and roll
out the solution from period t = 1 all the way to period t = T . Optimal labor
and savings distortions are computed from their de…nitions in equations (17)
and (18) respectively.
Finally, we verify ex post that the …rst-order approach is valid. We verify
within small numerical error bounds the su¢ cient conditions discussed above
in the context of optimization problem (9) and with formal arguments in the
Appendix. In particular, in addition to preferences described by the utility
15

The rate of convergence for bisection is, admittedly, only linear, however, what is im-

portant here is guaranteed convergence.

xiv

function U that satis…es single crossing property, we numerically verify that
output satis…es y 0 ( )
! 12 ^j

0 and promised utility satis…es ! 1 ^j

0 and

0. These conditions are straightforward to verify numerically

within the value function iteration.16
For this three-stage computational procedure to be feasible it is essential to
have an e¢ cient and robust optimization algorithm to solve all of the separate
period t mechanism design problems of each stage at each node.17 We solve
each problem using an implementation of the interior-point optimization algorithm with conjugate gradient iteration to compute the optimization step.18
Conjugate gradient iteration o¤ers a way of dealing with possible Jacobian and
Hessian singularities. The interior-point approach is one of the most e¢ cient
and stable methods that are currently available for solving large nonlinear optimization problems. The interior-point algorithm uses a trust-region Newton
method to solve the barrier problem and an l1 penalty barrier function. We
…nd that the interior-point algorithm provides a good approximate estimate
of the solution and the optimal set of active constraints. To compute accur16

As an additional check, we also veri…ed su¢ ciency using the "brute force" approach:

once the solution is found, we check that there are no global deviations.
17
The main reason is that a mechanism design problem is a bi-level maximization problem (alternatively, a mathematical programming problem with equilibrium constraints).
The outer-level maximization of the planner has to take into account the best response of
the agents, which is the outcome of the inner-level maximization of each agent type with
respect to the type reported. In other words, incentive constraints are individual agent
type maximization problems with type report as a choice variable. We follow the usual
convention of computationally approaching these types of problems (e.g. Judd (1998)) by
writing the incentive constraints as inequalities (without relying on simplifying the incentive
compatibility constraints with the envelope theorem) as in problem (3).
18
The implementation we use is KNITRO. To streamline the application of KNITRO we
use a modelling language AMPL.

xv

ate estimates of the solution, including Lagrange multipliers, we proceed to
switch to an active-set iteration that uses the output of the interior-point algorithm as its input. The implementation of the active-set algorithm is based
on the sequential linear quadratic programming. Once the problem is correctly scaled, we observe quadratic convergence to a local maximum. Our
globalization strategy is to explore multiple feasible starting points.

xvi

