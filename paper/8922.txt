NBER WORKING PAPER SERIES

RISK REDUCTION IN LARGE PORTFOLIOS:
WHY IMPOSING THE WRONG CONSTRAINTS HELPS

Ravi Jagannathan
Tongshu Ma

Working Paper 8922
http://www.nber.org/papers/w8922

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2002

We thank Torben Andersen, Gopal Basak, Louis Chan, Gregory Connor, Kent Daniel, Bernard Dumas,
Ludger Hentschel, Philippe Henrotte, Ioulia Io .e, Andrew Lo, Jesper Lund, Robert McDonald, Steve Ross,
Jay Shanken and seminar participants at Copenhagen Business School, Emory University, HEC, Insead, MIT,
Norwegian School of Management, Hong Kong University of Science and Technology, University of Illinois
at Urbana-Champaign, University of Iowa, University of Rochester, and University of Utah for helpful
comments. We thank the editor, Richard Green, and two anonymous referees, for a number of suggestions
that have helped us sharpen the focus of the article. We are responsible for any errors or omissions. The
views expressed herein are those of the authors and not necessarily those of the National Bureau of Economic
Research.

Â© 2002 by Ravi Jagannathan and Tongshu Ma. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice, is given
to the source.

Risk Reduction in Large Portfolios: Why Imposing the Wrong Constraints Helps
Ravi Jagannathan and Tongshu Ma
NBER Working Paper No. 8922
May 2002
JEL No. C49, G11, G12

ABSTRACT
Mean-variance efficient portfolios constructed using sample moments often involve taking
extreme long and short positions. Hence practitioners often impose portfolio weight constraints when
constructing efficient portfolios. Green and Hollifield (1992) argue that the presence of a single dominant
factor in the covariance matrix of returns is why we observe extreme positive and negative weights. If
this were the case then imposing the weight constraint should hurt whereas the empirical evidence is often
to the contrary. We reconcile this apparent contradiction. We show that constraining portfolio weights
to be nonnegative is equivalent to using the sample covariance matrix after reducing its large elements
and then form the optimal portfolio without any restrictions on portfolio weights. This shrinkage helps
reduce the risk in estimated optimal portfolios even when they have negative weights in the population.
Surprisingly, we also find that once the nonnegativity constraint is imposed, minimum variance
portfolios constructed using the monthly sample covariance matrix perform as well as those constructed
using covariance matrices estimated using factor models, shrinkage estimators, and daily data. When
minimizing tracking error is the criterion, using daily data instead of monthly data helps. However, the
sample covariance matrix without any correction for microstructure effects performs the best.

Ravi Jagannathan
Department of Finance
Kellogg Graduate School of Management
Northwestern University
Evanston, IL 60208
and NBER
847-491-8338
rjaganna@nwu.edu

Tongshu Ma
Department of Finance
David Eccles School of Business
University of Utah
Salt Lake City, UT 84112
801-581-7506
fintsm@business.utah.edu

I

Introduction

Markowitzâ€™s (1952, 1959) portfolio theory is one of the most important theoretical developments in finance. Mean-variance efficient portfolios play an
important role in this theory. Such portfolios constructed using sample moments often involve taking large short positions in a number of assets and
large long positions in some other assets. Since negative portfolio weights
(short positions) are difficult to implement in practice, most investors impose
the constraint that portfolio weights should be nonnegative when constructing mean-variance efficient portfolios.
Green and Hollifield (1992) argue that it is difficult to dismiss the observed
extreme negative and positive weights as entirely due to imprecise estimation
of the inputs used to construct mean-variance efficient portfolios. According
to them the extreme weights in sample efficient portfolios are to a large extent
due to the existence of a single dominance factor in the covariance structure
of stock returns and the small amount of cross-sectional diversity in asset
betas. To understand the Green and Hollifield argument, note that minimum
variance portfolios can be constructed in two steps. First we naively diversify
over the set of high beta stocks and the set of low beta stocks separately.
The resulting two portfolios will have very low residual risk and different
betas. Next we short the high beta portfolio and long the low beta portfolio
to get rid of the systematic risk. Clearly, the second step involves taking
extreme long and short positions when there is little dispersion in the betas of
different assets. This is why minimum variance portfolios take large positive
and negative positions in the underlying assets.
If extreme negative weights in efficient portfolios arise due to the presence of a single dominant factor then it would appear that imposing the
nonnegativity constraints would lead to a loss in efficiency. However, empirical findings suggest that imposing these constraints improves the efficiency

1

of optimal portfolios constructed using sample moments1 . Does this mean
that the evidence does not support the Green and Hollifield (1992) view?
In this paper we provide an answer to this question. We show that imposing the nonnegativity constraint on portfolio weights can help even when
Green and Hollifield are right â€“ i.e., the true covariance matrix is such that
efficient portfolios involve taking large negative positions in a number of assets. We show that each of the no-shortsales constraints is equivalent to
reducing the sample covariances of the corresponding asset with other assets
by a certain amount. Stocks that have high covariances with other stocks
tend to receive negative portfolio weights. Hence, to the extent that high
estimated covariances are more likely to be caused by upward-biased estimation error, imposing the nonnegativity constraint can reduce the sampling
error. It follows from the theory of shrinkage estimators that imposing the
no-shortsales constraint can help even when the constraints do not hold in
the population.
We also study the impact of upper bounds on portfolio weights since
they are also commonly imposed by practitioners. We show that each upper bound constraint is equivalent to increasing the sample covariances of
the corresponding asset with other assets by a certain amount. Since stocks
that have low covariances with other stocks tend to get extreme high portfolio weights, and these extreme low estimated covariances are more likely
to be caused by downward-biased estimation error, this adjustment in estimated covariances could reduce sampling error and help the out-of-sample
performance of the optimal portfolios. Our empirical evidence suggests that
imposing upperbounds on portfolio weights does not lead to a significant
improvement in the out-of-sample performance of minimum risk portfolios
when no-shortsales restrictions are already in place. Therefore the role of
upperbounds is more to ensure that the minimum risk portfolios that come
out of the optimization exercise can be constructed in practice.
1

See Frost and Savarino (1988) for an excellent discussion.

2

The most common estimator of a covariance matrix is the corresponding sample covariance matrix of historical returns. It has long been recognized that mean-variance efficient portfolios constructed using the sample
covariance matrix perform poorly out-of-sample.2 The primary reason is that
the large covariance matrices encountered in practice require estimating too
many parameters. For example, the covariance matrix of the returns of 500
stocks has about 125,000 distinct parameters. However, monthly returns for
all traded stocks are only available for the past 900 months or so. This gives
less than 4 degrees of freedom per estimated parameter. Consequently the
elements of the covariance matrix are estimated imprecisely.
Several solutions to this problem have been suggested. The first is to
impose more structure on the covariance matrix to reduce the number of
parameters that have to be estimated. This includes factor models and constant correlation models. The second approach is to use shrinkage estimators, shrinking the sample covariance matrix toward some target, such as the
single-index model (Ledoit (1996, 1999)). The third approach is to use data
of higher frequency, for example, daily data in place of monthly data. These
three approaches are widely used both by practitioners and academics.
For any covariance matrix estimator, we can impose the usual portfolio
weight constraints. According to Green and Hollifield (1992), these constraints are likely to be wrong in population and hence they introduces specification error. According to our analysis, these constraints can reduce sampling error. Therefore the gain from imposing these constraints depends on
the trade off between the reduction in sampling error and the increase in
specification error. For covariance matrix estimators that have large sampling error, such as the sample covariance matrix, imposing these constraints
is likely to be helpful. However, for the factor models and shrinkage estimators, imposing such constraint is likely to hurt. This is what we find empiri2

See Jobson and Korkie (1980, 1981), Frost and Savarino (1986, 1988), Jorion (1986),
Michaud (1989), Best and Grauer (1991), and Black and Litterman (1992).

3

cally. Sampling errors are likely to be less important when the assets we use
in constructing minimum variance portfolios are themselves large portfolios.
In that case imposing nonnegativity constraints should hurt. Again this is
what we find.
In this paper, we will focus on the effect of portfolio weight constraints
on the global minimum variance portfolios. We do this because it has been
reported in the literature that the global minimum variance portfolio has
as large an out-of-sample Sharpe Ratio as other efficient portfolios.3 We
also examine the effect of portfolio weight constraints on the performance of
tangency portfolios and minimum tracking error portfolios. Our interest in
minimum tracking error portfolios arises from the observation that it may
be necessary in practice to construct portfolios using a subset of all available
stocks that have low transactions costs and high liquidity to track certain
benchmark indices that may contain assets that are not actively traded.
Our main empirical findings are the following:
1. For factor models and shrinkage estimators, imposing the usual portfolio weight constraint reduces the portfolioâ€™s efficiency slightly. On the
3

Using monthly stock index return data for G7 countries Jorion (1985) convincingly
argues that â€œ... benefits from diversification are more likely to accrue from a reduction
in risk.â€ In the data set he examined, the global minimum variance portfolio had the
best out of sample performance. It out performed classical tangent portfolio, the tangent
portfolio construced using the Bayes-Stein estimator for the vector of mean returns, and
the value weighted and equally weighted portfolios. Using simulation methods Jorion
(1986) showed that this conclusion is robust if the sample size is not large. Jorion
(1991) found that the minimum variance portfolio constructed using returns on seven
industry stock index portfolios performed as well as the CRSP equally weighted and value
weighted stock indices during the January 1926 to December 1987 period, in out of sample
tests. The performance was comparable to that of the tangent portfolio constructed
using the Bayes-Stein estimator for the mean. Bloomfield, Leftwich and Long (1977)
found that portfolios constructed using mean-variance optimization did not dominate an
equally weighted portfolio. On the other hand, Chan et al. (1999) documented that the
constrained global minimum variance portfolios outperform the equally weighted portfolio.

4

other hand, when the no-shortsales restriction is imposed, minimum
variance and minimum tracking error portfolios constructed using the
sample covariance matrix perform almost as well as those constructed
using factor models, shrinkage estimators, or daily returns.4
2. When shortsales are allowed, minimum variance portfolios and minimum tracking error portfolios constructed using daily return sample
covariance matrix perform the best. When covariance matrices are estimated using daily data, corrections for microstructure effects that have
been suggested in the literature do not lead to superior performance.
So far, this has not been recognized in the literature.
3. Tangency portfolios, whether constrained or not, do not perform as well
as the global minimum variance portfolios in terms of out-of-sample
Sharpe Ratio. This means that the estimates of the mean returns are
so noisy that simply imposing the portfolio weight constraint is not
enough, even though the constraints still have a shrinkage effect.
4. Monte Carlo simulations indicate that when nonnegativity constraints
are in place, global minimum variance portfolios constructed using the
sample covariance matrix can perform just as well as the covariance
matrix estimators constructed by imposing the factor structure even
when returns do have a dominant factor structure in the population.
5. In the simulations, imposing the nonnegativity constraint typically
worsens the performance when a single factor model is used to estimate the covariance matrix. On the other hand, in the data, imposing
nonnegativity constraints does not hurt much when using factor models. This suggests that stock returns probably do not have a stable
time invariant factor structure.
4

It is well recognized in the literature that imposing portfolio weight constraints leads
to superior out-of-sample performance of mean-variance efficient portfolios. However to
our knowledge no one has noticed that the performance improvement is so large that it is
comparable to that attained using the other alternatives.

5

The rest of the paper is organized as follows. In Section II, we provide a
theoretical analysis of the shrinkage-like effect of imposing the no-shortsales
restriction and upper bounds on portfolio weights when constructing global
minimum risk portfolios. In Section III, we use simulation to evaluate the
tradeoff between specification error and sampling error. This tradeoff clearly
depends on the true covariance structure of the assets, which is not observed.
We therefore calibrate the covariance structure in the simulation to that of
the U.S. stocks. Using the simulation we provide some guidance as to when
the nonnegativity constraint will start to hurt. In Section IV, we empirically
examine the effects of portfolio weight constraints using the out of sample
performances of the constrained and unconstrained optimal portfolios. In
Section V, we discuss the role of portfolio weight constraints in constructing
tangency portfolios. We conclude the paper in Section VI. Proofs and details
about the construction of various covariance matrix estimates using daily
returns are collected in the Appendices.

II
A

The Effect of Portfolio Weight Constraints
Some Theoretical Results

Given an estimated covariance matrix S, the global portfolio variance minimization problem when portfolio weights are constrained to satisfy both a
lower bound of zero and an an upper bound of Ï‰Ì„ is given by:
minÏ‰ Ï‰ 0 SÏ‰
s.t.

X

(1)

Ï‰i = 1

(2)

i

Ï‰i â‰¥ 0, i = 1, 2, Â· Â· Â· , N.

(3)

Ï‰i â‰¤ Ï‰Ì„, i = 1, 2, Â· Â· Â· , N.

(4)

6

The Kuhn-Tucker conditions (necessary and sufficient) are
X
j

Si,j Ï‰j âˆ’ Î»i + Î´i = Î»0 â‰¥ 0, i = 1, 2, Â· Â· Â· , N.

(5)

Î»i â‰¥ 0,

and Î»i = 0 if Ï‰i > 0, i = 1, 2, Â· Â· Â· , N.

(6)

Î´i â‰¥ 0,

and Î´i = 0 if Ï‰i < Ï‰Ì„, i = 1, 2, Â· Â· Â· , N.

(7)

Here Î» = (Î»1 , Â· Â· Â· , Î»N )0 are the Lagrange multipliers for the nonnegativity
constraints (3), Î´ = (Î´1 , Â· Â· Â· , Î´N )0 the multipliers for the constraints (4), and
Î»0 the multiplier for (2).
Denote a solution to the constrained portfolio variance minimization problem (1)-(4) as Ï‰ ++ (S). Let 1 denote the column vector of ones. Then we have
the following proposition.
Proposition 1 Let
SÌƒ = S + (Î´10 + 1Î´ 0 ) âˆ’ (Î»10 + 1Î»0 ).

(8)

Then SÌƒ is symmetric and positive semi-definite, and Ï‰ ++ (S) is one of its
global minimum variance portfolios.
All proofs are given in Appendix B.
This result shows that constructing a constrained global minimum variance portfolio from S is equivalent to constructing a (unconstrained) minimum variance portfolio from SÌƒ = S + (Î´10 + 1Î´ 0 ) âˆ’ (Î»10 + 1Î»0 ). Later we
will interpret SÌƒ as a shrunk version of S, and argue that this shrinkage can
reduce sampling error.
In general, given a constrained optimal portfolio Ï‰ ++ (S), there are many
covariance matrix estimates that have Ï‰ ++ (S) as their (unconstrained) minimum variance portfolio. Is there anything special about SÌƒ? We do have an
answer to this question when returns are jointly normal and S is the MLE
of the population covariance matrix.
7

Let the N Ã—1 return vector ht = (r1t, , r2t , Â· Â· Â· , rN t )0 be iid normal N (Âµ, â„¦).
P
Then the MLE of â„¦ is S = Tt=1 (ht âˆ’ hÌ„)(ht âˆ’ hÌ„)0 /T. It is well known that for
any estimate of the covariance matrix, the MLE of the mean is always the
sample mean. (Morrison (1990), p.98.) With this estimate of the mean, the
log-likelihood (as a function of the covariance matrix alone) becomes
l(â„¦) = CONST âˆ’

T
T
ln |â„¦| âˆ’ tr(Sâ„¦âˆ’1 ).
2
2

(9)

This can also be considered as the likelihood function of â„¦âˆ’1 , and is defined
for nonsingular â„¦.
Now consider the constrained MLE of â„¦, subject to the constraint that
the global minimum variance portfolio constructed from â„¦ satisfy the weight
constraints (3)-(4). Let â„¦i,j denote the (i, j)-th element of â„¦ and â„¦i,j denote
the (i, j)-th element of â„¦âˆ’1 , then the constraints are
X

(10)

j

â„¦i,j â‰¥ 0, i = 1, 2, Â· Â· Â· , N.
XX

(11)

j

â„¦i,j â‰¤ Ï‰Ì„

X

k

â„¦k,j .

j

So the constrained maximum likelihood (ML) problem is maximizing (9)
subject to constraints (10)-(11). We have the following proposition.
Proposition 2 Assume that returns are jointly iid normal N (Âµ, â„¦). Let S
be the unconstrained MLE of â„¦.
1. Given S, let {Î»i , Î´i , Ï‰i }N
i=1 be a solution to the constrained portfolio
variance minimization problem (1) - (4), and construct SÌƒ according to
(8). Assume SÌƒ is nonsingular. Then SÌƒ and {Î»i , (1 âˆ’ Ï‰Ì„) Î´i }N
i=1 jointly
satisfy the first order conditions for the constrained ML problem.
2. Let SÌƒ and {Î»i , Î´i }N
i=1 jointly satisfy the first order conditions for the conP
P P
strained ML problem. For i = 1, Â· Â· Â· , N, define Ï‰i = j SÌƒ i,j / k l SÌƒ k,l ,
8

the normalized row sums of SÌƒ âˆ’1 . Then {Î»i , Î´i /(1 âˆ’ Ï‰Ì„), Ï‰i }N
i=1 is a solution to the constrained portfolio variance minimization problem (1) (4), given S.
Roughly speaking, this proposition says that the SÌƒ constructed from the
solution to the constrained global variance minimization problem is the ML
estimator of the covariance matrix subject to the condition that the global
minimum variance portfolio weights satisfy the nonnegativity and upper
bound constraints. So we could impose the constraints in the estimation
stage instead of the optimization stage and the result would be the same.
When only the nonnegativity constraint is imposed, the vector of Lagrange multipliers for the upper bound will be zero. So SÌƒ = S âˆ’ (Î»10 + 1Î»0 ),
and we can simplify the statements in Proposition 2 in a straightforward way.

B

A Shrinkage Interpretation of the Effects of Portfolio Weight Constraints

Letâ€™s first examine the effect of the nonnegativity constraint. Consider the
unconstrained global portfolio variance minimization. The first order condition is
N
X

j=1

Ï‰j Si,j = Î»0 â‰¥ 0, i = 1, 2, Â· Â· Â· , N.

(12)

The above condition says that at the optimum, stock iâ€™s marginal contribution to the portfolio variance is the same as stock jâ€™s, for any i and j.
Suppose stock i tends to have higher covariances with other stocks, i.e.,
the ith row of S tends to have larger elements than other rows. Then stock
P
iâ€™s marginal contribution to the portfolio variance, 2 N
j=1 Ï‰j Si,j , will tend to
be bigger than other stocksâ€™ marginal contributions. Therefore, to achieve
optimality, we need to reduce stock iâ€™s portfolio weight. Stock i may even
have negative weight if its covariances with other stocks are sufficiently high.
9

Therefore, a stock tends to receive a negative portfolio weight in the global
minimum variance portfolio if it has higher variance and higher covariances
with other stocks. In a one-factor structure, these are the high-beta stocks.
With only the nonnegativity constraint, Proposition 1 implies that constructing the constrained global minimum variance portfolio from S is equivalent to constructing the (unconstrained) global minimum variance portfolio
from SÌƒ = S âˆ’ (1Î»0 + Î»10 ). Notice that the effect of imposing the constraint is
that, whenever the nonnegativity constraint is binding for stock i, its covariances with other stocks, Sij , j 6= i, are reduced by Î»i +Î»j , a positive quantity,
and its variance is reduced by 2Î»i . We saw before that a stock will receive
a negative portfolio weight in the minimum variance portfolio if its covariances are relatively too high. Therefore, the new covariance matrix estimate,
SÌƒ, is constructed by shrinking the large covariances toward the average covariances. Since the largest covariance estimates are more likely caused by
upward-biased estimation error, this shrinking may reduce the estimation
error.
We can interpret the effect of the upper bounds on portfolio weights
similarly. In the unconstrained portfolio variance minimization, those stocks
with low covariances with other stocks tend to receive high portfolio weights.
So when the upper bound is imposed, it tends to be binding for these stocks.
Proposition 1 says that constructing the upper-bound constrained minimum
variance portfolio using S is the same as constructing the unconstrained
minimum variance portfolio from SÌƒ = S+(1Î´ 0 +Î´10 ). So the effect of imposing
the constraint is that, whenever the upper bound is binding for stock i, its
variance is raised by 2Î´i and its covariances with another stock j is increased
by (Î´i + Î´j ). Since the upper bound tends to be binding for those stocks with
low covariances with other stocks, and low estimated covariances are more
likely to be plagued by downward-biased estimation error, this adjustment
may reduce sampling error and achieve better estimates of the covariance
matrix in certain sense. This adjustment has a shrinkage-like effect.

10

We now illustrate this shrinkage-like effect of portfolio weight constraints
through an example. The covariance matrix estimate S is the sample covariance matrix of a random sample of 30 stocks among all domestic common
stocks that have all monthly returns from 1988 to 1997 (120 months). We
consider the effect of imposing nonnegativity and an upper bound of 10%
in the global portfolio variance minimization problem. Panel A of Table 1
reports summary statistics for the row sums of S, the portfolio weights of the
unconstraind global minimum variance portfolio, and the Lagrangian multipliers for the nonnegativity constraint and the upper bound. We can see that
both the row sums and the weights of the unconstrained optimal portfolio
vary over a wide range: the lowest row sum is 0.0106, the highest is 0.0695;
the lowest portfolio weight is -0.125, and the highest is 0.357.
Panel B of Table 1 reports the correlations among the row sums of S,
the weights of the unconstrained portfolio, the Lagrange multipliers of the
nonnegativity constraint, and the multipliers of the upper bound. We see that
the correlation between the row sums and the unconstrained portfolio weights
is -0.496; between the row sums and the multiplier of the nonnegativity
constraint is 0.713, and between the row sums and the multiplier of the upper
bound is -0.425. All of these correlations are significant at 2% level. Recall
that the effect of the nonnegativity constraint is to revise S into S âˆ’ (Î»10 +
1Î»0 ), and the additional upper bound is to further revise S into S âˆ’ (Î»10 +
1Î»0 ) + (Î´10 + 1Î´ 0 ), these correlations match well with our intuition discussed
before. Specifically, those rows of S that have low (or high) row sums tend to
receive high (or low) weights in the unconstrained global minimum variance
portfolio; the effect of the nonnegativity constraint tends to lower those rows
with high row sums; and the effect of the upper bound tends to raise those
rows with low row sums.
Table 1, Panel C and D report the effect of the weight constraints on
the distinct individual covariances (i.e., {Si,j , j â‰¥ i}). Panel C gives the
summary statistics of the distinct elements of S, the effect the nonnegativity

11

constraint (Î»i + Î»j ) for j â‰¥ i; and the effect of the upper bound constraint
(Î´i + Î´j ) for j â‰¥ i; Panel D reports the correlations among them.
Panel C shows that the individual covariances vary over a wide range:
the lowest is -0.00186 and the highest is 0.0190, while the mean covariance
is 0.00139. Panel D shows that the correlation between {Si,j , j â‰¥ i} and
{(Î»i + Î»j ), j â‰¥ i, } is 0.296; and the correlation between {Si,j , j â‰¥ i} and
{(Î´i + Î´j ), j â‰¥ i} is -0.184, and both are significant at 1% level. Again
these correlations match our shrinkage-like interpretation of the effect of the
portfolio weight constraint: the nonnegativity constraint tends to reduce the
high covariances; and the upper bound tends to raise the low covariances.
Panel E shows the regression of {Si,j , j â‰¥ i} on the adjustment due to the
portfolio weight constraints, {Î»i + Î»j , j â‰¥ i} and {Î´i + Î´j , j â‰¥ i}, respectively.
We see that the coeffcient estimates have the expected sign and are significant. Of course this is no surprise given the significant correlations reported
in Panel D.

III

A Simulation Study of the Tradeoff Between Specification Error and Sampling
Error

In the last section, we argued that imposing the nonnegativity constraint
in global portfolio variance minimization has a shrinkage-like effect. This
shrinkage-like effect can reduce sampling error. On the other hand, the constraint is wrong in population when asset returns have a single dominant
factor, as argued by Green and Hollifield (1992), because in that case the population global minimum variance portfolio takes extreme negative weights.
Whether the nonnegativity constraint can help depends on the trade-off between these two effects: the reduction in sampling error on the one hand

12

and the increase in the specification error on the other hand. That trade-off
would depend on, among other things, the true covariance structure. Since
we do not know the true covariance structure, we can not give a simple quantitative answer that holds true for all underlying covariance structures in the
population. We therefore rely on using Monte Carlo simulation analysis in
this section to further examine the trade-off between the two effects. By comparing the simulation results with the results using the real data, which are
reported in the next section, we are also able to provide additional insights
regarding the true covariance structure of the U.S. stock returns.
We assume a two-factor return structure in the simulation.5 We consider
a two-factor structure because the literature often finds more than one factor
in the return structure of the U.S. stocks. Without loss of generality, we
set the factor variances to unity and the covariance between them to zero.
We draw the betas for the first factor for each stock from an i.i.d Normal
distribution with mean 1 and standard deviation ÏƒÎ² , which varies from 0 to
0.4 across different sets of simulations. The stocksâ€™ betas with respect to the
second factor are drawn from an i.i.d. Normal distribution with mean zero
and standard deviation 0.2. The residual variances are set to be constant over
time, but cross-sectionally, they are drawn from an i.i.d. Lognormal(0.8, 0.7)
distribution. When ÏƒÎ² = 0.4, the distribution of the betas with respect to
the two factors roughly matches the empirical distribution of the first two
betas for the NYSE stocks with the two factors being the first two of the five
Connor-Korajczyk factors. Furthermore, the average fraction of variances
that are residual variances also roughly matches the same fraction in the
NYSE stocks.
We allow the number of stocks, N , to range from 30 to 300. For each
specification of N and ÏƒÎ² , we draw the betas and the residual variances
for the stocks according to the afore mentioned distributional assumptions.
5

We also performed a simulation with a one-factor structure. The results are qualitatively similar. These results are available upon request.

13

These betas and residual variances are fixed for this specification even as we
change the sample size T.
Given the sampled betas and residual variances, we then draw returns of
different sample sizes. We first set T = 60 and then vary it from N + 30 to
N + 210 by increment of 60. We allow T = 60 because that is the sample
size used in the simulation with real data in the next section, and having the
same sample size allows us to compare the results.
Given the simulated returns data, we estimate the return covariance matrix, and form the nonnegativity constrained and unconstrained global minimum variance portfolios. We then calculate the ex post variances of these
portfolios using the assumed true covariance matrix. This procedure is repeated ten times and the averages of ex post variances are reported.
We consider two covariance matrix estimators. The first is the sample
covariance matrix. The second is the one-factor model. When the covariance
matrix is estimated with the one-factor model, we assume the factor return
is known, and is the return of the first factor used in the simulation.
Table 2 presents a subset of our simulation results.6 It examines the effects on imposing the nonnegativity constraint and/or the single-factor constraint. The table reports the percentage reductions in the ex post standard
deviations of the global minimum variance portfolios constructed by imposing these constraints relative to that of the unconstrained global minimum
variance portfolios constructed from the sample covariance matrix, and relative to the equal-weighted portfolio. The three panels, ÏƒÎ² = 0, ÏƒÎ² = 0.2, and
ÏƒÎ² = 0.4, represents the cases where the nonnegativity constraint is correct,
is severely wrong, and is moderately wrong, respectively. We report the cases
where the number of stocks is either 30 or 300, and the sample size is either
60 or 360.
6

To save space, we do not report the full result of the simulations, which is available
upon request.

14

Panel A shows that when the nonnegativity constraint is correct, imposing the nonnegativity constraint always helps. The gain from imposing
the nonnegativity constraint is comparable to that obtained by imposing the
one-factor structure. In fact, this is true for all the cases in our simulation,
not only those cases reported in the table.
Across all three panels, the numbers in the last two columns are comparable. This means that if for some reason the nonnegativity constraint has
to be imposed, then whether we use the sample covariance matrix or the
one-factor model to estimate the covariance matrix makes little difference.
Again this is true not only for the cases in Table 2 but for all the cases in
our simulation.
When ÏƒÎ² > 0, so that the true global minimum variance portfolio has
negative weights, the nonnegativity constraint always hurts if we use the
one-factor model to estimate the covariance matrix, and the deteriation in
performance is dramatic if the number of stocks is large. However, imposing
the nonnegativity constraint helps when the sample covariance matrix is
used and there are too many stocks relative to the length of the time series
of observations used to estimate the covariance matrix. Again this is true in
general and not only for the cases reported in the table.
Comparing the numbers on the last two columns in all three panels, we see
that, paradoxically, the nonnegativity-constrained portfolios do worse than
the equal-weighted index when the nonnegativity constraint is correct, and
do better than the equal-weighted index when the nonnegativity constraint
is wrong. This is because when there is dispersion in the betas (so the
nonnegativity constraint is wrong in population), even if shortsales are not
allowed, we can still reduce the exposure to systematic risk by investing
only in the low-beta stocks. Thus we can achieve lower risk than the equalweighted index. On the other hand, when there is no dispersion in the
betas (i.e., the nonnegativity constraint is correct in population), we can not
reduce systematic risk at all, hence there is not much potential gain from
15

optimal diversification. And the fact that we are using the estimated, not
the true, covariance matrix can actually make things worse than a naive
divsersification. In fact, throughout the simulation, we find that when ÏƒÎ² >
0, â€“ i.e., when there is potential gain from optimal diversification, constrained
optimal portfolios always do better than the equal-weighted index.
Based on the results from the full set of simulation, we also find a meaningful tradeoff between specification error and sampling error when ÏƒÎ² > 0
and the covariance matrix estimate is the sample covariance matrix. First,
when ÏƒÎ² = 0.1, the nonnegativity constraint always helps. On the other
hand, as ÏƒÎ² goes from 0.2 to 0.4, we always find cutoff points for the sample size T, where when we have less observations than the cutoff points, the
nonnegativity constraint helps, and when we have more observations than
the cutoff points, the nonnegativity constraint hurts. These cutoff points
increases as we increase the number of asset (as expected), but are not sensitive to changes in ÏƒÎ² . These cutoff points are presented in Table 3. Recall
that ÏƒÎ² = 0.4 roughly corresponds to the covariance structure of the NYSE
stocks, and ÏƒÎ² = 0.2 or 0.3 represent cases where the nonnegativity constraint
is more severely violated than when ÏƒÎ² = 0.4. Since these cutoff points are
not sensitive to changes in ÏƒÎ² in this range, we can treat them as a rough
guidline for practitioners who use U.S. stocks.
Table 4 gives the short interest in the unconstrained global miminum variance portfolios constructed from the true covariance matrix. This table gives
us another metric about the extent to which the nonnegativity constraint is
violated.

16

IV

The Effect of Portfolio Weight Constraints:
An Empirical Examination

A

Data and Methodology

In this section we examine empirically the effect of portfolio weight constraints. As we have said before, whether these weight constraints help or
hurt is an empirical issue and will depend on the specific covariance matrix estimator. For the estimators that have large sampling errors such as
the sample covariance matrix, the portfolio weight constraints are likely to
be helpful, as documented by Frost and Savarino (1988) and demonstrated
again in the simulation study in the last section. However, for the factor
models and shrinkage estimators, the portfolio weight constraints are likely
to be harmful.
We examine the effect of the portfolio weight constraints on the outof-sample performance of minimum variance and minimum tracking error
portfolios formed using a number of covariance matrix estimators. This is
done following the methodology in Chan, Karcesky, and Lakonishok (1999).
At the end of each April from 1968 to 1998, we randomly choose 500 stocks
from all common domestic stocks traded on the NYSE and the AMXE, with
stock price greater than $5, market capitalization more than the 80th percentile of the size distribution of NYSE firms, and with monthly return data
for all the immediately preceding 60 months. We use return data for the
preceding 60 months to estimate the covariance matrix of the returns of the
500 stocks. For estimators that use daily data, the daily returns during the
previous 60 months of the same 500 stocks are used. When a daily return is
missing, the equally-weighted market return of that day is used instead.
When variance minimization is the objective, we form three global minimum variance portfolios using each covariance matrix estimator â€“ only two if
17

the covariance matrix estimate is singular. The first portfolio is constructed
without imposing any restrictions on portfolio weights, the second is subject
to the constraint that portfolio weights should be nonnegative, and the third,
in addition, faces the restriction that no more than 2 percent of the investment can be in any one stock. Each of these portfolios are held for one year,
their monthly returns are recorded, and at the end of April of the next year,
the same process is repeated. This gives at most three minimum variance
portfolios that have post-formation monthly returns from May 1968 to April
1999 for each covariance matrix estimator. We use the standard deviation of
the monthly returns on these portfolios to compare the different covariance
matrix estimators.
For tracking error minimization, following Chan et al (1999) we assume
the investor is trying to track the return of the S&P 500 index. As in the
case of portfolio variance minimization, we construct three tracking error
minimizing portfolios for each covariance estimator. Notice that constructing
the minimum tracking error variance portfolio is the same as constructing the
minimum variance portfolio using returns in excess of the benchmark subject
to the restriction that the portfolio weights sum to one.

B

Covariance Matrix Estimators

The first estimator is the sample covariance matrix:
T
1 X
SN =
(ht âˆ’ hÌ„)(ht âˆ’ hÌ„)0 ,
T âˆ’ 1 t=1

where T is the sample size, ht is a N Ã— 1 vector of stock returns in period t,
and hÌ„ is the average of these return vectors.
The second estimator assumes that returns are generated according to
Sharpeâ€™s (1963) one-factor model given by:
rit = Î±i + Î²i rmt + it ,
18

where rmt is the period t return on the value-weighted portfolio of stocks
traded on the NYSE, AMEX and NASDAQ. Then the covariance estimator
is,
S1 = s2m BB 0 + D.
(13)
Here B is the N Ã— 1 vector of Î²â€™s, s2m is the sample variance of rmt , and D has
the sample variances of the residuals along the diagonal and zeros elsewhere.
The third estimator is the optimal shrinkage estimator of Ledoit (1999).
It is a weighted average of the sample covariance matrix and the one-factor
model-based estimator:
SL =

Î±
Î±
S1 + (1 âˆ’ )SN ,
T
T

where Î± is a parameter that determines the shrinkage intensity that is estimated from the data. Ledoit (1999) shows this estimator outperforms the
constant correlation model (Elton and Gruber (1973), Schwert and Seguin
(1990)), the single-factor model, the industry factor model, and the principal
component model with five principal components.7 For the fourth set of
estimators we consider the Fama and French (1993) three-factor model, and
the Connor and Korajczyk (1986, 1988) five-factor model and a three-factor
version of it which includes only the first three of the five factors. This gives
three additional covariance matrix estimators each corresponding to one of
these multifactor models8 .
Finally we consider several covariance matrix estimators that use daily
return data. These include the daily return sample covariance matrix, daily
one-factor model, daily Fama-French three-factor model, and daily ConnorKorajczyk five-factor and three-factor models. These models are similar to
the corresponding monthly models. However, we incorporate the corrections
7

For tracking error variance minimization, we also considered Ledoitâ€™s (1996) estimator
that shrinks the sample covariance matrix toward the identity matrix. The results are
similar and we do not report them.
8
For tracking error variance minimization, the loadings on the first factor in these
multifactor models are set to zero for every stock.

19

for microstructure effects suggested by Scholes and Williams (1977), Dimson
(1979) and Cohen et al. (1983). We also develop a new estimator for the
covariance matrix of returns using daily return data that nests these three
estimators. Details on the estimation of the monthly return covariance matrix using daily return data that allow for microstructure effects are provided
in Appendix A.

C

Empirical Results

Table 5 gives the characteristics of minimum variance portfolios constructed
using various covariance matrix estimates.9 Judging by the ex post standard
deviations of the optimal portfolios, the shrinkage estimator proposed by
Ledoit (1999) and the sample covariance matrix of daily return are the best
performers. Since the Ledoit estimator is a particular weighted average of the
one-factor model and the sample covariance matrix, we examined whether a
simple average of the two estimators would do equally well. The random
average of the one-factor model and the sample covariance matrix has an
annualized out-of-sample standard deviation of 10.34 percentage points (not
reported in Table 5) which is not much different from the 10.76 percentage
points for the Ledoit estimator. We thus suspect that the sampling errors
associated with the estimated optimal shrinkage intensity in the Ledoit estimator is rather large. Notice that even for these two best estimators, the
unconstrained global minimum variance portfolios involing taking short positions that are over 80% of the portfolio value.
Next, we turn to the case when the no-shortsales restriction is imposed.
9

To save space, we only report a subset of the simulation results in Tables 5-7. The
results of using Connor-Korajczyk 3- and 5-factor models are very similar to those using
the Fama-French 3-factor model. This is true when daily returns are used as well. So these
results are not reported. Several versions of the daily one-factor model are dominated by
the daily return sample covariance matrix. So these results are not reported either.

20

There is a unique solution to the portfolio variance minimization problem
using the sample covariance matrix although it is singular. Surprisingly
the minimum variance portfolio constructed using the monthly sample covariance matrix compares favorably with all the other covariance matrix estimators. The out-of-sample annualized standard deviation is about 12
percentage points per year for all of the estimators, including the shrinkage
estimator of Ledoit and the daily sample covariance matrix. Imposing the
no-shortsales restriction leads to a small increase â€“ between 8 and 14 percent
â€“ in the standard deviation of the minimum variance portfolios constructed
using factor models. This decline in the performance is consistent with the
observation by Green and Hollifield (1992) that shortsales restrictions probably do not hold in the population. The number of assets in the portfolio
varies from a low of 24 for the sample covariance matrix estimator to a high
of 65 for the daily sample covariance matrix. In comparison, the equally
weighted portfolio of the 500 stocks has an annualized standard deviation of
17 percentage points, the value weighted portfolio of the 500 stocks has a
standard deviation of 16 percentage points. A portfolio of randomly picked
25 stocks has a standard deviation of 18 percentage points which is 40 percent more than that of the optimal minimum variance portfolio constructed
using the sample covariance matrix subject to the no-shortsales restrictions.
This clearly indicates that portfolio optimization can achieve a lower risk
than naive diversification. Imposing an upper bound of two percentage
points on portfolio weights in addition to a lower bound of zero does not affect
the out-of-sample variance of the resulting minimum variance portfolios in
any significant way.
When daily returns are used, the sample covariance matrix estimator
performs the best when there are no portfolio weight constraints. The
corrections for microstructure effects suggested in the literature do not lead
to superior performance. When portfolio weights are constrained to be
nonnegative all the models perform about equally well.

21

Table 6 gives the corresponding numbers for the minimum tracking error portfolios. Several patterns emerge. Among the estimators that use
monthly data, the monthly covariance matrix estimator and the one proposed by Ledoit (1996) perform the best. The former has only about 200
stocks whereas the latter has about 300 stocks.
The tracking error of the one factor model with non-negativity constraints
is 5.04% which is rather large compared to the 3.36% for the sample covariance matrix estimator. This should not be surprising since the first dominant
factor becomes less important for tracking error minimization. The portfolio
weight constraints are not binding with the one factor model. This is strong
support for the Green and Hollifield conjecture that large negative (and positive) weights are due to the presence of a single dominant factor which is
effectively removed when we consider tracking error minimization.
The multifactor models of Connor and Korajczyk (not reported) as well
as Fama and French perform better than the single factor model. This is
consistent with the observations in Chan et al (1999). As is to be expected,
portfolio weight constraints are not important when using multifactor models. However, the tracking error for the factor models is about one percentage
point more than that for the sample covariance matrix and the Ledoit estimators.
With daily data we expect the precision of all the estimators to improve.
If our conjecture that portfolio weight constriants lead to better performance
due to the shrinkage effect then such constraints should become less important when daily data is used. This is what we find. When shortsales are
allowed, the short interest is 36.6%, a substantial amount. Imposing the
nonnegativitiy constraint on portfolio weights reduces the number of stocks
to 231. However, the performance is hardly affected. The tracking error goes
down from 2.94% to 2.78%.
With daily data, the sample covariance matrix estimator dominates all

22

factor models, with the latter all perform equally well. Again corrections
for microstructure effects make little difference in the ex post tracking error
performance.
The value-weighted portfolio of the 500 stocks performs the best. This is
to be expected since the benchmark is the S&P500 portfolio, which is value
weighted.
Table 7 reports the t-tests for the difference between the mean returns
and mean squared returns of the portfolios compared with the nonnegativityconstrained portfolio from the monthly return sample covariance matrix.
Since the differences in mean returns are all insignificant, the t-test for the
difference in squared returns serve as a test for the difference in return variances, which is the focus of our study. We can see that for both portfolio
variance minimization and tracking error minimization, once the nonnegativity constraint is imposed, the more sophisticated estimators do not in general
give better out-of-sample performance than the monthly return sample covariance matrix. However, there is evidence that using daily returns can
achieve smaller out-of-sample tracking error. Why using daily returns can
help for the tracking error minimization case but not the total risk minimization case is an issue of future investigation.

V

The Role of Constraints in Constructing
Mean-Variance Efficient Portfolios

In the previous sections, we mainly focused on the role of constraints on
the global minimum variance portfolios. In this section, we will examine
the same issue in the context of mean-variance efficient portfolios. For that
purpose we will assume that there is a riskless asset. Then the mean variance
efficient frontier is spanned by two assets: the riskless asset and the portfolio
23

where the tangent from the risk free rate touches the mean variance frontier
of asset returns. The global minimum variance portfolio will not be on the
mean variance efficient frontier.
We will see that in this case, when the estimated covariance matrix is nonsingular, we can still give a shrinkage interpretation of the portfolio weight
constraints, where the shrinkage is applied to the mean returns, not the
covariance matrix. But we also point out that the sampling error in the estimated mean returns is too large for this shrinkage to be useful. Specifically,
the constrained mean variance efficient portfolios perform worse out of sample than the global minimum variance portfolios, as have been reported by
earlier studies. We will first present the theoretical analysis. Then we report
some simulation results.

A

An Analysis of the Role of Portfolio Constraints on
Mean-Variance Efficient Portfolios

We use w to denote the N vector of portfolio weights on the risky assets; S
the covariance matrix of the excess returns (over the risk free rate); and Âµ
the vector of excess returns.
Suppose we want to find the minimum variance portfolio with expected
excess return k. Letâ€™s first consider the case where there is no constraints on
individual portfolio weights. The Lagrangian is
1
L = w0 Sw âˆ’ Î¸(w0 Âµ âˆ’ k),
2
where Î¸ is the scalar Lagrange multiplier. The first order conditions are given
by
Sw âˆ’ Î¸Âµ = 0,

w0 Âµ = k.

24

(14)

From this we can find the optimal portfolio weights. These are standard
results.
Now letâ€™s consider the constrained efficient portfolio problem, where the
portfolio weights are subject to known lower and upper bounds:10
0 â‰¤ wi â‰¤ wÌ„i .
The Lagrangian is
1
L = w0 Sw âˆ’ Î¸(w0 Âµ âˆ’ k) âˆ’ Î»0 w + Î´ 0 (w âˆ’ wÌ„),
2
where Î» and Î´ are vectors of nonnegative Lagrange multipliers.
The first order conditions are
Sw âˆ’ Î¸Âµ âˆ’ Î» + Î´ = 0,

(15)

Î»i wi = 0,

(16)

Î´i (wi âˆ’ wÌ„i ) = 0,

(17)

w0 Âµ âˆ’ k = 0.

(18)

Suppose for a given k, the solution to the constrained minimum variance
portfolio problem is (wâˆ— (k), Î¸(k), Î»(k)). Assume that in a neighborhood of
k, the set of binding lower and upper bounds stays the same. We know
that the set of binding lower and upper bounds only changes at a finite
number of points as k varies. Since in practice S and Âµ are estimated and
hence are random, so with probability one, the above assumption is true.
Now in this neighborhood of k, we can re-write the binding lower and upper
bounds as equality constraints. So locally we are dealing with a constrained
10

Liu (2001) examined the same problem, though our approach here is different from
his. He works with the utility maximization problem of a mean-variance utility investor.
We work on the variance minimization for a given target return. We also point out that
the shrinkage interpretation is only valid when S is nonsingular.

25

optimization with only equality constraints. Further, both the solution to
this constrained optimization problem and the mimimum portfolio variance
change smoothly with respect to k. Applying the envelope theorem, we have
âˆ‚( 12 wâˆ—0 Swâˆ— )
âˆ‚(w0 Âµ âˆ’ k)
= âˆ’Î¸
= Î¸.
âˆ‚k
âˆ‚k
The envelope theorem simplifies here because neither the objective function
nor the equality constraints depend on k directly. Since on the efficient frontier there will be a positive trade-off between portfolio variance and portfolio
expected return, the LHS of the above equation, and hence Î¸, is positive.
Since Î¸ is positive, we can re-write the first order condition (15) as
1
1
Sw âˆ’ Î¸(Âµ + Î» âˆ’ Î´) = 0.
Î¸
Î¸
Notice this is in the same form of the first order condition for the unconstrained portfolio variance minimization problem (14). Therefore, constructing the constrained portfolio variance minimizaition from (S, Âµ) with target
expected excess return k is the same as constructing the unconstrained one
from (S, Âµ + 1Î¸ Î» âˆ’ 1Î¸ Î´) with target expected excess return (k âˆ’ 1Î¸ Î´ 0 wÌ„), because
the constraint on the portfolio mean return is now:
1
1
1
w0 (Âµ + Î» âˆ’ Î´) = k âˆ’ Î´ 0 wÌ„
Î¸
Î¸
Î¸
due to (16) - (18). (Notice that if only the nonnegativity constraint is present,
then the target return stays the same since Î´ is the zero vector.)
We point out that the above equivalence is true only when S is nonsingular. When S is singular, such as the monthly return sample covariance
matrix estimator in our empirical work in the earlier section, the unconstrained mean-variance optimization has no solution, but the constrained
one still has a solution since the domain of the objective function is now
compact. So we donâ€™t have the equivalence result anymore. The fact that
the constrained minimum variance portfolio can be constructed even though
26

S is singular implies that the constraint implies some adjustment to S. Liu
(2001) ignored this point.
Assume S is nonsingular, then if the nonnegativity constraint is binding
for stock i, its mean return is adjusted upward by the amount 1Î¸ Î»i . If the
upper bound is binding for stock j, its mean return is adjusted downward
by the amount 1Î¸ Î´j . In the unconstrained minimum variance portfolio, stocks
with low expected returns tends to get negative weights, so the nonnegativity
constraint will be binding. Imposing the nonnegativity constraint is as if
we adjust their expected returns upwards. The upper bounds have similar
effects. So imposing the weight constraints is equivalent to shrinking the
mean estimates.

B

Some Empirical Results

In this subsection, we empirically examine the shrinkage effect of imposing
portfolio weight constraints in the mean-variance optimization problem. We
will compare the out-of-sample performances of the constrained tangency
portfolios with that of the unconstrained ones, and with that of the global
minimum variance portfolios. We use the historical average return on an
asset as the measure of expected return on that asset. This would be a more
reasonable assumption for large stock portfolios than for individual stocks.
We therefore work with assets that are themselves portfolios of many stocks.
In particular, we construct these optimal portfolios using the Fama-French
25 size/book-to-market sorted stock portfolios.
At the end of April each year from 1968 to 1998, we use monthly returns
of the past 5 years to estimate the mean returns and return covariance matrix
of the 25 assets. We use several covariance matrix estimators, including the
sample covariance matrix, the one-factor model (where the factor return is
the value-weighted market index), the Fama-French three factor model, and
the Ledoit estimator. Using the estimates of mean returns and return co27

variance matrices, we form the unconstrained and nonnegativity constrained
tangency portfolios and the global minimum variance portfolios. We hold
these portfolios for one year, and then repeat the procedure again. The
realized returns of these optimal portfolios are recorded and examined.
The results are presented in Table 8. Panel A gives the out-of-sample
performance of the tangency portfolios. Panel B gives the corresponding
numbers for the global minimum variance portfolios. We use the Sharpe
Ratio to compare the performances of different portfolios. We draw the following conclusions from Table 8: (1) The constrained tangency portfolios
fared better than the unconstrained ones. This means there is some beneficial shrinkage associated with imposing the constraints. (2) The constrained
tangency portfolios fared worse than the constrained global minimum variance portfolios. This means that the sampling error in the estimated mean
returns is still too large even after the shrinking induced by imposing the constraints. Hence there is a need to bring in other information about expected
returns. This justifies our focus on the global minimum variance portfolios.
(3) The constrained global minimum variance portfolios did worse than the
corresponding unconstrained ones. This is true even if we use the sample covariance matrix. This contrasts sharply with the simulation result in Table
2, where for the case of 30 stocks, 60 months observations, and the covariance
matrix is estimated using the sample covariance matrix, the constraint always helps. Recall that the simulation there was calibrated to the covariance
structure of individual stocks. The covariance matrix of returns on a collection of assets that are themselves portfolios of a large collection of stocks can
be measured with substantially more precision than the covariance matrix of
returns on individual stocks. Hence when we are working with assets that
are themselves porfolios of large number of stocks, imposing the nonnegativity constraint hurts. This provides strong support for Green and Hollifield
(1992). Also, the fact that the constraint helps there but not here presents
a clear example that the gain from imposing the constraint depends on the
amount of sampling error.
28

VI

Concluding Remarks

Investors often voluntarily impose no-shortsales restrictions in optimal risk
reduction. However, Green and Hollifield (1992) argue that the optimal portfolios may well involve extreme positive and negative weights. We reconcile
this apparent contradiction. We show that imposing the no-shortsales constraint has a shrinkage-like effect. It follows from the theory of shrinkage
estimators that imposing the constraint can help even when the constraint
does not hold in the population. The upper bounds on portfolio weights have
similar shrinking effects. Using a Monte Carlo simulation we show that this
is indeed what is happening in optimal portfolio risk reduction.
Imposing the weight constraints also introduces specification error, since
these constraints are violated in population, as argued by Green and Hollifield. So the net effect depends on the tradeoff between the reduction in
sampling error and the increase in specification error, and whether the net
effect is positive or negative is an empirical issue. Frost and Savarino (1988)
and our simulation study show that for the sample covariance matrix, imposing the weight constraints helps. Our empirical results also show that
for factor models and shrinkage estimators, imposing the weight constraints
hurts slightly. On the other hand, once the no-shortsales restriction is imposed, portfolios constructed from the sample covariance matrix perform as
well as portfolios constructed using covariance matrices estimated using factor models and shrinkage methods.
While the effect of the portfolio weight constraints has been examined
empirically in the literature before, our result on the shrinkage effect of such
constraints is the first â€œtheoreticalâ€ result on this issue. One potential use of
this result is to gauge the tightness of a set of portfolio weight constraints by
the change from S to SÌƒ, as measured by ||S âˆ’ SÌƒ|| for some matrix norm || Â· ||.
A large ||S âˆ’ SÌƒ|| means that the effect of the constraints is quite strong and
the constraints are quite tight. This measure of tightness can help portfolio

29

managers to decide the appropriate lower and upper bounds on portfolio
weights when constructing the optimal portfolios.
Our empirical findings raise the following questions that deserve further
examination. (a) Why the use of daily data can help achieve better tracking
error reduction but not portfolio variance reduction? A possible explanation
is that covariances caused by exposure to the dominant factor change much
more over time when compared to those that are caused by exposure to other
factors. While the use of daily return data helps to reduce the sampling error
it does not take into account time variations in the covariance structure.
This may be less important once the dominant factor is removed as in the
case of tracking error minimization. (b) Why corrections for microstructure
effects do not help even though they provide more precise estimates of factor
betas? This could be due to the greater instability of microstructure effects
across stocks and over time. (c) Why do we find large in-sample-optimism
even for factor models and shrinkage estimators? Past researchers appear
to attribute this to sampling error. Additional Monte Carlo simulations
indicate that when returns have an exact factor structure, and the covariance
matrices are constructed using estimated factors, the in-sample optimism is
attenuated. This means that sampling error alone is unlikely to provide a
complete answer. Part of the reason has to be that either returns do not
have an exact factor structure or that the covariance structure is changing
over time. Hence shrinkage methods and factor models, which are intended
to reduce sampling errors, can only achieve limited success.

VII

Appendix A: Covariance Matrix Estimators that Use Daily Returns

This appendix describes how we estimate monthly covariance matrices using daily return data after taking into account serial correlations and cross30

correlations at various leads and lags induced by microstructure effects. We
consider the estimators proposed by Scholes and Williams (1977), Dimson
(1979), and Cohen, et al (1983, hereafter CHMSW). We point out that the
CHMSW estimator of the sample covariance matrix is usually not positive
semi-definite. We then propose a new methodology to estimate the covariance matrices of monthly returns using data on daily returns that are always
positive semi-definite. Our estimator uses the fact that the continuously
componded monthly return is the sum of continuously compounded daily returns. Our estimator can be readily modified based on restrictions imposed
by microstructure models.
The CHMSW estimator is based on the following relationship:
t
t
cov(rj,t
, rk,t
)

= cov(rj,t , rk,t ) +

L
X

cov(rj,t , rk,tâˆ’n )

n=1

+

L
X

cov(rj,tâˆ’n , rk,t ),

(19)

n=1

for any pair of stocks j and k, j 6= k. Here rt denotes the true date t return and r denotes the observed return, t and t âˆ’ n denote dates t and
t
t
t âˆ’ n. Based on this relation we can estimate cov(rj,t
, rk,t
) using observed
daily returns. In practice, L is set to three and the variances are estimated
using sample variances without any adjustment (Cohen et al. (1983) and
Shanken (1987)). The Scholes-Williams estimator is the special case of the
above, with L set to one. The estimate of the full sample covariance matrix
using the CHMSW method is denoted as â€œDaily Sample Covariance Matrix
(CHMSW)â€ in Tables 4-6.
Equation (19) is also valid if either asset (or both) is a portfolio. For
a well-diversified portfolio, (19) is approximately valid for its variance also.
Based on this, we can estimate a stockâ€™s beta as its covariance with the
market portfolio divided by the market portfolioâ€™s variance. The daily onefactor models (Scholes-Williams and CHMSW) in Tables 4-6 are estimated
using this strategy.
31

There is a problem with these estimators. The estimated covariance matrix, constructed from individual covariances and variances, is not positive
semi-definite. This is problematic for portfolio optimization. We propose a
new estimator that does not have this problem.11 Notice that monthly log
returns are simply sums of daily log returns:
ri,Ï„ =

Ï„m
X

ri,t .

t=(Ï„ âˆ’1)m+1

Here Ï„ is month Ï„, t is day t, and m is the number of days in a month. Then
the monthly return covariance is
cov(ri,Ï„ , rj,Ï„ ) =

Ï„m
X

Ï„m
X

cov(ri,t , rj,s ).

t=(Ï„ âˆ’1)m+1 s=(Ï„ âˆ’1)m+1

Unlike the CHMSW estimator (19), the above is valid for any i and j, even
if either one (or both) is a portfolio. Assuming covariance stationarity as
usual, we can drop the time subscripts, and get
covM (ri , rj ) = m Â· covD (ri,t , rj,t )

+ (m âˆ’ 1) Â· (covD (ri , rj,t+1 ) + covD (ri,t+1 , rj,t ))
+ (m âˆ’ 2) Â· (covD (ri , rj,t+2 ) + covD (ri,t+2 , rj,t ))
+ Â·Â·Â·

+ (covD (ri,t , rj,t+mâˆ’1 ) + covD (ri,t+mâˆ’1 , rj,t )).

(20)

The superscripts M and D denote the covariance of the monthly returns and
the covariance of the daily returns, respectively. We set m = 21 for there are
about 21 trading days in one month.
An obvious approach is to use the sample counterpart of the RHS of
(20) to estimate the monthly return covariance. However, to guarantee that
11

There is a difference between our approach and the approach taken by Scholes and
Williams and CHMSW. While they want to estimate the â€œtrueâ€ covariances and betas
using the daily returns, we want to use daily returns to estimate the covariances and betas
of monthly returns.

32

the covariance matrix is positive semi-definite, we need to further adjust the
covariance estimates (20) slightly. Let
R0 = (rt,i âˆ’ r.,i )t=1,...,T ; i=1,...,N ,
the matrix of demeaned returns. For j = 1, Â· Â· Â· , m âˆ’ 1, let Râˆ’j be the same
size as R0 , with the first j rows set to zeros, and the remaining T âˆ’ j rows
the same as R0 â€™s first T âˆ’ j rows (i.e., Râˆ’j is the matrix of lag-j demeaned
returns). Let
â„¦j = R00 Râˆ’j /T,
S = m â„¦0 +

mâˆ’1
X
j=1

(m âˆ’ j)(â„¦j + â„¦0j ).

(21)

Then S is positive semi-definite (see Newy and West (1987) for the proof)
and S is a consistent estimator of the RHS of (20). The covariance matrix
estimated this way is denoted as â€œDaily Sample Covariance Matrix (New)â€
in Tables 5 - 7.
If we assume a kâˆ’factor model, then the beta estimates are
b = (var(f
Ë† ))âˆ’1 cov(f,
Ë†
r).
Here b is k Ã— N, var(f
Ë† ) is the estimated factor covariance matrix (of size
k Ã— k) and is estimated according to (21), and cov(f,
Ë†
r) is estimated (similar
to (21)) by
ï£®

ï£¹

mâˆ’1
X
1
0
(m âˆ’ j)(F00 Râˆ’j + Fâˆ’j
R0 )ï£» ,
cov(f,
Ë†
r) = ï£°m F00 R0 +
T
j=1

with Fâˆ’j defined similarly as Râˆ’j .
For factor models, the residual covariance matrix is assumed diagonal
and the residual variances are estimated by the sample variances of residuals calculated from observed stock returns, observed factor returns, and the
estimated betas. In Tables 5-7, the estimators denoted as â€œDaily 1 Factor
33

Model (New),â€ â€œDaily Connor-Korajczyk 3 Factor Model,â€ â€œDaily ConnorKorajczyk 5 Factor Model,â€ and â€œDaily Fama-French 3 Factor Model,â€ are
all estimated using this strategy.
We construct the daily Connor-Korajczyk factors and Fama-French factors by following the same procedure as outlined in Connor and Korajczyk
(1988) (using daily returns instead of monthly returns) and Fama and French
(1993).
Finally, in Tables 5-7, the estimator â€œDaily Sample Covariance Matrixâ€
denotes the sample covariance of daily returns.

VIII

Appendix B: Proof of the Propositions

Proof of Proposition 1:12 SÌƒ is obviously symmetric. Now we prove that
it is positive demi-definite. Suppose that
(Ï‰1 , Â· Â· Â· , Ï‰N , Î»1 , Â· Â· Â· , Î»N , Î´1 , Â· Â· Â· , Î´N , Î»0 ) â‰¡ (Ï‰ 0 , Î»0 , Î´ 0 , Î»0 )
is a solution to the constrained portfolio variance minimization problem (1)
- (4). For any vector x,
x0 SÌƒx = x0 Sxâˆ’x0 (1Î»0 +Î»10 )x+x0 (1Î´ 0 +Î´10 )x = x0 Sxâˆ’2(x0 1)(x0 (Î»âˆ’Î´)). (22)
(Here 1 is a vector of ones.) By the first order condition, Î» âˆ’ Î´ = SÏ‰ âˆ’ Î»0 1.
Hence, x0 (Î» âˆ’ Î´) = x0 SÏ‰ âˆ’ Î»0 x0 1. Therefore
12

2(x0 1)(x0 (Î» âˆ’ Î´)) = 2(x0 1)(x0 SÏ‰) âˆ’ 2Î»0 (x0 1)2 .
We thank Gopal Basak for providing a part of this proof.

34

(23)

But
|(x0 1)(x0 SÏ‰)| = |(x0 1)(x0 S 1/2 )(S 1/2 Ï‰)| â‰¤ |(x0 1)|(x0 Sx)1/2 (Ï‰ 0 SÏ‰)1/2 .
The first equality holds since S is positive semi-definite, and the last inequality is due to the Cauchy-Schwarz inequality.
Again from the First Order Condition,
0 â‰¤ Ï‰ 0 SÏ‰ = Ï‰ 0 Î» âˆ’ Ï‰ 0 Î´ + Î»0 Ï‰ 0 1 = Î»0 âˆ’ Ï‰Ì„Î´ 0 1 â‰¤ Î»0 .
So
|(x0 1)(x0 SÏ‰)| â‰¤ |(x0 1)|(x0 Sx)1/2 (Î»0 )1/2 .
Combining the above inequality with (22) and (23), we have
x0 SÌƒx = x0 Sx âˆ’ 2(x0 1)x0 SÏ‰ + 2Î»0 (x0 1)2

â‰¥ x0 Sx âˆ’ 2|(x0 1)x0 SÏ‰| + 2Î»0 (x0 1)2

â‰¥ x0 Sx âˆ’ 2|(x0 1)|(x0 Sx)1/2 (Î»0 )1/2 + 2Î»0 (x0 1)2
= (a âˆ’ b)2 + b2 ,

(24)

1/2

where a = (x0 Sx)1/2 and b = Î»0 |(x0 1)|. Obviously this is always nonnegative. So SÌƒ is positive semi-definite.
Because SÌƒ is positive semi-definite, to show that Ï‰ = (Ï‰1 , Â· Â· Â· , Ï‰N ) is a
(unconstrained) global minimum variance portfolio of SÌƒ, it suffices to verify
the first order condition:
SÌƒÏ‰ = SÏ‰ âˆ’ (1Î»0 + Î»10 )Ï‰ + (1Î´ 0 + Î´10 )Ï‰
= SÏ‰ âˆ’ Î»10 Ï‰ + 1Ï‰Ì„(Î´ 0 1) + Î´10 Ï‰
= SÏ‰ âˆ’ Î» + Ï‰Ì„(Î´ 0 1)1 + Î´
= (Î»0 + Ï‰Ì„Î´ 0 1)1.

The second equality follows from the fact that Ï‰i Î»i = 0 for all i, and Î´i (Ï‰i âˆ’
P
Ï‰Ì„) = 0 for all i. The third equality holds because j wj = 1, and the last
35

equality follows from (5). The fact that SÌƒÏ‰ = (Î»0 + Ï‰Ì„Î´ 0 1)1 shows that
Ï‰ solves the (unconstrained) variance minimization problem for covariance
matrix SÌƒ.
QED
Proof of Proposition 2: First, letâ€™s re-write the second constraint in the
constrained MLE problem as
(1 âˆ’ Ï‰Ì„)

X
j

â„¦i,j â‰¤ Ï‰Ì„

XX

â„¦k,j .

k6=i j

Let the constrained MLE be â„¦Ì‚. The Kuhn-Tucker conditions for the constrained MLE problem are (Morrison (1990), p. 99):
1
1
âˆ‚l
=
â„¦Ì‚i,i âˆ’ Si,i = âˆ’Î»i + (1 âˆ’ Ï‰Ì„)Î´i , all i
i,i
âˆ‚â„¦
2
2
âˆ‚l
= â„¦Ì‚i,j âˆ’ Si,j = âˆ’(Î»i + Î»j ) + (1 âˆ’ Ï‰Ì„)(Î´i + Î´j ), all i < j
âˆ‚â„¦i,j
X
Î»i â‰¥ 0, and Î»i = 0 if
â„¦Ì‚i,j > 0,
j

Î´i â‰¥ 0, and Î´i = 0 if (1 âˆ’ Ï‰Ì„)

X
j

â„¦i,j < Ï‰Ì„

XX

â„¦k,j .

(25)
(26)
(27)
(28)

k6=i j

These conditions imply that the constrained MLE can be written as
â„¦Ì‚ = S âˆ’ (Î»10 + 1Î»0 ) + (1 âˆ’ Ï‰Ì„)(Î´10 + 1Î´ 0 )
Notice that â„¦Ì‚ has the same form as SÌƒ.
We will only prove Part 1. The proof of Part 2 is similar.
Let {Î»i , Î´i , Ï‰i }N
i=1 be a solution to the constrained portfolio variance minimization problem (1) - (4), given S, and construct SÌƒ according to (8). Then
we can easily verify that {Î»i , (1 âˆ’ Ï‰Ì„)Î´i }N
i=1 and SÌƒ satisfies (25), (26), and the
first halfs of (27) and (28). Now we need to verify the second halfs of (27)
P
P
P
P
and (28), i.e., j SÌƒ i,j > 0 implies Î»i = 0 and (1 âˆ’ Ï‰Ì„) j SÌƒ i,j < Ï‰Ì„ k6=i j SÌƒ k,j
implies Î´i = 0. By Proposition 1, Ï‰ is the unconstrained global minimum
P
P P
variance portfolio of SÌƒ, so Ï‰i = j SÌƒ i,j / j k SÌƒ j,k . From the second half of
P
(6) we know that Ï‰i > 0 implies Î»i = 0. This says that j SÌƒ i,j > 0 implies
Î»i = 0. Likewise, the second half of (7) implies the second half of (28). QED
36

References
Alexander, G. J., 1978, A Reevaluation of Alternative Portfolio Selection
Models Applied to Common Stocks, Journal of Financial and Quantitative Analysis 13, 71-78.
Best, Michael J. and Robert R. Grauer, 1991, On the Sensitivity of MeanVariance-Efficient Portfolios to Changes in Asset Means: Some Analytical and Computational Results, Review of Financial Studies 4, 315-42.
Bird, Ron, and Mark Tippett, 1986, Naive Diversification and Portfolio Riskâ€“
A Note, Management Science 32, 244-51.
Black, Fisher and Robert Litterman, 1992, Global Portfolio Optimization,
Financial Analysts Journal, September-October, 28-43.
Bloomfield, Ted, Richard Leftwich and John Long, 1977, Portfolio Strategies
and Performance, Journal of Financial Economics 5, 201-218.
Chan, Louis K.C. Jason Karceski and Josef Lakonishok, 1999, On Portfolio
Optimization: Forecasting Covariances and Choosing the Risk Model,
Review of Financial Studies 12, 937-74.
Cohen, G., G. Hawawini, S. Maier, R. Schwartz, and D. Whitcome, 1983,
Friction in the Trading Process and the Estimation of Systematic Risk,
Journal of Financial Economics 12, 263-78.
Cohen, K.J. and J.A.Pogue, 1967, An Empirical Evaluation of Alternative
Portfolio Selection Models, Journal of Business 40, 166-193.
Connor, Gregory, and Robert A. Korajczyk, 1986, Performance Measurement
with the Arbitrage Pricing Theory, Journal of Financial Economics, 15,
373-394.
Connor, Gregory and Robert A. Korajczyk, 1988, Risk and Return in an
Equilibrium APT: Applications of a New Test Methodology, Journal of
Financial Economics 21, 255-289.
37

Connor, Gregory and Robert A. Korajczyk, 1993, A Test for the Number of
Factors in an Approximate Factor Model, Journal of Finance 48, 1263-91.
Connor, Gregory and Robert A. Korajczyk, 1995, The Arbitrage Pricing
Theory and Multifactor Models of Asset Returns, in: R. A. Jarrow, V.
Maksimovic, and W.T.Ziemba (eds.), Finance, Elsevier Science.
Elton, E. J. and M.J. Gruber, 1973, Estimating the Dependence Structure
of Share Prices â€“ Implications for Portfolio Selection, Journal of Finance
28, 1203-1232.
Elton, E. J., and M. J. Gruber, 1977, Risk Reduction and Portfolio Size: An
Analytical Solution, Journal of Business 50, 415-37.
Elton, E. J. M. J. Gruber and T. Ulrich, 1978, Are Betas Best? Journal of
Finance 23, 1375-1384.
Evans, John L. and Stephen H. Archer, 1968, Diversification and the Reduction of Dispersion: An Empirical Analysis, Journal of Finance 21,
761-67.
Fama, Eugene, and Kenneth French, 1992, The Cross-Section of Expected
Stock Returns, Journal of Finance 47, 427-465.
Fama, Eugene and Kenneth French, 1993, Common Risk Factors in the Returns on Stocks and Bonds, Journal of Financial Economics 33, 3-56.
Frost, Peter A. and James E. Savarino, 1986, An Empirical Bayes Approach
to Efficient Portfolio Selection, Journal of Financial and Quantitative
Analysis 21, 293-305.
Frost, Peter A. and James E. Savarino, 1988, For Better Performance: Constrain Portfolio Weights, Journal of Portfolio Management 15, No. 1,
29-34.
Green, Richard C. and Burton Hollifield, 1992, When Will Mean-Variance

38

Efficient Portfolios be Well Diversified? Journal of Finance 47, 17851809.
James, W. and C. Stein, 1961, Estimation with Quadratic Loss. In Proc.
Fourth Berkeley Symp. Math. Statist. Probab., 1, 361-79. University of
California Press, Berkeley, CA.
Jobson, J.D. and B. Korkie, 1980, Estimation for Markowitz Efficient Portfolios, Journal of the American Statistical Association 75, 544-54.
Jobson, J.D. and B. Korkie, 1981, Putting Markowitz Theory to Work, Journal of Portfolio Management, Summer, 70-74.
Johnson, K. H. and D. S. Shannon, 1974, A Note on Diversification and the
Reduction of Dispersion, Journal of Financial Economics 1, 365-72.
Jorion, Philippe, 1985, International Portfolio Diversification with Estimation Risk, Journal of Business, 58, 3, 259-278.
Jorion, Philippe, 1986, Bayes-Stein Estimation for Portfolio Analysis, Journal of Financial and Quantitative Analysis, 21, 3, 279-292.
Jorion, Philippe, 1991, Bayesian and CAPM estimators of the means: Implications for portfolio selection, Journal of Banking and Finance, 15,
717-727.
Ledoit, Olivier, 1996, A Well-Conditioned Estimator for Large Dimensional
Covariance Matrices, Unpublished, UCLA.
Ledoit, Olivier, 1999, Improved Estimation of the Covariance Matrix of Stock
Returns with an Application to Portfolio Selection, Unpublished, UCLA.
Liu, Ludan, 2001, Portfolio Constraints and Shrinkage Estimation, Unpublishes, Carroll School of Management, Boston College.
MacKinlay, A. Craig and Lubos Pastor, 1999, Asset Pricing Models: Implications for Expected Returns and Portfolio Selection, Unpublished, The
Wharton School, University of Pennsylvania.
39

Markowitz, H. M., 1952, Portfolio Selection, Journal of Finance 7, 77-91.
Markowitz, H. M., 1959, Portfolio Selection: Efficient Diversification of Investments, Yale University Press, New Haven, CT.
Michaud, Richard O. 1989, The Markowitz Optimization Enigma: Is â€™Optimizedâ€™ Optimal? Financial Analysts Journal, January-February, 31-42.
Morrison, Donald F., 1990, Multivariate Statistical Methods (3rd ed.), McGrawHill.
Newy, Whitney K, and Kenneth D. West, 1987, A Simple, Positive SemiDefinite, Heteroskedasticity and Autocorrelation Consistent Covariance
Matrix, Econometrica 55, 703-708.
Scholes, M. and J. Williams, 1977, Estimating Betas from Nonsynchronous
Data, Journal of Financial Economics 5, 309-28.
Shanken, Jay, 1987, Nonsynchronous Data and the Covariance-Factor Structure of Returns, Journal of Finance 42, 221-31.
Sharpe, William, 1963, A Simplified Model for Portfolio Analysis Management Science 9, 277-293.
Statman, Meir, 1987, How Many Stocks Make a Diversified Portfolio? Journal of Financial and Quantitative Analysis 22, 353-63.
Tole, Thomas M., 1982, You Canâ€™t Diversify without Diversifying, Journal
of Portfolio Management, Winter, 5-11.
Wallingford, Buckner, 1967, A Survey and Comparison of Portfolio Selection
Models, Journal of Financial and Quantitative Analysis 2, 85-106.

40

Table 1. The effect of portfolio weight constraints
This table shows the effects of nonnegativity constraints and upper bound on portfolio weights.
The covariance matrix S is the sample covariance matrix of monthly returns of a random sample
of 30 stocks from 1988-1997 (120 months). Î» and Î´ are the vectors of Lagrange multipliers on
the nonnegativity constraint and the upper bound, respectively. The upper bound is set at 10%.
The numbers below the correlation coefficients (and in parenthesis) are significant levels.
The numbers below the regression coefficients are standard errors.
Panel A: Summary statistics of the row sums of S, unconstrained portfolio weights, and
the Lagrange multipliers
Variable
Mean
Std Dev Minimum Maximum
0.0358
0.0169
0.0106
0.0695
Row sums of S
0.0333
0.0926
-0.1251
0.3569
Unconstrained portfolio weights
0.000063
0.000092
0
0.000316
Î»iâ€™s
0.000016
0.000045
0
0.000169
Î´iâ€™s
Panel B: Correlations among the row sums of S, unconstrained portfolio weights, and the
Lagrange multipliers
Unconstrained
Î´iâ€™s
Î»iâ€™s
portfolio weights
-0.496
Row sumâ€™s of S
0.713
-0.425
(0.0053) (0.0001)
(0.0191)
Unconstrained portfolio weights
-0.494
0.808
(0.0055)
(0.0001)
-0.255
Î»iâ€™s
(0.173)
Panel C: Summary statistics for the (distinct) individual elements of S, and the
adjustments to the individual elements due to the portfolio weight constraints
Variable
Mean
Std Dev Minimum Maximum
0.00139
0.00216
-0.00186
0.019
Sij
0.000127
0.00013
0
0.000632
Î»i + Î»j
0.000032
0.000063
0
0.000338
Î´i + Î´j
Panel D: Correlations among the (distinct) individual elements of S and the adjustments
to the individual elements due to the portfolio weight constraints
Î´i + Î´j
Î»i + Î»j
Sij
0.296
-0.184
(0.0001)
(0.0001)
-0.255
Î»i + Î»j
(0.0001)
Panel E: Regression of the adjustments on the (distinct) individual elements of S
Dependent Variable
Intercept
Sij No. of obs.
Adj. R2
1.02E-4
0.0177
465
0.085
Î»i + Î»j
(6.84E-6) (0.00266)
3.94E-5 -0.00539
465
0.032
Î´i + Î´j
(3.44E-6) (0.00134)

Table 2. Effects of imposing nonnegativity constraints and the single-factor
constraint
This table shows the percentage reduction in the ex post standard deviations of the global
minimum variance portfolios, when the nonnegativity and/or single factor model
constraints are imposed, relative the ex post variances of the global minimum variance
portfolios constructed from the sample covariance matrix and the equal-weighted
portfolio. N is the number of assets; T is the sample size used to estimate the covariance
matrix. ÏƒÎ² is the cross-sectional standard deviation in the stocksâ€™ betas with respect to the
first factor. The true stock returns have a two factor structure, and the covariance
structure roughly matches that of the NYSE when ÏƒÎ² is 0.4. Refer to the text for details of
the setup of the simulation. When ÏƒÎ² is 0, the nonnegativity constraint is correct in
population; when ÏƒÎ² is 0.4, the nonnegativity constraint is violated roughly to the same
extent as using the NYSE stocks; and when ÏƒÎ² is 0.2, the nonnegativity constraint is more
severely violated than when ÏƒÎ² is 0.4. The rows with T = Infinity are the population
results.
N

T

Panel A: ÏƒÎ² = 0
30
60
30
360
30
Infinity
300
60
300
360
300
Infinity
Panel B: ÏƒÎ² = 0.2
30
60
30
360
30
Infinity
300
60
300
360
300
Infinity
Panel C: ÏƒÎ² = 0.4
30
60
30
360
30
Infinity
300
60
300
360
300
Infinity

Percentage reduction in ex post standard deviation of the optimal portfolios
from imposing the constraints
Relative to the portfolio constructed
Relative to the equal-weighted
from the sample covariance matrix
portfolio
Single- Nonnegativity
Both
Single- Nonnegativity
Both
factor
constraint
factor
constraint
model
model
21.6
0.8
0.0
na
54.6
0.0

25.2
1.2
0.0
na
58.8
0.0

26.0
1.4
0.0
na
59.1
0.0

-12.2
-1.7
1.1
-8.1
-14.6
0.2

-7.0
-1.3
1.1
-11.6
-3.9
0.2

-6.0
-1.0
1.1
-6.9
-3.2
0.2

20.7
1.7
-0.3
na
56.2
-5.0

16.2
-3.2
-5.6
na
26.1
-80.7

18.7
-2.6
-5.8
na
26.5
-81.3

8.4
14.8
16.8
45.9
60.3
62.8

3.3
10.6
12.4
18.1
33.0
35.9

6.1
11.1
12.3
23.2
33.3
35.7

27.2
2.3
-0.1
na
59.2
-0.8

16.8
-7.6
-10.0
na
25.0
-79.4

21.2
-7.1
-10.0
na
27.2
-80.7

38.9
42.6
43.3
72.9
79.3
79.9

30.2
36.8
37.7
50.8
61.9
64.2

33.9
37.0
37.7
57.6
63.0
64.0

Table 3. Cutoff points for the sample sizes when the nonnegativity constraints start
to hurt.
The true return covariance has a two factor structure. Across stocks, the betas with
respect to the first factor is normally distributed with mean one and standard deviation Î´Î².
The number of stocks is N, and the sample size is T. We estimate the covariance matrix
for the stocks using simulated returns of sample size T using the sample covariance
matrix. Then we form the nonnegativity constrained and unconstrained global minimum
variance portfolios using the estimated covariance matrix, and calculate the ex post
variances of these portfolios. For each (Î´Î², N) pair, we report the cutoff point for T such
that when the sample size is greater than or equal to the cutoff point, the nonnegativity
constraint will hurt. For more details of the simulation specification, please refer to the
text.
N

30
60
120
180
240
300
1

Î´Î²
0.2

0.3

0.4

na1
150
270
330
390
450

120
150
270
270
390
450

120
150
330
330
450
450

: Such cutoff point is not found in that set of simulation.

Table 4. Short interests in the global minimum variance portfolios
The true return covariance has a two factor structure. Across stocks, the betas with
respect to the first factor is normally distributed with mean one and standard deviation Î´Î²,
the betas with respect to the second factor is normally distributed with mean zero and
standard deviation 0.2. The two factor returns have unit variances and zero covariance.
The stocksâ€™ residual variances are constant over time, but follow a Lognormal(0.8, 0.7)
distribution. The number of stocks is N. For each (Î´Î², N) pair, we draw the betas and the
residual variances according to the above-mentioned distributional assumptions, and then
calculate the true stock return covariance matrix. We then calculate the unconstrained
global minimum variance portfolio and its short interest (i.e., the sum of the negative
portfolio weights). This procedure is repeated ten times and the averages are reported
below. The short interests give the extent to which the nonnegativity constraint is wrong.
N
0.1
30
60
120
180
240
300

-0.181
-0.554
-1.188
-1.578
-1.845
-2.042

Î´Î²

0.2

0.3

0.4

-0.401
-0.706
-1.012
-1.161
-1.250
-1.308

-0.391
-0.584
-0.737
-0.828
-0.816
-0.831

-0.350
-0.468
-0.515
-0.555
-0.534
-0.526

Table 5. Ex post mean, standard deviation, and other characteristics of the global
minimum variance portfolios
At the end of April each year from 1968-1997, the covariance matrix of a random sample
of 500 stocks is estimated according to variance estimators. We use these covariance
matrix estimates to construct the global minimum variance portfolios, both constrained
and unconstrained. We hold the portfolios for the next 12 months and their monthly
returns are recorded. The ex post means, standard deviations, and other characteristics of
these portfolios are reported. The C after an estimator indicates the nonnegativity
constrained portfolios, and D after an estimator indicates the portfolio with both the
nonnegativity constraint and the upper bound of 2%. For the equal-weighted and valueweighted portfolios of 25 stocks, the 25 stocks are randomly selected from the 500 ones.
Means and standard deviations are in percentage per year, maximum weight, minimum
weight, and short interest are in percentage.
Covariance matrix estimator
Monthly sample covariance matrix, C
Monthly sample covariance matrix, D
One-factor model
One-factor model, C
One-factor model, D
Ledoit
Ledoit, C
Ledoit, D
Fama-French 3 factor model
Fama-French 3 factor model, C
Fama-French 3 factor model, D
Daily sample covariance matrix
Daily sample covariance matrix, C
Daily sample covariance matrix, D
Daily sample covariance matrix of
CHMSW, C
Daily sample covariance matrix of
CHMSW, D
Daily sample covariance matrix (New)
Daily sample covariance matrix (New), C
Daily sample covariance matrix (New), D
Daily Fama-French 3-factor
Daily Fama-French 3-factor, C
Daily Fama-French 3-factor, D
Equal-weighted portfolio of the 500 stocks
Value-weighted portfolio of the 500 stocks
Equal-weighted portfolio of 25 stocks
Value-weighted portfolio of 25 stocks

Mean

Std
Dev

Max.
weight

Min.
weight

Short
No. of
interest positive
weights

13.55
13.55
13.99
12.68
13.51
13.09
12.79
13.49
13.04
12.65
13.34
14.06
13.95
14.22
13.89

12.43
12.85
11.69
12.62
12.50
10.76
12.29
12.43
11.35
12.38
12.53
10.64
12.34
12.28
12.31

18.4
2.0
3.8
11.3
2.0
4.9
13.4
2.0
4.2
12.2
2.0
6.3
8.8
2.0
9.1

0
0
-0.9
0
0
-1.7
0
0
-1.4
0
0
-2.5
0
0
0

0
0
-50.7
0
0
-80.6
0
0
-63.5
0
0
-122.4
0
0
0

24.1
59.5
268.8
39.3
63.1
283.2
39.7
65.4
284.1
40.1
64.0
270.7
64.7
81.1
62.5

14.18

12.25

2.0

0

0

80.1

13.94
13.81
14.12
13.07
13.03
13.09
14.52
13.39
15.16
14.25

10.60
12.26
12.21
11.25
12.03
12.15
17.48
15.60
17.78
17.79

6.3
9.0
2.0
4
12.7
2
0.2
7.3
4
30

-2.6
0
0
-1.4
0
0
0
0
0
0

-128.5
0
0
-66.9
0
0
0
0
0
0

269.5
62.9
79.5
276.8
40.7
63.6
500
500
25
25

Table 6. Ex post mean, standard deviation, and other characteristics of the
minimum tracking error variance portfolios
At the end of April each year from 1968-1997, the covariance matrix of a random sample
of 500 stocks is estimated according to variance estimators. We use these covariance
matrix estimates to construct the minimum tracking error variance portfolios, both
constrained and unconstrained. The target is the S&P 500 returns. We hold the portfolios
for the next 12 months and their monthly tracking errors are recorded. The ex post means
and standard deviations of the tracking errors and some characteristics of the tracking
portfolios are reported. The C after an estimator indicates the nonnegativity constrained
portfolios, and D after an estimator indicates the portfolio with both the nonnegativity
constraint and the upper bound of 2%. For the equal-weighted and value-weighted
portfolios of 25 stocks, the 25 stocks are randomly selected from the 500 ones.
Means and standard deviations are in percentage per year, maximum weight, minimum
weight, and short interest are in percentage.
Covariance matrix estimator
Monthly sample covariance matrix, C
Monthly sample covariance matrix, D
One-factor model
One-factor model, C
One-factor model, D
Ledoit
Ledoit, C
Ledoit, D
Fama-French 3 factor model
Fama-French 3 factor model, C
Fama-French 3 factor model, D
Daily sample covariance matrix
Daily sample covariance matrix, C
Daily sample covariance matrix, D
Daily sample covariance matrix of
CHMSW, C
Daily sample covariance matrix of
CHMSW, D
Daily sample covariance matrix (New)
Daily sample covariance matrix (New), C
Daily sample covariance matrix (New), D
Daily Fama-French 3-factor
Daily Fama-French 3-factor, C
Daily Fama-French 3-factor, D
Equal-weighted portfolio of the 500 stocks
Value-weighted portfolio of the 500 stocks
Equal-weighted portfolio of 25 stocks
Value-weighted portfolio of 25 stocks

Mean

Std
Dev

Max.
weight

Min.
weight

Short
No. of
interest positive
weights

4.28
4.23
4.91
4.91
4.91
4.18
4.21
4.27
3.76
3.71
3.71
3.69
3.93
4.17
3.92

3.36
3.40
5.04
5.04
5.04
3.48
3.34
3.36
4.41
4.39
4.39
2.94
2.78
2.96
2.75

2.4
1.8
0.9
0.9
0.9
1.8
2.2
1.8
1.4
1.5
1.5
5.3
5.4
2
5.4

0
0
0
0
0
-0.3
0
0
-0.2
0
0
-1
0
0
0

0
0
0
0
0
-8.7
0
0
-3.3
0
0
-36.6
0
0
0

200
194
499
499
499
391
314
312
433.1
394.6
394.5
322.4
231.3
227.6
231.4

4.17

2.92

2

0

0

226.3

3.72
3.93
4.17
3.82
3.76
3.77
4.92
3.6
4.66
4.13

2.92
2.73
2.89
4.50
4.50
4.51
6.58
2.37
8.62
8.24

5.3
5.4
2
1.3
1.5
1.4
0.2
6.7
4
29.7

-1
0
0
-0.2
0
0
0
0
0
0

-36.8
0
0
-3.7
0
0
0
0
0
0

322.2
228
224.2
427.8
384.1
383.8
500
500
25
25

Table 7. t-tests of equal mean returns and equal mean squared returns
This table reports the t-tests of equal mean returns and equal mean squared returns of the
minimum variance and minimum tracking error variance portfolios. For each such
portfolio, we test whether its mean returns and mean squared returns are statistically
different from those of the nonnegativity constrained portfolio constructed from the
sample covariance matrix of monthly returns.
Covariance matrix estimator

Monthly sample covariance matrix, D
One-factor model
One-factor model, C
One-factor model, D
Ledoit
Ledoit, C
Ledoit, D
Fama-French 3 factor model
Fama-French 3 factor model, C
Fama-French 3 factor model, D
Daily sample covariance matrix
Daily sample covariance matrix, C
Daily sample covariance matrix, D
Daily sample covariance matrix of
CHMSW, C
Daily sample covariance matrix of
CHMSW, D
Daily sample covariance matrix (New)
Daily sample covariance matrix (New), C
Daily sample covariance matrix (New), D
Daily Fama-French 3-factor
Daily Fama-French 3-factor, C
Daily Fama-French 3-factor, D
Equal-weighted portfolio of the 500 stocks
Value-weighted portfolio of the 500 stocks
Equal-weighted portfolio of 25 stocks
Value-weighted portfolio of 25 stocks

Minimum variance
portfolio
Equality
Equality in
in mean mean squared
return
return

Minimum tracking error
portfolio
Equality
Equality in
in mean mean squared
return
return

-0.01
0.26
-0.76
-0.05
-0.40
-1.05
-0.07
-0.38
-1.08
-0.22
0.38
0.35
0.65
0.29

1.36
-1.16
0.19
0.15
-2.99
-0.60
-0.02
-2.34
-0.29
0.23
-3.86
-0.11
-0.22
-0.20

-0.53
1.06
1.06
1.06
-0.32
-0.30
-0.03
-1.02
-1.15
-1.15
-1.30
-0.87
-0.28
-0.89

1.49
5.35
5.34
5.34
1.06
-0.32
0.08
4.46
4.42
4.41
-3.29
-4.43
-3.26
-4.82

0.62

-0.31

-0.29

-3.72

0.29
0.23
0.57
-0.31
-0.51
-0.44
0.54
-0.10
0.82
0.32

-3.82
-0.35
-0.44
-2.41
-0.95
-0.78
6.79
5.25
6.94
7.07

-1.24
-0.87
-0.29
-0.82
-0.95
-0.93
0.73
-1.48
0.29
-0.10

-3.40
-5.09
-4.11
4.28
4.25
4.26
6.76
-7.33
9.48
9.88

Table 8. Comparison of the ex post performance of tangency portfolios and global minimum variance portfolios
The assets are the Fama-French 25 size-beta sorted portfolios.
The covariance matrix is estimated at the end of April, using monthly
returns of the previous 5 year. The tangency portfolios and the global minimum variance portfolios are then formed
and held for one year. This procedure is repeated from 1968 to 1998.
The table reports characteristics of ex post excess returns of these portfolios.
Both unconstrained and nonnegativity constrained portfolios are considered.
Means and standard deviations of returns are monthly ones. Sharpe ratios are annualized.

Portfolios

In-sample
in-sample in-sample Sharpe
mean
std dev
Ratio Mean

Out-of-sample
Std Dev

Minimum

Maximum

Sharpe
Ratio

Average
total short
position

Average No.
of assets
held long

Panel A: Tangency portfolios
Sample cov matrix, constrained
Sample cov matrix, unconstrained
One-factor model, constrained
One-factor model, unconstrained
FF 3-factor model, constrained
FF 3-factor model, unconstrained
Ledoit estimator, constrained
Ledoit estimator, unconstrained
Equally-weighted portfolio

1.01
-2.96
0.97
6.27
1.02
18.03
1.01
-208.78

5.34
14.01
5.19
10.57
5.35
42.63
5.31
409.80

0.66
-0.73
0.65
2.06
0.66
1.46
0.66
-1.76

0.72
0.80
0.67
4.87
0.71
-0.33
0.71
-66.40
0.62

5.59
43.94
5.64
46.31
5.60
83.32
5.58
1851.19
5.15

-25.24
-243.78
-26.19
-160.16
-25.24
-715.70
-25.24
-19304.37
-26.56

25.74
193.46
26.78
500.39
25.74
533.18
25.74
15046.03
22.54

0.45
0.06
0.41
0.36
0.44
-0.01
0.44
-0.12
0.41

0.00
-36.69
0.00
-9.23
0.00
-51.97
0.00
-611.30
0.00

2.29
12.68
4.16
12.94
2.32
12.81
2.55
13.16
25.00

4.33
4.60
4.45
4.82
4.36
4.13
4.34
4.04

0.46
0.60
0.45
0.49
0.46
0.72
0.46
0.61

0.51
0.75
0.54
0.65
0.51
0.68
0.52
0.73
0.62

3.75
2.15
3.73
2.43
3.77
2.48
3.76
2.68
5.15

-24.42
-21.95
-26.34
-19.75
-24.66
-20.93
-24.52
-20.85
-26.56

16.78
17.44
17.95
20.16
17.79
18.27
17.00
16.29
22.54

0.46
0.60
0.45
0.49
0.46
0.72
0.46
0.61
0.41

0.00
-4.82
0.00
-1.48
0.00
-2.52
0.00
-2.23
0.00

3.58
13.00
4.55
12.35
3.42
13.03
4.06
13.39
25.00

Panel B: Global minimum variance portfolios
sample cov matrix, constrained
sample cov matrix, unconstrained
one-factor model, constrained
one-factor model, unconstrained
FF 3-factor model, constrained
FF 3-factor model, unconstrained
Ledoit Estimator, constrained
Ledoit Estimator, unconstrained
Equally-weighted portfolio

0.58
0.80
0.58
0.69
0.58
0.85
0.58
0.71

