NBER WORKING PAPER SERIES

Y-BASED APPROACH TO HEDONIC PRICE REGRESSIONS WITH TIME-VARYING UNOBSERVED PRODUCT ATTR
THE PRICE OF POLLUTION
Patrick Bajari
Jane Cooley
Kyoo il Kim
Christopher Timmins
Working Paper 15724
http://www.nber.org/papers/w15724

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
February 2010

The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Patrick Bajari, Jane Cooley, Kyoo il Kim, and Christopher Timmins. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

A Theory-Based Approach to Hedonic Price Regressions with Time-Varying Unobserved
Product Attributes: The Price of Pollution
Patrick Bajari, Jane Cooley, Kyoo il Kim, and Christopher Timmins
NBER Working Paper No. 15724
February 2010
JEL No. C01,Q51
ABSTRACT
We propose a new strategy for a pervasive problem in the hedonics literature—recovering hedonic
prices in the presence of time-varying correlated unobservables. Our approach relies on an assumption
about homebuyer rationality, under which prior sales prices can be used to control for time-varying
unobservable attributes of the house or neighborhood. Using housing transactions data from California’s
Bay Area between 1990 and 2006, we apply our estimator to recover marginal willingness to pay for
reductions in three of the EPA’s “criteria” air pollutants. Our findings suggest that ignoring bias from
time-varying correlated unobservables considerably understates the benefits of a pollution reduction
policy.
Patrick Bajari
Professor of Economics
University of Minnesota
4-101 Hanson Hall
1925 4th Street South
Minneapolis, MN 55455
and NBER
bajari@econ.umn.edu
Jane Cooley
University of Wisconsin
1180 Observatory Drive
Madison, WI 53706
jcooley@ssc.wisc.edu

Kyoo il Kim
Department of Economics
University of Minnesota
4-129 Hanson Halll
1925 4th Street South
Minneapolis, MN 55455
kyookim@umn.edu
Christopher Timmins
Department of Economics
Duke University
209 Social Sciences Building
P.O. Box 90097
Durham, NC 27708-0097
and NBER
christopher.timmins@duke.edu

1

Introduction

In a hedonic regression, the economist attempts to consistently estimate the relationship
between prices and product attributes in a differentiated product market. The regression
coefficients are commonly referred to as implicit (or hedonic) prices, which can be interpreted
as the effect on the market price of increasing a particular product attribute while holding
the other attributes fixed. Given utility-maximizing behavior, the consumer’s marginal
willingness to pay for a small change in a particular attribute can be inferred directly from
an estimate of its implicit price; moreover, these implicit prices can be used to recover
marginal willingness to pay functions for use in valuing larger changes in attributes (Rosen,
1974).
Hedonic regressions suffer from a number of well-known problems. Foremost among
them, the economist is unlikely to directly observe all product characteristics that are relevant
to consumers, and these omitted variables may lead to biased estimates of the implicit prices
of the observed attributes. For example, in a house-price hedonic regression, the economist
may observe the house’s square-footage, lot size, and even the average education level in the
neighborhood. However, many product attributes such as curb appeal, the quality of the
landscaping and the crime rate may be unobserved by the econometrician. If these omitted
attributes are correlated with the observed attributes, ordinary least squares estimates of
the implicit prices will be biased.
When correlated unobservables are time-invariant and panel data are available, the unobservables can be accounted for with fixed effects. When correlated unobservables vary over
time or when panel data are not available, previous research has relied instead on instrumental variables, regression discontinuity, or other forms of quasi-experimental variation to
avoid this bias. Chay and Greenstone (2005), Greenstone and Gallagher (2008), and Black
(1999) have proposed quasi-experimental approaches to this problem, exploiting either a discontinuity in the application of a regulation or a structural break due to a boundary. If the
regulation or boundary is exogenous and generates large movements in housing attributes,
these methods may be attractive for estimating implicit prices for at least two reasons. First,
they allow the econometrician to remove the bias from omitted variables that may confound
estimates of implicit prices. Second, the identifying assumptions are transparent and the
estimators are simple to implement (often using well-known statistical packages).

1

Why would anyone choose not to adopt one of these straightforward approaches? We
argue that, in many important hedonic applications, this sort of identification cannot be
achieved. First, a source of quasi-randomness that generates exogenous variation in product
characteristics may not be available in a particular application, or may be available, but
only under very strong assumptions. Such is the case, for example, in Chay and Greenstone
(2005), which exploits quasi-random variation in EPA air quality attainment status to recover
the effect of air pollution on housing prices. To use this strategy, they must impose the
assumption that the United States is comprised of a single, unified housing market.
Second, even if a natural experiment is found, implicit prices may not be precisely estimated because the instruments implied by that experiment are weak. Third, a regulatory
discontinuity or structural break caused by a boundary may only identify policy impacts
over a narrow range, rather than over the full range of interest to policy-makers. It would
therefore be useful to have an alternative set of assumptions with which to identify implicit
prices. At a minimum, this alternative approach would provide a way to check the robustness of the results from a quasi-experiment; in other situations, it would provide a viable
estimation strategy when quasi-random variation in the product attribute of interest cannot
be assumed.
In this paper, we propose such a method. It is based on three simple identifying assumptions. The first assumption is that home price in a local market at a point in time can
be written as a function of a home’s attributes. Importantly, we assume that this includes
attributes that are observed by home buyers but not by the economist (i.e., attributes that
are omitted from the regression specification). This assumption is maintained in theoretical
models underlying hedonic regressions including Rosen (1974), Epple (1987), Ekeland, Heckman and Nesheim (2004), Heckman, Matzkin and Nesheim (2003) and Bajari and Benkard
(2005).
In most applications, it seems reasonable to assume that buyers have superior information
about home attributes compared to the economist. For example, it is difficult, if not
impossible, for the economist to directly measure the “curb appeal” of a home. However,
anyone who has purchased a home knows this is an important consideration for many buyers.
Our first assumption implies that curb appeal and other attributes like it are priced by the
market even if the econometrician fails to measure them. As a consequence, the residual
from a hedonic regression contains information that the researcher can use to price home
attributes that she does not directly observe.
2

Our second identifying assumption is a parameterization of the process that determines
the dynamic evolution of the value of the omitted attribute. This assumption turns out
to not be terribly restrictive. In particular, the parameterization can be made increasingly
flexible with more repeat-transactions observations of the same house.
Our third and final identifying assumption is that homebuyers are rational with respect
to their predictions about how the omitted housing attribute evolves over time. Put differently, homebuyers do not make systematic errors in predicting its evolution. The practical
implication of this assumption is that the stochastic innovation in the evolution of the omitted housing attribute is uncorrelated with their current information set. Along with the
first two assumptions, this allows us to construct estimating equations that yield consistent
estimates of implicit prices, even in the presence of time-varying correlated unobservable
attributes.
The intuition behind our estimator is straightforward. Suppose that we observe a home
that is sold in 1998 and again in 2003. Our first assumption allows us to use the 1998
sales price to impute a market value for the omitted housing attributes in 1998. If the
market price was abnormally positive (negative) after controlling for the covariates in the
econometrician’s data set, we would infer that the home had a large positive (negative) value
for characteristics that were not observed by the economist. Our second assumption allows
us to say how the value of omitted housing attributes evolves over time in expectation. From
this process, we can recover the stochastic innovation in the value of the omitted attribute.
Our third assumption provides us with an orthogonality condition based on this stochastic
innovation that is similar to conditions used in well-known GMM estimators in financial
econometrics.
In an appendix, we show that our strategy allows for a flexible functional form by using a
control function approach and casting our problem in the framework of Ai and Chen (2003).
In contrast, approaches that exploit quasi-randomness may frequently require a parsimonious
functional form because instrumental variables do not have adequate variation to identify
models with many parameters.
We admit that our identifying assumptions are an approximation of the way housing markets function in reality. For example, our first assumption does not hold perfectly because
home prices are often determined by negotiation and therefore cannot be explained exactly
by the home’s characteristics. We argue, however, that there are not many opportunities
3

for a free lunch in a housing market with many buyers and sellers. Finding “steals”, where
the asking price significantly understates the value of a home’s attributes, is the exception
rather than the rule. Only rarely can a buyer find twice the home for half the price.
Our third assumption is also an approximation of real world housing markets. It may
fail to hold if certain types of houses earn above-market returns, even after controlling for
observable and unobservable attributes (as measured through prior prices). In that case,
home buyers might be able to predict earning excess returns given information available
today. Unlike many other identifying assumptions used in this literature, however, this is
a possibility for which we can test – our rationality assumption is a necessary (although
by no means sufficient) condition for housing market efficiency as described by Case and
Shiller (1989). While their test for housing market efficiency is therefore an overly stringent
requirement for our homebuyer rationality assumption to hold, we can use it to determine
if our assumption is valid.
As an application of our approach, we consider the value individuals place on a marginal
improvement in air quality, as revealed by their home buying decisions. In particular, we
analyze three of the EPA’s “criteria pollutants” (i.e., pollutants used by the EPA in setting
emissions regulations) – particulate matter (PM10), sulfur dioxide (SO2), and ground-level
ozone (O3) – all of which are known to have adverse health consequences and impose aesthetic
costs. Importantly, we expect there to be many more salient determinants of individual
housing choice that our data do not describe. There is, therefore, good reason to be
concerned about omitted variables bias. If changes in pollution are correlated with changes
in these omitted variables, a fixed-effect approach still gives biased estimates of the implicit
prices.
Using data describing housing transactions in California’s Bay Area between 1990 and
2006, we show evidence in support of the hypothesis that the market is efficient, providing
support for our rationality assumption. Using our estimator, we recover implicit prices for
the three criteria air pollutants described above. In contrast to simple cross-sectional or
fixed-effect estimators, marginal willingnesses to pay for a reduction in all three pollutants
(considered individually or together) are all statistically significant, have the expected sign,
and are on the high-end of the range of estimates found elsewhere in the literature. Considered together, PM10, SO2, and O3 exhibit house price elasticities of -0.07, -0.16, and -0.60,
respectively. We contrast these results with those from a simple fixed-effects model and
find that controlling for time-varying unobservables appears to be extremely important for
4

all three pollutants.
This paper proceeds as follows. Section 2 describes our estimator of implicit prices in a
simple parametric model. We generalize that model in the Appendix. Section 3 describes
the data that we use for our application. Section 4 presents results from our model, and
compares them to results from traditional cross-sectional and fixed-effects specifications.
Section 5 concludes.

2

Model: Estimating Implicit Prices

In this section, we consider the traditional hedonic framework – a model of demand in
a differentiated products market in which a consumer maximizes utility. The primary
application we have in mind is housing, however, many of the methods we propose could
carry over to other differentiated product markets where our assumptions are maintained.
We treat the consumer as being forward looking in her decision-making, but unconstrained
by adjustment costs; in a model of home buying without adjustment costs, forward-looking
agents maximize utility with respect to current house attributes (so that the model mimics
the standard static hedonic framework).
Houses, indexed by j = 1, ..., J, can be completely described by a finite vector of attributes. Let xj denote a 1 by K vector of attributes such as the number of square feet, the
lot size, or the year built, all of which are commonly observed by the econometrician and
the consumer. In addition, ξj denotes a scalar that captures an omitted attribute of the
house that is observed by the consumers, but not by the economist. For instance, while
data sets on housing are quite detailed, they typically do not report features such as the
curb appeal of a home or its state of repair, both of which may be important to buyers. For
notational and expositional simplicity, we require these omitted attributes to be captured in
a single product attribute, ξj , though many of our results allow for a more general error term
with vector-valued omitted attributes. To summarize, from the perspective of consumers
i = 1, ..., I, product j can be completely summarized by the 1 by (K + 1) vector (xj , ξj ).
Equilibrium prices can be written as pj = p(xj , ξj ). We will refer to p as the hedonic
price function. This is a map between the product characteristics (xj , ξj ) and the price of
good j (pj ). The hedonic price function p is determined in equilibrium by the interactions

5

of buyers and sellers. Bajari and Benkard (2005) show that consumer rationality plus mild
restrictions on consumer preferences imply that p is a function, not a correspondence. As
discussed in the introduction, the existence of the function p is our first key assumption
derived from economic theory.
In empirical applications, the economist is generally concerned with estimating p(xj , ξj )
using data on the observed prices, pj and characteristics, xj . Hedonic price regressions are
commonly conducted assuming that E [ξj |xj ] = 0 , that is, the omitted product attributes
are mean independent of the observed attributes. This assumption is frequently criticized
in the literature, going back to Small (1975). Returning to our earlier example, suppose
that ξj reflects the curb appeal of a home. The above moment condition would imply that
the expected value of curb appeal is the same for small homes in low income neighborhoods
as it is for million dollar homes in exclusive neighborhoods. However, in practice we expect
higher values of desirable omitted attributes to be positively correlated with higher values of
desirable observed attributes. Thus, failure to correct for this omitted variable would bias
upward estimates of implicit prices of desirable attributes.
The only proposed solutions to this problem rely on quasi-random sources of variation
such as breaks in geography (Black, 1999) or discontinuities in the application of regulations
(Chay and Greenstone, 2004; Greenstone and Gallagher, 2007). While these are important
contributions to the empirical literature, they may face limitations like those discussed in
the introduction.
We propose an alternative approach to estimating implicit prices. Begin by considering
cases in which there are data on repeat sales so that the price of home j is observed in several
time periods among t = 1, 2, ..., T . Note that the price does not need to be observed in all
time periods. Our empirical strategy will require as few as two sales for each house. To
simplify notation, consider the case where there is a single observed, time-varying characteristic, xj,t , which enters linearly into the hedonic price function. All of our results apply in
the more general case where this is a vector of characteristics and where the characteristics
enter nonparametrically; this situation is described in the Appendix (we consider observed
attributes that do not vary over time in Section 2.2). Suppose the system of hedonic pricing

6

equations is:
ln(pj,1 ) = α1 + β1 xj,1 + ξj,1
..
.

(1)

ln(pj,T ) = αT + βT xj,T + ξj,T .
Since we can observe prices of homes only when they actually transact, we have an unbalanced panel where some of ln(pjt )’s are never observed in (1).
In what follows, we assume that agents in the market are uncertain about the evolution
of ξj,t . This uncertainty could come from one of two sources. The first is that the omitted
characteristics themselves change over time periods. For example, a noisy neighbor may
move in next door to home j or an infestation may make it necessary to cut down all the large
trees in home j’s neighborhood. The second is that the implicit price of even time-invariant
omitted attributes could change over time. Both of these situations would look the same
from the point of view of the hedonic model.
In our model, we assume that the omitted product attribute evolves according to a firstorder Markov process,1
ξj,t0 = γ(t, t0 )ξj,t + η(j, t, t0 ).
(2)
This is our second key assumption. Here γ(t, t0 )ξj,t is the expected value of the omitted
attribute at time t0 conditional on its value at time t, and η(j, t, t0 ) is the stochastic innovation
in the omitted attribute. Later in the description of the model we illustrate that this could
be, for example, extended to a second-order Markov process if the researcher has access to
three repeat sales observations for each house. In our application, we limit our attention to
houses that sell twice.
Our third assumption requires that
E[η(j, t, t0 )|It ] = 0.

(3)

where It denotes the information available to the buyer at time t. In words, given all the
information available at time t, homebuyers predict that ξj,t0 will equal γ(t, t0 )ξj,t in expectation. Note that this condition is required if individuals are to be unable to use information
1

We assume that the unconditional mean of the omitted attribute equals to zero, E[ξj,t ] = 0 without loss
of generality because if not, the intercept in the hedonic pricing equation (1) can subsume the nonzero mean.

7

in It to predict excess appreciation rates for particular houses, which is a necessary condition for full informational efficiency of the housing market as described by Case and Shiller
(1989). While we do not require full informational efficiency of the housing market for our
estimator, we can use the Case and Shiller (1989) test of informational efficiency as an overly
stringent test of our third assumption. We do this in Section 4.1.

2.1

Lagged Prices and Consistent Estimation

We rewrite our hedonic price function for period t0 using information from the previous sale
of house j (i.e., in period t) to eliminate ξj,t0 . In particular, rewriting ξj,t0 as a function of
ξj,t using (2) and substituting ln(pj,t ) − αt − βt xj,t for ξj,t , we get,
ln(pj,t0 ) = αt0 + βt0 xj,t0 + ξj,t0

(4)

= αt0 + βt0 xj,t0 + γ(t, t0 ) [ln(pj,t ) − αt − βt xj,t ] + η(j, t, t0 )
= (αt0 − γ(t, t0 )αt ) + γ(t, t0 ) ln(pj,t )
−γ(t, t0 )βt xj,t + βt0 xj,t0 + η(j, t, t0 ).
We note that xj,t0 could be correlated with η(j, t, t0 ), for example, the innovation in “curb
appeal” between t and t0 might be correlated with an observable characteristic such as
test scores in local public schools. Thus, a regression based on (4) produces inconsistent
estimates of the hedonic price function. For the parametric model of (4), we can use the
2SNLS approach to recover parameters under our maintained assumption of (3). In the first
stage we replace xj,t0 with its projected value based on xj,t and other observed variables wj,t
in the information set It using
xj,t0 = π0 (t, t0 ) + π1 (t, t0 )xj,t + π2 (t, t0 )wj,t + vj,t,t0 ,

E[vj,t,t0 |It ] = 0.

The first stage uses the assumption that the innovation in the observed attributes is orthogonal to time t information.
We show in the appendix that by exploiting the process that describes the evolution of
xj,t over time and using a control function approach, we can still obtain consistent estimates
of the key structural parameters even when the characteristics enter nonparametrically in
the hedonic pricing equations.

8

Intuitively, our approach uses the information in lagged prices, pj,t to impute the lagged
value of the omitted attribute. For example, if the price for home j is unusually high after
controlling for xj,t , we would infer that ξj,t = ln(pj,t ) − αt − βt xj,t is also large. This is
where our first economic assumption – that prices reflect attributes that are observed by
consumers – has “bite”. We also assume that the stochastic innovations (vj,t,t0 ) in the
observed attributes are orthogonal to current information. Furthermore, after controlling
for It , the stochastic innovation in the omitted attribute, η(j, t, t0 ), is assumed to be mean
zero. If these assumptions were not true, it would be possible to earn excess returns in the
housing market.

2.2

Time-invariant Covariates and Model Restrictions

When houses have only time-invariant attributes, some of the parameters of the model
described above are not identified without further restrictions. To see this, replace xj,t with
the time-invariant covariate zj in (4):
ln(pj,t0 ) = (αt0 − γ(t, t0 )αt ) + γ(t, t0 ) ln(pj,t ) − γ(t, t0 )βt zj + βt0 zj + η(j, t, t0 ).
We cannot therefore identify βt0 separately from βt , i.e., a multicollinearity problem. Adding
the additional restrictions that αt = α0 and βt = β0 for all t, the above equation becomes
ln(pj,t0 ) = α0 (1 − γ(t, t0 )) + γ(t, t0 ) ln(pj,t ) + (1 − γ(t, t0 ))β0 zj + η(j, t, t0 ).
With these restrictions, we can identify γ(t, t0 ) from the coefficient on ln(pj,t ), α0 from the
constant term, and β0 from the coefficient on zj . An alternative approach is to normalize
β1 = 1. Then βt , t > 1 is identified recursively up to this normalization using the fact that
−γ(t, t0 )βt + βt0 can be recovered in each period.
Imposing some structure on γ(t, t0 ) yields a set of over-identifying restrictions. For
example, we can let γ(t, t0 ) = γ(t, e
t)γ(e
t, t0 ) for e
t between t and t0 . Even with time-varying
x’s, the above restrictions may be useful to obtain more stable and robust estimates when
the variation over time is relatively small.

9

2.3

Simple Parametric Model with Two Transactions

Often it may be the case that only two transactions per house are available in the data (as in
our application). Thus, we focus on the two-transaction setting as a straightforward illustration of how our estimator can be applied in many contexts. We describe the generalization
in the Appendix.
Assuming that the implicit prices are time-invariant βt = β for all t, the model simplifies
to
ln(pj,tb ) = αtb − γ(ta , tb )αta + γ(ta , tb ) ln(pj,ta ) + γ(ta , tb )βxj,ta

(5)

+βxj,tb + η(j, ta , tb ).
where ta denotes the time period of the first sale and tb denotes the time period of the second
sale. The estimation can proceed as a simple application of the two-stage nonlinear least
squares (2SNLS). We can rewrite (5) as
xj,tb = π0 (ta , tb ) + π1 (ta , tb )xj,ta + π2 (ta , tb )wj,ta + vj,ta ,tb

(6)

ln(pj,tb ) = αtb − γ(ta , tb )αta + γ(ta , tb ) ln(pj,ta ) + γ(ta , tb )βxj,ta
+β (π0 (ta , tb ) + π1 (ta , tb )xj,ta + π2 (ta , tb )wj,ta ) + uj,ta ,tb
where uj,ta ,tb = βvj,ta ,tb + η(j, ta , tb ). E[uj,ta ,tb |Ita ] = 0 because vj,ta ,tb is the projection error
in the first step and E[η(j, ta , tb )|Ita ] = 0 by assumption (3).
In (6) wj,t denotes other observable variables in It , including pj,ta . Importantly, we do
not need wj,t to include any additional information. In other words, exclusion restrictions
are not needed to identify the key structural parameters (γ(ta , tb ), β, and αtb − γ(ta , tb )αta ),
as can be seen in (6). Our key identification condition is E[uj,ta ,tb |Ita ] = 0. This condition
differs considerably from the standard approach to estimating hedonic models, which rely
instead on E [ξj,t |xj,t ] = 0, i.e., that omitted attributes are conditionally mean independent
of observed attributes, as discussed above.
We let θ(ta , tb ) = (αtb − γ(ta , tb )αta , γ(ta , tb ), β)0 . The coefficients in the second step
equation in (6) are nonlinear functions of θ(ta , tb ) where π0 (ta , tb ), π1 (ta , tb ), and π2 (ta , tb )

10

are obtained in the first step. We obtain estimates by solving
π
b(ta , tb ) = argminπ(ta ,tb )
b a , tb ) = argminθ(t ,t )
θ(t
a b

XJ
j=1
XJ
j=1

{xj,tb − π0 (ta , tb ) − π1 (ta , tb )xj,ta − π2 (ta , tb )wj,ta }2
bj,tb ; θ(ta , tb ))}2
{ln(pj,tb ) − g(ln(pj,ta ), xj,ta , x

where x
bj,tb = π
b0 (ta , tb ) + π
b1 (ta , tb )xj,ta + π
b2 (ta , tb )wj,ta and
g(ln(pj,ta ), xj,ta , x
bj,tb ; θ(ta , tb )) = αtb − γ(ta , tb )αta + γ(ta , tb ) ln(pj,ta )
+ γ(ta , tb )βxj,ta + βb
xj,tb .
We can also impose some parametric restrictions on π(ta , tb )’s and γ(ta , tb )’s in the above.
Note that the first step estimation contributes to the asymptotic variance of the second
step estimators. We obtain correct standard errors by applying Murphy and Topel (1985).
Denote
√

J(b
π (ta , tb ) − π(ta , tb )) →d N (0, V (ta , tb ))
∂
G(·; θ(ta , tb )) =
g(·; θ(ta , tb ))
∂θ(ta , tb )
Ω0 (ta , tb ) = E[η 2 (·, ta , tb )G(·; θ(ta , tb ))G(·; θ(ta , tb ))0 ]

Then, we have

Q0 (ta , tb )

=

E [G(·; θ(ta , tb ))G(·; θ(ta , tb ))0 ]

Q1 (ta , tb )

=

E [G(·; θ(ta , tb ))β(1, xj,ta , wj,ta )]

√

(7)

b a , tb ) − θ(ta , tb )) →d N (0, Σ(ta , tb ))
J(θ(t

where
Σ(ta , tb ) = Q0 (ta , tb )−1 [Ω0 (ta , tb ) + Q1 (ta , tb )V (ta , tb )Q1 (ta , tb )0 ] Q0 (ta , tb )−1 .
We obtain a consistent estimate of the heteroskedasticity robust variance matrix Σ(ta , tb )

11

using the following sample counterparts of (7):

−1  P
J
1
0
0
2
(1,
x
,
w
)
(1,
x
,
w
)
(1,
x
,
w
)
(1,
x
,
w
)
v
b
j,ta
j,ta
j,ta
j,ta
j,ta
j,ta
j,ta
j,ta
j=1
j=1 j,ta ,tb
J
 P
−1
,
× J1 Jj=1 (1, xj,ta , wj,ta )0 (1, xj,ta , wj,ta )

 P
J
1
Vb (ta , tb ) =

b 0 (ta , tb ) =
Ω

J

J
1X 2
b a , tb ))G(·; θ(t
b a , tb ))0 ,
ηb (j, ta , tb )G(·; θ(t
J j=1

b a , tb )),
ηb(j, ta , tb ) = ln(pj,tb ) − g(ln(pj,ta ), xj,ta , xj,tb ; θ(t
J
1X
b a , tb ))G(·; θ(t
b a , tb ))0 ,
b
G(·; θ(t
Q0 (ta , tb ) =
J j=1
J
1X
b a , tb ))β(1,
b xj,ta , wj,ta ), and
G(·; θ(t
J j=1
h
i
−1 b
0 b
b
b
b
b
b
Σ(ta , tb ) = Q0 (ta , tb )
Ω0 (ta , tb ) + Q1 (ta , tb )V (ta , tb )Q1 (ta , tb ) Q0 (ta , tb )−1 .

b1 (ta , tb ) =
Q

3

Data

We demonstrate the role of efficient housing markets in controlling for time-varying, correlated unobservables by measuring the marginal willingness to pay to avoid exposure to three
of the EPA’s “criteria” air pollutants – particulate matter (PM10), sulfur dioxide (SO2),
and ground-level ozone (O3).2 Without extremely detailed data describing the evolution
of neighborhood attributes, correlated unobservables are likely to play an important role in
such an application.
We consider housing transactions from California’s Bay Area (specifically, Alameda, Contra Costa, Marin, San Francisco, San Mateo, and Santa Clara counties) over the period 19902006. These data were purchased from the DataQuick Corporation and contain information
describing the universe of housing transactions (i.e., buyers’, sellers’ and lenders’ names,
dates, loan amounts, and transaction prices) and the houses that transacted (i.e., square
footage, lot size, year built, number of rooms, and how many of those rooms are bedrooms
or bathrooms). Important for our purposes, the data also provide the exact street address
2

The list of criteria pollutants also includes nitrogen oxides, lead, and carbon monoxide. This list forms
the basis for the EPA’s primary (health) and secondary (environmental and aesthetic) emissions reduction
targets. Of the six criteria pollutants, particulate matter and ground-level ozone are commonly considered
to pose the greatest health threat. (http://www.epa.gov/air/urbanair)

12

of each home, with which we can impute pollution measures using data from thirty-seven
monitors located throughout the Bay Area.

3.1

Housing Data

DataQuick reports a house’s attributes as they were measured at the time of the last sale
entered in our data. Because houses may have been altered (either improved or suffered
some severe damage), these attributes may not be applicable to all observed transactions.
We therefore carry-out a number of data cuts to avoid this problem. First, we consider the
appreciation rate exhibited by each house over each pair of sales that we observe in the data.
From this, we deduct the average appreciation rate for all houses that sold in the same pair
of years. We then drop the houses in the top and bottom 10% of the resulting distribution
of normalized appreciation rates. As such, we eliminate any house that appreciated or
depreciated at a very high rate relative to other houses on the market at the same time.
Second, we drop problematic observations – for example, all observations where “year
built” is missing, or where “year built” comes after the transaction date (signaling a purchase
of land on which a house was then constructed). We also drop all properties that fail to
report a transaction price or a latitude and longitude, houses with outlier attributes, and
all observations with housing attributes that appear to be coded with error – in particular,
houses where the number of bedrooms or bathrooms is greater than five. We also drop any
house more than 5,000 square feet in size, or which sits on more than a 70,000 square-foot
lot. We finally drop all homes that sell more than two times in the seventeen year period we
are considering. This is primarily for the sake of convenience, as it allows us to implement
our estimator using the simple specification described in Section 2.3. In the end, these cuts
leave us with data describing repeat transactions for 96,626 unique housing units. Table 1
summarizes the attributes of these houses.
Figure 1 describes the median transaction price in each year of our data. This makes
clear that there were periods of (slow) depreciation and (rapid) appreciation in the Bay Area
over the period we are considering.

13

Table 1: House Attributes (N=96626)

Lot size
Square feet
No. of bathrooms
No. of bedrooms
No. of rooms
Year built

Mean
6,922
1709
2.109
3.233
7.036
1966

Std Dev
5,519
620
0.689
0.831
1.819
22.72

Minimum
1,000
500
1
1
1
1868

Maximum
69,809
4,994
5
5
15
2005

Figure 1: Median Transaction Price by Year With 25th and 75th Percentiles

800000
700000
600000

Price

500000
400000
300000
200000
100000

19
90
19
91
19
92
19
93
19
94
19
95
19
96
19
97
19
98
19
99
20
00
20
01
20
02
20
03
20
04
20
05
20
06

0

Year

3.2

Air Quality Data

We measure individuals’ average marginal willingness-to-pay (MWTP) to avoid three of the
EPA’s major criteria air pollutants.3 The MWTP is a key determinant of the benefits of any
new air pollution regulation, such as the Clean Air Act Amendments of 1990 that allowed
for trading in permits to emit sulfur dioxide. The other main source of value from a new air
pollution regulation comes from avoided mortality; this is typically measured by ascribing
the value of a statistical life (VSL) to each death avoided by the policy.
3

Information on the health and aesthetic costs of each of the pollutants discussed in this section can be
found at the EPA’s web-site (http://www.epa.gov/air/).

14

We first consider PM10, which denotes particles less than ten micrometers in diameter. These particles (especially those smaller than 2.5 micrometers) can travel deep into
the lungs and even into the bloodstream. This can lead to a variety of health problems,
including asthma, chronic bronchitis, and heart attack.4 Fine particles also reduce visibility,
and prolonged exposure to PM10 can damage structures and stain building materials. While
not necessarily as important as health effects from a welfare perspective, these aesthetic effects may have a marked impact on housing prices. We consider the average annual PM10
concentration, which is measured in micrograms per cubic meter (µg/m3). PM10 concentration at each house is imputed with an inverse-squared-distance weighted average of the
concentrations measured at each of the thirty-seven monitoring stations in the Bay Area.
Our second pollutant is sulfur dioxide (SO2). The primary health consequences of sulfur
dioxide come in the form of breathing difficulties, especially for those who suffer from asthma.
Like PM10, SO2 can create haze that impairs visibility. Acid rain (or acid fog), which is
produced when SO2 reacts with water and other chemicals in the air, will damage building
materials and kill vegetation. SO2 (and the remainder of our pollutants) is measured in parts
per million (ppm), and we use the maximum one-hour observation observed over the course
of the year at each monitor (imputed for each house again using an inverse-squared-distance
weighted average of all monitors’ observations). The maximum one-hour observation is an
important figure used by the California Air Resources Board in determining whether or not
an air district is in compliance with state regulations.
Third, we consider ground-level ozone (O3). Similar to smog, ozone can cause a variety of severe respiratory problems including coughing, wheezing, breathing pain, aggravated asthma, and increased susceptibility to bronchitis. Exposure to peak concentrations
of ground-level ozone can have acute effects, and repeated exposure to even moderate levels
can lead to permanent lung damage. In addition to its health consequences, O3 has detrimental impacts on the growth of vegetation (particularly trees and other plants in urban
settings), which can have important aesthetic consequences for housing prices.
4

The Harvard ”Six City” Study (Dockery et al., 1993) established many of these effects, which have
been confirmed by numerous studies since that time. Lin et al., 2002; Norris et al., 1999; Slaughter et al.,
2003; and Tolbert et al., 2000) have demonstrated detrimental effects, particularly for the young and elderly
suffering from asthma. Hong et al., 2002; Tsai et al., 2003, and D’Ippoliti et al., 2003 provide evidence of
increased risk of heart attack and stroke. Ghio et al. 2000 finds evidence of lung tissue imflammation, while
Pope et al., 2002 finds increased risk of lung cancer. More recently, Samet et al., 2004 has found evidence of
increased risk of heritable diseases from exposure to fine particulates.

15

Figure 2 describes the time path of three pollution measures (along with nitrogen oxides)
over the sample period. To make the numbers more easily interpretable on the same graph,
we express PM10 pollution in (µg/m3)*(1/1000).

4

1

2

1

1
8

0
0

6
4

0

2

0

6

5

2

0

0

4

2

0

0

3

2

0

0

2

2

0

0

1

0
0
2

2

0

0

0

9

0
2

0

9

8

9
1
O

3

6

7

9
9
1
2

O

S

1

9

9

5

9
9
1

1

P

M

0

4

1

9

9

3

1

9

9

2

1

9

9

1

9

9

9
1

9
1

1

9

9

0

0

.

0

.

0

.

0

.

0

.

0

.

0

.

0

Figure 2: Median One Hour Maximum Pollution Concentrations

Table 2 describes the correlations across all three pollutants observed at the time of every
transaction in our sample. While PM10 and SO2 are fairly highly correlated, O3 has a much
lower correlation with SO2 and is even negatively correlated with PM10. This is consistent
with the intuition that O3, which is formed in a complicated photochemical process, is more
affected by weather patterns and is not restricted to the more polluted places. Although
collinearlity may be an issue for separately identifying the effects of PM10 and SO2, we
are still able to estimate a model with all three pollutants appearing simultaneously. In
addition, we measure the MWTP for each pollutant considered individually.
Table 2: Correlations of Pollutants

PM10
SO2
O3

PM10
1.000
0.516
-0.097

SO2

O3

1.000
0.217 1.000

A final feature of these pollutants that we do not address is the fact that the disutility
16

from each may be a complicated nonlinear function of the concentrations of all the other
pollutants. This is a result of the photochemical processes through which they interact.
See Muller, Tong, and Mendelsohn (2009) for an example of research that considers these
interactions.

4

Results

4.1

Testing the Efficient Housing Market Hypothesis

Before applying our estimation strategy, we provide empirical evidence in support of our
identifying assumptions on homebuyer rationality, a limited form of the efficient housing
market assumption, by approximating Case and Shiller’s (1989) test of full informational
efficiency for the subset of houses that sold 3 times over our sample period. In particular,
we check to see whether or not observable attributes in the information set at time t have
any explanatory power for price changes after that time. This is a stronger test than
we require. In particular, our estimator allows for predictable changes in observables and
unobservables based on their current values to influence price changes. However, if we find
that the predictive power of current observables is weak, statistically and/or economically,
it bolsters our assumption that E[η(j, t, t0 )|It ] = 0.
Begin by letting ta , tb , and tc denote the times at which sales are observed for houses in our
data set that transact three times, ta < tb < tc . a, b, and c can be different for each of these
ln(pj,tc )−ln(pj,tb )
on the average return of previous
houses. We regress the annualized return,
tc −tb
sales (which is allowed to differ across counties and years), housing attributes, pollutants,
and county fixed effects.5 While many of the coefficients are statistically significant, their
economic magnitudes in terms of marginal returns are negligible. Table 3 summarizes the
results.
To give a sense of the extent to which knowing housing attributes can help to generate
excess returns, we calculate dollar amounts of excess returns from the estimation results
in Panel A of Table 3 under the scenario that the previous average return is higher by 10
5

The average return from previous sales is obtained as the fitted values from the regression of ln(pj,tb ) −
ln(pj,ta ) on dummies indicating the year of the first and the second sales and the county in which the house
is located.

17

Table 3: Efficient Market Hypothesis(N=16656)
A. Regression of Annualized Return on House Attributes and Average Return
Avg. ret. Lotsize
Sqft
# Bath # Bed
PM10
SO2
Coeff
0.0205
0.0000 -0.0000 -0.0024 0.0077
-0.0040
1.0785
[2.35]
[1.29]
[-13.66] [-1.67]
[8.56]
[-4.80]
[6.78]
B. Excess Returns Per Year in Dollar Amounts
Purchase Avg. ret. Lotsize
Sqft
# Bath # Bed
PM10
SO2
3
Price
10% ↑
100 sf ↑ 100 sf ↑
1↑
1↑
2 µg/m ↑ 5 ppb ↑
0.4M
820
13
-916
-953
3,080
-3,241
2,157
1M
2,050
33
-2,290
-2,382
7,699
-8,103
5,393
2M
4,100
66
-4,580
-4,764 15,398
-16,206
10,785

O3
0.2496
[1.03]
O3
10 ppb ↑
998
2,495
4,991

t-statistics are reported in brackets and calculated from clustered robust standard errors, clustered by
county. The dollar amounts in panel B are calculated from the estimates in panel A, based on purchasing
prices of .4M,1M and 2M respectively for the given change in the observed attribute.

percent, the lot size is larger by 100 square feet, the home size is larger by 100 square feet,
the number of bathrooms is larger by 1, the number of bedrooms is larger by 1, and the three
pollutant measures PM10, SO2, and O3 are higher by 2 µg/m3 , 5 ppb, 10 ppb, respectively.
We also assume that the home prices at the time of purchase are 0.4 million, 1 million, and 2
million dollars, respectively. The results are reported in Panel B of Table 3. We see that the
amounts are small compared to the home prices (i.e., less than 1%). For example, when the
home price is 1 million at the time of purchase, one would make excess returns of 33 dollars
per year by purchasing a home with its lot size larger by 100 square feet and would earn
7,699 dollars of additional annual returns by purchasing a home with five bedrooms instead
of four bedrooms. One can interpret calculations of excess returns in other cases similarly.
These results suggest that information available at time t cannot be used to affect, in an
economically significant way, the returns derived from a house purchase decision. This implies that information available at that time is not particularly useful in predicting η(j, t, t0 );
hence, supporting our assumption that E[η(j, t, t0 )|It ] = 0.

18

4.2

The Marginal Willingness-to-Pay to Avoid Air Pollution

In our application, we allow Bay Area housing prices to be determined by different hedonic
price functions in each of three separate periods: (1) 1990-1994, (2) 1995-2000, and (3) 20012006. These periods correspond (roughly) to periods of depreciation, appreciation, and very
rapid appreciation in this housing market, as shown in Figure 1. They also correspond to
periods of changing enforcement of air pollution standards, as the Bay Area moved from
non-attainment to attainment and back to non-attainment with respect to federal ozone
regulations.
We report results for three different econometric models. First, we estimate a simple
cross-sectional model for each of the three time periods in our data set. This approach
does nothing to control for omitted attributes (time-varying or time-invariant) that may be
correlated with pollution:
Cross-Sectional Model
ln(pj,1 ) = α1 + x0j,1 β1 + zj0 φ1 + ξj,1 ,
ln(pj,2 ) = α2 + x0j,2 β2 + zj0 φ2 + ξj,2 ,
ln(pj,3 ) = α3 + x0j,3 β3 + zj0 φ3 + ξj,3 ,
where the subscripts {1, 2, 3} correspond to each of the three time periods, x0t ≡ {P M 10, SO2, O3}
captures the pollutants and z includes the housing attributes described in Table 1 and a vector of county fixed effects.
Second, we estimate a house fixed-effect model that uses the panel aspect of the data
to control for time-invariant omitted attributes that could potentially be correlated with
pollution. We constrain the derivative of ln(P ) with respect to each pollutant to be constant
over time. This constraint allows us to recover an implicit price for pollution from the fixedeffect specification. We allow the marginal effects of other housing attributes to vary over
time, meaning that we can only recover the change in the implicit prices of these attributes.

19

House Fixed-Effect Model
ln(pj,3 ) − ln(pj,2 ) = ρ2,3 + (xj,3 − xj,2 )0 β + zj0 χ2,3 + uj,2,3 ,
ln(pj,3 ) − ln(pj,1 ) = ρ1,3 + (xj,3 − xj,1 )0 β + zj0 χ1,3 + uj,1,3 ,
ln(pj,2 ) − ln(pj,1 ) = ρ1,2 + (xj,2 − xj,1 )0 β + zj0 χ1,2 + uj,1,2 .
where ρt,t0 = (αt0 − αt ) and χt,t0 = (φt0 − φt ).
Finally, we estimate a constrained specification of the model described in equation (6).
We restrict γ(1, 3) = γ(1, 2)γ(2, 3), and β1 = β2 = β3 = β. Constraining the marginal effect
of pollution on price to be constant over time assists with model identification and makes the
results more directly comparable to those of the house fixed-effect model. ψt,t0 replaces the
intercept in equation (4), ψt0 ,t = αt0 − γ(t, t0 )αt , and zj0 δt,t0 controls flexibly for any attributes
that do not vary over time.6 This implies the following specification:
Efficient Housing Market Model
ln(pj,3 ) = ψ2,3 + γ(2, 3) ln(pj,2 ) − x0j,2 γ(2, 3)β + x0j,3 β + zj0 δ2,3 + ηj,2,3 ,
ln(pj,3 ) = ψ1,3 + γ(2, 3)γ(1, 2) ln(pj,1 ) − x0j,1 γ(2, 3)γ(1, 2)β + x0j,3 β + zj0 δ1,3 + ηj,1,3 ,
ln(pj,2 ) = ψ1,2 + γ(1, 2) ln(pj,1 ) − x0j,1 γ(1, 2)β + x0j,2 β + zj0 δ1,2 + ηj,1,2 .
Depending upon the time periods a particular house sells, one of these three equations will
apply to it. The first equation applies when t = 2 and t0 = 3, the second equation applies
when t = 1 and t0 = 3, and the third equation applies when t = 1 and t0 = 2.
Given the linearity of the hedonic pricing equation, we implement a 2SNLS approach to
deal with the endogeneity of xt0 , as described in Section 2.1. In particular, we first estimate
the following regression equations using all the exogenous and predetermined variables as
instruments:
xj,3 = Π0 Y earj + Π1 (3, 2)xj,2 + Π2 (3, 2) ln(pj,2 ) + Π3 (3, 2)zj + Π4 (3, 2)Countyj + vj,2,3 ,
xj,3 = Π0 Y earj + Π1 (3, 1)xj,1 + Π2 (3, 1) ln(pj,1 ) + Π3 (3, 1)zj + Π4 (3, 1)Countyj + vj,1,3 ,
xj,2 = Π0 Y earj + Π1 (2, 1)xj,1 + Π2 (2, 1) ln(pj,1 ) + Π3 (2, 1)zj + Π4 (2, 1)Countyj + vj,1,2 .
6

In particular, if zj0 φt represents the contribution of time-invariant attributes zj to ln pj,t , then zj0 δt,t0 =
− γ(t, t0 )φt ). For convenience, we label δt,t0 = φt0 − γ(t, t0 )φt .

zj0 (φt0

20

where County denotes a vector of county dummies and Y ear denotes a vector of year dummies indicating t0 . The first equation applies to houses that sell in periods t = 2 and t0 = 3,
the second equation applies to houses that sell in periods t = 1 and t0 = 3, and the third
equation applies to houses that sell in periods t = 1 and t0 = 2. We then use the two sets
of equations described above and estimate using two-stage nonlinear as described in Section
2.3.7
Table 4: Implicit Price of Pollution: Cross-Sectional Estimates
Period 1
Period 2
§
‡
Coeff
Elast. WTP
Coeff
Elast.§ WTP‡
A. Regressions Controlling for All Pollutants
PM10
-0.0022 -0.0529 -65.4
0.0162 0.3827 473.1
(µg/m3) [0.0071]
[0.0088]
SO2
4.0666 0.1422 118.9 -1.1682 -0.0409 -34.2
(ppm)
[1.6431]
[0.9537]
O3
-3.0468 -0.3129 -89.1 -2.3021 -0.2364 -67.3
(ppm)
[1.7886]
[1.9823]
B. Separate Regression for Each Pollutant
PM10
0.0112 0.2648 327.4
0.0230 0.5431 671.4
(µg/m3) [0.0011]
[0.0097]
SO2
1.9838 0.0694
58.0
-0.0877 -0.0031
-2.6
(ppm)
[0.5540]
[0.6978]
O3
-1.8937 -0.1945 -55.4 -2.8659 -0.2943 -83.8
(ppm)
[0.2057]
[1.9288]
N
47,909
74,399

Coeff

Period 3
Elast.§ WTP‡

-0.0328 -0.7755
[0.0084]
-4.8399 -0.1693
[1.8254]
-2.1635 -0.2222
[0.6847]
-0.0414 -0.9792
[0.0101]
-6.0069 -0.2101
[1.5099]
-3.4630 -0.3556
[1.7408]
75,862

-958.8
-141.5
-63.3

-1210.5
-175.7
-101.3

Heteroskedasticity robust standard errors clustered by counties in brackets. Controls for lot size, square
feet, number of rooms, number of bedrooms, number of bathrooms, year built and county fixed effects also
included but not reported. § Elasticities calculated at medians of pollutants, which are 23.66 for PM10,
0.0350 for SO2, 0.1027 for O3. ‡ Willingness to pay calculated for marginal 1 µg/m3 change in PM10 and 1
ppb change in other pollutants, annualized at rate of 0.07 for median house price of $ 417,800.

Table 4 reports the results of a cross-sectional specification that considers all three pollutants simultaneously (panel A), along with specifications that consider each pollutant individually (panel B). For many pollutant-year combinations, MWTP exhibits the counterintuitive (i.e., positive) sign. Only the implicit price of O3 consistently has the expected
7

Note that other observable attributes of the house (in zj ) are time-invariant because we only observe
them at the time of last purchase, so we do this correction only for the pollutants.

21

Table 5: Implicit Price of Pollution: Fixed-Effect Estimates (N=76,405)
All
Coeff
PM10 (µg/m3) 0.0047
[0.0003]
SO2 (ppm)
-1.9142
[0.0916]
O3 (ppm)
-3.1038
[0.0677]

Pollutants†
Elast.§ WTP‡
0.1122 138.7
-0.0669

-56.0

-0.3188

-90.8

Single Pollutant†
Coeff
Elast.§ WTP‡
0.0056 0.1335 165.0
[0.0003]
-2.1023 -0.0735 -61.5
[0.0909]
-3.3898 -0.3481 -99.1
[0.0674]

Heteroskedasticity robust standard errors in brackets. Controls for lot size, square feet, number of rooms,
number of bedrooms, number of bathrooms, year built and county fixed effects also included but not
reported. † The single pollutant regressions are run separately for each pollutant, whereas the other
estimates are run with all pollutants in a single regression. § Elasticities calculated at medians of
pollutants, which are 23.66 for PM10, 0.0350 for SO2, 0.1027 for O3. ‡ Willingness to pay calculated for
marginal 1 µg/m3 change in PM10 and 1 ppb change in other pollutants, annualized at rate of 0.07 for
median house price of $ 417,800.

Table 6: Implicit Price of Pollution: Efficient Markets (N=76,405)
All Pollutants†
Coeff
PM10
-0.0030
(µg/m3) [0.0004]
SO2
-4.6987
(ppm)
[0.1341]
O3
-5.8732
(ppm)
[0.1082]

Single Pollutant†

Elast.§ WTP‡
-0.0710 -87.7
-0.1643

-137.4

-0.6032

-171.8

Coeff
Elast.§ WTP‡
-0.0037 -0.0875 -108.2
[0.0004]
-5.8241 -0.2037 -170.3
[0.1274]
-6.3151 -0.6485 -184.7
[0.1042]

Heteroskedasticity robust standard errors in brackets. Controls for prior sales price, lot size, square feet,
number of rooms, number of bedrooms, number of bathrooms, year built and county fixed effects also
included but not reported. † The single pollutant regressions are run separately for each pollutant, whereas
the other estimates are run with all pollutants in a single regression. § Elasticities calculated at medians of
pollutants, which are 23.66 for PM10, 0.0350 for SO2, 0.1027 for O3. ‡ Willingness to pay calculated for
marginal 1 µg/m3 change in PM10 and 1 ppb change in other pollutants, annualized at rate of 0.07 for
median house price of $ 417,800.

22

Table 7: Implicit Price of House Attributes

Lot size
Square feet
No. of bedrooms
No. of bathrooms
No. of rooms
Year built

Lot size
Square feet
No. of bedrooms
No. of bathrooms
No. of rooms
Year built

Lot size
Square feet
No. of bedrooms
No. of bathrooms
No. of rooms
Year built

Efficient Market IV
Fixed Effect
Cross Section
Coeff
Elast.§
Coeff
Elast.§
Coeff
Elast.§
Sold in period 3 and 2
Sold in period 3
4.95E-06* 0.0343 -1.48E-07 -0.0010 1.35E-05* 0.0934
[2.99E-07]
[3.08E-07]
[1.61E-06]
8.16E-05* 0.1394 -5.54E-05* -0.0947 3.42E-04* 0.5838
[4.89E-06]
[4.60E-06]
[1.82E-05]
8.50E-03* 0.0275 1.78E-02* 0.0575 -1.51E-02* -0.0489
[2.40E-03]
[2.55E-03]
[1.02E-02]
2.00E-03
0.0042 -6.31E-03 -0.0133 5.02E-02
0.1059
[1.50E-03]
[3.72E-03]
[1.25E-02]
1.06E-02* 0.0746 -5.57E-03* -0.0392 1.46E-02
0.1030
[3.60E-03]
[1.60E-03]
[6.41E-03]
-9.56E-04* -1.8804 -1.42E-03* -2.7937 -7.56E-04* -1.4871
[8.42E-05]
[8.79E-05]
[1.15E-03]
Sold in period 3 and 1
Sold in period 2
7.90E-06* 0.0547 -4.22E-07* -0.0029 1.37E-05* 0.0948
[6.77E-07]
[7.58E-07]
[1.29E-06]
1.86E-04* 0.3183 -5.62E-05 -0.0960 4.27E-04* 0.7289
[9.00E-06]
[1.11E-05]
[1.02E-05]
-5.30E-03 -0.0171 6.17E-03
0.0199 -3.62E-02 -0.1171
[4.50E-03]
[6.19E-03]
[1.92E-02]
5.40E-03
0.0114 -9.35E-03 -0.0197 4.25E-02* 0.0895
[2.90E-03]
[8.48E-03]
[1.77E-02]
2.79E-02* 0.1963 -4.16E-03 -0.0293 2.31E-02
0.1627
[6.50E-03]
[3.79E-03]
[1.21E-02]
-1.30E-03* -2.5558 -6.70E-04* -1.3180 -1.86E-04 -0.3653
[1.60E-04]
[2.09E-04]
[1.61E-03]
Sold in period 2 and 1
Sold in period 1
5.47E-06* 0.0379 1.08E-06* 0.0075 1.36E-05* 0.0941
[3.97E-07]
[3.41E-07]
[2.16E-06]
1.34E-04* 0.2288
8.77E-06
0.0150 4.51E-04* 0.7709
[6.52E-06]
[5.62E-06]
[4.39E-05]
-3.90E-03 -0.0126 9.77E-03* 0.0316 -5.94E-02 -0.1921
[3.30E-03]
[3.20E-03]
[2.58E-02]
6.60E-03* 0.0139
5.06E-03
0.0107 1.90E-02* 0.0402
[2.00E-03]
[4.36E-03]
[1.11E-02]
1.51E-02* 0.1062 -1.55E-03 -0.0109 2.11E-02* 0.1484
[4.40E-03]
[1.98E-03]
[2.55E-02]
-1.30E-03* -2.5558 -1.88E-03* -3.6965 -3.18E-04 -0.6256
[1.11E-04]
[1.09E-04]
[6.69E-04]
23

Heteroskedasticity robust standard errors in brackets. ∗ indicate statistically significantly different from 0
at 95% level. These parameter estimates are taken from the same regressions for which the pollutant
coefficients are reported in Table 6 (column 4), Table 5 (column 1), and Table 4 (panel A, columns 1,4,and
7). § Elasticities calculated at means of house characteristics as reported in Table 1.

negative sign. Moreover, for every pollutant, results are unstable across years. These results
suggest the presence of (possibly time-varying) omitted attributes that are correlated with
the pollutants we are studying.
A straightforward way to control for time-invariant unobservables, which may be confounding the cross-sectional estimates, is to estimate the fixed-effect model as described
above. Table 5 describes these results, first including all pollutants and then for each pollutant separated. MWTP estimates for SO2 and O3 are stable across the two specifications
(including all pollutants or not), have the expected sign, and are small but not unreasonable
in magnitude. For instance, the results including all pollutants suggest that at the median
housing price of $417,800, a homebuyer would be willing to pay $56 to avoid a 1ppb reduction in SO2 and $91 for a similar reduction in O3. MWTP for PM10, however, has
a counterintuitive sign, suggesting the presence of some sort of omitted attribute that was
not adequately controlled for by the house fixed effect. This is the typical sort of bias
encountered in the hedonic valuation of air pollution – desirable unobservables may evolve
over time in conjunction with worsening air pollution (e.g., the opening of new businesses,
or other forms of economic growth). The house fixed effect is unable to control for this sort
of evolving omitted attribute.
O3 appears to be an exception, producing comparable results across the cross sectional
and fixed-effect models. One explanation for this result has to do with the process in which
ground-level ozone is formed. In particular, ozone is the outcome of a photochemical process
that can be easily altered by variations in weather patterns – for example, it can be shutdown by thick fog or cloud cover, both of which can be quite common in the Bay Area. This
may be a source of exogenous variation in ozone that helps identify its effect separately from
those of time-invariant omitted attributes. Recall also that this intuition is supported by
the low correlations of O3 with the other pollutants as described in Table 10.
Given concerns about time-varying unobservables, it is at this point in the research
process where previous work has turned to some quasi-random source of variation in pollution
to accurately identify MWTP. There is no natural source of quasi-random variation in our
Bay Area data set, so we instead turn to the model based on our assumption of rational
home-buyers. The results of this model for the pollution variables are described in Table 3.
We first consider the results for PM10 in detail. Whereas the fixed-effect estimates of the
MWTP for PM10 had a counterintuitive sign, estimates from our efficient housing market
model imply a statistically significant MWTP to avoid an additional microgram of PM10
24

per cubic meter ranging between $88 and $108. Of the pollutants that we study, particulate
matter has received the most attention in the hedonics literature; Smith and Huang (1995)
survey that literature from 1967 to 1988 in the context of a meta-analysis. While those
papers focused on the elasticity of house prices with respect to TSP,8 elasticities are still
comparable to our results. Smith and Huang find elasticities that tend to lie between -0.04
and -0.07. Our results are therefore on the high-end of this range (i.e., -0.071 to -0.088).
Similar biases appear to be present for O3 and SO2, although in neither case is the bias
as severe as in the case of PM10. In the case of SO2, MWTP rises from $56 to $137 in the
case of the model with all pollutants when time-varying unobservables are accounted for,
and $62 to $170 for the single pollutant case. In the case of O3, MWTP rises from $91 to
$172 in the setting with all pollutants and from $99 to $185 for the single pollutant model.
In contrast to the comparison between the cross-sectional and fixed effect models (where the
addition of fixed effects did little to affect MWTP estimates), it appears that time-varying
unobservables do bias downward estimates of the MWTP to avoid O3.
Table 8 describes the results of all three models for non-pollution housing attributes.
For the efficient housing and fixed-effects models, these estimates describe the difference in
the implicit price of each attribute over time (e.g., the difference between the period 3 and
period 2 coefficients on lot-size in the efficient housing model is a statistically significant
5.22 × 10−6 ). We see that the implicit prices of many attributes associated with larger
homes tend to rise over time under the efficient housing model, while they more often fall
under the fixed-effects model (although this is by no means uniform across all attributes
and many of the estimates are insignificant). The value of newer homes (i.e., year-built)
falls over time in both of these specifications. The cross-sectional coefficient estimates for
non-pollution housing attributes in each period can be easily interpreted as implicit prices.
8

Prior to 1987, the EPA measured the concentration of a wide range of particulate matter of various sizes, denoted by total suspended particulates (TSP). After 1987, the EPA switched its focus to
”inhalable coarse particles” with diameters between 2.5 and 10 micrometers, and ”fine particles” with
diameters less than 2.5 micrometers. PM10 refers to any particle with a diameter smaller than 10 micrometers. Thes particles, which are the focus of our analysis, are considered to have greater adverse
health consequences becasue of their potential to travel deep into the lungs and even into the bloodstream
(http://www.epa.gov/air/particlepollution/basic.html). They may not, however, be as visible as larger
particles, and may therefore have lower amenity costs.

25

5

Conclusion

Our paper demonstrates a new approach to controlling for unobserved product attributes in
hedonic models. In particular, we show how an assumption about the rationality of homebuyers with respect to the evolution of the omitted housing attribute can be exploited to
identify implicit prices in the context of either fixed or time-varying unobserved product
attributes. We then describe an estimator that can be applied to settings where repeat sales
data are available and our rationality condition is likely to hold.
We use our estimator to recover a consumer’s marginal willingness to pay for clean air
in the Bay Area. Particularly appealing features of our identification strategy are that (i) it
can be easily applied to data from a single, well-defined housing market, and (ii) our main
identification assumption is a necessary condition for something that can be tested (i.e., that
available information at time t should not predict economically significant excess returns in
periods t + 1 and beyond). We find evidence that this assumption is valid for the housing
market in the Bay Area.
We estimate the implicit price of three of the EPA’s criteria air pollutants (PM10, SO2,
and O3). In contrast to fixed-effects methods (which just control for time-invariant omitted attributes) or cross-sectional methods (which ignore correlated omitted attributes altogether), our estimates of the implicit price indicate that consumers value pollution reductions,
and that their MWTP to avoid pollution is significantly larger in magnitude than that found
by other models. Particularly in the case of PM10, it appears that failing to control for
omitted attributes at all or only controlling for time-invariant unobserved attributes leads to
the wrong sign on the estimate of the potential benefits of a pollution reduction policy. Our
estimates suggest that SO2 is also prone to a large bias from ignoring time-varying unobservables. Time-varying unobservables associated with ground-level ozone, while important,
do not appear to lead to as large of a bias.
To be clear, while our approach works well in this context, we are not claiming that it
will be superior to quasi-random approaches in all applications. The identifying assumptions in our approach and quasi-random approaches are not nested, and the plausibility of
either set of assumptions depends on the particular application and data one is using. Our
approach may be preferable when a legitimate source of quasi-randomness cannot be found,
or when one is available but it generates insufficient exogenous variation in the variable of

26

interest. On the other hand, quasi-randomness will be preferable if there is reason to suspect that our rationality assumption is violated (e.g., if there is strong serial correlation in
the stochastic innovation of the omitted housing attribute). In empirical work, we advise
applied researchers to test the sensitivity of results to alternative identifying assumptions
when they are available.

27

Appendix
A

Nonparametric Hedonic Pricing Equations: Generalization

Consider the generalized system of hedonic pricing equations:
ln(pj,t ) = αt + ht (xj,t ) + ξj,t for t = 1, . . . , T
where we normalize ht (0) = 0 and ht (·) is nonparametrically specified. Similar to (4), we
obtain
ln(pj,t0 ) = αt0 + ht0 (xj,t0 ) + ξj,t0

(8)

= αt0 + ht0 (xj,t0 ) + γ(t, t0 ) [ln(pj,t ) − αt − ht (xj,t )] + η(j, t, t0 )
= (αt0 − γ(t, t0 )αt ) + γ(t, t0 ) ln(pj,t )
−γ(t, t0 )ht (xj,t ) + ht0 (xj,t0 ) + η(j, t, t0 ).
To deal with endogeneity of xj,t0 (which may be correlated with η(j, t, t0 )), we exploit the
process that describes the evolution of xj,t over time. We assume
xj,t0 = gt,t0 (xj,t , wj,t ) + v j,t,t0

E[v j,t,t0 |It ] = 0

(9)

In words, the innovation in the observed attributes is orthogonal to time t information where
wj,t denotes other observable variables in It . Also we assume that
η(j, t, t0 ) = τ (t, t0 )v j,t,t0 + εj,t,t0

(10)

where τ (t, t0 ) is the 1 × K parameter vector. These assumptions imply that xj,t0 evolves
according to the process described in (9), but that the innovation in xj,t0 may be correlated
with the innovation in the omitted attribute. Applying assumptions (9) and (10) to (8), we

28

obtain
ln(pj,t0 ) = (αt0 − γ(t, t0 )αt ) + γ(t, t0 ) ln(pj,t )

(11)

−γ(t, t0 )ht (xj,t ) + ht0 (xj,t0 ) + τ (t, t0 )v j,t,t0 + εj,t,t0 .
Our identification and estimation methods are then based on the following moment condition
E [εj,t,t0 |It , v j,t,t0 ] = 0.

This moment condition states that after controlling for time t information It and the innovation in the observed attributes v j,t,t0 , the innovation in the omitted attribute has an expected
value of zero. This moment condition motivates the use of a control function approach
– in the first step, estimate equation (9) and obtain fitted residuals, b
v j,t,t0 ; in the second
step, include b
v j,t,t0 (K × 1) as additional regressors in (4), so we use one control for each
endogenous product attribute xj,k,t0 , k = 1, . . . , K.

A.1

Identification and Estimation

In order to show how the model described in Section 2 generalizes to more than two transactions, suppose for each house j we observe transaction prices on three occasions, denoted
by ta (j), tb (j), and tc (j) such that 1 ≤ ta (j) < tb (j) < tc (j) ≤ T . The result in this section
can also be extended to four or more repeat sales. Here we assume that all the elements
in xj,t are time-varying. If some components in xj,t are time invariant, we need to assume
that implicit prices of those time invariant attributes are constant over time by the reason
explained in Section 2.2.
We write (11) for several time periods (assuming that we have enough observations of

29

transaction prices for each time period9 ) such that
ln(pj,tb ) = αtb − γ(ta , tb )αta + γ(ta , tb ) ln(pj,ta ) − γ(ta , tb )hta (xj,ta )
+htb (xj,tb ) + τ (ta , tb )v j,ta ,tb + εj,ta ,tb
ln(pj,tc ) = αtc − γ(tb , tc )αtb + γ(tb , tc ) ln(pj,tb ) − γ(tb , tc )htb (xj,tb )
+htc (xj,tc ) + τ (tb , tc )v j,tb ,tc + εj,tb ,tc .
Estimation proceeds based on the following moment conditions:
E[xj,tb − gta ,tb (xj,ta , wj,ta )|1, xj,ta , wj,ta ] = 0

(12)

E[εj,ta ,tb |1, ln(pj,ta ), xj,ta , xj,tb , v j,ta ,tb , wj,ta ] = 0

(13)

E[xj,tc − gtb ,tc (xj,tb , wj,tb )|1, xj,tb , wj,tb ] = 0

(14)

E[εj,tb ,tc |1, ln(pj,tb ), xj,tb , xj,tc , v j,tb ,tc , wj,tb ] = 0

(15)

where wj,t denotes other observable covariates in It . From (12) we identify gta ,tb (·) (along
with v j,ta ,tb ), and from (13) we identify αtb − γ(ta , tb )αta , γ(ta , tb ), hta (xj,ta ), htb (xj,tb ), and
τ (ta , tb ). Similarly from (14) we identify gtb ,tc (·) (along with v j,tb ,tc ) and from (15) we identify
αtc − γ(tb , tc )αtb , htb (xj,tb ), htc (xj,tc ), and τ (tb , tc ).
These may be run as two separate sets of estimations – i.e., one is based on (12) and (13)
and the other based on (14) and (15). We note, however, that htb (xj,tb ) is over-identified from
the moment conditions, which suggests combining all the moment conditions and performing
a nonlinear nonparametric estimation. Having set-up the moment conditions in (12)-(15),
one can cast them into Ai and Chen (2003)’s framework and estimate all the parameters
(including nonparametric functions) simultaneously. The consistency of the estimators and
the asymptotic normality of the parametric components can be obtained following Ai and
Chen (2003).
Once we estimate the hedonic function, another parameter of interest will be the weighted
average derivative of the log housing price (ln(pj,t0 )) with respect to the observed characteristic xj,t for t ≤ t0 , defined by


∂ ln(pj,t0 )
.
(16)
E λ(xj,t )
∂xj,t
9

To be precise,

1
J

PJ

j=1

1{ta (j) = t or tb (j) = t or tc (j) = t} −→ C > 0 for all t = 1, . . . , T .
J→∞

30

This can be estimated using its sample analogue,
J
J
\
1X
∂ ln(pj,t0 )
1X
∂ ln(p
j,t0 )
λ(xj,t )
≈
λ(xj,t )
J j=1
∂xj,t
J j=1
∂xj,t

\
where ln(p
j,t0 ) is the fitted log price function. The weight λ(·) satisfies λ(·) ≥ 0 and
R
\0 )
∂ ln(p
j,t
λ(x)dx = 1. In the literature, estimated implicit prices ∂xj,t
are commonly used
to recover valuation for non-market amenities such as clean air or public school quality.
∂ ln(p 0 )
Since ∂xj,tj,t varies across homeowners in the population, the function λ(xj,t ) allows the
researcher to aggregate these heterogeneous marginal benefits. The scalar (16) summarizes
the average marginal benefit from an increase in the amount of some characteristic xj,t in
time period t and is often used to measure welfare from a policy change.

References
Ai, C. and X Chen (2003), “Efficient Estimation of Models With Conditional Moment Restrictions Containing Unknown Functions,” Econometrica, 71(6), 1795-1843.
Bajari, P and CL Benkard (2005), “Demand Estimation with Heterogeneous Consumers and
Unobserved Product Characteristics: A Hedonic Approach,” Journal of Political Economy,
113(6), 1239-1276.
Black, SE (1999), “Do Better Schools Matter? Parental Valuation of Elementary Education,”
The Quarterly Journal of Economics, 114(2): 577-599.
Case, KE and R. J Shiller (1989), “The Efficiency of the Market for Single-Family Homes,”
The American Economic Review, 79(1): 125-137.
Chay, KY and M Greenstone (2005), “Does Air Quality Matter? Evidence from the Housing
Market,” Journal of Political Economy, 113(2), 376-424.
D’Ippoliti D, F Forastiere, C Ancona, N Agabity, D Fusco, P Michelozzi, and CA Perucci
(2003), “Air Pollution and Myocardial Infarction in Rome: A Case-Crossover Analysis,”
Epidemiology, 14: 528-535.

31

Dockery DW, CA Pope, X Xu, JD Spengler, JH Ware, ME Fay, BG Ferris, and FE Speizer
(1993), “An Association Between Air Pollution and Mortality in Six U.S. Cities,” New England Journal of Medicine, 329: 1753-1759.
Dougherty, A. and R Van Order (1982), “Inflation, Housing Costs, and the Consumer Price
Index,” The American Economic Review, 72(1): 154-164.
Ekeland, I, JJ Heckman, and L Nesheim (2004), “Identification and Estimation of Hedonic
Models,” Journal of Political Economy, 112(S1): S60-S109.
Epple, D (1987), “Hedonic Prices and implicit Markets: Estimating Demand and Supply
Functions for Differentiated Products,” Journal of Political Economy, 95(1): 59-80.
Ghio AJ, C Kim, and RB Devlin (2000), “Concentrated Ambient Air Particles Induce Mild
Pulmonary Inflammation in Healthy Human Volunteers,” American Journal of Respiratory
and Critical Care Medicine,162(3 Pt.1): 981-988.
Greenstone, M. and J. Gallagher (2008), “Does Hazardous Waste Matter? Evidence from
the Housing Market and the Superfund Program,” The Quarterly Journal of Economics,
MIT Press, 123(3): 951-1003.
Heckman, J, RL Matzkin, and L Nesheim. “Simulation and Estimation of Hedonic Models,”
Center for Economic Studies & Ifo Institute for Economic Research (CESifo), Working Paper
No. 1014, August 2003.
Hong YC, JT Lee, H Kim, EH Ha, J Schwartz, and DC Christiani (2002), “Effects of Air
Pollutants on Acute Stroke Mortality,” Environmental Health Perspectives, 110: 187-191.
Lin M, Y Chen, RT Burnett, PJ Villeneuve, and D Kerwski (2002), “The Influence of
Ambient Coarse Particulate Matter on Asthma Hospitalization in Children: Case-Crossover
and Time-Series Analyses,” Environmental Health Perspectives, 110: 575-581.
Muller N., D. Tong, and R. Mendelsohn (2009), “Regulating NOx and SO2 Emissions in
Atlanta,” The B.E. Journal of Economic Analysis and Policy, Berkeley Electronic Press,
9(2).
Murphy, K and R Topel (1985), “Estimation and Inference in Two-Step Econometric Models,” The Journal of Business & Economic Statistics, 3-4, 370-379.

32

Norris G, SN YoungPong, JQ Koenig, TV Larson, L Sheppard, and JW Stout (1999), “An
Association Between Fine Particles and Asthma Emergency Department Visits for Children
in Seattle,” Environmental Health Perspectives, 107: 489-493.
Pope CA, RT Burnett, MJ Thun, EE Calle, D Krewski, K Ito, and GD Thurston (2002),
“Lung Cancer, Cardiopulmonary Mortality, and Long-Term Exposure to Fine Particulate
Air Pollution,” JAMA, 287:1132-1141.
Rosen, S (1974), “Hedonic Prices and Implicit markets: Product Differentiation in Pure
Competition” Journal of Political Economy, 82(1):34-55.
Samet JM, DM DeMarini, and HV Malling (2004), “Do Airborne Particulates Induce Heritable Mutations?” Science, 304(5673):971-972.
Slaughter JC, T Lumley, L Sheppard, JQ Koenig, and GG Shapiro (2003), “Effects of
Ambient Air Pollution on Symptom Severity and Medication Use in Children with Asthma,”
Annals of Allergy, Asthma, and Immunology, 91: 346-353.
Smith, VK and JC Huang (1995), “Can Markets Value Air Quality? A Meta-Analysis of
Hedonic Property Value Models,” Journal of Political Economy, 103(1), 209-227.
Tolbert PE, JA Mulholland, DD MacIntosh, F Xu, D Daniels, OJ Devine, BP Carlin, M
Klein, J Dorley, AJ Butler, DF Nordenberg, H Franklin, PB Ryan, and MC White (2000),
“Air Quality and Pediatric Emergency Room Visits for Asthma in Atlanta, Georgia,” American Journal of Epidemiology, 151: 798-810.
Tsai SS, WB Goggins, HF Chiu, and CY Yang (2003), “Evidence for an Association Between
Air Pollution and Daily Stroke Admissions in Kaohsiung, Taiwan,” Stroke, 34(11): 26122616.

33

