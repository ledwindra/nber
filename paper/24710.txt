NBER WORKING PAPER SERIES

INEQUALITY, BUSINESS CYCLES, AND MONETARY-FISCAL POLICY
Anmol Bhandari
David Evans
Mikhail Golosov
Thomas J. Sargent
Working Paper 24710
http://www.nber.org/papers/w24710

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2018

We thank Adrien Auclert, Benjamin Moll, and seminar participants at numerous seminars and
conferences for helpful comments The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
Â© 2018 by Anmol Bhandari, David Evans, Mikhail Golosov, and Thomas J. Sargent. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including Â© notice, is given to the source.

Inequality, Business Cycles, and Monetary-Fiscal Policy
Anmol Bhandari, David Evans, Mikhail Golosov, and Thomas J. Sargent
NBER Working Paper No. 24710
June 2018
JEL No. C63,E52,E63
ABSTRACT
We study optimal monetary and fiscal policy in a model with heterogeneous agents, incomplete
markets, and nominal rigidities. We develop numerical techniques to approximate Ramsey plans
and apply them to a calibrated economy to compute optimal responses of nominal interest rates
and labor tax rates to aggregate shocks. Responses differ qualitatively from those in a
representative agent economy and are an order of magnitude larger. Taylor rules poorly
approximate the Ramsey optimal nominal interest rate. Conventional price stabilization motives
are swamped by an across person insurance motive that arises from heterogeneity and incomplete
markets.
Anmol Bhandari
Department of Economics
University of Minnesota
1925 Fourth Street South
Minneapolis, MN 55455
and NBER
bhandari@umn.edu

Mikhail Golosov
Department of Economics
University of Chicago
1126 E. 59th Street
Chicago, IL 60637
and NBER
golosov@uchicago.edu

David Evans
Economics Department
University of Oregon
devans@uoregon.edu

Thomas J. Sargent
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
thomas.sargent@nyu.edu

1 Introduction
We study monetary and scal policy in a New Keynesian economy populated by
agents who face aggregate and idiosyncratic risks. Agents dier in wages, exposures to
aggregate shocks, holdings of nancial assets, and abilities to trade assets. Incomplete
nancial markets prevent agents from fully insuring risks. Firms are monopolistically
competitive. Price adjustments are costly. We examine how the Ramsey planner's
choices of nominal interest rates, transfers, and proportional labor tax rates respond
to aggregate shocks.
Analysis of Ramsey policies in settings like ours faces substantial computational
challenges. The aggregate state in a recursive formulation of the Ramsey problem includes the joint distribution of individual asset holdings and auxiliary promise-keeping
variables that had been chosen by the planner earlier. The law of motion for that
high-dimensional object must be jointly determined with the optimal policies. This
feature renders inapplicable existing numerical techniques that rely on approximating
around a known invariant distribution associated with xed government policies.
To overcome this challenge, we develop a new computational approach that can
be applied to economies with substantial heterogeneity and does not require knowing
their long-run properties in advance. Our approach builds on a perturbation theory
that uses small-noise expansions with respect to a one-dimensional parameterization
of uncertainty. Each period along a sample path, we apply a perturbation algorithm
evaluated at the current cross-sectional distribution to approximate policy functions.
We use approximate decision rules for the current period to determine outcomes
including the cross-sectional distribution next period. Then we obtain approximations
of next period's decision rules by perturbing around that new distribution. In this
way we update points around which policy functions are approximated along the
equilibrium path.
Our perturbation approach requires computing derivatives of policy functions
with respect to all state variables. One state variable is a distribution over a multidimensional space of agents' characteristics. Except for very simple models of heterogeneity, it is impractical to compute the derivative with respect to this distribution
(i.e., the Frechet derivative). We make progress by showing that our expansion requires only the value of that derivative at a point that corresponds to the optimal
Ramsey response. We derive an expression for this value and show that it is a linear

2

function of variables that are easy to compute. That mathematical structure allows
us to compute approximations to each agent's policy function by solving low dimensional linear systems of equations that are independent across agents. This feature
enables us to solve our model quickly even though it has ample sources of heterogeneity. Furthermore, we proceed to show that the same computationally convenient
linear structure is preserved for second- and higher-order expansions. That allows us
to capture precautionary and hedging motives.
We apply our approach to a textbook New Keynesian sticky price model (see, e.g.,
GalÃ­ (2015)) augmented with heterogeneous agents in the spirit of Bewley-Aiyagari.
Agents' wages are subject to idiosyncratic and aggregate shocks that we calibrate to
match empirical facts about labor earnings documented by Storesletten et al. (2004)
and Guvenen et al. (2014).

We make the initial joint distribution of assets and

wages match cross-sectional moments in the Survey of Consumer Finances. We posit
two types of aggregate shocks: a productivity shock and a shock to the elasticity
of substitution between dierentiated intermediate goods that aects rms' optimal
markups.

Financial markets are incomplete and agents can trade only non-state-

contingent nominal debt. We study two types of Ramsey policies. First, a purely
monetary policy planner is required to keep the labor tax rate xed, an assumption
commonly used with New Keynesian models. In this case, the planner can adjust only
nominal interest rates and a uniform lump-sum transfer.

Second, a more powerful

monetary-scal Ramsey planner can adjust tax rates in addition to interest rates
and transfers.
Two motives inherited from the Ramsey planner's objective function shape optimal
policies. One is the usual New Keynesian motive to use government policies to oset
ineciencies caused by sticky prices.

A second is a desire to provide insurance.

Without a complete set of Arrow securities, agents cannot hedge risk, so aggregate
shocks aect dierent agents dierentially.

A planner can use monetary and scal

tools to even out the impact of those shocks and provide insurance. In our calibrated
economy, we nd that the insurance motive quantitatively swamps price stability
considerations. That makes optimal policy responses dier signicantly from those in
a representative agent economy where they are primarily driven by the price stability
motive.
Consider rst the optimal monetary response to a positive markup shock. One
eect of a markup shock is that rms want to increase their prices. Nominal rigidities

3

make that costly. When price stability is its only motive, the planner increases the
nominal interest rate in response to a positive markup shock. That lowers aggregate
demand and marginal costs and thereby reduces rms' incentives to raise prices. GalÃ­
(2015) dubs this optimal response in representative agent New Keynesian economies
as leaning against the wind.

With heterogeneous agents, a markup shock redis-

tributes resources among households. Higher markups shift factor income from wages
to dividends, beneting rm owners and hurting wage recipients. To provide insurance, the planner can decrease interest rates in order to boost aggregate demand and
real wages. The planner does that to oset the negative eect of the markup shock
on wage-earners. The net eect of the markup shock on optimal policy depends on
the relative strengths of the planner's price stability and insurance motives. When
we calibrate the distribution of equity ownership to U.S. data, we nd that a one
standard deviation positive markup shock, which implies a 0.5 percentage point increase in rms' optimal markups, calls for a 0.3 percentage point decrease in the
nominal interest rate versus a 0.05 percentage point increase with a representative
agent calibration.
Price stability and insurance motives also bring dierent prescriptions for the
optimal scal response.

To ensure price stability in response to a positive markup

shock, the planner wants to lower the marginal tax rate one for one with the shock.
This requires lowering transfers to satisfy the government's budget constraint, making
the average taxes more regressive. To provide insurance, the planner needs to raise
taxes and transfers to increase progressivity and oset the distributionary impact of
the shock. In the calibrated economy, the insurance channel dominates: in response
to a one standard deviation positive markup shock, a planner increases tax rates by
2 percentage points. This scal response comes on top of a cut in nominal interest
rates by about 0.25 percentage points and a 1 percentage point spike in ination.
The tax increase is short-lived, which contrasts with the very persistent eects of
aggregate shocks on optimal tax rates in non-monetary economies, such as Barro
(1979) and Aiyagari et al. (2002).

The reason for this is that deadweight losses

from temporary tax changes in New Keynesian models are lower than those from
permanent tax changes:

rms choose not to adjust nominal prices to temporary

shocks, and consequently a transitory tax change mostly aects tax incidence but not
the labor wedge.
The insurance motive also substantially aects Ramsey responses to TFP shocks.

4

With heterogeneous agents, eects of productivity shocks are not shared equally: borrowers in state-non-contingent nominal debt are hurt more than lenders. This eect
is further amplied when, as in the data, nancial and wage income are positively
correlated and because labor incomes of low earners are especially adversely aected
by recessions (see Guvenen et al. (2014)). To even out adverse eects of the shock,
the planner cuts nominal interest rates, thereby generating ination and lowering
realized returns on debt holdings. This contrasts with a typical New Keynesian response that would maintain stable prices by adjusting nominal rates one-for-one with

1 In our calibrated economy, we nd that in response

the natural rate of interest.

to a productivity shock that lowers output by 3 percentage point, nominal rates are
lowered by 0.6 percentage point.
In our heterogeneous agent economy, Taylor rules perform substantially worse
than in a representative agent counterpart. Without heterogeneity, the main purpose
of optimal policy is to stabilize ination; Taylor rules meet this objective well. But
they do poorly in the presence of heterogeneity for two reasons. First, in response
to markup shocks it is optimal to move interest rates in the opposite direction from
that prescribed by standard Taylor rules. Second, while Taylor rules make nominal
interest rates and ination as persistent as exogenous shocks, the Ramsey planner
prefers more transient nominal interest rates and ination to provide insurance.
We also investigate the eects of trading frictions on optimal policy.

Typical

Bewley-Aiyagari models poorly match observed cross-section distributions of MPCs.
We alter our economy to include a set of agents who can hold assets and consume
their returns but cannot trade them. We choose the distribution of such agents to
match MPC heterogeneity estimated by Jappelli and Pistaferri (2014). We nd that
in such an economy the optimal response of nominal interest rates is smaller than in
our benchmark calibration to markup shocks, but not to productivity shocks. This
outcome emerges because in response to a markup shock the Ramsey planner would
like to alter aggregate demand and real wages. These quantities are determined by

average

actions across agents. Changes in interest rates have a direct eect only on

agents who can trade their assets. By reducing the number of such agents, trading
frictions make monetary policy less eective, an outcome emphasized by Auclert
(2017) and Kaplan et al. (2018). But in response to a TFP shock the planner wants

1 The natural interest rate is dened as the real interest rates that would prevail in an economy
without nominal rigidities.

5

to aect returns on nancial assets that are determined by a
do not depend on the number of such investors.

marginal

investor and

We also nd that the presence

of trading frictions increases the importance of scal instruments like transfers that
directly aect the consumption of high MPC agents.

1.1 Earlier works
A number of contributions characterized and approximated competitive equilibria
with exogenously xed government policies.

These employ one of two broad ap-

proaches that either (i) compute non-linear policies after summarizing the distributional state variable with a low dimensional vector of its moments, for instance Krusell
and Smith (1998), or (ii) apply a rst-order Taylor expansion of policy functions with
respect to the aggregate shocks around an invariant distribution for an economy without aggregate shocks, for instance Reiter (2009).

2 Neither approach is suitable for

our problem. First, for us an invariant distribution depends on a key object that we
want to compute, namely, the Ramsey policy. Furthermore, the invariant distribution
under a Ramsey plan for an incomplete markets without aggregate shocks looks very
dierent from the invariant distribution of the same economy with small aggregate
shocks.

In addition, the speed of convergence to this invariant distribution is slow

and the behavior of optimal policies around the invariant distribution diers signi-

3 Finally, the

cantly from the behavior of policies away from the invariant distribution.

state space in an economy under the Ramsey plan is much larger because it includes
promise-keeping variables for the planner in addition to all of states that appear in a
corresponding economy with an arbitrary exogenous government policy.
Our computational approach uses a one dimensional scaling of uncertainty and a
sequence of small-noise expansions along an equilibrium path. Our approach is most
closely related to Fleming (1971), Fleming and Souganidis (1986), and Anderson et al.
(2012). State variables in the models studied by Anderson et al. are low dimensional,
for example just an aggregate capital stock. In contrast, our state variable is a joint

2 See Algan et al. (2014) for variants of the Krusell and Smith method and Ahn et al. (2017);
Winberry (2016); Childers et al. (2018) for the variants of the Reiter method.

3 Such outcomes are evident in Barro (1979), Aiyagari et al. (2002), and Farhi (2010). In Bhandari

et al. (2017a), we consider a simplied version of the economy studied in this paper and show that
while the invariant distribution in a Ramsey problem without aggregate shocks is pinned down by
initial conditions (such as the initial distribution of wealth), the invariant distribution in a corresponding problem with aggregate shocks is determined by motives to hedge such shocks. Therefore,
the invariant distribution is discontinuous in the degree of aggregate risk around zero risk.

6

distribution over a multi-dimensional domain. That renders direct application of the
Anderson et al. technique computationally infeasible. We overcome this problem by
proving and applying a factorization theorem (see section 3) that allows us to break
one big problem into a manageable collection of much smaller ones. We show how
these ideas can be used to construct second- and higher-order approximations. Our
approach builds on Evans (2015).
Most studies of optimal policy have been restricted to economies with very limited or no heterogeneity.

Schmitt-Grohe and Uribe (2004) and Siu (2004) are two

notable quantitative studies of Ramsey policies in representative agent New Keynesian models. Our parameterization follows theirs. So as might be expected, when all
heterogeneity is shut down, we obtain quantitative results similar to theirs. Bilbiie
and Ragot (2017), Nuno and Thomas (2016), Challe (2017), and Debortoli and Gali
(2017) study optimal monetary policy in economies with very limited heterogeneity.
In those settings, the aggregate distribution disappears from the formulation of the
Ramsey problem and the analysis can be done using traditional techniques. Like us,
they emphasize that uninsurable risk creates reasons for a planner to depart from
price stability. A recent paper by Legrand and Ragot (2017) develops a method different from ours to approximate Ramsey allocations in incomplete market economies
with heterogeneity. They apply their method to a neoclassical economy.

2 Environment
Our economy is populated by a continuum of innitely lived households. Individual

i's

preferences over nal consumption good

âˆ
X

t



n1+Î³
c1âˆ’Î½
âˆ’
1âˆ’Î½ 1+Î³

{ni,t }t

are ordered by


(1)

is an expectations operator conditioned on time

t information and Î² âˆˆ (0, 1)

Î²

t=0

Et

and hours

,

E0
where

{ci,t }t

is a time discount factor.
Agent

i

who works

ni,t

hours supplies

is an exogenous productivity process.
where

Pt

i,t ni,t

Eective labor receives nominal wage

is the nominal price of the nal consumption good at time

is taxed at a proportional labor tax rate

Î¥t .

7

i,t
Pt W t ,

units of eective labor, where

t.

Labor income

All agents receive a uniform lump sum

transfer

Tt Pt .

Agents trade a one-period risk-free nominal bond with price

Pt bi,t , Pt Bt

of the nal consumption good. We use

i

di,t

Î t

denotes the net ination

denotes dividends from intermediate goods producers measured in

units of the nal good. Agent

i's

t

budget constraint at

is

ci,t + Qt bi,t = (1 âˆ’ Î¥t )Wt i,t ni,t + Tt + di,t +
t

The government's budget constraint at time

GÌ„

bi,tâˆ’1
.
1 + Î t

(2)

is

Z

1
GÌ„ + Tt +
Btâˆ’1 = Î¥t Wt
1 + Î t
where

in units

to denote bond holdings of agent

and the debt position of the government respectively.

rate. Finally,

Qt

i,t ni,t di + Qt Bt ,
i

is the level of non-transfer expenditures.

Yt is produced by competitive rms
{yt (j)}jâˆˆ[0,1] in a production function

A nal good
mediate goods

Z

1

Yt =

yt (j)

Î¦t âˆ’1
Î¦t

that use a continuum of inter-

t
 Î¦Î¦âˆ’1
t

dj

,

0
where the elasticity of substitution
good prices

Pt

Î¦t

is stochastic. Final good producers take nal

and intermediate goods prices

Z
max

{yt (j)}jâˆˆ[0,1]

Pt

1

yt (j)

Î¦t âˆ’1
Î¦t

{pt (j)}j

t
 Î¦Î¦âˆ’1

as given and solve

1

Z

t

âˆ’

dj

pt (j)yt (j)dj.

0

(3)

0

Outcomes of optimization problem (3) are a demand function for intermediate goods


yt (j) =

pt (j)
Pt

âˆ’Î¦t
Yt ,

and a nominal price satisfying

Z
Pt =

1
1âˆ’Î¦t

pt (j)
0

8

1
 1âˆ’Î¦

t

.

Intermediate goods

yt (j)

are produced by monopolists with production function

Î±

,
yt (j) = nD
t (j)
nD
t (j) is eective labor hired by rm j

Î± âˆˆ (0, 1]. These intermediate goods

âˆ’Î¦t
pt (j)
monopolists face downward sloping demand curves
Yt and choose prices
Pt

2
pt (j)
pt (j) while bearing quadratic Rotemberg (1982) price adjustment costs Ïˆ2 ptâˆ’1
âˆ’
1
(j)
measured in units of the nal consumption good. Firm j chooses prices {pt (j)}t that
where

and

solve

max E0

{pt (j)}t

X

Î²t

t



Ct
C0

ï£±
âˆ’Î½ ï£²

pt (j)
ï£³ Pt

ï£®

âˆ’Î¦t

pt (j) Wt
Yt ï£°
âˆ’
Pt
Î±
)

2
Ïˆ
pt (j)
âˆ’
âˆ’1
,
2 ptâˆ’1 (j)



pt (j)
Pt

! 1âˆ’Î± ï£¹

âˆ’Î¦t

Î±

Yt

ï£»

(4)

where we have imposed that each rm values prot streams with a stochastic discount

R
Ct = ci,t di.4
pt (j) = Pt , yt (j) = Yt for all j .

factor that is driven by aggregate consumption
In a symmetric equilibrium,

Market clearing

conditions in labor, goods, and bond markets are:

Z
Nt =

Dt = Yt âˆ’ Wt Nt âˆ’

i,t ni,t di,

yt (j) = Yt = NtÎ± ,
Ïˆ
Ct + GÌ„ = Yt âˆ’ Î 2t ,
2
Z
bi,t di = Bt .

Ïˆ 2
Î ,
2 t

(5)

(6)
(7)

(8)

i
There are aggregate and idiosyncratic shocks. Aggregate shocks are a markup
shock

5

Î¦t

and an aggregate productivity

Î˜t .

The markup shock follows an AR(1)

4 In economies with heterogeneous agents and incomplete markets one has to take a stand on
how rms are valued.

Using stochastic discount factor induced by aggregate consumption makes

our exposition most transparent. We have experimented with other alternatives such as weighted
means of individual intertemporal marginal rates of substitutions and found them to have negligible
eects on the main results.

5 The New Keynesian literature has utilized markup or cost-push shocks to account for patterns

observed during business cycles (see, e.g., Smets and Wouters (2007)). The literature has proceeded
to study implications of those shocks for optimal monetary policy in a representative agent framework

9

stochastic process

ln Î¦t = ÏÎ¦ ln Î¦tâˆ’1 + (1 âˆ’ ÏÎ¦ ) ln Î¦Ì„ + EÎ¦,t ,
where

EÎ¦,t

is mean-zero and i.i.d. over time. We consider two alternative specication

for productivity shocks. In the rst specication, we simply assume that

ln Î˜t

follows

an AR(1) process described by

ln Î˜t = ÏÎ˜ ln Î˜tâˆ’1 + (1 âˆ’ ÏÎ˜ ) ln Î˜Ì„ + EÎ˜,t ,
EÎ˜,t is mean zero and i.i.d. over time. In
ln Î˜t follows a growth rate shock process

where
that

(9a)

the second specication we assume

ln Î˜t = ln Î˜tâˆ’1 + EÎ˜,t ,
where again

EÎ˜,t is mean zero and i.i.d.

(9b)

over time. Under the growth rate specication,

t to equal Gt = GÌ„Î˜t where GÌ„ is a nonÏˆt = ÏˆÌ„Î˜t for some non-negative constant ÏˆÌ„

we scale government expenditures at time
negative constant and menu cost so that

6

to achieve stationarity.

Individual productivity

where

Îµ,i,t

and

ÎµÎ¸,i,t

i,t

follows a stochastic process described by

ln i,t = ln Î˜t + ln Î¸i,t + Îµ,i,t ,

(10)

ln Î¸i,t = ÏÎ¸ ln Î¸i,tâˆ’1 + f (Î¸i,tâˆ’1 ) EÎ˜,t + ÎµÎ¸,i,t ,

(11)

are mean-zero, uncorrelated with each other and i.i.d. over time.

This specication of idiosyncratic shocks builds on formulations of wage dynamics
used by Storesletten et al. (2001) and Low et al. (2010)) in which

Îµ,i,t

and

ÎµÎ¸,i,t

corre-

spond to transitory and persistent shocks to individual productivities. We augment
this specication with a function

f (Î¸i,tâˆ’1 ) that makes an aggregate productivity shock

have dierent loadings for agents with dierent earning histories. Doing that allows
(see, e.g., Clarida et al. (2001), GalÃ­ (2015), Woodford (2003)). As in GalÃ­ (2015), we interpret these
shocks as changes in desired markups arising from uctuations in the elasticity of substitution
parameter

Î¦.

We leave for future work the study of other shocks such as wage markups.

6 General insights are similar from these two alternative specications, but the i.i.d growth speci-

cation provides a convenient benchmark to study monetary policy because without market incompleteness and nominal frictions, the real interest rate is constant.

10

us to capture some of the facts documented by Guvenen et al. (2014).

Î¸i

is

Pâˆ’1 = 1.
agent i's

the initial holding of debt, and

si

the ownership of equity. Agent

We normalize the initial price level
by a triple

bi,âˆ’1

in period
and that

t
si

(Î¸i,âˆ’1 , bi,âˆ’1 , si ),
are given by

where

di,t = si Dt .

Agent

i

in period 0 is characterized

persistent productivity component,

i's

dividends

This imposes that agents do not trade equity

is a permanent characteristic. We refer to the collection

{Î¸i,âˆ’1 , bi,âˆ’1 , si }i

as an initial condition.

Denition 1.

{Qt , Î¥t , Tt }t , a
{ci,t , ni,t , bi,t }i , Ct , Nt , Bt , Wt , Pt , Yt , Dt t such

Given an initial condition and a monetary-scal policy

competitive equilibrium is a sequence



{ci,t , ni,t , bi,t }i,t maximize (1) subject to (2) and natural debt limits; (ii)
nal goods rms choose {yt (j)}j to maximize (3); (iii) intermediate goods producers'
prices solve (4) and satisfy pt (j) = Pt ; and (iv) market clearing conditions (5)-(8) are

that:

(i)

satised.
A utilitarian Ramsey planner orders allocations by

E0

Z X
âˆ
t=0

"
Î²t

#
n1+Î³
c1âˆ’Î½
i,t
i,t
âˆ’
di.
1âˆ’Î½ 1+Î³

(12)

Denition 2. Given an initial condition and a constant tax sequence {Î¥t }t satisfying
Î¥t = Î¥Ì„ for some Î¥Ì„, an optimal monetary policy

is a sequence

{Qt , Tt } t that supports a

competitive equilibrium allocation that maximizes (12). Given an initial condition,

optimal monetary-scal policy

is a sequence

{Qt , Î¥t , Tt }t

equilibrium allocation that maximizes (12).
scal policy is called the

an

that supports a competitive

A maximizing monetary or monetary-

Ramsey plan ; an associated allocation is called the Ramsey

allocation.
A few remarks about our baseline formulation.

We begin by assuming natural

debt limits. This provides us with a useful benchmark and also avoids issues about
normative implications in economies with ad hoc debt limits being sensitive to assumptions one makes on a government's ability to enforce debt and tax repayments.

7

7 In Bhandari et al. (2017b) we provide a comprehensive treatment of a Ramsey problem with ad
hoc debt limits. In the economy with ad hoc debt limits the planner can simply choose the timing
of transfers to undo such ad hoc debt limits. If the planner enforces debt and tax liabilities equally
then welfare in the economies with ad hoc and natural debt limits coincides. Welfare can sometimes
be improved in the economy with ad hoc debt limits if the planner commits not to enforce private
debt contracts (see also Yared (2013) for a related result).

11

After presenting results with natural debt limits, we introduce credit market frictions
in section 6. We discipline these frictions by matching observed heterogeneity in the
marginal propensities to consume and study how these frictions aect the Ramsey
plans. Assuming that equity ownership is xed provides us with a simple way to calibrate portfolio shares.

8 We have distinguished between purely monetary and mixed

monetary-scal policies because doing so allows us to respect a common argument
that institutional constraints make it dicult to adjust tax rates in response to typical
business cycle shocks, leaving nominal interest rates as the government's only tool for
ameliorating such shocks. We capture that argument by studying optimal monetary
policy when tax rates

{Î¥t }t

are xed at some level

Î¥Ì„.

The monetary-scal Ramsey

plan evaluates the optimal policies when this restriction is dropped.

3 Solution method
Following steps used by Lucas and Stokey (1983), Schmitt-Grohe and Uribe (2004),
and others it is straightforward to establish that a monetary-scal policy
and



{ci,t , ni,t , bi,t }i , Ct , Nt , Wt , Pt , Yt , Dt

t

{Qt , Î¥t , Tt }t

are a competitive equilibrium if and only

if they satisfy (2), (5)-(7) and

Î³
(1 âˆ’ Î¥t )Wt i,t câˆ’Î½
i,t = ni,t ,

(13)

âˆ’1
âˆ’Î½
Qtâˆ’1 ci,tâˆ’1
= Etâˆ’1 câˆ’Î½
,
i,t (1 + Î t )
âˆ’Î½




Wt
Ct+1
1
Î t+1 (1 + Î t+1 ) = 0.
Yt 1 âˆ’ Î¦t 1 âˆ’
âˆ’ Î t (1 + Î t ) + Î²Et
Ïˆ
Ct
Î±NtÎ±âˆ’1

(14)

(15)

To formulate the Ramsey problem, it is convenient to rewrite some of these constraints.

After dening

ai,t â‰¡ bi,t Qt câˆ’Î½
i,t ,

substituting for

Qt

and

(1 âˆ’ Î¥t )Wt ,

and

solving the budget constraint forward, equations (2) can be expressed as a sequence
of measurability constraints inherited from the risk-free nature of one-period debt:

"âˆ
#
âˆ’1
X

ai,tâˆ’1 câˆ’Î½
i,t (1 + Î t )
1+Î³
âˆ’Î½
= Et
Î² s c1âˆ’Î½
i,t+s âˆ’ ci,t+s (Tt+s + si Dt+s ) âˆ’ ni,t+s
âˆ’1
Î²Etâˆ’1 câˆ’Î½
(1
+
Î 
)
t
i,t
s=0

(16)

8 More generally, one needs some adjustment costs to reconcile agents' portfolio choices with those
observed in data. Exploring normative implications of alternative cost specications is interesting
but outside the scope of the paper.

12

t â‰¥ 1 as well as a similar constraint at t = 0 in which the left hand side is replaced
âˆ’Î½
with bi,âˆ’1 ci,0 . Dene
ci,t
1/Î½
(17)
mi,t â‰¡
Ct
for

and rewrite Euler equation (14) as

âˆ’Î½
âˆ’1
Qtâˆ’1 = Î²mi,tâˆ’1 Etâˆ’1 câˆ’Î½
Ctâˆ’1
i,t (1 + Î t ) .

Variable

mi,t

(18)

can be interpreted as a time-t Pareto-Negishi weight of agent

i.

It will

serve as a state variable in a recursive formulation of the Ramsey problem.
We formulate the Ramsey problem using ideas of Marcet and Marimon (2011). Let

Î² t Î›t , Î² t Î¾i,t be Lagrange multipliers
Âµi,t = Âµi,tâˆ’1 + Î¾i,t . Given an initial

Âµi,0 â‰¡ Î¾i,0 ,
= ai,âˆ’1 = 0,

on (15) and (16), respectively. Dene
condition

{Î¸i,âˆ’1 , bi,âˆ’1 , si }i ,

and

Î›âˆ’1

the Ramsey monetary-scal problem solves:

inf sup E0

âˆ
X

Î²t

t=0

(Z "

c1âˆ’Î½
n1+Î³
i,t
i,t
âˆ’
1âˆ’Î½ 1+Î³

!

1+Î³
1âˆ’Î½
+ ci,t
âˆ’ câˆ’Î½
Âµi,t
i,t (Tt + si Dt ) âˆ’ ni,t

ai,tâˆ’1 câˆ’Î½
(1 + Î t )âˆ’1 Î¾i,t
i,t âˆ’Î½
 + (1 âˆ’ Î²)câˆ’Î½
âˆ’
i,0 bi,âˆ’1 Âµi,0 di
Î²Etâˆ’1 ci,t (1 + Î t )âˆ’1




Wt
âˆ’Î½
âˆ’Î½
+ Î›t Ct Yt 1 âˆ’ Î¦t 1 âˆ’
+ (Î›tâˆ’1 âˆ’ Î›t )Ct ÏˆÎ t (1 + Î t ) ,
Î±NtÎ±âˆ’1

(19)

Âµi,t = Âµi,tâˆ’1 + Î¾i,t , where the sup is
with respect to {ci,t , ni,t , bi,t }i , Ct , Nt , Bt , Wt , Pt , Yt , Dt , and inf is with respect to
t
the multipliers {Âµi,t , Î›t }t . The Ramsey monetary problem is the same except the
sequence {Î¥t }t is exogenously xed.
We call the subsequence of the Ramsey plan for t â‰¥ 1 a continuation Ramsey plan.
It is recursive in aggregate states (Î˜tâˆ’1 , Î¦tâˆ’1 ), the Lagrange multiplier on the Phillips
curve equation Î›tâˆ’1 , and the joint distribution over zi,tâˆ’1 â‰¡ (mi,tâˆ’1 , Âµi,tâˆ’1 , Î¸i,tâˆ’1 , si )
that we denote by â„¦tâˆ’1 . Time t policy functions for aggregate variables depend on
(Î˜tâˆ’1 , Î¦tâˆ’1 , â„¦tâˆ’1 , Î›tâˆ’1 , EÎ˜,t , EÎ¦,t ) while time t policy functions for individual variables
also depend on (zi,tâˆ’1 , Îµ,i,t , ÎµÎ¸,i,t ). The Ramsey plan includes choices at time 0 and
solves time t = 0 rst-order conditions subject to the restriction that future variables
subject to (5), (6), (7), (13), (17), (18) and



conform to the continuation Ramsey plan.
Dependence of policy functions on the history-dependent endogenous distribu-

13

tion

â„¦

makes computing the Ramsey plan challenging.

high-dimensional state variable

The law of motion of the

â„¦ depends on optimal monetary-scal policies.

As we

discussed in the introduction, a key diculty is that before optimal policies are computed little can be said about properties of the stochastic process

â„¦t

and its invariant

distribution. This structure renders inapplicable computational techniques for solving heterogeneous agent economies that approximate around a stationary distribution
associated a xed set of government policies.
To overcome this diculty we develop a new computational method that builds
on the perturbation theory of Fleming (1971), Fleming and Souganidis (1986), and
Anderson et al. (2012) as well as on Evans (2015). The method constructs a sequence
of small-noise expansions of policy functions around pertinent time

t

state variables.

Using this approach, we rst approximate optimal policy functions at time
the time-t state including

â„¦tâˆ’1 ,

then use those to compute

approximations of optimal policy functions at time
including

â„¦t .

t+1

â„¦t ,

t

around

and nally construct

around the time-t

+1

state

To begin, we illustrate our approach in a simple setting. We next extend

things to the more general setting of section 2. Detailed derivations, proofs, and other
details are relegated to the online appendix where we also show how our method can
be used to solve for a competitive equilibrium with xed government policies and
we use that economy to test the accuracy of our approximations by comparing our
solution to one obtained with standard numerical methods.

3.1 Approximations in the simple economy
We focus here on a special case designed to show the main steps and insights transparently. We assume that all shocks are i.i.d. and that there is a single non-trivial
aggregate shock

E

and a single non-trivial idiosyncratic shock

Îµ

EÎ˜,t and ÎµÎ¸,i,t ).
si = 1, in which

(say,

Furthermore, we assume that agents have identical equity holdings

Î›t = 0 for all t. These assumptions make â„¦ the only aggregate
state variable for the t â‰¥ 1 continuation Ramsey plan; â„¦ becomes a distribution over
the two-dimensional space of z = (m, Âµ). This is the minimal structure needed to
case one can show that

9

illustrate our method.

9 The distribution of states

â„¦ is dened over a two-dimensional space because the Ramsey planner

needs to keep track of two variables for each agent: a variable capturing agent's current assets and
a variable capturing past implicit promises of the planner which comes from the need to search for
optimal policies. In the recursive formulation of competitive equilibrium with xed policies,

â„¦

is a

distribution over a one dimensional space of agents' Pareto-Negishi weights (or, equivalently, their

14

We use tildes to denote policy functions in the

tâ‰¥1

continuation Ramsey plan.

The aggregate policy functions consist of all upper-case choice variables in problem
(19) as well as Lagrange multipliers on aggregate resource constraints (5)-(7).

XÌƒ .

denote the vector of these functions by

We

Individual policy functions consist of

all lower-case choice variables in problem (19) as well as Lagrange multipliers on

xÌƒ.
dene p

individual constraints (13), (17), (18); we denote the vector of these variables by
Policy functions for individual states

zÌƒ

to be the selection matrix that returns

are included in the vector

zÌƒ

from

xÌƒ,

i.e.,

xÌƒ

and we

zÌƒ = pxÌƒ.

Consider the full set of rst-order optimality conditions to problem (19). These
conditions can be split into two groups.

The rst group consists of the optimality

conditions for individual policy functions. They show the relationship between current
period individual and aggregate policy functions

xÌƒ, XÌƒ ,

current period realizations of

Îµ, E, and expectations of currenti and next period policy functions E [xÌƒ|z, â„¦],
h
E xÌƒ(Â·, Â·, zÌƒ(z, â„¦, Îµ, E), â„¦Ìƒ(â„¦, E))|Îµ, E, z, â„¦ . To keep the notation short, we denote the
10 These conditions can be
two expectations terms by Eâˆ’ xÌƒ and E+ xÌƒ respectively.
shocks

written as





F Eâˆ’ xÌƒ, xÌƒ, E+ xÌƒ, XÌƒ, Îµ, E, z = 0
for some mapping

F.

(20)

The remaining optimality conditions are various aggregate

feasibility constraints and rst-order conditions with respect to

XÌƒ

that show the

relationship between aggregate policy functions and integrals of individual policy
functions. They can be written as



Z
R
for some mapping

R.

xÌƒdâ„¦, XÌƒ, E

=0

(21)

The law of motion for the distribution

â„¦

is

Z
e (E, â„¦) (z) =
â„¦
where

Î¹ (zÌƒ â‰¤ z)

is

1

Î¹ (zÌƒ (Îµ, E, y, â„¦) â‰¤ z) d Pr (Îµ) dâ„¦ (y)

if all elements of

zÌƒ

âˆ€z,

(22)

z,

are less than all elements of

and zero

otherwise. Equations (20)-(22) jointly determine the Ramsey allocation.
asset holdings).

10 Strictly speaking, if

xÌƒ

consists of all lower-case choice variables and multipliers in problem (19),

then the relevant object is

Eâˆ’ f (xÌƒ)

and

E+ g(xÌƒ)

for some transformations

is without loss of generality once we expand the denition of

g (xÌƒ).

15

xÌƒ

f

and

g.

Our exposition

to also include variables

f (xÌƒ)

and

To approximate policy functions, we consider a family of economies parameter-

Îµ, E . We construct rst-, second-,
and higher-order approximations with respect to Ïƒ evaluated at Ïƒ = 0. Since, the
parameter Ïƒ aects policy functions directly in addition to scaled shocks (ÏƒÎµ, ÏƒE), we
record it as an extra argument. The rst-order expansion of XÌƒ reads
ized by a positive scalar

Ïƒ

that scales all shocks



XÌƒ(ÏƒE, â„¦; Ïƒ) = XÌƒ(0, â„¦; 0) + Ïƒ XÌƒE (0, â„¦; 0)E + XÌƒÏƒ (0, â„¦; 0) + O(Ïƒ 2 )

â‰¡ XÌ„ + Ïƒ XÌ„E E + XÌ„Ïƒ + O(Ïƒ 2 ),
where

XÌƒE

and

XÌƒÏƒ

(23)

are derivatives with respect to the rst and third arguments, and

(0, â„¦; 0).
e (0, â„¦; 0).
â„¦Ì„ = â„¦

bars indicate that functions are evaluated at
to the law of motion

e (ÏƒE, â„¦; Ïƒ),
â„¦

e.g.

The same convention applies
Individual policy functions

xÌƒ

are expanded analogously as

xÌƒ(ÏƒÎµ, ÏƒE, z, â„¦; Ïƒ) = xÌ„(z) + Ïƒ (xÌ„Îµ (z)Îµ + xÌ„E (z)E + xÌ„Ïƒ (z)) + O(Ïƒ 2 ).

(24)

We describe next how to obtain the coecients that appear in these expansions by
using the implicit function theorem.

3.1.1 Points of expansion and zeroth-order terms
Our point of expansion

Ïƒ=0

law of motion for distribution
starts with any given

â„¦0 ,

is a deterministic economy. It is easy to see that the

â„¦t

is particularly simple in this case: if the economy

it remains with that distribution forever. Formally,

Lemma 1. For any â„¦, policy functions satisfy zÌ„(z) = z for any z and therefore
â„¦Ì„(â„¦) = â„¦.
The fact that the distribution remains stationary at

Ïƒ=0

simplies our analysis.

Although at rst sight this result appears to be sensitive to the simplifying assumptions made in this section, we show later that by a careful choice of the individual
state variables one can obtain an analogue of lemma 1 even if the

Ïƒ = 0

economy

features non-trivial deterministic dynamics.
Lemma 1 implies that the expectation of next period's functions is simply equal
to their current period value at the point of expansion. Therefore, we can nd

16

XÌ„

and

xÌ„(z)

as a solution to a non-linear system of equations

Z



F xÌ„(z), xÌ„(z), xÌ„(z), XÌ„, 0, 0, z = 0,

R


xÌ„(z)dâ„¦(z), XÌ„, 0 = 0.

This system can be solved eciently using standard root nding algorithms.

xÌ„(z), we construct several objects that will be
used to nd higher-order terms. Let Rx and RX be the derivatives of the R mapping
with respect to its rst two arguments, and let RE be the derivative with respect to the
scaled shock ÏƒE , all evaluated Ïƒ = 0. Similarly, let subscripts xâˆ’, x, x+, X , Îµ, E and
z denote the analogous derivatives of F with respect to each of its arguments. From
âˆ’1
Fz (z).
the implicit function theorem we have xÌ„z (z) = [Fxâˆ’ (z) + Fx (z) + Fx+ (z)]
Using the zeroth-order terms

XÌ„

and

3.1.2 First-order terms
That aggregate shocks in period

t

aect the distributional state

â„¦

in period

t+1

makes calculating mathematical expectations of next period variables in equation
(20) hard. A principal contribution of our approach is to simplify calculation of these
expectations. The rst step towards this goal is to use lemma 1 to show that

h
i


E xÌƒ(Â·, Â·, zÌƒ(z, â„¦, Îµ, E), â„¦Ìƒ(â„¦, E))|Îµ, E, z, â„¦ =xÌ„(z) + xÌ„z (z)pxÌ„E (z) + âˆ‚ xÌ„(z) Â· â„¦Ì„E ÏƒE
+ [xÌ„z (z)pxÌ„Îµ (z)] ÏƒÎµ + xÌ„Ïƒ (z)Ïƒ + O(Ïƒ 2 ),
E [xÌƒ(Â·, Â·, z, â„¦)] =xÌ„(z) + xÌ„Ïƒ (z)Ïƒ + O(Ïƒ 2 ),
âˆ‚ xÌ„ is the Frechet derivative of xÌ„ with respect to the distribution â„¦.11 The
term âˆ‚ xÌ„(z) Â· â„¦Ì„E tells how current period's shock E inuences the expectation of next
period's policy function through its eect on next period's distribution â„¦. Formally,
â„¦Ì„E is the derivative of the law of motion (22) with respect to ÏƒE evaluated at Ïƒ = 0
and âˆ‚ xÌ„(z) Â· â„¦Ì„E is the Frechet derivative âˆ‚ xÌ„(z) evaluated at the point â„¦Ì„E .
The derivative âˆ‚ xÌ„(Â·) is high dimensional. Calculating it explicitly would be infeawhere

sible when the state space is large. Luckily, we need to know the derivative only at

11 A Frechet derivative

âˆ‚ xÌ„(z) is a linear operator from the space of distributions â„¦ to R with a
kxÌ„(z,â„¦+âˆ†)âˆ’xÌ„(z,â„¦)âˆ’âˆ‚ xÌ„(z)Â·âˆ†k
property that limkâˆ†kâ†’0
= 0. It can be found by xing a feasible direction
kâˆ†k
âˆ† and calculating a directional (Gateaux) derivative since âˆ‚ xÌ„(z) Â· âˆ† = limÎ±â†’0 xÌ„(z,â„¦+Î±âˆ†)âˆ’xÌ„(z,â„¦)
.
Î±
See Chapter 7 of Luenberger (1997). Throughout, we assume that âˆ† vanishes on the boundaries of
its domain,

R+ Ã— R.

17

â„¦Ì„E . The next theorem shows that there exists
âˆ‚ xÌ„ Â· â„¦Ì„E and xÌ„E that can be solved explicitly.

the point
between

a simple linear relationship

Theorem 1. (Factorization) From the zeroth-order expansion one can construct
matrices A(z) and C(z) such that

âˆ‚ xÌ„(z) = C(z)âˆ‚ XÌ„,
Z
âˆ‚ xÌ„(z) Â· â„¦Ì„E = C(z)âˆ‚ XÌ„ Â· â„¦Ì„E = C(z) A(y)xÌ„E (y)dâ„¦ (y) .
| {z }

(25a)
(25b)

XÌ„E0

Proof.

Evaluate the Frechet derivatives of (20) and (21) at an arbitrary point

use the fact that

âˆ‚ â„¦Ì„ = 1

âˆ†

and

from lemma 1 to show that

(Fxâˆ’ (z) + Fx (z) + Fx+ (z)) âˆ‚ xÌ„(z) Â· âˆ† + FX (z)âˆ‚ XÌ„ Â· âˆ† = 0,
Z

Rx âˆ‚
xÌ„ (y) dâ„¦ (y) Â· âˆ† + RX âˆ‚ XÌ„ Â· âˆ† = 0.

(26a)
(26b)

C(z) = âˆ’ (Fxâˆ’ (z) + Fx (z) + Fx+ (z))âˆ’1 FX (z).
derivatives in direction âˆ† we can show that

The rst equation yields (25a) with
By calculating directional

Z
âˆ‚


Z
Z
xÌ„ (y) dâ„¦ (y) Â· âˆ† = (âˆ‚ xÌ„ (y) Â· âˆ†) dâ„¦ (y) + xÌ„ (y) dâˆ† (y) .
âˆ† = â„¦Ì„E .

We want to evaluate the integral on the right side at
any

z = (m, Âµ)

Z

â„¦Ì„E (m, Âµ) = âˆ’

mÌ„E (m, y2 ) Ï‰ (m, y2 ) dy2 âˆ’
y2 â‰¤Âµ

where

Ï‰

Dierentiating (22) at

and applying lemma 1, we show that

Z

is the density of

Ï‰Ì„E (m, Âµ) = âˆ’

ÂµÌ„E (y1 , Âµ) Ï‰ (y1 , Âµ) dy1 ,
y1 â‰¤m

â„¦.

The density of

â„¦Ì„E (m, Âµ)

is then

d
d
[mÌ„E (m, Âµ) Ï‰ (m, Âµ)] âˆ’
[ÂµÌ„E (m, Âµ) Ï‰ (m, Âµ)] .
dm
dÂµ

18

(27)

Substitute this equation and (25a) into (27) to get

Z
âˆ‚


Z
Z
d
[mÌ„E (y) Ï‰ (y)] dy
xÌ„ (y) dâ„¦ (y) Â· â„¦Ì„E = C(y)âˆ‚ XÌ„ Â· â„¦Ì„E dâ„¦ (y) âˆ’ xÌ„ (y)
dm
Z
d
âˆ’ xÌ„ (y)
[ÂµÌ„E (y) Ï‰ (y)] dy
dÂµ
Z
Z
= C(y)âˆ‚ XÌ„ Â· â„¦Ì„E dâ„¦ (y) + xÌ„z (y) pxÌ„E (y) dâ„¦ (y) ,

where the second equality is obtained using integration by parts.
expression into (26b) and solve for

XÌ„E0
where

A(z) = âˆ’ Rx

R

âˆ‚ XÌ„ Â· â„¦Ì„E

Substitute this

to obtain

Z
â‰¡ âˆ‚ XÌ„ Â· â„¦Ì„E =

C(y)dâ„¦ (y) + RX

A(y)xÌ„E (y)dâ„¦ (y) ,

âˆ’1

Rx xÌ„z (z)p.

(28)

Together with (25a) this proves

(25b).
The factorization theorem makes our approach computationally tractable when

â„¦ is large. To see its signicance, suppose that we approximate â„¦ on a
grid with K points. In that case, the Frechet derivative of individual policy func2
tions âˆ‚ xÌ„(Â·) contains K unknown elements. Since the number of the unknowns grows
exponentially with the number K of grid points, calculating this derivative directly
would be infeasible for large K . Theorem 1 circumvents this problem by providing an
explicit formula for the value of the derivative âˆ‚ xÌ„(Â·) at the point â„¦Ì„E as a linear function of (yet unknown) xÌ„E (z) weighted with coecients given by matrices A(z), C(z).
Matrices A(z), C(z) can be calculated quickly from the zeroth-order terms since the
state space

only non-linear operation required is inversion of matrices of dimension no greater
than
of

z

max {dim x, dim X}.

Because

A(z), C(z)

can be calculated for dierent values

independently, the algorithm is easy to parallelize, a good thing when

K

is very

large.
An economic intuition underlies derivations in the proof of theorem 1. In competitive equilibrium agents care about the distribution

â„¦

only to the extent it aects

aggregate prices and income. Thus, the eect from any perturbation of distribution

â„¦

âˆ‚ xÌ„, can
âˆ‚ XÌ„ , and a

on individual variables,

on aggregate variables,

be factorized into the eect of that perturbation
known loading matrix

C

that captures how indi-

vidual variables respond to changes in the aggregates. Equation (25a) captures this

19

relationship. Feasibility and market clearing constraints impose a tight relationship
between individual policy function responses to aggregate shocks in the current period,

xÌ„E (z),

and expected future changes in the aggregates,

XÌ„E0 .

Conceptually, this

relationship is the a xed point problem and we derive an explicit solution in equation
(28). Together with (25a), this allows us to nd
to compute

âˆ‚ xÌ„Â· â„¦Ì„E

in terms of

xÌ„E

without having

âˆ‚ xÌ„(Â·).

We can now take the rst-order expansion of (20) and (21), apply the factorization
theorem, and use the method of undetermined coecients to nd
We illustrate how this is done for

XÌ„E , xÌ„E .

XÌ„E , XÌ„Ïƒ , xÌ„E , xÌ„Îµ , xÌ„Ïƒ .

Consider the rst-order expansion of the

left hand side of equations (20) and (21). Because this expansion should be equal to

0

for all values of

E,

the matrices of coecients that multiply

E

should equal

0

as

well. Solving for these matrices explicitly, we obtain a system of equations

(Fx (z) + Fx+ (z)xÌ„z (z)p) xÌ„E (z) + Fx+ (z)C(z)XÌ„E0 + FX (z)XÌ„ E + FE (z) = 0,
Z
Rx xÌ„E (y)dâ„¦ (y) + RX XÌ„ E + RE = 0.
This is a linear system with unknowns

XÌ„E , xÌ„E

(29a)
(29b)

after we substitute the denition of

XÌ„E0

from (28). Solving the discretized version directly would require inverting a square
matrix of dimension

K dim x,

which is impractical when the dimension of the grid

(K ) is large. A more computationally ecient approach is to split this system into

K

independent systems of dimensions

dim x

end, use equation (29a) to calculate matrices

that can be solved in parallel. To this

D0 (z)

and

D1 (z)

relationship

xÌ„E (z) = D0 (z) + D1 (z) Â·

h

XÌ„ E XÌ„E0

iT

that dene the linear

.

Then use this relationship to substitute into equations (29b) and (28) to nd
Values of

xÌ„E (z)

XÌ„ E .

can be found either by substituting back into the previous equation

or from (25a).
The remaining unknown rst-order coecients

XÌ„Ïƒ , xÌ„Îµ , xÌ„Ïƒ

can be found using sim-

ilar steps. The steps for computing them are much simpler since they do not depend
on the Frechet derivative

âˆ‚ xÌ„.

20

3.1.3 Second- and higher-order expansions
Our approach extends to second- and higher-order expansions while preserving the
computationally convenient linear structure. The key insight is that the factorization
theorem generalizes to higher order expansions. The analogue of equation (25a) holds
for any order of perturbations of
of

âˆ‚ xÌ„ Â· â„¦Ì„E

â„¦.

This allows us to solve for higher order analogues

explicitly as weighted sums of higher-order coecients

with weights known from lower-order expansions.

xÌ„EE , xÌ„EÏƒ , xÌ„ÏƒÏƒ . . .,

We then can form higher order

analogues of the system of equations (29). As before, the mathematical structure of
these equations allows us to split one large system of equations into a large number of
low dimensional linear problems that can be solved fast and simultaneously. Formal
proofs and constructions are notation-intensive but the steps mirror those in section
3.1.2 and we conne them to the online appendix.

3.2 Approximations in the general case
We now turn to the economy described in section 2. For concreteness we focus on the
case when

ln Î˜t follows an AR(1) process (9a).

This economy has two dierences from

the section 3.1 simpler economy. First, since shocks are persistent, policies also depend
on previous period values

Î˜ = (Î˜, Î¦)

Î¸.

and

Second, the Philips curve constraint

Î› becomes a state variable. Thus, in
individual state, â„¦ is a distribution over

(15) generally binds and its Lagrange multiplier
the general economy

z = (m, Âµ, s, Î¸)

is the

this four-dimensional state space, and the aggregate and individual policy functions
are mappings

XÌƒ (E, â„¦, Î˜, Î›)

and

xÌƒ (E, Îµ, z, â„¦, Î˜, Î›)

respectively.

To make progress, we assume that persistence of idiosyncratic shocks
1 so that we can represent it as

ÏÎ¸ = 1 âˆ’ ÏƒÏ

for some

Ï â‰¥ 0.

ÏÎ¸

is close to

We follow the approach

of the previous section by considering a sequence of economies with scaled shocks
and

ÏƒÎµ

and persistence

respect to

xÌ„ (z, Î˜, Î›)

Ïƒ

evaluated

ÏƒE

1 âˆ’ ÏƒÏ. We take their rst- and second-order expansion with
at Ïƒ = 0 around any given distribution â„¦. Let XÌ„ (Î˜, Î›) and

be their zeroth-order values.

Our general economy can have non-trivial dynamics even when

Ïƒ = 0.

This would

present a diculty if the complicated part of the state space  the distribution

â„¦



also changed over time. A judicious choice of state variables allows us to avoid this
complication.

21

Lemma 2. For any â„¦, policy functions satisfy zÌ„ (z, Î˜, Î›) = z for any (z, Î˜, Î›) and
therefore â„¦Ì„ (Î˜, Î›) = â„¦ for any Î˜, Î›.
The intuition is as follows.

There are multiple mathematically equivalent ways

to choose individual state variables.

m

We chose them to be Pareto-Negishi weights

and multipliers on implementability constraints

Âµ.

In the deterministic economy

(or, more generally, in a complete market economy as in Lucas and Stokey (1983)
or Werning (2007)) these weights are constant over time, even when other choices of
state variables, such as agents' debt levels, would not be.
Lemma 2 paves a way for the natural extension of our algorithm from section
3.1.

Start with any

{Î˜t , Î›t }t

Î˜Ì„ = Î˜Ì„, Î¦Ì„ ,
as

(Î˜0 , Î›0 )

and compute the deterministic transition dynamics

converge to the steady state.

The steady state value of

Î˜

is simply

Î›, that we denote by Î›Ì„, is pinned down

by a single non-linear equation Î›Ìƒ 0, â„¦, Î˜Ì„, Î›Ì„; 0 = Î›Ì„. Theorem 1 and its higher-order
generalizations continue to hold along the transition path of {Î˜t , Î›t }t , allowing one to
while the steady state value of

solve for the coecients in expansions of policy functions using backward induction,
as in Anderson et al. (2012).

XÌƒ (E, â„¦, Î˜, Î›) around Î˜ = Î˜Ì„ and Î› = Î›Ì„ rather
than solving for the full transition dynamics {Î˜t , Î›t }t . The online appendix describes
expanding

xÌƒ (E, Îµ, z, â„¦, Î˜, Î›)

This procedure can be further simplied by simply
and

how implement both approaches.

4 Calibration and computations
We choose three sets of parameters: (i) parameters governing preferences, technology and aggregate shocks; (ii) initial conditions; and (iii) stochastic processes for
idiosyncratic shocks.

Preferences, technology, aggregate shocks
Our settings of aggregate parameters align with standard representative agent calibrations such as Schmitt-Grohe and Uribe (2004) and Siu (2004).
function parameters at

Î½ = 1 , Î³ = 2,

and the discount factor

Î²

We set utility

at 0.96. We assume

that rms operate a constant returns to scale technology and set Î± = 1. To a rst
âˆ’1
approximation, average markups are Î¦Ì„ âˆ’ 1
and the slope of the Phillips curve is


Î¦Ì„ âˆ’ 1 /Ïˆ .

We set

Î¦Ì„ = 6

to attain average markups of

22

20%

and

Ïˆ = 20

to match

12 We set government

the slope of the Phillips curve as estimated by Sbordone (2002).
non-transfer expenditures

GÌ„ at 0.09 in order to match the average federal government

current expenditures net of transfer payments to annual GDP from the NIPA for the
period 1947-2016.
The stochastic process for the markup shocks is calibrated to be consistent with
that estimated in Smets and Wouters (2007) with the AR coecient of
volatility of the innovation to

ln Î¦

0.65

and the

such that a one standard deviation negative shock

EÎ¦ raises rms' optimal markups by about 0.5 percentage points. We set the standard
deviation of EÎ˜ at 3% to approximate the process for output per worker in the U.S.
In the AR(1) specication of TFP shocks we set ÏÎ˜ = 0.8 and Î˜Ì„ = 1.

Initial conditions
We use the 2007 wave of the Survey of Consumer Finances (SCF) to calibrate the
initial distribution of wages, debt, and equity holdings.
married households who work at least 100 hours.

We restrict our sample to

To measure bond holdings, we

sum direct and indirect holdings of government bonds through mutual funds (taxable
and nontaxable), saving bonds, liquid assets (net of unsecured credit), money market
accounts, and components of retirement accounts that are invested in government
bonds. To measure equity holdings we sum direct holdings of equities and indirect
holdings through mutual funds and retirement accounts.
To t initial states

{Î¸i,âˆ’1 , bi,âˆ’1 , si }

13

to data, we sample directly from the SCF

log wages, debt and shares of equity using 2007 wave sampling weights.
provides population weights for each observation.

The SCF

Given these weights, we set the

initial condition by drawing with replacement a random sample of 100000 agents from
a discrete distribution. In our SCF sample,

30% of households hold zero equities;

the

distribution of equities among the remaining households is right skewed with the top
10% of agents holding about 60% of total equities. Debt holdings, equity holdings,
and wages are positively correlated. Table I reports summary statistics of the data
and our t.

12 Using quarterly data, Sbordone (2002) estimates the slope of the U.S. Phillips curve to be about
0.06. Since our calibration uses annual frequency, we multiply her number by 4.

13 We drop observations where equity or bond holdings are more than 100 times average yearly

wage. These turned out to be about 0.5% of the total sample.

23

TABLE I: FIT OF THE INITIAL DISTRIBUTION

Data

Model

fraction of pop. with zero equities

30%

30%

std. share of equities

2.62

2.61

std. bond

4.90

5.23

std. ln wages

0.81

0.82

corr(share of equities,ln wages)

0.40

0.39

corr(share of equities,bond holdings)

0.59

0.55

corr(bond,ln wages)

0.32

0.30

Notes: The moments in the data column corresponds to SCF 2007 wave with sample restrictions
explained in the text and after scaling wages, equity holdings, and debt holdings by the average
yearly wage in our sample. The share of equities refers to the ratio of individual equity holdings to
the total in our sample such that the weighted sum of shares equals one.

Stochastic process for idiosyncratic shocks
We set the stochastic process for idiosyncratic shocks to match some facts about
labor earnings reported by Storesletten et al. (2004) and Guvenen et al. (2014). In
the model, labor earnings depend both on the stochastic process for skill

i,t

and on

monetary-scal policy. We calibrate them to t a competitive equilibrium in which
interest rates and tax rates are set to match stylized features of U.S. policies, namely,

Qâˆ’1
t âˆ’1 =

1
+ 1.5Î t ,
Î²

Î¥t = 0.25.

(30)

This Taylor rule parameterization for nominal rates is common in the literature, while
the calibrated tax rate matches estimates of the federal average marginal income tax
rate reported by Barro and Redlick (2011), who also show that it is largely acyclical
at business cycle frequencies.
To calibrate parameters governing stochastic processes (10) and (11), we simulate
log earnings for 100000 agents using a competitive equilibrium with the initial condition and government policies as described above. Shocks

Îµ,i,t , ÎµÎ¸,i,t

are Gaussian.

Storesletten et al. (2004) estimates a transitory/persistent component model of log
earnings using the PSID. We targeted their estimates by setting the parameter

ÏÎ¸

to

match the autocorrelation of the persistent component of log earnings, parameters

std(Îµ,i,t ), std(ÎµÎ¸,i,t )

to match the standard deviation of the transitory and persistent

24

TABLE II: PARAMETERS FOR IDIOSYNCRATIC SHOCKS PROCESSES

Parameters
s.d of

Values

Targeted moment

Values

Source

0.17

s.d. of transitory

0.25

Storesletten

Îµ

component in log earnings
s.d. of

ÎµÎ¸

0.12

s.d. of persistent

et al. (2004)
0.12

component in log earnings

ÏÎ¸

0.99

autocorr of persistent

0.99

component in log earnings

0.28,âˆ’0.52,
0.00

f2 , f1 , f0

relative (to median)
th
th
earnings losses 5 , 50
95th percentiles

&

see

Guvenen

text

et al. (2014),
see gure I

Notes: The parameters in this table characterize the stochastic processes in equations (10) and (11).

components of log earnings.

14

Guvenen et al. (2014) report earnings losses in the four recessions between 19782010 by percentiles of 5 year averages of pre-recession earnings.

These provide us

f (Î¸). We assume a
{f0 , f1 , f2 } as follows. We rst

with moments that we use to construct the loading function
quadratic form

f (Î¸) = f0 + f1 Î¸ + f2 Î¸

2

and calibrate

normalize Guvenen et al. (2014) reported earning losses for each percentile by the
median earnings losses and average across all four recessions to obtain a prole of
relative (to median) earnings losses.

This is the dashed line in gure I.

We next

simulate the competitive equilibrium for 50 periods with a recession that is ignited
by one standard deviation negative TFP shock. Following the empirical procedure
in Guvenen et al. (2014), we rank workers by percentiles of their average log labor
earnings

5

years prior to the shock and compute the percent earnings loss for each

percentile relative to the median. The parameters
losses of the

th

5

,

th

50

and

th

95

f0 , f1 , f2

are set to match earnings

percentiles. Our model's counterpart to Guvenen et al.

(2014) is the solid line in gure I. Parameters governing the process for idiosyncratic
shocks are summarized in table II.

14 In the model, we compute these cross-sectional moments by simulating a panel of log earnings
from the competitive equilibrium with 100000 agents after turning o aggregate shocks for a sample
of length 50 periods.

25

Earnings losses (relative to median) in a recession

2.5

data
model

2

1.5

1

0.5
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

percentiles
Figure I: Relative (to median) earnings losses by percentiles of 5 year average pre-recession
log earnings. The data line is constructed using moments from Guvenen et al. (2014) who
report the prole of earnings losses in the last 4 recessions (1978-2010). In the model line,
we use simulated earnings before and after a one standard deviation TFP shock.

26

Computations
We use our second-order expansion formulas to approximate Ramsey policies. To com-

Î¥Ì„ to the optimal level in the non-stochastic

pute the optimal monetary policy, we set

environment with the same the initial condition. At every history we discretize the
distribution across agents with

K = 2000

grid points that we choose each period us-

ing a k-means clustering algorithm. We apply our algorithm to approximate optimal
policies, use Monte Carlo simulation to draw idiosyncratic shocks and nally compute
the aggregate distribution next period for a given history of aggregate shocks. The algorithm is then repeated with the new distribution. The details of how to implement
the simulation steps are in the online appendix.
We focus on optimal policy responses to aggregate shocks

EÎ¦,t , EÎ˜,t .

These re-

sponses depend on the underlying state. To compute them we draw 100 histories of

{EÎ¦,t , EÎ˜,t }25
t=0 . To calculate an impulse response, say, to productivity shock
EÎ˜,k , of size Î´ in period k , we create two replicas of these draws. In one replica we
replace EÎ˜,k from 0 and in the other with Î´ . We then integrate over all histories to obtain expected paths conditional on EÎ˜,k = 0 and on EÎ˜,k = Î´ . Our impulse responses
shocks

are the dierences in the two paths. Since those paths are the same by construction
for all

t < k,

we draw all the graphs starting with

all responses for

t = k.

For concreteness we report

k = 5.15

5 Results
We study optimal monetary and monetary-scal responses to one standard deviation
negative shocks to

EÎ¦,t

and

EÎ˜,t .

These responses are primarily shaped by two goals.

The rst is price stability, which is also present in representative agent New Keynesian
models.

Price changes are costly and by pursuing stable prices the planner can

mitigate these costs.

The second is provision of insurance, a goal that arises from

heterogeneity and market incompleteness because aggregate shocks aect dierent
agents dierently.

If agents could trade a complete set of Arrow securities, they

would insure these shocks away and maintain constant consumption shares.

Our

15 As often occurs (for example, see Lucas and Stokey (1983), Schmitt-Grohe and Uribe (2004))
Ramsey policy at time

t=0

diers from continuation Ramsey policies for

of dierent arguments. In our economy, by

t = 5,

dissipated.

27

transient eects of time

t > 1, being functions
0 actions have mostly

assumptions rule out those trades. The planner uses monetary and scal policies to
make the distribution of gains and losses more equal.
In what follows we compare optimal responses in our economy to those in a representative agent version that shuts down all idiosyncratic shocks and heterogeneity
across agents. The RANK economy provides a useful benchmark because it isolates
the role of price stability concerns. We refer to our baseline setting with heterogeneous agents as HANK and the representative agent counterpart as RANK. When we
study Ramsey monetary policy, for each economy we x

Î¥Ì„

at the associated optimal

level in the non-stochastic environment. In the RANK economy it is

Î¥Ì„ = âˆ’1/Î¦Ì„.

5.1 Optimal Responses to Markup Shocks
We start by considering the optimal response to a negative innovation in
shock increases the desired markup
shock.

1/(Î¦t âˆ’ 1),

EÎ¦,t .

As this

we refer to it as a positive markup

Figure II shows (solid line) that the planner responds to a 0.5 percentage

points increase in markups by cutting the nominal interest rate by 0.3 percentage
points. This response boosts output, ination and real wages. The optimal policy
response to a markup shock diers signicantly from that in the representative agent
model (dashed line).
To understand economic forces behind these results, consider implications of the
shock for price stability and insurance. A negative innovation to
desired markups over marginal costs which,
increase nominal prices.

ceteris paribus,

EÎ¦,t

increases rms'

makes rms want to

To reduce the cost of price changes the planner can aim

to lower marginal costs by increasing the nominal interest rate, thereby depressing
aggregate demand and real wages, which reduces marginal costs.

Dubbed leaning

against the wind by GalÃ­ (2015), this response is optimal in representative agent
New Keynesian economies. The interest rate increase that maintains stable prices is
modest (see the dashed line).
Now turn to the insurance considerations. Higher markups increase dividends and
lower the real wage. This benets agents who own a lot of equities and hurts agents
who mainly rely on labor income. To provide insurance that osets the dierential
impact of the markup shock, the planner can aim to increase the real wage by cutting
the nominal interest rate and boosting aggregate demand.
Thus, the Ramsey planner's concerns about price stability and insurance have

28

Ination

Nominal rate

2

0
%

pts

0.5
RANK
HANK

âˆ’0.5

Tax rate

0

2

4

6

0

0

âˆ’1

8 10

0

Log output

0.5

2

4

6

0

8 10

4

6

8 10

Markup shock

Pre-tax wage

1

pts

%

2

0
0

0
âˆ’1
0

2

4

6

8 10

0

2

4

years

6

8 10

0

2

4

6

8 10

years

years

Figure II: Optimal monetary response to a markup shock

opposite implications for an optimal monetary response. Figure II shows that quantitatively the planner's intention to provide insurance swamps the intention to stabilize
prices. To understand why the insurance motive is so strong, think about how the
distribution of gains and losses from the shock depends on asset inequality. The insurance motive is least active when rm ownership is widely dispersed among agents
and most active when ownership is very skewed.

Data portray the distribution of

stock market wealth as highly unequal, much more than the distribution of labor
earnings. That makes the insurance motive relatively strong.
Figure III shows optimal monetary-scal responses to a markup shock. The planner temporarily increases tax rates and lowers nominal interest rates. This combination of policies increases the pre-tax wage

W

and ination.

Labor taxes allow the planner to completely oset the inationary consequences
of the markup shock. If taxes are decreased to make the path of
of the shock, then the after-tax wage

(1 âˆ’ Ï„ ) W

1âˆ’Ï„

mirror the path

and ination are both unchanged.

Since this tax response osets the eect of the shock on ination, the planner need not
change the nominal interest rate. In representative agent New Keynesian economies
(dashed line) this policy achieves the rst best.
In our economy, this scal response to an aggregate shock damages insurance pro-

29

Ination

Nominal rate

2

0
%

pts

0.5
RANK
HANK

âˆ’0.5

0

2

4

6

0

0

âˆ’1

8 10

0

Log output

2

4

6

0

8 10

2

4

6

8 10

Markup shock

Pre-tax wage

3

0.5

2

pts

%

Tax rate

0

1
0

0
âˆ’1
0

2

4

6

8 10

0

2

years

4

6

8 10

0

2

4

6

8 10

years

years

Figure III: Optimal monetary-scal response to a markup shock

vision. When tax rates are lowered, the planner has to decrease transfers in order to
satisfy the government's budget constraint. That makes average taxes more regressive and amplies the adverse eect of the markup shock on low-wage households.
To provide insurance, the planner wants to make the tax system more progressive by
increasing transfers funded by higher marginal tax rates.

It is optimal to combine

this scal policy with loose monetary policy because that osets the negative eect of
tax rate increases on output. Quantitatively, the insurance considerations dominate
the optimal scal response.
In contrast to tax-smoothing prescriptions of Barro (1979) and Aiyagari et al.
(2002), the optimal tax rate increase is short-lived.

This is because transitory tax

changes are less distortionary than permanent changes when price are sticky.
permanent increase in tax rates has no eect on real pre-tax wages

W

A

as in the long

run rms set their prices as a constant markup over wages. As a result, a permanent
tax rate change increases the labor distortion

(1 âˆ’ Ï„ ) W

one for one.

In contrast,

rms nd it suboptimal to adjust prices fully to a transient tax rate increase. Thus, a
transitory tax rate increase raises the pre-tax wage and has little (zero, in a continuous
time limit) eect on the labor distortion.

30

5.2 Optimal Responses to Productivity Shocks
Price stability and insurance provision also shape Ramsey responses to productivity
shocks. A well-known prescription for price stability is to move nominal interest rates
one for one with changes in the natural rate of interest  the real interest rate that
would prevail without nominal frictions. Consumers' Euler equations then ensure that
ination remains unchanged in response to the shock. The growth rate specication
for productivity shocks in (9b) keeps the natural rate constant providing us with a
clean way to isolate the insurance motive.
Figure IV shows the optimal monetary response to a negative innovation in

EÎ˜,t .

This response is driven purely by insurance concerns: in the RANK economy where
these concerns are absent, the planner optimally keeps interest rates and ination
unchanged. Several economic forces explain why lower aggregate productivity generates insurance motives in our model. One is heterogeneity in bond holdings. Incomes
of agents who hold a lot of non-state-contingent bonds suer less from an adverse
productivity shock than incomes of agents who are in debt.
even if wages of all agents are the same.

This eect is present

Two features in the data that we target

amplify this dierential eect: (i) low wage workers typically have fewer assets, and
(ii) the direct exposures of labor earnings to aggregate productivity shocks are large
for low wage workers, captured by the shape of our loading function

f.

To provide insurance, the planner wants to transfer resources from high income to
low income agents. Since debt is nominal, that can be done by lowering ex-post real
returns on debt after a negative

EÎ˜,t

shock. A lower return makes the distribution

of losses between savers and borrowers more equal. The planner lowers realized real
returns on the nominal asset by cutting nominal interest rates, thereby increasing

16

ination. The policy response is sizable but short lived.

Figure V shows an optimal monetary-scal response to an aggregate productivity
shock. When the planner has access to scal policy, increasing transfers funded by
higher labor tax rates provides insurance against the adverse productivity shock.
First, more progressive average taxes redistribute labor income towards low-wage,
low-asset agents.

This by itself would mandate a persistent increase in tax rates

16 Recall that we follow the usual convention in the New Keynesian literature and assume that
debt matures in one period. With longer debt maturity, the decreases in nominal interest rates and
increases in ination are smaller but more persistent which allows the planner to lower the cost of
nominal price adjustments.

31

Nominal rate

Tax rate

Ination

2
0.5

%

pts

0

0

RANK

âˆ’0.5

HANK

0

2

4

6

0

âˆ’1
0

8 10

2

4

6

8 10

0

Ex-post real returns

Output growth

2

4

6

8 10

TFP growth

0

0

âˆ’2

âˆ’0.5

âˆ’2

%

pts

0

0

2

4

6

8 10

0

2

4

6

8 10

0

years

years

2

4

6

8 10

years

Figure IV: Optimal monetary response to a productivity growth rate shock

because the increase in inequality is long lived.
changes in the pre-tax wage.

But a second force works through

With costly price adjustments, a temporary spike in

marginal taxes rates raises real wages. Together these two eects explain the responses
of optimal tax rates in gure V. Although nominal interest rates move little, that
behavior masks a substantial departure from natural interest rate targeting.

The

response of optimal tax rates increases the natural rate in the rst period, putting
the nominal rate substantially below it. The dierence between nominal and natural
interest rates follows a path that is similar to that in gure IV. This explains the spike
in ination that provides insurance through lower realized returns on bond holdings.
Now consider the alternative AR(1) specication of productivity shocks in equation (9a). A negative shock

EÎ˜,t

predicts a higher growth rate of

Î˜t+k

in the future.

This raises the natural rate, so in order to attain price stability the planner would
want to raise the nominal interest rate as well. This is the main dierence from the
growth rate specication of productivity shocks. In particular, once we look at the
dierence between nominal and natural rates instead of the nominal interest rate itself, counterparts of gures IV and V are very similar in both cases. We report them
in the online appendix where we also explain how to extend the notion of the natural
rate to our HANK economy.

32

Ination

Nominal rate

pts

0.5

Tax rate

2

0.5

%

0
0

RANK

âˆ’0.5

HANK

0

2

4

6

0

8 10

âˆ’1
0

Output growth

2

4

6

2

4

6

8 10

TFP growth

Ex-post real returns

0

0
0

pts

%

0

8 10

âˆ’2

âˆ’2
0

2

4

6

âˆ’0.5
8 10
0

2

years

4

6

years

8 10

0

2

4

6

8 10

years

Figure V: Optimal monetary-scal response to a productivity growth rate shock

5.3 Taylor Rules
We explore how well a Taylor rule approximates the Ramsey plan. To this end we
x tax rates as in sections 5.1 and 5.2 but assume that monetary policy follows the
interest rule specied in equation (30).
Figure VI compares responses of interest rates and ination under the Ramsey
plan and the Taylor rule.

The left panel (black lines) in gure VI shows that the

responses implied by the Taylor rules are too small, too persistent, and, in the case of
markup shocks, are in the opposite direction of the optimal responses. We could have
anticipated that a Taylor rule does a poor job of approximating the Ramsey responses.
In sections 5.1 and 5.2, we emphasized that the main economic force driving optimal
policy is the need to provide insurance; Taylor rules are designed to achieve price
stability.

In the right panel (red lines) in gure VI we plot responses to markup

and TFP shocks in the representative agent economy and nd that qualitatively, the

17

interest rate and ination both behave similarly under Ramsey and Taylor policies.

17 In the RANK economy it easy to improve the t further by small changes in the coecients in
the Taylor rule. For example, if we set the coecient on ination to 5, the two responses lie almost
perfectly on top of each other. This is not surprising and previous studies, for instance Woodford
(2003) and GalÃ­ (2015), also nd that Taylor rules approximate the optimal Ramsey policies well in

33

HANK

0.5

0

Nominal rate

Ination

Ination
Taylor

Taylor

Optimal

pts

Optimal

0.05

%

0.05
0
âˆ’0.5

0
0

2

4

6

0

8

2

4

6

8

0
0

0

2

4

6

8

1

1

0

0

0

2

4

6

8

0

2

4

6

8

pts

0.5

%

TFP shock

Markup shocks

Nominal rate

RANK

âˆ’0.5

0
0

2

4

6

8

âˆ’1
0

years

2

4

6

8

years

âˆ’1
0

2

4

6

8

years

years

Figure VI: Comparing optimal monetary responses to Taylor rule in HANK (black, left
panel) and RANK (red, right panel) models. The solid line is the optimal response and the
dashed line is the response in a competitive equilibrium with it

= iÌ„ + 1.5Ï€t .

For TFP shocks

we use the growth rate specication (9b).

The diculty with a Taylor rule lies not only in its conventional parameterization
but in a restriction that it implicitly imposes on the persistence of interest rates and
ination. Under a Taylor rule, persistence of nominal interest rates is inherited from
the persistence of exogenous aggregate shocks. Thus, a long-lived markup shock implies long-lived changes in nominal rates and ination. A motive to provide insurance
in the HANK economy often requires transient and short-lived changes in interest
rate and ination. These are dicult to implement with standard Taylor rules.

6 Extensions and robustness
We consider several extensions to the section 2 environment.
a class of representative agent settings.

34

6.1 Heterogeneity in the marginal propensity to consume
Our baseline specication combines a New Keynesian framework with a standard
Bewley-Aiyagari model of idiosyncratic shocks and imperfect insurance. A well known
limitation of Bewley-Aiyagari models is that they fail to generate sucient heterogeneity in marginal propensities to consume (MPCs).

18 That prediction is at odds

with the data. For example, Jappelli and Pistaferri (2014) document large dierences
in MPCs across agents and show that MPCs systematically co-vary with wealth.
Recent studies (Auclert (2017), Kaplan et al. (2018)) stress the role of MPC heterogeneity in transmitting changes in interest rates. We are interested in implications of
MPC heterogeneity for

optimal

monetary policy.

We follow Jappelli and Pistaferri (2014) and augment our model with hand-tomouth agents. These agents can own equities and consume dividends (in addition
to labor income) but cannot trade nancial assets over time. Thus, we modify our
baseline set up to allow two dimensions of permanent heterogeneity, equity holding

si

and a new variable

hi ,

where

hi âˆˆ {0, 1}

indicates whether or not individual

i

is a

hand-to-mouth type. We assume that the probability of being hand-to-mouth is

Pr(hi = 1|si ) = a0 + a1 Ã—Percentile (si ),
and re-calibrate our model by choosing parameters

a0

and

a1

to match the MPC

gradient with respect to wealth reported in Jappelli and Pistaferri (2014) in addition
to our calibration targets in section 4. Table III shows Jappelli and Pistaferri (2014)
numbers and the goodness of t of our calibration.
This approach is in line with Kaplan et al. (2018) who model MPC heterogeneity
using a Bewley-Aiyagari model with costly adjustment between liquid and illiquid
assets. Their baseline calibration makes MPC higher for agents with low liquid wealth,
and about two thirds of agents with zero liquid wealth have positive illiquid wealth.
Our specication captures both features, with high-s hand-to-mouth agents behaving
like wealthy hand-to-mouth agents in Kaplan et al. (2018).
Frictions in trading nancial assets segment agents into those who are unconstrained and are on their Euler equation and those who are constrained and at strict

18 In our baseline model agents trade subject to the natural borrowing limit. The same conclusion
also holds for economies when agents face ad-hoc borrowing limits, except for a small mass of agents
near that limit.

Krusell and Smith (1998) refer to this property in such models as approximate

aggregation.

35

TABLE III: MODEL FIT FOR MPC HETEROGENEITY

Parameters

Values

Moment

Data

Model

a0

-0.35

MPC for 10 percentile of Cash on Hand

0.62

0.63

a1

0.75

MPC for 90 percentile of Cash on Hand

0.35

0.33

Notes: The data column is obtained from gure 2 of Jappelli and Pistaferri (2014) who report average MPC out
of transitory income shock by percentiles of cash on hand (CoH) where CoH is dened as the sum of household
disposable income and nancial wealth, net of consumer debt. In the model we compute CoH as the sum post - tax
wage earnings, holdings of debt and equities.
Euler inequalities. Ramsey plans are still determined by price stability and insurance
concerns but now they take the dierent policy responses of these two groups into
account. In a setting with trading frictions, the eectiveness of monetary policy depends on the mechanism through which nominal rates provide insurance. To see this
we compare the responses to markup and TFP shocks.
In the top row of gure VII we see that in response to a positive markup shock
the planner still decreases the nominal interest rate, but not by as much as in the
baseline model. Recall from section 5.1 that, by stimulating aggregate demand, cuts
in interest rates provide insurance after a markup shock. Changes in interest rates
directly aect only agents who are on their Euler equation, and so trading frictions
diminish the ability of monetary policy to inuence aggregate demand. In contrast,
the bottom row of gure VII shows that the response of interest rates to a TFP
shock is virtually unaected by trading frictions. In this case, the planner provides
insurance by lowering real returns on nominal debt. Asset prices are determined only
by a marginal investor. Thus, in spite of trading frictions, monetary policy behaves
similarly to the benchmark case.
Figure VII also shows the importance of transfers in providing insurance when
agents face frictions in trading assets. In our baseline economy agents borrow subject
to natural debt limits, so Ricardian equivalence holds and the timing of transfers
is irrelevant. When some agents are constrained in their abilities to trade nancial
assets, transfers become an eective tool for aecting aggregate demand and real
wages. For example, in response to a markup shock the planner increases transfers
to stimulate aggregate demand. This leads to a spike in ination of about the same
magnitude as in the baseline economy despite a much smaller cut in nominal interest

36

0

0.4

pts

âˆ’0.1

0.2

âˆ’0.2

0

âˆ’0.3

pts

%

TFP shock

0

2

4

6

âˆ’0.2
0
8 10

0

0.6

âˆ’0.2

0.4
Benchmark

0

2

4

6

2

4

6

0.15
0.1
0.05
0
8 10
0

2

4

6

8 10

4

6

8 10

0
âˆ’0.2

0.2

HTM

âˆ’0.4

Transfers/Output

Ination

%

Markup shock

Nominal rate

0

8 10

0

2

4

6

âˆ’0.4
8 10
0

2

years

years

years

Figure VII: Optimal monetary responses with hand-to-mouth agents.

rates. Transfers are cut in response to a TFP shock because lower tax revenues make
it harder for the government to nance its outstanding liabilities.

6.2 Alternative assumptions about welfare criterion and scal
instruments
We consider other extensions of our baseline specication where we alter the welfare
criteria; turn o heterogeneous exposures of TFP shocks by setting
o nominal rigidities by setting

Ïˆ = 0.

f = 0;

and turn

We summarize main insights from these

extensions here and more details are in the online appendix.
In our baseline specication we assumed that the Ramsey planner is utilitarian
meaning that he puts equal Pareto weights on all agents.

This assumption is not

essential for our results. The focus of our analysis has been on the role of monetary
policy in providing insurance against aggregate shocks, and the need for this insurance
is driven by market incompleteness not Pareto weights. To conrm this insight we
tried a range of alternative Pareto weights, for example weights that rationalize the
observed average marginal tax rates or alternative weights that prefer more redistribution. Dierent choices of Pareto weights have a big inuence on the

37

average

levels

of optimal tax rates and transfers but have little eect on how tax rates, transfers,
and nominal interest rates respond to aggregate shocks.
We explored how assumptions about the menu of available scal instruments affect conclusions. Some of heterogeneous impacts of recessions in the data are driven
by unemployment. Targeted instruments such as unemployment insurance (UI) can
be more eective than nominal interest rates in helping agents to smooth their consumption.

But even the best designed programs are likely to provide only partial

insurance, due, for example, to moral hazard.

Modeling these eects realistically

would take us too far from the focus of this paper.

One way to estimate a rough

upper bound on the eectiveness of UI programs is to assume that they fully eliminate all heterogeneous wage impacts by setting

f = 0.

In this case, we nd that the

optimal response to a markup shock is essentially unaected and that the response
to a productivity shock is cut by about 50 percent. Unemployment insurance is not
eective at providing insurance against shocks that aect wage earners and nancial
asset holders dierently.
We also study the sensitivity of our ndings to the size of nominal rigidities.
Monetary policy remains eective even if prices are completely exible because it still
can inuence the nominal price level and real returns on nominal debt.
set

Ïˆ=0

When we

we nd that ination responds by 0.5% to markup shocks and by 2.5% to

productivity shocks. These eects are larger than the baseline case where

Ïˆ = 20.

The insight that nominal rigidities lower the optimal response of ination is consistent
with RANK studies (Schmitt-Grohe and Uribe (2004)), but unlike those papers the
volatility of nominal interest rates and ination remains sizable under conventional
calibrations of nominal rigidities.

7 Concluding Remarks
James Tobin described macroeconomics as a eld that explains aggregate quantities
and prices while ignoring distribution eects. Tobin's characterization describes much
work about real business cycles, asset pricing, Ramsey tax and debt, and New Keynesian models. In each of these lines of research, an assumption of complete markets
and/or of a representative consumer allows the analyst to compute aggregate quantities and prices without also determining distributions across agents.

This paper

departs from Tobin's aggregative economics by assuming heterogeneous agents and

38

incomplete markets.
Our paper makes two contributions. It develops a way to approximate optimal
plans in economies with heterogeneous agents. Our method can be more broadly applied to settings that feature incomplete markets, idiosyncratic and aggregate shocks.
Our quantitative application reevaluates lessons for monetary and scal policy drawn
from New Keynesian economies.

Relative to price stability motives that typically

drive policy prescriptions, heterogeneity adds a quantitatively important insurance
motive.

Our ndings complement a message in Kaplan and Violante (2018 forth-

coming) that monetary policy is inextricably connected with scal policy and about
distributional eects.

39

References
Ahn, SeHyoun, Greg Kaplan, Benjamin Moll, Thomas Winberry, and
Christian Wolf. 2017. When Inequality Matters for Macro and Macro Matters
for Inequality. In

NBER Macroeconomics Annual 2017, volume 32.:

University of

Chicago Press.

Aiyagari, S. Rao, Albert Marcet, Thomas J. Sargent, and Juha Seppala.
2002.  Optimal Taxation without State-Contingent Debt.

Economy, 110(6):

Journal of Political

12201254.

Algan, Yann, Olivier Allais, Wouter J. Den Haan, and Pontus Rendahl.
2014. Chapter 6 - Solving and Simulating Models with Heterogeneous Agents and
Aggregate Uncertainty. In

Handbook of Computational Economics Vol. 3.

eds. by

Karl Schmedders, and Kenneth L. Judd, 3 of Handbook of Computational Economics: Elsevier, 277  324.

Anderson, Evan W, Lars Peter Hansen, and Thomas J Sargent. 2012. Small
noise methods for risk-sensitive/robust economies.

and Control, 36(4):

Journal of Economic Dynamics

468500.

Auclert, Adrien. 2017. Monetary Policy and the Redistribution Channel. Working
Paper 23451, National Bureau of Economic Research.

Barro, Robert J.

Journal of

1979.  On the Determination of the Public Debt.

Political Economy, 87(5):

940971.

Barro, Robert J., and Charles J. Redlick. 2011. Macroeconomic Eects From
Government Purchases and Taxes.

Quarterly Journal of Economics,

126(1): 51

102.

Bhandari, Anmol, David Evans, Mikhail Golosov, and Thomas Sargent.
2017a. Fiscal Policy and Debt Management with Incomplete Markets.

Journal of Economics, 132(2):

Quarterly

617663.

Bhandari, Anmol, David Evans, Mikhail Golosov, and Thomas J. Sargent.
2017b.  Public debt in economies with heterogeneous agents.

Economics, 91 3951.
40

Journal of Monetary

Bilbiie, Florin Ovidiu, and Xavier Ragot.

2017.  Optimal Monetary Policy

and Liquidity with Heterogeneous Households. CEPR Discussion Papers 11814,
C.E.P.R. Discussion Papers.

Challe, Edouard.

2017.  Uninsured Unemployment Risk and Optimal Monetary

Policy. Working Papers 2017-54, Center for Research in Economics and Statistics.

Childers, David et al. 2018. On the Solution and Application of Rational Expectations Models with Function-Valued States.

Unpublished manuscript.

Clarida, Richard, Jordi Gali, and Mark Gertler.
Policy in Open versus Closed Economies:

Economic Review, 91(2):

2001. Optimal Monetary

An Integrated Approach.

American

248252.

Debortoli, Davide, and Jordi Gali. 2017.  Monetary Policy with Heterogeneous
Agents: Insights from TANK models. working papers, Department of Economics
and Business, Universitat Pompeu Fabra.

Evans, David. 2015. Perturbation Theory with Heterogeneous Agents:

Theory and

Applications. Ph.D. dissertation, New York University.

Farhi, Emmanuel.
Incomplete.

2010.  Capital Taxation and Ownership When Markets Are

Journal of Political Economy, 118(5):

908948.

Fleming, Wendell H. 1971. Stochastic Control for Small Noise Intensities. SIAM
Journal on Control, 9(3):

473517.

Fleming, Wendell H, and PE Souganidis.
method of vanishing viscosity.

1986. Asymptotic series and the

Indiana University Mathematics Journal,

35(2):

425447.

GalÃ­, Jordi. 2015. Monetary policy, ination, and the business cycle: an introduction
to the new Keynesian framework and its applications.:

Princeton University Press.

Guvenen, Fatih, Serdar Ozkan, and Jae Song. 2014. The Nature of Countercyclical Income Risk.

Huggett, Mark.

Journal of Political Economy, 122(3):

621660.

1993. The risk-free rate in heterogeneous-agent incomplete-

insurance economies.

Journal of Economic Dynamics and Control, 17(5):
41

953969.

Jappelli, Tullio, and Luigi Pistaferri. 2014. Fiscal Policy and MPC Heterogeneity.

American Economic Journal: Macroeconomics, 6(4):

10736.

Kaplan, Greg, Benjamin Moll, and Giovanni L. Violante.
Policy According to HANK.

2018. Monetary

American Economic Review, 108(3):

Kaplan, Greg, and Giovanni L. Violante.

697743.

2018 forthcoming. Microeconomic

Journal of Economic Perspectives.

Heterogeneity and Macroeconomic Shocks.

Krusell, Per, and Anthony A Smith, Jr. 1998. Income and wealth heterogeneity
in the macroeconomy.

Journal of Political Economy, 106(5):

Legrand, Francois, and Xavier Ragot.

867896.

2017. Optimal policy with heteroge-

neous agents and aggregate shocks : An application to optimal public debt dynamics.Technical report.

Low, Hamish, Costas Meghir, and Luigi Pistaferri.
employment risk over the life cycle.

2010. Wage risk and

American Economic Review,

100(4): 1432

1467.

Lucas, Robert E, and Nancy L Stokey.
policy in an economy without capital.

1983.  Optimal scal and monetary

Journal of Monetary Economics,

12(1):

5593.

Luenberger, David G.

1997.

Optimization by Vector Space Methods.

New York,

NY, USA: John Wiley & Sons, Inc., , 1st edition.

Marcet, Albert, and Ramon Marimon. 2011. Recursive contracts.
Nuno, Galo, and Carlos Thomas. 2016.  Optimal monetary policy with heterogeneous agents. Working Papers 1624.

Reiter, Michael. 2009. Solving heterogeneous-agent models by projection and perturbation.

Journal of Economic Dynamics and Control, 33(3):

649665.

Rotemberg, Julio J. 1982. Monopolistic Price Adjustment and Aggregate Output.
Review of Economic Studies, 49(4):

517531.

Sbordone, Argia M. 2002.  Prices and unit labor costs:
ness.

Journal of Monetary Economics, 49(2):
42

265292.

a new test of price sticki-

Schmitt-Grohe, Stephanie, and Martin Uribe. 2004. Optimal scal and monetary policy under sticky prices.

Siu, Henry E.

Journal of Economic Theory, 114(2):

198230.

2004. Optimal Fiscal and Monetary Policy with Sticky Prices.

Journal of Monetary Economics, 51(3):

575607.

Smets, Frank, and Rafael Wouters. 2007. Shocks and frictions in US business
cycles: A Bayesian DSGE approach.

American Economic Review, 97(3):

586606.

Storesletten, Kjetil, Chris I Telmer, and Amir Yaron. 2001. How important
are idiosyncratic shocks? Evidence from labor supply.

American Economic Review,

91(2): 413417.

Storesletten, Kjetil, Christopher I Telmer, and Amir Yaron.
sumption and risk sharing over the life cycle.

2004. Con-

Journal of Monetary Economics,

51(3): 609633.

Werning, Ivan. 2007.  Optimal Fiscal Policy with Redistribution,. Quarterly Journal of Economics, 122(August):

Winberry, Thomas.

925967.

2016. A Toolbox for Solving and Estimating Heterogeneous

Agent Macro Models.

Forthcoming Quantitative Economics.

Woodford, Michael. 2003. Interest and prices.:
Yared, Pierre.

Princeton University Press.

2013.  Public Debt Under Limited Private Credit.

European Economic Association, 11(2):

229245.

43

Journal of the

Online Appendix
A Recursive Representation of Ramsey Plan
For completeness and ease of readability, we repeat the planning problem with a full set of
implementability constraints below.

ai,âˆ’1 = 0

Given an initial condition

{bi,âˆ’1 , Î¸i,âˆ’1 , si }, Î›âˆ’1 = 0,

and the multipliers, the Ramsey allocation solves:

inf sup E0

âˆ
X
t=0

Î²t

(Z "

n1+Î³
c1âˆ’Î½
i,t
i,t
âˆ’
1âˆ’Î½ 1+Î³

!

1+Î³
1âˆ’Î½
+ ci,t
âˆ’ câˆ’Î½
Âµi,t
i,t (Tt + si Dt ) âˆ’ ni,t

âˆ’1
ai,tâˆ’1 câˆ’Î½
i,t (1 + Î t ) Î¾i,t

 + (1 âˆ’ Î²)câˆ’Î½
âˆ’
i,0 bi,âˆ’1 Âµi,0 di
âˆ’Î½
âˆ’1
Î²Etâˆ’1 ci,t (1 + Î t )




Wt
âˆ’Î½
âˆ’Î½
+ Î›t Ct Yt 1 âˆ’ Î¦t 1 âˆ’
+ (Î›tâˆ’1 âˆ’ Î›t )Ct ÏˆÎ t (1 + Î t ) ,
Î±NtÎ±âˆ’1
subject to

Î³
câˆ’Î½
i,0 (1 âˆ’ Î¥0 )W0 i,0 = ni,0
âˆ’1/Î½

mi,0 ci,0 = C0
Z
ci,0 di = C0
C0 + GÌ„ = N0Î± âˆ’

Ïˆ 2
Î 
2 0

Ïˆ
D0 = N0Î± âˆ’ W0 N0 âˆ’ Î 20
2
Z
N0 = i,0 ni,0 di

1

(31)

and

Î³
câˆ’Î½
i,t Wt (1 âˆ’ Î¥t )i,t = ni,t

Qtâˆ’1
âˆ’1/Î½

mi,t
Z

(32)

h
i
âˆ’1
= Î²mi,tâˆ’1 Etâˆ’1 câˆ’Î½
(1
+
Î 
)
t+1
i,t

(33)

ci,t = Ct

(34)

ci,t di = Ct

(35)

Ct + GÌ„ = NtÎ± âˆ’

Ïˆ 2
Î 
2 t

(36)

Ïˆ
Dt = NtÎ± âˆ’ Wt Nt âˆ’ Î 2t
2
Z
Nt = i,t ni,t di

(37)
(38)

Âµi,t = Âµi,tâˆ’1 + Î¾i,t .
for

t â‰¥ 1,

where

âˆ’Î½
Qtâˆ’1 â‰¡ Ctâˆ’1
Qtâˆ’1 ,

with

ln i,t = ln Î˜t + ln Î¸i,t + Îµ,i,t
ln Î¸i,t = ÏÎ¸ ln Î¸i,tâˆ’1 + f (Î¸i,tâˆ’1 )EÎ˜,t + ÎµÎ¸,i,t
ln Î˜t = ÏÎ˜ ln Î˜tâˆ’1 + (1 âˆ’ ÏÎ˜ ) ln Î˜Ì„ + EÎ˜,t
ln Î¦t = ÏÎ¦ ln Î¦tâˆ’1 + (1 âˆ’ ÏÎ¦ ) ln Î¦Ì„ + EÎ¦,t ,
where the inf is over multipliers
The state for the

Î›0 ,


{Âµi,t , Î›t }t and the sup is over {ci,t , ni,t , bi,t }i , Ct , Nt , Bt , Wt , Pt , Yt , Dt

t â‰¥ 1 continuation problem is the joint distribution of (mi,0 , Âµi,0 , Î¸i,0 , si ),

and aggregate shocks

(Î˜0 , Î¦0 ).

For the remainder of this appendix we'll focus on the

rst-order conditions for the continuation problem and how to approximate solutions to
those rst-order conditions recursive in the distribution over

(mi , Âµi , Î¸i , si )

and

(Î›, Î˜, Î¦).

Once that approximation has been obtained, the solution to the time 0 problem can be
found by solving the time 0 rst-order conditions with the knowledge that some variables
will be given by the continuation policy rules.

We omit those rst-order conditions for

brevity.
Let

Î² t Ï†i,t , Î² t Ïi,tâˆ’1 , Î² t Ï•i,t , Î² t Ï‡t , Î² t Ît , Î² t Î¶t ,Î² t Îºt

be the Lagrange multipliers on (32)-(38)

respectively. After taking derivatives, the rst-order condition with respect to
bined with

Âµi,t = Âµi,tâˆ’1 + Î¾i,t

imply

Âµi,tâˆ’1

h
i
âˆ’1 Âµ
Etâˆ’1 câˆ’Î½
(1
+
Î 
)
t
i,t
i,t
h
i ,
=
âˆ’1
Etâˆ’1 câˆ’Î½
(1
+
Î 
)
t
i,t

2

ai,tâˆ’1

com-

.

and the rst-order conditions with respect to

mi,t

and

Qtâˆ’1

give

Z
Ï†i,t = 0.
Due to the timing of the planner's problem (at time

t

but before shocks have been real-

Î˜tâˆ’1 =
(ln Î˜tâˆ’1 , ln Î¦tâˆ’1 ); the innovations, E t = (EÎ˜,t , EÎ¦,t ) and Îµ = (Îµ , ÎµÎ¸ ); as well as the individual
states, ztâˆ’1 = (mtâˆ’1 , Âµtâˆ’1 , Î¸tâˆ’1 , s), and the distribution over those states, â„¦tâˆ’1 . The rst
ized) policy functions will be a functions of both the previous log of the shocks,

order conditions of the planner's problem can then be written recursively as

0 =nÌƒ(Îµ, E, Î˜, z, â„¦, Î›)1+Î³ + cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ (TÌƒ (E, Î˜, â„¦, Î›) + sDÌƒ(E, Î˜, â„¦, Î›)) + aÌƒ(Î˜, z, â„¦, Î›)

pÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
Î²E [pÌƒ(Â·, Â·, Î˜, z, â„¦, Î›)]

âˆ’ c(Îµ, E, Î˜, z, â„¦, Î›)1âˆ’Î½ âˆ’ aÌƒ(ÏÎ˜ Î˜ + (1 âˆ’ ÏÎ˜ )Î˜Ì„ + E, zÌƒ(Îµ, E, Î˜, z, â„¦, Î›), â„¦Ìƒ(E, Î˜, â„¦, Î›), Î›Ìƒ(E, Î˜, â„¦, Î›))
0 =cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)

âˆ’Î½

WÌƒ (E, Î˜, â„¦, Î›)(1 âˆ’ Î¥Ìƒ(E, Î˜, â„¦, Î›))Ëœ
(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ nÌƒ(Îµ, E, Î˜, z, â„¦, Î›)

Î³

0 =mÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
cÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ CÌƒ(E, Î˜, â„¦, Î›)
h
i
0 =Î²E %Ìƒ(Â·, Â·ÏÎ˜ Î˜ + (1 âˆ’ ÏÎ˜ )Î˜Ì„ + E, zÌƒ(Îµ, E, Î˜, z, â„¦, Î›), â„¦Ìƒ(E, Î˜, â„¦, Î›), Î›Ìƒ(E, Î˜, â„¦, Î›))
1
mÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’1/Î½âˆ’1 cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)Ï•Ìƒ(Îµ, E, Î˜, z, â„¦, Î›)
Î½

0 =cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ + (1 âˆ’ Î½)cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ Î²Î½ mÌƒ(Îµ, E, Î˜, z, â„¦, Î›)

(40)
(41)

âˆ’1/Î½

+

(39)

(42)
%Ìƒ(Îµ, E, Î˜, z, â„¦, Î›)
cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)



âˆ’ Î½cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½âˆ’1 TÌƒ (E, Î˜, â„¦, Î›) + s(z)DÌƒ(E, Î˜, â„¦, Î›) ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
+

Î½aÌƒ(Î˜, z, â„¦, Î›)rÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
(ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ Âµ)
cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)

+ Î½cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½âˆ’1 WÌƒ (E, Î˜, â„¦, Î›)(1 âˆ’ Î¥Ìƒ(E, Î˜, â„¦, Î›))Ëœ
(Îµ, E, Î˜, z, â„¦, Î›)Ï†Ìƒ(Îµ, E, Î˜, z, â„¦, Î›)
+ mÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’1/Î½ Ï•Ìƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ Ï‡Ìƒ(E, Î˜, â„¦, Î›)
Î³

(43)

Î³

0 =nÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ (1 + Î³)nÌƒ(Îµ, E, Î˜, z, â„¦, Î›) ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
+ Î³ nÌƒ(Îµ, E, Î˜, z, â„¦, Î›)Î³âˆ’1 Ï†Ìƒ(Îµ, E, Î˜, z, â„¦, Î›) + Ëœ(Îµ, E, Î˜, z, â„¦, Î›)ÎºÌƒ(E, Î˜, â„¦, Î›)
0 =%Ìƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ (1 + Î Ìƒ(E, Î˜, â„¦, Î›))âˆ’1 ÏÌƒ(z, â„¦, Î›)
0 =pÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)

âˆ’Î½

(1 + Î Ìƒ(E, Î˜, â„¦, Î›))

âˆ’1

(44)
(45)
(46)

pÌƒ(Îµ, E, Î˜, z, â„¦, Î›)ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›)
0 =rÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’
Î²E [pÌƒ(Â·, Â·, Î˜, z, â„¦, Î›)]

(47)

0 =Âµ âˆ’ Î²E [rÌƒ(Â·, Â·, Î˜, z, â„¦, Î›)]


0 =QÌƒ(Î˜, â„¦, Î›) âˆ’ Î²mE pÌƒ(Â·, Â·, Î˜, z, â„¦, Î›))âˆ’1

(48)

0 = ln Ëœ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ ln Î¸Ìƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ Îµ âˆ’ ÏÎ˜ ln Î˜ âˆ’ (1 âˆ’ ÏÎ¸ ) ln Î˜Ì„ âˆ’ EÎ˜

(50)

(49)

0 = ln Î¸Ìƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ ÏÎ˜ ln Î¸ âˆ’ f (Î¸) âˆ’ ÎµÎ¸

(51)

0 =sÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ s

3

while the aggregate constraints are

Z Z

cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦(z)
Z Z
0 =CÌƒ(E, Î˜, â„¦, Î›) âˆ’
cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦(z)

(52)

Ïˆ
0 =YÌƒ (E, Î˜, â„¦, Î›) âˆ’ Î Ìƒ(E, Î˜, â„¦, Î›)2 âˆ’ CÌƒ(E, Î˜, â„¦, Î›) âˆ’ GÌ„
2
Z Z
0=
Ëœ(Îµ, E, Î˜, z, â„¦, Î›)nÌƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦(z) âˆ’ YÌƒ (E, Î˜, â„¦, Î›)

(54)

Ïˆ
0 =YÌƒ (E, Î˜, â„¦, Î›) âˆ’ WÌƒ (E, Î˜, â„¦, Î›)NÌƒ (E, Î˜, â„¦, Î›) âˆ’ Î Ìƒ(E, Î˜, â„¦, Î›)2 âˆ’ DÌƒ(E, Î˜, â„¦, Î›)
2


1
âˆ’Î½
0 =CÌƒ(E, Î˜, â„¦, Î›) YÌƒ (E, Î˜, â„¦, Î›)
1 âˆ’ Î¦Ìƒ(E, Î˜, â„¦, Î›)(1 âˆ’ WÌƒ (E, Î˜, â„¦, Î›)NÌƒ (E, Î˜, â„¦, Î›)1âˆ’Î± )
Î±
i
h
âˆ’ â„µÌƒ(E, Î˜, â„¦, Î›) + Î²E â„µÌƒ(Â·, ÏÎ˜ Î˜ + (1 âˆ’ ÏÎ˜ )Î˜Ì„ + E, â„¦Ìƒ(E, Î˜, â„¦, Î›), Î›Ìƒ(E, Î˜, â„¦, Î›))

(56)

0=

0 =Ï‡Ìƒ(E, Î˜, â„¦, Î›) âˆ’ ÎÌƒ(E, Î˜, â„¦, Î›) + Î½

(53)

(55)

â„µÌƒ(E, Î˜, â„¦, Î›)

(Î›Ìƒ(E, Î˜, â„¦, Î›) âˆ’ Î›)
CÌƒ(E, Î˜, â„¦, Î›)

h
i
âˆ’ Î½ CÌƒ(E, Î˜, â„¦, Î›)âˆ’Î½âˆ’1 YÌƒ (E, Î˜, â„¦, Î›) 1 âˆ’ Î¦Ìƒ(E, Î˜, â„¦, Î›)(1 âˆ’ WÌƒ (E, Î˜, â„¦, Î›)) Î›Ìƒ(E, Î˜, â„¦, Î›)
Z Z
0 =(1 + Î Ìƒ(E, Î˜, â„¦, Î›))âˆ’1
aÌƒ(Î˜, z, â„¦, Î›)rÌƒ(Îµ, E, Î˜, z, â„¦, Î›)(ÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›) âˆ’ Âµ)
âˆ’ Î² %Ìƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦(z) âˆ’ Ïˆ Î Ìƒ(E, Î˜, â„¦, Î›)ÎÌƒ(E, Î˜, â„¦, Î›)

(58)

(59)

âˆ’ Ïˆ Î Ìƒ(E, Î˜, â„¦, Î›)Î¶Ìƒ(E, Î˜, â„¦, Î›) âˆ’ Ïˆ CÌƒ(E, Î˜, â„¦, Î›) (1 + 2Î Ìƒ(E, Î˜, â„¦, Î›))(Î›Ìƒ(E, Î˜, â„¦, Î›) âˆ’ Î›)
Z Z
0=
cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ Ëœ(Îµ, E, Î˜, z, â„¦, Î›)Ï†Ìƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦(z)
Z
0 = cÌƒ(Îµ, E, Î˜, z, â„¦, Î›)âˆ’Î½ sÂµÌƒ(Îµ, E, Î˜, z, â„¦, Î›)dPr(Îµ)dâ„¦ âˆ’ Î¶Ìƒ(E, Î˜, â„¦, Î›)

(60)

1
0 = Î›Ìƒ(E, Î˜, â„¦, Î›)CÌƒ(E, Î˜, â„¦, Î›)âˆ’Î½ Î¦Ìƒ(E, Î˜, â„¦, Î›) âˆ’ Î¶Ìƒ(E, Î˜, â„¦, Î›)
Î±


1
0 =Î›Ìƒ(E, Î˜, â„¦, Î›)CÌƒ(E, Î˜, â„¦, Î›) Î±NÌƒ (E, Î˜, â„¦, Î›)Î±âˆ’1 (1 âˆ’ Î¦Ìƒ(E, Î˜, â„¦, Î›)) + Î¦Ìƒ(E, Î˜, â„¦, Î›)WÌƒ (E, Î˜, â„¦, Î›)
Î±


Î±âˆ’1
+ Î±NÌƒ (E, Î˜, â„¦, Î›)
ÎÌƒ(E, Î˜, â„¦, Î›) + Î¶Ìƒ(E, Î˜, â„¦, Î›) âˆ’ WÌƒ (E, Î˜, â„¦, Î›)Î¶Ìƒ(E, Î˜, â„¦, Î›) âˆ’ ÎºÌƒ(E, Î˜, â„¦, Î›)

(63)

âˆ’Î½

âˆ’Î½

0 =â„µÌƒ(E, Î˜, â„¦, Î›) âˆ’ CÌƒ(E, Î˜, â„¦, Î›)

0 =YÌƒ (E, Î˜, â„¦, Î›) âˆ’ NÌƒ (E, Î˜, â„¦, Î›)

(62)

(64)
(65)
(67)
(68)
(69)
(70)

These are in addition to the implicit restrictions that
shocks.

(61)

(66)

Ïˆ Î Ìƒ(E, Î˜, â„¦, Î›)(1 + Î Ìƒ(E, Î˜, â„¦, Î›))

Î±

0 =Î¦Ìƒ(E, Î˜, â„¦, Î›) âˆ’ exp(ÏÎ¦ ln Î¦ + (1 âˆ’ ÏÎ¦ ) ln Î¦Ì„ + EÎ¦ )
Z
0 = ÏÌƒ(Î˜, z, â„¦, Î›)dâ„¦
h
i
0 =E TÌƒ (Â·, Î˜, â„¦, Î›)

t

(57)

QÌƒ, aÌƒ

and

ÏÌƒ

do not depend on period

The additional constraint (70) is required because of Ricardian equivalence as

without it there would be multiple solutions to the FOC corresponding to dierent paths of
government debt.

A.1 Slack Phillips Curve When si = 1
Here we demonstrate the result that when all agents have the same equity ownership,

4

si = 1

for all i, the Phillips curve, equation (15), does not bind at the optimal allocation and hence

Î›t = 0

for all

t.

Let

{ci,t , ni,t }

and

{Ct , Î t , Wt , Tt , Î¥t , Dt , Qt , Yt }

be the allocation that

maximizes a relaxed planner's problem without the Phillip's curve constraint.
such that (15) is satised;
and

TÌ‚t

such that

DÌ‚t = (1 âˆ’ WÌ‚t )Yt âˆ’

TÌ‚t + si DÌ‚t = Tt + si Dt .

rium conditions will then be satised with

{ci,t , ni,t },

Ïˆ 2
2 Î t ;

Î¥Ì‚t

such that

Dene

WÌ‚t

(1 âˆ’ Î¥Ì‚t )WÌ‚t = (1 âˆ’ Î¥t )Wt ;

It is clear from this denition that all equilib-

{Ct , Î t , WÌ‚t , TÌ‚t , Î¥Ì‚t , DÌ‚t , Qt , Yt }

for the allocation

and therefore this allocation maximizes the full planner's problem which implies

that the Phillip's curve is slack.

B Additional Details for Section 3
This section contains the omitted steps and proofs from section 3 in the main text.
section B.1 we dene the

F

and

R

In

functions used in the expansion provided in section B.2.

We prove lemma 1 and lemma 2 of the main text in section B.3. In sections B.4-B.7, we
derive equations (74)-(79) which extend the factorization theorem, theorem 1, to the more
general Ramsey problem, and then exploit this factorization to derive equations (76)-(96)
which give all the derivatives needed for the second-order Taylor expansions of the Ramsey
policies using matrices known from the lower-order expansions and requiring only small
dimensional matrix inversions.

B.1 Deriving functions F and R
Let
let

xÌƒ =



XÌƒ =



|
mÌƒ, ÂµÌƒ, Î¸Ìƒ, sÌƒ, cÌƒ, nÌƒ, aÌƒ, %Ìƒ, Ï†Ìƒ, Ï•Ìƒ, ÏÌƒ, rÌƒ, pÌƒ, Ëœ

|
Î›Ìƒ, CÌƒ, YÌƒ , Î Ìƒ, WÌƒ , DÌƒ, NÌƒ , â„µÌƒ, Ï‡Ìƒ, ÎÌƒ, Î¦Ìƒ, Î¶Ìƒ, ÎºÌƒ, TÌƒ , Î¥Ìƒ

assumption,

P

and

p

denote the household specic variables and

Î›Ìƒ

is contained in

that satisfy

XÌƒ

Î›Ìƒ = PXÌƒ

and

and

zÌƒ

denote the aggregate variables.

is contained in

zÌƒ = pxÌƒ.

xÌƒ

By

so there exist projection matrices

Equations (39)-(51) represent the individual

constraints of the problem and can be summarized by the following function which extends
(20) of section 3

0 = F z, ExÌƒ(Â·, Â·, Î˜, z, â„¦, Î›), xÌƒ(Îµ, E, Î˜, z, â„¦, Î›),
h
i
E xÌƒ(Â·, Â·, ÏÎ˜ Î˜ + (1 âˆ’ ÏÎ˜ )Î˜Ì„ + E, zÌƒ(Îµ, E, Î˜, z, â„¦, Î›), â„¦Ìƒ(Î˜, z, â„¦, Î›), Î›Ìƒ(Î˜, z, â„¦, Î›) ,
!

(71)

XÌƒ(Î˜, â„¦, Î›), Îµ, E, Î˜

and must hold for all

z

in the support of

â„¦.

5

Equations (52)-(70) capture the aggregate

constraints which must hold across all agents and can be dened by the following function
which extends (21) of section 3

19

Z
0=

R z, xÌƒ(Îµ, Î˜, z, â„¦, Î›), XÌƒ(Î˜, â„¦, Î›),
!
E[XÌƒ(Â·, ÏÎ˜ Î˜ + (1 âˆ’ ÏÎ˜ )Î˜Ì„ + E, â„¦Ìƒ(Î˜, â„¦, Î›), Î›Ìƒ(Î˜, â„¦, Î›))], Îµ, Î˜, Î› dPr(Îµ)dâ„¦.
(72)

The law of motion for

â„¦Ìƒ

is given by

Z
Î¹ (zÌƒ (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y) d Pr (Îµ) dâ„¦ âˆ€y,

e (E, Î˜, â„¦, Î›) (y) =
â„¦
where

Î¹ (zÌƒ (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y)
y

elements of

is

1

zÌƒ (Îµ, E, Î˜, z, â„¦)

i all elements of

(73)

are less than all

and zero otherwise.

B.2 Setting up the expansions
Section 3 presented two approaches to approximating
deterministic transition dynamics
state

(Î˜Ì„, Î›Ì„).

xÌƒ

and

XÌƒ :

expanding around the

{Î˜t , Î›t } and expanding around the non-stochastic steady

We rst present how to expand around the non-stochastic steady state

(Î˜Ì„, Î›Ì„)

in sections B.2-B.6. In section B.7 we describe the full expansion along the transition path.
To expand around
of

Î˜

and

Î›

(Î˜Ì„, Î›Ì„),

we consider a positive scalar

from their respective steady states

Î˜Ì„

and

xÌƒ(ÏƒÎµ, ÏƒE, Ïƒ(Î˜ âˆ’ Î˜Ì„) + Î˜Ì„, z, â„¦, Ïƒ(Î› âˆ’ Î›Ì„(â„¦)) + Î›Ì„; Ïƒ)
Î›Ì„(â„¦)); Ïƒ)

and

Ïƒ

Î›Ì„(â„¦),

and

ÏÎ¸ (Ïƒ) = 1 âˆ’ ÏƒÏ.

We let

XÌƒ(ÏƒE, Ïƒ(Î˜ âˆ’ Î˜Ì„) + Î˜Ì„, z, â„¦, Ïƒ(Î› âˆ’

denote the policy rules with scaling parameters

with a Taylor expansion with respect to

that scales all shocks, deviations

Ïƒ,

and approximate these policies

Ïƒ. For example, a rst-order Taylor expansion would

be of the form


xÌƒ(Îµ, Î˜, z, â„¦, Î›) = xÌ„(z, â„¦) + xÌ„Îµ (z, â„¦)Îµ + xÌ„E (z, â„¦)E + xÌ„Î˜ (z, â„¦)(Î˜ âˆ’ Î˜Ì„) Ïƒ

+ xÌ„Î› (z, â„¦)(Î› âˆ’ Î›Ì„(â„¦)) + xÌ„Ïƒ Ïƒ + O(Ïƒ 2 )
19 The

R

presented here nests that of section 3 with two main dierences.

The rst is

the inclusion of expectations of future aggregate variables. The second is that we choose to
integrate over

R

rather than over

x.

Both choices are without loss of generality but they

allow for equations (39)- (51) and (52)-(70) representing the Ramsey plan to be expressed
in a more condensed form.

6

and


XÌƒ(Î˜, â„¦, Î›) = XÌ„(â„¦) + XÌ„E (â„¦)E + XÌ„Î˜ (â„¦)(Î˜ âˆ’ Î˜Ì„) + XÌ„Î› (â„¦)(Î› âˆ’ Î›Ì„(â„¦)) + XÌ„Ïƒ Ïƒ + O(Ïƒ 2 ),
while second-order expansions can be dened analogously.

B.3 Proof of Lemma 1 and Lemma 2
We begin by showing that when
From (47) it is clear that

Ïƒ = 0, zÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = z and hence that â„¦Ìƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0) = â„¦.

rÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) =

Âµ
Î² and thus equation (48) implies

ÂµÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = Âµ.
In absence of shocks, we conclude from equations (41) and (49) that

cÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = mÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0)1/Î½ CÌƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0)
and

1/Î½
Î²
cÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = m
QÌƒ(Î˜Ì„, â„¦, Î›Ì„; 0)(1 + Î (0, Î˜Ì„, â„¦, Î›Ì„; 0))
1/Î½

R 1
Î²
= CÌƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0) and hence
As
m Î½ dâ„¦(z) = 1, this implies QÌƒ(Î˜Ì„,â„¦,Î›Ì„;0)(1+Î (0,
Î˜Ì„,â„¦,Î›Ì„;0))
1/Î½



1

cÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = m Î½ CÌƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0).
We, therefore, conclude that
By assumption

sÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = s and, as ÏÎ¸ â†’ 1 as Ïƒ â†’ 0, Î¸Ìƒ(0, 0, 0, z, â„¦, Î›Ì„; 0) = Î¸.

All combined, we obtain
that we obtained

mÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = m.

zÌƒ(0, 0, Î˜Ì„, z, â„¦, Î›Ì„; 0) = z

and therefore

â„¦Ìƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0) = â„¦.

Note

â„¦Ìƒ(0, Î˜Ì„, â„¦, Î›Ì„; 0) = â„¦ by exploiting that, in absence of risk, the expectations

in (41) and (49) drop out. This would hold apply along any deterministic transition path
for

(Î›, Î˜)

and thus

zÌƒ(0, 0, Î˜, z, â„¦, Î›; 0) = z

and

â„¦Ìƒ(0, Î˜, â„¦, Î›; 0) = â„¦

for any

(Î›, Î˜).

This

proves the statement of lemma 2 and, therefore, also of lemma 1 as it is a special case of
lemma 2.

B.4 Frechet Derivatives: âˆ‚ xÌ„(z), âˆ‚ XÌ„
Dierentiate

F

and

R

with respect to

z

to obtain

(Fxâˆ’ (z) + Fx (z) + Fx+ (z))xÌ„z (z) + Fz (z) = 0,

7

where we exploited

zÌ„z = I.

This yields

xÌ„z (z) = (Fxâˆ’ (z) + Fx (z) + Fx+ (z))âˆ’1 Fz (z).

We begin by solving for the derivatives w.r.t

â„¦Ìƒ(0, 0, â„¦, Î›; 0) = â„¦

and hence

zÌ„Î› = 0

and

Î›.

Exploiting

zÌƒ(0, 0, 0, z, â„¦, Î›; 0) = z

and

â„¦Ì„Î› = 0,


Fxâˆ’ (z)xÌ„Î› (z) + Fx (z)xÌ„Î› (z) + Fx+ (z) xÌ„Î› (z)Î›Ì„Î› + FX (z)XÌ„Î› = 0
and

Z
Rx (z)xÌ„Î› (z) + RX (z)XÌ„Î› + RX+ (z)XÌ„Î› Î›Ì„Î› + RÎ› (z)dâ„¦(z) = 0.

In order to proceed, we need to nd the derivative

Î›Ì„Î› .

This requires solving a nonlinear

equation but still involves only operations involving small matrices. First note that

xÌ„Î› (z) = âˆ’(Fxâˆ’ (z) + Fx (z) + Î›Ì„Î› Fx+ (z))âˆ’1 FX (z)XÌ„Î›
Let

C(z) = âˆ’(Fxâˆ’ (z) + Fx (z) + Î›Ì„Î› Fx+ (z))âˆ’1 FX (z),
Z
XÌ„Î› = âˆ’

Therefore,

Î›Ì„Î›

then



Rx (z)C(z) + RX (z) + Î›Ì„Î› RX+ (z) dâ„¦(z)

âˆ’1 Z


RÎ› (z)dâ„¦(z) .

âˆ’1 Z



must solve

Z
Î›Ì„Î› = âˆ’P



Rx (z)C(z) + RX (z) + Î›Ì„Î› RX+ (z) dâ„¦(z)

RÎ› (z)dâ„¦(z) .

This can be found easily with a 1-dimensional root solver as all the inversions involve small
matrices.
The Frechet derivative w.r.t

â„¦

is computed as follows:

(Fxâˆ’ (z) + Fx (z) + Fx+ (z)) âˆ‚ xÌ„(z) + Fx+ (z)xÌ„Î› (z)Pâˆ‚ XÌ„ + FX (z)âˆ‚ XÌ„ = 0
which gives

âˆ‚ xÌ„(z) = âˆ’(Fxâˆ’ (z) + Fx (z) + Fx+ (z))âˆ’1 (Fx+ (z)xÌ„Î› (z)P + FX (z)) âˆ‚ XÌ„ â‰¡ C(z)âˆ‚ XÌ„.
To solve for

âˆ‚ XÌ„ ,

we dierentiate

R

in the direction

âˆ†,

with density

Î´,

(74)

to obtain

Z

Z
1
R(z, xÌ„(z, â„¦ + Î±âˆ†), XÌ„(â„¦ + Î±âˆ†))(Ï‰(z) + Î±Î´(z))dz âˆ’ R(z)Ï‰(z)dz
0 = lim
Î±â†’0 Î±
Z
Z


= R(z)Î´(z)dz +
Rx (z)âˆ‚ xÌ„(z) Â· âˆ† + RX+ (z) (âˆ‚ XÌ„ Â· âˆ†) + XÌ„Î› P(âˆ‚ XÌ„ Â· âˆ†) + RX (z)âˆ‚ XÌ„ Â· âˆ† Ï‰(z)dz

8

where

R(z)

C(z)âˆ‚ XÌ„,

R(z) = R(z, xÌ„(z), XÌ„, XÌ„, 0, Î›Ì„, Î˜Ì„).

is dened by

Substituting for

âˆ‚ xÌ„(z) =

we get

Z
âˆ‚ XÌ„ Â· âˆ† = âˆ’



âˆ’1 Z

Rx (z)C(z) + RX+ (z)(I + XÌ„Î› P) + RX (z) dâ„¦(z)

â‰¡ Dâˆ’1

R(z)dâˆ†(z)

Z
R(z)dâˆ†(z).

(75)

B.5 First-Order Terms
Next we dierentiate both

F

and

R

with respect to

coecients to group the terms that multiply

Îµ, E

Ïƒ

and

and use the method of undetermined

Î˜

and set each equal to zero. For

Îµ,

this yields

Fx (z)xÌ„Îµ (z) + Fx+ (z)xÌ„z (z)pxÌ„Îµ (z) + FÎµ (z) = 0
or

xÌ„Îµ (z) = âˆ’ (Fx (z) + Fx+ (z)xÌ„z (z)p)âˆ’1 FÎµ (z) â‰¡ E(z)âˆ’1 G(z).
Î˜,

For

we nd that (after noting imposing

â„¦Ì„Î˜ = 0

and

(76)

zÌ„Î˜ = 0)


Fxâˆ’ (z)xÌ„Î˜ (z) + Fx (z)xÌ„Î˜ (z) + Fx+ (z) xÌ„Î˜ (z)ÏÎ˜ + xÌ„Î› (z)PXÌ„Î˜ + FX (z)XÌ„Î˜ + FÎ˜ (z) = 0.
xÌ„Î˜

This yields a linear equation in
the linear relationship between

xÌ„Î˜

XÌ„Î˜

and
and

XÌ„Î˜

which we can solve for

xÌ„Î˜ .20

Plugging in for

in

Z
Rx (z)xÌ„Î˜ (z) + RX (z)XÌ„Î˜ + RX+ (z)XÌ„Î˜ ÏÎ˜ + RX+ (z)XÌ„Î› PXÌ„Î˜ + RÎ˜ (z)dâ„¦(z) = 0.
yields a linear equation for
Finally, for

E

XÌ„Î˜ .

we nd


Fx (z)xÌ„E (z)+Fx+ (z) xÌ„Î˜ (z) + xÌ„z (z)pxÌ„E (z) + âˆ‚ xÌ„(z) Â· â„¦Ì„E + xÌ„Î› (z)PXÌ„E +FX (z)XÌ„E +FE (z) = 0
and

Z


Rx (z)xÌ„E (z) + RX (z)XÌ„E + RX+ (z) XÌ„Î˜ + âˆ‚ XÌ„ Â· â„¦Ì„E + XÌ„Î› PXÌ„E + RE (z)dâ„¦(z) = 0.

20 Easiest to exploit


ÏÎ˜ =

ÏÎ˜ 0
0 ÏÎ¦


and solve for each column of

9

xÌ„Î˜

separately.

Substituting for

âˆ‚ xÌ„,

we obtain and dening

XÌ„E0 = âˆ‚ XÌ„ Â· â„¦Ì„E


Fx (z)xÌ„E (z)+Fx+ (z) xÌ„Î˜ (z) + xÌ„z (z)pxÌ„E (z) + C(z)XÌ„E0 + xÌ„Î› PXÌ„E +FX (z)XÌ„E +FE (z) = 0,
or

H(z)xÌ„E (z) = I(z)

h

I XÌ„E

XÌ„E0

i|

(77)

â„¦Ì„E . Dierentiating equation (73)
i
th
and letting z represent the i
element of z yields

Solving for these derivatives rst requires determining
with respect to

E

â„¦ÌƒE (E, Î˜, â„¦, Î›)(y) = âˆ’

Z X

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

Ã— zÌƒEi (Îµ, E, Î˜, z, â„¦) dPr(Îµ)dâ„¦(z)
which evaluated at

â„¦Ì„E (y) = âˆ’

Z X

Ïƒ=0
i

Î´(z âˆ’y )

i
The density of

i

gives

â„¦Ì„E

Y

j

Î¹(z â‰¤ y

j

)zÌ„Ei (z)dâ„¦(z)

=âˆ’

XZ
i

j6=i
is given by

Î´(z i âˆ’y i )

Ï‰Ì„E (y) =

âˆ‚ nz
âˆ‚y 1 âˆ‚y 2 Â·Â·Â·âˆ‚y nz

â„¦Ì„E (y)

Y

Î¹(z j â‰¤ y j )zÌ„Ei (z)dâ„¦(z).

j6=i

so

X âˆ‚ Z Y
X âˆ‚

j
j i
Ï‰Ì„E (y) = âˆ’
zÌ„Ei (y)Ï‰(y) .
Î´(z
âˆ’
y
)
zÌ„
(z)dâ„¦(z)
=
âˆ’
E
i
i
âˆ‚y
âˆ‚y
i

j

Plugging in for the denition of

XÌ„E0

i

XÌ„E0

we nd

Z

X âˆ‚

zÌ„Ei (z)Ï‰(z) dz
i
âˆ‚z
i

Z X
âˆ‚
âˆ’1
=D
R(z) zÌ„Ei (z)Ï‰(z)dz
âˆ‚z i
i
Z X
= Dâˆ’1
(Rzi (z) + Rx (z)xÌ„zi (z)) zÌ„Ei dâ„¦(z)
= âˆ’D

âˆ’1

R(z)

i

Z

= Dâˆ’1 (Rz (z) + Rx (z)xÌ„z (z)) pxÌ„E (z)dâ„¦(z)
Z
â‰¡ A(z)xÌ„E (z)dâ„¦(z)

(78)

where we arrive at the second equality through integration by parts. This implies

Z
âˆ‚ xÌ„(z) Â· â„¦Ì„E = C(z)

10

A(z)xÌ„E (z)dâ„¦(z).

(79)

Substituting for

Z

xÌ„E (z)

using equation (77) in (78) plus


Rx (z)xÌ„E (z) + RX (z)XÌ„E + RX+ XÌ„Î˜ + XÌ„E0 + XÌ„Î› PXÌ„E + RE (z)dâ„¦(z) = 0

yields a linear system

KÂ·
where

K

and

J

h

i|

XÌ„E0

XÌ„E

=J

(80)

are matrices with dimensions given by the number of aggregate variables or

number of aggregate shocks, both of which are small relative to number of agents.
Finally our last term, the derivative w.r.t
idiosyncratic shock

ÏÎ¸

scale with

Ïƒ , FÏƒ

Ïƒ.

Since we have the AR(1) parameter of

is non-zero.

Fxâˆ’ (z)xÌ„Ïƒ (z) + Fx (z)xÌ„Ïƒ (z) + Fx+ (z) xÌ„Ïƒ (z) + xÌ„z (z)pxÌ„Ïƒ (z) + âˆ‚ xÌ„(z) Â· â„¦Ì„Ïƒ + xÌ„Î› (z)PXÌ„Ïƒ



+ FX (z)XÌ„Ïƒ + FÏƒ (z) = 0
and

21

Z


Rx (z)xÌ„Ïƒ (z) + RX (z)XÌ„Ïƒ + RX+ (z) XÌ„Ïƒ + âˆ‚ XÌ„ Â· â„¦Ì„Ïƒ + XÌ„Î› PXÌ„Ïƒ dâ„¦(z) = 0.

Substituting for

âˆ‚ xÌ„,

we obtain and dening

XÌ„Ïƒ0 = âˆ‚ XÌ„ Â· â„¦Ì„Ïƒ

Fxâˆ’ (z)xÌ„Ïƒ (z) + Fx (z)xÌ„Ïƒ (z) + Fx+ (z) xÌ„Ïƒ (z) + xÌ„z (z)pxÌ„Ïƒ (z) + C(z)XÌ„Ïƒ0 + xÌ„Î› (z)PXÌ„Ïƒ



+ FX (z)XÌ„Ïƒ + FÏƒ (z) = 0,
or

L(z)xÌ„Ïƒ (z) = M(z)
Ïƒ

Dierentiating with respect to

â„¦ÌƒÏƒ (E, Î˜, â„¦, Î›)(y) = âˆ’

Z X

h

I XÌ„Ïƒ XÌ„Ïƒ0

which evaluated at

Ïƒ=0

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

Y

XZ
i

(81)

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j

j6=i

zÌƒÎµi (Îµ, E, Î˜, z, â„¦) Îµ

gives (as

â„¦Ì„Ïƒ (y) = âˆ’

.

yields

i

Ã—

i|

Îµ

+

zÌƒÏƒi


(Îµ, E, Î˜, z, â„¦) dPr(Îµ)dâ„¦(z)

is mean 0)

Î´(z i âˆ’ y i )

Y

Î¹(z j â‰¤ y j )zÌ„Ïƒi (z)dâ„¦(z).

j6=i

21 Note, we have dropped all the expectations as they are zero.

11



and

Ï‰Ì„E (y) = âˆ’

X âˆ‚

zÌ„Ïƒi (y)Ï‰(y) .
i
âˆ‚y
i

Plugging in for the denition of

XÌ„Ïƒ0 = Dâˆ’1
Substituting for

Z

xÌ„Ïƒ (z)

XÌ„Ïƒ0

we nd

Z
(Rz (z) + Rx (z)xÌ„z (z)) pxÌ„Ïƒ (z)dâ„¦(z)

(82)

in (82) and


Rx (z)xÌ„Ïƒ (z) + RX (z)XÌ„Ïƒ + RX+ XÌ„Ïƒ + XÌ„Ïƒ0 + XÌ„Î› PXÌ„Ïƒ + RÏƒ (z)dâ„¦(z) = 0

yields a linear system

NÂ·

h

XÌ„Ïƒ

XÌ„Ïƒ0

i|

=O

(83)

which is composed of small matrices.

B.6 Second-Order Terms
Here we describe how to compute all the second-order terms required for the Taylor expansion. To save on space, when obvious we drop dependence on

z.

B.6.1 Derivatives w.r.t. states
We start by dierentiating with respect to the states
computed by dierentiating
to

â„¦

F

w.r.t.

z

z

and

â„¦.

The term

âˆ‚ xÌ„z (z)

can be

and then taking the Frechet derivative with respect

to nd




0 =Fxâˆ’ âˆ‚ xÌ„z + Fx âˆ‚ xÌ„z + Fx+ âˆ‚ xÌ„z + xÌ„zÎ› âˆ‚ Î›Ì„ + Fxâˆ’X Â· xÌ„z , âˆ‚ XÌ„ + FxX Â· xÌ„z , âˆ‚ XÌ„



+ Fx+X Â· xÌ„z , âˆ‚ XÌ„ + Fzxâˆ’ Â· (I, âˆ‚ xÌ„) + Fzx Â· (I, âˆ‚ xÌ„) + FzX Â· I, âˆ‚ XÌ„ + Fzx+ Â· I, âˆ‚ xÌ„+


+ Fxâˆ’xâˆ’ Â· (xÌ„z , âˆ‚ xÌ„) + Fxâˆ’x Â· (xÌ„z , âˆ‚ xÌ„) + Fxâˆ’X Â· xÌ„z , âˆ‚ XÌ„ + Fxâˆ’x+ Â· xÌ„z , âˆ‚ xÌ„+


+ Fxxâˆ’ Â· (xÌ„z , âˆ‚ xÌ„) + Fxx Â· (xÌ„z , âˆ‚ xÌ„) + FxX Â· xÌ„z , âˆ‚ XÌ„ + Fxx+ Â· xÌ„z , âˆ‚ xÌ„+


+ Fx+xâˆ’ Â· (xÌ„z , âˆ‚ xÌ„) + Fx+x Â· (xÌ„z , âˆ‚ xÌ„) + Fx+X Â· xÌ„z , âˆ‚ XÌ„ + Fx+x+ Â· xÌ„z , âˆ‚ xÌ„+
where

I

âˆ‚ xÌ„+ (z)

represents the identity matrix and we use

â‰¡ âˆ‚ xÌ„(z) + xÌ„Î› (z)âˆ‚ Î›Ì„

a Â· (b, c)

a

is a

22

and

. This linear system is easily solved to give

âˆ‚ xÌ„z (z) = Q(z) Â· I, âˆ‚ XÌ„
22 Specically, if

to denote a bilinear map

n1 Ã— n2 Ã— n3

tensor,

b

is a

12



n2 Ã— n4

(84)
matrix and

c

is a

n3 Ã— n5

matrix

where

Q(z) is nx Ã— nz Ã— nX . The derivatives of xÌ„zz (z), xÌ„zÎ› (z) and xÌ„zÎ˜ (z) are equally easy

as they do not eect aggregates.
Next, twice dierentiating with respect to

â„¦Ì„Î›Î› = 0)

and

Î›

(again with the knowledge that

zÌ„Î›Î› = 0

implies

0 =Fxâˆ’ xÌ„Î›Î› + Fx xÌ„Î›Î› + FX XÌ„Î›Î› + Fx+ xÌ„Î› PXÌ„Î›Î› + xÌ„Î›Î› Î›Ì„2Î›



+ Fxâˆ’xâˆ’ Â· (xÌ„Î›, xÌ„Î› ) + 2Fxâˆ’x Â· (xÌ„Î› , xÌ„Î› ) + 2Fxâˆ’X (xÌ„Î› , XÌ„Î› ) + 2Fxâˆ’x+ Â· (xÌ„Î› , xÌ„Î› Î›Ì„Î› ) + 2Fxâˆ’Î› xÌ„Î›
+ Fxx Â· (xÌ„Î› , xÌ„Î› ) + 2FxX Â· (xÌ„Î› , XÌ„Î› ) + 2Fxx+ Â· (xÌ„Î› , xÌ„Î› Î›Ì„Î› ) + 2FxÎ› xÌ„Î› + FXX Â· (XÌ„Î› , XÌ„Î› )
+ 2FXx+ Â· (XÌ„Î› , xÌ„Î› Î›Ì„Î› ) + 2FXÎ› XÌ„Î› + Fx+x+ Â· (xÌ„Î› Î›Ì„Î› , xÌ„Î› Î›Ì„Î› ) + 2Fx+Î› xÌ„Î› Î›Ì„Î› + FÎ›Î›
and

Z
0=


Rx (z)xÌ„Î›Î› (z) + RX (z)XÌ„Î›Î› + RX+ (z) XÌ„Î› PXÌ„Î›Î› + XÌ„Î›Î› Î›Ì„2Î› + Rxx (z) Â· (xÌ„Î› (z), xÌ„Î› (z))


+ 2RxX (z) Â· xÌ„Î› (z), XÌ„Î› + 2RxX+ (z) Â· xÌ„Î› (z), XÌ„Î› Î›Ì„Î› + 2RxÎ› (z)xÌ„Î› (z)


+ RXX (z) Â· XÌ„Î› , XÌ„Î› + 2RXX+ (z) Â· XÌ„Î› , XÌ„Î› Î›Ì„Î› + 2RXÎ› (z)XÌ„Î›
!

+ RX+X+ Â· XÌ„Î› Î›Ì„Î› , XÌ„Î› Î›Ì„Î› + 2RX+Î› XÌ„Î› Î›Ì„Î› + RÎ›Î› (z) dâ„¦(z)

From the rst set of equations, we obtain

S(z)xÌ„Î›Î› (z) = T(z)
which we can then plug into the

R

h

I XÌ„Î›Î›

i

(85)

equation to yield

U(z)XÌ„Î›Î› = V(z).
A identical approach can be used to obtain expressions for

(86)

xÌ„Î˜Î˜ (z), xÌ„Î˜Î› (z), XÌ„Î˜Î˜

and

XÌ„Î˜Î›

which take the same form.
Next
then

âˆ‚ xÌ„Î› (z) is computed by dierentiating F

d = a Â· (b, c)

is

n1 Ã— n4 Ã— n5

and

R w.r.t Î› and then taking the Frechet

tensor dened by

dilm =

X

aijk bjl ckm .

j,k
This denition generalizes to when

a, b,

or

c

is innite dimensional, such as with

13

âˆ‚ xÌ„z .

derivative with respect to

â„¦

to nd (exploiting

âˆ‚ â„¦Ì„Î› = 0)

0 =Fxâˆ’ âˆ‚ xÌ„Î› + Fx âˆ‚ xÌ„Î› + FX âˆ‚ XÌ„Î› + Fx+ xÌ„Î› Pâˆ‚ XÌ„Î› + âˆ‚ xÌ„Î› Î›Ì„Î› + xÌ„Î›Î› Â· Î›Ì„Î› , âˆ‚ Î›Ì„



+ Fxâˆ’xâˆ’ Â· (xÌ„Î›, âˆ‚ xÌ„) + Fxâˆ’x Â· (xÌ„Î› , âˆ‚ xÌ„) + Fxâˆ’X (xÌ„Î› , âˆ‚ XÌ„) + Fxâˆ’x+ Â· (xÌ„Î› , âˆ‚ xÌ„+ ) + Fxxâˆ’ Â· (xÌ„Î› , âˆ‚ xÌ„)
+ Fxx Â· (xÌ„Î› , âˆ‚ xÌ„) + FxX Â· (xÌ„Î› , âˆ‚ XÌ„) + Fxx+ Â· (xÌ„Î› , âˆ‚ xÌ„+ ) + FXxâˆ’ Â· (XÌ„Î› , âˆ‚ xÌ„) + FXx Â· (XÌ„Î› , âˆ‚ xÌ„)
+ FXx+ Â· (XÌ„Î› , âˆ‚ xÌ„+ ) + Fx+xâˆ’ Â· (xÌ„Î› Î›Ì„Î› , âˆ‚ xÌ„) + Fx+x Â· (xÌ„Î› Î›Ì„Î› , âˆ‚ xÌ„) + Fx+X Â· (xÌ„Î› Î›Ì„Î› , âˆ‚ XÌ„)
+ Fx+x+ Â· (xÌ„Î› Î›Ì„Î› , âˆ‚ xÌ„+ )
and

Z


RÎ› (z) + Rx (z)xÌ„Î› (z) + RX (z)XÌ„Î› + RX+ (z)XÌ„Î› Î›Ì„Î› Î´(z)dz

0=
Z
+

Rx (z)âˆ‚ xÌ„Î› (z) Â· âˆ† + RX+ (z) XÌ„Î› Pâˆ‚ XÌ„Î› Â· âˆ† + âˆ‚ XÌ„Î› Â· âˆ†Î›Ì„Î› + XÌ„Î›Î› Â· Î›Ì„Î› , âˆ‚ Î›Ì„ Â· âˆ†



+ RX (z)âˆ‚ XÌ„Î› Â· âˆ† + Rxx (z) Â· (xÌ„Î› (z), âˆ‚ xÌ„(z) Â· âˆ†) + RxX (z) Â· (xÌ„Î› (z), âˆ‚ XÌ„ Â· âˆ†)
+ RxX+ (z) Â· (xÌ„Î› (z), âˆ‚ XÌ„ + Â· âˆ†) + RXx (z) Â· (XÌ„Î› , âˆ‚ xÌ„(z) Â· âˆ†) + RXX (z) Â· (XÌ„Î› , âˆ‚ XÌ„ Â· âˆ†)
+ RXX+ (z) Â· (XÌ„Î› , âˆ‚ XÌ„ + Â· âˆ†) + RX+x (XÌ„Î› Î›Ì„Î› , âˆ‚ xÌ„(z) Â· âˆ†) + RX+X Â· (XÌ„Î› Î›Ì„Î› , âˆ‚ XÌ„ Â· âˆ†)
!
+ RX+X+ Â· (XÌ„Î› Î›Ì„Î› , âˆ‚ XÌ„ + Â· âˆ†) + RÎ›x (z)âˆ‚ xÌ„(z) Â· âˆ† + RÎ›X (z)âˆ‚ XÌ„ Â· âˆ† + RÎ›X+ (z)âˆ‚ XÌ„ + Â· âˆ† dâ„¦(z),
where

âˆ‚ XÌ„ + â‰¡ âˆ‚ XÌ„ + XÌ„Î› âˆ‚ Î›Ì„.

From

F

equations we immediately obtain

W(z)âˆ‚ xÌ„Î› (z) = X(z)
which can be plugged into the equations from

Z
Yâˆ‚ XÌ„Î› Â· âˆ† = Zâˆ‚ XÌ„ Â· âˆ† +

h

R

âˆ‚ XÌ„Î› âˆ‚ XÌ„

i|

(87)

to obtain


RÎ› (z) + Rx (z)xÌ„Î› (z) + RX (z)XÌ„Î› + RX+ (z)XÌ„Î› Î›Ì„Î› Î´(z)dz.
(88)

A similar approach can be used to obtain expressions for
same form.

14

âˆ‚ xÌ„Î˜ (z)

and

âˆ‚ XÌ„Î˜

which take the

Finally the second-order Frechet derivative of

F

in the directions of

âˆ†1

and

âˆ†2

yields

0 =Fxâˆ’ âˆ‚ 2 xÌ„ Â· (âˆ†1 , âˆ†2 ) + Fx âˆ‚ 2 xÌ„ Â· (âˆ†1 , âˆ†2 ) + Fx+ âˆ‚ 2 xÌ„ Â· (âˆ†1 , âˆ†2 ) + FX âˆ‚ 2 XÌ„ Â· (âˆ†1 , âˆ†2 )



+ Fx+ xÌ„Î› Pâˆ‚ 2 XÌ„ Â· (âˆ†1 , âˆ†2 ) + xÌ„Î›Î› Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2 + (âˆ‚ xÌ„Î› Â· âˆ†1 ) âˆ‚ Î›Ì„ Â· âˆ†2 + (âˆ‚ xÌ„Î› Â· âˆ†2 ) âˆ‚ Î›Ì„ Â· âˆ†1

+ Fxâˆ’xâˆ’ Â· (âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 ) + Fxâˆ’x Â· (âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 ) + Fxâˆ’x+ Â· âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„+ Â· âˆ†2

+ Fxâˆ’X Â· âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2 + Fxxâˆ’ Â· (âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 ) + Fxx Â· (âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 )



+ Fxx+ Â· âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ xÌ„+ Â· âˆ†2 + FxX Â· âˆ‚ xÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2 + Fx+xâˆ’ Â· âˆ‚ xÌ„+ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2



+ Fx+x Â· âˆ‚ xÌ„+ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 + Fx+x+ Â· âˆ‚ xÌ„+ Â· âˆ†1 , âˆ‚ xÌ„+ Â· âˆ†2 + Fx+X Â· âˆ‚ xÌ„+ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2



+ FXxâˆ’ Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 + FXx Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ xÌ„ Â· âˆ†2 + FXx+ Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ xÌ„+ Â· âˆ†2

+ FXX Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2
Substituting for

âˆ‚ xÌ„(z) = C(z)âˆ‚ XÌ„

and

âˆ‚ xÌ„Î› (z),

and then solving for

âˆ‚ 2 xÌ„

gives


âˆ‚ 2 xÌ„(z) Â· (âˆ†1 , âˆ†2 ) =C(z)âˆ‚ 2 XÌ„ Â· (âˆ†1 , âˆ†2 ) + AA1 (z) Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2

+ AA2 (z) âˆ‚ XÌ„Î› Â· âˆ†1 âˆ‚ Î›Ì„ Â· âˆ†2 + âˆ‚ XÌ„Î› Â· âˆ†2 âˆ‚ Î›Ì„ Â· âˆ†1 .
To nd

Z

âˆ‚ 2 XÌ„

we dierentiate

R

w.r.t

â„¦

in the direction

âˆ†1

and then

âˆ†2

(89)

to nd

Rx (z)âˆ‚ 2 xÌ„(z) Â· (âˆ†1 , âˆ†2 ) + RX (z)âˆ‚ 2 XÌ„ Â· (âˆ†1 , âˆ†2 ) + RX+ (z)âˆ‚ 2 XÌ„ Â· (âˆ†1 , âˆ†2 )

0=




+ RX+ (z) XÌ„Î›Î› (âˆ‚ Î›Ì„ Â· âˆ†1 )(âˆ‚ Î›Ì„ Â· âˆ†2 ) + âˆ‚ XÌ„Î› Â· âˆ†1 âˆ‚ Î›Ì„ Â· âˆ†2 + âˆ‚ XÌ„Î› Â· âˆ†2 âˆ‚ Î›Ì„ Â· âˆ†1

+ Rxx (z) Â· (âˆ‚ xÌ„(z) Â· âˆ†1 , âˆ‚ xÌ„(z) Â· âˆ†2 ) + RxX (z) Â· âˆ‚ xÌ„(z) Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2



+ RxX+ (z) Â· âˆ‚ xÌ„(z) Â· âˆ†1 , âˆ‚ XÌ„ + Â· âˆ†2 + RXx (z) Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ xÌ„(z) Â· âˆ†2 + RXX (z) Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2


+ RXX+ (z) Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ + Â· âˆ†2 + RX+x (z) Â· âˆ‚ XÌ„ + Â· âˆ†1 , âˆ‚ xÌ„(z) Â· âˆ†2
!


+ RX+X (z) Â· âˆ‚ XÌ„ + Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2 + RX+X+ (z) Â· âˆ‚ XÌ„ + Â· âˆ†1 , âˆ‚ XÌ„ + Â· âˆ†2 dâ„¦(z)
Z


Rx (z)âˆ‚ xÌ„(z) Â· âˆ†1 + RX (z)âˆ‚ XÌ„ Â· âˆ†1 + RX+ (z)âˆ‚ XÌ„ + Â· âˆ†1 dâˆ†2 (z)

Z


Rx (z)âˆ‚ xÌ„(z) Â· âˆ†2 + RX (z)âˆ‚ XÌ„ Â· âˆ†2 + RX+ (z)âˆ‚ XÌ„ + Â· âˆ†2 dâˆ†1 (z)

+
+

15

A bit of rearranging and substituting for

Z

2

âˆ‚ 2 xÌ„

yields


Rx (z)âˆ‚ xÌ„(z) Â· âˆ†1 + RX (z)âˆ‚ XÌ„ Â· âˆ†1 + RX+ (z)âˆ‚ XÌ„ + Â· âˆ†1 dâˆ†2 (z)

Dâˆ‚ XÌ„ Â· (âˆ†1 , âˆ†2 ) =
Z


Rx (z)âˆ‚ xÌ„(z) Â· âˆ†2 + RX (z)âˆ‚ XÌ„ Â· âˆ†2 + RX+ (z)âˆ‚ XÌ„ + Â· âˆ†2 dâˆ†1 (z)



+ BB Â· âˆ‚ XÌ„ Â· âˆ†1 , âˆ‚ XÌ„ Â· âˆ†2 + CC âˆ‚ XÌ„Î› Â· âˆ†2 âˆ‚ Î›Ì„ Â· âˆ†1 + CC âˆ‚ XÌ„Î› Â· âˆ†1 âˆ‚ Î›Ì„ Â· âˆ†2 .
+

(90)

B.6.2 Derivatives w.r.t. shocks
Next we proceed by taking derivatives w.r.t.

Ïƒ

and then use the method of undeter-

mined coecients to nd the derivatives associated with each pair of shocks. Solving for

xÌ„ÎµÎµ , xÌ„ÎµÎ˜ , xÌ„ÎµÎ› , xÌ„ÎµÏƒ

and

xÌ„ÎµE

are trivial as these interactions do not eect aggregates so we

omit those formulas them for brevity.
For

xÌ„EÎ›

we see (after dening

xÌ„+
E = xÌ„Î˜ + xÌ„z zÌ„E + âˆ‚ xÌ„ Â· â„¦Ì„E + xÌ„Î› Î›Ì„E )

0 =Fx xÌ„EÎ› + FX XÌ„EÎ› + Fx+ xÌ„Î˜Î› Î›Ì„Î› + xÌ„zÎ› xÌ„E Î›Ì„Î› + âˆ‚ xÌ„Î› Â· â„¦Ì„E Î›Ì„Î› + xÌ„z pxÌ„EÎ› + âˆ‚ xÌ„ Â· â„¦Ì„EÎ›



+ Fx+ xÌ„Î› PXÌ„EÎ› + Fxxâˆ’ Â· (xÌ„E , xÌ„Î› ) + Fxx Â· (xÌ„E , xÌ„Î› ) + FxX Â· (xÌ„E , XÌ„Î› ) + Fxx+ Â· (xÌ„E , xÌ„Î› Î›Ì„Î› ) + FxÎ› xÌ„E
+ FXxâˆ’ Â· (XÌ„E , xÌ„Î› ) + FXx Â· (XÌ„E , xÌ„Î› ) + FXx+ Â· (XÌ„E , xÌ„Î› Î›Ì„Î› ) + FXÎ› XÌ„Î› + Fx+xâˆ’ Â· (xÌ„+
E , xÌ„Î› )
+
+
+
+ Fx+x Â· (xÌ„+
E , xÌ„Î› ) + Fx+X Â· (xÌ„E , XÌ„Î› ) + Fx+x+ Â· (xÌ„E , xÌ„Î› Î›Ì„Î› ) + Fx+Î› (xÌ„E )

+ FExâˆ’ xÌ„Î› + FEx xÌ„Î› + FEX XÌ„Î› + FEx+ xÌ„Î› Î›Ì„Î› + FEÎ›
Most of these terms are already known, but there are a few that are new and need to be
computed:

âˆ‚ xÌ„ Â· â„¦Ì„EÎ›

and

âˆ‚ xÌ„Î› Â· â„¦Ì„E .

For the rst,

0 .
âˆ‚ xÌ„ Â· â„¦Ì„EÎ› = C(z)âˆ‚ XÌ„ Â· â„¦Ì„EÎ› â‰¡ C(z)XÌ„EÎ›

For

the second, we have

âˆ‚ xÌ„Î› (z) Â· â„¦Ì„E = Y(z)âˆ’1 z1 (z)âˆ‚ XÌ„Î› Â· â„¦Ì„E + Y(z)âˆ’1 z2 (z)XE0
where

âˆ‚ XÌ„Î› Â· â„¦Ì„E = Yâˆ’1 ZXE0 + Yâˆ’1

Z


RÎ› (z) + Rx (z)xÌ„Î› (z) + RX (z)XÌ„Î› + RX+ (z)XÌ„Î› Î›Ì„Î› Ï‰Ì„E (z)dz

Z

âˆ‚
âˆ‚
RÎ› (z) +
RÎ› (z)xÌ„Î˜ (z) + RÎ› (z)xÌ„Î˜z (z)
âˆ‚z
âˆ‚z
!
d
âˆ‚
+
RX (z)XÌ„Î› +
RX+ (z)XÌ„Î› Î›Ì„Î› zÌ„E (z) Ï‰(z)dz
âˆ‚z
dz

= Yâˆ’1 ZXE0 + Yâˆ’1

16

23

where the last term is easily computable from known terms.
derivative

xÌ„EÎ›

Thus, we can show that the

solves the following system of equations

DD(z)xÌ„EÎ› = EE(z)
To determine

h

0
I XÌ„EÎ› XÌ„EÎ›

i

.

(91)

0 , proceed in the same manner as the rst-order terms.
XÌ„EÎ› and XÌ„EÎ›

Recall

we had,

â„¦ÌƒE (E, Î˜, â„¦, Î›)(y) = âˆ’

Z X

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Ã—

Y

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

zÌƒEi

(Îµ, E, Î˜, z, â„¦) dPr(Îµ)dâ„¦(z),

and thus

â„¦ÌƒEÎ› (E, Î˜, â„¦, Î›)(y) = âˆ’

Z X

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Ã—
Z

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

i
zÌƒEÎ›
(Îµ, E, Î˜, z, â„¦, Î›) dPr(Îµ)dâ„¦(z)

X

âˆ’

Y

Î´ 0 (zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

!
zÌƒEi

Ã—
Z

XX

+

i

(Îµ, E, Î˜, z, â„¦, Î›) zÌƒÎ›i (Îµ, E, Î˜, z, â„¦, Î›)

dPr (Îµ) dâ„¦(z)

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )Î´(zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y j )

j6=i


Y 
Î¹ zÌƒ k (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y k zÌƒEi (Îµ, E, Î˜, z, â„¦, Î›)
k6=i,j

Ã—
Evaluating this term at

Ïƒ=0

â„¦Ì„EÎ› = âˆ’

zÌƒÎ›i (Îµ, E, Î˜, z, â„¦, Î›)

and exploiting

XZ
i

Î´(z i âˆ’ y i )


dPr (Îµ) dâ„¦(z)

zÌ„Î› (z) = 0
Y

we have

i
Î¹(z j â‰¤ y j )zÌ„EÎ›
(z)dâ„¦(z)

j6=i

23 For compactness we have not expanded terms like âˆ‚ R (z), but this is easily accomâˆ‚z Î›
âˆ‚
plished. For example
R
(z)
=
R
(z)
+
R
(z)
xÌ„
(z)
.
Î›
Î›z
Î›
Î˜x
âˆ‚z

17

and thus

X âˆ‚ Z Y
X âˆ‚

i
j
j i
Ï‰Ì„EÎ› (y) = âˆ’
zÌ„
Î´(z
âˆ’
y
)
zÌ„
(y)Ï‰(y)
(z)dâ„¦(z)
=
âˆ’
EÎ›
EÎ›
âˆ‚y i
âˆ‚y i
i

j

i

and hence

0
XÌ„EÎ›

Z

X âˆ‚

i
zÌ„
(z)Ï‰(z)
dz
EÎ›
âˆ‚z i
i

Z X
âˆ‚
âˆ’1
i
=D
R(z) zÌ„EÎ›
(z)Ï‰(z)dz
âˆ‚z i
i
Z X
i
= Dâˆ’1
(Rzi (z) + Rx (z)xÌ„zi (z)) zÌ„EÎ›
dâ„¦(z)
= âˆ’D

âˆ’1

R(z)

i

= Dâˆ’1

Z
(Rz (z) + Rx (z)xÌ„z (z)) qxÌ„EÎ› (z)dâ„¦(z)

which combined with the second derivative of

R

w.r.t.

EÎ›

(dening

XÌ„E+ = XÌ„Î˜ + XÌ„E0 +

XÌ„Î› Î›Ì„E )

Z

0
Rx (z)xÌ„EÎ› (z) + RX (z)XÌ„EÎ› + RX+ (z) XÌ„Î˜Î› Î›Ì„Î› + âˆ‚ XÌ„Î› Â· â„¦Ì„E + XÌ„Î›Î› Î›Ì„Î› Î›Ì„E + XÌ„EÎ›
+ XÌ„Î› PXÌ„EÎ›





+ Rxx (z) Â· (xÌ„E (z), xÌ„Î› (z)) + RxX (z) Â· xÌ„E (z), XÌ„Î› + RxX+ Â· xÌ„E (z), XÌ„Î› Î›Ì„Î› + RxÎ› (z)xÌ„E (z)



+ RXx (z) Â· XÌ„E , xÌ„Î› (z) + RXX (z) Â· XÌ„E , XÌ„Î› + RXX+ (z) Â· XÌ„E , XÌ„Î› Î›Ì„Î› + RXÎ› (z)XÌ„E



+ RX+x (z) Â· XÌ„E+ , xÌ„Î› (z) + RX+X (z) Â· XÌ„E+ , XÌ„Î› + RX+X+ (z) Â· XÌ„E+ , XÌ„Î› Î›Ì„Î› + RX+Î› (z)XÌ„E+
!
+ REx (z)xÌ„Î› (z) + REX (z)XÌ„Î› + REX+ (z)XÌ„Î› Î›Ì„Î› + REÎ› (z) dâ„¦(z) = 0
gives a linear relationship

FF
to solve for

XÌ„EÎ› .

h

0
XÌ„EÎ› XÌ„EÎ›

i

= GG

A similar approach can be used to obtain expressions for

xÌ„ÏƒÎ˜ (z), XÌ„ÏƒÎ˜ , xÌ„ÏƒÎ› (z),

and

XÌ„ÏƒÎ› ,

which take the same form.

18

(92)

xÌ„EÎ˜ (z), XÌ„EÎ˜ ,

For

xÌ„EE

we see

0 =Fx xÌ„EE + FX XÌ„EE + Fx+ xÌ„z pxÌ„EE + âˆ‚ xÌ„ Â· â„¦Ì„EE + xÌ„Î› PXÌ„EE + xÌ„Î˜Î˜ + xÌ„Î˜z Â· (I, zÌ„E ) + âˆ‚ xÌ„Î˜ Â· I, â„¦Ì„E







+ xÌ„Î˜Î› Â· I, Î›Ì„E + xÌ„zz Â· (zÌ„E , zÌ„E ) + xÌ„zÎ˜ Â· (zÌ„E , I) + âˆ‚ xÌ„z Â· zÌ„E , â„¦Ì„E + xÌ„zÎ› Â· zÌ„E , Î›Ì„E + âˆ‚ xÌ„Î˜ Â· â„¦Ì„E , I




+ âˆ‚ xÌ„z Â· â„¦Ì„E , zÌ„E + âˆ‚ xÌ„Î˜ Â· â„¦Ì„E , I + âˆ‚ xÌ„z Â· â„¦Ì„E , zÌ„E + âˆ‚ 2 xÌ„ Â· (â„¦Ì„E , â„¦Ì„E ) + âˆ‚ xÌ„Î› Â· â„¦Ì„E , Î›Ì„E
!



+ xÌ„Î›Î˜ Â· Î›Ì„E , I + xÌ„Î›z Â· Î›Ì„E , zÌ„E + âˆ‚ xÌ„Î› Â· Î›E , â„¦Ì„E + xÌ„Î›Î› Â· (Î›E , Î›E ) + Fxx Â· (xÌ„E , xÌ„E )




+ FxX Â· xÌ„E , XÌ„E + Fxx+ Â· xÌ„E , xÌ„+
E + FxE Â· (xÌ„E , I) + FXx Â· XÌ„E , xÌ„E + FXX Â· XÌ„E , XÌ„E





+
+
+
+
+ FXx+ Â· XÌ„E , xÌ„+
E + FXE Â· XÌ„E , I + Fx+x Â· xÌ„E , xÌ„E + Fx+X Â· xÌ„E , XÌ„E + Fx+x+ Â· xÌ„E , xÌ„E



+
+ Fx+E Â· xÌ„+
E , I + FEx Â· (I, xÌ„E ) + FEX Â· I, XÌ„E + FEx+ Â· I, xÌ„E + FEE
Once again, almost all of these terms are already known with the exception of

(â„¦Ì„E , â„¦Ì„E )

which is computable from the expressions for

âˆ‚ 2 XÌ„

above and

âˆ‚ xÌ„ Â· â„¦Ì„EE

âˆ‚ 2 xÌ„ Â·
which

equals

0
âˆ‚ xÌ„(z) Â· â„¦Ì„EE = C(z)âˆ‚ XÌ„ Â· â„¦Ì„EE = C(z)XÌ„EE
.
Thus, we have that

H(z)xÌ„EE (z) = HH(z)
where

h

I XÌ„EE

0
XÌ„EE

i|

,

(93)

H(z) is the same as in the rst-order expansion equation (80) and HH(z) is computable

from the rst-order terms.
To solve for

XÌ„EE

and

0
XÌ„EE

we rst need

â„¦Ì„EE

19

which we nd by dierentiating the law

of motion for

â„¦

to get

â„¦ÌƒEE (E, Î˜, â„¦, Î›)(y) = âˆ’

Z X

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

i
Ã— zÌƒEE
(Îµ, E, Î˜, z, â„¦, Î›) dPr(Îµ)dâ„¦(z)

Z
âˆ’

X

Î´ 0 (zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

!
zÌƒEi

Ã—
+

Z XX
i

(Îµ, E, Î˜, z, â„¦, Î›) zÌƒEi

(Îµ, E, Î˜, z, â„¦, Î›) dPr (Îµ) dâ„¦(z)

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )Î´(zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y j )

j6=i

Ã—


Y 
Î¹ zÌƒ k (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y k zÌƒEj (Îµ, E, Î˜, z, â„¦, Î›)
k6=i,j

!
Ã— zÌƒEi (Îµ, E, Î˜, z, â„¦, Î›) dPr (Îµ) dâ„¦(z) .
Evaluated at

Ïƒ = 0,

â„¦Ì„EE (y) = âˆ’

this becomes

Z X

Î´(z i âˆ’ y i )

i

âˆ’

Z X

+

i

i
Î¹(z j âˆ’ y j )zÌ„EE
(z)dâ„¦(z)

j6=i

Î´ 0 (z i âˆ’ y i )

i

Z X

Y

Y


2
Î¹(z j âˆ’ y j ) zÌ„Ei (z) dâ„¦(z)

j6=i

Î´(z i âˆ’ y i )

X

Î´(z j âˆ’ y j )

j6=i

Y

Î¹(z k âˆ’ y k )zÌ„Ej (z)zÌ„Ei (z)dâ„¦(z)

k6=i,j

and

Ï‰Ì„EE (y) =

X âˆ‚
âˆ‚ nz
â„¦Ì„
(y)
=
âˆ’
EE
1
2
n
âˆ‚y âˆ‚y Â· Â· Â· âˆ‚y z
âˆ‚y i
i

Z Y

i
Î´(z j âˆ’ y j )zÌ„EE
(z)dâ„¦(z)

j

X âˆ‚ Z
Y
2
0 i
i
Î´
(z
âˆ’
y
)
Î´(z j âˆ’ y j ) zÌ„Ei (z) dâ„¦(z)
âˆ’
i
âˆ‚y
i
j6=i
X X âˆ‚2 Z Y
+
Î´(z j âˆ’ y j )zÌ„Ej (z)zÌ„Ei dâ„¦(z)
âˆ‚y i âˆ‚y j
i

=âˆ’

j6=i

j


X âˆ‚
 X X âˆ‚2  i
j
i
zÌ„
(y)Ï‰(y)
+
zÌ„
(y)
zÌ„
(y)Ï‰(y)
.
E
E
âˆ‚y i EE
âˆ‚y i âˆ‚y j
i

i

20

j

Thus,

ï£¶


2
X
X
X âˆ‚

âˆ‚
i
zÌ„EE
(z)Ï‰(z) +
zÌ„Ei (z)zÌ„Ej (z)Ï‰(z) ï£¸ dz
R(z) ï£­âˆ’
i
i
j
âˆ‚z
âˆ‚z âˆ‚z
ï£«

0
XÌ„EE
=

Z

i

i

j

Z
=

(Rz (z) + Rx (z)xÌ„z (z)) pxÌ„iEE (z)Ï‰(z)dz

Z 
+
Rzz (z) + Rxz (z) Â· (I, xÌ„z (z)) + Rzx (z) Â· (xÌ„z (z), I) + Rxx (z) Â· (xÌ„z (z), xÌ„z (z))
Â· (pxÌ„E (z), pxÌ„E (z)) Ï‰(z)dz

which when combined with the second derivative of

Z
0=

R

w.r.t

EE






RX+ (z) XÌ„Î˜Î˜ + âˆ‚ XÌ„Î˜ Â· I, â„¦Ì„E + XÌ„Î˜Î› Â· I, Î›Ì„E + âˆ‚ XÌ„Î˜ Â· â„¦Ì„E , I + âˆ‚ 2 XÌ„ Â· â„¦Ì„E , â„¦Ì„E
!
0
+ XÌ„Î› PXÌ„EE
+ âˆ‚ XÌ„Î› Â· â„¦Ì„E , Î›E + XÌ„Î›Î˜ Â· Î›Ì„E , I + âˆ‚ XÌ„Î› Â· Î›Ì„E , I + XÌ„Î›Î› Î›Ì„2E + XÌ„EE







+ Rx (z)xÌ„EE (z) + RX (z)XÌ„EE + Rxx (z) Â· (xÌ„E (z), xÌ„E (z)) + RxX (z) Â· xÌ„E (z), XÌ„E


+ RxX+ (z) Â· xÌ„E (z), XÌ„E+ + RxE (z) Â· (xÌ„E (z), I) + RXx (z) Â· XÌ„E , xÌ„E (z)



+ RXX (z) Â· XÌ„E , XÌ„E + RXX+ (z) Â· XÌ„E , XÌ„E+ + RXE (z) Â· XÌ„E , I



+ RX+x (z) Â· XÌ„E+ , xÌ„E (z) + RX+X (z) Â· XÌ„E+ , XÌ„E + RX+X+ (z) Â· XÌ„E+ , XÌ„E+


+ RX+E (z) Â· XÌ„E+ , I + REx (z) Â· (I, xÌ„E (z)) + REX (z) Â· I, XÌ„E
!

+ REX+ (z) Â· I, XÌ„E+ + REE (z) dâ„¦(z)



gives a system of linear equations of the form

KÂ·

h

XÌ„EE

0
XÌ„EE

i|

= II.

A similar approach can be used to obtain expressions for

(94)

xÌ„EÏƒ (z)

and

XÌ„EÏƒ

which take the

same form.
Finally, for the second-order expansion we need the eect of the presence of risk. Dier-

21

entiation of

F

gives, after dening

xÌ„+
Ïƒ = xÌ„z zÌ„Ïƒ + âˆ‚ xÌ„ Â· â„¦Ì„Ïƒ + xÌ„Î› Î›Ì„Ïƒ + xÌ„Ïƒ ,
!

0 =Fx xÌ„ÏƒÏƒ + FX XÌ„ÏƒÏƒ + Fx+ E [xÌ„ÎµÎµ Â· (Îµ, Îµ) + xÌ„EE Â· (E, E)] + xÌ„z pxÌ„ÏƒÏƒ + âˆ‚ xÌ„ Â· â„¦Ì„ÏƒÏƒ + xÌ„Î› PXÌ„ÏƒÏƒ
+ Fx+ xÌ„zz Â· (zÌ„Ïƒ , zÌ„Ïƒ ) + 2âˆ‚ xÌ„z Â· (â„¦Ì„Ïƒ , zÌ„Ïƒ ) + 2xÌ„zÎ› Â· (zÌ„Ïƒ , Î›Ì„Ïƒ ) + 2xÌ„zÏƒ zÌ„Ïƒ + âˆ‚ 2 xÌ„ Â· (â„¦Ì„Ïƒ , â„¦Ì„Ïƒ )
!
+ Fxâˆ’xâˆ’ Â· (xÌ„Ïƒ, xÌ„Ïƒ )

+ 2âˆ‚ xÌ„Î› Â· (â„¦Ì„Ïƒ , Î›Ì„Ïƒ ) + 2âˆ‚ xÌ„Ïƒ Â· â„¦Ì„Ïƒ + xÌ„Î›Î› Â· (Î›Ì„Ïƒ , Î›Ì„Ïƒ ) + 2xÌ„Î›Ïƒ Î›Ì„Ïƒ + xÌ„ÏƒÏƒ

+ 2Fxâˆ’x Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2Fxâˆ’X (xÌ„Ïƒ , XÌ„Ïƒ ) + 2Fxâˆ’x+ Â· (xÌ„Ïƒ , xÌ„+
Ïƒ ) + 2Fxâˆ’Ïƒ xÌ„Ïƒ
+ Fxx Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2FxX Â· (xÌ„Ïƒ , XÌ„Ïƒ ) + 2Fxx+ Â· (xÌ„Ïƒ , xÌ„+
Ïƒ ) + 2FxÏƒ xÌ„Ïƒ + FXX Â· (XÌ„Ïƒ , XÌ„Ïƒ )
+
+
+
+ 2FXx+ Â· (XÌ„Ïƒ , xÌ„+
Ïƒ ) + 2FXÏƒ XÌ„Ïƒ + Fx+x+ Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2Fx+Ïƒ xÌ„Ïƒ + FÏƒÏƒ

+ Fxâˆ’ E [xÌ„ÏƒÏƒ + xÌ„ÎµÎµ Â· (Îµ, Îµ) + xÌ„EE Â· (E, E)] = 0.
24

or

!
0 =Fx xÌ„ÏƒÏƒ + FX XÌ„ÏƒÏƒ + Fx+ xÌ„ÎµÎµ Â· var(Îµ) + xÌ„EE Â· var(E) + xÌ„z pxÌ„ÏƒÏƒ + âˆ‚ xÌ„ Â· â„¦Ì„ÏƒÏƒ + xÌ„Î› PXÌ„ÏƒÏƒ
+ Fx+ xÌ„zz Â· (zÌ„Ïƒ , zÌ„Ïƒ ) + 2âˆ‚ xÌ„z Â· (â„¦Ì„Ïƒ , zÌ„Ïƒ ) + 2xÌ„zÎ› Â· (zÌ„Ïƒ , Î›Ì„Ïƒ ) + 2xÌ„zÏƒ zÌ„Ïƒ + âˆ‚ 2 xÌ„ Â· (â„¦Ì„Ïƒ , â„¦Ì„Ïƒ )
!
+ 2âˆ‚ xÌ„Î› Â· (â„¦Ì„Ïƒ , Î›Ì„Ïƒ ) + 2âˆ‚ xÌ„Ïƒ Â· â„¦Ì„Ïƒ + xÌ„Î›Î› Â· (Î›Ì„Ïƒ , Î›Ì„Ïƒ ) + 2xÌ„Î›Ïƒ Î›Ì„Ïƒ + xÌ„ÏƒÏƒ
+ Fxâˆ’xâˆ’ Â· (xÌ„Ïƒ, xÌ„Ïƒ ) + 2Fxâˆ’x Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2Fxâˆ’X (xÌ„Ïƒ , XÌ„Ïƒ ) + 2Fxâˆ’x+ Â· (xÌ„Ïƒ , xÌ„+
Ïƒ ) + 2Fxâˆ’Ïƒ xÌ„Ïƒ
+ Fxx Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2FxX Â· (xÌ„Ïƒ , XÌ„Ïƒ ) + 2Fxx+ Â· (xÌ„Ïƒ , xÌ„+
Ïƒ ) + 2FxÏƒ xÌ„Ïƒ + FXX Â· (XÌ„Ïƒ , XÌ„Ïƒ )
+
+
+
+ 2FXx+ Â· (XÌ„Ïƒ , xÌ„+
Ïƒ ) + 2FXÏƒ XÌ„Ïƒ + Fx+x+ Â· (xÌ„Ïƒ , xÌ„Ïƒ ) + 2Fx+Ïƒ xÌ„Ïƒ + FÏƒÏƒ

+ Fxâˆ’ [xÌ„ÏƒÏƒ + xÌ„ÎµÎµ Â· var(Îµ) + xÌ„EE Â· var(E)]
Dening

0 ,
âˆ‚ xÌ„(z) Â· â„¦Ì„ÏƒÏƒ = C(z)âˆ‚ XÌ„ Â· â„¦Ì„ÏƒÏƒ â‰¡ C(z)XÌ„ÏƒÏƒ

we nd that

system

JJ(z)xÌ„ÏƒÏƒ (z) = KK(z)
24 Recall

xÌ„ÎµÎµ is
[
xÌ„
]
var
(Îµ)jk
ÎµÎµ
ijk
jk

a 3-dimensional tensor.

h

0
I XÌ„ÏƒÏƒ XÌ„ÏƒÏƒ

We dene

P

22

xÌ„ÎµÎµ Â·

i|

.

xÌ„ÏƒÏƒ (z)

solves the linear

(95)

var(Îµ) by the contraction

To solve for

0
XÌ„ÏƒÏƒ

we need to nd

Z

X

â„¦ÌƒÏƒÏƒ (E, Î˜, â„¦, Î›)(y) = âˆ’

â„¦Ì„ÏƒÏƒ

by dierentiating the law of motion for

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y

â„¦ 25

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

!
i
i
zÌƒÎµÎµ
(Îµ, E, Î˜, z, â„¦, Î›) Â· (Îµ, Îµ) + zÌƒÏƒÏƒ
(Îµ, E, Î˜, z, â„¦, Î›)

Z

X

âˆ’

Î´ 0 (zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )

i

Y



dPr(Îµ)dâ„¦(z)

Î¹ zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y j



j6=i

zÌƒÎµi (Îµ, E, Î˜, z, â„¦, Î›) ÎµzÌƒÎµi (Îµ, E, Î˜, z, â„¦, Î›) Îµ
!!
+ zÌƒÏƒi (Îµ, E, Î˜, z, â„¦, Î›) zÌƒÏƒi (Îµ, E, Î˜, z, â„¦, Î›)
âˆ’

Z XX
i

dPr (Îµ) dâ„¦(z)

Î´(zÌƒ i (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y i )Î´(zÌƒ j (Îµ, E, Î˜, z, â„¦, Î›) âˆ’ y j )

j6=i


Y 
k
k
Î¹ zÌƒ (Îµ, E, Î˜, z, â„¦, Î›) â‰¤ y
zÌƒÎµj (Îµ, E, Î˜, z, â„¦, Î›) ÎµzÌƒÎµi (Îµ, E, Î˜, z, â„¦, Î›) Îµ
k6=i,j

!
zÌƒÏƒj (Îµ, E, Î˜, z, â„¦, Î›) zÌƒÏƒi (Îµ, E, Î˜, z, â„¦, Î›)
dPr (Îµ) dâ„¦(z)
Evaluating at

â„¦Ì„ÏƒÏƒ (y) = âˆ’

Ïƒ=0

Z X

we nd

Î´(z i âˆ’ y i )

i

âˆ’

Z X

+


i
i
Î¹(z j âˆ’ y j ) zÌ„ÏƒÏƒ
(z) + zÌ„ÎµÎµ
Â· var(Îµ) dâ„¦(z)

j6=i

Î´ 0 (z i âˆ’ y i )

i

Z X

Y

Y


2

2
Î¹(z j âˆ’ y j ) zÌ„Îµi (z) Â· var(Îµ) + zÌ„Ïƒi (z) dâ„¦(z)

j6=i

Î´(z i âˆ’ y i )

i

X

Î´(z j âˆ’ y j )

j6=i

Y


Î¹(z k âˆ’ y k ) zÌ„Îµj (z)zÌ„Îµi (z) Â· var(Îµ) + zÌ„Ïƒj (z)zÌ„Ïƒi (z)dâ„¦(z)

k6=i,j

which gives

Ï‰Ì„ÏƒÏƒ (y) = âˆ’

X âˆ‚
âˆ‚y i

+

XX



i
i
zÌ„ÏƒÏƒ
(y) + zÌ„ÎµÎµ
(y) Â· var(Îµ) Ï‰(y)

i

i

j

âˆ‚2
âˆ‚y i âˆ‚y j




zÌ„Îµi (y)zÌ„Îµj (y) Â· var(Îµ) + zÌ„Ïƒi (y)zÌ„Ïƒj (y) Ï‰(y) .

25 For simplicity we drop the cross terms between
evaluated at

Ïƒ = 0.

23

Ïƒ

and

Îµ

which integrate to 0 when

Thus,

0
XÌ„ÏƒÏƒ

Z
=

âˆ’

R(z)

X âˆ‚

i
i
(zÌ„ÏƒÏƒ
(z) + zÌ„ÎµÎµ
(y)var(Îµ))Ï‰(z)
i
âˆ‚z
i

+

XX
i

Z
=

j

âˆ‚2
âˆ‚z i âˆ‚z j

zÌ„Îµi (z)zÌ„Îµj (z)var(Îµ)

+

zÌ„Ïƒi (z)zÌ„Ïƒj (z)



!

Ï‰(z) dz


i
i
(Rz (z) + Rx (z)xÌ„z (z)) zÌ„ÏƒÏƒ
(z) + zÌ„ÎµÎµ
(y)var(Îµ) Ï‰(z)dz
!

Z

Rzz (z) + Rxz (z) Â· (I, xÌ„z (z)) + Rzx (z) Â· (xÌ„z (z), I) + Rxx (z) Â· (xÌ„z (z), xÌ„z (z))

+

Â· (zÌ„Îµ (z), zÌ„Îµ (z)) Â· var(Îµ)Ï‰(z)dz
!

Z
+

Rzz (z) + Rxz (z) Â· (I, xÌ„z (z)) + Rzx (z) Â· (xÌ„z (z), I) + Rxx (z) Â· (xÌ„z (z), xÌ„z (z))
Â· (zÌ„Ïƒ (z), zÌ„Ïƒ (z)) Â· var(Îµ)Ï‰(z)dz

which combined with the second derivative of

R

w.r.t

ÏƒÏƒ

, after dening

XÌ„Ïƒ+ = XÌ„Ïƒ0 +

XÌ„Î› Î›Ì„Ïƒ + XÌ„Ïƒ
Z

0
Rx (z) (xÌ„ÏƒÏƒ (z) + xÌ„ÎµÎµ (z) Â· var(Îµ)) + RX (z)XÌ„ÏƒÏƒ + RX+ (z) XÌ„ÏƒÏƒ
+ XÌ„Î› PXÌ„ÏƒÏƒ



+ RX+ (z) XÌ„Î›Î› Î›Ì„2Ïƒ + 2âˆ‚ XÌ„Î› Â· â„¦Ì„Ïƒ Î›Ì„Ïƒ + 2XÌ„Î›Ïƒ Î›Ì„Ïƒ + âˆ‚ 2 XÌ„ Â· (â„¦Ì„Ïƒ , â„¦Ì„Ïƒ ) + 2âˆ‚ XÌ„Ïƒ Â· â„¦Ì„Ïƒ + XÌ„ ÏƒÏƒ



+ Rxx (z) Â· (xÌ„Ïƒ (z), xÌ„Ïƒ (z)) + 2RxX (z) Â· (xÌ„Ïƒ (z), XÌ„Ïƒ ) + 2RxX+ (z) Â· (xÌ„Ïƒ (z), XÌ„Ïƒ+ ) + RXX (z) Â· (XÌ„Ïƒ , XÌ„Ïƒ )
+ 2RXX+ (z) Â· (XÌ„Ïƒ , XÌ„Ïƒ+ ) + 2RX+X+ (z) Â· (XÌ„Ïƒ+ , XÌ„Ïƒ+ ) + Rxx (z) Â· (xÌ„Îµ (z), xÌ„Îµ (z)) Â· var(Îµ)
!
+ 2 (RxÎµ (z)xÌ„Îµ (z)) Â· var(Îµ) + RÎµÎµ (z) Â· var(Îµ) dâ„¦(z) = 0
gives a system of linear equations of the form

LL Â·

h

0
XÌ„ÏƒÏƒ XÌ„ÏƒÏƒ

i|

= MM.

(96)

B.7 Expansion Along Path
We now demonstrate how to compute the expansion along transition path when assuming

Ïƒ

scales only the shocks and

ÏÎ¸ .

Given the current

of the non-stochastic transition path

{Î˜Ì„n , Î›Ì„n }

24

with

(Î˜, Î›),

we will assume knowledge

(Î˜Ì„0 , Î›Ì„0 ) = (Î˜, Î›)

and

(Î˜Ì„N , Î›Ì„N ) =

(Î˜Ì„, Î›Ì„)

as well as the associated paths

N
N
of the policy functions at (Î˜Ì„ , Î›Ì„ )
assuming that all the derivatives of
computing derivatives evaluated at

(0, Î˜Ì„n , â„¦, Î›Ì„n ; 0)

by superscript

{xÌ„n , XÌ„ n }.26

= (Î˜Ì„, Î›Ì„).

xÌƒ and XÌƒ

Sections B.4-B.6 give the derivatives

We then proceed by backward induction,

are known at the point

(0, Î˜Ì„n+1 , â„¦, Î›Ì„n+1 ; 0) and

(0, Î˜Ì„n , â„¦, Î›Ì„n ; 0). We will denote derivatives evaluated at

n.

Dierentiating with respect to

Î›,


n
n
n
Fnxâˆ’ (z)xÌ„nÎ› (z) + Fnx (z)xÌ„nÎ› (z) + Fnx+ (z) xÌ„n+1
Î› (z)PXÌ„Î› + FX (z)XÌ„Î› = 0
and

Z

Solving for

Rnx (z)xÌ„nÎ› (z) + RnX (z)XÌ„Î›n + RnX+ (z)XÌ„Î›n+1 PXÌ„Î›n + RnÎ› (z)dâ„¦ = 0.

xÌ„nÎ› (z)

gives

xÌ„nÎ› (z) = âˆ’ Fnxâˆ’ (z) + Fnx (z)
and therefore

XÌ„Î›n

 âˆ’1

 n
n
(z)P
+
F
(z)
XÌ„Î› ,
Fnx+ (z)xÌ„n+1
X
Î›

equals

âˆ’1

 n
 âˆ’1 n

n+1
n+1
n
n
n
n
n
âˆ’
âˆ’Rx (z) Fxâˆ’ (z) + Fx (z)
Fx+ (z)xÌ„Î› (z)P + FX (z) + RX (z) + RX+ (z)XÌ„Î› P dâ„¦
Z

n
Ã—
RÎ› (z)dâ„¦(z) .
Z

The Frechet derivative w.r.t

â„¦

is computed as follows:

n
n
n
Fnxâˆ’ (z)âˆ‚ xÌ„n (z) + Fnx (z)âˆ‚ xÌ„n (z) + Fnx+ (z)âˆ‚ xÌ„n+1 (z) + Fnx+ (z)xÌ„n+1
Î› (z)Pâˆ‚ XÌ„ + FX (z)âˆ‚ XÌ„ = 0
which gives

âˆ‚ xÌ„n (z) = âˆ’ Fnxâˆ’ (z) + Fnx (z)
=

N
âˆ’n
X

âˆ’1 



n
n
n
n+1
Fnx+ (z)xÌ„n+1
(z)P
+
F
(z)
âˆ‚
XÌ„
+
F
(z)âˆ‚
xÌ„
(z)
x+
X
Î›

Cnj (z)âˆ‚ XÌ„ n+j ,

j=0
where for the last expression we our knowledge that

C(z)âˆ‚ XÌ„

and then

26 The fact that

âˆ‚ xÌ„n (z) =

PN âˆ’n
j=0

Cnj (z)âˆ‚ XÌ„ n+j

â„¦Ìƒ(0, Î˜, â„¦, Î›; 0) = â„¦

for any

âˆ‚ XÌ„ N = âˆ‚ XÌ„

25

âˆ‚ xÌ„N (z) = âˆ‚ xÌ„(z) =

is derived from the recursion.

(Î˜, â„¦, Î›)

straightforward using a shooting algorithm.

and

makes computation of these terms

To nd

Z

we then take the Frechet derivative of

Z

to get

Rn (z)Î´(z)dz.

Substituting for

n

R



Rnx (z)âˆ‚ xÌ„n (z) Â· âˆ† + RnX+ (z) (âˆ‚ XÌ„ n+1 Â· âˆ†) + XÌ„Î›n+1 P(âˆ‚ XÌ„ n Â· âˆ†) + RnX (z)âˆ‚ XÌ„ n Â· âˆ† Ï‰(z)dz

0=
+

âˆ‚ XÌ„

Z

âˆ‚ XÌ„ Â· âˆ† = âˆ’

âˆ‚ xÌ„n (z) = âˆ‚ XÌ„ n ,

Rnx (z)Cn0 (z)

+

we get

RnX+ (z)XÌ„Î›n+1 P

+

RnX (z)



âˆ’1 Z
dâ„¦(z)
Rn (z)Î´(z) + Rnx (z)âˆ‚ xÌ„n (z) Â· âˆ†dz

ï£«
ï£¶
Z
N
âˆ’n
X

â‰¡ (Dn )âˆ’1 ï£­ Rn (z)dâˆ† +
Enj âˆ‚ XÌ„ n+j Â· âˆ† ï£¸
j=1
Finally we can compute the response to shock

E

(note we only need to do this for

n = 0)


F0x xÌ„0E + F0x+ ÏÎ˜ xÌ„1Î˜ + xÌ„1z pxÌ„0E + âˆ‚ xÌ„1 Â· â„¦Ì„0E + xÌ„1Î› PXÌ„E0 + F0X XÌ„E0 + F0E = 0.
Substituting for

âˆ‚ xÌ„1

we obtain, after dening

XÌ„ j E = âˆ‚ XÌ„ j Â· â„¦Ì„0E

ï£«
F0x (z)xÌ„E (z)+F0x+ (z) ï£­ÏÎ˜ xÌ„1Î˜ (z) + xÌ„1z (z)pxÌ„nE (z) +

N
âˆ’1
X

ï£¶
C1j (z)XÌ„Ej+1 + xÌ„1Î› (z)PXÌ„E0 ï£¸+F0X (z)XÌ„E0 +F0E (z) = 0,

j=0
or

M0 (z)xÌ„0E (z) = N0 (z)
We obtain the following expression for

XÌ„ jE = D


j âˆ’1

Z

h

XÌ„ jE

I XÌ„E0
for

XÌ„E1

Â· Â· Â· XÌ„EN

i|

.

j = 1, . . . , N

N
âˆ’j
X
 0
j
j
j
Rz (z) + Rx (z)xÌ„z (z) pxÌ„E (z)dâ„¦ +
Ejk XÌ„Ej+k

!

k=1
which, when combined with

Z


1
R0x (z)xÌ„0E (z) + R0X (z)XÌ„E0 + R0X+ (z) ÏÎ˜ XÌ„Î˜
+ XÌ„E1 + XÌ„Î›1 PXÌ„E0 + R0E (z)dâ„¦ = 0,

yields the linear system

OÂ·

h

I

XÌ„E0

XÌ„E1

26

Â·Â·Â·

XÌ„EN

i|

= P.

C Simulation and Clustering
To simulate an optimal policy at each date with

generates

K

grid points that we nd each period using a k-means clustering al-

{zi }N
i=1

represent the current distribution of agents. The k-means algorithm

points

squared error

agents, we discretize the distribution

K

across agents with
gorithm. Let

N

{zÌ„k }K
k=1

P

i kzi

âˆ’ zÌ„k(i)

with each agent

k2 .

We let

â„¦

i

assigned to a cluster

represent the distribution of

represent our approximating distribution of

27
clusters.

gorithm to approximate the optimal policies around
scale deviations of

â„¦

rules as follows. Let

from

â„¦Ì„,

to

Ïƒ.

to minimize the

N

agents and

â„¦Ì„

At each history, we apply our al-

â„¦Ì„.

Moreover, by allowing

Ïƒ

to also

we can increase the accuracy of our approximate the policy

xÌƒ(ÏƒÎµ, ÏƒE, Ïƒ(Î˜ âˆ’ Î˜Ì„) + Î˜Ì„, z, â„¦Ì„ + Ïƒ(â„¦ âˆ’ â„¦Ì„), Ïƒ(Î› âˆ’ Î›Ì„(â„¦)) + Î›Ì„; Ïƒ)

XÌƒ(ÏƒE, Ïƒ(Î˜ âˆ’ Î˜Ì„) + Î˜Ì„, â„¦Ì„ + Ïƒ(â„¦ âˆ’ â„¦Ì„), Ïƒ(Î› âˆ’ Î›Ì„(â„¦)); Ïƒ)
parameters

k(i)

and

denote the policy rules with scaling

Ïƒ. We can them approximate these policies with a Taylor expansion with respect

For example, a rst-order Taylor expansion would be


xÌƒ(Îµ, Î˜, z, â„¦, Î›) â‰ˆ xÌ„ + xÌ„Îµ Îµ + xÌ„E E + xÌ„Î˜ (Î˜ âˆ’ Î˜Ì„) + âˆ‚ xÌ„ Â· (â„¦ âˆ’ â„¦Ì„) + xÌ„Î› (Î› âˆ’ Î›Ì„) + xÌ„Ïƒ Ïƒ
and


XÌƒ(Î˜, â„¦, Î›) â‰ˆ XÌ„ + XÌ„E E + XÌ„Î˜ (Î˜ âˆ’ Î˜Ì„) + âˆ‚ XÌ„ Â· (â„¦ âˆ’ â„¦Ì„) + XÌ„Î› (Î› âˆ’ Î›Ì„(â„¦)) + XÌ„Ïƒ Ïƒ.
Both

âˆ‚ xÌ„ Â· (â„¦ âˆ’ â„¦Ì„)

and

âˆ‚ XÌ„ Â· (â„¦ âˆ’ â„¦Ì„)

are easily computed from terms already computed

during the expansion, so these extra corrections have no additional computational cost.
Note that when

K=N

we exactly approximate around

N
the computations by a factor of
K . We choose

K

â„¦,

but for

K<N

so that increasing

impulse responses reported in section 5 which results in a

K

of

K

28

we can speed up

does not change the

2000 to 3000 and N = 100000

depending on the experiment.

D Competitive Equilibrium with xed government
policies
We demonstrate the application of our method outlined in section 3.1 to a problem of nding
a competitive equilibrium for xed government policies. We have two goals in mind: First,

27 Formally

1
i N Î´(z âˆ’ zÌ„k(i) ).
28 Following the steps in section (B.5) it can readily be seen that âˆ‚ XÌ„ Â·(â„¦âˆ’ â„¦Ì„)
P
zÌ„(z))dâ„¦Ì„(z) = i N1 A(zÌ„k(i) )(zi âˆ’ zÌ„k(i) ) and âˆ‚ xÌ„(zÌ„k ) = C(zÌ„k )âˆ‚ XÌ„ Â· â„¦Ì„Ïƒ .

dâ„¦(z) =

1
i N Î´(z

P

âˆ’ zi )

while

dâ„¦Ì„(z) =

27

P

=

R

A(z)(z âˆ’

the problem with xed policies is simpler and explicit expressions for terms that arise in
many of the steps in section 3 as well as those in appendix B can be derived. Second, we use
this economy as a test case to analyze the accuracy of the our approximations by comparing
the second-order expansions to solutions obtained with global methods.
To make our exposition most transparent, we assume that government has no expenditures, sets taxes

Î¥t = Tt = 0

and implements ination

Î t = 0

in all periods. We assume all

agents have equal ownership of rms and that there is no permanent component of labor
productivity,

Î˜

Î¸i,t = 0.

Finally, we assume that the aggregate shock is i.i.d., which removes

as a state variable.

These assumptions deliver a version of Huggett (1993) economy

with natural borrowing limits extended to allow for endogenous labor supply and aggregate
shocks.
Individual decisions are expressed recursively. The aggregate variables depend on the
realized aggregate shock

E

and the beginning of the period distribution of assets

â„¦.

Since we

assumed that government has no revenues, it also cannot issue debt, and so the distribution

â„¦

satises

R

bdâ„¦ = 0.

We denote the space of such distributions by

to denote policy functions, and let

XÌƒ =

h

QÌƒ WÌƒ

DÌƒ

iT

W.

We use tildes

be a vector of aggregate policy

functions capturing interest rates, wages and dividends. Individual policy functions depend
both on aggregate state

(E, â„¦)

and on idiosyncratic state

(Îµ, b)

where

Îµ

is the realization

of the idiosyncratic shock that aects individual with asset beginning of period assets

xÌƒ =

h

iT

bÌƒ cÌƒ nÌƒ
R Ã— W â†’ W be the
Let

be the triplet of the individual policy functions. Finally,

b.

e (E, â„¦) :
â„¦

law of motion describing how the aggregate distribution of debt next

period is aected by the aggregate shock in the current period.
Individual optimality conditions consist of the budget constraint (2) and the optimality
conditions (13)-(14). In our recursive notation, these conditions read

for all

cÌƒ (Îµ, E, b, â„¦) + QÌƒ (E, â„¦) bÌƒ (Îµ, E, b, â„¦) = WÌƒ (E, â„¦) exp (E + Îµ) nÌƒ (Îµ, E, b, â„¦)

(97a)

+ b + DÌƒ (E, â„¦) ,
n h 
i
o
e (E, â„¦)
Î²E uc cÌƒ Â·, Â·, bÌƒ (E, b, â„¦) , â„¦
E, â„¦ = QÌƒ (E, â„¦) uc [cÌƒ (Îµ, E, b, â„¦)] ,

(97b)

WÌƒ (E, â„¦) exp (E + Îµ) uc [cÌƒ (Îµ, E, b, â„¦)] = âˆ’un [nÌƒ (Îµ, E, b, â„¦)] ,

(97c)

Îµ, E, b, â„¦.

These constraints construct the function

28

F

as in (20) of section 3.

The

aggregate constraints after imposing rm's optimality (15) can be written as

Î±

Z
exp(E + Îµ)nÌƒ (Îµ, E, b, â„¦) d Pr (Îµ) dâ„¦

Z
cÌƒ (Îµ, E, b, â„¦) d Pr (Îµ) dâ„¦,

=

Z
Î±âˆ’1
âˆ’1
Î±
exp(E + Îµ)nÌƒ (Îµ, E, b, â„¦) d Pr (Îµ) dâ„¦
= WÌƒ (E, â„¦) ,


 Z
Î±
âˆ’1
1âˆ’
Î±
exp(E + Îµ)nÌƒ (Îµ, E, b, â„¦) d Pr (Îµ) dâ„¦ = DÌƒ (E, â„¦) ,

for all

E, â„¦

(98a)

(98b)

(98c)

which construct the function (21) of section 3. Finally, the law of motion for the

distribution of debts induced by the savings behavior of the agents is given by

Z
e (E, â„¦) (y) =
â„¦
where

Î¹



Î¹ bÌƒ (Îµ, E, b, â„¦) â‰¤ y d Pr (Îµ) dâ„¦ âˆ€y,

(99)

is the indicator variable.

Equations (97), (98), and (99) fully describe the equilibrium behavior.

D.1 Points of expansion and zeroth-order terms
Consider the expansion around deterministic economy with a given distribution of assets

â„¦.

Observe that we have

bÌ„ (b, â„¦) = b

for all b,â„¦.

(100)

This counterpart of lemma (1) implies that equations for deterministic economy are

cÌ„ (b, â„¦) + QÌ„ (â„¦) b = WÌ„ (â„¦) nÌ„ (b, â„¦) + b + DÌ„ (â„¦) ,
Î² = QÌ„ (â„¦) ,

(101b)

WÌ„ (â„¦) uc [cÌ„ (b, â„¦)] = âˆ’un [nÌ„ (b, â„¦)] ,
for all

(b, â„¦)

(101a)

(101c)

and aggregate constraints

Î±

Z
nÌ„ (b, â„¦) dâ„¦

Z
=

cÌ„ (b, â„¦) dâ„¦,

Î±âˆ’1
Z
âˆ’1
Î±
nÌ„ (b, â„¦) dâ„¦
= WÌ„ (â„¦) ,


 Z
Î±
âˆ’1
1âˆ’
nÌ„ (b, â„¦) dâ„¦ = DÌ„ (â„¦) ,
Î±


(102)

and the law of motion

â„¦Ì„ (â„¦) = â„¦

29

(103)

that hold for all

â„¦.For

a given

â„¦,

we solve the system of equations above for

xÌ„(b, â„¦), XÌ„(â„¦).

To obtain the coecients of the rst-order expansion of the policy functions, we will
need to know how policy functions are aected by perturbations to the individual state
Dierentiate (101a) and (101c) with respect to

xÌ„b

b

b.

to get a linear system and then solving for

yields

ï£®

bÌ„b (b)

ï£¹

ï£®

1

ï£¯
ï£º ï£¯
xÌ„b (b) â‰¡ ï£° cÌ„b (b) ï£» = ï£° QÌ„ âˆ’ 1
nÌ„b (b)

0

0

0

ï£¹âˆ’1 ï£®

1

WÌ„

ï£º
ï£»

1

ï£¹

ï£¯
ï£º
ï£° DÌ„ ï£» ,

WÌ„ ucc [cÌ„ (b)] unn [nÌ„ (b)]

(104)

0

where all the terms on the right hand side are known from the zeroth-order expansion.

D.2 First-order terms and factorization theorem
Consider the rst order expansion with respect to

Ïƒ

of equations (98) and (97) and use

method of undetermined coecients to nd the derivatives that multiply
derivatives

ÏƒÎµ

and

ÏƒE .

The

xÌ„Îµ (b) are easy to nd since they cancel out from the expansions of the feasibility

constraints and appear only in the individual optimality conditions

cÌ„Îµ (b) + QÌ„bÌ„Îµ (b) = WÌ„ (nÌ„ (b) + nÌ„Îµ (b)) ,

(105a)

QÌ„ucc [cÌ„(b)]cÌ„Îµ (b) = Î²ucc [cÌ„(b)]cÌ„b (b)bÌ„Îµ (b),

(105b)

WÌ„ (uc [cÌ„ (b)] + ucc [cÌ„ (b)] cÌ„Îµ (b)) = âˆ’unn [nÌ„ (b)] nÌ„Îµ (b) .
for all

b.

All variables apart from

expansion. Thus we can nd

bÌ„Îµ (b) , cÌ„Îµ (b) , nÌ„Îµ (b),

bÌ„Îµ (b) , cÌ„Îµ (b) , nÌ„Îµ (b)

(105c)

are known from the zeroth-order

separately for each

b

by solving this

3Ã—3

system of equations. In the direct analogy with (104) we can write this solution compactly
as

xÌ„Îµ (b) = E(b)âˆ’1 G(b)
for matrices
that

XÌ„Ïƒ , xÌ„Ïƒ

K(b),L(b)

(106)

known from the zeroth-order expansion. Similarly it can be shown

are all zero vectors.

Solving for the eect of the aggregate shocks is more complicated because they aect the
distribution of debts and the aggregate constraints. Dierentiating individual constraints
implies that

cÌ„E (b) + QÌ„bÌ„E (b) + QÌ„E bÌ„ (b) = WÌ„ (nÌ„ (b) + nÌ„E (b)) + WÌ„E nÌ„ (b) + DÌ„
(107a)
E,

Î²ucc [cÌ„(b)] cÌ„b (b)bÌ„E (b) + âˆ‚cÌ„(b) Â· â„¦Ì„E = QÌ„ucc [cÌ„(b)]cÌ„E (b) + uc [cÌ„(b)]QÌ„E , (107b)
WÌ„ (uc [cÌ„ (b)] + ucc [cÌ„ (b)] cÌ„E (b)) + WÌ„E uc [cÌ„ (b)] = âˆ’unn [nÌ„ (b)] nÌ„E (b) .

30

(107c)

while dierentiating the aggregate constraints gives

Î±NÌ„

Î±âˆ’1

Z

Z
(nÌ„ (b) + nÌ„E (b)) dâ„¦ =

cÌ„E (b) dâ„¦,

âˆ’1
Î± (Î± âˆ’ 1) NÌ„ Î±âˆ’2 (nÌ„ (b) + nÌ„E (b)) dâ„¦ = WÌ„E ,



Z
âˆ’1
1âˆ’
Î± Î±NÌ„ Î±âˆ’1 (nÌ„ (b) + nÌ„E (b)) dâ„¦ = DÌ„E ,

Z

where

NÌ„

(108)

is the aggregate labor supply in the zeroth-order expansion.

dierentiating equation (99) with respect to

E

and evaluating at

Furthermore, by

Ïƒ = 0 it can readily be seen

29
that

â„¦Ì„E (b) = âˆ’Ï‰(b)bÌ„E (b)

for all

This leads to the main diculty of this problem:
aggregates

XÌ„E

b.

(109)

in order to solve for the response of

we must jointly solve equations (107a)-(108) for

xÌ„E (b) for all b.

is to apply the factorization theorem, theorem (1), to show that

0
as loadings on XÌ„E and XÌ„E

= âˆ‚ XÌ„ Â· â„¦Ì„E (b)

xÌ„E (b)

Our resolution

can be constructed

which can be solved for independently.

Begin by dierentiating the individual constraints with respect to

â„¦.

Exploiting

âˆ‚ â„¦Ì„ = 1

yields

âˆ‚cÌ„(b) + bâˆ‚ QÌ„ + Î²âˆ‚ bÌ„(b) = nÌ„(b)âˆ‚ WÌ„ + WÌ„ âˆ‚ nÌ„(b) + âˆ‚ DÌ„

Î²ucc [cÌ„(b)] cÌ„b (b)âˆ‚ bÌ„(b) + âˆ‚cÌ„(b) = uc [cÌ„(b)]âˆ‚ QÌ„ + Î²ucc [cÌ„(b)]âˆ‚cÌ„(b)
WÌ„ ucc [cÌ„(b)]âˆ‚cÌ„(b) + uc [cÌ„(b)]âˆ‚ WÌ„ = unn [nÌ„(b)]âˆ‚ nÌ„(b).
This can be represented by the matrix expression

ï£®

Î²

ï£¯
ï£° Î²ucc [cÌ„(b)]cÌ„b (b)
0

1

âˆ’WÌ„

0

0

ï£¹ï£®

âˆ‚ bÌ„(b)

ï£¹

ï£®

âˆ’b

ï£ºï£¯
ï£º ï£¯
ï£» ï£° âˆ‚cÌ„(b) ï£» = ï£° uc [cÌ„(b)]

WÌ„ ucc [cÌ„(b)] âˆ’unn [nÌ„(b)]

âˆ‚ nÌ„(b)

0

nÌ„(b)
0

1

ï£¹ï£®

âˆ‚ QÌ„

ï£ºï£¯
ï£º
0 ï£» ï£° âˆ‚ WÌ„ ï£»

âˆ’uc [cÌ„ (b)] 0

âˆ‚ DÌ„

which we can solve to yield the counterpart to the rst result of theorem (1):

âˆ‚ xÌ„(b) = C(b)âˆ‚ XÌ„.
To obtain the second result we dierentiate equations (98a)-(98c) in an arbitrary direction

29 For the derivation in detail see section B.5.

31

ï£¹

âˆ†

evaluated at

Ïƒ=0

to nd

Î±âˆ’1

Z



Z


cÌ„ (b) dâ„¦ Â· âˆ†

nÌ„ (b) dâ„¦ Â· âˆ† =

âˆ’1
Î±âˆ’2
Î± (Î± âˆ’ 1) NÌ„
nÌ„ (b) dâ„¦ Â· âˆ† = âˆ‚ WÌ„ Â· âˆ†,


Z


âˆ’1
Î±âˆ’1
1âˆ’
Î± Î±NÌ„
nÌ„ (b) dâ„¦ Â· âˆ† = âˆ‚ DÌ„ Â· âˆ†.

Î±NÌ„

Z

(110)

As noted in section (3),

Z



Z

cÌ„ (b) dâ„¦ Â· âˆ† =
Evaluating this integral at

Z
âˆ‚cÌ„ (b) Â· âˆ†dâ„¦ +

âˆ†(b) = â„¦Ì„E (b) = âˆ’Ï‰(b)bÌ„E (b)

cÌ„(b)dâˆ†.

and exploiting integration by parts

we nd

Z



Z

cÌ„ (b) dâ„¦ Â· â„¦Ì„E =

Z
âˆ‚cÌ„ (b) Â· â„¦Ì„E dâ„¦ +

Z
cÌ„(b)dâ„¦Ì„E =

Z
C1 (b)dâ„¦âˆ‚ XÌ„ Â· â„¦Ì„E +

cÌ„b (b)bÌ„E (b)dâ„¦

C1 (b) represents the rst row of C(b). As a similar relationship can be derived for

nÌ„ (b) dâ„¦ Â· â„¦Ì„E , plugging these into equations (110) yields a system of equations of the

where

R

form

Z
Dâˆ‚ XÌ„ Â· â„¦Ì„E =

where

D

and

âˆ‚ XÌ„ Â· â„¦Ì„E =

R

B(b)

B(b)xÌ„E (b)dâ„¦

are both known from zeroth-order terms.

A(b)xÌ„E (b)dâ„¦.

Solving for

When combined with our expression for

âˆ‚ XÌ„ Â· â„¦Ì„E

âˆ‚ xÌ„(b),

gives

we get the

analogue of (75) of theorem 1

Z
âˆ‚ xÌ„(b) Â· â„¦Ì„E = C(b)

A(b)xÌ„E (b)dâ„¦.

Finally we can exploit this knowledge to solve for

XÌ„E

and

xÌ„E (b)

by rst dening

âˆ‚ xÌ„(b) Â· â„¦Ì„E = C(b)âˆ‚ XÌ„ Â· â„¦Ì„E â‰¡ C(b)XÌ„E0 .
After substituting for
policy functions
other

xÌ„E (bÌ‚).

âˆ‚ xÌ„(b) Â· â„¦Ì„E ,

xÌ„E (b)

equation (107) now denes a linear relationship between

and aggregate variables

Thus, we can write (107) for each

M(b)xÌ„E (b) = N(b) Â·

32

h
b
h

XÌ„E

XÌ„E0

i

XÌ„E0

iT

which is independent of any

as

XÌ„E

,

(111)

where

M(b)

is a

3Ã—3

matrix, and all coecients of

xÌ„E (b)

zeroth-order expansion. Thus we can solve for each
ables independently for each
equations into

K

system of

b.

equations for each of

xÌ„E (Â·)

6Ã—6

N(b)

are known from the

as a function of aggregate vari-

K

3K Ã— 3K

levels of debt. We can substitute

into equations (108) and

XÌ„E0
to generate a

and

This simplies analysis by breaking one system of

3Ã—3

the obtained expressions for

M(b)

Z
=

A(b)xÌ„E (b)dâ„¦

(112)

system of equations of the form

OÂ·

h

XÌ„E

XÌ„E0

iT

= P.

Equation (113) can be easily solved numerically for
for the rst-order responses to the aggregate shock

(113)

XÌ„E , XÌ„E0 .

This completes the solution

E.

D.3 Second and higher order terms
To construct a second-order expansion of policy functions we need additional terms. These
are

xÌ„ÎµÎµ (b), xÌ„ÎµÏƒ (b), xÌ„EE (b), xÌ„EÏƒ (b), xÌ„ÏƒÏƒ (b), XÌ„EE , XÌ„EÏƒ , XÌ„ÏƒÏƒ .

Calculations of

xÌ„ÎµÎµ ,xÌ„EE ,XÌ„EE

then

proceeds analogously to their rst-order counterparts, while the cross-partials

xÌ„ÎµÏƒ , xÌ„EÏƒ , XÌ„EÏƒ

xÌ„ÏƒÏƒ , XÌ„ÏƒÏƒ

are no longer

are all zeros. Unlike the rst-order expansion, the intercept terms
zero.

They depend on var(Îµ), var(E) and capture such eects as precautionary savings.

Solution for

xÌ„ÏƒÏƒ (b), XÌ„ÏƒÏƒ

involves steps similar to those used to solve for

xÌ„E (b), XÌ„E

in the

previous section. Details are provided in section B.6.

D.4 Numerical implementation and accuracy
To implement our algorithm numerically, we approximate
with

K

points

{bk }k

with masses

{Ï‰k }k .

with a discrete distributions

All the integrals in our expressions collapse then

to sums. For example, our expression (112) for

XÌ„E0 =

â„¦

X

XE0

becomes

A(bk )Ï‰k bÌ„E (bk ).

k
All intermediate terms, such as

E(bk ),

can be computed independently for each

k,

making

the algorithm highly parallelizable. Once we compute approximations of the policy functions
in the current period, we use Monte-Carlo methods described in section C to obtain the next
period distribution of assets

â„¦Ìƒ,

for which we repeat this procedure.

33

We now discuss the numerical accuracy of our approximations. To compare our (secondorder) approximated policy rules with those solved via global methods we shut down the
aggregate shocks and compute the steady state distribution of assets the model presented
in section D.3.

Optimal policies of each agent are computed using the endogenous grid

method of Carol (2005). The steady-state distribution is approximated using a histogram
and computed using the transition matrix constructed from the policy rules following Young
(2010). We then compare the approximated policy rules using our method, around the same
stationary distribution, to those of the global solution.

As noted in section D.3, even in

absence of aggregate shocks our techniques are still necessary, for a second-order expansion,
to determine the eect of the presence idiosyncratic risk on policies through
We calibrate the 6 parameters of this model,

Î½=1

and

Î³=2

=6

2%.

Î½ ,Î³ ,Î² , Î± , 

to match of calibration in section 4.

Î²

and

ÏƒÎµ ,

xÌ„ÏƒÏƒ

and

as follows.

We set

is set to target an interest rate of

targets a markup of 20% and the decreasing returns to scale parameter,

chosen to target a labor share of

0.66.

XÌ„ÏƒÏƒ .

The standard deviation

ÏƒÎµ

Î±,

is

is set at .25 to match our

calibration in section 4. We choose very loose ad-hoc borrowing constraints,

b = âˆ’100

to

approximate a natural debt limit. To ensure an accurate approximation to the global policy
rules, we approximated the consumption and labor policy rules using cubic splines with 200
grid points and the steady-state distribution with a histogram with 1000 bins.
Agents' policies and aggregate variables are then approximated using a second-order
approximation around the stationary distribution

â„¦Ì„

with the expressions derived in this

section. The equilibrium policy rules and aggregates, around this distribution of 1000 points,
can be approximated using single processor in 0.8 seconds.

The equilibrium interest rate

found by perturbation code was 2.0013%. The percent error in the aggregate labor supply
was 0.036%.

Finally, we can evaluate the policy errors for the individual agents.

In the

rst panel of gure VIII we plot the percentage errors for consumption relative to the global
solution for a median shock to

Ï‚

along with a

Â±2.5

standard deviation shock.

For almost all of the agents, the perturbation methods perform well with errors less
than
every

0.1%

which would correspond making an error in consumption of less than a dollar on

$1000

dollars spent. As expected, since the quadratic approximation assumes natural

borrowing limits, the accuracy deteriorates near the borrowing limit assumed by the global
solution. The range plotted in gure VIII contains 99.2% of the agents in the stationary
distribution. As a robustness check, we also observe how accuracy behaves as we change
For values of

ÏƒÎµ âˆˆ [0.1, 0.5],
Z Z

we compute the average absolute percentage error as

cglobal (ÏƒÎµ Îµ, b; ÏƒÎµ ) âˆ’ cpertub (ÏƒÎµ Îµ, b; ÏƒÎµ )
dPr(Îµ)dâ„¦
cglobal (ÏƒÎµ Îµ, b; ÏƒÎµ )

34

ÏƒÎµ .

Ï‚ = âˆ’0.6
Ï‚ = 0.0
Ï‚ = 0.6

0.2

%

error

0.4

0
âˆ’90

âˆ’50

âˆ’10

30

70

110

150

190

error

0.2

%

assets

0.1
0

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5

ÏƒÏ‚
Figure VIII: Percentage error of consumption policy functions relative to global solution in
top panel. Bottom panel plots average (with respect to the stationary distribution) absolute
consumption error relative to global solution as

ÏƒÏ‚

varies.

and plot it in the bottom panel of gure VIII. We see that the average error remains very
low around the level of our calibration and increases moderately for higher

ÏƒÎµ .

E Robustness
We provide details for several cases that are discussed in sections 5 and 6 but omitted
from the main text. These include stationary TFP shocks, alternative welfare criteria, no
inequality shocks

f = 0,

and no menu costs

Ïˆ = 0.

Stationary TFP shocks are modeled as an AR(1) process (see equation 9a) in the text,
with autocorrelation

ÏÎ˜ = 0.954

and std of

EÎ˜ = 3%.

All other parameters and the initial

condition are kept as the same as the baseline calibration in section 4. The impulse responses
are computed to a one standard deviation negative shock. As mentioned in section 5.2, we
extend the denition of natural rate for our heterogeneous agent economy to be the real
interest rates in a competitive equilibrium with
policy set

Î¥t

Ïˆ=0

that implements exible prices, scal

at the non-stochastic optimum and initial conditions as in section 4.

The

optimal response of the nominal rate in Figure IX is plotted as a deviation from this natural
rate and we see that it quite closely tracks the response in the baseline with the i.i.d growth
rate specication.

35

Ination

Nominal rate-Natural rate

0.6

pts

âˆ’0.2

0.4

%

1

0
âˆ’0.4

AR(1)

âˆ’0.6

BM

4

6

8

0.5
0

0.2

âˆ’0.5

0
4

10 12

Output

6

8

4

10 12

%

0
âˆ’0.5

âˆ’3
6

8

10 12

pts

pts

%

âˆ’2

10 12

0
âˆ’1

%

pts

âˆ’1

8

TFP

0.5

4

6

Ex-post real returns

0

Figure IX:

Tax rate

âˆ’2
âˆ’3

4

6

8

10 12

4

6

8

10 12

Optimal monetary response to an AR(1) productivity shock. The solid line is

the baseline calibration with i.i.d growth rate shocks.

To illustrate the role of alternative preferences for the planner, we modify the objective
function (12) to introduce time-invariant Pareto weights
that the optimal non-stochastic tax rate equals

24%.

Î±Ï‰
Ï‰i âˆ Î¸âˆ’1,i
.

We calibrate the

Our estimate suggests an

Î±Ï‰

such

Î±Ï‰ = 0.75

indicating higher Pareto weights to productive agents which rationalizes low marginal tax
rates. We keep all other parameters and the initial condition as in the baseline calibration
and compute optimal monetary responses to a TFP shock in gure X and the markup
shock in gure XI.

The fact that the responses are similar to the utilitarian case in the

baseline underlines that changes in Pareto wights primarily map into changes in the steady
state level of the tax rate while the response of policies to shocks is governed by insurance
motives arising mainly due to incomplete markets.
Next we turn to the case where we study TFP shocks with

f = 0,

implying that the

aggregate TFP shock results in the same proportional change labor productivity for all
agents.

As mentioned in the text, even in absence of changes in inequality, a permanent

drop in wages with agents heterogeneous in asset holdings creates needs for insurance. The
exercise in gure XII allows us decompose the eect into the part that comes because initial
wealth dierences and the part that comes because of heterogeneous exogenous exposure to
the shock.
Finally we study the case without nominal rigidities by setting

Ïˆ â‰ˆ 0.

In response to a

TFP shock (gure XIII), the planner provides insurance through ination which generates

36

Nominal int. rate

1

%

pts

0
âˆ’0.5
Non util.
BM

âˆ’1
4

6

8

0.6
0.4
0.2
0

pts

0

0.5
0
âˆ’0.5
4

10 12

6

8

10 12

âˆ’1

4

Ex-post real returns

Output growth

%

Tax rate

Ination

6

8

10 12

TFP growth

0

0

âˆ’1

âˆ’1
âˆ’0.5

âˆ’2

âˆ’2

âˆ’3
4

6

8

10 12

4

6

8

4

10 12

6

8

10 12

Figure X: Optimal monetary response to a productivity shock with non-utilitarian Pareto
weights. The solid line is the baseline calibration with utilitarian Pareto weights

Nominal int. rate

%

pts

0

0.5
0.2

âˆ’0.2

Non util.

âˆ’0.3

BM

4

6

8

10 12

Log Output

0.4
pts

1

0.4

âˆ’0.1

%

Tax rate

Ination

0

0
âˆ’0.2

âˆ’0.5
4

6

8

10 12

0.2

0.5

0

0
8

10 12

6

8

10 12

Markup Shock

0.4
0.2
0

âˆ’0.5
6

4

Log Wages (aftertax)

1

4

âˆ’1

4

6

8

10 12

4

6

8

10 12

Figure XI: Optimal monetary response to a markup shock with non utilitarian Pareto
weights. The solid line is the baseline calibration with utilitarian Pareto weights

37

%

pts

Nominal int. rate

1

0

0.6

âˆ’0.2

0.4
f =0

âˆ’0.4

BM

4

6

8

pts

0.5
0

0.2

âˆ’0.5

0

10 12

4

Output growth

%

Tax rate

Ination

6

8

10 12

âˆ’1

Ex-post real returns

0

0

âˆ’1

âˆ’0.2

âˆ’1

âˆ’0.4

âˆ’2

âˆ’0.6
4

6

8

10 12
f

8

10 12

âˆ’3
4

6

8

10 12

4

Figure XII: Optimal monetary response to a productivity shock with
is the baseline case with

6

TFP growth

0

âˆ’2

4

6
f = 0.

8

10 12

The solid line

calibrated as in section 4.

state contingent returns. The size of response is about 3 to 4 times larger than the baseline
mainly driven by the fact that price changes are less costly and an eective way of insuring
against permanent TFP shocks. In response to a markup shock (gure XIV), we see that
real wages drop and then follow the path of the shock.

This is quite dierent from the

baseline where planner increased real wages to redistribute to towards the wage earners from
equity holders. The reason for this dierence is that absent nominal rigidities, the ability
of the planner to aect aggregate demand and wages through changes in nominal rates is
substantially diminished. The planner still induces some ination on impact because bonds
and equities are correlated and lowering returns partially redistributes towards low wage
agents.

38

Ination

Nominal int. rate

Tax rate

1

%

pts

0

2

0.5

1

0

âˆ’0.2
Ïˆ=0

âˆ’0.4

âˆ’0.5

BM

4

6

8

0

10 12

4

6

8

âˆ’1

10 12

4

Ex-post real returns

0

0

0

pts

âˆ’1

âˆ’1

âˆ’1

âˆ’2

âˆ’3
4

6

8

4

10 12

6

8

4

10 12

Figure XIII: Optimal monetary response to a productivity shock with
is the baseline calibration with

0
pts

6

8

Ïˆ = 0.

10 12

The solid line

Ïˆ = 20.

Ination

Nominal int. rate

%

10 12

âˆ’2

âˆ’2

âˆ’3

8

TFP growth

%

Output growth

6

Tax rate

1

0.5

0.5
0
âˆ’0.5

Ïˆ=0
BM

4

6

8

4

1

pts

0.2

0.5

%

0

0

âˆ’0.2

âˆ’0.5
8

6

8

10 12

âˆ’1

10 12

6

8

10 12

Markup Shock

0.4
0.2
0
4

6

8

10 12

Figure XIV: Optimal monetary response to a markup shock with
the baseline calibration with

4

Log Wages (after tax)

0.4

6

âˆ’0.5

âˆ’1

10 12

Log Output

4

0

âˆ’0.5

Ïˆ = 20.

39

4

6

Ïˆ = 0.

8

10 12

The solid line is

