NBER WORKING PAPER SERIES

INTEGRABILITY AND GENERALIZED SEPARABILITY
Thibault Fally
Working Paper 25025
http://www.nber.org/papers/w25025

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
September 2018

Many thanks to Philippe Aghion, Dave Donaldson, Federico Etro, Ben Faber, Ethan Ligon,
Kiminori Matsuyama, Marti Mestieri, Andres Rodriguez-Clare, Ina Simonovska and Brian
Wright for helpful comments and suggestions. The views expressed herein are those of the author
and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
Â© 2018 by Thibault Fally. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including Â©
notice, is given to the source.

Integrability and Generalized Separability
Thibault Fally
NBER Working Paper No. 25025
September 2018
JEL No. D11,D40,L13
ABSTRACT
This paper examines demand systems where the demand for a good depends only on its own
price, consumer income, and a single aggregator synthesizing information on all other prices.
This generalizes directly-separable preferences where the Lagrange multiplier provides such an
aggregator. As indicated by Gorman (1972), symmetry of the Slutsky substitution terms implies
that such demand can take only one of two simple forms. Conversely, here we show that only
weak conditions ensure that such demand systems are integrable, i.e. can be derived from the
maximization of a well-behaved utility function. This paper further studies useful properties and
applications of these demand systems.

Thibault Fally
Department of Agricultural and Resource Economics
University of California, Berkeley
301 Giannini Hall
Berkeley, CA 94720-3310
and NBER
fally@berkeley.edu

1

Introduction

The integrability problem, which consists in characterizing demand systems that can be rationalized and derived from utility functions, has long been a central issue in economic theory.
Its earliest contributions date from Antonelli (1886), with applications to various fields, including micro and macroeconomics, econometrics, industrial organization and international trade.
Theorists have provided broad sufficient and necessary conditions for demand patterns to be
integrable, notably Hurwicz and Uzawa (1971), who provide conditions based on the Slutsky
substitution matrix, which must be symmetric and negative semi-definite for all prices and
income levels.
While very general, the Hurwicz and Uzawa (1971) integrability conditions lack practicality.
Perhaps a consequence is that applied theorists and practitioners have often focused on less
general cases to ensure both tractability and rationality. In particular, one often focuses on
directly-separable, indirectly-separable or quasi-linear preferences. An attractive feature of
these preferences is that demand depends only on a few variables, namely consumer income, a
goodâ€™s own price, and a single aggregator (scalar) that is itself a function of the vector of prices
and income. Such an aggregator can be, for instance, a price index (e.g. with constant elasticity
of substitution preferences) or the marginal utility of money (directly-separable preferences).
These preferences, however, have properties that may be undesirable and too restrictive in terms
of income and price effects. For instance, quasi-linear preferences suppress income effects, while
direct separability implies that income elasticities and price elasticities are proportional across
goods (â€œPigouâ€™s lawâ€), a testable prediction that has been rejected by Deaton (1974).
In this paper, we characterize more general demand systems that retain a key practical
property of these widely-used demand systems: the existence of a single price aggregator, a
feature that is very useful to welfare analysis and models of monopolistic and oligopolistic
competition. Following Pollak (1972), we refer to such a demand systems as â€œgeneralized
separableâ€ whereby demand satisfies:
qi = qi (pi /w, Î›)

(1)

for each good i, where w refers to consumer income (total outlays), pi the price of good i, and Î›
is a scalar (aggregator) function of all prices and income. Without providing a complete proof,
Gorman (1972, 1995) indicates that such demand system can take either of two main forms1 if
1

There are other cases that can be ruled out under additional restrictions on price sensitivity.

2

we impose the Slutsky matrix to be symmetric:
qi =

Di (F (Î›)pi /w)
H(Î›)

or:

qi = Ai (Î›)(pi /w)âˆ’Ïƒ(Î›)

(2)

where, in both cases, Î› is a scalar that is adjusted so that the budget constraint is satisfied, and
can thus be defined as an implicit function of prices and income. As little is known about these
demand systems, they have not been used in the applied literature in spite of their usefulness.2
The objectives of this paper are twofold. First, I provide conditions under which demand
with generalized separability have to take these two forms (i.e. a formal statement of Gormanâ€™s
claims mentioned above). These functional forms however do not imply that these demand
systems are well defined and integrable, as shown with counter-examples in each case. The
second and main contribution is to show that any demand function that takes the form in
equation (2) can be integrated under weak restrictions. These restrictions ensure that the Slutsky substitution matrix not only is symmetric but also negative semi-definite, or equivalently,
a quasi-concave and well-defined utility function.
In the first case, where demand satisfies qi = Di (F (Î›)pi /w)/H(Î›), integrability is guaranteed if Di is monotonically decreasing in pi , and demand qi is decreasing in Î›. We will refer
to this case as a â€œgeneralized Gorman-Pollakâ€ demand system, which generalizes the demand
systems mentioned above. It corresponds to directly-additive utility when H(Î›) is constant
and indirectly-additive utility when F (Î›) is constant. This also generalizes the results of Matsuyama and Ushchev (2017), who focus on homothetic demand where F (Î›) = 1/H(Î›) = Î›.
Income and price elasticities both depend on the functional form chosen for Di , which can
be very flexible; demand and price shifters H(Î›) and F (Î›) also influence income effects and
depend flexibly on the price aggregator.
In the second case, with common price elasticities across goods and qi = Ai (Î›)(pi /w)âˆ’Ïƒ(Î›) ,
integrability requires that the demand shifters Ai (Î›) increase quickly enough in Î› to ensure
that the associated utility is well defined. In that case, there is a one-to-one mapping between Î›
and utility. Notice that the price elasticity Ïƒ(Î›) does not have to remain constant or monotonic
across indifference curves; it can increase or decrease with Î›, i.e. indifference curves can become
flatter or more convex as income goes up, as long as they do not cross. We will refer to that
case as â€œgeneralized non-homothetic CESâ€. This second case features Allen-Uzawa substitution
elasticities that do not vary across goods but may vary with the demand aggregator Î›, and
generalizes implicitly-additive utility functions previously defined by (Comin et al., 2015) who
impose a constant elasticity of substitution Ïƒ(Î›) = Ïƒ. Relative to Gorman-Pollak demand, this
2

There are a few recent exceptions, including Bertoletti and Etro (2017a) for the first case, Comin et al.
(2015) and Matsuyama (2015) for the second case with homogeneous Ïƒ(Î›) = Ïƒ.

3

case allows for more flexible income patterns, but less flexible price effects.3
The demand systems in both cases yield various applications. They are particularly useful
in the case of monopolistic competition. In the limit where firms have small market shares,
they choose their price by taking as given other prices and quantities. It is then practical to
have a single industry-wide indicator Î› that uniquely determines the locus of the demand curve
for a good with respect to its own price.4
With the first type of demand system, the generalized Gorman-Pollak form, the price aggregator Î› can be interpreted as an index of tightness of the budget constraint,5 or alternatively
as an index of the toughness of competition in a model with firms. It may shift downward
or upward along demand curves as income and competition grows, with flexible implications
for markups. These demand functions encompass most examples from MraÌzovaÌ and Neary
(2013), e.g. bi-power and inverse bi-power demand functions, or Weyl and Fabinger (2013),
e.g. Bulow-Pfleiderer demand. With iso-elastic functions H and Di , they coincide with the
self-dual addilog demand systems (Houthakker, 1965) and extend the constant relative income
elasticities (CRIE) used for instance in Fieler (2011) and Caron et al. (2014). The generalized Gorman-Pollak form can also generate choke prices (as demand Di for a good i goes to
zero) which can be expressed as a simple function of income and the price aggregator, with a
functional form that is again more flexible than commonly used in macroeconomics and international trade. In particular, this form can be used to generalize the results of Bertoletti and
Etro (2017b) and Bertoletti et al. (2016) in which the choke price is proportional to income.
Applications of the second type of demand, with generalized non-homothetic CES, remain
very tractable and empirically relevant, because they allow for heterogeneous price elasticities
across the income distribution. Several studies (such as Handbury, 2013 and Faber and Fally,
2017) based on expenditure surveys and scanner data have shown that price elasticities vary
significantly with income. Handbury (2013) and Faber and Fally (2017) model income effects in
the elasticity of substitution by relying on a numeraire good. With generalized non-homothetic
CES, we can instead generate such relationship between income and the elasticity of substitution
through utility, without relying on a numeraire, while retaining a common elasticity Ïƒ(Î›) across
goods for a given income level.
The paper is also related to a vast literature studying functional forms restrictions of utility
3

Note that implicitly-additive utility depends on a single aggregator only in the case where the Allen-Uzawa
elasticity of substitution is common across goods. In other cases, such as Kimball (1995), two aggregators are
needed. See also Preckel et al. (2005) for another form of implicitly additive utility and generalization of CES
preferences.
4
Bertoletti and Etro (2017a) recent work formalizes this insight and covers this demand system as an example.
5
Aggregator Î› is implicitly determined by the budget constraint and its role is very similar to the Lagrange
multiplier under directly-separable preferences.

4

and demand systems. Ligon (2016) focuses on cases where the aggregator Î› corresponds to
the Lagrange multiplier associated with the budget constraint, and shows that Î›âˆ’separability
implies directly-additive utility with even more specific functional forms. Nocke and Schutz
(2017) study the (â€œquasi-â€) integrability of quasi-linear demand systems, i.e. without income
effects. Atkin et al. (2018) examine quasi-separable preferences (following Gorman, 1970, 1995)
and applications to welfare estimation using Engel curves. The discussion on the existence of
aggregators also mirrors the restrictions associated with the rank of a demand system (Gorman,
1981; Lewbel, 1991, 2010; LaFrance and Pope, 2006; Lewbel and Pendakur, 2009). The rank
of a demand system corresponds to the number of vectors and homothetic price aggregators
needed to recover Engel curves (see Lewbel, 1991). Here, the single aggregator Î› is generally not
homogeneous of degree one in prices (it also depends on income) and the two demand systems
studied here do not have restrictions in terms of rank. Finally, Blackorby et al. (1978) study
functional forms implied by various definitions of separability, and find that the same functional
structure as with generalized non-homothetic CES is obtained when imposing stronger forms
of separability that imply equality among Allen-Uzawa elasticities of substitution.
The remainder of the paper proceeds as follows. Section 2 examines the functional forms
imposed by generalized separability. Section 3 provides sufficient conditions to ensure integrability for each type of demand. Section 4 discusses key properties of these demand systems.
Section 5 concludes by discussing various applications.

2

Functional Forms under Generalized Separability

Additively-separable utility allows us to obtain demand as a simple function of a goodâ€™s own
price pi and a single aggregator, the Lagrange multiplier. While practical, both direct and indirect separability put strong constraints on the structure of demand, such as a tight relationship
between price elasticity and income elasticity, with for instance the adverse consequence that
preferences with constant elasticity of substitution (CES) are the only directly-separable and
indirectly-separable preferences that are homothetic.
In an attempt to generalize the concept of separability, Gorman (1972) and Pollak (1972)
define generalized separability as demand that would take the form:
qi = qi (pi /w, Î›)

(3)

where qi refers to demand for good i (quantity) and Î› is implicitly defined by the budget
constraint:
X
pi qi = pi qi (pi /w, Î›) = w
5

i.e. such that total expenditures equal a fixed revenue w. Note that, generally, Î› is not a
Lagrange multiplier, except for the case where demand can be derived from a directly-additive
separable utility (Ligon 2016).
In an unpublished note by Gorman (printed in Gorman, 1995) mentioned by Pollak (1972),
Gorman indicates that a demand system defined as above needs to take specific forms in order
to satisfy Slutskyâ€™s symmetry condition. With a few additional restrictions, this result can be
formulated as follows:6

Proposition 1 If demand satisfies the following conditions:
i) generalized separability (equation 3);
ii) there are at least four goods,
iii) holding Î› constant, (pi /w)qi (pi /w, Î›) is not constant over the range of prices pi
Then demand can be written as either:
case 1:
case 2:
+ case 2â€™:

Di (F (Î›)pi /w)
H(Î›)
qi (pi /w, Î›) = Ai (Î›)(pi /w)âˆ’Ïƒ(Î›)

qi (pi /w, Î›) =

qi (pi /w, Î›) = Ai Î›Ï (pi /w)âˆ’Ïƒ

for all goods i and all pi , w, Î›
for all goods i and all pi , w, Î›
for all but one good i

or a combination of cases 2 and 2â€™ depending on Î›. In all cases, Î› is implicitly defined such
P
that budget constraint is satisfied, i.e. such that i qi (pi /w, Î›)pi = w.
The proof of Proposition 1 is rather tedious. A key step is to show that the symmetry of
the Slutsky matrix implies, with a few exceptions, that either the cross-elasticity of demand
w.r.t to the normalized price pi /w and Î› is constant across all goods (this corresponds to case
âˆ’Î›i
2 above) or that the ratio of elasticities Î›i
is identical across all pairs of goods (conditional
yi âˆ’yi
on Î›), where Î›i denotes the demand elasticity of good i w.r.t Î› and yi w.r.t own normalized
prices pi /w. Solving differential equations implied by these constraints, we can then show that
the functional forms above are the only possible demand functions. Symmetry of the Slutsky
matrix is the only constraint that is imposed on substitution patterns, and the negative semidefiniteness is not yet guaranteed.
6

Gormanâ€™s sketch of proof had many shortcuts, as he himself noted: â€œThroughout this paper I have talked
as if my claims were definitely proven. Of course this is not so: my arguments are far from rigorousâ€ (Gorman,
1995). Here I impose somewhat stronger assumptions on the form of demand and price effects in order to avoid
a few inelegant cases. In particular, the assumption that expenditure shares are not just a function of Î› allows
me to avoid what Gorman calls â€œthe abnormal caseâ€.

6

Since the third case is relatively interesting and elegant (CES for all but one good), the
remainder of the paper focuses on cases 1 and 2, setting aside case 2â€™. Note that there may
be alternative functional forms under generalized separability if we allow for price-insensitive
expenditures shares, which Gorman calls â€œabnormalâ€ goods. Assumption iii) allows us to
exclude such cases.
Finally, note that functional forms are unique up to a constant term and a monotonic
transformation of Î›:

Proposition 2 Uniqueness of functional forms, except for the CES case:
Case 1: H(Î›) and F (Î›) are uniquely determined by demand patterns, up to a constant
term and a strictly-monotonic transformation of Î›
Case 2: Ai (Î›) and Ïƒ(Î›) are uniquely defined by demand patterns, up to a strictlymonotonic transformation of Î›

To prove this result, in case 1), note that price effect depend tightly on ÎµDi (see sections 3.2
and 3.3), hence price elasticities can be used to determine Di . One can then identify functions
F and H by examining variations in ÎµDi depending on income (except in the CES case).7 In
case 2), Ïƒ corresponds to price elasticities and Ai (Î›) can be determined by examining income
expansion path. Note that for any function H, F , Ai and Ïƒ, one would obtain the same demand
patterns after the change in variable Î›0 = g(Î›) with any one-to-one mapping g.
In the first case, note that we can express the inverse demand system as:
pi /w = (1/F (z)) Diâˆ’1 (H(z)qi )

(4)

where z is implicitly defined as described in equation (8) as function of the vector of consumption. When F (z)H(z) is constant and preferences are homothetic, this aggregator z is
homogeneous of degree one in quantities qi . This inverse demand formulation highlights the
symmetric role of H vs. F . While H is the demand shifter in the direct demand function
(equation 4), now F is the demand shifter in the inverse demand function.
7

Price and income elasticities depend on the ratio of ÎµF and ÎµH which is uniquely determined once we know
these elasticities. Taking a strictly monotonic transformation of Î› does not change this ratio and yields the same
consumption patterns (assuming that this new aggregator is also such that the budget constraint is satisfied).

7

3

Integrability

3.1

Integrability of Generalized Gorman-Pollak Demand

Let us now examine the reciprocal of Proposition 1. Under which conditions are these demand systems integrable, i.e. can be derived from a rational utility-maximizing consumption
behavior? These functional forms, imposed by the symmetry of the Slutsky matrix, do not
necessarily correspond to rational consumer behavior (see counter-examples in Appendix B).
However it turns out that only weak additional conditions are sufficient to guarantee that the
demand systems described in Proposition 1 are integrable.
Suppose that demand is given by:
qi =

Di (F (Î›)pi /w)
H(Î›)

(5)

P
where Î› is implicitly determined by the budget constraint
i pi Di (F (Î›)pi /w)/H(Î›) = w,
which can be rewritten:
X
H(Î›) =
(pi /w) Di (F (Î›)pi /w)
(6)
i
Di
H
Let us denote by ÎµDi = âˆ‚âˆ‚log
the elasticity of Di in its argument, and ÎµH = âˆ‚âˆ‚ log
and
log x
log Î›
âˆ‚ log F
ÎµF = âˆ‚ log Î› the elasticity of H and F in Î›.
To ensure integrability, we impose the following sufficient regularity restrictions:

Regularity assumptions [A1] on functions Di and H:
i) Di is differentiable, ÎµDi < 0 unless Di = 0
ii) H and F are differentiable and ÎµF ÎµDi < ÎµH for all i, Î› and pi /w
iii) For any set of normalized prices pi /w, equation (6) admits a solution in Î›.

Note that instead of [A1] ii) we could assume that ÎµF ÎµDi âˆ’ ÎµH has the same sign for all i, Î› and
pi /w. Assuming that this difference is negative is without loss of generality as we can always
make the change in variable Î›0 = 1/Î› to invert its sign for all goods and prices. Assumptions i)
and ii) imply that the solution in Î› to equation (6) is always unique, but they are also needed
to show that utility is quasi-concave and that the Slutsky substitution matrix is negative semidefinite. However, condition ii) on elasticities does not ensure that there exists a Î› to satisfy
the budget constraint, so we need to also impose condition iii). Note also that condition iii)
could be implied by stricter conditions on elasticities (see Appendix C for practical examples).
8

Under these conditions, we obtain:
Proposition 3 If H and Di satisfy the regularity conditions [A1], the demand described in
equations (5) and (6) is integrable, i.e. can be derived from a utility function.
I provide two alternative proofs in Appendix. First, we can reconstruct a utility function that
depends on an implicitly-defined aggregator.8 We can show that demand can be derived from
the maximization of:
U (q) =

XZ
i

x=H(z)qi

Diâˆ’1 (x)dx

Z

z

âˆ’

H 0 (z)F (z)dz

(7)

z0

x=xi0

for arbitrary z0 , x0i â‰¥ 0 and where z is itself a function of the consumption vector x implicitly
defined by:
X
F (z) =
qi Diâˆ’1 (H(z)qi )
(8)
i

As a slight abuse of notation, we define Diâˆ’1 (0) = ai if Di (y) = 0 for all y â‰¥ ai (which yields a
choke price) and Diâˆ’1 (x) = 0 for all x â‰¥ bi if Di (0) = bi . Regularity conditions [A1] are needed
to ensure that equation (8) always has a unique solution in z and that the utility function
is quasi-concave. Note that equation (8) can be seen as a first-order condition such that the
derivative of the expression above for U has a zero derivative in z, and such that:
âˆ‚U
= Diâˆ’1 (H(z)qi )
âˆ‚qi

(9)

The two aggregators Î› (function of prices and income) and z (function of quantities q) coincide
for the optimal consumption basket.9
An alternative proof of Proposition 3 checks that the Slutsky substitution matrix is negative
semi-definite under these restrictions, so that we can apply the integrability theorem of Hurwitz
and Uzawa (1971). Thanks to Proposition 1, we already know that it is symmetric but this
does not ensure semi-definite negativity. As one could expect, the conditions ensuring the semidefinite negativity of the Slutsky matrix are the same as those providing the quasi-concavity
of the utility function above.
8

This utility representation was pointed out by Gorman (1987) with a more restrictive formulation and
no formal proof that such utility
function is well defined and quasi-concave. Gorman formulated this as a
P
maximization: U = maxz { i ui (zqi ) âˆ’ Î¦(z)} but this approach omits very useful cases (e.g. cases with
0 < Î² < 1 in applications 3, 4, 9 and 10 in Section 4) where the second order condition of this maximization is
not satisfied yet the utility function remains quasi-concave with z implicitly defined by equation 8.
9
But note that z is defined as a function of the vector of quantities while Î› is a function of the vector of
prices and income.

9

Next, an important concern is whether the set of conditions [A1] can be relaxed, but I argue
here that all are needed. First, the demand system would clearly not be well defined if it does
not have a solution in equation (6), so condition iii) is unavoidable. It is possible to impose
more simple conditions to ensure existence, but such condition would be less general. Second,
restriction ii) is the simplest and more direct way to insure that the equation defining the price
aggregator has a unique solution. It is required for good i for a given level of prices when a
good i has a sufficiently large expenditure share. In Appendix B, I provide an example with two
goods where restrictions i) and iii) are met but the Slutsky matrix is no longer negative semidefinite when ÎµF ÎµDi âˆ’ ÎµH does not have the same sign for the two goods. Finally, restriction i)
ensures that we have a negative effect of prices on demand when the expenditure share of a good
is small (a positive price effect would not be rational for small expenditure shares). Inverting
Di is also needed in equations (8) and (7) to retrieve utility.
The case F (Î›) = 1/H(Î›) coincides with Matsuyama and Ushchev (2017) for homothetic
preferences. With the change in variable: F (Î›) = 1/H(Î›) = wÎ›0 (where Î›0 is again implicitly
determined by the budget constraint), a demand system such that qi = Î›0 wDi (Î›0 pi ) can be
rationalized as long as ÎµDi + 1 has the same sign for all goods (which is equivalent to A1-ii). If
ÎµDi + 1 is negative, we define Î›0 instead by w/Î›0 = F (Î›) = 1/H(Î›).
In general, Proposition 3 does not require F (Î›) to be monotonic in Î›. If F 0 (Î›) > 0, an
increase in Î› (tightness of the budget constraint) leads to a downward shift in the partial
demand curve Di . When F 0 (Î›) < 0, we would instead have an upward shift in Di , which
needs to be compensated by a large enough decrease in the demand shifter H(Î›). If F (Î›) can
be inverted (which is satisfied for most applications provided in Section 4), note that we can
reformulate demand as:
e
qi = H(Î›w)D
i (Î›pi )

s.t.:

e
H(Î›w)

X

pi Di (Î›pi ) = w

(10)

i

e
with the change in variable: Î›0 = F (Î›)/w and the transformation 1/H(Â·)
= H(F âˆ’1 (Â·)). In
this case, condition [A1] ii) and iii) are automatically satisfied if there exists  > 0 such that
ÎµHe + ÎµDi < âˆ’ for all pi , w and Î›.

3.2

Integrability of Generalized Non-Homothetic CES

Now, consider the second case of Proposition 1. Let us assume that demand is given by:
pi qi = w (Gi (Î›) pi /w)1âˆ’Ïƒ(Î›)

10

(11)

where Î› is an implicit function of the vector of normalized prices pi /w such that the budget
constraint is satisfied:
X
(Gi (Î›)pi /w)1âˆ’Ïƒ(Î›) = 1
(12)
i

To ensure integrability, we impose the following sufficient regularity restriction [A2]:

Regularity assumptions [A2] For each Î›, we have Ïƒ(Î›) 6= 1 and either one of the following
two conditions:
i) Ïƒ(Î›) is weakly increasing in Î› and Gi (Î›) is strictly increasing in Î›
ii) Ïƒ(Î›) is decreasing in Î› and, for each Î›0 , there exists Î±i > 0 such that
1
Ïƒ(Î›)âˆ’1

such that Gi (Î›) Î±i

P

i

Î±i = 1 and

is strictly increasing in Î› in a neighborhood of Î›0

When both Ïƒ(Î›) and Gi (Î›) are all differentiable, condition ii) can be rewritten after solving
for the minimum Î±i that would satisfy this monotonicity condition. Condition ii) is formally
equivalent to imposing:10


X
(Ïƒ(Î›) âˆ’ 1)2 G0i (Î›)
exp
<1
(13)
0 (Î›)G (Î›)
Ïƒ
i
i
See Appendix for the proof of equivalence.
We obtain the following proposition for generalized non-homothetic CES:

Proposition 4 Suppose that demand can be written as in equation (11) where Gi and Ïƒ are
continuous and where Î› is implicitly defined by (12). This demand system is integrable if
conditions [A2] are satisfied. Under [A2], demand can be derived from a utility function that is
implicitly defined by:
X
Ïƒ(U )âˆ’1
(14)
(qi /Gi (U )) Ïƒ(U ) = 1
i

which has a unique solution in U , with Î› = U for the demand qi described above.

The constant elasticity case Ïƒ(Î›) = Ïƒ corresponds to implicitly additive utility as in (Comin
et al., 2015). This is not equivalent to the standard CES since, even in that case, non-trivial
10

In general, note that condition ii) need not hold for any set of Î±i â€™s, it is sufficient that it holds for a single
set of Î±i â€™s. In particular, using Î±i = 1/N (where N denotes the number of goods), a sufficient condition is that
1
Gi (Î›) N 1âˆ’Ïƒ(Î›) strictly increases in Î›.

11

income effects through the demand shifter Gi (Î›) allow for very flexible Engel curves. The main
contribution of this proposition is to generalize to variable elasticity of substitution.
The proof of Proposition 4 mainly consists in showing that Î› is well-defined, i.e. that
the budget constraint has a unique solution in Î›, and that utility is also uniquely defined by
equation 14. As the more general case allows for varying curvature of indifference curves, one
needs to ensure in particular that these indifference curves do not cross.
i1
hP
Ï Ï
The proof proceeds as follows. First we show in a lemma that
Î±
x
is monotonically
i
i
i
P
increasing in Ï if i Î±i = 1 (a consequence of Jensenâ€™s inequality). This allows us to obtain
comparative statics in the exponent in equations (14) and (12). We can then show that the
solutions to these equations are unique, for a given set of income and prices, or quantities.
Once we have uniqueness, it is easy to verify the quasi-concavity of the utility function (as in
Comin et al., 2015). The last step is to check that this utility maximum problem does yield
the demand system described above.
Again, as for Proposition 3, a potential concern is whether restrictions [A2] are necessary.
When neither condition i) or ii) is satisfied, neither the demand system described above nor the
utility in Proposition 3 is well defined. Counter-examples in the Appendix further illustrate
the role of each condition, showing that equations (12) and (14) admit multiple solutions in Î›
and U if conditions i) and ii) are not satisfied. Incidentally, this shows that monotonicity in
demand shifters Gi (Î›) is not sufficient.11
One should also point out why we need different conditions depending on whether Ïƒ(Î›)
decreases or increases with Î›. In the first case, where Ïƒ(Î›) increases with Î›, indifference
curves become flatter as we move away from the origin (with increases in income and Î›). In
that case, indifference curves are most likely to cross around the intercepts (when only one
good is consumed). Monotonicity in Gi (Î›) is then sufficient to ensure that indifference curves
do not cross. In the second case, where the elasticity of substitution Ïƒ(Î›) decreases with Î›, the
indifference curves are more curved as we move away from the origin. In this case, indifference
curves are most likely to be close to each other and intersect in the middle.
11

We can also have Ïƒ(Î›) = 1 for a discrete number of limit cases.

12

4
4.1

Properties: Welfare, price and income effects
Generalized Gorman-Pollak

Price elasticities. In this case, the price elasticity of Marshallian demand is:
âˆ‚ log qi
Wj (1 + ÎµDj )(ÎµH âˆ’ ÎµF ÎµDi )
= ÎµDi . 1(i=j) âˆ’
âˆ‚ log pj
ÎµH âˆ’ ÎµF ÎµÌ„D
where Wj is the expenditure share of good j and 1(i=j) is a dummy equal to one when i = j.
Given our restriction ÎµH > ÎµF ÎµDi , the cross-price elasticity (i 6= j) is positive if and only if
ÎµDj < âˆ’1. The own-price elasticity is always negative, which rules out Giffen goods.
The own price elasticity is mainly determined by the shape of function Di when that good
has a negligible market share:
âˆ‚ log qi
â‰ˆ ÎµDi
âˆ‚ log pi
Since we impose very few constraints on ÎµDi the patterns of price elasticities can be very flexible.
Shifters and choke prices. For applications to oligopolistic and monopolistic competition,
a key determinant of the toughness of competition is the position along demand curves. Here
this is reflected in the price shifter F (Î›)/w as well as the demand shifter H(Î›). Either one is
constant with directly or indirectly-separable preferences.
The demand system can be accommodated to yield choke prices (also called reservation
prices), i.e. a price threshold pâˆ—i such that Di (F (Î›)pi /w) = 0 for all pi â‰¥ pâˆ—i , which arises as
soon as Di (y) = 0 for large enough yâ€™s.12
Of particular interest is how choke prices depend on income. Income is irrelevant with
homothetic preferences, but this prediction contradicts substantial evidence (e.g. Hummels
and Klenow 2007) showing that richer consumer buy a greater variety of goods and that richer
countries import a larger variety of products. A special case corresponds to indirectly-additive
preferences (H is constant). In this case, choke prices are linear in income, as documented by
Bertoletti et al (2017). In the general case, the choke price depends on both income and the
toughness of competition, captured by Î›:
pâˆ—i =

ai w
F (Î›)

12
Choke prices are particularly useful in international trade to explain why less efficient firms are less likely
to export to a specific market (without having to rely on export fixed costs) and to obtain gravity equations as
shown in Melitz and Ottaviano (2008) and Arkolakis et al (2015) among others.

13

where ai = min{Diâˆ’1 (0)} is the level above which demand is null.
Income effects. The income elasticity of good i is:
âˆ‚ log qi
(ÎµH + ÎµF )(ÎµÌ„D âˆ’ ÎµDi )
=1+
âˆ‚ log w
ÎµH âˆ’ ÎµF ÎµÌ„D

(15)

Using this expression, one can see that homotheticity implies that either ÎµH = âˆ’ÎµF or ÎµDi = ÎµÌ„D
for all i.
As pointed out by Pigou (1910) and Deaton (1974), own-price elasticities and income elasticities are tightly linked when demand is derived from a directly-additive utility (which correqi
sponds to the case where ÎµH = 0). Here we obtain: âˆ‚âˆ‚ log
= ÎµÎµÌ„Di
with directly separable utility.
log w
D
With ÎµH 6= 0, the relationship between income elasticity and price elasticity is muted and we
obtain a demand system that is more in line with Deaton (1974) empirical results. Note that
âˆ‚ log qi
âˆ’ 1 has the same sign as ÎµÌ„D âˆ’ ÎµDi when ÎµF + ÎµH > 0, and flipped otherwise. This property
âˆ‚ log w
can seem attractive, as empirical evidence indicates that price-elastic goods are not necessarily
more income elastic.
Homotheticity. This demand system is homothetic if and only if H(Î›)F (Î›) is constant or
if it is CES. This corresponds to the case studied by Matsuyama and Ushchev (2017). In this
case, without loss of generality we can assume that F (z) = 1/H(z) = z. We obtain that a
utility representation given by:
U (q) = log(z) +

XZ
i

where z is such that

âˆ’1
i (qi /z)Di (qi /z)

P

x=qi /z

Diâˆ’1 (x)dx

(16)

x=xi0

= 1, and xi0 are constant terms.

Indirect utility. Here we draw from Pollak (1972) to show that indirect utility can be expressed as:
V (p, w) = Ve (p, w, Î›) =

XZ
i

yi0

Z

Î›

Di (y)dy +

(pi /w)F (Î›)

F 0 (l)H(l)dl

(17)

Î›0

where Î› = Î›(p, w) is implicitly defined as above, and where yi0 and Î›0 are constant terms.
Ve
= 0, hence we obtain simple expressions for marginal
Conveniently, we can verify that âˆ‚âˆ‚Î›
(indirect) utility from income and price changes. Taking the derivative w.r.t income, one can

14

interpret the product of the two shifters as the marginal utility of income:
âˆ‚V (p, w)
F (Î›)H(Î›)
=
âˆ‚w
w

(18)

This expression can also be useful to compute equivalent and compensating variations, implicitly defined such that V (p0 , w âˆ’ CV ) = V (p, w) and V (p, w + EV ) = V (p0 , w0 ).
Additivity When are these preferences directly or indirectly additive? Recall that preferP
ences are directly additive if utility can be written as U (q) = f ( i ui (qi )) where f and {ui }
are scalar functions. Preferences are indirectly additive if indirect utility can be written as
P
V (p, w) = g( i vi (pi /w)) where g and {vi } are scalar functions.
From equation (7), we can conclude that utility is directly-additive if and only if H is
constant or demand is CES. From equation (17) for indirect utility, we can see that we have
indirect additivity if and only if F is constant or demand is CES.

4.2

Generalized Non-Homothetic CES

Price effects. In the second case, when demand corresponds to equation (11), price effects
are more simple. The price elasticity of the Hicksian demand corresponds to Ïƒ(Î›), since we
can also interpret Î› as utility (Proposition 3).
Income effects. In the second case, demand corresponding to equation (11) yields even more
flexible income effects. Changes in Gi (Î›) in Î› need not be related to changes in Ïƒ(Î›). Starting
with the special case where Ïƒ(Î›) = Ïƒ is constant, which corresponds to Hanoch (1975), the
effect of income on Î› is such that:
1âˆ’Ïƒ
âˆ‚ log Î›
=
(19)
âˆ‚ log w
ÎµÌ„G
Î›G0 (Î›)

where ÎµÌ„G is an average of elasticities ÎµGi = Gii(Î›) weighted by expenditures shares. We obtain
the income elasticity:
 
âˆ‚ log qi
ÎµGi
= Ïƒ + (1 âˆ’ Ïƒ)
(20)
âˆ‚ log w
ÎµÌ„G
Good i is income-elastic if Ïƒ < 1 and ÎµGi > ÎµÌ„G or if Ïƒ > 1 and ÎµGi < ÎµÌ„G . In the more general
case where Ïƒ(Î›) is not constant, function Gi plays a similar role and dictates income effects.
Moreover, depending on how income affects Î› (with depends on both the sign of Ïƒ 0 (Î›) and
whether Ïƒ(Î›) is smaller than unity), one can have Ïƒ increase or decrease with income.
One constraint, however, links the price elasticity and the income elasticity. Both in the
cases where Ïƒ(Î›) is fixed or increasing in Î›, the price elasticity imposes a lower bound on
15

income elasticities of demand:13
âˆ‚ log qi
> Ïƒ(Î›)
âˆ‚ log w
âˆ‚ log qi
< Ïƒ(Î›)
âˆ‚ log w

if Ïƒ(Î›) < 1
if Ïƒ(Î›) > 1

Homotheticity. The demand system in (11) is homothetic only in the CES case, as one can
see for instance in expression (20).

5

Concluding remarks

Economists have often focused on demand systems where prices are conveniently summarized by
a single aggregator, and where demand depends solely on such an aggregator, total expenditures
and a goodâ€™s own price (â€œgeneralized separabilityâ€, following the terminology of Pollak 1972).
Here I show that such a demand system can take only one of two forms when price effects are not
trivial. This result was already known by Pollak (1972) and Gorman (1972) but not formally
demonstrated and is not well known today in spite of its usefulness. Furthermore, I show that
these two types of demand systems are integrable (i.e. can be derived from well-behaved utility
functions) under fairly mild regularity restrictions that guarantee the semi-definite negativity
of the Slutsky substitution matrix (and quasi-concavity of utility).
The first case of demand allows for very flexible price effects but more restricted income
effects. This is particularly useful in industrial organization where income effects are not the
main focus. The second case of demand allows for very flexible income effects (highly flexible
Engel curves) but more restricted price effects. Allen-Uzawa substitution elasticities have to
be constant across goods to ensure the symmetry of the Slutsky matrix, but here I show that
they may vary (increase or decrease) with utility and thus vary indirectly with income.
There can be numerous applications and uses of such demand systems, spanning different
fields. I provide additional examples in Appendix C. I describe cases of Gorman-Pollak forms
where functions H and F are iso-elastic, which provides simple generalizations of directlyseparable and indirectly-separable preferences, and cases where functions Di are iso-elastic,
which coincide with self-dual addilog demand systems (Houthakker 1965). Other examples
described in the appendix generalize demand systems featured in Mazrova and Neary (2013),
such as cases where functions Di take a bi-power form, and the use of non-homothetic CES.
13

When Ïƒ(Î›) decreases in Î›, the income elasticity exceeds Ïƒ(Î›) if and only if exp

This need not be satisfied, even if inequality (13) is imposed.

16



(Ïƒ(Î›)âˆ’1)2 G0i (Î›)
Ïƒ 0 (Î›)Gi (Î›)



< Wi .

References
Antonelli, G. B. (1886). Sulla teoria matematica della economia politica.
Atkin, D., B. Faber, T. Fally, and M. Gonzalez-Navarro (2018). â€œA New Engel on the Gains
from Tradeâ€. Working paper .
Bertoletti, P. and F. Etro (2017a). Monopolistic competition, as you like it. University Caâ€™
Foscari of Venice, Dept. of Economics Research Paper Series, 08/2017.
Bertoletti, P. and F. Etro (2017b). Monopolistic competition when income matters. The
Economic Journal 127 (603), 1217â€“1243.
Bertoletti, P., F. Etro, and I. Simonovska (2016). International trade with indirect additivity.
National Bureau of Economic Research WP No. 21984 .
Blackorby, C., D. Primont, and R. R. Russell (1978). Duality, separability, and functional
structure: Theory and economic applications, Volume 2. Elsevier Science Ltd.
Caron, J., T. Fally, and J. Markusen (2017). Per capita income and the demand for skills.
National Bureau of Economic Research WP No. 23482 .
Caron, J., T. Fally, and J. R. Markusen (2014). International trade puzzles: A solution linking
production and preferences. The Quarterly Journal of Economics 129 (3), 1501â€“1552.
Comin, D. A., D. Lashkari, and M. Mestieri (2015). Structural change with long-run income
and price effects. National Bureau of Economic Research Working Paper .
Deaton, A. (1974). A reconsideration of the empirical implications of additive preferences. The
Economic Journal 84 (334), 338â€“348.
Faber, B. and T. Fally (2017). Firm heterogeneity in consumption baskets: Evidence from
home and store scanner data.
Fieler, A. C. (2011). Nonhomotheticity and bilateral trade: Evidence and a quantitative explanation. Econometrica 79 (4), 1069â€“1101.
Gorman, W. M. (1970). Quasi separable preferences, costs, and technologies. Unpublished
manuscript.
Gorman, W. M. (1972). Conditions for generalized additive separability. Unpublished transcript, now printed in Gorman (1995).
Gorman, W. M. (1981). Some engel curves. Essays in the theory and measurement of consumer
behaviour in honor of sir Richard Stone.
Gorman, W. M. (1987). Separability. The New Palgrave: A Dictionary of Economics, London:
Macmillan Press, 4, 305â€“11.

17

Gorman, W. M. (1995). Collected Works of WM Gorman: Separability and Aggregation, Volume 1. Oxford University Press.
Handbury, J. (2013). Are poor cities cheap for everyone? non-homotheticity and the cost of
living across us cities. Mimeograph, Wharton University.
Hanoch, G. (1975). Production and demand models with direct or indirect implicit additivity.
Econometrica, 395â€“419.
Houthakker, H. S. (1965). A note on self-dual preferences. Econometrica, 797â€“801.
Hurwicz, L. and H. Uzawa (1971). On the integrability of demand functions. Preferences,
utility, and demand , 114â€“148.
LaFrance, J. T. and R. D. Pope (2006). Full rank rational demand systems. Department of
Agricultural & Resource Economics, UCB .
Lewbel, A. (1991). The rank of demand systems: theory and nonparametric estimation. Econometrica: Journal of the Econometric Society, 711â€“730.
Lewbel, A. (2010). Shape-invariant demand functions. The Review of Economics and Statistics 92 (3), 549â€“556.
Lewbel, A. and K. Pendakur (2009). Tricks with hicks: The easi demand system. The American
Economic Review 99 (3), 827â€“863.
Ligon, E. (2016). All Î»-separable demands and rationalizing utility functions. Economics
Letters 147, 16â€“18.
Matsuyama, K. (2015). â€œThe home market effect and patterns of trade between rich and poor
countriesâ€. Working paper .
Matsuyama, K. and P. Ushchev (2017). â€œBeyond CES: Three alternative classes of flexible
homothetic demand systemsâ€. Working paper .
Mayer, T., M. J. Melitz, and G. I. Ottaviano (2014). Market size, competition, and the product
mix of exporters. The American Economic Review 104 (2), 495â€“536.
Melitz, M. J. and G. I. Ottaviano (2008). Market size, trade, and productivity. The Review of
Economic Studies 75 (1), 295â€“316.
MraÌzovaÌ, M. and J. P. Neary (2013). Not so demanding: Preference structure, firm behavior,
and welfare. The American Economic Review (forthcoming).
Mrazova, M., J. P. Neary, and M. Parenti (2017). Sales and markup dispersion: Theory and
empirics. CEPR Discussion Paper No. DP12044 .
Nocke, V. and N. Schutz (2017). Quasi-linear integrability. Journal of Economic Theory 169,
603â€“628.

18

Ottaviano, G., T. Tabuchi, and J.-F. Thisse (2002). Agglomeration and trade revisited. International Economic Review , 409â€“435.
Pollak, R. A. (1972). Generalized separability. Econometrica: Journal of the Econometric
Society, 431â€“453.
Preckel, P. V., J. Cranfield, T. W. Hertel, et al. (2005). Implicit additive preferences: A
further generalization of the ces. In Annual Meetings of the American Agricultural Economics
Association, pp. 24â€“27.
Weyl, E. G. and M. Fabinger (2013). Pass-through as an economic tool: Principles of incidence
under imperfect competition. Journal of Political Economy 121 (3), 528â€“583.

19

Appendix A â€“ Proofs of Propositions 1, 3 and 4
Proof of Proposition 1
Consider the demand system:
qi = (w/pi ).Wi (pi /w, Î›)

(21)

where Wi denotes expenditure shares as a function of normalized prices pi /w (demand is homogeneous
of degree zero in prices and income) and Î› (by assumption), and where Î› is implicitly determined by
the budget constraint:
X
Wi (pi /w, Î›) = 1
(22)
i

We denote normalized prices by yi â‰¡ P
pi /w such that qi = (1/yi ).Wi (yi , Î›) and with Î› an implicit
function of the vector of yi such that:
j Wj (yj , Î›) = 1.
For i 6= j, the Slutsky substitution coefficient is:
sij

=
=
=
=

âˆ‚qi
âˆ‚qi
+ qj
âˆ‚pj
âˆ‚w


qj âˆ‚Wi
qj qi
w âˆ‚Wi âˆ‚Î›
âˆ‚Î›
+ qj
âˆ’
âˆ’
pi âˆ‚Î› âˆ‚pj
âˆ‚w
w âˆ‚yi
w


qi qj âˆ‚ log Î›
qj qi âˆ‚ log Wi
qj qi
âˆ‚ log Wi qi âˆ‚ log Î›
+
âˆ’
âˆ’
âˆ‚ log Î› pj âˆ‚ log pj
w âˆ‚ log w
w âˆ‚ log yi
w
qi qj Î›i âˆ‚ log Î›
qj qi yi
qj qi
qi Î›i âˆ‚ log Î›
+
âˆ’
âˆ’
pj âˆ‚ log pj
w âˆ‚ log w
w
w

where we denote:
yi â‰¡

âˆ‚ log Wi
âˆ‚ log yi

Î›i â‰¡

and

âˆ‚ log Wi
âˆ‚ log Î›

To compute the derivatives of Î› in w and pi , we differentiate (22) w.r.t w, which gives:
"
# "
#
X pi âˆ‚Wi
âˆ‚Î› X âˆ‚Wi
âˆ’
=0
âˆ‚w
âˆ‚Î›
w2 âˆ‚yi
i

i

"

#

"
#
X
âˆ‚ log Î› X
â‡â‡’
Wi Î›i âˆ’
Wi yi = 0
âˆ‚ log w
i

We obtain:

i

P
Wi yi
y
âˆ‚ log Î›
= Pi
=
âˆ‚ log w
Î›
i Wi Î›i

where y and Î› denotes the expenditure-weighted averages of yi and Î›i .
Similarly, differentiating (22) w.r.t price pj , we get:
"
#
âˆ‚Î› X âˆ‚Wi
1 âˆ‚Wj
+
=0
âˆ‚pj
âˆ‚Î›
w âˆ‚yj
i

20

"
#
âˆ‚ log Î› X
â‡â‡’
Wi Î›i + Wj yj = 0
âˆ‚ log pj
i

which gives:
Wj yj
âˆ‚ log Î›
=âˆ’
âˆ‚ log pj
Î›
Incorporating the expressions for the derivatives of Î›, the Slutsky coefficients become:
sij

=
=
=

qi qj Î›i y
qj qi yi
qj qi
qi Î›i Wj yj
+
âˆ’
âˆ’
pj
Î›
w Î›
w
w
qi qj Î›i y
qj qi yi
qi qj Î›i yj
qj qi
+
âˆ’
âˆ’
âˆ’
w Î›
w Î›
w
w
qi qj
[âˆ’yj Î›i + Î›i y âˆ’ yi Î› âˆ’ Î› ]
wÎ›
âˆ’

Rearranging, one can see that the Slutsky substitution matrix is symmetrical if and only if, for all
i 6= j:
yi Î›j âˆ’ Î›j y + yj Î› = yj Î›i âˆ’ Î›i y + yi Î›
Subtracting yj Î›j on both sides, rearranging and factorizing, this can be rewritten:
(yj âˆ’ y )(Î›j âˆ’ Î›i ) = (yj âˆ’ yi )(Î›j âˆ’ Î› )
This holds for any pair of goods i and j. Picking any three goods i, j, k from the consumption basket,
we have:
(yj âˆ’ y )(Î›j âˆ’ Î›i ) = (yj âˆ’ yi )(Î›j âˆ’ Î› )
(yi âˆ’ y )(Î›i âˆ’ Î›k ) = (yi âˆ’ yk )(Î›i âˆ’ Î› )
(yk âˆ’ y )(Î›k âˆ’ Î›j ) = (yk âˆ’ yj )(Î›k âˆ’ Î› )
Adding up, the average terms y and Î› disappear and we obtain:
Î›i yj + Î›k yi + Î›j yk = Î›j yi + Î›i yk + Î›k yj
Subtracting Î›j yj on both sides and factorizing, we obtain:
(Î›i âˆ’ Î›j )(yj âˆ’ yk ) = (Î›j âˆ’ Î›k )(yi âˆ’ yj )

(23)

Let us denote by Y(Î›) the set of feasible y (vector of normalized prices for which the aggregator takes
a value Î›):
(
)
X
Y(Î›) = y ; s.t.
Wi (yi , Î›) = 1
i

and denote by Yi (Î›) its projection onto the i axis, i.e. the set of feasible yi for a given Î›.
For a given Î›, to satisfy equation (23) for any triplet of goods, three cases arise naturally:
- case 1A: yj = yi for all goods, for each y âˆˆ Y(Î›).
- case 1B: yj = yi for all but one good i0, for all y âˆˆ Y(Î›).
- case 2: there exists three goods i 6= j 6= k such that yi 6= yj 6= yk for some y âˆˆ Y(Î›).

21

Case 1A is easier to consider. Recall that, in general, yj is a function of yj and Î›. The goal is to
show that
(Î›)

â€¢ Wi (yi , Î›) = Ai (Î›)yi
for all yi âˆˆ Yi (Î›) for some functions Ai (Î›) and (Î›).
n
o
(Î›)
â€¢ Yi (Î›) = yi ; Ai (Î›)yi
<1
P
Suppose that y âˆ— âˆˆ Y(Î›), i.e. such that
Wi (yiâˆ— , Î›) = 1 and denote (Î›) = yj (yj , Î›). Also suppose
for now that (Î›) is strictly positive (the same proof applies to the other case after a simple change
in variable). Define Ai (Î›) such that Wi (yiâˆ— , Î›) = Ai (Î›)yiâˆ— (Î›) .
Denote by (yi , yi ) the maximum interval included in Yi (Î›) containing yiâˆ— and such that, for each
yi âˆˆ (yi , yi ), there exists yÌƒ âˆˆ Y(Î›), with yÌƒj âˆˆ (yj , yj ) in each of its argument, with yÌƒi = yi , and such
that Wj (yÌƒj , Î›) = Aj (Î›)(yÌƒj )(Î›) .
By contradiction, suppose that this is not the case: suppose that for a good i = I we have
yI > 0. We need to show that it is then possible to construct a new vector y 0 such that Wj (yj0 , Î›) =
P
Aj (Î›)(yj0 )(Î›) and j Aj (Î›)(yj0 )(Î›) = 1, and such that yI0 < yI .
Since we deal with bounded intervals, we can construct a series y (n) that satisfies these four
conditions:
(n)
(n)
i) Wj (yj , Î›) = Aj (Î›)(yj )(Î›) ;
P
(n)
ii) j Wj (yj , Î›) = 1;
iii) each term converge to a finite (possibly zero) value denoted yjâˆ ;
(n)

iv) and such that yI

converges to yI > 0.

By continuity (with the abuse of notation Wi (0, Î›) = 0 in the limit case), we must have Wj (yjâˆ , Î›) =
P
Aj (Î›)(yjâˆ )(Î›) and j Wj (yjâˆ , Î›) = 1. Denote by K0 the set of goods k such that ykâˆ = 0. If K0 is
empty, pick a good k 6= I. Since yI > 0, we know that such a good k satisfies yk < 1/Ak . Next, since
yI > 0 and yk < 1/Ak for k âˆˆ K0 , and since the derivative of WI is non-zero at yI , we can find small
enough but positive Î½I > 0 and Î½k > 0 (for k âˆˆ K0 ) such that:
X
X
WI (yIâˆ âˆ’ Î½I , Î›) +
Wj (yjâˆ , Î›) = 1
Wk (ykâˆ + Î½k , Î›) +
j âˆˆK
/ 0 ,k6=I

kâˆˆK0

Moreover, given that the derivative of Wi is strictly positive on each interval (yIâˆ âˆ’ Î½I , yIâˆ ) and
(ykâˆ , ykâˆ + Î½k ), we can construct a continuum of other vectors y on such intervals that satisfy the same
condition as above. For all these vectors, the elasticity Î½yj must be kept constant so we must have:
Wj (yjâˆ , Î›) = Aj (Î›)(yjâˆ )(Î›) . This contradicts the assumption that yI > 0 and proves that yi = 0 for
all i.
Conversely, one can show that yi = 1/Ai otherwise one can construct a new vector y 0 such as y âˆ
with a ith argument strictly above yi if yi < 1/Ai .
Here we have imposed (Î›) > 0. The same arguments can be applied to the case with (Î›) < 0
with the change in variable yi0 = 1/yi .
Case 1B Here we assume that all but one good i0 has a common elasticity (Î›). Applying the
(Î›)
same arguments as in the previous case, we obtain that Wj (yj , Î›) = Aj (Î›)yj
for all yj such that
(Î›)

Ai (Î›)yi
< 1 âˆ’ si0 where si0 is the minimum expenditure share of good i0 for which its elasticity
differs from other goods.

22

On these intervals, we have:

Î›j (yj , Î›) âˆ’ Î›k (yk , Î›) =

Î›i0 âˆ’ Î›j
yi0 âˆ’ yj


(yj âˆ’ yk ) = 0

which holds for any two goods j, k 6= i0, we obtain that they also share the same elasticity with respect
to Î›: Î›j (yj , Î›) = Î›k (yk , Î›) = Ï(Î›). Hence these elasticities do not depend on yi or yk . This implies
that both  and Ï are constant, and that for any good k 6= i on these intervals we must have:
Wk (yk , Î›) = Ak Î›Ï yk

k 6= i0

Case 2 is more involved. Pick any three goods i, j, k from the consumption basket. From equation (23),
we have:
(Î›i âˆ’ Î›j )(yj âˆ’ yk ) = (Î›j âˆ’ Î›k )(yi âˆ’ yj )
In this case, there exists at least three goods i 6= j 6= k such that yj 6= yi 6= yk for some y âˆˆ Y(Î›).
For these goods, we obtain:
Î›i âˆ’ Î›j
yi âˆ’ yj
Î›i âˆ’ Î›j
yi âˆ’ yj

=
=

Î›j âˆ’ Î›k
yj âˆ’ yk
Î›k âˆ’ Î›i
yk âˆ’ yi

(24)
(25)

Notice that the left-hand side of both equations potentially depend on yi and yj but the right-hand
side of equation (24) does not depend on yi and the right-hand side of equation (25) does not depend
on yj . Since there are at least four goods (by assumption) and the expenditure share of these other
goods vary with prices for a given Î›, we obtain that equations (24) and (25) hold for a neighborhood
of yi , yj and yk (these can vary over that neighborhood while holding Î› constant).
 âˆ’Î›j
Denote by f (Î›) = Î›i
the left-hand side of equations (24) and (25).
yi âˆ’yj
Picking any good h instead of k, equation (23) also applies and yields:
Î›j (yj , Î›) âˆ’ Î›k (yh , Î›) = f (Î›) (yj (yj , Î›) âˆ’ yh (yh , Î›))

(26)

Given that there are at least four goods, this should hold over a non-trivial range of yh (same argument
as above). Taking the derivative w.r.t. yh , we get:
âˆ‚yh
âˆ‚Î›h
= f (Î›)
âˆ‚ log yh
âˆ‚ log yh

(27)

Given the symmetry of the cross-derivative (we assume that demand is twice differentiable), this can
be rewritten:
âˆ‚yh
âˆ‚yh
= f (Î›)
(28)
âˆ‚ log Î›
âˆ‚ log yh
By continuity, the conditions required for this equation hold over a neighborhood of Î›. Take
R reference

Î›
Î›0 and consider the function: M (y, Î›) = yh (y, Î›) âˆ’ yh (yF (Î›), Î›0 ) where F (Î›) = exp Î›0 f (t) dtt .
Note that F (Î›0 ) = 1 hence M (y, Î›0 ) = 0. For other Î›, we obtain:
âˆ‚M
âˆ‚ log Î›

=

âˆ‚yh (y, Î›)
âˆ‚ log F âˆ‚yh (yF (Î›), Î›0 )
âˆ’
âˆ‚ log Î›
âˆ‚ log Î›
âˆ‚ log yh

23

=
=

âˆ‚yh (yF (Î›), Î›0 )
âˆ‚yh (y, Î›)
âˆ’ f (Î›)
âˆ‚ log Î›
âˆ‚ log yh
0

Hence, M (y, Î›) = 0 over the neighborhood where equation (28) holds. This implies:
yh (yh , Î›) = yk (yh F (Î›), Î›0 )
Now, for a given reference point y âˆ— and Î›0 , let us construct Di as:
"Z
Dh (yh ) = Wi (yhâˆ— , Î›0 ) exp

#

yh

âˆ—
yh

yh (y, Î›0 )dy

Integrating over y from a reference point y âˆ— in the region where this equality holds, we obtain that
demand can be written as:
#
"Z
yh
dy
âˆ—
yh (y, Î›)
Wh (yh , Î›) = Wh (yh , Î›) exp
âˆ—
y
yh
#
"Z
yh
dy
= Wh (yhâˆ— , Î›) exp
yh (yF (Î›), Î›0 )
âˆ—
y
yh
"Z
#
yh F (Î›)
dy
yh (y, Î›0 )
= Wh (yhâˆ— , Î›) exp
âˆ— F (Î›)
y
yh
= Wh (yhâˆ— , Î›) .

Dh (yh F (Î›))
Dh (yhâˆ— F (Î›))

= Hh (Î›) Dh (yh F (Î›))
where Hh is a function of Î› defined as:
Hh (Î›) â‰¡

Dh (yhâˆ— F (Î›))
Wh (yhâˆ— , Î›)
D (y âˆ— F (Î› ))

D (y âˆ— )

0
h h
h h
for which, by definition of Dh , we have: Hh (Î›0 ) = W
= Wh (y
= 1.
âˆ—
âˆ—
h (yh ,Î›0 )
h ,Î›0 )
Examining elasticities w.r.t. prices and Î›, we can then show that Hh is in fact identical across
goods. To check this, with Wh (yh , Î›) = Dh (yh F (Î›))/Hi (Î›), we have:

yh = Dh
where Dh denotes the elasticity of Dh , while the elasticity in Î› is:
Î›h = f (Î›) Dh âˆ’ Hh
where Hh denotes the elasticity of Hh in Î›. Thanks for condition (26), we obtain that for any two
goods h and k:
Hk âˆ’ Hh = Î›h âˆ’ Î›k âˆ’ f (Î›) (Dh âˆ’ Dk )
= Î›h âˆ’ Î›k âˆ’ f (Î›) (yh âˆ’ yk )
= 0

24

This implies that Hh (Î›) and Hk (Î›) remain proportional for any two goods k and h. Given that
Hh (Î›0 ) = Hk (Î›0 ) = 1, Hh must be identical across all goods h.
Hence, demand in case 1 can be written for any good h as:
Wh (yh , Î›) = Dh (yh F (Î›)) / H(Î›)

Combinations of cases: Locally, for a given Î› and around it, one must be in one of these three
cases. A remaining question is whether demand can be a mixture of these three cases as Î› varies.
To finish the proof of Proposition 1, we show that we cannot combine case 2 with cases 1A and 1B.
Hence the functional form of case 2 needs to hold globally across all Î›â€™s, while we can potentially have
a combination of 1A and 1B across Î›.

Combination of cases 2+1A Here we show that we cannot have a combination of cases 1A and 2
globally. First, note that for a given Î›, case 1 and 2 are mutually exclusive by definition. Hence, if
we have a mixture of cases 1 and 2, it must occurs along different Î›â€™s. By contradiction, suppose that
there exists Î›âˆ— such that, at least locally,
Wi (yi , Î›) = Di (F (Î›)yi ) / H(Î›)
1âˆ’Ïƒ(Î›)

Wi (yi , Î›) = Ai (Î›)yi

if Î› < Î›âˆ—
if Î› > Î›âˆ—

By continuity, at the limit where Î› = Î›âˆ— , we must have:
âˆ‚ log Di (F (Î›âˆ— )y)
= 1 âˆ’ Ïƒ(Î›âˆ— )
âˆ‚ log y
Since it must hold for any i and any y, it implies that F âˆ— (y) = 0 and that 1 âˆ’ Ïƒ(Î›âˆ— ) = 0, which
contradicts our assumption that Wi (yi , Î›) is not locally constant across yi for any given Î›.
Combinations of cases 1+2B Here we show that we cannot have a combination of cases 1B and
2 globally, using the same arguments as above. Note again that for a given Î›, case 1B and 2 are
mutually exclusive by definition. Hence, if we have a mixture of cases 1B and 2, it must occurs along
different Î›â€™s.
By contradiction, suppose that there exists Î›âˆ— such that, at least locally, such that for all but one
good we have:
Wi (yi , Î›) = Di (F (Î›)yk )/H(Î›)

if Î› < Î›âˆ—

Wi (yi , Î›) = Î›âˆ’Ï Ai yi1âˆ’Ïƒ

if Î› > Î›âˆ—

Again, by continuity, at the limit where Î› = Î›âˆ— , we must have:
âˆ‚ log Di (F (Î›âˆ— )y)
=1âˆ’Ïƒ
âˆ‚ log y
Since it must hold for any i and any y, it implies that either demand is CES or F âˆ— (y) = 0 and that
1 âˆ’ Ïƒ(Î›âˆ— ) = 0. This contradicts the assumption that Wi (yi , Î›) is not locally constant across yi for any
given Î›.

25

Proof of Proposition 3
e (q, z) as:
Define U
e (q, z) =
U

X

Z

z

ui (H(z)qi ) âˆ’

F (z)H 0 (z)dz

z0

i

where:

Z

qi

ui (qi ) =
q=0

Diâˆ’1 (x)dx

and u0i = Diâˆ’1 . Recall that Di is strictly decreasing unless Di = 0. As noted in the text, as an
abuse of notation, we define Diâˆ’1 (0) = ai if Di (y) = 0 for all y â‰¥ ai (which yields a choke price) and
Diâˆ’1 (x) = 0 for all x â‰¥ bi if Di (0) = bi .
In turn, we want to define z as an implicit function of q such that:
X
F (z) =
qi u0i (H(z)qi )
(29)
i

We proceed in three steps. First we show that equation (29) admits a solution z(q) for each q and
e (q, z(q)) is well-behaved
that this solution is unique. Second we show that utility defined as U (q) = U
and quasi-concave. Finally, we show that maximizing U leads to the demand function in the text, and
that the single aggregator Î› is also well defined.

Step 1: Implicit function z(q). Here we show that for any vector q of consumption, there is a
z such that equation (29) holds.
With restrictions [A1] iii), we have assumed that for each good i and each yi , there is a Î› such
that Di (F (Î›)yi )/H(Î›) is arbitrarily small. Take yi = 1/(N qi ) where N denotes the number of goods.
For each i, there is a z such that:
Di (F (z)/(N qi ))/H(z) < qi
Since the left-hand side decreases with z (this is implied by restriction [A1]-ii), we can take the
maximum z of all zi â€™s such that it holds for all goods i with a common z. This inequality is equivalent
to:
Di (F (z)/(N qi )) < H(z)qi
â‡”
â‡”

F (z)/(N qi )) > u0i (H(z)qi )
F (z)/N

> qi u0i (H(z)qi )

Going from the first to second inequality above is guaranteed by the assumption that Di decreases
strictly. Adding across all goods (given that qi u0i is positive for all goods), we obtain that for each
vector q there exists a z such that:
X
F (z) >
qi u0i (H(z)qi )
i

Next, with restrictions [A1] iii), we have also assumed that there is at least one good i such that, for
each yi , there is a Î› such that yi Di (F (Î›)yi )/H(Î›) is larger than 1. Taking yi = 1/qi , there is a z = Î›

26

such that:
(1/qi )Di (F (z)/qi )/H(z) > 1
â‡” Di (F (z)/qi ) > H(z)qi
â‡” F (z)/(N qi )) < u0i (H(z)qi )
F (z) < qi u0i (H(z)qi )

â‡”
Hence, summing across goods, we also have:
F (z) <

X

qi u0i (H(z)qi )

i

P
0
We havePshown that for each q there is a z such that F (z) >
i qi ui (H(z)qi ) and a z such that
0
F (z) < i qi ui (H(z)qi ). By continuity, we conclude that equation (29) has a solution.
Then, using part ii) of restrictions [A1], we can see that Di (F (Î›)yi )/H(Î›) strictly decreases
with Î›. This implies
qi u0i (H(z)qi ) also strictly decreases with z, and that the right-hand side
P that
0
of equation (29),
i qi ui (H(z)qi ), decreases faster (or increases slower) than the left-hand side of
equation (29), F (z). Hence the solution to equation (29) is unique.

Step 2: Quasi-concavity. The second step is to show that utility defined as U (q) = Ue (q, z(q))
is quasi-concave. First, we need to get the first and second derivatives.

Derivatives in z. Here we consider the properties of z = z(q), the solution of equation (29).
Taking the derivative of equation (29), we get:
"
#
X
âˆ‚z
0
0
2 00
F âˆ’H
qi ui = u0i + Hqi u00i
âˆ‚qi
i

and thus:

with âˆ† â‰¡ F 0 âˆ’ H 0

u0 + Hqi u00i
âˆ‚z
= i
âˆ‚qi
âˆ†
2 00
i qi ui .

P

Showing that âˆ† is positive. Note that
âˆ† = F 0 âˆ’ H0

u0i
00
ui Hqi

X

= ÎµDi and thus:

qi2 u00i

i

P


Hqi2 u00i
i
= (F/z) ÎµF âˆ’ ÎµH P
qi u0
P i 0 i


qi u (1/ÎµDi )
= (F/z) ÎµF âˆ’ ÎµH i P i 0
i qi ui
We can see that, if ÎµDi < 0 and ÎµF ÎµDi < ÎµH for all i, then ÎµF âˆ’ ÎµH (1/ÎµDi ) > 0 for all i and we always
have âˆ† > 0.
This implies that the derivatives of z are always well defined, and knowing âˆ† > 0 will be useful
below.

27

Derivatives in U. First derivatives:
âˆ‚U
âˆ‚qi

âˆ‚z
= H u0i (Hqi ) +
âˆ‚qi

"

#
H0

X

qi u0i (Hqi ) âˆ’ H 0 F

= H u0i (Hqi )

i

Second derivatives:
âˆ‚2U
âˆ‚qi2
âˆ‚2U
âˆ‚qi âˆ‚qj

=

âˆ‚z
(u0 + Hqi u00i )H 0 + H 2 u00i
âˆ‚qi i

=

âˆ‚z
(u0 + Hqi u00i )H 0
âˆ‚qj i

and thus, incorporating the derivatives in z:
âˆ‚2U
âˆ‚qi2
âˆ‚2U
âˆ‚qi âˆ‚qj

= (u0i + Hqi u00i )2 H 0 /âˆ† + H 2 u00i
= (u0i + Hqi u00i ) (u0j + Hqj u00j ) H 0 /âˆ†

Negative semi-definiteness. To show that utility is quasi-convex, we need to show that the
bordered Hessian is negative semi-definite, i.e we need to show:
X
i,j

!2

âˆ‚2U
=
ti tj
âˆ‚qi âˆ‚qj

X

ti (u0i

+

Hqi u00i )

H 0 /âˆ† +

i

for any ti such that:

X

t2i H 2 u00i < 0

i

X
X âˆ‚U
=
ti Hu0i = 0
ti
âˆ‚qi
i

i

P
The objective function above is homogeneous of degree 2. We can renormalize the sum i ti (u0i +
Hqi u00i ) up to any constant without loss of generalization.
First step is to find the optimal vector of ti â€™s that maximizes the left-hand side of the inequality
above. It is equivalent to consider the maximization:
(
)
X
max
t2i u00i
i

P
under the constraint: i ti (u0i + Hqi u00i ) = constant and i ti u0i = 0.
This leads to ti proportional to:
u0i
ti âˆ¼
+ Âµqi
Hu00i
P

(and second-order condition is fine, objective function is concave since u00i < 0 for all i). Given that
P
P u02
P
we must have 0 = i ti u0i = i Hui 00 + Âµ i qi u0i , Âµ must be:
i

u02
i
i Hu00
i
âˆ’P
0
q
u
i
i
i

P

Âµ =

28

0

ui
0
i qi ui qi Hu00
i
âˆ’ P
0
q
u
i
P i0 i
i qi ui ÎµDi
âˆ’ P
0
i qi ui

P

=
=

= âˆ’ÎµÌ„D
where ÎµDi =

u0i
qi Hu00
i

and ÎµÌ„D is its weighted average.

Next, using the optimal ti =
negative semi-definiteness is:

u0i
Hu00
i

âˆ’ ÎµÌ„D qi = qi ÎµDi âˆ’ qi ÎµÌ„D , a sufficient and necessary condition for
!2

X

(qi ÎµDi âˆ’ qi ÎµÌ„D )(u0i + qi Hu00i )

H 0 /âˆ† + H 2

X

(qi ÎµDi âˆ’ qi ÎµÌ„D )2 u00i < 0

i

i

Since âˆ† > 0, this condition can be rewritten:
!2
X

(qi ÎµDi âˆ’ qi ÎµÌ„D )(u0i + qi Hu00i )

H0 < âˆ’ H2 âˆ†

i

X

(qi ÎµDi âˆ’ qi ÎµÌ„D )2 u00i

i

!2
â‡”

X

qi u0i âˆ’ ÎµÌ„D H

X

i

qi2 u00i

H0 < âˆ’ H2 âˆ†

i

X

(qi ÎµDi âˆ’ qi ÎµÌ„D )2 u00i

i

!2
â‡”

X

qi u0i âˆ’ ÎµÌ„D H

X

i

qi2 u00i

!
H0 < âˆ’ H âˆ†

âˆ’ÎµÌ„D

X

i

qi u0i + ÎµÌ„2D H

X

qi2 u00i

i

i

!2
â‡”

X

qi u0i

âˆ’ ÎµÌ„D H

X

i

Note that

P

qi2 u00i

!
H

0

<

ÎµÌ„D H âˆ†

X

i

0
i qi ui

âˆ’ ÎµÌ„D H

2 00
i qi ui

P

qi u0i

âˆ’ ÎµÌ„D H

i

X

qi2 u00i

i



is negative (unless all price elasticities ÎµDi are identical):
P
P
0
X
X
qi u0i (âˆ’ÎµDi )
0
2 00
iP
i qi ui
qi ui âˆ’ ÎµÌ„D H
qi ui < 0 â‡â‡’ P
<
0
1
0
i qi ui
i qi ui (âˆ’ÎµDi )
i
i

(In the second inequality, the left hand side corresponds to a harmonic average while the right-handside corresponds P
to an arithmetic
P0).
P average of a positive variable âˆ’ÎµDi >
Hence, using i qi u0i âˆ’ ÎµÌ„D H i qi2 u00i < 0 and also that âˆ† â‰¡ F 0 âˆ’H 0 i qi2 u00i the previous inequality
is equivalent to:
!
X
X
â‡” H0
qi u0i âˆ’ ÎµÌ„D H
qi2 u00i > ÎµÌ„D H âˆ†
i

i

!
â‡”
â‡”

H

0

H

0

X

qi u0i

âˆ’ ÎµÌ„D H

X

i

i

X

0

qi u0i

> ÎµÌ„D H F

qi2 u00i

!
> ÎµÌ„D H

0

F âˆ’H

0

X
i

i

29

qi2 u00i

Given that F =

0
i qi ui ,

P

this gives:
â‡”

H 0 F > ÎµÌ„D H F 0

â‡”

ÎµÌ„D ÎµF < ÎµH

This holds, given that ÎµDi ÎµF < ÎµH is assumed in part ii) of restrictions [A1] for each good i.

Step 3: Marshallian
demand and price aggregator. Maximizing U (q) under the budget
P
constraint

i p i qi

= w leads to:

âˆ‚U
= H(z) u0i (H(z)qi ) = Âµpi
âˆ‚qi
where Âµ henceforth denotes the Lagrange multiplier associated with the budget constraint. Summing
across goods, we can see that Âµ is such that:
Âµ =

1X
H(z)F (z)
1X
H qi u0i (Hqi ) =
Âµpi qi =
w
w
w
i

(note that it only depends on quantities and prices through z). Using H(z) u0i (H(z)qi ) = Âµpi , we
obtain:
Âµpi
F (z)pi
u0i (H(z)qi ) =
=
H(z)
w
and thus, given the definition of u0i :
H(z)qi = Di (Âµpi /H(z)) = Di (F (z)pi /w)
and:
qi = Di (F (z)pi /w)/H(z)
The final step is to show that z can be written as z = Î› where Î› is implicitly defined as a function of
all normalized prices pi /w.
To see this, notice that qi must satisfy the budget constraint:
X
X
w=
qi p i =
pi Di (F (z)pi /w)/H(z)
i

i

which can be rewritten:
H(z) =

X

(pi /w)Di (F (z)pi /w)

i

This equation in z has a unique solution, which we denote Î› and is a function of all pi /w:
- To prove uniqueness, we use restriction [A1] part ii) which implies that Di (F (z)pi /w)/H(z) is
strictly decreasing in z. Hence the right-hand side of the equation above decreases strictly faster
with z (or increases strictly slower) than the left-hand side.
- To prove existence (for a given set of prices and income), we use restriction [A1] part iii) which
assumes that Di (F (z)pi /w)/H(z) can be arbitrarily small and that there is at least one good
for which Di (F (z)pi /w)/H(z) is larger for unityP
for some z. By continuity, there must be at
least one solution Î› = z to the equation H(z) = i (pi /w)Di (F (z)pi /w).

30

Alternative proof of Proposition 3 using the Slutsky Matrix
An alternative proof of proposition 3 is to show that the Slutsky matrix is symmetric and negative
semi-definite, and then apply Hurwicz and Uzawa (1971) theorem. We have already proved symmetry
in Proposition 1 but semi-definitiveness is yet to be checked. Consider the demand system:
qi = Di (F (Î›)pi /w) / H(Î›)
(30)
P
where Î› is implicitly determined by the budget constraint i pi Di (Î›pi /w) / H(Î›) = w, which can be
rewritten:
X
(pi /w)Di (F (Î›)pi /w) / H(Î›) = 1
(31)
i

Slutsky substitution coefficients. For i 6= j, the Slutsky term is:
sij

=
=

where ÎµÌ„D =

P

i (pi qi /w)ÎµDi

and ÎµDi =

âˆ‚qi
âˆ‚qi
+ qj
âˆ‚pj
âˆ‚w


âˆ‚qi âˆ‚Î›
ÎµDi
âˆ‚Î›
âˆ’ qi qj
+ qj
âˆ‚Î› âˆ‚pj
âˆ‚w
w
âˆ‚ log Di
âˆ‚ log x .

The first term is:

âˆ‚qi
qi (ÎµF ÎµDi âˆ’ ÎµH )
=
âˆ‚Î›
Î›
Then, we get the derivative of Î› w.r.t. pj and w. From:
X
(pi /w)Di (F (Î›)pi /w) / H(Î›) = 1

(32)

i

we get:
1 + ÎµDj
âˆ‚ log Î›
= âˆ’(pj qj /w)
âˆ‚ log pj
ÎµF ÎµÌ„D âˆ’ ÎµH
1 + ÎµÌ„D
âˆ‚ log Î›
=
âˆ‚ log w
ÎµF ÎµÌ„D âˆ’ ÎµH
Hence we obtain:
sij

=
=
=



1 + ÎµDj
qi (ÎµF ÎµDi âˆ’ ÎµH )
1 + ÎµÌ„D
ÎµDi
. Î› âˆ’(qj /w)
+ (qj /w)
âˆ’ qi qj
Î›
ÎµF ÎµÌ„ âˆ’ ÎµH
ÎµF ÎµÌ„D âˆ’ ÎµH
w
qi qj (ÎµF ÎµDi âˆ’ ÎµH )(ÎµÌ„ âˆ’ ÎµDj )
ÎµDi
.
âˆ’ qi qj
w
ÎµF ÎµÌ„D âˆ’ ÎµH
w
ÎµDj + ÎµDi âˆ’ ÎµÌ„
qi qj ÎµF (ÎµDi âˆ’ ÎµÌ„D )(ÎµDj âˆ’ ÎµÌ„D )
âˆ’
.
âˆ’ qi qj
w
ÎµF ÎµÌ„D âˆ’ ÎµH
w

which is symmetric in i and j.
P
When ÎµF 6= 0, denote Î¸i = ÎµH âˆ’ ÎµF ÎµDi , which is positive by assumption, and Î¸Ì„ = i (pi qi /w)Î¸i its

31

weighted average across goods. It is more convenient to write the Slutsky substitution coefficient as:
sij

=
=


qi qj (Î¸i âˆ’ Î¸Ì„)(Î¸j âˆ’ Î¸Ì„)
qi qj 
+
.
Î¸j + Î¸i âˆ’ Î¸Ì„ âˆ’ ÎµH
w
ÎµF w
ÎµF Î¸Ì„
qi qj Î¸ i Î¸ j
q i q j ÎµH
.
âˆ’
w
w ÎµF
ÎµF Î¸Ì„

In turn, the diagonal coefficients of the Slutsky matrix are:
sii =
=

q2 Î¸2
qi ÎµDi
âˆ’ i . i âˆ’
pi
w ÎµF Î¸Ì„
qi (Î¸i âˆ’ ÎµH )
q2
âˆ’
âˆ’ i .
p i ÎµF
w

qi2 ÎµH
w ÎµF
q 2 ÎµH
Î¸i2
âˆ’ i
w ÎµF
ÎµF Î¸Ì„

Is the Slutsky matrix negative semi-definite? Denote wi = pi qi /w expenditure shares, we
obtain:
wi wj Î¸ i Î¸ j
ÎµH
P
âˆ’ wi wj
ÎµF k w k Î¸ k
ÎµF
wi (Î¸i âˆ’ ÎµH )
ÎµH
w2 Î¸2
Pi i
sii . p2i /w = âˆ’
âˆ’ wi2
+
ÎµF
ÎµF k w k Î¸ k
ÎµF

sij . pi pj /w =

In order to show that the Slutsky matrix is negative semi-definite, we need to show that for any
vector x we have:
X
sij xi xj â‰¤ 0
ij

âˆš
Normalizing the xâ€™s by pi / w, this is equivalent to showing the following inequality:
 
X  Î¸ i âˆ’ ÎµH 
X
X wi x i wj x j Î¸ i Î¸ j
ÎµH
2
P
âˆ’
wi
âˆ’
xi +
wi wj x i x j
â‰¤ 0
ÎµF
ÎµF
i wi Î¸ i
i

i,j

i,j

"P
"
#
#
P
2
X
2
2
X
(
w
Î¸
x
)
w
Î¸
w
Î¸
x
Îµ
i
i
i
i
i
i
i
H
i
i
P
â‡â‡’ âˆ’ i
âˆ’ Pi
+
wi x2i âˆ’
wi x i
â‰¤ 0
ÎµF
ÎµF
( i wi Î¸i )2
i wi Î¸ i
i
i
"P
#
"
#
P
2
X
2
2
X
w
Î¸
x
(
w
Î¸
x
)
1
Îµ
i
i
i
i
i
H
i
i
P
P
âˆ’ Pi
+
wi x2i âˆ’
wi x i
â‰¤ 0
â‡â‡’ âˆ’
2
ÎµF
w
Î¸
Îµ
w
Î¸
(
w
Î¸
)
i
i
i
i
F
i
i
i
i
i
P

i

i

The terms in brackets can be interpreted as variances and are positive. We need to distinguish three
cases depending on the sign of ÎµH and ÎµF :
â€¢ First, if ÎµF > 0 and ÎµH â‰¤ 0 (and Î¸i > 0), each term of the sum is negative, the sum is negative
and the Slutsky matrix is semi-definite negative.
â€¢ If ÎµF > 0 and ÎµH > 0, note that Î¸i = ÎµH âˆ’ ÎµF ÎµDi is then larger than ÎµH given that ÎµDi is
assumed to be negative. With ÎµF > 0, the inequality above is then equivalent to:
"P
#
"
#
P
2
X
2
2
X
w
Î¸
x
(
w
Î¸
x
)
Îµ
i
i
i
i
i
H
2
i
i
P
â‡â‡’
âˆ’ Pi
âˆ’ P
wi x i âˆ’
wi xi
â‰¥ 0
( i wi Î¸ i ) 2
i wi Î¸ i
i wi Î¸ i
i

32

i

The proof then relies on Lemma 5, an auxiliary result from Matsuyama and Uchshev (2017).
In this case, denote ai = PÎ¸iwwji Î¸j , bi = wi and Î³ = P ÎµH
. Since Î¸i > ÎµH for each i, we have
j
i wi Î¸i
ai > Î³bi for each i. We obtain the result that we want by applying Lemma 5, which implies the
inequality above.
â€¢ Finally, if ÎµF < 0, note that ÎµH > Î¸i and ÎµH > 0 given that ÎµDi is negative by assumption, and
given that Î¸i = ÎµH âˆ’ ÎµF ÎµDi is positive by assumption. With ÎµF < 0, the inequality above is
then equivalent to:
"
#
"P
#
P
P
2
X
2
2
X
w
Î¸
w
Î¸
x
(
w
Î¸
x
)
i
i
i
i
i
i
i
i
i
i
P
â‡â‡’
âˆ’
wi x2i âˆ’
wi x i
â‰¥ 0
âˆ’ Pi
ÎµH
w
Î¸
( i wi Î¸i )2
i
i
i
i

i

P

wÎ¸

The proof again relies on Lemma 5. In this case, denote ai = wi , bi = PÎ¸iwwji Î¸j , and Î³ = iÎµHi i .
j
Since Î¸i < ÎµH for each i, we obtain again that ai > Î³bi for these new ai and bi . Lemma 5 then
implies the inequality above.
This finishes the proof that the Slutsky matrix is negative semi-definite when ÎµF 6= 0.
What happens when ÎµF = 0? When ÎµF = 0, then ÎµH > 0 by assumption, and we have instead:
q i ÎµH
âˆ‚qi
=âˆ’
âˆ‚Î›
Î›

1 + ÎµDj
âˆ‚ log Î›
= (pj qj /w)
âˆ‚ log pj
ÎµH

;

âˆ‚ log Î›
1 + ÎµÌ„
= âˆ’
âˆ‚ log w
ÎµH

;

Hence we obtain:
sij

=



1 + ÎµDj
q i ÎµH
1 + ÎµÌ„
ÎµDi
. Î› âˆ’(qj /w)
+ (qj /w)
âˆ’ qi qj
Î›
ÎµH
ÎµH
w

and thus the Slutsky substitution coefficients are:
sij

âˆ’ qi qj

=

qi ÎµDi
pi

sii =

ÎµDj + ÎµDi âˆ’ ÎµÌ„
w
2 2ÎµDi âˆ’ ÎµÌ„
âˆ’ qi
w

Is the Slutsky matrix negative semi-definite in the special case where ÎµF = 0? As before, we need:
X
X
wi x2i ÎµDi âˆ’
wi wj xi xj (ÎµDj + ÎµDi âˆ’ ÎµÌ„) â‰¤ 0
i

i,j

where wi denotes the consumption share in good i.
This statement is successively equivalent to:
X
X
X
â‡â‡’
wi x2i ÎµDi âˆ’ 2
wi wj xi xj ÎµDj + ÎµÌ„(
wi xi )2 â‰¤ 0
i

â‡â‡’

X
i

i,j

wi x2i ÎµDi

âˆ’ 2(

X
i

i

wi xi )(

X

wi xi ÎµDj ) + (

i

X
i

wi ÎµDj )(

X

wi x i ) 2 â‰¤ 0

i

P
P
P
X
2( i wi xi )( i wi xi ÎµDj )
wi x2i ÎµDi
i
P
âˆ’
+(
wi xi )2 â‰¥ 0
â‡â‡’ P
w
Îµ
w
Îµ
i i Dj
i i Dj
i

33



P
2
P
P
2+(
w
Îµ
x
w
x
)
i
i i Di
j j j
2( i wi xi )( i wi xi ÎµDj )
P
P
â‡â‡’
â‰¥
i wi ÎµDj
i wi ÎµDj


2
P
P
P
P
P
P
2 i wi ÎµDi xi ( j wj xj )
i wi ÎµDi xi âˆ’ (
j wj x j )
2( i wi xi )( i wi xi ÎµDj )
P
P
P
â‡â‡’
+
â‰¥
i wi ÎµDj
i wi ÎµDj
i wi ÎµDj


2
P
P
i wi ÎµDi xi âˆ’ (
j wj x j )
P
â‰¥ 0
â‡â‡’
i wi ÎµDj
P

which is satisfied if all the ÎµDj are negative.

Lemma 5 (Matsuyama
2017) Suppose that ai > Î³bi > 0 for all i âˆˆ {1, ..., N } where Î³ is a
P
P Ushchev,
positive scalar and i ai = i bi = 1. Define A = diag{a1 , ..., an } âˆ’ aaT and B = diag{b1 , ..., bn } âˆ’
bbT , two (positive semi-definite) matrices. We obtain that the matrix M:
M = A âˆ’ Î³B
is positive semi-definite.
Proof of Lemma 5: This lemma is from Matsuyama and Ushchev (2017) which I report here again
for convenience (see last part of the proof of Proposition 1 of Matsuyama and Ushchev 2017).
One needs to show that, for each vector t of the

RN + with components ti â‰¥ 0,

i âˆˆ {1, ..., N }:

tT A t âˆ’ Î³ . tT B t â‰¥ 0
Denote
TP
a and Tb the random variables such that: P rob{Ta = ti } = ai and P rob{Tb = ti } = bi . Since
P
a
=
i bi = 1, one can write each term above as a variance:
i i
!2
T

t At =

X

ai t2i

âˆ’

X

i

i

X

X

ai ti

= V ar(Ta )

!2
tT B t =

bi t2i âˆ’

i

bi ti

= V ar(Tb )

i

Note that V ar(Tb ) > 0 unless ti = tj for all i, j, in which case we also have V ar(Ta ) = 0 and thus
tT A t âˆ’ Î³ . tT B t = 0. Since V ar(Tb ) is homogeneous of degree two and strictly positive aside from the
case above, we can focus on tâ€™s such that tT B t = 1. Under this assumption, we need to show that:
tT A t â‰¥ Î³
Consider the maximization:
max tT A t
t

s.t.

tT B t = 1

The maximum is attained when Atâˆ—i = Î›âˆ— Btâˆ— where Î›âˆ— is the minimum value of the objective function,
which can also be written:




âˆ—
âˆ—
âˆ—
âˆ—
âˆ—
ai ti âˆ’ E[Ta ] = Î› bi ti âˆ’ E[Tb ]
(33)

34

where E[Tx ] refers to the expectation of Tx .
The goal is to show that Î›âˆ— > Î³. To prove this claim by contradiction, suppose that Î›âˆ— < Î³.
Given that ai > Î³bi , we also have ai > Î›âˆ— bi .
If E[Ta ] â‰¤ E[Tb ], we can see that:
max ti âˆ’ E[Ta ] â‰¥ max ti âˆ’ E[Tb ] > 0
hence equation (33) cannot hold for i = arg max tj .
If E[Ta ] > E[Tb ], we can see that:
min ti âˆ’ E[Ta ] < min ti âˆ’ E[Tb ] < 0
hence, again, equation (33) cannot hold for i = arg min tj . This yields a contradiction and concludes
the proof of Lemma 5.

35

Proof of Proposition 4
Suppose that demand can be written:
qi = Gi (Î›)1âˆ’Ïƒ(Î›) (pi /w)âˆ’Ïƒ(Î›)
P
with Î› implicitly defined by i [Gi (Î›)pi /w]1âˆ’Ïƒ(Î›) = 1.
The goal is to to show that these equations:
"

#

1
1âˆ’Ïƒ(Î›)

X
(Gi (Î›) pi /w)1âˆ’Ïƒ(Î›)

= 1

(34)

= 1

(35)

i

"
X

(Gi (U )/qi )

1âˆ’Ïƒ(U )
Ïƒ(U )

#

Ïƒ(U )
1âˆ’Ïƒ(U )

i

have a unique solution in Î› and U respectively. To do so, we show that the left-hand side of each of
these equations strictly increase in Î› and U around the solution, showing that the left-hand side can
be equal to unity only once.
We distinguish two cases, depending on whether elasticity Ïƒ(Î›) increases with Î›. If the first case
we assume that Gi (Î›) strictly increases with Î›. In the second case, we impose condition ii).
1) In the first case, suppose that Ïƒ(Î›) increases with Î› and that Gi (Î›) strictly increases with Î›.
The equation above in Î› is equivalent to:
X
(Gi (Î›) pi /w)1âˆ’Ïƒ(Î›) = 1
i

If Ïƒ(Î›) âˆˆ (0, 1), each term Gi (Î›) pi /w in the summation increases in Î› and has to be smaller than
unity. Hence, if 1 âˆ’ Ïƒ(Î›) decreases with Î›, the left-hand side of this expression is strictly increasing
1
with Î›. The same holds if we raise the whole expression on the left-hand side to the power 1âˆ’Ïƒ(Î›)
.
If Ïƒ(Î›) > 1, each term Gi (Î›) pi /w in the summation increases in Î› and has to be larger than unity.
Hence, if 1 âˆ’ Ïƒ(Î›) decreases with Î› (i.e. becomes more positive), the left-hand side of this expression
is strictly decreasing in Î›. The inverse holds if we raise the whole expression on the left-hand side to
1
the power 1âˆ’Ïƒ(Î›)
< 0.
Now consider the equation:
 1âˆ’Ïƒ(U )
X
Ïƒ(U )
Gi (U )/qi
=1
i
1âˆ’Ïƒ(U )
Ïƒ(U )

If Ïƒ(Î›) âˆˆ (0, 1), the exponent
is positive and decreases with U . The term within parenthesis
increases in U . Moreover, each summation term has to be smaller than unity. Hence, as U increases,
each summation term increases (strictly) with U . The same holds if we raise the whole expression on
Ïƒ(U )
the left-hand side to the power 1âˆ’Ïƒ(U
).
)
If Ïƒ(Î›) > 1, the exponent 1âˆ’Ïƒ(U
Ïƒ(U ) is negative and decreases with U . The term within parenthesis
increases in U . Moreover, each summation term has to be larger than unity. Hence, as U increases,
each summation term decreases (strictly) with U . If we raise the whole expression on the left-hand
Ïƒ(U )
side to the power 1âˆ’Ïƒ(U
) , we obtain a strictly increasing function of U .

36

2) In the second case, we assume that Ïƒ(Î›) decreases with Î› and that, around each solution Î›0 of
âˆ’ 1
P
equation (34), there exists a set of Î±i such that i Î±i = 1 and such that Gi (Î›)Î±i 1âˆ’Ïƒ(Î›) increases in
Î›.
1
âˆ’ 1âˆ’Ïƒ(Î›)

Define Ki (Î›) = Gi (Î›)Î±i

The left-hand side of equation (34) can then be rewritten:

"
X

#

1
1âˆ’Ïƒ(Î›)

Î±i (Ki (Î›) pi /w)1âˆ’Ïƒ(Î›)

i

To show that it strictly increases in Î›, we use Lemma 6 discussed in the next appendix section. We
obtain that the left-hand side of the above equation decreases with Ïƒ, which itself decreases with Î›.
Moreover, the term Ki (Î›) strictly increases in Î›, by assumption, hence the whole left term strictly
increases with Î›.
We can again use the same approach to show that the left-hand side of (35) increases strictly with
U . This is equivalent to showing that the following expression strictly increases in U :
"
X



Î±i Ki (U )/qi

 1âˆ’Ïƒ(U )

#

Ïƒ(U )
1âˆ’Ïƒ(U )

Ïƒ(U )

i
)
Each exponent 1âˆ’Ïƒ(U
Ïƒ(U ) increases in U and each term Ki (U ) strictly increases with U . With Lemma 6
again, we obtain that the whole term strictly increases with U .

Hence, in both cases, Î› and U are well defined by equations (34) and (35) which admit no more
than one solution. This implicitly defines utility U as a function of qi . It is straightforward to see that
such utility function is quasi-concave in q: indifference curves have the same shape as CES indifference
curves, holding Ïƒ = Ïƒ(U ) constant.
Consumption quantities q chosen to maximize U would satisfy the following first-order conditions:
Ïƒ(U )âˆ’1
(Ïƒ(U ) âˆ’ 1)  qi  Ïƒ(U )
= Âµpi
qi Ïƒ(U )
Gi (U )

where Âµ is a constant term (combination of the Lagrange multiplier associated with the equation in U
)âˆ’1)Âµ
has to equal 1/w.
and the budget constraint multiplier). To satisfy the budget constraint, (Ïƒ(U
Ïƒ(U )
Ïƒ(U
)âˆ’1


Ïƒ(U )
i
In other words, Giq(U
corresponds to the budget share of good i in consumption baskets:
)


This leads to the demand qi :

qi 
Gi (U )

Ïƒ(U )âˆ’1
Ïƒ(U )

=

(Ïƒ(U ) âˆ’ 1)Âµ
p i qi
pi qi =
Ïƒ(U )
w

qi = Gi (U )1âˆ’Ïƒ(U ) (pi /w)âˆ’Ïƒ(U )

which is the same expression as above, with Î› corresponding to utility. Moreover, we can see that
)âˆ’1
P  i  Ïƒ(U
Ïƒ(U )
utility U is such that i Giq(U
= 1 which, using the demand for qi just above, can be written
)
as:
X
[Gi (U )pi /w]1âˆ’Ïƒ(U ) = 1
i

37

which is the same equation as the one determining Î›, which proves that Î› = U .

Proof of equivalence between condition ii) and inequality (13)
We mention in the text that condition ii) of Proposition 4 is equivalent to inequality (13) when both
Ïƒ and Gi are differentiable.
âˆ’

1

Taking the derivative of the log of Gi (Î›)Î±i 1âˆ’Ïƒ(Î›) with respect to Î›, we find that it is positive if
and only if:


1
âˆ‚
G0i (Î›)
>0
âˆ’ (log Î±i ) .
Gi (Î›)
âˆ‚Î› 1 âˆ’ Ïƒ(Î›)
Hence, for each good i, the minimum Î±i such that it is positive is:


(Ïƒ(Î›) âˆ’ 1)2 G0i (Î›)
âˆ—
Î±i = exp
Ïƒ 0 (Î›)Gi (Î›)
P
One can see that inequality i Î±iâˆ— < 1 corresponds to inequality (13) in the text.
Note: one can also verify that this condition is equivalent to imposing that Gi (Î›) and Ïƒ(Î›) are
such that:
"
# 1
1âˆ’Ïƒ(Î›)
X
1âˆ’Ïƒ(Î›)
(Gi (Î›) pi /w)
i

increases for any set of pi /w.

38

Lemma 6 For any given set of xi â‰¥ 0 and Î±i â‰¥ 0 such that
monotonically increasing in Ï âˆˆ (âˆ’âˆ, +âˆ):
hX

Î±i xÏi

P

i Î±i

= 1, the following expression is

i1

Ï

i

Ï0

Proof of Lemma 6: First, consider two values Ï < Ï0 < 0 and consider the mapping m(x) = x Ï
which is convex in x. Jensenâ€™s inequality implies that:
X
 X
m
Î±i yi â‰¤
Î±i m(yi )
i

i

and thus:
X

Î± i yi

1

Ï

â‰¤

X

i

Choosing yi = [xi

]Ï ,

Ï0

Î±i yiÏ

 10
Ï

i

we obtain:
hX

Î±i xÏi

i1

Ï

hX

â‰¤

i

Î±i xÏi

0

i 10
Ï

i
Ï0

Second, consider two values Ï0 > Ï > 0 and consider again the mapping m(x) = x Ï which is now
concave in x. Jensenâ€™s inequality for concave functions implies:
X
 X
m
Î±i yi â‰¥
Î±i m(yi )
i

i

and thus, taking to the exponent 1/Ï < 0, we have:
X

Î± i yi

1

Ï

â‰¤

X

Ï0
Ï

Î±i yi

 10
Ï

i

i

Choosing yi = [xi ]Ï , we obtain:
hX

Î±i xÏi

i1

Ï

â‰¤

hX

i

Î±i xÏi

0

i 10
Ï

i

Note that these terms are well defined when Ï converges to zero (on both sides):
lim

Ïâ†’0

hX

Î±i xÏi

i1

i

Ï

=

Y

xÎ±i i

i

hence the findings above also apply to Ï = 0. This proves Lemma 6.

39

Appendix B â€“ Counter-examples
First case with homogeneous demand shifters
Here I show that we can find a case where conditions ii) fails and where the Slutsky substitution
matrix is not semi-definite negative, thus proving that condition ii) cannot be entirely waived.
Suppose that F (Î›) = Î› (no problem arises when F is locally constant) and that we have two
goods 1 and 2, where ÎµD1 < ÎµH while ÎµD2 > ÎµH for the other good, i.e. ÎµH âˆˆ (ÎµD1 , ÎµD2 ). In particular,
D1
to fix ideas, supposed that all elasticities are constant, with ÎµH = ÎµD2 +Îµ
â‰¡ âˆ’Îº < 0 and denote
2
Î´ â‰¡ ÎµD2 âˆ’ ÎµH = ÎµH âˆ’ ÎµD1 > 0. Denote by the expenditure share of product 1 as 1âˆ’
2 and the
such
that
ÎµÌ„
âˆ’
Îµ
=
Î´.
While
elasticities
are
constant,
we can
expenditure share of good 2 as 1+
D
H
2
still adjust the demand shifter for each good to obtain the desired market shares (hence  can be
chosen independently from the elasticities).
The off-diagonal coefficients of the Slutsky substitution matrix are then:
s12 p1 p2 /w = âˆ’

a1 a2 (ÎµD1 âˆ’ ÎµH )(ÎµD2 âˆ’ ÎµH )
(1 âˆ’ 2 )Î´ 2 (1 âˆ’ 2 )Îº
+ a1 a2 ÎµH = âˆ’
âˆ’
ÎµÌ„D âˆ’ ÎµH
4Î´
4

where ai denotes the expenditure share of good i. The diagonal coefficients are:
s11 p21 /w = a1 ÎµD1 âˆ’

a21 (ÎµD1 âˆ’ ÎµH )2
(1 âˆ’ )(Îº + Î´) (1 âˆ’ )2 Î´ 2 (1 âˆ’ )2 Îº
+ a21 ÎµH = âˆ’
+
âˆ’
ÎµÌ„D âˆ’ ÎµH
2
4Î´
4

s22 p22 /w = a2 ÎµD2 âˆ’

a22 (ÎµD2 âˆ’ ÎµH )2
(1 + )(Îº âˆ’ Î´) (1 + )2 Î´ 2 (1 + )2 Îº
+ a22 ÎµH = âˆ’
+
âˆ’
ÎµÌ„D âˆ’ ÎµH
2
4Î´
4

One can see that the substitution coefficients become very large as  approach zero (because some
of the terms have  in the denominator). Moreover, if we denote by Î£ the matrix with coefficients
sij pi pj /w, we obtain:


+Î´ âˆ’Î´
lim 4Î£ =
âˆ’Î´ +Î´
â†’0+
This matrix is semi-definite positive: xT 4Î£x = Î´ 2 (x1 âˆ’ x2 )2 â‰¥ 0. By continuity, when  is small
enough, the substitution matrix with coefficient sij is semi-definite positive, which is not consistent
with a rational demand system.

Second case with iso-elastic substitution
In this case, I provide counter-examples to show that neither Î› or U are well defined if the assumptions
of Proposition 4 are not satisfied.
â€¢ First, suppose that Ïƒ(Î›) increases in Î›. In this case, the elasticity of substitution increases
with income and issues are more likely to arise when consumption is concentrated in one or few
goods.
When Gi (Î›) is not monotonic in Î› for a good i, the budget constraint can be written:
Gi (Î›)pi /w = 1
when the consumption of all other goods become negligible, i.e. when (pj /w)1âˆ’Ïƒ(Î›) = 0. If
there exists Î›1 6= Î›2 such that Gi (Î›1 ) = Gi (Î›2 ), one can see that the equation above has at

40

least two solutions when pi /w = 1/Gi (Î›1 ).
Conversely, utility is not well defined by the implicit equation provided in Proposition 4 when
Ïƒ(U )âˆ’1

Gi is not monotonic for a good. Suppose that qj Ïƒ(U ) is zero (or close to zero) for other goods
 Ïƒ(U )âˆ’1

Ïƒ(U )
qi
= 1 â‡” Gi (U ) = qi has several solutions in U for
j. In that case, we can see that Gi (U )
some qi if Gi is not monotonic, potentially violating the monotonicity of U w.r.t quantities.
We also need G0i to have the same sign for all goods. If it is not the case, we can obtain
situations where Î› and U are not well defined, or where U would decrease with quantities qi for
some goods.
â€¢ Counter-examples for the second case are more difficult to construct. Here we will assume here
that Ïƒ(Î›) and Gi (Î›) are differentiable. Let us examine what happens when inequality (13) is
not satisfied, i.e. when:


X
(Ïƒ(Î›) âˆ’ 1)2 G0i (Î›)
exp
>1
Ïƒ 0 (Î›)Gi (Î›)
i

for a given Î› = U0 . In that case, we can show that it is possible to find a set of quantities qi
such that U0 is the solution of equation (14) but where implicit utility would depend negatively
on some of the quantities. This amounts to showing that the following expression:
hX

Gi (U )/qi

 1âˆ’Ïƒ(U ) i
Ïƒ(U )

Ïƒ(U )
1âˆ’Ïƒ(U )

i

decreases with U and for at least some of the qi â€™s.
Suppose that U0 is the solution of equation (14) for a given set of qi . We can always rearrange
the qi to match a given set of consumption shares while still having U0 as the solution of
equation (14) . In particular, choose qiâˆ— such that U0 is still the solution of (14) and such that:


Gi (U0 )/qiâˆ—

 1âˆ’Ïƒ(U0 )

1
=
exp
A

Ïƒ(U0 )



(Ïƒ(U0 ) âˆ’ 1)2 G0i (U0 )
Ïƒ 0 (U0 )Gi (U0 )





P
(Ïƒ(U0 )âˆ’1)2 G0i (U0 )
where A â‰¡
exp
> 1, strictly larger than unity if condition ii) is not
0
i
Ïƒ (U0 )Gi (U0 )
satisfied. Consider the function:
f (U, q) =

hX

Gi (U )/qi

 1âˆ’Ïƒ(U ) i
Ïƒ(U )

Ïƒ(U )
1âˆ’Ïƒ(U )

i

which corresponds to the left-hand side of equation (14). One can see that the derivative in U
at U = U0 and q = q âˆ— is negative:
fU (U0 , q âˆ— ) =

0)
X G0 (U0 )  Gi (U0 )  1âˆ’Ïƒ(U
Ïƒ(U )

i

i

Gi (U0 )

0

qiâˆ—

+

1âˆ’Ïƒ(U )
 G (U )  1âˆ’Ïƒ(U0 )
Ïƒ 0 (U0 ) X  Gi (U0 )  Ïƒ(U0 )0
Ïƒ(U0 )
i
0
log
(1âˆ’Ïƒ(U0 ))2
qiâˆ—
qiâˆ—

i

Ïƒ 0 (U0 )
=
log A < 0
(1âˆ’Ïƒ(U0 ))2
while the derivative fqi (U0 , q âˆ— ) in each qi is also negative. This leads to an implicit utility
function U of q that decreases with quantities.

41

Appendix C â€“ Practical cases and applications
For the second case, generalized non-homothetic CES, with uniform elasticity of substitution across
goods:
1. In various contexts, one has associated a lower elasticity of substitution for richer consumers
(in line with empirical evidence) while keeping the practicality of CES preferences. Proposition
4 case ii) allows us to do just that. Handbury (2016) and Faber and Fally (2017) assume that
the consumption of the outside good influences elasticities. Here, one can circumvent such
assumption by defining utility implicitly in a similar fashion as in Hanoch (1975) and Comin et
al (2015).
2. Comin et al (2015) provide an excellent application of the case with constant elasticity of
substitution Ïƒ that does not depend on income. In the calibration of their model, each industry
is associated with a distinct structural parameter driving income effect, while keeping constant
elasticities of substitution among industries. Here we show that it can be extended to elasticities
of substitution that can potentially change with real income. Moreover, these income effects
in substitution would not have to be tied (in terms of functional form) to income effects in
consumption shares across industries.
For instance, one application could be to rationalize the rise of profits and fixed costs relative to
variable costs. If Ïƒ decreases with utility (and thus income), growth would be associated with
larger markups and larger variable profits, and under free entry with larger shares of fixed costs
over total costs. If fixed costs are more intensive in capital, this would rationalize an increasing
share of capital in GDP.
3. While Comin et al (2015) focus on constant elasticity Ïƒ(Î›) = Ïƒ, an opposite case would be to
assume that all goods have the same shifters Gi (Î›) = G(Î›). Generalized non-homothetic CES
would still be non-homothetic in that case. Assuming that Ïƒ(Î›) is differentiable, integrability
is ensured if G(Î›) increases sufficiently fast:


G0 (Î›)
Ïƒ 0 (Î›)
> max 0, âˆ’
log N
G(Î›)
(Ïƒ(Î›) âˆ’ 1)2
For the first case, generalized Gorman-Pollak form, with non-uniform elasticity of substitution:
4. A simple way to generalize both directly and indirectly-separable preferences, as well as homothetic single-aggregator (HSA) preferences, is to consider iso-elastic functions H and F such
that demand can be written:
qi = Î›Î² Di (Î›pi /w)
For instance, if we assume that the price elasticity of Di is always strictly larger than unity
(a common assumption under monopolistic competition to ensure finite markups), integrability
is ensured as long as Î² â‰¤ 1. Directly-separable preferences correspond to the special case
Î² = 0, indirectly-separable preferences correspond to the limit case Î² â†’ âˆ’âˆ, and homothetic
single-aggregator to the special case Î² = 1.
5. Iso-elastic functions Di (x) = Ai xâˆ’Ïƒi , F (Î›) = Î› and H(Î›) = Î›âˆ’Î² with Î² < 1 lead to another
interesting case. It is equivalent to CES only if the Ïƒi â€™s are identical.
This corresponds to self-dual addilog preferences previously examined by Houthakker (1965),
Pollak (1972) and just recently by Bertoletti and Etro (2017a). With direct separability (when

42

H is constant), we obtain preferences with â€œConstant Relative Income Elasticitiesâ€ (Fieler 2011,
Caron et al., 2017, 2014). When Î² = 0 (CRIE). In the latter case with Î² = 0, income elasticities
are:
âˆ‚ log qi
Ïƒi
=
(36)
âˆ‚ log w
ÏƒÌ„
where ÏƒÌ„ is the expenditure-weighted average of Ïƒj . With Î² 6= 0, we obtain a generalization of
such preferences where income elasticities are given by:
 Ïƒ âˆ’ ÏƒÌ„ 
âˆ‚ log qi
i
= 1 + (1 âˆ’ Î²)
âˆ‚ log w
ÏƒÌ„ âˆ’ Î²

(37)

These demand systems are non-homothetic except for the case where Î² = 1 (which does not
necessarily imply CES) or when Ïƒj = Ïƒi for all i, j.
6. Augmented bi-power form, as in Mazrova and Neary (2013)
Consider the demand system, assuming Ïƒ > Î½ > 0:
qi (pi /w, Î›) = Î³(Î›)[pi /w]âˆ’Î½ + Î´(Î›)[pi /w]âˆ’Ïƒ
1

Under which conditions is that demand system integrable? Defining F (Î›) = [Î³(Î›)/Î´(Î›)] Ïƒâˆ’Î½
Ïƒ
Î½
and H(Î›) = Î´(Î›)âˆ’1 F (Î›)âˆ’Ïƒ = Î³(Î›)âˆ’ Ïƒâˆ’Î½ Î´(Î›) Ïƒâˆ’Î½ , one can recover the form of demand
systems as in Mazrova and Neary (2013) by applying Proposition 3.
To apply Proposition 3, one would need qi to be decreasing in Î›, regardless of prices. Hence
a sufficient condition is that both Î´(Î›) and Î³(Î›) decrease with Î›. If those conditions are
not satisfied, we can see that Î› will not be well defined.14 TakingPvery low prices, we have
1âˆ’Ïƒ = 1 can
qi (pi /w, Î›) â‰ˆ Î´(Î›)[pi /w]âˆ’Ïƒ and we can see that the equation
i Î´(Î›)[pi /w]
lead to multiple solutions in Î› if Î´ is not monotonic.
if we have very high prices,
P Conversely,
1âˆ’Ïƒ = 1 can lead to multiple
Î³(Î›)[p
/w]
qi (pi /w, Î›) â‰ˆ Î³(Î›)[pi /w]âˆ’Î½ , and the equation
i
i
solutions in Î› if Î³ is not monotonic. Hence monotonicity in both Î³(Î›) and Î´(Î›) is required to
ensure that Î› is well defined.
7. The previous example builds on a symmetric case (symmetric across all goods). More generally,
one can also consider asymmetric bi-power forms. With Di (yi ) = Î³i yiâˆ’Î½i + Î´i yiâˆ’Ïƒi , one can
obtain recoverable demand systems as long as F (Î›) and H(Î›) are common across all goods, i.e.
if demand takes the form:
qi (pi /w, Î›) = Î³i H(Î›)[F (Î›)pi /w]âˆ’Î½i + Î´i H(Î›)[F (Î›)pi /w]âˆ’Ïƒi
with

âˆ‚ log H
âˆ‚ log Î›

< min{Î½i , Ïƒi } to ensure that Î› is well defined.

8. Similarly, one can consider inverse demand functions that are bi-power, with the same extensions
as above.
9. Mrazova et al. (2017) introduce CREMR demand (with constant revenue elasticity of marginal
revenue) where the own-price effects are such that the distribution of sales and productivity
belong to the same family (e.g. lognormal+lognormal, Pareto+Pareto, etc.). They rationalize
their demand system with a directly-additive utility function.
14

If both Î´ and Î³ are instead increasing in Î›, we can just replace Î› by 1/Î›.

43

Using our results, one can further generalize such demand system (though only in the superconvex case where there is no restriction on minimum quantities) with more flexible income effects
while keeping the CREMR properties linked to price effects. If we specify:
Diâˆ’1 (x) =

Ïƒâˆ’1
Î²i
(x âˆ’ Î³i ) Ïƒ
x

with Î³i < 0, and H(z) such that ÎµH â‰¥ âˆ’1, the following (inverse) demand systems is integrable:
pi (qi , z) = w/z Diâˆ’1 (H(z)qi )
P i qi
=1 (see Section 3), which can be
where z is implicitly defined by the budget constraint i pw
written:
X
Ïƒâˆ’1
z =
Î²i (H(z)qi âˆ’ Î³i ) Ïƒ / H(z)
i

The directly additive case described in Mrazova et al. (2017) corresponds to the case where
H(z) is constant. The homothetic case corresponds to H(z) = 1/z.
10. Conditionally-linear demand:
qi = (Î±i âˆ’ Î³i Î›pi )/H(wÎ›)
is integrable as long as Î›pi â‰¤

Î±i
2Î²i

and ÎµH > âˆ’1.

This generalizes Ottaviano et al. (2002), Melitz and Ottaviano (2008) and Mayer et al. (2014)
based on quasi-linear preferences. This conditionally-linear demand system nevertheless yields
very simple expressions for markups in monopolistic competition when Î› is taken as given (limit
case with many firms).
A practical case is to impose H(wÎ›) = (wÎ›)âˆ’Î² with Î² < 1, but even in this most simple case
there is no fully closed-form solution since utility (direct and indirect) still depends on functions
z and Î› that are implicitly defined.15 While z âˆ’Î² qi < Î±i and pi Î› < Î±i /Î³i , utility and indirect
utility take the form:
U (q) =

X z âˆ’Î² qi (2Î±i âˆ’ z âˆ’Î² qi )
Î²z 1âˆ’Î²
+
1âˆ’Î²
2Î³i

V (p, w) =

X pi Î›(2Î±i âˆ’ Î³i pi Î›)
(wÎ›)1âˆ’Î²
âˆ’
1âˆ’Î²
2

i

i

where z and Î› are implicitly defined as the solutions of z =
Î³i Î›pi ) = w respectively.

P

i qi (Î±i âˆ’z

âˆ’Î² q

i )/Î³i

and

P

i (wÎ›)

Î²p

i (Î±i âˆ’

11. Counter-examples where demand depends on more than one aggregator: Kimball (1995) and
Î±i
Note that the conditions in Proposition 2 are not always satisfied if x â‰¤ 2Î³
and the elasticity of H is close
i
to âˆ’1 (Di would have an elasticity below unity in absolute value). In a monopolistic competition framework,
2
Î±
a trick is to replace Di by 4Î³Î±i x for x < 2Î³
. Such a function Di would satisfy the conditions of Proposition 1
i
as long as the elasticity of H remains between zero and unity. In equilibrium, none of the firms would set an
Î±i
and none of the firms would end up on the
infinite markup, hence equilibrium prices are such that Î›pi > 2Î³
i
non-linear portion of the demand curve.
15

44

QMOR (Feenstra 2015). QMOR demand can be expressed as:
"


 âˆ— r/2 #
pi râˆ’1
p
qi = Î±u
1âˆ’
e(p)
pi
which is a function of two aggregators: pâˆ— and e(p). Given that e(u)u = w, we also have:
 "
 âˆ— r/2 #

p i qi
p
pi r
1âˆ’
=Î±
w
e(p)
pi
Note that the price elasticity can be expressed as a function of pâˆ— only.
Similarly, demand with Kimball preferences with an implicit aggregator depends in fact on two
aggregators (it also depend on the Lagrange multiplier associated with the budget constraint)
hence they are not a special case of the demand systems described here.

45

