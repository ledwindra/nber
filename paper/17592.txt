NBER WORKING PAPER SERIES

THE LEVERAGE EFFECT PUZZLE:
DISENTANGLING SOURCES OF BIAS AT HIGH FREQUENCY
Yacine Ait-Sahalia
Jianqing Fan
Yingying Li
Working Paper 17592
http://www.nber.org/papers/w17592

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2011

Aït-Sahalia's research was supported by NSF grant SES-0850533. Fan's research was supported by
NSF grants DMS-0714554 and DMS-0704337. Li's research was supported by the Bendheim Center
for Finance at Princeton University and the RGC grant DAG09/10.BM12 at Hong Kong University
of Science and Technology. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2011 by Yacine Ait-Sahalia, Jianqing Fan, and Yingying Li. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

The Leverage Effect Puzzle: Disentangling Sources of Bias at High Frequency
Yacine Ait-Sahalia, Jianqing Fan, and Yingying Li
NBER Working Paper No. 17592
November 2011
JEL No. C22,G12
ABSTRACT
The leverage effect refers to the generally negative correlation between an asset return and its changes
of volatility. A natural estimate consists in using the empirical correlation between the daily returns
and the changes of daily volatility estimated from high-frequency data. The puzzle lies in the fact that
such an intuitively natural estimate yields nearly zero correlation for most assets tested, despite the
many economic reasons for expecting the estimated correlation to be negative. To better understand
the sources of the puzzle, we analyze the different asymptotic biases that are involved in high frequency
estimation of the leverage effect, including biases due to discretization errors, to smoothing errors
in estimating spot volatilities, to estimation error, and to market microstructure noise. This decomposition
enables us to propose novel bias correction methods for estimating the leverage effect.

Yacine Ait-Sahalia
Department of Economics
Fisher Hall
Princeton University
Princeton, NJ 08544-1021
and NBER
yacine@princeton.edu
Jianqing Fan
Bendheim Center for Finance
26 Prospect Ave
Princeton NJ 08540
jqfan@princeton.edu

Yingying Li
Department of Information Systems,
Business StatisWLFV
Hong Kong University of Science and Technology
yyli@ust.hk

1

Introduction

The “leverage eﬀect” refers to the observed tendency of an asset’s volatility to be negatively
correlated with the asset’s returns. Typically, rising asset prices are accompanied by declining
volatility, and vice versa. The term leverage refers to one possible economic interpretation of this
phenomenon, developed in Black (1976) and Christie (1982): as asset prices decline, companies
become mechanically more leveraged since the relative value of their debt rises relative to that
of their equity. As a result, it is natural to expect that their stock becomes riskier, hence
more volatile. While this is only a hypothesis, this explanation is suﬃciently prevalent in the
literature that the term “leverage eﬀect” has been adopted to describe the statistical regularity
in question. It has also been documented that the eﬀect is generally asymmetric: other things
equal, declines in stock prices are accompanied by larger increases in volatility than the decline
in volatility that accompanies rising stock markets (see, e.g., Nelson (1991) and Engle and Ng
(1993)). Various discrete-time models with a leverage eﬀect have been estimated by Yu (2005).
The magnitude of the eﬀect however seems too large to be attributable solely to an increase
in ﬁnancial leverage: Figlewski and Wang (2000) noted among other ﬁndings that there is no
apparent eﬀect on volatility when leverage changes because of a change in debt or number of
shares, only when stock prices change, which questions whether the eﬀect is linked to ﬁnancial
leverage at all. As always, correlation does not imply causality. Alternative economic interpretations have been suggested: an anticipated increase in volatility requires a higher rate of
return from the asset, which can only be produced by a fall in the asset price (see, e.g., French
et al. (1987) and Campbell and Hentschel (1992)). The leverage explanation suggests that a
negative return should make the ﬁrm more levered, hence riskier and therefore lead to higher
volatility; the volatility feedback eﬀect is consistent with the same correlation but reverses the
causality: increases in volatility lead to future negative returns.
These diﬀerent interpretations have been investigated and compared (see Bekaert and Wu
(2000)), although at the daily and lower frequencies the direction of the causality may be diﬃcult
to ascertain since they both appear to be instantaneous at the level of daily data (see Bollerslev
et al. (2006)). Using higher frequency data, namely ﬁve-minute absolute returns to construct a
realized volatility proxy over longer horizons, Bollerslev et al. (2006) ﬁnd a negative correlation
between the volatility and the current and lagged returns, which lasts for several days, low
correlations between the returns and the lagged volatility and strong correlation between the
2

high-frequency returns and their absolute values. Their ﬁndings support the dual presence of a
prolonged leverage eﬀect at the intradaily level, and an almost instantaneous volatility feedback
eﬀect. Diﬀerences between the correlation measured using stock-level data and index-level data
have been investigated by Duﬀee (1995). Bollerslev et al. (2011) develop a representative agent
model based on recursive preferences in order to generate a volatility process which exhibits
clustering, fractional integration, and has a risk premium and a leverage eﬀect.
Whatever the source(s) or explanation(s) for the presence of the leverage eﬀect correlation,
there is broad agreement in the literature that the eﬀect should be present. So why is there
a puzzle, as suggested by the title of this paper? As we will see, using high frequency data
and standard estimation techniques, the data stubbornly refuse to conform to these otherwise
appealing explanations. We ﬁnd that, at high frequency and over short horizons, the estimated
correlation ρ between the asset returns and changes in its volatility is close to zero, instead of
the strong negative value that we have come to expect. At longer horizons, or especially using
option-implied volatilities, the eﬀect is present. If we accept that the true correlation is indeed
negative, then this is especially striking since a correlation estimator relies on second moment,
or quadratic (co)variation, quantities and as such should be estimated particularly well at high
frequency, or instantaneously, using standard probability limit results. We call this disconnect
the “leverage eﬀect puzzle,” and the purpose of this paper is to examine the reasons for it.
At ﬁrst read, this behavior of the estimated correlation at high frequency can be reminiscent
of the Epps Eﬀect. Starting with Epps (1979), it has indeed been recognized that the empirical
correlation between the returns of two assets tends to decrease as the sampling frequency of
observation increases. One essential issue that arises in the context of high frequency estimation
of the correlation coeﬃcient between two assets is the asynchronicity of their trading, since
two assets will generally trade, hence generate high frequency observations, at diﬀerent times.
Asynchronicity of the observations has been shown to have the potential to generate the Epps
Eﬀect.1
However, the asynchronicity problem is not an issue here since we are focusing on the
estimation of the correlation between an asset’s returns and its (own) volatility. Because the
1

As a result, various data synchronization methods have been developed to address this issue: for instance,

Hayashi and Yoshida (2005) have proposed a modiﬁcation of the realized covariance which corrects for this eﬀect;
see also Large (2007), Griﬃn and Oomen (2008), Voev and Lunde (2007), Zhang (2011), Barndorﬀ-Nielsen et al.
(2008b), Kinnebrock and Podolskij (2008) and Aı̈t-Sahalia et al. (2010).

3

volatility estimator is constructed from the asset returns themselves, the two sets of observations
are by construction synchrone. On the other hand, while asynchronicity is not a concern, one
issue that is germane to the problem we consider in this paper is the fact that one of two variables
entering the correlation calculation is latent, namely the volatility of the asset returns. Relative
to the Epps Eﬀect, this gives rise to a diﬀerent set of issues, speciﬁcally the need to employ
preliminary estimators or proxies for the volatility variable, such as realized volatility (RV) for
example, in order to compute its correlation with asset returns. We will show that the latency
of the volatility variable is partly responsible for the observed puzzle.
One further issue, which is in common at high frequency between the estimation of the
correlation between two asset returns and the estimation of the correlation between an asset’s
return and its volatility, is that of market microstructure noise. When sampled at suﬃciently
high frequency, asset prices tend to incorporate noise that reﬂects the mechanics of the trading
process, such as bid/ask bounces, the diﬀerent price impact of diﬀerent types of trades, limited
liquidity, or other types of frictions. To address this issue, we will analyze the eﬀect of using
noise-robust high frequency volatility estimators for the purpose of estimating the leverage
eﬀect.2
Our main results are the following. We provide theoretical results to disentangle the biases
involved in estimating the correlation between the returns and volatilities with a sequence of
progressively more realistic estimators. We proceed incrementally, in such a way that we can
isolate the sources of the bias one by one. Starting with the spot volatility, an ideal but unavailable estimator since volatility is unobservable, we will see that the leverage eﬀect parameter ρ is
2

In the univariate volatility case, many estimators have been developed to produce consistent estimators

despite the presence of the noise. These include the Two Scales Realized Volatility (TSRV) of Zhang et al.
(2005), Multi-Scale Realized Volatility (MSRV), a modiﬁcation of TSRV which achieves the best possible rate
of convergence proposed by Zhang (2006), Realized Kernels (RK) by Barndorﬀ-Nielsen et al. (2008a), the
Pre-Averaging volatility estimator (PAV) by Jacod et al. (2009), and the Quasi-Maximum Likelihood Estimator
(QMLE) of Xiu (2010) which extends the parametric Maximum-Likelihood Estimator of Aı̈t-Sahalia et al. (2005)
to the setting of stochastic volatility. Related work include Bandi and Russell (2006), Delattre and Jacod (1997),
Fan and Wang (2007), Gatheral and Oomen (2010), Hansen and Lunde (2006), Kalnina and Linton (2008), Li and
Mykland (2007), Aı̈t-Sahalia et al. (2011) and Li et al. (2010). To estimate the correlation between two assets,
or any two variables that are observable, Zhang (2011) proposed a consistent Two Scales Realized Covariance
estimator (TSCV), Barndorﬀ-Nielsen et al. (2008b) a Multivariate Realized Kernel (MRK), Kinnebrock and
Podolskij (2008) a multivariate Pre-Averaging estimator and Aı̈t-Sahalia et al. (2010) a multivariate QuasiMaximum Likelihood Estimator.

4

already estimated with a bias that is due solely to discretization. The unobservable spot volatility is frequently estimated by a local time-domain smoothing method which involves integrating
the spot volatility over time, locally. Replacing the spot volatility by the (also unavailable) true
integrated volatility, the bias for estimating ρ is even larger, but remains quantiﬁable. The incremental bias is due to smoothing. Replacing the true integrated volatility by an estimated
integrated volatility, the bias for estimating ρ becomes so large that, when calibrated on realistic parameter values, the estimated ρ becomes essentially zero, which is indeed what we
ﬁnd empirically. The incremental bias represents the eﬀect of the estimation error. We then
examine the eﬀect of using noise-robust estimators of the integrated volatility, and compute
the resulting additional bias term, which can of course go in the reverse direction. Based on
the above results, we propose a regression approach to compute bias-corrected estimators of ρ.
We investigate these eﬀects in the context of the Heston stochastic volatility model, which has
the advantage of providing explicit expressions for all these bias terms.
The paper is organized as follows. Section 2 documents the presence of the leverage eﬀect
puzzle. The prototypical model for understanding the puzzle and nonparametric estimators
for spot volatility are described in Section 3. Section 4 presents the main results of the paper,
which unveil the biases of estimating leverage eﬀect parameter in all steps of approximations.
A novel solution to the puzzle is proposed in Section 5, which is convincingly demonstrated
by Monte Carlo simulations in Section 6 and by empirical studies in Section 7 using the highfrequency data from S&P500 and Microsoft. Section 8 concludes. The appendix contains the
mathematical proofs.

2

Motivation: The Leverage Eﬀect Puzzle

To motivate the theoretical analysis that follows, we start with a straightforward empirical
exercise to illustrate the leverage eﬀect puzzle. A scatter plot of estimated changes of volatilities
and returns provides a simple way to examine graphically the relationship between estimated
changes in volatility and changes in log-prices (i.e., log-returns). Figure 1 shows scatter plots
of the diﬀerences of estimated daily volatilities V̂t − V̂t−m against the corresponding returns of
horizon m days for several assets, where V̂t is the integrated daily volatility estimated by the
noise-robust TSRV estimator. If we start with long horizons, as shown in Figure 1, we see that
the eﬀect is present in the data.
5

+++ Insert Figure 1 Here +++
In addition to the evidence that comes from long horizons, the eﬀect is even stronger empirically if we use a diﬀerent measurement altogether of the asset volatility, based on market prices
of derivatives. In the case of the S&P 500 index, we employ VIX, which is the square root of the
par variance swap rate with thirty day to maturity; that is, VIX measures the square-root of
the risk neutral expectation of the S&P 500 variance over the next thirty calendar days. Using
this market-based volatility measure, the leverage eﬀect is indeed very strong as demonstrated
in Figure 2.
+++ Insert Figure 2 Here +++
Yet, starting at the daily horizon, even when using high frequency volatility estimates, we
see in Figure 3 that the scatter plot of D̂t = V̂t − V̂t−1 against daily returns Rt shows no apparent
leverage eﬀect for the diﬀerent assets considered. As discussed in the Introduction, diﬀerent
economic explanations provide for diﬀerent causation between returns and their volatility. To
be robust against the timing diﬀerences that diﬀerent causality explanations would generate, we
next examine scatter plots of diﬀerent time lags and leads such as {(D̂t−1 , Rt )} and {(D̂t , Rt−1 )}.
The evidence again reveals no leverage eﬀect. Similar results are obtained if we employ diﬀerent
time periods and/or diﬀerent noise-robust volatility estimators such as QMLE or PAV.
+++ Insert Figure 3 Here +++
There are sound economic rationales to support a prior that a leverage eﬀect is present in
the data, and we do indeed ﬁnd it in Figures 1 and 2. So why are we unable to detect it on
short horizon based on high frequency volatility estimates that should provide precise volatility
proxies? This is the nature of the “leverage eﬀect puzzle” that we seek to understand. Can it
be the result of employing estimators that are natural at high frequency for the latent volatility
variable, but somehow result in biasing the estimated correlation all the way down to zero?
Why does this happen? The goal of this paper is to understand the sources of the puzzle and
propose a solution.

6

3

Data Generating Process and Estimators

In order to study the leverage eﬀect puzzle, we need two ingredients: nonparametric volatility
estimators that are applicable at high frequency, and data generating processes for the logreturns and their volatility in the form of a stochastic volatility model. Employing a speciﬁc
stochastic volatility model has the advantage that the properties of nonparametric estimators
of the correlation between asset returns and their volatility become fully explicit. We can derive
theoretically the asymptotic biases of diﬀerent nonparametric estimators applied to this model,
and verify their practical relevance via small sample simulation experiments. Put together, these
ingredients lead to a novel solution to the leverage puzzle by introducing a tuning parameter
(represented by m below) that attempts to minimize the estimation bias.

3.1

Stochastic Volatility Model

The speciﬁcation we employ for this purpose is the stochastic volatility model of Heston (1993)
for the log-price dynamics:
dXt = (µ − νt /2)dt + σt dBt
1/2

dνt = κ(α − νt )dt + γνt dWt ,

(1)
(2)

where νt = σt2 , B and W are two standard Brownian motions with E(dBt dWt ) = ρdt, and the
parameters µ, α, κ, γ and ρ are constants. We assume that the initial variance ν0 > 0 is a
realization from the stationary (invariant) distribution of (2) so that νt is a stationary process.
Under Feller’s condition 2κα > γ 2 , the process νt stays positive, a condition that is always
assumed in what follows. Note that
ρ = lim Corr(νt+s − νt , Xt+s − Xt )
s→0

(3)

so that the leverage eﬀect is summarized by the parameter ρ under the Heston model (1)-(2).
Throughout the paper, we refer to the correlation (3) between changes in volatility and
changes in asset log-prices, i.e., returns, as the “leverage eﬀect.” Other papers deﬁne it as the
correlation between the level of volatility and returns, or the correlation between the level of
absolute returns and returns (see, e.g., Bollerslev et al. (2006).) The latter deﬁnition, however,
would not predict that the parameter ρ should be identiﬁed as the high frequency limit of
that correlation; while that alternative deﬁnition is appropriate at lower frequencies, it yields
7

a degenerate high frequency limit since it measures the correlation between two variables that
are of diﬀerent orders of magnitude in that limit. High frequency data can be employed to
estimate the correlation between volatility levels and returns, but only over longer horizons, as
it is indeed employed in Bollerslev et al. (2006).
We consider a diﬀerent problem: the nature of the “leverage eﬀect puzzle” we identify lies
in the fact that it is diﬃcult to translate the otherwise straightforward short horizon / high
frequency limit (3) into a meaningful estimate of the parameter ρ.

3.2

Nonparametric Estimation of Volatility and Sampling

Our ﬁrst statistical task will be to understand why natural approaches to estimate ρ based on
(3) do not yield a good estimator when nonparametric estimates of volatility based on highfrequency data are employed. With a small time horizon ∆ (e.g., one day or ∆ = 1/252 year),
let

∫

t

Vt,∆ =

νs ds

(4)

t−∆

denote the integrated volatility from time t − ∆ to t and V̂t,∆ be an estimate of it based on
the discretely observed log-price process Xt , which additionally may be contaminated with the
market microstructure noise. Recall that the quantity of interest is ρ and is based on (3).
However, the spot volatility process νt is not directly observable and has to be estimated by
∆−1 V̂t,∆ . Thus, corresponding to a given estimator V̂ , a natural and feasible estimator of ρ is
ρ̂ = Corr(V̂t+s,∆ − V̂t,∆ , Xt+s − Xt ).

(5)

With s = ∆, V̂t+s,∆ and V̂t,∆ are estimators of integrated volatilities over consecutive intervals.
This is a natural choice for parameter s: changes of daily estimated integrated volatility are
correlated with changes of daily prices in two consecutive days. However, as to be demonstrated
later, the choice of s = m∆ (changes over multiple days apart) can be more advantageous.
We now specify the diﬀerent nonparametric estimators of the integrated volatility that will
be used for V̂t,∆ . We assume that the log-price process Xt is observed at higher frequency,
corresponding to a time interval δ (e.g., one observation every 10 seconds). In order for the
nonparametric estimate V̂t,∆ to be suﬃciently accurate, we need δ ≪ ∆; asymptotically, we
assume that ∆ → 0 and δ → 0 in such a way that ∆/δ → ∞.

8

In the absence of microstructure noise, the log prices Xiδ (i = 0, 1, · · · , n) are directly
observable, and the most natural (and asymptotically optimal) estimator of Vt,∆ is the realized
volatility
∑

∆/δ−1
RV
V̂t,∆

=

(Xt−∆+(i+1)δ − Xt−∆+iδ )2 .

(6)

i=0

Here, for simplicity of exposition, we assume there is an observation at time t − ∆, and that
the ratio ∆/δ is an integer; otherwise ∆/δ should be replaced by its integer part [∆/δ], without
any asymptotic consequences.
In practice, high frequency observations of log-prices are likely to be contaminated with
market microstructure noise. Instead of observing the log-prices Xt+iδ , we observe the noisy
version
Zt+iδ = Xt+iδ + ϵt+iδ ,

(7)

where the ϵt+iδ ’s are white noise random variables with mean zero and standard deviation
σϵ . With this type of observations, we can use noise-robust methods such as TSRV, PAV,
QMLE or RK to obtain consistent estimates of the integrated volatility. We will ﬁrst use the
TSRV estimator, as it is relatively simple to analyze. Speciﬁcally, letting n = ∆/δ, θTSRV be
a constant, L = [θTSRV n2/3 ] the number of grids over which the subsampling is performed and
n̄ = (n − L + 1)/n, the TSRV estimator is deﬁned as
n̄ ∑
1∑
(Zt−∆+(i+L)δ − Zt−∆+iδ )2 −
(Zt−∆+(i+1)δ − Zt−∆+iδ )2 .
L i=0
n i=0
n−L

TSRV
V̂t,∆
=

n−1

(8)

The TSRV estimator is simple to analyze but is not rate-optimal, converging at rate n1/6
instead of the optimal rate n1/4 . Thus, it is expected to incur a slightly larger estimation error.
We therefore consider the rate-eﬃcient pre-averaging volatility estimator (PAV) as proposed by
Jacod et al. (2009) with the weight function chosen as g(x) = x ∧ (1 − x). More speciﬁcally, let
√
θPAV be a constant, kn = [θPAV n], we consider
PAV
V̂t,∆

=

12
√

θPAV n
−

6

n−k
n +1
∑
i=0
n−1
∑

2
θPAV
n i=0

1
(
kn

k∑
n −1
j=⌊kn /2⌋

1
Zt−∆+(i+j)δ −
kn

(Zt−∆+(i+1)δ − Zt−∆+iδ )2 .

⌊kn /2⌋−1

∑

Zt−∆+(i+j)δ )2

j=0

(9)

A consistent estimator of the variance is provided in Jacod et al. (2009), as well as a consistent
∫t
estimator of the integrated quarticity t−∆ σs4 ds (see (21)).
9

4

Biases in Estimation of the Leverage Eﬀect

We now present the ﬁrst results of the paper, consisting of the biases of estimators of the
leverage eﬀect parameter ρ in four progressively more realistic scenarios, each employing a
diﬀerent nonparametric volatility estimator. These progressive scenarios help us document
an incremental source for the bias: discretization, smoothing, estimation error and market
microstructure noise.

4.1

True Spot Volatility: Discretization Bias

First, we consider the unrealistic but idealized situation in which the spot volatility process νs
is in fact directly observable. This helps us understand the error in estimating ρ that is due to
discretization alone. Theorem 1 reports the correlation between asset returns and changes of
the instantaneous volatility, from which the bias can easily be computed.
Theorem 1. Changes of the true spot volatility and changes of log-prices have the following
√

correlation:
Corr(νs+t − νt , Xs+t − Xt ) = √

ρ
(

s+

e−κs −1
κ

1−e−κs
κ

) ( γ2

4κ2

−

γρ
κ

.

)

(10)

+s

Let us denote the right hand side of the expression in Theorem 1 as C1 (s, κ, γ, α, ρ). From
Theorem 1, the bias due to the discrete approximation can be easily computed, in the form
C1 (s, κ, γ, α, ρ) − ρ. In particular, we have the following Proposition expressing the bias as a
function of the integration interval ∆ and the interval length over which changes are evaluated,
m∆, m ≥ 1, under diﬀerent asymptotic assumptions on the sampling scheme:
Proposition 1. When m∆ → 0, we have
Corr(νt+m∆ − νt , Xt+m∆ − Xt ) = ρ −

ρ (γ 2 − 4γκρ + 4κ2 )
m∆ + o(m∆).
16κ

(11)

Since the value ρ is negative, the ﬁrst order of the bias is positive, which pulls the function
C1 (s, κ, γ, α, ρ) towards zero, weakening the leverage eﬀect. Figure 4 shows precisely how
the function C1 (m∆, κ, γ, α, ρ) varies with m for two sets of parameter values: (ρ, κ, γ, α) =
(−0.8, 5, 0.5, 0.1) and (ρ, κ, γ, α) = (−0.3, 5, 0.05, 0.04) when ∆ is taken to be 1/252. The former
set of parameters was adapted from those in Aı̈t-Sahalia and Kimmel (2010) and the latter set
10

was taken to weaken the leverage eﬀect but to observe the Feller’s condition: 2κα > γ 2 . As
expected, the smaller the m, the smaller the discretization bias.
+++ Insert Figure 4 Here +++

4.2

True Integrated Volatility: Smoothing Bias

The spot volatilities are latent. They can be (and usually are) estimated by a local average of
integrated volatility, which is basically a smoothing operation, over a small time horizon ∆. How
big are the biases for estimating ρ even in the idealized situation where the integrated volatility is
known precisely? The following theorem gives an analytic expression for the resulting smoothing
bias:
Theorem 2. Changes of the true integrated volatility and changes of log-prices have the following correlation:
Corr(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt ) = A2 /(B2 C2 )

(12)

where
A2 = 2γ(1 − ∆κ) + 4∆κ2 ρ − 2γe−∆κ
(
)
+ e−∆κ(m+1) e2∆κ (γ − 4κρ) − 2e∆κ (γ − 2κρ) + γ ,
√
(
)
B2 = 2 e−∆κ(m+1) 2e∆κm − (e∆κ − 1)2 + 2∆κ − 2,
and
C2 =

√

γ 2 (∆κm + e−∆κm − 1) + 4γκρ (−∆κm − e−∆κm + 1) + 4∆κ3 m.

While the expressions in Theorem 2 are exact, further insights can be gained when we
consider the resulting asymptotic expansion as ∆ → 0. We focus again on both situations
where m is ﬁxed and m → ∞ while still m∆ → 0.
Proposition 2. The following asymptotic expansions show the incremental bias due to smoothing induced by the local integration of spot volatilities:
(2m − 1)
Corr(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt ) = Corr(νt+m∆ − νt , Xt+m∆ − Xt ) √
2 m2 − m/3

 O(∆) when ∆ → 0 for any m
+
.
 o(m∆) when m → ∞, m∆ → 0
11

(13)

The ﬁrst expression is true when m is any ﬁxed integer. For the second expression, note
that the asymptote of the correction factor
(2m − 1)
1
√
= 1 + O( ).
2
m
2 m − m/3

(14)

Hence, when m is large, unlike what the initial intuition might have suggested, the bias of
estimated ρ based on integrated volatilities is asymptotically the same as that of the estimated
ρ based on spot volatilities.
Figure 4 shows the resulting numerical values (dotted curves) for the same sets of parameters.
They are plotted along with the correlations of the other estimators to facilitate comparisons.
First, as expected, the bias is larger than that when spot volatilities are employed. Figure 4
also reveals an interesting shape of biases of the idealized estimate of spot volatility. When
m is small, the bias is large and so is when m is large. There is an optimal choice of m that
minimizes the bias. For the case ∆ = 1/252, with the chosen parameters as in the left panel
of Figure 4 [(ρ, κ, γ, α) = (−0.8, 5, 0.5, 0.1)], the optimum is m0 = 16 with the optimal value
−0.74, leading to a bias of 0.06. On the other hand, using the natural choice m = 1, the
estimated correlation is about −0.5, meaning that the bias is about 40% of the true value.

4.3

Estimated Integrated Volatility: Shrinkage Bias due to Estimation Error

Theorems 1 and 2 provide a partial solution to the puzzle. If the spot volatility were observable,
the ideal estimate of leverage eﬀect is to use the change of volatility over two consecutive
intervals against the changes of the prices over the same time interval, i.e. m = 1. However,
when the spot volatility has to be estimated, even with the ideally estimated integrated volatility
Vt,∆ , the choice of m = 1 is far from being optimal. Indeed the resulting bias is quite large: for
ρ = −0.8, with the same set of parameters as above, the estimated ρ is about −0.5 even when
employing the idealized true integrated volatility Vt,∆ . When the sample version of integrated
volatility is used, we should expect that the leverage eﬀect is further masked by estimation
error. This is due to the well-known shrinkage bias of computing correlation when variables
are measured with errors. In fact, we already know that it becomes so large that it masks
completely the leverage eﬀect when m = 1 is used as in Figures 1 and 2. We now derive the
theoretical bias expressions corresponding to this more realistic case.
12

The following theorem calculates the bias of using a data driven estimator of the integrated
volatility in the absence of microstructure noise. In other words, we use the realized volatility
estimator. Let n be the number of observations during each interval ∆. Assume for simplicity
that the observation intervals are equally spaced at a distance δ = ∆/n.
Theorem 3. When n∆ → C and m2 ∆ → Cm for C, Cm ∈ (0, ∞), the following expansion
shows the incremental bias due to estimation error induced by the use of RV:
(2m − 1)
RV
RV
Corr(V̂t+m∆,∆
− V̂t,∆
, Xt+m∆ − Xt ) = Corr(νt+m∆ − νt , Xt+m∆ − Xt ) √
(15)
2 m2 − m/3
)−1/2
(
12ακ + 6γ 2
[1 + o(m∆)].
× 1+
(3γ 2 m − γ 2 )κC − 32 γ 2 κ2 CCm
The above theorem documents the bias when there is no market microstructure noise. Interestingly, it is decomposed into two factors. The ﬁrst factor is the smoothing bias and the
second factor is the shrinkage bias due to the estimation errors. The second factor reﬂects the
cost of estimating the latency of volatility process. The larger the C, the smaller the shrinkage
bias. Similarly, the larger the m, the smaller the shrinkage bias.
To appreciate the bias due to the use of RV, the main term in Theorem 3 as a function
of m is depicted in Figure 4 for the same sets of parameters as mentioned above. The daily
sampling frequency is taken to be n = 390 (one observation per minute) so that C = 390/252.
In particular, the choice of m = 1 corresponds to the natural estimator but it results in a very
large bias.
Even in the absence of market microstructure noise, the estimated correlation based on the
natural estimator
RV
RV
ρ̂RV = Corr(V̂t+∆,∆
− V̂t,∆
, Xt+∆ − Xt )

(16)

is very close to 0. This provides a mathematical explanation for why the leverage eﬀect cannot
be detected empirically using a natural approach. On the other hand, Theorem 3 also hints at
a solution to the leverage eﬀect puzzle: with an appropriate choice of m, there is hope to make
the leverage eﬀect detectable. For the left panel of Figure 4, if the optimal m = 27 is used, the
estimated correlation is now −0.694, when the true value is −0.8.

13

4.4

Estimated Noise-Robust Integrated Volatility: Shrinkage Bias
due to Estimation Error and Noise Correction Error

Under the more realistic case where allowance is made for the presence of market microstructure
noise under (7), the integrated volatility Vt is estimated based on noisy log-returns, using biascorrected high-frequency volatility estimators such as TSRV, PAV, QMLE or RK. In this case,
as we will see, detecting the leverage eﬀect based on the natural estimator is even harder. It
may in fact even result in an estimated correlation coeﬃcient with the wrong sign. Again, the
tuning parameter m can help resolve the issue.
We start with TSRV and then consider PAV as well. Other methods can be employed too,
but the computations become increasingly tedious – more so than they already are! Recall the
deﬁnition of θTSRV in the TSRV estimator, which determines the constant factor of the large
scale RV.
Theorem 4. When n1/3 ∆ → CT SRV , σϵ2 /∆ → Cϵ and m2 ∆ → Cm with CT SRV , Cϵ and
Cm ∈ (0, ∞), the following expansion shows the incremental bias due to estimation error and
noise correction induced by the use of TSRV:
(2m − 1)
TSRV
TSRV
Corr(V̂t+m∆,∆
− V̂t,∆
, Zt+m∆ − Zt ) = Corr(νt+m∆ − νt , Xt+m∆ − Xt ) √
2 m2 − m/3
× (1 + A4 + B4 )−1/2 [1 + o(m∆)],
where
−2
96θTSRV
Cϵ2
A4 =
CTSRV αγ 2 (6m − 2 − 3κCm )
8θTSRV (2ακ + γ 2 )
B4 =
.
κCTSRV γ 2 (6m − 2 − 3κCm )

For the same reasons behind the above theorem, using the parameter m helps resolving
the leverage eﬀect problems. When θTSRV is taken to be 0.5, with m = 1 and the same
set of parameters (ρ, κ, γ, α, ∆, n) = (−0.8, 5, 0.5, 0.1, 1/252, 390), the leverage eﬀect is barely
noticeable whereas using m = 73 yields a correlation of −0.483. Even though the bias is large,
the leverage eﬀect is clearly noticeable.
Again, the estimating biases can be decomposed into two factors. The ﬁrst factor is the
smoothing bias, the same as that in the RV and PAV below. The second factor reﬂects the
shrinkage biases due to estimation errors and noise correction errors. The rate of convergence
14

of TSRV is slower than that of RV. This is reﬂected in the factor CTSRV which is of order
n1/3 ∆, rather than C = n∆ in RV. Similarly, since PAV below has a faster rate of convergence
than TSRV, its corresponding shrinkage bias is smaller than TSRV but larger than RV. This is
reﬂected in CPAV = n1/2 ∆ in Theorem 5 below.
A parallel result to Theorem 4 for PAV is the following.
Theorem 5. When n1/2 ∆ → CP AV , σϵ2 /∆ → Cϵ , and m2 ∆ → Cm with CP AV , Cϵ and Cm ∈
(0, ∞), the following expansion shows the incremental bias due to estimation error and noise
correction induced by the use of PAV:
(2m − 1)
PAV
PAV
Corr(V̂t+m∆,∆
− V̂t,∆
, Zt+m∆ − Zt ) = Corr(νt+m∆ − νt , Xt+m∆ − Xt ) √
2 m2 − m/3
× (1 + A5 + B5 + C5 )−1/2 [1 + o(m∆)],
where
24Φ22 θPAV (2ακ + γ 2 )
ψ22 CP AV κγ 2 (6m − 2 − 3κCm )
96Φ12 Cϵ
B5 =
2
θPAV ψ2 CP AV γ 2 (6m − 2 − 3κCm )
48Φ11 Cϵ2
C5 = 3
,
θPAV ψ22 CP AV αγ 2 (6m − 2 − 3κCm )
A5 =

where ψ2 =

1
, Φ11
12

= 61 , Φ12 =

1
, Φ22
96

=

151
.
80640

Theorem 4 and Theorem 5 are also illustrated in Figure 4 in which the main terms of the
correlations are plotted. Again when m = 1, the correlation is nearly zero, whereas with the
ideal choice of m = 48, the ideal correlation is −0.599, still signiﬁcantly smaller than the true
one of −0.8.

5

A Solution to the Puzzle: Model-Independent Bias
Corrections

The previous section documented the various biases arising when estimating the leverage eﬀect
parameter ρ in four progressively more realistic scenarios. The message was decidedly gloomy:
even in idealized situations, the bias is large, and attempts to correcting for the latency of the
15

volatility, or for the presence of market microstructure noise, do not improve matters. In fact,
they often make matters worse. But, fortunately, they also point towards potential solutions
to the bias problem.

5.1

Back to the Latent Spot Volatility

First, we show that all the additional biases that are introduced by the latency of the spot
volatility can be corrected, and the problem is reduced to the discretization bias left in Theorem
1.
Recall the asymptotic expression given in Theorem 2, which can be inverted to yield:
√
2 m2 − m/3
Corr(νt+m∆ −νt , Xt+m∆ −Xt ) =
Corr(Vt+m∆,∆ −Vt,∆ , Xt+m∆ −Xt )+O(∆). (17)
(2m − 1)
Thus, up to a multiplicative correction factor that is independent of the model’s parameters,
the integrated volatility V can work as well as the spot volatility ν. The eﬀectiveness of this
simple bias correction is demonstrated in Figure 5.
+++ Insert Figure 5 Here +++
In the absence of microstructure noise, using the realized volatility (6), the asymptotic
relative bias in comparison with the use of the true spot volatility is given by Theorem 3. Using
the expressions given there, we can correct the bias due to the estimate of realized volatility back
to that based on the spot volatility. However, such a correction involves unknown parameters
in the Heston model and depends on the parametric assumption. However, the method is
applicable to a wider array of data generating processes. A nonparametric correction consists
in using the following result, demonstrated in the Appendix, in the proof of Theorem 3:
Proposition 3. When n∆ → C and m2 ∆ → Cm with C and Cm ∈ (0, ∞),
√
2 m2 − m/3
RV
RV
, Xt+m∆ − Xt ) + o(m∆),
− V̂t,∆
Corr(νt+m∆ − νt , Xt+m∆ − Xt ) = c3
Corr(V̂t+m∆,∆
(2m − 1)
(18)
where c3 is given by

(
c3 =

1−

4E [σt4 ] ∆2
RV
RV
n Var(V̂t+m∆,∆
− V̂t,∆
)

16

)−1/2
.

(19)

Note that in (19), the stationarity of the process of νt is used so that the correction factor
does not depend on t.
In practice, we can estimate E [σt4 ] nonparametrically based on the fact that the quarticity
satisﬁes

n ∑n
(Xt+(i+1)δ − Xt+iδ )4 →P ∆
i=0
3

∫

t+∆

σs4 ds as n → ∞
t

for any ﬁxed ∆. Hence a long run average of scaled quarticity can be used to estimate E [σt4 ].
The variance in (19) can be estimated by its sample version.
For the TSRV estimator, the bias correction admits the same form as (18) with a diﬀerent
correction.
Proposition 4. When n1/3 ∆ → CT SRV , σϵ2 /∆ → Cϵ and m2 ∆ → Cm for constants CT SRV , Cϵ
and Cm ∈ (0, ∞),
√
2 m2 − m/3
TSRV
TSRV
Corr(νt+m∆ − νt , Xt+m∆ − Xt ) = c4
Corr(V̂t+m∆,∆
− V̂t,∆
, Zt+m∆ − Zt ) + o(m∆)
(2m − 1)
where

(
c4 =

1−

−2
48θTSRV
σϵ4 + 8θTSRV E [σt4 ] ∆2
TSRV
TSRV
3n1/3 Var(V̂t+m∆,∆
− V̂t,∆
)

)−1/2
.

(20)

Two unknown quantities are involved and can be estimated nonparametrically here. For σϵ ,
∫t
∫t
RV
TSRV
since V̂t,∆
≈ 2nσϵ2 + t−∆ σs2 ds, V̂t,∆
≈ t−∆ σs2 ds for ﬁxed ∆ and big n, we can conclude that
RV
TSRV
a long run average of (V̂t,∆
− V̂t,∆
)/2n can be used as a good estimate of σϵ2 . This is similar to

the way the average of the subsampled RV estimators is bias-corrected to construct TSRV. For
E [σt4 ], since market microstructure noise is involved, the situation is a bit more complicated
∫t
than before. Consistent noise-robust estimators of t−∆ σs4 ds are proposed in Zhang et al. (2005)

17

and Jacod et al. (2009); we can use for instance the estimator called Q̂nt in the latter paper:
Q̂nt

=

1

n−k
n +1
∑

3θP2 AV ψ22

i=0

−

1
(
kn

n−2k
n +1 (
∑

δ
θP4 AV ψ22

i=0

k∑
n −1
j=⌊kn /2⌋

1
(
kn

1
Zt−∆+(i+j)δ −
kn

k∑
n −1
j=⌊kn /2⌋

⌊kn /2⌋−1

∑

Zt−∆+(i+j)δ )4

j=0

1
Zt−∆+(i+j)δ −
kn

i+2k
n −1
∑

⌊kn /2⌋−1

∑

Zt−∆+(i+j)δ )2 ×

j=0

(Zt−∆+(j+1)δ − Zt−∆+jδ )2

)

(21)

j=i+kn

+

δ

n−2
∑

4θP4 AV ψ22 i=1
∫ t
→P
σt4 dt,
t−∆
where ψ2 =

1
,
12

(Zt−∆+(i+1)δ − Zt−∆+iδ )2 (Zt−∆+(i+3)δ − Zt−∆+(i+2)δ )2 .

√
kn = [θPAV n] for an appropriately chosen θPAV . A scaled long run average of

this estimator can be used to estimate E [σt4 ].
For PAV, we have
Proposition 5. When n1/2 ∆ → CP AV , σϵ2 /∆ → Cϵ , and m2 ∆ → Cm for constants CP AV , Cϵ
and Cm ∈ (0, ∞),
√
2 m2 − m/3
PAV
PAV
Corr(νt+m∆ − νt , Xt+m∆ − Xt ) = c5
Corr(V̂t+m∆,∆
− V̂t,∆
, Zt+m∆ − Zt ) + o(m∆)
(2m − 1)
where

(
c5 =

1−

2(A′5

+ B5′ + C5′ )
PAV
PAV
n1/2 Var(V̂t+m∆,∆
− V̂t,∆
)

)−1/2
,

(22)

with
4Φ22 θPAV E [σt4 ]
,
ψ22
8Φ12 E [σt2 ] σϵ2
B5′ =
,
θPAV ψ22
4Φ11 σϵ4
C5′ = 3
,
θPAV ψ22
A′5 =

where ψ2 , Φ11 , Φ12 , Φ22 are as in Theorem 5.
A more direct way is to use the long run average of the quantity Γnt deﬁned in (3.7) of Jacod
et al. (2009) to estimate A′5 + B5′ + C5′ .
18

5.2

Correcting the Discretization Bias From Spot Volatilities

The above results reveal that the biases due to the various estimates are correctable back to the
case where the spot volatility can be viewed as observable. However, Theorem 1 implies that
the estimate of ρ based on νt itself is also biased. If the model were known, then the bias (11)
can be computed and corrected. However, this depends on the Heston model and its unknown
parameters.
A parameter-independent method is as follows. Let ρ̂m = Corr(νt+m∆ − νt , Xt+m∆ − Xt ).
Then, by Theorem 1 we see that
ρ̂m = ρ + bm + o(m∆).

(23)

This suggests that the parameter of interest ρ (as well as the slope b but this is not needed)
can be estimated by running a linear regression of the data {(m, ρ̂m )}. The bias-corrected
estimate of ρ is simply the intercept of that linear regression. The scatter plot of {(m, ρ̂m )} can
also suggest a region of m to run the above simple linear regression (23).
The above discussion suggests a rather general strategy for bias correction. The method does
not depend on the Heston model parameters. First, compute the simple correlation between
estimated changes of volatilities and estimated changes of prices. Second, conduct a preliminary
bias correction according to (17) – (22), depending on which estimated volatilities are used.
Third, run the simple regression equation (17) for the preliminary bias corrected estimated
correlations. Fourth, take the intercept of the simple linear regression as the ﬁnal estimate.
The method turns out to be very eﬀective in pratice, as we will now see.

6

Monte-Carlo Simulations

In this section, we use simulation studies to reproduce the leverage eﬀect puzzle and its proposed
solution and to verify the practical validity of the results presented in the previous section.

6.1

The data generating process

The true log-price is simulated from the Heston model (1)-(2) with broadly realistic parameter
values: α = 0.1 γ = 0.5, κ = 5, ρ = −0.8 and µ = 0.05 over 252 ∗ 5 trading days in ﬁve
years (∆ = 1/252). Each day, the sampling frequency is one minute per sample, giving an
19

intra-day number of observations of n = 390. Therefore the total number of observations over
5 years is N = 252 ∗ 390 ∗ 5 = 491, 400. The true price is latent. Instead, the observed data
{Ziδ }491,400
are contaminated with the market microstructure as in (7) with i.i.d N (0, σϵ2 ) noise,
i=1
and σϵ = 0.0005. (The case when the observation frequency is higher, n = 1560 is also studied.
The results are collected at the end of this section.)

6.2

Vizualizing the leverage eﬀect puzzle

With the latent spot volatility νt and latent price Xt known in simulated data, we can easily
examine the correlation of {(Xt∆ − X(t−1)∆ , νt∆ − ν(t−1)∆ )} over N observations. As expected,
the leverage eﬀect is strong, with the sample correlation being −0.787 for a given realization.
This is in line with the result of Theorem 1.
Next, consider the more realistic situation that the spot volatility needs to be estimated by
∫t
a smoothing method such as a local integrated average Vt,∆ = t−∆ σt2 dt. A natural estimate is
∑
2
2
the average of daily spot volatility V̂t,∆ = n−1 nj=1 σ̂t−∆+j/N
. In this ideal situation, σt−∆+j/N
∑
2
is known, resulting in Vt,∆ = n−1 nj=1 σt−∆+j/N
. The correlation of {(X(t+1)∆ −Xt∆ , V(t+1)∆,∆ −
Vt∆,∆ )}1259
t=1 is −0.462 for the given realization. This is in line with the result of Theorem 2. The
magnitude of the leverage eﬀect parameter ρ is signiﬁcantly under-estimated. To appreciate the
eﬀect of the tuning parameter m, the upper panels of Figure 6 plots the correlation {(X(t+m)∆ −
Xt∆ , ν(t+m)∆,∆ − νt∆,∆ )}1260−m
and {(X(t+m)∆ − Xt∆ , V(t+m)∆,∆ − Vt∆,∆ )}1260−m
against m. To
t=1
t=1
examine the sampling variabilities, the simulation is conducted 100 times. The averages of the
sample correlations are plotted along with its standard deviation in the ﬁgure. The impact of
m can easily be seen and the natural estimate based on Vt∆,∆ with m = 1 is far from optimal.
+++ Insert Figure 6 Here +++
In practice, the integrated volatility is not observable. It has to be estimated using the
discretely observed data. In absence of market microstructure noise, the realized volatility
provides a good estimate of the integrated volatility. Using RV based on the simulated latent
prices Xin , we have a sample correlation of −0.25 for the same realization discussed above.
RV
RV
More generally, the correlation of {{(X(t+m)∆ − Xt∆ , V̂(t+m)∆,∆
− V̂t∆,∆
)}1260−m
as a function of
t=1

m is depicted in the lower left panel of Figure 6. As above, this is repeated 100 times so that
the average correlations along with their errors at each m are computed.
20

For a more realistic situation, the integrated volatility has to be estimated based on the
contaminated log prices Zt in (7). The volatility parameter is now estimated by the correlation
PAV
PAV 1260−m
TSRV
TSRV 1260−m
{(Z(t+m)∆ − Zt∆ , V̂(t+m)∆,∆
− V̂t∆,∆
)}t=1
or {(Z(t+m)∆ − Zt∆ , V̂(t+m)∆,∆
− V̂t∆,∆
)}t=1
with

a suitable choice of m. The lower middel and right panels of Figure 6 shows the correlation as a
function of m. In particular, when m = 1, the sample correlation is merely −0.113 for PAV and
−0.107 for TSRV for the same simulated path as mentioned above, which would be interpreted
in practice as showing little support for the leverage eﬀect. But we know that this is due to the
statistical bias of the procedure as demonstrated in Theorem 4. Using PAV with m = 26, the
sample correlation is −0.682; and using TSRV with m = 62, the sample correlation is −0.553.
While this is still a biased estimate, the leverage eﬀect is now clearly seen.
The averages of these correlations against m are plotted together in Figure 7. These are in
line with what the theory predicts (see the left panel of Figure 4).
+++ Insert Figure 7 Here +++

6.3

Eﬀectiveness of the Bias Correction Method

We now illustrate the eﬀectiveness of the bias correction method proposed in Section 5. We
simulate sample paths with the same parameters as above. θTSRV and θPAV are both taken to be
0.5. For the linear regression method, we use the set of values of m as {6, 7, 8, 9, 10, 11, 12, 13, 14,
15, 16, 17}. Let us denote the bias corrected estimate of ρ as corNutorho with the correlation
based on the spot volatility as the input. Similarly, corVtorho, corRVtorho, corPAVtorho and
corTSRVtorho are the bias corrected ρ using the linear regression respectively based on the
corrected curves from V , V̂ RV V̂ PAV and V̂ TSRV , using equations (17), (18), (22) and (20). The
true values of Eσt4 , Eσt2 and σϵ are plugged in. Table 1 summarizes the results based on 100
simulations of (T = 5) minute-by-minute (n=390) data over a ﬁve-year period.
+++ Insert Table 1 Here +++
The mean of all of these corrected estimates are all close to the true value ρ =-0.8. This
means that these estimates are unbiased. The progressive harder of the problems can easily be
seen from the SD of the estimates. As demonstrated in Figure 8, the TSRV with the available
sample size incurs large estimation errors. This translates into the large error for estimating

21

ρ. When the sampling frequency is more frequent than one sample per minute, the estimation
error can be reduced.
In summary, Table 1 provides a stark evidence that the methods in Section 5 solve the
leverage eﬀect puzzle. It also quantiﬁes the extent to which the problem gets progressively
harder.
In practice, the parameters are unknown and hence the correction based directly on the
model parameters as in Table 1 is not feasible. In the following, we demonstrate the eﬀectiveness
of the non-parametric methods as described in section 5.1 to obtain corrections. corRVtorhoE,
corPAVtorhoE and corTSRVtorhoE are the bias corrected ρ using the linear regression based
on the non-parametrically corrected curves from V̂ RV , V̂ PAV and V̂ TSRV respectively. Estimates
are based on the same simulated sample paths as above. The results are collected in Table 2.
+++ Insert Table 2 Here +++
In this section, we used a ﬁxed range of m to run the regression regardless of the method
and realizations. As discussed in Section 5, the data-dependent and estimator-dependent choice
of the range can improve the results further. The scatterplot helps us empirically determine
an appropriate range. To illustrate the point, we randomly select a sample path from the
simulation, and then plot the corrected correlations up to the curve corresponding to Theorem
1: see Figure 8. After that, we identify the range of m values such that the corrected curve is
roughly linear. For this sample path, a range of m = (30, 31, · · · , 70) gives us a corPAVtorhoE
of -0.83, and a range of m = (40, 41, · · · , 80) gives us a corTSRVtorhoE of -0.85. These are
better than the corrections based on a generic choice of m = (6, 7, · · · , 17), which yields an
estimated correlation of -0.71 and -0.90 respectively. This tailor-made method will be used in
the empirical study below in order to improve the estimation.
+++ Insert Figure 8 Here +++
Note that as shown in the upper right panel of Figure 8, occasionally we may obtain extreme
results that the corrected correlation has an absolute value bigger than 1, especially when m
is small. One can truncate these observations back to the correct range as one likes. Indeed,
typically these values won’t aﬀect our ﬁnal results because we typically choose reasonably big
values of m in the ﬁnal step of correction using regression.

22

Without bias correction, as demonstrated in Section 2, sampling data at higher frequency
does not give us a better assessment of the leverage eﬀect. With the bias correction, we would
expect better results. Table 3 and Figure 9 demonstrate this further by the results with the
sampling frequency of one observation every 15 seconds, from which we see similar results but
with reduced estimation errors.
+++ Insert Table 3 Here +++
+++ Insert Figure 9 Here +++

7

Empirical Evidence on the Leverage Eﬀect at High
Frequency

We now apply our bias corrected methods to examine the presence of the leverage eﬀect using
high-frequency data. We have seen in Section 2 that, due to the latency of the volatility process,
it is nearly impossible to use only returns data and no extraneous volatility proxy to get as nice
a plot as what was shown in Figure 3. Nevertheless, we will demonstrate that the new tool
is able to reveal the presence of a strong leverage eﬀect contained in high-frequency data. We
only focus on the S&P 500 and MSFT returns; we have applied the methods to various data
sets and the conclusions are similar.

7.1

S&P 500 data

Based on the high-frequency returns (1 minute per sample) on S&P 500 futures from January
2004 to December 2007, the naive or natural estimates give the results reported in Table 4.
The leverage eﬀect at the natural choice of m = 1 is nearly 0. Even with the data-optimized
choice of m, the correlation with TSRV is estimated to be around −0.44 and that with the
PAV is around -0.50, much smaller than that computed based on the VIX. The upper panel
of Figure 10 summarizes the sample correlations based on TSRV, PAV and VIX respectively,
versus horizon m.
+++ Insert Table 4 Here +++

23

We now apply our bias corrected methods. First, we compute the preliminarily biascorrected estimates using both TSRV and PAV for a wide range of choice of m. Their scatter
plots are presented in Figure 10, which are quite curly. We then took the ﬁrst increasing region
(because the biases are expected to get larger with m after correction so that the slope should
be positive) that appears approximately linear. For TSRV, we take m = (55, 56 · · · , 100) to run
the regression and obtain the intercept of −0.85. This is our bias-corrected estimated leverage
eﬀect parameter implied in the high frequency data. Similarly, for PAV, we selected the range
m = (55, 56, · · · , 85), the bias-corrected correlation based on PAV is estimated as −0.68.
+++ Insert Figure 10 Here +++

7.2

Microsoft

We now use our method to examine how strong the leverage eﬀect for the Microsoft corporation.
The high-frequency returns at sample frequencies of one data point per minute and one per 5
seconds from January 2005 to June 2007 are used for estimating the leverage eﬀect parameter.
Again, we apply both the naive method, the simple sample correlation, and more sophisticated
volatility estimation methods, based on preliminary correction and linear regression. Table
5 summarizes the results. Again, the leverage eﬀects are barely noticeable at both sampling
frequencies for natural choices of m (small values of m).
+++ Insert Table 5 Here +++
For the data sampled at one observation per minute, the preliminary corrections are summarized in the left panel of Figure 11. This helps us determine a region where the linear
regression should be run. Based on regression (taking m = (130, 131, · · · , 170)), the leverage
eﬀect parameter is estimated as −0.72 with TSRV and −0.68 with PAV. Again, we ﬁnd that
the leverage eﬀect is much stronger than one would obtain without bias-correction.
+++ Insert Figure 11 Here +++
The analysis for the data sampling at 5-second frequency produces similar results. The range
m = (130, 131, · · · , 170) is determined based on preliminary corrections depicted in Figure 12
(left panel). Using this range of estimates to run a simple linear regression yields an estimated
leverage eﬀect parameter. It is −0.76 based on TSRV and −0.78 based on PAV.
+++ Insert Figure 12 Here +++
24

8

Conclusions

There are diﬀerent sources of error when estimating the leverage eﬀect using high-frequency
data, a discretization error due to not observing the full instantaneous stochastic processes, a
smoothing error due to using integrated volatility in place of spot volatilities, an estimation
error due to the need to estimate the integrated volatility using the price process, and a noise
correction error introduced by the need to correct the integrated volatility estimates for the
presence of market microstructure noise.
These errors tend to be large even when the window size is small and lead to signiﬁcant
bias in the leverage eﬀect estimation. They are also concave as a function of the length of time,
controlled by m, used to compute changes in the variables. We have shown that these errors
can have an adverse eﬀect on the assessment of the leverage eﬀect.
Fortunately, these errors are correctable to the extent where spot volatility is used for a
certain range of m. There is still a substantial discretization bias that remains when using the
spot volatility over a large time horizon, yet a reasonable large choice of m is necessary so that
biases based on integrated volatility becomes correctable. This leads us to further correct the
biases by aggregating the information in various preliminary estimates of the leverage eﬀect
over diﬀerent values of m. This is achieved by using a simple linear regression technique. The
methods’ eﬀectiveness is demonstrated using both simulated examples and empirical study of
real asset returns data.
In summary, a seemingly natural application of integrated volatility estimators to assess the
leverage eﬀect can lead to severe bias. Perhaps paradoxically, attempts to improve the estimation by employing statistically better volatility estimators (such as noise-robust estimators)
can actually make matters worse as far as the estimation of the leverage eﬀect is concerned.
We show instead that to assess the leverage eﬀect using high-frequency data, it is necessary to
ﬁrst do a preliminary bias correction and then further aggregate these preliminary estimates
by running a local linear regression.

25

Appendix
A

Preliminary Results

We ﬁrst compute some moments that are related to the Heston model. They will be useful for
proofs of Theorems 1–4. Throughout the appendix, we use the notation Eν and Varν to denote
the conditional mean and conditional variance given the latent volatility process {νt }, and Et
denote the conditional expectation given the ﬁltration up to time t. Other similar notations
will be adopted.

A.1

Conditional Moments of Returns,

Rewrite the process as
1/2

dXt = (µ − νt /2)dt + ρνt dWt +

√
1/2
1 − ρ2 νt dZt ,

(24)

where Zt is another Brownian motion process independent of W . Let Yt = γXt − ρνt , which
eliminates the dWt term. Then, it follows that
dYr = [γµ − ρκα + (ρκ − γ/2)νr ] dr +

√

1 − ρ2 νr1/2 dZr .

Denoting by a = µ − ρκα/γ, b = ρκ/γ − 1/2 and c = ρ/γ, we have from the above expression
that

∫

u

Xu − Xs =

}
{
√
1/2
2
(a + bνt ) dt + 1 − ρ νt dZt + c(νu − νs ).

(25)

s

Hence, conditioning on the process {νt }, Xu − Xs is normally distributed with mean
∫ u
Eν (Xu − Xs ) =
(a + bνt )dt + c(νu − νs ) ≡ µν

(26)

s

and variance

∫
Var v (Xu − Xs ) = (1 − ρ )

u

νt dt ≡ σν2 .

2

(27)

s

Using the moment formulas of the normal distribution, we can easily obtain the ﬁrst four
moments for the changes of the prices:
Eν (Xu − Xs )2 = µ2ν + σν2 ,
Eν (Xu − Xs )3 = µ3ν + 3µν σν2 ,
Eν (Xu − Xs )4 = µ4ν + 3σν4 + 6µ2ν σν2 .
26

A.2

Cross-Moments of the Feller Process

We now compute the cross-moments of the Feller process {νt }. First of all, it is well known
that

γ2α
E(νt ) = α and Var(νt ) =
.
2κ

(28)

Using again the Ito’s formula, we have
1/2

d(eκt νt ) = καeκt dt + γeκt νt dWt ,
which implies for s > t,
E(νs |νt ) = e−κ(s−t) νt + α(1 − e−κ(s−t) ).

(29)

Similarly, by using the Ito’s formula again,
3/2

d(eκt νt )2 = (2κα + γ 2 )e2κt νt dt + 2γe2κt νt dWt .
This together with (29) imply that for s > t,
E(νs2 |νt )

=e−2κ(s−t) νt2

+e

−2κs

∫

s

(2κα + γ 2 )e2κu E(νu |νt )du
t

2κα + γ 2
(νt − α)(e−κ(s−t) − e−2κ(s−t) )
κ
2κα2 + γ 2 α
(1 − e−2κ(s−t) ).
+
2κ

=e−2κ(s−t) νt2 +

(30)

Therefore, for r ≤ s,
E(νr νs ) = E(νr E(νs |νr ))
= E[νr2 e−κ(s−r) + α(1 − e−κ(s−r) )νr ]
= α2 + γ 2 αe−κ(s−r) /(2κ).

(31)

Using the same technique, we can calculate higher moments and cross-moments. From
1/2

d(eκt νt )3 = 3e2κt νt2 (καeκt dt + γeκt νt dWt ) + 3(eκt νt )γ 2 e2κt νt dt,
we have

∫
κt

3

E(e νt ) =

Eν03

t

(κα + γ 2 )e3κu Eνu2 du.

+3
0

27

(32)

Using the fact that Eνt3 = Eν03 and Eνu2 = α2 + γ 2 α/(2κ), we deduce that
Eνt3 = (α +

γ2
γ2α
)(α2 +
).
κ
2κ

Recall that Et denote the conditional expectation given the ﬁltration up to time t. For s > t,
we deduce from (32) that

∫
κs

3

Et (e νs ) =

eκt νt3

s

(3κα + 3γ 2 )e3κu Et νu2 du.

+
t

Now, substituting (30) into the above expression, we obtain after some calculation that
[
Et νs3 =e−3κ(s−t) νt3 + 3β1 (eκ(s−t) − 1)νt2 + 1.5β1 β2 (e2κ(s−t) − 2eκ(s−t) + 1)νt
(
)]
+ 0.5αβ1 β2 3eκ(s−t) − 3e2κ(s−t) + e3κ(s−t) − 1 ,

(33)

where β1 = α + γ 2 /κ and β2 = 2α + γ 2 /κ. For r < s < u, by using conditional expectation and
(29), we have
E(νr νs νu ) = Eνr νs [α + e−κ(u−s) (νs − α)]
= αE(νr νs ) + e−κ(u−s) E[νr Er (νs2 − ανs )].
Substituting (29)-(31) into the above formula, the resulting expression involves only the ﬁrst
three moments of νr , which has already been derived. Therefore, after some calculation, it
follows that
E(νr νs νu ) = α3 +

]
γ 2 α2 [ −κ(s−r)
e
+ e−κ(u−r) + e−κ(u−s) + γ 2 κ−1 α−1 e−κ(u−r) .
2κ

(34)

The fourth order cross-moment can be derived analogously using what has already been
derived along with the Ito formula:
1/2

d(eκt νt )4 = 4e3κt νt3 (καeκt dt + γeκt νt dWt ) + 6(e2κt νt2 )γ 2 e2κt νt dt.
We omit the detailed derivations, but state the following results:
E(νt4 ) = (α +

3γ 2
γ2
γ2α
)(α + )(α2 +
),
2κ
κ
2κ

(35)

and for r < s < u < t,
]
α3 γ 2 [ −κ(u−r)
−κ(t−r)
−κ(s−r)
−κ(u−s)
−κ(t−s)
−κ(t−u)
E(νr νs νu νt ) =α +
e
+e
+e
+e
+e
+e
2κ
]
α2 γ 4 [ −κ(t+u−r−s)
−κ(u−r)
−κ(t−r)
−κ(s+t−u−r)
−κ(t−s)
+
e
+
e
+
2e
+
e
/2
+
e
2κ2
]
αγ 6 [ −κ(t+u−r−s)
−κ(t−r)
+ 3 e
.
(36)
+ 2e
4κ
4

28

B

Proofs of the Theorems

B.1

Proof of Theorem 1

Let us ﬁrst compute the covariance. It follows from (25) that
Cov(νt+s − νt , Xt+s − Xt )
[∫ t+s
]
=E(νt+s − νt )
(a + bνu )du + c(νt+s − νt )
t
∫ t+s
[E(νu νt+s ) − E(νu νt )]du + cE(νt+s − νt )2 .
=b
t

Now, using the moment formulas (28) and (31) and some simple calculus, we have
Cov(νt+s − νt , Xt+s − Xt ) = αγρ[1 − exp(−sκ)]/κ.
By using (28) and (31) again, we easily obtain
Var(νt+s − νs ) = γ 2 α[1 − exp(−κs)]/κ.

(37)

Hence, it remains to compute Var(Xt+s − Xt ). By (26) and (27),
Var(Xt+s − Xt ) = Var(µν ) + E(σν2 ) = E(µ2ν + σν2 ) − (E(µν ))2
∫ t+s ∫ t+s
∫ t+s
=
E(a + bνr )(a + bνu )drdu + 2bc
Eνr (νt+s − νt )dr
t
t
t
∫ t+s
2
2
2
+ c E(νt+s − νt ) + (1 − ρ )αs − (
a + bE(νr )dr)2 .
t

Using the moments for νt computed in section A.2, after some calculus, we obtain
(
)( 2
)
e−κs − 1
γ α γαρ
Var(Xt+s − Xt ) = s +
−
+ αs.
κ
4κ2
κ

(38)

Finally, combinations of the covariance and variance expressions lead to the correlation
formula in Theorem 1.
Expanding the result of Theorem 1 around s = 0, we obtain the Proposition 1.

B.2

Proof of Theorem 2 and Proposition 2

Recall Vt,∆ =

∫t
t−∆

νs ds. Let us compute the variance of the change of the ideally estimated

spot volatility. Note that E(Vt+m∆,∆ − Vt,∆ ) = 0. Using the stationarity of the process {νt },
29

we have
Var(Vt+m∆,∆ − Vt,∆ ) =E(Vt+m∆,∆ − Vt,∆ )2
∫ t ∫ t
∫
=2
Eνs νu ds du − 2
t−∆

t−∆

t+m∆

∫

t

Eνs νu ds du.

t+(m−1)∆

t−∆

Now, by (31), the above variance is given by
∫ t ∫ u [
∫ t+m∆ ∫ t [
γ 2 α −κ(u−s) ]
γ 2 α −κ(u−s) ]
2
4
α +
e
ds du − 2
α2 +
e
ds du.
2κ
2κ
t−∆ t−∆
t+(m−1)∆ t−∆
Simple calculus leads to
Var(Vt+m∆,∆ − Vt,∆ ) = αγ 2 B22 /4,
where B2 is as given in Theorem 2. Comparing this with the variance of diﬀerenced spot
volatilities, we have
Var(Vt+m∆,∆ − Vt,∆ )
= 1 + Rv (m, ∆),
∆2 Var(νt+m∆ − νt )(1 − 1/3m)

(39)

where Rv (m, ∆) is such that

|Rv (m, ∆)|
< ∞.
∆
m∆→0
In particular, Rv (m, ∆) = O(∆) for any m as ∆ → 0, and Rv (m, ∆) = o(m∆) if m → ∞ and
lim sup

m∆ → 0.
Next, we compute the covariance. By (26) and the double expectation formula, we have
Cov(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt )
∫ t
[ ∫ t+m∆
][ ∫ t+m∆
]
=E
νs ds −
νs ds
(a + bνr )dr + c(νt+m∆ − νt )
∫

t+(m−1)∆
∫ t+m∆
t+m∆

t−∆

t

∫

t

∫

t+m∆

E(νs νr )drds − b

=b
t+(m−1)∆ t
∫ t+m∆

E(νs νr )drds
t−1 t
∫ t

Eνs (νt+m∆ − νt )ds − c

+c
t+(m−1)∆

Eνs (νt+m∆ − νt )ds.
t−1

Using (31), after some calculus, we obtain that
Cov(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt ) = αγA2 /(4κ3 ),
where A2 is again as given in Theorem 2. The conclusion of Theorem 2 follows from (38) and
the above results. Comparing this with the covariance based on the spot volatilities, we have
Cov(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt )
= 1 + Rc (m, ∆),
∆ Cov(νt+m∆ − νt , Xt+m∆ − Xt )(1 − 1/2m)
30

(40)

where Rc (m, ∆) satisﬁes lim supm∆→0

|Rc (m,∆)|
∆

< ∞.

By (39) and (40) the following asymptotic expressions are easily obtained:
(2m − 1)
Corr(Vt+m∆,∆ − Vt,∆ , Xt+m∆ − Xt ) = Corr(νt+m∆ − νt , Xt+m∆ − Xt ) √ 2 m
2 m − 3

 O(∆), when ∆ → 0 for any m
+
 o(m∆), when m → ∞, m∆ → 0,

(41)

which proves the Proposition 2.

B.3

Proof of Theorem 3 and Proposition 3

The calculation is very involved. We separate them into several subsections so that the structure
of computation can be better recognized. Recall that n = ∆/δ. Without loss of generality, we
RV
RV
assume that t = ∆ and rewrite V̂∆,∆
= V̂∆RV . Note that it is easy to verify that E(V̂(m+1)∆,∆
−

V̂∆RV ) = 0.
B.3.1

[
]
Calculation of E V̂∆RV (X(m+1)∆ − X∆ )

Note that V̂∆RV and X(m+1)∆ − X∆ involve two diﬀerent time intervals. By conditioning on the
latent process {νt }, V̂∆RV and X(m+1)∆ − X∆ are independent by (25). Thus,
[
]
[
]
E V̂∆RV (X(m+1)∆ − X∆ ) = E Eν V̂∆RV Eν (X(m+1)∆ − X∆ ) .
Using (25)–(27), the above expectation is given by
{ ∫
∫
n−1
[ (i+1)δ
]2
∑
2
E
(a + bνr )dr + cν(i+1)δ − cνiδ + (1 − ρ )
{∫

iδ

i=0

·

(a + bνr )dr + cν(m+1)∆ − cν∆

νr dr

iδ

}

(m+1)∆

}

(i+1)δ

.

(42)

∆

Expanding the ﬁrst curly bracket into four terms, we have 4 product terms with the second
curly bracket in (42). Denote those four terms by I1 , · · · , I4 , respectively.
We now deal with each of the four terms. The ﬁrst term is given by
} ∫
{∫
n−1
[ (i+1)δ
]2
(m+1)∆
∑
(a + bνr )dr .
I1 ≡
(a + bνr )dr + cν(m+1)∆ − cν∆
i=0

iδ

∆

31

Expressing the square-term above as the double integral, I1 involves only the third cross
moment of the process {νt }. By using (31) and (34), it follows that
I1 =

n−1 ∫
∑

(m+1)∆

∫

(i+1)nδ

∫

r

−2

iδ
i=0 ∆
∫
∫
n−1
r
(i+1)δ
∑

+

i=0 iδ
2 4

iδ

2ca2

iδ

γ 4 a3 −κ(s−u)
e
dudrds
2κ2 α2

]
γ 4 [ −κ((m+1)∆−u)
−κ(∆−u)
dudr
e
−
e
2κ2 α

a γ (a + αcκ) m∆3
=−
+ R1 ,
2α2 κ2
n
where R1 satisﬁes that limn→∞ supm≥1 sup∆≤1

|R1 |n
m∆3

= 0. In particular, we have,

I1
∆
= O( ),
2
m∆
n
as ∆ → 0 and n → ∞ or as m → ∞, m∆ → 0, and n → ∞.
Using the same argument, the second term can be calculated as follows:

I2 ≡ 2c
=

{∫
n−1
∑

(m+1)∆

(a + bνr )dr + cν(m+1)∆ − cν∆

∆
i=0
n−1 [ ∫ (m+1)∆
∑
∆

i=0

∫

2ac2
iδ

(i+1)δ

]
(a + bνr )dr (ν(i+1)δ − νiδ )

iδ

∫

(i+1)δ

]
γ 4 [ −κ(s−r)
−κ(s−iδ)
e
−e
drds
2ca
2κ2 α
2

iδ

(i+1)δ

+

} ∫
[

]
γ 4 [ −κ((m+1)−iδ)
−κ((m+1)∆−r)
−κ(∆−iδ)
−κ(∆−r)
e
−
e
−
e
+
e
dr,
2κ2

where the cross moment function of the process {νt } is used. We have
I2 =

acγ 4 (a + αcκ) m∆3
+ R2 ,
2ακ
n

where R2 satisﬁes that limn→∞ supm≥1 sup∆≤1

|R2 |n
m∆3

= 0. Hence,

I2
∆
= O( ),
2
m∆
n
as ∆ → 0 and n → ∞ or as m → ∞, m∆ → 0, and n → ∞.
Similarly, we can calculate the third term and the fourth term based on the cross moments
of the process {νt }. They are given by
(
)
(
)
I3 = − c2 γ 4 e∆κ − 1 e−∆κ(m+1) e∆κm − 1 (a + αcκ)/(2κ3 ),
(
)(
)
(
)
I4 =γ 2 ρ2 − 1 e∆κ − 1 e−∆κ(m+1) e∆κm − 1 (a + αcκ)/(2κ3 ).
32

B.3.2

RV
Calculation of E V̂(m+1)∆,∆
(X(m+1)∆ − X∆ ) and covariance

RV
By the deﬁnition of V̂(m+1)∆,∆
, it follows that

RV
E V̂(m+1)∆,∆
(X(m+1)∆ − X∆ ) = E

n−1
∑

[Xm∆+(i+1)δ − Xm∆+iδ ]2

i=0

{
}
× (Xm∆+iδ − X∆ ) + (Xm∆+(i+1)δ − Xm∆+iδ ) + (X(m+1)∆ − Xm∆+(i+1)δ ) .
Let J1 , J2 and J3 be respectively the product of the ﬁrst, second and third term in the curly
bracket with that in square bracket. Each of these terms can be treated similarly as those in
Section B.3.1. That is, by conditioning on the process {νt }, they can be reduced to the calculation of the cross moments of {νt }, by using the conditional moments in section A.1. After
tedious calculations involving the cross moments discussed in section A.2, we can obtain asymptotic expressions for J1 , J2 and J3 . Using these together with what we get for I1 , · · · , I4 , we can
RV
easily obtain an asymptotic expression of Cov(V̂(m+1)∆,∆
− V̂∆RV , X(m+1)∆ − X∆ ). Comparing

this asymptotic expression with what we have obtained in Theorem 2, we conclude that
RV
m−1 ∆−2 Cov(V̂(m+1)∆,∆
− V̂∆RV , X(m+1)∆ − X∆ )

1
=m−1 ∆−2 Cov(V(m+1)∆,∆ − V∆,∆ , X(m+1)∆ − X∆ ) + O( ) as n → ∞
n

(43)

=m−1 ∆−2 Cov(V(m+1)∆,∆ − V∆,∆ , X(m+1)∆ − X∆ ) + o(m∆),
as ∆ → 0, n∆ → C and m∆ → 0.
B.3.3

Calculation of the variance of changes of estimated RV

Let Yi = X(i+1)δ − Xiδ . Then,
E(V̂∆RV )2

=

n−1
∑

EYi4

+2

i=0

n−1 ∑
i−1
∑

EYi2 Yj2 .

i=1 j=1

By using the expression at the end of Section A, we have
)4
(∫
(i+1)δ

(a + bνr )dr + cν(i+1)δ − cνiδ

EYi4 =E
iδ

∫

(∫

(i+1)δ

+ 6(1 − ρ2 )E

+ 3E

(

∫

(1 − ρ2 )

νr dr

(i+1)δ

(a + bνr )dr + cν(i+1)δ − cνiδ
iδ

33

)2

(i+1)δ

iδ

νr dr ·
iδ

(44)

)2
.

By conditioning on the process {νt }, Yi2 and Yj2 are conditionally independent for j < i.
Appealing to (26) and (27), we have that for j < i
(

)2
∫ (i+1)δ
 ∫ (i+1)δ
EYi2 Yj2 =E 
(a + bνr )dr + cν(i+1)δ − cνiδ + (1 − ρ2 )
νr dr

iδ
iδ
(

)2
∫ (j+1)δ
∫ (j+1)δ

2


·
(a + bνr )dr + cν(j+1)δ − cνjδ + (1 − ρ )
νr dr
.

jδ
jδ
Both terms above only involve the cross moments of the process {νt }. After tedious calculations,
we can show that
(
)2
αγ 2 2 αγ 2 3 α (3ρ4 − 6ρ2 + 4) (2ακ + γ 2 ) ∆2
∆
RV
E V̂∆
)∆ −
∆ +
+ o( ),
= (α2 +
2κ
6
κ
n
n
(
)2
RV
when ∆ → 0 and n∆ → C. This is the same for E V̂(m+1)∆,∆
.

(45)

By conditioning on the process {νt }, using the conditional independence, we have
RV
E V̂∆RV V̂(m+1)∆,∆
(
)2
∫ (i+1)δ
∫
n−1
n−1
∑∑
2
=
E
(a + bνr )dr + cν(i+1)δ − cνiδ + (1 − ρ )
iδ

i=0 j=0

(
∫
·


(i+1)δ

νr dr

iδ

)2

(j+1)δ

(a + bνm∆+r )dr + cνm∆+(j+1)δ − cνm∆+jδ

∫


(j+1)δ

+ (1 − ρ2 )

jδ

νm∆+r dr .

jδ

Again, tedious calculations involving the cross moments of the process {νt } yield
RV
=
E V̂∆RV V̂(m+1)∆,∆

α (2ακ + γ 2 ) 2
∆ − αγ 2 m∆3 + o(∆3 ),
κ

(46)

as ∆ → 0 and n∆ → C. Combination of (45) and (46) results in
RV
RV
RV
Var(V̂(m+1)∆,∆
− V̂∆RV ) =E(V̂∆RV )2 + E(V̂(m+1)∆,∆
)2 − 2E(V̂∆RV V̂(m+1)∆,∆
)
[
]
αγ 2 2 αγ 2 3 α (2ακ + γ 2 ) ∆2
=2 (α2 +
)∆ −
∆ +
2κ
6
κ
n
[
]
2
α (2ακ + γ ) 2
∆ − αγ 2 m∆3 + o(∆3 ).
−2
κ

(47)

as ∆ → 0 and n∆ → C. Comparing this with the variance expression obtained in the proof of
Theorem 2, we have
RV
− V̂∆RV ) = Var(Vt+m∆,∆ − Vt,∆ ) +
Var(V̂(m+1)∆,∆

34

2α (2ακ + γ 2 ) ∆2
+ o(∆3 ),
κ
n

Or, equivalently,
RV
m−1 ∆−3 Var(V̂(m+1)∆,∆
− V̂∆RV )
(
)
4Eσt4 ∆2
1
−1 −3
Var(Vt+m∆,∆ − Vt,∆ ) +
+ o( )
=m ∆
n
m
2
2α (2ακ + γ )
=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ ) +
+ o(m∆),
κCm

(48)
(49)

when m2 ∆ → Cm .
B.3.4

Adjustment to Leverage Parameter

Further from (37) and (39), we have
m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ ) = γ 2 α −

γ2α 1 2
− αγ κm∆ + o(m∆),
3m
2

(50)

and (48) becomes
RV
m−1 ∆−3 Var(V̂(m+1)∆,∆
− V̂∆RV )

=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ )(1 +

(51)
6 (2ακ + γ 2 )
) + o(m∆).
(3γ 2 m − γ 2 )κC − 32 γ 2 κ2 CCm

(52)

By using (43), (51) and (41), we can easily obtain the following relationship:
RV
Corr(V̂(m+1)∆,∆
− V̂∆RV , X(m+1)∆ − X∆ )

= Corr(V(m+1)∆ − V∆ , X(m+1)∆ − X∆ )) · √
1+
= Corr(νm+t − νt , Xm+t − Xt ) · √
(1 +

1

[1 + o(m∆)]

12ακ+6γ 2
(3γ 2 m−γ 2 )κC− 32 γ 2 κ2 CCm

1 − 1/2m
12ακ+6γ 2
)(1
(3γ 2 m−γ 2 )κC− 23 γ 2 κ2 CCm

−

1
)
3m

[1 + o(m∆)],

as ∆ → 0, n∆ → C and m2 ∆ → Cm .
Proposition 3 follows from (41), (43) and (48).

B.4

Proof of Theorem 4 and Theorem 5

Under the assumptions that n1/3 ∆ → CT SRV and σϵ2 /∆ → Cϵ , we have
TSRV
− V̂∆TSRV , Z(m+1)∆ − Z∆ )
m−1 ∆−2 Cov(V̂(m+1)∆,∆

=m−1 ∆−2 Cov(V(m+1)∆,∆ − V∆,∆ , X(m+1)∆ − X∆ ) + o(m∆)
35

(53)

and
TSRV
m−1 ∆−3 Var(V̂(m+1)∆,∆
− V̂∆TSRV )
(
)
−2
16θTSRV
σϵ4 8θTSRV Eσt4 ∆2
−1 −3
=m ∆
Var(Vt+m∆,∆ − Vt,∆ ) +
+
+ o(m∆)
n1/3
3n1/3
−2
16θTSRV
Cϵ2 8θTSRV Eσt4
=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ ) +
+
+ o(m∆)
mCT SRV
3mCT SRV

=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ )[1 + A4 + B4 + o(m∆)],
where A4 =

−2
Cϵ2
96θTSRV
,
CT SRV αγ 2 (6m−2−3κCm )

B4 =

Under the assumptions that n1/2 ∆

(54)

(55)

8θTSRV (2ακ+γ 2 )
, by (50).
κCT SRV γ 2 (6m−2−3κCm )
→ CP AV and σϵ2 /∆ → Cϵ , with

the constants ψ2 , Φ11 ,

Φ12 , Φ22 as speciﬁed in Theorem 5, we have
PAV
m−1 ∆−2 Cov(V̂(m+1)∆,∆
− V̂∆PAV , Z(m+1)∆ − Z∆ )

=m−1 ∆−2 Cov(V(m+1)∆,∆ − V∆,∆ , X(m+1)∆ − X∆ ) + o(m∆),

(56)

and
PAV
m−1 ∆−3 Var(V̂(m+1)∆,∆
− V̂∆PAV )
(
)
8Φ22 θPAV Eσt4 ∆2 16Φ12 Eσt2 σϵ2 ∆
8Φ11 σϵ4
−1 −3
=m ∆
Var(Vt+m∆,∆ − Vt,∆ ) +
+
+ 2
+ o(m∆)
ψ22 n1/2
θPAV ψ22 n1/2
θPAV ψ22 n1/2

(57)
=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ ) +

8Φ22 θPAV Eσt4
mψ22 CP AV

+

16Φ12 Eσt2 Cϵ
mθPAV ψ22 CP AV

+

8Φ11 Cϵ2
2
mθPAV
ψ22 CP AV

=m−1 ∆−3 Var(Vt+m∆,∆ − Vt,∆ )[1 + A5 + B5 + C5 + o(m∆)],
24Φ22 θPAV (2ακ+γ 2 )
,
ψ22 CP AV κγ 2 (6m−2−3κCm )
2
48Φ11 Cϵ
.
2
θPAV
ψ22 CP AV αγ 2 (6m−2−3κCm )

where A5 =
C5 =

B5 =

96Φ12 Cϵ
θPAV ψ22 CP AV γ 2 (6m−2−3κCm )

+ o(m∆)
(58)

and

Similar as in section B.3.4, Theorem 4 follows by (53) and (55), and Theorem 5 by (56) and
(58). Proposition 4 follows by (53) and (54), and Proposition 5 by (56) and (57).

36

References
Aı̈t-Sahalia, Y., Fan, J., and Xiu, D. (2010), “High-Frequency Covariance Estimates with Noisy
and Asynchronous Data,” Journal of the American Statistical Association, 105, 1504–1517.
Aı̈t-Sahalia, Y. and Kimmel, R. (2010), “Estimating Aﬃne Multifactor Term Structure Models
Using Closed-Form Likelihood Expansions,” Journal of Financial Economics, 98, 113–144.
Aı̈t-Sahalia, Y., Mykland, P. A., and Zhang, L. (2005), “How Often to Sample a ContinuousTime Process in the Presence of Market Microstructure Noise,” Review of Financial Studies,
18, 351–416.
— (2011), “Ultra High Frequency Volatility Estimation with Dependent Microstructure Noise,”
Journal of Econometrics, 160, 190–203.
Bandi, F. M. and Russell, J. R. (2006), “Separating microstructure noise from volatility,”
Journal of Financial Economics, 79, 655–692.
Barndorﬀ-Nielsen, O. E., Hansen, P. R., Lunde, A., and Shephard, N. (2008a), “Designing realized kernels to measure ex-post variation of equity prices in the presence of noise,” Econometrica, 76, 1481–1536.
— (2008b), “Multivariate Realised Kernels: Consistent Positive Semi-Deﬁnite Estimators of
the Covariation of Equity Prices with Noise and Non-Synchronous Trading,” Tech. rep.,
Department of Mathematical Sciences, University of Aarhus.
Bekaert, G. and Wu, G. (2000), “Asymmetric Volatility and Risk in Equity Markets,” Review
of Financial Studies, 13, 1–42.
Black, F. (1976), “Studies of Stock Price Volatility Changes,” in Proceedings of the 1976 Meetings of the American Statistical Association, pp. 171–181.
Bollerslev, T., Litvinova, J., and Tauchen, G. (2006), “Leverage and Volatility Feedback Eﬀects
in High-Frequency Data,” Journal of Financial Econometrics, 4, 353–384.
Bollerslev, T., Sizova, N., and Tauchen, G. T. (2011), “Volatility in Equilibrium: Asymmetries
and Dynamic Dependencies,” Review of Finance, forthcoming.

37

Campbell, J. Y. and Hentschel, L. (1992), “No News is Good News: An Asymmetric Model of
Changing Volatility in Stock Returns,” Journal of Financial Economics, 31, 281–318.
Christie, A. A. (1982), “The Stochastic Behavior of Common Stock Variances: Value, Leverage
and Interest Rate Eﬀects,” Journal of Financial Economics, 10, 407–432.
Delattre, S. and Jacod, J. (1997), “A Central Limit Theorem for Normalized Functions of the
Increments of a Diﬀusion Process, in the Presence of Round-Oﬀ Errors,” Bernoulli, 3, 1–28.
Duﬀee, G. R. (1995), “Stock Returns and Volatility: A Firm-level Analysis,” Journal of Financial Economics, 37, 399–420.
Engle, R. F. and Ng, V. K. (1993), “Measuring and Testing the Impact of News on Volatility,”
The Journal of Finance, 48, 1749–1778.
Epps, T. W. (1979), “Comovements in Stock Prices in the Very Short Run,” Journal of the
American Statistical Association, 74, 291–296.
Fan, J. and Wang, Y. (2007), “Multi-Scale Jump and Volatility Analysis for High-Frequency
Financial Data,” Journal of the American Statistical Association, 102, 1349–1362.
Figlewski, S. and Wang, X. (2000), “Is the ”Leverage Eﬀect” a Leverage Eﬀect?” Tech. rep.,
New York University.
French, K. R., Schwert, G. W., and Stambaugh, R. F. (1987), “Expected stock returns and
volatility,” Journal of Financial Economics, 19, 3–29.
Gatheral, J. and Oomen, R. C. (2010), “Zero-intelligence realized variance estimation,” Finance
and Stochastics, 14, 249–283.
Griﬃn, J. and Oomen, R. (2008), “Sampling returns for realized variance calculations: Tick
time or transaction time?” Econometric Reviews, 27, 230–253.
Hansen, P. R. and Lunde, A. (2006), “Realized Variance and Market Microstructure Noise,”
Journal of Business and Economic Statistics, 24, 127–161.
Hayashi, T. and Yoshida, N. (2005), “On Covariance Estimation of Non-synchronously Observed Diﬀusion Processes,” Bernoulli, 11, 359–379.
38

Heston, S. (1993), “A closed-form solution for options with stochastic volatility with applications to bonds and currency options,” Review of Financial Studies, 6, 327–343.
Jacod, J., Li, Y., Mykland, P. A., Podolskij, M., and Vetter, M. (2009), “Microstructure Noise
in the Continuous Case: The Pre-Averaging Approach,” Stochastic Processes and Their
Applications, 119, 2249–2276.
Kalnina, I. and Linton, O. (2008), “Estimating quadratic variation consistently in the presence
of endogenous and diurnal measurement error,” Journal of Econometrics, 147, 47–59.
Kinnebrock, S. and Podolskij, M. (2008), “Estimation of the Quadratic Covariation Matrix in
Noisy Diﬀusion Models,” Tech. rep., Oxford-Man Institute, University of Oxford.
Large, J. (2007), “Accounting for the Epps Eﬀect: Realized Covariation, Cointegration and
Common Factors,” Tech. rep., Oxford-Man Institute, University of Oxford.
Li, Y., Mykland, P., Renault, E., Zhang, L., and Zheng, X. (2010), “Realized Volatility When
Sampling Times are Possibly Endogenous,” Tech. rep., Hong Kong University of Science and
Technology.
Li, Y. and Mykland, P. A. (2007), “Are Volatility Estimators Robust with Respect to Modeling
Assumptions?” Bernoulli, 13, 601–622.
Nelson, D. B. (1991), “Conditional Heteroskedasticity in Asset Returns: A New Approach,”
Econometrica, 59, 347–370.
Voev, V. and Lunde, A. (2007), “Integrated Covariance Estimation Using High-Frequency Data
in the Presence of Noise,” Journal of Financial Econometrics, 5, 68–104.
Xiu, D. (2010), “Quasi-Maximum Likelihood Estimation of Volatility with High Frequency
Data,” Journal of Econometrics, 159, 235–250.
Yu, J. (2005), “On Leverage in a Stochastic Volatility Model,” Journal of Econometrics, 127,
165–178.
Zhang, L. (2006), “Eﬃcient Estimation of Stochastic Volatility Using Noisy Observations: A
Multi-Scale Approach,” Bernoulli, 12, 1019–1043.

39

— (2011), “Estimating Covariation: Epps Eﬀect and Microstructure Noise,” Journal of Econometrics, 160, 33–47.
Zhang, L., Mykland, P. A., and Aı̈t-Sahalia, Y. (2005), “A Tale of Two Time Scales: Determining Integrated Volatility with Noisy High-Frequency Data,” Journal of the American
Statistical Association, 100, 1394–1411.

40

Table 1: Performance of the bias correction method based on asymptotic formulas and linear
regression. The 100 estimates of ρ are summarized by its minimum, ﬁrst quartile, median, third
quartile, maximum, mean and SD.
Min.

1st Qu.

Median

3rd Qu.

Max.

Mean

SD

corNutorho

-0.8555

-0.8172

-0.8005

-0.7808

-0.7511

-0.7999

0.026

corVtorho

-0.8827

-0.8238

-0.8019

-0.7814

-0.7415

-0.8041

0.031

corRVtorho

-0.9282

-0.8323

-0.7993

-0.7709

-0.7075

-0.8007

0.043

corPAVtorho

-1.0330

-0.8320

-0.7921

-0.7174

-0.6138

-0.7794

0.079

corTSRVtorho -1.0760

-0.8351

-0.7776

-0.7020

-0.4765

-0.7744

0.117

Table 2: Performance of the bias correction method based on nonparametrically estimated
asymptotic quantities and linear regression. The 100 estimates of ρ are summarized by its
minimum, ﬁrst quartile, median, third quartile, maximum, mean and SD.
Min.

1st Qu.

Median

3rd Qu.

Max.

corRVtorhoE

-0.8916

-0.8250

-0.8007

-0.7779

-0.7312

-0.8029 0.034

corPAVtorhoE

-0.9530

-0.8380

-0.7941

-0.7513

-0.6545

-0.7941 0.062

corTSRVtorhoE -1.9230

-0.9647

-0.8241

-0.7452

-0.5587

-0.8742 0.211

41

Mean

SD

Table 3: The results based on the sample frequency n = 1560, one observation per 15 seconds.
They show the performance of the bias correction method based on asymptotic formulas and linear regression (“corNutorho”, “corVtorho”, “corRVtorho”, “corPAVtorho”, “corTSRVtorho”);
and that of bias correction method based nonparametrically estimated asymptotic quantities
and linear regression (“corRVtorhoE”, “corPAVtorhoE”, “corTSRVtorhoE”). The 100 estimates of ρ are summarized by its minimum, ﬁrst quartile, median, third quartile, maximum,
mean and SD. The range for regression is m = (6, 7, · · · , 17)).
Min.

1st Qu.

Median

3rd Qu.

Max.

Mean

SD

corNutorho

-0.8527

-0.8141

-0.8023

-0.7812

-0.7316

-0.7988 0.024

corVtorho

-0.8727

-0.8253

-0.8099

-0.7869

-0.7223

-0.8053 0.029

corRVtorho

-0.8777

-0.8285

-0.8104

-0.7875

-0.6944

-0.8051 0.033

corPAVtorho

-0.8968

-0.8313

-0.7989

-0.7558

-0.6119

-0.7942 0.058

corTSRVtorho

-0.9921

-0.8709

-0.7953

-0.7313

-0.5364

-0.7999 0.094

corRVtorhoE

-0.8745

-0.8270

-0.8093

-0.7872

-0.7067

-0.8056 0.030

corPAtorhoE

-0.8962

-0.8287

-0.7973

-0.7682

-0.6743

-0.7970 0.045

corTSRVtorhoE -1.7800

-0.9657

-0.8850

-0.8184

-0.6027

-0.9147 0.175

Table 4: The sample correlation between the returns of S&P500 (2004-2007) and its estimated
changes of volatilities, using TSRV, PAV and VIX (squared).
m

1

2

5

21

63

126

252

TSRV

-0.196

-0.257

-0.333

-0.434

-0.309

-0.267

-0.122

PAV

-0.255

-0.318

-0.403

-0.494

-0.368

-0.317

-0.152

VIX(sq) -0.784

-0.774

-0.761

-0.792

-0.614

-0.469

-0.114

42

Table 5: The sample correlation between the returns of Microsoft and its estimated changes of
volatilities, using TSRV and PAV with sampling frequencies at one per minute and one per 5
seconds.
m

1

2

5

10

21

63

126

252

One observation per minute
TSRV

0.087

0.049

0.016

-0.027

-0.120

-0.290

-0.363

-0.221

PAV

0.030

-0.002

-0.017

-0.039

-0.169

-0.339

-0.405

-0.280

One observation per 5 seconds
-0.069

-0.207

-0.364

-0.362

-0.345

-0.074

-0.102

-0.115

-0.257

-0.412

-0.400

-0.404

0.02

0.04

MSFT, 6 months

−0.10

−0.05

0.00

0.05

4e−04

−0.2

Return

−0.1

0.0

0.1

Return

0.2

2e−04

Change in Volatility (TSRV)

2e−04
0e+00

Change in Volatility (TSRV)

4e−04
0e+00

Change in Volatility (TSRV)

0.00

Return

−4e−04

2e−04
0e+00

Change in Volatility (TSRV)

−4e−04

−0.06 −0.04 −0.02

MSFT, 3 months
4e−04

S&P 500 Futures, 1 month

4e−04

S&P 500 Futures, 1 week

0e+00

-0.051

-0.047

−2e−04

PAV

-0.034

−2e−04

TSRV -0.006

−0.2

−0.1

0.0

0.1

0.2

0.3

Return

Figure 1: Scatter plots of diﬀerences of estimated daily volatility V̂t − V̂t−m versus returns
over relatively long time span m for S&P 500 futures 2004-2007 data and Microsoft data from
January 2005 to June 2007. Daily volatilities are estimated using TSRV based on high frequency
minute-by-minute observations, and returns are calculated based on daily closing prices. From
left to right: S&P 500 futures when time horizon m is taken to be 5 days (a week), S&P 500
futures when time horizon m is taken to be 21 days (a month), MSFT when time horizon m is
taken to be 63 days (three months), MSFT when time horizon m is taken to be 126 days (six
months). Solid red lines are the least squares regression lines.

43

100
0
−100

−200

0

Change in Volatility (VXD^2)

100 200

200

Dow Jones

−400

Change in Volatility (VIX^2)

S&P 500

−0.04

−0.02

0.00

0.02

−0.03

Return

−0.02

−0.01

0.00

0.01

0.02

Return

Figure 2: Changes of squared volatility indices versus returns. Using the volatility indices as
the proxy of volatility, the leverage eﬀect can clearly be seen. Left panel: S&P 500 data from
January 03, 2004 to December 05, 2007, in which the VIX is used as a proxy of the volatility;
Right panel: Dow Jones Industrial Average data from January 03, 2005 to March 30, 2007 in
which the CBOE DJIA Volatility Index (VXD) is used as the volatility measure.

44

0.00

0.02

4e−04
2e−04
0e+00

Change in Volatility (TSRV)

−2e−04

0.002
0.000
−0.004

−0.04

−0.02

0.00

0.02

−0.10

−0.05

0.00

0.05

0.10

−0.10

−0.05
Return

S&P 500 Futures

S&P 500 Futures

MSFT

MSFT

0.00
Return

0.02

−0.04

−0.02

0.00

0.02

−0.05
Return

0.00

0.05

0.00

0.05

2e−04
0e+00

Change in Volatility (TSRV)

−0.10

Lagged Return

0.05

−2e−04

2e−04
0e+00
−2e−04

3e−04
1e−04
−3e−04

−1e−04

Change in Volatility (TSRV)

1e−04
−1e−04

−0.02

0.00

4e−04

Return

4e−04

Return

Lagged Change in Volatility (TSRV)

Return

−3e−04

−0.04

MSFT

−0.002

Change in Volatility (TSRV)

3e−04
1e−04
−3e−04

−0.02

3e−04

−0.04

Lagged Change in Volatility (TSRV)

Dow Jones Futures

−1e−04

−1e−04

1e−04

Change in Volatility (TSRV)

3e−04

E−mini S&P 500

−3e−04

Change in Volatility (TSRV)

S&P 500 Futures

−0.10

−0.05

Lagged Return

Figure 3: Upper: Scatter plots of the changes of estimated daily volatilities versus daily returns. Daily volatilities are estimated using TSRV based on high frequency minute-by-minute
observations, and returns are calculated based on daily closing prices. From left to right: S&P
500 futures 2004-2007 data, E-mini S&P 500 2004-2007 data, Dow Jones futures January 2005
– March 2007 data, Microsoft January 2005 – June 2007 data. Lower: Scatter plots of diﬀerences of estimated daily volatility versus daily returns with leads and lags for S&P 500 futures
2004-2007 data (left two) and Microsoft data from January 2005 to June 2007 (right two).

45

0.0

0.0

−0.1

−0.2

Cor

−0.2

−0.4
−0.8

−0.3

−0.6

Cor

0

50

100

150

200

Cor_nu
Cor_V
Cor_RV
Cor_PAV
Cor_TSRV

−0.4

−1.0

Cor_nu
Cor_V
Cor_RV
Cor_PAV
Cor_TSRV
250

0

50

100

m

150

200

250

m

Figure 4: The theoretical estimated leverage eﬀect parameter ρ as a function of the tuning
parameter m when ∆ is taken to be 1/252; using the spot volatility (Cor_nu), ideally estimated
spot volatility (Cor_V), realized volatility estimator (Cor_RV), pre-averaging volatility estimator,
(Cor_PAV) and two-time scale volatility estimator (Cor_TSRV) respectively. They correspond
respectively to the function C1 (m∆, κ, γ, α, ρ) in Theorem 1, A2 /(B2 C2 ) in Theorem 2, and the
main terms in Theorems 3, 4 and 5 respectively. Two sets of parameters are used. Left panel:

0.0
Cor_nu
Cor_V
Cor_V => Cor_nu
0

20

40

60

80

100

−1.0 −0.8 −0.6 −0.4 −0.2

Cor

−1.0 −0.8 −0.6 −0.4 −0.2

Cor

0.0

(ρ, κ, γ, α) = (−0.8, 5, 0.5, 0.1); right panel: (ρ, κ, γ, α) = (−0.3, 5, 0.05, 0.04).

Cor_nu
Cor_V
Cor_V => Cor_nu
0

m

20

40

60

80

100

m

Figure 5: The eﬀectiveness of multiplicative correction of smoothing bias, based on the main
term in (17). After correction, the estimate of ρ is approximately the same as that based on
the observable spot volatility. Left panel: (ρ, κ, γ, α, ∆) = (−0.8, 5, 0.5, 0.1, 1/252); right panel:
(ρ, κ, γ, α, ∆) = (−0.3, 5, 0.05, 0.04, 1/252).
46

0.0
−0.2

0.0
−0.2

−0.4
Cor_V
−0.6

−−−−−−−
−−−−−−−
−−−−−−
−−−−−
−−−−−
−−−−
−−−
−−−
−
−
−−
−−−
−−−
−−−
−−−
−
−−−
−−−
−
−−
−−
−
−
−−
−−−−−−−−−−−−−−−−−−−−−−−−−−
−−
−−−−−−
−−−−−−−−
−−
−
−−−−−−−
−−
−−−−
−−
−−−−
−
−
−−−−
−−
−
−−−−
−−−
−−
−−−−
−
−−−−
−
−−−−−−−−−−−−

−1.0

−0.8

−0.4
−0.6
−1.0

−0.8

Cor_nu

−−−−−
−−−−−−−−−−
−−−−−−−
−−−−−−−
−−−−−
−−−−
−
−
−
−−
−−−−
−−−−
−−−−
−−−−
−−−
−−−
−
−
−−−
−−−−−−−−−−−−−−−−−−−−−−−−−−−−
−−−
−−−−−−−−−−−−
−−
−−−−−−−−
−−
−−−−−−−
−−
−−−−−
−−
−−−−−
−
−
−
−
−
−
−−−
−
−
−
−
−−−−−−
−
−−−−−
−
−
−
−
−

0

50

100

150

200

250

0

50

100

150

50

100

150
m

200

250

0.0

0.0
250

−0.2
−0.4

Cor_TSRV

−0.6

−
−
−
−−−−
−−−−−−−−−−−
−−−−−−−−−
−
−−−−−−−−
−−−−−
−
−−−−−
−−
−−−−−
−
−
−
−
−
−
−−−−−
−−
−−−−−
−−
−−−−
−
−−−−−
− −−−−−−−−−
−−−−−−−−−−−−−−−−−−−−−
−
−−−−−−−−−−−−−
−−
−−−−−−−−−−−−
−−−
−−−−−−−−
−−−−−−−−−−−−−−−−−−−−−

−1.0

−0.8

−0.2
−0.4

Cor_PAV

−−−−−
−−−−−−−−−−
−−−−−−−−
−−−−−−−
−−−−−
−−−−
−
−
−
−
−
−−−
−−−−
−
−−−−
−
−−−−
−−−−
−−−
−−−
−−−
−
−
−−
−
−−−−−−−−−−−−−−−−−−−
−−−−−−−−−−−−
−−−−−−−−−−−−−
−
−−−−−−−−−−−−
−−−−−−−
−−−−−−−
−
−−−−−−
−−−
−−−−−−−−−−−−−−

−

−0.8

−0.6

−

−1.0

−0.2
−0.4

Cor_RV

−0.6
−0.8
−1.0

−−
−−−−−−−−−
−−−−−−−
−−−−−−
−−−−−−
−−−−
−−−−
−
−
−
−
−−−
−−−−
−−−
−
−−−
−−−
−−−
−−−
−−−
−
−
−
−−
−−−−−−−−−−−−−−−−−−−−−−−
−−
−−−−−−−−−
−−
−
−−−−−−−−−−−
−−
−
−−−−−−
−−
−−−−−−
−−−−−−−−
−−−−−
−
−−−−−
−
−
−
−
−
−− −−−−−−−−
−−−−

0

200

m

0.0

m

0

50

100

150
m

200

250

0

50

100

150

200

250

m

Figure 6: Sample correlation between the log-returns and the changes of spot volatility (upper
left), the changes of integrated volatility (upper right), the diﬀerences of realized volatility
(lower left), the diﬀerences of PAV (lower middle), and the diﬀerences of TSRV (lower right)
over a period of m days. The results are based on 100 simulations. The solid curve is the
average over 100 simulations. The dots are one standard deviations away from the averages.
Parameters: (ρ, κ, γ, α, σϵ , ∆, n) = (−0.8, 5, 0.5, 0.1, 0.0005, 1/252, 390).

47

0.0
−1.0

−0.8

−0.6

Cor

−0.4

−0.2

Cor_nu
Cor_V
Cor_RV
Cor_PAV
Cor_TSRV

0

50

100

150

200

250

m

Figure 7: The average sample correlations between the changes of log-prices over a period of m
days and the diﬀerence of the spot volatility ν, the diﬀerence of the integrated volatility V , the
diﬀerence of the RV estimates, and the diﬀerence of the TSRV estimates over the same period.
Comparing this with the left panel of Figure 4, we see how the simulation results are in line
with the theory. Parameters: (ρ, κ, γ, α, σϵ , ∆, n) = (−0.8, 5, 0.5, 0.1, 0.0005, 1/252, 390)

48

−0.2
−0.8
−1.2

−1.0

Correction from TSRV

−0.6

−0.4

−0.2
−0.3
−0.4
−0.5

Correction from PAV

−0.6

−1.4

−0.7
−0.8

50

100

150

200

250

0

100

150

200

250

−0.72

Correction from TSRV

−0.70

−0.68

50

−0.78

−0.76

−0.74

−0.72
−0.74
−0.76

Correction from PAV

−0.70

0

30

40

50

60

70

40

50

60

70

80

Figure 8: The scatter plot of preliminary bias corrected estimates of the leverage eﬀect parameter ρ against m for one simulated realization. Left panel is based on the PAV and the right
panel is based on TSRV. The bottom panel is the zoommed version of the plots on the top
panel, in which the ﬁrst linearly increasing interval is depicted. The estimates in this range are
further aggregated by using a simple linear regression to obtain a ﬁnal estimate of the leverage

0.0

eﬀect.

−1.0

−0.8

−0.6

Cor

−0.4

−0.2

Cor_nu
Cor_V
Cor_RV
Cor_PAV
Cor_TSRV

0

50

100

150

200

250

m

Figure 9: The same as Figure 7 except that the data are sampled at every 15 seconds (n=1560).
49

Cor

−1.0 −0.8 −0.6 −0.4 −0.2 0.0

Cor_VIX
Cor_PAV
Cor_TSRV
0

50

100

150

200

250

150

200

−0.3
60

65

75

80

85

0

100

150
m

200

60

80

100

60

80

100

−0.3
Correction from TSRV

−0.6
−0.7
−0.8

Correction from TSRV
250

−0.9

−0.9
50

40
m

−0.5

0.0
0

20

m

−1.0 −0.8 −0.6 −0.4 −0.2

Correction from TSRV

70

250

m

−0.5

100

−0.7

50

−0.5

Correction from PA

−0.9
55

0

−0.7

−0.38

−1.0

−0.46

−0.42

Correction from PA

−0.4
−0.6
−0.8

Correction from PAV

−0.2

−0.34

0.0

m

60

70

80

90

100

m

0

20

40
m

Figure 10: Upper: The raw sample correlations based on VIX (squared), PAV and TSRV, for
diﬀerent horizons m based on the minute-by-minute data of S&P500 returns in the time period
2004-2007. Lower: the scatter plots of preliminary bias corrected estimates of the leverage
eﬀect parameter ρ against m for the same data set. The middle plots are the zoomed versions
of the plots on the left, in which the ﬁrst linearly increasing interval is depicted. The plots
on the right show how estimates in the range are further aggregated by using a simple linear
regression to obtain a ﬁnal estimate of the leverage eﬀect.

50

0.0

−0.26

−0.4

Correction from PAV

−0.8

−0.38
50

100

150

200

250

130

140

150

160

170

0

50

100

150

100

150

m

−0.4

Correction from TSRV

−0.6

−0.35
−0.40

−1.0

−0.45

−0.8

−0.8

−0.6

−0.4

Correction from TSRV

−0.2

−0.2

−0.30

0.0

m

0.0

m

Correction from TSRV

−0.6

−0.30
−0.32
−0.36

−0.34

Correction from PAV

−0.2

−0.28

0.0
−0.2
−0.4
−0.6

Correction from PAV

−0.8
−1.0
0

0

50

100

150

200

250

130

140

m

150

160

170

0

50

m

m

Figure 11: The scatter plots of preliminary bias corrected estimates of the leverage eﬀect
parameter ρ against m based on the minute-by-minute data of Microsoft returns in the time
period Jan/2005-Jun/2007. Upper panel is based on the PAV and the lower panel is based on
TSRV. The middle are the zoomed versions of the plots on the left, in which the ﬁrst linearly
increasing interval is depicted. The plots on the right show how estimates in the range are
further aggregated by using a simple linear regression to obtain a ﬁnal estimate of the leverage

100

150

200

250

0.0
−0.4
−0.8
130

140

100

170

0

50

150
m

200

250

100

150

100

150

m

0.0
−0.2
Correction from TSRV

−0.8

Correction from TSRV
50

160

−0.44 −0.42 −0.40 −0.38 −0.36 −0.34 −0.32 −0.30

−0.2
−0.4
−0.6
−0.8
−1.0
0

150
m

0.0

m

−0.4

50

−0.6

0

Correction from TSRV

−0.6

Correction from PAV

−0.2

−0.32
−0.34
−0.36

Correction from PAV

−0.42

−1.0

−0.40

−0.38

−0.4
−0.6
−0.8

Correction from PAV

−0.2

−0.30

0.0

eﬀect.

130

140

150
m

160

170

0

50
m

Figure 12: The same as in Figure 11 except that the data are sampled at the frequency of one
observation per 5 seconds.
51

