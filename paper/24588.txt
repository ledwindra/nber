NBER WORKING PAPER SERIES

STRUCTURAL ESTIMATION OF A MODEL OF SCHOOL CHOICES:
THE BOSTON MECHANISM VS. ITS ALTERNATIVES
Caterina Calsamglia
Chao Fu
Maia Güell
Working Paper 24588
http://www.nber.org/papers/w24588

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2018

We thank Yuseob Lee for excellent research assistance. We thank the editor and five anonymous
referees for their suggestions. We thank the staff at IDESCAT, especially Miquel Delgado, for
their help in processing the data. We thank Steven Durlauf, Jeremy Fox, Amit Gandhi, John
Kennan and Chris Taber for insightful discussions. We thank participants at the Cowles
conference, Barcelona GSE summer forum and ASSA 2016, and workshop participants at ASU,
Rice, Royal Holloway, Stanford, Virginia Tech, UChicago and UCL for helpful comments. The
authors acknowledge support from a grant from the Institute for New Economic Thinking for the
Human Capital and Economic Opportunity Global Working Group. The views expressed in this
paper are those of the authors and not necessarily those of the funders or persons named here.
Calsamiglia acknowledges support from the European Research Council through the ERC Grant
638893, and the the Spanish Ministry of Science and Innovation (ECO2014-53051-P), the
Generalitat de Catalunya (2014 SGR 515), and Severo Ochoa. Guell acknowledges support from
the Spanish Ministry of Science and Innovation (ECO-ECO2014-59225-P and ECO2017-89240P). All errors are ours. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2018 by Caterina Calsamglia, Chao Fu, and Maia Güell. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Structural Estimation of a Model of School Choices: the Boston Mechanism vs. Its Alternatives
Caterina Calsamglia, Chao Fu, and Maia Güell
NBER Working Paper No. 24588
May 2018
JEL No. I0,J0
ABSTRACT
We model household choice of schools under the Boston mechanism (BM) and develop a new
method, applicable to a broad class of mechanisms, to fully solve the choice problem even if it is
infeasible via the traditional method. We estimate the joint distribution of household preferences
and sophistication types using administrative data from Barcelona. Counterfactual policy analyses
show that a change from BM to the Deferred Acceptance mechanism would decrease average
welfare by 1,020 euros, while a change to the top trading cycles mechanism would increase
average welfare by 460 euros.
Caterina Calsamglia
UAB-Barcelona GSE
Edifici B, Campus de Bellaterra
08193 Bellaterra
ccalsamig@gmail.com
Chao Fu
Department of Economics
University of Wisconsin - Madison
1180 Observatory Drive Madison,
WI 53706
and NBER
cfu@ssc.wisc.edu

Maia Güell
University of Edinburgh
Economics
50 George Square
Edinburgh EH8 9JY
UK
and FEDEA
maia.guell@gmail.com

A data appendix is available at http://www.nber.org/data-appendix/w24588

1

Introduction

Designed to broaden households’access to schools beyond their neighborhoods, public
school choice systems have been increasingly adopted in many countries.1 The quality
of schools to which students are assigned can have signi…cant long-term e¤ects for
individual families as well as important implications on e¢ ciency and equity for a
society.2 How to assign students to schools is of key interest among policy makers
and researchers.
One important debate centers around the popular Boston mechanism (BM), which
is vulnerable to manipulation (Abdulkadiro¼
glu and Sönmez (2003)). Some cities, including Boston, have replaced BM with less manipulable mechanisms such as the
student-proposing deferred acceptance mechanism (DA) (Gale and Shapley (1962)).3
However, the e¢ ciency and equity comparison between BM and its alternatives remains an open question.
To answer this question, one needs to quantify two essential but unobservable
factors underlying households’choices, which is what we do in this paper. The …rst
factor is household preferences, indispensable for comparing welfare across mechanisms even if household choices were observed under each. Moreover, as choices are
often not observed under counterfactual scenarios, one needs to predict how households would behave. The knowledge of household preferences alone is not enough for
this purpose. Although BM gives incentives for households to act strategically, there
may exist non-strategic households that simply rank schools according to their true
preferences.4 A switch from BM to DA, for example, will induce behavioral changes
only among strategic households. The knowledge about the distribution of household
types (strategic or non-strategic) thus becomes a second essential factor.
We develop a model of school choices under BM by households who di¤er in both
1

Some papers explore changes in families’ school choice sets to study how school choice a¤ect
students’ achievement, e.g., Abdulkadiro¼
glu et al. (2010), Deming et al. (2014), Hastings et al
(2009), Lavy (2010), Mehta (2013) and Walters (2013). Other studies focus on how the competition
induced by school choices a¤ects school performance, e.g., Hoxby (2003) and Rothstein (2006).
2
See Heckman and Mosso (2014) for a comprehensive review of the literature on human development and social mobility.
3
See Abdulkadiro¼
glu et al. (2005) for the Boston reform; and Pathak and Sönmez (2013) for
switches in other cities to less-manipulable mechanisms.
4
There is direct evidence that both strategic and non-strategic households exist. For example,
Abdulkadiro¼
glu et al. (2006) show that some households in Boston obviously failed to strategize.
Calsamiglia and Güell (2014) prove that some households obviously behave strategically.

1

their preferences for schools and their strategic types. Non-strategic households …ll
out application forms according to their true preferences. Strategic households take
admissions risks into account to maximize their expected payo¤s. A household’s expected payo¤ depends on how it selects and ranks schools on its application list. The
standard way to solve this problem selects the best permutation out of the set of
schools. This method is applicable only when the choice set is small because the
dimensionality grows exponentially with the number of schools. We utilize two unexploited properties of most allocation mechanisms, and show that the full optimization
problem can be e¤ectively solved via backward induction even when the household
faces a large choice set. This solution method is applicable to a wide range of mechanisms, covering most mechanisms studied in the literature.
We apply our model to a rich administrative data set from Barcelona, where a BM
system has been used to allocate students across over 300 public schools. Between
2006 and 2007, there was a drastic change in the o¢ cial de…nition of school zones
that signi…cantly altered the set of schools a family had priorities for. We estimate
our model using the 2006 pre-reform data via simulated maximum likelihood, and
conduct an out-of-sample validation using the 2007 post-reform data. The model
matches the data in both years.
In counterfactual policy experiments, we assess the performance of two truthrevealing alternatives to BM: DA and the top trading cycles mechanism (TTC).5 An
average household would lose by an amount equivalent to 1,020 euros in a BM-to-DA
change, and bene…t by 460 euros in a BM-to-TTC change. A BM-to-DA change is
more likely to bene…t those who live in higher-school-quality zones, hence enlarging
the cross-zone inequality. In a BM-to-TTC change, the quality of the school zone a
household lives in does not impact its chance to win or to lose. While TTC enables
59% of households whose favorite schools are out of their zones to attend such schools,
this fraction is only 47% under BM and 42% under DA.
We contribute to the literature on the design of centralized choice systems initiated by Balinski and Sönmez (1999) for college admissions, and Abdulkadiro¼
glu and
Sönmez (2003) for public school choices, the latter leading to debates on BM. Some
suggest that BM creates an equity problem as non-strategic parents may be disadvantaged by strategic ones (e.g., Pathak and Sönmez (2008)). Using Boston data under
5
TTC was introduced by Shapley and Scarf (1974) and adapted by Abdulkadiro¼
glu and Sönmez
(2003).

2

BM, Abdulkadiro¼
glu et al. (2006) …nd that households that obviously failed to strategize were disproportionally unassigned. Calsamiglia and Miralles (2014) show that
under certain conditions, the only equilibrium under BM is the one in which families
apply for and are assigned to in-zone schools. Chen and Sönmez (2006) and Ergin
and Sönmez (2006) show that DA is more e¢ cient than BM in complete information
environments. Abdulkadiro¼
glu et al. (2011), Featherstone and Niederle (2011), and
Miralles (2008) provide examples where BM is more e¢ cient than DA.6
Empirical studies that quantify the di¤erences between alternative mechanisms
have been sparse.7 He (2014) estimates an equilibrium model under BM. Under
certain assumptions, he estimates household preferences without specifying the distribution of household sophistication types. This approach imposes fewer presumptions on the data, but restricts the model’s ability to compare across mechanisms.
Developed independently at roughly the same time as our paper are Hwang (2015)
and Agarwal and Somaini (2016). Hwang (2015) set-identi…es household preferences
assuming certain simple rules on behavior. Assuming all households are strategic,
Agarwal and Somaini (2016) interpret a household’s submitted report as a choice of
a probability distribution over assignments, which naturally corresponds to choosing
the best permutation of schools.8 As in our paper, they also exploit the observed
assignment outcomes and estimate household preferences without having to solve for
the equilibrium. They show that a class of mechanisms can be consistently estimated
and establish conditions under which preferences are non-parametrically identi…ed.
In the application, they estimate a parametric model using data from Cambridge,
where each household can rank up to 3 programs out of 13. The authors propose an
estimation method based on Gibbs sampling, in which one initiates the procedure by
solving for the best permutation for each household, but avoids having to compute
the likelihood that a report is optimal during the estimation.
Our paper complements well the three papers mentioned above. We develop a
solution method applicable to a wide range of choice mechanisms, which e¢ ciently
solves household problems that are unmanageable via the standard method. This new
solution method can signi…cantly expand the scope of empirical research on choice
6

Some recent studies challenge the robustness of the results from Abdulkadiro¼
glu et al. (2011),
e.g., Troyan (2012), Akyol (2014) and Lu (2015).
7
With a di¤erent focus, Abdulkadiro¼
glu et al. (2014) show the bene…ts of centralizing school
choice procedures.
8
In an extension, they allow for the existence of both strategic and non-strategic households.

3

mechanisms. We show evidence suggesting the coexistence of strategic and nonstrategic households, and estimate both household preferences and the distribution
of strategic types in a parametric model. The rich variations in our data allow us
to form a more comprehensive view of the alternative mechanisms in terms of not
only the overall household welfare but also cross-neighborhood inequality. Moreover,
we are able to validate our model using data after a sharp reform, which we view
as a positive message for empirical research that compares di¤erent mechanisms via
structural models and counterfactual analyses.
Researchers have used out-of-sample …ts for model validation, exploiting random
social experiments (Wise (1985), Lise et al. (2005), Todd and Wolpin (2006)), lab
experiments (Bajari and Hortacsu (2005)), or regime shifts (McFadden and Talvitie
(1977), Pathak and Shi (2014)).9 Some studies, including our paper, deliberately hold
out data for validation purposes, e.g., Lumsdaine et al. (1992), Keane and Mo¢ tt
(1998) and Keane and Wolpin (2007).
The next section describes the background. Section 3 describes the model. Section 4 explains our estimation and identi…cation strategy. Section 5 describes the
data. Section 6 presents the estimation results. Section 7 conducts counterfactual
experiments, followed by the conclusion. The appendix contains further details and
additional tables.

2

Background

2.1

The Public School System in Barcelona

The public school system consists of over 300 public or semi-public schools. Public
schools are fully …nanced by the government and free to attend. The operation of
public schools follows government rules. All public schools are largely homogenous
in teacher assignment, infrastructure, curricula, and funding per pupil. Semi-public
schools are run privately, have more autonomy, and are allowed to charge service fees.
On average, of the total funding for semi-public schools, 63% is from the government,
34% from service fees, and 3% from private sources. All public and semi-public schools
are subject to the same national limit on class size; and have to unconditionally accept
and only accept students assigned to them via the centralized procedure. Outside
9

See Keane, Todd and Wolpin (2011) for a comprehensive review.

4

of the system, there are private schools, accounting for only 4% of all schools in
Barcelona. Private schools receive no public funding, are subject to few restrictions
and do not participate in the centralized school choice program.10

2.2

School Choice within the Public School System

Families get into the public school system via a centralized procedure, in which almost all families participate.11 Every April, participating families with a child who
turns 3 in that calendar year submit a ranked list of up to 10 schools.12 Assignment
is via a Boston mechanism. The result is made public between April and May; and
enrollment happens in September. If a school is over-demanded, applicants are prioritized according to government rules. Applicants can get priority points for the
presence of a sibling in the same school (40 points), in-zone schools (30 points), and
some family/child characteristics (e.g., disability (10 points)). Ties in total priority
scores are broken through a fair lottery.
Transferring to a di¤erent school within the public system is feasible only if the
receiving school has a free seat, which is nearly impossible for popular schools. In
preschool-to-primary-school transitions, a student has the priority to stay in the same
school she enrolled for preschool. Moreover, students are given priorities to speci…c
secondary schools based on their primary schools.

2.3

The 2007 Re-De…nition of Zones

Before 2007, Barcelona was divided into …xed zones. Families had 30 priority points
for every in-zone school and 0 for out-of-zone schools, regardless of distance.13 In 2007,
a family’s school zone was rede…ned as the smallest area around its residence that
covered the closest 3 public and 3 semi-public schools.14 The reform was announced
10

For this reason, information on private schools is very limited. Given the lack of information
and the small fraction of schools they account for, we treat private schools as part of the (exogenous)
outside option.
11
In 2007, over 95% of families with a 3-year old child in Barcelona participated.
12
Applications after the deadline can only be considered after all on-time applicants have been
assigned.
13
Before 2007, a family had priorities for a set of public schools de…ned by its public-school zone,
and a set of semi-public schools de…ned by its semi-public-school zone. Throughout the paper,
in-zone schools refer to the union of these two sets.
14
There were over 5,300 zones under this new de…nition (Calsamiglia and Güell (2014)).

5

abruptly on March 27th, 2007; families were informed via mail by March 30th and
had to submit their lists by April 20th.

3
3.1

Model
Primitives

There are J (public, semi-public) schools distributed across various zones in the city.
There is a continuum of households of measure 1 (we use the words household, applicant, student and parent interchangeably). Each household submits an ordered list
of schools. Then a centralized procedure assigns students according to their applications, school capacity and a priority structure.15 One can choose either the school
one is assigned to or the outside option.
Each school j has a location lj , a vector wj of observable characteristics, and a
characteristic j observable to households but not the researcher.16 No school can
accommodate all students, but each student is guaranteed a seat in the system.
Household i has characteristics xi ; a location li , idiosyncratic tastes for schools
i = f ij gj , and a type T 2 f0; 1g (non-strategic or strategic): Households know
their tastes and types, which are unobservable to the researcher. The vector i is
independent of (xi ; li ) and follows an i.i.d. distribution F ( ).17 The fraction of
strategic households varies with household characteristics and locations, (xi ; li ) :
Conditional on observables, the two types di¤er only in their behaviors, speci…ed
later.
Remark 1 We do not take a stand on why some households are (non)strategic. This
would be critical if a policy change may a¤ect the fraction of strategic households.
It’s less concerning for us because we aim at investigating the impact of replacing BM
with some truth-revealing mechanisms, under which all households will rank schools
according to their true preferences. Once we recover household preferences and the
15

Since almost all families participate in the application procedure in reality, we assume that the
cost of application is zero and that all families participate. This is in contrast with the case of the
costly college application, e.g., Fu (2014).
16
We assume that households have full information about schools. Our data do not allow us to
separate preferences from information frictions. Some examples using experiments to study how
information a¤ects schooling choices include Hastings and Weinstein (2008) and Jensen (2010).
17
Each component of i follows N 0; 2 :

6

(current) distribution of types, we can compare the current regime with truth-revealing
alternatives without the need to know how household types are determined.
We normalize the ex-ante value of the outside option to 0, so that a household’s
evaluation of each school is relative to its outside option. Let dij be the distance between household i and school j, and di = fdij gj : Household i’s utility from attending
school j is given by,18
uij = U (wj ; xi ; dij ; j ) + ij :
Between application and enrollment (about 6 months), the value of the outside option
is subject to a shock i s i:i:d: N (0; 2 ), e.g., a wage shock that changes one’s
ability to pay for the private school. A household knows the distribution of i before
application, and observes i afterwards. With i , applying for schools in the public
system provides an option value for households. These shocks also rationalize the
data fact that some households opted out despite being assigned to their …rst choices.

3.2

Priority and Assignment

Priority Scores: Let zl be the zone that contains location l, I li 2 zlj indicate
whether i lives in school j’s zone, and sibij 2 f0; 1g indicate whether i has some
sibling enrolled in j.19 Household i’s priority score for school j (sij ) is given by
sij = x0i a + b1 I li 2 zlj + b2 sibij ;

(1)

where a is the vector of points based on demographics. In Barcelona, a student’s
priority score of her …rst choice carries over for all schools on her application.20 We
take this feature into account in our analyses. Implied by (1) ; multiple households
may tie in their priority scores. If a school is over-demanded, households are ranked
…rst by their scores, tied households are ranked by random lottery numbers drawn
after applications are submitted.
18

A likelihood ratio test does not favor a more complex model with zone characteristics added to
the utility function. Following the literature on choice mechanisms, we abstract from peer e¤ects and
social interactions (see Epple and Romano (2011) and Blume et. al (2011) for reviews). The major
complication is the multiple equilibria problem arising from peer e¤ects and social interactions, even
under DA or TTC.
J
19
Characteristics xi consists of demographics x0i and the vector fsibij gj=0 .
20
For example, if a student lists an in-zone sibling school as her …rst choice, she carries x0i a+b1 +b2
for all the other schools she listed.

7

The BM Procedure: Schools are gradually …lled up over R < J rounds, where
R is the maximum length of an application list.
Round 1: For each school, consider only the students who have listed it as their …rst
choice and assign seats to them one at a time following their priority scores from high
to low (with random numbers as tie-breakers) until there is either no seat left or no
student left who has listed it as her …rst choice.
Round r 2 f2; 3; :::; Rg: Only the rth choices of the students not previously assigned
are considered. For each un…lled-up school, assign the remaining seats to these students one at a time following their priority scores and tie-breaking lottery numbers
until there is either no seat left or no student left who has listed it as her rth choice.
The procedure terminates after any step r R when every student is assigned, or if
the only students who remain unassigned listed no more than r choices. A student
who remains unassigned after the procedure ends can propose a leftover school and
be assigned to it.
Admissions probabilities to each school j can be characterized by a triplet
(rj ; sj ; cutj ) ; where rj is the round at which j is …lled up (rj > R if j is a leftover
school), sj is the priority score for which lottery numbers are used to break ties for j’s
slots, cutj is the cuto¤ of the lottery number for admission to j. School j will admit
th
any rth -round applicant before rj ; any rth
j -round applicant with sij > sj ; and any r j round applicant with score sj and random lottery higher than cutj ; and it will reject
any other applicant. Once the random lottery numbers are drawn, admissions are fully
determined. When making its application decision, a household knows Si
fsij gj
but not its random number, which makes admissions uncertain in many school-round
cases. The assignment procedure implies that the admissions probability is (weakly)
decreasing in sij in each round, and is (weakly) decreasing over rounds for all scores.
In particular, the admissions probability to a school in Round r + 1 for the highest
priority score is (weakly) lower than that for the lowest score in Round r:

3.3

Household Problem

We start with the enrollment problem. After seeing the post-application shock i and
the assignment result, i chooses between the school it is assigned to and the outside
option. The expected value of being assigned to school j is
vij = E i max fuij ; i g :
8

(2)

If rejected by all schools on its list, i can opt for a school that it prefers the most
among the leftover schools (i’s backup). The value (vi0 ) of being assigned to its
backup school is given by
vi0 = max fvij gj2lef tovers :
3.3.1

(3)

Application: Non-Strategic Households

A non-strategic household lists schools according to its true preferences fvij gj : Without further assumptions, any list of length n (1 n R) that consists of the ordered
top n schools according to fvij gj is consistent with non-strategic behavior, which
makes the prediction of allocation outcomes ambiguous. To avoid such a situation,
we impose the following weak requirement: suppose household i ranks its backup
school as its ni -th favorite, then the length of i’s application list ni is such that
ni

min fni ; Rg :

(4)

That is, when there are still slots left on its application form, a non-strategic household
will list at least up to its backup school.21
Let A0i = a01 ; :::; a0ni be an application list for non-strategic (T = 0) household
i, where a0r is the ID of the rth -listed school and ni satis…es (4) : The elements in A0i
are given by
a01 = arg max fvij gj

(5)

j

a0r = arg max fvij jj 6= ar0 <r gj ; for 1 < r
j

min fni ; ni g :

The rth -listed school is one’s rth favorite for the entire list if ni < ni ; and for the
…rst ni schools if the ni ni :22 De…ne A0 (xi ; i ; li ) as the set of lists that satisfy (4)
and (5) for a non-strategic household with (xi ; i ; li ). If ni
R; the set A0 ( ) is a
singleton, and the length of the list ni = R: If ni < R, all lists in the set A0 ( ) are
identical up to the …rst ni elements and imply the same outcome.
21

See the online appendix for further discussions about Condition (4).
We do not require that schools listed after one’s backup school be ranked, which is a weaker
assumption than otherwise.
22

9

3.3.2

Application: Strategic Households

Taking admissions probabilities as given, a strategic household maximizes its expected
payo¤.23 This payo¤ depends on not only which schools are listed but also how
they are ordered.24 Therefore, the standard (direct) solution is to choose the best
permutation of schools. Formally, let P (J; R) be the set of all possible permutations
of size 1 to R out of elements in J; and jP (J; R)j be its size. The standard solution
is given by
max
(A; Si ; xi ; li ; i ) ;
(6)
A2P(J;R)

where (A; ) is the expected value of list A: Choosing the best permutation has been
feasible in previous studies because choice sets (J) were small in those studies. When
J is relatively big and R is beyond 1; P (J; R) soon becomes unmanageably large. In
the case of Barcelona, with J = 317 and R = 10, jP (J; R)j is over 8:9 1024 :
We develop a solution method to break the curse of dimensionality and fully solve
the strategic household’s problem, which is applicable to a broad class of mechanisms,
referred to as the class under consideration from now on.25 Some examples in this
class include BM, constrained and unconstrained DA, …rst preference …rst, Chinese
parallel, and variants or hybrids of the above.26 The solution utilizes the following
two unexploited properties that are intrinsic of these mechanisms.
(1) Sequentiality: Although the entire application list is submitted all at once, the
ranked schools on the list are considered sequentially in the procedure. During the
assignment, the rth -listed school (ar ) is relevant only if one is rejected by all previously listed schools. Therefore, ar should be one’s best choice contingent on reaching
that stage, implying that the problem can be solved via backward induction.
(2) Reducible History: Being rejected by previously listed schools may carry information about one’s probability of being assigned to ar , but the information can
be fully summarized by objects much simpler than the list (a1 ; :::ar 1 ). Therefore,
23

It is standard to assume that households take admissions probabilities as given, e.g., Abdulkadiro¼
glu et al. (2011), Hat…eld et al. (2014), Azevedo and Hat…eld (2015), Azevedo and Leshno
(2015), Agarwal and Somaini (2016), and Kojima (2015).
24
We assume that strategic households are fully rational because it is a clear baseline. As a
justi…cation, BM has been practiced in Barcelona for over 20 years and very familar to households.
A more ‡exible model would allow for partially-informed types, which is a straight-forward extension
to our framework but will impose great challenges for identi…cation. We leave it for future work.
25
Agarwal and Somaini (2016) study the same class of mechanisms.
26
For example, the Cambridge mechanism, serial dictatorship and the Pan London Admissions.

10

the problem involves a state space with a dimension much lower than jP (J; R)j.27
In particular, as we show in the online appendix, with some di¤erences in speci…cs,
mechanisms in the class under consideration has the following feature. After being
rejected by (a1 ; :::ar 1 ) ; i will be admitted to ar if ar still has seats and if i is ranked
high enough among those being considered. The latter is fully determined by i’s
priority and random lottery number for ar . Among the two factors, i’s priority for
ar is determined by pre-determined characteristics, and, in some instances, the rank
position of the school on i’s list (i.e., r); but it is independent of the other schools on
the list.28 One’s lottery number is drawn after the application, unknown to the applicant when making her decisions. In the case where a household has a single lottery
number across all tie-breaking cases, correlation arises between the probabilities of
being admitted to the listed schools: being rejected by a1 due to losing the lottery for
a1 reveals that one’s lottery number is below cuta1 ; being rejected again by a2 due to
losing the lottery for a2 reveals that one’s lottery number is below min fcuta1 ; cuta2 g ;
and so on. However, other than this, (a1 ; :::ar 1 ) bears no information that is payo¤
relevant for one’s decision on ar : Therefore, the dimensionality can be reduced considerably. Consider an example where one can list up to 3 schools out of 12; under a
standard BM. Suppose the numbers of schools …lled up in Rounds 1 to 3 are (5; 4; 3) :
The dimensionality is jP (12; 3)j = 1; 464 in the direct solution, while it is bounded
from the above by 150 in our solution.
Given sequentiality, we will explain how to derive a strategic household’s optimal
applications list A1i = fa1i1 ; :::a1iR g via backward induction in general. Then, we will
use BM as an example to show the evolution of the state variables involved in the
induction, utilizing the property of reducible history. The online appendix proves that
this method fully solves the problem, formally describes the dimensionality involved
in the solution, and explains applications of this method to other mechanisms in the
class under consideration. Readers not interested in the details can skip to the next
section.
27

The dimensionality of the direct solution is the same as that of a backward induction where all
details of the list (a1 ; :::; ar 1 ) bear information relevant for ar ; which is not the case. That is, the
direct method makes the problem unnecessarily complicated.
28
One exception is the BM in Barcelona and Spain in general, where priorities for all listed
schools are determined by the priority for the school ranked …rst. This makes the case in Spain more
complicated than regular cases, which can nevertheless be solved e¢ ciently using our method.

11

Solution via Backward Induction Let zri
zi (a1 ; :::ar 1 ) be the information
relevant for Round r that is contained in the history of i being rejected by (a1 ; :::ar 1 ).
Let prj (Si jzri ) be the probability of being admitted to j for a household with scores Si
and j as its rth choice. The contents of Fir and the determination of prj ( ) vary across
mechanisms and depend on the detailed speci…cation of priorities and the usage of
lottery numbers in ranking applicants. However, in the class of mechanisms under
consideration, given Si ; xi ; li ; i ; zR
i ; aR shall solve:
R
= max pR
V R Si ; xi ; li ; i ; zR
j Si jzi vij + 1
i
j

R
pR
j Si jzi

vi0 :

In general, given V r+1 (Si ; xi ; li ; i ; ) and the state variables (Si ; xi ; li ; i ; zri ) ; with
V R+1 ( ) = vi0 ; the continuation value for i at Round r R is given by
V r (Si ; xi ; li ; i ; zri ) = max prj (Si jzri ) vij + (1
j2J

prj (Si jzri ))V r+1 Si ; xi ; li ; i ; zr+1
i

:
(7)

The process continues until r = 1, where a1 solves:
V 1 Si ; xi ; li ; i ; z1i = max p1j (Si jz1i )vij + 1
j

p1j Si jz1i

V 2 Si ; xi ; li ; i ; z2i

:

The backward induction process above constructs an optimal list (a1 ; :::; aR ) :
We show the contents of Fir and the determination of prj ( ), using as examples,
the standard BM and the BM used in Barcelona, the latter being a special and more
complicated case of the former.29
Case 1) School-Speci…c Priorities and a Single Lottery Number (Standard
BM) When a household has a single lottery number across all tie-breaking cases,
correlation arises between admissions probabilities across rounds. Losing the lottery
for ar reveals that one’s lottery number is below cutar : Therefore, the probability
of being allocated in Round r + 1 conditional on being rejected by ar is (weakly)
29

The easiest case happens when applicants are given i.i.d. school-speci…c lottery numbers, under
which V r ( ; zri ) = V r ( ) and the constraint for (7) is
8
< 1 if r < rj or (r = rj and sij > sj );
1 cutj if r = rj and sij = sj ;
prj (Si jzri ) = prj (Si ) =
:
0 otherwise.

12

r

lower than the unconditional probability. Let i 2 [0; 1] be the upper bound of
1
one’s random number conditional on one’s rejection history ( i = 1): All relevant
r
r
information reduces to i ; i.e., zri = i . Constraints for (7) are
r+1
i

prj Si j

r
i

=

(

n
min cutj ;
r
i

r
i

o

if sij = sj and r = rj ;

(8)

otherwise,

8
>
>
< 1 if rn< rjr or (ro= rj and sij > sj );
cut
=
max 0; i r j if r = rj and sij = sj ;
i
>
>
: 0 otherwise.

(9)

n
o
r+1
r
Condition (8) is the updating rule: i will decrease to min cutj ; i if i is in the
tied priority group and loses the lottery.30 hThe second
equality in (9) follows the
i
r
uniform distribution with truncated support 0; i :
Case 2) Constant Priority and a Single Lottery Number (Barcelona) The
priority score of one’s top-listed school carries over to future rounds. As a result,
the continuation values for r > 1 depend on the top-listed school (a1 ) ; and Si in (7)
now becomes a vector of identical elements, sia1 1 [sia1 ; :::; sia1 ]. With sia1 1 being
the priority score vector, the problem for r > 1 remains the same as in Case 1). For
Round 1, one solves the following problem
1
V 1 Si ; xi ; li ; i ; i = 1 =
n
max p1j (sij 1j1) vij + 1
j2J

p1j (sij 1j1) V 2 sij 1; xi ; li ; i ;

s:t: Conditions (8) , (9) :

2
i

o

,

(10)

That is, the choice in Round 1 governs the vector of priority scores.
Remark 2 Multiple lists may yield the same value. Let A1 (xi ; li ; i ) be the set of
optimal lists for a strategic household. All lists in the optimal set, including the one
derived by backward induction, are identical up to the payo¤-relevant part of the lists
and imply the same allocation outcome.31
30

Going to Round r + 1 means one must have been rejected in Round r:
For example, consider a list A1 = a11 ; :::; a1r ; :::a1R ; by the speci…cation of fuij g ; each a1r is
generically unique if no school listed before it has a 100% admissions rate for the household. However,
if for some r < R; the admissions rate for the rth listed school is one, then any list that shares the
same …rst r ordered elements is also optimal. See the online appendix for other cases.
31

13

4

Estimation

4.1

Further Empirical Speci…cation

As described in detail in Appendix A1, the utility function takes the following form
U (wj ; xi ; dij ; j ) =

1I

+

(single parent) +

3
X

(

0e

+

1e j

2

(sibij

+ wj

e) I

sibi0 )

C (dij )

(11)

(edui = e) :

e=1

In particular, 2 is added to i’s evaluation of j if a sibling is enrolled in j; subtracted
from i’s evaluation of all schools if a sibling is in the outside option (sibi0 = 1). C (dij )
is a distance cost function. The second line of (11) speci…es the part of the utility
that varies across households with di¤erent education levels.
With potential correlation between school characteristics that are unobserved ( j )
and observed (wj ) ; estimates of in (11) may be inconsistent. Yet, one can combine
the e¤ects of (wj ; j ) and rewrite the second line of (11) as
X

(

0e

+

1e j

(12)

+ wj e ) I (edui = e) :

e

The reduced-form parameters and f j gj can be consistently estimated; and each of
them is some combination of structural parameters ; and : For the goal of this
paper, it is su¢ cient to estimate and f j gj instead of and :32

4.2

The Likelihood

Let parameter vector
[ u ; T ] ; whereh u governs
household preferences, and
i
e
e
Ai ; eei jji be the observed outcomes for
T governs type distribution. Let Oi
ei is the application list, e
household i; where A
ji is the assigned school, and eei is
enrollment. Conditional on being type T , the probability of observing Oi is given by
8
Z < I A
ei 2 AT (xi ; li ; i ; u )
h
LTi ( u ) =
uiej ( u )+ iej
i
: eei
+ (1 eei ) 1
32

uiej (

(11) and (12) are invariant to our counterfactual policy changes.

14

u )+ ie
ji

i

9
=
;

dF ( ;

);

where AT ( ) is the set of model-predicted optimal application lists for a type-T
uiej ( u )+ iej
i
is the probability that this household will enroll in
household, and
e
ji : Integrating over the type distribution, i’s contribution to the likelihood is
Li ( ) = (xi ; li ;

1
T )Li

(

u)

+ (1

(xi ; li ;

The log likelihood of the whole sample is given by L ( ) =

4.3

0
T ))Li

P

i

(

u) :

ln (Li ( )) :

Identi…cation

We give an overview of the identi…cation in this subsection and leave the formal proof
in the online appendix. The identi…cation relies on the following assumptions.
A1: There does not exist a vector of household observables x and a school j; such
that all households with x have probability zero of being admitted to school j.
A2: Household tastes are drawn from an i.i.d. unimodal distribution, with mean
normalized to zero; and they are independent of school characteristics, household
observables (x; l) and household type (T ) :
A3: At least one continuous variable in the utility function is excluded from the type
distribution. Conditional on variables that enter the type distribution function, the
excluded variable is independent of household type T:
To illustrate the identi…cation challenge, consider a situation where each household
only applies to one school, which is a less favorable situation for identi…cation because
we would have less information, and suppose there is no post-application shock.33 If all
households are non-strategic, the model boils down to a multinomial discrete choice
model with a household choosing the highest uij ( u ) + ij . The identi…cation of
such models is well-established under very general conditions (e.g., Matzkin (1993)).
If all households are strategic, a household considers the admissions probabilities
fpij gj and chooses the option with the highest expected value.34 With the admissions
probabilities observed from the data, this model is identi…ed with A1:35 The challenge
exists because we allow for a mixture of both types of households. In the following,
33

The post-application shock is identi…ed from the observed allocation and enrollment outcomes.
Agarwal and Somaini (2016) show conditions under which one can nonparametrically identify
household preferences when all of them are strategic.
35
If for all households with x; the admissions probabilities to j are zero, the utility for school j
for these households is unidenti…able, because the expected value of applying to j is zero regardless
of the level of utility.
34

15

we …rst explain A2-A3, then give the intuition underlying the identi…cation proof.
4.3.1

A2 and A3 in Our Framework

We observe application lists with di¤erent distance-quality-risk combinations with
di¤erent frequencies in the data. The model predicts that households of the same
type tend to make similar application lists. Given A2, the distributions of typerelated variables will di¤er around the modes of the observed choices, which informs
us of the correlation between type T and these variables. A3 guarantees that di¤erent
behaviors can arise from exogenous variations within a type. To satisfy A3, we need to
make some restrictions on how household observables (xi ; li ) enter type distribution
and utility. Conditional on distance, a non-strategic household may not care too
much about living to the left or the right of a school, but a strategic household may
be more likely to have chosen a particular side so as to take advantage of the priority
zone structure.36 However, given that households, strategic or not, share the same
preferences about school characteristics and distances, there is no particular reason
to believe that everything else being equal, the strategic type will live closer to a
particular school than the non-strategic type would just for pure distance concerns.37
In other words, because the only di¤erence between a strategic type and a nonstrategic type is whether or not one considers the admissions probabilities, which are
a¤ected by one’s home location only via the zone to which it belongs to, we assume
that home location li enters the type distribution only via the school zone zli , i.e.,
(xi ; li ) = (xi ; zli ) : In contrast, household utility depends directly on the homeschool distance vector di . Conditional on being in the same school zone, households
with similar characteristics x but di¤erent home addresses still face di¤erent homeschool distance vectors d, as required in A3.
4.3.2

The Intuition for Identi…cation

The data contains rich information for identi…cation. First, one can compare a household’s listed schools with other schools. Due to unobserved school characteristics,
some seemingly good schools may in fact be unattractive, making it not as popular as
36

Without directly modeling households’location choices, we allow household types to be correlated with the characteristics of the school zones they live in. We leave the incorporation of household
location choices for future extensions.
37
See the online appendix for evidence from the data supporting this assumption.

16

it “should have been”among most households. Controlling for such common factors,
as we do in the model, a household may still leave out some seemingly good schools
due to unobserved tastes. A2 implies that tastes are independent of household-schoolspeci…c admissions probabilities, which should not lead to a systematic relationship
between a school being listed and a household’s chances of getting into this school.
However, as will be shown in Section 5, for a large fraction of households, when they
left out schools better than their listed ones in terms of quality, fees and distance, in
most cases, these better schools were ones for which they had lower chances. Such
behavior is highly consistent with strategizing instead of truth-telling.
Second, one can explore the fact that admissions probabilities increase discontinuously with in-zone status. Most illustratively, consider households along the border
of two zones. Were all households non-strategic, applications should be very similar
among households along both sides of the border. In contrast, were most households
strategic, applications would be very di¤erent across the border.
Finally, conditional on (x; zl ) ; the variation in d induces di¤erent behaviors within
the same type; and conditional on (x; zl ; d) ; di¤erent types behave di¤erently. In particular, although households share the same preference parameters, di¤erent types of
households will behave as if they have di¤erent sensitivities to distance. For example,
consider households with the same (x; zl ) and a good school j out of their zone zl . As
the distance to j decreases along household addresses, more and more non-strategic
households will apply to j because of the decreasing distance cost. However, the
reactions will be much less obvious among the strategic households, because they
take into account the risk of being rejected, which remains unchanged no matter how
close j is as long as it is out of zl . The di¤erent distance-elasticities among households therefore inform us of the type distribution within (x; zl ). This identi…cation
argument does not depend on speci…c parametric assumptions. For example, Lewbel
(2000) shows that similar models are semiparametrically identi…ed when an A3-like
excluded variable with a large support exists. However, to make the exercise feasible,
we have made parametric assumptions.38
38

We have to use parametric assumptions because semiparametric estimation is empirically infeasible, and because the support of d is bounded by the size of the city, which is not large enough
relative to the (unbounded) support of household tastes, as required in Lewbel (2000).

17

4.3.3

Obviously Non-Strategic Households

The identi…cation of our model is further facilitated by the fact that we can partly observe household type directly from the data: there is one particular type of “mistakes”
that a strategic household will never make, which is a su¢ cient (but not necessary)
condition to spot a non-strategic household.39 Intuitively, if a household’s admissions
status is still uncertain for all schools listed so far, and there is another school j it
desires, one should never waste the current slot listing a zero-probability school instead of j because the admissions probabilities decrease over rounds.40 The idea is
formalized in the following claim and proved in the online appendix.41
Claim 1 An application list with the following features is su¢ cient but not necessary
evidence that the household must be non-strategic: 1) for some rth element ar on the
list; the household faces zero admissions probability at the rth round, and 2) it faces
admissions probabilities lower than 1 for all schools listed in previous rounds; and 3)
it faces a positive but lower than 100% admissions probability for the school listed in
a later slot r0
r + 1 and no school listed between ar and ar0 admits the household
with probability 1:

5

Data

We focus on applications among families with children that turned 3 years old in 2006
or 2007 and lived in Barcelona. For each applicant, we observe the application list,
the assignment and enrollment outcomes, home address, family background, and the
ID of the school(s) her siblings were enrolled in the year of her application. For each
school, we observe its type (public or semi-public), a measure of quality, capacity and
service fees. The online appendix describes our data sources.
39

If the support of household characteristics is full conditional on being obviously non-strategic,
household preferences can be identi…ed using this subset of households without A1, since is independent of (x; l) : However, our identi…cation does not rely on the existence of obviously non-strategic
households.
40
For example, consider an application list (1; 2; 3; :::) by Household i with Si ; where School 1 is
…lled up in Round 1 with p11 (Si ; ) < 1; School 2 is …lled up in Round 1 hence p22 ( ) = 0; and School
3 is …lled up in Round 3 and 0 < p33 (Si ; ) < 1: This list is irrational, because one has probability 1
of getting into School 3 in Round 2 and hence is strictly better o¤ with any list starting with (1; 3)
instead of (1; 2) :
41
Abdulkadiro¼
glu et al. (2006) use a mistake similar to Feature 1) in Claim 1 to spot non-strategic
households, which is to list a school over-demanded in the …rst round as one’s second choice.

18

5.1

Admissions Thresholds

Assuming each household is a small player that takes the admissions thresholds as
given, we can recover all parameters by estimating an individual decision model.
Given the observed applications and the priority rules, we make 1,000 copies for each
observed application list, involving all participating households (11,871 in 2006), and
assign each copy a random lottery number. We simulate the assignment results in this
enlarged market to obtain f(rj ; sj ; cutj )gj , which are treated as the ones households
expected when they applied.42

5.2

Summary Statistics

For estimation, we drop 3,152 observations (obs) whose locations cannot be matched
in the GIS (geographic information system),43 31 obs whose outcomes were inconsistent with the o¢ cial rule, 191 obs with special-need children or post-dealine (and
hence ineligible) applications, and those with missing information.44 The …nal estimation sample has 6,836 obs. Table 1 summarizes school characteristics.45 Compared to
public schools, semi-public schools have higher quality and larger capacities. Table 2
reports household characteristics in the estimation sample.46 Households had priority
for 22 schools on average but with considerable dispersions depending on their zones.
Table 1 School Characteristics
Public
Quality
Fees (100 Euros)
# Classes
Observations

Semi-Public

All

7.4 (0.8)

8.0 (0.5)

7.7 (0.7)

0

12.8 (5.7)

6.4 (7.5)

1.4 (0.5)

1.8 (1.0)

1.6 (0.8)

158

159

317

42
Agarwal and Somaini (2016) prove consistency of the obtained admissions probabilities for the
class of mechanisms under consideration.
43
We know their priority scores and applications, which enables us to include them in the calculation of admissions thresholds.
44
In the estimation, we exclude 748 parents who reported their education as “high school or
above.”In policy simulations, we include this subsample so as to make equilibrium assignments. We
estimate the probability of each of them as being college educated as a ‡exible function of all the
other observable characteristics, by comparing them with those who reported exactly high-school or
college education. The model …t for this subsample is as good as that for the estimation sample,
available on request.
45
School quality is measured by average student test scores on a scale from 0 to 10.
46
Following the literature on child development, we use mother’s education as the de…nition of
parental education if the mother is present in the household, otherwise, we use the father’s education.

19

Table 2 Household Characteristics
Parental Edua < HS

29.8%

Parental Edu = HS

30.4%

Parental Edu > HS

39.8%

Single Parent

15.8%

Have school-age older sibling(s)

42.2%

# Schools in Zone

22.3 (7.9)

Average school quality in zone

7.8 (0.3)

Observations
a

6,836

Parental Edu: mother’s edu if she is present, otherwise father’s edu.

The left panel of Table 3 shows that most of households listed no more than 3
schools, with 47% listing only one school. High-school-educated (HS) parents and
single parents tended to list more schools than others. The right panel of Table 3
shows the round at which households were assigned. In equilibrium, most households
(93%) were assigned to their …rst choices. However, this does not imply low risk.47
Among those assigned to their …rst choices, the average admissions probability was
94.6%, with the lowest being 0.2. Of all schools, 44% were …lled up in Round 1,
while 40% were leftovers. That is, households face very high stakes: a large number of
schools were over-demanded; and once rejected in Round 1, most schools one could get
into were leftovers. The fact that most households were assigned to their …rst choices
suggests both the prevalence of strategic play and a large amount of coordination
in equilibrium. Table 4 summarizes the characteristics of top-listed schools: school
quality, distance and fees all increase with parental education. Table 5 shows that
97% of all students were enrolled in the public school system. Among those assigned
to their …rst choice, 2.2% chose not to enroll, which can be rationalized by ex-post
shocks.48
47

Other studies also …nd that most households were assigned to their …rst choices under manipulable mechanisms, e.g., Abdulkadiro¼
glu et al. (2006), Hastings et al. (2009), Lavy (2010) and Agarwal
and Somaini (2016).
48
The online appendix shows that the probabilities of being assigned in Round 1 were lower for
non-enrollees, suggesting that households who took higher risks might have better outside options.

20

Table 3 Number of Schools Listed and Assignment (%)
Number of Schools Listed

Assignment Round

1

2

3

4 or more

1st

2nd

3rd-10th

Unassigned

All

46.9

12.4

16.9

23.8

93.0

2.8

1.5

2.7

Parental Edu < HS

49.8

15.0

19.5

15.7

93.2

2.7

1.6

2.5

Parental Edu = HS

43.4

12.1

18.4

26.2

92.0

3.5

1.5

3.0

Parental Edu > HS

47.4

10.6

13.9

20.1

93.7

2.3

1.3

2.7

Single-Parent

43.3

14.7

16.8

25.2

94.0

1.9

1.4

2.7

Table 4 Top-Listed Schools
Quality

Distance (100m)

Fees (100Euros)

All

7.9 (0.6)

7.1 (8.7)

8.1 (7.7)

Parental Edu < HS

7.6 (0.7)

5.2 (6.2)

5.4 (6.6)

Parental Edu = HS

7.9 (0.5)

7.0 (8.6)

8.1 (7.5)

Parental Edu > HS

8.2 (0.4)

8.7 (9.9)

9.9 (8.1)

Single-Parent

8.0 (0.6)

8.1 (9.9)

8.6 (8.4)

For suggestive evidence of strategic behavior, Table 6 compares a household’s toplisted school with other schools. A school is labeled as “better in 3” if it had higher
quality, lower tuition and shorter distance than one’s top-listed school; as “better
in 2” if it failed one of the three conditions. Of all households, 41% had at least
one “better in 3” school, with the average number being 5.2. Almost all households
had a considerable number of “better in 2” schools. Of course, unobservable tastes
and/or school characteristics may drive these choices, both of which are incorporated
in our model. However, these unobservables are unlikely to su¢ ce. First, “better”
schools overlap very little across households, suggesting a very limited role by school
unobservables. Second, these “better” schools were disproportionally unlikely to be
schools for which the household had higher admissions probabilities. For example, for
an average household with some “better in 3”schools, for only 14% of such schools did
the household have higher chances than its top choice. The same pattern holds if we
exclude those who top-listed a sibling school. These facts are hard to rationalize with
truthful reporting, unless households’unobserved tastes vary systematically with the
household-speci…c admissions probabilities.49 These data facts provide information
for the identi…cation of household type and preference distribution.
49

The online appendix shows further evidence via regression analyses.

21

Table 5 Enrollment in Public System (%)
All

96.7

Parental Edu < HS

97.0

Parental Edu = HS

97.1

Parental Edu > HS

96.3

Single-Parent

96.1

Assigned in Round 1

97.8

Table 6 “Better” Schools than the Top-Listed One
% Households

# Better Sch

%Better w/ Higher p

Have Sch. Better in 3 Aspects

40.7%

5.2 (9.9)

14.1%

Have Sch. Better in 2 Aspects

99.8%

75.9 (45.1)

10.5%

Have Sch. Better in 3 Aspects

39.3%

4.6 (8.7)

24.8%

Have Sch. Better in 2 Aspects

99.8%

77.3 (44.2)

17.8%

All Households (6,836)

Sib Sch. not Top-listed (4,025)

% Households: % of households that satisfy the condition speci…ed in each row.
#Better Sch: average (std.dev.) num. of better schools for households with such schools.
%Better w/ higher p: % of better sch with higher admission prob. than one’s top choice.

6
6.1

Results
Parameter Estimates

Table 7 presents the estimated parameters governing household preferences. The left
panel reports structural parameters governing parts of the utility function that vary
within an education group and the dispersions of tastes ( ) and post-application
shocks ( ). The cost of distance is convex, although the square term is not precisely
estimated.50 We also allow for two jumps in the cost of distance. The …rst jump is
set at 500 meters, an easy-to-walk distance even for a 3-year old; the second is at
1 kilometer, a long yet manageable walking distance. As households may have to
use other transportation methods beyond these distances, the cost of distance jumps
signi…cantly at the thresholds. The parameter on sibling schools adjusts such that
50

As in other discrete choice models, we need to normalize one coe¢ cient in the utility function
in order to identify
and ; and we normalize the linear term on distance to -1.

22

most (97%) households with sibling schools top-listed them. We …nd a high , which
explains why a household would give up its assigned school, especially if it is its …rst
choice.51 Taste dispersion
is relatively small, which is consistent with households’
low willingness to take risks (Table 6).

Table 7 Preference Parameters
Structural Parameter Estimatesa
Distance

2

Summarize School FEb
Edu < HS

Edu = HS

Edu > HS

-0.05 (0.04)

Constant

2766.3

2783.3

2423.0

Distance>5 (100m)

-55.3 (7.1)

Quality

152.0

176.4

187.8

Distance>10 (100m)

-46.5 (7.9)

Fee

-1.0

-0.6

-0.3

Sibling School

1339.0 (86.5)

Semi-Public

-0.6

6.5

0.8

Single Parent

-404.3 (12.2)

Capacity

(taste dispersion)
(post-app shock)
a
b

66.3 (6.2)
1937.8 (18.7)

2

Capacity

2

Quality

0.7
-0.001
-9.9

Structural preference parameter estimates, (standard errors in parentheses).

OLS regression of the estimated school value parameters on observables.

It would be non-informative to report the over 300 parameter estimates ( j ) of
school values. Instead, we use an OLS regression of these estimates on observables as
a summary (the right panel of Table 7).52 These OLS estimates will be unbiased only
if the unobserved school characteristics are uncorrelated with the observables. This
potential correlation does not a¤ect our policy analyses, which use the consistentlyestimated school values. However, one should be cautious when relating school values
and utils to wj . With caution, we have the following …ndings that are consistent with
data facts in Tables 3 to 5. 1) HS parents value schools more than the others,
especially the college group, for whom the outside option may be more a¤ordable. 2)
Higher educated parents value school quality more and are less sensitive to fees.53 3)
Households prefer schools with larger capacity, which tend to have more resources.
51

The ex-ante value of the outside option is normalized to zero, while the average value of schools
( j ) is estimated to be 3,391.
52
The form of the OLS follows model speci…cations in Section 4.1.2 and Appendix A.
53
Preferences for quality peak beyond the maximum school quality for the high education group,
at 99th percentile for the middle education group, and around 60th percentile for the low group.
Other studies also …nd that parents of di¤erent education value school characteristics di¤erently,
e.g., Burgess et al. (2009), Hastings et al. (2008), He (2012) and Abdulkadiro¼
glu et al. (2014).

23

4) Everything else being equal, semi-public schools are more preferable except for the
low-educated group.
Table 8 Type Distribution
Constant

-18.9 (2.3)

Single Parent

0.3 (0.5)

Education < HS

-0.1 (0.2)

Education > HS

0.7 (0.3)

No. schools in zone

-0.1 (0.2)

Average school quality in zone

3.1 (1.1)

Have an older sibling

49.0 (24.7)

Table 9 Strategic vs. Non-Strategic Type: Simulation
Strategic (%)

Strategic

Non-Strategic

All

96.3

Schools in zone

Parental Edu < HS

94.7

No. Schools

22.3

21.8

Parental Edu = HS

95.8

Ave. quality

7.9

7.7

Parental Edu > HS

97.8

Single-Parent

96.6

Have an older sibling

97.1

Table 8 presents the estimated type distribution parameters. Single parents and
parents with higher education levels are more likely to be strategic. Although strategic
households are not more likely to live in zones with more schools, they are more likely
to live in zones with better schools.54 Households with older children and therefore
have already gone through the process before, are more likely to be strategic.55 Based
on these estimates, Table 9 shows the simulated type distribution in our sample.
Consistent with data facts such as those in Table 6, 96% of households were strategic;
and the fraction increases with education.56 To obtain further insights on our …ndings,
54

We allow for the correlation between zone characteristics and types. The estimates are consistent
with our intuition that strategic households may choose home locations to utilize the residence-based
priority structure.
55
One extension is to incorporate the dynamic considerations by households with multiple children.
56
We …nd a much smaller fraction of non-strategic households than Abdulkadiro¼
glu et al. (2006).
The main reason is our incorporation of the outside option and the leftover schools, which rationalizes the choices by a substantial fraction of households that might be categorized as non-strategic
otherwise. Another reason is the long history of BM in Barcelona, where parents have become very
familiar with the mechanism.

24

we have re-estimated our model with the restriction that only 80% of households were
strategic. The …t of this restricted model is signi…cantly worse, as shown in the online
appendix.

6.2

Model Fits and Out-of-Sample Validation

The 2007 re-de…nition of priority zones abruptly changed the school-household-speci…c
priorities: priority schools became those that surrounded each home location.57 We
show model …ts for both the 2006 and the 2007 samples.58 To simulate the 2007
outcomes, we …rst calculate the admissions probabilities in 2007 via the same procedure as we do for 2006. Then we use the 2007 sample to conduct an out-of-sample
validation.59 Because the reform came as a surprise and households were unlikely to
relocate before submitting their applications in 2007, we simulate the distribution of
2007 household types using the characteristics of their residential zones according to
the 2006 de…nition.60
Considered as the most informative test of the model, the …rst two rows of Table
10 explore the changes in the de…nition of priority zones. The reform led to situations
where some schools were in the priority zone for a household in one year but not in
the other, which would a¤ect the behavior of a strategic household. In 2006, 24% of
households top-listed a school that was in their priority zone by the 2006 de…nition
but not by the 2007 de…nition. In 2007, the fraction of households top-listing these
schools dropped to 12%. On the other hand, the fraction of households that top-listed
schools in their priority zone only by the 2007 de…nition but not by the 2006 de…nition
increased from 3% to 12% over the two years. The model is able to replicate such
behaviors and predicts the changes as being from 24% to 14.6% for the …rst case,
and from 4.5% to 11% for the second case. The model also replicates the fact that
top-listed schools in 2007 were of similar quality, shorter distance and lower tuition,
relative to those in 2006. The model slightly under-predicts the fraction of households
assigned in Round 1 for 2006, but closely replicates the enrollment rate.
57

In 2007, the average (std) number of schools to which a household had priority became 7.0 (1.5).
More …tness tables are in the appendix.
59
In 2007, 12,335 Barcelona households participated, 7,437 of whom are selected into our validation
sample, using the same selection rule as before.
60
We also assume that strategic households had rational expectation about admissions probabilities in 2007. As shown below, we can …t the data in both years, suggesting that our assumptions
are not unreasonable.
58

25

Table 10 Model Fits
2006

2007

Data

Model

Data

Model

In Zone 06 Only (%)

24.1

24.1

12.0

14.6

In Zone 07 Only (%)

3.0

4.5

12.0

10.9

Quality

7.9

7.9

7.9

7.9

Distance (100m)

7.1

7.2

6.6

7.0

Fee (100 Euros)

8.1

8.1

7.9

7.8

1

93.0

91.3

92.0

92.6

2

2.8

4.0

3.1

3.6

1.5

0.9

1.8

0.6

2.7

3.8

3.1

3.2

Top-Listed Schools

Assignment Round (%)

3
Unassigned

Enrollment in the Public System (%)

7

All

96.7

96.5

97.6

96.6

Assigned in Round 1

97.8

97.1

98.3

97.1

BM vs. DA vs. TTC

Using the estimated model, we compare the baseline BM with DA and TTC. In a
di¤erent experiment, presented in the appendix, we assess the impacts of the 2007
reform. In both experiments, households’welfare refers to their evaluations of their
assignment outcomes relative to their outside options, i.e., vij :61

7.1

Theoretical Background

The DA procedure is similar to BM, however, students are only temporarily assigned
to schools in each round and one’s chance of being …nally admitted to a school does
not depend on the ranking of the school on her application. TTC creates cycles of
trade between individuals in each round. Each individual in a cycle trades o¤ a seat
in her highest-priority school for a seat in her announced most preferred school among
those with open seats. Whenever such a cycle is formed the allocation is …nal.
61
All simulations use the school-household-speci…c priority scores given by (1) ; following o¢ cial
rules in the relevant year.

26

Three properties are considered as desirable but cannot hold simultaneously in a
mechanism: Pareto e¢ ciency, truth revealing and the elimination of justi…ed envy
(aka stability).62 BM satis…es none of the properties. DA and TTC, with the standard priority structure, are both truth revealing, which are the cases we consider.63
Between the other two con‡icting properties, DA eliminates justi…ed envy, while TTC
achieves Pareto e¢ ciency. The welfare comparison between BM and its alternatives
is ambiguous because of two competing forces. On the one hand, BM can lead to potential misallocations because households hide their true preferences, which is absent
in DA and TTC. On the other hand, BM may better “respect”households’cardinal
preferences than DA and TTC (Abdulkadiro¼
glu et al. (2011)). BM-induced household behaviors increase the chance of a “right match”in that a school is matched to
households that value it more. Under a truth-revealing mechanism, households who
share the same ordinal preferences will rank schools the same way and have the same
chance of being allocated to various schools, regardless of who will gain the most
from each school. Given that it is theoretically inconclusive, the welfare comparison
between these mechanisms becomes an empirical question, one that we answer below.

7.2

Results

Under both DA and TTC with the standard priority structure, all households will
list their true preferences.64 We simulate each household’s application list accordingly and assign them using DA and then using TTC, and compare the results with
those from the baseline Barcelona case, i.e., BM with constant priority and single
lottery number.65 We present our results under the more recent (2007) priority zone
structure.66
Remark 3 We report total household welfare, the distribution of winners and losers
among di¤erent subgroups of households, as well as the assignment outcomes. Total
62

Stability requires that there be no unmatched student-school pair (i; j) where student i prefers
school j to her assignment and she has higher priority at j than some other student who is assigned
a seat at school j.
63
For example, one’s priority score in Round 1 does not carry over to future rounds.
64
To simulate DA and TTC, it is su¢ cient to know household preferences. However, to compare
DA or TTC with the baseline, one needs to know the distribution of household strategic types.
65
All these mechanisms use random lotteries break ties. For a given set of random lottery numbers,
we simulate the allocation procedure and obtain the outcomes for all students. We repeat this process
many times to obtain the expected (average) outcomes for each simulated student.
66
The 2006 results are similar.

27

household welfare is not necessarily the criterion for social welfare, which may involve
di¤erent weights across households. Given that we can calculate the welfare at the
household level, our results can be used to calculate any weighted social welfare. Given
a social objective, our results can be easily used for policy-making purposes, although
we do not necessarily recommend one mechanism over another in this paper.
7.2.1

Household Welfare Comparison

The …rst column of Table 11 shows household welfare under BM. Average welfare
decreases by 5.4 utils or 1,020 euros when BM is replaced by DA.67 The impacts di¤er
across households qualitatively and quantitatively, which leads to a wide dispersion.
Welfare decreases more for non-strategic households. Although the welfare loss in
utils decreases with education, the decreasing price sensitivity across education groups
yields a di¤erent ranking of euros lost. Clearly, one should not compare the losses
directly across education groups because they view the same euro amount di¤erently.68
The last two columns of Table 11 compares BM with TTC. For an average household,
the change from BM into TTC increases the welfare by 460 euros. As such, TTC
leads to the highest total household welfare among all three alternatives. The gains
are especially large for the non-strategic households, measured at 1,970 euros.
Result 1: In terms of total household welfare, the three mechanisms are ranked as
TTC > BM > DA. There are more losers than winners from a change of BM into
DA, and more winners than losers from a change of BM into TTC (Table 12).
67

The translation of utils to euros uses the education-speci…c coe¢ cients for fees as in Table 7.
Although the households we study face a much larger choice set and a more complicated problem
under BM as a result of the special priority rule in Barcelona, our …ndings are not peculiar. Hwang
(2015) and Agarwal and Somaini (2016), who study BM with standard priority rules, also …nd that
DA would yield lower welfare. Moreover, our …nding that DA decreases welfare for both strategic
and non-strategic households is consistent with some recent theoretical work, e.g., Abdulkadiro¼
glu
et al. (2011).
68

28

Table 11 Household Welfare: BM vs. DA vs. TTC
BMa

%

DA-BMb
utils

TTC-BMc

100 euros

utils

100 euros

All

3,811 (633)

-5.4 (30.9)

-10.2 (71.8)

1.9 (40.5)

4.6 (96.3)

Strategic

3,810 (633)

-5.3 (30.3)

-10.2 (69.9)

1.6 (39.9)

3.9 (94.3)

Non-strategic

3,818 (629)

-5.7 (41.0)

-19.7 (131.8)

8.3 (51.5)

19.7 (131.8)

Edu< HS

3,690 (600)

-9.9 (28.3)

-10.0 (28.6)

0.1 (31.4)

0.1 (31.7)

Edu= HS

3,934 (619)

-5.7 (33.0)

-18.3 (106.3)

2.5 (44.1)

8.0 (141.9)

Edu> HS

3,792 (647)

-2.1 (30.3)

-3.7 (54.6)

2.7 (42.8)

4.8 (77.2)

a

b

c

welfare under BM (std in parentheses), change from BM to DA, change from BM to TTC
utils: welfare change in utils.

100 euros: welfare change in 100 euros.

Table 12 Winners and Losers (%)
BM to DA

7.2.2

BM to TTC

Winner

Loser

Winner

Loser

All

11.7

33.0

25.0

21.5

Strategic

11.6

32.8

24.6

21.7

Non-strategic

15.3

36.7

32.3

17.5

Edu < HS

7.8

37.0

23.1

22.1

Edu = HS

13.0

35.5

27.4

23.0

Edu > HS

13.3

28.2

24.3

20.0

Cross-Zone Inequality

A household’s welfare can be signi…cantly a¤ected by the school quality within its zone
not only because of the quality-distance trade-o¤, but also because of the quality-risk
trade-o¤ created by the priority structure. For equity concerns, a replacement of BM
will be more desirable if it is more likely to bene…t those living in poor-quality zones.
Table 13 tests whether or not each of the counterfactual reforms meets this goal. In
the change from BM to DA, winners live in better zones than losers, which is against
the equity goal. The di¤erence in zone quality between these two groups is almost
20% of a std of quality across all zones. Changing from BM to TTC, the average
zone quality is similar across winners and losers.
Result 2: Welfare dependence on zone quality increases with a change from BM to
DA, and remains una¤ected by a change from BM to TTC.

29

Table 13 Zone Quality: Winners vs. Losers
BM to DA

BM to TTC

Winner

Loser

Winner

Loser

All

7.83

7.78

7.80

7.80

Edu < HS

7.72

7.67

7.69

7.68

Edu = HS

7.79

7.77

7.79

7.79

Edu > HS

7.90

7.88

7.89

7.91

The Cost of the Elimination of Justi…ed Envy Underlying the results in Table
13 is the residence-based priority and the high respect DA has for priorities that
enables it to eliminate justi…ed envy. The …rst three columns of Table 14 show the
fraction of households assigned to schools in their own school zones under alternative
mechanisms among all households and among those whose favorite schools are out of
their zones. The last three columns of Table 14 show households’chances of being
assigned to their favorite schools.
Result 3: DA assigns the largest fraction of households to in-zone schools, followed
by BM and then TTC. In terms of enabling households to get out of their zones to
attend their desired schools, the three mechanisms are ranked as TTC > BM > DA.
Table 14 The Cost of the Elimination of Justi…ed Envy
Assigned in Zone (%)

Assigned to Favorite (%)

BM

DA

TTC

BM

DA

TTC

All Households

65.1

70.1

58.4

68.3

64.1

67.8

Favorite is out of Zone

28.4

38.4

18.8

47.2

41.8

58.9

Remark 4 Like most studies on school choice mechanisms, our cross-mechanism
comparisons takes the priority structure as given.69 These structures di¤er across
cities; and they play an essential role. We leave it for future research to understand
the trade-o¤s and social objectives underlying these di¤erent priority structures.
7.2.3

School Assignment

Table 15 presents changes in the characteristics of schools households are assigned
to. When BM is replaced by DA, households are assigned to schools with higher
69

See Kominers and Sönmez (2012) and Dur et al. (2013) for examples of theoretical studies on
priority structures.

30

quality, shorter distance and higher fees.70 The low-education group sees the smallest
increase in quality and deduction in distance, while the largest increase in fees, which
explains why the average welfare (utils) decreases the most for this group (Table 11).
When BM is replaced by TTC, households are assigned to schools with higher quality,
longer distance and higher fees. That is, BM leads to misallocation as people hide
their true preferences, who ine¢ ciently apply for in-zone schools for which they higher
priorities, while giving up higher-quality out-of-zone schools.
Result 4: Compared to TTC, both BM and DA ine¢ ciently assign students to
schools that are closer but of lower quality.

Table 15 School Assignment
DA-BM

TTC-BM

Quality

Distance(100m)

Fees(euro)

Quality

Distance

Fees

All

0.04 (0.4)

-0.4 (4.7)

7.8 (333.2)

0.05 (0.5)

0.6 (5.5)

12.4 (427.0)

Edu < HS

0.02 (0.3)

-0.1 (4.2)

8.8 (284.6)

0.03 (0.4)

0.5 (4.7)

2.4 (360.4)

Edu = HS

0.05 (0.5)

-0.5 (5.1)

6.3 (356.0)

0.06 (0.5)

0.7 (5.9)

17.1 (461.1)

Edu > HS

0.05 (0.5)

-0.5 (4.7)

8.3 (343.9)

0.06 (0.5)

0.7 (5.6)

15.3 (438.8)

8

Conclusion

We have developed a model of households’choices of schools under the Boston mechanism (BM) and estimated the joint distribution of household preferences and their
strategic types, using data before a drastic change in household-school priorities. The
estimated model has been validated using data after this drastic change. We have
developed an e¢ cient method to fully solve household problems even when the choice
set is large. This method is applicable to a broad class of choice mechanisms, which
may expand the scope of empirical studies in this literature beyond what has been
feasible using the traditional solution method.
We have quanti…ed the welfare impacts of replacing the Boston mechanism with
its two alternatives, DA and TTC. A change from BM to DA decreases household
welfare and exacerbates inequalities across residential zones. A change from BM to
TTC increases welfare but does not a¤ect cross-zone inequalities.
70

A non-zero average change in quality is possible because there are more school seats than students
city-wise.

31

The methods developed in this paper and the main empirical …ndings are promising for future research. One particularly interesting extension is to incorporate household’s residential choices into the framework of this paper. Individual households may
relocate in order to take advantage of changes in school choice mechanisms and/or in
residence-based priority structures. Such individual incentives will in turn a¤ect the
housing market. There is a large literature on the capitalization of school quality for
housing prices, as reviewed by Black and Machin (2010) and Gibbons and Machin
(2008).71 An important yet challenging research project involves combining this literature and the framework proposed in our paper, in order to form a more comprehensive
view of the equilibrium impacts of school choice mechanisms on households’choices
of schools and residential areas, and on the housing market.

References
Abdulkadiro¼
glu, A., N. Agarwal and P. Pathak (2014). “The Welfare E¤ects of Congestion in Uncoordinated Assignment: Evidence from the NYC HS Match,” NBER
working paper.
Abdulkadiroglu, A., J. Angrist, S. Dynarski, T. Kane, and P. Pathak (2011). “Accountability and Flexibility in Public Schools: Evidence from Boston’s Charters and
Pilots,”Quarterly Journal of Economics, 126(2): 699–748.
Abdulkadiro¼
glu, A., Y. Che, and Y. Yasuda (2011). “Resolving Con‡icting Preferences in School Choice: the Boston Mechanism Reconsidered,” American Economic
Review, 101(1): 399-410.
Abdulkadiro¼
glu, A., P. Pathak, and A. Roth (2009). “Strategy-Proofness versus Ef…ciency in Matching with Indi¤erences: Redesigning the NYC High School Match.”
American Economic Review, 99(5): 1954–78.
Abdulkadiro¼
glu, A., P. Pathak, A. Roth and T. Sönmez (2005). “The Boston Public
School Match,”American Economic Review, Papers and Proceedings, 95(2): 368-371.
71

Ries and Somerville (2010) exploit changes in the catchment areas of public schools in Vancouver
and …nd signi…cant e¤ects of school performance on housing prices. Epple and Romano (2003)
conjecture that school choice systems can eliminate the capitalization of school quality on the housing
market. Machin and Salvanes (2010) exploit policy reforms in Oslo that allowed students to attend
schools without having to live in the school’s catchment area, and …nd a signi…cant decrease in the
correlation between a school’s quality and housing prices.

32

Abdulkadiro¼
glu, A., P. Pathak, A. Roth and T. Sönmez (2006). “Changing the Boston
School Choice Mechanism: Strategy-proofness as Equal Access,”National Bureau of
Economic Research Working Paper 11965.
Abdulkadiro¼
glu, A., and T. Sönmez (2003). “School Choice: A Mechanism Design
Approach,”American Economic Review, 93(3): 729-747.
Agarwal, N. and P. Somaini (2015). “Demand Analysis Using Strategic Reports: An
Application to a School Choice Mechanism,”Working Paper MIT.
Akyol, E. (2014). “Welfare Comparison of School Choice Mechanisms under Incomplete Information,”Working Paper Pennsylvania State University.
Arcidiacono, P. (2005). “A¢ rmative Action in Higher Education: How Do Admission
and Financial Aid Rules A¤ect Future Earnings?”Econometrica, 73(5): 1477-1524.
Azevedo, E. and J. Hat…eld (2015). “Existence of Equilibrium in Large Matching
Markets with Complementarities,”Mimeo, Wharton.
Azevedo, E. and J. Leshno (2015). “A supply and demand framework for two-sided
matching markets”forthcoming, Journal of Political Economy
Bajari, P. and A. Hortacsu (2005) “Are Structural Estimates of Auction Models
Reasonable? Evidence from Experimental Data,”Journal of Political Economy 113,
703–741.
Black, S. and S. Machin (2010) “Housing Valuations of School Performance” in E.
Hanishek, S. Machin and L. Woessmann (eds.), Handbook of the Economics of Education, Amsterdam: Elsevier.
Blume, L., W. Brock, S. Durlauf and Y. Ioannides (2011). “Identi…cation of Social
Interactions,” Handbook of Social Economics, ed. by J. Benhabib, A. Bisin and M.
Jackson, North-Holland, Vol 1B: 853-964.
Burgess, S., E. Greaves, A. Vignoles and D. Wilson (2009). “Parental Choice of
primary school in England: what type of schools do parents choose?”CMPO Working
Paper No. 09/224.
Calsamiglia, C., M. Güell (2014). “The Illusion of Choice: Evidence from Barcelona,”
CEPR Discussion Paper 10011.
33

Calsamiglia, C. and Miralles A. (2014). “All about priorities? Less choice with bad
schools,”mimeo UAB.
Chen, Y., and T. Sönmez (2006). “School Choice: An Experimental Study,”Journal
of Economic Theory, 127(1): 202-231.
Deming, D., J. Hastings, T. Kane, and D. Staiger (2014). “School Choice, School
Quality and Postsecondary Attainment,” American Economic Review, 104(3): 991–
1013.
Epple, D. and R. Romano (2003). “Neighborhood Schools, Choice, and the Distribution of Educational Bene…ts,” in C. Hoxby (ed), The Economics of School Choice,
University of Chicago Press.
Epple, D. and R. Romano (2011). “Peer e¤ects in education : a survey of the theory
and evidence,” Handbook of Social Economics, ed. by J. Benhabib, A. Bisin and M.
Jackson, North-Holland, Vol 1B: 1053-1163.
Ergin, H., and T. Sönmez (2006). “Games of School Choice under the Boston Mechanism,”Journal of Public Economics, 90(1-2): 215-237.
Dur, U., S. Kominers, P. Pathak and T. Sönmez (2013). "The Demise of Walk Zones
in Boston: Priorities vs. Precedence in School Choice," NBER Working Paper No.
18981.
Featherston, C. and M. Niederle (2008). “Ex Ante E¢ ciency in School Choice Mechanisms: An Experimental Investigation,”NBER Working Paper 14618.
Fu, C. (2014). “Equilibrium Tuition, Applications, Admissions and Enrollment in the
College Market,”Journal of Political Economy, 122(2): 225-281.
Gibbons, S. and S. Machin (2008) “Valuing School Quality, Better Transport and
Lower Crime,”Oxford Review of Economic Policy, 24: 99-119.
Hastings, J., T. Kane and D. Staiger (2009). “Heterogeneous Preferences and the
E¢ cacy of School Choice,”NBER Paper Working Paper 12145.
Hastings, J. and J. Weinstein (2008) “Information, School Choice and Academic
Achievement: Evidence from Two Experiments,” Quarterly Journal of Economics,
1373-1414.
34

Hat…eld, J., F. Kojima, and Y. Narita (2014), “Promoting School Competition
through School Choice: A Market Design Approach,”Mimeo, Stanford University.
He, Y. (2014). “Gaming the Boston School Choice Mechanism in Beijing,” Working
Paper, Toulouse School of Economics.
Heckman, J. and S. Mosso (2014). “The Economics of Human Development and Social
Mobility,”Working paper, University of Chicago.
Hoxby, C. (2003): “School Choice and School Productivity (Or, Could School Choice
be a Rising Tide that Lifts All Boats),” in The Economics of School Choice, ed. by
C. Hoxby. Chicago: University of Chicago Press.
Hwang, S. (2015). “A Robust Redesign of High School Match,”Working Paper, UBC.
Jensen, R. (2010). “The (Perceived) Returns to Education and the Demand for
Schooling,”Quarterly Journal of Economics, 125 2, 515-548.
Keane, M. and R. Mo¢ tt (1998). “A Structural Model of Multiple Welfare Program
Participation and Labor Supply.” International Economic Review 39, 553–590.
Keane, M., P. Todd and K. Wolpin (2011) “The Structural Estimation of Behavioral
Models: Discrete Choice Dynamic Programming Methods and Applications,” in: O.
Ashenfelter and D. Card (Eds.) Handbook of Labor Economics, North-Holland. Vol
4A: 331-461.
Keane, M. and K. Wolpin (2007). “Exploring the Usefulness of a Non-random Holdout
Sample for Model Validation: Welfare E¤ects on Female Behavior,” International
Economic Review 48, 1351–1378.
Kojima, F. (2015). "Recent Developments in Matching Theory and their Practical
Applications," Manuscript, Stanford University.
Kominers, S. and T. Sönmez (2012). "Designing for Diversity: Matching with SlotSpeci…c Priorities," Boston College Working Paper No. 806.
Lavy, V. (2010) “E¤ects of Free Choice Among Public Schools.”The Review of Economic Studies, 77: 1164–1191.

35

Lewbel, A. (2000). “Semiparametric qualitative response model estimation with unknown heteroscedasticity or instrumental variables,” Journal of Econometrics, 97:
145-177.
Lise, J., S. Seitz, and J. Smith (2005). “Equilibrium Policy Experiments and the
Evaluation of Social Programs,”Mimeo, Queens University.
Lu, J. (2014). “Cardinal Utility and Incomplete Information in School Choice:
Strengthening the Case for the Boston Mechanism,”Undergraduate Thesis, Harvard
University.
Lumsdaine, R., J. Stock, and D. Wise (1992). “Pension Plan Provisions and Retirement: Men and Women, Medicare, and Models,”In: Wise, D.A. (Ed.), Studies in the
Economics of Aging, University of Chicago Press, Chicago.
Machin, S., and K. G. Salvanes (2010). “Valuing School Quality via School Choice
Reform,”IZA Discussion Paper No 4719.
Matzkin, R. (1993). “Nonparametric Identi…cation and Estimation of Polychotomous
Choice Models,”Journal of Econometrics, 58: 137-168.
McFadden, D., and A. Talvitie (1977). “Validation of Disaggregate Travel Demand
Models: Some Tests,” Urban demand forecasting project, …nal report. Vol. V, Institute of Transportation Studies, University of California, Berkeley.
Mehta, N. (2013). “Competition in Public School Districts: Charter School Entry,
Student Sorting, and School Input Determination,”Working paper, UWO.
Miralles, A. (2008). “School Choice: The Case for the Boston Mechanism,” Mimeo,
Barcelona Graduate School of Economics.
Pais, J., and A. Pinter (2008). “School Choice and Information: An Experimental
Study on Matching Mechanisms,”Games and Economic Behavior, 64(1): 303-38.
Pathak, P. and P. Shi (2014). “Demand Modeling, Forecasting, and Counterfactuals,”
NBER working paper.
Pathak, P. and T. Sönmez (2008). “Leveling the Playing Field: Sincere and Sophisticated Players in the Boston Mechanism,” American Economic Review, 98(4):
1636–52.
36

Pathak, P. and T. Sönmez (2013). “School Admissions Reform in Chicago and England: Comparing Mechanisms by their Vulnerability to Manipulation,” American
Economic Review, 103(1): 80–106.
Ries, J. and T. Somerville (2010). “School Quality and Residential Property Values:
Evidence from Vancouver Rezoning,”Review of Economics and Statistics, 92(4), 928944.
Rothstein, J. (2006). “Good Principals or Good Peers: Parental Valuation of School
Characteristics, Tiebout Equilibrium, and the Incentive E¤ects of Competition
Among Jurisdictions,”American Economic Review, 96(4): 1333–1350.
Todd, P. and K. Wolpin (2006). “Assessing the Impact of a School Subsidy Program
in Mexico: Using a Social Experiment to Validate a Dynamic Behavioral Model of
Child Schooling and Fertility.”American Economic Review 96, 1384–1417.
Troyan, P. (2012). “Comparing School Choice Mechanisms by Interim and Ex-ante
Welfare,”Games and Economic Behavior, 75(2): 936-947.
Walters, C. (2013). “A Structural Model of Charter School Choice and Academic
Achievement,”Working paper, UC-Berkeley.
Wise, D. (1985). “A Behavioral Model versus Experimentation: the E¤ects of Housing
Subsidies on Rent.” In: Brucker, P. and R. Pauly (Eds.), Methods of Operations
Research, 50: 441–489.

Appendix
A1. Detailed Functional Forms
Household: xi = [xi1 ; :::; xi5 ] : xi1 = I (edui < High school) ; xi2 = I (edui = HS) ;
xi3 = I (edui > HS) ; xi4 = I (single parenti = 1) ; xi5 = sibling’s school (xi5 = 0 if
outside school, 2 f1; :::Jg if non-private school, 9 if no sibling).
School: wj = [wj1 ; wj2 ; wj3 ; wj4 ]. wj1 : school quality, wj2 : tuition, wj3 : capacity,
wj4 = 1 if semi-public, 0 otherwise.
Zone: Nz : # of schools in zone z; q z : the average school quality in z:
A1.1 Utility: Preference heterogeneity is captured via 3 channels: 1) general school
values relative to the outside option vary with x; 2) trade-o¤s among distance, quality,
37

tuition and unobserved school characteristics vary with education; 3) idiosyncratic
tastes. De…ne g ( ) and C ( ) such that U (wj ; xi ; dij ; j ) = g (wj ; xi ; j ) C (dij ) ;
C (dij ) = dij + c1 d2ij + c2 I (dij > 5) + c3 I (dij > 10) :
g (wj ; xi ; j ) =
+

3
X

1 xi4

xim (

+

0m

[I (xi5 = j)

2

+

1m j )

I (xi5 = 0)]
3
X

+ wj1

m=1

+

7 wj3

+

2
8 wj3

2
9 wj1

+

+ wj4

m xim

m=1
3
X

!

+ wj2

9+m xim

m=1

!

3
X

:

The last two rows are education-speci…c preference for wj and
X

(

0e

+

1e j

+ wj

e) I

3+m xim

m=1

!

j,

with the form of

(edui = e) :

e

A1.2 Type distribution
(xi ; li ) =

(xi ; zli ) =

exp(

0

+

1 + exp(

0

P4

m=1

+

P4

m xim

m=1

+

m xim

5I

+

(xi5
5I

(xi5

0) +

6 Nzli

0) +

+

6 Nzli

7 q zl

+

i

)

7 q zl

i

)

:

B. Policy Evaluation: The 2007 Reform
We simulate the outcomes for the 2007 applicants had they lived under the 2006
regime, taking as given the 2006 admissions probabilities. The results can be interpreted in two ways: 1) they are at the individual level, i.e., “what would have
happened to a 2007 applicant had she applied in 2006?” 2) assuming that the 2006
and 2007 cohorts are two i.i.d. random samples from the same distribution, the results
tell us “what would have happened to all 2007 households without the reform and if
they had played the same equilibrium as the 2006 cohort?”Table A6 shows that 17%
of households gained and 7% of them lost from the reform, with more non-strategic
households a¤ected. Overall, the gain from the reform was equivalent to 1,430 euros.
C. Additional Tables72
72

As mentioned in the model section, there can be multiple lists that are payo¤-equivalent and
imply the same allocation results. All these lists have identical ordered elements that are allocationrelevant, which is what our model can explain. For example, consider a list of length 4, the third
element of which was a leftover school. Our model is designed to replicate the …rst three elements

38

Table A1 Model Fit: Relevant List Length (%)
2006

2007

Data

Model

Data

Model

1

85.8

83.1

86.1

83.2

2

11.5

14.5

11.7

10.3

2.7

3.4

2.2

6.5

3

Table A2 Model Fit: Assignment Round (%)
Edu < HS

Edu = HS

Edu > HS

Single Parents

2006

Data

Model

Data

Model

Data

Model

Data

Model

1

93.2

91.8

92.0

91.0

93.7

91.2

94.0

93.4

2

2.7

2.8

3.5

4.0

2.3

4.8

1.9

2.8

Unassigned

2.5

4.2

3.0

3.9

2.7

3.3

2.7

3.6

1

91.0

92.0

90.6

91.8

93.7

93.7

91.3

92.4

2

3.7

3.8

3.2

3.8

2.2

3.1

2.9

3.1

Unassigned

3.5

3.0

4.0

4.0

2.5

2.8

3.3

3.1

2007

Table A3 Model Fit: Enrollment in Public System
2006

2007

Data

Model

Data

Model

Parental Edu < HS

96.9

96.2

96.4

96.2

Parental Edu = HS

97.1

97.0

98.4

97.0

Parental Edu > HS

96.3

96.4

97.8

96.7

Single-Parent

96.1

95.5

97.0

95.8

of that list, not how many schools would be listed beyond that point. Table 12 presents the model
…t for the length of the allocation-relevant part of household application lists.

39

Table A4 Model Fit: Top-Listed Schools
Quality
2006

Distance (100m)

Tuition (100 Euros)

Data

Model

Data

Model

Data

Model

Parental Edu < HS

7.6

7.6

5.2

6.0

5.4

5.7

Parental Edu = HS

7.9

7.9

7.0

7.1

8.1

8.3

Parental Edu > HS

8.2

8.2

8.7

8.2

9.9

9.6

Single-Parent

8.0

8.0

8.1

8.0

8.6

8.6

Parental Edu < HS

7.5

7.6

5.2

5.9

5.3

5.4

Parental Edu = HS

8.0

7.9

6.3

6.8

8.2

8.0

Parental Edu > HS

8.2

8.2

7.8

8.2

9.7

9.5

Single-Parent

8.0

8.0

6.8

7.2

8.2

8.0

2007

Table A5 School Assignment: BM
Quality

Distance (100m)

Fees (100Euros)

All

7.8 (0.7)

7.3 (7.9)

7.7 (7.4)

Edu < HS

7.4 (0.7)

6.6 (6.9)

5.2 (6.2)

Edu = HS

7.8 (0.6)

7.1 (7.2)

7.7 (7.1)

Edu > HS

8.0 (0.7)

8.1 (8.3)

9.3 (8.0)

Table A6 Impact of the 2007 Reform
Winner(%)

Loser(%)

utils

100 Euros

All

16.7

6.7

6.7 (29.5)

14.3 (68.4)

Strategic

16.6

6.5

6.6 (28.7)

14.1 (65.9)

Non-strategic

20.8

11.9

8.2 (43.8)

18.9 (108.4)

Edu < HS

14.7

7.0

4.9 (25.7)

5.0 (26.0)

Edu = HS

18.1

7.7

7.1 (31.0)

22.9 (99.8)

Edu > HS

17.1

5.9

7.6 (30.6)

13.7 (55.2)

Compare the welfare of a 2007 household under the 2007 regime with its would-be
welfare under the 2006 regime. Winners have higher welfare under the 2007 regime.

40

