NBER WORKING PAPER SERIES

ESTIMATION OF DYNAMIC DISCRETE CHOICE MODELS IN CONTINUOUS
TIME WITH AN APPLICATION TO RETAIL COMPETITION
Peter Arcidiacono
Patrick Bayer
Jason R. Blevins
Paul B. Ellickson
Working Paper 18449
http://www.nber.org/papers/w18449
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
October 2012

We thank the attendees of the 2009 Cowles Foundation Conference on Structural Microeconomics,
the 2010 cemmap Conference on Matching and Sorting, and the 2012 NBER/NSF/CEME Conference
on the Econometrics of Dynamic Games as well as seminar participants at Chicago (Economics and
Booth), Duke, Harvard, Johns Hopkins, Kentucky, London School of Economics, Michigan, Ohio
State (Economics and Fisher), Penn State, Rochester, Toronto, UBC, UC Davis, UCLA, Virginia,
Western Ontario, Washington University (Olin), Wisconsin, and Yale for useful comments. Timothy
Schwuchow provided excellent research assistance. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2012 by Peter Arcidiacono, Patrick Bayer, Jason R. Blevins, and Paul B. Ellickson. All rights reserved.
Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Estimation of Dynamic Discrete Choice Models in Continuous Time with an Application
to Retail Competition
Peter Arcidiacono, Patrick Bayer, Jason R. Blevins, and Paul B. Ellickson
NBER Working Paper No. 18449
October 2012, Revised Fabruary 2015
JEL No. C13,C35,L11,L13
ABSTRACT
This paper develops a dynamic model of retail competition and uses it to study the impact of the expansion
of a new national competitor on the structure of urban markets. In order to accommodate substantial
heterogeneity (both observed and unobserved) across agents and markets, the paper first develops
a general framework for estimating and solving dynamic discrete choice models in continuous time
that is computationally light and readily applicable to dynamic games. In the proposed framework,
players face a standard dynamic discrete choice problem at decision times that occur stochastically.
The resulting stochastic-sequential structure naturally admits the use of CCP methods for estimation
and makes it possible to compute counterfactual simulations for relatively high-dimensional games.
The model and method are applied to the retail grocery industry, into which Wal-Mart began rapidly
expanding in the early 1990s, eventually attaining a dominant position. We find that Wal-Mart’s expansion
into groceries came mostly at the expense of the large incumbent supermarket chains, rather than the
single-store outlets that bore the brunt of its earlier conquest of the broader general merchandise sector.
Instead, we find that independent grocers actually thrive when Wal-Mart enters, leading to an overall
reduction in market concentration. These competitive effects are strongest in larger markets and those
into which Wal-Mart expanded most rapidly, suggesting a diminishing role of scale and a greater emphasis
on differentiation in this previously mature industry.
Peter Arcidiacono
Department of Economics
201A Social Sciences Building
Duke University
Durham, NC 27708
and NBER
psarcidi@econ.duke.edu
Patrick Bayer
Department of Economics
Duke University
213 Social Sciences
Durham, NC 27708
and NBER
patrick.bayer@duke.edu

Jason R. Blevins
Department of Economics
Ohio State University
Columbus, OH
blevins.141@osu.edu
Paul B. Ellickson
Simon School of Business Administration
University of Rochester
Rochester, NY 14627
Email: paul.ellickson@simon.rochester.edu
paul.ellickson@simon.rochester.edu

1

Introduction

Beginning with the static equilibrium entry models of Bresnahan and Reiss (1991) and Berry
(1992), the modern empirical literature in industrial organization has sought to understand
the determinants of market structure and its impact on market power and the nature of
competition in oligopolistic industries. Recent papers have extended these models to permit
forward-looking behavior on the part of firms, as well as more complex forms of investment
and post-entry competition.1 Adding such dynamic considerations broadens the nature
of strategic interactions among firms and permits the study of a range of fundamentally
dynamic phenomena such as preemption, predation, and limit pricing.
Using existing methods, incorporating forward-looking behavior in models of strategic
interaction has been computationally costly, making it infeasible to compute the dynamic
equilibrium unless the state space is sufficiently small. As a result, empirical researchers
have often had to sacrifice much of the rich firm and market heterogeneity that can be
incorporated in static models in order to study the kinds of interesting strategic behavior
that can result when firms are forward-looking. With this trade-off in mind, the central
goal of this paper is to provide a new approach for computing dynamic equilibrium models
of market competition that is much lighter computationally and, therefore, permits the
study of dynamic behavior without preventing researchers from incorporating dimensions
of heterogeneity (both observed and unobserved) that may be critical for understanding key
aspects of the nature of market competition.
At the outset, it is important to clarify that the key computational challenge in the
dynamic games literature is related to the computation of the dynamic equilibrium (e.g., for
use in counterfactuals) rather than estimation per se. In particular, since the seminal work
of Hotz and Miller (1993) and Hotz, Miller, Sanders, and Smith (1994), conditional choice
probability (CCP) estimators have been applied to a wide range of dynamic discrete choice
problems including, more recently, simultaneous-move dynamic games (Aguirregabiria and
Mira, 2007, Bajari et al., 2007, Pesendorfer and Schmidt-Dengler, 2007, Pakes et al., 2007).
The key advantage of CCP estimation is that it eliminates the need to compute the full
solution of the dynamic game, allowing empirical researchers to estimate relatively highdimensional games, including many that can not be solved directly even once.
While knowledge of the key parameters of many dynamic games can be informative, a
key limitation of the application of CCP estimation to high-dimensional problems is that it
1
Building on earlier methodological contributions pioneered by Aguirregabiria and Mira (2007), Bajari,
Benkard, and Levin (2007), Pesendorfer and Schmidt-Dengler (2007), and Pakes, Ostrovsky, and Berry
(2007), empirical researchers have recently examined the impact of environmental regulations on entry,
investment and market power in the cement industry (Ryan, 2012), the effect of demand fluctuations in the
concrete industry (Collard-Wexler, 2013), and the impact of increased royalty fees on the variety of products
offered by commercial radio stations (Sweeting, 2013).

2

is often impossible to compute counterfactual simulations of the estimated model. In the
context of games, the calculation of players’ expectations over all combinations of actions
of their rivals grows exponentially in the number of players, making it computationally
challenging to compute the equilibrium even in some relatively simple economic contexts.2
In this paper, we develop a characterization of a dynamic game in continuous time
that not only alleviates some of the computational difficulties associated with simultaneous
move games, but also links naturally with the existing literature on dynamic discrete choice
models and dynamic discrete games. The key feature of our approach is that players face
a standard dynamic discrete choice problem at decision times that occur stochastically.
The resulting stochastic-sequential structure naturally admits the use of CCP methods
for estimation and makes it possible to compute counterfactual simulations for relatively
high-dimensional games.
CCP estimation applied to our formulation of a dynamic game in continuous time has
several important advantages that carry over from the discrete time literature. Most directly, CCP estimation continues to eliminate the need to compute the full solution of
the model for estimation. Using our framework, the two-step estimators of Aguirregabiria
and Mira (2002, 2007), Bajari et al. (2007), Hotz et al. (1994), Pakes et al. (2007), and
Pesendorfer and Schmidt-Dengler (2007) can be applied in continuous time. In most empirical studies, the equilibrium will only need to be computed a handful of times to perform
the counterfactual analyses conducted in the paper. In addition, it is straightforward to
account for unobserved heterogeneity with our framework by extending the methods of
Arcidiacono and Miller (2011). We demonstrate both of these advantages in our empirical application, applying the methods to a high dimensional problem while incorporating
unobserved heterogeneity, an important feature of the institutional setting.
But, importantly, CCP estimation has additional advantages in continuous time beyond
those studied in the discrete time literature. In particular, it is easier to satisfy the finite
dependence property of Arcidiacono and Miller (2011, 2014) and Altu and Miller (1998),
whereby only a handful of conditional choice probabilities are needed to express the future
utility term. This occurs because the inversion theorem of Hotz and Miller (1993) yields
a mapping between differences in value functions and conditional choice probabilities in
the continuous time setting, as opposed to differences in conditional value functions and
conditional choice probabilities in the discrete time setting. As we illustrate in Section 3,
working with value functions rather than conditional value functions also has the added
benefit of limiting the need to estimate conditional choice probabilities for rare events, a
prevalent feature in many empirical settings.
2

These limitations have led some to suggest alternatives to the Markov perfect equilibrium concept in
which firms condition on long run averages (regarding rivals’ states) instead of current information (Weintraub, Benkard, and Van Roy, 2008).

3

We take advantage of this new formulation of a dynamic game in continuous time to
study the impact of a new national competitor on the structure of urban markets across the
United States. Specifically, we examine the impact of Wal-Mart’s rapid expansion into the
retail grocery industry from 1994–2006.3 In particular, we model the decisions of Wal-Mart
and its rivals over whether to operate grocery stores in a market and at what scale (i.e.,
number of stores). We include the choices of Wal-Mart and up to seven competing chains,
as well as the single-store entry and exit decisions of several dozen fringe players. Each
geographic market is characterized by observed features—most importantly, the level and
growth rate of population—as well as unobserved heterogeneity that affects the relative
profitability of Wal-Mart, chain, and fringe stores in that market.
This characterization of the problem results in a dynamic game that has a rich error
structure (due to the unobserved heterogeneity) and an enormous number of states. We
estimate the model using CCP methods and solve counterfactually for the equilibrium under
several scenarios designed to measure how Wal-Mart’s entry into the retail grocery industry
affects the profitability and decision-making of rival chain and fringe firms.4
The estimates imply that Wal-Mart’s entry has a substantial impact on market structure
that is heterogeneous both across markets and firm types. In particular, we find that
Wal-Mart’s expansion came mostly at the expense of the large, incumbent grocery chains,
leading some to exit the market completely and sharply diminishing the scale of others. In
contrast, the small fringe firms actually thrive in the new market structure, suggesting a
greater ability to differentiate themselves (e.g., in terms of product offerings or geography)
from both Wal-Mart and the remaining chains. Taken as a whole, market concentration is
sharply reduced by Wal-Mart’s entry in these markets.
Notably, this new, entrepreneurial activity is strongest in the larger markets and those
into which Wal-Mart expanded the fastest. In contrast, in another set of (primarily smaller,
Western) markets, Wal-Mart’s entry greatly concentrates the market in a way that closely
resembles the impact of its initial entry into discount retailing two decades earlier (Jia, 2008).
Wal-Mart’s entry is felt most directly by the fringe firms in these markets because, much
like the rural markets Wal-Mart focused on originally, chain stores were less established in
these markets to begin with. However, in the vast majority of grocery markets, Wal-Mart
actually benefits the fringe.
A comparison of the results for specifications with and without unobserved heterogeneity
reveals that the inclusion of unobserved heterogeneity is essential for uncovering these qual3

Our methods have also been applied by Nevskaya and Albuquerque (2012) to online games, by Schiraldi,
Smith, and Takahasi (2012) to supermarkets, by Mazur (2014) to airlines, and by Cosman (2014) to bars in
Chicago.
4
Our counterfactual policy simulations involve calculating value functions at up to 157 million states in
each of 205 markets, yet by taking advantage of the continuous time formulation this is computationally
feasible.

4

itatively distinct economic implications of Wal-Mart’s entry across markets. While there
is still some variation across markets, the specification without unobserved heterogeneity
implies that Wal-Mart’s entry decreases market concentration in every market in the sample
and sharply understates the positive impact on small, independent stores, especially in the
larger markets. Taken as a whole, the results of our analysis demonstrate the importance
of incorporating substantial heterogeneity both across markets and firm types in estimating
dynamic games of retail entry and competition, thereby highlighting the advantage of computationally light approaches for estimating and solving dynamic models with large state
spaces.
Our paper relates to the literature on both estimation of dynamic models in continuous time as well as the empirical literature on entry in retail markets.5 Continuous-time
methods have a long history in the search literature. Our approach is most connected to
the literature in which job offers arrive at an exogenous rate. Another vein of the search
literature, however, assumes that individuals receive offers according to their search intensity, effectively choosing a hazard rate for job offers. This is the spirit of Doraszelski and
Judd (2012) who first illustrated the computational advantages of casting dynamic games
into continuous time. Players in their model make simultaneous, continuous decisions that
control the hazard rate of state changes (e.g., choose an investment hazard which results
stochastically in a discrete productivity gain). In our paper, we take advantage of the
insight of Doraszelski and Judd (2012) regarding how continuous time, and more specifically sequential state-to-state transitions, can reduce the computational burden of dynamic
games but reframe the problem in a way that naturally parallels the discrete time discrete
choice literature and retains the computational advantages of CCP methods in estimation
as well as circumventing issues of multiple equilibria in estimation.
The paper is structured as follows. Section 2 introduces our model in a simple singleagent context in order to build intuition. Section 3 develops an alternative CCP representation of the value function which will facilitate two-step estimation of the model. Section 4
extends the model to the multi-agent setting. Concrete and canonical examples are provided
in both the single- and multi-agent cases. Section 5 develops our estimators and discusses
issues associated with time aggregation. Section 6 introduces and describes the results of
our empirical analysis of the market structure of grocery store chains in geographically
separate U.S. markets. Section 7 concludes.
5

On the empirical side, our paper is the first to estimate structurally the impact of Wal-Mart on both
chain and a single store firms. Ellickson and Grieco (2013) examine the impact of Wal-Mart on the structure
of the supermarket industry using descriptive methods from the treatment effects literature, while Basker
and Noel (2009) and Matsa (2011) look at its impact on prices and quality. Wal-Mart’s previous experience
in the discount industry has been analyzed by Jia (2008), Holmes (2011), and Ellickson, Houghton, and
Timmins (2010).

5

2

Single-Agent Dynamic Discrete Choice Models

In this section, we introduce a dynamic discrete choice model of single-agent decisionmaking in continuous time. The single-agent problem provides a simple setting in which to
describe the main features of our continuous time framework. We show how these extend
directly to multi-agent settings in the following section. We begin this section by laying
out the notation and structure of the model in a general context. We then introduce an
example—the classic bus engine (capital) replacement model of Rust (1987)—to illustrate
how to apply our model in a familiar setting.
Consider a dynamic single-agent decision problem in which time is continuous, indexed
by t œ [0, Œ). The state of the model at any time t can be summarized by an element

k of some finite state space X = {1, . . . , K}. Two competing Poisson processes drive the
dynamics of the model. First, a finite-state Markov jump process on X with a K ◊ K

intensity matrix Q0 governs moves by nature—exogenous state changes that are not a
result of actions by the agent. The elements of Q0 are the rates at which particular state
transitions occur. Second, a Poisson arrival process with rate parameter ⁄ governs when
the agent can move. When a move opportunity arrives, the agent chooses an action j from
among J alternatives in a discrete choice set A = {0, . . . , J ≠ 1}, conditional on the current

state k.

Before describing the agent’s problem, we review some properties of finite Markov jump
processes, which are the basic building blocks of our model and can be used to characterize
both exogenous and endogenous state changes on X . A finite Markov jump process on X

is a stochastic process Xt indexed by t œ [0, Œ). At any time t, the process remains at
Xt for a random time interval · (the holding time) before transitioning to some new state
Xt+· . A sample path of such a process is a piecewise-constant, right-continuous function
of time. Jumps occur according to a Poisson process and the holding times between jumps
are exponentially distributed.
A finite-state Markov jump process can be characterized by an intensity matrix, which
contains the rate parameters for each possible state transition:
S

q11

W
W q21
W
Q=W .
W ..
U

...

q1K

q22
..
.

...
..
.

q2K X
X
.
.. X
. X

qK1 qK2 . . . qKK

For l ”= k

T

q12

X
V

Pr (Xt+h = l | Xt = k)
hæ0
h

qkl = lim

6

is the hazard rate for transitions from state k to state l and
qkk = ≠

ÿ
l”=k

qkl

is the overall rate at which the process leaves state k (and hence, qkk is negative). Transitions
out of state k follow an exponential distribution with rate parameter ≠qkk and, conditional
on leaving state k, the process transitions to l ”= k with probability qkl /

q

lÕ ”=k qklÕ .

For

additional details about Markov jump processes see, for example, Karlin and Taylor (1975,
Section 4.8).

Returning to the agent’s problem, we assume that the agent is forward-looking and
discounts future payoffs at rate ﬂ. Exogenous state changes that the agent cannot control
occur according to a Markov jump process with intensity matrix Q0 . While in state k, the
agent receives flow utility uk . At rate ⁄ œ (0, Œ) the agent makes a decision, choosing an

action j œ A and receiving an instantaneous payoff Âjk + Áj , where Âjk is the mean payoff
(or cost) associated with making choice j in state k and Áj œ R is an instantaneous choice-

specific payoff shock.6 Let ‡jk denote the probability that the agent optimally chooses
choice j in state k. The agent’s choice may result in a deterministic state change. Let
l(j, k) denote the state that results upon making choice j in state k.
We can now derive the instantaneous Bellman equation, a recursive expression for the
value function Vk which gives the present discounted value of all future payoffs obtained from
starting in some state k and behaving optimally in future periods. For small time increments

h, under the Poisson assumption, the probability of an event with rate ⁄ occurring is ⁄h.
Given the discount rate ﬂ, the discount factor for such increments is 1/(1 + ﬂh). Thus, for
small time increments h the optimal discounted value in state k satisfies
S

Ó
Ô
ÿ
1 U
uk h +
qkl hVl + ⁄h E max Âjk + Áj + Vl(j,k)
Vk =
j
1 + ﬂh
l”=k
Q

+ a1 ≠ ⁄h ≠

ÿ
l”=k

R

T

qkl hb Vk + o(h)V .

Rearranging and letting h æ 0, we obtain the following recursive expression for Vk :
Vk =

uk +

q

+ ⁄ E maxj {Âjk + Áj + Vl(j,k) }
q
.
ﬂ + ⁄ + l”=k qkl

l”=k qkl Vl

(1)

6
Although the choice-specific shocks Áj vary over time, we omit the t subscript for notational simplicity.
For convenience, we also assume the distribution of Áj is independent of the state, to avoid conditioning
on k throughout, but the joint distribution of the vector Á = (Á0 , . . . , ÁJ≠1 )€ can, in general, depend on k
without additional difficulties.

7

The denominator contains the sum of the discount factor and the rates of all possible state
changes. The numerator is composed of the flow payoff for being in state k, the rate-weighted
values associated with exogenous state changes, and the expected current and future value
obtained when a move arrival occurs in state k. The expectation is with respect to the joint
distribution of Á = (Á0 , . . . , ÁJ≠1 )€ . Alternatively, and perhaps more intuitively, rearranging
once again shows that the instantaneous discounted increment to the value function Vk is
ﬂVk = uk +

ÿ
l”=k

qkl (Vl ≠ Vk ) + ⁄ E max{Âjk + Áj + Vl(j,k) ≠ Vk }.
j

(2)

A policy rule is a function ” : X ◊ RJ æ A which assigns to each state k and vector Á an

action from A. The optimal policy rule satisfies the following inequality condition, where
Vk is the value function that solves the Bellman equation:7

”(k, Á) = j ≈∆ Âjk + Áj + Vl(j,k) Ø Âj Õ k + Áj Õ + Vl(j Õ ,k)

’j Õ œ A.

That is, when given the opportunity to choose an action, ” assigns the action that maximizes
the agent’s expected future discounted payoff. Thus, under the optimal policy rule, the
conditional choice probabilities are
‡jk = Pr[”(k, Á) = j | k].
Note that the move arrival rate, ⁄, and the choice probabilities of the agent, ‡jk , also
imply a Markov jump process on X with intensity matrix Q1 , where Q1 is a function of both

⁄ and ‡jk for all j and k. In particular, the hazard rate of action j in state k is simply ⁄‡jk ,
the product of the move arrival rate and the choice probability. The choice probability ‡jk
is thus the proportion of moves in state k, which occur at rate ⁄, that result in action j.
Summing the individual intensity matrices yields the aggregate intensity matrix Q = Q0 +Q1
of the compound process, which fully characterizes the state transition dynamics of the
model. This simple and intuitive structure is especially important in extending the model
to include multiple agents, and in accomodating estimation with discrete time data. We
discuss both of these extensions in subsequent sections.

2.1

Example: A Single-Agent Renewal Model

Our first example is a simple single-agent renewal model, based on the bus engine replacement problem analyzed by Rust (1987). The single state variable captures the accumulated
7
Note that in estimation we would substitute in for the value function using equation (2), as we will be
interested in recovering the flow payoffs.

8

mileage of a bus engine. Let qk1 and qk2 denote the rates at which one- and two-unit
mileage increments occur, respectively. With each move arrival, the agent faces a binary
choice: replace the engine (j = 1) or continue (j = 0). If the agent replaces the engine,
the mileage is reset to the initial state k = 1 and the agent pays a replacement cost c. The
agent faces a cost minimization problem where the flow cost incurred in mileage state k is
represented by uk . The value function for mileage state k is
Vk =

uk + qk1 Vk+1 + qk2 Vk+2 + ⁄ E max {Vk + Á0 , V0 + c + Á1 }
,
ﬂ + qk1 + qk2 + ⁄

(3)

where, in our general notation from before, the instantaneous payoffs are
Âjk =

Y
]0,
[c,

if j = 0,
if j = 1.

We will return to this example in the following section, where we discuss a useful CCP
representation of the value function.

3

CCP Representation

The primary difference between our framework and traditional discrete time dynamic discrete choice models is that, rather that having state changes and choices made simultaneously at pre-determined intervals, only one event occurs at any given instant (almost surely),
with random time intervals between moves. Given that the unobserved preferences evolve
stochastically as in the discrete time literature, we are able to show that some of the insights
of Hotz and Miller (1993), Altu and Miller (1998), and Arcidiacono and Miller (2011, 2014)
on expressing value functions in terms of conditional choice probabilities (CCPs) apply here
as well. In fact, as we show below, it is actually much easier to express the value functions
in terms of CCPs in the continuous time setting than in discrete time. In this way we can
often eliminate the value functions on the right-hand side of (2), implying that no fixed
point problem needs to be solved in estimation.
Let ‡k = (‡0k , . . . , ‡J≠1,k )€ denote the vector of CCPs in state k. We make the following
standard assumptions on the discount rate and the choice-specific shocks (Rust, 1994).
Assumption 1. ﬂ > 0.
Assumption 2. The choice-specific shocks Á are iid over time and across choices with a
known joint distribution which is absolutely continuous with respect to Lebesgue measure,
has finite first moments, and support equal to RJ .

9

With these two assumptions, it is possible to express the continuous-time value function
as a function of the flow and instantaneous payoffs, conditional choice probabilities, ‡, and
hazards for nature, Q0 , analogous to Aguirregabiria and Mira (2002):
Proposition 1. If Assumptions 1 and 2 hold, then the value function can be written as
V (‡) = [(ﬂ + ⁄)I ≠ ⁄ (‡) ≠ Q0 ]≠1 [u + ⁄E(‡)],
where I is the K ◊ K identity matrix,

(‡) is the K ◊ K state transition matrix induced by

the choice probabilities ‡ due to actions by the agent, u is the K ◊ 1 vector of flow payoffs,

and E(‡) is the K ◊ 1 vector containing the ex-ante expected values of the instantaneous

payoffs in each state,

q

that choice j is optimal,
1
‡jk

⁄

j

‡jk [Âjk + ejk (‡k )] where ejk (‡) is the expected value of Ájk given

Ó

Ô

Ájk · 1 Áj Õ k ≠ Ájk Æ Âjk ≠ Âj Õ k + Vl(j,k) (‡) ≠ Vl(j Õ ,k) (‡) ’j Õ f (Ák ) dÁk .

Proof. See Appendix B.

⌅

This formulation provides the basis for some of our estimators. However, this representation still requires an inverse of a potentially large (though sparse) matrix. In the
remainder of this section we develop conditions under which an inversion is not needed and
the value function can be expressed as a function of the conditional choice probabilities for
a limited number of states.
To do so, we first derive two results that allow us to link value functions across states.
The first is essentially the continuous-time analog of Proposition 1 of Hotz and Miller (1993).
Namely, using the conditional choice probabilities, we can derive relationships between the
value functions associated with any two states as long as both states are feasible from the
initial state, should the agent have the right to move.
Proposition 2. If Assumptions 1 and 2 hold, then there exists a function
that for all

j, j Õ

1 (j, j Õ , ‡ )
k

such

œ A,
Vl(j,k) = Vl(j Õ ,k) + Âj Õ k ≠ Âjk +

Proof. See Appendix B.

1

(j, j Õ , ‡k ).

(4)
⌅

Thus, the value functions themselves can be linked across states. This is similar to
the result of Proposition 1 of Hotz and Miller (1993), which applied to conditional value
functions: the value of making a particular choice conditional on behaving optimally in the
future.
10

The second result establishes a similar CCP representation for the final term in the
Bellman equation.
Proposition 3. If Assumptions 1 and 2 hold, then there exists a function
that for all

jÕ

2 (j Õ , ‡ )
k

such

œ A,
Ó

Ô

E max Âjk + Áj + Vl(j,k) = Vl(j Õ ,k) + Âj Õ k +
j

2

(j Õ , ‡k ).

Proof. See Appendix B.

(5)
⌅

The intuition for Proposition 3 is that we can express the left hand side of (5) relative
to Vl(j Õ ,k) + Âj Õ k for an action j Õ of our choosing. By doing so, the terms inside the E max

term will consist of differences in value functions and instantaneous payoffs. These differences, as established by Proposition 2, can be expressed as functions of conditional choice
probabilities.
For a concrete example of these two propositions, consider the case where the Á’s follow
the type I extreme value distribution. In this case, closed form expressions exist for both
2

and

1:
1

(j, j Õ , ‡k ) = ln(‡jk ) ≠ ln(‡j Õ k )
2

(j Õ , ‡k ) = ≠ ln(‡j Õ k ) + “

where “ is Euler’s constant.
Importantly, Proposition 2 allows us to link value functions across many states. For
example, suppose that action 0 is a continuation action which does not change the state,
l(0, k) = k, and has no instantaneous payoff or cost, Â0k = 0. If in state k the agent is able
to move to k Õ by taking action j Õ , and is further able to move from k Õ to k ÕÕ by taking action
j ÕÕ , then it is possible to express VkÕÕ as a function of Vk by substituting in the relevant
relationships:

Vk = VkÕ + Âj Õ ,k +

1

(0, j Õ , ‡k )

= VkÕÕ + Âj ÕÕ ,kÕ + Âj Õ ,k +

1

(0, j ÕÕ , ‡kÕ ) +

1

(0, j Õ , ‡k ).

By successively linking value functions to other value functions, in many cases it is straightforward to find a chain such that the remaining value functions on the right hand side of
(2) can be expressed in terms of Vk and conditional choice probabilities. Then, collecting
all terms involving Vk yields an expression for Vk in terms of the flow payoff of state k and
the conditional choice probabilities. Since the latter can often be flexibly estimated directly
from the data and the former is an economic primitive, it is no longer necessary to solve
11

a dynamic programming problem to obtain the value functions. This is formalized in the
following result.
Definition. A state k ú is attainable from state k if there exists a sequence of actions from
k that result in state k ú .
Proposition 4. Suppose that Assumptions 1 and 2 hold and that for a given state k, j = 0
is a continuation action with l(0, k) = k and for all states l ”= k with qkl > 0 there exists a
state k ú that is attainable from both k and l. Then, there exists a function

k (Â, Q0 , ⁄, ‡)

such that
ﬂVk = uk +

k (Â, Q0 , ⁄, ‡).

(6)

Proof. See Appendix B.
The function

k

⌅

for each state may depend on the model primitives Â, Q0 , and ⁄ as

well as the CCPs, ‡. By restating the problem in this way, when the conditional choice
probabilities are available, no fixed point problem needs to be solved in order to obtain the
value functions and no K ◊ K matrix need be stored or inverted. This can often lead to
large computational gains. We now provide an example of how to apply these propositions.

3.1

Example: A Single-Agent Renewal Model

Recall the bus engine replacement example of Section 2.1, where the value function was
characterized by (3). Applying Proposition 3 eliminates the third term in the numerator:
Vk =

uk + qk1 Vk+1 + qk2 Vk+2 + ⁄
ﬂ + qk1 + qk2

2 (0, ‡ )
k

.

Although there is no direct link between the value function at k and the value functions
at k + 1 and k + 2, it is possible to link the two value functions through the replacement
decision. In particular, Vk and Vk+1 can be expressed as follows:
Vk = V0 + c +

1

(0, 1, ‡k ),

Vk+1 = V0 + c +

1

(0, 1, ‡k+1 ).

This implies that we can express Vk+1 in terms of Vk :
Vk+1 = Vk +

1

(0, 1, ‡k+1 ) ≠

12

1

(0, 1, ‡k ).

Using a similar expression for Vk+2 , we obtain the function
k (Â, Q0 , ⁄, ‡)

= qk1

1

(0, 1, ‡k+1 ) + qk2

1

k

from Proposition 4:

(0, 1, ‡k+2 )
≠ (qk1 + qk2 )

1

(0, 1, ‡k ) + ⁄

2

(0, ‡k ).

This example illustrates one of the benefits of continuous time over discrete time when
using conditional choice probabilities. Namely, as illustrated by Arcidiacono and Miller
(2011), forming renewal problems using CCPs required both expressing the future utility
term relative to a particular choice and differencing the conditional valuation functions used
in estimation. In this example, the future utility terms for both replacing and continuing
would be expressed relative to the value of replacing. Hence accurate estimates of the
conditional probability of replacing at very low mileages would be needed, but these are low
probability events whose estimates will likely depend heavily on the smoothing parameters
or functional forms used to mitigate the associated small sample problems. In the present
continuous time framework, differencing is not required in order to form the value function
in terms of conditional choice probabilities and we only need the replacement probabilities
at states k, k + 1, and k + 2.

4

Dynamic Discrete Games

The potential advantages of modeling decisions using a continuous time framework are particularly salient in games, where the state space is often enormous. Working in continuous
time highlights aspects of strategic interaction that are muted by discrete time (e.g., firstmover advantage) and mitigates unnatural implications that can arise from simultaneity
(e.g., ex post regret). In fact, a number of recent papers in the empirical games literature
(e.g., Einav, 2010, Schmidt-Dengler, 2006) have adopted a sequential structure for decisionmaking to accommodate the underlying economic theory associated with their games.
Extending the single-agent model of Section 2 to the case of dynamic discrete games
with many players is simply a matter of modifying the intensity matrix governing the
state transitions to incorporate players’ beliefs regarding the future actions of their rivals.
We begin this section by describing the structure of the model, followed by properties of
equilibrium strategies and beliefs. We then show how to apply the CCP representation
results of Section 3 in the context of dynamic games.
Suppose there are N players indexed by i = 1, . . . , N . As before, the state space X

is finite with K elements. This is without loss of generality, since each of these elements
may be regarded as indices of elements in a higher-dimensional, but finite, space of firmmarket-specific state vectors. Player i’s choice set in state k is Aik . For simplicity, we
13

consider the case where each player has J actions in all states: Aik = {0, . . . , J ≠ 1} for
all i and k. We index the remaining model primitives by i, including the flow payoffs in
state k, uik , instantaneous payoffs, Âijk , and choice probabilities, ‡ijk . Let l(i, j, k) denote
the continuation state that arises after player i makes choice j in state k. We assume that
players share a common discount rate ﬂ.
Although it is still sufficient to have only a single jump process on X , with some intensity

matrix Q0 , to capture moves by nature, there are now N independent, competing Poisson

processes with rate ⁄ œ (0, Œ) generating move arrivals for each of the N players.8 The
next event to occur is determined by the earliest arrival of one of these N + 1 processes.

Let Îi denote player i’s beliefs regarding the actions of rival players, given by a collection
of (N ≠ 1) ◊ J ◊ K probabilities Îimjk for each rival player m ”= i, state k, and choice j.
Applying Bellman’s principal of optimality (Bellman, 1957), the value function for an active
player i in state k can be defined recursively as9
Vik (Îi ) =

uik +

q

l”=k qkl Vil (Îi ) +

q

m”=i ⁄

q

Ó

Ô

j Îimjk Vi,l(m,j,k) (Îi ) + ⁄ E maxj Âijk + Áij + Vi,l(i,j,k) (Îi )

ﬂ+

q

l”=k qkl

+ N⁄

(7)

The denominator of this expression the sum of the discount factor and the rates of exogenous
state changes and moves by players. The numerator can be understood by looking at each
term separately. The first term is the flow payoff that accrues to firm i each instant the
model remains in state k. Next, we have a sum over possible exogenous state changes,
weighted by the rates at which those changes occur. The third term is a sum over rival
firms, in particular, over the rate-weighted state changes that could result due to the action
of a rival firm. The final term is the rate-weighted continuation value that occurs when the
agent moves and optimally makes a discrete choice.
Following Maskin and Tirole (2001), we focus on Markov perfect equilibria in pure
strategies, as is standard in the discrete-time games literature. A Markov strategy for
player i is a mapping which assigns an action from Aik to each state (k, Ái ) œ X ◊ RJ .
Focusing on Markov strategies eliminates the need to condition on the full history of play.

Given beliefs for each player, {Î1 , . . . , ÎN }, and a collection of model primitives, a Markov

strategy for player i is a best response if10

”i (k, Ái ; Îi ) = j ≈∆ Âijk + Áij + Vi,l(i,j,k) (Îi ) Ø Âij Õ k + Áij Õ + Vi,l(i,j Õ ,k) (Îi ) ’j Õ œ Aik .
Then, given the distribution of choice-specific shocks, each Markov strategy ”i implies re8

For simplicity, we assume the move arrival rates are equal for each firm.
If a player is not active in state k, then the probability of inaction (j = 0) for that player is set to one.
10
In the event of a tie, we assume the action with the smallest index is assigned. Because the distribution
of Ái is continuous under Assumption 2, such ties occur with probability zero.
9

14

.

sponse probabilities for each choice in each state:
‡ijk = Pr [”i (k, Ái ; Îi ) = j | k] .

(8)

Definition. A collection of Markov strategies {”1 , . . . , ”N } and beliefs {Î1 , . . . , ÎN } is a

Markov perfect equilibrium if for all i:

1. ”i (k, Ái ) is a best response given beliefs Îi , for all k and almost every Ái ;
2. for all players m ”= i, the beliefs Îmi are consistent with the best response probabilities
implied by ”i , for each j and k.

Following Milgrom and Weber (1985) and Aguirregabiria and Mira (2007), we can characterize Markov perfect equilibria in probability space, rather than in terms of pure Markov
strategies, as a collection of equilibrium best response probabilities {‡1 , . . . , ‡N } where each
probability in ‡i is a best response given beliefs ‡≠i . Likewise, any such collection of prob-

abilities can be extended to a Markov perfect equilibrium.

In particular, equilibrium conditional choice probabilities are fixed points to the best
response probability mapping, which defines a continuous function from [0, 1]N ◊J◊K onto
itself. Existence of an equilibrium then follows from Brouwer’s Theorem, as established by
the following proposition.
Proposition 5. A Markov perfect equilibrium exists.
Proof. See Appendix B.

4.1

⌅

CCP Representation

As in single-agent models, the value function for any player i in the multi-player case can be
expressed in terms of reduced-form CCPs and hazards. The following proposition formalizes
this and generalizes Proposition 1 to the multi-player setting.
Proposition 6. If Assumptions 1 and 2 hold, then the value function for each player i can
be written as
C

Vi (‡) = (ﬂ + N ⁄) I ≠
where

m (‡m )

N
ÿ

⁄

m (‡m )

m=1

≠ Q0

D≠1

[ui + ⁄Ei (‡i )]

(9)

is the K ◊ K state transition matrix induced by the actions of player m

given the choice probabilities ‡m and where Ei (‡i ) is a K ◊ 1 vector where each element k is
the ex-ante expected value of the choice-specific payoff in state k,

15

q

j

‡ijk [Âijk + eijk (‡ik )]

where eijk (‡) is the expected value of Áijk given that choice j is optimal,
1
‡ijk

⁄

Ó

Ô

Áijk · 1 Áij Õ k ≠ Áijk Æ Âijk ≠ Âij Õ k + Vi,l(i,j,k) (‡) ≠ Vi,l(i,j Õ ,k) (‡) ’j Õ f (Áik ) dÁik .

Proof. See Appendix B.

⌅

We also note that the propositions in Section 3 apply to games as well in cases where
the attainability condition holds. Hence, it is possible to eliminate the value functions in
the fourth term of the numerator of (7) using Proposition 3:
Vik =

uik +

q

l”=k qkl Vil

+

q

ﬂ+

q

‡mjk Vi,l(m,j,k) + ⁄
l”=k qkl + N ⁄

m”=i ⁄

q

j

2 (0, ‡ )
ik
i

.

(10)

Eliminating the other value functions, however, is problematic as each player may only
be able to move the process to some subset of the state space via a unilateral action, since
they only have direct control over their own state. For example, when firms have different
numbers of stores, a given firm is only able to choose its own stores, not the stores of
its competitors. There are at least two cases where the remaining value functions can be
eliminated. The first is the case where there is a terminal choice, such as permanently
exiting a market. Since no further choices are made by the focal firm, the value function for
the terminal choice does not include other value functions. A concrete example is provided
below. The other case is where an action can be taken to reset the system for all players.
For example, consider a game that involves technology adoption. By achieving a particular
technology level, previous technologies may become obsolete, effectively renewing the states
of the other players.

4.2

Example: Multi-Store Entry and Exit

Note that in either the terminal or reset case, there only has to be an attainable scenario
where the agent can execute the terminal or reset action. For example, consider a game
amongst retailers where firms compete by opening and closing stores. Given a move arrival,
a firm can build a store, j = 1, do nothing, j = 0, or, if the agent has at least one store,
close a store, j = ≠1. Once a firm has no stores, it makes no further choices. Let c denote
the scrap value of closing a store.

Suppose that firm i has ki stores and the economy-wide state is k = (k1 , . . . , kN ), the
store counts of all firms in the market (including potential entrants, namely firms with zero
stores). Let lú (i, k, kiÕ ) denote the state that is equal to the initial state k, but where firm i
has kiÕ stores instead of ki . Applying Proposition 2 and normalizing the value of zero stores

16

to zero, we can express Vik as:
Vik =

ki
ÿ

kiÕ =1

1

1

2

0, ≠1, ‡i,lú (i,k,kiÕ ) + ki c.

(11)

Since (11) holds for all k, we can use the value of fully exiting to link value functions
for any pair of states. Namely, linking the value functions on the right hand side of (10) to
Vik and solving for Vik yields:
ﬂVik = uik + ⁄i
+

ÿ

m”=i

+

ÿ

m”=i

2
i (0, ‡ik )

Q

‡m,≠1,k a
Q

‡m,1,k a

ki Ë
ÿ

kiÕ =1

ki Ë
ÿ

kiÕ =1

1
i

1

2

1
i

0, ≠1, ‡i,lú (i,l(m,≠1,k),kiÕ ) ≠

1

R
2È
0, ≠1, ‡i,lú (i,k,kÕ ) b
i

R
2È
1
1
b.
i 0, ≠1, ‡i,lú (i,l(m,1,k),kiÕ ) ≠ i 0, ≠1, ‡i,lú (i,k,kiÕ )
1

2

1

Once again, no fixed point calculation is required to express the full value function, a
simplification that is especially powerful in the context of high-dimensional discrete games.

5

Estimation

We now turn to estimation. Methods that solve for the value function directly and use
it to obtain the implied choice probabilities for estimation are referred to as full-solution
methods. The nested fixed point (NFXP) algorithm of Rust (1987), which uses value
function iteration inside of an optimization routine that maximizes the likelihood, is the
classic example of a full-solution method.
CCP-based estimation methods, on the other hand, are two-step methods pioneered
by Hotz and Miller (1993) and Hotz et al. (1994) and later extended by Aguirregabiria
and Mira (2002, 2007), Bajari et al. (2007), Pesendorfer and Schmidt-Dengler (2007), Pakes
et al. (2007), and Arcidiacono and Miller (2011). The CCPs are estimated in a first step and
used to approximate the value function in a closed-form inversion or simulation step. The
approximate value function is then used in the likelihood function or the GMM criterion
function to estimate the structural parameters.
Full-solution methods have the advantage that the full structure of the model is imposed
in estimation. However, these methods can become quite computationally expensive for
complex models with many players or a large state space. Many candidate parameter
vectors must be evaluated during estimation and, if the value function is costly to compute,
even if solving the model once might be feasible, doing so many times may not be. In
17

the presence of multiple equilibria, they also require researchers to make an assumption on
the equilibrium selection mechanism and solve for all the equilibria to complete the model
(Bajari, Hong, and Ryan, 2007). In addition to allowing the value function to be computed
very quickly, CCP methods provide an attractive solution to the issue of multiplicity. Under
the usual assumption invoked in the literature (e.g., Aguirregabiria and Mira, 2007), that
conditional on observables, all observations are generated by the same equilibrium, then the
resulting likelihood conditions on the equilibrium that is played in the data, bypassing the
need to consider other equilibria. We formalize this assumption below.
Our model has the advantage of being estimable via either the full solution or CCP
approaches when applicable. As in Doraszelski and Judd (2012), the use of continuous time
reduces the computational burden of computing expectations over successor states because
only a single state change can occur at any particular instant. An attractive and novel
feature of our framework is that it is also easily estimable using standard CCP methods.
This greatly reduces the computational costs of estimation relative to full-solution methods.
Having estimated a large problem with CCP methods, it is then straightforward to use the
same model for post-estimation exercises, since the computational burden of computing the
equilibrium a few times for these purposes is not as great as nesting several such solutions
into an estimation routine. In this way, our framework preserves a tight link between the
estimated model and that used for post-estimation analysis, something which has proven
infeasible for many empirical applications that have been modeled in discrete time.
In the rest of this section we describe the estimation algorithms. We begin with the
simplest case in which continuous-time data is available and we consider both the fullsolution and two-step estimators in this case. Note that the full-solution estimator is only
applicable to single agent models or in cases where there is a unique equilibrium to the
strategic game, but we consider it here primarily to build intuition for the estimators that
follow. Next, since data is often reported only at discrete intervals, we next show how our
methods can be applied to discrete time data. We then extend the methods to incorporate
permanent unobserved heterogeneity. Finally, we discuss nonparametric identification of
the model.
Throughout, we normalize ⁄, the arrival rate of moves for players, to one, implying an
average of one move per unit of time (e.g., one year). In a discrete time model, this is
similar to the assumption that players move once per time period, but it only restricts the
average not the actual realized move times. In other words, it allows players to move more
or less than once per unit of time by allowing randomness in the realized move times rather
than restricting moves to occur exactly at unit intervals.

18

5.1

Continuous Time Data

5.1.1

Full-Solution Estimation with Continuous Time Data

We maintain the convention that choice j = 0 for each agent is a continuation choice
which does not change the state. Then, in state k, the probability of the next state change
occurring during an interval of length · is
S

Q

ÿ

1 ≠ exp U≠· a

l”=k

qkl +

ÿ

ÿ

⁄

j”=0

i

RT

(12)

‡ijk bV .

This is the cdf of the exponential distribution with rate parameter equal to the sum of the
exogenous state transition rates and the hazards of the non-continuation actions for each
player.
Differentiating with respect to · yields the density for the time of the next state change,
which is the exponential pdf with the same rate parameter as before:
Q

ÿ

a

l”=k

qkl +

ÿ
i

⁄

ÿ

j”=0

R

S

Q

‡ijk b exp U≠· a

ÿ
l”=k

qkl +

ÿ
i

⁄

ÿ

j”=0

RT

‡ijk bV .

(13)

Conditional on a state change occurring in state k, the probability that the change is due
to agent i taking action j is

Now, define the function

⁄‡ijk
q q
.
l”=k qkl +
i⁄
j”=0 ‡ijk

(14)

q

S

Q

g(·, k; q, ◊) = exp U≠· a

ÿ
l”=k

qkl +

ÿ
i

⁄

ÿ

j”=0

RT

‡ijk bV ,

(15)

which is the second term from (12), noting that the vector of equilibrium choice probabilities
‡ = (‡ijk ) is, implicitly, a function of q = vec(Q0 ) and the parameters ◊.
Then, the joint likelihood of the next stage change occurring after an interval of length
· and being the result of player i taking action j is the product of (13) and (14),
⁄‡ijk g(·, k; q, ◊),
with the corresponding likelihood of nature moving the state from k to l being
qkl g(·, k; q, ◊).
19

Now consider a sample of M markets where in each market m we observe a sequence
{kmn }Tn=1 of T state changes occurring over the interval [0, T ]. Let kmn denote the state

prior to the n-th state change in market m, with km,T +1 denoting the final state. Let tmn

denote the time of the n-th event and let ·mn denote the holding time between events,
defined as ·mn = tmn ≠ tm,n≠1 for n Æ T . For the interval between the last event and the

end of the sampling period, we define ·m,T +1 = T ≠ tmT . Let Imn (i, j) be the indicator for

whether the n-th move in market m was a move by player i and the choice was j and let
Imn (0, l) be the indicator for whether the n-th move in market m was a move by nature to

state l. The maximum likelihood estimates of q and ◊ are then the solution to:
1

Y
S
T
M ÿ
]ÿ
ÿ
Uln g(·mn , kmn ; q, ◊) +
q̂, ◊ˆ = arg max
Imn (0, l) ln qkl
(q,◊) [
m=1 n=1
l”=kmn
Z
T
^
ÿÿ
+
Imn (i, j) ln (⁄‡ijk (q, ◊))V + ln g(·m,N +1 , km,N +1 ; q, ◊) .
\
2

i j”=0

Note that embedded in the estimation problem is the solution to a fixed point problem
which is needed in order to obtain the value functions and CCPs. We have made the
dependence of the choice probabilities on the parameters and rates explicit. The last term
in the expression is the natural logarithm of one minus the exponential cdf, to account for
the fact that another state change was not observed by the end of the sampling period.
Ô
ˆ is a full-information maximum likelihood estimator and is M -consistent,
Note that (q̂, ◊)
asymptotically normal, and efficient under standard regularity assumptions.
5.1.2

Two-Step Estimation with Continuous Time Data

As discussed in Section 3, it is possible to express differences in continuous time value functions as functions of the conditional choice probabilities. These expressions can sometimes
be used in such a way that solving the nested fixed point problem is unnecessary. In this
section, we show how two-step methods apply in estimation, linking reduced form hazards
to conditional choice probabilities.
Step 1: Estimating the Reduced-Form Hazards Let hijk = ⁄‡ijk denote the hazard
for an active player i choosing action j in state k and let
h = (q12 , q13 , . . . , qK≠1,K , ⁄‡111 , . . . , ⁄‡1Jk , . . . ⁄‡N 11 , . . . , ⁄‡N JK )

(16)

denote the vector of distinct hazards for nature and all state-specific, non-continuation
action hazards of players and let H µ RK(K≠1)+N JK denote the space of all such vectors h.
20

In Step 1, one estimates the hazards hijk nonparametrically. For example, these hazards
can be estimated by maximum likelihood by writing the exponential cdf in (12) as a function
of hijk instead of ⁄‡ijk . Similarly, we can rewrite the function in (15) as
S

Q

g̃(·, k; h) = exp U≠· a

ÿ
l”=k

qkl +

ÿÿ

i j”=0

RT

hijk bV .

Then, the maximum likelihood estimates of the hazards h are
h̃ = arg max
hœH

I M T C
ÿ ÿ

ln g̃(·mn , kmn ; h) +

m=1 n=1

+

ÿ

l”=kmn

ÿÿ

i j”=0

Imn (0, l) ln qkl
D

J

Imn (i, j) ln hijk + ln g̃(·m,N +1 , km,N +1 ; h) .

Step 2: Estimating the Structural Payoff Parameters In Step 2, we use the estimated reduced-form hazards to estimate the structural payoff parameters ◊. Given the
estimated hazards and a value of ⁄, we can estimate the conditional choice probabilities for
j ”= 0 as h̃ijk /⁄ and 1 ≠

q

j”=0 h̃ijk /⁄

for j = 0.

We can then express the structural conditional choice-specific hazards as functions of

◊ and the estimated hazards h̃ so that no fixed-point problem needs to be solved. When
the finite dependence condition holds, this simply involves evaluating the mapping in (6).
Otherwise, we can use the matrix representation in (9). Let ȟijk (h̃, ◊) denote the particular
mapping used. Similarly, let ǧ(·, k; h̃, ◊) denote the mapping in (15) with ȟijk (h̃, ◊) used in
place of ⁄‡ijk .
Since we already have estimates of the rates q (which are the first K(K ≠ 1) components

of h̃), we focus on estimating ◊. The joint likelihood of the next state change occurring
after an interval of length · and being the result of player i taking action j is
ȟijk (h̃, ◊) ǧ(·, k; h̃, ◊).
The second stage estimates are then
◊ˇ = arg max
◊

I M T C
ÿ ÿ
m=1 n=1

ln ǧ(·mn , kmn ; h̃, ◊) +

ÿÿ

i j”=0

Imn (i, j) ln ȟijk (h̃, ◊)

D
J

+ ln ǧ(·m,N +1 , km,N +1 ; h̃, ◊) .
This is a fairly standard two-step estimator and is consistent and asymptotically normal
21

under suitable regularity conditions In the next section we consider two-step estimation
in the leading case of discrete time data. There, we formally state sufficient conditions
for consistency and asymptotic normality. The properties of the estimator above, with
continuous time data, are largely similar.

5.2

Discrete Time Data

Often the exact sequence of events and event times is not observed, rather, the state is only
observed at discrete points in time. Here, we consider estimation with discretely-sampled
data. First we consider full-solution estimation and then we show that one can easily carry
out two-step estimation in an analogous manner. We proceed by assuming the data are
sampled from independent markets at uniformly spaced time intervals of length

.11

Assumption 3. The observations {kmn : m = 1, . . . , M, n = 1, . . . , T }, sampled at times

on the lattice {n
for all k œ X .

: n = 1, . . . , T }, are independent across markets m and Pr(kmn = k) > 0

Let Pkl ( ) denote the probability that the system has transitioned to state l after a
period of length

given that it was initially in state k, given the aggregate intensity matrix

Q. The corresponding matrix of these probabilities, P ( ) = (Pkl ( )), is the transition
matrix, which satisfies
P( ) = e

Q

=

Œ
ÿ
( Q)j

j=0

j!

.

(17)

This quantity is the matrix exponential, the matrix analog of the scalar exponential, which
can be computed using one of many known algorithms (cf. Moler and Loan, 1978, Sidje,
1998).12
The transition probabilities summarize the relevant information about a pair of observations km,n≠1 and kmn . That is, Pkm,n≠1 ,kmn ( ) is the probability of the process moving from

km,n≠1 to kmn after an interval of length

. This includes cases where kmn = km,n≠1 , since

the transition probabilities account for the case of no jumps at all, as well as all sequences
involving any number of jumps to intermediate states before returning to the initial state.
5.2.1

Computational Considerations

Since the Q matrix can be large, this may seem to introduce a dimensionality problem
rivaling that of discrete time models. However, the Q matrix is often very sparse, which
11

Extending this to cases with irregular time intervals is straightforward and also helps with identification.
See Cuthbert (1973), Singer and Spilerman (1976), Hansen and Sargent (1983), and Blevins (2013) for results
on identification of continuous time models with irregularly spaced observations.
12
The matrix exponential operator is available, for example, in Matlab, via the expm function.

22

substantially reduces the computational burden. Sparse matrix algorithms can be used
to compute P ( ) which typically require only being able to compute the action of Q on
some generic vector v. Since the structure of Q is known, this usually involves very few
multiplications relative to the size of the intensity matrix, which is K ◊ K. Furthermore,
only at most M T rows of P ( ) need be calculated to estimate the model, corresponding to

the number of observations. Algorithms are available which exploit the sparsity of Q and
directly compute the action of P ( ) on some vector v, further reducing the computational
cost. Since v can be the n-th standard basis vector, one can compute only the necessary
rows of P ( ).
We now provide some intuition for why discrete-time data will not substantially complicate the problem, which also suggests a natural way to form a simulation-based estimator
of P ( ). Recall that we are considering stationary models: the hazards do not depend on
t. This implies that we can decompose the Markov jump process into two components: a
state-independent Poisson process dictating when moves occur, and an embedded Markov
chain which dictates where the state moves to.
In our setting, the embedded Markov chain associated with moves by agents is a matrix containing the relevant conditional choice probabilities. We can also rewrite the state
transition rates for nature in a similar manner. Namely, let q denote the maximum sum of
these rates across all states:
q = max
j

ÿ

qjk .

k

If we consider q to be the move arrival rate for nature, then at each move opportunity, the
probability of transitioning from state k to l due to a move by nature is
Õ
=
qkl

Y
]qkl /q
[1 ≠

if k ”= l,

q

k”=l qkl /q

if k = l.

Given the conditional choice probabilities, ‡, and the transition probabilities for nature, q Õ , we can construct an embedded Markov chain Z which characterizes the transition

probabilities across all states for each arrival of the alternative Poisson process with rate

q + N ⁄. The transition matrix associated with moving from any state k to any future state
k Õ in exactly r steps is simply Z r . Let an denote a vector of length K, which has a one
in position kn , corresponding to the state at observation n, and zeros elsewhere (i.e., the

kn -th standard basis vector). The maximum likelihood estimates given a dataset of discrete
observations at intervals of unit length (
1

2

q̂, ◊ˆ = arg max
(q,◊)

N
ÿ

n=1

= 1) satisfy

CŒ
D
ÿ (q + N ⁄)r exp(≠(q + N ⁄))
€
r
an Z(q, ◊) an+1 .
ln

r!

r=0

23

(18)

The first term in the innermost summation above is the probability of exactly r state
changes occurring during a unit interval, under the Poisson distribution. The second term
is the probability of the observed state transition, given that there were exactly r moves.
The expression above also suggests a simulation-based estimator. Namely, use the expression inside the sum for the first R < Œ terms. Given an initial guess of q, draw from

the event distribution conditional on having more than R events. One could then use importance sampling to weight the number of events to avoid redrawing the simulated paths
when changing the parameters.
5.2.2

Two-Step Estimation with Discrete Time Data

We now formalize our assumptions in order to define the two-step estimator with discrete
time data and establish its large sample properties. First, following most papers in the
literature on two-step estimation (e.g., Bajari et al., 2007, Aguirregabiria and Mira, 2007)
we require that the data be generated by a single Markov perfect equilibrium and that all
players expect the same equilibrium to be played at all times both in and out of sample.
This assumption is analogous to similar assumptions commonly used in two-step estimation
of discrete time models (see Aguirregabiria and Mira (2010) for a survey).
Assumption 4. (a) In each market m = 1, . . . , M , players expect the same equilibrium,
with corresponding intensity matrix Q, to be played for all times t œ [0, Œ). (b) The
distribution of state transitions in each market m and each time period t is consistent with

row kmt of the transition matrix P ( ) = exp( Q).
As defined in (16), let h denote the vector of all distinct hazards for nature and
all state-specific, non-continuation action hazards of players that appear in the matrices
Q0 , Q1 , . . . , QN . Recall that given any h œ H a corresponding matrix Q =
constructed.

qN

i=1 Qi

can be

Let ◊ denote the finite-dimensional vector of parameters, in some parameter space
which determine the flow payoffs u and instantaneous payoffs Â. Then, let

:

,

◊H æ H :

(◊, h) ‘æ (◊, h) denote the mapping which, given vectors ◊ and h, a new vector hÕ = (◊, h)

is determined using the inverse CCP mapping. This proceeds in two steps. First, given ◊

and h, we construct Q and ‡ and obtain new value functions. In the second step, given the
new value functions we determine the new choice probabilities ‡ Õ and then form the new
vector hÕ . Note that equilibrium conditional choice probabilities must satisfy h = (◊, h).
We note that

here can be either of two mappings. If the finite dependence property

of Proposition 4 holds,

can be the mapping defined by the representation in (6). More

generally, under Proposition 6,

can be the mapping defined by the linear representation

of (9) for the infinite-horizon case. Although we have only considered these two cases so far,
24

Appendix A provides details on other two-step approaches to estimation of the model such
as the forward-simulation-based estimators of Hotz et al. (1994) and Bajari et al. (2007)
and the nested pseudo-likelihood estimator of Aguirregabiria and Mira (2007).
The remaining conditions are standard regularity conditions requiring markets to be
independent, the parameter space to be compact, the population parameter vector to be
identified, and the hazard mapping
Assumption 5.

is compact and the true parameters ◊0 lie in the interior of

Assumption 6. For any ◊ œ

h ”=

h0

for the hazards

Assumption 7.

to be sufficiently smooth.

:

h0

with ◊ ”= ◊0 and any h such that h =

implied by

.

(◊, h), we have

◊0 .

◊ H æ H : (◊, h) ‘æ (◊, h) is twice continuously differentiable.

Define the pseudo likelihood function
LM (◊, h) =

T
M ÿ
1 ÿ
ln Pkm,n≠1 ,kmn ( ; (◊, h)) ,
M m=1 n=2

where Pk,l ( ; h) denotes the (k, l) element of the transition matrix induced by the rates
and CCPs in h. In the case where the model has a unique equilibrium, we could define the
full-solution maximum likelihood estimator as
◊˜ = arg max LM (◊, h)
◊œ

s.t.

h = (◊, h).

A nested fixed point (NFXP) procedure would obtain the equilibrium CCPs (components
of h) for each trial value of ◊ given by an optimization routine (Rust, 1987).
Since we have not shown that the equilibrium is unique, we consider a two-step estimation approach under Assumption 4. This estimator has the additional benefit of reducing
Ô
the computational burden of estimating ◊0 . Suppose we have a M -consistent first stage
M-estimator ĥ for h0 . For example, the nonparametric maximum likelihood estimator of
h based on P ( ; h) is an estimator of this kind. We define the feasible two-step pseudo
maximum likelihood estimator ◊ˆ of ◊0 as
◊ˆ = arg max LM (◊, ĥ).
◊œ

Under the maintained assumptions, we show that ◊ˆ is consistent and asymptotically normal.

25

Proposition 7. Suppose that Assumptions 1–7 hold and that ĥ is an M-estimator of h0
Ô
d
such that M (ĥ ≠ h0 ) æ N(0, ). Then
Ô
where

◊◊€

d

= E[Ò◊ sm Ò◊€ sm ] and
sm ©

5.3

1

M (◊ˆ ≠ ◊0 ) æ N 0,

T
ÿ

◊h€

≠1
◊◊€

+

≠1
◊◊€

◊h€

€
◊h€

≠1
◊◊€

2

= E[Ò◊ sm Òh€ sm ] and sm is the pseudo-score

ln Pkm,n≠1 ,kmn

t=2

1

2

; (◊0 , h0 ) .

Unobserved Heterogeneity

Our methods can also be extended to accommodate permanent unobserved heterogeneity
using finite mixture distributions. In particular, suppose that T observations are sampled
at intervals of length

for each of M markets, where each market is one of Z types.

Let ﬁz (km1 ) denote the population probability that market m is of type z conditional on
the initial observation.13 We can then integrate with respect to the distribution of the

unobserved state, so that the maximum likelihood problem becomes
1

2

ˆ ﬁ̂ = arg max
q̂, ◊,

(q,◊,ﬁ)

M
ÿ

m=1

ln

C Z
ÿ

ﬁz (km1 )

z=1

N
Ÿ

D

ln Pkm,n≠1 ,kmn ( ; q, ◊, z) ,

n=2

(19)

where P ( ; q, ◊, z) is the transition matrix for type z.
Although (19) is written for the full-solution case, the methods outlined in Arcidiacono
and Miller (2011) apply. They show that the EM algorithm can be used to recover the
conditional choice probabilities as part of the maximization problem or in a first stage. The
same methods can be applied here, only now it is the reduced form hazards conditional on
both the observed and unobserved states that are being recovered.

5.4

Nonparametric Identification

With continuous-time data, identification and estimation of the intensity matrix for finitestate Markov jump processes is straightforward and well-established (Billingsley, 1961).
However, in general when a continuous-time process is only sampled at equispaced points
in time, the parameters of the underlying continuous-time model may not be identified.
This potential identification problem is also known as the aliasing problem in continuoustime models and it has has been studied by many authors in the context of continuous-time
multivariate regression models (e.g., Phillips, 1973, Hansen and Sargent, 1983).14 In our
13

By letting ﬁz (km1 ) depend on km1 , we allow for an initial conditions problem.
A related issue is the embeddability problem: could the observed discrete-time transition matrix P ( ),
associated with a time interval of length , have been generated by the proposed data generating process
14

26

setting, the question is whether there exists an observationally equivalent continuous time
model that could have generated the data and that is also consistent with the structure
implied by the dynamic model. We summarize the nonparametric identification results for
our model in this section which show that any other continuous time model that could be
consistent with the observable data would imply a fundamentally different structure and
is therefore not permissible (e.g., a Q matrix containing a non-zero hazard for a transition
that is not permissible, or a collection of choice-specific payoffs that violate an exclusion
restriction).
In the context of a general finite-state Markov jump processes, the question of identification is whether there a unique matrix Q that leads to the observed transition matrix
P ( ) when the process is sampled at intervals of length

. In closely related work on first-

order systems of stochastic differential equations, Phillips (1973) discusses the role of prior
information and gives conditions under which linear restrictions can lead to identification.
Blevins (2013) shows that identification can be achieved with even fewer prior restrictions
and in the special case of a finite-state Markov jump processes, he gives conditions under
which only Â(K ≠ 1)/2Ê prior restrictions are needed.

The structural model underlying the Q matrix in our framework provides exactly the

sort of prior restrictions needed to mitigate the aliasing problem. The model restricts Q to a
lower-dimensional subspace, since it is sparse and must satisfy both within-row and acrossrow restrictions. Therefore, even if there are multiple matrix solutions to the equation
P ( ) = exp( Q), it is unlikely that two of them simultaneously satisfy the restrictions of
the structural model. For example, consider the restrictions on the Q matrix implied by
the simple renewal model of Section 2.1:
S

≠q1 ≠ q2

W
W ⁄‡
12
W
W
W ⁄‡13
W
Q=W
..
W
.
W
W
W ⁄‡1,K≠1
U

⁄‡1K

q1

q2

0

≠q1 ≠ q2 ≠ ⁄‡12

q1

q2

0
..
.

≠q1 ≠ q2 ≠ ⁄‡13
..
.

q1
..
.

0

···

0

0

···

0

···

···
···
..
.

≠q1 ≠ q2 ≠ ⁄‡1,K≠1
0

0

T

X
X
X
X
0 X
X
.
.. X
. X
X
X
q1 + q2 X
V

0

≠⁄‡1K

The number of parameters to be estimated in this matrix is substantially less than if the
(some continuous-time Markov structure with intensity matrix Q or some discrete-time chain over fixed time
periods of length ”). This is a model specification issue, also arising in both discrete time and continuous
time: was the data actually generated by a continuous time Markov jump process? We assume throughout
that the model is well-specified and therefore, such an intensity matrix Q exists. Singer and Spilerman (1976)
provide several necessary conditions for embeddability involving testable conditions on the determinant and
eigenvalues of P ( ). This problem was first proposed by Elfving (1937). Kingman (1962) derived the set of
embeddable processes with K = 2 and Johansen (1974) gave an explicit description of the set for K = 3.

27

intensities were allowed to vary across all the non-diagonal elements. In fact, there are K 2 ≠
4K + 8 zero restrictions while under the conditions of Blevins (2013) as few as Â(K ≠ 1)/2Ê

are sufficient for identification of Q given P ( ). Furthermore, the CCPs depend on the
rates and payoff parameters, which introduces shape restrictions on ‡1k across states k.
In general, as in this example, a large number of zero restrictions are typically implied

naturally by the model specification. Blevins (2014) shows that for models of the kind we
consider, all non-trivial binary-choice (J = 1) games are identified using only these zero
restrictions. More generally, when there is a player-specific state variable that can take
Ÿ values, then any model is identified as long as the number of choices is not too large:
J Æ (ŸN ≠ 1)/(2N ). Other (non-zero) restrictions can also be added. For example, if

continuous-time data is available on a subset of the state variables, then certain elements
of Q are identified and can serve as restrictions.

Once identification of Q has been established given P ( ), the question remains as to
whether the choice probabilities, value functions, choice-specific payoffs, and flow payoffs
are also identified. Although we do not consider these details here, Blevins (2014) also gives
conditions for which ‡ik , Vik , and uk are nonparametrically identified. Possible identifying
restrictions on Vik and Âik include payoff exclusion restrictions and equality restrictions on
the choice-specific payoffs across states.
Importantly, the question of identification applies equally to discrete-time models, where
there is an analogous time-aggregation problem (Bajari, Hong, and Nekipelov, 2013, Hong,
Li, and Wang, 2012). Suppose there is a fixed move interval of length ” in the model
which may be different from the fixed interval

at which observations are sampled. In

practice, researchers typically assume (implicitly) that ” =

, where

= 1 is normalized

to be some specific unit of time (e.g., one quarter).This assumption is convenient, but
masks the identification problem, which requires that there exist a unique matrix root P0
of the discrete-time aggregation equation P0

/”

= P ( ). In general, however, there may

be multiple such matrices (Singer and Spilerman, 1976, p. 49). As in our setting, however,
valid solutions P0 must satisfy the restrictions implied by the model. These issues become

trivial under the usual assumption that ” =

5.5

.

Comparison to Discrete Time Methods

Characterizing dynamic problems in continuous time has both advantages and disadvantages
when compared to discrete time formulations.
From a computational perspective, the key benefit to working in continuous time concerns the treatment of counterfactuals. Here there are two advantages over discrete time.
First, even if the data is time aggregated, the counterfactual analysis can leverage the full
computational benefit of the underlying continuous time process. In particular, instanta28

neous representations of the value functions can be used to solve for counterfactual hazards,
greatly reducing computational times because only one event occurs in any given instant.
In the typical discrete time set up, all players move simultaneously, sharply increasing the
computational burden. Second, one source of multiple equilibria—simultaneous moves—is
eliminated in the continuous time context. Multiple equilibria make interpreting counterfactuals difficult due to ambiguity regarding which equilibrium would be played in the
counterfactual environment.
On the other hand, estimation is more complicated in continuous time when data are
time aggregated, as it requires integrating out over the possible paths between the observed
state changes. It is important to keep in mind, however, that estimation is not the main
bottleneck for research, as consistent estimates can be obtained with two-step estimation
in either discrete or continuous time with low computational burden.
Continuous and discrete time representations of dynamic games also have different economic implications. While continuous time methods may capture the underlying decisionmaking and strategy interaction well in many setting, they may be a poor fit for some
research problems. First, it may be the case that a simultaneous move environment and the
resulting coordination failures are a salient feature of the economic setting. For example,
the adoption of new technology standards may be delayed by a failure by incumbent players
to quickly agree on a standard. Second, the methods developed here apply to stationary
environments. While dynamic games are typically estimated assuming stationarity, there
are exceptions. See Beauchamp (2014) and Igami (2014) for examples of empirical games
in non-stationary environments. Further work is necessary to understand whether the tools
developed here can be extended to non-stationary, continuous time environments.
Finally, conceptual issues may dictate the choice between discrete and continuous time.
It is well-known that in a discrete time setting with asymmetric information, agents can
sometimes make “mistakes” that arise from the simultaneity of choice (for example, simultaneously opening in the same location as a rival with a low ex-ante probability of entering
because the rival happened to receive a “high” idiosyncratic shock). This is obviously most
damaging in a static model (where firms cannot correct their mistakes) but may be unattractive in a dynamic setting as well if, for example, the choice requires substantial investments
to un-wind. That said, if such “mistakes” are a salient feature of the economic environment
because, for example, firms only observe their rival’s actions with a lag, a discrete time
model might be able to capture this behavior more simply than a continuous time model.
More broadly, the regularity of decision timing implied by the discrete time model may
be preferred in some settings. For example, there may be institutional features that restrict
the timing of when decisions can be made. Board meetings may occur at pre-specified (e.g.
quarterly) times during the year or long-term contracts (or implicit agreements) might
29

prevent an agent from changing its actions for a pre-specified period of time. In such cases,
a discrete time model may be more appropriate. On the other hand, a discrete time model
may force many outcomes to occur at the same instant that are more naturally viewed as
occurring sequentially (e.g. the opening or closing of stores, changes in installed capacity,
or the release of new products). Generally, the appropriate choice of modeling assumption
will depend on the institutional setting being considered.

6

Wal-Mart’s Entry into the Supermarket Industry

Our empirical application considers the impact of Wal-Mart’s entry into the supermarket
industry. In 1994, the first year for which we have data, Wal-Mart owned 97 supercenter
outlets. However, by 2006, the last year of our data, they operated 2225 such outlets and
ranked first among all grocery firms in terms of overall sales. Much of this expansion came
at the expense of incumbent grocers. The question is exactly which types of firms were
most impacted and how the competitive landscape evolved in response.
Wal-Mart first gained national prominence through its gradual rise to an ultimately
dominant position in the discount store (general merchandise) industry. Due to its large
role in the U.S. economy (Wal-Mart accounted for 8.8 percent of (non-automobile) retail
sales in 2004), Wal-Mart has attracted significant attention from both the popular press
and academic researchers. Much of the debate centers on Wal-Mart’s overall impact on
consumer surplus, labor market outcomes, and local competitors. Our focus here will be
on its impact on competition and market structure.
There is no doubt that Wal-Mart has had a significant impact on retail competition. Due
to its scale and operational efficiency, Wal-Mart is often able to undercut the prices of its
rivals, both in general merchandise and groceries. For example, in the context of groceries,
Basker and Noel (2009) find that Wal-Mart is able to set prices that are on average 10
percent lower than their competitors and that this differential appears to be increasing
over time. They also find evidence of a competitive response: in the short run, competing
grocery stores reduce prices by 1-2% when a Wal-Mart enters. They note that the response
is mostly due to smaller scale competitors - the reaction by the top 3 national chains is
only half as large. Matsa (2011) looks at Wal-Mart’s impact on supermarket stock-outs (a
measure of quality) and finds that entry by Wal-Mart decreases stock-outs at competing
supermarkets, but that this impact is instead centered on large-scale competitors. The
smaller rivals either cut prices or exit. Since much of Wal-Mart’s advantage appears to
derive from its enormous scale and intensive investment in information technology (Basker,
2007), there is particular concern that Wal-Mart stifles small scale entrepreneurial activity.
This was particularly salient in the context of the discount store industry (Wal-Mart’s
30

original line of businesss) which was, prior to entry by Wal-Mart, served by a collection
of single-store outlets that typically focused on a more narrow line of goods. By offering
greater breadth and depth of assortment, Wal-Mart consistently leveraged its greater scale
to undercut prices and consolidate purchases (by offering one stop shopping). The impact
on small scale firms was unambiguously negative - Wal-Mart displaced the “mom and pop”
stores. Jia (2008) concludes that Wal-Mart’s expansion alone drove 50-70 percent of the net
exit of small discount retailers from the late 1980s to mid 1990s. Focusing on the big box
industry as a whole, Haltiwanger, Jarmin, and Krizan (2010) find a large negative impact
of big box chains (including Wal-Mart) on single store retailers and small chains, continuing
a long term trend toward larger chains throughout much of retail.
However, Wal-Mart’s impact on the structure of the grocery industry is less clear. While
Matsa (2011) finds a significant negative impact on the survival probabilities of small-scale
rivals consistent with earlier experience in the discount industry (and a shift up market by
the larger chains), Ellickson and Grieco (2013) find a large, geographically localized negative
impact of Wal-Mart centered on the large grocery chains, with no measurable impact on the
small firms at all. In the analysis presented below, we find that Wal-Mart’s negative impact
falls almost entirely on the large chains and is actually associated with an expansion by the
single store segment. This sharp contrast with the earlier case of the discount segment is
striking, and illustrates the benefit of a dynamic structural model as the overall shift is an
equilibrium result that evolves slowly over time.

6.1

Data

Our data for the supermarket industry are drawn from yearly snapshots of the Trade Dimensions Retail Database, capturing the set of players that are active in September of each
year, starting in 1994 and ending in 2006. Trade Dimensions continuously collects information on every supermarket (and many other retailers) operating in the United States
for use in their Marketing Guidebook and Market Scope publications and as a standalone,
syndicated dataset. The definition of a supermarket used by Trade Dimensions is the government and industry standard: a store selling a full line of food products that grosses at
least $2 million in revenue per year. Store level data on location and a variety of in-store
features is linked to the firm level through a firm identity code, which can also be used to
identify the location of the nearest distribution facility. In addition to the Trade Dimensions
data, which consists of yearly snapshots of the entire industry, we also have information on
the exact opening dates of the Wal-Mart supercenters that were gathered from a variety of
online sources.
Although not strictly necessary to our methods being able to handle time aggregation,
for some of our specifications we use data on the exact date of Wal-mart entry. This data
31

comes from two sources. First is data downloaded from trendresults.com which gives the
opening date for all Wal-Mart stores. Some stores, however, were converted from retail
stores to supercenters and this data misses these conversion dates. This is a particular
issue earlier in the sample. We supplement this data with data from Emek Basker who was
provided with entry dates up through 2005, though some of the dates were clustered around
particular days suggesting time aggregation in some cases. We only used exact Wal-mart
entry dates if we were confident in the timing.15
For market definition, we focus on Metropolitan Statistical Areas (MSAs) with population under 500,000, yielding a total of 309 markets. For our purposes, a firm is deemed
to be a chain firm in a market if it has at least 20 stores open nationally and its maximum
market share (in terms of number of stores) exceeds 20% in at least one year. We allow
for up to seven chain players in each MSA who may or may not be active in the market at
any given time. If a chain has no stores in a particular period and chooses not to build a
store, that chain is replaced by a new potential chain entrant. In our model, we allow for
ten potential fringe firm entrants in each MSA, so the number of fringe firms is the number
of incumbent fringe firms plus ten.16
Demand for supermarkets is a function of population. The data on market population are interpolated from the decennial censuses of the United States and population is
discretized into six categories.17 Each MSA is assigned to one of three population growth
categories based on the change in the population of the MSA over the full sample period. In
particular, the growth category of a city is fast if the annual growth rate is greater than 2%
(74 cities), moderate if the annual growth rate is between 1% and 2% (106 cities), and slow
if the annual growth rate is less than 1% (129 cities). The parameters governing population
transitions are indexed by these growth categories.
Table 1 gives descriptive statistics for the sample. On average, there are about two and
a half chain firms per market, with 3.7 stores per chain firm on average. Markets contain
an average of 13 fringe stores. The number of Wal-Marts is much smaller, averaging one
store per market in the sample. On average, there are 0.277, 0.177, and 0.825 stores built
per market within a year by chain firms, Wal-Mart, and fringe firms, respectively. The
corresponding figures for store closings are 0.224, 0.002, and 0.908, revealing that Wal-Mart
virtually never exits in our sample.
Table 2 looks at entry and exit decisions for chain firms and fringe firms one year before,
15

In total we use 256 for dates for 475 Wal-mart entries. The match rate is much higher in later years,
with exact dates on 213 of 260 entries between 2001 and 2006.
16
Since we are treating the firm/market as the relevant unit of analysis, we do not model situations in
which a supermarket chain moves one of their stores to another location within the market. In such cases,
we consider only the net effect, meaning that we assume that if we see both an entry and exit by the same
chain, this pair of moves is equivalent to not moving at all.
17
The discretization was such that differences in log population between adjacent categories was equal.

32

the year of, and the year after initial entry of Wal-Mart. Here, we see that chain and fringe
firms both respond negatively to Wal-Mart. The number of new chain stores falls from 0.311
in the period before Wal-Mart enters to 0.189 in the period after—a 40% drop. Similarly,
the number of stores that close increases by over 6.5% from a base level of 0.122. The
qualitative patterns for fringe firms are the same, though the effects are muted, suggesting
that Wal-Mart’s presence is more detrimental to chain firms than fringe firms.
This table highlights an advantage of using a model where the frequency of moves can
differ from the data sampling frequency. Note that the numbers of entering and exiting chain
stores in the year of Wal-Mart’s initial entry are bracketed by the corresponding values the
year before and the year after Wal-Mart’s entry. In markets where chain and fringe stores
saw little change in their building patterns, this suggests that Wal-Mart entered later in
the period. But when Wal-Mart enters early in the period, exit by chain and fringe stores
is more likely to occur within the period. Our model can explain both the increase in exit
rates during the entry period as well as the additional increase in exit rates in the period
after.

6.2

Model

To quantify Wal-Mart’s impact on large versus small rivals, and allow for heterogeneous
competitive effects across firm types, there are three types of firms in our model: chain firms
(who can operate many stores), Wal-Mart (who can also operate many stores), and fringe
firms (who can operate at most one store each). We assume that the chain firms (including
Wal-Mart) make strategic decisions within each local market (MSA), but independent decisions across markets (i.e. they do not choose their entire spatial layout jointly, but rather
make optimal decisions on a market by market basis). With each move arrival, chain stores
can open one new store (j = 1), do nothing (j = 0), or, conditional on having at least one
open store, close a store (j = ≠1). A move arrival for an incumbent fringe firm provides an

opportunity for the firm to exit. Similarly, move arrivals provide opportunities for potential
entrants to enter. In the context of retail competition, a random move arrival process might
reflect the stochastic timing of local development projects (e.g., housing tracts and business
parks), delays in the zoning and permitting processes, and the random arrival of retailers
in other lines of business that have higher valuations for the properties currently occupied
by incumbent grocers. All firms have the same move arrival rate, normalized at ⁄ = 1, and

q1 and q≠1 are the rates of moving up and down in population, respectively.

Our model is a continuous-time, discrete action version of the dynamic oligopoly model

of Ericson and Pakes (1995) and Pakes and McGuire (1994), in which heterogeneous firms
make entry, exit, and investment decisions. Firms in our model are differentiated by type
(Wal-Mart, chain, or fringe) and by the number of stores they operate. Firms invest by
33

building new stores and disinvest by closing stores.
Since the state variables are discrete, we enumerate all possible states by an integer
scalar index k = 1, . . . , K. The state of the market at each instant can be summarized by
a vector xk containing the number of stores operated by each chain firm, sc1k , sc2k , . . . , each

fringe firm, sf1k , sf2k , . . . , and Wal-Mart, sw
k , along with the current population, dk :
xk = (sc1k , sc2k , . . . , sf1k , sf2k , . . . , sw
k , dk ).

Therefore, each value of k represents an encoded state vector and the function l(i, j, k)
gives the state conditional on firm i taking action j in state k. Additionally, each market is
characterized by a time-invariant unobserved type z, which is observed by the firms in the
market but not by the econometrician.18 Hence, the full state vector at any instant can be
written as (xk , z).
6.2.1

Value Functions

We now provide the general formulation of the value functions and then describe the relevant
state variables. For a particular market, the value function for firm i in state k is given by:
Vik =

uik +

q

jœ{≠1,1} qj Vi,l(0,j,k)

+

ﬂ+

q

m”=i ⁄

q

q

jœ{≠1,1} ‡mjk Vi,l(m,j,k)

jœ{≠1,1} qj

+

q

m”=i ⁄

q

Ó

+ ⁄ E maxj Vi,l(i,j,k) + Âijk + Áijk

jœ{≠1,1} ‡mjk

+⁄

(20)

In this expression, nature is indexed by i = 0, the choices are j = 1 and j = ≠1, and the
costs Âijk reflect the costs of initial entry, building new stores, or closing stores depending

on the values of the player identity i, choice j, and state k. We will fully specify these costs
for each type of firm below.
Following standard convention in the empirical entry literature, we assume that if a
chain or fringe firm closes all of its stores, then the firm cannot enter again later (in effect,
the continuation value for exit is identically zero). Hence, if a chain firm exits, it would
be replaced by a new potential chain entrant. For chain and fringe firms, this allows us
to replace the value functions on the right-hand side of (20) using Propositions 2 and 3.
As a result (and exploiting Proposition 4), the value function on the left-hand side of (20)
can be expressed as a function of the flow payoffs, the move arrival parameters, and the
probabilities of making particular decisions. Because Wal-Mart essentially never exits or
closes stores, we cannot recover their full set of structural parameters. Nonetheless, we are
able to fully account for their strategic impact on rivals’ actions by using our first stage
estimates to capture their rivals’ beliefs about Wal-Mart’s equilibrium policy functions.
18

We use Z = 5 points of support, z œ {≠1.3998, ≠0.5319, 0.0, 0.5319, 1.3998}, based on a discrete approximation to a standard normal random variable.

34

Ô

.

This flexibility is an additional advantage of using a two-step estimation approach.
6.2.2

Flow Profits and Choice-Specific Payoffs for Chain Firms

We specify the flow payoff uik for chain firms in terms of per-store latent revenue and
total cost. These are linear functions of market population, dk , the number of own stores,

scik , the number of competing chain stores, s̃cik , the number of Wal-Mart stores, sw
k (WalMart), and the number of fringe stores, sfk . Revenues also depend on an unobserved (to the

econometrician) characteristic of the market, z, which reflects the tastes of consumers in a
given market for particular types of products. Flow profits for a chain firm i in state k are
1

2

c f
c c
c
c
c c
c
ucik = scik —0c + —1c s̃cik + —2c sw
k + —3 sk + —4 sik + —5 dk + —6 z + —7 zsik + eik ,

where ecik is (the negative of) the flow cost of operating a set of stores:
ecik = µc1 scik + µc2 (scik )2 + µc3 (scik )3 .

A cubic cost function allows there to be regions of increasing and then decreasing returns
to scale, so that for each state the optimal value of scik is finite. Expanding and collecting

terms yields
1

c f
c
c c
c c 2
c
c
c c
ucik = scik (—0c + µc1 ) + —1c s̃cik + —2c sw
k + —3 sk + (—4 + µ2 )sik + µ3 (sik ) + —5 dk + —6 z + —7 zsik

1

2

c f
c c
c c 2
c
c
c c
= scik ◊0c + ◊1c s̃cik + ◊2c sw
k + ◊3 sk + ◊4 sik + ◊5 (sik ) + ◊6 dk + ◊7 z + ◊8 zsik .

2

The choice-specific instantaneous payoffs Âijk depend on the unobserved state z and

differ according to whether firm i is an incumbent (scik > 0) or new entrant (scik = 0) and
whether the choice is building a new store (j = 1) or closing an existing store (j = ≠1):

Âijk =

Y
_
c
c
c
c
_
_÷0 + ÷1 z + Ÿ0 + Ÿ1 z
_
_
_
_
]Ÿc + Ÿc z
0

1

_
_
„c0 + „c1 z
_
_
_
_
_
[0

if scik = 0 and j = 1,
if scik > 0 and j = 1,
if scik > 0 and j = ≠1,

otherwise.

Therefore, the structural parameters of interest for chain firms are the coefficients of the
per-store payoff function and the parameters of the instantaneous payoffs:
◊c = (◊0c , . . . , ◊8c , ÷0c , ÷1c , Ÿc0 , Ÿc1 , „c0 , „c1 ).
We assume that there are seven chain firms in all markets with the number of potential
35

entrants in a market equal to seven minus the observed chain firms in the market. The twostep estimation we employ means we do not need to place any restrictions on the number of
chain stores a firm operates, though we will need to do so when we solve for counterfactual
choice probabilities.
6.2.3

Flow Profits and Choice-Specific Payoffs for Fringe Firms

Flow profits for fringe stores have a similar linear form to that of chain firms, though with
different coefficients and a different flow cost function, efik . Namely, an operating fringe

store has profits given by:19

f f
f
f
f
f
f
ufik = —0f + —1f sck + —2f sw
k + —3 sk + —4 dk + —5 z + —6 zsk + eik ,

Fringe competitors often rely on the same suppliers to deliver goods to their stores. Hence,
there may be some density economies present at first. However, at some point competitive
influences will drive up costs, suggesting a quadratic cost function in the total number of
fringe stores:

efik = µf0 + µf1 sfk + µf2 (sfk )2 .

Collecting terms yields the flow profit function
f
f f
f f 2
f
f
f
f
ufik = (—0f + µf0 ) + —1f sck + —2f sw
k + (—3 + µ1 )sk + µ2 (sk ) + —4 dk + —5 z + —6 zsk
f f
f f 2
f
f
f
f
= ◊0f + ◊1f sck + ◊2f sw
k + ◊3 sk + ◊4 (sk ) + ◊5 dk + ◊6 z + ◊7 zsk .

Recall that fringe firms can operate at most one store. Therefore, potential fringe
entrants only choose whether to enter (and build a single store) or not and incumbent
fringe firms only decide whether to close their store or not. We assume there are always
ten potential fringe entrants. Therefore, the choice-specific instantaneous payoffs for fringe
firms, Âijk , represent entry costs for new entrants (for which sfik = 0) and exit values for

incumbents (for which sfik = 1). Since fringe firms can operate at most one store, we cannot
distinguish the entry cost from the building cost. Because we estimate a fixed flow cost

parameter for fringe firms, ◊0f , we normalize the exit value to zero. As with chain firms, we

allow the entry cost to depend on the unobserved state z:

19

Y
]÷ f + ÷ f z
0
1
Âijk =
[0

if sfik = 0 and j = 1,
otherwise.

Note that there is no term for own number of stores here as fringe stores can only operate at most one
store.

36

Therefore, the structural parameters of interest for fringe firms are the coefficients of the
payoff function and the parameters of the instantaneous payoffs:
◊f = (◊0f , . . . , ◊7f , ÷0c , ÷1c ).

6.3

Estimation

We estimate the model in two steps, first estimating the reduced form hazards that capture
the rate of change in the number of stores of each format and the change in population
over time, and then estimating the structural parameters of the profit functions, taking the
reduced form hazards as given.
6.3.1

Step 1: Estimating Reduced-Form Hazards

We estimate the probabilities of opening a store, closing a store (if the firm has at least
one store), and doing nothing using a linear-in-parameters multinomial logit sieve, with
the parameters varying by firm type (chain, Wal-Mart, and fringe).20 In particular, let
p̃ij (k, z, –) denote the reduced form probability of firm i making choice j in state (k, z),
which has the form

exp(hj (k, z, –))
,
j Õ œAik exp(hj Õ (k, z, –))

p̃ij (k, z, –) = q

where hj (k, z, –) is a flexible function of the state variables with finite dimensional parameter
vector –. The likelihood of a particular event, choice j by firm i in state k, in a market
with unobserved state z, with an interval of length · since the previous event, is
S

Q

⁄p̃ij (k, z, –) exp U≠ a

ÿ

qj Õ +

ÿ
m

j Õ œ{≠1,1}

⁄

ÿ

j Õ œA

mk

R T

p̃mj Õ (k, z, –)b · V .

Since we have annual data, we simulate potential sequences of events that can happen
over the course of each year. As discussed earlier, the structure of our data is such that
we observe all events that took place in each year, but do not observe the exact times at
which these events occur. Suppose that we observe W events in period n. For periods with
W > 0, we draw R simulated paths, randomly assigning each observed event to a simulated
time. Once we have the likelihood of each simulated sequence of events, we average over
these simulated sequences, integrating over move times.
20
The variables included in the multinomial logit models are the number of fringe stores and its square,
the number of chain stores and its square, the number of Wal-Marts and its square, and the total number
of firms squared, and interactions of each of these variables with population. In addition, we control for city
growth type, the unobserved state, and the unobserved state interacted with an indicator for building a new
store.

37

Focusing on a particular observation period n, let kn≠1 and kn denote the states at the
(r)

beginning and end of the period. Let kw denote the state immediately preceding event
w in simulation r, with w = 1, . . . , W + 1. The observed state at the beginning of the
(r)

(r)

period is then k1 , so k1

= kn≠1 for each r. Similarly, the terminal state for each path
(r)

(r)

is the observed state at the end of the period, so kW +1 = kn for each r. Let Iw (i, j)

be the indicator for whether event w of the r-th simulation was action j taken by firm i.
Conditional on knowing the unobserved state z, the simulated likelihood of observation n
in market m is
Y

S

T

R ]Ÿ
W
ÿ
ÿ ÿ
1 ÿ
(r)
U
Iw(r) (0, j)qj +
⁄
Iw(r) (i, j)p̃ij (kw
, z, –)V
L̃mn (q, –; z) =
R r=1 [w=1 jœ{≠1,1}
i
j”=0

S

Q

◊ exp U≠ a

ÿ

qj +

jœ{≠1,1}

S

Q

◊ exp U≠ a

ÿ

⁄

ÿ

j”=0

i

ÿ

TZ
^
(r)
p̃ij (kw
, z, –)b ·w(r) V
\

qj +

jœ{≠1,1}

R

ÿ

⁄

i

ÿ

j”=0

R

(r)

(r)

T

p̃ij (kW +1 , z, –)b (1 ≠ tW )V ,
(r)

where W is the number of events that occurred in the n-th interval and tW is the time of
the last simulated move.

Since z is unobserved, we estimate the reduced form hazards using mixture distributions.
Higher values of the unobserved state may make it easier or harder to operate as a chain,
fringe, or Wal-Mart store respectively. We discretize the standard normal distribution into
five points and then estimate the population probabilities of being at each of these points.
Note that there is an initial conditions problem here, so we allow the prior probability of
being in a particular unobserved state to depend on the first period state variables, similar
to Keane and Wolpin (1997) and Arcidiacono, Sieg, and Sloan (2007). In particular, we
specify the prior probabilities as following an ordered logit that depends on the number of
chain stores, the number of Wal-Marts, and the number of fringe stores, all interacted with
population, and the city growth type.
Let ﬁz (k1 ) be the probability of the unobserved state being z given that the observed
state was k1 for the first observation. With M markets and T periods each, integrating
with respect to the distribution of the unobserved market states yields
(q̃, –
˜ , ﬁ̃) = arg max

(q,–,ﬁ)

M
ÿ

m=1

ln

A

ÿ
z

ﬁz (km1 )

N
Ÿ

n=1

B

L̃mn (q, –; z) .

The first stage estimates then give both the reduced form hazards, which are subsequently
used in the second stage to form the value functions, as well as the conditional probability
38

of each market being in each of the unobserved states, as in Arcidiacono and Miller (2011).
6.3.2

Step 2: Estimating the Structural Parameters

In Step 2, we take the probabilities of being in each unobserved state and the reduced-form
hazards from Step 1 as given. We then separately estimate the structural parameters for
chain firms and fringe stores. As noted above, Wal-Mart’s limited set of realized actions
precludes us from estimating their structural parameters. However, their strategic impact
is captured by the first stage estimates, which reflect their rivals’ beliefs over Wal-Mart’s
expected actions. Our counterfactual experiments will then include only scenarios in which
Wal-Mart’s structural parameters do not play a role (e.g. equilibria in which Wal-Mart no
longer exists). Let Pm (z) denote the probability of MSA m being in unobserved state z
given the data. Using Bayes’ rule, we have
r

˜ ; z)
ﬁz (km1 ) N
n=1 L̃mn (q̃, ⁄̃, –
.
Pm (z) = q
rN
˜; zÕ)
z Õ ﬁz Õ (km1 ) n=1 L̃mn (q̃, ⁄̃, –

(21)

These probabilities are then used as weights in the likelihood function for Step 2.
Next, using Proposition 4, we can express the value function in (20) as a function of
˜ ).
the structural parameters, ◊, and the reduced form hazards from the first stage, p̃ij (k, z, –
Thus, let ‡
˜ij (k, z, ◊) denote the implied probability that firm i takes action j in state (k, z),
for a given value of the second stage parameters.
˜ ; z) as
Define Ľmn (◊; q̃, –
Y

S

T

R ]Ÿ
W
ÿ ÿ
ÿ
1 ÿ
(r)
U
˜ , z) =
Iw(r) (0, j)qj +
⁄
Iw(r) (i, j)˜
‡ij (kw
, z, ◊)V
Ľmn (◊; q̃, –
R r=1 [w=1 jœ{≠1,1}
i
j”=0

S

Q

◊ exp U≠ a

ÿ

jœ{≠1,1}

S

qj +

Q

◊ exp U≠ a

ÿ

⁄

i

ÿ

ÿ

j”=0

TZ
^
(r)
‡
˜ij (kw
, z, ◊)b ·w(r) V
\

qj +

R

ÿ
i

jœ{≠1,1}

⁄

ÿ

j”=0

(r)

R

(r)

T

‡
˜ij (kW +1 , z, ◊)b (1 ≠ tW )V ,

where we use the same simulation draws as in Step 1, but replace each p̃ij with ‡
˜ij , which
is a function of ◊. The second stage estimates are then given by
◊ˇ = arg max
◊

M ÿ
ÿ

Pm (z)

m=1 z

N
ÿ

n=1

39

ln Ľmn (◊; q̃, –
˜ , z).

6.4

Results

The structural parameter estimates for chain stores are presented in Table 3. In the first set
of columns we present the results where all entry and exit decisions are aggregated over the
year. In the second set we use the information on the exact date of Wal-Mart entry, while
the third set removes the controls for unobserved heterogeneity. In all cases, we calculate
standard errors using the approach of Ackerberg, Chen, and Hahn (2012).
All three sets of estimates show Wal-Mart having substantial effects on chain flow profits
that dwarf the effects of other chain and fringe stores. Despite these large effects, the
estimates aggregating over Wal-Mart entry times (column 1) and using the exact date of
Wal-Mart entry (column 2) show virtually identical parameter estimates, suggesting that,
in this case, integrating out over entry times does not contaminate our estimates.
The effects of competition on chain profits, however, are substantially lower in the third
set of columns that do not control for unobserved heterogeneity. The coefficients on the
number of Wal-Marts and number of fringe stores are over thirty percent higher in columns
1 and 2 than in column 3, with the effect of the other chain stores almost four times as high.
This is to be expected since, all else equal, higher unobserved demand will be correlated
with more entry leading to estimates of competition that are biased downward. Controlling
for such bias is important for our counterfactual analysis since the degree to which different
firm types face differential competitive pressures from each type of rival will determine who
thrives and who fails as the market evolves.
Markets with higher values of the unobserved state face lower building costs for chain
firms and lower diminishing returns for increasing chain size, but the costs of entering the
market are higher. Other coefficients are as expected—population increases profits and the
costs of building stores is substantial, with even higher costs incurred for entering a market.
Results for the three specifications for fringe firms are presented in Table 4. We again
see negative effects of Wal-Mart on fringe profits in all three specifications with the timeaggregated results (column 1) very close to those that conditional on Wal-Mart entry times
(column 2). In contrast to the chain stores, Wal-Mart’s effects on fringe stores are smaller
when we account for unobserved heterogeneity. An additional chain store negatively affects
profits of fringe stores, with the effect being about that half that of an additional Wal-Mart.
By comparison, the effect of an additional chain store from a competing chain was a little
over one-sixth of the effect of an additional Warmart for chain profits. Hence, Wal-Mart
appears to have a greater relative effect on chain stores than fringe stores. Moreover, the
impact of competition from both types of rivals is smaller for the fringe than for the chains,
suggesting that fringe stores are indeed more differentiated in product space than their
chain rivals. Since differentiation in this industry mainly involves focusing on more narrow
segments of the consumer base (e.g. ethnic foods, organic meats and produce) it makes
40

sense that the benefits of scale would be more muted here, creating an opening for smaller
scale firms to counter the cost advantage enjoyed by the larger chains.
Due perhaps to the importance of distribution networks (which rely on achieving a
minimal local scale), having more fringe competitors raises profits at first, with competitive
effects dominating as the number of fringe competitors increases. This positive spillover is
robust to the inclusion of correlated unobservables. Population again has a positive effect
on profits and there are significant store building costs. Similar to chain stores, higher
values of the unobserved state lower store building costs and lessen the competitive impact
from fringe competitors. However, this latter effect is smaller for fringe stores.

6.5

Counterfactuals

The focus of our empirical analysis is on the differential impact of Wal-Mart on the chain and
fringe segments. While Wal-Mart’s earlier impact on the discount sector was unambiguously
detrimental to small scale rivals, the impact on the grocery industry is much less clear. To
evaluate the impact of Wal-Mart’s entry on the market structure of the grocery industry, we
conducted counterfactual experiments for each of the 205 markets that did not have a WalMart outlet in the beginning of our sample. In particular, we computed equilibrium policy
functions for a counterfactual scenario in which Wal-Mart does not exist,21 and compared
the temporal evolution of these markets under this counterfactual to the evolution implied
by the estimated first stage policy functions recovered from the true data.22 Using these two
sets of policy functions (true and counterfactual) we then simulated 10,000 future histories
from the first period in the data (1994), and averaged over them (at the market level) to
characterize differences in long-run equilibrium outcomes.
Table 5 illustrates the long-run impact of Wal-Mart’s entry. The two panels of Table 5
contain the simulated equilibrium outcomes at year 20 (which corresponds to 2014 in calendar time) and includes several measures of market structure, including the average number
of chain firms, chain stores, fringe stores, Wal-Mart stores, the average market shares of
each of these three player types, the share (by store count) of the largest (C1) and three
largest (C3) firms, and the Herfindahl-Hirschman Index (HHI) computed using the share
of total square feet of selling space.23 Column 1 contains the average initial market popu21

There is no guarantee that our counterfactual policy functions are unique. However, working in continuous time eliminates one sources of multiple equilibria (simultaneity) as well as being less-computationally
intensive, implying we can search for other equilibria. Using 10,000 different draws on the starting values
for the value functions and then iterating to a fixed point showed no evidence of multiple equilibria.
22
Recall that we did not attempt to recover the full set of Wal-Mart’s structural parameters because WalMart did not exit any markets over this period. The ability to make such a comparison is a benefit of using
a two-step estimation approach rather than a (infeasible with this data structure) full-solution estimation
approach.
23
Our square footage calculation assumes that all Wal-Mart stores are 62,200 square feet, all chain stores

41

lation, while column 2 contains the number of markets in a given category. The first row
of each panel averages across all 205 markets, while the next four rows in each panel break
this average out by census region.
Several clear patterns emerge. First, Wal-Mart has a sizeable negative impact on both
the number of chain firms and number of chain stores that are active in a given market.
Looking across regions, we find that the impact is fairly consistent across the Midwest,
Northeast and South, but only about half as large in the West. This is consistent with both
the higher level of political resistance that Wal-Mart has faced in these markets, and the
fact that the more tightly clustered population centers in these markets are less suited to
Wal-Mart’s more diffuse outlet structure.
Second, Wal-Mart’s presence actually leads to an expansion of the fringe. Note that
this is in sharp contrast to what occurred in the discount store industry, where the small
“mom and pop” stores retreated in the face of Wal-Mart’s expansion. There are at least
two likely reasons for this contrast. First, unlike the earlier experience of rural discount
(general merchandise) stores, Wal-Mart faced a large number of well-established chain stores
in the supermarket industry that had already made similar investments in scale and IT and
were providing a range of products that overlapped very closely with Wal-Mart’s offerings.
Second, and consistent with this overlap, as captured in the first stage policy function
estimates, Wal-Mart competes more directly with chain firms than those in the fringe. As
noted above, firms in the fringe are much more likely to be horizontally differentiated into
a distinct local niche (such as providing an ethnic or gourmet focus) than the full-service
chains. As Wal-Mart displaces the chains, this likely provides an even greater opportunity
for differentiation by the fringe segment, while Wal-Mart’s huge cost advantage (reflected
in its large competitive impact on chain flow profits) represents a direct challenge to the
survival of competing chains. The next set of results will further explore these points.
Before doing so, we note that the overall (and regional) impact of Wal-Mart actually
leads to a decrease in market concentration along all three measures (C1, C3 and HHI).
This is driven by the displacement of the chains by firms from the fringe. Even though
Wal-Mart eventually becomes a large player in many of these markets, the decrease in the
number of chain firms is significantly smaller than the decrease in the number of chain
stores, leading to a more uniform market structure when Wal-Mart is present. While we
do not have information on prices, under most models of retail competition a more uniform
structure would yield tougher price competition amongst the remaining firms, likely leading
to benefits for consumers.
Table 6 cuts the counterfactual results along several additional dimensions. The first
are 35,500 square feet and all fringe stores are 13,500 feet, which correspond to the empirical averages from
the data.

42

two columns contain the number of markets in each category and the average number of
Wal-Mart’s predicted to enter under the “actual” scenario. The remaining columns report
the percentage change in the various market structure measures employed in Table 5. The
first panel breaks the results out by census region (as in Table 5), illustrating the importance
of accounting for unobserved heterogeneity in capturing regional variation (we will return to
this point shortly). The next panel breaks the results out by market size. We label markets
as either “small” or “large” based on whether their initial population is below or above the
median value. Here we see a sharp contrast: while the negative impact on chains is the
same in both small and large markets, the positive impact on the fringe is much stronger in
the larger markets. This is consistent with the notion that the fringe is exploiting a greater
opportunity for horizontal differentiation, as these opportunities would naturally increase
with market size (i.e., a larger population yields more sub-markets large enough to support
one or more stores tailored to more unique tastes). Similarly, we divide markets by “Slow”,
“Moderate”, or “Fast” growth rates based on whether they are in the lower, middle, or
upper tercile of the population growth distribution.
The last panel breaks markets out by their “unobserved type” as assigned by the finite
mixture model employed above.24 While there were five points of support in the estimation, no markets were pre-dominantly assigned to the highest type. Higher values of the
unobserved type are clearly associated with greater Wal-Mart entry and higher initial population levels. Viewed geographically (results not shown), markets with low values of the
unobserved state tend to be in the western and mountain states as well as New England,
while markets with high values of the unobserved state tend to be in the south and southern
Atlantic states. Again, this is consistent with Wal-Mart’s center of regional strength and
areas where opposition to their expansion is weakest. The highest values of the unobserved
state are also associated with a greater initial fringe presence.
Strikingly, in markets assigned the lowest value for the unobserved type, Wal-Mart
has a strong negative impact on both chain and fringe stores. As a result, concentration
actually increases with Wal-Mart’s presence, as it moves towards being the dominant firm
in the market. Note that this outcome most closely matches what happened in the discount
industry. However, in the case of supermarket industry, it represents only a very small
fraction of the overall set of markets (9 out of 205). Geographically, these are small, rural
markets that initially had few chains and were essentially dominated by fringe players.
Wal-Mart pushes both types of firms out and actually increases the equilibrium level of
concentration. It seems likely that these markets are too small to support a diverse range
of offerings and Wal-Mart’s scale advantage is dominant.
24

The probability Pm (z)
qthat market m is of unobserved type z is defined in (21). We take the mean state
for a market to be z m = z zPm (z) and round z m to the nearest mass point to label cities, respectively, as
“More Negative”, “Negative”, “Zero”, “Positive”, or “More Positive”.

43

However, this is far from the modal outcome across the whole industry. For all other
values of the unobserved state, the average impact on the fringe is positive and sharply
increasing with the value of the unobserved state. The overall structure becomes less concentrated with Wal-Mart’s presence. This is due to both the contraction of the chain
segment, which is hurt more the greater the value of the unobserved state, and the fact that
the fringe competes less directly with (i.e. is more differentiated from) Wal-Mart.
Table 7 considers the impact of ignoring heterogeneity, and presents the same sets of
conditional means employed in Table 6, but using parameters (and counterfactual computations) estimated without accounting for unobserved heterogeneity. Perhaps not surprisingly, these results miss the rich heterogeneity apparent in Table 6: the regional variation
is muted and the asymmetric impact in large and small markets vanishes. The last panel
breaks things using the values of the unobserved state recovered earlier (which are ignored
in this estimation). Note that we now lose the traditional story altogether, as the small set
of rural “mom and pop” markets are now averaged in with the rest. Most importantly, the
offsetting impact of Wal-Mart’s expansion, namely its complementary relationship with the
fringe, is sharply reduced as we no longer capture its competitive separation from Wal-Mart
and the interplay with market size.
Table 8 explores the temporal evolution of market structure, providing some insight
into why the expansion of the fringe did not show up in earlier studies and illustrating the
importance of a dynamic structural model in this context. Focusing on the small market
versus large market comparison, the table shows the equilibrium market structure in years
5, 10, 15 and 20. As in year 20, the expansion of the fringe is most pronounced in earlier
years in the larger markets where the scope for differentiation is greatest. However, across
both sizes, the expansion of the fringe evolves more slowly than the contraction of the
chains, reflecting the subtle impact of dynamics. Recall that Wal-Mart’s direct impact
on the flow profits of the fringe is negative, but the overall impact is positive since WalMart pushes out the chains, who compete more directly with them, shifting the competitive
landscape toward the smaller scale competitors. Interestingly, Wal-Mart has recently started
to shift its focus toward offering much smaller stores (e.g. Wal-Mart Neighborhood Markets
and Wal-Mart Express, which are closer in size to corner grocers and convenience stores),
perhaps acknowledging the importance of these more localized offerings and the decreasing
role of local scale.

7

Conclusion

While recently developed two-step estimation methods have made it possible to estimate
large-scale dynamic games, performing simulations for counterfactual work or generating
44

data remains severely constrained by the computational burden that arises due to simultaneous moves. We recast the standard discrete-time, simultaneous-move game as a sequentialmove game in continuous time. This significantly reduces the computational cost, greatly
expanding the breadth and applicability of these structural methods and making even fullsolution estimation feasible for very large games.
By building on an underlying discrete-choice random utility framework, our model preserves many of the desirable features of discrete-time models. In particular, we show that
the insights from two-step estimation methods can be applied directly in our framework, resulting in another order of magnitude reduction in computational costs during estimation.
We also show how to extend the model to accommodate incomplete sampling schemes,
including time-aggregated data. Both are likely to be relevant for real-world datasets.
Using this formulation of a dynamic game in continuous time, we develop a dynamic
model of retail competition that allows for substantial heterogeneity (both observed and
unobserved) across agents and markets. We use the model to study the impact of WalMart’s entry into the retail grocery industry on market structure. The results imply that
Wal-Mart’s entry on market structure varies greatly across markets, leading to an increase
in market concentration in some markets which were initially served primarily by smaller
fringe stores and to a sharp decrease in concentration in the majority of markets that were
characterized by the presence of a number of large, dominant chains.
The inclusion of unobserved heterogeneity in the model is essential for uncovering these
qualitatively distinct economic implications of Wal-Mart’s entry across markets. Taken
as a whole, the results of our analysis demonstrate the importance of incorporating substantial heterogeneity both across markets and firm types in estimating dynamic games of
retail entry and competition, thereby highlighting the advantage of computationally light
approaches for estimating and solving dynamic models with large state spaces.

A
A.1

Additional Details on Other Approaches to Estimation
Nested Pseudo-Likelihood Estimation

In the main text we focus on the case of two-step pseudo maximum likelihood (PML) estimation where the hazards are estimated in a first step and used to form a pseudo-likelihood
function which is in turn used to estimate the structural parameters. This is similar to the
approach of Hotz and Miller (1993) and the pseudo maximum likelihood PML estimator of
Aguirregabiria and Mira (2007). This process can be iterated to improve the estimates as
in the nested pseudo likelihood (NPL) estimator, also proposed by Aguirregabiria and Mira
(2007), in which the estimated structural parameters are used to obtain new hazards which
are in turn used to obtain refined structural parameter estimates and so on.
45

Let ĥ0 denote an initial consistent estimator of the vector of hazards h define in (16).
Then let ◊ˆ1 denote the initial consistent two-step estimates of the structural parameters

based on ĥ0 . We can iterate this process by using ◊ˆ1 to obtain new choice probabilities and
hazards using the probability mapping as in ĥ1 = (◊ˆ1 , ĥ0 ). We can therefore define the
K-stage NPL estimator recursively as
◊ˆK = arg max LM (◊, ĥK≠1 )
◊œ

where the hazards are in turn defined recursively as
ĥK = (◊ˆK , ĥK≠1 ).

A.2

Forward-Simulation-Based Estimators

Forward simulation methods like those of Hotz, Miller, Sanders, and Smith (1994) and
Bajari, Benkard, and Levin (2007) can also be used in the continuous time framework we
have developed. We take as given that the reduced form hazard of firm i choosing action j
in state k, hijk , has been estimated in a first stage and that the choice-specific shocks follow
a type I extreme value distribution.
In this case, hijk is given by:
hijk = ⁄‡ijk
⁄ exp(Vijk ≠ Âijk )
= q
j Õ exp(Vij Õ k ≠ Âij Õ k )

implying that the log differences in the hazards between action j and 1 can be expressed
as:
ln (hijk ) ≠ ln (hi1k ) = Vijk ≠ Vi1k ≠ Âijk + Âi1k

(22)

We assume the instantaneous payoff to beginning in state k can be expressed as:
uik = Xi (k)–

(23)

where Xi (k) a row vector of dimension X Æ K associated with state k and – is a X ◊ 1

vector of coefficients to be estimated. Note that this is without loss of generality as X

could equal the number of states. Again without loss of generality, we express the cost of
changing the state as:
Âijk = Zi (j, k)Â

(24)

where Zi (j, k) is a row vector of dimension Z Æ K associated with changing the state using
46

action j in state k. Our forward simulation methods will then collect values for the row
vectors above.
Let ”ˆi denote the estimated strategy or policy function of firm i associated with the
estimated hazards ĥ. Given values for the structural parameters, ◊, the ex-ante value
function implied by these policies is
ˆ ĥ, ◊) = E
V̄ik (”,

5⁄ Œ
0

e

≠ﬂt

6
ukt dt - k0 = k

where the expectation is taken with respect to the continuous time joint stochastic process
(kt , Át ) over the infinite time horizon given the estimated parameters ĥ and strategy profile
ˆ
”.
We can now approximate Vijk and Vi1k using forward simulation methods. Specifically,
for each of R paths given initial state kú and choice jú, we initialize the 1 ◊ X vector Xij ú r ,
the 1 ◊ Z vector Zij ú r , and the scalar ‘ij ú r to zero. We then:

1. Draw the time of the next move arrival, · (1, r) where the rate is given by the sum of
the arrival processes associated with each of the players and nature (the ⁄’s and q’s).
2. Conditional on a move arrival, use the arrival processes to draw which player, or
alternatively nature, received the move arrival.
3. Draw an action using the estimates of the ‡ijk ’s if a player has moved or a state change
using the estimates of the q’s if nature has moved. The action or state change then
results in a new state k(1, r).
4. Add Xi (k ú )

s · (1,r) ≠ﬂt
ú . This gives the weight associated with the payoff
e dt to Xij
úr
0

while in state k ú over the interval zero to · (1, r).

5. If state k(1, r) resulted from player i taking action j, then:
(a) add e≠ﬂ· (1,r) ln (‡ijk ), the discounted expected value of ‘ijk that resulted in the
state change, to ‘új ú . This gives the expected adjustment from the unobservable
preferences from action j being optimal.

ú . This gives the weight associated with the cost of
(b) add e≠ﬂ· (1,r) Zi (j, k ú ) to Zij
úr

changing the state through action j in state k ú .

6. Iterate on the previous steps, where for the mth move arrival replace · (1, r) with
· (m, r), k ú with k(m, r), and k(1) with k(m + 1, r), until the the last move arrival is
sufficiently far into the future that future weights are sufficiently small.

47

The log differences in the hazards between action j and 1 can then be expressed as:
ln (hijk ) ≠ ln (hi1k ) =

C

ÿ

≠

ú
(Xijr

r

C

ÿ
r

≠

ú
Xi1r
)/R

D

–+

C

ÿ

(‘úij

r

≠

‘úi1 )/R

D

(25)

D

ú
ú
(Zijr
≠ Zi1r
)/R + Zi (j, k) ≠ Zi (1, k) Â

Note that all the terms in brackets can be calculated given the reduced form hazards implying that stacking the differences in hazards results in a linear system.
A.2.1

Second Step Estimation for Hotz, Miller, Sanders, and Smith (1994)

Following Hotz, Miller, Sanders, and Smith (1994), use (25) to form moment conditions. We
then stack the moment conditions for each state and choose {–, Â} it minimize the squared
differences of (25) where the left-hand side has been replaced by the estimated hazards.
A.2.2

Second Step Estimation for Bajari, Benkard, and Levin (2007)

With the first-step estimated hazards ĥ in hand and the ability to approximate the value
function for any arbitrary collection of policies (included the estimated ones), estimation of
the second step structural parameters can proceed as in Bajari, Benkard, and Levin (2007).
They use the principle of revealed preference to construct a minimum distance objective
function for the structural parameters based on the equilibrium conditions. In an MPE, no
single firm should be able to improve their presented discounted profits by deviating from
the estimated policy rule. We can estimate the value function for any firm i in any state
k by using the estimated hazards to simulate equilibrium behavior. We can do the same
for an alternative policy function that yields different hazards and then bulid an objective
function based on minimizing violations of the equilibrium conditions.
The structural parameters ◊ can be estimated as usual by treating the estimated policies
”ˆ = (”ˆ1 , . . . , ”ˆN ) as the true policies in the equilibrium conditions,
V̄i (s; ”ˆi , ”ˆ≠i , ĥ, ◊) Ø V̄i (s; ”iÕ , ”ˆ≠i , ĥ, ◊) ’(i, k, ”iÕ ),
and using them to form a minimum distance objective function
S(◊) ©

⁄ Ë

Ó

ÔÈ2

min V̄i (k; ”ˆi , ”ˆ≠i , ĥ; ◊) ≠ V̄i (k; ”iÕ , ”ˆ≠i , ĥ; ◊), 0

dH(i, k, ”iÕ )

where H is a distribution over the set of possible “inequalities” represented by tuples of the
form (i, k, ”iÕ ). By minimizing this function, we minimize the sum of squared violations of
the equilibrium conditions, motivated by revealed preference. Under the true parameters
48

◊, the true policy should always yield higher discounted future payoffs than any alternative
policy ”iÕ for each firm i.

B

Proofs

B.1
Let

Proof of Proposition 1
(‡) denote the K ◊ K state transition matrix induced by the choice probabilities ‡

and the continuation state function l(·, ·). Let Q̃0 denote the matrix formed by replacing

the diagonal elements of Q0 with zeros. Finally, let E(‡) be the K ◊ 1 matrix containing
the ex-ante expected value of the immediate payoff (both the instantaneous payoff and the

choice-specific shock) as defined in Proposition 1.
We can rewrite the value function in (1) in matrix form as
Ë

È

(ﬂ + ⁄)I ≠ (Q0 ≠ Q̃0 ) V (‡) = u + Q̃0 V (‡) + ⁄ [ (‡)V (‡) + E(‡)] .

Collecting terms involving V (‡) yields
[(ﬂ + ⁄)I ≠ ⁄ (‡) ≠ Q0 ] V (‡) = u + ⁄E(‡).
The matrix on the left hand side is strictly diagonally dominant since the diagonal of
Q equals the off-diagonal row sums, the elements of

(‡) are in [0, 1], and ﬂ > 0 by

Assumption 1. Therefore, by the Levy-Desplanques theorem, this matrix is nonsingular
(Horn and Johnson, 1985, Theorem 6.1.10). The result follows by multiplying both sides of
the above equation by [(ﬂ + ⁄)I ≠ ⁄ (‡) ≠ Q0 ]≠1 .

B.2

Proof of Proposition 2

Let vjk = Âjk + Vl(j,k) denote the choice-specific value function, net of the choice-specific

shock, for choice j in state k. Given the additively separable structure of instantaneous
payoffs, we can express the conditional choice probabilities in terms of the social surplus
function of McFadden (1981):
S (v0k , . . . , vJ≠1,k ; k) © E max{vjk + Áj }.
jœA

This function depends implicitly on the joint distribution of Á. Under Assumption 2, by
the Williams-Daly-Zachary theorem (Rust, 1994, Theorem 3.1), the function S exists, S is
additive in the sense that for any – œ R,
S(v0k + –, . . . , vJ≠1,k + –; k) = S(v0k , . . . , vJ≠1,k ; k) + –,
49

and the vector of CCPs equals the gradient of S: ‡k = ÒS(v0k , . . . , vJ≠1,k ; k). Let ṽk =
(v0k ≠ vj Õ ,k , . . . , vJ≠1,k ≠ vj Õ ,k ) denote the J ≠ 1 vector of differenced choice-specific value

functions, relative to choice j Õ , with the j Õ -th component omitted.

It follows from Proposition 1 of Hotz and Miller (1993) (also see Lemma 3.1 of Rust
(1994)) that there is a one-to-one function H which maps the differenced choice-specific
value functions ṽk in RJ≠1 to choice probabilities ‡k in

J,

the J-dimensional unit simplex

in R . The result follows by noting that the j-th component of the inverse mapping yields
J

ṽjk = Âjk ≠ Âj Õ k + Vl(j,k) ≠ Vl(j Õ ,k) as a function of j, j Õ , and ‡k .

B.3

Proof of Proposition 3

Recall from the proof of Proposition 2 that, by the Williams-Daly-Zachary theorem (Rust,
1994, Theorem 3.1) and Proposition 1 of Hotz and Miller (1993), we have ṽk = H ≠1 (‡k ).
Then, by the aforementioned additivity property of S,
)

*

E max {vjk + Áj } = E max vjk ≠ vj Õ k + Áj ≠ Áj Õ + vj Õ k + E Áj Õ
j

j

= S(v0k ≠ vj Õ k , . . . , vJ≠1,k ≠ vj Õ k ; k) + vj Õ k + E Áj Õ
2

= Vl(j Õ ,k) + Âj Õ k +
where

B.4

2 (j Õ , ‡ )
k

(j Õ , ‡k ),

= S(H ≠1 (‡k ); k) + E Áj Õ .

Proof of Proposition 4

For simplicity, suppose that j = 0 is a continuation action such that l(0, k) = k.25 Let
(jk1 , . . . , jkDk ) denote a generic sequence of Dk decisions by which state k ú is attainable from
state k. Similarly, let lkd denote the intermediate state in which the d-th decision is made,

where lk1 = k and lkd = l(jkd≠1 , lkd≠1 ). Then, by recursively applying Proposition 2 for the

continuation choice j = 0, we can write
Vk = Vkú +

Dk 1
ÿ

d=1

2

Âj d ,ld ≠ Â0,ld +
k k

k

Dk
ÿ

1

(0, jkd , ‡ld ).
k

d=1

(26)

Applying a similar procedure for each l ”= k for which qkl > 0 implies that we can write
the differences Vl ≠ Vk on the right-hand side of (2) in terms of a difference of terms of the

form in (26), where the Vkú term cancels leaving only sums of instantaneous payoffs Âjk

and functions of the CCPs ‡k . Finally, using Proposition 3 and additivity, we can express

the remaining term ⁄ E maxj {Âjk + Áj + Vl(j,k) ≠ Vk } as ⁄

2 (0, ‡ )
k

+ ⁄Â0k .

25
Otherwise, we have to begin from some suitable state kÕ and choice j Õ such that l(j Õ , kÕ ) = k so that Vk
is on the left-hand side of (4).

50

B.5

Proof of Propositions 5 and 6

Given a collection of equilibrium best response probabilities {‡i }N
i=1 , we can obtain a matrix
expression for the value function Vi (‡i ) by rewriting (7). Let

m (‡m )

denote the K ◊ K

state transition matrix induced by the choice probabilities ‡m and the continuation state
function l(m, ·, ·). Let Q̃0 denote the matrix formed by replacing the diagonal elements of

Q0 with zeros. Finally, let Ei (‡i ) be the K ◊ 1 matrix containing the ex-ante expected value

of the immediate payoff (both the instantaneous payoff and the choice-specific shock) for
player i as defined in Proposition 6.
Then, we can rewrite (7) in matrix form as
Ë

È

(ﬂ + N ⁄) I ≠ (Q0 ≠ Q̃0 ) Vi (‡i )

= ui + Q̃0 Vi (‡i ) +

ÿ

⁄

m”=i

m (‡m )Vi (‡i )

+ ⁄[

i (‡i )Vi (‡i )

+ Ei (‡i )] .

Collecting terms involving Vi (‡i ) yields
C

(ﬂ + N ⁄) I ≠

N
ÿ

⁄

m (‡m )

m=1

D

≠ Q0 Vi (‡i ) = ui + ⁄Ei (‡i ).

The matrix on the left hand side is strictly diagonally dominant since the diagonal of Q
equals the off-diagonal row sums, the elements of each matrix

m (‡m )

are in [0, 1] for all

m, and ﬂ > 0 by Assumption 1. Therefore, by the Levy-Desplanques theorem, this matrix
is nonsingular (Horn and Johnson, 1985, Theorem 6.1.10). Hence,
C

Vi (‡i ) = (ﬂ + N ⁄) I ≠

N
ÿ

⁄

m (‡m )

m=1

≠ Q0

D≠1

[ui + ⁄Ei (‡i )] .

(27)

This representation is similar to the linear expression for the ex-ante value function in the
discrete time model of Pesendorfer and Schmidt-Dengler (2007).
Now, define the mapping

: [0, 1]N ◊J◊K æ [0, 1]N ◊J◊K by stacking the best response

probabilities. This mapping defines a fixed point problem for the equilibrium choice probabilities ‡ijk as follows:
ijk (‡)

=

⁄

Ó

Ô

1 Áij Õ ≠ Áij Æ Âijk ≠ Âij Õ k + Vi,l(i,j,k) (‡i ) ≠ Vi,l(i,j Õ ,k) (‡i ) ’j Õ œ Ai f (Ái ) dÁi .

The mapping

is a continuous function from a compact space onto itself. By Brouwer’s

theorem, it has a fixed point. The fixed point probabilities imply Markov strategies that
constitute a Markov perfect equilibrium.

51

B.6

Proof of Proposition 7

Step 1: Uniform Convergence of LM to L—We apply the uniform law of large numbers
of Newey and McFadden (1994, Lemma 2.4) to establish uniform convergence. The data
are independent and identically distributed under Assumption 3, the parameter space is
compact under Assumption 5, the observation likelihood is continuous at each (◊, h) with
probability one, and the observation likelihood is strictly bounded between 0 and 1 under
additive separability of the idiosyncratic shocks and Assumption 2, and since the rates ⁄
and qkl are bounded for all k and l.
Ô
ˆ
Step 2: Consistency of ◊—By
assumption, ĥ is a M -consistent M-estimator. Let
RM (h) =

1
M

qM

m=1 rm (h)

denote it’s objective function and let rm © rm (h0 ). (For example,

for nonparametric MLE we would have rm (h) =

qT

n=2 ln Pkm,n≠1 ,kmn (

; h)). We have shown

above that LM converges uniformly in probability to L. L is also uniformly continuous in
◊ and h. Therefore, by Lemma 24.1 of Gourieroux and Monfort (1995), LM (◊, ĥ) converges

in probability to L(◊, h0 ) uniformly in ◊. Then, Assumption 6 implies that ◊0 is the only
element of

for which h0 = (◊, h0 ). This assumption plays a role similar to the conditional

density identification condition in conditional maximum likelihood. By the Kullback-Leibler
information inequality, it follows that ◊0 is the unique maximizer of L(◊, h0 ) in . It follows
p
by Theorem 2.1 of Newey and McFadden (1994) that ◊ˆ = arg max◊œ LM (◊, ĥ) æ ◊0 .

ˆ ĥ) = 0.
ˆ
Step 3: Asymptotic Normality of ◊—The
first order conditions for ◊ˆ are Ò◊ LM (◊,
ˆ ĥ) and by consistency of the latter,
By a mean value expansion between (◊0 , h0 ) and (◊,
0 = Ò◊ LM (◊0 , h0 ) + Ò◊◊€ LM (◊, h0 )(◊ˆ ≠ ◊0 ) + Ò◊h€ LM (◊0 , h0 )(ĥ ≠ h0 ) + op (1).
p

By the central limit theorem and information matrix equality, Ò◊◊€ LM (◊0 , h0 ) æ ≠

and Ò◊h€ LM
Ô

p
(◊0 , h0 ) æ

M (◊ˆ ≠ ◊ ) =
0

≠

≠1
◊◊€

◊h€ .

I

It follows that

◊h€

A

B

M
1 ÿ
Ô
Ò h rm +
M m=1

Finally, we note that under the assumptions

A

M
1 ÿ
Ô
Ò◊ sm
M m=1

BJ

◊◊€

+ op (1).

is continuously differentiable and the transi-

tion probabilities are bounded away from zero. The regularity conditions of Theorem 5.1 of
Newey and McFadden (1994) are satisfied, so the generalized information matrix equality
holds (Newey and McFadden, 1994, p. 2163), E[Òh rm Ò◊€ sm ] = 0, and E[Òh rm Òh€ sm ] =

I. Thus,

1
Ô
M

A M
ÿ

m=1

B

Ò◊ sm ≠

◊h€

A

M
1 ÿ
Ô
Ò h rm
M m=1

52

B

d

1

æ N 0,

◊◊€

+

◊h€

€
◊h€

2

.

The result holds by applying the continuous mapping theorem.

References
Ackerberg, D., X. Chen, and J. Hahn (2012). A practical asymptotic variance estimator for
two-step semiparametric estimators. Review of Economics and Statistics 94, 481–498.
Aguirregabiria, V. and P. Mira (2002). Swapping the nested fixed point algorithm: A class
of estimators for discrete Markov decision models. Econometrica 70, 1519–1543.
Aguirregabiria, V. and P. Mira (2007). Sequential estimation of dynamic discrete games.
Econometrica 75, 1–53.
Aguirregabiria, V. and P. Mira (2010). Dynamic discrete choice structural models: A survey.
Journal of Econometrics 156, 38–67.
Altu , S. and R. A. Miller (1998). The effect of work experience on female wages and labour
supply. Review of Economic Studies 65, 45–85.
Arcidiacono, P. and R. A. Miller (2011). Conditional choice probability estimation of dynamic discrete choice models with unobserved heterogeneity. Econometrica 79, 1823–
1867.
Arcidiacono, P. and R. A. Miller (2014). Nonstationary dynamic models with finite dependence. Working paper, Duke University.
Arcidiacono, P., H. Sieg, and F. Sloan (2007). Living rationally under the volcano? An
empirical analysis of heavy drinking and smoking. International Economic Review 48,
37–65.
Bajari, P., C. L. Benkard, and J. Levin (2007). Estimating dynamic models of imperfect
competition. Econometrica 75, 1331–1370.
Bajari, P., H. Hong, and D. Nekipelov (2013). Game theory and econometrics: A survey
of some recent research. In D. Acemoglu, M. Arellano, and E. Dekel (Eds.), Advances
in Econometrics: Tenth World Congress, Volume 3, Chapter 1, pp. 3–52. Cambridge:
Cambridge University Press.
Bajari, P., H. Hong, and S. P. Ryan (2007). Identification and estimation of discrete games
of complete information. Econometrica 78, 1529–1568.
Basker, E. (2007). The causes and consequences of Wal-Mart’s growth. Journal of Economic
Perspectives 21, 177–198.
53

Basker, E. and M. Noel (2009). The evolving food chain: Competitive effects of Wal-Mart’s
entry into the supermarket industry. Journal of Economics and Management Strategy 18,
977–1009.
Beauchamp, A. (2014). Regulation, imperfect competition, and the U.S. abortion market.
International Economic Review.
Bellman, R. E. (1957). Dynamic Programming. Princeton, NJ: Princeton University Press.
Berry, S. T. (1992). Estimation of a model of entry in the airline industry. Econometrica 60,
889–917.
Billingsley, P. (1961). Statistical Inference for Markov Processes. Chicago: University of
Chicago Press.
Blevins, J. R. (2013). Identifying restrictions for finite parameter continuous time models
with discrete time data. Working Paper 13-01, Ohio State University.
Blevins, J. R. (2014). Identification and estimation of continuous time dynamic discrete
choice games. Working paper, Ohio State University.
Bresnahan, T. F. and P. C. Reiss (1991). Empirical models of discrete games. Journal of
Econometrics 48, 57–81.
Collard-Wexler, A. (2013). Demand fluctuations in the ready-mix concrete industry. Econometrica 81, 1003–1037.
Cosman, J. (2014). Industry dynamics and the value of variety in nightlife: Evidence from
Chicago. Working paper, University of British Columbia.
Cuthbert, J. R. (1973). The logarithm function for finite-state Markov semi-groups. Journal
of the London Mathematical Society s2-6, 524–532.
Doraszelski, U. and K. L. Judd (2012). Avoiding the curse of dimensionality in dynamic
stochastic games. Quantitative Economics 3, 53–93.
Einav, L. (2010). Not all rivals look alike: Estimating an equilibrium model of the release
date timing game. Economic Inquiry 48, 369–390.
Elfving, G. (1937). Zur theorie der Markoffschen ketten. Acta Societatis Scientiarum Fennicæ Nova Series A 2, 1–17.
Ellickson, P. B. and P. L. Grieco (2013). Wal-Mart and the geography of grocery retailing.
Journal of Urban Economics 75, 1–14.
54

Ellickson, P. B., S. Houghton, and C. Timmins (2010). Estimating network economies in
retail chains: A revealed preference approach. Working Paper 15832, NBER.
Ericson, R. and A. Pakes (1995). Markov-perfect industry dynamics: A framework for
empirical work. Review of Economics and Statistics 62, 53–82.
Gourieroux, C. and A. Monfort (1995). Statistics and Econometric Models, Volume 2.
Cambridge University Press.
Haltiwanger, J., R. Jarmin, and C. Krizan (2010). Mom-and-pop meet big-box: Complements or substitutes? Journal of Urban Economics 67, 116–134.
Hansen, L. P. and T. J. Sargent (1983). The dimensionality of the aliasing problem in
models with rational spectral densities. Econometrica 51, 377–387.
Holmes, T. (2011). The diffusion of Wal-Mart and economies of density. Econometrica 79,
253–302.
Hong, H., W. Li, and B. Wang (2012). Estimation of dynamic discrete models from time
aggregated data. Working paper, Stanford University.
Horn, R. A. and C. R. Johnson (1985). Matrix Analysis. New York: Cambridge University
Press.
Hotz, V. J. and R. A. Miller (1993). Conditional choice probabilities and the estimation of
dynamic models. Review of Economic Studies 60, 497–529.
Hotz, V. J., R. A. Miller, S. Sanders, and J. Smith (1994). A simulation estimator for
dynamic models of discrete choice. Review of Economic Studies 61, 265–289.
Igami, M. (2014). Estimating the innovator’s dilemma: Structural analysis of creative
destruction in the hard disk drive industry. Working paper, Yale University.
Jia, P. (2008). What happens when Wal-Mart comes to town: An empirical analysis of the
discount retail industry. Econometrica 76, 1263–1316.
Johansen, S. (1974). Some results on the imbedding problem for finite Markov chains.
Journal of the London Mathematical Society s2-8, 345–351.
Karlin, S. and H. M. Taylor (1975). A First Course in Stochastic Processes (Second ed.).
San Diego, CA: Academic Press.
Keane, M. and K. I. Wolpin (1997). The career decisions of young men. Journal of Political
Economy 105, 473–522.
55

Kingman, J. F. C. (1962). The imbedding problem for finite Markov chains. Probability
Theory and Related Fields 1, 14–24.
Maskin, E. and J. Tirole (2001). Markov perfect equilibrium: I. Observable actions. Journal
of Economic Theory 100, 191–219.
Matsa, D. A. (2011). Competition and product quality in the supermarket industry. Quarterly Journal of Economics 126, 1539–1591.
Mazur, J. (2014). Can stricter bankruptcy laws discipline capital investment? Evidence
from the U.S. airline industry. Working paper, Duke University.
McFadden, D. (1981). Econometric models of probabilistic choice. In C. F. Manski and
D. McFadden (Eds.), Structural Analysis of Discrete Data. Cambridge, MA: MIT Press.
Milgrom, P. R. and R. J. Weber (1985). Distributional strategies for games with incomplete
information. Mathematics of Operations Research 10, 619–632.
Moler, C. and C. V. Loan (1978). Nineteen dubious ways to compute the exponential of a
matrix. SIAM Review 20, 801–836.
Nevskaya, Y. and P. Albuquerque (2012). A continuous time model of product usage:
Measuring the effect of product design and rewards in online games. Working paper.
Newey, W. K. and D. McFadden (1994). Large sample estimation and hypothesis testing. In
R. F. Engle and D. McFadden (Eds.), Handbook of Econometrics, Volume 4, Amsterdam.
North Holland.
Pakes, A. and P. McGuire (1994). Computing Markov-perfect Nash equilibria: Numerical
implications of a dynamic differentiated product model. The RAND Journal of Economics 25, 555–589.
Pakes, A., M. Ostrovsky, and S. Berry (2007). Simple estimators for the parameters of
discrete dynamic games (with entry/exit examples). The RAND Journal of Economics 38,
373–399.
Pesendorfer, M. and P. Schmidt-Dengler (2007). Asymptotic least squares estimators for
dynamic games. Review of Economic Studies 75, 901–928.
Phillips, P. C. (1973). The problem of identification in finite parameter continuous time
models. Journal of Econometrics 1, 351–362.
Rust, J. (1987). Optimal replacement of GMC bus engines: An empirical model of Harold
Zurcher. Econometrica 55, 999–1013.
56

Rust, J. (1994). Estimation of dynamic structural models, problems and prospects: Discrete
decision processes. In C. Sims (Ed.), Advances in Econometrics: Sixth World Congress,
Volume 2, Chapter 4, pp. 119–170. Cambridge: Cambridge University Press.
Ryan, S. P. (2012). The costs of environmental regulation in a concentrated industry.
Econometrica 80, 1019–1061.
Schiraldi, P., H. Smith, and Y. Takahasi (2012). Estimating a dynamic game of spatial
competition: The case of the U.K. supermarket industry. Working paper.
Schmidt-Dengler, P. (2006). The timing of new technology adoption: The case of MRI.
Working paper, London School of Economics.
Sidje, R. B. (1998). Expokit: A software package for computing matrix exponentials. ACM
Transactions on Mathematical Software 24, 130–156.
Singer, B. and S. Spilerman (1976). The representation of social processes by Markov
models. The American Journal of Sociology 82, 1–54.
Sweeting, A. (2013). Dynamic product positioning in differentiated product markets: The
effect of fees for musical performance rights on the commercial radio industry. Econometrica 81, 2013.
Weintraub, G. Y., C. L. Benkard, and B. Van Roy (2008). Markov perfect industry dynamics
with many firms. Econometrica 76, 1375–1411.

57

Table 1: Summary Statistics

Presenta

Number of Chains
Average No. of Stores per Chainb
Number of Wal-Marts Presenta
Number of Fringe Firms Presenta
Number of New Chain Storesc
Number of Exiting Chain Stores
Number of New Fringe Stores
Number of Exiting Fringe Stores
Number of New Wal-Marts
Number of Exiting Wal-Marts
Population Increase
Population Decrease
a

Sample size is 2910,

b

Mean
2.559
3.727
1.004
12.997
0.277
0.224
0.825
0.908
0.177
0.002
0.042
0.004

S.D.
0.024
0.040
0.142
0.823
0.012
0.011
0.021
0.023
0.008
0.001
0.004
0.001

Max.
7
32
12
47
5
7
10
11
3
1
1
1

Sample size is 7446 and removes all market-period combinations where the chain

operates no stores,

c

Sample size in this and all remaining rows is 2686.

Table 2: Response to Initial Wal-Mart Entry

Number of New Chain Stores
Number of Exiting Chain Stores
Number of New Fringe Stores
Number of Exiting Fringe Stores

Year
Before
0.311
(0.064)
0.122
(0.038)
0.867
(0.117)
0.789
(0.114)

Year
During
0.211
(0.054)
0.156
(0.044)
0.711
(0.105)
0.844
(0.118)

Year
After
0.189
(0.041)
0.189
(0.050)
0.767
(0.102)
0.833
(0.132)

Standard errors in parentheses. Based on 90 markets where Wal-Mart is first observed to enter.

58

Table 3: Chain Firm Parameters

59

Constant (◊0c )
Number of Chain Stores (◊1c )
Number of Wal-Marts (◊2c )
Number of Fringe Stores (◊3c )
Number of Own Stores (◊4c )
Number of Own Stores Sq./100 (100 ◊ ◊5c )
Population (◊6c )
Unobserved State (◊7c )
Unobserved State ◊ Number of Own Stores (◊8c )
Entry Cost (÷0c )
Entry Cost ◊ Unobserved State (÷1c )
Store Building Cost (Ÿc0 )
Store Building Cost ◊ Unobserved State (Ÿc1 )
Exit Value („c0 )
Exit Value ◊ Unobserved State („c1 )

Time-aggregated
Coeff.
S.E.
4.470 (0.768)
-0.065 (0.024)
-0.375 (0.148)
-0.052 (0.017)
-0.039 (0.081)
-0.182 (0.432)
0.176 (0.114)
-0.956 (0.881)
0.245 (0.199)

With Wal-Mart
Entry Times
Coeff.
S.E.
4.403 (0.749)
-0.067 (0.024)
-0.383 (0.139)
-0.053 (0.017)
-0.044 (0.084)
-0.165 (0.445)
0.213 (0.111)
-0.968 (0.806)
0.249 (0.191)

No Unobserved
Heterogeneity
Coeff.
S.E.
2.561 (0.409)
-0.017 (0.014)
-0.278 (0.108)
-0.040 (0.012)
0.104 (0.051)
-0.265 (0.166)
0.267 (0.075)

-18.377
-5.151
-5.068
3.513
15.913
4.166

-18.400
-5.148
-5.073
3.508
15.912
4.126

-17.643

(0.953)

-4.494

(0.782)

15.044

(0.633)

(0.805)
(1.621)
(0.876)
(0.968)
(0.888)
(1.261)

(0.807)
(1.676)
(0.870)
(0.986)
(0.896)
(1.274)

Table 4: Fringe Firm Parameters

60

Constant (◊1f )
Number of Chain stores (◊2f )
Number of Wal-Marts (◊2f )
Number of Fringe Stores (◊3f )
Number of Fringe Stores Squared / 100 (100 ◊ ◊4f )
Population (◊5f )
Unobserved State (◊6f )
Unobserved State ◊ Number of Fringe Stores (◊7f )
Entry Cost (÷0f )
Entry Cost ◊ Unobserved State (÷1f )

Time-aggregated
Coeff.
S.E.
-13.074 (0.080)
-0.021 (0.003)
-0.041 (0.012)
0.183 (0.008)
-0.349 (0.018)
0.240 (0.021)
-2.530 (0.107)
0.050 (0.006)
-5.034
1.186

(0.033)
(0.079)

With Wal-Mart
Entry Times
Coeff.
S.E.
-13.092 (0.080)
-0.021 (0.003)
-0.042 (0.012)
0.183 (0.008)
-0.349 (0.019)
0.248 (0.021)
-2.544 (0.107)
0.051 (0.006)
-5.034
1.190

(0.033)
(0.079)

No Unobserved
Heterogeneity
Coeff.
S.E.
-12.698 (0.067)
-0.018 (0.003)
-0.054 (0.012)
0.193 (0.008)
-0.369 (0.018)
0.170 (0.021)

-5.030

(0.033)

Table 5: Counterfactual Simulations of Market Structure in Year 2014 With and Without Wal-Mart

61

Markets

Initial
Pop

Chain
Firms

Chain
Stores

Fringe
Stores

All Markets
Midwest
Northeast
South
West

205
58
22
83
42

176153
175371
205180
170856
172494

2.41
1.75
2.18
2.78
2.71

9.17
5.88
8.48
11.72
9.02

11.98
14.36
14.32
9.63
12.11

All Markets
Midwest
Northeast
South
West

205
58
22
83
42

176153
175371
205180
170856
172494

2.77
2.13
2.61
3.22
2.86

12.43
8.41
12.22
16.15
10.77

9.85
11.81
11.18
7.54
11.02

Wal-Mart Chain
Stores Share
With Wal-Mart
2.42 39.9%
2.07 27.3%
2.58 35.2%
2.85 49.1%
1.96 41.3%
Absent Wal-Mart
0.00 54.9%
0.00 42.0%
0.00 53.7%
0.00 66.9%
0.00 49.5%

Wal-Mart
Share

Fringe
Share

C1

C3

HHI

10.8%
9.9%
10.7%
12.1%
9.3%

49.4%
62.7%
54.1%
38.7%
49.4%

25.4%
21.7%
24.0%
29.1%
23.8%

48.1%
39.1%
45.3%
55.8%
46.6%

0.22
0.20
0.21
0.24
0.20

0.0%
0.0%
0.0%
0.0%
0.0%

44.6%
58.0%
46.3%
32.7%
48.8%

29.9%
27.6%
30.6%
33.2%
25.9%

55.7%
47.5%
55.4%
64.3%
50.2%

0.26
0.25
0.27
0.28
0.23

Table 6: Counterfactual Simulations of Changes in Market Structure Due to Wal-Mart’s Presence

Markets
205

Initial
Pop
176153

Wal-Mart
Stores
2.42

58
22
83
42

175371
205180
170856
172494

2.07
2.58
2.85
1.96

Small
Large

104
101

117740
236300

1.76
3.09

Slow
Moderate
Fast

54
46
105

178252
175444
175383

2.26
2.17
2.61

9
68
96
32

106248
127754
184404
273906

1.20
1.62
2.20
5.08

All Markets
Midwest
Northeast
South
West
62

More Negative
Negative
Zero
Positive

Chain
Stores
-26.3%

Fringe Chain
Stores
Share
21.6% -27.3%
By Region
-30.1% 21.6% -34.8%
-30.5% 28.1% -34.5%
-27.4% 27.7% -26.5%
-16.3%
9.9% -16.6%
By Market Size
-24.3%
7.0% -23.1%
-27.4% 30.0% -31.7%
By Growth Type
-35.8% 40.6% -36.5%
-38.9% 18.5% -38.3%
-17.4% 13.5% -18.6%
By Unobserved Type
-18.5% -17.2%
-6.7%
-15.9%
2.7% -17.9%
-27.8% 25.2% -31.1%
-30.5% 59.1% -33.7%

Fringe
Share
10.6%

C1
-15.0%

C3
-13.7%

HHI
-16.6%

8.1%
16.8%
18.7%
1.2%

-21.3%
-21.5%
-12.4%
-8.1%

-17.8%
-18.4%
-13.2%
-7.2%

-19.3%
-21.8%
-15.6%
-11.9%

5.0%
16.2%

-12.1%
-18.1%

-9.9%
-17.9%

-14.1%
-19.4%

24.3%
15.2%
1.0%

-22.3%
-16.3%
-10.1%

-21.0%
-17.6%
-8.4%

-23.8%
-9.7%
-14.9%

-6.2%
-2.5%
18.2%
40.6%

29.6%
-9.4%
-20.0%
-15.1%

27.3%
-5.5%
-19.2%
-17.8%

42.3%
-11.3%
-22.0%
-17.7%

Table 7: Counterfactual Simulations of Changes in Market Structure Absent Unobserved Heterogeneity
Wal-Mart
Stores
3.15

Chain
Stores
-33.2%

Midwest
Northeast
South
West

2.92
3.24
3.28
3.15

-38.4%
-35.8%
-32.3%
-28.6%

Large
Small

3.65
2.66

-30.5%
-37.5%

More Negative
Negative
Zero
Positive

2.22
2.71
3.24
4.07

-42.9%
-35.9%
-33.7%
-29.6%

All Markets

Fringe
Stores
7.3%

63

Chain Fringe
Share Share
-33.1%
9.0%
By Region
9.7% -41.5%
8.3%
7.0% -36.0%
9.7%
7.4% -29.8% 11.7%
3.4% -29.4%
3.9%
By Market Size
7.3% -29.6%
7.2%
7.1% -36.2% 11.5%
By Unobserved Type
15.6% -43.9% 13.1%
6.0% -36.9%
8.5%
6.7% -32.8%
7.6%
9.3% -24.4% 13.7%

C1
-12.9%

C3
-9.7%

HHI
-7.0%

-17.2%
-14.6%
-10.0%
-12.4%

-12.0%
-10.6%
-8.5%
-8.7%

-6.6%
-7.5%
-6.6%
-7.6%

-12.2%
-13.9%

-9.5%
-10.3%

-7.8%
-6.8%

-16.6%
-14.9%
-12.2%
-10.1%

-14.9%
-9.8%
-9.1%
-10.1%

-2.9%
-6.5%
-6.2%
-12.5%

Table 8: Temporal Evolution of Market Structure

64

Year
5
5
10
10
15
15
20
20

Market Size
Small
Large
Small
Large
Small
Large
Small
Large

WM Stores
0.58
0.87
1.06
1.76
1.45
2.52
1.76
3.09

Chain Stores
-6.8%
-10.0%
-13.7%
-16.8%
-19.5%
-22.3%
-24.3%
-27.4%

Fringe Stores
3.4%
5.2%
5.4%
12.8%
6.5%
21.3%
7.0%
30.0%

Chain Share
-7.9%
-9.9%
-14.3%
-18.3%
-19.4%
-25.6%
-23.1%
-31.7%

Fringe Share
-0.1%
2.9%
0.8%
6.6%
2.0%
11.1%
5.0%
16.2%

C1
-5.7%
-5.2%
-9.3%
-10.2%
-11.5%
-14.6%
-12.1%
-18.1%

C3
-6.3%
-7.5%
-9.2%
-12.0%
-10.3%
-15.2%
-9.9%
-17.9%

HHI
-9.9%
-10.1%
-14.3%
-15.6%
-15.4%
-18.2%
-14.1%
-19.4%

