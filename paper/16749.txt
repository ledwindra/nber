NBER WORKING PAPER SERIES

INSURANCE AND TAXATION OVER THE LIFE CYCLE
Emmanuel Farhi
IvÃ¡n Werning
Working Paper 16749
http://www.nber.org/papers/w16749

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2011

The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2011 by Emmanuel Farhi and IvÃ¡n Werning. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice,
is given to the source.

Insurance and Taxation over the Life Cycle
Emmanuel Farhi and IvÃ¡n Werning
NBER Working Paper No. 16749
January 2011
JEL No. H21
ABSTRACT
We consider a dynamic Mirrlees economy in a life cycle context and study the op- timal insurance
arrangement. Individual productivity evolves as a Markov process and is private information. We use
a first order approach in discrete and continuous time and obtain novel theoretical and numerical results.
Our main contribution is a formula describing the dynamics for the labor-income tax rate. When productivity
is an AR(1) our formula resembles an AR(1) with a trend where: (i) the auto-regressive coefficient
equals that of productivity; (ii) the trend term equals the covariance pro- ductivity with consumption
growth divided by the Frisch elasticity of labor; and (iii) the innovations in the tax rate are the negative
of consumption growth. The last prop- erty implies a form of short-run regressivity. Our simulations
illustrate these results and deliver some novel insights. The average labor tax rises from 0% to 46%
over 40 years, while the average tax on savings falls from 17% to 0% at retirement. We com- pare
the second best solution to simple history independent tax systems, calibrated to mimic these average
tax rates. We find that age dependent taxes capture a sizable fraction of the welfare gains. In this way,
our theoretical results provide insights into simple tax systems.

Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
efarhi@harvard.edu
IvÃ¡n Werning
Department of Economics
MIT
50 Memorial Drive, E51-251a
Cambridge, MA 02142-1347
and NBER
iwerning@mit.edu

Insurance and Taxation over the Life Cycle
Emmanuel Farhi

IvÃ¡n Werning

Harvard University

MIT

July 2010
Abstract
We consider a dynamic Mirrlees economy in a life cycle context and study the optimal insurance arrangement. Individual productivity evolves as a Markov process
and is private information. We use a first order approach in discrete and continuous
time and obtain novel theoretical and numerical results. Our main contribution is a
formula describing the dynamics for the labor-income tax rate. When productivity is
an AR(1) our formula resembles an AR(1) with a trend where: (i) the auto-regressive
coefficient equals that of productivity; (ii) the trend term equals the covariance productivity with consumption growth divided by the Frisch elasticity of labor; and (iii)
the innovations in the tax rate are the negative of consumption growth. The last property implies a form of short-run regressivity. Our simulations illustrate these results
and deliver some novel insights. The average labor tax rises from 0% to 46% over 40
years, while the average tax on savings falls from 17% to 0% at retirement. We compare the second best solution to simple history independent tax systems, calibrated
to mimic these average tax rates. We find that age dependent taxes capture a sizable
fraction of the welfare gains. In this way, our theoretical results provide insights into
simple tax systems.

1

Introduction

To a twenty five year old entering the labor market, the landscape must feel full of uncertainties. Will they land a good job relatively quickly or will they initially bounce from
one job to another in search of a good match? What opportunities for on-the-job training
and other forms of skill accumulation be they find? How well will they take advantage
of these opportunities? Just how good are they? How high will they rise? Will they advance steadily within a firm or industry, or be laid off and have to reinvent themselves
1

elsewhere? For all these reasons, young workers must find it challenging to predict how
much they will be making at, say, age fifty. More generally, they face significant uncertainty in their lifetime earnings.
This paper investigates the optimal design of a tax system that efficiently shares these
risks. With a few notable exceptions, since Mirrlees (1971), optimal tax theory has mostly
worked with a static model that treats heterogeneity and uncertainty symmetrically, since
redistribution can be seen as insurance behind the â€œveil of ignoranceâ€. More recently,
there has been growing interest in the special role of uncertainty and insurance. To date,
this more dynamic approach has focused on savings distortions, or considered special
cases, such as two periods or i.i.d. shocks.1 Little is known in more realistic settings about
the pattern of labor income taxes when uncertainty is gradually revealed over time.
This paper aims to fill this gap and address the following questions. How are the
lessons for labor income taxes from the static models (e.g. Mirrlees (1971), Diamond
(1998), Saez (2001), Werning (2007b)) altered in a dynamic context? How is taxation with
an insurance motive different from the redistributive motive? How does the optimal tax
system compare to simpler systems? Are the welfare gains from a more elaborate system
large? What lessons can we draw from the optimal tax structure for simpler tax systems?
We adapt the standard dynamic Mirrleesian framework to a life cycle context. Agents
live for T years. They work and consume for TE years and then retire, just consuming,
for the remaining TR = T âˆ’ TE periods. During their working years, labor supply in
efficiency units is the product of work effort and productivity. An agentâ€™s productivity
evolves as a persistent Markov process. Both effort and productivity are privately observed by the agent. The planner controls consumption and output, but cannot observe
productivity nor work effort. Due to this private information, allocations must be incentive compatible. We study constrained efficient allocations and characterize the implicit
marginal taxes or wedges implied by the allocation.
A direct attack on this problem is largely intractable, but we show that both theoretical
and numerical progress can be made by using a first-order approach. A similar approach
has proven useful in moral-hazard contexts with unobservable savings (see for example
Werning (2002)). Kapicka (2008) spells out the first-order approach for a Mirrleesian setting, which we implement here. The basic idea is to relax the problem by imposing only
local incentive constraints. Unlike the original problem, the relaxed problem has a recursive structure that makes it tractable. One can then check whether the solution to the
relaxed problem is incentive compatible, and, hence, a solution to the original problem.
1 See

for example Diamond and Mirrlees (1978); Farhi and Werning (2008b); Golosov, Kocherlakota, and
Tsyvinski (2003); Golosov, Tsyvinski, and Werning (2006); Albanesi and Sleet (2006).

2

We find it useful to work in both discrete and continuous time (and relate the two by
limiting arguments).
Our theoretical results are summarized by a novel formula for the dynamics of the
labor wedge Ï„L,t . Although we derive the formula for a general stochastic process for
productivity, it is most easily explained in the case where the logarithm of productivity
follows an AR(1) with coefficient of mean-reversion Ï:
log Î¸t+1 = Ï log Î¸t + (1 âˆ’ Ï) log Î¸Ì„ + Îµ t+1 .
We require utility to be additively separable between consumption and labor and an isoelastic disutility function for labor. We then obtain
Et








Ï„L,t+1
Ï„L,t
1
1
1
1
=Ï
+
+ 1 Covt log Î¸t+1 , 0
.
1 âˆ’ Ï„L,t+1 u0 (ct+1 )
1 âˆ’ Ï„L,t u0 (ct )
e
u ( c t +1 )

The first term captures mean-reversion and is simply the past labor wedge weighted by
the coefficient of mean-reversion Ï in productivity. In this sense, the labor wedge inherits
its degree of mean reversion from the stochastic process for productivity. The second
term is zero if productivity or consumption are predictable. In this case, if Ï = 1, the
formula specializes to a case of perfect tax-smoothing: the labor wedge remains constant
between periods t and t + 1. If instead Ï < 1, then the labor wedge reverts to zero at rate
Ï. When productivity and consumption are not predictable and are positively correlated,
the second term on the right hand side is positive, contributing to higher average taxes.
Intuitively, uncertainty in consumption creates a role for insurance, delivered by larger
taxes. The covariance captures the marginal benefit of more insurance. The marginal cost
depends on the elasticity of labor, which explains the role of the Frisch elasticity e.
We also show that there is a sense in which our conditional expectation formula accurately describes the realized path. To do so, we consider a continuous time limit where
productivity is a Brownian diffusion: d log Î¸t = âˆ’(1 âˆ’ Ï)(log Î¸t âˆ’ log Î¸Ì„ )dt + Ïƒt dWt , so that
Ï controls the degree of mean reversion as above. We study this continuous time model
directly and also approach it by taking the limit in the discrete time model. We show that


Ï„L,t+Ï„
1
1
= 0.
lim Vart
1 âˆ’ Ï„L,t+Ï„ u0 (ct+Ï„ )
Ï„ â†“0 Ï„
Thus, the conditional expectation above completely describes changes in

{ 1âˆ’Ï„LÏ„L u01(c) }

small intervals of time. In the limit, the process
instantaneous volatility (it is of bounded variation):
3

Ï„t
1
1âˆ’Ï„t u0 (ct )

over

is a diffusion that has no


d

Ï„L,t
1
0
1 âˆ’ Ï„L,t u (ct )



Ï„
1
+
= âˆ’(1 âˆ’ Ï) L,t
0
1 âˆ’ Ï„L,t u (ct )








1
1
+ 1 Covt d log Î¸t , d
dt.
e
u0 (ct )

The drift in the continuous time is essentially the counterpart of our conditional expectation formula. Thus, this equation states that there are no errors around the conditional
expectation. Of course, this does not mean that the entire process for { 1âˆ’Ï„LÏ„L u01(c) } is deterministic, since the drift itself may vary stochastically. It does imply that over short
Ï„
1
periods of time 1âˆ’L,t
Ï„L,t u0 (ct ) varies a lot less than productivity Î¸t .
Economically, this result is important because it describes a form of regressivity. When
productivity rises, consumption rises, so the marginal utility of consumption falls. The
labor wedge must then fall by the same amount, at least in the short run. This induces
a negative short-run relation between productivity and the labor wedge. This force for
regressive taxation is novel and due to the dynamic aspects of our model.
Finally, we extend the well-known zero taxation result at the top and bottom of the
productivity distribution.2 If the conditional distribution for productivity has a fixed support, then the labor wedge is zero at both extremes, just as in the static Mirrlees model.
However, in our dynamic model, a moving support may be more natural, with the top
and bottom, Î¸ t (Î¸tâˆ’1 ) and Î¸ t (Î¸tâˆ’1 ), being functions of the previous periodâ€™s productivity, Î¸tâˆ’1 . With a moving support, we establish that the labor wedge is no longer zero
at the top and bottom. An interesting example is when productivity is a geometric random walk, and innovations have a bounded support, the extremes Î¸ t (Î¸tâˆ’1 ) and Î¸ t (Î¸tâˆ’1 )
move proportionally with Î¸tâˆ’1 . In this case, the labor wedge at the top must be below
the previous periodâ€™s labor wedge. The reverse is true at the bottom: the labor wedge
must be higher than in the previous period. This result is consistent with the short-run
regressivity discussed in the previous paragraph. Note, however, that no limit argument
is required.
For our numerical exploration, we adopt a random walk for productivity. This choice
is motivated by two considerations. First, the evidence in Storesletten, Telmer, and Yaron
(2004) points to a near random walk for labor earnings, which requires a near random
walk for productivity. Second, by focusing on a random walk we are considering the
opposite end of the spectrum of the well explored i.i.d. case (Albanesi and Sleet, 2006).
Our findings both serve to illustrate our theoretical results and provide novel insights.
Indeed, although our numerical work is based the discrete time version of the model, with
a period modeled as a year, the simulations show that the continuous time provides an
2 The

result at the bottom requires labor to be positive.

4

excellent explanations of our findings.
We find that the average labor wedge starts near zero and increases over time, asymptoting to around 40% precisely at retirement. The intertemporal wedge displays the opposite pattern, with its average starting around 0.9%, corresponding to a 17% tax on net
interest, and falling to zero at retirement. Both results are easily explained by our theoretical formula. As retirement approaches the variance of consumption growth falls to zero,
for standard consumption smoothing reasons. Our formulas then indicate that the labor
wedge will rise over time and asymptote at retirement and that the intertemporal wedge
will reach zero at retirement.
Our tax system comes out to be slightly regressive in the sense that marginal tax rates
are higher for agents with currently low productivity shocks. Our short-run regressivity
result seems to explain at least part of this regressivity. However, it should be noted
that the tax system is progressive in the sense that average tax rates are increasing in
productivity.
The second-best allocation we have characterized can be implemented with taxes, but,
as is well known, it requires relatively elaborate, history-dependent tax instruments. We
wish to investigate how our results translate to simpler systems, restricted to being history independent. Do our theoretical results provide guidance for such real-world tax
systems? We find that they do: the second best turns out to be unexpectedly informative
in the design of simpler policies.
Specifically, we compute the equilibrium with history-independent linear taxes on labor and capital income, and consider both age-dependent and age-independent taxes.
When age-dependent taxes are allowed, we set the tax rate on labor or capital at a given
age equal to the average for that given age of the corresponding wedge in the simulated second best. Surprisingly, the welfare loss of such a system, relative to the second
best, is minusculeâ€”around 0.1% of lifetime consumption. By implication, the pattern
of tax rate we chose must be very close to optimal. In this way, our theoretical results
do provide guidance for more restrictive tax systems. When we solve the model with
age-independent tax rates, we optimize over the value of these tax rates. The results are
as follows. First, we find a more significant loss in welfare, of around 0.7% of lifetime
consumption. Age dependent tax rates are important in approaching the second best.
Second, when taxes are age independent, the optimal tax rate on capital comes out to be
essentially zero. This can be explained by the fact that a subsidy on capital helps imitate
the missing age-dependent taxes on labor. This new effect cancels the desire for a positive
tax on capital, obtained when more sophisticated taxes are allowed.

5

Related literature. Our paper contributes to the is the optimal taxation literature based
on models with private information (see Golosov, Tsyvinski, and Werning, 2006, and the
references therein). The case where shocks are i.i.d. has been extensively studied [see for
example Albanesi and Sleet (2006) and more recently Ales and Maziero (2009)]. Outside
of the i.i.d. case few undertake a quantitative analysis. Persistent shocks significantly
complicate the analysis. As emphasized by Fernandes and Phelan (2000), the efficient
allocations have a recursive structure, but the dimensionality of the state is proportional
to the number of possible shock values, severely limiting the possibilities for realistic
numerical analyses.34
This paper continues our efforts to quantify dynamic Mirrleesian models using more
realistic assumptions about uncertainty. In Farhi and Werning (2008a) and Farhi and
Werning (2009), our strategy was to focus on the welfare gains from savings distortions.
We presented a simple method to do so, which allowed us to consider rich stochastic processes and was tractable enough to apply in general equilibrium settings, which proved
to be important. However, these papers do not attempt anything regarding labor wedges,
which are the main focus of the present paper.
Versions of the first-order approach on which we rely in this paper have been studied in other papers. Werning (2002) introduced this approach in a moral-hazard setting
with unobservable savings to study optimal unemployment insurance with free-savings.
Pavan, Segal, and Toikka (2009) characterize necessary and sufficient conditions for the
first-order approach in very general dynamic environment. Williams (2008) studies a
continuous-time economy with hidden income that follows a Brownian motion. Garrett
and Pavan (2010) use a first-order approach to study managerial compensation. Kapicka
(2008) spells out the first-order approach for a general Mirrleesian setting with persistent
productivity shocks. He also simulates a simple example to illustrate the approach.5
Fukushima (2010) performs a numerical study of an overlapping generations economy, where each generation looks much like the ones in our model. He considers a special
class of Markov chains with two discrete shocks that allow for a low dimensional representation of the state space. For a planning problem that seeks to maximize steady-state
utility, he reports substantial welfare gains of the optimal tax system over a system combining a flat tax and an exemption. Golosov, Troshkin, and Tsyvinski (2010) use a first3 Two

exceptions are Golosov and Tsyvinski (2006) for disability insurance and Shimer and Werning
(2008) for unemployment insurance. In both cases, the nature of the stochastic process for shocks allows for
a low dimensional recursive formulation that is numerically tractable.
4 See also Battaglini and Coate (2008). See as well Tchistyi (2006) and Battaglini (2005) for applications in
a non-taxation context.
5 See also Abraham and Pavoni (2008) and Jarque (2008).

6

order approach to study a life-cycle economy with two periods and persistent shocks.
The goal of their paper is to calibrate the distribution of shocks in both periods using the
observed distribution of incomes, as Saez (2001) did for a single period in a static setting.6
An important implication of our results is that with persistent productivity shocks,
labor taxes should on average increase with age. Our theoretical formula provides the
underpinnings for this observation as well as insights into its origin; our numerical simulation explores its quantitative importance. This aspect of our contribution connects with
a prior contributions focusing on the benefits of age-dependent taxes.7 Most closely related to our paper are Kremer (2002) and Weinzierl (2008). Kremer (2002) emphasized
the potential benefits of age-dependent labor taxation, noting that the wage distribution
is likely to become more dispersed with age and conjectured that labor taxes should generally rise depend on age. Weinzierl (2008) provides a more comprehensive treatment.
He calibrates two- and three-period Mirrlees models. Like us, he finds important welfare
gains from age dependent taxes.

2

The Insurance Problem

This section first describes the economic environment and its planning problem. We then
explain our first order approach to solving this problem.

2.1

The Environment and Planning Problem

Preferences, Uncertainty and Information. The economy is populated by a continuum
of agents who live for T periods. Their ex ante utility is
E0

T

âˆ‘ Î² t âˆ’1 u t ( c t , y t ; Î¸ t ).

t =1

Here ct represents consumption, yt represents efficiency units of labor, and Î¸t âˆˆ Î˜ = [Î¸, Î¸Ì„ ]
is a state variable with conditional density f t (Î¸t |Î¸tâˆ’1 ). This state affects preferences over
consumption and labor in efficiency units and can capture both taste and productivity
fluctuations. In particular, an important case is when ut (c, y; Î¸ ) = uÌƒt (c, y/Î¸ ), for some
6 Both Kapicka (2008) and Golosov,

Troshkin, and Tsyvinski (2010) rely on exponential utility and special
shock specifications to make the problem tractable, by reducing the number of state variables.
7 Erosa and Gervais (2002) analyze age-dependent linear labor taxation in Ramsey setting. In their model,
optimal linear labor income taxes are indexed on age because the elasticity of labor supply varies, endogenously, with age.

7

utility function uÌƒt (c, n), defined over consumption and labor effort; then y = Î¸n and Î¸
can be interpreted as productivity.
We allow the utility function and the density to depend on the period t to be able to
incorporate life-cycle considerations. For example, an economy where agents work for TE
periods and then retire for TR periods can be captured by setting uÌƒ(c, y/Î¸ ) for t â‰¤ TE and
uÌƒ(c, 0) for TE < t â‰¤ T.
We make several smoothness assumptions. The utility function is twice continuously
differentiable and the density is continuously differentiable in its second argument. To
simplify the exposition, we start with the full support assumption that f t (Î¸ 0 |Î¸ ) > 0 for all
Î¸, Î¸ 0 âˆˆ Î˜.
The realization of the state Î¸t for all t = 1, 2, ..., T is privately observed by the agent. To
simplify and focus on the insurance motive, we assume that the initial state Î¸âˆ’1 is publicly
known. It is easy to introduce initial heterogeneity and private information with respect
to Î¸âˆ’1 , together with a redistributive motive.
More explicitly, an allocation is {c, y} â‰¡ {c(Î¸ t ), y(Î¸ t )} and utility is
T

U ({c, y}) â‰¡

âˆ‘Î²

t =1

t âˆ’1

Ë†

ut (c(Î¸ t ), y(Î¸ t ); Î¸t ) f t (Î¸t |Î¸tâˆ’1 ) f tâˆ’1 (Î¸tâˆ’1 |Î¸tâˆ’2 ) Â· Â· Â· f 1 (Î¸1 |Î¸0 )dÎ¸t dÎ¸tâˆ’1 Â· Â· Â· dÎ¸1

Incentive Compatibility. By the revelation principle, without loss of generality, we can
focus on direct mechanisms, where agents make reports rt âˆˆ Î˜ regarding Î¸t . For any
reporting strategy Ïƒ = {Ïƒt (Î¸ t )} we have a history of reports Ïƒt (Î¸ t ) = (Ïƒ1 (Î¸0 ), . . . , Ïƒt (Î¸ t ))
and a corresponding path {cÏƒ , yÏƒ } = {c(Ïƒt (Î¸ t )), y(Ïƒt (Î¸ t )}. Let Î£ denote the set of all
reporting strategies Ïƒ.
An allocation {c, y} is incentive compatible if and only if
U ({c, y}) â‰¥ U ({cÏƒ , yÏƒ })

âˆ€Ïƒ âˆˆ Î£,

so that truth telling Ïƒâˆ— = {Ïƒtâˆ— (Î¸ t )} with Ïƒtâˆ— (Î¸t ) = Î¸t , is optimal.
Planning Problem.
To keep things simple, we work in partial equilibrium, that is,
assuming a linear technology that converts labor into consumption goods one for one
and a linear storage technology with gross rate of return qâˆ’1 (and a net rate of return
equal to qâˆ’1 âˆ’ 1). This allows us to study the contracting problem for a single cohort in

8

isolation. The relevant cost of an allocation is then its expected net present value:
Î¨({c, y}) â‰¡

T

âˆ‘q

t âˆ’1

t =1

Ë†

(c(Î¸ t ) âˆ’ y(Î¸ t )) f t (Î¸t |Î¸tâˆ’1 ) Â· Â· Â· f 1 (Î¸1 |Î¸0 )dÎ¸t Â· Â· Â· dÎ¸1 .

An allocation {câˆ— , yâˆ— } is efficient if there is no other incentive compatible allocation {c, y}
with U ({c, y}) â‰¥ U ({câˆ— , yâˆ— }) and Î¨({c, y}) â‰¤ Î¨({câˆ— , yâˆ— }), with at least one strict inequality. Efficient allocations solve the following program.
Program IC.
K0 (v) â‰¡ min Î¨({c, y})
{c,y}

s.t. U ({c, y}) â‰¥ v
U ({c, y}) â‰¥ U ({cÏƒ , yÏƒ })

2.2

âˆ€Ïƒ âˆˆ Î£

A Recursive First-Order Approach

In this section, we lay down our first-order approach, and explain how it leads to a relaxed
version of Program IC. Previous papers using a similar approach include Werning (2002),
Kapicka (2008), Williams (2008), and Pavan, Segal, and Toikka (2009).
Let w(Î¸ t ) denote the equilibrium continuation utility after history Î¸ t . That is, w is the
unique solution solution to
Ë†
t

t

t

w(Î¸ t , Î¸t+1 ) f t+1 (Î¸t+1 |Î¸t )dÎ¸t+1

t

w ( Î¸ ) = u ( c ( Î¸ ), y ( Î¸ ), Î¸ t ) + Î²

(1)

for all t = 1, . . . , T with w(Î¸ T +1 ) â‰¡ 0. Incentive compatibility can be represented with
this notation as follows. For any strategy Ïƒ âˆˆ Î£, let continuation utility wÏƒ (Î¸ t ) solve
Ë†
Ïƒ

t

t

t

t

t

t

w (Î¸ ) = u (c(Ïƒ (Î¸ )), y(Ïƒ (Î¸ )), Î¸t ) + Î²

wÏƒ (Î¸ t , Î¸t+1 ) f t+1 (Î¸t+1 |Î¸t )dÎ¸t+1

with wÏƒ (Î¸ T +1 ) â‰¡ 0. Then incentive compatibility is equivalent to
Ë†

Ë†

1

w(Î¸1 ) f (Î¸1 |Î¸0 )dÎ¸1 â‰¥

wÏƒ (Î¸1 ) f 1 (Î¸1 |Î¸0 )dÎ¸1

for all Ïƒ âˆˆ Î£. This condition requires
w(Î¸ t ) â‰¥ wÏƒ (Î¸ t )

9

for almost all Î¸ t .
A Necessary Condition.
We now use this representation to sketch a derivation of a
necessary condition for incentive compatibility. We omit the full details of the argument
which have been derived by Pavan, Segal, and Toikka (2009).
For any incentive compatible allocation, consider the following one-shot deviation
from truth telling:
Ïƒs (Î¸ s ) = Î¸s

Î¸ s 6= Î¸ t

Ïƒt (Î¸ t ) = r
Thus, the agent reports truthfully until Î¸ t , then reports r and reverts back to truth telling
thereafter. Denote this strategy by Ïƒr . Continuation utility solves
r

t

t

w (Î¸ ) = u (c(Î¸

t âˆ’1

, r ), y ( Î¸

t âˆ’1

Ë†
, r ), Î¸ t ) + Î²

wr (Î¸ t+1 ) f t+1 (Î¸t+1 |Î¸t )dÎ¸t+1

Since truth telling is employed from t + 1 onwards we have that
wr (Î¸ t+1 ) = w(Î¸ tâˆ’1 , r, Î¸t+1 ).
Incentive compatibility requires
w(Î¸ t ) = max wr (Î¸ t ).
r

Putting the three conditions together yields
t

t

w(Î¸ ) = max{u (c(Î¸
r

t âˆ’1

, r ), y ( Î¸

t âˆ’1

Ë†
, r ), Î¸ t ) + Î²

w(Î¸ tâˆ’1 , r, Î¸t+1 ) f t+1 (Î¸t+1 |Î¸t )dÎ¸t+1 }

Differentiating and applying an envelope condition implies:
âˆ‚
w(Î¸ t ) = utÎ¸ (c(Î¸ t ), y(Î¸ t ), Î¸t ) + Î²
âˆ‚Î¸t

Ë†

w(Î¸ t+1 ) f Î¸tt+1 (Î¸t+1 |Î¸t )dÎ¸t+1

(2)

Equations (1)â€“(2) provide a set of necessary conditions for an allocation to be incentive
compatible. Pavan, Segal, and Toikka (2009) derive these conditions rigorously in a more
general setting.

10

It will be useful to collect these conditions and rewrite them as
w(Î¸ t ) = ut ( x (Î¸ t ), Î¸t ) + Î²v(Î¸ t )
âˆ‚
w(Î¸ t ) = utÎ¸ ( x (Î¸ t )), Î¸t ) + Î²âˆ†(Î¸ t )
âˆ‚Î¸t
where
Ë†
t

v(Î¸ ) â‰¡

Ë†

t

âˆ†(Î¸ ) â‰¡

w(Î¸ t+1 ) f t+1 (Î¸t+1 |Î¸t )dÎ¸t+1
w(Î¸ t+1 ) f Î¸tt+1 (Î¸t+1 |Î¸t )dÎ¸t+1

The Relaxed Planning Problem. Define C t (y, u, Î¸ ) denote the expenditure functionâ€”
the inverse of the utility function for consumption ut (Â·, y, Î¸ ). Let K denote the minimized
cost for the relaxed program that only imposes the necessary conditions derived above.
This function satisfies the following Bellman equation:
Program FOA.
Ë†
K (v, âˆ†, Î¸âˆ’ , t) = min

{C t (y(Î¸ ), w(Î¸ ) âˆ’ Î²v(Î¸ ), Î¸ ) âˆ’ y(Î¸ )
Ë†
+ q K (v(Î¸ ), âˆ†(Î¸ ), Î¸ 0 , t + 1) f t+1 (Î¸ 0 |Î¸ )dÎ¸ } f t (Î¸ |Î¸âˆ’ )dÎ¸
Ë†
v=
âˆ†=

Ë†

w(Î¸ ) f t (Î¸ |Î¸âˆ’ )dÎ¸
w(Î¸ ) f Î¸tâˆ’ (Î¸ |Î¸âˆ’ )dÎ¸

wÌ‡(Î¸ ) = utÎ¸ (C t (y(Î¸ ), w(Î¸ ) âˆ’ Î²v(Î¸ ), Î¸ ), y(Î¸ ), Î¸ ) + Î²âˆ†(Î¸ )
Verifying IC. Suppose that a solution to Program FOA has been computed. Then it is
a solution to Program IC if and only if the proposed allocation is incentive compatible.
One approach is to seek sufficient conditions on primitives that a priori guarantee that
this will be the case. A practical alternative, is to verify the incentive compatibility of any
candidate optimum. It turns out that doing so is relatively straightforward.
The solution to Program FOA yields policy functions that determine the allocation

11

recursively as a function of reports as follows
c t = g c ( v t , âˆ† t , r t âˆ’1 , r t , t )
y t = g y ( v t , âˆ† t , r t âˆ’1 , r t , t )
v t +1 = g v ( v t , âˆ† t , r t âˆ’1 , r t , t )
âˆ† t +1 = g âˆ† ( v t , âˆ† t , r t âˆ’1 , r t , t )
An agent takes these functions as a constraints in his optimal reporting problem, represented by the Bellman equation:
V (v, âˆ†, râˆ’ , Î¸, t) = max{ut ( gc (v, âˆ†, râˆ’ , r, t), gy (v, âˆ†, râˆ’ , r, t), Î¸ )
r
Ë†
+ Î² V ( gv (v, âˆ†, râˆ’ , r, t), gâˆ† (v, âˆ†, râˆ’ , r, t), r, Î¸ 0 , t + 1) f t+1 (Î¸ 0 |Î¸ )dÎ¸ 0 }
Let
gw (vt , âˆ†t , rtâˆ’1 , rt , t) = ut ( gc (vt , âˆ†t , rtâˆ’1 , rt , t), gy (vt , âˆ†t , rtâˆ’1 , rt , t), rt ) + Î²gv (vt , âˆ†t , rtâˆ’1 , rt , t)
represent the optimal value of w in the planning problem given states (vt , âˆ†t , rtâˆ’1 , rt t).
The proposed allocation is incentive compatible if and only if
V (v, âˆ†, râˆ’ , Î¸, t) = gw (v, âˆ†, râˆ’ , Î¸, t)
Plugging this condition into into the Bellman equation we obtain

Î¸ âˆˆ arg max{ut ( gc (v, âˆ†, râˆ’ , r, t), gy (v, âˆ†, râˆ’ , r, t), Î¸ )
r
Ë†
+ Î² gw (Î¸ 0 , gv (v, âˆ†, râˆ’ , r, t), gâˆ† (v, âˆ†, râˆ’ , r, t), r, t + 1) f t+1 (Î¸ 0 |Î¸ )dÎ¸ (3)
Interestingly, because we have the guess for the agentâ€™s value function, this verification does not require solving a dynamic optimization problem.
Initial Heterogeneity. We have interpreted the planning problem as confronting a single agent. However, it is simple to add heterogeneity to the analysis. Indeed, we can
interpret the first shock Î¸1 as initial heterogeneityâ€”recall that we allow the conditional
density to depend flexibly on the period t. If the social welfare function is Utilitarian,

12

then the analysis requires no change: insurance behind the veil of ignorance and utilitarian redistribution are equivalent. It is also possible to allow for a different social welfare
function, or to characterize the entire set of constrained Pareto-efficient allocations, by
treating the initial period in the planning problem differently.

3

Optimalityx Conditions

Given an allocation {c, y} , and a history Î¸ t , define the intertemporal wedge
Ï„K Î¸


t


 
utc c Î¸ t , y Î¸ t , Î¸t
q
= 1 âˆ’ Â´ t +1
Î² uc (c (Î¸ t+1 ) , y (Î¸ t+1 ) , Î¸t+1 ) f t+1 (Î¸t+1 |Î¸t ) dÎ¸t+1

and the labor wedge
Ï„L Î¸

t



â‰¡ 1+


 
uty c Î¸ t , y Î¸ t , Î¸t
utc (c (Î¸ t ) , y (Î¸ t ) , Î¸t )

.

In this section, we characterize these wedges for allocations that solve Programs IC and
FOA.

3.1

A Positive Intertemporal Wedge

Our first result restates the well-known inverse Euler condition. This result requires utility from consumption to be separable from the disutility of labor.
Assumption 1 For every t â‰¥ 0, the utility function ut (c, y, Î¸ ) is separable so that there exists
functions uÌ‚t and hÌ‚t such that ut (c, y, Î¸ ) = uÌ‚t (c) âˆ’ hÌ‚t (y, Î¸ ).
Proposition 1 Suppose that Assumption 1 holds and that {c, y} solves Program IC or Program
FOA. Then for every t â‰¥ 1 and history Î¸ tâˆ’1 , the following Inverse Euler equation holds
q
1
=
t
âˆ’
1
t
âˆ’
1
0
Î²
uÌ‚
(c (Î¸ ))

Ë†
uÌ‚t0

1
f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t
(c (Î¸ t ))

Î¸t

âˆ’1

and the intertemporal wedge satisfies
hÂ´ 
Ï„K (Î¸ tâˆ’1 ) = 1 âˆ’

uÌ‚t0
Â´

c

ft

(Î¸t |Î¸tâˆ’1 ) dÎ¸t

uÌ‚t0 (c (Î¸ t )) f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t

i âˆ’1
.

(4)

Note that this result holds for any allocation that solves both Program IC or Program
FOA and for any stochastic process for idiosyncratic shocks {Î¸ }. Applying Jensenâ€™s in13


equality to the second equation implies that the intertemporal wedge Ï„K Î¸ tâˆ’1 is positive.
In other words, positive savings distortions are present at the constrained optimum.

3.2

Labor Wedge Dynamics: Tax Smoothing and Mean Reversion

We now seek an optimality condition for the labor wedge. The following isoelastic assumption is useful for this purpose. It has been used to prove perfect tax-smoothing
results by Werning (2007a).
Assumption 2 Assumption 1 holds and the disutility of work is isoelastic hÌ‚t (y, Î¸ ) = (Îº/Î±) (y/Î¸ )Î±
with Îº > 0 and Î± > 1.
For any function Î , define
Ï†tÎ 

Ë†

( Î¸ t âˆ’1 ) â‰¡

Î  (Î¸t ) f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t .

We then have the following proposition.
Proposition 2 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA.
Consider a function Ï€ (Î¸ ) and let Î  (Î¸ ) be a primitive of Ï€ (Î¸ ) /Î¸. Then the labor wedge satisfies
the following equation for every t â‰¥ 1 and history Î¸ tâˆ’1
Ë†



Ï„L Î¸ t
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
Ï€ (Î¸t ) f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t
1 âˆ’ Ï„L (Î¸ t ) Î² uÌ‚t0 (c (Î¸ t ))
"
#


Ë†
Ï„L Î¸ tâˆ’1
dÏ†tÎ  (Î¸tâˆ’1 )
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
+ Î± Î  (Î¸t )
âˆ’ 1 f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t . (5)
Î¸ t âˆ’1
=
dÎ¸tâˆ’1
Î² uÌ‚t0 (c (Î¸ t ))
1 âˆ’ Ï„L (Î¸ tâˆ’1 )
The fact that
n
o equation (5) holds for all possible Ï€ (Î¸t ) imposes restrictions on the stochasÏ„L 1
tic 1âˆ’Ï„L uÌ‚t0 . We shall come back to this point later, especially in its continuous time
counterpart. For now, the case where Ï€ (Î¸ ) = 1 and Î  (Î¸ ) = log (Î¸ ) is of particular
interest.
Corollary 1 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA. Then

14

the labor wedge satisfies the following equation for every t â‰¥ 1 and history Î¸ tâˆ’1
Ë†



Ï„L Î¸ t
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t
1 âˆ’ Ï„L (Î¸ t ) Î² uÌ‚t0 (c (Î¸ t ))
"
#


Ë†
log
Ï„L Î¸ tâˆ’1
dÏ†t (Î¸tâˆ’1 )
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
+ Î± log (Î¸t )
Î¸ t âˆ’1
=
âˆ’ 1 f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t .
dÎ¸tâˆ’1
Î² uÌ‚t0 (c (Î¸ t ))
1 âˆ’ Ï„L (Î¸ tâˆ’1 )
(6)
log

To understand the role of Î¸tâˆ’1 dÏ†t
ized geometric AR(1) process:

(Î¸tâˆ’1 ) /dÎ¸tâˆ’1 in equation (6), consider the general-

log (Î¸t ) = Ï log (Î¸tâˆ’1 ) + Î¸Ì„t + Îµ t ,
where {Î¸Ì„t } is a deterministic sequence for the unconditional mean of Î¸t , and Îµ t are indeÂ´
pendent draws from a distribution gt (Îµ t , Î¸ tâˆ’1 ), normalized so that Îµ t gt (Îµ t , Î¸ tâˆ’1 )dÎµ t = 0.
log
Then Ï†t (Î¸tâˆ’1 ) = Ï log (Î¸tâˆ’1 ) + Î¸Ì„t so that
log

Î¸ t âˆ’1

dÏ†t

( Î¸ t âˆ’1 )

dÎ¸tâˆ’1

= Ï.

For this AR(1) specification, equation (6) can be written more compactly as
Et âˆ’1






Ï„L,tâˆ’1
Ï„L,t q uÌ‚tâˆ’10 (ctâˆ’1 )
q uÌ‚tâˆ’10 (ctâˆ’1 )
=Ï
+ Î±Covtâˆ’1 log(Î¸t ),
1 âˆ’ Ï„L,t Î² uÌ‚t0 (ct )
1 âˆ’ Ï„L,tâˆ’1
Î² uÌ‚t0 (ct )

Proposition 1 implies that
Et âˆ’1



(7)


q uÌ‚tâˆ’10 (ctâˆ’1 )
=1
Î² uÌ‚t0 (ct )

so the term (q/Î²) uÌ‚tâˆ’10 (ctâˆ’1 ) /uÌ‚t0 (ct ) on the left hand side of equation (7) represents a
change of measure.
Thus, we have a formula for the conditional expectation of Ï„L,t /(1 âˆ’ Ï„L,t ) under a riskadjusted probability measure. On the right hand side, Ï„L,tâˆ’1 /(1 âˆ’ Ï„L,tâˆ’1 ) is weighted by
the coefficient of mean-reversion Ï. In this sense, {Ï„L /(1 âˆ’ Ï„L )} inherits its degree of
mean reversion from the stochastic process for productivity. The second term provides a
drift for {Ï„L /(1 âˆ’ Ï„L )}.
It is useful to first consider the special cases where the drift is zero, which occurs when
consumption at t is predictable at t âˆ’ 1, so that Vartâˆ’1 (ct ) = 0. This would be the case if
the productivity level Î¸t were predictable at t âˆ’ 1, so that Vartâˆ’1 (Î¸t ) = 0. In this case, if
15

Ï = 1 equation (7) implies that the labor wedge remains constant between periods t âˆ’ 1
and t, a form of perfect tax-smoothing. When Ï < 1 the labor wedge reverts to zero at
rate Ï.8
The drift is positive whenever Vartâˆ’1 (Î¸t ) > 0 provided that consumption is increasing
in productivity. Compared to the case with Vartâˆ’1 (Î¸t ) = 0, the additional shocks to
productivity create an additional motive for insurance. This pushes the labor wedge up.
Interestingly, the size of the drift is precisely the covariance of the log of productivity
with the inverse growth rate in marginal utility, divided by 1/Î± = e/(1 + e), where
e is the Frisch elasticity of labor supply. The covariance captures the benefit of added
insurance, since it depends on the variability of consumption as well as on the degree
of risk aversion. Insurance comes at the cost of lower incentives for work. This effect is
stronger the more elastic is labor supply, explaining the role of the Frisch elasticity.
Returning to the more general statement in Proposition 2, equation (5) shares many
ingredients with equation (6). Note however that, in general,
Ë†

q uÌ‚tâˆ’10 c Î¸ tâˆ’1
Î² uÌ‚t0 (c (Î¸ t ))



Ï€ (Î¸t ) f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t

will not equal one, so that by contrast with equation (6), the right-hand side cannot be
interpreted as a risk-adjusted conditional expectation of the labor wedge in period t. An

other important case is Ï€ (Î¸t ) = ( Î²/q)uÌ‚t0 c Î¸ t /uÌ‚tâˆ’10 c Î¸ tâˆ’1 , so that equation (5)
provides a formula for the unadjusted conditional expectation for Ï„L,t /(1 âˆ’ Ï„L,t ). The
corresponding expression is somewhat more involved than equations (6) and (7). Rather
than develop the expression here, we present its neater continuous time counterpart in
Section 4.
Equations (5) and (6) hold for any allocation that solves Program FOA. They do not
necessarily hold for an allocation that solves Program IC when the two programs do not
coincide. Nevertheless, we are able to show that Proposition 2 applies with a particular
function Ï€ to any allocation that solves Program IC under the following assumption.
Assumption 3 The process {Î¸ } is a geometric random walk. That is, the growth rate Î¸t /Î¸tâˆ’1 is
independent of the history Î¸ tâˆ’1 .
8 These

special cases are consistent with the results in Werning (2007a), who studied a model where
agentâ€™s private types are fixed (similar to Vartâˆ’1 (Î¸t ) = 0 here). Productivity may still vary for each type,
due to changes in inequality or aggregate shocks. At the optimum, the tax rate is constant with respect
to aggregate shocks to productivity, but is an increasing function of the current degree of inequality. This
relates to the analysis here, since when Ï < 1 and Vartâˆ’1 (Î¸t ) = 0 we have a decreasing pattern for inequality
and the tax rate.

16

Proposition 3 Suppose that Assumptions 1, 2, and 3 hold, and that {c, y} solves Program IC.
Then the labor wedge satisfies equation (5) for every t â‰¥ 1 and history Î¸ tâˆ’1 with Ï€ (Î¸ ) = Î¸ âˆ’Î± .

3.3

Labor Wedge at the Top and Bottom

We now look at the labor wedge for the two extreme realizations of Î¸t , top and bottom.
As we shall see, when the support for current productivity is independent of previous
productivity then standard zero-distortion results apply. However, it is important to consider the more general case of a moving support, where the upper and lower bounds,
Î¸ t (Î¸tâˆ’1 ) and Î¸ t (Î¸tâˆ’1 ) vary with Î¸tâˆ’1 . We assume Î¸ t (Î¸tâˆ’1 ) and Î¸ t (Î¸tâˆ’1 ) are differentiable.
For short, we often simply write Î¸ t and Î¸ t leaving the dependence on Î¸tâˆ’1 implicit.
The only modification to Program FOA is that âˆ† now incorporates two terms to capture the movements in the support:
Ë†
âˆ†=

Î¸ t (Î¸âˆ’ )
Î¸ t (Î¸âˆ’ )

w (Î¸ ) f Î¸tâˆ’ (Î¸, Î¸âˆ’ ) dÎ¸ +



dÎ¸ t
dÎ¸ t
w Î¸ t f t Î¸ t |Î¸âˆ’ âˆ’
w (Î¸ t ) f t (Î¸ t |Î¸âˆ’ ) .
dÎ¸âˆ’
dÎ¸âˆ’

Propositions 1, 2 and 3 extend without modification to the case of moving support.
Proposition 4 Consider an interior allocation that solves Program FOA:
i. if for a history Î¸ tâˆ’1 , dÎ¸ t /dÎ¸tâˆ’1 = dÎ¸ t /dÎ¸tâˆ’1 = 0, then
Ï„L Î¸ tâˆ’1 , Î¸ t
1 âˆ’ Ï„L


Ï„L Î¸ tâˆ’1 , Î¸ t
 =
= 0;
1 âˆ’ Ï„L (Î¸ tâˆ’1 , Î¸ t )
Î¸ t âˆ’1 , Î¸ t


ii. suppose that Assumptions 1 and 2 hold, then for every history Î¸ tâˆ’1
Ï„L Î¸ tâˆ’1 , Î¸ t



Ï„L Î¸ tâˆ’1
Î² uÌ‚t0 c Î¸ tâˆ’1 , Î¸ t Î¸âˆ’ dÎ¸ t
 =
,
1 âˆ’ Ï„L (Î¸ tâˆ’1 ) q uÌ‚tâˆ’10 (c (Î¸ tâˆ’1 )) Î¸ t dÎ¸tâˆ’1
1 âˆ’ Ï„L Î¸ tâˆ’1 , Î¸ t



Ï„L Î¸ tâˆ’1 , Î¸ t
Ï„L Î¸ tâˆ’1
Î² uÌ‚t0 c Î¸ tâˆ’1 , Î¸ t Î¸âˆ’ dÎ¸ t
=
.
1 âˆ’ Ï„L (Î¸ tâˆ’1 , Î¸ t )
1 âˆ’ Ï„L (Î¸ tâˆ’1 ) q uÌ‚tâˆ’10 (c (Î¸ tâˆ’1 )) Î¸ t dÎ¸tâˆ’1


With a fixed support, the no-distortion results from the static model extend to our dynamic setting. However, when the support is not fixed the labor wedge after an extreme
realization is the product of the labor wedge in the previous period times the growth
rate of marginal utility, and the elasticity of the corresponding bound of the support with
respect to Î¸tâˆ’1 . For example, in the case where {Î¸ } is a geometric random walk with
bounded innovations, the elasticity of the bounds with respect to Î¸tâˆ’1 is equal to one.
17

In this case, provided that consumption c(Î¸ tâˆ’1 , Î¸t ) is increasing in Î¸t , the Inverse Euler



equation implies: Ï„L Î¸ tâˆ’1 , Î¸ t â‰¤ Ï„L Î¸ tâˆ’1 â‰¤ Ï„L Î¸ tâˆ’1 , Î¸ t . The fact that the tax rate may
go both up or down illustrates a form of tax smoothing.

3.4

A Regressivity Result

In Section 4, we develop a continuous time formulation of Program FOA when the stochastic process for productivity follows a Brownian diffusion, and we use continuous time
stochastic control to analyze this program. In this section, instead, we perform an analysis in discrete time, but taking the limit as the period length shrinks to zero. We show
that, in the limit, the quantity (1/uÌ‚t0 (ct ))(Ï„L,t /(1 âˆ’ Ï„L,t )) does not vary unpredictably,
in response to productivity shocks. In this sense, the conditional expectation formula in
equation (6) provides a very accurate prediction for this variable over short intervals of
time.
Let Ï„ be the length of a period. Instead of indexing periods by t = 1, 2, 3 . . . we now
take t = Ï„, 2Ï„, 3Ï„, . . . We assume that Î¸t+Ï„ is log normally distributed so that
log

log Î¸t+Ï„ âˆ¼ N (log Î¸t + Âµt (Î¸t ), Ïƒt2 )

(8)

We set the parameters of our model to scale as follows with Ï„:
Î²=e

âˆ’ÏÏ„

, q=e

âˆ’ÏÏ„

,

log
Âµt (Î¸t )


âˆš
1 2
= Ï„ ÂµÌ‚t (Î¸t ) âˆ’ Î¸t ÏƒÌ‚t , Ïƒt = ÏƒÌ‚t Ï„
2


(9)

for some constants Ï > 0, some function of time and productivity ÂµÌ‚t (Î¸t ) and some function of time ÏƒÌ‚t . To simplify, we assume here that q = Î².
log
The definition for Âµt contains an adjustment term âˆ’Ï„ 21 Î¸t ÏƒÌ‚t2 to ensure that Et [Î¸t+Ï„ ] =
Î¸t eÏ„ ÂµÌ‚t (Î¸t ) . Thus, ÂµÌ‚t (Î¸t ) can be interpreted as the (instantaneous) conditional expected
growth rate in productivity, per unit of time. In the limit as Ï„ â†’ 0, it is well known
that there exists a Brownian motion Wt such that the stochastic process {Î¸ } converges to
the continuous time diffusion dÎ¸t /Î¸t = ÂµÌ‚t (Î¸t ) dÎ¸t + ÏƒÌ‚t dWt . This is the limit that we study
directly in Section 4.
Assumption 4 The stochastic process {Î¸ } satisfies (8)â€“(9).
Proposition 5 Suppose that Assumptions 1, 2, and 4 hold, and that {c, y} solves Program FOA.

18

Then for every t and history Î¸ t , then, conditional (on Î¸ t )
âˆ‚
plim
Ï„ â†’0 âˆ‚Î¸t+Ï„

!

Ï„L Î¸ t , Î¸t+Ï„
1
= 0,
1 âˆ’ Ï„L (Î¸ t , Î¸t+Ï„ ) uÌ‚t0 (c (Î¸ t , Î¸t+Ï„ ))

where plimÏ„ â†’0 denotes the probability limit (conditional on Î¸ t ).
1
For short period lengths, this result implies that the unpredictable changes in 1âˆ’L,t
Ï„L,t uÌ‚t0 (ct )
are small
h relative to ithose in Î¸t . As a result, the conditional variance per unit of time
Ï„L,t+Ï„
1
1
Ï„ Vart 1âˆ’Ï„L,t+Ï„ u0 (ct+Ï„ ) is small and vanishes as Ï„ â†’ 0. Another implication is that unpredictable changes in Ï„L,t /(1 âˆ’ Ï„L,t ) must mirror those in the marginal utility uÌ‚t0 (ct ). This
induces a negative conditional covariance between productivity and the labor wedge.
Economically, this represents a form of regressivity: good productivity shocks lower both
the marginal utility of consumption and the current labor wedge by the same amount, at
least in the short run.
To make this result more palatable, note that
Ï„


Ï„L Î¸ t
1
Î¸t
1
= t0
âˆ’  t .
t
0
t
t
t
uÌ‚ (c (Î¸ )) hÌ‚0 y(Î¸ )
1 âˆ’ Ï„L (Î¸ ) uÌ‚ (c (Î¸ ))
Î¸t
The first-best allocation has both terms, 1/uÌ‚t0 (ct ) and Î¸t /hÌ‚0 (yt /Î¸t ), constant over time.
This is not possible at the constrained-efficient allocation. However, although 1/uÌ‚t0 (ct ) is
not constant, the Inverse Euler equation implies that its changes are unpredictable. Somewhat intuitively, our result implies that changes in Î¸t / hÌ‚0 (yt /Î¸t ) should track changes in
1/uÌ‚t0 (ct ) in an attempt to stabilize the difference.
Why should this be the case? Consider an allocation {c, y} that satisfies the constraints
of Program FOA, a history Î¸ t , and two numbers Îµ and Îµ. Consider the following perturbed

allocation cÎ´,Ï„ , yÎ´,Ï„ , which differs from the original allocation {c, y} only at histories
âˆš 
âˆš 
Î¸ t , Î¸t + Îµ Ï„ and Î¸ t , Î¸t + Îµ Ï„ :

âˆš 
âˆš 
âˆš Î±
hÌ‚ yÎ´,Ï„ Î¸ t , Î¸t + Îµ Ï„ = hÌ‚ y Î¸ t , Î¸t + Îµ Ï„ âˆ’ Î¸t + Îµ Ï„ Î´,

âˆš 
âˆš 
t
Î´,Ï„
t
uÌ‚ c
Î¸ , Î¸t + Îµ Ï„ = uÌ‚t c Î¸ t , Î¸t + Îµ Ï„ âˆ’ Î´,

19

and


Î´,Ï„

hÌ‚ y

uÌ‚t cÎ´,Ï„

âˆš 
âˆš 
âˆš Î±
Î¸ , Î¸t + Îµ Ï„ = hÌ‚ y Î¸ t , Î¸t + Îµ Ï„ + Î¸ + Îµ Ï„ Î´,
âˆš 
âˆš 
Î¸ t , Î¸t + Îµ Ï„ = uÌ‚t c Î¸ t , Î¸t + Îµ Ï„ + Î´.
t



The change in the cost of the allocation Î¨ cÎ´,Ï„ , yÎ´,Ï„ âˆ’ Î¨ ({c, y}) from this perturbation is proportional to Î´. Using the identity uÌ‚t01(c) âˆ’ 1 01 y = 1âˆ’Ï„LÏ„L uÌ‚t01(c) , the constant of
Î¸ hÌ‚

proportionality can be expressed as

(Î¸)

âˆš 
âˆš 
Ï„L Î¸ t , Î¸t + Îµ Ï„
Ï„L Î¸ t , Î¸t + Îµ Ï„
1
1

 âˆ’

âˆš
âˆš  .
âˆš
âˆš
1 âˆ’ Ï„L Î¸ t , Î¸t + Îµ Ï„ uÌ‚t0 c Î¸ t , Î¸t + Îµ Ï„
1 âˆ’ Ï„L Î¸ t , Î¸t + Îµ Ï„ uÌ‚t0 c Î¸ t , Î¸t + Îµ Ï„
If this perturbation were feasible, then we should set this expression to zero and conclude
that a stronger form of Proposition 5 holds.
This argument is heuristic and incomplete, because the perturbed allocation {cÎ´,Ï„ , yÎ´,Ï„ }
is not feasible: it delivers the same utility as {c, y}, but does not preserve the local incentive constraints of Program FOA. However, this basic perturbation can be modified to
preserve these constraints. The key to our result is that the corrections are of order Ï„,
âˆš
âˆš
while the distance between the two productivity levels Î¸t + Îµ Ï„ and Î¸t + Îµ Ï„ at which
âˆš
we perturb the allocation is of order Ï„, so we obtain

âˆš 
Ï„L Î¸ t , Î¸t + Îµ Ï„
1
âˆš  t0
âˆš 
t
t
1 âˆ’ Ï„L Î¸ , Î¸t + Îµ Ï„ uÌ‚ c Î¸ , Î¸t + Îµ Ï„

âˆš 
Ï„L Î¸ t , Î¸t + Îµ Ï„
1
âˆš  t0
âˆš  + O(Ï„ ),
=
t
t
1 âˆ’ Ï„L Î¸ , Î¸t + Îµ Ï„ uÌ‚ c Î¸ , Î¸t + Îµ Ï„

which implies our result. In addition to a proof based on optimal control, the appendix
contains a rigorous version of this more constructive perturbation argument, which provides a second proof to Proposition 5.

4

A Continuous Time Approach

In this section, we formulate Program FOA in continuous time and tackle this program
using continuous time stochastic control. We assume that the stochastic process for pro-

20

ductivity is a Brownian diffusion with deterministic volatility:
dÎ¸t
= ÂµÌ‚t (Î¸t )dÎ¸t + ÏƒÌ‚t dWt
Î¸t

(10)

or equivalently that
log

d log Î¸t = ÂµÌ‚t (Î¸t )dÎ¸t + ÏƒÌ‚t dWt ,
where {W } is a Brownian motion, ÂµÌ‚t is a function of current productivity Î¸t which controls the drift of productivity, ÏƒÌ‚t is deterministic function of time which determines the
log
volatility of productivity, and ÂµÌ‚t (Î¸âˆ’ ) = ÂµÌ‚t (Î¸âˆ’ ) âˆ’ 12 Î¸âˆ’ ÏƒÌ‚t2 . We assume that the rate of
time preferences and the instantaneous interest rates are both equal to Ï > 0 (this can be
easily generalized to separate the two).
To formulate Program FOA in continuous time, we need to determine the laws of
motions for âˆ†t and vt . Our approach here is to work with Assumption 4 and take the
continuous time limit of the discrete time model.9
Â´
We start with âˆ†t . Integrate âˆ†t = wt+Ï„ f Î¸tt (Î¸t+Ï„ |Î¸t ) dÎ¸t+Ï„ by parts, using Lemma 2 in
the appendix, to obtain an expression for f Î¸tt (Î¸t+Ï„ |Î¸t ). Using Âµt (Î¸t ) = Ï„ (ÂµÌ‚t (Î¸t ) âˆ’ 21 Î¸t ÏƒÌ‚t2 )
we obtain
!
Ë†
log


d
ÂµÌ‚
Î¸t âˆ†t =
Î¸t+Ï„ utÎ¸+Ï„ + eâˆ’ÏÏ„ Î¸t+Ï„ âˆ†t+Ï„ 1 + Î¸t Ï„ t
f t (Î¸t+Ï„ |Î¸t ) dÎ¸t+Ï„ .
dÎ¸t
This implies that in the continuous time limit, we can write
log

"

dÂµÌ‚
d (Î¸t âˆ†t ) = Ï âˆ’ Î¸t t
dÎ¸

#

(Î¸t âˆ†t ) âˆ’ Î¸t utÎ¸ + ÏƒÌƒâˆ†,t ÏƒÌ‚t Î¸t dWt

for some function ÏƒÌƒâˆ†,t of the state variables (vt , âˆ†t , Î¸t , t). Applying Itoâ€™s lemma, we infer
that {âˆ†} solves the following stochastic differential equation:
"
dâˆ†t =

log

dÂµÌ‚
Ï âˆ’ ÂµÌ‚t âˆ’ Î¸t t
dÎ¸

!

#

âˆ†t âˆ’ utÎ¸ âˆ’ Ïƒâˆ†,t ÏƒÌ‚t dt + Ïƒtâˆ† ÏƒÌ‚t dWt ,

(11)

where Ïƒâˆ†,t = ÏƒÌƒâˆ†,t âˆ’ âˆ†t .
Turning now to vt , note that the definition of vt as the net present value of utility
implies that {v} solves a differential equation of the form dvt = Ïvt dt âˆ’ ut dt + Ïƒv,t Ïƒt dWt
9 It is also possible to start with the model in continuous time and derive the relevant first order approach

versions of the incentive constraints from scratch.

21

for some function Ïƒv,t of the state variables (vt , âˆ†t , Î¸t , t). Finally, in the continuous time
limit, the constraint wÌ‡ (Î¸ ) = Î¸utÎ¸ + Î²Î¸âˆ† (Î¸ ) simply amounts to the requirement that the
sensitivity of continuation utility to productivity changes be Ïƒv,t = Î¸t âˆ†t . Therefore, {v}
solves the following differential equation:
dvt = Ïvt dt âˆ’ ut dt + Î¸t âˆ†t ÏƒÌ‚t dWt .

(12)

Having re-expressed the constraints in Program FOA as stochastic differential equations for the state variables, we can now write down the Hamilton-Jacobi-Bellman (HJB)
equation for the cost function K (vt , âˆ†t , Î¸t , t). The states are (vt , âˆ†t , Î¸t , t) with laws of motion given by equations (12), (11), and (10). The controls are (ct , yt , Ïƒâˆ†,t ). The HJB equation
is
log
i
h


dÂµÌ‚ 
[ct âˆ’ yt ] + Kv Ïvt âˆ’ ut + Kâˆ† Ï âˆ’ ÂµÌ‚t âˆ’ Î¸t t âˆ†t âˆ’ Ïƒâˆ†,t ÏƒÌ‚t âˆ’ utÎ¸
ct ,yt ,Ïƒâˆ†,t
dÎ¸
1
1
1
1
2
2
+ KÎ¸ Î¸t ÂµÌ‚t + Kt + Kvv Î¸t2 âˆ†2t ÏƒÌ‚t2 + Kâˆ†âˆ† Ïƒâˆ†,t
ÏƒÌ‚t2 + Kvv Î¸t2 âˆ†2t ÏƒÌ‚t2 + Kâˆ†âˆ† Ïƒâˆ†,t
ÏƒÌ‚t2
2
2
2
2

1
2 2
2
2
2
2
+ KÎ¸Î¸ Î¸ ÏƒÌ‚t + Kvâˆ† Î¸t âˆ†t Ïƒâˆ†,t ÏƒÌ‚t + KvÎ¸ Î¸t âˆ†t ÏƒÎ¸ + Kâˆ†Î¸ Î¸t Ïƒâˆ†,t ÏƒÌ‚t .
2

ÏK = max



It will prove convenient to introduce the dual variables of (vt , âˆ†t ) : Î»(vt , âˆ†t , Î¸t , t) =
Kv (vt , âˆ†t , Î¸t , t) and Î³(vt , âˆ†t , Î¸t , t) = Kâˆ† (vt , âˆ†t , Î¸t , t).
Proposition 6 Suppose that Assumptions 1 and 2 hold, and that productivity evolves according
to equation (10). Then:
i. There exists a function ÏƒÎ» (vt , âˆ†t , Î¸t , t) such that the stochastic processes for {Î»} and {Î³}
verify the following stochastic differential equations
dÎ»t
= ÏƒÎ»,t ÏƒÌ‚t dWt
Î»t
"

(13)

dÎ³t = âˆ’Î¸t Î»t ÏƒÎ»,t ÏƒÌ‚t2 +

log

dÂµÌ‚
ÂµÌ‚t + Î¸t t
dÎ¸

!

#
Î³t dt + Î³t ÏƒÌ‚t dWt ,

with Î³0 = 0.
ii. Consumption ct and output yt can be computed as follows:
1
uÌ‚t0 (c

t)

= Î»t

1

and

uÌ‚t0 (c
22

t)

âˆ’

Î¸t
Î³t
= âˆ’Î± .
Î¸t
t /Î¸t )

ht0 (y

(14)

iii. The labor and intertemporal wedges, Ï„L,t and Ï„K,t , can be computed as follows:
Ï„L,t
Î³t 1
= âˆ’Î±
1 âˆ’ Ï„L,t
Î»t Î¸t

and

2 2
Ï„K,t = ÏƒÎ»,t
ÏƒÌ‚t .

Part (i) may be used as follows. If the functions Î»(vt , âˆ†t , Î¸t , t) and Î³(vt , âˆ†t , Î¸t , t) can
be inverted for (vt , âˆ†t ), then an alternative state space is (Î»t , Î³t , Î¸t , t). In this case, we can
write ÏƒÎ» (Î»t , Î³t , Î¸t , t). Equations (13)â€“(14) then provide the evolution of these alternative
state variables. Part (ii) and (iii) then offer a way to compute the allocation and wedges
as a function of (Î»t , Î³t , Î¸t , t).
Combining parts (i) and (iii) leads to the following corollary.
Corollary 2 Suppose that Assumptions 1 and 2 hold, and that productivity evolves according to
equation 10. Then the labor wedge verifies the following stochastic differential equation

d Î»t

Ï„L,t
1 âˆ’ Ï„L,t



"

= Î±Î»t ÏƒÎ»,t ÏƒÌ‚t2 + Î»t

log
dÂµÌ‚t

Ï„L,t
Î¸t
1 âˆ’ Ï„L,t
dÎ¸t

#
dt.

(15)

This result is the continuous time extension
5. A bit more can be said
o
n of Proposition
Ï„L
here, because in continuous time the process Î» 1âˆ’Ï„L is a diffusion. The fact that it has
zero instantaneous volatility implies that the realized paths will vary much less than those
for productivity {Î¸ }, in the sense that they are (a.s.) of bounded variation.
Combining (5) with (15) and applying Itoâ€™s lemma, yields the following formula:

d

Ï„L,t
1 âˆ’ Ï„L,t



#
log
d
ÂµÌ‚
Ï„
Ï„L,t
Ï„
L,t
L,t
2 2
= Î±ÏƒÎ»,t ÏƒÌ‚t2 +
Î¸t t +
ÏƒÎ»,t
ÏƒÌ‚t dt âˆ’
Ïƒ ÏƒÌ‚t dWt . (16)
1 âˆ’ Ï„L,t
dÎ¸
1 âˆ’ Ï„L,t
1 âˆ’ Ï„L,t Î»,t
"

This is the continuous time counterpart of equation (5) with the particular weighting func

tion Ï€ (Î¸t ) = ( Î²/q)uÌ‚t0 c Î¸ t /uÌ‚tâˆ’10 c Î¸ tâˆ’1 .10 It describes the dynamics for { 1âˆ’Ï„LÏ„L }
with the original, unadjusted probability. Unlike equation (5) which focuses on the conditional expectation, this equation describes not only the drift, but also the volatility of
{ 1âˆ’Ï„LÏ„L }.
The drift of { 1âˆ’Ï„LÏ„L } contains the elements discussed after Proposition 2 (the covariance
Ï„
2 2
and auto-regressive term) and a new term given by 1âˆ’L,t
Ï„L,t ÏƒÎ»,t Ïƒt . One can interpret the term
2 ÏƒÌ‚2 as an instantaneous mean reversion coefficient. In this sense, this stochasâˆ’Î¸t ddÎ¸ÂµÌ‚t âˆ’ ÏƒÎ»,t
t
10 Corollary

2 also sheds light on the general discrete time formula in equation (5). Indeed, for any twice
Ï„
differentiable function Ï€ (Î¸t ), one can apply Itoâ€™s lemma to infer the drift of Ï€t Î»t 1âˆ’L,t
Ï„L,t and obtain a continuous time counterpart of equation (5).

23

tic process features less mean-reversion than productivity. The higher is the variance of
consumption growth, the larger is the discrepancy.
It is also possible to rearrange this equation as

d

Ï„L,t
1 âˆ’ Ï„L,t



log

"

dÂµÌ‚
Ï„L,t
= Î±ÏƒÎ»,t ÏƒÌ‚t2 +
Î¸t t
1 âˆ’ Ï„L,t
dÎ¸

#

Ï„L,t
dt +
Î»t d
1 âˆ’ Ï„L,t



1
Î»t



.

This version shows explicitly how the innovations in the labor wedge must be perfectly
1
mirrored by those in the marginal utility of consumption uÌ‚t0 (ct ) = Î»âˆ’
t . This formulation
neatly highlights the regressivity result alluded to in subsection 3.4.
It may seem surprising that we obtain a regressivity result in our dynamic model,
especially in light of the absence of such a result in a static setting. As is well understood,
the skill distribution is key in shaping the tax schedule in the static model (Mirrlees (1971);
Diamond (1998); Saez (2001)). In contrast, in our dynamic model, the regressivity result
holds for a large class of productivity processes.
It is important to stress what this regressivity result does and does not say. Over
short horizons, it induces a negative conditional correlation between consumption and
the labor wedge. However, whether or not this translates into a negative correlation over
longer horizons depends on the evolution of the drift term. In particular, the endogenous
volatility term ÏƒÎ»,t may play a central role. We investigate these dynamics more explicitly
in Section 6.
Using part (iii) in Proposition
6, we can solve for the volatility ÏƒÎ»,t in terms of the
âˆš
Ï„K,t
intertemporal wedge: ÏƒÎ»,t = ÏƒÌ‚t to rewrite these last three equations in terms of the
labor and intertemporal wedges. In this way, optimality can be seen as imposing a joint
restriction on the labor and intertemporal distortions.
We close by noting the key role played by the endogenous volatility process {ÏƒÎ» } in all
these equations. Firstly, it represents the loading of consumption changes on productivity
innovations. Higher values for ÏƒÎ»,t provide more incentives at the expense of insurance.
Secondly, by part (i) in Proposition 6, it essentially summarizes the entire allocation by determining the evolution of the alternative endogenous states (Î»t , Î³t ). Finally, it is featured
prominently in the equations describing the labor and savings wedges. It pins down the
Ï„L
2 ÏƒÌ‚2 of the savings wedge Ï„
2
value ÏƒÎ»,t
K,t and scales the drift Î±Î»t ÏƒÎ»,t ÏƒÌ‚t of { Î» 1âˆ’Ï„L }. Section 6
t
exploits the fundamental role of {ÏƒÎ» } to interpret our numerical findings.

24

5

General Preferences

In this section, we investigate what can be said for general utility functions ut (c, y, Î¸ ). It
is well known that when consumption and labor are not additively separable, the Inverse
Euler condition does not necessarily holdâ€”we lose Proposition 1 . However, as we show
next, we still can make progress generalizing Corollary 1 .
Recall that the expenditure function C t (y, u, Î¸ ) is the inverse of ut (Â·, y, Î¸ ). Define
Î·t (y, w, Î¸ ) â‰¡

t ( y, w, Î¸ )
âˆ’Î¸CyÎ¸

Cyt (y, w, Î¸ )

.

Since Cyt = âˆ’uty /utc = | MRSt | = 1 âˆ’ Ï„L,t is the marginal rate of substitution, Î·t represents
d log | MRS |

the elastiticity âˆ’ d log Î¸t t . It plays a key role below. Note that in the separable isoelastic utility case (Assumptions 1â€“2) that we studied above, this elasticity is constant with
Î·t (y, w, Î¸ ) = Î±.
Discrete Time. In order to generalize equation (6), we need to introduce the dual of the
variable v(Î¸ t ) defined by
Î» ( Î¸ t ) â‰¡ K v ( v ( Î¸ t ), âˆ† ( Î¸ t ), Î¸ t , t + 1).
At an optimum, we have the martingale relation
Î»(Î¸

t âˆ’1

q
)=
Î²

Ë†

Î» Î¸ t f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t .

Below we adopt the shorthand notation of writing xt (Î¸t ) for any function xt (c(Î¸ t ), y(Î¸ t ), Î¸t )
(see Î·t and utc below).
Proposition 7 Suppose that {c, y} solves Program FOA. Then the labor wedge satisfies the following equation for every t â‰¥ 1 and history Î¸ tâˆ’1
Ë†




log
Ï„L Î¸ tâˆ’1
Ï„L Î¸ t
dÏ†t (Î¸tâˆ’1 )
q utc Î¸ tâˆ’1 t
1
1
f (Î¸t |Î¸tâˆ’1 ) dÎ¸t =
Î¸ t âˆ’1
Î·t (Î¸ t ) 1 âˆ’ Ï„L (Î¸ t ) Î² utc (Î¸ t )
dÎ¸tâˆ’1
Î·tâˆ’1 (Î¸ tâˆ’1 ) 1 âˆ’ Ï„L (Î¸ tâˆ’1 )
"
#

Ë†
t
q Î» Î¸
âˆ’ 1 f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t . (17)
+ utc (Î¸ tâˆ’1 )Î»(Î¸ tâˆ’1 ) log (Î¸t )
Î² Î» ( Î¸ t âˆ’1 )

This proposition generalizes equation (6). The martingale relation satisfied by Î»(Î¸ t )
implies that we can rewrite the second term on the right-hand side of equation (17) as a
25

q

covariance: Covtâˆ’1 (log(Î¸t ), Î² Î»Î»tâˆ’t 1 ). Note that we could also generalize equation (5) along
the exact same lines.
There are two important differences between equations (6) and (17). First, note that
q
unless utility is separableâ€”Assumption 1 holdsâ€”we no longer have Î² Î»(Î¸ t ) = ut (1Î¸ t ) . As a
c

t
t âˆ’1
q u (Î¸ )
is no longer a martingale and, by contrast with equation (6), the term Î² cut (Î¸ t )
result,
c
cannot be interpreted as a change of measure.
Ï„ (Î¸ t )
Ï„ (Î¸ t )
Second, note that Î· (1Î¸ t ) 1âˆ’LÏ„ (Î¸ t ) replaces 1âˆ’LÏ„ (Î¸ t ) . When Assumptions 1 and 5 hold,
t
L
L
Î·t = Î±, we can multiply through by Î±, as in equation (6). Otherwise, the general equation
indicates that changes in the elasticity should affect the labor wedge. To elaborate on
this point, it will prove convenient to specialize the discussion to a class of generalized
isoelastic preferences for which equation (17) takes a simpler form.

1
utc (Î¸ t )

Assumption 5 For every
t â‰¥ 0, there exists
functions uÌƒt , uÌ‚t , and constants Îºt > 0, Î±t > 1, such



y Î±
that ut (c, y, Î¸ ) = uÌƒt uÌ‚t (c) âˆ’ Î±Îºtt Î¸ t .
For this class of preferences, we have Î·t (y, w, Î¸ ) = Î±t .
Corollary 3 Suppose that Assumption 5 holds and that {c, y} solves Program FOA. Then the
labor wedge satisfies the following equation for every t â‰¥ 1 and history Î¸ tâˆ’1
Ë†




log
Ï„L Î¸ tâˆ’1
Ï„L Î¸ t
dÏ†t (Î¸tâˆ’1 )
q utc Î¸ tâˆ’1 t
Î±t
Î¸ t âˆ’1
f (Î¸t |Î¸tâˆ’1 ) dÎ¸t =
1 âˆ’ Ï„L (Î¸ t ) Î² utc (Î¸ t )
Î±tâˆ’1 1 âˆ’ Ï„L (Î¸ tâˆ’1 )
dÎ¸
"
# t âˆ’1

Ë†
q Î» Î¸t
+ Î±t utc (Î¸ tâˆ’1 )Î»(Î¸ tâˆ’1 ) log (Î¸t )
âˆ’ 1 f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t . (18)
Î² Î» ( Î¸ t âˆ’1 )

Other things being equal, we see that increases in Î±t (decreases in the Frisch elasticdÏ†

log

(Î¸

)

ity of labor supply) increase the autoeregressive coefficient Î±Î±tâˆ’t 1 Î¸tâˆ’1 tdÎ¸ tâˆ’1 of the labor
t âˆ’1
wedge. In other words, a decrease in the Frisch elasticity of labor supply tends to increase
the labor wedge. This is a manifestation of a standard inverse elasticity principle: other
things equal, labor is taxed more in periods in which it is less elastic.
Continuous Time. Our continuous time analysis can also be extended to general preferences. In particular, we can generalize equation (19).
Proposition 8 Suppose that productivity evolves according to equation (10). Then the labor
wedge satisfies the following stochastic differential equation

26


d

Ï„L,t 1 1
1 âˆ’ Ï„L,t utc Î·t



log

"

Ï„L,t 1 1 dÂµÌ‚t
Î¸t
= Î»t ÏƒÎ»,t ÏƒÌ‚t2 +
1 âˆ’ Ï„L,t utc Î·t
dÎ¸t

#
(19)

dt.

This expression is the continuous time analogue of equation (17). Note that our noÏ„
1 1
volatility result generalizes: the stochastic process 1âˆ’L,t
Ï„L,t utc Î·t has zero instantaneous volatility so that its realized paths will vary much less than those for productivity {Î¸ }, in the
sense that they are (a.s.) of bounded variation. Equation (19) takes a simple and illuminating form when preferences are in the generalized isoelastic class defined by Assumption
5.
Corollary 4 Suppose that Assumption 5 holds and that productivity evolves according to equation (10). Then the labor wedge satisfies the following stochastic differential equation

d

Ï„L,t 1
1 âˆ’ Ï„L,t utc



"

Ï„L,t 1
= Î±t Î»t ÏƒÎ»,t ÏƒÌ‚t2 +
1 âˆ’ Ï„L,t utc

log

dÂµÌ‚
1 dÎ±t
Î¸t t +
dÎ¸t
Î±t dt

!#
dt.

(20)

Equation (20) clearly shows how a time-varying Frisch elasticity of labor supply imÏ„
1
pacts the autoregressive coefficient of 1âˆ’L,t
Ï„L,t utc . Increases in Î±t (decreases in the Frisch elasticity of labor supply) tend to increase the labor wedge.
We can also derive a generalization of equation (16)

d

Ï„L,t
1 âˆ’ Ï„L,t



log

"

Ï„L,t 1
= Î±t Î»t ÏƒÎ»,t ÏƒÌ‚t2 +
1 âˆ’ Ï„L,t utc

dÂµÌ‚
1 dÎ±t
Î¸t t +
dÎ¸t
Î±t dt

!#
dt +


Ï„L,t 1
t
d
u
.
c
1 âˆ’ Ï„L,t utc

This shows explicitly how innovations in the labor wedge must be perfectly mirrored by
those in the marginal utility of consumption utc .

6

The Model At Work: A Numerical Solution

In this section we parametrize the model and solve it numerically. This serves to illustrate
some of our theoretical results, but also leads to some new insights.
A Life Cycle Economy. Agents live for T = 60 years, working for 40 years and then
retiring for 20 years. Their period utility function is
log(ct ) âˆ’

Îº  yt Î±
Î± Î¸

27

with Î± > 1 and Îº > 0 during working years t = 1, 2, . . . 40 and
log(ct )
during retirement t = 41, 42, . . . , 60. We set Î± = 3 implying a Frisch elasticity for labor of
0.5, and Îº = 1. We set the agentâ€™s and plannerâ€™s discount factors equal to each other at
q = Î² = 0.95.
For productivity, we follow Storesletten, Telmer, and Yaron (2004). They estimate earnings to fit an AR(1) plus white noise.11 The coefficient of auto correlation is very close to
one, leading them to adopt a geometric random walk:
Î¸ t = Îµ t Î¸ t âˆ’1 ,
2

with log Îµ âˆ¼ N (âˆ’ ÏƒÌ‚2 , ÏƒÌ‚2 ). We truncate the normal distribution: the density of log Îµ is
proportional to the density of the normal over a finite interval [Îµ, ÎµÌ„]. We adjust ÏƒÌ‚2 so that
Var(log Îµ) = 0.0161 the value reported in Storesletten, Telmer, and Yaron (2004) for the
variance of the log changes in earnings.
Under these conditions, the value function satisfies
K (v, âˆ†, Î¸âˆ’ , t) = Î¸âˆ’ K (v âˆ’ (1 + Î² + Â· Â· Â· + Î² T âˆ’t ) log Î¸âˆ’ , Î¸âˆ’ âˆ†, 1, t).
This holds because if {ct , yt } is feasible given (v, âˆ†, Î¸âˆ’ ) and has cost k, then, due to balanced growth preferences, it follows that {Ï†ct , Ï†yt } is feasible given (v + (1 + Î² + Â· Â· Â· +
Î² T âˆ’t ) log Ï†, Ï†âˆ’1 âˆ†, Ï†Î¸âˆ’ ) and costs Ï†k. Setting Ï† = 1/Î¸âˆ’ then yields the desired property
for K. A similar homogeneity condition holds for the policy functions. These properties
reduce the dimensionality of our problem.
After computing policy functions, we iterate on them to produce a Montecarlo simulation with 1 million agents evolving through periods t = 1, 2, . . . , T. For any given v1 ,
we initialize âˆ†1 at t = 1 to minimize cost
âˆ†1 âˆˆ arg min K (v1 , âˆ†, 1, 1).
âˆ†

We set the initial value for utility v1 so that the resulting cost is zero, K (v1 , âˆ†1 , 1, 1) = 0.
11 Storesletten,

Telmer, and Yaron (2004) estimate earnings, not wages or productivity. calibrating the
productivity process with the earnings process is an approximation. Ass we discuss below, in logs, earnings
are linear in productivity at the first best solution as well as in autarky.

28

Two Benchmarks. Before discussing the results of our simulations, it is useful to consider two benchmark allocations, those corresponding to autarky and the first best.
Consider first an autarkic situation, where there are no taxes. Agents can consume
their own production. They can neither borrow nor save. Thus, they solve the static
maximization: maxy u(y, y; Î¸ ). With logarithmic utility, or more generally with balanced
growth preferences, this implies ct = yt = Î¸t nÌ„ for some constant level of work effort, defined by the solution to uc (nÌ„, nÌ„; 1) = âˆ’uy (nÌ„, nÌ„; 1). Consumption and output are geometric
random walks: ct = Îµctâˆ’1 and yt = Îµytâˆ’1 . The labor wedge is zero and the inter-temporal
wedge is a positive constant equal to 1 âˆ’ Rq = 1 âˆ’ RÎ² > 0, where R â‰¡ Î²âˆ’1 (E 1Îµ )âˆ’1 .12
Consider next the first-best planning problem given by:
max E0
{c,y}

T

âˆ‘ u(ct , yt ; Î¸t )

s.t.

t =1

E0

T

âˆ‘ qt (ct âˆ’ yt ) â‰¤ e,

t =1

for some constant e âˆˆ R, representing outside resources available to the planner. The optimum features perfect insurance, with constant consumption ct = cÌ„ and constant marginal
disutility of work, implying
Î±  1
Î± âˆ’1
yt =
Î¸t
.
Îº cÌ„
Output is increasing in productivity, with Frisch elasticity 1/(Î± âˆ’ 1) > 0. Both the labor
and intertemporal wedges are zero.
Findings from Simulation. Within each period t, we compute the average in the cross
section for a number of variables of interest, such as consumption, output, and the labor and intertemporal wedges. During retirement each agentâ€™s consumption is constant,
while output and wedges are zero. Thus, we focus on the working periods t = 1, 2, . . . , 40.
Although our simulations are for the discrete time model, with a period representing a year, our results from the continuous time version turn out to provide an excellent explanation for our findings. In particular, Proposition 6 shows that the optimum is
summarized by the volatility process {ÏƒÎ» }, since this determines the laws of motion for
wedges, consumption and output. With logarithmic utility, the instantaneous variance of
2 ÏƒÌ‚2 . Figure 1 panel (b) plots the average variance of
consumption growth is given by ÏƒÎ»,t
12 Alternatively,

in the case with no retirement, this allocation can also be sustained as an equilibrium
where q = Râˆ’1 (instead of q = Î²) and agents can freely save and borrow. The intertemporal wedge in
this latter case is zero. This serves to make the point that the sign of the intertemporal wedge is somewhat
uninteresting, because it depends on the value of various parameters, including q. Another way to proceed
is to define autarky as allowing agents to borrow and save at rate q, in which case all wedges are zero by
definition, but, unless there is no retirement and q = Râˆ’1 , we would be unable to solve the equilibrium in
closed form.

29

0.01
0.008

0.4

0.006
0.2

0.004
0.002

0

10

20

30

0

40

(a) Average labor wedge

10

20

30

40

(b) Intertemporal wedge (blue) and variance of
consumption growth (green)

Figure 1: Average wedges over time
consumption growth in our simulation Vart [ct+1 /ct ]. This is the discrete time counterpart
2 ÏƒÌ‚2 .
of ÏƒÎ»,t
As the figure shows, the average variance of consumption growth falls over time and
reaches zero at retirement. There are two key forces at play. First, as retirement nears,
productivity shocks have a smaller effect on the present value of earnings, since they
affect earnings for fewer periods. Since consumption is smoothed over the entire lifetime,
including retirement, the impact of shocks on consumption falls and approaches zero at
retirement. This is the usual permanent income mechanism. Indeed, this property would
be present at an equilibrium with no taxes and free savings. Second, as we show below,
the labor wedge is increasing over time. This provides increased insurance, in the sense
of lowering the effect of productivity shocks on net earnings.
The decreasing pattern towards zero in the average variance of consumption growth
will be key in understanding a number of results presented below.
Turning to the wedges, panel (a) in Figure 1 shows that the labor wedge starts near
zero and increases over time, asymptoting around 46% at retirement. Panel (b) displays
the intertemporal wedge, which displays the reverse pattern. It is decreasing over time,
starting around 1%â€”which represents an implicit tax on net interest of around 17%â€”
and falling to zero at retirement.13 Both of these findings are easily explained by our
theoretical results, together with the behavior of the average variance of consumption
growth.
As shown in equations (7) and (16), when Ï = 1, the expected change in the labor
13 To

put these magnitudes in perspective, recall that the intertemporal wedge represents an implicit tax
on the gross rate of return to savings. In this interpretation, agents perceive a gross interest of (1 âˆ’ Ï„K,t )(1 +
r ) instead of (1 + r ), where 1 + r = qâˆ’1 . An equivalent reduction in the gross interest rate can be obtained
by an implicit tax Ï„Ì‚K,t on net interest r given by 1 + (1 âˆ’ Ï„Ì‚K,t )r. Setting, 1 + (1 âˆ’ Ï„Ì‚K,t )r = (1 âˆ’ Ï„K,t )(1 + r )
gives Ï„Ì‚K,t = 1+r r Ï„K,t . In our case, q = 0.95, so that 1+r r â‰ˆ 1r â‰ˆ 20.

30

1.1

1
0.8

1

0.6

0.9

0.4
0.2

0.8
10

20

30

0

40

(a) Average for output (blue) and consumption (green)

10

20

30

40

(b) Variance of output (green), productivity
(blue) and consumption (red)

Figure 2: Statistics for optimal allocation over time
tax is proportional to the covariance of consumption growth with the log of productivity,
which is positive, in order to provide incentives. This explains the increasing pattern in
the average wedge. The covariance equals ÏƒÎ»,t ÏƒÌ‚2 in the continuous time limit. Then, since
2 ÏƒÌ‚2 decreases over time to zero, so does Ïƒ ÏƒÌ‚2 , explaining the asymptote in the labor
ÏƒÎ»,t
Î»,t
wedge at retirement.
As for the intertemporal wedge, equation (4) implies that it is increasing in the uncertainty of consumption growth, in the sense that a mean-preserving spread leads to an
increase in the wedge. In the continuous time limit the intertemporal wedge equals the
2 ÏƒÌ‚2 . Indeed, although panel (b) plots both
variance of consumption growth: Ï„K,t = ÏƒÎ»,t
the variance of consumption growth and the intertemporal wedge, the two are indistinguishable to the naked eye. More generally, while we simulate the discrete time version
of the model, with a period representing a year, the continuous time formulas turn out to
provide excellent approximations for our findings.
Figure 2 shows the evolution over time for the cross-sectional means and variances of
the allocation. Panel (a) shows that average consumption is perfectly flat. This is expected
given the Inverse Euler condition, which with logarithmic utility is (q/Î²)Etâˆ’1 [ct ] = ctâˆ’1 .
Output, on the other hand, is mostly decreasing, consistent with the increasing pattern in
the labor wedge.14
Panel (b) shows the cross-sectional variance for consumption, productivity and output. The variance of productivity grows, by assumption, linearly. The variance of output
14 Note that average output can also be affected by the increasing dispersion in productivity.

For example,
in a first best solution, output would be proportional to Î¸tÎ±âˆ’1 . When Î± < 2 this function is concave inducing
a decreasing pattern. The reverse is true when Î± > 2. In our case Î± = 2 so the increasing dispersion in
productivity would not have an effect on average output at the first best solution. An autarkic solution,
without taxes and where agents consume their current output (i.e. with no savings or with q set at a level
that induces no savings), would feature constant output regardless of the value of Î±.

31

0.5
0.5

Ï„40

Ï„20

0.4
0.3
0.2
0.2

0.4
0.3

0.3

0.4

0.2
0.2

0.5

Ï„19

0.3

0.4

0.5

Ï„39

Figure 3: Scatter of Ï„L,t vs. Ï„L,tâˆ’1
is higher and grows in a convex manner. The variance of consumption, on the other hand,
it lower than the variance of productivity and grows in a concave manner. For reference,
note that in autarky, with no taxes and no savings, since c = y âˆ¼ Î¸, the variance for
consumption, output and productivity are equal to each other. At the other end of the
1

spectrum, the first best solution has zero variance in consumption and since yt âˆ¼ Î¸tÎ±âˆ’1 .
the variance for output is higher than that of productivity and grows in a convex manner.
The plannerâ€™s solution, in contrast, partially insures productivity shocks and lies between
these two benchmarks.
The degree of insurance is nicely illustrated by the lower variance of consumption,
relative to that of output and productivity. Over time, the variance for consumption rises,
and does so in a concave fashion. Recall that consumption is a martingale, which implies
that inequality must rise. As we discussed above, over time the variance in consumption
growth falls and reaches zero at retirement, explaining the concave shape.
Figure 3 illustrates the intertemporal labor wedge formula by showing scatter plots of
the current labor wedge against the previous periodâ€™s labor wedge. In period t = 20, the
average relationship is close to linear with a slope near one and lies above the 45 degree
line. Both of these properties are consistent with our formula in equation (7). The average
tax in the current period lies slightly above the previous periodâ€™s, illustrating the positive
drift in taxes.
In the last working period, t = 40, the scatter plot shows an almost perfect relationship
between the previous tax and the current one, with a slope of one. Taxes on labor are almost perfectly smoothed near retirement. Recall that the variance of consumption growth
drops to zero as retirement approaches. This explains why the average relationship is
essentially the 45 degree line. The reason there is no dispersion around the average relationship is an implication of the results in Sections 4 and 3.4 that show that unpredictable
changes in the labor wedge are related to unpredictable changes in marginal utility. Near
32

0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.1

Figure 4: Scatter of

0.2

0.3

0.4

Ï„L,t
0
1âˆ’Ï„L,t u ( ct )

0.5

against

0.6

0.7

0.8

Ï„L,tâˆ’1
0
1âˆ’Ï„L,tâˆ’1 u ( ctâˆ’1 )

for t = 20.

retirement, consumption becomes almost perfectly predictable, so the labor wedge does
as well.
Ï„L,tâˆ’1
Ï„
0
0
To illustrate this point further, Figure 4 plots 1âˆ’L,t
Ï„L,t u ( ct ) against 1âˆ’Ï„L,tâˆ’1 u ( ctâˆ’1 ) for t =
20. The average relationship is slightly above the 45 degree line and the dispersion around
this relationship is minimal. This illustrates the results in Sections 3.4 and 4, that there is
no instantaneous volatility in { 1âˆ’Ï„LÏ„L u01(c) }. In other words, unpredictable changes in the
labor wedge { 1âˆ’Ï„LÏ„L } are entirely explained by unpredictable changes in the reciprocal of
marginal utility { u01(c) }.
Figure 5 panel (a) plots the current periodâ€™s labor wedge Ï„L,t against the productivity
Î¸t for period t = 20. On average, tax rates are higher for agents with low productivity.
In this sense, the tax system is regressive. What accounts for this finding? In a static
setting, it is well known that the pattern of taxes is dependent, among other things, on
the distribution of productivity shocks (Diamond, 1998; Saez, 2001). We have assumed
a log-normal distribution for the productivity shocks. In our dynamic context, however,
it is less obvious whether this particular choices is responsible for the regressive pattern
we find. Indeed, the results in Sections 3.4 and 4 point towards a negative correlation
between the labor wedge and productivity, at least in the short run.
The figure also shows that, for any given level of current productivity, there is significant dispersion in the labor wedge. If the labor wedge were solely a function of current
productivity, then there would be no dispersion. Thus, this dispersion illustrates the history dependence in the labor wedge. Recall that the allocation and wedges depend on the
history of shocks as summarized by our two state variables v and âˆ†.
It is important to keep in mind, that a history independent tax system, with a fixed
non-linear tax schedule that allows for savings, can also produces a history dependent labor wedge. The history of productivity shocks affects savings decisions. The accumulated
wealth, in turn, affects the current labor choice, determining the position, and marginal
tax rate, along the fixed non-linear tax schedule.
33

0.5

30
25

0.4

20
15

0.3

10
0.2

0

0.5

1

1.5

2

5

2.5

(a) Scatter of Ï„L,t vs. Î¸t at t = 20

5

10
(b) Scatter of

15

20

âˆ‘tT=1 qt ct

vs.

25

30

âˆ‘tT=1 qt yt

Figure 5: History dependence and Insurance
Figure 5 panel (b) gets at a measure of the overall degree of insurance by plotting
the realized present value of consumption âˆ‘tT=1 qtâˆ’1 ct against the present value of output
âˆ‘tT=1 qtâˆ’1 yt in the simulation. Without taxes there is no insurance and âˆ‘tT=1 qtâˆ’1 ct would
vary one for one with âˆ‘tT=1 qtâˆ’1 yt . Insurance makes the present value of consumption
âˆ‘tT=1 qtâˆ’1 ct vary less than one for one with the present value of income âˆ‘tT=1 qtâˆ’1 yt . The
scatter shows that at the optimum there is a near linear relationship, with a slope around
0.67. For reference, a linear tax with a rate of 33% would produce an exact linear relationship with this slope.
We have performed some comparative statics and welfare analysis which we report
briefly now.
A fundamental parameter in our exercise is the degree of uncertainty. Unfortunately,
empirical estimates for the earnings process vary quite substantially, due to differences
in methodologies, econometric specifications and data sets. In addition, an important
consideration is the degree to which agents have better information than the econometrician, allowing them to forecast future earnings and productivity better. This suggests that
agents face lower uncertainty than what is implied by the available empirical estimates.
Motivated by these considerations, we solved for an economy with lower uncertainty,
with the same parameters as our baseline, but with the standard deviation ÏƒÌ‚2 = 0.0061.
The results show the same qualitative patterns as the benchmark. Quantitatively, both
the labor and intertemporal wedges are lower, with the labor wedge peaking at 30% and
the intertemporal wedge starting at 0.45%â€”which represents an implicit tax on net interest of around 9%. With lower uncertainty the optimum features lower insurance and
distortions. These results are consistent with our formulas, which stress the role that the
degree of uncertainty, captured by ÏƒÌ‚, has in determining both the labor and intertemporal
wedges.

34

0.01
0.008

0.4

0.006
0.2

0.004
0.002

0

10

20

30

0

40

(a) Labor wedge

10

20

30

40

(b) Intertemporal wedge

Figure 6: Impulse response to shock at t = 20.
Labor Wedge Dynamics: An Impulse Response. The scatter of the labor wedge at t
against the labor wedge at t âˆ’ 1 shown above illustrates the average short-run dynamics
implied by our formula. Here, we wish to zoom in more and see how these dynamics play
out over longer horizons. To this end, we follow an agent with a productivity realization
given by Îµ t = F âˆ’1 (1/2) for t 6= 20 and Îµ 20 = F âˆ’1 (0.95). We compare this to an agent with
Îµ t = F âˆ’1 (1/2) for all t = 1, 2, . . . , 40. We plot the evolution of the labor wedge, and other
variables, for these two agents. The difference can be interpreted as the impulse response
to a shock at t = 20.
Figure 6 shows the evolution of the wedges for these two realizations. Without a
shock, the wedges behaves similarly to the averages shown in Figure 1. In contrast, with
the shock, we see a downward jump on impact in the labor wedge (consumption, not
shown, jumps upward). After the shock, the labor wedge displays a higher rate of growth.
In the figure, the labor wedge remains below the path for the no-shock scenario. This feature is not general: we have found that for other values of Î»0 , the path with a shock
may jump below but eventually cross and overtake the path without a shock. The higher
growth rate in the labor wedge may be enough to over come the initial jump downward.
But why does the labor wedge grow faster after a shock? Panel (b) displays a partial answer: the intertemporal wedge jumps up on impact, due to an increase in the variance of
consumption growth. Our formulas indicate that this increases the drift term in the labor
wedge. Why does the variance of consumption growth rise? Intuitively, due to partial
insurance, the shock raises consumption by less than productivity. As a result, the agent
becomes poorer, relatively speaking, and, hence, more susceptible to the fluctuations in
productivity.
Welfare. We now compute the welfare gains relative to a situation with no taxes. Our
baseline is a market equilibrium without taxes, where agents can save and borrow freely
35

second-best
first-best

ÏƒÌ‚2 = 0.0161
3.43%
13.04%

ÏƒÌ‚2 = 0.0061
0.86%
5.20%

Table 1: Welfare gains over free-savings, no-tax equilibrium.
in a risk-free asset with rate of return qâˆ’1 . This allocation is easily solved backwards
starting at retirement by using the agentâ€™s first-order conditions, with zero wedges, and
the budget constraints.
In Table 1 , we report the welfare gains for the second best, the solution to Program
FOA, and the first-best, the optimum with publicly observable productivity. The numbers represent the constant percentage increase, at all dates and histories, in the baseline
consumption required to achieve the same utility as the alternative allocation. The first
column corresponds to our benchmark value for the conditional variance of productivity
ÏƒÌ‚2 , while the second reports a simulation with half this value. As expected, the welfare
gains increase with ÏƒÌ‚2 .
Comparison with Simple Policies.
The second best requires sophisticated historydependent taxes. If these are not available, how do our results inform us about simpler,
history-independent ones? In welfare terms, how well can simpler policies do? These are
the questions we explore next.
To this end, we consider history-independent taxes. To simplify the analysis and aid
the interpretation, we further restrict taxes to be linear. Since the second best features an
important age pattern for taxes, we consider both age-dependent and age-independent
taxes.
Optimizing over age dependent taxes is not very tractable numerically, due to the
large number of tax variables and the cost of computing the equilibrium for each tax
arrangement. In this case, instead of optimizing, we take a hint from the second-best
to formulate a sensible choice: we set the tax rates at each age to their cross-sectional
averages in the second-best. In contrast, with age-independent taxes there are just two
variables, so the problem is numerically tractable. In this case, we compute the optimal
age-independent tax rates. There are also intermediate cases, such as age-dependent taxes
on labor combined with an age-independent capital tax. In this case, we set the labor tax
rates to the corresponding cross-sectional averages in the second-best, but optimize over
the constant capital tax rate.
Table 2 below reports the welfare gains over the zero-tax allocation of various simple
policies. These are comparable to the numbers in Table 1 . Although we perform the
36

age-dependent Ï„L and Ï„K
age-dependent Ï„L , and Ï„K = 0
age-dependent Ï„L , age-independent Ï„K
age-independent Ï„L and Ï„K

ÏƒÌ‚2 = 0.0161
3.30%
3.16%
3.29%
2.71%

ÏƒÌ‚2 = 0.0061
0.71%
0.66%
0.70%
0.54%

Table 2: Welfare from simple tax policies.
exercises for two values of ÏƒÌ‚, since the findings are qualitatively similar in both cases, we
will focus our discussion on our benchmark reported in the first column.
The first row reports welfare for an age-dependent linear tax system, where tax rates at
each age are set to the cross-sectional average obtained from the second-best simulation.
It is surprising just how well this relatively simple policy performs. It delivers a welfare
gain of 3.30% in lifetime consumption, compared to the 3.43% obtained by the second
best. Remarkably, age-dependent linear taxes deliver 96% of the welfare gains of the
second-best.
It is is worth repeating that we have not optimized over the age-dependent tax rates.
Instead, the tax rates are taken to be the cross-sectional average from the second-best simulation, as in Figure 2 . Of course, the fact that welfare comes out to be very close to that
of the second best, suggests that this policy is very close to being optimal within the set
of simple age-dependent tax policies.15 We think this illustrates that our characterization
of the second best, theoretical and numerical, provides not only useful insights, but can
also deliver detailed and surprisingly accurate guidance for simplertax systems.
Although our age-dependent policy is constructed to mimic the second best as much
as possible, it lacks history dependence. In particular, it cannot implement the shortterm regressivity property which we found to be optimal. At least for this simulation, it
appears that history dependence is not crucial for welfare. At present, we do not know
how robust this conclusion is.
As the second row indicates, preserving age-dependent linear labor taxes but setting
capital taxes to zero delivers a welfare gain of 3.16%. The difference of 0.14% represents
the gains from taxing capital. This magnitude is in line with Farhi and Werning (2008a,b),
who find relatively modest gains, especially when incorporating general equilibrium effects which are absent here.
The third row maintains the same age-dependent labor tax, but allows for a non-zero,
age-independent tax on capital. This improves welfare to 3.29%, very close to the welfare
obtained by age dependent labor and capital taxes of 2.30% from the first row. The op15 Other

findings discussed below imply that the shape of the age-dependent tax does affect welfare.

37

timal age-independent intertemporal wedge is 0.33% (corresponding to tax rate of 6.60%
on the net interest). Interestingly, this is close to the average wedge across ages from the
second-best simulation, as displayed in Figure 1 .
The last row reports welfare for the simplest tax system we consider: age-independent
linear labor and capital taxes. The optimal age-independent linear tax on labor is equal
to 27.43%, quite close to the average across ages found in the second best simulation,
or the calculation behind panel (b) in Figure 5 . This simplest of tax systems delivers
welfare of 2.71%. Comparing this to the first row, we see that the cost of imposing an
age-independent tax system is roughly 0.60% of lifetime consumption.
Not reported in the table is the fact that the optimal age-independent tax on capital
comes out to be minuscule: an intertemporal wedge of 0.0138%, corresponding to a tax
rate of around 0.28% on net interest. Given this, the cost of imposing a zero tax on capital
constraint are minuscule, below 0.001% of lifetime consumption. Interestingly, taxing
capital does not appear to be optimal unless the labor tax is somewhat sophisticated and
features either age-dependence or the richer history-dependence of the second best.
With an age-dependent labor tax, an age-independent tax on capital provides modest
but non-negligible benefits, equal to 0.13%. However, the addition of an age-dependent
capital tax provides little extra benefit, equal to 0.01% of lifetime consumption. In contrast, age-dependent taxes on labor provide a sizable improvement of 0.60% over the
completely age-independent tax system. Allowing for age-dependent labor taxes is more
important in this simulation than allowing for age-dependent capital taxes.
Why is the optimal age-independent tax on capital significant when labor taxes are
age-dependent, yet minuscule when labor taxes are age independent? There are two
forces at play. The first pushes for a positive tax on capital to get closer to the Inverse Euler
condition. This force is clearly at play in the second best, but also appears to be present
in the simpler tax systems (rows 1â€“3 in the table). The second force occurs only when
when labor taxes cannot be age-dependent (row 4). The reason is that a capital subsidy
could help mimic an increasing age profile of labor taxes. Intuitively, labor income earned
earlier in life, while taxed at the same rate as later in life, has the benefit that, when saved,
it accrues a higher interest rate from the capital subsidy. This sort of mimicking effect is
explained in Erosa and Gervais (2002) for a Ramsey framework.16 When we allow for
16 They

assume no uncertainty, so that the age-dependence of the desire path of labor taxes is entirely
driven by the age-dependence of the Frisch elasticity of labor supply. In our simulation, instead, the Frisch
elasticity of labor supply is constant, and it is the information structure that is responsible for the agedependence of desired labor taxes, which is increasing. Restricting labor taxes to be age-independent calls
for a mimicking capital subsidy. Instead, they focus on a specification where the elasticity of the disutility
of labor varies, with a functional form that can lead to the reverse case, with decreasing labor taxes or a
positive tax on capital to mimic them.

38

age-dependent labor taxes, the second force is absent leading to a positive tax on capital.
When the labor tax cannot depend on age, both forces are present and roughly cancel
each other out, resulting in a practically zero tax on capital.
Gains From the Inverse Euler Equation. We conclude our numerical investigations by
linking our results to Farhi and Werning (2008a,b). In these papers, we propose a method
to assess the importance of savings distortions from a welfare perspective. Starting with
any incentive-compatible allocation, we consider the class of all allocations that share the
same labor allocation, are incentive compatible, and deliver the same utility to agents.
We show how these allocations can be obtained from the original allocation through a
simple set of perturbations. In this class of allocations, the one with the least cost is
the only one that satisfied the Inverse Euler equation. The corresponding cost-savings
represent the gains from optimal savings distortions. In Table 3, we report the welfare
gains from allowing for optimal savings distortions for the different allocations discussed
above. Overall, our findings are supportive of the results in Farhi and Werning (2008a,b).
We report the corresponding numbers both for the high and low volatility case. The
gains from optimal savings distortions decrease with the volatility of productivity. For
example, they decrease from 0.449% to 0.086% for the allocation with zero taxes. This is
intuitive. Starting with an allocation that satisfies the Euler equation, the gains from optimal savings distortions are linked to the amount of precautionary savings. With log preferences, the strength of this motive is measured by the variance of consumption growth,
which is an increasing function of the variance of productivity. In the rest of the discussion, we focus on the high volatility case.
Consistent with Farhi and Werning (2008a,b), we find that the gains from optimal savings distortions are never very large. The maximum number that we compute is 0.449%.
Starting from the allocation with zero taxes, the gains from optimal savings distortions
only contribute to a relatively small fraction (about 13%) of the gains from moving to an
optimal tax system (3.43%).
That the the gains from optimal savings distortions are largest (0.449%) for the allocation with zero taxes is intuitive for two reasons. First, this allocation has no savings
distortions to start with (it satisfies the Euler equation). Second, this allocation features
the least insurance among the allocations that we consider. As a result, the variance of
consumption growth is high, and so are the welfare gains from optimal savings distortions. The same reasons explain why the gains from optimal savings distortions for the
allocation with age-independent labor and capital taxes are also larger (at 0.180%) than
for the other allocations that we consider. Regarding this allocation, it is interesting to
39

zero taxes
age-dependent Ï„L and Ï„K
age-dependent Ï„L , and Ï„K = 0
age-dependent Ï„L , age-independent Ï„K
age-independent Ï„L and Ï„K

ÏƒÌ‚2 = 0.0161
0.449%
0.005%
0.095%
0.011%
0.180%

ÏƒÌ‚2 = 0.0061
0.086%
0.000%
0.036%
0.026%
0.056%

Table 3: Welfare from Optimal Savings Distortions.
note that the optimal age-independent capital tax is basically equal to zero (corresponding to zero savings distortions): the gains from savings distortions cannot be achieved by
simply introducing a linear tax on capital.
The gains from optimal savings distortions for the allocation with age-dependent labor and capital taxes are absolutely minuscule (much less than the gains from moving to
the second best). This allocation approximates the second best very well. Our exercise
informs us that the small gains from the second best over this allocation (of the order of
0.1%) do not originate in better savings distortions.
The allocation with age-dependent labor taxes but zero capital taxes offers greater
gains from optimal savings distortions (0.095%). Note also that the gains from optimal
savings distortions are only about a third of the gains from moving to the second best allocation (0.270%): the bulk of these gains does not originate in savings distortions per se.
The gains from optimal savings distortions for the allocation with age-dependent labor
taxes but age-independent capital taxes are lower (0.011%): this allocation already features some savings distortions that partially replicate the savings distortions prescribed
by the Inverse Euler equation.

References
A BRAHAM , A., AND N. PAVONI (2008): â€œEfficient Allocations with Moral Hazard and
Hidden Borrowing and Lending: A Recursive Formulation,â€ Review of Economic Dynamics, 11(4), 781â€“803.
A LBANESI , S., AND C. S LEET (2006): â€œDynamic Optimal Taxation with Private Information,â€ Review of Economic Studies, 73(1), 1â€“30.
A LES , L., AND P. M AZIERO (2009): â€œAccounting for Private Information,â€ mimeo.
B ATTAGLINI , M. (2005): â€œLong-Term Contracting with Markovian Consumers,â€ American
Economic Review, 95(3), 637â€“658.
40

B ATTAGLINI , M., AND S. C OATE (2008): â€œPareto efficient income taxation with stochastic
abilities,â€ Journal of Public Economics, 92(3-4), 844â€“868.
D IAMOND , P. A. (1998): â€œOptimal Income Taxation: An Example with a U-Shaped Pattern of Optimal Marginal Tax Rates,â€ American Economic Review, 88(1), 83â€“95.
D IAMOND , P. A., AND J. A. M IRRLEES (1978): â€œA model of social insurance with variable
retirement,â€ Journal of Public Economics, 10(3), 295â€“336.
E ROSA , A., AND M. G ERVAIS (2002): â€œOptimal Taxation in Life-Cycle Economies,â€ Journal
of Economic Theory, 105(2), 338â€“369.
FARHI , E., AND I. W ERNING (2008a): â€œOptimal savings distortions with recursive preferences,â€ Journal of Monetary Economics, 55(1), 21â€“42.
(2008b): â€œThe Political Economy of Non-Linear Capital Taxation,â€ mimeo.
(2009): â€œCapital Taxation: Quantitative Explorations of the Inverse Euler Equation,â€ mimeo.
F ERNANDES , A., AND C. P HELAN (2000): â€œA Recursive Formulation for Repeated Agency
with History Dependence,â€ Journal of Economic Theory, 91(2), 223â€“247.
F UKUSHIMA , K. (2010): â€œQuantifying the Welfare Gains from SImple Tax Systems,â€
mimeo.
G ARRETT, D., AND A. PAVAN (2010): â€œDynamic Managerial Compensation: a Mechanism
Design Approach,â€ mimeo.
G OLOSOV, M., N. K OCHERLAKOTA , AND A. T SYVINSKI (2003): â€œOptimal Indirect and
Capital Taxation,â€ Review of Economic Studies, 70(3), 569â€“587.
G OLOSOV, M., M. T ROSHKIN ,
mimeo.

AND

A. T SYVINSKI (2010): â€œOptimal Dynamic Taxes,â€

G OLOSOV, M., AND A. T SYVINSKI (2006): â€œDesigning Optimal Disability Insurance: A
Case for Asset Testing,â€ Journal of Political Economy, 114(2), 257â€“279.
G OLOSOV, M., A. T SYVINSKI , AND I. W ERNING (2006): â€œNew Dynamic Public Finance:
A Userâ€™s Guide,â€ forthcoming in NBER Macroeconomics Annual 2006.
J ARQUE , A. (2008): â€œRepeated Moral Hazard with Effort Persistence,â€ mimeo.
41

K APICKA , M. (2008): â€œEfficient Allocation in Dynamic Private Information Economies
with Persistent Shocks: A First-Order Approach,â€ mimeo.
K REMER , M. (2002): â€œShould Taxes be Independent of Age,â€ mimeo.
M IRRLEES , J. (1971): â€œAn Exploration in the Theory of Optimum Income Taxation,â€ Review of Economic Studies, 38(2), 175â€“208.
PAVAN , A., I. S EGAL , AND J. T OIKKA (2009): â€œDynamic Mechanism Design: Incentive
Compatibility, Profit Maximization, and Infomation Disclosure,â€ mimeo.
S AEZ , E. (2001): â€œUsing Elasticities to Derive Optimal Income Tax Rates,â€ Review of Economic Studies, 68(1), 205â€“29.
S HIMER , R., AND I. W ERNING (2008): â€œLiquidity and Insurance for the Unemployed,â€
American Economic Review, 98(5), 1922â€“42.
S TORESLETTEN , K., C. I. T ELMER , AND A. YARON (2004): â€œConsumption and risk sharing
over the life cycle,â€ Journal of Monetary Economics, 51(3), 609â€“633.
T CHISTYI , A. (2006): â€œSecurity Design with Correlated Hidden Cash-Flows: The Optimality of Performance Pricing,â€ mimeo.
W EINZIERL , M. (2008): â€œThe Surprising Power of Age-Dependent Taxes,â€ mimeo.
W ERNING , I. (2002): â€œOptimal Unemployment Insurance with Unobservable Savings,â€
Mimeo.
(2007a): â€œOptimal Fiscal Policy with Redistribution,â€ Quarterly Journal of Economics, 122(3), 925â€“967.
(2007b): â€œPareto Efficient Income Taxation,â€ mimeo.
W ILLIAMS , N. (2008): â€œPersistent Private Information,â€ mimeo.

7

Appendix

Proof of Proposition 1. Consider an allocation {c, y} that solves Program IC or Program
FOA. Then consider a history Î¸ tâˆ’1 and a neighborhood |Î¸Ìƒ tâˆ’1 âˆ’ Î¸ tâˆ’1 | â‰¤ Îµ of this history

42


where | Â· | is the sup norm. Consider the following perturbed allocation cÌƒÎ´ , yÌƒÎ´ . Define
for every Î¸Ìƒ tâˆ’1 such that |Î¸Ìƒ tâˆ’1 âˆ’ Î¸ tâˆ’1 | â‰¤ Îµ,



uÌ‚t cÌƒÎ´ Î¸Ìƒ t = uÌ‚t c Î¸Ìƒ t âˆ’ Î´,
 

 

uÌ‚tâˆ’1 cÌƒÎ´ Î¸Ìƒ tâˆ’1
= uÌ‚tâˆ’1 c Î¸Ìƒ tâˆ’1 + Î²Î´,
and for every other Î¸ s




uÌ‚s cÎ´ (Î¸ s ) = uÌ‚s cÎ´ (Î¸ s ) .
Finally for every Î¸ s , define
yÌƒÎ´ (Î¸ s ) = y (Î¸ s )
The perturbed allocation {cÌƒ, yÌƒ} satisfies all the constraints (of either Program IC or
Program FOA). A necessary condition for the inital allocation {c, y} to be optimal is that

it be the least cost allocation among the class of allocations cÌƒÎ´ , yÌƒÎ´ indexed by Î´. This
implies that

dÎ¨ cÌƒÎ´ , yÌƒÎ´
=0
dÎ´
which can be rewritten as
Ë†



1
 f tâˆ’1 Î¸Ìƒtâˆ’1 |Î¸Ìƒtâˆ’2 ... f 0 Î¸Ìƒ0 |Î¸Ìƒâˆ’1 dÎ¸Ìƒtâˆ’1 ...dÎ¸Ìƒ0
tâˆ’10 c Î¸Ìƒ tâˆ’1
|Î¸Ìƒ tâˆ’1 âˆ’Î¸ tâˆ’1 |â‰¤Îµ uÌ‚
Ë†
Ë†



1
 f t Î¸Ìƒt |Î¸Ìƒtâˆ’1 dÎ¸t f tâˆ’1 Î¸Ìƒtâˆ’1 |Î¸Ìƒtâˆ’2 ... f 0 Î¸Ìƒ0 |Î¸Ìƒâˆ’1 dÎ¸Ìƒtâˆ’1 ...dÎ¸Ìƒ0 .
=q
uÌ‚t0 c Î¸Ìƒ t
|Î¸Ìƒ tâˆ’1 âˆ’Î¸ tâˆ’1 |â‰¤Îµ

Î²



Â´
Dividing by |Î¸Ìƒ tâˆ’1 âˆ’Î¸ tâˆ’1 |â‰¤Îµ f tâˆ’1 Î¸Ìƒtâˆ’1 |Î¸Ìƒtâˆ’2 ... f 0 Î¸Ìƒ0 |Î¸Ìƒâˆ’1 dÎ¸Ìƒtâˆ’1 ...dÎ¸Ìƒ0 and taking the limit when
Îµ â†’ 0 yields the result.
Proof of Proposition 2. We tackle Program FOA using optimal control. To clarify the
origins of the results, we first only make Assumption 1. Then we introduce Assumption 2
in the proof only when it is needed. We attach multipliers Î» and Î³ on the first and second
constraints. We denote by Âµ (Î¸ ) the co-state variable associated with w (Î¸ ). We then form
the corresponding Hamiltonian. The Envelope conditions can be written as
Kv (v, âˆ†, Î¸âˆ’ , t) = Î» and Kâˆ† (v, âˆ†, Î¸âˆ’ , t) = Î³.
In line with these identities, we write
Kv (v (Î¸ ) , âˆ† (Î¸ ) , Î¸, t + 1) = Î» (Î¸ ) and Kâˆ† (v (Î¸ ) , âˆ† (Î¸ ) , Î¸, t + 1) = Î³ (Î¸ ) .
43

The boundary conditions are
lim Âµ (Î¸ ) = 0 and lim Âµ (Î¸ ) = 0.

(21)

Î¸ â†’Î¸

Î¸ â†’Î¸

The law of motion for the co-state Âµ (Î¸ ) is
"
#
f Î¸tâˆ’ (Î¸ |Î¸âˆ’ ) t
dÂµ (Î¸ )
1
= âˆ’ t0
âˆ’Î»âˆ’Î³ t
f (Î¸ |Î¸âˆ’ )
dÎ¸
uÌ‚ (c (Î¸ ))
f (Î¸ |Î¸âˆ’ )

(22)

The first order conditions for âˆ† (Î¸ ), v (Î¸ ) and y (Î¸ ) can be rearranged as follows
q Î³ (Î¸ )
Âµ (Î¸ )
=âˆ’
,
Î² Î¸
(Î¸ |Î¸âˆ’ )

(23)

1
q
= Î» (Î¸ ) ,
Î²
(c (Î¸ ))

(24)

Î¸ft

uÌ‚t0
and

hÌ‚y (y (Î¸ ) , Î¸ )
1 âˆ’ t0
uÌ‚ (c (Î¸ ))

!


Âµ (Î¸ ) 
h
y
Î¸
,
Î¸
.
(25)
(
(
)
)
yÎ¸
f t (Î¸ |Î¸âˆ’ )

Using equation (24) to replace Î» by ( Î²/q) 1/uÌ‚tâˆ’10 (câˆ’ ) in equation (22), and integrating
and using equation (21) we get
0=

Ë† 

=


Î²
1
1
âˆ’
f t (Î¸ |Î¸âˆ’ )
uÌ‚t0 (c (Î¸ )) q uÌ‚tâˆ’10 (câˆ’ )

which provides another proof of Proposition 1 .
Let us now make Assumption 2. We can then simplify equation (25) as follows
ï£«
ï£¬
ï£­1 âˆ’

1
Î¸Îº



uÌ‚t0


y ( Î¸ ) Î± âˆ’1
Î¸
ï£·
ï£¶

(c (Î¸ ))

ï£¸=Î±

Âµ (Î¸ )
uÌ‚t0 (c (Î¸ ))
(Î¸ |Î¸âˆ’ )

Î¸ft

1
Î¸Îº




y ( Î¸ ) Î± âˆ’1
Î¸

uÌ‚t0 (c (Î¸ ))

.

Replacing the expression for the labor wedge in this last condition, we get
Ï„L (Î¸ )
1
Ï€ (Î¸ )
t
Ï€
Î¸
f
Î¸
|
Î¸
=
Î±Âµ
Î¸
.
(
)
(
)
(
)
âˆ’
1 âˆ’ Ï„L (Î¸ ) uÌ‚t0 (c (Î¸ ))
Î¸
Integrating by parts this equality, we get
Ë†

Ï„L (Î¸ )
1
Ï€ (Î¸ ) f t (Î¸ |Î¸âˆ’ ) dÎ¸ = Î±
t
0
1 âˆ’ Ï„L (Î¸ ) uÌ‚ (c (Î¸ ))
44

Ë†
Âµ (Î¸ )

Ï€ (Î¸ )
dÎ¸
Î¸

(26)

= Î± [Âµ (Î¸ ) Î  (Î¸ )]Î¸Î¸
"
#
Ë†
f Î¸tâˆ’ (Î¸ |Î¸âˆ’ ) t
1
âˆ’Î»âˆ’Î³ t
+ Î± Î  (Î¸ ) t0
f (Î¸ |Î¸âˆ’ ) dÎ¸
uÌ‚ (c (Î¸ ))
f (Î¸ |Î¸âˆ’ )


Ë†
dÏ†Î  (Î¸âˆ’ )
1
Î³
= Î± Î  (Î¸ ) t0
âˆ’ Î» f t (Î¸ |Î¸âˆ’ ) dÎ¸ âˆ’ Î± Î¸âˆ’
Î¸âˆ’
dÎ¸âˆ’
uÌ‚ (c (Î¸ ))
where we have used the fact that
dÏ†Î  (Î¸âˆ’ )
=
dÎ¸âˆ’
Now note that

Ë†
Î  (Î¸ ) f Î¸tâˆ’ (Î¸ |Î¸âˆ’ ) dÎ¸.

Âµ (Î¸ )
Ï„L (Î¸ )
1
q Î³ (Î¸ )
=Î± t
= âˆ’Î±
t
0
1 âˆ’ Ï„L (Î¸ ) uÌ‚ (c (Î¸ ))
Î¸ f (Î¸ |Î¸âˆ’ )
Î² Î¸

so that we also have

q Î³
1
Ï„Lâˆ’
= âˆ’Î±
.
t
âˆ’
1
0
1 âˆ’ Ï„Lâˆ’ uÌ‚
Î² Î¸âˆ’
(câˆ’ )

Similarly we have
Î»=

1
Î²
.
q uÌ‚tâˆ’10 (câˆ’ )

This implies that
Ë†

Ï„L (Î¸ ) q uÌ‚tâˆ’10 (câˆ’ )
Ï€ (Î¸ ) f t (Î¸ |Î¸âˆ’ ) dÎ¸
1 âˆ’ Ï„L (Î¸ ) Î² uÌ‚t0 (c (Î¸ ))
 t âˆ’10

Ë†
q uÌ‚
Ï„Lâˆ’
dÏ†Î  (Î¸âˆ’ )
(câˆ’ )
t
= Î± Î  (Î¸ )
âˆ’
1
f
Î¸
|
Î¸
dÎ¸
+
Î¸
.
(
)
âˆ’
âˆ’
Î² uÌ‚t0 (c (Î¸ ))
1 âˆ’ Ï„Lâˆ’
dÎ¸âˆ’
This proves Proposition 2.
Proof of Proposition 3. The proof is very similar to that of Proposition 1. Define
Ë†
Ï‡â‰¡

(Î¸tâˆ’1 /Î¸t )Î± f t (Î¸t |Î¸tâˆ’1 ) dÎ¸t .

The idea is to consider a history Î¸ tâˆ’1 , a neighborhood |Î¸Ìƒ tâˆ’1 âˆ’ Î¸ tâˆ’1 | â‰¤ Îµ of this history, and

the following perturbed allocation cÌƒÎ´ , yÌƒÎ´ . Define for every Î¸Ìƒ tâˆ’1 such that |Î¸Ìƒ tâˆ’1 âˆ’ Î¸ tâˆ’1 | â‰¤
Îµ,

Î±
Î± Î´
yÌƒÎ´ Î¸Ìƒ t
= y Î¸Ìƒ t
âˆ’ ,
Ï‡
 
Î±  
Î±
yÌƒÎ´ Î¸Ìƒ tâˆ’1
= y Î¸Ìƒ tâˆ’1
+ Î²Î´,

45

and for every other Î¸ s
yÌƒÎ´ (Î¸ s ) = yÎ´ (Î¸ s ) .
Finally for every Î¸ s , define
cÌƒÎ´ (Î¸ s ) = c (Î¸ s ) .
It is easy to see that the perturbed allocation is incentive compatible and delivers the same
utility as the original allocation. As in the proof of Proposition 1, a necessary condition for
the inital allocation {c, y} to solve Program IC is that it be the least cost allocation among

the class of allocations cÌƒÎ´ , yÌƒÎ´ indexed by Î´. The limit of the corresponding first-order
condition when Îµ goes to zero delivers
Ë†


 

Ï„L Î¸ t
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
Î¸t Î± t
f (Î¸t |Î¸tâˆ’1 ) dÎ¸t
1 âˆ’ Ï„L (Î¸ t ) Î² uÌ‚t0 (c (Î¸ t ))
Î¸ t +1
 Ë† 

Ï„L Î¸ tâˆ’1
Î¸t Î± t
f (Î¸t |Î¸tâˆ’1 ) dÎ¸t
=
Î¸ t +1
1 âˆ’ Ï„L (Î¸ tâˆ’1 )
 # 

Ë† "
Î¸t Î± t
q uÌ‚tâˆ’10 c Î¸ tâˆ’1
+
1âˆ’
f (Î¸t |Î¸tâˆ’1 ) dÎ¸t .
Î² uÌ‚t0 (c (Î¸ t ))
Î¸ t +1

This completes the proof.
Proof of Proposition 4.
We use optimal control to analyze this program: we attach
multipliers Î» and Î³ on the first and second constraints; we denote by Âµ (Î¸ ) the co-state
variable associated with w (Î¸ ); and we then form the corresponding Hamiltonian. The
Envelope conditions can be written as
Kv (v, âˆ†, Î¸âˆ’ , t) = Î» and Kâˆ† (v, âˆ†, Î¸âˆ’ , t) = Î³.
In line with these identities, we write
Kv (v (Î¸ ) , âˆ† (Î¸ ) , Î¸, t + 1) = Î» (Î¸ ) and Kâˆ† (v (Î¸ ) , âˆ† (Î¸ ) , Î¸, t + 1) = Î³ (Î¸ ) .
The boundary conditions for the co-state variable are
lim

Âµ Î¸t


 = âˆ’

Î³ Î¸âˆ’ dÎ¸ t
,
Î¸âˆ’ Î¸ t dÎ¸âˆ’

Î¸ t f t Î¸ t |Î¸âˆ’
Âµ (Î¸ t )
Î³ Î¸âˆ’ dÎ¸ t
lim
= âˆ’
.
t
t
Î¸âˆ’ Î¸ t dÎ¸âˆ’
Î¸ â†’Î¸ Î¸ t f (Î¸ t | Î¸âˆ’ )

Î¸ â†’Î¸

t

46

The first-order condition for y (Î¸ ) can be rearranged as follows
Âµ (Î¸ )
1 Î¸CnÎ¸
Ï„L (Î¸ )
=âˆ’ t
,
1 âˆ’ Ï„L (Î¸ )
Î¸ f (Î¸ |Î¸âˆ’ ) Cu Cn
nÎ¸
where for short, the argument (y (Î¸ ) , w (Î¸ ) âˆ’ Î²v (Î¸ ) , Î¸ ) of the function C1u Î¸C
Cn is omitted.
Combining the last three equations immediately yields part (i) of the proposition.
Turning to part (ii), we now make Assumptions 1 and 2. We can then simplify the
first-order condition for y (Î¸ ) as

Î² 0
Âµ (Î¸ )
Ï„L (Î¸ )
= Î± uÌ‚t (c (Î¸ )) t
.
1 âˆ’ Ï„L (Î¸ )
q
Î¸ f (Î¸ |Î¸âˆ’ )
Combining this with the first-order condition for âˆ† (Î¸ )
Âµ (Î¸ )
q Î³ (Î¸ )
=âˆ’
Î² Î¸
(Î¸ |Î¸âˆ’ )

Î¸ft
yields

Ï„L (Î¸ )
Î³ ( Î¸ ) t0
uÌ‚ (c (Î¸ )) .
= âˆ’Î±
1 âˆ’ Ï„L (Î¸ )
Î¸
These conditions also hold in the previous period
0
Ï„Lâˆ’
Î³
= âˆ’Î± uÌ‚tâˆ’1 (câˆ’ ) .
1 âˆ’ Ï„Lâˆ’
Î¸âˆ’

Together with the boudary conditions, this yields
Ï„L Î¸ t
1 âˆ’ Ï„L





Âµ Î¸t
Î² t0
 = Î± uÌ‚ c Î¸ t

q
Î¸t
Î¸ t f t Î¸ t |Î¸âˆ’
 Î¸âˆ’ dÎ¸ t
Î³ Î² t0
= âˆ’Î±
uÌ‚ c Î¸ t
Î¸âˆ’ q
Î¸ t dÎ¸âˆ’

0
Ï„Lâˆ’ Î² uÌ‚t c Î¸ t Î¸âˆ’ dÎ¸ t
=
.
1 âˆ’ Ï„Lâˆ’ q uÌ‚tâˆ’10 (câˆ’ ) Î¸ t dÎ¸âˆ’

A similar calculation yields
0

Ï„L (Î¸ t )
Ï„Lâˆ’ Î² uÌ‚t (c (Î¸ t )) Î¸âˆ’ dÎ¸ t
=
1 âˆ’ Ï„L (Î¸ t )
1 âˆ’ Ï„Lâˆ’ q uÌ‚tâˆ’10 (câˆ’ ) Î¸ t dÎ¸âˆ’

47

Proof of Proposition 5. The proof follows immediately, by combining the following two
lemmas.
Lemma 1 Suppose that Assumptions 1 and 2 hold, and that {c, y} solves Program FOA. Then
the labor wedge satisfies the following equation for every t â‰¥ 1, history Î¸ tâˆ’1 and shock Î¸t :
âˆ‚
dÎ¸t

"

#

Ï„L Î¸ tâˆ’1 , Î¸t
q
1
=
1 âˆ’ Ï„L (Î¸ tâˆ’1 , Î¸t ) Î² uÌ‚t0 (c (Î¸ tâˆ’1 , Î¸t ))

Î¸tâˆ’1 f Î¸ttâˆ’1 (Î¸t |Î¸tâˆ’1 )
Ï„L Î¸ tâˆ’1
1
âˆ’
1 âˆ’ Ï„L (Î¸ tâˆ’1 ) uÌ‚tâˆ’10 (c (Î¸ tâˆ’1 )) Î¸t f t (Î¸t |Î¸tâˆ’1 )

âˆ’ f t (Î¸t |Î¸tâˆ’1 ) âˆ’ Î¸t f Î¸tt (Î¸t |Î¸tâˆ’1 )
Ï„L Î¸ tâˆ’1 , Î¸t
1
q
+
Î¸ t f t ( Î¸ t | Î¸ t âˆ’1 )
1 âˆ’ Ï„L (Î¸ tâˆ’1 , Î¸t ) Î² uÌ‚t0 (c (Î¸ tâˆ’1 , Î¸t ))


Î± q
1
1
âˆ’
âˆ’
.
Î¸t Î² uÌ‚t0 (c (Î¸ tâˆ’1 , Î¸t )) uÌ‚tâˆ’10 (c (Î¸ tâˆ’1 ))

We build on the proof of Proposition 4. We use the same notations and definitions. We
start with the following equation
Ï„ (Î¸ ) q
Î¸Î» (Î¸ ) f (Î¸ |Î¸âˆ’ ) = Î±Âµ (Î¸ ) .
1 âˆ’ Ï„ (Î¸ ) Î²
Using the law of motion for Âµ and the boundary condition for Âµ at Î¸ t , we can transform
this equation as follows
Ï„L (Î¸ ) q
Î¸Î» (Î¸ ) f t (Î¸ |Î¸âˆ’ )
1 âˆ’ Ï„L (Î¸ ) Î²

#
Ë† Î¸"
f Î¸tâˆ’ Î¸Ì‚ |Î¸âˆ’


q
dÎ¸ t t
 f t Î¸Ì‚ |Î¸âˆ’ dÎ¸Ì‚
= âˆ’Î±Î³
f (Î¸ t |Î¸âˆ’ ) âˆ’ Î±
Î» Î¸Ì‚ âˆ’ Î» âˆ’ Î³
dÎ¸âˆ’
Î²
f Î¸Ì‚ |Î¸âˆ’
Î¸t

Ë† Î¸
Ë† Î¸



dÎ¸ L (Î¸âˆ’ )
q
âˆ’ Î±Î³
f (Î¸ |Î¸âˆ’ ) + Î±Î³
f Î¸âˆ’ Î¸Ì‚ |Î¸âˆ’ dÎ¸Ì‚ âˆ’ Î±
Î» Î¸Ì‚ âˆ’ Î» f t Î¸Ì‚ |Î¸âˆ’ dÎ¸Ì‚
dÎ¸âˆ’
Î²
Î¸t
"
#

Ë† Î¸
Ë† Î¸



Ï„Lâˆ’
dÎ¸ t t
q
t
Î¸âˆ’ Î»
f (Î¸ t |Î¸âˆ’ ) âˆ’
f Î¸âˆ’ Î¸Ì‚ |Î¸âˆ’ dÎ¸Ì‚ âˆ’ Î±
Î» Î¸Ì‚ âˆ’ Î» f t Î¸Ì‚ |Î¸âˆ’ dÎ¸Ì‚.
1 âˆ’ Ï„Lâˆ’
dÎ¸âˆ’
Î²
Î¸t

where

1
q
1
q
= Î» and t0
= Î» (Î¸ ) .
Î²
uÌ‚ (c (Î¸ ))
Î²
(câˆ’ )

uÌ‚tâˆ’10

48

This implies that
d

h

Ï„L (Î¸ ) q
Î» (Î¸ )
1âˆ’Ï„L (Î¸ ) Î²

dÎ¸

i

Î¸âˆ’ f Î¸tâˆ’ (Î¸ |Î¸âˆ’ )
Ï„Lâˆ’
=âˆ’
Î»
1 âˆ’ Ï„Lâˆ’ Î¸ f t (Î¸ |Î¸âˆ’ )



âˆ’ f t (Î¸ |Î¸âˆ’ ) âˆ’ Î¸ f Î¸t (Î¸ |Î¸âˆ’ ) Î± q
Ï„ (Î¸ ) q
+
Î» (Î¸ )
âˆ’
Î» Î¸Ì‚ âˆ’ Î»
1 âˆ’ Ï„ (Î¸ ) Î²
Î¸ f t (Î¸ |Î¸âˆ’ )
Î¸ Î²

which proves the lemma.
Lemma 2 Suppose that
ï£«

ï£«

ï£¬ ï£¬
ï£¬logï£¬
ï£­ ï£­

f t (Î¸ |Î¸âˆ’ ) =

1
âˆš

Î¸Ïƒt 2Ï€

e

âˆ’

ï£¶ ï£¶2
ï£·ï£·
Î¸
ï£·ï£·
ï£¸ï£¸
log
Âµt (Î¸âˆ’ )
Î¸âˆ’ e
2Ïƒt2

(27)

where Âµt (Î¸âˆ’ ) is an arbitrary function of Î¸âˆ’ and Ïƒt is a constant. Then
log

dÂµ
Î¸âˆ’ f Î¸tâˆ’ (Î¸ |Î¸âˆ’ ) = âˆ’ 1 + Î¸âˆ’ t
dÎ¸âˆ’

!

Î¸ f Î¸t (Î¸ |Î¸âˆ’ ) + f t (Î¸ |Î¸âˆ’ ) .

Alternative Proof of Proposition 5 based on a perturbation argument.
Consider an
allocation {c, y} that satisfies the constraints of Program FOA, and a history Î¸ tâˆ’1 . We

construct a sequence cn,Î´ , yn,Î´ of perturbed allocations as follows. Let




Ï€ n (Î¸ ) = âˆ’ Î¸Ì‚ âˆ’ Îµ Î´n Î¸ âˆ’ Î¸Ì‚ âˆ’ Îµ + Î¸Ì‚ + Îµ Î´n Î¸ âˆ’ Î¸Ì‚ + Îµ
where Î´n is a sequence of functions that converges to the Dirac distribution Î´distr at 0
where we write Î´distr to differentiate the notation for the Dirac distribution and the notation for the number Î´. The sequence of functions Ï€ n converges to the following distribution




Ï€ (Î¸ ) = âˆ’ Î¸Ì‚ âˆ’ Îµ Î´distr Î¸ âˆ’ Î¸Ì‚ âˆ’ Îµ + Î¸Ì‚ + Îµ Î´distr Î¸ âˆ’ Î¸Ì‚ + Îµ
Let Î n (Î¸ ) be a primitive of Ï€ n (Î¸ ) /Î¸. The sequences of functions Î n converges to the
following function Î 
Î  (Î¸ ) = 0 if Î¸ < Î¸Ì‚ âˆ’ Îµ or Î¸ > Î¸Ì‚ + Îµ
Î  (Î¸ ) = âˆ’1 otherwise.

Denote by hÌ‚ ( x ) the function Îº/Î±x Î± . The allocation cn,Î´ , yn,Î´ differs from {c, y} only
49


at histories Î¸ tâˆ’1 and Î¸ tâˆ’1 , Î¸t (for all possible Î¸t ). Define


hÌ‚ y
and



n,Î´

Î¸

t âˆ’1





= hÌ‚ y(Î¸

t âˆ’1



) + Î¸Ì‚tÎ±âˆ’1 Î³n,Î´



 


Î´
= hÌ‚ y Î¸ tâˆ’1 , Î¸t âˆ’ Î¸tÎ± Ï€ n (Î¸t )
hÌ‚ yn,Î´ Î¸ tâˆ’1 , Î¸t
Î²

and define
uÌ‚

t



c

n,Î´



Î¸

t âˆ’1

, Î¸t

where



= uÌ‚

t



c

n,Î´



Î¸

t âˆ’1

, Î¸t



+ Î¶ n,Î´ (Î¸t ) âˆ’ Ï€ n (Î¸t )

Î´
Î²

Î´
Î¶ n,Î´ (Î¸t ) = Î± Î n (Î¸t ) + Î¶Ì„ n,Î´ .
Î²

The perturbed allocations satisfy the constraints of Program FOA as long as
dÏ†Î 
,
= Î´Î¸tâˆ’1
dÎ¸tâˆ’1
n

Î³

Î¶Ì„ n,Î´

n,Î´

n
dÏ†Î 
Î¸ t âˆ’1
âˆ’ Î±Ï†Î 
dÎ¸tâˆ’1
n

Î´
=
Î²

!
.

Note that the perturbed allocation incorporates the necessary corrections to the perturbation constructed in the text.
The first-order condition

dÎ¨ cn,Î´ , yn,Î´
=0
dÎ´
can be rewritten as equation (5) for Ï€ = Ï€ n and Î  = Î n . Taking the limit when n goes to
infinity, and then taking the limit when Îµ goes to zero delivers Proposition 1.
Note that under Assumption 4, we can rewrite
Ë†
Î³
and
Î¶Ì„

n,Î´

Î´
=
Î²

Ë†

n,Î´

=Î´

Ï€ n,Î´ (Î¸t ) f t (Î¸t |Î¸tâˆ’1 )
Ë†

Ï€

n,Î´

t

(Î¸t ) f (Î¸t |Î¸tâˆ’1 ) dÎ¸t âˆ’ Î±

Î 

n,Î´

t

(Î¸t ) f (Î¸t |Î¸tâˆ’1 ) dÎ¸t .

We can then take the continuous time limit and derive Proposition 5.

50



Proof of Proposition 6. The first-order conditions for ct , yt ,and Ïƒâˆ†,t in the HJB equation
can be written as
1
Î»t = 0
,
uÌ‚t (ct )
Ï„L,t
Î³t 1
= âˆ’Î±
,
1 âˆ’ Ï„L,t
Î»t Î¸t
Ïƒâˆ†,t =

Kâˆ† âˆ’ Kvâˆ† Î¸t âˆ†t âˆ’ Î¸t Kâˆ†Î¸
.
Kâˆ†âˆ†

Applying Itoâ€™s lemma to Î»t = Kv (vt , âˆ†t , Î¸t , t), and differentiating the HJB equation
with respect to vt (using the Envelope theorem) immediately yields that the drift term of
Î»t is equal to zero. Hence, Î»t is a martingale. We can therefore write
dÎ»t = (Kvv Î¸t âˆ†t + Kvâˆ† Ïƒâˆ†,t + KvÎ¸ Î¸t ) ÏƒÌ‚t dWt .
Using the first-order condition for Ïƒâˆ†,t , we obtain
dÎ»t
= ÏƒÎ»,t ÏƒÌ‚t dWt ,
Î»t
where
ÏƒÎ»,t

1
=
Kv

2
Kvv Kâˆ†âˆ† âˆ’ Kvâˆ†
K âˆ’ Î¸t Kâˆ†Î¸
Î¸t âˆ†t + Kvâˆ† âˆ†
+ KvÎ¸ Î¸t
Kâˆ†âˆ†
Kâˆ†âˆ†

!
.

Applying Itoâ€™s lemma to Î³t = Kâˆ† (vt , âˆ†t , Î¸t , t), and differentiating the HJB equation with
respect to âˆ†t (using the Envelope theorem) yields that the drift term of Î³t is equal to

âˆ’ Kvv Î¸t2 âˆ†t ÏƒÌ‚t2 + Kvâˆ† Î¸t Ïƒâˆ†,t ÏƒÌ‚t2 + KvÎ¸ Î¸t2 ÏƒÌ‚t2 âˆ’

log

dÂµÌ‚
ÂµÌ‚t + Î¸t t
dÎ¸

!

!
Kâˆ†

dt

which using the definition of Î³t , the first-order condition for Ïƒâˆ†,t and the expression for
ÏƒÎ»,t , we get
!
log
d
ÂµÌ‚
âˆ’Î¸Î»t ÏƒÎ»,t ÏƒÌ‚t2 dt + ÂµÌ‚t + Î¸t t
Î³t dt.
dÎ¸
Similarly, the volatility term of Î³t is given by

(Kâˆ†v Î¸t âˆ†t + Kâˆ†âˆ† Ïƒâˆ†,t + Kâˆ†Î¸ Î¸t ) ÏƒÌ‚t dWt

51

which using the first order condition for Ïƒâˆ†,t , we can rewrite this as
Î³t ÏƒÌ‚t dWt .
Hence we have
"

dÎ³t = âˆ’Î¸t Î»t ÏƒÎ»,t ÏƒÌ‚t2 +

log

dÂµÌ‚
ÂµÌ‚t + Î¸t t
dÎ¸

!

#
Î³t dt + Î³t ÏƒÌ‚t dWt .

Applying Itoâ€™s lemma to the first order condition for yt then yields


Ï„L,t
d Î»t
1 âˆ’ Ï„L,t



log

"

dÂµÌ‚
Ï„
= Î±Î»t ÏƒÎ»,t ÏƒÌ‚t2 + Î»t L,t Î¸t t
1 âˆ’ Ï„L,t
dÎ¸

52

#
dt.

