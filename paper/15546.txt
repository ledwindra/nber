NBER WORKING PAPER SERIES

A FORMAL TEST OF ASSORTATIVE MATCHING IN THE LABOR MARKET
John M. Abowd
Francis Kramarz
Sébastien Pérez-Duarte
Ian Schmutte
Working Paper 15546
http://www.nber.org/papers/w15546

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2009

Any opinions and conclusions expressed herein are those of the authors and do not necessarily represent
the views of the U.S. Census Bureau. All results have been reviewed to ensure that no confidential
information is disclosed. This research uses data from the Census Bureau's Longitudinal Employer
Household Dynamics Program, which was partially supported by the following National Science Foundation
Grants SES-9978093, SES-0339191 and ITR-0427889; National Institute on Aging Grant AG018854;
and grants from the Alfred P. Sloan Foundation. Abowd also acknowledges direct support from NSF
Grants SES-0339191, CNS-0627680, and SES-0922005. The data used in this paper were derived
from confidential data¸˛produced by the LEHD Program at the U.S. Census Bureau. All estimation
was performed on public-use versions of these data available directly from the authors. The views
expressed herein are those of the author(s) and do not necessarily reflect the views of the National
Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2009 by John M. Abowd, Francis Kramarz, Sébastien Pérez-Duarte, and Ian Schmutte. All rights
reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including © notice, is given to the source.

A Formal Test of Assortative Matching in the Labor Market
John M. Abowd, Francis Kramarz, Sébastien Pérez-Duarte, and Ian Schmutte
NBER Working Paper No. 15546
November 2009
JEL No. E24,J21,J31
ABSTRACT
We estimate a structural model of job assignment in the presence of coordination frictions due to Shimer
(2005). The coordination friction model places restrictions on the joint distribution of worker and firm
effects from a linear decomposition of log labor earnings. These restrictions permit estimation of the
unobservable ability and productivity differences between workers and their employers as well as
the way workers sort into jobs on the basis of these unobservable factors. The estimation is performed
on matched employer-employee data from the LEHD program of the U.S. Census Bureau. The estimated
correlation between worker and ˝firm effects from the earnings decomposition is close to zero, a ˝finding
that is often interpreted as evidence that there is no sorting by comparative advantage in the labor market.
Our estimates suggest that this finding actually results from a lack of sufficient heterogeneity in the
workforce and available jobs. Workers do sort into jobs on the basis of productive differences, but
the effects of sorting are not visible because of the composition of workers and employers.

John M. Abowd
School of Industrial and Labor Relations
261 Ives Hall
Cornell University
Ithaca, NY 14853
and NBER
John.Abowd@cornell.edu
Francis Kramarz
CREST-INSEE
15 blvd Gabriel Peri
Malakoff CEDEX, 92245
FRANCE
kramarz@ensae.fr

Sébastien Pérez-Duarte
INSEE - F204
18 bd Adolphe Pinard
75014 Paris FRANCE
sebastien.perez-duarte@ensae.fr
Ian Schmutte
Department of Economics
404 Uris Hall
Cornell University
Ithaca, NY 14853
ims28@cornell.edu

1

Introduction

It is now well established that the statistical decomposition of wage rates into portions due
to observable characteristics, unmeasured individual heterogeneity, unmeasured employer
heterogeneity, and statistical residual attributes substantial variation to the unmeasured
individual and employer components.1 There is less agreement on the sign and magnitude of
the statistical correlation between these components of heterogeneity in the observed samples
of workers. Some find a small or negative correlation (Abowd et al. 1999). Others find some
evidence of positive correlation (Woodcock 2008; Abowd et al. 2003).
What might explain the correlation between unmeasured individual and employer heterogeneity? Roy (1951) posited an optimal sorting of workers with heterogeneous abilities that
were differentially productive in different occupations. Employer heterogeneity resulted from
different occupation mixes across industries and firm sizes. Mortensen (2003) demonstrates
that the within occupation decomposition into unmeasured individual and employer components is just as strong as the between occupation decomposition, which is not consistent
with Roy’s model.
Mortensen (2003) posits a collection of alternative explanations based on search and recruitment costs among employers and workers with heterogeneous productivity. He provides
empirical analyses of the Danish labor market that are consistent with the structural models
he describes. Postel-Vinay and Robin (2002) use Mortensen-style models to study the French
labor market.
Our goal is to explain the observed correlations between individual and firm heterogeneity
components. For this task, we adopt the model of job assignment with coordination frictions
developed in Shimer (2005). In what follows, we describe only those features of the model
that are essential to our analysis. Shimer’s model yields a wage offer function that depends
upon both the ability of the individual and the productivity of the employer. Furthermore,
it predicts which jobs will be filled in equilibrium. These are the two essential features
needed to construct theoretical moments of the joint distribution of individual and firm
heterogeneity. The structural model and the estimated parameters help us assess whether
and to what extent the correlations we observe between individual and firm heterogeneity
components are due to assortative matching, mismatch, and selection effects.
The key contribution of the Shimer’s model was to formally introduce the notion of
coordination frictions into the job matching process. If firms and workers could condition
wage offers and applications on the behavior of all other agents in the economy, it would
always be possible to get a frictionless and optimal assignment of workers to employers
(synonymous with jobs in this model). Shimer argues that such complete coordination of the
plans of all actors is unrealistic. Workers and firms can coordinate their behavior, but only
imperfectly. The model captures this idea by two refinements to worker and firm strategies.
First, firms can condition their wage offers on the type, but not the identity of the worker.
Second, all workers of the same type are presumed to follow the same application strategy.
1

See Abowd et al. (1999) for France, Abowd et al. (2003) for the United States, and Mortensen (2003)
for Denmark, among others.

1

These simple but powerful assumptions generate equilibrium unemployment, mismatch of
worker and firm types, and wage dispersion that depends on both firm and worker type.
Section 2 describes the job assignment model with coordination frictions. Section 3
presents the input data from the LEHD program and how it is processed prior to estimation
of the structural model. Section 4 summarizes the estimation procedure, and section 5 the
results of the estimation on LEHD data for the Professional, Scientific and Technical Services
and Manufacturing sectors. Section 6 concludes.

2
2.1

Theoretical Assignment Model
Job Assignment with Coordination Frictions

The economy consists of workers and employers. Each employer has one vacancy to fill by
hiring one worker. Employers choose wage offers for each worker. Workers then choose where
they want to apply for a job. Based on the pool of applicants, the employers hire one worker
to fill the vacancy. Workers and employers only differ in productive type. There are M types
of worker and N types of employers. When a worker of type m is hired into a job of type n,
the output of production is xm,n .
A decentralized equilibrium of the coordination friction economy is characterized by
application strategies for all workers and wage offers from all employers to each type of
worker. It turn out that this equilibrium depends only on the nature of the production
technology and the number of each type of worker and of each type of employer. Out of a
total measure µ of workers in the economy, we assume that µm of them have productive type
m ∈ {1 . . . M }. Likewise, out of a total measure ν of employers in the economy, ν n of them
have productive type n ∈ {1 . . . N }. Although it will not matter in the final equilibrium,
we follow Shimer in naming individual workers by (m, i) and individual employers by (n, j)
where the first term is the type of the agent, and the second term is the agent’s name. Thus,
each worker or employer can be uniquely identified.

2.2
2.2.1

Equilibrium Wage Offers, Applications and Hiring
The Worker’s Problem

Suppose each employer, (n, j), has chosen its menu of wage offers. Employers cannot offer
different wages to workers of the same type. Consequently, a worker of type m must choose
an application strategy based on the set of offers, wm,(n,j) , across all (n, j). The model
assumes that a worker can make only one application, so a feasible strategy for worker (m, i)
is a probability distribution pm,i that specifies the probability with which she applies to each
employer.
Since all workers of type m follow the same strategy in the coordination friction economy,
and since we assume that the number of workers of each type is very large, it is easier to
think in terms of the queue of applicants of type m to each employer. That is, the number of

2

applications from type m workers to any employer is approximately Poisson with parameter
qm,(n,j) = pm,(n,j) µm .
The equilibrium queue lengths must leave all workers of type m indifferent between
applying for any two jobs. To satisfy this condition for each type of worker, all jobs for
which there is a positive probability of application have the same expected income. In
addition, all jobs for which the worker of type m does not apply have strictly less expected
income. The expected income, ym,(n,j) , from any job for which qm,(n,j) > 0 is:
ym,(n,j) = e−Qm+1,(n,j)

1 − e−qm,(n,j)
wm,(n,j)
qm,(n,j)

(1)

P
where Qm+1,(n,j) = M
m0 =m+1 qm0 ,(n,j) is the measure of workers with productive type at least
m + 1. This is the expected number of applications from workers who are strictly better
than a worker of type m. Using the properties of the Poisson distribution, the expected
income from (n, j) is the probability of getting the job times the wage, where the probability
of getting the job is the probability that there are no applications from a better worker (the
first term on the right-hand side of (1) times the probability that the worker actually ends
up applying for the job (the term in the numerator) and is chosen from among all other
applicants of the same type (the term in the denominator). As long as there are expected
incomes, ym,n , and queue lengths that satisfy (1), workers have no incentive to deviate.
2.2.2

The Employer’s Problem

Employers choose wage offers for workers of each productive type and a hiring protocol that
maximizes expected profits given the queueing behavior of workers. Shimer (2005) shows
that the optimal hiring strategy is to choose the applicant of highest productive type. When
pursuing the optimal strategy, the maximized expected profit of employer (n, j) is given by
M
X

e−Qm+1,(n,j) [1 − e−qm ,(n,j) ][xm,n − wm,(n,j) ].

(2)

m=1

The employer’s optimal wage offers maximize the difference between each worker type’s
productivity and wage rate times the probability that a worker of that type will apply.
2.2.3

Competitive Search Equilibrium

Shimer defines the equilibrium for this economy as follows:
Definition 1 A Competitive Search Equilibrium consists of wage offers, w, queue lengths,
q, and expected incomes, y, chosen so that employer’s profits (2) are maximized, worker’s
expected incomes are given by (1), and the expected number of applications from type m
workers does not exceed the total measure of such workers, µm :

3

µm =

N Z
X
n=1

νn

qm,(n,j) dj.

(3)

0

The competitive equilibrium turns out to be unique. Furthermore, the equilibrium queue
lengths, qm,n , are the same as those that would be chosen by a social planner who chooses
queue lengths, or equivalently, application probabilities for workers. The social planner is
restricted to queue lengths that do not condition on individual identities. The goal of the
social planner is to maximize expected aggregate output. In this setting, it turns out that
the optimal queue lengths will satisfy the first-order conditions:
−Q(m,n)

λm,n ≥ e

xm,n −

m−1
X

e−Qm0 +1,n (1 − e−qm0 ,n )xm0 ,n

(4)

m0 =1

where λm,n is the expected employment of type m workers in type n employers. The dependence on the individual’s identity, i, and the employer’s identity, j, have been suppressed
because they are not relevant. Given these queue lengths, and the requirement that workers’
expected incomes satisfy (1), the equilibrium wages must be:
wm,n =

m−1
X
qm,n e−qm,n
e−Qm0 +1,n (1 − e−qm0 ,n )xm0 ,n ].
[x
−
m,n
1 − e−qm,n
m0 =1

(5)

Equations (4) and (5) provide all the information that is required for our estimation
strategy. Given assumptions about the production technology, xm,n , and the measure of
each type of employer and worker, wages and queue lengths are determined. Although the
equilibrium queue lengths have no observable counterpart, we can use them to derive the
expected number of workers of type m that ultimately become employed by employers of
type n:
λm,n = ν n e−Qm+1,n (1 − e−qm,n ).
(6)

2.3

Empirical Predictions and Sorting

In equilibrium, as in the frictionless model, the nature of job assignment depends on the
properties of the production function. Hence, the model is still informative about the nature
of assortative matching in the economy. Unlike the frictionless model, however, the coordination friction equilibrium has several properties that are more consistent with the stylized
facts characterizing labor markets. These equilibrium properties are also enough to generate
a structural connection between the underlying model primitives and the estimated person
and employer effects from a linear decomposition of log earnings. We exploit this structural
link to estimate the structure of the model.
With respect to the nature of assortative matching, Shimer derives several strong results.
First, if the production function is supermodular, Shimer’s Proposition 3 shows that Qm,n is
strictly increasing in n when it is positive. In addition, a more productive job is more likely
4

to be filled, a worker is less likely to obtain a more productive job conditional on applying
for it, and a worker’s wage is increasing in the employer’s productivity. This result holds
for production technologies that exhibit comparative advantage for higher-ability workers in
higher-productivity jobs. It also holds, as is well known, for a production technology that
exhibits no comparative advantage. Specifically, one in which output is multiplicative in
the ability and productive types of the worker and job. A converse result holds when there
is a comparative advantage for low ability workers in high-productivity jobs. In that case,
Qm,n is decreasing in n so that the assortative matching again corresponds to comparative
advantage. We estimate the structural model assuming either that the production technology
exhibits no comparative advantage or that the technology exhibits comparative advantage
for low ability workers in high productivity jobs. These specifications yield the minimal
differentiation sufficient to capture model uncertainty as to whether matching is positively
or negatively assortative.
On their own, these results do not distinguish the coordination friction economy, since
the frictionless model also predicts that job assignment will be in accord with comparative
advantage in production. However, the coordination friction model makes more reasonable
predictions about equilibrium unemployment and vacancies, and predicts a certain amount
of mismatch, which eliminates the untenable “perfect correlation” prediction for worker and
employer types from comparative advantage models without the coordination friction. Since
workers randomly choose the employer to which they will apply, there is, in general, a positive
probability that multiple workers apply for the same job–leaving all but one unemployed.
There is also a positive probability that no one will apply for any particular job, leaving it
vacant. Therefore, there will be simultaneous unemployment and job vacancy for workers and
jobs of all types. Furthermore, even among employed workers and occupied vacancies, there
will be mismatch in the sense that the particular set of matches realized in the economy
could be improved upon in the sense of maximizing total output, or in terms of aligning
assignments with comparative advantage.
Finally, the coordination friction equlibrium has two properties that are essential to the
estimation strategy. In equilibrium, the wage offer function violates the law of one price.
Different jobs pay identically able workers different wages. That is, there is a structural
employer effect in the wage. Shimer shows that the wage offer will generally be increasing in
the productive type of the employer. The equivalent result does not hold for workers, however. It is possible for an employer to offer workers with low ability higher equilibrium wage
than workers with higher ability. This establishes that it is possible to observe a negative
correlation between person and employer effects from the empirical earnings decomposition
even when there is positive assortative matching on the unobserved productivity types.
Note, however, that the model does not generally imply that log earnings can be additively
decomposed into a person and employer effect. But this implication is not required by our
estimation procedure. Our approach is motivated by the observation that the person and firm
effects from the statistical decomposition of log earnings in a linear model will be complicated
transformations of the underlying productivities and abilities along with factors determining
the supply of and demand for worker skill. As we show below, Shimer’s coordination friction

5

model provides explicit formulas for these transformations that we can identify through
restrictions on observable moments of the the joint distribution of the estimated person and
firm effects from the earnings decomposition.

3

Data

Our estimation procedure has two stages. First, we use matched employer-employee data
from the U.S. Census Bureau’s LEHD Program to estimate the parameters of a statistical
decomposition of log earnings into components due to individual heterogeneity, employer heterogeneity, and time-varying observables. Next, we estimate the structure of the assignment
model from its predictions about the joint distribution of the person and employer effects.
In the structural estimation, we use the distribution of person and employer effects stratified
by deciles of the firm size distribution. This provides an additional source of variation to
help identify the model in the absence of firm-level data on productivity. We estimate the
model separately for the Manufacturing (NAICS 31-33) and the Professional, Scientific, and
Technical Services (NAICS 541) sectors.

3.1

The Statistical Decomposition

Following Abowd et al. (1999), we decompose the annualized wage in each job as:
log wi,t = xi,t β + θi + ψ J(i,t) + εi,t

(7)

where
• J(i, t) is the dominant employer of individual i at time t;
• θi is the individual effect;
• xi,t β is the effect of individual labor market experience, tenure, and labor market
attachment, interacted with sex; and
• ψ J(i,t) is the firm effect.
Abowd et al. (2002) document the identification strategy and the details of implementing
the full least squares solution for estimating (7).
We estimate (7) on matched employer-employee data from the LEHD Program of the
U.S. Census Bureau. The LEHD program uses administrative data from state Unemployment
Insurance wage records and ES-202/QCEW establishment reports that cover approximately
98% of all nonfarm U.S. employment. Our estimation sample is based on a snapshot of
the LEHD data infrastructure that includes data from 30 states collected between 1990 and
2004. A detailed description of the input data is found in Appendix B.

6

3.2

The Data Used in the Structural Estimation

The estimates of the assignment model are based on data, D, of the form:
(θ̂i , ψ̂ j , s` )`
where θ̂ and ψ̂ are estimates of the true person and firm effects from (7); i and j are the
identities of the worker and firm contributing to the `th observation; and s` = (s1 , . . . , s10 )
is an indicator for the decile of the firm
P size distribution into which the employer falls. We
assume that ` ∈ {1, ..., N } and define N
`=1 s` = (N1 , ..., N10 ).
We compute the empirical first and second moments of the joint distribution of θ and
ψ within employer size decile for each of the two NAICS sectors. The unit of analysis is
the individual job history observation in the matched data. The deciles of the employer size
distribution are computed for every year of the data, and employers are assigned to the decile
that they occupy for each year. We use a bootstrap procedure to compute the covariance
matrix for the estimated first and second moments. We resample the data from each sector
1, 000 times and compute the first and second moments of the joint distribution of θ̂ and
ψ̂ in each sample. The estimated covariance matrix is the covariance matrix of these 1, 000
estimates.
It is important to note the measures taken to protect the confidentiality of respondents providing the underlying micro-data. The U.S. data are protected by a distributionpreserving noise-infusion procedure. Each element of the microdata has been distorted in
such a way that the individual observations are protected, yet the aggregate statistics are
still valid for our proposed analysis. For complete details of the noise infusion procedure and
the way in which it preserves analytical validity, see Abowd et al. (2009).
Figures 1, 2 and 3 provide a visual summary of data from the Professional, Scientific and
Technical Services sector. Figure 1 shows that employment in this sector is concentrated in
smaller firms. Figures 2 and 3 show two different kinds of evidence about the relationship
between the estimated person and firm effects. The first figure plots the empirical average
person and firm effects within each decile of the employer size distribution. The average
firm effect is increasing in employer size, consistent with the widely documented presence
of a firm size effect in the wage equation. Note that here the firm-size effect is preserved
even controlling for the effects of personal heterogeneity. Abowd et al. (2003) note that the
firm-size effect is indeed driven almost entirely by firm heterogeneity in wages with little of
the effet caused by sorting of highly paid workers into larger firms. Here, we see that the
average level of the person effect does not change much across deciles of the employer size
distribution. The standard errors on these estimates are so small as to be invisible on the
plot. Figure 3 shows the empirical correlation between θ̂ and ψ̂ within each decile of firm
size. The correlations are generally small in absolute value, ranging between about −0.2
and 0.25. Our model will fit estimated correlations that try to capture the scale of these
correlations as well as the variation across size classes. Here, we observe a hump-shaped
relationship between employer size decile and the correlation between θ̂ and ψ̂. In terms
of the model, this is feasible only if there is some considerable variation in the production
technology and demand across the size classes.
7

Figures 4, 5 and 6 show the corresponding picture for the Manufacturing sector. The
distribution of jobs is more concentrated in firms of intermediate size. As in the Professional,
Scientific and Technical Services sector, we see clear evidence of a firm-size effect on earnings.
Here, though, there is a more puzzling relationship between firm size and the average person
effect. The relationship is clearly non-linear, but its shape defies simple interpretation. Here,
the correlations are smaller, tending close to zero, with the exception of a relatively strong
negative correlation between θ̂ and ψ̂ for the smallest firms.

4
4.1

Estimation Procedure
Method of Moments Estimation

In this section we show that Shimer’s model generates restrictions on the joint distribution
of the estimated person and employer effects, θ̂ and ψ̂ from the decomposition of log earnings
that are sufficient to identify the free parameters of the model. We analyze the conceptual log
earnings decomposition on the matched employer-employee data that would be generated in
the coordination friction economy. Assuming that worker and employer types are observable,
we derive formulas for the expectation of estimated person and firm effects in terms of
equilibrium quantities of the model. Using these theoretical analogues to the estimated
person and firm effects, we derive formulas for the expected value of the empirical second
moments of θ̂ and ψ̂. The full set of estimating equations uses these restrictions on the second
moments of the joint distribution of θ̂ and ψ̂ as well as restrictions on the distribution of
realized matches across deciles of the firm size distribution.
In the exposition and the estimation, we assume that there are two types of worker and
20 types of employer. However, the argument does not depend on these assumptions; one
could set an arbitrary number of worker and employer types. For both identification and
computational purposes, we impose parametric restrictions on the model. Our restrictions
limit the kind of production technologies under consideration as well as the manner in which
productivity and the vacancy rate vary by firm size decile. These facilitate our computation
of the method of moments estimator by the method of simulated annealing.
4.1.1

Theoretical Wage Decomposition

We consider two types of workers, so M = 2. In the coordination friction economy, for any
given employer all workers of the same type are equally productive and by assumption are
equally paid. The wage offer functions for the case M = 2 are given by:
q1,n e−q1,n
x1,n ,
1 − e−q1,n


q2,n e−q2,n
−q1,n
x
−
1
−
e
x
=
2,n
1,n
1 − e−q2,n

w1,n =
w2,n

Recall that λm,n is the expected number of m type workers matched to employers of type
n and wm,n the corresponding wage. For M = 2 we have λ1,n = ν n e−q2,n (1 − eq1,n ) and
8

λ2,n = ν n (1 − eq2,n ).
To generate the theoretical analogues to the estimated person and firm effects, we perform
a decomposition of log earnings into portions due to worker and employer type based on the
equilibrium wage offers, w, and expected realized matches, λ, given model primitives (µ, ν, f ):
log wm,n = θm + ψ n
where dependence on i and j has been suppressed because it is irrelevant. There are only
two worker ability effects to estimate and N employer productivity effects. We restricted our
attention to models that produce equilibrium matches so that the decomposition is identified.
The worker and firm effects are the solution to the weighted least squares problem
" 2,N
#


X
θ̂1 , θ̂2 , ψ̂ 1 , . . . , ψ̂ N = arg max
λm,n (log wm,n − θm − ψ n )2 .
(8)
m,n=1

The worker and employer effects are identified up to a constant Λ (see Abowd et al. (1999)
and Abowd et al. (2002)). Straightforward computations (see Appendix) yield
P λ1n λ2n
n λ1n +λ2n log wi,n
+ Λ,
i = 1, 2
(9)
θ̂i =
P λ1n λ2n
n λ1n +λ2n

ψ̂ n

λ2n
λ1n
(log w1,n − θ1 ) +
(log w2,n − θ2 ) − Λ.
=
λ1n + λ2n
λ1n + λ2n

For consistency with the assumption used in the empirical estimation, we set Λ = 0.
4.1.2

(10)
2

Estimating Equations

The estimating equations are based on the second moments of the (θ̂, ψ̂) distribution resulting
from solving (8), stratified by deciles of the firm size distribution s, and also from the expected
fraction of filled jobs within firms of each size class, that is the first moments of s. Within
each size class, k, we form a vector of second central moments as:


¯
¯
(θ̂ − θ̂k )T (θ̂ − θ̂k )
1 

C
¯
¯
m̄C
 (θ̂ − θ̂k )T (ψ̂ − ψ̂ k ) 
k (D) = m̄ (θ̂, ψ̂|sk = 1) =
Nk
¯
¯
(ψ̂ − ψ̂ k )T (ψ̂ − ψ̂ k )
¯
¯
where θ̂k and ψ̂ k are the within size-class means for decile k. In addition, the model makes
predictions on the number of jobs observed in each size class:
m̄S (D) =
2

N
1 X
s` .
N `=1

See Appendix for the general case with a continuum of firms.

9

The 40 empirical moments are compactly expressed as


m̄C
(D)
1


..


m̄(D) =  C .
.
 m̄10 (D) 
m̄S (D)
The first 30 elements of m̄(D) are the second moments listed sequentially by size class and
the last ten elements are the employment counts in each decile.3
We now show that the model structure is sufficient to specify a function that delivers
moment restrictions corresponding to m̄(D) in terms of the underlying primitives of the
model, (µ, ν, f ):
E(m̄(D)) = g(µ, ν, f ).
We illustrate the manner in which the model determines the expectation of the empirical
covariance between θ̂ and ψ̂ within size-class k. The formulas for the variances are derived
identically.


1 X
¯ ¯
(θ̂i ψ̂ j ) − θ̂k ψ̂ k
E[covk (θ̂, ψ̂)] = E
Nk
P
= (λ11k θ1 ψ (k,1) + λ12k θ1 ψ (k,2) + λ21k θ2 ψ (k,1) + λ22k θ2 ψ (k,2) )
(11)
+λ12k )θ1 +(λ21k +λ22k )θ2 [(λ11k +λ21k )ψ (k,1) +(λ12k +λ22k )ψ (k,2)
− (λ11k
.
(λ11k +λ12k +λ21k +λ22k )
(λ11k +λ12k +λ21k +λ22k )
Using formulas (9)-(10) the covariance and variances are thus functions of the expected
number of each type of worker per firm λm,n and of the wage wm,n . We derive the theoretically
predicted number of filled jobs in each size class
 (λ1,(1,1) +λ1,(1,2) +λ2,(1,1) +λ1,(1,2) ) 
P10

s=1 (λ1,(s,1) +λ1,(s,2) +λ2,(s,1) +λ1,(s,2) )


g S (µ, ν, f )) = 


..
.

(λ1,(10,1) +λ1,(10,2) +λ2,(10,1) +λ1,(10,2) )
P10
s=1 (λ1,(s,1) +λ1,(s,2) +λ2,(s,1) +λ1,(s,2) )


.


These two variables are indeed determined in the Shimer economy.

4.2

Implementation

Our estimation procedure is based on matching the empirical second moments of the joint
distribution of θ̂ and ψ̂ to their theoretical counterparts. We obtain the optimal minimum
distance estimator of the model parameters. Parametric restrictions on the model primitives
aid in the identification of the model and also in easing the computational burden of estimation. Our inferences on the nature of assortative matching are based on estimates from
several different specifications of the production technology. We use several representative
3

For the overall economy, these counts are obviously equal in the real data; however, within each estimating sector (NAICS sector) they will not be equal.

10

technologies to capture the assumptions of comparative advantage for low-skilled workers in
high productivity jobs (LCA) and no comparative advantage (NCA). We also fit the model
under a quasi-nested combination of these production technologies.
4.2.1

Parametrization

We have 30 empirical moments from the covariance matrix for each employer size decile and
an additional 10 moments from the disribution of realized jobs across size classes. With the
model restricted to two latent skill groups for workers and two latent productive types for
firms within each size class, the most general specification of the model primitives would
have 38 parameters associated with the production technology, 1 for the distribution of
workers across skill groups, and 18 for the number of vacancies for jobs of each type. To
satisfy the order condition for identification, we specify parameteric restrictions that express
assumptions about the relationship between firm size, vacancies, and productivity. Each of
these is discussed in turn below.
There are M = 2 types of workers; the first parameter is α, the share of the type-1
persons in the population (α is between 0 and 1). The total number of employed workers
J is known, but not the size of the labor force. We calibrate the unemployment rate at
6% (the results appear to be robust with respect to this parameter). Hence µ1 = αJ/0.94,
µ2 = (1 − α)J/0.94.
We consider 10 different size classes with two latent productive types per size class for
a total of 20 different types of firms. The index n of the firm is (s, j), where s = 1, ..., 10
indicates the size class and j = 1, 2 indicates the type of the firm. The type of the firm
represents a variation in the production function between productive and unproductive firms.
The size categories are constructed so that each size category contains the same number of
employed workers, Js . The number of jobs (vacant and filled) is not observed, but the number
of employed workers by size category is observed. We model the number of jobs as
ν s,j = π s,j [1 + exp(γ 0 + γ 1 log(σ s ))] Js
π s,2 = 1/ [1 + exp(δ 0 + δ 1 log(σ s ))]
π s,1 = 1 − π s,2
where ν s,j is the number of jobs in firm (s, j), π s,j is the share of type-j firms in the size
category s, σ s is the average size of the firms in size category s (σ s is increasing in s).
The productive type of a job has two dimensions, the size-class, s, of the firm into which
it is aggregated, and a latent productive type, j ∈ {1, 2}. The effect of size class depends
only on a single parameter, φ, and we allow the effect of the latent type to be specified
fairly generally. Since (s, j) is two-dimensional when n is one-dimensional, and because
production must increase in n to apply Shimer’s results, our parameterization must sort
output, x(m,i),(n,j) , in increasing order at every stage of our estimation procedure along the
(s, j) dimension.
We estimate several specifications of the production technology that imply different relationships between the supply and demand for skill on the one hand, and the matching of
11

skills to productive characteristics on the other. The LCA techology is additively separable
in firm and worker types, and therefore admits comparative advantage for low-ability workers in high-productivity jobs. The NCA technology is multiplicative, and therefore admits
no comparative advantage. For all of these parameterizations, we specify that the worker’s
skill type, m, and the employer’s latent productive type, j, combine thus:
x̄1,1
x̄2,1
x̄1,2
x̄2,2

=
=
=
=

χ0
χ0 + χ1
χ0 + χ2
χ0 + χ1 + χ2

where x̄m,n is the mean over (m, i) , (n, j) . To assist identification, we assume that the productive capital of the employer scales linearly with the log of firm size, σ s . Our empirical
strategy is based on estimates of two different specifications for the production technology
that embody different assumptions about the nature of comparative advantage in each sector:
• The LCA technology parameterizes output as fLCA (m, s, j) = x̄m,j + φ log(σ s )
• The NCA technology parameterizes output as fN CA (m, s, j) = exp (fLCA (m, s, j))
χ0 is fixed exogenously for identification purposes to be 0.1. Since the production technology
is required to be increasing in the productive types of both agents, we restrict χ1 > 0
and χ2 > 0. In addition to these specifications, we also estimate a quasi-nested model by
considering all production functions that can be obtained as a convex combination of the
two basic LCA and NCA technologies. That is, we consider a technology of the form:
fmix (m, s, j) = ξfLCA (m, s, j) + (1 − ξ)fN CA (m, s, j).
4.2.2

Computation

We fit the parameter ζ = (α, χ1 , χ2 , φ, δ 0 , δ 1 , γ 0 , γ 1 , ξ) to the observed data by the generalized method of moments. While the estimation strategy is standard conceptually, it is
complicated by the fact that there is not a general closed-form solution for the coordination
friction equilibrium given an arbitrary set of model primitives. Thus, there is no general
analytic closed form for the moment equations, nor for their first- and second-derivatives.
We instead use a Monte Carlo approach, simulated annealing, to find the parameter estimate
ζˆA that minimizes the generalized distance between the theoretical and empirical moments.
This procedure requires sampling the parameter space many times, solving the model at
each draw to compute the theortical moments and thereby the distance from the empirical
moments. Solving the coordination friction equilibrium for an arbitrary set of parameters is
accomplished by first solving the planner’s problem numerically for the equilibrium queues,
and then calculating the wages from the corresponding decentralized economy. The details
of these computational methods are outlined below, after first discussing the general setup
for the GMM estimation.
12

Model estimation is complicated by the absence of a closed form expression for the model
equilibrium in terms of the parameters. It is not possible to explicitly compute the partial
derivatives of the moment equations with respect to the model parameters. We therefore turn
to simulation methods to find the GMM estimator. The moment estimator, ζ̂ A minimizes
ζ̂ A = arg min QA (ζ) = arg min(m̄(D) − f (ζ))T A (m̄(D) − f (ζ))
Simulated annealing is an optimization technique that can be thought of as a variant of
greedy search that allows for ‘uphill’ moves. The uphill moves prevent the algorithm from
getting stuck in a local minimum. The probability of such a move decreases over the course of
the algorithm. During early iterations, the algorithm can easily bounce out of local minima,
leading to a more complete exploration of the parameter space.
Given the unusual nature of the problem, it is important to check that the results are
robust. In this spirit, we employ two methods to solve for the minimum distance estimator: simulated annealing and a more standard non-linear solver from the KNITRO package.
Simulated annealing has the advantage that it does not require the stepwise evaluation of
first- or second derivatives of the objective function. It also has a theoretical guarantee of
convergence to the global minimum. KNITRO is a local solver that can be applied to global
minimization by using a grid of starting values. If KNITRO converges to a better solution
than simulated annealing, or can improve the solution found through simulated annealing,
then we have not tuned the simulated annealing algorithm properly.
Simulated annealing follows an iterative structure starting from an initial guess, ζ 0 using
the algorithm:
1. Given ζ t−1 , propose candidate ζ t
2. Compute (η(ζ t ), µ(ζ t ), x(ζ t ))
3. Given (η(ζ t ), µ(ζ t ), x(ζ t )), solve for equilibrium (q(ζ t ), w(ζ t ))
4. Use (q(ζ t ), w(ζ t )) to compute theoretical (θ(ζ t ), ψ(ζ t ), λ(ζ t ))
5. Compute Q(ζ t )
6. Check Q(ζ t ) against stopping conditions.
The simulated annealing algorithm gives specific details on the process by which ζ t is proposed and the stopping conditions. When the algorithm is properly specified, the sequence
(ζ t )t will converge to the true distance-minimizing parameter. We use the Adaptive Simulated Annealing (ASA) algorithm described in Ingber (1993). Simulated annealing is known
to be effective on other estimation problems (Goffe et al. 1994), and the ASA variant of
simulated annealing has been successfully applied in a few economic settings. In spite of
theoretical assurances of convergence tuning the algorithm to the problem is essential.
At each iteration in the algorithm, we must solve the decentralized equilibrium of the
coordination friction economy. We exploit the theoretical result from Shimer’s paper that
13

the equilibrium queue lengths are identical in the decentralized economy and in a centralized
economy with a planner that faces coordination constraints equivalent to those faced by the
workers and employers. At each iteration in the minimization, it is sufficient to solve the
planner’s problem by choosing the vector of applicant queues that maximizes the economy’s
expected output. Again, because there is no closed form for these queues in terms of the
model primitives, or the parameters, we have to solve this problem by numerical methods.
This is a constrained nonlinear optimization in 40 decision variables. We have used the
built-in Matlab function fmincon as well as KNITRO to solve this problem at each iteration
with comparable results.
Once the simulated annealing procedure converges to an estimate, ζ̂ A , we use standard
results to estimate its covariance matrix as:
(F T AF )−1 F T ASAF (F T AF )−1
where F = F (ζ) = ∂f∂ζ(ζ) . F (ζ̂ A ) is computed using automatic differentiation at the parameter
estimate. We compute the sample variance of m̄, denoted S, using a bootstrap procedure.
From the full data, we compute m̄ on 1,000 bootstrap samples and compute the empirical
covariance matrix for the elements of m. We continue to impose the restriction that there is
no correlation between the sample moments across size classes, except for the estimates of
m̄S (D).
4.2.3

Identification

The parametric restrictions on the relationship between employer size and the number of
vacancies and the production technology yield an order condition necessary for identification.
It remains to be shown that model satisfies the sufficient condition for identification:
E(m̄(D)) − f (ζ) = 0 ⇔ ζ = ζ 0
where ζ 0 is the true parameter of the data generating process. We take note of a theoretical
result which states that as long as F (ζ) = ∂f∂ζ(ζ) has constant rank in a neighborhood of
ζ 0 and full-column rank at ζ 0 , then ζ 0 is locally identified (Ruud 2003). Noting that the
smallest singular value of F (ζ 0 ) is the 2-norm distance of F from the space of rank-deficient
matrices (Golub and Van Loan, 2008), it is sufficient to check this value is non-zero, since this
combined with the continuous differentiability of F in ζ ensures that there is a neighborhood
of ζ 0 for which F always has full column rank.

5

Results

We have obtained results from estimating the model under the LCA technology, NCA technology, and a nested technology in which the output from every match is a convex combination of the LCA and NCA technologies for that match given the same parameter values.
In the nested model, the parameter ξ is the weight on the LCA technology. Table 2 shows
14

estimates obtained from estimating the LCA, NCA, and nested models on data for the
Professional, Scientific and Technical Services sector and the Manufacturing sector from the
LEHD sample. We present results only for the general specification that mixes the two types
of production technology. The estimates of the LCA and NCA technologies are equivalent
to restrictions on the value of ξ. Where appropriate, we comment on the validity of those
assumed restrictions.

5.1
5.1.1

The Professional, Scientific and Technical Services Sector
Model Primitives

The estimated parameters reveal the type of workers, the type of jobs, and the production
technology in the sector. Our best estimate of the distribution of workers available for
work in the sector indicates that 86% of the workforce is of high ability, a reasonable result
given the nature of the sector. These workers sort themselves into jobs across deciles that
are distinguished in terms of productivity. Figure 7 shows the split between high and low
productivity vacancies across firm size deciles. We find that the concentration of high ability
workers is not matched by the distribution of vacancies. The majority of vacancies in this
sector are of low productivity.
The estimated production technology is illustrated in figure 8. Output is measured
in implied units that have been scaled by our assumption that χ0 = 0.1. There is very
little productive heterogeneity by employer size. However, there is a productive advantage
associated with the latent employer type, but most of the output differentials within this
sector are associated with matches of high ability workers into high productivity employers.
Output in those matches is roughly four times greater than the output in other matches.
Combining the estimated production technology with the estimated distribution of vacancies,
we note that this sector is composed of a large low-productivity segment of jobs in which
it does not matter much what kind of worker is employed. These are complemented by a
small high productivity segment in which there is a substantial advantage to employing high
ability workers.
5.1.2

Characteristics of the Estimated Equilibrium

The estimated equilibrium wages and job assignments in the Professional Services sector
reflect a small degree of positive assortative matching of workers to jobs. The equilibrium
wages, illustrated in figure 9, reflect the peculiarities of the coordination friction equilibrium.
Note that even though there is a very high production advantage to high ability workers in
high ability jobs, the low ability workers actually have a higher equilibrium wage offer from
high ability employers. In terms of the model, this occurs because there are so few high
productivity jobs and so many high ability workers that competition limits the wages that
high ability workers receive. At the same time, the high productivity employers limit their
risk of vacancy by making sure even low ability workers are willing to apply for those jobs.
The high wage offers received by low ability workers is compensation for the unemployment

15

risk they face in applying for those jobs. The expected income from applying for such a
job has to balance the expected income from applying for a low productivity job, which can
almost always be obtained due to the large number of low productivity vacancies relative to
the number of job-seekers.
The positive assortative matching result follows from the fact that the estimated production technology is primarily one with no comparative advantage. How the assortativity of
matching manifests itself in this sector is revealed in figures 10 and 11. The first figure shows
the probability that a low ability worker applies to high productivity and low productivity
employers. The second shows the same probabilities for high ability workers. For both ability
types, the application probabilities sum to one. Most of the mass is concentrated on the low
productivity jobs since there are many more of them, and the shape is goverened by the way
vacancies are distributed across the size classes. Note that the probability of application to
low productivity jobs is considerably higher for low ability workers. In other words, better
workers are more likely to apply for better jobs, and, of course, to receive them conditional
on applying for them. These application strategies result in the expected distribution of
realized matches shown in figures 12 and 13.
The low productivity vacancies are occupied by a mixture of high and low ability workers,
as shown in figure 12. We also see that there is a large number of unoccupied vacancies in
equilibrium. By contrast, high productivity jobs, which are a small fraction of the total
number of jobs, are almost entirely occupied in equilibrium by high ability workers. Based
on these estimates of the number of occupied vacancies, we estimate that 88% of the employed
workforce is of high productivity. In addition, fully 85% of the filled vacancies are of low
productivity.
The estimates give an overall impression of this sector as being split between a large,
low productivity segment and a small high productivity segment. In the low productivity
segment, workers’ ability differentials are largely irrelevant to production. Furthermore,
there are sufficiently many vacancies that the coordination friction is not binding. Workers
can be relatively certain of obtaining a job conditional on applying for it. By contrast, the
high productivity segment has very few vacancies and pays much higher wages. Thus, many
workers queue for, but fail to receive, these jobs. The relatively mild correlation we observe
between wage components hides the extent of sorting both because there are relatively few
high productivity vacancies and low ability workers. In addition, the low ability workers
actually earn higher wages when they are employed in high productivity jobs.

5.2
5.2.1

The Manufacturing Sector
Model Primitives

The estimated parameters in the manufacturing sector are listed in the second column of
table 2. We estimate that 92% of the workforce participating in this sector is of low productivity. This sector is characterized by a dominance of low productivity vacancies. Figure 14
shows the distribution of vacancies between high and low productivity jobs across deciles of
the employer size distribution. Here though, the estimates suggest that most of the high pro16

ductivity vacancies are concentrated in smaller firms, rather than being evenly distributed
by size. The mixing parameter on the production technology, ξ is essentially equal to 1,
providing strong evidence that there is a comparative advantage for low ability workers in
high productivity jobs. The estimated output indicates that both worker and employer types
have a relevant impact on output.
5.2.2

Characteristics of the Estimated Equilibrium

The estimated equilibrium wages (figure 16) show that high ability workers receive the same
wage in most jobs that they actually occupy in equilibrium. By contrast, low ability workers
receive a wage premium when they obtain high productivity jobs. The application behaviors
of both types of workers reflect the incentives created by these wages and the nature of
comparative advantage that is ultimately reflected in the equilibrium assignment of workers
to jobs. Low ability workers are more likely to apply to high productivity jobs than are high
ability workers. As a result, we see in figure 20 that a large portion of the high productivity
vacancies are filled by low ability workers.
When we consider the estimated equilibrium job matches, we find that 88% of the workforce employed in this segment is of low ability, and 98% of the occupied job vacancies are
of low productivity. Therefore, there is very little variation, especially for larger firms in
employer type. Hence, the small correlations between estimated wage components are an
artefact of the very small amount of heterogeneity in employer types in the sector. Nevertheless, the model does a rather good job of capturing the empirical correlation between θ̂
and ψ̂. Figure 21 shows the estimated and actual correlations. The model captures both
the overall location of these correlations as well as some of the variation across deciles of the
employer size distribution.

6

Conclusion

We implemented a formal test of Shimer’s model of job assignment with coordination frictions. The full structural model was estimated using the method of moments. The model
predicts the equilibrium number of job matches as well as the empirical moments of the joint
distribution of estimated person and employer effects from a linear decomposition of log labor earnings. Our estimates of this model for two major sectors of the U.S. economy provide
evidence that there is matching in the labor market in terms of comparative advantage, but
the empirical relevance of matching is attenuated because there is insufficient heterogeneity
of workers and employers for assignment to influence the distribution of earnings.
This paper provides some of the first estimates of a structural job assignment model
with transferrable surplus using matched employer-employee data. These estimates allow a
structural interpretation of the observed correlations between person and employer effects
from the log wage decomposition. While we have focused in this paper on estimating the
assignment model with coordination friction, our empirical strategy is general. Any model
that delivers a wage offer function which depends on both worker and employer type and
17

which predicts the way in which workers match to jobs in equilibrium could be estimated
using this strategy.
Estimates from both sectors, Professional Services and Manufacturing, have similar characteristics. The underlying production technology should generate comparative advantage.
In the case of Professional Services, there is positive assortative matching, while in Manufacturing the estimated production technology has a comparative advantage for low ability
workers in high productivity employers. In both cases, the influence of sorting by comparative advantage is limited because there are very few of the workers who should be sorting
into low productivity jobs. Likewise, there is a very limited number of high productivity
vacancies. In other words, each sector has a small, high productivity segment that generates
unemployment based on queueing.

18

Bibliography
Abowd, J. M., Creecy, R. H. and Kramarz, F. (2002). Computing person and firm effects
using linked longitudinal employer-employee data, Technical Report TP-2002-06, LEHD,
U.S. Census Bureau.
Abowd, J. M., Haltiwanger, J. C. and Lane, J. I. (2004). Integrated Longitudinal EmployeeEmployer Data for the United States, American Economic Review 94(2).
Abowd, J. M., Kramarz, F. and Margolis, D. N. (1999). High wage workers and high wage
firms, Econometrica 67(2): 251–333.
Abowd, J. M., Lengermann, P. and McKinney, K. L. (2003). The measurement of human
capital in the u.s. economy, Technical Report TP-2002-09, LEHD, U.S. Census Bureau.
Abowd, J. M., Stephens, B. E., Vilhuber, L., Andersson, F., McKinney, K. L., Roemer,
M. and Woodcock, S. (2009). Producer Dynamics: New Evidence from Micro Data,
Chicago: University of Chicago Press for the National Bureau of Economic Research,
chapter The LEHD Infrastructure Files and the Creation of the Quarterly Workforce Indicators, pp. 149–230.
Bjelland, M. J. (2007). Empirical Analyses of Job Displacements and Productivity, PhD
thesis, Cornell University.
Goffe, W. L., Ferrier, G. D. and Rogers, J. (1994). Global optimization of statistical functions
with simulated annealing, Journal of Econometrics 60: 65–99.
Ingber, L. (1993). Adaptive simulated annealing (asa) global optimization c-code, Technical
report, Caltech Alumni Association.
Mortensen, D. T. (2003). Wage Dispersion: Why Are Similar Workers Paid Differently,
Zeuthen lecture book series, MIT Press.
Postel-Vinay, F. and Robin, J.-M. (2002). Wage dispersion with worker and employer heterogeneity, Econometrica 70: 2295–350.
Roy, A. D. (1951). Some thoughts on the distribution of earnings, Oxford Economic Papers
3: 135–146.
Shimer, R. (2005). The assignment of workers to jobs in an economy with coordination
frictions, Journal of Political Economy 113: 996.
Stevens, D. W. (2002). Employment that is not covered by state unemployment, Technical
Report TP-2002-14, LEHD, U.S. Census Bureau.
Woodcock, S. (2008). Wage differentials in the presence of unobserved worker, firm, and
match heterogeneity, Labour Economics 15: 772–794.
19

Appendices
A

An Economy with Heterogeneous Workers and Firms

In this Appendix we derive worker and firm effects in an economy with only two types of
workers and a continuum of firms differing by size and production technology. Notation in
this appendix differs slightly from the notation in the main paper in order to accommodate
the more general specification.

A.1

The Economy

Let the economy consist of two types of workers. This is not as limiting as it sounds, for it
may only represent heterogeneity inside a particular class of workers since we consider the
effects net of observables. The economy is divided in a finite number k̄ of industries. The
workers are hired by a continuum of firms, indexed by the share x of type 1 workers each
firm hires, the size t of the firm, and the industry k. The share x is unobserved by the
econometrician. In industry k, there is a mass (density) µk (x, t) of firms of type (k, x, t). We
omit from what follows the k index except when it is necessary.
The economy as a whole is represented by the space Ω = {Ω1 , . . . , Ωk̄ } with
R Ωk = [0, 1] ×
+
R , the
R space defining each industry. There is a quantity (or number) J = Ω dµ of firms,
Jk = Ωk dµk in each industry. Firm (x, t) hires xt of type 1 workers, and (1 − x)t of type 2.
R
R
We write Ω xt dµ(x, t) = M and Ω (1 − x)t dµ(x, t) = N so that there are M + N workers
in the economy. Type 1 workers earn w(x, t, k) in firm (x, t) in industry k while type 2 earn
u(x, t, k); the wage only depends on the industry, the share of type 1 workers, and the size
of the firm.

A.2

The Economy as Estimated by Person and Firm Effects

As in Abowd et al. (1999) (hereafter, AKM99), decompose the individual wage, ln wi,j(i,t),t ,
after conditioning for observables, in each period as the sum of an individual effect, θi , a
firm effect, ψ j(i,t) , and a residual, εi,j(i),t
ln wi,j(i,t),t = θi + ψ j(i,t) + εi,j(i),t
We consider here only the limiting (and purely theoretical) case where the number of time
periods goes to infinity and the workers visit ergodically all firms and all industries. This
frees us from the identification problem discussed in detail in the above paper. Moreover,
the effects estimated in AKM99 would converge in probability to the theoretical values we
show below.
In this case, even though the type of the worker is not directly known by the econometrician, observing the workers jump from job to job provides enough information to be able
to reduce the above ordinary least squares (OLS) problem to the following minimization
20

problem. Find W , U (worker effects) and ψ(k, x, t) (firm effect in industry k for a firm of
size t hiring a proportion x of type 1 workers) that solve
Z


min
xt (w(x, t) − W − ψ(x, t))2 + (1 − x)t (u(x, t) − U − ψ(x, t))2 dµ(x, t).
(12)
W,U,ψ

Ω

This problem is exactly equivalent to minimizing the sum of squared residuals in ordinary
least squares. The solutions to this problem are unique up to a constant. We show that:
Theorem 2 Under integrability assumptions on w and u, the solutions to the OLS program
(12) are of the type
R
x(1 − x)tw(x, t)
R
+ Λ,
(13)
W =
x(1 − x)t
R
x(1 − x)tu(x, t)
R
U=
+ Λ,
(14)
x(1 − x)t
ψ(x, t) = x(w(x, t) − W ) + (1 − x)(u(x, t) − U ) − Λ
(15)
where the integrals are all taken on Ω with respect to the measure µ, and Λ is an arbitrary
constant (we will set Λ = 0 in the rest of the paper).
Proof. Set U = 0 forR the time being, as the solutions are only identified up to a constant.
Let us write J(W, ψ) = Ω ρ(W, ψ)(x, t) dµ(x, t). J is defined on R × L2 (Ω, µ), and may take
the value +∞. It is clear that ρ is convex in its two arguments (as sum of two squares);
hence J is also convex, and can be show to be strictly convex if w(x, t) − u(x, t) is not a
constant. Hence it has a unique minimum under this assumption, characterized by the first
order constraints
Z
xt(w(x, t) − W − ψ(x, t)) dµ(x, t) = 0
(16)
Ω
Z
xt(w(x, t) − W − ψ(x, t)) + (1 − x)t(u(x, t) − ψ(x, t)) = 0
(17)
Ω

R

R
Hence W = xt(w − ψ) dµ/ xt dB and ψ = x(w − W ) + (1
ψ by this
R −2 x)u. Replacing
R
last
value
in
equation
16
and
simplifying
with
the
fact
that
x
t
=
M
−
x(1
−
x)t and
R 2
R
R
x tw = xtw − x(1 − x)w proves the theorem.
Remark 3 (Some special cases) If all firms hire the same number of both types of workers,
the distribution µk for all k is δ 1/2,2 , a Dirac distribution
of firms
P
P of equal size1 and same
number of type 1 workers. This leads to W = k wk /k̄, U = k uk /k̄, ψ k = 2 (wk − w̄ +
uk − ū), where wk is the wage in industry k.
The case where the distribution µ has all mass in t at t = 2 and w(x, t) = u(x, t) + δ leads
to W = U + δ̄ and ψ(x, t) = u(x) − U .

21

We define the firm-employee effects covariances cov(θ̂, ψ̂) as
R
R
R
(xtW + (1 − x)tU ) dµ ψ(x, t) dµ
(xtW + (1 − x)tU )ψ(x, t) dµ
R
R
R
−
t dµ
t dµ
t dµ

(18)

For total covariance the integrals are taken over Ω, for within-sector covariance over Ωk for
all k, and the between-sector covariance is the discrete covariance between the means (i.e.
integrals) on the Ωk . Total covariance is as usual the sum of between-sector and within-sector
covariances.

B

Data Appendix

We use data from the Longitudinal Employer-Household Dynamics Program (LEHD), universe data for four large American states with information from 1990-2004. See Abowd et al.
(2004) and Abowd et al. (2009) for more detailed discussions of the underlying data.

B.1

Unemployment Insurance

The individual data were derived from the universe of unemployment insurance (UI) quarterly wage records from four of the following seven states: California, Florida, Illinois, Maryland, Minnesota, North Carolina, and Texas.4 The BLS Handbook of Methods (1997) describes UI coverage as “broad and basically comparable from state to state,” and claims
over 96 percent of total wage and salary civilian nonfarm jobs were covered in 1994. The
Federal Unemployment Tax Act (FUTA), first enacted in 1938, lays the ground rules for the
kinds of employment which must be covered in state unemployment insurance laws. While
technically mandating coverage of all employers with one or more employees in a calendar
year, FUTA allows for numerous exceptions to covered employment (Stevens 2002). These
include workers at small agricultural co-operatives, employees of the federal government,
and certain employees of state governments, most notably elected officials, members of the
judiciary, and emergency workers. According to the Handbook, UI wage records measure
“gross wages and salaries, bonuses, stock options, tips, and other gratuities, and the value of
meals and lodging, where supplied.” They do not include OASDI, health insurance, workers
compensation, unemployment insurance, and private pension and welfare funds. Individuals
are uniquely identified and followed for all quarters in which their employers had reporting
requirements in the UI system. Thus, cross-state mobility can be observed for individuals
moving between any of the seven states for which we have data. Although coverage dates
vary, all states provide between seven and thirteen years of data. Table 1 in Abowd et al.
(2003) (ALM, hereafter) details the starting dates and number of individuals appearing in
each of these states up to the year 2000. In our analysis, by combining them into a single
4

We cannot disclose which states are included in the analysis as a condition imposed by the Census
Bureau on the public use data. We can, however, release our analysis moment matrices to any user who
requests them as they have been designated as public-use data.

22

“pooled” file, we have information on approximately 75 million workers, accounting for over
40% of the U.S. workforce.

B.2

Creation of Variables

Using Census Bureau and other LEHD data bases, sex, race, date of birth, and education
are combined with the individual earnings data.5 When a variable was created with an
exact link to another database, the actual value from that data source is used. When a
variable was created with a statistical link to another database, the value of the variable
is imputed 10 times, thereby providing information on the precision of the statistical links.
Upon each individual’s first appearance in the data, labor force experience as potential labor
force experience (age - education - 6) is calculated. In subsequent periods, experience is
measured as the sum of observed experience and initial (potential) experience. The UI wage
records connect individuals to every employer from which they received wages in any quarter
of a given calendar year. Therefore, individual employment histories are constructed using
the same personal identifier used in the individual data. Employers are identified by their
state unemployment insurance account number (SEIN). While large employers undoubtedly
operate in multiple states, their SEINs are unfortunately state specific, meaning they cannot
be connected. In addition, while we match workers to their employers, it is not possible
to connect those employed in firms with multiple establishments to specific places of work.
This problem is not overly pervasive, as over 70% of employment occurs in firms with only a
single establishment. There are approximately 4.7 million firms in this version of the data.

B.3

Earnings

For every year an individual appears in a state, a “dominant” employer — the employer for
whom the sum of quarterly earnings is the highest—is identified in order to better approximate the individual’s full-time, full-year annual wage rate using the following steps. First,
define full quarter employment in quarter t as having an employment history with positive
earnings for quarters t − 1, t, and t + 1. Continuous employment during quarter t means
having an employment history with positive earnings for either t − 1 and t or t and t + 1.
Employment spells that are neither full quarter nor continuous are designated discontinuous.
If the individual was full quarter employed for at least one quarter at the dominant employer,
the annualized wage is computed as 4 times average full quarter earnings at that employer
(total full quarter earnings divided by the number of full quarters worked). This accounts for
84% of the person-year-state observations in our eventual analysis sample. Otherwise, if the
individual was continuously employed for at least one quarter at the dominant employer, the
annualized wage is average earnings in all continuous quarters of employment at the dominant employer multiplied by 8 (i.e., 4 quarters divided by an expected employment duration
during the continuous quarters of 0.5). This accounts for 11% of all observations. For the
5

Sex, race, and date of birth are based on an exact match to administrative data. Education is based on
a statistical match.

23

remaining 5%, annualized wages are average earnings in each quarter multiplied by 12 (i.e.,
4 quarters divided by an expected employment duration during discontinuous quarters of
0.33).

B.4

Annual Hours of Work and Full-time Status

We restrict our sample to individuals who worked full-time for their dominant employer.
Full-time status is taken to mean that the individual worked at least 35 hours per week. The
average number of hours per week for a worker is given by dividing the number of hours
worked over the year with the dominant employer by the number of weeks worked. The
number of weeks worked is approximated based on the observed number of full, continuous,
and discontinuous quarters with one’s dominant employer. Specifically, we compute weeks
worked as 13 times the number of full quarters + 6.5 times the number of continuous quarters
+ 4.33 times the number of discontinuous quarters. Annual hours of work are observed for a
subset of individuals in the sample via a database link to other LEHD and Census sources.
For those missing annual hours of work, a value is statistically assigned using a Bayesian
multiple imputation procedure. Bjelland (2007) provides complete details of the imputation
of annual hours of work.
Our analysis sample is restricted to individuals aged 18-70, employed full-time at their
dominant employer. Table 1 presents sample means for several earnings, demographic, industry, and labor force attachment variables for the period 1990-2004. The final analysis
sample contains 278 million person-year-state observations for the aforementioned 75 million
individuals and 4.7 million firms. In comparison to the base LEHD file, this analysis file
has considerably higher wages and earnings, and is slightly more educated, male, white, and
experienced.

24

C

Tables and Figures
Table 1: Summary of the LEHD Data

N
277,527,039
Log Raw Earnings ($2000)
9.64
Education
13.48
Male
0.57
Age
37.82
White
0.62
Annual Hours
1952.46
Theta (Person-Effect)
0.07
Psi (Firm-Effect)
0.12
Employer Size
3543.69
Native
0.84
Note: Earnings data originate from Unemployment Insurance wage records of four states in
the LEHD database between 1990-2004. Demographic characteristics were added through
database links to other Census Bureau and
LEHD sources. Education and annual hours of
work have been imputed using multivariate multiple imputation procedures. The sample is restricted to full-time workers, aged 18-70, employed in their dominant jobs. Source:Authors’
calculations.

25

Table 2: Estimates of the Model Parameters
Parameter
α
χ1
χ2
φ
δ0
δ1
γ0
γ1
ξ
Residual

Prof. Svcs.
0.139
(0.0001)
2.133
(0.0007)
3.829
(0.0116)
0.027
(0.0004)
2.322
(0.0063)
0.022
(0.0009)
1.681
(0.0507)
-2.216
(0.0376)
0.105
(0.0048)
0.0900

Mfg.
0.924
(0.0003)
0.767
(0.0009)
3.106
(0.0030)
0.0282
(0.0001)
0.358
(0.0047)
1.034
(0.0021)
-0.276
(0.0321)
-1.616
(0.0102)
0.999
(0.0000)
0.0214

GMM parameter estimates for the nested model that mixes the
two technologies according to the parameter ξ. See text for details.
Standard errors in parentheses.

26

Figure 1: Average θ̂ and ψ̂ by employer size class: Professional, Scientific and Technical
Services Sector (NAICS 541)

Figure 2: Average θ̂ and ψ̂ by employer size class: Professional, Scientific and Technical
Services Sector (NAICS 541)

27

Figure 3: Correlation of θ̂ and ψ̂ by employer size class: Professional, Scientific and Technical
Services Sector (NAICS 541)

Figure 4: Average θ̂ and ψ̂ by employer size class: Manufacturing Sector (NAICS 31-33)
28

Figure 5: Average θ̂ and ψ̂ by employer size class: Manufacturing Sector (NAICS 31-33)

Figure 6: Correlation of θ̂ and ψ̂ by employer size class: Manufacturing Sector (NAICS
31-33)

29

Figure 7: Estimated Distribution of Vacancies by Employer Size Decile: Professional, Scientific and Technical Services Sector (NAICS 541)

Figure 8: Estimated Output: Professional, Scientific and Technical Services Sector (NAICS
541)

30

Figure 9: Estimated Equilibrium Wage Offers: Professional, Scientific and Technical Services
Sector (NAICS 541)

Figure 10: Estimated Equilibrium Application Probabilities for Low Ability Workers: Professional, Scientific and Technical Services Sector (NAICS 541)

31

Figure 11: Estimated Equilibrium Application Probabilities for High Ability Workers: Professional, Scientific and Technical Services Sector (NAICS 541)

32

Figure 12: Estimated Equilibrium Occupancy of Low Productivity Jobs: Professional, Scientific and Technical Services Sector (NAICS 541)

Figure 13: Estimated Equilibrium Occupancy of High Productivity Jobs: Professional, Scientific and Technical Services Sector (NAICS 541)

33

Figure 14: Estimated Distribution of Vacancies by Employer Size Decile: Manufacturing
Sector (NAICS 31-33)

Figure 15: Estimated Output: Manufacturing Sector (NAICS 31-33)

34

Figure 16: Estimated Equilibrium Wage Offers: Manufacturing Sector (NAICS 31-33)

Figure 17: Estimated Equilibrium Application Probabilities for Low Ability Workers: Manufacturing Sector (NAICS 31-33)

35

Figure 18: Estimated Equilibrium Application Probabilities for High Ability Workers: Manufacturing Sector (NAICS 31-33)

36

Figure 19: Estimated Equilibrium Occupancy of Low Productivity Jobs: Manufacturing
Sector (NAICS 31-33)

Figure 20: Estimated Equilibrium Occupancy of High Productivity Jobs: Manufacturing
Sector (NAICS 31-33)

37

Figure 21: Estimated Equilibrium Occupancy of High Productivity Jobs: Manufacturing
Sector (NAICS 31-33)

38

