NBER WORKING PAPER SERIES

MARKET FRICTIONS, ARBITRAGE, AND THE CAPITALIZATION OF AMENITIES
Amine Ouazad
Romain Rancière
Working Paper 25701
http://www.nber.org/papers/w25701

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
March 2019

We would like to thank Joël David, Morris Davis, Mariacristina De Nardi, Anthony Heyes,
Matthew E. Kahn, Patrick Kehoe, Adam Lavecchia, Robert Lucas, Fabrizio Perri, Hashem
Pesaran for helpful comments, as well as the audience of the Federal Reserve of Minneapolis
seminar series, the University of Southern California’s conference on housing and the
macroeconomy, the meeting of the Canadian Economics Association, and seminar series at the
University of Ottawa and Université Laval. The authors acknowledge financial support from
HEC, INET, and USC. The views expressed herein are those of the authors and do not necessarily
reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2019 by Amine Ouazad and Romain Rancière. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Market Frictions, Arbitrage, and the Capitalization of Amenities
Amine Ouazad and Romain Rancière
NBER Working Paper No. 25701
March 2019
JEL No. G12,G21,R21,R3,R31
ABSTRACT
The price-amenity arbitrage is a cornerstone of spatial economics, as the response of land and
house prices to shifts in the quality of local amenities and public goods is typically used to reveal
households' willingness to pay for amenities. With informational, time, and cash constraints,
households' ability to arbitrage across locations with different amenities (demographics, crime,
education, housing) depends on their ability to compare locations and to finance the swap of
houses. Arbitrageurs with deep pockets and better search and matching technology can take
advantage of price dispersions and unexploited trade opportunities. We develop a disaggregated
search and matching model of the housing market with endogenously bargained prices, identified
on transaction-level data from the universe of deeds for 6,400+ neighborhoods of the Chicago
metropolitan area, matched with school-level test scores and geocoded criminal offenses. Priceamenity gradients reflect preferences and the capitalization of trading opportunities, which are
arbitraged away in the frictionless limit. Thus the time-variation in hedonic pricing coefficients
partly reflects the time variation in search and credit frictions. Our model is able to explain that,
between the peak of the housing boom and its trough, the sign of the price-amenity gradient
flipped, due to the decline in trading opportunities in lower-amenity neighborhoods and due to the
lower capitalization of trading opportunities in house prices.

Amine Ouazad
HEC Montreal
3000, Chemin de la Cote Sainte Catherine
H3T 2A7, Montreal, QC
Canada
aouazad@gmail.com
Romain Rancière
Department of Economics
University of Southern California
Los Angeles, CA 90097
and NBER
ranciere@usc.edu

1

Introduction

The capitalization of amenities into land and house prices changes over time. The relative prices
of neighborhoods fluctuate substantially more than what changes in neighborhood amenities would
imply, even when accounting for the expected flow value of future neighborhood amenities. Rationalizing the change in such capitalization with shifts in the distribution of preferences requires
substantial shifts in buyers’ and sellers’ preferences for amenities. In the city of Chicago between
2007, right before the mortgage bust, and 2010, during the trough of the mortgage crisis, prices
in neighborhoods with low school test scores and high crime rates collapse dramatically compared
to neighborhoods with better schools and lower crime, after controlling for a large array of observables and unobservable characteristics. This paper proposes and estimates a disaggregated dynamic
model of housing choices with endogenous prices, search and credit frictions that can explain such
changes in the capitalization of amenities into individual house prices. The model explains housing
decisions as resulting from preferences but also from trading opportunities, including the opportunity to “trade-up” in the future. While the distribution of preferences is stable over time, trading
opportunities change drastically, reflecting time-variation in credit and matching frictions, and especially so time-variation in mortgage indebtedness, interest payments, and approval rates. We find
that such variations explain a significant part of the variation in the time-varying capitalization of
amenities. The model is estimated for Chicago over the period 2005-2013 taking advantage of the
drastic changes in credit conditions over the period.
A key novel insight of our dynamic approach is to show how neighborhood dynamics depend
on a simple index of trading opportunities, which is defined as the diﬀerence between the lifetime
expected value of living in a neighborhood – which includes the flow value of amenities and the
option to move out of it at some point – and the lifetime expected value of owning, maintaining,
and receiving potential rental payments for a vacant home in the same neighborhood; the latter
value is also the reservation value, i.e. the lowest price at which its owner is ready to sell the unit.
The index of trading opportunities determines the relative attractiveness of neighborhoods in the
city. Homeowners would like to leave neighborhoods for which the index of trading opportunities is
low – that is the amenity value of their home is low but their market value is high – and to move
into a neighborhood for which the opposite is true. The diﬀerence of index of trading opportunities

2

between two neighborhoods is exactly equal to the joint surplus of transactions between a buyer
moving into a unit and a seller selling a vacant home.
The key role played by trading opportunities establishes a new link between two key areas of
economics: the literature on price-amenity trade-oﬀs in housing choices, and the literature on the
limits to arbitrage in asset markets. We show that in the absence of search and credit frictions,
deep-pocketed arbitrageurs could fully exploit existing arbitrage opportunities across neighborhoods.
They would do so by buying a vacant home in neighborhoods where the index of trading opportunities is low, and sell it to buyers in neighborhoods in which the index of trading opportunities is
high; by this process, the index of trading opportunities is equalized across neighborhoods. Therefore the persistence of diﬀerences in trading opportunities across neighborhoods reveals the limits to
arbitrage due to search and credit frictions, which may prevent households from “trading-up” their
home for another for which the price-amenity trade-oﬀ is more favorable.
Individual households face search and mortgage credit frictions, and their forward-looking decisions to buy and sell houses are constrained by such frictions. When purchasing a new house, the
homeowner vacates his current house and lists it on the market. When making oﬀers, home buyers
consider the value of enjoying the amenities of the new home, as well as the value of moving out
and putting their existing house on the market. In doing so, moving in to a new unit depends on
the comparison of trading opportunities across neighborhoods. Mortgage credit conditions are an
important source of friction faced by households when making their location choices. Borrowers
with a mortgage balance that exceed their value of their house face limited mobility options. Indebted homeowners are exposed to both interest rate risk and also risk to the value of their equity,
endogenously pinned down by the market equilibrium. The ability to secure a mortgage for a new
home depends crucially on the build-up of equity in the previous home as well as current lending
standards.
This paper’s dynamic general equilibrium model of housing choices incorporates search and credit
conditions in housing choices. With constant preferences, increases in housing market liquidity and
the relaxation of credit conditions leads to substantial shifts in the ability of households to arbitrage
between locations, and thus to shifts in the price-amenity relationship. We show that evolution of
the index of trading opportunities across neighborhoods, the demographics of inflows and outflows,
and the dynamics of mortgage balances are jointly suﬃcient to fully identify households’ preferences
3

for amenities, the matching technology, credit frictions and households’ time discount factor. In
turn, such parameters fully characterize city dynamics, including listings, sales, transaction prices,
and flows.
The central novel theoretical result of the paper is the exact derivation of the price-amenity
gradient as the sum of three components: the current flow of utility of owning a house, the expected
future utility flows of owning a house, and the trading opportunities-amenity gradient weighted by
capitalization of trading opportunities into prices. Variation in credit market frictions aﬀects the
price-amenity gradient through both the dynamics of trading opportunities and the variation of
its capitalization into house prices. A tightening of credit frictions implies that households will be
less able to seize future trading-up opportunities, which, in turn, reduces their mobility and thus
the sale of housing units to households from other neighborhoods. This causes a decline in the
neighborhood’s current index of trading opportunities. For a giving set of trading opportunities,
the tightening of credit constraints also reduces the set of potential trades that generate a surplus
for buyers and sellers. This corresponding reduction in sales reduces the capitalization of trading
opportunities into prices. The combined variations in trading opportunities and its capitalization
into prices lead to variations in the price-amenity gradient.
The model is identified using flows of buyers to each of the 6,400+ neighborhoods and the
corresponding transaction prices. The diﬀerence with a Hotz & Miller (1993) structural estimation
approach is that, in this model with endogenously Nash-bargained prices, the flows identify trading
opportunities rather than values. Hence the 2005-2013 gross flows to each of the neighborhoods
yield the trading opportunities across locations by demographic subgroup. The observation of
prices disentangles the value of owner occupation from the value of vacant or rented out units. By
projecting values on a flexible polynomial of amenities, we can identify the functional form tying
values to amenities, and then estimate the expectation of future values for each neighborhood using
numerical integration. Annual vacancies by neighborhood provide matching probabilities. Observed
approval rates, current mortgage balances, and expected interest cost payments provide estimates
of credit frictions. Finally, the regression of current values on current amenities and expectations,
potentially aﬀected by credit frictions, identifies the time discount factor. These steps fully identify
preferences, the matching technology, credit frictions, and the time discount factor.
The model is estimated using the universe of transactions, the universe of mortgages, and mort4

gage applications for the Chicago metropolitan area between 2005 and 2013, a period that includes
the end of the credit boom, the mortgage crisis, and the post-crisis recovery. While credit conditions
and transaction prices experience large variations, the estimated model delivers stable estimates of
households’ preferences for amenities. Importantly, incorporating mortgage credit characteristics
significantly impact the estimates of household preferences, and in particular their discount factor
and preferences for same-race neighbors.
The empirical analysis shows how the model-estimated decomposition of the price-amenity gradient can account for its drastic steepening between 2007 (the peak of the housing boom) and 2010
(the trough of the mortgage crisis). Between 2007 and 2010, the neighborhoods at the bottom of
the distribution of amenities, which are for a large part located in the West-Side and South-Side
of Chicago, experience larger increases in mortgage balances, larger decreases in trading opportunities, and large declines in house prices compared to the rest of the MSA. In contrast, controlling for
trading opportunities yields a very stable relationship between prices and amenities over the period
2005-2013. This yields the key empirical result of the paper: fluctuations in the price-amenity gradients are mostly explained by fluctuations in the distribution of trading opportunities, and their
capitalization into prices, rather than by variations in current and future utility flows. Consistent with the model’s predictions, the fall in trading opportunities and of their capitalizations into
prices appear partly driven by the tightening of credit frictions, and especially so by the increase in
the ratio of mortgage balances over current house prices, and the associated rise of “underwater ”
mortgages.
The paper’s results have substantial implications for the measurement of households’ preferences
for public goods. Households’ trade-oﬀ between house prices and amenities has underpinned the
literature on the capitalization of amenities, as equilibrium prices are determined by households’
willingness to pay for locations (Alonso et al. 1964, Rosen 1974, Roback 1982, Benabou 1996).
The relationship between house prices and households’ preferences for amenities is a key way to
measure the dollar value of benefits of public good investment in education (Black 1999), the
environment (Cragg & Kahn 1997), crime reduction (Linden & Rockoﬀ 2008), and transportation
infrastructure (Chen & Haynes 2015).
This paper contributes to an emerging literature that highlights the importance of dynamic considerations in the understanding of relationships between prices and amenities. Bishop & Murphy
5

(2011) shows that hedonic pricing estimates based on current amenities underestimate the preference for amenities when such amenities are mean-reverting. This paper endogenizes the 3-way
neighborhood-level price negotiation between buyer, seller, and lender. Endogenous prices reflects
both local market tension and time-varying credit frictions, which is key in obtaining precise and
stable estimates of household preferences. Furthermore, understanding the dynamics of such frictions and their impact on trading opportunities explains a substantial share of time-variations in
the price-amenity relationship.
This paper connects the literature on urban choices with the literature on the limits to arbitrage
in assets markets. In finance, a series of seminal papers shows how financing constraints can lead
to mispricing (Shleifer & Vishny 1997, Gromb & Vayanos 2002, Gromb & Vayanos 2015), as such
constraints imply that long-run prices can diﬀer from fundamentals. In housing markets, given the
greater level of diﬀerentiation, segmentation in search, and the lower levels of liquidity, mispricing is
also a likely salient feature and arbitrage opportunities are arguably pervasive. For instance, Glaeser
& Gyourko (2007) provides evidence that the no-arbitrage rental-ownership relationship may not
hold. Within the set of diﬀerentiated locations of the city, this paper provides a closed–form
expression describing how search costs and credit frictions imply long-run diﬀerentials between
prices and the value of amenities; professional arbitrageurs with access to better search technology
and/or less liquidity constraints than individual households may take advantage of mispricing and
narrow the distribution of prices.1 This paper’s structural estimates pinpoint the spatial location
of such arbitrage opportunities.
The paper also contributes to the emerging literature that describes the importance of the withincity dispersion of house prices along the business cycle (Liu, Nowak & Rosenthal 2016). Following
the reasoning of recent contributions (Bayer, Ferreira & McMillan 2007, Bayer, McMillan, Murphy
& Timmins 2016), such within-city variations could be explained by describing how amenities are
priced at diﬀerent percentiles of the distribution of households’ preferences in diﬀerent parts of the
business cycle – generating cyclicality in the pricing of amenities without the need to introduce
market frictions. Other key contributions (Gabriel, Hearey, Kahn & Vaughn 2016) describe how
preferences for amenities themselves vary across the business cycle, e.g. as the returns to education
1

Combined with access to more sophisticated market information, companies such as Opendoor and Zillow have
started engaging in directly buying and selling; and thus may resemble this paper’s arbitrageurs. A short introduction
to these new players is featured in Manjoo (2017).

6

can be higher during a boom. This paper suggests that the capitalization of amenities can vary even
without preference heterogeneity and without temporal variation in households’ willingness to pay
for amenities due to changes in credit frictions aﬀecting the ability of households to exploit trading
opportunities.
The paper is structured as follows. Section 2 presents the theoretical framework: the model of
the city with diﬀerentiated locations and endogenous prices; the existence of a steady-state; and
the short- and medium-run transition dynamics to the long-run steady-state. Section 3 provides a
closed-form expression of the price-amenity gradient as a function of preferences, trading opportunities, search and credit frictions. Section 4 identifies the city’s structural parameters (preferences,
matching technology, and time discount factors). Section 5 introduces the transaction-level data
from the 14 counties of the Chicago metropolitan area. Section 6 presents the estimates of household
preferences and empirically analyzes the role of credit frictions in the evolution of the price-amenity
gradient. Section 7 concludes.

2

Theoretical Framework

2.1

The Model

The city is composed of J neighborhoods indexed by j. The j-th neighborhood has hj housing units.
The observable amenities of neighborhood j are noted zj , a vector of size K. The unobservable
amenities are a J-vector of scalars "j with variance

2
".

Stacked into a J ⇥ (K + 1) matrix Z,

such matrix describes the distribution of amenities across the J neighborhoods. There is an infinite
number of discrete time periods t = 1, 2, . . . . The distribution of amenities in the next period
conditional on the current matrix of amenities is Z0 |Z.
There are i = 1, 2, . . . , N households in the city, each living in one housing unit. The total
number of households in the city is less than the number of housing units, N < H. The number of
households living in neighborhood j when the matrix of amenities is Z is noted n(j, Z). The H
vacant housing units are owned by households of the city. We assume that L = H

N

N < 2H.

The value of living in neighborhood j when the distribution of amenities in the city is Z is noted
Vi` (j, Z) 2 R. The value of owning a vacant unit in neighborhood j is noted Viv (j, Z) 2 R.
Preferences for the K observable amenities are described by a vector ⇠ i , and unobservable
7

amenities are a term "ij so that the flow utility enjoyed in one period by a household living in j is
zj ⇠ i + "ij . The unobservables "ij are i.i.d. and are normally distributed with cumulative distribution
function F (.), the c.d.f of the normal with variance

2
".

Without loss of generality, and for the sake of notational simplicity, the rest of the exposition
proceeds without individual household indices i. Yet, the framework can accommodate heterogeneity
in preferences for amenities and heterogeneity in frictions.
Each period, a household occupying a house in neighborhood j is matched to a listed vacant
P
house in neighborhood j 0 with probability j 0 , with j 0 j 0 = 1. When a household living in j
is matched to a listed vacant house in neighborhood j 0 , they bargain over the transaction price
log p(j, j 0 , Z). If the household in j buys a vacant house in j 0 , she pays price log p(j, j 0 , Z), moves
to neighborhood j 0 , and owns a vacant house in j that is listed. The seller simply obtains the price
log p(j, j 0 , Z) for the vacant unit and transfers the property right to the buyer. There can thus a
mutually beneficial transaction if there exists a price log p(j, j 0 , Z) such that:
V v (j 0 , Z)  log p(j, j 0 , Z)  V ` (j 0 , Z) + V v (j, Z)

V ` (j, Z),

(1)

in which case we write 1(j, j 0 , Z) = 1, and 0 otherwise. The Nash-bargaining power of the seller is
noted

so that, when a transaction occurs the price is:
log p(j, j 0 , Z) =

h
· V ` (j 0 , Z) + V v (j, Z)
+ (1

V ` (j, Z)

) · V v (j 0 , Z).

i

(2)

The value of living in neighborhood j is thus the sum of the flow utility and expectations, discounted
by an intertemporal discount factor :2
`

V (j, Z) = zj ⇠ +


+

(1
J
X

)EV ` (j, Z0 )
j 0 E{(1(j, j

0

, Z0 )(V ` (j 0 , Z0 ) + V v (j, Z0 )

log p(j, j 0 , Z))

j 0 =1

+ (1
2

1(j, j 0 , Z0 ))V ` (j, Z0 )} + "l ,

The symbol E denotes expectations of t + 1 while the symbol E is the average over a distribution.

8

(3)

where "l is a normally distributed unobservable preference term. The owner of a vacant unit in j
receives a flow zj ⇣ that reflects maintenance and the potential flow of rental payments. A vacant
unit is matched to an owner in neighborhood j 0 with probability

vµ

j0 .

Thus the value of owning a

vacant unit is:
v

V (j, Z) = zj ⇣ +



(1

+

v

v
J
X

)EV v (j, Z0 )

µj 0 E{1(j 0 , j, Z0 ) log p(j 0 , j, Z0 ) + (1

1(j 0 , j, Z0 ))V v (j, Z0 )} + "v . (4)

j 0 =1

where "v is a normally distributed unobservable preference term. The change in the number of
listings in j is noted

`(j, Z) and is a function of the number of inflows (vacant units being sold to

households, leaving the listing), and outflows (occupied housing units becoming vacant and listed):
2

`(j, Z) = E 4n(j, Z)
where L =

PJ

j=1 `(j, Z)

J
X

(j 0 , Z)1(j, j 0 , Z)

`(j, Z)

j 0 =1

v

J
X

j 0 =1

3

µ(j 0 , Z)1(j 0 , j, Z)5 ,

(5)

is the total number of listings. E denotes the average over all matches,

whereas E is an intertemporal expectation. In this version of the model the probability of being
matched to a vacant house in j 0 is simply proportional to the number of listed houses in j 0 , and the
probability of being matched to a buyer in j 0 is simply proportional to the number of households
in j 0 :
(j 0 , Z) =

`(j 0 , Z)
,
L

µ(j 0 , Z) =

n(j 0 , Z)
.
N

(6)

The framework can be extended to allow for a segmented housing market.

2.2

Steady-State City Dynamics

A key role is played by the diﬀerence r(j, Z) = V ` (j, Z)

V v (j, Z) between the value of living

in a neighborhood and the value of owning a vacant housing unit, called the trading opportunities
index. Indeed, city dynamics can be fully described by only two sets of quantities: (i) the diﬀerence r(j, Z) = V ` (j, Z)

V v (j, Z) between the value of living in a neighborhood and the value

of owning a vacant unit, and (ii) the listings in neighborhood j, `(j, Z). The index of trading

9

opportunities r(j, Z) satisfies a simple Bellman equation:
r(j, Z) = zj (⇠

⇣) + Er(j, Z0 )
X
J
+ E
(1
)

(j 0 , Z0 ) (r(j 0 , Z0 )

r(j, Z0 ))

µ(j 0 , Z0 ) (r(j, Z0 )

r(j 0 , Z0 ))

j 0 =1

+
where

(d) = F ( p2d )d +
"

p

v

+ ",

(7)

2 " f ( p2d ), which captures the expected value of the unobservables
"

conditional on a transaction. The unobservable is " = "l

"v and

2
"

= V ar("). The first term

of the equation corresponds to the diﬀerence between the current utility flows of living-in in the
unit and that of owning a vacant home. The second term is the expected value of future trading
opportunities. The last two terms correspond to the expected values attached with moving-up to
a diﬀerent housing unit, and that of selling a vacant housing unit, respectively. The dynamic of r
implies transaction probabilities, values V l and V v , and prices, which depend solely on such trading
opportunities. For instance, a transaction occurs in j from j 0 with probability F (r(j, Z) r(j 0 , Z)),
i.e. is a function of whether such diﬀerence is higher in neighborhood j than in neighborhood j 0 .
This expression for the diﬀerence in values, together with population dynamics (5), defines city
dynamics:

`(j, Z) =

⇢

n(j, Z)

J
X

j 0 =1
v

⇥
(j 0 , Z)F r(j, Z)

`(j, Z)

J
X

j 0 =1

r(j 0 , Z)

⇥
µ(j 0 , Z)F r(j 0 , Z)

⇤
r(j, Z)

⇤

,

(8)

and

n(j, Z) + `(j, Z) = 0: every net population increase matches a net decline in listings. where
P
the model’s stock-flow structure ensures that the total household count j n(j, Z) = N at every
point. The city is fully described by r and

` only.

The following proposition shows that a unique steady-state equilibrium of the city exists.
Proposition 1. (Existence and Uniqueness of a Steady-State City Equilibrium) Given
the structural parameters of household preferences ⇠, time discount factor , the vector of housing
units h, an equilibrium of the city is a couple (r⇤ , `⇤ ) made of a continuous and diﬀerentiable
10

function r⇤ : {1, 2, . . . , J} ⇥ RJK ! R and a continuous and diﬀerentiable function of listings `⇤ :
{1, 2, . . . , J} ⇥ RJK ! R for each neighborhood and for each city-wide distribution of amenities Z
that satisfy the dynamics (7) and for which the net change in listings is
When max{ , ,

v}

`(j, Z) = 0 in (8).

< 1, such an equilibrium exists and is unique. The value functions V` and Vv ,

the transaction probabilities F and prices log p are implied by the couple (r, `).
Proof. Presented in Appendix Section D.1.

2.3

Introducing Credit Frictions

We introduce three key dimensions of credit frictions: approval rates for mortgage applications,
mortgage balances, interest costs. This has two separate impacts on city dynamics: first, the lender
may not approve mortgage applications thus lowering the volume of transactions. Second, the lender
captures part of the transaction surplus in the form of interest payments. Third, a household who
moves out pays his mortgage balance, reducing the surplus of a transaction and lowering the volume
of transactions.
Approval Probability
The approval rate probability '(j, Z; x) depends on neighborhood and household characteristics.
'(j, Z; x) = ⇤( a log p + z0 c + x0 b + z0 dx)

(9)

where a, c, b, d are constants. log p is the endogenously negotiated price. Overall, a transaction
occurs if it is mutually beneficial for the buyer and the seller and if the lender approves the mortgage.
Thus a transaction occurs with a probability that is the product of the two probabilities.
Transaction Surplus
Prior to moving out of their unit, households pay their outstanding mortgage balance, noted B(j, Z).
When taking a loan, borrowers take into account the interest cost (j 0 , Z) on top of the purchase
price. Both the balance payment and the anticipation of an interest payment aﬀect the buyer’s
surplus. Indeed, the value of moving into j 0 is V ` (j 0 , Z) + V v (j, Z)

11

V l (j, Z)

B(j, Z)

(j 0 , Z).

The interest cost (j 0 , Z) is the present discounted value of interest payments on the annual
mortgage balance. For a T = 30 year fixed rate mortgage this is simply:
(j 0 , Z) =

T
X

t

(10)

log [rBt ]

t=0

where Bt is the balance in year t, r is the mortgage’s interest rate. For a 30-year fixed rate
mortgage with payment m and loan-to-value LT V , then T = 30 and the balance at t is simply
Bt = m + (1 + r)t (r · LT V · p

m).

Transaction probability and price
As in the model without friction, the transaction price splits the transaction surplus between the
buyer and the seller, where the seller’s bargaining power is noted . Here, the value of moving into
a housing unit in neighborhood j 0 is aﬀected by the balance and the interest cost payment:

log p(j, j 0 , Z) =

· (V ` (j 0 , Z) + V v (j, Z)
+ (1

) · V v (j 0 , Z)

z

Credit F rictions

}|
{
V ` (j, Z) B(j, Z) (j 0 , Z))

(11)

And the probability of a successful transaction turns into:
⇡(j, j 0 , Z) = '(j 0 , Z)F (r(j 0 , Z)

(j 0 , Z)

B(j, Z)

r(j, Z))

(12)

where '(j 0 , Z) is the probability of approval in neighborhood j 0 .
In an extension of the model we also introduce the possibility of foreclosures.
Steady-State City Dynamics with Credit Frictions
The evolution of the city with credit frictions is driven by three dynamics: (i) the dynamics of
trading opportunities, described in equation (7); the diﬀerence here being that opportunities to
trade-up are constrained by the approval rates, the mortgage balance, and the interest cost. (ii) the
dynamics of listings. (iii) the dynamic of mortgage balances B(j, Z). The first two are similar to
the model without credit frictions and are presented in Appendix (A). The third one is specific to

12

the city with credit frictions.
The dynamic of mortgage balances is as follows. Mortgage balances decline due to the flow
of households who move out of the neighborhood and repay. Mortgage balances increase for new
inward movers who take up new loans. Finally, mortgage balances decline when households repay
their loans during the maturity of the mortgage.3

B(j, Z) =

z

Households moving out

n(j, Z)

}|
J
X

k ⇡jk

k=1

+ n(j, Z) 1

{

· B(j, Z)
J
X

k ⇡jk

k=1

+ (hj
|

n(j, Z)) ·

v

J
X
k=1

!

· [rB(j, Z)

m(j, Z)]

µk ⇡kj · LT V · p(k, j, Z)

{z

Households moving in

At the steady-state, the city experiences no net shift in mortgage balances,

(13)

}

B(j, Z) = 0.

Proposition 2. (Existence and Uniqueness of City Equilibrium with Frictions) Given the
structural parameters (⇠, , h) and the mortgage credit conditions (', r, T ), an equilibrium of the
city is a triplet (r, `, B) made of a function r : {1, 2, . . . , J} ⇥ RJK ! R, a function of listings ` :
{1, 2, . . . , J} ⇥ RJK ! R, and a function of mortgage balances B : {1, 2, . . . , J} ⇥ RJK ! R for
each neighborhood and for each city-wide distribution of amenities Z that satisfy the dynamics (7),
for which the net change in listings is
is

`(j, Z) = 0 in (8), and the change in mortgage balances

B(j, Z). Such an equilibrium exists and is unique in the space of continuous and diﬀerentiable

functions. The value functions V` and Vv , the transaction probabilities F and prices log p are
implied by the couple (r, `, B).
Proof. The proof is generically similar to the proof for the model without credit frictions (Proposition (1)) with the addition of the dynamics of balances B. As in the prior proof, write B =
TB (r, `, B) the dynamic of mortgage balances (13), and realize that Tr and T` are also a function
of the vector of balances B. The operator TB is a contraction in the space S of triplets (r, `, B)
3

Keeping track of the mortgage balance of each household in each neighborhood would dramatically increase
the dimensionality of the dynamics. We choose a parsimonious representation where B(j, Z) measures the average
mortgage balance in neighborhood j. When we introduce household heterogeneity by observable x, this turns into
Bx (j, Z).

13

and such triplets (r, `, B) belong to a bounded set for the norm |||·|||1 on S defined as the max of
(r, `, B). The mapping T = (Tr , T` , TB ) is a contraction as long as max{ , ,

v}

< 1. It admits a

unique fixed point in the Banach space (S, |||·|||1 ).

3
3.1

The Price-Amenity Gradient at Equilibrium
Current Amenities vs. Trading-Up Opportunities

In a dynamic setting, holding other neighborhood amenities constant, a marginal increase in the
quality z of current amenities in a specific neighborhood j leads to two separate impacts on transaction prices in that neighborhood: first, the value V ` of living in the neighborhood increases; second,
the value of selling the housing unit (once vacated) V v changes. With Nash bargained prices according to 2, the impact of dzj on the price of a transaction for a buyer coming from k buying in j
is the sum of these two eﬀects:
@ log p(k, j, Z)
=
@zj

·

@V ` (j, Z)
+ (1
@zj

)·

@V v (j, Z)
@zj

(14)

In turn, the impact of a shift dzj in amenities on the value V v of living in the unit is an aggregation of
the preference for amenities, the expectation of future amenities, and the opportunities to ‘trade-up’
to a better unit.
Expectations of future amenities

@V

` (j, Z)

@zj

=⇠+

z

}|
{
i
@E h `
V (j, Z0 )|Z
@zj
(1

|

)

J
X

j0

j 0 =1

0

(r(j 0 , Z)
{z

r(j, Z))

Opportunities to trade up

@r(j, Z)
@zj
}

Thus a household with few opportunities to trade up (in the extreme, e.g. if

= 0,

(15)

= 0, or

= 1)

will see the impact of amenities only through the flow value of amenities and not through trading-up
opportunities. The value of living in the unit depends negatively on the trading opportunities index
r(j, Z) as a household living in a neighborhood with a more favorable r(j, Z) is less likely to move
and will thus trade-up less often.

14

The impact of the amenity shift on the resale value V v of the vacant unit in 14 depends on the
preferences of renters ⇣ and the trading opportunities index r(j, Z):
⇤
@V v (j, Z)
@E ⇥ v
=⇣+
V (j, Z0 )|Z
@zj
@zj
v

+

J
X

µj 0

0

(r(j, Z)

j 0 =1

|

r(j 0 , Z))

{z

@r(j, Z)
@zj
}

(16)

Opportunities to sell the vacant unit

where ⇣ is renters’ preference for amenities. The owner of a vacant house in a neighborhood with a
more favorable index of trading opportunities r(j, Z) will turn a greater transaction surplus when
selling the vacant unit.
Combining the gradient of the value of living-in (15) and that of owning a vacant unit (15) into
(14) yields the price amenity-gradient as the sum of the current utility flows of owning a house, the
impact of current amenities of the future values of owning a house, and the capitalization in the
price of the change in the trading opportunities with respect to amenities.
Proposition 3. (Impact of trading opportunities on price-amenity gradient) The relationship between log prices and amenities is driven by the neighborhood’s index of trading opportunities r. The price-amenity gradient is the sum of three terms:


@ log p·j
E
@zj

Impact of current amenities on future values

=

+

z

}|
@E h ` i
V |Z + (1
@zj

{
@E v
)
[V |Z]
@zj

@r
+ Capitalizationj ·
(j, Z)
@zj
|
{z
}

(17)

Impact on trading opportunities

where

is the weighted average of owners’ and renters’ preferences

=

⇠ + (1

)⇣. The

average of the capitalization coeﬃcients across neighborhoods is equal to E(Capitalizationj ) =
⇣ ⌘2
hj
H
1 PJ
(1
) 1. This is positive. This coeﬃcient declines when the number of listings
j=1 H
L
2
increases.

Proof. See Appendix Section D.3.
The proposition implies that when neighborhoods with higher amenities have worse trading-up
15

opportunities (@r/@zj < 0), the price-amenity gradient @ log pkj /@zj is flatter than what the vector
of preferences for amenities

suggest for given expectations of the impact of current amenities on

the future value of owning a house. In this case, the household faces a trade-oﬀ between high current
value of owning a house with low trading opportunities, and low current value of amenities with
high trading opportunities. In the opposite case, trading opportunities are aligned with the current
value of amenities and the price-amenity gradient is steeper than what the vector of preferences for
amenities

suggests. In absence of credit frictions, the capitalization coeﬃcient is constant and

only depends on aggregate ratio of housing units to listings and on the distribution of housing units
across the city. As we shall see in Section 3.3 this will no longer be the case when time-varying
credit frictions are introduced. In this case, changes in credit frictions will aﬀect both the trading
opportunities-amenities gradient and the capitalization of trading opportunities.

3.2

Arbitrage Opportunities

The city-wide heterogeneity in trading opportunities r(j, Z) is a reflection of the heterogeneity in
trading-up opportunities across locations that would not occur in a frictionless Alonso et al. (1964)
city. In such a frictionless world, described in Appendix Section (D.4), log prices would indeed
reflect (i) the value of amenities and (ii) housing supply. The Alonso et al. (1964) case obtains with
an infinitely elastic housing supply.
We thus consider briefly the introduction of a real estate investor with access to a perfect
matching technology, i.e. which can choose freely which sellers and buyers he can be matched
to. Such a real estate investor can buy a vacant home in neighborhood k at any price exceeding
V v (k, Z). He can sell such vacant home to a buyer from neighborhood j at a maximum price
of V ` (k, Z) + V v (j, Z)

V ` (j, Z). Thus the maximum profit that an arbitrageur can earn is the

maximum over (k, j) 2 {1, 2, . . . , J}2 of the diﬀerence V ` (k, Z) + V v (j, Z)
which is simply the diﬀerence in trading opportunities r(k, Z)
⇧ = max {r(k, Z)
k,j

V ` (j, Z)

V v (k, Z),

r(j, Z),

r(j, Z)}

(18)

In other words, the arbitrageur will buy a vacant home with the lowest amenity-price diﬀerential
and sell it to a buyer from the neighborhood with the highest amenity-price diﬀerential.
16

With a single arbitrageur, this will not aﬀect other households’ outside option. Nevertheless,
with a large number of arbitrageurs, arbitrageurs will compete for vacant houses, and buyers will
compete among multiple arbitrageurs, and the free-entry, zero profit condition for arbitrageurs will
lead to a homogenous trading opportunities index, i.e. 8j r(j, Z) = r(Z) across neighborhoods.
The following proposition formalizes this result:
Proposition 4. (Impact of arbitrageurs on prices) In a city with free entry of arbitrageurs
with no matching frictions, the index of trading opportunities is constant across locations. The zeroprofit condition implies that the index of trading opportunities does not vary across neighborhoods,
r(j, Z) = r(Z). Then the log price exhibits a linear relationship with the preference coeﬃcient ⇠,
and trading-up opportunities r do not aﬀect price-amenity gradients diﬀerently across locations.
The last statement is a simple consequence of expressions (15) and (16).

3.3

Price-Amenity Gradient with Credit Frictions

The city with matching frictions predicts a constant relationship between prices, amenities, and
the index of trading opportunities r. In contrast, as lending standards fluctuate over time, shifts
in credit frictions alter the relationship between prices and the trading opportunities index. When
lending standards are tight, trading-up opportunities are limited and the index of trading opportunities r has little impact on the price-amenity gradient. When lending standards are more relaxed,
trading-up opportunities are more readily available and the index of trading opportunities r has a
larger impact on the price-amenity gradient.
The case of a uniform approval rate for mortgage applications can help clarify this mechanism.
The average amenity-price gradient across neighborhoods becomes:

Ej



Impact of current amenities on expectations of future amenities

@ log pkj
@zj

=

z

}|
i
@E h `
V (j, Z0 )|Z + (1
@zj

{
⇤
@E ⇥ v
+
)
V (l, Z0 )|Z
@zj
@r
+ Capitalization('j , Bj , j ) ·
(j, Z) .
@zj
|
{z
}

(19)

Impact on trading-up opportunities

Hence the capitalization coeﬃcient depends on the mortgage approval probability 'j , the outstanding mortgage balance Bj , and the interest cost .
17

The following proposition suggests that the capitalization coeﬃcient declines when the approval
rate ' declines, when the outstanding mortgage balance B increases, and when the interest cost
increases .
Proposition 5. (Partial Equilibrium Impact of Credit Frictions) Keeping the trading opportunities, credit conditions, and listings constant in all other neighborhoods, a tightening in credit
conditions in one neighborhood (i.e. a reduction in the approval rate, an increase in the mortgage balance, or an increase in the interest cost) reduces trading opportunities, the capitalization
coeﬃcient, and the number of listings in that neighborhood.
The logic of the proof is described in Figure 4 for an increase in mortgage balance in one neighborhood. Figure (a) describes the determination of the equilibrium local trading opportunity index
as the fixed point of the Bellman equation (29). An increase in the mortgage balance implies that
more heavily indebted households will be less able to seize future trading-up opportunities, which,
in turn, reduces the number of listings in this specific neighborhood and the opportunity to sell
vacant units to households from other neighborhoods. This causes a decline in the neighborhood’s
index of trading opportunities.
Figure (b) graphs the relationship between the neighborhood’s index of trading opportunities
and the capitalization coeﬃcient. A higher balance leads to a lower capitalization at every given
level of the index. For a giving set of trading opportunities, the tightening of credit constraints
reduces the set of potential trades that generates a surplus for buyers and sellers. This reduces the
probability to sell and therefore the capitalization of trading opportunities into prices.

4
4.1

Identification
The Model without Credit Frictions

We present here first the estimation of the index of trading opportunities rjt for each neighborhood
and each year and the values Vjt` and Vjtv . Then using such estimate, we estimate preferences for
amenities ⇠, the intertemporal discount factor , and the variance of unobservables

18

2
"

.

Step #1: Identification of Trading Opportunities
The data set has t = 1, 2, . . . , T years. The indexes of trading opportunities rjt are identified by
observing gross flows into each neighborhood j in each period t. For the neighborhoods j for which
the number of movers is positive, n+
jt > 0, the vector rt of trading opportunities is such that the
predicted probability of moving to j 0 is equal to the observed probability of moving to j 0 :
2

log 4

J
X

njt

j0 F

j=1

rj 0 t

3

rjt 5 = log n+
j0t,

(20)

The vector rt is obtained by minimizing the distance between the prediction and the realization
of mobility. If the probability of moving in to a neighborhood is n+
jt = 0, the index of trading
opportunities of this neighborhood is conventionally set to rj 0 t =

1.

Step #2: Identification of Values
Observed prices are then separately identifying the utilities V ` of living in a neighborhood and V v
of owning a vacant unit. Indeed, prices depend on the sum Vj`0 t + (1
log pjj 0 t =

· [Vj`0 t

rjt ] + (1

)V v ,

) · Vjv0 t ,

(21)

then observation of prices log pjj 0 t and identification of rs using flows provides two relationships to
identify Vj`0 t and Vjv0 t . However, the econometrician does not typically observe log pjj 0 t . Transaction
data features the destination of sales but not the origin of sales. To solve this we estimate the
average index of trading opportunities E(rjt |j 0 ) of buyers moving in to each neighborhood j 0 , from
any origin j. The probability that a sale in neighborhood j 0 is with a buyer living in j is simply, by
Bayes’ law:

where Fjj 0 t = F (rj 0 t

P (j 0 |j)P (j)
j 0 Fjj 0 t njt
P (j|j 0 ) = PJ
=P
,
0
k j 0 Fkj 0 t nkt
k=1 P (j |k)P (k)

(22)

rjt ) is the probability of a transaction conditional on a match between a
P
buyer in j and a seller in j 0 . Thus the average index r·t of buyers in j 0 is E(r·t |j 0 ) = Jj=1 P (j|j 0 ) ·
rjt . Therefore:

· Vj`0 t + (1

) · Vjv0 t = Ej log pjj 0 t + · E(r·t |j 0 )
| {z }
observed price

19

(23)

Together, the J moment conditions of flows (20) and of prices (23) identify the 2J values Vjt` and
Vjtv . Sellers’ bargaining power is set to

= 1/2, as is conventional in part of the search and matching

literature (Den Haan, Ramey & Watson 2000).4
Step #3: Identification of the Arrival Rate of Oﬀers
The arrival rate of oﬀers is estimated by matching the predicted population change with the observed
population change

njt .

ˆ = argmin

X

njt

⇢ X
J
⇥
ˆ `jt
µj 0 t F rjt
j 0 =1

j,t

n(j, Z)

J
X

j 0 =1

j0tF

⇥

⇤
rj 0 t .
rj 0 t

rjt

⇤

2

(24)

Step #4: Identification of Preferences
The final step identifies the vector of preferences for amenities ⇠ and the intertemporal discount
factor . Noting Ejt+1 the expectation of the value of living, from neighborhood j in period t + 1,
the following regression identifies preference coeﬃcients ⇠ and the time discount factor :
h i
Vjt` = zjt ⇠ + E Vj`0 + "jt ,

(25)

which is identified whenever unobservables are orthogonal to observable amenities and to the expectations. zjt includes a neighborhood fixed eﬀect.
This regression requires an estimate of the expectation term, in a way akin to a control function approach. Expectations depend on (i) the probability of being matched to a vacant house ,
(ii) conditional on a match, the probability
observed and thus

j0t

j0t

that this match is in neighborhood j 0 ; the listings are

too; (iii) the expected value V ` of living in the neighborhood in subsequent

periods.
As the future evolution of the neighborhood may depend on values of amenities that are never
observed, we estimate a flexible relationship between values and amenities noted V ` (z, ", Z), i.e. it
depends on the observable amenities of the neighborhood, the unobservable amenities "jt , and the
4

There is spatial and time variation in sellers’ share of the transaction surplus as sellers’ and buyers’ outside
options are heterogeneous.

20

distribution of amenities Z in the city. We estimate such relationship using a flexible Generalized
Additive Model (Hastie & Tibshirani 1990). This enables the estimation of values of indirect utilities
outside of the empirical support of zjt and the estimation of the expectation:
E(Vj`0 )

=

Z Z
E

Z

V ` (z0 , "0 , Z0 )f (z0 , "0 , Z0 |z, ", Z)dzd"

(26)

where the dynamic of neighborhood amenities z0 |z is estimated using the neighborhood panel, and
"ijt+1 is an iid shock with normal distribution.
An autoregressive process is estimated for each amenity z. This expectation 26 is estimated
by Monte Carlo integration by drawing values (z, ", Z) from this AR process conditional on the
previous values of the amenities. The unobservables "0 in the next year are assumed independent of
the unobservables in the previous year.
This enables the estimation of preferences ⇠ and the time discount factor

by estimating

specification (25).
Individual Heterogeneity
For the sake of clarity, identification was presented in this section without indexing utilities by
household i. Yet, a similar approach estimates values by demographic subgroup. Each individual i is
characterized by a set of K demographic characteristics x 2 RK , such as income, race, and ethnicity.
The identification uses the share of movers of each characteristic x in each neighborhood j. This
provides the trading opportunities index rjt (x), and the values Vjt` (x), Vjtv (x). This enables an
estimation of heterogeneous preferences ⇠i = ⇠(xi ) and heterogeneous time discount factors

i

=

(xi ).

4.2

Identification with Credit Frictions

Credit frictions aﬀect each of the four steps of the estimation.
In the first step, the predicted gross flow of movers is aﬀected by the mortgage balance, the

21

interest cost, and the approval rate:
2

log 4

j0

J
X
j=1

njt · 'j 0 t · F rj 0 t

j 0 t

Bjt

3

rjt 5 = log n+
j0t

(20’)

where (i) 'j 0 t is the mortgage approval probability in j 0 ; a low mortgage approval probability leads
to low inflows; (ii) Bijt is the mortgage balance at the origin; high indebtedness lead to low outflows
from j; (iii) ik0 t is the interest cost; high interest costs lead to low inflows into j 0 . The approval
probabilities, mortgage balances, and interest costs are observed and presented in Section (5) below.
In the second step, values V ` and V v are also aﬀected by the mortgage balance and the interest
cost. Indeed, the mortgage balance and the interest cost aﬀect the value of moving for the buyer,
and thus the negotiated price (equation ). Thus the sum ·Vij` 0 t +(1
· Vj`0 t + (1

) · Vjv0 t = Ej log pijj 0 t +
|
{z
}
observed price

ij 0 t
|{z}

interest cost

)·Vijv0 t of the values becomes:
0

1

+ · Ej @rijt + Bijt A ,
|{z}

(21’)

balance

l and V v that account
which, together with the index of trading opportunities, yields values Vijt
ijt

for borrowing constraints. Adjustments to the third and fourth estimation steps follow from these
modifications.

5

Data Set

Five data sets are combined to estimate the model. The data construction steps are detailed in
Appendix Section B.
First, flows into each neighborhood (identification step #1) are obtained using a comprehensive
data set of all deeds transactions from the 14 county recording oﬃces of the Chicago metropolitan
statistical area between 2005 and 2014 inclusive. The data includes the street address of the transacted property, the unique assessment parcel number (APN), the nature of the transaction (grant
deed or deeds of trust for typical transactions), the transaction amount, the name of the buyer,
and the name of the seller. The transaction amount is used in identification step #2. The race,
ethnicity, and income of the buyer is obtained by matching deeds to data from the Home Mortgage
Disclosure Act. The HMDA is matched to deeds using the location of the property and the loan
22

amount.
Second, the deeds data include the loan amount, the structure of the mortgage (ARM or FRM,
negative amortization or interest-only loan, loan maturity), the name and address of the lender.
We also observe mortgage refinancings and second mortgages. This provides an estimate of mortgage loan balances, interest cost, and mortgage payments using mortgage amortization formulas (Brueggeman & Fisher 2011), for each Assessment Parcel Number for which there is at least one
transaction in the files. Approval rates are obtained using the universe of mortgage applications of
the Home Mortgage Disclosure Act.
The third set of data pertains to neighborhood amenities: schools, crime, and neighborhood
demographics. Such observations enable the identification of households’ preferences for amenities
(identification step #4).
The median and average school test score measures are built as follows. The 3,057 schools
are matched to their corresponding school-attendance areas, within the 368 school districts. Each
blockgroup is matched to its school-attendance area and linked to the average test score of the
attendance area. School test scores are provided by each of the three states: in Illinois, the State
Board of Education’s Report Card with Assessment Data; in Wisconsin, the Department of Public
Instruction provides data from the Wisconsin Student Assessment System; in Indiana, the Department of Education provides Annual School Performance Reports ranking schools with letters from
A to F.
Crime data at the neighborhood level is based on the Federal Bureau of Investigation’s Uniform
Crime Reports and from the City of Chicago’s Crime Data Portal. Each blockgroup is matched
to either a corresponding incorporated municipality or a county, when outside an incorporated
municipality. Crime counts in blockgroups within incorporated municipalities are the crime counts
of the municipal police. Crime counts in neighborhoods within a county outside the boundaries of
an incorporated municipality are those of the County Sheriﬀ.
Neighborhood data comes from the American Community Survey (ACS). At the blockgroup
level, and between 2005 and 2016, the ACS provides 5-year averages for key household demographics and for housing units: median household income, median building age, median number of rooms,
racial and ethnic make-up. Such 5-year averages overlap as the 5-year window shifts by one year
every year. In a similar fashion as in Autor, Dorn & Hanson (2013), there are thus a set of ac23

counting relationships that provide a set of constraints on each neighborhood-level annual measure.
Using a flexible location-specific polynomial it is then possible to recover estimates of the annual,
blockgroup-level data. Such data includes the age of buildings, the median number of rooms and
the demographic make-up of the neighborhood (race, ethnicity, income, and education). Neighborhood demographics are used in identification step #3 (the arrival rate of oﬀers) and step #4
(identification of the preference for neighbors’ demographics).

6

Empirical Analysis

The goal of this section is to present a series of key empirical and model-derived facts on the
evolution of the Chicago MSA between 2007 (the final year of the boom) and 2010 (the trough
of the mortgage crisis). Such facts highlight the role of time-varying credit frictions in the joint
dynamics of prices and trading opportunities.
Section 6.1 below presents the outcome of the estimation of the dynamic model. In particular
it regresses values and trading opportunities on local amenities. Sections 6.2 and 6.3 show how, at
constant preferences, shifts in credit conditions can lead to large changes in the relation between
prices and amenities. Section 6.4 presents a test of this paper’s theory-driven decomposition of the
price-amenity gradient into preferences and trading opportunities (Equation 3.3).
The correlation between credit conditions and the stark inequalities in crime rates and school
quality across the Chicago metro area imply a time-varying pricing of amenities.

6.1

Estimated Preferences and Trading Opportunities

Table 1 presents the estimation of preferences and the time discount factor for the model with credit
(col. 1-2), and for the model without credit (col. 3-4).
⇥
⇤
The first result is that for both models the expectation E V ` (j 0 , Z0 )|j, Z is highly significant,

confirming the role of dynamic considerations in housing preferences. The model with credit yields a
higher estimate discount factor than the model without credit (0.58 vs. 0.52) which is consistent with
levered borrowers being more concerned with future housing valuations. The second result is that
accounting for credit has a significant impact on the valuation of several amenities. In particular,
taking into account credit conditions reveals a much stronger preference by ethnic groups for living
24

in neighborhoods with a large fraction of neighbors of the same race. This is true for Blacks,
Hispanics, and Asians. The model with credit also predicts stronger preferences for larger and more
recent houses.
Underlying the diﬀerences between the estimates of the two models is the idea that accounting for
credit enables to disentangle the taste for neighborhoods based on preferences from considerations
related to access to credit or to the cost of borrowing. For example, Blacks might have a strong
preference for mostly blacks neighborhoods but the model without credit yields a weaker preference
because of the diﬃculties of Blacks to obtain credit to live in such neighborhoods. By contrast, the
model with credit produces households preferences that are purified of credit considerations.
The distribution of trading opportunities across neighborhoods with diﬀerent amenities has
implications for the relationship between prices and amenities (see Proposition 3). Here again,
there are substantial diﬀerences between the estimates of the two models. The model with credit
predicts a distribution of trading opportunities who mostly mirror the preference for amenities.
This is the less the case for the model without credit for which trading opportunities decline in the
fraction of Blacks both for Blacks and for other ethnic groups.

6.2

Price Dynamics, Credit Frictions, and Trading Opportunities

Figure 1, panel (a) and panel (b), looks at the price-amenity gradient for two key amenities: (i) school
quality, measured by the test-score (z-score), and (ii) crime measured by the number of oﬀenses per
capita. Neighborhoods are sorted by bins of increasing z-score with equal numbers of neighborhoods
in each bin. For both amenities, the price-amenity gradient is much steeper in 2010 than in 2007.
Figure 1, panel (c) looks at the spatial distribution of price changes in City of Chicago. It
shows an important contrast between the strong price declines between 2007 and 2010 in the south
and west sides and the more moderate price changes in the rest of the city. Figure 1, panel (d)
plots the 2005 school test-scores, ranked by quartiles of the neighborhood distribution of z-score on
the same map. The map reveals that those neighborhoods experiencing large price drop are also
neighborhoods with below average school quality. The steepening of price-school test score gradient
(panel (a)) thus results, for a large part, from larger house price declines in neighborhoods of the
south and west side of the City of Chicago, which are at the bottom end of the distribution of school
test scores.
25

The next step is to assess which of the dimensions of credit conditions are driving such decline in
house prices in the West and South Side: (i) the mortgage approval rate, (ii) households’ mortgage
balance, (iii) the interest cost on new mortgages. Figure 2 looks at the time variation in the
correlation between credit conditions and neighborhood amenities between 2007 and 2010. Figure 2
panel (a), (b), and (c) display the average mortgage balance over current price (in logs), the average
present value of mortgage interest cost over current prices (in logs), and the average approval rate
of mortgage applications, respectively. A striking fact is that neighborhoods with the lowest test
scores experienced the largest increase in average mortgage balance between 2007 and 2010. In
2010, the average ratio mortgage balances is above the current house price (share above one) for the
neighborhoods that are at the bottom third of the school quality distribution. This fact implies that,
on average, households in those neighborhoods have “underwater” mortages in 2010. By contrast
the interest cost remains very similar in both periods, with higher risk premia being compensated
by lower base interest rate. The approval rate for new mortgages increased in most neighborhoods,
with fall in house prices more than compensating more stringent lending standard in the context
of a collapse in the number of applications (this is addressed in Appendix Section C whose results
are displayed in Appendix Figure C). Figure 2, panel (b) looks at the change in household income
across the distribution of neighborhoods, suggesting little change. In sum, the sharp deterioration
in mortgage balances in the neighborhoods with low school quality appears as the most salient sign
of the uneven deterioration in credit conditions.
Figure 3 displays a map of the distribution of mortgage balances across the neighborhoods of
Cook County, Illinois. Average mortgage balances over current house prices are ranked by quartile
computed over the 2005-2013 period. The fourth quartile includes neighborhood whose mortgage
balances are over 95 percent of the house price (the median balance in that quartile is 143 percent)
and thus characterizes areas in which a vast fraction of mortgages are “underwater”. Comparing
panel (a) for 2007 and panel (b) for 2010 shows a large increase in mortgage balances throughout
the County but strong spatial contrasts. The neighborhoods that are aﬀected by the most dramatic
increase in mortgages balances are in the South Side and the West Side of Chicago – the same
neighborhoods in which school test scores are lower – as well as cities adjacent to the South Side
(e.g. Harvey) which are also typically characterized by low levels of school test scores.
Figure 5 maps the spatial distribution of trading opportunities in Cook County in 2007 and
26

2010. Against the backdrop of a general reduction in trading opportunities between 2007 and 2010,
the most dramatic fall in trading opportunities appears in the same areas of Cook County where
school test scores are low and mortgage balances were high during the crisis.
Our theoretical framework (Figure 4) predicts that tighter credit frictions lead to both a fall in
trading opportunities and in their capitalization into prices. When this fall happens in neighborhoods with a low quality of amenities, which is shown in Figures 2 and 3, the theory predicts a
steepening of the price-amenity gradient, which is what is observed in the data for Chicago (Figure 1).

6.3

The Price-Amenity Gradients: Preferences vs. Trading Opportunities

A key result of our model regards the impact of trading opportunities on the price-amenity gradient.
The theory Section predicts that the price-amenity gradient captures both preferences, expectations, and trading opportunities 3. In our model, with stable preferences, changes in price-amenity
gradients

@ log pkj
@zj

are correlated with changes in the gradient

@r(j,Z)
@zj

of trading opportunities with

respect to amenities. As a way to to assess this relationship, we first run the following regression of log prices on amenities interacted with each year indicator, controlling for a neighborhood
(blockgroup) fixed eﬀect and year fixed eﬀect:

log pjt =

2013
X

t=2005

↵t · (Yeart ⇥ zjt ) + Neighborhoodj + Yeart + "jt .

(27)

We then re-run the same regression controlling for the trading opportunities. The regression is done
for four diﬀerent neighborhood characteristics: fraction of African Americans, fraction of Hispanics,
crime (log of the number of oﬀenses per capita), and school quality (z-Score).
Figure 7 reports the coeﬃcients of the regression of the log transaction price in each neighborhood on each of its four characteristics, interacted with an indicator variable for each year. These
coeﬃcients, linked on Figure 7 by a solid line, measures the price-amenity relationship each year
between 2005 and 2013. A second set of coeﬃcents, linked with a dotted line, measures the priceamenity relationship each year between 2005 and 2013 controlling for trading opportunities. There
is a striking contrast between the two set of estimated coeﬃcients. Without controlling for trading
opportunities, the price-amenity gradient displays significant time-variations. For the fraction of
27

African Americans (upper-left panel), the coeﬃcient is positive in 2005-2009, but then becomes
negative in 2010-2013. For the fraction of Hispanics, the coeﬃcient similarly turns from positive
in 2005-2009, to negative in 2010-2012. The lower-right panel shows that for the standard school
test score in Illinois, the coeﬃcient goes from negative in 2005-2008 to positive in 2009-2013. While
the lower-left panel for log(oﬀenses per capita) is less clear, it nevertheless suggests substantial
variation in the capitalization coeﬃcient over the cycle. By contrast, when trading opportunities
are controlled for, the price-amenity relationship becomes almost stable over time, suggesting that
variations in trading opportunities can indeed account for most of the variation in prices-amenity
gradients.
Figure 8 plots the coeﬃcients of the regression of the trading opportunities index r on the
same set of neighborhood characteristics, interacted with years, and controlling for block-group
fixed eﬀects. The changes in trading opportunities are following a similar pattern than those in
price-amenity gradients when the trading opportunities are not controlled for (Figure 7). Figure
8 shows a shift in the location of trading opportunities between the boom and the bust away
from neigborhoods with high fraction of minorities and below average school quality and towards
neighborhood to neighborhoods with lower shares of minorities and higher school quality. This shift,
whose spatial dimension is illustrated on Figure 5, explains while preferences only become stables
when trading opportunities are controlled for.
Figure 6 complements Figure 8 by plotting the estimates of the impact of changes in trading
opportunities over changes in mortage balances, showing that, as predicted by the theory’s Proposition 5, trading opportunities sharply decrease when credit conditionss tighten.
Table 2 decomposes the reversal of the price-school quality gradient by looking at the role of
time-variations in transaction prices, trading opportunities, and future expected value of living
in the neighborhood. Each regression controls not only for blockgroup fixed eﬀects but also for
the entire arrays of neighborhood characteristics. Table 2 focuses on school quality but similar
results are obtained for other neigborhood characterisitics. The table documents the reversal in the
capitalization of school quality between the boom and the bust and shows that it closely matche the
reversal in trading opportunities. By contrast the future expected value of living in the neighborhood
appears rather stable over time.
In short, this subsection illustrates the importance of trading opportunities in the dynamics of
28

the price-amenity gradient. Trading opportunities appear to be the key ingredient necessary to
reconcile time-variations in the price-amenity gradient with stable current and future preferences
over amenities.

6.4

Credit Frictions and the Capitalization of Trading Opportunities

Our theoretical results predict that a tightening of credit friction not only reduce trading opportunities but also reduce the capitalization of trading opportunities into prices by reducing the potential
surplus from house transactions. We evaluate here the impact of credit frictions on the capitalization coeﬃcient within a regression framework that is exactly derived from the the theoretical
price-amenity gradient in the presence of credit frictions (Equation 19). We run the following
regression:

log pjt = a · zjt + b · rjt + c · rjt · Creditjt + d · Creditjt
⇣
⌘
`
+ e · E Vjt+1
+ N eighborhoodjt + Y eart + "jt ,

(28)

where zjt is the vector of neigborhood characteristics, rjt the trading opportunities, Creditjt
the three measures of credit frictions (approval rate, interest rate cost, mortgage balances), and
⇣
⌘
`
E Vjt+1
the future expected utility of living-in the neighborhood. The trading opportunities index is obtained in Identification Step #1 (4). Expectations are obtained by building transaction

probabilities and integrating values over the distribution of future amenities (Step #4, equation 26
with the adjustment for credit frictions described in Section 4.2).
Table 3 present regression results where the diﬀerent components are graduallly introduced.
Table 3, col 1., presents, as a baseline, the results of standard hedonic regression without trading
opportunities and expected utility of living-in which are then introduced in Table 3, col 2. Table 3,
col 3. adds the interaction of trading opportunities with credit frictions. Trading opportunites and
the expected value of owner-occupying are strongly significant. Introducing those terms aﬀect some
of the amenity coeﬃcients with the mean test score (IL) displaying the expected positive sign and
the negative impact of crime being reduced. The index of trading opporunities is standardized with
a unit variance. A one standard deviation increase in trading opportunities is associated with an
increase of 16.9 percent in house prices. Table 3, col 3. shows that the coeﬃcient capitalization
29

significantly varies with approval rates and mortgage balances. The eﬀect is economically large.
A increase in mortgage balances from 80 to 100% of the current price lowers the capitalization
coeﬃcient by 0.06 which is more than a third of the baseline capitalization coeﬃcient of 0.169
(Table 3, col. 2.)
The results of Table 3 complete the analysis of the price-amenity gradient relationship by showing
that, as the theory predicts, tighter credit constraints not only reduce the emergence of trading
opportunities (Figure 6) but also their capitalization into house prices.

7

Conclusion

This paper shows that variations in trading opportunities combined with variations in the capitalization of trading opportunities are able is to explain the large observed variations in the pricing
of amenities in absence of variations of preferences. Time variation in housing search and credit
market frictions are able to explain, in turn, why trading opportunities and their capitalization into
prices change over time. During the mortgage boom, easy access to mortgage credit facilitated the
exploitation of trading opportunities in high amenity neighborhoods, shifting trading opportunities
to neighborhoods experiencing gentrification. Furthermore when credit conditions are relaxed or
when the supply of listing is large, trading opportunities are easier to grasp and therefore neighborhoods with a high level of trading opportunities are traded at a lower premium than when market
frictions are more severe.
The paper’s results have substantial implications for both policymakers and analysts of housing
markets. Measuring the dollar willingness-to-pay for public goods is a task that relies on house
prices to identify households’ preferences for amenities. Understanding the elasticity of housing
demand with respect to amenities relies on an understanding of the structural drivers of the house
price-amenity relationship. This paper proposes a framework combining the estimation of preferences, the dynamics of amenities and that of trading opportunities which match key empirical
facts on the time variation of the house price-amenity relationship. In estimating the relationship
between prices and observable characteristics, machine learning approaches recently pioneered in
economics (Mullainathan & Spiess 2017) are susceptible to a form of Lucas critique (Lucas 1976),
as the relationship between preferences and house prices depends on the organization of the market,
30

e.g. the nature of its frictions. Hence even econometricians interested in the task of predicting
rather than explaining house prices would benefit from using a structural framework such as ours,
in which forward-looking households make housing decisions by taking into account the dynamics
of both amenities and market frictions.

References
Alonso, W. et al. (1964), Location and land use: toward a general theory of land rent., Cambridge,
Mass.: Harvard Univ. Pr.
Autor, D., Dorn, D. & Hanson, G. (2013), ‘The china syndrome: The impact of import competition
on us labor markets’, American Economic Review 103(6), 2121–2168.
Bayer, P., Ferreira, F. & McMillan, R. (2007), ‘A unified framework for measuring preferences for
schools and neighborhoods’, Journal of Political Economy .
Bayer, P., McMillan, R., Murphy, A. & Timmins, C. (2016), ‘A dynamic model of demand for
houses and neighborhoods’, Econometrica 84(3), 893–942.
Benabou, R. (1996), ‘Equity and eﬃciency in human capital investment: The local connection’, The
Review of Economic Studies 63(2), 237–264.
Bishop, K. C. & Murphy, A. D. (2011), ‘Estimating the willingness to pay to avoid violent crime:
A dynamic approach’, American Economic Review 101(3), 625–29.
Black, S. E. (1999), ‘Do better schools matter? parental valuation of elementary education’, The
Quarterly Journal of Economics pp. 1–26.
Brueggeman, W. B. & Fisher, J. D. (2011), Real estate finance and investments, McGraw-Hill Irwin
New York, NY.
Chen, Z. & Haynes, K. E. (2015), ‘Impact of high speed rail on housing values: An observation
from the beijing–shanghai line’, Journal of Transport Geography 43, 91–100.
Cragg, M. & Kahn, M. (1997), ‘New estimates of climate demand: evidence from location choice’,
Journal of Urban Economics 42(2), 261–284.
31

Den Haan, W. J., Ramey, G. & Watson, J. (2000), ‘Job destruction and propagation of shocks’,
American economic review 90(3), 482–498.
Gabriel, S., Hearey, O., Kahn, M. E. & Vaughn, R. K. (2016), Public school quality valuation over
the business cycle, Working Paper 22668, National Bureau of Economic Research.
Glaeser, E. L. & Gyourko, J. (2007), Arbitrage in housing markets, Technical report, National
Bureau of Economic Research.
Gromb, D. & Vayanos, D. (2002), ‘Equilibrium and welfare in markets with financially constrained
arbitrageurs’, Journal of financial Economics 66(2-3), 361–407.
Gromb, D. & Vayanos, D. (2015), The dynamics of financially constrained arbitrage, Technical
report, National Bureau of Economic Research.
Hastie, T. & Tibshirani, R. (1990), Generalized additive models, Wiley Online Library.
Hotz, V. J. & Miller, R. A. (1993), ‘Conditional choice probabilities and the estimation of dynamic
models’, The Review of Economic Studies 60(3), 497–529.
Judd, K. L. (1998), Numerical methods in economics, MIT press.
Linden, L. & Rockoﬀ, J. E. (2008), ‘Estimates of the impact of crime risk on property values from
megan’s laws’, American Economic Review 98(3), 1103–27.
Liu, C. H., Nowak, A. & Rosenthal, S. S. (2016), ‘Housing price bubbles, new supply, and within-city
dynamics’, Journal of Urban Economics 96, 55–72.
Lucas, R. (1976), Econometric policy evaluation: A critique, Vol. 1, North Holland, pp. 19–46.
Manjoo, F. (2017), ‘The rise of the fat start-up’, New York Times .
Mullainathan, S. & Spiess, J. (2017), ‘Machine learning: an applied econometric approach’, Journal
of Economic Perspectives 31(2), 87–106.
Roback, J. (1982), ‘Wages, rents, and the quality of life’, Journal of political economy 90(6), 1257–
1278.

32

Rosen, S. (1974), ‘Hedonic prices and implicit markets: product diﬀerentiation in pure competition’,
Journal of political economy 82(1), 34–55.
Shleifer, A. & Vishny, R. W. (1997), ‘The limits of arbitrage’, The Journal of Finance 52(1), 35–55.

33

Figure 1: Descriptive Facts – Price Dynamics in the Chicago Metro Area
This set of figures presents the evolution of the correlation between prices and amenities in the
Chicago Metro Area between 2007 and 2010. Figures (a) and (b) suggest that the correlation between
school test scores (resp., oﬀenses per capita) and house prices became substantially steeper during
the bust, in 2010. Figure (c) shows that the largest price declines were concentrated in the southern
part of the City of Chicago. Figure (d) suggests that the distribution of house prices expanded, with
larger declines at the bottom of the price distribution.

13.0

(a) Average Price by Std. Test Score (Illinois)

(b) Price and Crime Rate (Chicago-Naperville-Elgin
MSA)

●

12.5
●

12.5

●

●

●

●
●
●
● ●
●

●
●

●
●

11.5

11.5

12.0

E(log price)

●

●

12.0

●

E(log price)

●

●

2007
2010
−2.0

11.0

●

−1.5

−1.0

−0.5

0.0

0.5

1.0

●

0

Z−Score

2007
2010
5000

10000

15000

20000

25000

30000

Offenses per Capita

(c) Price Declines 2007-2010

(d) Average Test Scores in 2005

[−3.87,−0.755]
(−0.755,−0.407]
(−0.407,−0.175]
(−0.175,3.5]

Sources: City of Chicago geocoded criminal incidents. FBI’s Uniform Crime Reports. Illinois State
Board of Education. House prices from Corelogic’s deeds records. School attendance areas hand
coded.
34

Figure 2: The Correlation of Amenities with Credit Frictions and Household Income
This figure presents the correlation between three dimensions of credit frictions and the school attendance areas’ z-score, for 2007 and 2010. Neighborhoods are sorted by bins of increasing z-score
with equal numbers of neighborhoods. Each point presents the average approval rate, log mortgage
balance as a share of the current price, log interest cost as a share of the current price. Figure (d)
presents household income by z-score bin in 2007 and 2010.
(b) Mortgage Balance and Z-Score

●

0.80

● ●
●
●

0.75

●

●

0.70

●
●

0.0
−0.5

●

●

●

●

●
●

●
●
●

●

●●

●

● ●

●
●

●
●

−1.0

●
●

Average Approval Rate

●

●
● ●

log Mortgage Balance − log Current Price

0.85

0.90

(a) Approval Rate and Z-Score

●

●

−2

−1

0

2007
2010

●

−1.5

0.65

●
●

●

1

−2

−1

Z−Score (Illinois Test Score)

0

1

Z−Score (Illinois Test Score)

(c) Interest Cost and Z-Score

(d) Household Income and Z-Score

11.2

−0.5

11.4

●

●
●

●

●

●
●

−1.0

−0.5

0.0

0.5

●
●

10.4
2007
2010

●

10.2

●

−1.5

●

●
●

−2.0

●

10.6

●

●

11.0

−1.0

●

10.8

log(Median Income)

●

−1.5

log(Interest Cost/Price)

●

●

2007
2010

1.0

−2.0

Z Score (Illinois)

−1.5

−1.0

−0.5

0.0

Z Score (Illinois)

35

0.5

1.0

Figure 3: The Spatial Distribution of Mortgage Indebtedness – Cook County
This map focuses on the neighborhoods of Cook County, Illinois. It presents the evolution of the
spatial distribution of mortgage indebtedness. Mortgage indebtedness is the log of the remaining
mortgage balance over the current transaction price of housing units. The map illustrates the substantial increase in indebtedness in the south relative to the northern parts of the county.

(a) 2007

(b) 2010

log Mortgage Balance over Price: ⌅ 1st Quartile ⌅ 2nd Quartile ⌅ 3rd Quartile ⌅ 4th Quartile.
Quartiles taken for the overall 2005-2013 distribution of Trading Opportunities.

36

Figure 4: Theory Predictions – The Impact of an Increasing Mortgage Indebtedness on the Capitalization of Amenities
This figure presents the impact of a local, neighborhood-level, increase in household indebtedness on
trading opportunities and capitalization coeﬃcient. The first impact of a higher indebtedness is a
lower trading opportunity index. This is derived from the Bellman equation 7. The second figure
shows that a higher indebtedness implies a lower level of capitalization at each level of the trading
opportunities index.

High Balance

Low Balance

∇high bal.

(b) Impact on Capitalization Coeﬃcient

Trading Opportunities

T(Trading Opportunities ∇)

(a) Impact on Trading Opportunities

∇high bal.

Caphigh bal.

∇low bal.

Trading Opportunities ∇

Caplow bal.

Capitalization Index

The black line is for the initial balance. The red line corresponds to an increase in the neighborhood’s
mortgage balance. The dashed line in (a) is the 45 degree line.

37

Figure 5: The Spatial Distribution of Trading Opportunities
These map focus on Cook county neighborhoods, which includes the City of Chicago, to illustrate the
decline of trading opportunities rj in the southern neighborhoods of Chicago from the peak of the
boom in 2007 to the trough of the bust in 2010.
(a) 2007

(b) 2010

Trading Opportunities: ⌅ 1st Quartile ⌅ 2nd Quartile ⌅ 3rd Quartile ⌅ 4th Quartile.
Quartiles taken for the overall 2005-2013 distribution of Trading Opportunities.

38

Figure 6: The Impact of the Increase in Mortgage Indebtedness on Local Trading Opportunities

0.0

This figure presents the impact of the rise in local mortgage indebtedness on neighborhood-level
trading opportunities. Each point is the coeﬃcient in the regression of trading opportunities on
indicator variables for the 20 bins of mortgage indebtedness, where the regression controls for credit
conditions, amenities, blockgroup and year fixed eﬀects. The segments are 95% confidence intervals,
with standard errors two-way clustered at the neighborhood and year levels.

−0.2

●

−0.4

●

●

●
●

●

●
●

−0.6

Impact on Trading Opportunities

●

●

●

−0.8

●
●

11.0

11.5

12.0

12.5

log(Mortgage Balance)

Mortgage balance: neighborhood-level mortgage balance averaged across all parcels (APNs) of the
neighborhood. Data Appendix Section B describes the data construction process that builds a parcelspecific debt level. Trading Opportunities estimated as in Step #1 of the Identification Section 4.

39

Figure 7: The Price-Amenity Gradient: Preferences vs. Trading Opportunities
This figure reports the coeﬃcients of the regression of the log transaction price in each neighborhood
on their current amenity, interacted with an indicator variable for each year, and controlling for
blockgroup fixed eﬀects and year fixed eﬀects. Thus the plot coeﬃcients measure the price-amenity
relationship each year between 2005 and 2013.

●

●

●

●

●

0.0

●

●
●
●

2006

2008

●
●

2010

●

0.0

0.2

0.4

●

●

●

●

●
●

●

2012

2006

2008

2010

●

●

●

●

●

●

●

2006

2008

2010

2012

0.00

●

●

●

●

●

2008

2010
date

40

●

●

2006

date

●

●

●

−0.06

●

2012

●

−0.02

●

●
●

z−Score (IL)

●

−0.01 0.00

0.02

0.02
0.01

●

●

●

date

●

●

●

●

●

●

●

●

●

●

●

●

●

date

log(offenses)

●

−0.2

Frac. Hispanic

0.4

●

0.2

Frac. Black

●

●

0.6

0.8

The dotted line is the same set of coeﬃcients, when controlling for the value of trading opportunities, interacted with neighborhood-level credit conditions: balances outstanding, approval
rate, foreclosures per housing unit.

2012

●

Figure 8: Trading Opportunities and Neighborhood Characteristics
The four figures present scatter plots of the coeﬃcients of the regression of the trading opportunities
index r on a selected group of neighborhood characteristics, interacted with years. Each point is a
regression coeﬃcient, grey bands are for 95% confidence intervals.
(b) Fraction Hispanic and Trading Opportunities

3.5

5

(a) Fraction Black and Trading Opportunities

4

●

3.0

●
●
●

●
●

2.5

●
●
●

1.5

1

●

●

2.0

Frac. Hispanic

●

2

Frac. Black

3

●

●

1.0

0

●

0.5

−1

●

2006

2008

2010

2012

2006

2008

2010

date

2012

date

(d) School Score and Trading Opportunities

0.2

0.2

0.3

0.3

(c) Criminal Oﬀenses and Trading Opportunities

0.1

●

●

●

0.0

●
●

−0.1

●

Z−Score (IL)

0.0

0.1

●

●

●
●

−0.2

−0.1

●

●
●

−0.3

●

−0.4

−0.2

log(Offenses), Standardized

●
●

2006

2008

2010

2012

2006

date

2008

2010
date

41

2012

Table 1: Model Estimation – Preferences, Trading Opportunities, and Price-Amenity Gradients
When Accounting for Credit Opportunities
This table presents the estimation of preferences ⇠ for amenities zjt and the intertemporal discount
factor in columns (1) and (3). Columns (2) and (4) present the regression of the trading index
rijt , j = 1, 2, . . . , J, on amenities zjt . The trading index rijt is the diﬀerence between the owner’s
` of owning and occupying a unit and the value V v of owning a vacant or rented unit.
value Vijt
Columns (1) and (2) are estimated in the model with both credit and matching frictions (Section 2.3).
Columns (3) and (4) are estimated in the model with matching frictions only (Section 2.1).

Dependent variable:

log(Median Income)
Frac. Black
Frac. Black ⇥ Black
Frac. Hispanic
Frac. Hispanic ⇥ Hispanic
Frac. Asian
Frac. Asian ⇥ Asian
log Oﬀenses
Mean Test Score (IL)
Median Test Score (WI)
Year Structure Built
Median Nbr Rooms
E(V l (j 0 , t + 1)|j, t)

Observations
R2

(1)

(2)
Index of Trading
Opportunities rijt

`
Utility Vijt

(3)
`
Utility Vijt

(4)
Index of Trading
Opportunities rjt

Estimated with Matching and Credit Frictions

Estimated with Matching Frictions Only

0.048
0.320
9.084⇤⇤⇤
0.624⇤⇤
8.582⇤⇤⇤
1.281⇤⇤⇤
14.900⇤⇤⇤
0.004
0.059⇤⇤⇤
1.993
0.046⇤⇤⇤
0.809⇤⇤⇤
0.583⇤⇤⇤

0.009
0.036
0.818
0.169⇤⇤⇤
0.219⇤⇤
0.049
0.019
0.002
0.006
0.417
0.004⇤⇤⇤
0.102⇤⇤⇤
0.518⇤⇤⇤

(0.038)
(0.343)
(0.756)
(0.269)
(0.573)
(0.417)
(0.977)
(0.009)
(0.022)
(5.837)
(0.003)
(0.045)
(0.005)

118,053†
0.842

0.026
1.595⇤⇤⇤
11.373⇤⇤⇤
0.621⇤⇤
13.086⇤⇤⇤
1.538⇤⇤⇤
23.259⇤⇤⇤
0.043⇤⇤⇤
0.096⇤⇤⇤
3.382
0.041⇤⇤⇤
1.127⇤⇤⇤

-

(0.035)
(0.316)
(0.697)
(0.247)
(0.526)
(0.384)
(0.900)
(0.008)
(0.020)
(5.376)
(0.003)
(0.042)

118,053†
0.845

(0.006)
(0.051)
(1.961)
(0.042)
(0.091)
(0.067)
(0.139)
(0.001)
(0.004)
(0.915)
(0.001)
(0.007)
(0.001)

90,865†
0.997

0.006
0.755⇤⇤⇤
8.267
1.316⇤⇤⇤
4.727⇤⇤⇤
0.104
1.675⇤⇤⇤
0.003
0.010
0.485
0.009⇤⇤⇤
0.081⇤⇤⇤
-

(0.016)
(0.134)
(5.131)
(0.110)
(0.236)
(0.174)
(0.363)
(0.004)
(0.009)
(2.394)
(0.001)
(0.019)

90,865†
0.993

⇤ p<0.1; ⇤⇤ p<0.05; ⇤⇤⇤ p<0.01

†: These specifications have one observation by demographic group i, neighborhood j, and year t.

42

Table 2: The Reversal of the Correlation Between Prices and School Test Scores
This table presents the time varying coeﬃcient of the regression of transaction prices (column (1)),
trading opportunities (column (2)), and expectations (column (3)) on standardized school test scores.

Dependent variable:
log(Transaction Pricejt )
(1)
log(Median Household Income)
Frac Black
Frac Hispanic
Frac Asian
Average Test Score (IL) ⇥ 2005
Average Test Score (IL) ⇥ 2006
Average Test Score (IL) ⇥ 2007
Average Test Score (IL) ⇥ 2008
Average Test Score (IL) ⇥ 2009
Average Test Score (IL) ⇥ 2010
Average Test Score (IL) ⇥ 2011
Average Test Score (IL) ⇥ 2012
Share of Schools with B
Share of Schools with C
Share of Schools with D
Share of Schools with F
Median Test Score (WI)
Median Year Structure Built
Median Number of Rooms
log(Oﬀenses Per Capita)
Observations
R2
Adjusted R2
Residual Std. Error

⇤⇤

0.041
0.120
0.166⇤⇤⇤
0.069
0.156⇤⇤⇤
0.175⇤⇤⇤
0.143⇤⇤⇤
0.025
0.128⇤⇤⇤
0.114⇤⇤⇤
0.081⇤⇤⇤
0.077⇤⇤⇤
0.018
0.205⇤⇤⇤
0.111⇤
0.104
0.045
0.004⇤⇤⇤
0.032⇤⇤⇤
0.376

Trading Opportunities rjt

E(Vjt` )

(2)

(0.019)
(0.080)
(0.057)
(0.088)
(0.027)
(0.027)
(0.027)
(0.028)
(0.027)
(0.027)
(0.026)
(0.027)
(0.061)
(0.053)
(0.061)
(0.145)
(1.220)
(0.001)
(0.010)
(0.686)

0.017
0.475⇤⇤⇤
0.446⇤⇤⇤
0.174
0.096⇤⇤⇤
0.096⇤⇤⇤
0.073⇤⇤
0.056
0.045
0.053
0.047
0.043
0.084
0.026
0.107
0.291
0.195
0.007⇤⇤⇤
0.176⇤⇤⇤
1.318

37,564
0.793
0.754
0.358 (df = 31574)

(0.036)
(0.182)
(0.126)
(0.217)
(0.035)
(0.035)
(0.035)
(0.034)
(0.034)
(0.035)
(0.035)
(0.038)
(0.131)
(0.111)
(0.133)
(0.208)
(0.890)
(0.002)
(0.023)
(0.986)

0.012
0.040⇤⇤⇤
0.012⇤⇤⇤
0.109⇤⇤⇤
0.025⇤⇤⇤
0.024⇤⇤⇤
0.023⇤⇤⇤
0.018⇤⇤⇤
0.015⇤⇤⇤
0.008⇤⇤⇤
0.015⇤⇤⇤
0.0001
0.009⇤⇤
0.019⇤⇤⇤
0.021⇤⇤⇤
0.092⇤⇤⇤
0.158⇤⇤⇤
0.0001
0.004⇤⇤⇤
0.228⇤⇤⇤

37,666
0.822
0.789
0.461 (df = 31673)
⇤

Note:

43

(3)
⇤⇤⇤

(0.002)
(0.006)
(0.004)
(0.008)
(0.001)
(0.001)
(0.001)
(0.001)
(0.001)
(0.001)
(0.001)
(0.002)
(0.004)
(0.003)
(0.003)
(0.009)
(0.054)
(0.0001)
(0.001)
(0.045)

37,666
0.99
0.99
0.020 (df = 31673)
p<0.1;

⇤⇤

p<0.05;

⇤⇤⇤

p<0.01

Table 3: The Capitalization of Trading Opportunities Into House Prices
This regression tests the predictions of Section 3 (The Price-Amenity Gradient at Equilibrium). The second column
estimates the impact of trading opportunities on observed transaction prices. The third column estimates how credit
frictions aﬀects such capitalization of trading opportunities into house prices.

Dependent variable:
log(Transaction Pricejt )
(1)
log(Median Household Income)
Frac. Black
Frac. Hispanic
Frac. Asian
Mean Test Score (IL)
Share of Schools with B (IN)
Share of Schools with C (IN)
Share of Schools with D (IN)
Share of Schools with F (IN)
Median Test Score (WI)
Median Year Structure Built
Median Number of Rooms
Trading Opportunities r
⇥ log Balance
⇥ Approval Rates
⇥ log(Interest Cost)
E(V ` )
log(Oﬀenses per Capita)
Other Controls
Observations
R2
Adjusted R2
Residual Std. Error

⇤⇤

0.044
0.160⇤
0.201⇤⇤⇤
0.032
0.030⇤⇤⇤
0.015
0.201⇤⇤⇤
0.108⇤
0.093
0.027
0.004⇤⇤⇤
0.050⇤⇤⇤

(2)
(0.022)
(0.090)
(0.060)
(0.090)
(0.006)
(0.060)
(0.053)
(0.061)
(0.144)
(1.219)
(0.001)
(0.012)

0.005
0.106⇤
0.081⇤
0.180⇤⇤⇤
0.004
0.006
0.161⇤⇤⇤
0.056
0.039
0.175
0.001
0.011
0.032⇤⇤⇤
0.003⇤⇤⇤
0.352⇤⇤⇤
0.005
3.090⇤⇤⇤ (0.132)
1.281⇤⇤⇤
⇤⇤⇤
⇤⇤⇤
5.474
(0.695)
3.338
(0.664)
2.329⇤⇤⇤
log(Balance), Approval Rate, log(Interest Cost)

37,564
0.772
0.728
0.376 (df = 31581)

0.001
0.118
0.230⇤⇤⇤
0.363⇤⇤⇤
0.016⇤⇤⇤
0.004
0.265⇤⇤⇤
0.061
0.141
0.557
0.002⇤⇤⇤
0.002
0.169⇤⇤⇤

(3)
(0.019)
(0.085)
(0.058)
(0.095)
(0.006)
(0.063)
(0.058)
(0.067)
(0.133)
(1.239)
(0.001)
(0.011)
(0.008)

(0.015)
(0.057)
(0.042)
(0.066)
(0.005)
(0.051)
(0.045)
(0.055)
(0.124)
(1.047)
(0.001)
(0.008)
(0.005)
(0.001)
(0.042)
(0.003)
(0.106)
(0.549)

37,564
0.788
0.747
0.363 (df = 31579)

37,564
0.844
0.814
0.311 (df = 31573)

⇤

Note:

p<0.1;

⇤⇤

p<0.05;

The index r of trading opportunities is standardized, s.d.(r) = 1 across neighborhoods.

44

⇤⇤⇤

p<0.01

A

City Dynamics with Credit Constraints

This section of the Appendix presents the equations describing the city’s dynamics with credit frictions. The city’s equilibrium is characterized by a vector of neighborhood-level trading opportunities
r, a vector of listings `, and a vector of mortgage balances B. The dynamics of trading opportunities with credit frictions are aﬀected by the probability of approval '(j, Z) in each neighborhood
j for a given distribution of city-wide amenities; these approval probabilities lower the probability
of a successful transaction. The dynamics are also aﬀected by the mortgage balance in buyers’
neighborhoods B and the interest cost at destination. Overall, the Bellman equation for trading
opportunities r is:
⇣) + Er(j, Z0 )
X
J
+ E
(1
) (j 0 , Z0 )'(j 0 , Z0 ) (r(j 0 , Z0 )

r(j, Z) = zj (⇠

(j 0 , Z0 )

j 0 =1

v

+

µ(j, Z0 )'(j, Z) (r(j, Z0 )

(j, Z0 )

r(j, Z0 )

r(j 0 , Z0 )

B(j, Z0 ))

B(j 0 , Z0 ))

+ ".
(29)

The dynamic of listings is aﬀected as well by the presence of credit frictions. Approval rates,
mortgage balances, and interest payments lower both flows into and out of a neighborhood.

`(j, Z) =

⇢

n(j, Z)

J
X

j 0 =1
v

`(j, Z)

⇥
(j 0 , Z)'(j, Z)F r(j, Z)

J
X

j 0 =1

(j, Z)

⇥
µ(j 0 , Z)'(j 0 , Z)F r(j 0 , Z)

r(j 0 , Z)

(j 0 , Z)

B(j 0 , Z)

r(j, Z)

⇤

B(j, Z)

⇤

,

(30)

The third dynamics is the dynamics of mortgage balances, presented in equation (13) in the main
body of the paper.

B

Data Appendix

The paper combines five data sets to estimate the structural parameters. This section describes
how these data sets are built to estimate price-amenity gradients and households’ preferences for

45

amenities.
Deeds records come from Corelogic Inc., which compiled information from the 14 county
recording oﬃces of the Chicago metropolitan area between 2000 and 2014 inclusive. The latitude
and longitude of each parcel was obtained by geocoding the street address using the Census PostGIS
TIGER Geocoder for the three states of the MSA (Illinois, Indiana, Wisconsin). While street
addresses are encoded as text, the success rate for matches was above 80%. Each transaction’s
latitude and longitude is then matched to each of the Census 2010 blockgroup boundaries. The
characteristics of the mortgage are added to the transaction as follows. When a grant deed was
recorded, the characteristics of the mortgage are typically observed in the same record as the
property transaction. When a deed of trust was recorded, the characteristics of the mortgage are
recorded separately from the property transaction. In this case, we build a parcel specific timeline
to associate the mortgage characteristics with the last property transaction on the same parcel.
The race, ethnicity, and income of the buyer are obtained by matching the deeds records to
data collected in accordance with the Home Mortgage Disclosure Act. This is done by
matching each of the transactions by loan amount and census tract. As Home Mortgage Disclosure
Act data uses 1990 boundaries until 2003 inclusive and 2000 boundaries after 2004 inclusive, we
match deeds to HMDA using HMDA’s boundaries, and then merge them to consistent 2010 Census
tract boundaries.
Blockgroup-level school quality measures are obtained by using the polygon boundaries of school
attendance areas, the geocoding of schools by the federal National Center for Education Statistics, and school-level test scores from each of the three states. School attendance boundaries are
obtained by hand coding the polygons of Great Schools. The geographic location of each school is
included in the National Center for Education Statistics’ Common Core of Data. Thus schools
are matched to their corresponding attendance area. Each school’s state-specific test score is obtained by matching the school’s state identifier with the state’s test score data. This is possible as
the Common Core of Data includes both the federal identifier and the state-level identifier. Test
scores are standardized at the year and state-level. Each property is associate to a test score in the
following way. First, blockgroup boundaries are intersected with school attendance area boundaries.
Second, if a blockgroup lies entirely within a school boundary, the test score for this property is the
test score of the attendance area. Third, if a blockgroup boundary crosses two or multiple school
46

attendance areas, the test score is the weighted average of the test scores of the corresponding
attendance areas, weighted by the area of their intersections.
Crime data comes from the FBI’s Uniform Crime Reports and from the City of Chicago’s
Crime Data Portal. The Uniform Crime Reports report crime counts by Originating Agency
Identifier. The FBI provides a crosswalk from ORIs to incorporated Census places. The City of
Chicago’s data reports geocoded criminal incidents. In the latter case, such events are matched to
blockgroup boundaries within the city of Chicago. In the former case, the counts are apportioned
to blockgroups in the following way. First, special police data (e.g. airport police or university
police) is eliminated. Second, blockgroups are intersected with the boundaries of Census places.
When a blockgroup does not intersect with a Census place, the crime count per resident is that of
the County police. When the blockgroup is within a Census place, the crime count is that of the
municipal police of the place. Some police forces serve multiple incorporated municipalities.
Neighborhood demographics come from the American Community Survey. As blockgroup
boundaries change with every decennial Census and thus also for waves of the ACS between 2005 and
2014, we build a consistent longitudinal data set of neighborhoods with 2010 blockgroup boundaries
in the following way. We build a blockgroup relationship file by intersecting the boundaries of
the 2000 Census Shapefiles with the boundaries of the 2010 Census Shapefiles. Counts with 2000
boundaries are apportioned according to the size of the intersection. Averages are the area-weighted
averages of the intersections. Since the ACS provides 5-year averages, we build annual values by
observing that, for a Census variable xjt (unobserved) for each neighborhood j and year t, the
ACS reports: xjy0 = 15 (xjy0 + xjy0 +1 + xjy0 +2 + xjy0 +3 + xy0 +4 ) for y0 = 2005, . . . , 2010. Thus the
identification problem is to infer 10 data points xjy for y = 2005, 2014 from the observation of 6
per neighborhood. A polynomial regression of xjy on t for each data set identifies each of the 6003
blockgroups’ trend in xjy . Then the relationship between the polynomial coeﬃcients of xjy and xjy
provides the polynomial coeﬃcients of xjy and the imputed annual value for annual demographics.

C

Estimating Lending Standards: The Self-Selection Problem

The availability of the HMDA microfiles enables the estimation of a lending standards specification
where the approval decision (approved/denied) depends on applicant, mortgage, and house char47

Appendix Figure A: Assigning School Test Scores to Neighborhoods in the Illinois neighborhoods
of the Chicago-Naperville-Elgin Metro Area
School-level test scores from Illinois’ State Board of Education are matched to their corresponding
school attendance area. Each neighborhood is then assigned the test score from its corresponding
attendance area. Darker colors indicate higher test scores.
(a) 2005

(b) 2006

(c) 2012

(d) 2013

48

Appendix Figure B: Crime Rates by Blockgroup
This map shows the counts of crimes per 100,000 residents obtained for each blockgroup of the
Chicago-Naperville-Elgin, IL-IN-WI Metropolitan Statistical Area using the approach described in
Appendix Section B. Data comes from the City of Chicago’s Data portal for crimes committed within
the boundaries of the City of Chicago. For neighborhoods outside of the city, Uniform Crime Report
(UCR) data was used.

49

acteristics. Modelling this approval decision as the lender’s benefit-cost analysis of lending, the
probability of approval 'ijt for household i in neighborhood j in year t is:

'ijt = P (xit

t

+ zjt

t

+ xit

t zjt

(31)

+ "ijt > 0)

where xit is the vector of household characteristics, zjt is the vector of mortgage and house characteristics. "ijt is the unobservable driver of the approval decision. The evolution of lending standards
is then the evolution of the estimates of the coeﬃcients

t,

t,

and

t

between t = 2005 and

t = 2013.
One significant empirical issue in the estimation is that the volume of mortgage applications
drops dramatically from the market’s boom to the market’s bust: going from above 300,000 applications to less than 100,000. Thus households’ self-selection causes large shifts in the sample of
estimation, which confounds the estimation of these lending standards coeﬃcients.
We address this issue as follows. The distribution of characteristics (x, z) in year t is noted
f (x, z|t). We reweigh the sample so that the distribution f (x, z|t) is identical regardless of the
value of t. A practical issue is that f (x, z|t) is a non-parametric statistical object. Our method
involves the following simple steps. By Bayes’ rule:

f (x, z|t) =

f (t|x, z)f (x, z)
f (t)

(32)

where f (t) is the share of observations in year t. The probability f (t|x, z) that an observation (x, z)
is in year t is estimated as the prediction of the linear regression of an indicator variable for year t
on the set of covariates x and z. The set of weights for year t is thus:

w(x, z, t) =

f (2005|x, z)
f (t)
·
f (2005)
f (t|x, z)

(33)

which ensures that any distribution for t = 2006, . . . , 2013 is identical to the distribution of observations in t = 2005. For instance the weighted mean of x for any t
Z

w(x, z, t) · x · f (x, z|t)dxdz =

Z

f (2005|x, z)
x·
f (x, z)dxdz =
f (2005)

50

2006 is
Z

x · f (x, z|2005)dxdz

(34)

Appendix Figure C: Estimation of the Evolution of Lending Standards: Approval Rate
The figures below present the evolution of credit frictions. Specifically, figure (a) presents the estimated sensitivity of the mortgage approval decision to the applicant’s loan-to-income ratio. Figure (b) presents the constant of the approval specification. Figure (c) presents the

0.04

(a) Approval Specification – Sensitivity to the LTI

(b) Approval Specification – Constant

●

●
●
●

0.02

●

●

●

●

●

●

●

●

●
●

●
●

●

●

Constant

−0.04

●

−0.05

−0.02

●

−0.06

Impact of log(LTI)

0.00

0.00

●

●

●
●

●

−0.08

−0.10

●

●

2000

2002

2004

2006

2008

2010

●

2012

2000

Year

2002

2004

2006

2008

2010

2012

Year

which is independent of t. This is true for any moment of the observations. This approach enables
the estimation of lending standards without shifts in the distribution of observations across years.
This method is used in Appendix Figure C.

51

D

Theory

D.1

Existence and Uniqueness of the Steady-State Equilibrium

Proposition 6. (Existence and Uniqueness of a Steady-State City Equilibrium)
Proof. We consider the space noted S of couples (r, `) of a trading opportunities function of amenities r : {1, 2, . . . , J}⇥RJK ! R, (j, Z) 7! r(j, Z) and a listing function ` : {1, 2, . . . , J}⇥RJK ! R,
(j, Z) 7! `(j, Z).
First, amenities z belong to a closed and bounded, i.e. compact set Z of RK . This assumption
has two implications: first, the city-wide distribution of amenities Z also belongs to a compact set
as the cartesian product of compacts. Second, values V l and V v are bounded. Therefore r is a
function mapping from a compact set into a compact set D ⇢ R. Similarly, listings l(j, Z) evolve in
a compact set [0, hj ] for each j and for all Z ⇢ Z.
Second, the index of trading opportunities r satisfies equation 7. This is expressed in terms
of operator Tr from (r, `) to r, i.e. r = Tr (r, `) in steady-state. Similarly, the dynamics of
listings can be expressed as an operator T` from (r, `) to `, i.e. ` = T` (r, `) in steady-state. The
steady-state is a couple (r⇤ , `⇤ ) such that (r⇤ , `⇤ ) = T (r⇤ , `⇤ ), with T = (Tr , T` ).
Finally, the vector space S is endowed with a norm k·k1 with k(r, `)k1 = max{|r|, |`|}. Hence
S is a Banach space. The mapping T is a Lipschitz contraction from S into itself with constant
max{ , ,

v}

< 1. By the Banach–Caccioppoli fixed-point theorem there is a unique fixed point

(r⇤ , `⇤ ) 2 S of such mapping.
D.1.1

Value Function Iterations

The comparative statics that provide the predictions of Section (E.1) are performed as follows.
Keeping the preferences of households ⇠ constant, the steady-state5 neighborhood-level trading opportunities index r and the neighborhood-level listings ` satisfy 7 and 8 for a given value of city-wide
market tension L/H, city-wide listings divided by the number of housing units. In steady-state, listings are stable,

` = 0. The index of trading opportunities (resp. the listings function) is a function

r of the vector of amenities z 2 RK (resp., a function ` of z). The space of amenities is bounded, and
discretized on an equally-spaced grid. We use value function iteration over r(z) and `(z) to obtain
5

The model also allows non-steady-state dynamics with a path of shifts in market tension.

52

the corresponding steady-state functions, and Chebyshev polynomial approximations (Judd 1998)
to estimate values of r(z) and `(z) for amenities outside of the grid.
As the values of ownership and vacancies V l and V v are simple functions (3) and (4) of the
index of trading opportunities and listings, values and prices log p(z0 , z) for each origin-destination
neighborhood pair (z0 , z) are straightforwardly derived from the simulation of r and `. Average
prices Ez0 (log p(z0 , z)) in neighborhood with amenities z are obtained by averaging log p(z0 , z) over
the probabilities of transaction between z0 and z. The price-amenity gradient is the simple regression
of such average transaction price Ez0 (log p(z0 , z)) on the amenity vector z.

D.2

Short-Run Transition Dynamics

At the city’s steady-state, the amenity-value diﬀerence r and listings ` are constant for a given
distribution of city-wide amenities Z. How the city converges to such steady-state remains to be
established: shocks to preferences d⇠, shocks to amenities dzj in a neighborhood, and shocks to the
matching technology d , d v , are incorporated into values with some delay. Deriving the short run
dynamics of (r, `) will give an understanding of the short-run dynamics of prices and transaction
volumes; in particular, it will show with what speed shifts in the value of amenities are transmitted
into house prices.
We consider a permanent shift in a structural parameter ✓, a notation that encompasses the
three specific cases of preferences, amenities, and the matching technology. The parameter ✓ evolves
according to a discrete-time sequence (✓t ) where ✓0 = ✓ in the initial period, and ✓t = ✓ for all time
periods t

t. The values and listings in period t = 0, 1, 2, . . . are noted (rt , `t ).

Proposition 7. (Short-Run City Dynamics in Response to a Shock) Given an anticipated
path for a structural parameter ✓ according to a discrete-time sequence (✓t ), and given an initial
condition (r0 , `0 ) there exists a unique sequence (rt , `t ) such that households’ amenity-value gap
are pinned down according to Bellman dynamics (7), where the current rt depends on forwardlooking rt+1 and `t , `t+1 ; and where listings `t evolve according to (8).
As t ! 1, (rt , `t ) converges6 to the steady-state (r1 , `1 ) that would be achieved if ✓ were
constant and equal to limt!1 ✓t in all time periods. Similarly the amenity-price gradient converges
to the steady-state value (@ log p/@z)1 .
6

The norm k · k that defines the convergence concept is defined in the Appendix.

53

Proof. The Bellman dynamics (7) and (8) in the out-of-steady state path can be expressed as two
operators:

8
>
< rt

= Tr (rt+1 , `t+1 )

(35)

>
: `t+1 = T` (rt , `t )

k is the k times composition so that the
where rt ! r1 and lt ! l1 as t ! 1. The operator Tr
k (r
amenity-price gap can be expressed as a function rt = Tr
t+k , `t ) of the forward looking t + k

value of r. Then, when max{ , ,

v}

k converges to an operator T 1
< 1, as t ! 1, the operator Tr
r

and the amenity-price gap converges to a value r1 . Thus the current value can be simply expressed
1 (r , ` ). Indeed, the convergence point
as the steady-state value and the current listings rt = Tr
1 t

r1 is well defined according to proposition (1).
The dynamics become:

8
>
< rt

1 (r , ` )
= Tr
1 t

(36)

>
: `t+1 = T` (rt , `t )

which leads to the unique transition sequence (r⇤t , `⇤t ), for t = 1, 2, . . . .
The proof of Proposition 7 shows that from a given initial condition (a vector of listings per
neighborhood ` 2 RJ ) and from a path of parameters, e.g. shifts in amenities, there is a unique
path for city dynamics.

D.3

Closed-Form Expression of the Capitalization Coeﬃcient

Proposition 8. (Impact of trading opportunities on price-amenity gradient)
Proof. In the price-amenity gradient @ log pkj /@zj , collect the terms in @r(j, Z)/@zj :
@ log pkj
@V l (j, Z)
=
+ (1
@zj
@zj
= ⇠ + (1

@V v (j, Z)
@zj
h
i
@E
V l (j, Z0 )|Z + (1
@zj
)

)⇣ +
(1

)

J
X

0

j0

+ (1

)

J
X

µj 0

r(j, Z))

0

r(j 0 , Z))

j 0 =1

54

(r(j, Z)

⇤
@E ⇥ v
V (l, Z0 )|Z
@zj

@r(j, Z)
@zj

(r(j 0 , Z)

j 0 =1
v

)

@r(j, Z)
,
@zj

and the factor in (1

) @r(j, Z)/@zj (last two lines) is:

J
X
⇥

v

0

µj 0

(r(j, Z)

j 0 =1

where

0 (d)

= ( p21

r(j 0 , Z))

1)f ( p2d )d + F ( p2d ), hence

"

"

"

j0

0

0(

d) = 1

⇤
r(j, Z)) ,

(r(j 0 , Z)

(37)

Factoring by , the term

0 (d).

becomes:
J 
X
N

L

j 0 =1

=

J 
X
N

L

j 0 =1

=

µj 0

0

(r(j, Z)

r(j 0 , Z))

j 0 (1

0

(r(j, Z)

r(j 0 , Z)))

µj 0

0

(r(j, Z)

r(j 0 , Z))

j 0 (1

0

(r(j, Z)

r(j 0 , Z)))

J
X
`j 0 0
N nj 0
(
+
) (r(j, Z)
L N
L
0

j =1

=

J
H X hj 0
L 0 H

0

(r(j, Z)

j =1

As

0 (·)

r(j 0 , Z))

r(j 0 , Z))

1

1.

is an increasing function, and H > L, there is a value r such that

H
L

r(j 0 , Z)) = 1. At that point, @ log pkj /@zj = ⇠.

PJ

hj 0
j 0 =1 H

0 (r

Now on average across locations, weighted by their number of housing units hj /H,
J
J
H X X h j hj 0
L
H H
0

0

(r(j, Z)

j=1 j =1

r(j 0 , Z))

J
J
H X X h j hj 0
1
=
(1(j 6= j 0 ) + 1(j = j 0 ))
L
H H
2
0

1

1

j=1 j =1
J

H X hj
= (
(1
L
H
j=1

J

hj
1X
)+
H
2
j=1

✓

hj
H

◆2

)

H
1 = (1
L

J

1X
2
j=1

✓

hj
H

◆2

)

1

the first term is positive when H > 2L. This makes the log price amenity relationship steeper if
@r(j, Z)/@zj

0 and flatter if @r(j, Z)/@zj  0. If all housing units are concentrated in one

neighborhood, the term becomes

1.

55

D.4

The Simple Case of a City without Matching Frictions

We consider a set of J neighborhoods and N households indexed by i. The price of housing in
neighborhood j is noted pj .
The demand for housing The value of living in a unit for household i is noted:
V ` (z) = z

p(z) + " +

· E(V ` (z0 )|z)

(38)

where p(z) is the price of housing in a neighborhood with amenities z. The unobservable " generates
variations in the valuations of housing across households, and thus a smooth downward sloping
demand curve. The demand for housing is the probability that such V ` (z) is maximum across all
values of z on the support Z. The demand for a neighborhood with characteristic z given the
citywide distribution of characteristics f (z) is thus:
D(z; f ()) = N · R

exp(V ` (z))
`
Z exp(V (w))f (w)dw

In steady-state, f (·) will be stable over time.

The supply of housing The supply of housing is the number of housing units “for sale” in each
neighborhood. This number of units is immediately equal to the number of housing units minus the
number of units demanded in the neighborhood. Demand generates its own supply.

S(z) = h(z)

n(z)

The value of a vacancy is then noted:
V v (z) = z⇠ + p(z) +

· E(V v (z0 )|z)

where the owner of a vacant unit earns the market price p(z). This value in turn aﬀects the righthand side E() of equation (38), and implies that V ` might not be a decreasing function of the price
p(z). That would only hold however with high values of .

56

Frictionless equilibrium The demand for housing at each location z 2 Z is equal to the supply
of units.
D(z; f ()) = S(z),
which in turn implies:
D(z; f ()) = h(z)

D(z; f ())

and thus:
D(z; f ()) =

h(z)
2

which implies that price diﬀerences reflect (i) amenity diﬀerences and (ii) the supply of housing in
the neighborhood. This is formalized as follows.
Definition. An equilibrium price schedule is a function p : z 7! p(z) such that the demand for
housing in each location is equal to half the number of housing units in that location.
Hence an increase in the number of housing units h(z) will lead to a decline in the equilibrium
price p(z), at constant amenities.
Remark. This relationship implies a constraint on the number of occupied and vacant units: as
R
R
D = N , and h = H, we need N = H/2. In other words, it is the arrival rate of oﬀers and the
uncertainty of matches that implies the imbalance between N and H in the frictional model.

The price amenity gradient With a one-dimensional amenity, and a constant supply of housing
across the z, the price-amenity gradient exactly reflects households’ preferences for amenities:

(

dp
) · D(1
dz

D) = 0 )

dp
=
dz

With a varying supply, the price-amenity gradient reflects both preferences

(39)
and the gradient of

supply w.r.t. amenities:

(

dp
) · D(1
dz

D) =

1 dh
dp
)
=
2 dz
dz

57

1
dh
2D(1 D) dz

(40)

