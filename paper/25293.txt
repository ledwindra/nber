NBER WORKING PAPER SERIES

THE MICROECONOMIC FOUNDATIONS OF AGGREGATE PRODUCTION FUNCTIONS
David Baqaee
Emmanuel Farhi
Working Paper 25293
http://www.nber.org/papers/w25293

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2018, Revised November 2019

We thank Maria Voronina for excellent research assistance. We thank Natalie Bau and Elhanan
Helpman for useful conversations. This paper was written for the 2018 BBVA lecture of the
European Economic Association. The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2018 by David Baqaee and Emmanuel Farhi. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

The Microeconomic Foundations of Aggregate Production Functions
David Baqaee and Emmanuel Farhi
NBER Working Paper No. 25293
November 2018, Revised November 2019
JEL No. E0,E1,E25
ABSTRACT
Aggregate production functions are reduced-form relationships that emerge endogenously from
input-output interactions between heterogeneous producers and factors in general equilibrium.
We provide a general methodology for analyzing such aggregate production functions by
deriving their first- and second-order properties. Our aggregation formulas provide nonparameteric characterizations of the macro elasticities of substitution between factors and of the
macro bias of technical change in terms of micro sufficient statistics. They allow us to generalize
existing aggregation theorems and to derive new ones. We relate our results to the famous
Cambridge-Cambridge controversy.

David Baqaee
UCLA
315 Portola Plaza
Los Angeles, CA
baqaee@econ.ucla.edu
Emmanuel Farhi
Harvard University
Department of Economics
Littauer Center
Cambridge, MA 02138
and NBER
emmanuel.farhi@gmail.com

1. Introduction
The aggregate production function is pervasive in macroeconomics. The vast
majority of macroeconomic models postulate that real GDP or aggregate
output Y can be written as arising from some specific parametric function
Y = F ( L1 , . . . , L N , A), where Li is a primary factor input and A indexes
different production technologies. By far the most common variant takes
the form Y = AF ( AK K, A L L), where A, AK , and A L index Hicks-neutral,
capital-augmenting, and labor-augmenting technical change, and F is a CES
function.1
From the early 50s to the late 60s, the aggregate production function
became a central focus of a dispute commonly called the CambridgeCambridge controversy. The attackers were the post-Keynesians, based
primarily in and associated with Cambridge, England, and the defenders
were the neoclassicals, based primarily in and associated with Cambridge,
Massachusetts.2 A primary point of contention surrounded the validity of
the neoclassical aggregate production function. To modern economists, the
archetypal example of the neoclassical approach is Solow’s famous growth
model (Solow, 1956), which uses an aggregate production function with
capital and labor to model the process of economic growth.
The debate kicked off with Joan Robinson’s 1953 paper criticizing the
aggregate production function as a ”powerful tool of miseducation.” The
post-Keynesians (Robinson, Sraffa, and Pasinetti, among others) criticized
the aggregate production function, and specifically, the aggregation of the
capital stock into a single index number. They were met in opposition by the
neoclassicals (Solow, Samuelson, Hahn, among others) who rallied in defense
of the aggregate production function.
Eventually, the English Cambridge prevailed against the American
Cambridge, decisively showing that aggregate production functions with an
aggregate capital stock do not always exist. They did this through a series
of ingenious, though perhaps exotic looking, “re-switching” examples. These
examples demonstrated that at the macro level, “fundamental laws” such as
diminishing returns may not hold for the aggregate capital stock, even if, at
the micro level, there are diminishing returns for every capital good. This
1.

More precisely, this variant can be written as
Y
A
=
Ȳ
Ā


ωK

AK K
ĀK K̄

 σ −1



σ

+ ωL

AL L
Ā L L̄

 σ−1 ! σ−σ 1
σ

,

where bars denote values of output, factors, and productivity shifters, at a specific point, ω L
and ωK = 1 − ω L are the and labor and capital shares at that point, and σ is the elasticity of
substitution between capital and labor. The popular Cobb-Douglas specification obtains in the
limit σ → 1.
2.

See Cohen and Harcourt (2003) for a retrospective account of the controversy.

2

means that a neoclassical aggregate production function could not be used
to study the distribution of income in such economies.
However, despite winning the battle, the English side arguably lost the
war. Although exposed as a fiction, the “neoclassical” approach to modeling
the production technology of an economy was nevertheless very useful. It
was adopted and built upon by the real business cycle and growth literatures
starting in the 1980s. Reports of the death of the aggregate production function
turned out to be greatly exaggerated, as nearly all workhorse macroeconomic
models now postulate an exogenous aggregate production function.
Why did Robinson and Sraffa fail to convince macroeconomists to
abandon aggregate production functions? One answer is the old adage: you
need a model to beat a model. Once we abandon the aggregate production
function, we need something to replace it with. Although the post-Keynesians
were effective in dismantling this concept, they were not able to offer
a preferable alternative. For his part, Sraffa advocated a disaggregated
approach, one which took seriously “the production of commodities by
means of commodities” (the title of his magnum opus). However, his impact
was limited. Clean theoretical results were hard to come by and conditions
under which factors of production could be aggregated were hopelessly
restrictive.3 In a world lacking both computational power and data, and in
lieu of powerful theorems, it is little wonder that workaday macroeconomists
decided to work with Solow’s parsimonious aggregate production function
instead. After all, it was easy to work with and only needed a sparing amount
of data to be calibrated, typically having just one or two free parameters (the
labor share and the elasticity of substitution between capital and labor).4
Of course, today’s world is awash in an ocean of micro-data and access to
computational power is cheap and plentiful, so old excuses no longer apply.
Macroeconomic theory must evolve to take advantage of and make sense of
detailed micro-level data. This paper is a contribution to this project.
We fully take on board the lessons of the Cambridge-Cambridge
controversy and allow for as many factors as necessary to ensure the
existence of aggregate production functions.5 Instead of desperately seeking
to aggregate factors, we focus on aggregating over heterogeneous producers
in competitive general equilibrium. Under the assumptions of homothetic
3.

For a good review, see Felipe and Fisher (2003)

4. The popular specification Y = AF ( AK K, A L L) with F a CES function described in details in
footnote 1 can be entirely calibrated using the labor share ω L and the elasticity of substitution
between capital and labor σ, or even with only the labor share ω L under the common CobbDouglas restriction.
5. Since we do not place any restrictions on the number of factors the economy has, we
can recreate the famous counterexamples from the Cambridge capital controversy in our
environment. In other words, despite having an aggregate production function, our framework
can accommodate the classic Cambridge UK critiques. We show exactly how in Section 5.

3

final demand and no distortions, such aggregation endogenously gives rise
to aggregate production functions.6 The key difference between our approach
and that of most of the rest of the literature that follows the Solow-Swan
paradigm is that we treat aggregate production functions as endogenous
reduced-form objects rather than structural ones. In other words, we do not
impose an arbitrary parametric structure on aggregate production functions at
the outset and instead derive their properties as a function of deeper structural
microeconomic primitives.
Our contribution is to fully characterize these endogenous aggregate
production functions, up to the second order, for a general class of
competitive disaggregated economies with an arbitrary number of factors
and producers, arbitrary patterns of input-output linkages, arbitrary
microeconomic elasticities of substitution, and arbitrary microeconomic
technology shifters. Our sufficient-statistic formulas lead to general
aggregation results expressing the macroeconomic elasticities of substitution
between factors and the macroeconomic bias of technical change in terms
of microeconomic elasticities of substitution and characteristics of the
production network.
The benefits of microfoundations do not require lengthy elaboration.
First, they address the Lucas critique by grounding aggregate production
functions in deep structural parameters which can be taken to be
constant across counterfactuals driven by shocks or policy. Second, they
allow us to understand the macroeconomic implications of microeconomic
phenomena. Third, they allow to unpack the microeconomic implications of
macroeconomic phenomena.
This development can be put in a broader perspective by drawing
an analogy with the shifting attitudes of economists towards aggregate
consumption functions. In the wake of the Rational Expectations Revolution
and the Lucas critique, economists abandoned aggregate consumption
functions— functions that postulated a parametric relationship between
aggregate consumption and aggregate income without deriving this
relationship from microeconomic theory. This has become all the more true
with the rise of heterogeneous-agent models following the early contributions
of Bewley (1986), Aiyagari (1994), Huggett (1993), and Krusell and Smith
(1998). However, the aggregate production function, which does much
the same thing on the production side of the economy was left largely
unexamined. By deriving an aggregate production function from firstprinciples, this paper provides microeconomic foundations for the aggregate
production function building explicitly on optimizing microeconomic
behavior.
6. We explain later how to generalize our results regarding macroeconomic elasticities of
substitution and the macroeconomic bias of technical change to environments with nonhomothetic final demand and with distortions.

4

We restrict attention to situations where the aggregate production
function, a function mapping endowments and technologies to aggregate
output, exists, because final demand is homothetic and there are no
distortions. The aggregate production function then depends on the structure
of final demand. It is possible to define an alternative notion, the aggregate
distance function, which separates technology from final demand. The
aggregate distance function must then be combined with final demand to
compute general-equilibrium comparative statics. Our object of interest is
the aggregate production function, which takes these two steps at once. This
choice, which is guided by our focus on general-equilibrium comparative
statics, is without loss of generality. Indeed, it is possible to use our results
for the aggregate production function to characterize the aggregate distance
function by using different specifications of final demand.
Aggregate production functions may fail to exist if there is no single
quantity index corresponding to final output; this happens if final demand
is non-homothetic either because there is a representative agent with nonhomothetic preferences or because there are heterogeneous agents with
different preferences. Furthermore, aggregate production functions also fail to
exist in economies with distortions. Extended notions of aggregate production
functions with distortions and non-homothetic final demand can be defined.
However, they are less useful in the sense that their properties cannot anymore
be tied to interesting observables: their first and second derivatives do not
correspond to factor shares, elasticities of substitution between factors, and
bias of technical change.
In this paper, we confine ourselves to economies with homothetic final
demand and without distortions. In other papers (see Baqaee and Farhi,
2019c, 2018), we have developed an alternative “propagation-equations”
methodology to cover economies with non-homothetic final demand and
with distortions. These propagation equations generalize equations (5) and
(6) in Proposition 2 and equations (8) and (9) in Proposition 7. They fully
characterize the elasticities of sales shares and factor shares to factor supplies,
factor prices, and technology shocks. They can be used along the exact same
lines as in this paper to express the macroeconomic elasticities of substitution
between factors and the macroeconomic bias of technical change as a function
of microeconomic primitives. This shows precisely how to extend our results
to economies with non-homothetic final demand and with distortions.
The outline of the paper is as follows. In Section 2 we set up the basic
model, introduce the aggregate cost and production functions as dual ways
of representing an economy’s production possibilities, and define the notions
of macroeconomic elasticities of substitution between factors and of the bias
of technical change. In Section 3, we define and characterize the properties of
aggregate cost functions for the case of nested-CES economies. In Section 4,
we define and characterize the properties of aggregate production functions
for the case of nested-CES economies. In Section 5, we review some classic
5

aggregation theorems and provide new ones. We revisit the CambridgeCambridge controversy, and represent some of the classic arguments via our
framework and language. In Section 6, we provide some simple theoretical
examples to illustrate the results developed in Sections 3 and 4: Hicksian
and non-Hicksian examples with two and three factors; an example showing
how to capture Houthakker (1955) within our framework; and an example of
factor-biased technical change in a task-based model. We also present a simple
quantitative application to capital-skill complementarity à la Griliches (1969)
in the US economy, taking into account the multiplicity of sectors and their
input-output linkages. We put it to use to revisit the analysis in Krusell et al.
(2000) of the role of these complementarities in the evolution over time of the
skill premium. In Section 7, we review several extensions. First, we generalize
the results of Sections 3 and 4 to non-nested-CES economies with two simple
tricks. Second, we explain how to use our results to separate technology from
final demand by characterizing the aggregate distance and associated cost
functions. Third, we explain how to generalize our results to economies where
final demand is non-homothetic and with distortions. We conclude in Section
8.

2. Setup
In this section, we setup the model and notation, define the equilibrium, the
aggregate production, and the aggregate cost function.
2.1. Environment
The model has a set of producers N, and a set of factors F with supply
functions L f . We write N + F for the union of these two sets. With some abuse
of notation, we also denote by N and F the cardinalities of these sets. What
distinguishes goods from factors is the fact that goods are produced from
factors and goods, whereas factors are produced ex nihilo. The output of each
producer is produced using intermediate inputs and factors, and is sold as an
intermediate good to other producers and as a final good.
Final demand is a constant-returns-to-scale aggregator
Y = D0 ( c1 , . . . , c N ),

(1)

where ci represents the use of good i in final demand and Y is real output.
Each good i is produced with some constant-returns- to-scale production
function. Hence, we can write the production function of each producer as
yi = Ai Fi ( xi1 , · · · , xiN , Li1 , · · · , LiF )

(2)

where yi is the total output of i, xij is the use of input j, and Li f is the
use of factor f . The variable Ai is a Hicks-neutral productivity shifter.
6

We will sometimes use the unit-cost function Ai−1 Ci ( p1 , · · · , p N , w1 , · · · , w F )
associated with the production function Fi .
Finally, the economy-wide resource constraints for goods j and factors f
are given by:
c j + ∑ xij = y j ,
(3)
i∈ N

∑ Li f

= Lf .

(4)

i∈ N

This framework is more general than it might appear. First, although we
have assumed constant-returns-to-scale production functions, our analysis
also covers the case of decreasing-returns-to-scale production functions
by adding producer-specific fixed factors.7,8,9 Similarly, although we have
assumed that, at the level of individual producers, technical change is
Hicks neutral, our analysis also covers the case of biased factor- or inputaugmenting technical change: for example, to capture factor- f -augmenting
technical change for firm i, we simply introduce a new fictitious producer
which linearly transforms factor f into factor f for firm i and study a Hicksneutral technology shock to this fictitious producer.10 Finally, although we
refer to each producer as producing one good, our framework actually allows
for joint production by multi-product producers: for example, to capture a
producer i producing goods i and i0 using intermediate inputs and factors, we
represent good i0 as an input entering negatively in the production and cost
functions for good i.11
7. This was an observation made by McKenzie (1959). See Section 6.3 for a concrete example in
the model of Houthakker (1955).
8. Note that this flexibility also allows us to capture different renditions of assignment/sorting
models (see Sattinger, 1993, for a survey). In these models: there are distributions of workers
and tasks of different types; output in a given task depends on both the type of the worker and
the type of the task; the output of different tasks can be complements or substitutes; and tasks
and workers may operate under decreasing returns to scale, limiting, for example, the number
of workers per task. These models can be captured within our framework by treating different
types of workers as different factors, different tasks as different producers, and allowing for
producer-specific fixed factor to capture decreasing returns at the task level.
9. Our formulas can also in principle be applied, with increasing-returns to scale, but only to
some limited extent, by allowing these quasi-fixed factors to be local “bads” receiving negative
payments over some range, but care must be taken because it introduces non-convexities in
the cost-minimization over variable inputs, and our formulas only apply when variable input
demand changes smoothly.
10. We generalize our results to factor-biased but not necessarily factor-augmenting technical
change at the producer level in Section 7.
11. To satisfactorily capture such features, one probably needs to go beyond the nested-CES
case on which we focus for a large part of the paper, and use instead the non-parametric
generalization to arbitrary economies provided in Section 7.

7

2.2. Feasible and Competitive Equilibrium Allocations
We first define feasible allocations.
Definition. (Feasible Allocations) A feasible allocation is a set of intermediate
input choices xij , factor input choices Li f , outputs yi , final demands ci , and real
output Y, such that (1), (2), (3), and (4) hold.
Next we define equilibrium allocations. Equilibrium allocations are
feasible allocations which arise as part of a competitive equilibrium.
Definition. (Equilibrium Allocations) An equilibrium allocation is a set of
prices pi and w f for goods and factors, intermediate input choices xij ,
factor input choices Li f , outputs yi , final demands ci , and real output Y,
such that: final demand maximizes Y subject to (1) and to the budget
constraint ∑iN=1 pi ci = ∑ Ff=1 w f L f ; each producer i maximizes its profits pi yi −
∑ j∈ N p j xij − ∑ f ∈ F w f Li f subject to (2), taking prices p j and wages w f as given;
the markets for all goods i and factors f clear so that (3) and (4) hold. Instead
of fixing factor supplies L f , we can also define feasible and equilibrium
allocations for given factor prices w f and level of income E allocated to final
demand.
The welfare theorems apply in our environment. Equilibrium allocations
are efficient and coincide with the solutions of the planning problems
introduced below, which define the aggregate production and cost functions.
We will make use of these theorems to go back and forth between those
properties most easily seen using the equilibrium decentralization and those
that arise more naturally using the planning problem.
Going forward, and to make the exposition more intuitive, we slightly
abuse notation in the following way. For each factor f , we interchangeably
use the notation w f or p N + f to denote its wage, the notation Li f or xi( N + f )
to denote its use by producer i, and the notation L f or y f or to denote total
factor supply. We define final demand as an additional good produced by
producer 0 according to the final demand aggregator. We interchangeably use
the notation c0i or x0i to denote the consumption of good i in final demand. We
write 1 + N for the union of the sets {0} and N, and 1 + N + F for the union
of the sets {0}, N, and F.
2.3. Aggregate Production and Cost Functions
The aggregate production function is defined as the solution of the following
planning problem:
F ( L1 , · · · , L F , A1 , · · · , A N ) = max Y
subject to (1), (2), (3), and (4). It is homogeneous of degree one in the factor
supplies L1 , · · · , L F . As already discussed above, this production function also
8

indexes the equilibrium level of real output as a function of productivity
shocks Ai and factor supplies L f .
The aggregate cost function is defined as the solution of the dual planning
problem which seeks to minimize the expenditure necessary to achieve real
output Y given factor prices w f :
C (w1 , · · · , w F , A1 , · · · A N , Y ) = min E
subject to (1), (2), (3), and E = ∑ f ∈ F w f L f . It is homogeneous of degree
one in the factor prices w1 , · · · , w F . The aggregate cost function is also
homogeneous of degree one in aggregate output Y so that we can write it
as YC (w1 , . . . , w F , A1 , . . . , A N ), where with some abuse of notation, C now
denotes the aggregate unit-cost function. Most of the results in the rest of
the paper characterize the log derivatives of the aggregate cost function
with respect to productivities or factor prices, which coincide with the
corresponding log derivatives of the aggregate unit-cost function, and so both
can be used interchangeably. To fix ideas, the reader can focus on the aggregate
cost function.
The primary difference between the aggregate production function and the
aggregate cost function is that the former takes the factor quantities as given,
while the latter takes the factor prices as given.
The goal of this paper is to characterize the aggregate production and cost
functions up to the second order as a function of microeconomic primitives
such as microeconomic elasticities of substitution and the input-output
network. Propositions 1 and 6 characterize the Jacobians (first derivatives)
and Propositions 2 and 7 the Hessians (second derivatives) of the aggregate
production and cost functions.
In economic terms, this means that we seek to characterize not only
macroeconomic marginal products of factors and factor demands (first-order
properties) but also macroeconomic elasticities of substitution between factors
and the sensitivities of marginal products of factors and factor demands to
technical change (second-order properties).
As mentioned before, we have put ourselves under conditions where the
existence of an “aggregate output” good can be taken for granted because
final demand is homothetic. Given our definitions, the properties of the
aggregate production and cost functions depend on final demand. One might
want to consider alternative notions which remove this dependence: the
aggregate distance and associated cost functions. One might also want to
study economies where there is no aggregate output good because final
demand is not homothetic, or economies with distortions. Our results can
be used to fully and precisely accommodate these desiderata. Detailed
explanations can be found in Sections A.3 and A.4.

9

2.4. Macroeconomic Elasticities of Substitution Between Factors
As is well known, there is no unambiguous way to generalize the standard
Hicksian notion of elasticity of substitution between factors (Hicks, 1932)
when there are more than two factors, and several concepts have been
proposed in the literature.
Invariably, all competing definitions of the elasticity of substitution are
computed via the Jacobian and Hessian of a function. Since we characterize
both of these in general, our results can be used to compute all the different
notions of the elasticity of substitution. In this paper, we follow Blackorby and
Russell (1989) who advocate using the definition due to Morishima (1967).
They argue that Morishima Elasticities of Substitution (MESs) are appealing
because they extend the standard Hicksian notion while preserving some
of its desirable properties: an MES is a measure of the inverse-curvature of
isoquants; it is a sufficient statistic for the effect on relative factor shares of
changes in relative factor prices; it is a log derivative of a quantity ratio to a
price ratio.12
Definition. (MESs for the Aggregate Production Function) The MES σ fFg
between factors f and g in the aggregate production function is defined as
d log F

d log F

dF
dF
d log( dL
/ dL
)
d log( d log L f / d log Lg )
1
g
f
=
=
1
+
.
d log( L g /L f )
d log( L g /L f )
σ fFg

Definition. (MESs for the Aggregate Cost Function) The MES σCfg between
factors f and g in the aggregate cost function is defined as
σCfg

=

dC
dC
/ dw
)
d log( dw
g
f

d log(w g /w f )

d log C

= 1+

d log C

d log( d log w f / d log wg )
d log(w g /w f )

.

Note that the ratios (dF/dŁ f )/(dF/dL g ) and (d log F/d log L f )/(d log F/d log L g )
are homogeneous of degree zero in L1 , · · · , L F . Similarly, the ratios
(dC/dw f )/(dC/dw g ) and (d log C/d log w f )/(d log C/d log w g ) are homogeneous of degree zero in w1 , · · · , w F . These definitions exploit this homogeneity
12. Stern (2010) points out that while the MES in cost do characterize the inverse-curvature
of the corresponding constant-output isoquants, those in production do not. In the production
function case, he defines the symmetric elasticity of complementarity to be the inverse-curvature
of the constant-output isoquants, and shows that its inverse, which measures the curvature of
the constant-output isoquants, is symmetric and can easily be recovered as a share-weighted
harmonic average (Λ f + Λ g )/(Λ f /σ Ffg + Λ g /σgFf ) of the MESs in production. This concept is the
dual of the shadow elasticity of substitution put forth by McFadden (1963), which is symmetric
and which can be recovered as share-weighted arithmetic average (Λ f σCfg + Λ g σgCf )/(Λ f + Λ g )
of the MESs in costs. We will focus on characterizing MESs for the aggregate production and cost
functions.

10

to write these ratios as functions of L1 /L f , · · · , L F /L f and w1 /w f , · · · , w F /w f ,
respectively. Therefore, underlying the definition of σ fFg are variations in
L g /L f , holding Lh /L f constant for h , g, i.e. variations in L g , holding Lh
constant for h , g. Similarly, underlying the definition of σCfg are variations
in w g /w f , holding wh /w f constant for h , g, i.e. variations in w g , holding wh
constant for h , g.
As we shall see below in Propositions 1 and 6, d log F/d log Lh and
d log C/d log wh are equal to the factor shares Λh in the competitive equilibria
of the corresponding economies. MESs therefore pin down the elasticities of
relative factor shares to relative factor supplies or relative factor prices:
1−

d log(Λ f /Λ g )
1
=−
F
d log( L g /L f )
σf g

and

σCfg − 1 =

d log(Λ f /Λ g )
.
d log(w g /w f )

Similarly, dF/dLh is equal to the wage rate wh and dC/dwh to the
factor demand per unit of output Lh in the competitive equilibria of the
corresponding economies, which can be viewed as homogeneous-of-degreezero functions of L1 , · · · , L F and w1 , · · · , w F respectively. MESs therefore pin
down the elasticities of factor prices to factor supplies and of factor demands
to factor prices:
d log(w f /w g )
1
=
F
d log( L g /L f )
σf g

and

σCfg =

d log( L f /L g )
.
d log(w g /w f )

MESs between factors in the aggregate production and cost functions can
be directly expressed as a function of the Jacobians and Hessians of these
functions:
1−

d2 log F/(d log L f d log L g )
d2 log F/(d log L g )2
1
=
−
,
d log F/d log L g
d log F/d log L f
σ fFg

σCfg − 1 =

d2 log C/(d log w f d log w g ) d2 log C/(d log w g )2
−
.
d log C/d log w f
d log C/d log w g

MESs between factors in the aggregate production function are typically
not symmetric so that σ fFg , σgFf and σCfg , σgCf in general. Moreover, MESs
between factors in the aggregate production and cost functions are typically
not equal to each other, so σ fFg , σgCf in general.
The “Hicksian” case where there are only two factors of production f and g
is special in this regard since in this case, the MESs for the cost and production
function are the same, and symmetric, so that we get σ fFg = σgFf , σCfg = σgCf , and
σ fFg = σCfg . The proof is standard and can be found in Hicks (1932) and in
Russell (2017) for example.

11

Consider the case where the aggregate production function and the
associated aggregate cost function are of the CES form with
A
F ( L1 , . . . , L N , A) = Ȳ
Ā
Ā
C ( w1 , . . . , w N , A ) =
A

N

∑ ωi



i =1
N

∑ ωi



i =1

Li
L̄i

wi
w̄i

 σ−σ 1 ! σ−σ 1
,
1−σ ! 1−1 σ
,

where bar variables correspond to some particular point and ωi denotes the
share of factor i at this point. Then with our definitions, the MESs in the
aggregate production and cost functions between factor f and factor g are
given by σ fFg = σCfg = σ.
More generally, if the aggregate production and cost functions are of the
nested-CES form, and if two factors belong to the same CES nest, then the MES
between these two factors is equal to the elasticity of substitution of the nest;
more generally, if two factors enter together with other factors only through a
nested-CES sub-aggregate, then the MES between these two factors is only a
function of the elasticities of substitution in the nested-CES sub-aggregate.
However, even when the economy with disaggregated production is of
the nested-CES form as described in Section 2.7, the aggregate production
and cost functions that describe its production possibility frontier are typically
not of the nested-CES form except in simple cases with limited heterogeneity
and simple input-output network structures. MESs between factors in the
aggregate production and cost functions are macroeconomic elasticities of
substitution. They incorporate general equilibrium effects and typically do not
coincide with any microeconomic elasticity of substitution.
Our results in Propositions 3 and 8 below deliver formulas for the
MESs between factors as a function of microeconomic primitives such as
microeconomic elasticities of substitution and the input-output network.
2.5. Macroeconomic Bias of Technical Change
We now present our definitions of the macroeconomic bias of technical
change. These definitions generalize the definitions proposed by (Hicks, 1932)
to the case of multiple factors. We present these definitions directly in terms
of the Jacobians and Hessians of the aggregate production and cost functions.
We later relate them to the elasticities of relative factor shares to technology
shocks.
Definition. (Bias of Technical Change for the Aggregate Production Function)
The bias B Ffgj in the aggregate production function towards factor f vs. factor

12

g of technical change driven by a technology shock to producer j is defined as
d log F

d log F

B Ffgj
1 + B Ffgj

=

d log( d log L f / d log Lg )
d log A j

.

Definition. (Bias of Technical Change for the Aggregate Cost Function) The
bias BCfgj in the aggregate cost function towards factor f vs. factor g of technical
change driven by a technology shock to producer j is defined as
d log C

BCfgj

=

d log C

d log( d log w f / d log wg )
d log A j

.

As already alluded to, and as we shall see below in Propositions 1 and 6,
d log F/d log Lh and d log C/d log wh are equal to the factor shares Λh in the
competitive equilibria of the corresponding economies. The macroeconomic
biases of technical change in the aggregate production and cost functions
therefore pin down the elasticities with respect to technology shocks of
relative factor shares as well as of relative factor prices and of relative factor
demands, holding respectively factor supplies or factor prices constant :13
B Ffgj
1+

B Ffgj

=

d log(w f /w g )
d log(Λ f /Λ g )
=
d log A j
d log A j

and

BCfgj =

d log(Λ f /Λ g )
d log( L f /L g )
=
.
d log A j
d log A j

Technological bias in the aggregate production and cost functions can
be directly expressed as a function of the Jacobians and Hessians of these
functions:
B Ffgj
1 + B Ffgj

=

BCfgj =

d2 log F/(d log A j d log L f ) d2 log F/(d log A j d log L g )
−
,
d log F/d log L f
d log F/d log L g
d2 log C/(d log A j d log w f ) d2 log C/(d log A j d log w g )
−
.
d log C/d log w f
d log C/d log w g

Even in the Hicksian case where there are only two factors, the biases of
technology in the aggregate production and cost functions do not necessarily
coincide so that B Ffgj , BCfgj in general.
13. We can use these measures to compute a measure of bias of technical change towards one
factor instead of towards one factor vs. another by defining
B Ffj =

∑

g∈ F

d log F F
B =
d log L g f gj

g∈ F

∑

d log C C
B =
d log w g f gj

∑ Λg BCfgj =

and
BCfj =

g∈ F

∑ Λg BFfgj =

g∈ F

d log Λ f
d log A j
d log Λ f
d log A j

holding respectively factor supplies or factor prices constant.

13

=

=

d log w f
d log A j
d log L f
d log A j

− λj

− λj ,

Consider the case where the aggregate production and cost functions are
of the CES form with
 σ−1 ! σ−σ 1

N
Ai Li σ
F ( L1 , . . . , L N , A1 , . . . , A N ) = Ȳ ∑ ωi
,
Āi L̄i
i =1
N

C ( w1 , . . . , w N , A 1 , . . . , A N ) =

∑ ωi

i =1



Āi wi
Ai w̄i

1−σ ! 1−1 σ
,

where bar variables correspond to some particular point, ωi denotes the
share of factor i at this point, and Ai is a technological shock augmenting
factor i. Then with our definitions, the biases in the aggregate production and
cost functions towards factor f vs. factor g of technical change driven by a
technology shock augmenting factor j are given B Ffgj = BCfgj = σ − 1 if j = f ,
B Ffgj = BCfgj = −(σ − 1) if j = g, and B Ffgj = BCfgj = 0 otherwise.
More generally, if the aggregate production and cost functions are of
the nested-CES form with factor-augmenting technical change, and if two
factors belong to the same CES nest, then the bias towards the first factor vs.
the second factor of a technology shock is equal to (minus) the elasticity of
substitution minus one of the nest if the technology shock augments the first
(second) of the two factors, and zero otherwise; more generally, if two factors
enter together with other factors only through a nested-CES sub-aggregate,
then the bias between these two factors is nonzero only for technology shocks
that augment the factors in the nested-CES sub-aggregate, and then it is only
a function of the elasticities of substitution in the nested-CES sub-aggregate.
However, even when the economy with disaggregated production is of the
nested-CES form as described in Section 2.7, the aggregate production and
cost functions that describe its production possibility frontier are typically
not of the nested-CES form with factor-augmenting technical change except
in simple cases with limited heterogeneity and simple input-output network
structures. The bias of technical change in the aggregate production and cost
functions are macroeconomic in nature. They incorporate general equilibrium
effects and typically do not coincide with any microeconomic elasticity of
substitution minus one.
Our results in Propositions 5 and 10 below deliver formulas for the
bias of technical change as a function of microeconomic primitives such as
microeconomic elasticities of substitution and the input-output network.
2.6. Input-Output Definitions
To state our results, we require some input-output notation and definitions.
We define input-output objects such as input-output matrices, Leontief
inverse matrices, and Domar weights. These definitions arise most naturally
in the equilibrium decentralization of the corresponding the planning solution
14

(for the aggregate production function or the aggregate cost function
respectively).
Input-Output Matrix. We define the input-output matrix to be the (1 + N +
F ) × (1 + N + F ) matrix Ω whose ijth element is equal to i’s expenditures on
inputs from j as a share of its total revenues
Ωij ≡

p j xij
,
pi yi

Note that input-output matrix Ω includes expenditures by producers on
factor inputs as well as expenditures by consumers for final consumption. By
Shephard’s lemma, Ωij is also the elasticity of the cost of i to the price of j,
holding the prices of all other producers constant.
Leontief Inverse Matrix. We define the Leontief inverse matrix as
Ψ ≡ ( I − Ω ) −1 = I + Ω + Ω 2 + . . . .
While the input-output matrix Ω records the direct exposures of one producer
to another, the Leontief inverse matrix Ψ records instead the direct and indirect
exposures through the production network. This can be seen most clearly by
noting that (Ωn )ij measures the weighted sums of all paths of length n from
producer i to producer j. By Shephard’s lemma, Ψij is also the elasticity of the
cost of i to the price of j holding fixed the prices of factors but taking into
account how the price of all other goods in the economy will change.
GDP and Domar Weights.
expenditures

GDP or nominal output is the total sum of all final
GDP =

∑ pi ci = ∑ pi x0i .

i∈ N

i∈ N

We define the Domar weight λi of producer i to be its sales share as a fraction
of GDP
pi yi
.
λi ≡
GDP
Note that ∑i∈ N λi > 1 in general since some sales are not final sales but
intermediate sales.
For expositional convenience, for a factor f , we sometimes use Λ f instead
of λ f . Note that the Domar weight Λ f of factor f is simply its total income
share.
We can also define the vector b to be final demand expenditures as a share
of GDP
pi ci
px
bi =
= i 0i = Ω0i .
GDP
GDP
The accounting identity
pi yi = pi ci +

∑ pi x ji = Ω0i GDP + ∑ Ω ji λ j GDP

j∈ N

j∈ N

15

links the revenue-based Domar weights to the Leontief inverse via
λ 0 = b 0 Ψ = b 0 I + b 0 Ω + b 0 Ω2 + . . . .
Another way to see this is that the i-th element of b0 Ωn measures the weighted
sum of all paths of length n from producer i to final demand.
2.7. Nested-CES Economies
We call an economy nested CES if all the production functions of all the
producers (including final demand) are of the nested-CES form with Hicksneutral technical change at the level of each nest. Following Baqaee and Farhi
(2019a), any nested-CES economy, with an arbitrary number of producers,
factors, CES nests, elasticities, and intermediate input use, can be re-written
in what we call standard form, which is more convenient to study.
A CES economy in standard form is defined by a tuple (ω, θ, F ). The (1 +
N + F ) × (1 + N + F ) matrix ω is a matrix of input-output parameters. The
(1 + N ) × 1 vector θ is a vector of microeconomic elasticities of substitution.
Each good i is produced with the production function

A
yi
= i  ∑ ωij
yi
Āi j∈1+ N + F



xij
xij

 θiθ−1

 θ θ−i 1
i

i



,

where xij are intermediate inputs from j used by i. Throughout the paper,
variables with over-lines are normalizing constants equal to the values at
some initial allocation. We represent final demand Y as the purchase of good 0
from producer 0 producing the final good. For the most part, we assume that
A0 = Ā0 and abstract away from this parameter.14
Through a relabelling, this structure can represent any nested-CES
economy with an arbitrary pattern of nests and elasticities. Intuitively, by
relabelling each CES aggregator to be a new producer, we can have as many
nests as desired.
To facilitate the exposition in the paper, and due to their ubiquity in
the literature, we present our baseline results for nested-CES economies in
Sections 3 and 4. We then explain how to generalize them for arbitrary
economies in Section A.1.15
14. Changes in A0 are changes in how each unit of final output affects consumer welfare. This
is what Hulten and Nakamura (2017) call “output-saving” technical change.
15. We assume throughout that all microeconomic elasticities of substitution are finite. Some
economic models assume that some of these elasticities are infinite. This implies that substitution
is not smooth at the producer level, and raises a number of technical issues having to do with
varying patterns of partial or full specialization. Our approach can be used to shed light on these
models by viewing them as limiting cases of perhaps models with large but finite elasticities.

16

3. Aggregate Cost Functions
In this section, we provide a general characterization of aggregate cost
functions up to the second order for nested-CES economies. We refer the
reader to Sections 6 and 6.5 for some simple theoretical and quantitative
examples, and to Section A.1 for a generalization to non-nested-CES
economies.
3.1. First-Order Characterization
The following proposition characterizes the first derivatives (gradient) of the
aggregate cost function.
Proposition 1. (Gradient) The first derivatives of the aggregate cost function are
given by the sales shares of goods and factors
d log C
= Λf
d log w f

and

d log C
= − λi .
d log Ai

The proposition follows directly from Hulten’s theorem (Hulten, 1978). It
shows that the elasticity of the aggregate cost function C to the price of factor
f is given by the share Λ f of this factor in GDP. Similarly, the elasticity of the
aggregate cost function C to the productivity of producer i is given by the
negative of the sales share λi of this producer in GDP. The proposition is fully
general and applies even when the economy is not of the nested-CES form.
Incidentally, Proposition 1 confirms that the aggregate cost function C
is homogeneous of degree one in factor prices, since ∑ f ∈ F Λ f = 1. It also
confirms that C is homogeneous of degree one in aggregate output Y since
d log C/ d log A0 = 1.
3.2. Second-Order Characterization
The following proposition characterizes the second derivatives (Hessian) of
the aggregate cost function.
Proposition 2. (Hessian) The second derivatives of the aggregate cost function are
determined by the elasticities of the sales shares of goods and factors
dΛ f
d2 log C
=
,
d log w f d log w g
d log w g
dλi
d2 log C
=−
,
d log A j d log Ai
d log A j
dΛ f
d2 log C
=
,
d log A j d log w f
d log A j

17

where the elasticities of the sales shares are given by
λk
CovΩ(k) ( ∑ Ψ( j) d log A j − ∑ Ψ( g) d log w g , Ψ(i) ),
λi
g∈ F
j∈ N
k ∈1+ N
(5)
and the elasticities of the factor shares are given by
d log λi =

∑

( θ k − 1)

d log Λ f =

∑

( θ k − 1)

k ∈1+ N

λk
CovΩ(k) ( ∑ Ψ( j) d log A j − ∑ Ψ( g) d log w g , Ψ( f ) ).
Λf
g∈ F
j∈ N
(6)

The shares propagation equations (5) and (6) are taken directly
from Baqaee and Farhi (2019a). While Baqaee and Farhi (2019a) focuses
on the second-order macroeconomic impact of microeconomic shocks
d2 log C/(d log A j d log Ai ), in this paper, we focus instead on d2 log C/(d log w f d log w g ),
which as we will show in Section 3.3 below, determines the macroeconomic elasticities of substitution between factors, as well as on
d2 log C/(d log A j d log w f ), which determines the elasticity of factor shares to
technical change i.e. the bias of technical change.
Of course, equation (6) is obtained simply by letting i = f in (5). This
proposition shows that these equations, which characterize the elasticities
of the shares of goods and factors to productivity shocks and factor prices,
completely pin down the second derivatives of the aggregate cost function.
In these equations, we make use of the input-output covariance operator
introduced by Baqaee and Farhi (2019a):
!
!
CovΩ(k) (Ψ( j) , Ψ(i) ) =

∑

Ωkl Ψlj Ψli −

l∈N+F

∑

l∈N+F

Ωkl Ψlj

∑

Ωkl Ψli

, (7)

l∈N+F

where Ω(k) corresponds to the kth row of Ω, Ψ( j) to jth column of Ψ, and Ψ(i)
to the ith column of Ψ. In words, this is the covariance between the jth column
of Ψ and the ith column of Ψ using the kth row of Ω as the distribution. Since
the rows of Ω always sum to one for a reproducible (non-factor) good k, we
can formally think of this as a covariance, and for a non-reproducible good,
the operator just returns 0.
To gain some intuition, consider for example the elasticity d log Λ f /d log w g
of the share Λ f of factor f to the price of factor g in equation (6). Imagine
a shock d log w g < 0 which reduces the wage of factor g. For fixed relative
factor prices, every producer k will substitute across its inputs in response to
this shock. Suppose that θk > 1, so that producer k substitutes expenditure
towards those inputs l that are more reliant on factor g, captured by Ψlg , and
the more so, the higher θk − 1. Now, if those inputs
are also more reliant on

factor f , captured by a high CovΩ(k) Ψ( g) , Ψ( f ) , then substitution by k will
increase expenditure on factor f and hence the income share of factor f . These
substitutions, which happen at the level of each producer k, must be summed
18

across producers. The intuition for d log Λ f /d log A j in equation (6) as well as
for d log λi /d log w g and d log λi /d log A j in equation 5 is similar.
3.3. Macroeconomic Elasticities of Substitution Between Factors
We can leverage Proposition 2 to characterize the macroeconomic elasticities
of substitution between factors in the aggregate cost function.
Proposition 3. (MESs) The MESs between factors in the aggregate cost function are
given by
σCfg = ∑ θk λk CovΩ(k) (Ψ( g) , Ψ( g) /Λ g − Ψ( f ) /Λ f ),
k ∈1+ N

where

∑

k ∈1+ N

λk CovΩ(k) (Ψ( g) , Ψ( g) /Λ g − Ψ( f ) /Λ f ) = 1.

This proposition shows that MESs σCfg between factors in the aggregate cost
function are weighted averages of the microeconomic elasticities of substitution
θk in production with weights given by sufficient statistics of the inputoutput network λk CovΩ(k) (Ψ( g) , Ψ( g) /Λ g − Ψ( f ) /Λ f ). These weights capture
the change in expenditure for factor f vs. g from substitution by producer k in
response to a change in the price of factor f .
This implies the following network-irrelevance result, already uncovered
in Baqaee and Farhi (2019a), in the knife-edge case where all the
microeconomic elasticities of substitution are identical.
Proposition 4. (Network Irrelevance) If all microeconomic elasticities of substitution
θk are equal to the same value θk = θ, then MESs σCfg between factors in the aggregate
cost function are also equal to that value σCfg = θ.
3.4. Macroeconomic Bias of Technical Change
We can also leverage Proposition 2 to characterize the macroeconomic bias of
technical change in the aggregate cost function.
Proposition 5. (Bias of Technical Change) The biases towards one factor vs. another
of the different technology shocks in the aggregate cost function are given by
BCfgj =

∑

k ∈1+ N

(θk − 1)λk CovΩ(k) (Ψ( j) , Ψ( f ) /Λ f − Ψ( g) /Λ g ).

This proposition shows that biases BCfgj are weighted sums of the
departures from one θk − 1 of the microeconomic elasticities of substitution
with weights given by sufficient statistics of the input-output network
λk CovΩ(k) (Ψ( j) , Ψ( f ) /Λ f − Ψ( g) /Λ g ). These weights capture the change in
expenditure for factor f vs. g as a result substitution by producer k in response
to a technology shock to producer j.
19

The network-irrelevance result for MESs in the aggregate cost function
stated in Proposition 4 does not extend to the bias of technical change. In
general, the network matters for the bias of technical change, even when all the
microeconomic elasticities of substitution θk are identical. The Cobb-Douglas
is the one case where it doesn’t: when all the microeconomic elasticities θk are
unitary so that θk = 1, technical change in unbiased with BCfgj = 0 for all f , g,
and j, no matter what the structure of the network is.

4. Aggregate Production Functions
In this section, we provide a general characterization of aggregate production
functions up to the second order for nested-CES economies. We refer the
reader to Sections 6 and 6.5 for some simple theoretical and quantitative
examples, and to Section A.1 for a generalization to non-nested-CES
economies.
4.1. First-Order Characterization
The following proposition characterizes the first derivatives (gradient) of the
aggregate production function.
Proposition 6. (Gradient) The first derivatives of the aggregate production function
are given by the sales shares of goods and factors
d log F
= Λf
d log L f

and

d log F
= λi .
d log Ai

The proposition follows directly from Hulten’s theorem (Hulten, 1978). It
shows that the elasticity of the aggregate production function F to the supply
of factor f is given by the share Λ f of this factor in GDP. Similarly, the elasticity
of the aggregate production function F to the productivity of producer i is
given by the sales share λi of this producer in GDP. The proposition is fully
general and applies even when the economy is not of the nested-CES form.
Once again, Proposition 6 confirms that the aggregate production function
is homogeneous of degree one with respect to factor quantities since
∑ f ∈ F Λ f = 1.
4.2. Second-Order Characterization
The following proposition characterizes the second derivatives (Hessian) of
the aggregate production function.

20

Proposition 7. (Hessian) The second derivatives of the aggregate production
function are given by the elasticities of the sales shares of goods and factors
dΛ f
d2 log F
=
,
d log L f d log L g
d log L g
dλi
d2 log F
=
,
d log A j d log Ai
d log A j
dΛ f
d2 log F
=
,
d log A j d log L f
d log A j
where the elasticities of the sales shares are given by
d log λi =

∑

( θ k − 1)

k ∈1+ N

λk
CovΩ(k) ( ∑ Ψ( j) d log A j + ∑ Ψ( g) d log L g , Ψ(i) )
λi
g∈ F
j∈ N

−

∑ ∑

( θ k − 1)

h ∈ F k ∈1+ N

λk
CovΩ(k) (Ψ(h) , Ψ(i) )d log Λh , (8)
λi

and where the elasticities of the factor shares solve the following system of linear
equations
d log Λ f =

∑

( θ k − 1)

k ∈1+ N

−

λk
CovΩ(k) ( ∑ Ψ( j) d log A j + ∑ Ψ( g) d log L g , Ψ( f ) )
Λf
g∈ F
j∈ N

∑ ∑

( θ k − 1)

h ∈ F k ∈1+ N

λk
CovΩ(k) (Ψ(h) , Ψ( f ) )d log Λh . (9)
Λf

The shares propagation equations (8) and (9) are taken directly
from Baqaee and Farhi (2019a). While Baqaee and Farhi (2019a) focuses
on the second-order macroeconomic impact of microeconomic shocks
d2 log F/(d log A j d log Ai ), in this paper, we focus instead on d2 log F/(d log L f d log L g ),
which as we will show in Section 4.3 below, determines the macroeconomic elasticities of substitution between factors, as well as on
d2 log F/(d log A j d log w f ), which determines the elasticity of factor shares to
technical change i.e. the bias of technical change.
The difference with the characterization of the second-order aggregate cost
function in Section 3.2 is that: the elasticities of the factor shares show up in
equation (8) for the elasticities of the sales shares; the elasticities of the sales
shares are now given by a system of linear equations. As we shall see, this is
because shocks trigger changes in relative demand for factors, which given
fixed factor supplies, lead to changes in factor prices.
To gain some intuition, consider for example the vector of elasticities
d log Λ/d log L g of factor shares to the supply of factor g. Note that as observed
in Baqaee and Farhi (2019a), we can rewrite the system of linear factor share
propagation equations (9) as
d log Λ
d log Λ
=Γ
+ δ( g) ,
d log L g
d log L g
21

(10)

with
Γfh = −

∑

( θ k − 1)

k ∈1+ N


λk
CovΩ(k) Ψ(h) , Ψ( f ) ,
Λf

and
δf g =

∑

k ∈1+ N

( θ k − 1)


λk
CovΩ(k) Ψ( g) , Ψ( f ) .
Λf

We call δ the factor share impulse matrix. Its gth column encodes the direct or
first-round effects of a shock to the supply of factor g on factor income shares,
taking relative factor prices as given. We call Γ the factor share propagation
matrix. It encodes the effects of changes in relative factor prices on factor
income shares, and it is independent of the source of the shock g.
Consider a shock d log L g > 0 which increases the supply of factor g. If we
fix relative factor shares, the relative price of this factor declines by −d log L g .
Every producer k will substitute across its inputs in response to this shock.
Suppose that θk > 1, so that producer k substitutes expenditure towards those
inputs l that are more reliant on factor g, captured by Ψlg , and the more so, the
higher θk − 1. Now, if thoseinputs are also more reliant on factor f , captured
by a high CovΩ(k) Ψ( g) , Ψ( f ) , then substitution by k will increase expenditure
on factor f and hence the income share of factor f . These substitutions, which
happen at the level of each producer k, must be summed across producers.
This first round of changes in the demand for factors triggers changes in
relative factor prices which then sets off additional rounds of substitution in
the economy that we must account for, and this is the role Γ plays. For a given
set of factor prices, the shock to g affects the demand for each factor, hence
factor income shares and in turn factor prices, as measured by the F × 1 vector
δ( g) given by the gth column of δ. These changes in factor prices then cause
further substitution through the network, leading to additional changes in
factor demands and prices. The impact of the change in the relative price of
factor h on the share of factor f is measured by the f hth element of the F × F
matrix Γ. The movements in factor shares are the fixed point of this process,
i.e. the solution of equation (10):
d log Λ
= ( I − Γ)−1 δ( g) ,
d log L g
where I is the F × F identity matrix.
The intuition for the elasticities of factor share to productivity shocks
d log Λ/d log A j in equation (9) and for the elasticities of sales shares of goods
to factor supplies d log λ/d log L g and to productivities d log λ/d log A j in
equation (8) are similar.

22

4.3. Macroeconomic Elasticities of Substitution Between Factors
As in Section 3.3, we can leverage Proposition 7 to characterize the
macroeconomic elasticities of substitution between factors in the aggregate
production function.
Proposition 8. (MESs) The MESs between factors in the aggregate production
function are given by
1−

1
= ( I( g) − I( f ) )0 ( I − Γ)−1 δ( g) ,
σ fFg

where Γ is the F × F factor share propagation matrix defined by
Γhh0 = −

∑

k ∈1+ N


(θk − 1)λk CovΩ(k) Ψ(h0 ) , Ψ(h) /Λh ,

δ is the F × F factor share impulse matrix defined by
δhh0 =

∑

k ∈1+ N

(θk − 1)λk CovΩ(k) Ψ(h0 ) , Ψ(h) /Λh



δ( g) is its gth column, I is the F × F identity matrix, and I( f ) and I( g) are its f th and
gth columns.
In Section 3.3, we showed that the MES σCfg between factors in the
aggregate cost function are weighted averages of the microeconomic elasticities
of substitution θk in production with weights given by sufficient statistics
λk CovΩ(k) (Ψ( g) , Ψ( g) /Λ g − Ψ( f ) /Λ f ) of the input-output network. For the
aggregate production function, the MESs σ fFg between factors are still
determined by microeconomic elasticities of substitution θk and by sufficient
statistics λk CovΩ(k) (Ψ(h0 ) , Ψ(h) /Λh ) of the input-output network. However,
they are no longer weighted averages of the microeconomic elasticities of
substitution, and they depend on a longer list of input-output network
sufficient statistics. In fact, σ fFg is now a nonlinear function of the sufficient
statistics (θk − 1)λk CovΩ(k) (Ψ(h0 ) , Ψ(h) /Λh ).
There are two special cases where σ fFg becomes a weighted average of the
microeconomic elasticities θi , The first case is the “Hicksian” case when there
are only two factors. The second case is when all the microeconomic elasticities
of substitution are identical, which follows from the following networkirrelevance result established in uncovered in Baqaee and Farhi (2019a).
Proposition 9. (Network Irrelevance) If all microeconomic elasticities of substitution
θk are equal to the same value θk = θ, then MESs σ fFg between factors in the aggregate
production function are also equal to that value σ fFg = θ.

23

4.4. Macroeconomic Bias of Technical Change
We can also leverage Proposition 7 to characterize the macroeconomic bias of
technical change in the aggregate production function.
Proposition 10. (Bias of Technical Change) The biases towards one factor vs. another
of the different technology shocks in the aggregate production function are given by
B Ffgj
1 + B Ffgj

= ( I( f ) − I( g) )0 ( I − Γ)−1 δ̂( j) ,

where Γ is the F × F factor share propagation matrix defined by
Γhh0 = −

∑

k ∈1+ N


(θk − 1)λk CovΩ(k) Ψ(h0 ) , Ψ(h) /Λh ,

δ̂ is the F × 1 + N factor share impulse matrix defined by
δ̂hj =

∑

k ∈1+ N


(θk − 1)λk CovΩ(k) Ψ( j) , Ψ(h) /Λh ,

δ̂( j) is its jth column, I is the F × F identity matrix, and I( f ) and I( g) are its f th and
gth columns.
In Section 3.4, we showed that the bias BCfgj of technical change in the
aggregate cost function was a weighted sum of the departure from one θk − 1
of the microeconomic elasticities of substitution in production with weights
given by sufficient statistics λk CovΩ(k) (Ψ( j) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) of the inputoutput network. For the aggregate production function, B Ffgj is determined by
departures from one θk − 1 of microeconomic elasticities of substitution and
by sufficient statistics λk CovΩ(k) (Ψ( j) , Ψ(h) /Λh ) and λk CovΩ(k) (Ψ(h0 ) , Ψ(h) /Λh )
of the input-output network. However, it is no longer a weighted sum of
the departures from one of the microeconomic elasticities of substitution,
and it depends on a longer list of input-output network sufficient statistics.
In fact, B Ffgj is now a nonlinear function of the sufficient statistics (θk −
1)λk CovΩ(k) (Ψ( j) , Ψ(h) /Λh ) and (θk − 1)λk CovΩ(k) (Ψ(h0 ) , Ψ(h) /Λh ).
As in case of the aggregate cost function, the network-irrelevance result
for MESs in the aggregate production function stated in Proposition 9 does
not extend to the bias of technical change. In general, the network matters
for the bias of technical change, even when all the microeconomic elasticities
of substitution θk are identical. Once again, the Cobb-Douglas is the one case
where it doesn’t: when all the microeconomic elasticities θk are unitary so that
θk = 1, technical change in unbiased with B Ffgj = 0 for all f , g, and j, no matter
what the structure of the network is.
As already mentioned, in Sections 6 and 6.5, we will present some simple
theoretical and quantitative examples to illustrate the results of Sections 3
24

and 4.. In Section 7, we will also generalize these results to non-nestedCES economies. Before doing so however, we now turn to the questions of
factor aggregation and network factorization and relate our results to the
Cambridge-Cambridge controversy.

5. Factor Aggregation, Network Factorization, and the
Cambridge-Cambridge Controversy
“The production function has been a powerful instrument of miseducation. The
student of economic theory is taught to write Y = F (K, L) where L is a quantity
of labour, K a quantity of capital and Y a rate of output of commodities. He is
instructed to [...] measure L in man-hours of labour; he is told something about
the index-number problem involved in choosing a unit of output ; and then he is
hurried on [...], in the hope that he will forget to ask in what units K is measured.
Before ever he does ask, he has become a professor, and so sloppy habits of
thought are handed on from one generation to the next.” — Robinson (1953)

As described earlier, the Cambridge-Cambridge controversy was a decadeslong debate about the foundations of the aggregate production function. The
broader context of the controversy was a clash between two views of the
origins of the returns to capital. The first one is the Marxist view of the return
to capital as a rent determined by political economy and monopolization.
The second one is the marginalist view of the competitive return to capital
determined by technology, returns to scale, and scarcity. The marginalist view
is encapsulated in the “three key parables” of neoclassical writers (Jevons,
Bohm-Bawerk, Wicksell, Clark) identified by Samuelson (1966): (1) the rate
of interest is determined by technology (r = FK ); (2) there are diminishing
returns to capital (K/Y and K/L are decreasing in r); and (3) the distribution
of income is determined by relative factor scarcity (r/w is decreasing in
K/L). These parables are consequences of having a per-period neoclassical
aggregate production function F (K, L) which has decreasing returns in each
of its arguments.
In his famous “Summing Up” QJE paper (Samuelson, 1966), Samuelson,
speaking for the Cambridge US camp, finally conceded to the Cambridge
UK camp and admitted that indeed, capital could not be aggregated. He
produced an example of an economy with “re-switching” : an economy where,
as the interest rate decreases, the economy switches from one technique to the
other and then back to the original technique. This results in a non-monotonic
relationship between the capital-labor ratio as a function of the rate of interest
r.
Since the corresponding capital-labor and capital-output ratios are nonmonotonic functions of the rate of interest, this economy violates the first
two of the three key parables. It is impossible to represent the equilibrium of
the economy with a simple neoclassical model with a neoclassical aggregate

25

production function with capital and labor, and where output can be used for
consumption and investment.
Importantly, this result is established using valuations to compute the
value of the capital stock index as sum of the values of the existing vintages
of techniques, i.e. the net-present-value of present and future payments to
nonlabor net of the net-present-value of present and future investments. The
value of the capital stock depends on the rate of interest. Basically, the physical
interpretation of capital is lost when it is aggregated in this financial way, and
so are basic technical properties such as decreasing returns.16
The reactions to the Cambridge-Cambridge controversy were diverse.
Post-Keynesians, like Pasinetti, considered neoclassical theory to have been
“shattered” by their critiques.17 Samuelson (and others like Franklin Fisher)
on the other hand became invested in the view that one should develop
disaggregated models of production. For example, Samuelson concluded his
“A Summing Up” paper with this:
“Pathology illuminates healthy physiology [...] If this causes headaches for those
nostalgic for the old time parables of neoclassical writing, we must remind
ourselves that scholars are not born to live an easy existence.” — Samuelson
(1966).

Solow was more ambivalent:
“There is a highbrow answer to this question and a lowbrow one. The highbrow
answer is that the theory of capital is after all just a part of the fundamentally
microeconomic theory of the allocation of resources, necessary to allow for the
fact that commodities can be transformed into other commodities over time.
Just as the theory of resource allocation has as its ‘dual’ a theory of competitive
pricing, so the theory of capital has as its ‘dual’ a theory of intertemporal pricing
involving rentals, interest rates, present values and the like. The lowbrow answer,
I suppose, is that theory is supposed to help us understand real problems, and the
problems that cannot be understood without capital-theoretic notions are those
connected with saving and investment. Therefore the proper scope of capital
theory is the elucidation of the causes and consequences of acts of saving and
investment. Where the highbrow approach tends to be technical, disaggregated,
and exact, the lowbrow view tends to be pecuniary, aggregative, and approximate.
A middlebrow like myself sees virtue in each of these ways of looking at capital
theory. I am personally attracted by what I have described as the lowbrow view of

16. A historical reason for the focus of the controversy on the aggregation of capital as opposed
to labor was the view held by the participants there was a natural physical unit in which to
measure labor, man-hours. This view rests on the debatable assumption that different forms
of labor, such as skilled labor and unskilled labor for example are perfect substitutes. Another
historical reason was that some participants in the controversy took the view that labor could be
reallocated efficiently across production units in response to shocks whereas capital was stuck in
the short run, which they thought made the aggregation of capital more problematic. From the
perspective of this paper, the aggregation problem for capital is not meaningfully different from
that of labor. In general, outside of knife-edge cases, factors that are not perfectly substitutable
or which cannot be reallocated cannot be aggregated.
17.

See for example Pasinetti et al. (2003).

26

the function of capital theory. But as so often happens, I think the highbrow view
offers indispensable help in achieving the lowbrow objective.” — Solow (1963).

In the mid 60s, an “MIT school” arose, which attempted to make progress
on the study of disaggregated models of production. It impact was limited.
Of course it didn’t help that the re-switching example that concluded the
Cambridge-Cambridge controversy seemed so exotic. Later, developments
in the growth literature, the arrival of real business cycle models, and the
rational expectations revolution shifted the mainstream of the profession
(with a few notable exceptions) away from these questions of heterogeneity
and aggregation and towards dynamics and expectations.
In our opinion, the general neglect of these questions is unfortunate, and
we hope that our work will contribute to reviving interest in these important
topics. This section can be seen as a historical detour to make contact with
the issues that preoccupied the protagonists of the Cambridge-Cambridge
controversy. First, in Section 5.1, we show that generically, capital, or for
that matter, any group of distinct factors, cannot be physically aggregated.
Second, in Section 5.2, we give useful sufficient conditions for the possibility of
physically factorizing the production network into components which can be
represented via a sub-aggregate production functions. Third, in Section 5.3, we
show how to capture Samuelson’s reswitching example showing that capital
cannot be linearly aggregated financially with valuations using our formalism.
The general lesson from this section is that the details of the production
network matter, that outside of very knife-edge special cases, aggregating
factors violates the structure of the network, and hence that it also changes
the properties of the model. As a result, attempting to capture a disaggregated
model of production by directly postulating an aggregate model does not
work outside of very special cases.
5.1. Factor Aggregation
We study the aggregate production and cost functions of an economy with
more than three factors. For brevity, we only treat the case of the aggregate cost
function in nested-CES economies. The analysis of the general non-nestedCES case is similar, using the generalizations presented in Section 7. Similar
proofs can be given in the case of the aggregate production function.18 We
also abstract from productivity shocks in our discussion (hold them fixed),
but similar reasoning can be extended to productivity shocks.
Consider a non-trivial partition { Fi }i∈ I of the set factors F, i.e. such that
there exists an element of the partition comprising strictly more than 1 and
strictly less than F factors. We say factors can be aggregated according in the
18. The results also extend the “hybrid” case of an economy where some factors are in inelastic
supply and some factors are in perfectly elastic supply, as in the steady state of a Ramsey model.

27

partition { Fi }i∈ I if there exists a set of functions C̃ and g̃i such that
C (w1 , . . . , w F , Y ) = C̃ ( g1 ({w f } f ∈ F1 ), . . . , g I ({w f } f ∈ FI ), Y ).
Similarly, we say that factors can be aggregated in to the partition { Fi }i∈ I , up
to an nth order approximation, if there exists a set of functions C̃ and g̃i such
that for all m ≤ n and ( f 1 , f 2 , · · · , f m ) ∈ F m ,
dm log C̃ ( g̃1 ({w f } f ∈ F1 ), . . . , g̃ I ({w f }i∈ FI ), Y )
dm log C (w1 , . . . , w F , Y )
=
.
dw f1 · · · dw f m
dw f1 · · · dw f m
In words, the factors can be aggregated up to the nth order, if there exists a
separable function whose derivatives coincide with C up to the nth order.
A strict subset Fi of factors can always be aggregated locally to the
first order by matching the shares of these factors in revenue.19 But this
aggregation fails to the second order, and by implication, it also fails globally.
Indeed, and abstracting from productivity shocks, by the Leontief-Sono
theorem, the strict subset Fi of factors can be globally aggregated in the
aggregate cost function if and only if Cw f /Cwg , is independent of wh for all
( f , g) ∈ Fi2 and h ∈ F − Fi . This is equivalent to the condition that
d2 log C
d2 log C
−
=0
d log wh d log w f
d log wh d log w g
C
for all ( f , g) ∈ Fi2 , h ∈ F − Fi , and vector of factor
or equivalently that σhCf = σhg
prices. Using Proposition 2, this equation can be rewritten as

∑

k ∈1+ N

(θk − 1)λk CovΩ(k) (Ψ(h) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) = 0.

It is clear that this property is not generic: starting with an economy
where this property holds, it is possible to slightly perturb the economy
and make it fail. Indeed, suppose that the property holds at the original
economy for a given vector of factor prices. Consider a set Fi an element of
the partition comprising strictly more than 1 and strictly less than F factors. If
CovΩ(k) (Ψ(h) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) , 0 for some k, ( f , g) ∈ Fi2 , and h ∈ F − Fi ,
then it is enough to perturb the elasticity θk to make the property fail. If
CovΩ(k) (Ψ(h) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) = 0 for all k, ( f , g) ∈ Fi2 , and h ∈ F − Fi , then
we need to perturb the network to bring ourselves back to the previous case.
It is enough to introduce a new producer producing only from factors h and
f and selling only to final demand, with a small share e, and scale down the
19. A loglinear approximation of the aggregate cost function is trivially separable in every
partition, and is a first-order approximation. By Proposition 1, the log-linear approximation sets
the elasticity of the aggregate cost function with respect to the wage of each factor equal to the
revenue share of that factor.

28

other expenditure share in final demand by 1 − e. We can choose the exposures
of the new producer to h and f such that CovΩ(0) (Ψ(h) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) , 0
for e , 0 small enough. This leads us the following proposition.
Proposition 11. (Conditions for Factor Aggregation) Consider an economy with
more than three factors and a non-trivial partition { Fi }i∈ I of the set F of factors. In the
aggregate production function, the factors can be aggregated in to the partition if and
F
only if σhFf = σhg
for all i ∈ I, ( f , g) ∈ Fi2 , h ∈ F − Fi , and vector of factor supplies.
Similarly, in the aggregate cost function, the factors can be aggregated according to
C
for all i ∈ I, ( f , g) ∈ Fi2 , h ∈ F − Fi , and
the partition if and only if σhCf = σhg
vector of factor prices. The conditions for factor aggregation according to a given
partition in the aggregate production and cost functions are equivalent. Generically,
these properties do not hold.
The capital-aggregation theorem of Fisher (1965) can be seen through
the lens of this proposition. It considers an economy with firms producing
perfectly-substitutable goods using firm-specific capital and labor. It shows
that the different capital stocks can be aggregated into a single capital index
in the aggregate production function if and only if all the firms have the same
production function up to a capital-efficiency term. In this case, and only in
the case, all the MESs between the different firm-specific capital stocks and
labor in the aggregate production function are all equal to each other, and are
equal to the elasticity of substitution between capital and labor of the common
firm production function.
Proposition 11 also shows that generically, capital, or indeed any other
factor, cannot be aggregated. In other words, disaggregated production
models cannot be avoided. Our approach in the previous sections
acknowledges this reality and start with as many disaggregated factors as is
necessary to describe technology. Our results take disaggregated models and
seek to characterize their properties in terms of standard constructs such as
the aggregate production and cost functions, marginal products of factors and
factor demands, and elasticities of substitution between factors.
5.2. Network Factorization and Sub-Aggregate Production Functions
There is one frequently-occurring network structure under which we can
establish a powerful form of network aggregation. This result can easily be
conveyed at a high level of generality without requiring the economy to be of
the nested-CES form. We need the following definition.
Definition. Let I be a subset of nodes. Let M be the set of nodes j < I with
Ωij , 0 for some i ∈ I. We say (r, I, M) is an island, if
1. There is a unique node r ∈ I such that Ωir = 0 for every i ∈ I.
2. Ω ji = 0 for every i ∈ I − {r } and every j < I.
3. Ωkj = 0 for every j ∈ M and k < I.
29

We call r the export of the island. We say M are imports of the island.
The imports of the island can be factors or non-factors. With some abuse of
notation, we denote by xri the total imports of good i ∈ M of the whole island
(r, I, M). In the case where f ∈ M is a factor, we also use the notation Lr f . See
Figure 1 for a graphical illustration.
Note that the requirement that the export r of the island not be used as an
intermediate input by other producers in the island is merely a representation
convention: if it is not the case, we can always introduce a fictitious producer
which transforms the good into an export using a one-to-one technology. The
same remark applies to the requirement that imports of the island not be used
by producers outside of the island: if a particular import is used by another
producer outside of the island, we can always introduce a fictitious producer
which transforms the good into an import using a one-to-one technology.
M1

···

M2

Mn −1

Mn

xr2

xr1

I1

I3

xr,n−1

···

I2

xrN

r

F IGURE 1. Illustration of an island (r, I, M ) within a broader network. The nodes in the
island I are in blue, the imports M are in green, and the export of the island is denoted by
r. The figure only shows the island, its imports, and its export. This island is embedded in
a broader network which is not explicitly represented in the figure.

Given an island (r, I, M), we can define an associated island sub-aggregate
production function with the island’s imports as factors and its exports as
aggregate output:

Fr { xri }i∈ M , { Ai }i∈ I = max yr ,
(11)

30

subject to
y j = A j Fj ({ x jk }k∈ I −{r}+ M )

∑ xij = xrj

( j ∈ I ),

( j ∈ I − { r } + M ).

i∈ I

With some abuse of notation, we use the same symbol Fr to denote the
endogenous island sub-aggregate production function that we have used to
denote the exogenous production function of producer r. The arguments of
the latter are the intermediate inputs used by producer r while those of the
former are the imports of the island and the productivities of the different
producers in the island. The island sub-aggregate production function can
be characterized using the same methods that we have employed for the
economy-wide aggregate production function throughout the paper.
The planning problem defining the economy-wide aggregate production
function can then be rewritten by replacing all the nodes in the island by its
sub-aggregate production function:
F ( L1 , . . . , L N , A1 , . . . , A N ) = max D0 (c1 , . . . , c N )
subject to
yi = Ai Fi ({ xij } j∈ N − I +{r}+ F )

( i ∈ N − I ),

yr = Fr { xri }i∈ M , { Ai }i∈ I ,

ci +

∑

x ji = yi

(i ∈ N − I + {r }),

j∈ N − I +{r }

∑

xi f = L f

( f ∈ F ),

i ∈ N − I +{r }

where Fr is the island sub-aggregate production function.
So, if the economy contains islands, then the economy-wide aggregate
production function can be derived in two stages: by first solving the island
component planning problems (11) giving rise to the island sub-aggregate
production functions, and then by solving the economy-wide problem giving
rise to the economy-wide aggregate production function which uses the island
sub-aggregate production functions. To describe this recursive structure, we
say that the production network has been factorized.
Proposition 12 (Network Factorization). Let (r, I, M) denote an island.
Then the economy-wide aggregate production function depends only on { Ai }i∈ I
and { xri }i∈ M = {yi }i∈ M via the island aggregate production function
Fr { xri }i∈ M , { Ai } . In particular, if all the imports of the island are factors so that
M ⊆ F, then the factors can be aggregated according to the partition { M, F − M}.20
20. In
case,
we
can 
n othis
F̃ Fr
Lf
, { Ai }i∈ I , { Ai }i<I , { Li }i<M .
f ∈M

31

write

F ( L1 , . . . , L N , A1 , . . . , A N )

=

The factor-aggregation theorems of Fisher (1982) and Fisher (1983)
correspond to special cases of the conditions in the second part of this
proposition. The first part of the proposition is particularly useful in
disaggregated intertemporal models. In some cases, intertemporal linkages
can be represented via a set of capital stocks and their laws of motions
via production functions with investment as inputs. This is the case, for
example, of the post-Keynesian reswitching model studied in the next section.
Even though will not pursue this particular representation of the example,
it will prove helpful in understanding some of the obstacles preventing the
aggregation of this model into a simple one-good neoclassical growth model.
5.3. Re-Switching Revisited
We now turn to the post-Keynesian reswitching example in Samuelson (1966).
Samuelson’s example features an economy with two goods in every period:
labor and output. Labor is in unit supply. Output is used for consumption,
labor can be used to produce output using two different production functions
(called “techniques”). The first technique combines 2 units of labor at t − 2 and
6 units of labor at t to produce one unit of output at t. The second technique
uses 7 units of labor at t − 1 to produce one unit of output at t. Both techniques
are assumed to have constant-returns-to-scale.
We focus on the steady state of this economy, taking the gross interest
rate R = 1 + r as given, where r is the net interest rate. The interest rate
R is varied by changing the rate of time preferences β = 1/R of the agent.
By comparing the unit costs of production, it is easy to see that the second
technique dominates for high and low values of the interest rate, and that the
first technique dominates for intermediate values of the interest rate. Indeed,
at a gross interest rate of one (a net interest rate of zero), the second technique
is preferred because it has a lower total labor requirement (7 vs. 8); and at a
high interest rate, the second technique is preferred because the two-period
delay in production of the first technique is too costly. Therefore, the economy
features reswitching: as the interest rate is increased, it switches from the
second to the first technique and then switches back to the second technique.
This post-Keynesian example can be obtained as a limit of the sort of
nested-CES economies that we consider, provided that we use the ArrowDebreu formalism of indexing goods and factors by dates and to think about
capital stocks as intermediate goods. The corresponding production network
is represented in Figure 2. The diagram shows how in different periods,
labor can be combined with intermediate goods produced from past labor to
produce new intermediate and final goods.
In Figure 3 we plot some steady-values for this economy as a function
of the interest rate. The capital-labor and capital-output ratios are nonmonotonic functions of the interest rate, where the aggregate capital stock is
computed via financial valuations as the net-present-value of the payments to
32

l t −1

l t +1

lt

x1,t

x1,t+1

y2,t+1

y2,t

y2,t+2

y1,t

ct

x1,t+2

y1,t+1

c t +1

y1,t+2

c t +2

Y

F IGURE 2. The production network underlying Samuelson’s reswitching example. The
arrows indicate the flow of goods. The green nodes are primary factors, and Y is aggregate
output in this economy, which is perfectly substitutable across consumption units at
different dates.

capital or equivalently at its replacement cost. Using the notation in Figure
2, this means that the aggregate capital stock in period t is computed as
Kt = p x1,t x1,t + py2,t y2,t = 2wt−2 x1,t + 7wt−1 y2,t .
We could alternatively represent this economy using per-period production
functions for consumption and for investments, where the factors would be
the capital stocks corresponding to the quantities of the different vintages of
the two techniques and labor, and the laws of motions for the different capital
stocks would combine previous capital stocks and investments to produce
new capital stocks. These different production functions would correspond
to a factorization of the production network into separate islands.
For our purposes here, it is more convenient instead to work directly
with the disaggregated economy in Arrow-Debreu intertemporal form, which
is characterized by the propagation equations (8) and (9). These equations
are associated with an intertemporal production function characterizing the
production of an intertemporal aggregate of consumption goods in all dates
as a function labor in all dates.
For convenience, we consider a smoother version of the post-Keynesian
example by imaging that the two techniques produce different goods
which enter in consumption via a CES aggregator with a finite elasticity
of substitution. The example obtains in the limit when that elasticity of

33

0.40

0.30

0.20

Price Difference of Techniques

0.6

Real GDP (CPI Deflator)

Capital/Output Ratio

0.50

0.25

0.2

0.4

0.2

0

0.15
0.10

1

2
1.5
Interest rate

2.5

1

2
1.5
Interest rate

2.5

0.4

0.10

0.08

2
1.5
Interest rate

2.5

0.04

2.5

0.3

0.2

0.06

1

2
1.5
Interest rate

0.4
Investment Rate

Real Wage

Capital/Labor Ratio

0.12
0.10

0.00

1

0.5

0.14

0.05

0.6
0.8
Interest rate

1

2
1.5
Interest rate

2.5

0.1

1

F IGURE 3. Samuelson’s reswitching example

substitution goes to infinity. As can be seen in Figure 4, the properties of the
smoothed-out example resemble those of the original example.21
Now consider a simple one-good neoclassical growth model with a perperiod neoclassical aggregate production function with capital and labor
as its two arguments, where output can be used for investment and for
consumption. In such a model, the homogeneous capital stock can be
computed via financial valuations or equivalently at its replacement cost.
The question we now ask is whether we could represent the disaggregated
post-Keynesian example as a version of the simple neoclassical model
with an aggregate capital stock given by the sum of the values of the
heterogeneous capital stocks in the disaggregated post-Keynesian example.
The non-monotonicity of the capital-labor and capital-output ratios as a
function of the interest rate shows that this is not possible. The simple
21. Marglin (1984) shows that re-switching cannot occur with smooth substitution in the
sense that the composition of the basket of inputs used to produce each good cannot be the
same for all goods for two different interest rates. One lesson of the original example is lost:
that for no ranking of the two techniques in terms of “mechanization” or capital intensity is
the economy necessarily becoming more mechanized or capital intensive as the interest rate
decreases. Nonetheless, the lesson that the capital-labor and capital-output ratios are nonmonotonic functions of the interest rate survives.

34

0.4

0.3

0.2

0.1

1

2

1.5

Price Difference of Techniques

0.6

Real GDP (CPI Deflator)

Capital/Output Ratio

0.5

0.25

0.2

2.5

1

2

1.5

Interest rate

2.5

0.4

0.2

0
0.6
Interest rate

0.4

Interest rate

0.8

0.5

0.14

0.05

Investment Rate

Real Wage

Capital/Labor Ratio

0.12
0.10
0.10

0.08

0.4

0.3

0.06
0.2

1

2

1.5

2.5

0.04

1

2

1.5

Interest rate

2.5

1

2

1.5

Interest rate

2.5

Interest rate

F IGURE 4. Samuelson’s smoothed-out reswitching example

neoclassical model could match the investment share, the capital share, the
value of capital, and the value of the capital-output and capital-labor ratios of
the original steady state of the disaggregated model, but not across steady
states associated with different values of the interest rate. In other words,
aggregation via financial valuation fails.22
22. Relatedly, consider a model with several capital stocks K f and labor L. Each of the capital
stocks depreciates from one period to the next with depreciation rate δK f can be augmented by
investing the final good with productivity 1/pK f . The user cost of each capital stock is therefore
p f (r + δK f ). To capture a steady state, we assume that the different capital stocks are in infinitelyelastic supply at these user costs, but that labor is in fixed supply. Appendix A.2 generalizes our
equations to such a hybrid case with both factors in infinitely-elastic supply and factors in fixed
supply.
We can compute the financial value of the aggregate capital stock K = ∑ f pK f K f in the
model. We have


∑ f pK f K f


d log
Y
pK f K f
r


=− ∑
d log r
p K r + δK f
f ∑ g Kg g

×∑
f

pK f K f

r
r +δK f

∑ g pKg K g r+rδK

1 + ∑ λ j (θ j − 1)CovΩ( j)
g

j

∑ ΛKg
g

r + δK f

Ψ(K g )

r + δKg

ΛKg

−

Ψ( L)
ΛL

!
,

Ψ(K f )
ΛK f

!!
.

Knowledge of the aggregate capital stock K = ∑ f pK f K f is not enough to infer the elasticity of the
capital output ratio K/Y to the interest rate r. Knowledge of the values of all of the disaggregated
capital stocks is required. Aggregation via financial valuations fails.

35

The production network of the simple one-good neoclassical growth
economy is represented in Figure 5. The nodes (yt , lt , k t ) form an island where
yt is the export of the island, and k t is the import of the island. Hence the
relative price of k t and lt depends only on the quantity of k t and lt , and the
problem can be studied in isolation via a neoclassical production function. The
production function of the post-Keynesian reswitching example is different
and it cannot be factorized into the same islands and represented with the
same production functions. In other words, physical aggregation also fails.
One way to frame the lesson more generally is that the details of the
production network matter. Aggregating factors changes the production
network, and hence aggregation changes the properties of the model.
l t +1

lt

l t +2

kt

k t +1

k t +2

yt

yt

yt

ct

c t +1

c t +2

Y

F IGURE 5. The production network underlying a simple one-good neoclassical growth
model of an economy with a per-period production function with capital and labor as its
two arguments, where output can be used for investment and for consumption. The arrows
indicate the flow of goods. The green nodes are primary factors, and Y is aggregate output
in this economy, which is perfectly substitutable across consumption units at different
dates.

6. Simple Illustrative Examples
In this section, we provide four simple theoretical examples and a simple
quantitative illustration. The first example is Hicksian in the sense that
there are only two factors: the MESs in the aggregate production and cost
functions are identical and are symmetric. The second example is nonHicksian since it has three factors: the MESs in the aggregate production and
cost functions are different and are asymmetric in general. The third example
36

is the famous example of Houthakker (1955). The fourth example works out
the macroeconomic bias of technical change which is capital augmenting
at the microeconomic level in a disaggregated “task-based” model; it also
shows that such a model can give rise to richer and more complex patterns
than simpler models based on an aggregate production function in the
sense that such technical change can be capital biased but not necessarily
capital augmenting at the macroeconomic level. The fifth example is a simple
quantitative illustration to capital-skill complementarity à la Griliches (1969)
in the US economy, taking into account the multiplicity of sectors and their
input-output linkages. We use the analysis to revisit the influential analysis
in Krusell et al. (2000) of the role of these complementarities in the evolution
over time of the skill premium.
6.1. A Hicksian Example with Two Factors
Our first example features two factors of production and producers with
different factor intensities. A similar example is analyzed in Oberfield and
Raval (2014), building on Sato (1975).23 Each producer 1 ≤ i ≤ N produces
from capital (Ki ) and labor (Li ) according to

yi
= ωiK
ȳi



Ki
K̄i

−1
 θiKL
θ



iKL

+ ωiL

Li
L̄i

−1
 θiKL
θ

 θ θiKL−1
iKL

iKL



and the final demand aggregator is


N

Y
=  ∑ ωDi
Ȳ
i =1



yi
ȳi

 θDθ −1

 θ θD−1
D

D



with ωiK = 1 − ωiL and ∑iN=1 ω Di = 1. Sales shares for goods and factors are
given by λ D = 1, λi = ω Di , ΛK = ∑iN=1 λi ωiK , and Λ L = ∑iN=1 λi ωiL .
For this example economy, the MES between capital and labor in the
C
C
F
F
aggregate cost and production functions satisfy σLK
= σKL
= σLK
= σKL
= σLK ,
where σLK is given by
N

σLK =

ωiK (1 − ωiK )

∑ θiKL λi ΛK (1 − ΛK )

i =1

where

N

∑ λi

i =1

23.

∑i=1 λi (ωiK − ΛK )2
,
Λ K (1 − Λ K )
N

+ θD

ωiK (1 − ωiK ) ∑iN=1 λi (ωiK − ΛK )2
+
= 1.
Λ K (1 − Λ K )
Λ K (1 − Λ K )

Sato (1975) only considered the case with two producers.

37

The MES between capital and labor σLK is a weighted average of the
microeconomic elasticities of substitution between capital and labor θiKL and
of the elasticity of substitution θ D across producers in final demand. The
weight on θiKL increases with its sales share λi and the heterogeneity in
factor shares ωiK (1 − ωiK ) relative to the economy-wide heterogeneity in
factor shares ΛK (1 − ΛK ). It is zero when ωiK = 0 or ωiK = 1. The weight
on θ D increases in the heterogeneity in capital exposure across producers
N
∑i=1 λi (ωiK − ΛK )2 relative to the economy-wide heterogeneity in factor
exposures ΛK (1 − ΛK ). It is zero when ωiK = ΛK for all i.
6.2. A Non-Hicksian Example with Three Factors
Our second example extends the first example to include three factors. Each
producer 1 ≤ i ≤ N produces from capital (Ki ), skilled labor (Hi ), and
unskilled labor (Li ), according to




yi 
= ωiKH ωiK
ȳi 



Ki
K̄i



θiKH −1
θiKH



+ ωiH

Hi
H̄i



θiKH −1
θiKH

−1
 θiKHL
θ

−1
 θ θiKH−1 θiKHL
θ
iKH

iKHL



+ ωiL



Li
L̄i



θiKHL−1
θiKHL

and the final demand aggregator is


N

Y
=  ∑ ωDi
Ȳ
i =1



yi
ȳi

 θDθ −1

 θ θD−1
D

D



,

with ωiKH = 1 − ωiL , ωiK = 1 − ωiH , and ∑iN=1 ω Di = 1. This economy can
be written in normal form by introducing fictitious producers indexed by
iKH producing a bundle of capital and skilled labor to be used as an input
by producer i. Sales shares for goods and factors are given by λ D = 1,
λi = ω Di , λiKH = λi ωiKH , ΛK = ∑iN=1 λi ωiKH ωiK , Λ H = ∑iN=1 λi ωiKH ωiH , and
Λ L = ∑iN=1 λi ωiL .
We start with the MESs in the aggregate cost function. For the sake of
C
C
illustration, we focus on the MESs σLK
and σKL
. We have
C
σLK

N

= θ D ∑ λi ωiKH ωiK
i =1
N



ωiKH ωiK
ω
− iL
ΛK
ΛL






ω ω
ω ω
ω
+ ∑ θiKHL λi ωiK iKH iK + λi ωiKH ωiK − iKH iK + iL
ΛK
ΛK
ΛL
i =1
N

+ ∑ θiKH λi ωiH
i =1

38

ωiKH ωiK
,
ΛK

iKHL





C
σKL

N

= θ D ∑ λi ωiL
i =1



ωiL
ω ω
− iKH iK
ΛL
ΛK
N



+ ∑ θiKHL
i =1



ωiL
λi
+ λi ωiL
ΛL



ωiKH ωiK
ω
− iL
ΛK
ΛL


.

C
C
As is apparent from these formulas, in general, σLK
, σKL
. For instance,
C
C
and by contrast with σLK , σKL does not depend on the microeconomic
elasticities of substitution θiKH between capital and skilled labor. This follows
C
from two observations: variations underlying the definition σLK
vary wK while
C
keeping w H and w L constant while variations underlying the definition σKL
vary w L while keeping wK and w H constant; capital and skilled labor always
enter in the CES nest iKH with elasticity θiKH while unskilled labor does not. In
C
the special case where capital intensities are uniform across producers, σLK
is
D
independent of θ , and similarly, in the special case where labor intensities are
C
uniform across producers, σKL
is independent of θ D . In general, and although
C
C
verifying it requires some steps of algebra, both σLK
and σKL
are weighted
averages of the microeconomic elasticities of substitution.
F
The expressions for the MESs in the aggregate production function σKL
F
and σLK
are more complex, and we omit them for brevity. Obtaining these
equations requires solving a system of equations of two equations in two
unknowns for the changes in factor shares d log Λ L and d log ΛK in response
to a change d log K and d log L respectively (after having used the equation
ΛK d log ΛK + Λ H d log Λ H + Λ L d log Λ L = 0 to substitute out d log Λ H ). In
F
C
F
C
F
F
F
general, we have σLK
, σKL
, σLK
, σLK
, and σLK
, σKL
. Moreover, σLK
and
F
σLK are not weighted averages, or even linear functions, of the microeconomic
elasticities of substitution.
These expressions simplify drastically in the case where factor intensities
and microeconomic elasticities of substitution are uniform across producers
so that ωiK , ωiH , ωiL , ωiKH , θiKHL , and θiKH are independent of i. In this
case, the aggregate production and cost functions are of the nested-CES
C
F
C
form. In particular, we get σKL
= σKL
= θKHL , σLK
= θKHL ΛK /(ΛK + Λ H ) +
F
θKH Λ H /(ΛK + Λ H ), and σLK = (ΛK + Λ H )/(ΛK /θKHL + Λ H /θKH ). Hence
C
F
we see that in this simple case, σLK
and σLK
are respectively the arithmetic
and harmonic averages of the microeconomic elasticities θKHL and θKH with
weights ΛK /(ΛK + Λ H ) and Λ H /(ΛK + Λ H ) and are therefore different in
general.

6.3. Houthakker (1955)
Houthakker (1955) described how a disaggregated economy with fixed
proportions and decreasing returns at the microeconomic level could give
rise to a Cobb-Douglas aggregate production function with decreasing returns
when the distribution of technical requirements across producers is a double
Pareto. The model illustrates a divorce between microeconomic elasticities of
39

substitutions between factors equal to 0, and macroeconomic elasticities of
substitutions between factors equal to 1. The model is a particular limit case
of our general model. In this section, we explain how to capture it using our
formalism.24
The model features individual cells. Each individual j cell can produce up
to φj units of output, where each unit of output requires a1,j units of factor L1
and a2,j units of factor L2 . Using output as the numeraire, the unit is active in
equilibrium if 1 − a1,j w1 − a2,j w2 ≥ 0. The total capacity of cells for which a1,j
lies between a1 and a1 + da1 and for which a2,j lies between a2 and a2 + da2 can
be represented by φ( a1 , a2 )da1 da2 , where φ is the input-output distribution for
the set of cells concerned. Total output and total factor demand are then given
by
Y=

1/w1

Z
0

L1 =
L2 =

Z (1+ a1 w1 )/w2
0

1/w1 Z (1+ a1 w1 )/w2

Z
0

0
1/w1 Z (1+ a1 w1 )/w2

Z
0

0

φ( a1 , a2 )da1 da2 ,
a1 φ( a1 , a2 )da1 da2 ,
a2 φ( a1 , a2 )da1 da2 .

The last two equations implicitly give w1 and w2 as functions of L1
and L2 , and plugging these functions back into the first equation gives
output Y = F ( L1 , L2 ) as a function of L1 and L2 , thereby describing
the aggregate production function of this economy. Characterizing this
production function is difficult, and so Houthakker focused on the special case
where the distribution of unit requirements is double Pareto with φ( a1 , a2 ) =
Aa1α1 −1 a2α2 −1 . He showed that in this case, the production function is given by
α1
α1 + α2 +1

F ( L1 , L2 ) = ΘL1

α2
α1 + α2 +1

L2

,

where
Θ = ( α1 + α2 + 1)

AB(α1 + 1, α2 + 1)
α1α1 +1 α2α2 +1

!α

1
1 + α2 +1

,

R1
where B is the beta function given by B(α1 + 1, α2 + 1) = 0 tα1 (1 − t)α2 .
To capture the model using our formalism, one first has to introduce more
factors, because of decreasing returns to scale at the micro level. Specifically,
we assume that over and above the factors L1 and L2 , there is a different
fixed factor L j in unit supply for each producer j. Producer j produces output
24. Levhari (1968) generalizes Houthakker (1955) by deriving distributions of technical
requirements across producers for which the aggregate production function is CES rather
than simply Cobb Douglas. Sato (1969) in turn generalizes Levhari (1968) by allowing for
microeconomic production to be CES rather than simply Leontief. All these models are particular
cases of our general model.

40

according to a Leontief aggregate min{l1 /a1 , l2 /a2 , φj l j }, where l1 is its use of
factor L1 , l2 its use of factor L2 , and l j its use of factor L j . The outputs of the
different producers are then aggregated using a CES aggregate. Houthakker’s
model obtains in the limit where the elasticity of substitution of this CES
aggregator goes to infinity. In this limit, the wage of the fixed factor of
producer j can be computed as (1 − a1,j w1 − a2,j w2 )+ so that payments to all
factors exhaust the revenues of producer j.
It is possible to obtain Houthakker’s formulas in the particular case where
the distribution is double Pareto by specializing our general formulas, but
the calculations are tedious and so we refrain from doing so. The reason
for this difficulty is that there are many factors: the two nonfixed factors
and all the fixed factors. Our formulas solve for all these changes in shares
simultaneously as the solution of a large system of linear equations. In the
double Pareto case, it is actually possible to sidestep this difficulty and to solve
directly for the changes in the shares in the two non-fixed factors, which turn
out to be zero. This means that while the individual changes in the shares
accruing to the fixed factors are nonzero, their sum is zero. Since the changes
in these individual shares is not of direct interest for the question at hand, the
direct method is preferable. Indeed, it is straightforward to see that

(α1 + α2 + 1) AB(α1 + 1, α2 + 1)
,
α1 α2 w1α1 w2α2
AB(α1 + 1, α2 + 1)
,
L1 =
α2 w1α1 +1 w2α2
AB(α1 + 1, α2 + 1)
L2 =
.
α1 w1α1 w2α2 +1
Y=

This immediately implies that
α1
w1 L 1
=
,
Y
α1 + α2 + 1
w2 L 2
α2
=
.
Y
α1 + α2 + 1
This in turn immediately implies that σLF1 ,L2 = σLF2 ,L1 = σLC1 ,L2 = σLC2 ,L1 = 1 as
α / ( α1 + α2 ) α2 / ( α1 + α2 )
L2

well as Houthakker’s result that F ( L1 , L2 ) = ΘL1 1

.

6.4. Capital-Biased Technical Change in a Task-Based Model
In this section, we consider an example taken from Baqaee and Farhi
(2018) and inspired by Acemoglu and Restrepo (2019). We compute the
bias of technical change and explain its dependence on the microeconomic
pattern of sales shares, factor intensities, and microeconomic elasticities
of substitution. We then show that in a “task-based” economy with
41

disaggregated production, a possible consequence of capital-augmenting
technical change and automation at the microeconomic level is a simultaneous
decline in both the labor share of income and the real wage at the
macroeconomic level. This cannot happen in a simpler economy with an
aggregate production function with capital-augmenting technical since such
technical change would always increase the real wage. In other words,
technical change which is capital augmenting at the microeconomic level is
capital biased but not capital augmenting at the macroeconomic level. The
impact of technical change is therefore richer and more complex in models of
disaggregated production.
Assume that each producer, associated to a “task”, produces from capital
and labor according to

yi
= ωiL
ȳi
with
K̃i =



L̃i
L̃¯

−1
 θKL
θ
KL



+ ωiK

i

K̃i
K̃¯

−1
 θKL
θ

 θ θKL−1
KL

KL



i

AiK
Ki
ĀiK

and

L̃i =

AiL
Li
ĀiL

and ωiK = 1 − ωiL . The consumer values the output of these tasks according
to a CES aggregator


N

Y
=  ∑ ωDi
Ȳ
i =1



yi
ȳi

 θDθ −1

 θ θD−1
D

D



,

with ∑iN=1 ω Di = 1. Sales shares for goods and factors are given by λ D = 1,
λi = ω Di , ΛK = ∑iN=1 λi ωiK , and Λ L = ∑iN=1 λi ωiL .
Capital-biased technical change is modeled as a shock d log AkK > 0. Using
our formulas, we can characterize the responses of the labor share and of the
wage. The biases towards K vs. L of this technology shock in the aggregate
cost function and production functions are given by
C
BKLkK
= (θKL − 1)λk

ω
ω
ωkK ωkL
+ (θ D − 1)λk kK (1 − kL )
ΛK Λ L
ΛK
ΛL

and
F
(θKL − 1)λk ωΛkKK ωΛkLL + (θ D − 1)λk ωΛkKK (1 − ωΛkLL )
BKLkK
=
.
F
1 + BKLkK
1 + (θKL − 1) ∑iN=1 λi ωΛiKK ωΛiLL + (θ D − 1) Λ L1ΛK Varλ (ω( L) )

When there is a single task k so that λk = 1, ωkL = Λ L , and ωkK = Λk ,
the aggregate production function is CES with elasticity of substitution θKL
between capital and labor, and the biases in the aggregate cost and production
C
F
functions coincide BKLkL
= BKLkL
= θKL − 1.
42

C
F
. The
In general however, these two biases are different BKLkL
, BKLkL
C
bias in the aggregate cost function BKLkL is a linear function of the different
microeconomic elasticities of substitution whereas the bias in the aggregate
F
production function BKLkL
is a nonlinear function of these elasticities.
However, the signs of the two biases are identical. A capital-augmenting
shock to task k is more likely to be biased towards capital vs. labor at
the macroeconomic level when: (i) capital and labor are substitutes at the
microeconomic level with θKL > 1; and (ii) tasks are substitutes with θ D > 1
and task k is more capital intensive than the average task with ωkL /Λ L < 1,
or tasks are complements with θ D < 1 and task k is more labor intensive than
the average task with ωkL /Λ L > 1. The intuition for (i) is straightforward:
in response to a positive shock, producer k substitutes expenditure towards
capital if θKL > 1 and towards labor if θKL < 1. The intuition for (ii) is
the following: a positive shock reduces the price of task k; if θ D > 1, the
household substitutes expenditure towards task k, resulting in the reallocation
of factors towards task k, which increases the overall expenditure on capital
if ωkL /Λ L < 1 and reduces it otherwise; if θ D < 1, the household substitutes
expenditure away from task k, resulting in the reallocation of factors away
from task k, which increases the overall expenditure on capital if ωkL /Λ L > 1
and reduces it otherwise.
We now turn our attention to the effect of technical change on the real
wage, holding factor supplies constant. For simplicity, we focus on the case
where final demand is Cobb Douglas across tasks with θ D = 1. We also assume
that capital and labor are substitutes at the microeconomic level with θKL > 1,
so that a capital-augmenting shock to task k is biased towards capital vs. labor
at the macroeconomic level, i.e. a positive shock increases the capital share
and decreases the labor share. As we shall now see, the effect of such a shock
on the real wage is ambiguous:25,26


ωkL ωiK
ωiL
1
+
(
θ
−
1
)
λ
−
∑
KL
i
i
ΛL
ΛL
ΛK
d log w L
= λk ωkK
.
d log AkK
1 + (θKL − 1) ∑i λi ωΛiLL ωΛiKK

If task k is more labor intensive than the average task with ωkL /Λ L > 1,
and capital and labor are highly substitutable with a high-enough value of
25.

We can compute this as a function of the aggregate production function using
d log w L
d log F
d2 log F
d log F
d log Λ L
=
+
/
= λk ωkK +
.
d log AkK
d log AkK
d log AkK d log L d log L
d log AkK

26.

In the general case where θ D , 1, we have


h
1 + (θKL − 1) ∑i λi ωΛiLL − ωΛkLL ωΛiKK + (θ D − 1) ΛK1Λ L Varλ (ω( L) ) +
d log w L
= λk ωkK
d log AkK
1 + (θKL − 1) ∑iN=1 λi ωΛiLL ωΛiKK + (θ D − 1) Λ L1ΛK Varλ (ω( L) )

43

ωkL
ΛL

−1

i
.

θKL , then the real wage falls in response to a positive shock. This is because as
task k substitutes away from labor and towards capital, labor is reallocated to
other tasks who use labor less intensively. This reallocation of labor reduces
the marginal product of labor and hence the real wage. These patterns cannot
be generated in a simpler economy with an aggregate production function
with capital-augmenting technical change since such a shock always increases
the marginal product of labor and hence the real wage.27
6.5. Quantitative Application: Capital-Skill Complementarity and the Skill
Premium
In this section, we briefly summarize a simple quantitative application of
the results in Sections 3 and 4. We refer the reader to Appendix B for the
details of the analysis. We show how to use these results to study capital-skill
complementarity à la Griliches (1969) in the US economy, taking into account
the multiplicity of sectors and their input-output linkages. We use the analysis
to revisit the influential analysis in Krusell et al. (2000) of the role of these
complementarities in the evolution over time of the skill premium.
Krusell et al. (2000) studies the relationship between the increasing skill
premium and the rapid decline in the relative price of equipment investment
goods. They find that complementarity between capital goods and high-skill
labor can explain a large part of the increase in the skill premium. They use an
aggregate model and directly postulate an exogenous aggregate production
function. We revisit their analysis in the context of a disaggregated model
where the aggregate production function emerges endogenously. We find
that moving from the aggregate model to the disaggregated model reduces
the MES between capital and high-skil labor from 0.67 to 0.66 and the MES
between capital an low-skill labor from 1.05 to 0.93. These differences are
enough to reduce by 20% the contribution of the decline in the relative price
of equipment investment to the increase of the skill premium.
These particular results notwithstanding, we stress that our goal in
this application is more to demonstrate quantitatively the dependence of
macroeconomic elasticities of substitution on microeconomic primitives than
to draw strong implications for the question of whether and how much
complementarities between capital and skilled labor can explain the behavior
of the skill premium.
27. Indeed, suppose for example that there is a single task so that λk = 1. We get ωkL = Λ L and
F
ωkK = Λk . This implies that BKLkL
= θKL − 1 and d log w L /d log AkK = Λk /θKL > 0. The result is
true more generally.

44

7. Extensions
In Appendix A, we present a number of extensions. First, in Appendix A.1,
we explain how to generalize our results to arbitrary economies beyond the
nested-CES case with Hicks neutral technology shocks at the level of each
nest. In Appendix A.3, we introduce alternative notions for the aggregate
production and cost functions which separate final demand from technology
and explain how to use our results to characterize these objects. In Appendix
A.4, we explain how to generalize our results to economies where final
demand is non-homothetic or where there are distortions.

8. Conclusion
This paper is part of a broader agenda to bring macro theory closer to
micro data. As micro data becomes more plentiful, parsimonious reducedform aggregate production functions look more antiquated. This paper takes
a step towards realizing this goal by providing an organizing framework
and some general characterizations of micro-founded aggregate production
functions. The difference in this approach, compared to the classical analysis,
is that it takes advantage of the information in granular micro-data and allows
for data-intensive aggregation to arrive at the behavior of macroeconomic
aggregates.
We have several other papers in this agenda. In Baqaee and Farhi (2019a),
we focus on on the nonlinear macroeconomic impact on aggregate output of
microeconomic shocks in efficient models. In Baqaee and Farhi (2019c), we
extend our analysis to inefficient economies. In Baqaee and Farhi (2018), we
characterize how shocks affect non-aggregate outcomes, namely how shocks
propagate from one producer to another, and how microeconomic variables
comove with one another in a production network, and we also show how
to combine input-output production networks with heteorgeneous agents
and non-homothetic final demand in closed economies. In Baqaee and Farhi
(2019b), we show how to take these elements into account in trade models.
However, we think we have only scratched the surface of what is left to
be done. Extending the analysis to allow for, amongst other things, entry,
exit, and tractable stochastic dynamics, are further steps that need to be taken
before theory can start to approximate reality. We are actively pursing these
questions in ongoing research.

References
Acemoglu, D. and P. Restrepo (2019). Artificial intelligence, automation and
work. In A. Goldfarb, J. Gans, and A. Agrawal (Eds.), The Economics of
45

Artificial Intelligence: An Agenda. University of Chicago Press.
Aiyagari, S. R. (1994). Uninsured idiosyncratic risk and aggregate saving. The
Quarterly Journal of Economics 109(3), 659–684.
Atalay, E. (2017). How important are sectoral shocks? American Economic
Journal: Macroeconomics 9(4), 254–80.
Baqaee, D. R. and E. Farhi (2018, June). Macroeconomics with Heterogeneous
Agents and Input-Output Networks.
NBER Working Papers 24684,
National Bureau of Economic Research, Inc.
Baqaee, D. R. and E. Farhi (2019a).
The macroeconomic impact
of microeconomic shocks: Beyond Hulten’s Theorem.
Econometrica
(Forthcoming).
Baqaee, D. R. and E. Farhi (2019b). Networks, barriers, and trade.
Baqaee, D. R. and E. Farhi (2019c). Productivity and Misallocation in General
Equilibrium. NBER Working Papers 24007, National Bureau of Economic
Research, Inc.
Bewley, T. (1986). Stationary monetary equilibrium with a continuum
of independently fluctuating consumers. Contributions to mathematical
economics in honor of Gérard Debreu 79.
Blackorby, C. and R. R. Russell (1989). Will the real elasticity of substitution
please stand up?(a comparison of the Allen/Uzawa and Morishima
elasticities). The American economic review 79(4), 882–888.
Boehm, C. E., A. Flaaen, and N. Pandalai-Nayar (2019). Input linkages
and the transmission of shocks: Firm-level evidence from the 2011 tōhoku
earthquake. Review of Economics and Statistics 101(1), 60–75.
Cohen, A. J. and G. C. Harcourt (2003). Retrospectives: whatever happened
to the cambridge capital theory controversies?
Journal of Economic
Perspectives 17(1), 199–214.
Felipe, J. and F. M. Fisher (2003). Aggregation in production functions: what
applied economists should know. Metroeconomica 54(2-3), 208–262.
Fisher, F. M. (1965). Embodied technical change and the existence of an
aggregate capital stock. The Review of Economic Studies 32(4), 263–288.
Fisher, F. M. (1982). Aggregate production functions revisited: the mobility
of capital and the rigidity of thought. The Review of Economic Studies 49(4),
615–626.
Fisher, F. M. (1983). On the simultaneous existence of full and partial capital
aggregates. The Review of Economic Studies 50(1), 197–208.
Griliches, Z. (1969). Capital-skill complementarity. The review of Economics and
Statistics, 465–468.
Hamermesh, D. S. (1996). Labor demand. princeton University press.
Herrendorf, B., R. Rogerson, and A. Valentinyi (2013). Two perspectives on
preferences and structural transformation. American Economic Review 103(7),
2752–89.
Hicks, J. (1932). Theory of wages. Springer.

46

Houthakker, H. S. (1955). The pareto distribution and the Cobb-Douglas
production function in activity analysis. The Review of Economic Studies 23(1),
27–31.
Huggett, M. (1993). The risk-free rate in heterogeneous-agent incompleteinsurance economies. Journal of economic Dynamics and Control 17(5-6), 953–
969.
Hulten, C. and L. Nakamura (2017, April). Accounting for growth in the age
of the internet: The importance of output-saving technical change. Working
Paper 23315, National Bureau of Economic Research.
Hulten, C. R. (1978). Growth accounting with intermediate inputs. The Review
of Economic Studies, 511–518.
Johnson, G. E. (1997). Changes in earnings inequality: the role of demand
shifts. Journal of economic perspectives 11(2), 41–54.
Krusell, P., L. E. Ohanian, J.-V. Rı́os-Rull, and G. L. Violante (2000).
Capital-skill complementarity and inequality: A macroeconomic analysis.
Econometrica 68(5), 1029–1053.
Krusell, P. and A. A. Smith, Jr (1998). Income and wealth heterogeneity in the
macroeconomy. Journal of political Economy 106(5), 867–896.
Levhari, D. (1968). A note on houthakker’s aggregate production function in a
multifirm industry. Econometrica: journal of the Econometric Society, 151–154.
Marglin, S. A. (1984). Growth, distribution, and prices. Number 155. Harvard
University Press.
McFadden, D. (1963). Constant elasticity of substitution production functions.
The Review of Economic Studies 30(2), 73–83.
McKenzie, L. W. (1959). On the existence of general equilibrium for a
competitive market. Econometrica: journal of the Econometric Society, 54–71.
Morishima, M. (1967). A few suggestions on the theory of elasticity. Keizai
Hyoron (Economic Review) 16, 144–150.
Oberfield, E. and D. Raval (2014, September). Micro data and macro
technology. Working Paper 20452, National Bureau of Economic Research.
Pasinetti, L. L., F. M. Fisher, J. Felipe, J. McCombie, and R. L. Greenfield (2003).
Cambridge capital controversies. The Journal of Economic Perspectives 17(4),
227–232.
Robinson, J. (1953). The production function and the theory of capital. The
Review of Economic Studies 21(2), 81–106.
Russell, R. R. (2017). Elasticities of substitution. Technical report.
Samuelson, P. A. (1966). A summing up. The quarterly journal of economics 80(4),
568–583.
Sato, K. (1969).
Micro and macro constant-elasticity-of-substitution
production functions in a multifirm industry. Journal of Economic Theory 1(4),
438–453.
Sato, K. (1975). Production functions and aggregation, Volume 90. NorthHolland.

47

Sattinger, M. (1993). Assignment models of the distribution of earnings.
Journal of economic literature 31(2), 831–880.
Solow, R. M. (1956). A contribution to the theory of economic growth. The
quarterly journal of economics 70(1), 65–94.
Solow, R. M. (1963). Capital theory and the rate of return. North-Holland.
Stern, D. I. (2010). Derivation of the hicks, or direct, elasticity of substitution
using the input distance function. Economics letters 108(3), 349–351.

48

Appendix A: Appendix: Extensions
In this section, we present a number of extensions. First, in Section A.1,
we explain how to generalize our results to arbitrary economies beyond
the nested-CES case with Hicks neutral technology shocks at the level of
each nest. In Section A.3, we introduce alternative notions for the aggregate
production and cost functions which separate final demand from technology
and explain how to use our results to characterize these objects. In Section A.4,
we explain how to generalize our results to economies where final demand is
non-homothetic or where there are distortions.
A.1. Beyond CES
In Sections 3 and 4, we confined our characterization of aggregate cost and
production functions to the general class of nested-CES economies with Hicksneutral technology shocks at the level of each nest.
Now each producer i has a production function Fi ( xi1 , · · · , xiN , Li1 , · · · , LiF , Ai )
with associated cost function Ci ( p1 , · · · , p N , w1 , · · · , w F , Ai ). Generically,
we can normalize the technology shock Ai so that d log F/d log Ai =
d log C/d log Ai = 1 at the point of interest.
We proceed in two successive steps. In the first step, we continue to
assume that technology shocks are Hicks neutral at the producer level and
explain how to deal with non-CES producers.28 We then explain how to
extend our results using the input-output substitution operator, which is a
generalization of the input-output covariance operator defined in equation (7).
In the second step, we relax the assumption of Hicks-neutral technical change
at the producer level and explain how to deal with completely general biased
technical change at the producer level.29
Dealing with Non-CES Producers . We start with the case where technical
change is Hicks neutral at the producer level. We introduce the input-output
substitution operator. We show how it can be used to generalize the results of
Sections 3 and 4.
Definition. (Micreconomic Allen-Uzawa Elasticities of Substitution) For a
producer k, let θk (l, l 0 ) denote the Allen-Uzawa elasticity of substitution in
28. That technology shocks are Hicks neutral at the producer level means that we can write,
with some abuse of notation, Fi ( xi1 , · · · , xiN , Li1 , · · · , LiF , Ai ) = Ai Fi ( xi1 , · · · , xiN , Li1 , · · · , LiF )
and Ci ( p1 , · · · , p N , w1 , · · · , w F , Ai ) = Ai−1 Ci ( p1 , · · · , p N , w1 , · · · , w F )
29. In contrast to our analysis of the nested-CES case, in this section, we purposefully eschew
any relabelling of the network via the disaggregation of a producer into an network of producers
(an island) or via the introduction of fictitious producers. Factor-biased technical change is
modeled directly at the original producer level, where it is not necessarily factor-augmenting.

49

cost between inputs l , l 0 in the cost of producer k:
θk (l, l 0 ) =

e (l, l 0 )
Ck d2 Ck /(dpl dpl 0 )
= k
,
(dCk /dpl )(dCk /dpl 0 )
Ωkl 0

where ek (l, l 0 ) is the elasticity of the demand by producer k for input l with
respect to the price pl 0 of input l 0 , and Ωkl 0 is the expenditure share in cost of
input l 0 .
This definition applies to good inputs and factor inputs using the
aforementioned notation p N + f = w f . Because of the symmetry of partial
derivatives, we have θk (l, l 0 ) = θk (l 0 , l ). Because of the homogeneity
of degree one of the cost function, we have the homogeneity identity
∑l 0 ∈ N + F Ωkl 0 θk (l, l 0 ) = 0.
Following Baqaee and Farhi (2019a), we introduce the input-output
substitution operator for producer k:
Φ k ( Ψ (i ) , Ψ ( j ) ) = −

∑

Ωkl [δll 0 + Ωkl 0 (θk (l, l 0 ) − 1)]Ψli Ψl 0 j ,

(A.1)

(l,l 0 )∈( N + F )2


1
,
= EΩ(k) (θk (l, l 0 ) − 1)(Ψi (l ) − Ψi (l 0 ))(Ψ j (l ) − Ψ j (l 0 )) (A.2)
2
where δll 0 is the Kronecker symbol, Ψi (l ) = Ψli , Ψ j (l 0 ) = Ψl 0 j , and the
expectation in the second line is over l and l 0 . The second line can be
obtained from the first using the symmetry of Allen-Uzawa elasticities and
the homogeneity identity.
When the production function of k is CES with elasticity of substitution θk ,
the cross Allen-Uzawa elasticities θk (l, l 0 ) are identical θk (l, l 0 ) = θk for l , l 0 ,
the own Allen-Uzawa elasticities are given by θk (l, l ) = −θk (1 − Ωkl )/Ωkl , and
we recover
Φk (Ψ(i) , Ψ( j) ) = (θk − 1)CovΩ(k) (Ψ( j) , Ψ(i) ).
Even outside of the CES case, the input-output substitution operator
Φk (Ψ(i) , Ψ( j) ) shares many properties with a covariance operator. For example,
it is immediate to verify that: Φk (Ψ(i) , Ψ( j) ) is bilinear in Ψ(i) and Ψ( j) ;
Φk (Ψ(i) , Ψ( j) ) is symmetric in Ψ(i) and Ψ( j) ; Φk (Ψ(i) , Ψ( j) ) = 0 whenever Ψ(i)
or Ψ( j) is constant.
All of our results in Sections 3 and 4 can be generalized to non-nestedCES economies. All that is needed is to replace terms of the form (θk −
1)CovΩ(k) (Ψ( j) , Ψ(i) ) by Φk (Ψ(i) , Ψ( j) ). For example, the result in Proposition
3 for the MES between factors in the aggregate cost function becomes
σCfg − 1 =

∑

λk Φk (Ψ( g) , Ψ( g) /Λ g − Ψ( f ) /Λ f ).

k ∈1+ N

Just like in the nested-CES case, σCfg is a weighted average of the
microeconomic elasticities of substitution θk (l, l 0 ) and is equal to θ if the
microeconomic elasticities of substitution are all equal to θ.
50

Intuitively, Φk (Ψ(i) , Ψ( j) ) captures the way in which k redirects expenditure
share towards i in response to one percent change in the price of j. To see this,
we make use of the following well-known result (see for example Russell,
2017): the elasticity of the expenditure share of producer k on input l with
respect to the price of input l 0 is given by δll 0 + Ωkl 0 (θk (l, l 0 ) − 1).30 Equation
(A.1) says that the way k redirects expenditure share towards i in response to
unit proportional decrease in the price of j depends on considering, for each
pair of inputs l and l 0 , how much the proportional decrease Ψl 0 j in the price of
l 0 induced by the decline in the price of j causes k to increase its expenditure
share on l (measured by −Ωkl [δll 0 + Ωkl 0 (θk (l, l 0 ) − 1)Ψl 0 j ), and on the exposure
of l to i (measured by Ψli ).
Equation (A.2) says that the way k redirects expenditure share towards i
in shares in response to a decline in the price of j depends on considering, for
each pair of inputs l and l 0 , whether or not increased exposure to j (measured
by Ψ j (l ) − Ψ j (l 0 )), is aligned with increased exposure to i (measured by
Ψi (l ) − Ψi (l 0 )), and whether l and l 0 are complements or substitutes (measured
by (θk (l, l 0 ) − 1)).
Dealing with Biased Technical Change at the Producer Level . We now further
generalize the results of Sections 3 and 4 to the case where technical change is
biased at the producer level. This generalization matters only for our results
on the bias of technical change in the aggregate production and cost functions.
It does not change anything to our results on the MESs between factors in the
aggregate production and cost functions.
Definition. (Microeconomic Bias of Technical Change) For a producer k, we
C
the microeconomic bias towards input i vs. j of a technology shock
denote by bijk
to producer k, defined by the elasticity of the ratio of the cost shares of inputs
i vs. j of producer k with respect to a technology shock to producer k, holding
input prices constant:
d log(Ωki /Ωkj )
C
.
bijk
=
d log Ak
C
Similarly, we denote by bik
the bias towards input i of a technology shock to
producer k, defined by elasticity of the cost share of input i of producer k,
holding input prices constant:
C
bik
=

d log Ωki
=
d log Ak

C
.
∑ Ωkj bijk

j∈ N

30. This property is the reason we choose to use Allen-Uzawa elasticities at the producer
level: because they easily give the elasticities of cost expenditure shares with respect to input
prices. Morishima elasticities σkC (l, l 0 ) = ek (l, l 0 ) − ek (l 0 , l 0 ) are better suited instead to give the
elasticities of relative cost expenditure shares. Of course, the two concepts are related and so we
could have used either one.

51

Note that we have defined the bias of technical change towards inputs, be
they factors or intermediate goods. These notions are purely microeconomic.
They are defined at the level of an individual producer, and do not embed any
general equilibrium whatsoever. In what follows, we will rely on the following
C
C
properties: ∑i∈ N Ωki bik
= 0 and ∑i∈ N ∑ j∈ N Ωki Ωkj bijk
=0
In the presence of biased technical change at the producer level, the only
difference to the analysis in Section A.1 is that we now must include new
forcing terms in the propagation equations (5) and (6) in Proposition 2 and (8)
and (9) in Proposition 7. More precisely the following term must be added on
the right-hand sides of equations (5) and (8) for d log λi :

∑

∑

k ∈1+ N j ∈1+ N

λk
CovΩ(k) (b(Ck) , Ψ(i) )d log Ak ;
λi

and the following term must be added on the right-hand sides of equations
(6) and (9) for d log Λ f :

∑

∑

k ∈1+ N j ∈1+ N

λk
CovΩ(k) (b(Ck) , Ψ( f ) )d log Ak ,
Λf

where b(Ck) is the k-th column of bCjk . These terms account for the direct and
indirect effects through the network of the changes in input expenditures of
each producer k due to the bias of its technical change d log Ak .
Of course, these new terms do not appear in the results on the MESs
between factors in the aggregate production and cost functions which do not
depend on the nature of technical change. But they do enter the results on
the bias of technical change in the aggregate production and cost functions.
For example, the result in Proposition 5 for the bias of technical change in the
aggregate cost function becomes
BCfgj = λ j CovΩ( j) (b(Cj) , Ψ( f ) /Λ f − Ψ( g) /Λ g ) +

∑

λk Φk (Ψ( j) , Ψ( f ) /Λ f − Ψ( g) /Λ g ).

k ∈1+ N

A.2. Hybrid Model with Infinitely Elastic and Inelastic Factors
We assume that some of the factors F∞ are in infinitely-elastic supply and that
the others F0 are in fixed supply, with F = F∞ ∪ F0 . We then have

∑

d log λi =

( θ k − 1)

k ∈1+ N

+

∑

( θ k − 1)

k ∈1+ N

−

∑

k ∈1+ N

λk
CovΩ(k) ( ∑ Ψ( j) d log A j , Ψ(i) )
λi
j∈ N

λk
CovΩ(k) ( ∑ Ψ(h) d log Lh − ∑ Ψ(h) d log wh , Ψ(i) )
λi
h∈ F0
h∈ F∞

( θ k − 1)

λk
CovΩ(k) ( ∑ Ψ(h) d log Λh − ∑ Ψ(h) d log Y, Ψ(i) ),
Λf
h∈ F0
h∈ F∞
52

where the elasticities of output and of factor shares solve the following system
of linear equations
"
1
d log Y =
∑ ∑ λ j d log A j − ∑ Λg d log wg
∑ f ∈ F0 Λ f
g∈ F∞
j∈ N
#

+

∑ Λg d log Lg − ∑ Λd d log Λg

g∈ F0

∑

d log Λ f =

( θ k − 1)

k ∈1+ N

+

∑

( θ k − 1)

k ∈1+ N

−

∑

k ∈1+ N

,

g∈ F0

λk
CovΩ(k) ( ∑ Ψ( j) d log A j , Ψ( f ) )
Λf
j∈ N

λk
CovΩ(k) ( ∑ Ψ(h) d log Lh − ∑ Ψ(h) d log wh , Ψ( f ) )
Λf
h∈ F0
h∈ F∞

( θ k − 1)

λk
CovΩ(k) ( ∑ Ψ(h) d log Λh − ∑ Ψ(h) d log Y, Ψ( f ) ).
Λf
h∈ F0
h∈ F∞

A.3. Separating Technology from Final Demand
As mentioned before, in this paper, we have put ourselves under conditions
where the existence of an aggregate output good can be taken for granted
because final demand is homothetic. Given our definitions, the properties of
the aggregate production and cost functions depend on final demand.
It is possible to define alternative notions which do not depend on final
demand: the aggregate distance function and its associated aggregate cost
function. These alternative notions must then be combined with final demand
to derive general-equilibrium comparative static results. Our definitions
intentionally take these two steps at once. We take this route because we want
to put the focus on general-equilibrium comparative statics. However, our
results can also be used to characterize the properties of aggregate distance
and cost functions. This is because we have full flexibility in specifying final
demand, meaning that the aggregate distance function and its associated cost
function can be analyzed by specifying final demand to be Leontief (i.e. setting
the elasticity of substitution between final goods to be zero).
To see this, we first define the aggregate distance function and the
associated cost function. Define the aggregate technology set
Γ( A) = {( L, c) : L can produce c},
where L is a vector of factors, c is a vector of final consumptions, and A is a
vector of productivities. The aggregate distance function is defined as follows:
D ( L, A, c) =

max

{δ:( L/δ,c)∈Γ( A)}

53

δ,

so that ( L, c) ∈ Γ( A) if and only if D ( L, A, c) ≥ 1. Similarly, and with some
abuse of notation, we can define the aggregate cost function
C (w, c, A) =

min

{ L:( L,c)∈Γ( A)}

wL.

Whenever an output good D0 (c) exists because final demand is
homothetic, the aggregate production function can be recovered from the
aggregate distance function using
F ( L, A)
= max D ( L, A, c).
Y
{c:D0 (c)≥Y }
Going in the other direction is also possible. To capture an aggregate distance
function via an aggregate production function, for a given vector of final
output c, suppose that final demand has a Leontief form D0 = D0c , where
D0c (ĉ) = min{ĉ1 /c1 , · · · , ĉ N /c N }, and then compute the associated aggregate
production function F c to recover
D ( L, A, c) =

F c ( L, A)
= F c ( L, A).
D0c (c)

Basically, the aggregate distance function is obtained by removing the
possibility of substitution in final demand. Similar considerations apply to the
relationship between the aggregate cost functions C (w, Y, A) and C (w, c, A).
Therefore, and although we do not present them in this form, our results can
be used to fully characterize the aggregate distance function D ( L, A, c) and
the aggregate cost function C (w, c, A).
A.4. Non-Homothetic Final Demand and Distortions
One advantage of the alternative notions defined in Section A.3 is that they
can be applied to to economies that do not possess an “aggregate output”
good. However, as already mentioned, these notions must then be combined
with final demand to derive general-equilibrium comparative statics.
In Baqaee and Farhi (2018), we develop an alternative approach based on
“propagation equations” which maintains the focus on general-equilibrium
comparative static results. These equations generalize equations (5) and (6) in
Proposition 2 and equations (8) and (9) in Proposition 7. These equations allow
us to characterize the first- and second-order properties of real GDP when it is
defined as a Divisa index (and does not correspond to any physical quantity)
and hence to compute macroeconomic elasticities of substitution between
factors and the macroeconomic bias of technical change along the same lines
as in this paper. This methodology generalizes our results to environments
with non-homothetic final demand. It also has the advantage of allowing us
to also deal with economies with distortions in the same unified framework.
54

Appendix B: Appendix: Quantitative Application in Section 6.5
We show how to use these results to study capital-skill complementarity à
la Griliches (1969) in the US economy, taking into account the multiplicity
of sectors and their input-output linkages. We use the analysis to revisit
the influential analysis in Krusell et al. (2000) of the role of these
complementarities in the evolution over time of the skill premium.
Krusell et al. (2000) studies the relationship between the increasing skill
premium and the rapid decline in the relative price of equipment investment
goods. They find that complementarity between capital goods and high-skill
labor can explain a large part of the increase in the skill premium. They use an
aggregate model and directly postulate an exogenous aggregate production
function. We revisit their analysis in the context of a disaggregated model
where the aggregate production function emerges endogenously. We find
that moving from the aggregate model to the disaggregated model reduces
the MES between capital and high-skil labor from 0.67 to 0.66 and the MES
between capital an low-skill labor from 1.05 to 0.93. These differences are
enough to reduce by 20% the contribution of the decline in the relative price of
equipment investment to the increase of the skill premium. These particular
results notwithstanding, we stress that our goal in this application is more
to demonstrate quantitatively the dependence of macroeconomic elasticities
of substitution on microeconomic primitives than to draw strong implications
for the question of whether and how much complementarities between capital
and skilled labor can explain the behavior of the skill premium.
Krusell et al. (2000) work with a nested CES aggregate production function
of the form

 θ2
  θ2θ−1
  θ2θ−1 θ2 −1
2
2
X
L
Y

,
= ω L
+ (1 − ω L )
X̄
L̄
Ȳ
with

X
= ω H
X̄



H
H̄

 θ1θ−1
1

 θ1
  θ1θ−1 θ1 −1
1
K

+ ωK
.
K̄

Here L represents low-skill labor, H high-skill labor, and K is capital.
They estimate the model on macro data using the first-order conditions
of the model and find an elasticity of substitution between skilled labor and
capital to be θ1 = 0.67 and an elasticity of substitution between unskilled labor
and the composite factor X to be θ2 = 1.67. They argue that these estimates
are plausible by noting that they lie in the middle of the range of estimates
in the microeconomic literature reported by Johnson (1997) and Hamermesh
(1996). They then use their estimated model to perform a counterfactual and
conclude that the decrease in the price of equipment investment goods can
explain a large part of the increase in the skill premium over time.
55

We revisit their exercise in a calibrated disaggregated model with 66
sectors and input-output linkages. We consider a model with 5 distinct
micro elasticities of substitution (θ0 , θ1 , θ2 , θ3 , θ4 ). The parameter θ0 is the
elasticity of substitution across industries in consumption, θ1 is the elasticity
of substitution between high-skilled labor and capital, θ2 is the elasticity of
substitution between low-skilled labor and a composite factor consisting of
high skilled labor and capital, θ3 is the elasticity of substitution across valueadded and intermediate inputs, and θ4 is the elasticity of substitution across
intermediate inputs.
We consider a benchmark calibration with values for the elasticities
(θ0 , θ1 , θ2 , θ3 , θ4 ) = (0.9, 0.67, 1.67, 0.5, 0.0001) informed by estimates from
the microeconomic literature, which as we shall see, points to strong
complementarities at the sectoral level (θ4 = 0.0001) and between value added
and intermediates (θ3 = 0.5). For the elasticities of substitution between
skilled labor and capital and between unskilled labor and the composite
factor consisting of high-skilled labor and capital and skilled labor, we pick
θ1 = 0.67 and θ2 = 1.67 which we are consistent with the microeconomic
literature surveyed in reported by Johnson (1997) and Hamermesh (1996).
We set the elasticity of substitution in consumption θ0 = 0.9, following
Atalay (2017), Herrendorf et al. (2013), and Oberfield and Raval (2014), all
of whom use an elasticity of substitution in consumption (across industries)
of slightly less than one. For the elasticity of substitution across value-added
and intermediate inputs, we set θ3 = 0.5. This accords with the estimates
of Atalay (2017), who estimates this parameter to be between 0.4 and 0.8,
as well as Boehm et al. (2019), who estimate this elasticity to be close to
zero. Finally, we set the elasticity of substitution across intermediate inputs
to be θ4 = 0.001, which matches the estimates of Atalay (2017). The aggregate
production function arising endogenously from our model is different from
the aggregate production function postulated by Krusell et al. (2000).
In the aggregate model of Krusell et al. (2000), macroeconomic
elasticities of substitution between factors coincide with their microeconomic
counterparts. As a result, they can be estimated using either microeconomic
or macroeconomic data. Their particular choices come from a macroeconomic
estimation with macroeconomic data using the first-order conditions of
their aggregate model. They find that these estimates are consistent with
microeconomic estimates in the microeconomic literature reported by Johnson
(1997) and Hamermesh (1996).
By contrast, in our disaggregated model, the macroeconomic elasticities
of substitution between factors are different from their microeconomic
counterparts. We therefore rely entirely on microeconomic estimates to justify
our choices the microeconomic elasticities of substitution θ1 and θ2 . If one
takes the view that the economy is described by our model, then their
macroeconomic model is mis-specified. Our justification for choosing the
same values as them for these elasticities is only that these values are
56

consistent with estimates from the microeconomic literature, and not because
they come out of the estimation of their possibly mis-specified macroeconomic
model with macroeconomic data.
We use input-output tables and the integrated industry-level production
account (KLEMS) data from the BEA. These two datasets report, at the
industry level, the expenditures of each industry on different types of inputs
(supplied from other industries), as well as the compensation of college
(high-skill) employees and non-college (low-skill) employees. We attribute the
remainder of each industry’s value-added net of compensation of employees
to the industry’s capital stock.
Although we calibrate the model with industry-level data, the general
methodology can accommodate as much data as available to the researcher.
In particular, going from an industry-level model, to a firm or product level
model is, conceptually, a very easy step given the generality of Propositions 2
and 7.
Production Function
Capital
Non-college
College

Capital
–
1.05
0.67

Non-college
1.67
–
1.67

Cost Function

College
0.67
0.88
–

Capital
Non-college
College

Capital
–
1.28
0.67

Non-college
1.67
–
1.67

College
0.67
1.07
–

TABLE B.1. MESs between factors in the aggregate production function and in the
aggregate cost function for the aggregate model.

Production Function
Capital
Non-college
College

Capital
–
0.94
0.67

Non-college
1.43
–
1.59

Cost Function

College
0.70
0.94
–

Capital
Non-college
College

Capital
–
1.09
0.64

Non-college
1.47
–
1.54

College
0.72
1.09
–

TABLE B.2. MESs between factors in the aggregate production function and in the
aggregate cost function for the disaggregated model.

In Table B.1, we show the MES between the three primary factors for
the aggregate model of Krusell et al. (2000) using both the production
function (quantity elasticities) and the cost function (price elasticities). Since
the aggregate model has a nested CES production function, the MES between
capital and college labor in the aggregate production function and in the
aggregate cost function are just equal to the corresponding micro elasticity
θ1 = 0.67. Similarly, the MESs between either capital or college labor and noncollege labor are just equal to the corresponding micro elasticity θ2 = 1.67.
In Table B.2, we show the same macroeconomic elasticities of substitution
(for both quantities and prices) using the disaggregated model. In the
57

disaggregated model, MESs between factors depend not only on their
microeconomic counterparts θ1 and θ2 as in the aggregate model, but also
on the other microeconomic elasticities of substitution θ0 , θ3 , and θ4 . Note
C
F
that the values of σHK
and σHK
end up being very similar to those used by
Krusell et al. (2000) (respectively 0.64 vs. 0.67 and 0.67 vs. 0.67) : this is because
some of the microeconomic elasticities are higher (θ0 = 0.9 and θ2 = 1.67)
and some are lower (θ3 = 0.5 and θ4 = 0.0001), and their corresponding
C
effects basically cancel out. The difference is bigger in the case of σLK
and
F
σLK (respectively 1.09 vs. 1.28 and 0.94 vs. 1.05) and the disaggregated model
has lower values for these elasticities in part simply because in this case the
benchmark microeconomic elasticity is higher to begin with.
To demonstrate this dependence in more detail, we show how the MES
between capital and skilled labor changes in response to changes in the
underlying microeconomic elasticities of substitution in Table B.3, and how
the MES between capital and skilled labor changes in response to changes in
the underlying microeconomic elasticities of substitution in Table B.4. In both
tables, since the MESs in the aggregate cost function are weighted averages of
the underlying micro-elasticities of substitution, the sum of the derivatives
along this column add up to 1. The same is not true of the MESs in the
aggregate production function.

σHK
Consumption: θ0
VA vs. INT: θ3
INT: θ4
VA outer nest: θ2
VA inner nest: θ1

Aggregate Model

Disaggregated Model

Cost

Production

Cost

Production

0.67

0.67

0.64

0.66

–
–
–
0
1

–
–
–
0
1

0.13
0.1
0.09
0.01
0.67

0.12
0.09
0.08
0.05
0.65

TABLE B.3. Derivatives of the MES between high-skilled labor and capital w.r.t. micro
elasticities of substitution.

We can use our estimates for the values of the macro elasticities of
substitution to revisit the question posed by Krusell et al. (2000) and assess
by how much the growth in capital due to the decline in the relative price of
equipment has contributed to the widening skill premium. Following them,
we ask how factor income shares would change if growth in capital had not
accelerated in the mid-1970s. Absent this acceleration in the growth rate, the
capital stock in 2015 would be lower. Specifically, maintaining the growth in
the capital stock at its 1970s growth rate would be tantamount to a shock of
size d log K = −0.37 to today’s capital stock.

58

σLK
Consumption: θ0
VA vs. INT: θ3
INT: θ4
VA outer nest: θ2
VA inner nest: θ1

Aggregate Model

Disaggregated Model

Cost

Production

Cost

Production

1.28

1.05

1.09

0.93

–
–
–
0.4
0.6

–
–
–
0.97
0.24

0.11
0.09
0.1
0.26
0.46

0.14
0.11
0.07
0.57
0.22

TABLE B.4. Derivatives of the MES between low-skilled labor and capital w.r.t. micro
elasticities of substitution.

In Table B.5, we show the implied change in factor income shares in
response to such a shock, for both the aggregate and disaggregated models.
In the aggregate counterfactual economy, the capital share would be higher
by about 5%, while the non-college share of income would be 7% higher,
and the college share of income would be 13% lower. On the other hand,
in the disaggregated counterfactual economy, the capital share would be
6% higher, while the non-college share of income would be 4% higher, and
the college share would be 13% lower. Hence, viewed through the lens of
the disaggregated economy, and compared to the aggregate economy, the
accelerated growth in capital has weighed down the capital share more,
increased the college share less, and weighed down the non-college share less
(the last effect has been cut by more than half).

Aggregate model
Disaggregated Model

Capital
0.05
0.06

Non-college
0.07
0.04

College
-0.13
-0.13

TABLE B.5. The (log point) change in factor income shares in response to the shock
d log K = −0.37 in the aggregated and disaggregated model.

The change in the skill premium, defined as the change in the relative
income of college and non-college labor, can also be estimated using the
numbers in Table B.1 and B.2. Specifically, we can write




1
d log Λ H
d log Λ L
1
−
× d log K =
−
× d log K,
σHK
σLK
d log K
d log K
putting the change in skill premium in the aggregate model at −0.20 log points
and −0.16 log points in the disaggregated model.
The implication is that the disaggregated model reduces by 20% the
increase in the skill premium that can be ascribed to the channel running
through capital-skill complementarity and the decrease in the relative price of
59

equipment identified by Krusell et al. (2000). This is of course by no means the
final word on this question. The broad lesson is that disaggregating matters for
some questions and less for others. There is a priori no way to know without
doing the analysis. The point we wish to demonstrate is how easy it is to port
prior analysis to more realistic production structures through a mechanical
application of Propositions 1 and 6 — the only limit is the availability of data.

60

