NBER WORKING PAPER SERIES

SHRINKAGE ESTIMATION OF HIGH-DIMENSIONAL FACTOR MODELS WITH
STRUCTURAL INSTABILITIES
Xu Cheng
Zhipeng Liao
Frank Schorfheide
Working Paper 19792
http://www.nber.org/papers/w19792

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2014

Minchul Shin (Penn) provided excellent research assistance. Many thanks to Ataman Ozylidirim for
granting us with access to a selected set of time series published by The Conference Board. We also
thank Xu Han and seminar participants at the University of Pennsylvania, Yale University, the 2013
Montreal Time Series Conference, the 2013 Tsinghua Econometrics Conference, the 2013 NSF-NBER
Time Series Conference, and the 2013 New York Area Econometrics Colloquium for helpful comments
and suggestions. Schorfheide gratefully acknowledges financial support from the National Science
Foundation under Grant SES 1061725. The views expressed herein are those of the authors and do
not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2014 by Xu Cheng, Zhipeng Liao, and Frank Schorfheide. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Shrinkage Estimation of High-Dimensional Factor Models with Structural Instabilities
Xu Cheng, Zhipeng Liao, and Frank Schorfheide
NBER Working Paper No. 19792
January 2014
JEL No. C13,C33,C52
ABSTRACT
In high-dimensional factor models, both the factor loadings and the number of factors may change
over time. This paper proposes a shrinkage estimator that detects and disentangles these instabilities.
The new method simultaneously and consistently estimates the number of pre- and post-break factors,
which liberates researchers from sequential testing and achieves uniform control of the family-wise
model selection errors over an increasing number of variables. The shrinkage estimator only requires
the calculation of principal components and the solution of a convex optimization problem, which
makes its computation efficient and accurate. The finite sample performance of the new method is
investigated in Monte Carlo simulations. In an empirical application, we study the change in factor
loadings and emergence of new factors during the Great Recession.

Xu Cheng
Department of Economics
University of Pennsylvania
3718 Locust Walk
Philadelphia, PA 19104
xucheng@econ.upenn.edu
Zhipeng Liao
Department of Economics
University of California, Los Angeles
Bunche Hall
Los Angeles, CA 90095
zhipeng.liao@econ.ucla.edu

An online appendix is available at:
http://www.nber.org/data-appendix/w19792

Frank Schorfheide
University of Pennsylvania
Department of Economics
3718 Locust Walk
Philadelphia, PA 19104-6297
and NBER
schorf@ssc.upenn.edu

1

1

Introduction

High-dimensional factor models are widely used to analyze macroeconomic and financial
panel data, where a small number of unobserved factors drive the comovement of a large
number of time series. This paper focuses on the complications in the estimation of factor
models that arise from potential structural breaks. Our leading empirical example of a
potential structural break is the beginning of the 2007-2009 (Great) recession, which, unlike
other post-war U.S. recessions, was characterized by a severe disruption of financial markets,
a slow recovery, and a lasting episode of zero nominal interest rates and unconventional
monetary policies. Throughout this paper, we distinguish between two types of factor model
instabilities: changes in the factor loadings, which alter the response of macroeconomic
variables to a fixed number of underlying factors (type-1 instability), and changes in the
number of factors (type-2 instability). Since only the product of factors and loadings is
identifiable, we use a normalization that attributes changes in this product to changes in
loadings.
The main contribution of this paper is in providing a novel econometric procedure that
allows researchers to consistently estimate the number of pre- and post-break factors simultaneously and to consistently detect changes in factor loadings in cases in which the number
of factors remaines unchanged. Our estimation method relies on a penalized least squares
(PLS) criterion function in which adaptive group-LASSO penalties are attached to pre-break
factor loadings, to coefficients that parameterize changes in factor loadings after the break,
and to coefficients that are associated with new post-break factors. The PLS estimator is a
shrinkage estimator because, as compared with the unrestricted least squares estimator, it
sets small coefficient estimates equal to zero. The number of factors is determined based on
the number of nonzero columns in the loading matrices, and we refer to the determination
of the number of factors and the presence of breaks as model selection.
Our procedure substantially differs from existing methods in several dimensions. First, to
detect instabilities in factor loadings, our method does not require knowledge of the factors
before and/or after the break. Second, our procedure automatically determines whether a
structural break belongs to the type-1 or type-2 category. Third, for type-2 instabilities, we
decompose the structural change into the contribution of new factors and the contribution
of changes of loadings for the old factors.
Fourth, the consistency of our procedure is preserved even if the break date is unknown.

2
It is known in the literature (e.g., Breitung and Eickmeier (2011)) that the presence of
instabilities leads to the overestimation of the number of factors. In turn, a misspecification
of a break date leads to the overestimation of pre- or post-break factors. Thus, roughly
speaking, we search for break dates that minimize the sum of the number of pre- and postbreak factors. While this procedure itself does not deliver a consistent estimate of the break
date, it does generate consistent estimates of the number of pre- and post-break factors —
even if the “true” break date is unknown to the researcher.
The empirical analysis in this paper revisits a recent study by Stock and Watson (2012),
who investigated whether new factors appeared at the onset of the Great Recession, considering a large data set of macroeconomic and financial times series. In a nutshell, Stock and
Watson (2012) extended the pre-break factor to the post-break period and examined whether
there was evidence of an un-modeled factor in the residuals of the post-break sample. They
found no such evidence. Our empirical results differ. Using a similar set of time series, but
sampled at a monthly frequency, we find evidence of a type-2 instability at the beginning
of the Great Recession (i.e., the emergence of a new factor, which can be interpreted as
a financial factor). Our estimation results also indicate that the factor loadings changed
drastically during this episode. Because Stock and Watson (2012) normalized the size of the
loadings rather than the variance of the factors in their analysis, the change in loadings in
our analysis mirrors the increase in factor volatility in their analysis.
We are building on a large body of literature on the analysis of factor models. In a seminal
paper, Bai and Ng (2002) provide information criteria to select the number of factors in stable
factor models. We use their assumptions about cross-sectional and temporal dependence
and heteroskedasticity in the idiosyncratic errors as a starting point for our theoretical
analysis. In subsequent work, several authors (e.g., Onatski (2010), Alessi, Barigozzi, and
Capasso (2010), Kapetanios (2010), Caner and Han (2012), Ahn and Horenstein (2013), and
Choi (2013)) proposed alternative methods for estimating the number of factors in a stable
environment.
Stock and Watson (2002) and, more recently, Bates, Plagborg-Møller, Stock, and Watson
(2013), show that in the presence of small structural instabilities of the factor loadings the
principal component estimator of the factors remains consistent. Our paper focuses on large
structural breaks that render the principal component estimator inconsistent. As shown,
for instance, in Breitung and Eickmeier (2011), a factor model with big structural breaks
can always be written as a stable model with a larger number of pseudo-true factors. These

3
pseudo-true factors are comparable to the factors that are being estimated with a static
factor model, if the “true” factors are current and lagged values of a lower-dimensional
vector of dynamic factors (e.g., Forni, Hallin, Lippi, and Reichlin (2000), Amengual and
Watson (2007), Bai and Ng (2007), Hallin and Lika (2007), Onatski (2009), and Breitung
and Pigorsch (2013)). The above-mentioned methods for estimating the number of factors
in a stable environment, are only able to determine the number of pseudo-true factors, but
not the actual number of pre- and post-break factors. However, in many applications (e.g.,
forecasting with factor-augmented autoregressive models) the consistent estimation of the
post-break factors is crucial.
Several structural break tests for factor models have been developed in the literature.
Most papers, including Stock and Watson (2009), Breitung and Eickmeier (2011), Chen,
Dolado, and Gonzalo (2011), Han and Inoue (2011), and Corradi and Swanson (2013),
consider the null hypothesis of no change in loadings versus an alternative of a single break
in the loadings, assuming that the number of factors stays constant throughout the sample.
The key challenges are to ensure that the estimation error with the factors is asymptotically
negligible and to control the family-wise error as the number of factor loadings, and hence the
number of parameters on which the null hypothesis is imposed, tends to infinity in the large
sample approximations. Our PLS estimation approach automatically controls the familywise error over an increasing number of variables. Furthermore, to achieve consistency, we
only require that the number of the time series variables and the number of time periods
are both large without any restriction on their relative rates, whereas structural break tests
in the literature typically restrict their relative rates to ensure that the generated-regressor
effect is negligible.
If the break point is known one, could study the emergence of new post-break factors
simply by applying one of the existing methods for determining the number of factors in a
stable environment to the pre- and post-break subsamples. Alternatively, Stock and Watson
(2012) test for the presence of a factor in the errors associated with the forecasts of the postbreak observations based on extensions of the pre-break factors. However, these approaches
have not been extended to the unknown-break-date case, and they would be unable to
simultaneously detect type-1 instabilities if the data provide no evidence in favor of a change
in the number of factors.
The model selection mechanism in this paper employs the adaptive group LASSO estimator (Tibshirani (1994), Zou (2006), and Yuan and Lin (2006)) of a high-dimensional

4
sparse system. This sparse system unifies the factor structures and the specification of
structural changes. Specifically, we consider penalized estimation of the factor loadings and
changes in factor loadings in an augmented auxiliary model where the factors are replaced
by a large number of orthonormal regressors. Consistent model selection is obtained by
combining superefficient estimation of the zero components and consistent estimation of the
nonzero components in the sparse system. Theoretical results in the paper provide bounds
on the penalization tuning parameters for consistent model selection. A practical algorithm
is suggested for empirical applications. In recent work, Bai and Liao (2012), Caner and Han
(2012), and Lu and Su (2013) provide important results on shrinkage estimation of stable
factor models. With observed regressors, Lee, Seo, and Shin (2012) and Qian and Su (2013)
propose using shrinkage estimation to detect structural breaks. The main challenge in our
paper is that the factor structure is both unobserved and unstable.
The remainder of this paper is organized as follows. Section 2 describes the factor model
and the types of instabilities considered in this paper. The proposed shrinkage estimator and
model selection procedure are presented in Section 3 under the assumption that the break
date is known. Section 4 develops the asymptotic theory for our estimator and establishes
the consistency of the model selection procedure. The selection of the tuning parameters as
well as the practical implementation of the shrinkage estimation are addressed in Section 5.
The extension to the case in which the break date is unknown is presented in Section 6.
The Monte Carlo results are reported in Section 7, and Section 8 contains the empirical
application. Finally, Section 9 concludes. All proofs as well as additional simulation and
empirical results are relegated to the Appendix.

2

A Factor Model with Structural Break

We observe panel data {Xit ∈ R : i = 1, . . . , N, t = 1, . . . , T }. Let Xt = (X1t , . . . , XN t )0 ∈
RN ×1 denote the observations at time period t. For t = 1, . . . , T0 , the observed N series are
driven by ra unobserved common factors. At time period T0 , the number of factors and/or
the magnitude of the factor loadings may change. We assume that there are no further breaks
after T0 . Using the break date T0 , we split the full sample into two stable subsamples: The
first one contains the first T0 observations of the N series, and the second one contains the
last T1 = T − T0 observations of the N series. In the remainder of this section, we introduce
the (nonidentifiable) data generating process (DGP) and an identifiable version of the DGP.

5
Moreover, we distinguish between two types of structural changes, the occurrence of which
we will consistently estimate.

2.1

The (Nonidentifiable) Data Generating Process

The DGP before T0 is
Xt = Λ0 Ft0 + et , for t = 1, . . . , T0 ,

(2.1)

where Λ0 ∈ RN ×ra denotes the factor loadings and et ∈ RN denotes the idiosyncratic errors.
Using matrix notation, we write
Xa = Fa Λ00 + ea ,

(2.2)

where Xa = (X1 , . . . , XT0 )0 ∈ RT0 ×N , Fa = (F10 , . . . , FT00 )0 ∈ RT0 ×ra , and ea = (e1 , . . . , eT0 )0 ∈
RT0 ×N . The matrices Fa and Λ0 are both unknown and they are not separately identified.
To take into account the potential structural break in period T0 , we write the post-break
DGP in matrix form as
Xb = Fb,1 (Λ0 + Γ01 )0 + Fb,2 Γ00
2 + eb ,

(2.3)

where Xb = (XT0 +1 , . . . , XT )0 , Fb,1 = (FT00 +1 , . . . , FT0 )0 , Fb,2 = (FT∗0 +1 , . . . , FT∗ )0 , and eb =
(eT0 +1 , . . . , eT )0 . Here the T1 × ra matrix Fb,1 extends the pre-break factors to the post-break
period, whereas the T1 × (rb − ra ) matrix Fb,2 collects the new factors that may emerge after
the break. The matrix Γ01 captures possible changes in the loadings of the pre-break factors
Ft0 , whereas the matrix Γ02 contains the loadings for the new factors Ft∗ . The changes in
the factor loadings are summarized in Γ0 = (Γ01 , Γ02 ). If the loadings of the old factors stay
constant, then Γ01 = 0. Likewise, in the absence of new factors Γ02 = 0. After T0 , there are rb
factors Fb = (Fb,1 , Fb,2 ) with factor loadings Ψ0 = (Λ0 + Γ01 , Γ02 ). Thus, the model in (2.3)
can be equivalently written as
Xb = Fb Ψ00 + eb .

(2.4)

Throughout this paper, we use C ∈ R to denote a generic positive constant. For t > T0 ,
0

0

let F t = (Ft00 , Ft∗0 ) ∈ Rrb denote the rb factors after the break. We assume the factors and
their loadings satisfy Assumptions A and B below.
4

0

Assumption A. E[ kFt0 k ] ≤ C, E[||F t ||4 ] ≤ C and there exist positive definite matrices
P 0 0 00
P
0 00
−1/2
ΣF and ΣF such that T0−1 Tt=1
Ft Ft = ΣF + Op (T0 ) and T1−1 Tt=T0 +1 F t F t = ΣF +
−1/2

Op (T1

). 

6
Write Λ0 = (λ01 , . . . , λ0N )0 , where λ0i ∈ Rra ×1 is the factor loading for series i before the
0 0
break. Similarly, write Ψ0 = (ψ10 , . . . , ψN
) , where ψi0 ∈ Rrb ×1 is the factor loading for series

i after the break.
Assumption B. (i) kλ0i k ≤ C, ||ψi0 || ≤ C and there exist matrices ΣΛ , ΣΨ and ΣΛΨ such
that ||Λ00 Λ0 /N − ΣΛ || → 0, ||Ψ00 Ψ0 /N − ΣΨ || → 0, and ||Λ00 Ψ0 /N − ΣΛΨ || → 0 as N → ∞,
where ΣΛ and ΣΨ are positive definite. (ii) The matrices ΣΛ ΣF and ΣΨ ΣF both have distinct
eigenvalues. 
Assumptions A and B are analogous to Assumptions A and B of Bai and Ng (2002) with
the modification to accommodate additional factors and changes of factor loadings at T0 .
They ensure that all ra factors before the break and rb factors after the break make nontrivial
contributions to the variance of the data. Assumption B(ii) is the same as Assumption G of
Bai (2003).1
In the remainder of this paper, we assume rb ≥ ra . If the application suggests that rb ≤ ra ,
then labeling the subsample before T0 as Xb and the subsample after T0 as Xa maintains the
validity of the proposed method. We distinguish between two types of instabilities:
type-1 change : rb = ra and Γ01 6= 0
type-2 change : rb > ra .

(2.5)

Under a type-1 change, the number of factors is constant, but there is a change in the factor
loadings. For a type-2 change, new factors appear in the model after T0 , while some of the
loadings of the old factors also may change.
If the break date T0 is known, the number of pre- and post-break factors ra and rb
are identified and can be consistently estimated using existing methods (e.g., the model
selection criteria proposed by Bai and Ng (2002)). The strict inequality rb > ra identifies
type-2 instabilities without further assumptions on the DGP. To identify type-1 instabilities,
further restrictions are necessary. Intuitively, the change is identifiable if either the space
spanned by the factor loadings or the scaling of the factor loadings changes. Formally, for any
square matrix A, we use ρ` (A) to denote its `-th largest eigenvalue. Define a (ra +rb )×(ra +rb )
1

Assumption A is sufficient for the identification conditions in Assumption ID below. It is also one of the

sufficient conditions for consistent model selection with a known break date. For consistent model selection
with an unknown break date, Assumption A is strengthened to Assumption A∗ in Section 6.1.

7
augmented covariance matrix
"
Σ+
ΛΨ =

ΣΛ

ΣΛΨ

Σ0ΛΨ

ΣΨ

#
.

(2.6)

The following assumption, stated in terms of the coefficients of the DGP in (2.2) and (2.3),
is sufficient for identifying type-1 structural instabilities.
Assumption ID. One of the following two conditions holds:
(i) rank(Σ+
ΛΨ ) > ra ;
(ii) ρ` (ΣF ΣΛ ) 6= ρ` (ΣF ΣΨ ) for some ` ≤ ra . 
Assumption ID(i) holds if and only if Λ0 and Ψ0 do not span the same column space
asymptotically. Assumption ID(ii) focuses on the scaling of the loadings and provides an
alternative identification condition through the eigenvalues of ΣΛ ΣF and ΣΨ ΣF . This condition does not put restrictions on the asymptotic column spaces generated by the factor
loadings.

2.2

An Identifiable Version of the DGP

The factors and their loadings in (2.2) and (2.4) are not separately identified. In order to
develop an estimation theory for the factor model, we have to impose normalization restrictions. This normalization also helps to further clarify identifiable type-1 structural changes.
Because our estimation will be based on principal-components analysis, we normalize the factors to have an identity covariance matrix and the vectors of factor loadings to be orthogonal
and sorted according to length.2
1/2

Let Σa = Λ00 Λ0 /N ∈ Rra ×ra , let Σa

be the Cholesky factor of Σa , and let Υa be a

matrix of orthonormal eigenvectors such that
Υ0a (Σa1/2 )0 ΣF Σa1/2 Υa = Va ,

(2.7)

where Va is a diagonal matrix of eigenvalues, ordered from largest to smallest. Note that by
1/2

1/2

Assumptions A and B, the matrix (Σa )0 ΣF Σa

has positive and distinct eigenvalues with

large N , which means that (2.7) holds for large N . Now define the transformation matrix
−1/2
Ra = Σ1/2
.
a Υa Va
2

(2.8)

In addition, the signs of the factors and loadings need to be normalized. However, because this sign

normalizaton is immaterial for our analysis, we do not provide further details.

8
We can rewrite the DGP before T0 as
Xa = Fa Ra Ra−1 Λ00 + ea = FaR ΛR0 + ea ,

(2.9)

where FaR = Fa Ra and ΛR = Λ0 (Ra−1 )0 . For the post-break DGP, we let Σb = Ψ00 Ψ0 /N ∈
Rrb ×rb , substitute ΣF in (2.7) by ΣF , and otherwise replace a subscripts by b subscripts. The
second transformation matrix Rb is defined as
−1/2

1/2

Rb = Σb Υb Vb

(2.10)

such that the second DGP can be rewritten as3
Xb = Fb Rb Rb−1 Ψ00 + eb = FbR ΨR0 + eb .

(2.11)

Assumption ID(i) implies that the column spaces of ΛR and ΨR in (2.9) and (2.11) are
different, whereas Assumption ID(ii) translates into Va 6= Vb . Note that our normalization
interprets changes in the law of motion of the factors Fa and Fb as changes in the loadings
ΛR and ΨR . For example, consider a DGP with ra = rb = 1, constant factor loadings Λ = Ψ,
and a break in the persistence of the factor, which follows an AR(1) process Ft = ρa Ft−1 + εt
for t ≤ T0 and Ft = ρb Ft−1 + εt for T > T0 , where εt ∼ i.i.d.N (0, 1) for all t. The change
of the autocorrelation of Ft from ρa to ρb in our setting translates into a change of the
p
p
transformed factor loadings from ΛR = Λ/ 1 − ρ2a to ΨR = Λ/ 1 − ρ2b . This leads to
Vb = Va (1 − ρ2b )/(1 − ρ2a ).

2.3

A Useful Decomposition of Structural Changes

The (nonidentifiable) DGP in (2.2) and (2.3) provides a natural decomposition of type-2
0

structural changes into changes resulting from the new factors, Fb,2 Γ02 , and changes associ0

ated with the effect of the extended versions of the old factors, Fb,1 Γ01 . We can mechanically
rewrite the normalized version of the post-break DGP in (2.11) as
0

R
0
R R
Xb = FbR ΨR0 + eb = Fb,1
(ΛR + ΓR
1 ) + Fb,2 Γ2 + eb ,
3

(2.12)

It can be verified that the transformation induces the desired normalization. For the pre-break period,

using Assumption A and the fact that Υa is a finite matrix, we have
1/2
−1/2
Ta−1 FaR0 FaR = Va−1/2 Υ0a Σ1/2
+ Op (Ta−1/2 ) = Ira ×ra + Op (Ta−1/2 ).
a ΣF Σa Υa Va
1/2

Moreover, by definition of Σa , N −1 ΛR0 ΛR = Va
matrix, as desired.

−1/2

Υ0a Σa

−1/2 0

Σa (Σa

1/2

) Υa Va

= Va , which is a diagonal

9
0

R R
R
R
R
), and we define ΓR = (ΓR
, Fb,2
where FbR = (Fb,1
1 , Γ2 ). However, the components Fb,1 Γ1 and
0

R R
Fb,2
Γ2 are difficult to interpret because after imposing the normalization, there is no sense

in which Fb,1 can be viewed as the post-break extension of Fa .
Nonetheless, in empirical applications, it is interesting and useful to decompose type-2
changes into the contribution of the new factors and changes in the effects of old factors. To
do so, we construct an rb × ra matrix with orthogonal columns by maximizing the correlation
between the old normalized loadings ΛR and the new loadings ΨR Ωa :
0

Ωa = argmaxΩ̃a ∈O tr[ΛR ΨR Ω̃a ],

(2.13)

where O is the class of rb × ra matrices with orthonormal columns. The solution is given by
(see Cliff (1966)) Ωa = V U 0 , where V is an rb ×ra and U an ra ×ra orthogonal matrix obtained
0

from the singular value decomposition ΛR ΨR = U DV 0 . Let Ω⊥ be the null space of Ω0a and
define Ω = (Ωa , Ω⊥ ). Moreover, define the rotated loadings and factors FbRΩ = F R Ω and
0

ΨRΩ = ΨR Ω. This rotation preserves the normalization of the factors, i.e., FbRΩ FbRΩ /Tb = I.
RΩ
RΩ
RΩ
Partitioning FbRΩ = (Fb,1
, Fb,2
) and ΨRΩ = (ΨRΩ
1 , Ψ2 ), we can decompose Xb as follows:
0

Xb = FbR ΩΩ0 ΨR + eb =

2.4

0

0

RΩ
R 0
RΩ RΩ
F RΩ ΛR + Fb,1
(ΨRΩ
+eb .
1 − Λ ) + Fb,2 Ψ2
| b,1{z }
{z
}
|
| {z }
old loadings change in loadings new factor

(2.14)

Model Classes

The main contribution of this paper is to develop a procedure that consistently detects the
occurrence of type-1 and type-2 structural changes. Let S0 ∈ {0, 1} be a binary variable
such that S0 = 0 indicates that there is no structural instability (i.e., Γ(0) = 0 in (2.3) and
ra = rb ). If S0 = 1 and ra = rb , then the DGP exhibits a type-1 instability. Finally, S0 = 1
and ra < rb corresponds to a type-2 instability. For the remainder of this paper, we refer to
a model as a collection of DGPs that are associated with the triplet
M0 = (ra , rb , S0 ).

(2.15)

We propose a consistent model selection procedure for M0 based on the simultaneous estimation of ra , rb , and S0 . For the consistent determination of M0 , it suffices to estimate
the normalized version of the factor model in (2.9) and (2.11), because Γ0 = 0 if and only if
R
0
ΓR = 0, where ΓR
1 and Γ2 are (implicitly) defined in (2.12). Moreover, Γ2 = 0 if and only if

ΓR
2 = 0.

10
Our procedure differs from the existing methods in two very important dimensions. First,
our method not only detects structural instabilities but also automatically determines their
type. Second, to detect instabilities in factor loadings, our method does not require knowledge of the number of factors before and/or after the break. Instead, it determines the preand post-break factors structures simultaneously.

3

Model Selection with Known Break Date

In this section, we assume that the date of the potential structural break, T0 , is known. We
divide the full sample into a pre-break and a post-break subsample. Let Ta and Tb denote the
number of periods in the two subsamples, respectively. With a known break date, Ta = T0
and Tb = T1 . Since we treat the number of factors as unknown, we define k ≥ rb to be
the number of potential factors. In order to motivate the criterion function in the shrinkage
estimation, we rewrite the normalized DGP in (2.9) and (2.11) as the following augmented
system:

Xa =

h

Xb =

h

R⊥
R⊥
FaR Fa,1
Fa,2

R
R
Fb,1
Fb,2
FbR⊥

ΛR0



i

 0(r −r )×N  + ea = FaR+ (ΛR+ )0 + ea .
a
b


0(k−rb )×N


R0
R0
i  Λ + Γ1 
 + eb = F R+ (ΛR+ + ΓR+ )0 + eb .

ΓR0
b
2


0(k−rb )×N

(3.1)

Here, FaR⊥ denotes a T × (k − ra ) orthogonal complement of FaR . We partition FaR⊥ into
R⊥
R⊥
T × (rb − ra ) and T × (k − rb ) submatrices Fa,1
and Fa,2
. Likewise, FbR⊥ is an orthogonal

complement of FbR . Below, we call FaR and FbR the “true” and FaR⊥ and FbR⊥ the irrelevant
factors. In the augmented model (3.1), ΛR+ and (ΛR+ + ΓR+ ) are the factor loadings before
and after the break, respectively. Estimating the number of factors and detecting instability
in factor loadings can be executed simultaneously in (3.1), because they are equivalent to
consistent selection of the zero and and nonzero components in ΛR+ and ΓR+ . Hence, for
consistent model selection, it is key to obtain estimators that can consistently distinguish
zeros from nonzeros in ΛR+ and ΓR+ . The shrinkage estimator proposed below is designed
to achieve such consistency.

11

3.1

Estimation Objective Function

The k potential factors are estimated by the principal component estimator in each subsample. Specifically, for subsample j ∈ {a, b}, let Fej ∈ RTj ×k be the orthonormalized eigenvectors
of (N Tj )−1 Xj Xj0 associated with its first k largest eigenvalues. For both subsamples, estimating an overfitted model with k factors gives the unrestricted least square estimators of
e LS = T −1 X 0 Fea , Ψ
e LS = T −1 X 0 Feb and Γ
eLS = Ψ
e LS − Λ
e LS .
the factor loading matrices Λ
a

a

b

b

Given Fea and Feb , we propose shrinkage estimators of ΛR+ and ΓR+ by minimizing a PLS
criterion function:
b Γ)
b =
(Λ,

arg min

[M (Λ, Γ) + P1 (Λ) + P2 (Γ)] ,

(3.2)

Λ∈RN ×k ,Γ∈RN ×k

where
−1

M (Λ, Γ) = (N T )
P1 (Λ) = αN T

k
X
`=1



Xa − Fea Λ0

ω`λ

2

+ Xb − Feb (Λ + Γ)0

kΛ` k and P2 (Γ) = βN T

k
X

2


,

ω`γ kΓ` k ,

(3.3)

`=1

Λ` and Γ` are the `-th column of Λ and Γ, respectively, αN T and βN T are two sequences
of positive constants that depend on N and T , and ω`λ and ω`γ are data-dependent weights
defined as:

−d
−1 e
2
e ` ||2 I e
ω`λ = N −1 ||Λ
+
N
||
Λ
||
I
,
e ` =0N ×1 }
`,LS
{Λ` 6=0N ×1 }
{Λ

−d
−1 e
2
e` ||2 I e
ω`γ = N −1 ||Γ
+
N
||
Γ
||
I
.
e ` =0N ×1 }
`,LS
{Γ` 6=0N ×1 }
{Γ

(3.4)

Here I{x=a} is the indicator function that is equal to one if x = a and equal to zero otherwise;
e ∈ RN ×k and Γ
e ∈ RN ×k are some preliminary estimators of
d is a positive constant; and Λ
Λ+ and Γ+ , where the ` subscript denotes the `-th column of the matrices. The simplest
e=Λ
e LS and
preliminary estimator available is the unrestricted least square estimator (i.e., Λ
eLS = Γ
eLS ). An alternative preliminary estimator can be a shrinkage estimator that is
Γ
based on a rough choice of tuning parameters. Since such a shrinkage estimator may set
some of the columns of Λ̃ and Γ̃ equal to zero, we use the indicator functions to replace zero
columns with the corresponding columns of the unrestricted least square estimators. This
model selection procedure is easy to compute because it is a convex optimization problem
after the principal components are used for dimension reduction.

12
In this adaptive estimation, the data-dependent weights ω`λ and ω`γ are designed to differentiate the zero columns of ΛR+ and ΓR+ from the nonzero columns. It is easy to obtain
e ` || →p 0 if and only if the `-th column of ΛR+ is zero
preliminary estimators such that ||Λ
e` || →p 0 if and only if the `-th column of ΓR+ is zero. The unrestricted least square
and ||Γ
estimator is one simple example. If such requirement is satisfied by the preliminary estimae ` k to converge to a positive constant for ` ≤ ra and to converge to zero
tor, we expect N −1 kΛ
for ` > ra . In the latter case, ω`λ diverges to infinity, which delivers strong penalization in
the shrinkage estimation (3.2) to the estimators of the zero columns in Λ0 . The weights, ω`γ ,
have similar effects on the estimation of Γ+ .
The penalty functions P1 (Λ) and P2 (Γ), defined in terms of the column norms kΛ` k and
kΓ` k, are group-LASSO penalties (cf., Yuan and Lin (2006)). A group-LASSO estimator
either sets all the elements in a group equal to zero or estimates them as nonzeros altogether.
This feature is particularly useful for large-scale factor models because the irrelevant factors
have zero factor loadings for all series. As such, the group-LASSO estimator automatically
controls the group-wise model-selection error, which is challenging if the model-selection is
performed sequentially.

3.2

Model Selection

b and Γ.
b The estimators of ra and
Model selection for M0 is based on the column norms of Λ
rb are
n
o
2
b
rba = min Ja , where Ja = j : ||Λ` || = 0 for all ` > j
n
o
b` ||2 = 0 for all ` > j .
rbb = max (min Jb , rba ) , where Jb = j : ||Γ

(3.5)

b and min Jb is the last nonzero column of
Note that min Ja is the last nonzero column of Λ
b The estimator of S0 is
Γ.
(
b = 0,
0 if Γ
Sb =
(3.6)
1 otherwise.
The procedure selects a model with no structural instability if Sb = 0. When Sb =
6 0, the
change is type-1 if rbb = rba and it is type-2 if rbb > rba .4 In all cases, we not only detect the
4

b do not provide any implications on the stability of
If there is a type-2 change, the first rba columns of Γ

the “original factor loadings” in the first subsample, because they involve a rotation of all factor loadings,
including the new ones.

13
instabilities and identify their sources but also simultaneously estimate the number of factors
before and after the break. In sum, the model selected by the shrinkage estimator is
c = (b
b
M
ra , rbb , S).

(3.7)

In the following sections, we show that
c = M0 ) → 1 as N, T → ∞
Pr(M

(3.8)

provided that the tuning parameters αN T and βN T are chosen within the bounds specified
below.

3.3

Estimation of Factor Loadings

In applications such as forecasting both the dimension of the factor space and the values
of the factor loadings are of interest. If Ŝ = 0 (i.e., there is no evidence of a structural
instability), then we recommend to reestimate the factors and their loadings using the full
sample to improve efficiency and reduce the bias introduced by penalization. In this case,
let Fe ∈ RT ×bra be the orthonormalized left eigenvectors of (N T )−1 XX 0 associated with its
b F = T −1 X 0 Fe.
first rba largest eigenvalues. The factor loading for the full sample is Ψ
If, on the other hand, there is evidence of a structural break, Ŝ = 1, then one could
b and Λ
b+Γ
b of the factor loadings
either use the pre- and post-break shrinkage estimators Λ
or re-estimate the factor model conditional on the selected number of factors r̂a and r̂b . We
call this latter estimator a post-model-selection (PMS) estimator. It is formally defined as


b P M S = Λ, 0Λ , Ψ
b P M S = Ψ, 0Ψ and Γ
bP M S = Ψ
b P MS − Λ
bP MS,
Λ

(3.9)

e LS , Ψ denotes the first rbb columns of Ψ
e LS , 0Λ
where Λ denotes the first rba columns of Λ
is a N × (k − rba ) zero matrix, and 0Ψ is a N × (k − rbb ) zero matrix. For the first rba
columns, the PMS estimator is identical to the unrestricted least square estimator because
b LS . In
the columns of Fea are orthogonal by construction. The same argument applies to Ψ
finite samples, the penalization on the nonzero columns may further reduce the variance
of the shrinkage estimator, but at the same time, it introduces extra bias. Whether this
feature of the shrinkage estimator is preferable to the PMS estimator depends on the specific
bias-variance trade-off, and we provide some simulation evidence in Section 7. For both
the shrinkage estimators and the PMS estimators of the factor loadings, their corresponding
factor estimators are Fea for the first subsample and Feb for the second subsample.

14

4

Asymptotic Theory

b Γ)
b and
This section establishes the large sample properties of the shrinkage estimators (Λ,
shows the consistency of the proposed model selection procedure when the break date is
known. We begin by stating additional assumptions.

4.1

Additional Assumptions

Suppose T0 /T → τ0 for some constant τ0 ∈ (0, 1) as T → ∞. We assume the following
assumptions in addition to Assumptions A and B. Let e = [e1 , . . . , eT ] ∈ RN ×T be the
matrix of idiosyncratic errors and eit denote the (i, t) element of e that is associated with
series i in period t.
Assumption C. (i). E[eit ] = 0, E[|eit |8 ] ≤ C;
PT PT
P
−1
(ii). E[N −1 N
t=1 |σN (s, t)| ≤ C;
s=1
i=1 eis eit ] = σN (s, t), |σN (s, s)| ≤ C for all s, T
P PN
(iii). E[eit ejt ] = τij,t with |τij,t | ≤ |τij | for some τij and for all t, and N −1 N
j=1 |τij | ≤ C;
i=1
P PN PT PT
(iv). E[eit ejs ] = τij,ts and (N T )−1 N
s=1 |τij,ts | ≤ C;
t=1
j=1
i=1
P
4
(v). For every (t, s), E[|N −1/2 N
i=1 [eis eit − E[eis eit ]]| ] ≤ C;
(vi). ρ1 ((N T )−1 ea e0a ) = Op (max[N −1 , T −1 ]) and ρ1 ((N T )−1 eb e0b ) = Op (max[N −1 , T −1 ]). 
P 0 0
P
P
0
−1/2
( Tt=1
Ft eit + Tt=T0 +1 F t eit )||2 ] ≤ C. 
Assumption D. E[N −1 N
i=1 ||T
Assumptions C and D are analogous to Assumptions C and D of Bai and Ng (2002).
Assumption C allows for time-series and cross-sectional weak dependence in the idiosyncratic
errors. Assumption C(vi) or a similar condition is needed for the consistent selection of
the number of factors (see Amengual and Watson (2007)). Assumption D allows for weak
dependence between the factors and the idiosyncratic errors.
Define CN T = min(T 1/2 , N 1/2 ), where CN T is the convergence rate of the unrestricted
least square estimator in Bai and Ng (2002). Assumptions P1 and P2 below are highlevel conditions on the stochastic order of the preliminary estimators. They are useful in
studying the asymptotic properties of the data-dependent weights ω`λ and ω`γ defined in
e LS and Γ
eLS , as well as shrinkage
(3.4). In practice, we consider the least square estimators Λ
estimators as preliminary estimators (see Section 5 for details).
e and Γ
e satisfy
Assumption P1. The preliminary estimators Λ

15
e ` ||2 ≥ C) → 1 for ` = 1, . . . , ra , N −1 ||Λ
e ` ||2 = Op (C −2 ) for ` = ra + 1, . . . , k;
(i) Pr(N −1 ||Λ
NT
e` ||2 ≥ C) → 1 for ` = 1, ..., rb , N −1 ||Γ
e` ||2 = Op (C −2 ) for ` =
(ii) If Γ0 6= 0, Pr(N −1 ||Γ
NT
rb + 1, . . . , k;
e` ||2 = Op (C −2 ) for ` = 1, ..., k. 
(iii) If Γ0 = 0, N −1 ||Γ
NT
e=Λ
e LS and Γ
e=Γ
eLS . 
Assumption P2. Assumption P1 holds with Λ
Assumption P1 is imposed on any preliminary estimators of ΛR and ΓR . If the preliminary
e LS and Γ
eLS , Assumption P2 is still necessary because ω λ and
estimators are different from Λ
`

ω`γ

e LS and Γ
eLS whenever Λ
e or Γ
e has zero columns. Note that Λ
e ` = 0 is a special
depend on Λ
e ` ||2 = Op (C −2 ) in Assumption P1, and the same argument applies to Γ
e` .
case of N −1 ||Λ
NT

Under the conditions in Assumption P1, the columns of the preliminary estimators
e ` ||2 ≥ C) → 1 and
are divided into two categories. For the first category, Pr(N −1 ||Λ
e` ||2 ≥ C) → 1 such that the data-dependent weights, ω λ and ω γ , are stochasPr(N −1 ||Γ
`

tically bounded. For the second category, N

−1

`

e ` ||2 = Op (C −2 ) and N −1 ||Γ
e` ||2 = Op (C −2 ),
||Λ
NT
NT

which implies that ω`λ and ω`γ diverge in probability faster than CN2dT . These large penalties
in the second category yield shrinkage estimators that are equal to 0 w.p.a.1.
While the data-dependent weights ω`λ and ω`γ determine the relative penalties of different
columns of factor loadings, the tuning parameters αN T and βN T determine the overall penalization. We make the following assumptions about the rates at which the tuning parameters
vanish asymptotically.
Assumption T. The tuning parameters αN T and βN T satisfy
(i) αN T = O(N −1/2 CN−1T ) and βN T = O(N −1/2 CN−1T );
−(2d+1)

(ii) N −1/2 CN T

−(2d+1)

= o(αN T ) and N −1/2 CN T

= o(βN T ). 

Assumption T imposes bounds on the tuning parameters αN T and βN T . These bounds
control the magnitudes of penalization on all columns and are designed for consistent model
selection. The upper bound in Assumption T(i) ensures that if the data-dependent weights
ω`λ and ω`γ are stochastically bounded, the penalties on the nonzero columns are small such
that the shrinkage bias is negligible asymptotically. On the other hand, we aim to shrink
the estimators of zero columns to zero. For this purpose, the lower bound in Assumption
T(ii) requires that the tuning parameters αN T and βN T converge to zero not too fast. The
upper bound is larger than the lower bound provided that d is positive. In the simulation

16
and empirical application, we use d = 2. Under the theoretical guidance by Assumption T,
we discuss the practical choice of αN T and βN T in Section 5.

4.2

Asymptotic Behavior of the PLS Estimator

b and Γ.
b The estimators
We begin by defining the asymptotic limits of the PLS estimators Λ
converge to the coefficients of the normalized version of the DGP in (2.9) and (2.11). The
transformation matrices Ra and Rb , defined in (2.8) and (2.10), that were used to normalize
the DGP are related to, but essentially different from, their counterparts considered in the
literature, such as those in Bai and Ng (2002) and Bai (2003). In the definitions of Ra and
Rb , one subtle point is that Σa and Σb are averages that depend on N , whereas ΣF and ΣF
are asymptotic limits as T → ∞. This subtle difference is crucial for deriving asymptotic
limits of the PLS estimators if potential structural change is considered. In the absence of
structural instabilities, Ra = Rb by construction. This immediately implies that ΓR = 0 for
any N , instead of ΓR → 0, as both N and T go to infinity. As previously stated, let the
subscript ` denote the `-th column of a matrix.
Theorem 1 Suppose Assumptions A-D, P1-P2, and T hold. Then,
b ` − ΛR ||2 = Op (C −2 ) for ` = 1, . . . , ra ;
(a) Pre-break loadings of relevant factors: N −1 ||Λ
`
NT
b ` ||2 = 0 for ` = ra + 1, . . . , k) → 1;
(b) Pre-break loadings of irrelevant factors: Pr(||Λ
b` − ΓR ||2 = Op (C −2 )
(c) Post-break changes in loadings of relevant factors: If Γ0 6= 0, N −1 ||Γ
`
NT
for ` = 1, . . . , rb ;
b` ||2 = 0 for 1, . . . , rb ) → 1;
(d) No-break: If Γ0 = 0, Pr(||Γ
b` ||2 = 0 for ` = rb +1, . . . , k) →
(e) Post-break changes in loadings of irrelevant factors: Pr(||Γ
1.
Parts (a) and (b) of Theorem 1 characterize the limits of the PLS estimators of the prebreak factor loadings. Due to the penalization, the factor loadings of the irrelevant factors
are estimated as exactly zero w.p.a.1. This superefficiency result cannot be achieved by the
unrestricted least square estimators. In contrast, for the true factors, the penalization does
not affect the consistency and the convergence rate of their estimators. For ` = 1, . . . , ra ,
b ` converges in probability to the factor loadings ΛR of the transformed
the PLS estimator Λ
`
DGP.

17
Parts (c) to (e) of Theorem 1 characterize asymptotic properties of the PLS estimators
of the changes in the factor loadings, which is essential to detecting structural instabilities.
In the absence of structural instabilities, the PLS estimators of the changes are equal to
0 w.p.a.1. In the presence of a structural instability, the superefficiency in Part (e) of
Theorem 1 only applies to the redundant factors, which pins down the number of factors
after the break.
To obtain results in Parts (a) and (c) of Theorem 1, only the upper bound on the
convergence rate of the tuning parameters in Assumption T(i) is necessary. The lower
bound in Assumption T(ii) is necessary for the superefficiency results stated in Parts (b),
(d), and (e) of Theorem 1. Because the unrestricted least square estimators are special cases
b` = Λ
e `,LS
of the PLS estimators with zero penalties, Parts (a) and (c) of Theorem 1 apply to Λ
b` = Γ
e`,LS for ` = 1, . . . , k, regardless of the specification of the model.
and Γ

4.3

Consistent Model Selection

In the previous subsection, we showed that the factor loadings of the irrelevant factors are
estimated as zeros w.p.a.1. We also showed that the changes in the loadings of the relevant
factors are estimated as zero w.p.a.1, if their loadings are not subjected to any instability.
Hence, to establish the model selection consistency for the PLS estimation, it is sufficient to
R
show that the asymptotic limits ΛR
` and Γ` in Parts (a) and (c) of Theorem 1 are bounded

away from zero w.p.a.1.
Lemma 1 Suppose Assumptions A-D hold. Then,
(a) N −1 ΛR
`

2

= ρ` (ΣΛ ΣF ) + o(1) for ` = 1, . . . , ra ;

2
(b) If rb > ra , N −1 ||ΓR
` || = ρ` (ΣΨ ΣF ) + o(1) for ` = ra + 1, . . . , rb ;
−1 R0 R
(c) If rb = ra and rank(Σ+
Γ Γ → ΣΓ for some ΣΓ 6= 0 as N → ∞;
ΛΨ ) > ra , N
p
p
2
(d) N −1 ||ΓR
ρ` (ΣΨ ΣF ) − ρ` (ΣΛ ΣF )]2 + o(1) for ` = 1, . . . , ra .
` || ≥ [

Lemma 1(a) follows from the definition of the transformation matrix Ra in (2.8) and,
b ` || =
b ` || = 0 for
together with Theorem 1(a) and (c), implies that ||Λ
6 0 for ` ≤ ra and ||Λ
b For
` > ra w.p.a.1. Therefore, a consistent estimator of ra is the last nonzero column in Λ.
the type-2 instability with rb > ra , the same arguments apply by combining Lemma 1(b)

18
with Theorem 1(c) and (e). It follows that a consistent estimator of rb is the last nonzero
b
column in Γ.
To consistently detect a type-1 instability (i.e., ra = rb and Γ01 6= 0), it is sufficient to
show that N −1 ||ΓR ||2 is bounded away from 0 asymptotically. Lemma 1(c) focuses on the
change of the space spanned by the factor loadings. One sufficient condition for Lemma 1(c)
is Assumption ID(i), which holds if and only if Λ0 and Ψ0 do not span the same column
space asymptotically. Lemma 1(d) suggests that an alternative sufficient condition for identification of the structural instability is Assumption ID(ii), which focuses on the change in
the scaling of factor loadings.
Theorem 2 Suppose Assumptions A-D, ID, P1, P2, and T hold. Then the model selection
is consistent:
c = M0 ) → 1 as N, T → ∞.
Pr(M
Theorem 2 provides asymptotic consistency for any set of preliminary estimators that
satisfy Assumption P1 and P2. If the unrestricted least squares estimators are used as
preliminary estimators, our model selection procedure is consistent under a set of primitive
conditions that do not involve Assumptions P1 and P2.
e Γ)
e = (Λ
e LS , Γ
eLS ), then Theorem 2 holds under Assumptions A-D, ID,
Corollary 1 If (Λ,
and T.
If the preliminary estimator is a shrinkage estimator based on a rough choice of the
tuning parameters, then Theorems 1 and 2 can be applied repeatedly to a multistep shrinkage
estimation procedure, which in each step fine-tunes the penalty terms based on the estimation
results of the previous step. Such a multistep estimation procedure is discussed in detail in
Section 5.

5

Practical Guidance for Implementation

We provide a practical procedure for choosing the tuning parameters αN T and βN T in Section 5.1. Moreover, in Section 5.2, we propose a two-step shrinkage estimation procedure
that fine-tunes the penalties in the second-stage based on the first-stage shrinkage estimation
results. This procedure improves the finite-sample performance of the PLS estimator, and
we show in Section 5.3 that it also leads to consistent model selection.

19

5.1

Choosing the Penalty Weights αN T and βN T

According to Theorem 2, consistent model selection requires αN T and βN T to converge to
−(2d+1)

0 at least as fast as N −1/2 CN−1T and slower than N −1/2 CN T

. In practice, we choose αN T

and βN T to balance these two rates. For two scaling constants κ1 and κ2 , let
−1/2 −d−1
CN Tb ,
αN T = κ1 N −1/2 CN−d−1
Ta and βN T = κ2 N
1/2

(5.1)

1/2

where CN Ta = min(N 1/2 , Ta ) and CN Tb = min(N 1/2 , Tb ). Although CN Ta , CN Tb , and
CN T are all of the same asymptotic order, we use CN Ta and CN Tb rather than CN T in (5.1)
to improve the finite-sample accuracy. Roughly speaking, αN T is the weight attached to
the penalty on the coefficients related to Xa , whereas βN T is the penalty weight on the
coefficients of Xb .
In choosing the scaling constants κ1 and κ2 , we consider the optimality conditions that
lead the PLS estimators to have zero solutions for some columns in Λ and/or Γ. Intuitively,
the criterion function in (3.2) is minimized at 0 if the marginal penalty for deviating from 0
is larger than the marginal gain on the least square criterion function. Translated into our
b ` || = 0 for ` > ra if
notation, ||Λ
b Fea,` + eb (Λ
b + Γ)
b Feb,` < N T αN T ω`λ /2,
ea (Λ)

(5.2)

where the residual matrices are
ea (Λ) = Xa − Fea Λ0 and eb (Λ + Γ) = Xb − Feb (Λ + Γ)0 .

(5.3)

The inequality in (5.2) suggests that doubling every element in the residual matrices ea (Λ)
and eb (Λ + Γ) has to be compensated for by doubling κ1 to ensure that the inequality in
(5.2) holds. Therefore, to standardize the left-hand side of (5.2), a reasonable choice of κ1 is
o
1n
e + (N Tb )−1/2 eb (Λ
e + Γ)
e
κ1 =
(N Ta )−1/2 ea (Λ)
,
(5.4)
ζ
where ζ = 1 by default.
In practice, we also consider ζ = 2, 4, and 6 to check the sensitivity of the estimation
results to the penalty function. Although our asymptotic theory does not apply to the weak
factors considered in Onatski (2012), the adjustment of ζ corresponds to the strength of the
factors in finite samples. Generally speaking, a larger ζ works better on detecting a weak
factor and a small break, while a smaller ζ works better for strong factors and large breaks.

20
If the break occurs at the end of the sample, simulation results suggest that a larger ζ, e.g.,
ζ = 4, tends to work better than ζ = 1. By similar arguments, the choice of κ2 is
1
e + Γ)
e .
κ2 = (N Tb )−1/2 eb (Λ
ζ
In sum, the recommended tuning parameters are:

1
e + (N Tb )−1/2 eb (Λ
e + Γ)
e
N −1/2 CN−d−1
αN T =
(N Ta )−1/2 ea (Λ)
Ta ,
ζ

1
e + Γ)
e
βN T =
N −1/2 CN−d−1
(N Tb )−1/2 eb (Λ
Tb .
ζ

5.2

(5.5)

(5.6)

Two-Step Estimation Procedure

We recommend a two-step estimation procedure that uses as preliminary estimators in the
second step the shrinkage estimators from the first step. The two-step procedure improves
the finite sample performance through two channels. First, the tuning parameters are better
calibrated in the second step because the residual matrices in (5.6) are more accurate when
e and Γ
e are based on first-step shrinkage estimators. Second, a better preliminary estimator
Λ
e is obtained through a rotation of the factor loadings ΛR and ΨR . For i = 1 and 2, let
Γ
e (i) , Ψ
e (i) , and Γ
e(i) denote the preliminary estimators, Λ
b (i) , Ψ
b (i) and Γ
b(i) denote the PLS
Λ
b (i) , Ψ
b (i) and Γ
b(i) denote the PMS estimators in step i. The two-step
estimators, and Λ
P MS

P MS

P MS

estimation can be implemented with the following algorithm:
Algorithm 1 (Two-Step Estimation Procedure) Execute the following steps:
1. Construct the first-stage shrinkage estimator as follows:
e LS and Λ
e LS .
(a) Compute the unrestricted least squares estimators Λ
e (1) = Λ
e LS and Γ
e(1) = Γ
eLS . Calculate ω λ , ω γ , αN T and βN T following (3.4)
(b) Let Λ
`
`
(1)
(1)
e
e
e
e
and (5.6) with Λ = Λ and Γ = Γ .
b (1) and Γ
b(1) by minimizing the criterion func(c) Compute the shrinkage estimator Λ
tion (3.2).
b = Λ
b (1) and Γ
b = Λ
b (1) and call the
(d) Estimate ra and rb following (3.5) with Λ
(1)
(1)
(1)
(1)
e LS and Ψ(1)
estimators rba and rb . Let Λ denote the first rba columns of Λ
b

21
(1)

e LS . Following the definition of the PMS estimator
denote the first rbb columns of Ψ
in (3.9),

 (1)

 (1)
(1)
(1)
N ×k
b
b
and ΨP M S = Ψ , 0Ψ(1) ∈ RN ×k ,
ΛP M S = Λ , 0Λ(1) ∈ R
(1)

(5.7)

(1)

where 0Λ(1) is a N × (k − rba ) zero matrix and 0Ψ(1) is a N × (k − rbb ) zero matrix.
(1)

(e) If rbb

(1)

(1)

= rba , transform the columns of Ψ
(1)0

be the singular value decomposition of Λ

(1)0

as follows: Let Λ

(1)

Ψ

(1)

Ψ

= U DV

0

0

= U DV . Define the transformed

factor loading as
(1)

(1)

ΨR = Ψ Q,

(5.8)

where Q = V U 0 . Define the modified PMS estimator of Ψ as
 (1)

b (1)
Ψ
=
Ψ
,
0
∈ RN ×k ,
(1)
Ψ
R
P M S−R

(5.9)

b (1) with Ψ(1) replaced by Ψ(1)
which is a modification of Ψ
R .
P MS
2. Construct the second-stage shrinkage estimator as follows:
(a) Let
(
e (2) =
Λ

b (1) ,
Λ
P MS

e (2) =
Ψ

(1)
(1)
b (1)
Ψ
bb = rba
P M S−R if r
e(2) = Ψ
e (2) − Λ
e (2)
, Γ
(1)
(1)
b (1)
Ψ
if
r
b
>
r
b
a
P MS
b

(5.10)

e=Λ
e (2) and
and calculate ω`λ , ω`γ , αN T , and βN T following (3.4) and (5.6) with Λ
e=Γ
e(2) .
Γ
b (2) and Γ
b(2) by minimizing the criterion func(b) Compute the shrinkage estimators Λ
tion (3.2).
b=Λ
b (2) and Γ
b=Λ
b (2) .
(c) Estimate ra , rb , and S0 following (3.5)-(3.7) with Λ
The preliminary estimators in the second step are based on the PMS estimators of the
first step. The rotation in Step 1(e) minimizes the risk of falsely reporting a structural break
(1)

when there is no instability in the data. It is designed to match the column spaces of Λ
(1)
e if Γ0 = 0. Formally, the problem is to find an orthogonal
and Ψ . This leads to a smaller Γ
(1)

matrix Q such that ||Λ

(1)

− Ψ Q||2 is minimized. This is an orthogonal procrustes problem.
(1)

It is equivalent to maximizing the correlation between the columns of Λ

(1)

and Ψ Q (see

22
Section 2.3). The solution is Q = V U 0 (see Schönemann (1966)), where U and V are obtained
(1)0

from the singular value decomposition Λ

(1)

Ψ

= U DV 0 .

In the remainder of this subsection, we show that if there is indeed a type-1 instability,
R
the Q rotation will not eliminate the difference between ΛR
` and Ψ` . Moreover, we show

that the asymptotic theory we established in the previous section applies to the two-step
shrinkage estimator.

5.3

Large Sample Behavior of Two-Step Estimation Procedure

Under Assumption ID, Lemma 1(c) and Lemma 1(d) imply that, in the presence of a type-1
change, there exists a set of columns such that
2
−1
R 2
||ΨR
Z = {` : N −1 ||ΓR
` || = N
` − Λ` || ≥ C}.

(5.11)

The columns in the set Z are crucial for the identification of a type-1 instability. We now
state the following additional assumption:
2
Assumption R. If ra = rb , then inf kwk=1 N −1 ||ΨR w − ΛR
` || ≥ C for ` ∈ Z. 

Assumption R is not restrictive. It holds whenever ΛR
` is not in the column space generated by ΨR . Assumption R is imposed on the loadings ΛR of the normalized version of the
DGP rather than on the loadings Λ0 of the DGP itself. Assumption R allows the loadings
of some of the “structural” factors in the unnormalized DGP to remain constant while the
loadings of other “structural” factors change. In the absence of structural instabilities, Z is
empty and Assumption R is not necessary.
Using Assumption R, the model selection consistency established in Theorem 2 can be
extended to the two-step estimation procedure, as summarized in the following corollary:
e=Λ
e (2) and Γ
e=Γ
e(2) , then Theorem 2 holds under Assumptions A-D, ID,
Corollary 2 If Λ
R, and T.
Recall that Assumptions A-D, ID, and R are primitive conditions on the factor models.
The recommended tuning parameters αN T and βN T defined in (5.6) are constructed to ensure
that Assumption T is satisfied. As a result, one can continue to use the recommended
formulas of αN T and βN T throughout the two-step estimation procedure.

23

6

Model Selection with Unknown Break Date

We now extend the model selection procedure to study a potential one-time abrupt break
at an unknown time T0 , allowing for both type-1 and type-2 instabilities. Let π0 = T0 /T ,
where T is the number of periods in the sample. For simplicity, we call π0 , rather than T0 ,
the break date. We assume that the exact value of π0 is unknown, but it is known that
π0 ∈ Π, where Π is some closed subset in the interior of [0, 1].
For any π ∈ Π, we split the full sample into two subsamples Xa (π) = (X1 , ..., XTa )0 ∈
RTa ×N and Xb (π) = (XTa +1 , ..., XT )0 ∈ RTb ×N , where Ta = bT πc is the integer part of T π and
Tb = T − Ta . In Section 6.1, we study the consequences of misspecifying the break date and
present an identification condition for the unknown break date. To account for the unknown
break date, we slightly modify the penalty terms of the PLS estimator in Section 6.2. Finally,
we show in Section 6.3 that the consistency result of Theorem 2 extends to the case with an
unknown break date.

6.1

Identification of the Change Point

To obtain an identification condition for the unknown break date π0 , we now study the
number of factors in Xa (π) and Xb (π) when π 6= π0 . In a nutshell, if the break date is
misspecified, then one of the two subsamples contains one or more additional factors. Thus,
the break date can be identified by minimizing the number of estimated pre- and post-break
factors by varying π.
Consider the case of π < π0 . For the first subsample Xa (π), the DGP is the same as that
in (2.2), which can be written as
Xa (π) = Fa (π)Λ00 + ea (π), where
0
Fa (π) = F10 , . . . , FT0a ∈ RTa ×ra ,
ea (π) = (e1 , . . . , eTa )0 ∈ RTa ×N .

(6.1)

For the second subsample Xb (π), which includes observations for t = Ta + 1, . . . , T0 , . . . , T ,
the DGP corresponds to (2.2) for t ≤ T0 and to (2.3) for t > T0 . Thus, the DGP for Xb (π)

24
can be written as
Xb (π) = Fa+ (π)Λ00 + Fb (π)Ψ00 + eb (π), where
Fa+ (π) = (FT0a +1 , ..., FT00 , 0ra ×(T −T0 ) )0 ∈ RTb ×ra ,
0

0

Fb (π) = (0rb ×(T0 −Ta ) , F T0 +1 , ..., F T )0 ∈ RTb ×rb ,
eb (π) = (eTa +1 , ..., eT )0 ∈ RTb ×N .

(6.2)

Here the ra factors in Fa+ (π) with loadings Λ0 are only for observations before the true
break date, and the rb factors in Fb (π) with loadings Ψ0 are only for observations after the
true break. By construction, Fa+ (π) and Fb (π) are orthogonal to each other. By definition,
Fa (π0 ) = Fa , Fa+ (π0 ) = 0, and Fb (π0 ) = Fb . The DGPs in (6.1) and (6.2) reduce to (2.2)
and (2.3), respectively, if the break date is known.
We now replace Assumptions A and C with Assumptions A∗ and C∗ such that the weak
dependence and stationarity hold for any subsamples considered.
4

Assumption A∗ .

0

E kFt0 k ≤ C, E||F t ||4 ≤ C and there exist some positive definite
PbT πc 0 00
Ft Ft = πΣF + Op (T −1/2 ) for π ≤ π0 and
and ΣF such that T −1 t=1

matrices ΣF
P
0 00
T −1 Tt=bT πc+1 F t F t = (1 − π)ΣF + Op (T −1/2 ) for π ≥ π0 , where both Op (T −1/2 ) terms
are uniform over π ∈ Π. 

Assumption C∗ . Assumption C holds with ea and eb replaced by ea (π) and eb (π) and
Assumption C(vi) holds uniformly over π ∈ Π. 
Let ra (π) and rb (π) denote the number of factors in Xa (π) and Xb (π), respectively.
By definition, they are the number of nonvanishing eigenvalues of (N T )−1 Xa (π)0 Xa (π) and
(N T )−1 Xb (π)0 Xb (π), respectively, as N, T → ∞. Under Assumptions A∗ , B, C∗ , and D, the
DGP in (6.1) is a factor model with ra factors (i.e., ra (π) = ra for π ≤ π0 ). To study the
number of factors in (6.2) for the second subsample, note that
T −1 (Fa+ (π),Fb (π))0 (Fa+ (π),Fb (π)) →p Σ+
F (π),


0
N −1 Λ0 ,Ψ0 Λ0 ,Ψ0 →p Σ+
ΛΨ , where
"
#
(π
−
π)Σ
0
0
F
r
×r
a
b
Σ+
F (π) =
0rb ×ra
(1 − π0 )ΣF

(6.3)

+
and Σ+
ΛΨ is defined in (2.6). Because ΣF (π) has full rank by construction, the number
+
of factors in Xb (π) depends on the rank of Σ+
ΛΨ (i.e., rb (π) = rank(ΣΛΨ ) for π < π0 ). If

Λ0 = Ψ0 , we know that rank(Σ+
ΛΨ ) = rb . If, on the other hand, the column spaces generated

25
by Ψ0 and Λ0 do not overlap, we have rank(Σ+
ΛΨ ) = ra + rb . Typically, we would expect
the column spaces generated by Ψ0 and Λ0 to be overlapping but non-nested, which means
rank(Σ+
ΛΨ ) > rb ≥ ra and hence rb (π) > rb for π < π0 .
Now consider π > π0 . For the first subsample, we have ra (π) = rank(Σ+
ΛΨ ), which implies
ra (π) ≥ rb ≥ ra , while for the second subsample, we simply get rb (π) = rb . The following
lemma provides a summary:
Lemma 2 Suppose that Assumptions A∗ , B, C∗ , and D hold. Then,
(
(
ra
π ≤ π0
rank(Σ+
ΛΨ ) π < π0
ra (π) =
and
r
(π)
=
,
b
rank(Σ+
rb
π ≥ π0
ΛΨ ) π > π0

(6.4)

where rank(Σ+
ΛΨ ) ≥ rb ≥ ra .
It follows from Lemma 2 that

+


 ra + rank(ΣΛΨ ) π < π0
ra (π) + rb (π) =
r a + rb
π = π0 .


 r + rank(Σ+ ) π > π
b
0
ΛΨ

(6.5)

Because rank(Σ+
ΛΨ ) ≥ rb ≥ ra , we see that ra (π)+rb (π) is minimized at π0 , with the minimum
value ra + rb . Define the set of values π such that ra (π) + rb (π) achieve the smallest value
ra + rb as
D = {π ∈ Π : ra (π) + rb (π) = ra + rb }.

(6.6)

By definition, we know that π0 ∈ D and hence D is a well-defined nonempty set. If
0
rank(Σ+
ΛΨ ) > rb (which holds if the column space generated by Λ is not contained by

that generated by Ψ0 asymptotically), we can deduce that π0 is the unique minimizer. The
result is summarized in the following corollary:
Corollary 3 Suppose that Assumptions A∗ , B, C∗ , and D hold.
(a) If rank(Σ+
ΛΨ ) > rb , then π0 = D;
(b) If rank(Σ+
ΛΨ ) = rb > ra , then π0 = max {π : π ∈ D}.

26
If the structural break is due to the type-2 instability, Corollary 3 shows that the break
date π0 can always be identified by the maximum value in the set D. π0 can still be identified
under type-1 instability, provided that Assumption ID(i) holds. In that case, we have
rank(Σ+
ΛΨ ) > ra = rb ,

(6.7)

which combined with Corollary 3(a) implies that {π0 } = D. The only case in which D does
not identify π0 is if ra = rb and Λ0 and Ψ0 span the same column spaces. However, this
type-1 instability itself can still be identified as long as Assumption ID(ii) holds.

6.2

Estimation with Unknown Break Date

For any π ∈ Π, let Fea (π) ∈ RTa ×k be the orthonormalized eigenvectors of (N Ta )−1 Xa (π)Xa (π)0
associated with its first k largest eigenvalues. Similarly, let Feb ∈ RTb ×k be the orthonormalized left eigenvectors of (N Tb )−1 Xb (π)Xb (π)0 associated with its first k largest eigenvalues. We assume k ≥ ra + rb , the largest possible number of factors in any subsame LS (π) = T −1 Xa (π)0 Fea (π),
ple. The unrestricted estimators of the factor loadings are Λ
a

e LS (π) = T −1 Xb (π)0 Feb (π), and Γ
eLS (π) = Ψ
e LS (π) − Λ
e LS (π).
Ψ
b
By applying the procedure in Section 5 with π0 replaced by π, we obtain a shrinkage
estimator indexed by π ∈ Π, which yields consistent estimators of ra (π) and rb (π) for any
π ∈ Π. In our empirical application, we found that this simple procedure is undesirable
because the estimators of ra (π) and rb (π) are highly sensitive to π. To improve the finite
sample performance of the PLS estimation with an unknown break date, we propose an
averaging penalty. Based on this averaging penalty, the shrinkage estimator depends on π
only through the least square criterion function. Uniform convergence of the least square
criterion function over π ∈ Π follows from Assumptions A∗ and C∗ . In the remainder of this
subsection, we describe the construction of the averaging penalty.
The shrinkage estimator with an averaging penalty is obtained by minimizing a PLS
criterion function indexed by π:
b
b
(Λ(π),
Γ(π))
=

arg min
Λ∈RN ×k ,Γ∈RN ×k

[M (Λ, Γ; π) + P1∗ (Λ) + P2∗ (Γ)] ,

(6.8)

where
−1

M (Λ, Γ; π) = (N T )



0

Xa (π) − Fea (π)Λ

2

0

+ Xb (π) − Feb (π)(Λ + Γ)

2


.

(6.9)

27
The averaging penalty functions P1∗ (Λ) and P2∗ (Λ) are
P1∗ (Λ)

=

P2∗ (Γ) =

k
X
`=1
k
X

Eξ [αN T (ξ)ω`λ∗ (ξ)] kΛ` k ,
Eξ [βN T (ξ)ω`γ∗ (ξ)] kΓ` k ,

(6.10)

`=1

where ξ has a uniform distribution on Π and Eξ [·] denotes the expectation with respect to ξ.5
In practice, Π is approximated by a set of equally spaced grid points Πd , and the expectation
in (6.10) is replaced by an average. The tuning parameters αN T (π) and βN T (π) are
−1/2 −d−1
CN Tb ,
αN T (π) = κ1 (π)N −1/2 CN−d−1
Ta and βN T (π) = κ2 (π)N

(6.11)

where κ1 (π) ∈ [κ1 , κ1 ] and κ2 (π) ∈ [κ2 , κ2 ] for some κ1 , κ2 > 0 and κ1 , κ2 < ∞. They are
analogous to those in (5.1). In practice, we can choose κ1 (π) and κ2 (π) as in (5.6) but with
e and Γ
e replaced by Λ(π)
e
e
Λ
and Γ(π),
respectively.
e
e
e
For each π ∈ Π, let Λ(π),
Ψ(π),
and Γ(π)
be some preliminary estimators. We define
adaptive weights ω`λ∗ (π) and ω`γ∗ (π) as

−d
−1 e
2
e ` (π)||2 I e
+
N
||
Λ
(π)||
I
,
ω`λ∗ (π) = N −1 ||Λ
e ` (π)=0N ×1 }
`,LS
{Λ` (π)6=0N ×1 }
{Λ

−d
e` (π)||2 , ||Ψ
e ` (π)||2 }I e
ω`γ∗ (π) = N −1 min{||Γ
{Γ` (π)6=0N ×1 }

−d
e`,LS (π)||2 , ||Ψ
e `,LS (π)||2 }I e
+ N −1 min{||Γ
.
{Γ` (π)=0N ×1 }

(6.12)

Comparing the weights in (6.12) with those in (3.4), we see that ω`λ∗ (π0 ) = ω`λ but ω`γ∗ (π0 ) 6=
ω`γ . If the break date is unknown, it is crucial to use ω`γ∗ (π) for consistent estimation
e `,LS (π)||2 converges (in probability) to 0,
of rb because, for π > π0 and ` > rb , N −1 ||Ψ
e`,LS (π)||2 may not converge (in probability) to 0. Thus, the modified adaptive
but N −1 ||Γ
weights can deliver larger penalties, when needed. The modified weights can also be used if
e` (π0 )||2 and N −1 ||Ψ
e ` (π0 )||2 are either of the same
the break date is known, because N −1 ||Γ
order of magnitude or the former is smaller than the latter.
5

By definition,
Eξ [αN T (ξ)ω`λ (ξ)]

Z

π

=
π

αN T (ξ)ω`λ (ξ)

1
dξ and Eξ [βN T (ξ)ω`γ (ξ)] =
π−π

Z

π

π

βN T (ξ)ω`γ (ξ)

1
dξ,
π−π

where π and π are the lower and upper bounds of Π. Note that the above two terms depend on N and T .

28

6.3

Model Selection with Unknown Break Date

If the break date is unknown, the model selection for M0 is based on the zero and nonzero
b
b
columns in Λ(π)
and Γ(π)
for all π ∈ Π. First, we generalize the estimators rba and rbb in
(3.5) to
n
o
2
b
rba (π) = min Ja (π), where Ja (π) = j : ||Λ` (π)|| = 0 for all ` > j ,
n
o
b` (π)||2 = 0 for all ` > j . (6.13)
rbb (π) = max (min Jb , rba (π)) , where Jb (π) = j : ||Γ
With an unknown break date, the estimators of ra and rb are
rba∗ = min rba (π) and rbb∗ = min rbb (π).
π∈Π

(6.14)

π∈Π

The estimator of S0 is
(
b∗

S =

b
0 if supπ∈Π ||Γ(π)||
=0
1

otherwise

.

(6.15)

The selected model is
c∗ = (b
M
ra∗ , rbb∗ , Sb∗ ).

(6.16)

As in the known-break-date case, we consider a two-step procedure for model selection.
e (1) (π) = Λ
e LS (π), Ψ
e (1) (π) = Ψ
e LS (π), and
Follow the steps in Section 5.2 by setting π0 = π, Λ
e(1) (π) = Γ
eLS (π); replacing ω λ , ω γ , αN T , and βN T with ω λ∗ (π), ω γ∗ (π), αN T (π), and βN T (π),
Γ
`
`
`
`
respectively; replacing the PLS criterion (3.2) with (6.8); and replacing the estimators rba
(1)

(1)

and rbb in (3.5) with those in (6.14). Note that the first-step estimators rba and rbb

do not

vary with π following the definition in (6.14). Therefore, one should first obtain the firstb (1) (π) and Γ
b(1) (π) for each π ∈ Π and get rba(1) and rb(1) , and then obtain the
step estimator Λ
b

b (2) (π) and Γ
b(2) (π) for each π ∈ Π. The selected model M
c∗ is based
second-step estimator Λ
b (2) (π) and Γ
b(2) (π).
on the two-step PLS estimator Λ
To show the model selection consistency for the two-step PLS estimator described in the
previous subsection, we strengthen Assumption R to take into account the unknown break
date and the averaging penalty. For any π ∈ Π, we can write the normalized system as
Xa (π) = FaR (π)ΛR (π)0 + ea (π),
Xb (π) = FbR (π)ΨR (π)0 + eb (π),

(6.17)

where FaR (π) and ΛR (π) are Ta × ra (π) and N × ra (π) matrices, respectively, and FbR (π) and
ΨR (π) are Tb × rb (π) and N × rb (π) matrices, respectively.

29
2
Assumption R.∗ . (i) If ra = rb , then inf π∈Π inf kwk=1 N −1 ||ΨR (π)w − ΛR
` (π)|| ≥ C for

` ∈ Z;
R
2
(ii) If rb > ra , then inf π>π0 N −1 ||ΨR
` (π) − Λ` (π)|| ≥ C for ` = rb . 

Assumption R∗ (i) generalizes Assumption R from π = π0 to any π ∈ Π. Assumption
R∗ (ii) is not necessary if the break date π0 is known because ΛR
` (π0 ) = 0 for ` = rb > ra .
R
Similar to Assumption R, these assumptions are not restrictive because ΛR
` (π) and Ψ` (π)

are some specific matrices transformed from the structural factors. Assumptions R and R∗
are compatible in applications where the loadings of some structural factors change and some
do not.
Theorem 3 Suppose that Assumptions A∗ , B, C∗ , D, ID, and R∗ hold. Then the model
selection with an unknown break date is consistent:
c∗ = M0 ) → 1 as N, T → ∞.
Pr(M
The identification result in Section 6.1 is used constructively in the proof of Theorem 3.
Among all the models indexed by π, only the one with the smallest number of factors is not
over-penalized by the averaging penalty. Since the model with the true break date has the
smallest number of factors by Lemma 2, the PLS estimator with the averaging penalty can
consistently select the true model without knowing the break date.
The proof strategy of Theorem 3 is different from that of Theorem 2 due to the averaging
b ra (π) and Γ
bra (π) uniformly
penalty. Theorem 3 is proved by first showing the convergence of Λ
b ra (π) uniformly converges to a nonzero limit for all π ∈ Π, it
over π ∈ Π. Provided that Λ
follows that Pr(minπ∈Π rba (π) ≥ ra ) → 1. Because π0 ∈ Π and ra (π0 ) = ra by definition,
one can show that Pr(b
ra (π0 ) = ra ) → 1 as long as results like those in Theorem 1 hold
b 0 ). Combining the two results above, we immediately get Pr(minπ∈Π rba (π) = ra ) →
for Λ(π
bra (π) to show that Pr(minπ∈Π rbb (π) = rb ) → 1.
1. Similar arguments can be applied to Γ
b 0 ) for
After showing consistency of the estimators of the number of factors, we analyze Γ(π
b
consistent detection of type-1 instability, and show that Pr(Γ(π)
= 0) → 1 uniformly over
π ∈ Π when there are no structural instabilities.
The averaging penalty enables consistent estimation of ra and rb but does not yield
consistent estimation of rba (π) and rbb (π) for π 6= π0 . Therefore, the resulting shrinkage
estimation does not simultaneously produce a consistent estimator of the break date. In

30
practice, researchers tend to have a conjecture for the break date, which is denoted by πc ,
and used to center the set Π in the previous subsection. The shrinkage estimator can be
used to verify whether a conjecture break date πc is a consistent estimator of π0 . If the
data provide evidence against this conjecture, πc can be revised accordingly. We denote the
b denote the set of π ∈ Π at
revised break date by πrc , and it is defined as follows: Let D
which rba (π) + rbb (π) achieves its minimum, which typically is an interval in finite samples.
b Hence, if πc ∈ D,
b
Corollary 3 suggests that πc is a reasonable conjecture only if πc ∈ D.
we do not revise the conjectured break date and we define πrc = πc . On the other hand, if
b we choose πrc ∈ D
b such that |πrc − πc | = min b |π − πc |. However, this procedure
πc ∈
/ D,
π∈D

does not ensure that πrc is a consistent estimator of the break date.
Once the number of factors ra and rb have been consistently estimated by the shrinkage estimator, the classical least squares method in Bai (1997) can be applied to obtain a
consistent estimator of the break date. While without knowing the numbers of the pre- and
post-break factors, one can not consistently estimate the break date using the least squares
criterion, our model selection procedure provides a bridge linking the break-date estimation
with observed regressors with break-date estimation in latent factor models.

7

Monte Carlo Simulations

In this section, we conduct Monte Carlo simulations to illustrate the accuracy of the proposed
model selection procedure, and the mean squared errors (MSEs) of the shrinkage estimators
and the PMS estimators in finite samples. Section 7.1 describes the DGPs used in the
experiment. Section 7.2 discusses various estimators of the empirical factor models. The
simulation results are presented in Section 7.3.

7.1

Design

The design of the DGPs roughly follows that in Bates, Plagborg-Møller, Stock, and Watson
(2013), with the additional flexibility to accommodate both type-1 and type-2 instabilities

31
and the shift of focus from small breaks to large breaks. The DGP takes the form
Pre-break:

Xit = λ0i Ft + eit ,

Ft,` = ρa Ft−1,` + ηa ut,` ,

t = 1, . . . , bT π0 c,

` = 1, . . . , ra ,

Post-break: Xit = ψi0 F t + eit ,

F t,` = ρb F t−1,` + ηb ut,` ,

t = bT π0 c + 1, . . . , T,

(7.1)

` = 1, . . . , rb ,

where i = 1, . . . , N , Ft = (Ft,1 , . . . , Ft,ra )0 and F t = (F t,1 , . . . , F t,rb )0 . To model the temporal
and cross-sectional dependence of the idiosyncratic errors, we consider
eit = αeit−1 + vit , vt = (v1t , ..., vN t )0 ∼ N (0, Ω),

(7.2)

where the (i, j)-th element of Ω is β |i−j| . The processes {ut,` : ` = 1, ..., rb } and {vit } are
mutually independent and are i.i.d. across t with the standard normal distribution. The
initial values F0 and e0 = (e10 , ..., eN 0 )0 are drawn from their stationary distribution. When
0

rb = ra , F T0 = FT0 . When rb > ra , F T0 = (FT0 0 , FT∗0 )0 , where each element of FT∗0 is drawn independently from the distribution of Ft,` . The parameters {N, T, π0 , ra , rb , ρa , ρb , ηa , ηb , α, β}
are specified below.
The pre-break factor loadings {λi : i = 1, . . . , N } are independent across i and independent of the factors and the idiosyncratic errors. Let λi ∼ N (0, Σi ), where Σi is a diagonal
matrix with diagonal elements σi2 (1), . . . , σi2 (ra ). These diagonal elements are distinct to
ensure that Assumption ID holds, and their sum controls the population regression R2 of
Pa 2
σi (`) = σ ∗ (Ri2 ),
Xit on the factors. To this end, we set σi2 (`) = 0.9(`−1) σi2 (1) and r`=1
where the scalar σ ∗ (Ri2 ) is chosen such that E[(λ0i Ft )2 ]/E[Xit2 ] = Ri2 for t ≤ T0 and Ri2 is the
pre-specified regression R2 of the i-th series.6
We consider two different ways of choosing Ri2 for i = 1, . . . , N . One is the homogeneous
case of Ri2 = 0.5, which is considered in Bai and Ng (2002) to assess their information criteria
and the benchmark DGP in our simulations. Another is the heterogeneous case in which Ri2
is calibrated to match the distribution of R2 values in the data sets used in the empirical
applications. Taking the data set before December 2007, which is the conjectured break
date of the recent recession, we regress each time series variable on the principal component
estimators of five factors and obtain the empirical distribution of the regression R2 . We then
draw Ri2 for i = 1, . . . , N independently from this empirical distribution and use the realized
Ri2 to construct the pre-break factor loadings λi .
6


The choice is σ ∗ Ri2 =

Ri2
1−ρ2a
2 1−R2 .
(1−α2 )ηa
i

32
Depending on the type of the instabilities, we consider two different ways of constructing
the post-break factor loadings ψi . For a type-1 instability, we set ψi = (1 − w)λi + wλ∗i ,
where λ∗i and λi are independent and have the same distribution. We vary the scalar w
to control the size of the instability, with w = 0 corresponding to the special case of no
break in the factor loadings. For a type-2 instability, ψi is drawn independently of everything else with a distribution that is similar to that of λi , except that ra is changed to
rb , E[(ψi0 F t )2 ]/E[Xit2 ] = Ri2 for t > T0 , and the post-December 2007 subsample is used to
calibrate Ri2 in the heterogeneous R2 case.

7.2

Estimators

We have described the principal component estimators of the factors in the previous sections. The time series variables are normalized to have zero means and unit variances before
estimating these factors.7 We set the maximum number of factors k = 8 and standardize
the data before getting the principal component estimators. For the data-dependent weight,
we set d = 2.
For experiments with known break dates, model selection is based on the two-step PLS
estimator following the algorithm described in Section 5. To investigate the model selection
accuracy, we report the probability that the “true” model M0 = (ra , rb , S0 ) is selected, the
probabilities of rba = ra , ra − 1 and ra + 1, and the probabilities of rbb = rb , rb − 1 and rb + 1,
respectively. In addition, we report MSEs of four different estimators. The first two are the
PMS estimator and the PLS estimator described at the end of Section 3. Both of them switch
from a full-sample estimation to a subsample estimation only if a break is detected and the
number of factors before and after the break are obtained by the shrinkage estimation. In
contrast, the third estimator always uses the full sample, and the fourth estimator always
uses the post-break subsample. The last two estimators are standard principal component
estimators, where the number of factors is selected by the ICp2 information criterion of
Bai and Ng (2002). The third estimator coincides with the infeasible benchmark estimator
when there is no structural instability, and the fourth estimator coincides with the infeasible
benchmark estimator when there is a large change. For the convenience of comparison, the
MSE of the first estimator is normalized to be 1.
7

Without normalization, the idiosyncratic errors of each series have the same variance. When standard-

izing the variance of all series, those with low regression R2 receive more weight. Thus, in the present
simulation setup, the procedure performs much better without normalization in the heterogeneous R2 case.

33
For simulations in which the break date is not assumed to be known, the model selection
is based on the procedure described in Section 6.3, where Π is approximated by a discrete
set Πd . To make them similar to the empirical example investigated in Section 8, we conduct
simulations with the true break date at π0 = 0.8, and the regression R2 is calibrated. The
grid size in Πd is τ = 0.01, a shift by a quarter for a monthly data set of 300 periods, like the
data set in our empirical application. We consider Πd = {πc − 4τ, πc − 3τ, . . . , πc , . . . , πc +
3τ, πc + 4τ }, which spans a two-year interval and is symmetric around the conjectured break
date πc . We consider both the correct specification case in which πc = π0 = 0.8 and the
misspecification case in which πc = 0.78, which is half a year previous to the real break
date in the application. We report model selection probabilities and the MSEs of the four
estimators discussed above. To define a post-break subsample for the first two estimators,
the revised conjectured break date πrc is used because π0 is unknown. However, to define the
post-break subsample for the fourth estimator, we continue to use π0 because this estimator
serves as an infeasible benchmark when there is a large break. For all four estimators, the
reported MSEs are based on the subsample from the upper end of Πd to the end of the full
sample. This subsample ensures the availability of the post-break subsample estimator, no
matter where the break date is specified.

7.3

Monte Carlo Results

The Monte Carlo results are summarized in four tables. Tables 1 and 2 present results
when the break date is known and the regression R2 is homogenous across series. The break
date is in the middle of the sample in Table 1 (π0 = 0.5) and at the end of the sample in
Table 2 (π0 = 0.8). Table 3 also assumes the break date is known, but the regression R2 is
calibrated from the data set in the empirical application and thus is heterogeneous across
series. Table 4 allows the break date to be unknown, and the regression R2 is calibrated.
When the regression R2 is calibrated, we only conduct simulations with the true break date
at the end of the sample, because the potential break occurs around π = 0.8 in the data set of
our empirical application. Each table contains three panels, corresponding to no instability,
type-1 instability, and type-2 instability, respectively. For a type-1 instability, we consider
w = 0.2, 0.5 and 1 in the DGPs for the scenarios of small, medium, and large changes in the
factor loadings, respectively. For a type-2 instability, we consider the changes of the number
of factors from 1 to 2 and 3 to 4. Various values of N and T are considered. For each DGP,

34

Table 1: Known Break Date, Homogeneous R2 , π0 = 0.5
rba − ra

DGP Configuration
ra

rb

w

N

T

c
M

0

−1

rbb − rb
1

0

MSE

−1

1

PMS

PLS

Full

Sub

Panel A. No Change
3

3

100 100

0.77

(0.79 0.21 0.00)

(0.96 0.04

0.00)

1.00

1.07

0.83

1.35

3

3

150 150

0.99

(0.99 0.01 0.00)

(1.00 0.00

0.00)

1.00

1.01

0.99

1.59

3

3

200 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.01

1.00

1.60

Panel B. Type-1 Change
3

3

0.2

100 100

0.12

(0.88 0.12 0.00)

(0.94 0.06

0.00)

1.00

1.17

0.84

1.34

3

3

0.2

150 150

0.13

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.30

0.95

1.30

3

3

0.2

200 200

0.13

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.42

0.97

1.20

3

3

0.5

100 100

0.90

(0.90 0.10 0.00)

(0.94 0.06

0.00)

1.00

1.11

1.42

1.15

3

3

0.5

150 150

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.19

2.09

1.01

3

3

0.5

200 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.15

2.65

1.00

3

3

1.0

100 100

0.61

(0.61 0.38 0.00)

(0.99 0.01

0.00)

1.00

0.99

1.47

1.00

3

3

1.0

150 150

0.97

(0.97 0.03 0.00)

(1.00 0.00

0.00)

1.00

0.97

1.31

1.00

3

3

1.0

200 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.30

1.00

Panel C. Type-2 Change
1

2

100 100

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.15

1.00

1

2

150 150

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.13

1.00

1

2

200 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.13

1.00

3

4

100 100

0.23

(0.61 0.39 0.00)

(0.41 0.58

0.00)

1.00

1.11

1.39

0.81

3

4

150 150

0.90

(0.97 0.03 0.00)

(0.93 0.07

0.00)

1.00

1.22

1.24

0.95

3

4

200 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.13

1.23

1.00

Notes: Parameters α = β = 0.2, ρa = ρb = 0.5, ηa = ηb = 1, ζ = 1. The first five columns are parameters in
the DGPs. The next column is the probability that the true model is selected. The next six columns are the
probabilities rba = ra , ra − 1, ra + 1, and rbb = rb , rb − 1, rb + 1. The last four columns are MSE for the PMS
estimator, the PLS estimator, the full-sample estimator, and the post-break subsample estimator.

we report the model selection results and the MSEs of the four estimators introduced above.
All results are based on averages over 5,000 simulation repetitions.
Tables S-1 to S-4 in the Appendix contain supplemental results that serve as benchmarks
or for robustness checks. Table S-1 is similar to Table 1, but with i.i.d. idiosyncratic errors.
Table S-2 is similar to Table 2, but with a different constant ζ that is associated with larger
penalty. Table S-3 is similar to Tables 1 and 2, but the break is in the factor dynamics
instead of the loadings, which confirms our early discussion below Assumption ID. Table S-4
is similar to Table 4, but the conjectured break date is equal to the true break date instead

35

Table 2: Known Break Date, Homogeneous R2 , π0 = 0.8
rba − ra

DGP Configuration
ra

rb

w

N

T

c
M

0

−1

rbb − rb
1

0

MSE

−1

1

PMS

PLS

Full

Sub

Panel A. No Change
3

3

100 200

0.99

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.08

0.98

2.75

3

3

150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.02

1.00

2.72

3

3

200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.02

1.00

2.71

Panel B. Type 1 Change
3

3

0.2

100 200

0.12

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.52

0.88

1.84

3

3

0.2

150 300

0.11

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.75

0.93

1.46

3

3

0.2

200 400

0.13

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

2.04

0.96

1.24

3

3

0.5

100 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.20

1.68

1.18

3

3

0.5

150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.15

2.57

1.04

3

3

0.5

200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.09

3.46

1.00

3

3

1.0

100 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.95

2.83

1.01

3

3

1.0

150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.97

2.03

1.00

3

3

1.0

200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.39

1.00

Panel C. Type 2 Change
1

2

100 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.96

1.68

1.00

1

2

150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.97

1.18

1.00

1

2

200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.14

1.00

3

4

100 200

0.60

(1.00 0.00 0.00)

(0.60 0.40

0.00)

1.00

1.05

2.83

0.97

3

4

150 300

0.96

(1.00 0.00 0.00)

(0.96 0.04

0.00)

1.00

1.08

2.92

0.99

3

4

200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.03

2.24

1.00

Notes: Parameters α = β = 0.2, ρa = ρb = 0.5, ηa = ηb = 1, ζ = 4.

of being misspecified as in Table 4.
We now discuss the model selection and estimation results. First, Table 1 shows that our
procedure is quite accurate in estimating ra and rb if the break date is in the middle of the
sample, even if the number of periods in each subsample is as small as 75. To detect a type-1
instability, the method works well except when the magnitude of the break is as small as
w = 0.2. However, the MSE comparison shows that, with a small change of this magnitude,
the full-sample estimator yields the smallest MSE, and the PMS estimator benefits from
not detecting the break. In the same spirit, when the sample size is as small as 50 in each
subsample, our procedure sometimes favors a more parsimonious model by underestimating

36

Table 3: Known Break Date, Heterogeneous R2 , π0 = 0.8

rba − ra

DGP Configuration
ra

rb

w

N

T

c
M

0

−1

rbb − rb
1

0

−1

MSE
1

PMS

PLS

Full

Sub

Panel A. No Change
3

3

100 200

0.97 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

0.95

3.70

3

3

150 300

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

1.00

3.49

3

3

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

1.00

3.08

Panel B. Type-1 Change
3

3

0.2 100 200

0.11

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.02

0.78

2.66

3

3

0.2 150 300

0.01

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.04

0.98

3.12

3

3

0.2 200 400

0.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.01

1.00

2.55

3

3

0.5 100 200

0.98

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.97

0.70

0.99

3

3

0.5 150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.39

1.13

1.36

3

3

0.5 200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.57

1.50

1.39

3

3

1.0 100 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.85

2.63

1.39

3

3

1.0 150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.91

4.12

1.18

3

3

1.0 200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.93

4.74

1.03

Panel C. Type-2 Change
1

2

100 200

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.94

2.80

1.02

1

2

150 300

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.96

1.60

1.00

1

2

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.98

1.18

1.00

3

4

100 200

0.54 (1.00 0.00 0.00)

(0.54 0.46

0.00)

1.00

0.97

3.13

1.41

3

4

150 300

0.93 (1.00 0.00 0.00)

(0.93 0.07

0.00)

1.00

1.02

3.84

1.15

3

4

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.99

3.53

1.01

Notes: Parameters α = β = 0.2, ρa = ρb = 0.5, ηa = ηb = 1, ζ = 4.

of the number of factors. Results in Table 1 are for idiosyncratic errors with both temporal
and cross-sectional dependence and the default choice of the penalty with ζ = 1. If i.i.d.
idiosyncratic errors are considered in Table S-1, the procedure works quite well even if each
subsample only contains 50 periods and the break is small.
Second, if the break date is at the end of the sample, Table 2 shows a pattern similar
to that in Table 1. In particular, when the true model is not selected for a small break or
a small sample, the misspecified model typically yields a smaller MSE. Comparing Table 2
with Table S-2, it is clear that ζ = 4, which gives a smaller penalty than ζ = 1, is preferred

37

Table 4: Unknown Break Date, Heterogeneous R2 , π0 = 0.8

rba − ra

DGP Configuration
ra

rb

w

N

T

c
M

0

−1

rbb − rb
1

0

−1

MSE
1

PMS

PLS

Full

Sub

Panel A. No Change
3

3

100 200

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.01

1.00

3.90

3

3

150 300

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

1.00

3.49

3

3

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

1.00

3.08

Panel B. Type-1 Change
3

3

0.2 100 200

0.05

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.06

0.92

3.16

3

3

0.2 150 300

0.01

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.03

0.99

3.16

3

3

0.2 200 400

0.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.01

1.00

2.54

3

3

0.5 100 200

0.78

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.26

0.80

1.14

3

3

0.5 150 300

0.94

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.92

1.19

1.43

3

3

0.5 200 400

0.99

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

2.32

1.57

1.45

3

3

1.0 100 200

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.13

2.59

1.36

3

3

1.0 150 300

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.12

4.06

1.17

3

3

1.0 200 400

1.00

(1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.07

4.69

1.02

Panel C. Type-2 Change
1

2

100 200

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.93

2.78

1.01

1

2

150 300

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.95

1.58

1.00

1

2

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

0.97

1.18

1.00

3

4

100 200

0.39 (1.00 0.00 0.00)

(0.54 0.46

0.00)

1.00

0.98

3.00

1.36

3

4

150 300

0.86 (1.00 0.00 0.00)

(0.93 0.07

0.00)

1.00

1.04

3.71

1.11

3

4

200 400

1.00 (1.00 0.00 0.00)

(1.00 0.00

0.00)

1.00

1.00

3.50

1.00

Notes: Parameters α = β = 0.2, ρa = ρb = 0.5, ηa = ηb = 1, ζ = 4. The conjecture break date πc is
misspecified, πc = 0.78.

if the break date is moved from the middle of the sample to the end of the sample. This is
particularly important to detect a type-2 instability, because the new factors are only in the
post-break subsample, which has a small sample size. If there is no structural break or if
there is a type-1 instability, model selection results are more robust to the choice of ζ.
Third, Table 3 and Table 4 show that heterogeneous regression R2 and unknown break
date make the model selection procedure less accurate than that in Table 2, but it still
works quite well in general. In all cases, ra can be accurately estimated, even if the postbreak subsample is as small as 40. In a factor model with type-2 instability, rb might be

38
underestimated if the post-break subsample is 40, but this underestimation issue is minor if
the size of the post-break subsample is larger than 80. As in other cases, type-1 instability
can be detected except when w = 0.2. Table 4 and Table S-4 suggest that the results are
similar with different specifications of the conjectured break date.
Finally, the PMS estimator (the first column) switches between the full-sample estimator
(the third column) and the post-break subsample estimator (the fourth column) and when
evaluated by its MSE, the PMS estimator may have better finite sample performances than
the other two estimators in some scenarios. For example, in Panel B of Table 1 with w = 0.5,
N = 100, and T = 100, the MSEs of the full-sample estimator and the post-break subsample
estimator, respectively, are 42% and 15% larger than that of the PMS estimator. The PLS
estimator (second column) may have a smaller MSE than the PMS estimator. This could
happen for a type-1 instability with a large w or a type-2 instability where the factor loadings
of the new factors are large. On the other hand, when the shrinkage causes much more bias
than desired, the PLS estimator can be worse than the PMS estimator.

8

Structural Changes During the Great Recession

Unlike in other post-war recessions, the disruption of borrowing and lending played an important role in the 2007-2009 recession. Narratives emphasize a collapse of the U.S. housing
market; massive devaluations of mortgage-backed securities that spilled over to other asset
markets and ultimately led to a large-scale disruption of financial intermediation; a drop in
real activity caused by the crisis in the financial sector; and an extended period of zero nominal interest rates in combination with unconventional monetary policy interventions. We use
the shrinkage methods developed in the preceding sections to investigate the stability of factor loadings and the emergence of new factors. Section 8.1 describes the data set. Estimates
of the number of pre-2007 and post-2007 factors are presented in Section 8.2. Finally, we
make some identification assumptions and provide an interpretation of the estimated factors
in Section 8.3.

8.1

Data Set

The data set used for the empirical analysis is based on Stock and Watson (2012), who
compiled a set of 200 macroeconomic and financial indicators. These 200 series contain both

39

Table 5: Categories of Time Series
Symbol

Description

Series

NIPA

National Income and Product Accounts

5

IP

Industrial Production

9

Emp

Employment and Unemployment

HSS

Housing Starts

6

Ord

Orders, Inventories, and Sales

7

Pri

Productivity

IntL

Interest Rates (Level)

2

IntS

Interest Rates (Spread)

7

Mon

Money and Credit

5

StPr

Stock Prices and Wealth

3

ExR

Exchange Rates

5

Others

Consumer Expectation

1

30

22

high-level aggregates and disaggregated components. To avoid double counting, Stock and
Watson retained 132 of the 200 series, and we refer to the resulting data set as SW132. Using
SW132 as starting point, our data set is constructed as follows: (i) We extend the series in
the SW132 data set to 2012:M12, using May 2013 data vintages. (ii) We replace the quarterly
series in SW132 by their monthly counterparts, if available. This is possible for consumption
of nondurables, services, and durables; for nonresidential investment; and for 16 price series.
We remove the remaining quarterly series for which no monthly observations are available.
(iii) We add two GDP components that are available at monthly frequency: change in private
inventory and wage and salary disbursements. (iv) Following Stock and Watson (2012), we
remove local means from all series using a biweight kernel with a bandwidth of 100 months.
The local means are approximately the same as the ones obtained by a centered moving
average of ±70 months. After making these modifications, our data set consists of N = 102
series of monthly macroeconomic and financial indicators, which are grouped into the 12
categories listed in Table 5. The sample begins after the Great Moderation and ranges from
1985:M1 to 2013:M1 (T = 337).

40

Table 6: Model Selection, Tc is 2007:12
Penalty
Scaling ζ

Interval

Estimates
Break Trc

r̂a

b l k2
(r̂b − r̂a ) kΓ

Panel A. Known Break Date
1

N/A

2007:M12

1

1

3.66

4

N/A

2007:M12

4

1

5.02

6

N/A

2007:M12

6

0

5.52

Panel B. Unknown Break Date
1

Tc ± 6

2007:M12

1

1

12.98

1

Tc ± 12

2007:M12

1

1

15.38

4

Tc ± 6

2007:M12

3

0

19.20

4

Tc ± 12

2007:M3

3

0

24.31

6

Tc ± 6

2007:M6

5

1

19.86

6

Tc ± 12

2007:M5

5

1

25.19

Notes: The PLS estimator uses the averaging penalty functions P1∗ (Λ) and P2∗ (Λ) defined in (6.10) where
the average is taken over the interval specified in the second column of this table.

8.2

The Number of Factors Before and After 2007:M12

The empirical analysis is based on the two-step estimation procedure described in Section 5.2.
The starting point is a conjectured break date Tc = 2007:M12, which is the beginning of the
Great Recession, according to the business cycle dating of the National Bureau of Economic
Research (NBER). We use the extensions described in Section 6 to account for the fact that
the “true” break date is unknown. Throughout the empirical analysis, we fix the number
of potential factors to k = 8, and we set the constant that controls the rate of decay (as a
function of the sample size) of the penalty term to d = 2, as we did for the Monte Carlo
analysis in Section 7. To document the sensitivity of the empirical results to the magnitude
of the penalty terms P1 (Λ) and P2 (Λ) (or P1∗ (Λ) and P2∗ (Λ) for the case of unknown break
point), we vary the scaling constant ζ that appears in the definition of the penalty weights
αN T and βN T in (5.6).
The model selection results are summarized in Table 6 for different choices of the penalty
scaling factor ζ. We distinguish the case of treating the break date as known (Panel A)
from the case of an unknown break date (Panel B). Following the procedure described in

41
Section 6.3, we consider break dates Ta over the range Tc ± τ̄ , where τ̄ is either six or 12
months, and generate estimates of r̂a (Ta /T ) and r̂b (Tb /T ), keeping the overall sample size
T = Ta + Tb fixed. If r̂a (Ta /T ) + r̂b (Tb /T ) achieves its minimum at Tc then we do not revise
the conjectured break date. If the minimum is achieved elsewhere in the interval Tc ± τ̄ , we
use the date closest to the conjectured break date at which the minimum is achieved. For
ζ = 1, the conjectured break date is not revised, whereas for larger values of ζ, in particular
ζ = 6, the break date is shifted several months backward in time to the first half of 2007.
We subsequently focus on the case of an unknown break date. The estimates of the
number of factors is robust to the choice of τ̄ ∈ {6, 12}. The overall number of factors is
increasing in the scaling factor ζ, because the larger ζ the smaller the penalty for nonzero
coefficients. By choosing different values for ζ, we are essentially setting different thresholds
for the increase in goodness-of-fit that an additional factor must generate to justify its
inclusion. For the pre-2007 sample, the number of factors ranges from r̂a = 1 for ζ = 1
to r̂a = 5 for ζ = 6. For comparison, we also estimated the number of pre-break factors
using the Bai and Ng (2002) criteria: IC1 and IC2 deliver the estimate r̃a = 1, whereas IC3
generates either r̃a = 6 (sample ending in 2007:M5 or 2007:M6) or r̃a = 7 (sample ending in
2007:M3 or 2007:M12).
While the estimation of the overall number of factors is fairly sensitive to the choice of
ζ, the estimate of the change in the number of factors, r̂b − r̂a is quite stable. For ζ = 1
and ζ = 6, we detect a type-2 instability and find that the number of factors post-2007 has
increased by one. For ζ = 4, our procedure detects a type-1 instability, meaning that the
loadings change but the estimated number of factors stays constant.
Using the estimates for ζ = 6 and Tc ± 12, we now decompose the effect of the structural
change into the effect of the change in loadings on the old factors and the effect of the new
factor. The decomposition is based on (2.14). As a baseline, we compute R2 values for
0

RΩ R
RΩ
R 0
each individual series based on the variation explained by Fb,1
Λ + Fb,1
(ΨRΩ
1 − Λ ) (new
0

RΩ R
loadings only). We compare the baseline R2 s to R2 s associated with Fb,1
Λ (old loadings)

and R2 s associated with all three terms in (2.14) (i.e., new loadings and factor). The results
are plotted in Figure 1. Bars below the zero baseline indicate the R2 loss due to ignoring
the change in loadings. Bars above the zero line indicate the R2 gain from also accounting
for the effect of the new factor. Each set of bars corresponds to an individual series, and the
vertical lines delimit the time series categories listed in Table 5.

42

Figure 1: R2 Gains from New Loadings and Factor: (r̂1 , r̂2 ) = (5, 6)

Notes: Base line case new loadings only. Dark bars (above zero) indicate R2 gain due to new factor relative
to new loadings only. Light grey bars (below zero) indicate R2 losses from using the old loading matrices.
The procedure with ζ = 6 and interval 2007 : M 12 ± 12 selects the break date 2007:M5.

Two observations stand out. First, our estimates attribute most of the structural change
to a change in the loadings of the existing factors, in the sense that the contribution of
0

R 0
2
RΩ RΩ
RΩ
(ΨRΩ
Fb,1
1 − Λ ) to the overall R exceeds the contribution of Fb,2 Ψ2 . This is consistent

with the fact that for ζ = 4, our estimate of the change in the number of factors is equal
to zero. The effect of the loadings change dominates. Second, the new factor mainly affects
financial variables, namely those series in the two interest rate categories (IntL, IntS), the
money and credit group (Mon), and the stock price and wealth group (StPr). While there
are some spillovers to the real side (i.e., industrial production (IP), employment (EMP), and
housing starts (HSS) variables), these spillovers are relatively small and affect only a fraction
of the series.
Figure 2 depicts the fitted time path of four series: the spread between commercial paper
and Treasury bills, housing starts in the southern Census district, capital utilization, and
employment in durable goods manufacturing. We overlay the actual sample paths with three
(in-sample) predicted paths, which, as before, we refer to as old loadings, new loadings only,
new loadings and factor. The spread starts to rise toward the end of 2007. This rise is not
captured by the path predicted under the pre-break loadings, which stays fairly constant

43

Figure 2: In-sample Prediction: Individual series

Spread (CP-Tbill)

Housing Starts (South)

Capital Utilization (Total)

Employment (Durable Goods)

Notes: Gray line: actual; black dashed: old loadings; thick dashed red: new loadings only; thick blue: new
loadings and factor. Break date is 2007:M5 and (r1 , r2 ) = (5, 6). Our procedure with ζ = 6 and interval
2007M 12 ± 12 selects (r1 , r2 , dates) = (5, 6, 2007:M5).

throughout 2008. As suggested by Figure 1, the discrepancy between the old loadings and
the new loadings only paths is substantial during the Great Recession period. Once the
loadings are allowed to change, the predicted spread rises drastically throughout 2008, and
even more so once the new factor is accounted for. Capital utilization and employment drop
drastically in the second half of 2008 and only start recovering in 2010. The old loadings
path is unable to capture the large drop in real activity. With the new loadings only, on the
other hand, the model is able to track both capital utilization and employment quite well

44
during and after the recession, and the additional factor has not altered the predicted paths
of these series. However, there are real series that show a noticeable effect of the new factor,
one of them being the housing starts series in the top right panel of Figure 2.
At first glance, the results in Figure 2 look very different from those presented in Figure 2
of Stock and Watson (2012). Part of the discrepancy is due to the different normalization
schemes. We are normalizing the variance of the factors to one, whereas Stock and Watson
(2012) normalized the length of the loading vectors to one (i.e., Λ0 Λ/N = Ir ). To be able to
explain the macroeconomic dynamics during and after the Great Recession with factors that
have unit variance, a big change in the loadings is required. This is evident from our Figures 1
and 2. If we normalize the length of the loadings before and after the break to one, then the
increase in the volatility after 2007 is absorbed in an increase in the factor volatility. The
ratio of pre- to post-break factor variance under this alternative normalization ranges from
1.26 to 1.93 for the five factors that were active prior to the break. Stock and Watson (2012)
interpret this phenomenon as an unchanged response to “old” factors combined with large
innovations to the “old” factors in the post-2007 sample. In the absence of the emergence
of a new factor, we would interpret this phenomenon as a type-1 instability of the factor
model.
To summarize, our model selection procedure provides strong evidence that the loadings
in the normalized factor model changed drastically, generally implying a stronger comovement of the series after 2007. There is also some evidence of the emergence of a new factor,
which to a large extent seems to capture important co-movements among financial series but
also spills over into the real activity variables. While the estimate of the total number of
factors is sensitive to the scaling of the penalty terms in the objective function of the PLS
estimator, the estimate of the number of new factors, which is either one or zero, is much
more robust to the tuning of the penalty terms.

8.3

Interpreting the Old and New Factors

Previously, our analysis focused on determining the number of factors pre- and post 2007:M12
and the type of the structural instability. Moreover, for the detected type-2 structural
changes we decomposed the overall break effect into the contribution of breaks in the loadings and the emergence of a new factor. Due to the normalization imposed on the DGP,
the estimated pre- and post-break factors have identity covariance matrices and no specific

45
economic interpretation. We will now use a nonsingular ra × ra matrix B (rb × rb matrix
B) to transform the estimated pre-break factors F̃a (post-break factors F̃b ) into factors Fe†
a

(Feb† ) that resemble the first principal components of the variable groups listed in Table 5
and therefore can be interpreted as NIPA, IP, EMP, etc.8
To simplify the notation, we drop the “hats” and “tildes” from matrices associated with
sample estimates. Without loss of generality, we assume that the columns of Xa are arranged
according to the J = 11 categories listed in Table 5, such that we can partition Xa =
[Xa,1 , . . . , Xa,J ], where Xa,j contains the series associated with the j’th category of variables,
e.g., Xa,1 comprises the five NIPA series. For each Xa,j we calculate the first principal
component, denoted by the T × 1 vector xa,j , which can be interpreted as a group-specific
factor. We then project each group-specific factor on the space spanned by Fa :
ξa,j = Fa Bj + resid,

j = 1, . . . , J

(8.1)

and refer to the T × 1 vector of predicted values Fa B̂j as the NIPA factor for j = 1, the IP
factor for j = 2, and so forth. For each regression j in (8.1), we compute the associated R2
and then select the ra categories that deliver the highest R2 values. The associated coefficient
estimates are B̂(1) , . . . , B̂(ra ) , where each B̂(j) is a ra × 1 vector. In turn, we define
B = (B̂(1) , . . . , B̂(ra ) ),

Fa† = Fa B,

0

and Λ† = B −1 Λ0 .

(8.2)

The transformed factors are labeled according to the associated ξa,(j) vectors.
For the post-break period, we have a T × rb matrix of estimated factors Fb , which we will
now transform into a set of economically interpretable factors Fb† = Fb C using a nonsingular
rb × rb matrix C. First, we extend the transformed pre-break factors Fa† into the post-break
period. Note that Fa† consists of linear combinations of Xa , say, Fa† = Xa Υ†a . Thus, we can
†
†
define Fb|a
= Xb Υ†a . The extended factors Fb|a
need not fall into the space spanned by the

post-break factors Fb . Thus, we project the extended factors on the space spanned by Fb
using the following regression:
†
Fb|a
= Fb C0 + resid.

(8.3)

Here the matrix C0 is of dimension rb × ra . If rb > ra , we proceed by computing post-break
group-specific factors ξb,j based on the first principal components. Focusing on the variable
8

An alternative method of constructing interpretable factors is developed in Dobrev and Schaumburg

(2013).

46

Table 7: Rotated Factors, Unknown Break Date, Tc is 2007:12
Penalty

Pre-Break Factors

Scaling ζ

Interval

F1

1

Tc ± 12

Emp

6

Tc ± 12

Emp

F2

F3

F4

New Post-Break
F1∗

F5

IntS
IP

IntS

ExR

Pri

Mon

groups j that were not used in the construction of the rotated pre-break factors, we estimate
ξb,j = Fb Cj + resid

(8.4)

and compute the R2 associated with this regression. Let (ra + 1), . . . , (rb ) denote the indices
that generate the highest R2 values. We define the post-break transformation and the
associated transformed factors and loadings as
C = (Ĉ0 , Ĉ(ra +1) , . . . , Ĉ(rb ) ),

Fb† = Fb C,

0

and Ψ† = C −1 Ψ0 .

(8.5)

Table 7 summarizes the labels for the transformed pre-break factors and the additional
post-break factors for the two choices of ζ under which a new factor was detected. Since
the results were identical for Tc ± 6 and Tc ± 12, we only report the latter. For ζ = 1,
we identify the pre-break factor as an employment factor. By assumption, the employment
factor continues to be active from 2008:M1 onward but a second factor, namely an interest
rate spread factor, emerges. This is consistent with the narrative of a financial crisis in which
drastic increases in spreads coincide with substantial drops in real activity.
For ζ = 6, our identification scheme labels the five pre-break factors as employment,
industrial production, interest rates, exchange rates, and prices. We verified that the transformed factors track the group-specific factors well. For the categories employment, industrial
production, and money and credit, the correlation with the group-specific factors is above
0.9. The new post-break factor is money and credit, which is also broadly consistent with
the narrative of the Great Recession. Overall, our analysis suggests that one can construct
a plausible identification scheme for the factors under which the new factor that emerged
during the Great Recession can be broadly interpreted as a financial factor. This conclusion
is consistent with the findings in Figure 1, in which the financial variables are associated
with the largest R2 gains from the new factor.

47

9

Conclusion

We develop a shrinkage estimation procedure for high-dimensional factor models that generates consistent estimates of the number of pre- and post-break factors. In situations in
which the number of factors is constant throughout the sample, the procedure can consistently detect changes in the matrix of factor loadings. Our model selection procedure
remains consistent even if the break date is unknown; however, it does not generate a consistent estimate of the break date itself. Nevertheless, once the number of pre- and post-break
factors is known, conventional methods can be used to estimate the break date consistently.
Our Monte Carlo analysis shows that the procedure has good finite sample properties. In
an application to U.S. data, we show that the procedure detects an increase in the number of factors for a large macroeconomic and financial data set at the onset of the Great
Recession. After imposing some identification conditions, we show that the new factor can
be interpreted as a financial factor, which is consistent with the narratives of the 2007-2009
recession.

References
Ahn, S. C., and A. R. Horenstein (2013): “Eigenvalue Ratio Test for the Number of
Factors,” Econometrica, 81(3), 1203–1227.
Alessi, L., M. Barigozzi, and M. Capasso (2010): “Improved Penalization for Determining the Number of Factors in Approximate Factor Models,” Statistics & Probability
Letters, 80(23-24), 1806–1813.
Amengual, D., and M. W. Watson (2007): “Consistent Estimation of the Number of
Dynamic Factors in a Large N and T Panel,” Journal of Business & Economic Statistics,
25(1), 91–96.
Bai, J. (1997): “Estimation of a Change Point in Multiple Regression Models,” Review of
Economics and Statistics, 79(4), 551–563.
(2003): “Inferential Theory for Factor Models of Large Dimensions,” Econometrica,
71(1), 135–171.

48
Bai, J., and Y. Liao (2012): “Efficient Estimation of Approximate Factor Models via
Regularized Maximum Likelihood,” Manuscript, Columbia University and University of
Maryland.
Bai, J., and S. Ng (2002): “Determining the Number of Factors in Approximate Factor
Models,” Econometrica, 70(1), 191–221.
(2007): “Determining the Number of Primitive Shocks in Factor Models,” Journal
of Business & Economic Statistics, 25, 52–60.
(2013): “Principal Components Estimation and Identification of Static Factors,”
Journal of Econometrics, 176(1), 18–29.
Bates, B. J., M. Plagborg-Møller, J. H. Stock, and M. W. Watson (2013):
“Consistent Factor Estimation in Dynamic Factor Models with Structural Instability,”
Journal of Econometrics, 177(2), 289–304.
Breitung, J., and S. Eickmeier (2011): “Testing for Structural Breaks in Dynamic
Factor Models,” Journal of Econometrics, 163(1), 71–84.
Breitung, J., and U. Pigorsch (2013): “A Canonical Correlation Approach for Selecting
the Number of Dynamic Factors,” Oxford Bulletin of Economics and Statistics, 75(1), 23–
36.
Bühlmann, P., and S. van de Geer (2011): Statistics for High-Dimensional Data:
Methods, Theory and Applications. New York: Springer.
Caner, M., and X. Han (2012): “Selecting the Correct Number of Factors in Approximate
Factor Models: The Large Panel Case with Group Bridge Estimators,” Manuscript, North
Carolina State University.
Chen, L., J. J. Dolado, and J. Gonzalo (2011): “Detecting Big Structural Breaks in
Large Factor Models,” Manuscript, Universidad Carlos III de Madrid.
Choi, I. (2013): “Model Selection for Factor Analysis: Some New Criteria and Performance
Comparisons,” Working Paper, Sogang University Research Institute for Market Economy,
1209(1209).
Cliff, N. (1966): “Orthogonal Rotation to Congruence,” Psychometrika, 31(1), 33–42.

49
Corradi, V., and N. Swanson (2013): “Testing for Structural Stability of Factor Augmented Forecasting Models,” Journal of Econometrics, forthcoming.
Dobrev, D., and E. Schaumburg (2013): “Robust Forecasting by Regularization,”
Manuscript, Board of Governors of the Federal Reserve System and Federal Reserve Bank
of New York.
Forni, M., M. Hallin, M. Lippi, and L. Reichlin (2000): “The Generalized Dynamic
Factor Model: Identification and Estimation,” Review of Economics and Statistics, 82(4),
540–554.
Hallin, M., and R. Lika (2007): “Determining the Number of Factors in the General
Dynamic Factor Model,” Journal of the American Statistical Association, 102(478), 603–
617.
Han, X., and A. Inoue (2011): “Tests for Parameter Instability in Dynamic Factor Models,” Manuscript, North Carolina State University.
Kapetanios, G. (2010): “A Testing Procedure for Determining the Number of Factors
in Approximate Factor Models With Large Datasets,” Journal of Business & Economic
Statistics, 28(3), 397–409.
Lee, S., M. H. Seo, and Y. Shin (2012): “The Lasso for High-Dimensional Regression
with a Possible Change-Point,” ArXiv e-prints http://arxiv.org/abs/12094875.
Lu, X., and L. Su (2013): “Shrinkage Estimation of Dynamic Panel Data Models with
Interactive Fixed Effects,” Manuscript, Hong Kong University of Science & Technology
and Singapore Management University.
Onatski, A. (2009): “Testing Hypotheses About the Number of Factors in Large Factor
Models,” Econometrica, 77(5), 1447–1479.
(2010): “Determining the Number of Factors from Empirical Distribution of Eigenvalues,” Review of Economics and Statistics, 92(4), 1004–1016.
(2012): “Asymptotics of the Principal Components Estimator of Large Factor
Models with Weakly Influential Factors,” Journal of Econometrics, 168(2), 244–258.

50
Qian, J., and L. Su (2013): “Shrinkage Estimation of Regression Models with Multiple
Structural Change,” Manuscript, Shanghai Jiao Tong University and Singapore Management University.
Schönemann, P. (1966): “A Generalized Solution of the Orthogonal Procrustes Problem,”
Psychometrika, 31(1), 1–10.
Stock, J. H., and W. M. Watson (2002): “Forecasting Using Principal Components
From a Large Number of Predictors,” Journal of the American Statistical Association,
97(460), 1167–1179.
(2009): “Forecasting in Dynamic Factor Models Subject to Structural Instability,”
in The Methodology and Practice of Econometrics: Festschrift in Honor of D.F. Hendry,
ed. by N. Shephard, and J. Castle, pp. 1–57. Oxford University Press.
(2012): “Disentangling the Channels of the 2007-09 Recession,” Brookings Papers
on Economic Activity, pp. 81–156.
Tibshirani, R. (1994): “Regression Shrinkage and Selection Via the Lasso,” Journal of the
Royal Statistical Society, Series B: Statistical Methodology, 58(1), 267–288.
Yuan, M., and Y. Lin (2006): “Model selection and estimation in regression with grouped
variables,” Journal of the Royal Statistical Society, Series B: Statistical Methodology, 68(1),
49–67.
Zou, H. (2006): “The Adaptive Lasso and Its Oracle Properties,” Journal of the American
Statistical Association, 101(476), 1418–1429.

