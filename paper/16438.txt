NBER WORKING PAPER SERIES

ESTIMATING DYNAMIC DISCRETE CHOICE MODELS WITH HYPERBOLIC
DISCOUNTING, WITH AN APPLICATION TO MAMMOGRAPHY DECISIONS
Hanming Fang
Yang Wang
Working Paper 16438
http://www.nber.org/papers/w16438

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
October 2010

We would like to thank Peter Arcidiacono, Patrick Bayer, Han Hong, Joe Hotz, Edward Kung, Thierry
Magnac, Aprajit Mahajan, Ted O'Donoghue, Dan Silverman, Frank Sloan, Xun Tang and seminar/conference
participants at Cornell, AEA Meetings in San Francisco (2009) and Midwest Health Economics Conference
in Chicago (2010) for helpful comments and suggestions. The first draft of the paper (January 2009)
was completed when both authors were at Duke University. Fang gratefully acknowledges financial
support from NSF Grant SES 0844845. We are responsible for all remaining errors. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2010 by Hanming Fang and Yang Wang. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice,
is given to the source.

Estimating Dynamic Discrete Choice Models with Hyperbolic Discounting, with an Application
to Mammography Decisions
Hanming Fang and Yang Wang
NBER Working Paper No. 16438
October 2010
JEL No. C14,I1
ABSTRACT
We extend the semi-parametric estimation method for dynamic discrete choice models using Hotz
and Miller's (1993) conditional choice probability (CCP) approach to the setting where individuals
may have hyperbolic discounting time preferences and may be naive about their time inconsistency.
We illustrate the proposed estimation method with an empirical application of adult women's decisions
to undertake mammography to evaluate the importance of present bias and naivety in the under-utilization
of this preventive health care. Our results show evidence for both present bias and naivety.

Hanming Fang
Department of Economics
University of Pennsylvania
3718 Locust Walk
Philadelphia, PA 19104
and NBER
hanming.fang@econ.upenn.edu
Yang Wang
Department of Economics
Lafayette College
213 Simon Center
Easton, PA 18042
wangy@lafayette.edu

1

Introduction
Dynamic discrete choice models have been used to understand a wide range of economic be-

havior. The early dynamic discrete choice models that are empirically implemented tend to be
parametric;1 but recently, a growing list of authors have addressed the non- or semi-parametric
identification of dynamic discrete choice models. The earliest attempt in this regard is Hotz and
Miller (1993) which pioneered the approach of using conditional choice probabilities to infer about
choice-specific continuation values. Rust (1994a, 1994b) showed that the discount factor in standard dynamic discrete choice models are generically not identified; Magnac and Thesmar (2002)
expanded Rustâ€™s non-identification results, and proposed exclusion restrictions that lead to the
identification of the standard discount factor.
All of the above-mentioned literature model the impatience of the decision makers by assuming that agents discount future streams of utility or profits exponentially over time. As is now well
known, exponential discounting is not just an analytically convenient assumption; without this
assumption, intertemporal marginal rates of substitution will change as time passes, and preferences will be time-inconsistent [see Strotz (1956, p.172)]. A recent theoretical literature has built
on the work of Strotz (1956) and others to explore the consequences of relaxing the standard assumption of exponential discounting. Drawing both on experimental research and on common
intuition, economists have built models of quasi-hyperbolic discounting to capture the tendency
of decision makers to seize short-term rewards at the expense of long-term preferences.2 This literature studies the implications of time-inconsistent preferences, and their associated problems of
self-control, for a variety of economic choices and environments.3
A small list of empirical papers that attempted to estimate dynamic models with hyperbolic
discounting time preferences have followed the parametric approach (Fang and Silverman 2009,
Laibson, Repetto and Tobacman 2007 and Paserman 2008).4 Fang and Silverman (2009) empiri1
The earliest formulation and estimation of parametric dynamic discrete choice models include Wolpin (1984) for
fertility choice, Miller (1984) for occupational choice, Pakes (1986) for patent renewal, and Rust (1987) for bus engine
replacement.
2
A body of experimental research, reviewed in Ainslie (1992) and Loewenstein and Elster (1992), indicates that
hyperbolic time discounting may parsimoniously explain some basic features of the intertemporal decision making
that are inconsistent with simple models with exponential discounting. Specifically, standard decision models with
exponential discounting are not easy to reconcile with commonly observed preference reversals: subjects choose the
larger and later of two prizes when both are distant in time, but prefer the smaller but earlier one as both prizes draw
nearer to the present (see Rubinstein 2003, however, for an alternative explanation of preference reversals).
3
For example, models of time-inconsistent preferences have been applied by Laibson (1997) and Oâ€™Donoghue and
Rabin (1999a,b) to consumption and savings; by Barro (1999) to growth; by Gruber and Koszegi (2001) to smoking decisions; by Krusell, KurusÌ§cÌ§u, and Smith (2002) to optimal tax policy; by Carrillo and Mariotti (2000) to belief formation;
by Fang and Silverman (2004) to welfare program participation and labor supply of single mothers with dependent
children; and by Della Vigna and Paserman (2005) to job search.
4
Also related, Arcidiacono, Sieg and Sloan (2007) estimate a parametric forward-looking dynamic discrete choice
model of smoking and heavy drinking for late-middle age men in the Health and Retirement Studey (HRS) and find

1

cally implement a dynamic structural model of labor supply and welfare program participation
for never-married mothers with potentially time-inconsistent preferences. Using panel data on
the choices of single women with children from the National Longitudinal Survey of Youth (NLSY
1979), they provide estimates of the degree of time-inconsistency, and of its influence on the welfare take-up decision. For the particular population of single mothers with dependent children,
they estimate the present bias factor and the standard discount factor to be 0.338 and 0.88 respectively, implying a one-year ahead discount rate of 238%. Laibson, Repetto and Tobacman (2007)
use the Method of Simulated Moments (MSM) to estimate time preferences - both short and long
run discount rates â€“ from a structural buffer stock consumption model that includes many realistic
features such as stochastic labor income, liquidity constraints, child and adult dependents, liquid
and illiquid assets, revolving credit and retirement. Under parametric assumptions on the model,
the model is identified from matching the modelâ€™s predictions of retirement wealth accumulation, credit card borrowing and consumption-income co-movement with those observed in the
data. Their benchmark estimates imply a 48.5% short-term annualized discount rate and a 4.3%
long-term annualized discount rate. Paserman (2008) estimates the structural parameters of a job
search model with hyperbolic discounting and endogenous search effort, using data on duration
of unemployment spells and accepted wages from the NLSY 1979. Under parametric assumptions
of the model, identification of the hyperbolic discounting parameters comes from the variation in
the relative magnitude of unemployment duration and accepted wages. Indeed he finds that the
results are sensitive to the specific structure of the model and on the functional form assumption
for the distribution of offered wages. For low-wage workers, he rejects the exponential discounting model and estimates a one-year discount rate of about 149%.5 Chung, Steenburgh and Sudhir
(2009) estimated a dynamic structural model of sales force response to a bonus-based compensation plan where the salesman might have hyperbolic discounting time preferences. Exploiting the
bonus-based compensation structure, they found some evidence consistent with present bias.
None of the above papers allow for the possibility that a hyperbolic discounting decisionmaker may also be naive. More importantly, the identification of the present bias and standard
discount factors in these papers are often based on parametric assumptions imposed on the model.
To the best of our knowledge, it is not known whether dynamic discrete choice models with hyperbolic discounting preferences can be semi-parametrically identified using standard short-panel
that a forward-looking model fits the data (mainly the age profile for heavy-drinking and smoking) better than a myopic model. Their model assumes exponential discounting and thus does not incorporate the possibility that time
inconsistent preferences may play a role in the consumption of alcohol and cigarettes.
5
There are other inferential studies about discount rates that exploit specific clear-cut intertemporal trade-offs. For
example, Hausman (1979), and Warner and Pleeter (2001) estimate discount rates ranging from 0 to 89% depending on
the characteristics of the individual and intertemporal trade-offs at stake.

2

data that are typically used in these papers.6, 7
In this paper, we consider a standard dynamic discrete choice model where decision makers
potentially exhibit hyperbolic discounting preferences in the form of a present-bias factor (ğ›½), an
Ëœ [as in Oâ€™Donoghue and
exponential discounting factor (ğ›¿) and a potential naivety parameter (ğ›½)
Rabin (1999a)], and examine the conditions under which the primitive parameters of the model,
including the three hyperbolic discounting time preference parameters, can be identified using
short-panel (two periods) data. We show that, if there exist exclusion variables that affect the transition probabilities of states over time but do not affect the decision-makersâ€™ static payoff functions, a condition similar to that in Magnac and Thesmar (2002) necessary for the identification
of dynamic discrete choice models with standard exponential discounting, then we can potentially
Ëœ and ğ›¿.
identify all three discount factors ğ›½, ğ›½
The intuition for why exclusion variables that affect the transition of state variables but not
static payoffs might provide source of identification for the discount factors can be described as
follows. Consider two decision-makers who share the same period-payoff relevant state variables
but differ only in the exclusion variables. Because the exclusion variables only affect the transition
of the payoff-relevant state variables, their effects on the choices in the current period will inform
Ëœ and ğ›¿ can
us about the degree to which the agents discount the future. The intuition for why ğ›½, ğ›½
be separately identified will be provided later in Section 3.2.
We propose two estimation approaches that are intimately related to our identification arguments. One approach is based on maximizing a pseudo-likelihood function and the other is based
on minimizing the estimated variation of the static payoff functions with respect to the exclusion
variables. Monte Carlo experiments show that both estimators perform well in large samples, but
in relatively small samples, the maximum pseudo-likelihood based estimator performs better. We
thus use maximum pseudo-likelihood based estimator in our empirical application.
Our paper also represents an interesting intermediate case between the literature on estimating
dynamic discrete choice single-agent decision problems [see Miller (1984), Wolpin (1984), Pakes
(1986), Rust (1987), Hotz and Miller (1993) for early contributions and Rust (1994a, 1994b) and
Aguirregabiria and Mira (2007b) for surveys] and the more recent literature on estimating dynamic games [see Pakes and McGuire (1994), Pesendorfer and Schmidt-Dengler (2003), Pakes,
Ostrovsky and Berry (2007), Aguirregabiria and Mira (2007a), Bajari, Benkard and Levin (2007),
among others; and see Bajari, Hong and Nekipelov (2010) for a survey]. As is well-known, if an
agent has hyperbolic discounting time preferences, the outcome of her decision process can be
6

Fang and Silverman (2006) is an exception. They argue that exponential discounting and hyperbolic discounting
models are distinguishable, using an argument based on observed choice probabilities.
7
Mahajan and Tarozzi (2010) discuss how data about expectations regarding future behavior might be used to identify and estimate hyperbolic discounting parameters in their study of the adoption of insecticide treated nets.

3

considered as the equilibrium outcome of an intra-personal game with the players being the selves
of the same individual at different periods. There are two crucial differences, however, between the
intra-personal games we analyze for agents with time-inconsistent time preferences and those in
the existing dynamic games literature. The first difference is that in the intra-personal game case,
we do not observe the actions of all the players. More specifically, the outcomes â€“ choices and the
evolutions of the state variables â€“ we observe in the data are affected only by the current selves,
even though the current selvesâ€™ choices are impacted by their perception of future selvesâ€™ actions.
Secondly, the dynamic games literature [e.g. Bajari, Benkard and Levin 2007] may allow for the
different players to have different period-payoff functions, however, in our setting the payoffs
for the players â€“ the current self and the future selves â€“ differ only in time preferences; moreover, under hyperbolic discounting, we are assuming a rather restricted form of time preference
differences between the players.
We illustrate our identification argument and estimation method with an empirical application of adult womenâ€™s decisions to undertake mammography to investigate the role of time inconsistent preferences in the under-utilization of this preventive care. We consider a simple model
where mammography can potentially lower the probability of death in the next two years and it
may also lower the probability of bad health conditional on surviving in two years; however, undertaking mammography may involve immediate costs (most of which we would like to interpret
as psychological and physical costs instead of financial costs). For the purpose of identifying the
hyperbolic discounting preference parameters, we use several variables, including the indicator
for either the womanâ€™s mother is still alive and/or whether she died at age greater than 70, as
the exclusion variables that do not enter the relevant instantaneous payoff function but affects the
transition probability of other instantaneous payoff-relevant state variables. Our estimates indiËœ are estimated to be about
cate that individuals exhibit both present bias and naivety as ğ›½ and ğ›½
Ëœ > ğ›½). These sug0.72 and 0.99, respectively, suggesting both present bias (ğ›½ < 1) and naivety (ğ›½
gest that both present bias and naivety might have played an important role in the fact that nearly
25% of the women do not undertake mammography as advised by American Cancer Association,
which is universally regarded as a very cost effective way for early detection of breast cancer (see
Degnan et al. 1992).
The remainder of the paper is structured as follows. In Section 2 we describe a general dynamic discrete choice model with hyperbolic discounting time preferences. In Section 3 we provide detailed analysis for identification. In Section 4, we propose two estimation strategies based
on the identification arguments for the discount factors and we also evaluate the performance of
our proposed estimation methods using Monte Carlo experiments. In Section 5 we provide the
background information for mammography, which is the decision we examine in our empirical

4

application; we also describe the data set used in our study and provide some basic descriptive
statistics of the samples; we then provide details about the empirical specification of our model
of the decision for undertaking mammography and present the main estimation results. Finally,
Section 6 concludes and discusses a few important issues abstracted away in our analysis. In the
Appendix, we provide additional details about how our identification argument can be extended
to finite horizon applications.

2

Dynamic Discrete Choice Model with Hyperbolic Discounting Time
Preferences

2.1

Basic Model Setup
Consider a decision maker whose intertemporal utility is additively time separable. The agentâ€™s

instantaneous preferences are defined over the action she chooses from a discrete set of alternatives ğ‘– âˆˆ â„ = {0, 1, ..., ğ¼} , and a list of state variables denoted by â„ â‰¡ (ğ‘¥, ğœº) where ğ‘¥ âˆˆ ğ’³ , which
for notational simplicity includes time ğ‘¡, are observed by the researcher, and ğœº â‰¡ (ğœ€1 , ..., ğœ€ğ¼ ) âˆˆ ğ‘…ğ¼
are the vector of random preference shocks for each of the ğ¼ alternatives.8 We make the following
assumption about the instant utility from taking action ğ‘–, ğ‘¢âˆ—ğ‘– (â„) â‰¡ ğ‘¢âˆ—ğ‘– (ğ‘¥, ğœº):
Assumption 1. (Additive Separability) The instantaneous utilities are given by, for each ğ‘– âˆˆ â„,
ğ‘¢âˆ—ğ‘– (ğ‘¥, ğœº) = ğ‘¢ğ‘– (ğ‘¥) + ğœ€ğ‘– ,

(1)

where ğ‘¢ğ‘– (ğ‘¥) is the deterministic component of the utility from choosing ğ‘– at ğ‘¥, and (ğœ€1 , ..., ğœ€ğ¼ ) has a joint
distribution ğº, which is absolutely continuous with respect to the Lebesgue measure in ğ‘…ğ¼ .
We assume that the time horizon is infinite with time denoted by ğ‘¡ = 1, 2, ... The decisionmakerâ€™s intertemporal preferences are represented by a simple and now commonly used formulation of agentsâ€™ potentially time-inconsistent preferences: (ğ›½, ğ›¿)-preferences (Phelps and Pollak,
1968; Laibson, 1997; and Oâ€™Donoghue and Rabin 1999a):
Definition 1. (ğ›½, ğ›¿)-preferences are intertemporal preferences represented by
ğ‘ˆğ‘¡ (ğ‘¢ğ‘¡ , ğ‘¢ğ‘¡+1 , ...) â‰¡ ğ‘¢ğ‘¡ + ğ›½

+âˆ
âˆ‘

ğ›¿ ğ‘˜âˆ’ğ‘¡ ğ‘¢ğ‘˜

ğ‘˜=ğ‘¡+1

where ğ›½ âˆˆ (0, 1] and ğ›¿ âˆˆ (0, 1].
8

We assume that ğ’³ is a finite set and denote ğ‘‹ = #ğ’³ to be the size of the state space.

5

Following the terminology of Oâ€™Donoghue and Rabin (1999a), the parameter ğ›¿ is called the
standard discount factor, which captures long-run, time-consistent discounting; and the parameter
ğ›½ is called the present-bias factor, which captures short-term impatience. The standard model is
nested as a special case of (ğ›½, ğ›¿)-preferences when ğ›½ = 1. When ğ›½ âˆˆ (0, 1) , (ğ›½, ğ›¿)-preferences
capture â€œquasi-hyperbolicâ€ time discounting (Laibson, 1997). We say that an agentâ€™s preferences
are time-consistent if ğ›½ = 1, and are present-biased if ğ›½ âˆˆ (0, 1).
The literature on time-inconsistent preferences distinguishes between naive and sophisticated
agents (Strotz, 1956; Pollak, 1968; Oâ€™Donoghue and Rabin, 1999a, 1999b). An agent is partially
naive if the self in every period ğ‘¡ underestimates the present-bias of her future selves, believing
Ëœ âˆˆ (ğ›½, 1); in the extreme, if the present self believes that her
that her future selvesâ€™ present bias is ğ›½
Ëœ = 1, she is said to be completely naive. On the other hand,
future selves are time-consistent, i.e. ğ›½
an agent is sophisticated if the self in every period ğ‘¡ correctly knows her future selvesâ€™ present-bias
Ëœ = ğ›½.
ğ›½ and anticipates their behavior when making her period-ğ‘¡ decision, i.e., if ğ›½
Following previous studies of time-inconsistent preferences, we will analyze the behavior of
an agent by thinking of the single individual as consisting of many autonomous selves, one for
each period. Each period-ğ‘¡ self chooses her current behavior to maximize her current utility
ğ‘ˆğ‘¡ (ğ‘¢ğ‘¡ , ğ‘¢ğ‘¡+1 , ...) , while her future selves control her subsequent decisions.
More specifically, let the observable state variable in period ğ‘¡ be ğ‘¥ğ‘¡ âˆˆ ğ’³ where ğ’³ denotes
the support of the state variables and the unobservable choice-specific shock ğœ€ğ‘–ğ‘¡ âˆˆ ğ‘…, and ğœºğ‘¡ =
ğ¼
(ğœ€1ğ‘¡ , ..., ğœ€ğ¼ğ‘¡ ) âˆˆ ğ‘…ğ¼ . A strategy profile for all selves is ğˆ â‰¡ {ğœ ğ‘¡ }âˆ
ğ‘¡=1 where ğœ ğ‘¡ : ğ’³ Ã— ğ‘… â†’ â„ for all ğ‘¡. It

specifies for each self her action in all possible states and under all possible realizations of shock
âˆ
vectors. For any strategy profile ğˆ, write ğˆ +
ğ‘¡ â‰¡ {ğœ ğ‘˜ }ğ‘˜=ğ‘¡ as the continuation strategy profile from

period ğ‘¡ on.
To define and characterize the equilibrium of the intra-personal game of an agent with poten(
)
tially time-inconsistent preferences, we first write ğ‘‰ğ‘¡ ğ‘¥ğ‘¡ , ğœºğ‘¡ ; ğˆ +
as the agentâ€™s period-ğ‘¡ expected
ğ‘¡
continuation utility when the state variable is ğ‘¥ğ‘¡ and the shock vector is ğœºğ‘¡ under her long-run
(
)
+
time preference for a given continuation strategy profile ğˆ +
ğ‘¡ . We can think of ğ‘‰ğ‘¡ ğ‘¥ğ‘¡ , ğœºğ‘¡ ; ğˆ ğ‘¡ as representing (hypothetically) her intertemporal preferences from some prior perspective when her
(
)
own present-bias is irrelevant. Specifically, ğ‘‰ğ‘¡ ğ‘¥ğ‘¡ , ğœºğ‘¡ ; ğˆ +
ğ‘¡ must satisfy:
(
)
(
)
[
(
)
]
ğ‘‰ğ‘¡ ğ‘¥ğ‘¡ , ğœºğ‘¡ ; ğˆ +
= ğ‘¢âˆ—ğœğ‘¡ (ğ‘¥ğ‘¡ ,ğœºğ‘¡ ) ğ‘¥ğ‘¡ , ğœ€ğœğ‘¡ (ğ‘¥ğ‘¡ ,ğœºğ‘¡ )ğ‘¡ + ğ›¿E ğ‘‰ğ‘¡+1 ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ; ğˆ +
ğ‘¡
ğ‘¡+1 âˆ£ğ‘¥ğ‘¡ , ğœ ğ‘¡ (ğ‘¥ğ‘¡ , ğœºğ‘¡ ) ,

(2)

where ğœ ğ‘¡ (ğ‘¥ğ‘¡ , ğœºğ‘¡ ) âˆˆ â„ is the choice specified by strategy ğœ ğ‘¡ , and the expectation is taken over both
the future state ğ‘¥ğ‘¡+1 and ğœºğ‘¡+1 .
We will define the equilibrium for a partially naive agent whose period-ğ‘¡ self believes that,

6

Ëœ âˆˆ
beginning next period, her future selves will behave optimally with a present-bias factor of ğ›½
[ğ›½, 1]. Following Oâ€™Donoghue and Rabin (1999b, 2001), we first define the concept of an agentâ€™s
perceived continuation strategy profile by her future selves.
Definition 2. The perceived continuation strategy profile for a partially naive agent is a strategy profile
ğ¼
ğˆ
Ëœ â‰¡ {Ëœ
ğœ ğ‘¡ }âˆ
ğ‘¡=1 such that for all ğ‘¡ = 1, 2, ..., all ğ‘¥ğ‘¡ âˆˆ ğ’³ , and all ğœºğ‘¡ âˆˆ ğ‘… ,

{
[
(
)
]}
Ëœ
ğœ
Ëœ ğ‘¡ (ğ‘¥ğ‘¡ , ğœºğ‘¡ ) = arg max ğ‘¢âˆ—ğ‘– (ğ‘¥ğ‘¡ , ğœ–ğ‘–ğ‘¡ ) + ğ›½ğ›¿E
ğ‘‰ğ‘¡+1 ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ; ğˆ
Ëœ+
âˆ£ğ‘¥
,
ğ‘–
.
ğ‘¡
ğ‘¡+1
ğ‘–âˆˆâ„

Ëœ then her
That is, if an agent is partially naive with perceived present-bias by future selves at ğ›½,
period-ğ‘¡ self will anticipate that her future selves will follow strategies ğˆ
Ëœ+
ğœ ğ‘˜ }âˆ
ğ‘¡+1 â‰¡ {Ëœ
ğ‘˜=ğ‘¡+1 . Note,
importantly, what the strategy profile ğˆ
Ëœ â‰¡ {Ëœ
ğœ ğ‘¡ }âˆ
ğ‘¡=1 describes is the perception of the partially naive
agent regarding what her future selves will play. It is not what will generate the actual play that we
observe in the data. What we actually observe is generated from the perception-perfect strategy
profile that we now define.
Definition 3. A perception-perfect strategy profile for a partially naive agent is a strategy profile ğˆ âˆ— â‰¡
ğ¼
{ğœ âˆ—ğ‘¡ }âˆ
ğ‘¡=1 such that, for all ğ‘¡ = 1, 2, ..., all ğ‘¥ğ‘¡ âˆˆ ğ’³ , and all ğœºğ‘¡ âˆˆ ğ‘… ,

)
]}
{
[
(
.
ğœ âˆ—ğ‘¡ (ğ‘¥ğ‘¡ , ğœºğ‘¡ ) = arg max ğ‘¢âˆ—ğ‘– (ğ‘¥ğ‘¡ , ğœ€ğ‘–ğ‘¡ ) + ğ›½ğ›¿E ğ‘‰ğ‘¡+1 ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ; ğˆ
Ëœ+
ğ‘¡+1 âˆ£ğ‘¥ğ‘¡ , ğ‘–
ğ‘–âˆˆâ„

That is, ğˆ âˆ— is the best response of the current self with (ğ›½, ğ›¿)-preference against ğˆ
Ëœ , the perceived
continuation strategy profile of her future selves. It is key to note the difference and connection
between ğˆ
Ëœ and ğˆ âˆ— . ğˆ
Ëœ is the unobserved perception of the partially naive agent regarding what her
future selves will do, under the partial naivety assumption that her future selves do not suffer
from the present bias as described by the parameter ğ›½, but instead is governed by present bias
Ëœ that may differ from ğ›½. ğˆ âˆ— is what the self in each period will optimally choose to do,
parameter ğ›½
and the actions generated from ğˆ âˆ— are what will be observed in the data. Note also that when ğ›½
Ëœ coincide, i.e., when the agent is sophisticated, we have ğˆ âˆ— = ğˆ
and ğ›½
Ëœ.
Assumption 2. (Stationarity) We assume that the observed choices are generated under the stationary
perception-perfect strategy profile of the infinite horizon dynamic game played among different selves of the
decision makers.

7

2.2

Decision Process
Now we describe the decision process of the decision maker. First, define the deterministic

component of the current choice-specific value function, ğ‘Šğ‘– (ğ‘¥), as follows:
âˆ‘

ğ‘Šğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥) + ğ›½ğ›¿

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–),

(3)

ğ‘¥â€² âˆˆğ’³

where ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) denotes the transition probabilities for state variables ğ‘¥ when action ğ‘– is taken;
and ğ‘‰ (â‹…) is the perceived long-run value function defined as:
ğ‘‰ (ğ‘¥) â‰¡ Eğœº ğ‘‰ (ğ‘¥, ğœº; ğˆ
Ëœ)

(4)

where ğ‘‰ (ğ‘¥, ğœº; ğˆ
Ëœ ) is the stationary value function defined according to (2) under the perceived
continuation strategy profile ğˆ
Ëœ for a partially naive agent as defined in Definition 2.
Using ğ‘‰ (â‹…) as defined in (4), we can also define the choice-specific value function of the next-period
self as perceived by the current self, ğ‘ğ‘– (ğ‘¥) , as follows:
âˆ‘

Ëœ
ğ‘ğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥) + ğ›½ğ›¿

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–).

(5)

ğ‘¥â€² âˆˆğ’³

There are two key difference between ğ‘Šğ‘– (ğ‘¥) and ğ‘ğ‘– (ğ‘¥). The first difference is in how they
discount the future streams of payoffs: in ğ‘Šğ‘– (ğ‘¥) the payoff ğ‘¡ periods removed from the current
period is discounted by ğ›½ğ›¿ ğ‘¡ , while in ğ‘ğ‘– (ğ‘¥) the payoff ğ‘¡ periods removed from now is discounted
Ëœ ğ‘¡ . The second difference is interpretational: ğ‘Šğ‘– (ğ‘¥) represents how the current-period self
by ğ›½ğ›¿
evaluates the deterministic component of the payoff from choosing alternative ğ‘–, while ğ‘ğ‘– (ğ‘¥) is
how the current-period self perceives how her next-period self would evaluate the deterministic
component of the payoff from choosing alternative ğ‘–. It is obvious but important to note that ğ‘Šğ‘– (ğ‘¥)
will regulate the current selfâ€™s optimal choice, but ğ‘ğ‘– (ğ‘¥) will regulate the perception of the current
self regarding the choices of her future selves.
Given ğ‘ğ‘– (ğ‘¥) , we know that the current selfâ€™s perception of her future selfâ€™s choice, i.e., ğœ
Ëœ as
defined in Definition 2 is simply
[

]

Ëœ
ğœ
Ëœ (ğ‘¥, ğœº) = max ğ‘¢ğ‘– (ğ‘¥) + ğœ€ğ‘– + ğ›½ğ›¿
ğ‘–âˆˆâ„

âˆ‘

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–)

ğ‘¥â€² âˆˆğ’³

= max [ğ‘ğ‘– (ğ‘¥) + ğœ€ğ‘– ] .
ğ‘–âˆˆâ„

(6)

Let us define the probability of choosing alternative ğ‘— by the the next period self as perceived by

8

the current period self, ğ‘ƒËœğ‘— (ğ‘¥) , when the next-periodâ€™s state is ğ‘¥ :
ğ‘ƒËœğ‘— (ğ‘¥) = Pr [Ëœ
ğœ (ğ‘¥, ğœº) = ğ‘—]
[
]
= Pr ğ‘ğ‘— (ğ‘¥) + ğœ€ğ‘— â‰¥ ğ‘ğ‘— â€² + ğœ€ğ‘— â€² for all ğ‘— â€² âˆ•= ğ‘— .

(7)

With the characterization of ğœ
Ëœ (ğ‘¥, ğœº), we can now provide a characterization of ğ‘‰ (â‹…) . For this
purpose, further denote the perceived choice-specific long-run value function ğ‘‰ğ‘– (ğ‘¥) as follows:
ğ‘‰ğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥) + ğ›¿

âˆ‘

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–).

(8)

ğ‘¥â€² âˆˆğ’³

According to the definition of ğ‘‰ (â‹…) as given by (4), ğ‘‰ (ğ‘¥) is simply the expected value of ğ‘‰ğ‘– (ğ‘¥) + ğœ€ğ‘– ,
where ğ‘– is the chosen alternative according to ğœ
Ëœ (ğ‘¥, ğœº) ; that is, we have the following relationship:
[
]
ğ‘‰ (ğ‘¥) = Eğœº ğ‘‰ğœËœ (ğ‘¥,ğœº) (ğ‘¥) + ğœ€ğœËœ (ğ‘¥,ğœº) .

(9)

Now note from (5) and (8), we have
(
) âˆ‘
Ëœ ğ›¿
ğ‘‰ğ‘– (ğ‘¥) = ğ‘ğ‘– (ğ‘¥) + 1 âˆ’ ğ›½
ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘–).

(10)

ğ‘¥â€² âˆˆğ’³

Relationship (10) is crucial as it allows us to rewrite (9) as:
[
]
ğ‘‰ (ğ‘¥) = Eğœº ğ‘‰ğœËœ (ğ‘¥,ğœº) (ğ‘¥) + ğœ€ğœËœ (ğ‘¥,ğœº)
[

(

]

)

Ëœ ğ›¿
= Eğœº ğ‘ğœËœ (ğ‘¥,ğœº) (ğ‘¥) + ğœ€ğœËœ (ğ‘¥,ğœº) + 1 âˆ’ ğ›½

âˆ‘

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğœ
Ëœ (ğ‘¥, ğœº))

ğ‘¥â€² âˆˆğ’³

(

)

Ëœ ğ›¿Eğœº
= Eğœº max [ğ‘ğ‘– (ğ‘¥) + ğœ€ğ‘– ] + 1 âˆ’ ğ›½
ğ‘–âˆˆâ„

âˆ‘

ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğœ
Ëœ (ğ‘¥, ğœº) )

ğ‘¥â€² âˆˆğ’³

[
]
) âˆ‘
âˆ‘
â€²
â€²
Ëœ ğ›¿
= Eğœº max [ğ‘ğ‘– (ğ‘¥) + ğœ€ğ‘– ] + 1 âˆ’ ğ›½
ğ‘ƒËœğ‘— (ğ‘¥)
ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğ‘—)
(

ğ‘–âˆˆâ„

ğ‘—âˆˆâ„

(11)

ğ‘¥â€² âˆˆğ’³

where the second equality just follows from (10); and the third equality follows from (6) and thus
[
]
Eğœº ğ‘ğœËœ (ğ‘¥,ğœº) (ğ‘¥) + ğœ€ğœËœ (ğ‘¥,ğœº) = Eğœº max [ğ‘ğ‘– (ğ‘¥) + ğœ€ğ‘– ] ;
ğ‘–âˆˆâ„

9

and the fourth equality follows from the fact that
[
Eğœº

âˆ‘

â€²

âˆ‘

â€²

ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğœ
Ëœ (ğ‘¥, ğœº) ) =

ğ‘¥â€² âˆˆğ’³

]
Pr (Ëœ
ğœ (ğ‘¥, ğœº) = ğ‘—)

âˆ‘

â€²

ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğ‘—)

ğ‘¥â€² âˆˆğ’³

ğ‘—âˆˆâ„

[
âˆ‘

=

â€²

]
ğ‘ƒËœğ‘— (ğ‘¥)

ğ‘—âˆˆâ„

âˆ‘

â€²

â€²

ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğ‘— ).

ğ‘¥â€² âˆˆğ’³

Now we make two additional standard assumptions about the transition of the state variables
and the distribution of the shocks [see, e.g., Rust (1994b)]:
Assumption 3. (Conditional Independence):
ğœ‹(ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 âˆ£ğ‘¥ğ‘¡ , ğœ€ğ‘¡ , ğ‘‘ğ‘¡ ) = ğ‘(ğœºğ‘¡+1 âˆ£ğ‘¥ğ‘¡+1 )ğœ‹(ğ‘¥ğ‘¡+1 âˆ£ğ‘¥ğ‘¡ , ğ‘‘ğ‘¡ )
ğ‘(ğœºğ‘¡+1 âˆ£ğ‘¥ğ‘¡+1 ) = ğ‘(ğœº).
Assumption 4. (Extreme Value Distribution): ğœºğ‘¡ is i.i.d extreme value distributed.
Remark 1. It is well-known that the distribution of the choice-specific shocks to payoffs in discrete choice
models are not non-parametrically identified (see Magnac and Thesmar 2002, for example). Thus one has
to make an assumption about the distribution of ğœ€. We make the extreme value distribution assumption for
simplicity, but it could be replaced by any other distribution ğº .
With the above preliminary notations, now we can describe how the agent will make the
choices when the state variables are given by (ğ‘¥, ğœº) . From Definition 3 for perception perfect strategy profile and Equation (3), we know that the current period decision maker will choose ğ‘– if and
only if
ğ‘– âˆˆ arg max {ğ‘Šğ‘– (ğ‘¥) + ğœ€ğ‘– } .
ğ‘–âˆˆâ„

That is, the perception-perfect strategy profile ğœ âˆ— (ğ‘¥, ğœº) is:
ğœ âˆ— (ğ‘¥, ğœº) = arg max {ğ‘Šğ‘– (ğ‘¥) + ğœ€ğ‘– } .
ğ‘–âˆˆâ„

Under Assumption 4, the probability of observing action ğ‘– being chosen at a given state variable ğ‘¥
is:

[

]

exp [ğ‘Šğ‘– (ğ‘¥)]
.
ğ‘ƒğ‘– (ğ‘¥) = Pr ğ‘Šğ‘– (ğ‘¥) + ğœ€ğ‘– > max {ğ‘Šğ‘— (ğ‘¥) + ğœ€ğ‘— } = âˆ‘ğ¼
ğ‘—âˆˆâ„âˆ–{ğ‘–}
ğ‘—=0 exp [ğ‘Šğ‘— (ğ‘¥)]

(12)

ğ‘ƒğ‘– (ğ‘¥) is the current-period selfâ€™s equilibrium choice probabilities and will be observed in the data.
Now we derive some important relationships that will be used in our identification exercise

10

below. First, note that by combining (3) and (5), we have that:
ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘¢ğ‘– (ğ‘¥) =

Ëœ
ğ›½
[ğ‘Šğ‘– (ğ‘¥) âˆ’ ğ‘¢ğ‘– (ğ‘¥)] .
ğ›½

(13)

Since both ğ‘ğ‘– (â‹…) and ğ‘Šğ‘– (â‹…) depends on ğ‘‰ (â‹…) , we would like to use (11) to derive a characterization of ğ‘‰ (â‹…) . Note that under Assumptions 4, we have:
Eğœ€ max{ğ‘ğ‘– (ğ‘¥) + ğœ€ğ‘– } = ln
ğ‘–âˆˆâ„

{
âˆ‘

}
exp [ğ‘ğ‘– (ğ‘¥)] .

(14)

ğ‘–âˆˆâ„

Moreover, from (7), we have that
exp [ğ‘ğ‘— (ğ‘¥)]
.
ğ‘ƒËœğ‘— (ğ‘¥) = âˆ‘ğ¼
ğ‘–=0 exp [ğ‘ğ‘– (ğ‘¥)]

(15)

Using (14) and (15), we can rewrite (11) as
ğ‘‰ (ğ‘¥) = ln

{
âˆ‘

}
exp [ğ‘ğ‘– (ğ‘¥)]

ğ‘–âˆˆâ„

(
) âˆ‘ exp [ğ‘ (ğ‘¥)]
âˆ‘
ğ‘—
Ëœ ğ›¿
+ 1âˆ’ğ›½
ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘—).
âˆ‘ğ¼
ğ‘–=0 exp [ğ‘ğ‘– (ğ‘¥)] ğ‘¥â€² âˆˆğ’³
ğ‘—âˆˆâ„

(16)

The three set of equations (5), (13) and (16) will form the basis of our identification argument
below. Let us first make a few useful remarks.
Remark 2. We have three value functions {ğ‘Šğ‘– (ğ‘¥) , ğ‘ğ‘– (ğ‘¥) , ğ‘‰ğ‘– (ğ‘¥) : ğ‘¥ âˆˆ ğ’³ } as defined respectively in (3),
(5) and (8). Both ğ‘Šğ‘– (â‹…) and ğ‘ğ‘– (â‹…) are related to ğ‘‰ğ‘– (â‹…) . It is worth emphasizing that ğ‘Šğ‘– (ğ‘¥) will regulate the
current selfâ€™s choice behavior as demonstrated by (12); and ğ‘ğ‘– (ğ‘¥) will regulate the current selfâ€™s perception
of future selves choices as demonstrated by (15). ğ‘‰ğ‘– (ğ‘¥) is an auxiliary value function that simply uses the
long-run discount factor ğ›¿ to evaluate the payoffs from the choices that the current self perceives that will be
made by her future selves.
Ëœ = 1, i.e., if the decision maker is completely naive, we can see from (10) that ğ‘‰ğ‘– (ğ‘¥) = ğ‘ğ‘– (ğ‘¥)
Remark 3. If ğ›½
Ëœ = 1, the current self perceives her future selves to be time
for all ğ‘¥. This makes sense because when ğ›½
consistent. Thus the current self is already perceiving her future selves to be behaving according to the long
run discount factor ğ›¿ only.
Ëœ = ğ›½, i.e., when an agent is sophisticated, then Eqs. (3) and (5) tell us that ğ‘Šğ‘– (ğ‘¥) = ğ‘ğ‘– (ğ‘¥) .
Remark 4. If ğ›½
That is, if the decision maker is sophisticated, then the current selfâ€™s own choice rule will be identical to what
she perceives to be her future selfâ€™s choice rule.
Remark 5. When the decision maker is partially naive, there are two distinct value functions ğ‘Šğ‘– (ğ‘¥) and
ğ‘ğ‘– (ğ‘¥) that separately regulate the choice of the current self and the perceived choice of her future selves.
11

Notation
ğ‘¢ğ‘– (ğ‘¥)
ğ‘¢âˆ—ğ‘– (ğ‘¥)

Interpretation

Equation/Definition

Deterministic payoff from choosing alternative ğ‘–
when state vector is ğ‘¥
Payoff, including the choice-specific shock, from choosing

alternative ğ‘–when state vector is ğ‘¥ : ğ‘¢âˆ—ğ‘– (ğ‘¥) â‰¡ ğ‘¢ğ‘– (ğ‘¥) +ğœ€ğ‘–

Eq. (1)

ğ›½

The present-bias factor

Ëœ
ğ›½

Ëœ âˆˆ [ğ›½, 1]
The partial naivety parameter: ğ›½

ğ›¿

The standard discount factor

Definition (1)

ğ‘‰ğ‘– (ğ‘¥)

Perceived choice-specific long-run value function

Eq. (8)

ğ‘‰ (ğ‘¥)

Perceived long-run value function

Eq. (4)

ğ‘Šğ‘– (ğ‘¥)

Current choice-specific value function

Eq. (3)

ğ‘ğ‘– (ğ‘¥)

Definition (1)

Choice-specific value function of the next-period self
as perceived by the current self

Eq. (5)

ğœ
Ëœ (ğ‘¥, ğœº)

Perceived continuation strategy profile for a partially naive agent

Definition (2)

ğœ âˆ— (ğ‘¥, ğœº)

Perception-perfect strategy profile for a partially naive agent

Definition (3)

Table 1: Summary of Key Notations.

Equation (13) clarifies that it is the fact that we allow for potential naivety in the hyperbolic model that is
Ëœ = ğ›½, i.e., if agents are sophisticated (even when they
creating the wedge between ğ‘Šğ‘– (ğ‘¥) and ğ‘ğ‘– (ğ‘¥) : if ğ›½
suffer from present bias), it would be true that ğ‘Šğ‘– (ğ‘¥) = ğ‘ğ‘– (ğ‘¥) . This is an important point because, as
we see in (12), the observed choice probabilities (our data) would provide direct information about ğ‘Šğ‘– (ğ‘¥),
Ëœ = ğ›½, the observed choice probawithout needing any information about the discount factors. Thus when ğ›½
Ëœ and ğ›½ are potentially not equal, we can no
bilities also provide direct information about ğ‘ğ‘– (ğ‘¥) ; but when ğ›½
longer learn about ğ‘ğ‘– (ğ‘¥) directly from the observed choice probabilities.
Summary. Table 1 summarizes the main notations we have introduced up to now.

2.3

Relationship with the Dynamic Games Literature
We analyze the observed outcome of the dynamic discrete choice problem of a hyperbolic dis-

counting decision process as the equilibrium outcome of an intra-personal game with the players
being the selves at different periods. Thus our paper represents an interesting intermediate case between the classic literature on estimating single-agent dynamic discrete choice decision problems
and the more recent literature on estimating dynamic games. It is worth pointing out that there
are two crucial differences between the intra-personal games we analyze for agents with time12

inconsistent time preferences and those in the existing dynamic games literature.
The first key difference is that in our case, we do not observe the actions of all the players. More
specifically, the outcomes â€“ choices and the evolutions of the state variables â€“ we observe in the
data are affected only by the current selves, even though the current selvesâ€™ choices are impacted
by their perception of future selvesâ€™ actions. The current selfâ€™s perception of how her future selves
will play has to be inferred by the researcher using the equilibrium restriction imposed by the
theory. As can be seen from the above discussion, ğ‘ƒËœğ‘— (ğ‘¥) as defined in (15), captures the current
selfâ€™s perception of how her future selves will play, which is crucial for us to understand the
current selfâ€™s actual choices. However, as a researcher, we do not observe ğ‘ƒËœğ‘— , only observe ğ‘ƒğ‘— ,
the choice probabilities by the current self. In the standard dynamic games literature, it is always
assumed that the action of all the players are observed.
Secondly, the dynamic games literature (e.g. Bajari, Benkard and Levin 2007) may allow for
players to have different contemporaneous payoff functions, in our setting, however, the payoffs
for the players â€“ the current self and the future selves â€“ differ only in their time preferences;
moreover, under hyperbolic discounting, we are assuming a rather restricted form of difference in
time preferences between the selves in different periods.

3
3.1

Identification
Data and Preliminaries
Before we describe our results on identification, let us assume that we have access to a data set

that provides us with the following information:
DATA:
âˆ™ (Conditional Choice Probabilities) For all ğ‘¥ âˆˆ ğ’³ , we observe the choice probabilities ğ‘ƒğ‘– (ğ‘¥)
for all ğ‘– âˆˆ â„;
âˆ™ (Transitional Probabilities for Observable State Variables) For all (ğ‘¥, ğ‘¥â€² ) âˆˆ ğ’³ 2 , all ğ‘– âˆˆ â„,
we observe the transition probabilities ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) ; we denote
{ (
) (
)
}
ğ… â‰¡ ğœ‹ ğ‘¥â€² âˆ£ğ‘¥, ğ‘– : ğ‘¥, ğ‘¥â€² âˆˆ ğ’³ 2 , ğ‘– âˆˆ â„ ;
âˆ™ (Short Panels) We have access to at least two periods of the above data, even though the
data results from a stationary infinite horizon model.

13

Following Magnac and Thesmar (2002), we assume that the structure of the model, denoted by
ğœƒ, is defined by the following parameters:9
ğœƒ=

{(

)
âŒ©{
( )
( )
}âŒª}
Ëœ ğ›¿ , ğº, ğ‘¢ğ‘– (ğ‘¥) , ğ‘ğ‘– ğ‘¥â€² , ğ‘‰ğ‘– ğ‘¥â€² : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ , ğ‘¥â€² âˆˆ ğ’³
ğ›½, ğ›½,
,

where ğº (â‹…) , the distribution of the choice-specific payoff shocks ğœ€ğ‘–ğ‘¡ , is assumed to have a Type-I
extreme value distribution by Assumption 4. Note that the elements in ğœƒ in our setting differs
Ëœ that
from those in Magnac and Thesmar (2002) in that we have two additional parameters ğ›½ and ğ›½
measure present bias and naivety; moreover, the interpretation of ğ‘‰ğ‘– (ğ‘¥â€² ) in our paper differs from
theirs. In their paper ğ‘‰ğ‘– (ğ‘¥â€² ) directly informs about the actual choice probabilities of the decision
maker in the second period because Pr (ğ‘–âˆ£ğ‘¥â€² ) = Pr (ğ‘‰ğ‘– (ğ‘¥â€² ) + ğœ€ğ‘– > ğ‘‰ğ‘— (ğ‘¥â€² ) + ğœ€ğ‘— âˆ€ğ‘— âˆ•= ğ‘–) . In our paper,
ğ‘ğ‘– (ğ‘¥â€² ) captures the current selfâ€™s perception of the choice probability of the next periodâ€™s self, which
is never actually observed in the data; while ğ‘‰ğ‘– (ğ‘¥â€² ) is just an auxiliary value function to account
for the exponentially discounted payoff streams from the perceived choices made according to
ğœ
Ëœ (ğ‘¥, ğœº) . Another difference is that in Magnac and Thesmar (2002), the vector {ğ‘‰ğ‘– (ğ‘¥â€² ) : ğ‘¥â€² âˆˆ ğ’³ } are
completely free parameters; in our setting, however, neither ğ‘ğ‘– (ğ‘¥â€² ) and ğ‘‰ğ‘– (ğ‘¥â€² ) are completely free
parameters as they are subject to the restriction that they have to satisfy (5), (13) and (16).
We denote by Î˜ the set of all permissible structures. The set Î˜ requires that the structure
satisfies the assumptions we adopted in the model, as well as the restrictions (5), (13) and (16).
Given any structure ğœƒ âˆˆ Î˜, the model predicts the probability that an agent will choose alternative ğ‘– âˆˆ â„ in state ğ‘¥ âˆˆ ğ’³ , which we denote by ğ‘ƒË†ğ‘– (ğ‘¥; ğœƒ) and is given by
{
ğ‘ƒË†ğ‘– (ğ‘¥; ğœƒ) = Pr

[
ğ‘¢ğ‘– (ğ‘¥) + ğœ€ğ‘– + ğ›½ğ›¿

âˆ‘

â€²

â€²

ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğ‘–) = max ğ‘¢ğ‘— (ğ‘¥) + ğœ€ğ‘— + ğ›½ğ›¿
ğ‘—âˆˆâ„

ğ‘¥â€² âˆˆğ’³

]
âˆ‘

â€²

â€²

ğ‘‰ (ğ‘¥ )ğœ‹(ğ‘¥ âˆ£ğ‘¥, ğ‘—)

}
ğ‘¥, ğœƒ .

ğ‘¥â€² âˆˆğ’³

As is standard in the identification literature, we call the predicted choice probabilities ğ‘ƒË†ğ‘– (ğ‘¥; ğœƒ) as
the reduced form of structure ğœƒ âˆˆ Î˜. We say that two structures ğœƒ, ğœƒâ€² âˆˆ Î˜ are observationally equivalent
if
(
)
ğ‘ƒË†ğ‘– (ğ‘¥; ğœƒ) = ğ‘ƒË†ğ‘– ğ‘¥; ğœƒâ€² âˆ€ğ‘– âˆˆ â„ and ğ‘¥ âˆˆ ğ’³ .
A model is said to be identified if and only if for any ğœƒ, ğœƒâ€² âˆˆ Î˜, ğœƒ = ğœƒâ€² if they are observationally
equivalent.
9

We could have included the vector {ğ‘Šğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ } as part of the model parameters as well. But as seen from
Eq. (17), ğ‘Šğ‘– (ğ‘¥) can be straightforwardly inferred from the data of choice probabilities ğ‘ƒğ‘– (ğ‘¥), subject to a normalization.
For this reason, we exclude them from our list of model parameters.

14

3.2

Identification Results

We first describe identification of âŸ¨{ğ‘¢ğ‘– (ğ‘¥) , ğ‘ğ‘– (ğ‘¥â€² ) , ğ‘‰ğ‘– (ğ‘¥â€² ) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ , ğ‘¥â€² âˆˆ ğ’³ }âŸ© with for a given
âŒ©
âŒª
Ëœ ğ›¿ . Then we provide conditions pertinent to the identification of
set of discount factors ğ›½, ğ›½,
âŒ©
âŒª
Ëœ ğ›¿ .
ğ›½, ğ›½,

3.2.1

âŒ©
âŒª
Ëœ ğ›¿
Identification of âŸ¨{ğ‘¢ğ‘– (ğ‘¥) , ğ‘ğ‘– (ğ‘¥â€² ) , ğ‘‰ğ‘– (ğ‘¥â€² ) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ , ğ‘¥â€² âˆˆ ğ’³ }âŸ© for Given ğ›½, ğ›½,

For any given joint distribution ğº of Ëœğœ€ â‰¡ (ğœ€1 , ..., ğœ€ğ¼ ) , the choice probability vector P (ğ‘¥) =
(ğ‘ƒ1 (ğ‘¥) , ..., ğ‘ƒğ¼ (ğ‘¥)) is a mapping ğ‘„ of W (ğ‘¥) = (ğ‘Š0 (ğ‘¥) , ğ‘Š1 (ğ‘¥) , ..., ğ‘Šğ¼ (ğ‘¥)) . Hotz and Miller (1993)
showed that the mapping ğ‘„ can be inverted if for each ğ‘– âˆˆ â„, one of the ğ‘Šğ‘– (ğ‘¥) is normalized. That
is, one can find
ğ·ğ‘– (ğ‘¥) â‰¡ ğ‘Šğ‘– (ğ‘¥) âˆ’ ğ‘Š0 (ğ‘¥) = ğ‘„ğ‘– (P (ğ‘¥) ; ğº)
where ğ‘„ğ‘– is the ğ‘–ğ‘¡â„ component of the inverse ğ‘„. Under our Assumption 4 (that ğœ€ğ‘– has i.i.d Type-I
Extreme Value distribution), the mapping ğ‘„ğ‘– is especially simple [following from (12)]:
ğ·ğ‘– (ğ‘¥) = ğ‘Šğ‘– (ğ‘¥) âˆ’ ğ‘Š0 (ğ‘¥) = ln

ğ‘ƒğ‘– (ğ‘¥)
.
ğ‘ƒ0 (ğ‘¥)

(17)

Since we observe ğ‘ƒğ‘– (ğ‘¥) and ğ‘ƒ0 (ğ‘¥) from the data, we immediately learn about ğ·ğ‘– (ğ‘¥) . We thus
proceed as if ğ·ğ‘– (ğ‘¥) is observable.
From Eq. (13), we have that, for all ğ‘– âˆˆ â„,
Ëœ
ğ›½
ğ‘ğ‘– (ğ‘¥) = ğ‘Šğ‘– (ğ‘¥) +
ğ›½

(

Ëœ
ğ›½
1âˆ’
ğ›½

)
(18)

ğ‘¢ğ‘– (ğ‘¥)

Together with (17), we have, for all ğ‘– âˆˆ â„âˆ– {0} and ğ‘¥ âˆˆ ğ’³ ,
Ëœ
ğ›½
ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥) = ğ·ğ‘– (ğ‘¥) +
ğ›½

(

Ëœ
ğ›½
1âˆ’
ğ›½

)
[ğ‘¢ğ‘– (ğ‘¥) âˆ’ ğ‘¢0 (ğ‘¥)] .

(19)

Now let us examine the system of equations defined by Eq. (16), which can be re-written, using
(15), as, for all ğ‘¥ âˆˆ ğ’³ ,
ğ‘‰ (ğ‘¥) = ğ‘0 (ğ‘¥) + ln

{
âˆ‘

}
exp [ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥)]

(
) âˆ‘
âˆ‘
Ëœ ğ›¿
+ 1âˆ’ğ›½
ğ‘ƒËœğ‘— (ğ‘¥)
ğ‘‰ (ğ‘¥â€² )ğœ‹(ğ‘¥â€² âˆ£ğ‘¥, ğ‘—).

ğ‘–âˆˆâ„

ğ‘—âˆˆâ„

(20)

ğ‘¥â€² âˆˆğ’³

{
}
Ëœ ğ›¿, âŸ¨ğ‘ğ‘– (ğ‘¥) : ğ‘¥ âˆˆ ğ’³ âŸ© as given, Eq. (20) is just a system of ğ‘‹ linear equaNote that if we take ğ›½, ğ›½,

15

tion in ğ‘‹ unknowns, namely, V â‰¡ [ğ‘‰ (1) , ..., ğ‘‰ (ğ‘‹)]ğ‘‡ .10
[
{âˆ‘
}]
Specifically, if we stack ğ‘0 (ğ‘¥) + ln
exp [ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥)] ğ‘¥âˆˆğ’³ into an ğ‘‹ Ã—1 column vecğ‘–âˆˆâ„
]
[
tor A, denote by PÌƒ â‰¡ PÌƒ0 â‹… â‹… â‹… PÌƒğ¼ the ğ‘‹ Ã— [(ğ¼ + 1) ğ‘‹] matrix of choice probabilities,11 and
properly stack up the transition matrices ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘—) into an [(ğ¼ + 1) ğ‘‹] Ã— ğ‘‹ matrix as:12
â¡

â¤

â¢ Î 0 â¥
â¢ . â¥
. â¥
Î  â‰¡â¢
â¢ . â¥,
â£
â¦
Î ğ¼
we can write (20) as
(
)
Ëœ ğ›¿ PÌƒÎ V,
V=A+ 1 âˆ’ ğ›½
{
}
Ëœ ğ›¿, âŸ¨ğ‘ğ‘– (ğ‘¥) : ğ‘¥ âˆˆ ğ’³ âŸ© to be:
which yields the solution of V as a function of ğ›½, ğ›½,
[ (
)
]âˆ’1
Ëœ ğ›¿ PÌƒÎ 
V= Iâˆ’ 1 âˆ’ ğ›½
A.

(21)

(
)
Ëœ ğ›¿ , we can plug (21) into (5) and obtain, for all ğ‘¥ âˆˆ ğ’³ , and all
Thus for fixed values of ğ›½, ğ›½,
ğ‘– âˆˆ â„ â‰¡ {0, 1, ..., ğ¼} ,
Ëœ
ğ‘ğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥) + ğ›½ğ›¿

âˆ‘

( ) (
)
ğ‘‰ ğ‘¥â€² ğœ‹ ğ‘¥â€² âˆ£ğ‘¥, ğ‘–

ğ‘¥â€² âˆˆğ’³

Ëœ ğ‘– (ğ‘¥) V
= ğ‘¢ğ‘– (ğ‘¥) + ğ›½ğ›¿Î 
[ (
)
]âˆ’1
Ëœ ğ‘– (ğ‘¥) Iâˆ’ 1 âˆ’ ğ›½
Ëœ ğ›¿ PÌƒÎ 
= ğ‘¢ğ‘– (ğ‘¥) + ğ›½ğ›¿Î 
A,

(22)

where Î ğ‘– (ğ‘¥) = [ğœ‹ (1âˆ£ğ‘¥, ğ‘–) , ..., ğœ‹ (ğ‘‹âˆ£ğ‘¥, ğ‘–)] is an ğ‘‹ Ã— 1 vector as defined in footnote 12.
10

Note that all the terms ğ‘ƒËœğ‘— (ğ‘¥) just depend on ğ‘ğ‘– (â‹…) .
â¡

11

12

â¢
â¢
â¢
For each ğ‘— âˆˆ â„, PÌƒğ‘— is the ğ‘‹ Ã— ğ‘‹ matrix organized as: PÌƒğ‘— = â¢
â¢
â£

ğ‘ƒËœğ‘— (0)

0

â‹…â‹…â‹…

0

â¤

0

ğ‘ƒËœğ‘— (1)

0

0

0

â‹…â‹…â‹…
..
.

â¥
â¥
â¥
â¥.
â¥
â¦

0

0

â‹…â‹…â‹…

Here, Î ğ‘— is an ğ‘‹ Ã— ğ‘‹ matrix defined by
â¡

Î ğ‘— (1)

â¢
â¢ Î ğ‘— (2)
â¢
Î ğ‘— = â¢
..
â¢
.
â£
Î ğ‘— (ğ‘‹)

â¡

ğœ‹ (1âˆ£1, ğ‘—)

...

ğœ‹ (ğ‘‹âˆ£1, ğ‘—)

â¤

â¥ â¢
â¥ â¢
â¥ â¢
â¥=â¢
â¥ â¢
â¦ â£

ğœ‹ (1âˆ£2, ğ‘—)

...
..
.

ğœ‹ (ğ‘‹âˆ£2, ğ‘—)

â¥
â¥
â¥
â¥.
â¥
â¦

ğœ‹ (1âˆ£ğ‘‹, ğ‘—)

...

ğœ‹ (ğ‘‹âˆ£ğ‘‹, ğ‘—)

â¤

16

0
Ëœ
ğ‘ƒğ‘— (ğ‘‹)

Now consider the system of equations given by (19) and (22). We know from the standard
theories of discrete choice that we have to normalize the utility for the reference alternative 0,
which without loss of generality we set ğ‘¢0 (ğ‘¥) = 0 for all ğ‘¥ âˆˆ ğ’³ . Thus, the unknowns contained
in the equation system of (19) and (22) include the following unknowns: (ğ¼ + 1) Ã— ğ‘‹ values for
{ğ‘ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ } and ğ¼ Ã— ğ‘‹ values for {ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„/ {0} , ğ‘¥ âˆˆ ğ’³ } . That is, the total number
of unknowns is (2ğ¼ + 1) Ã— ğ‘‹. It is also easy to see that the total number of equations in the system
is also equal to (2ğ¼ + 1) Ã— ğ‘‹ : ğ¼ Ã— ğ‘‹ equations in (19) and (ğ¼ + 1) Ã— ğ‘‹ equations in (22).
Of course, having the same number of equations as the number of unknowns does not guarantee the existence, or the uniqueness of the solutions. We will describe how the number of solutions
affect our estimation procedure below.
(
)
Ëœ ğ›¿
Note that in the equation system of (19) and (22), the three discounting parameters ğ›½, ğ›½,
(
)
Ëœ and 1 âˆ’ ğ›½
Ëœ ğ›¿ appear; second,
appear in three different combinations: first, in Eqs. (22), both ğ›½ğ›¿
(
)
Ëœ
Ëœ
Ëœ ğ›¿ and ğ›½/ğ›½
Ëœ
ğ›½/ğ›½
appears in Eqs. (19). The fact that ğ›½ğ›¿,
1âˆ’ğ›½
appear in the equation system is
(
)
Ëœ ğ›¿ parameters.13 It is important to emphasize
crucial for the separate estimation of the ğ›½, ğ›½,
(
)
Ëœ ğ›¿ enter our problem is not by ad hoc
that the non-linearities of how the three parameters ğ›½, ğ›½,
assumptions, instead they are driven by theoretical considerations.
Finally, as we will see below, the main variables of interest that we would like to solve in
the equation system (19) and (22) are the ğ¼ Ã— ğ‘‹ values for {ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„/ {0} , ğ‘¥ âˆˆ ğ’³ } , and the
values for {ğ‘ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ } are only auxiliary. In our actual estimation, we indeed further eliminate {ğ‘ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ } from the equation system (19) and (22) and only solve for
{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„/ {0} , ğ‘¥ âˆˆ ğ’³ } .
3.2.2

âŒ©
âŒª
Ëœ ğ›¿
Exclusion Restriction to Identify ğ›½, ğ›½,

âŒ©
âŒª
Ëœ ğ›¿ . This discussion is closely
Now we discuss conditions for identification related to ğ›½, ğ›½,
related to that in Magnac and Thesmar (2002). We impose the following exclusion restriction assumption:
Assumption 5. (Exclusion Restriction) There exist state variable ğ‘¥1 âˆˆ ğ’³ and ğ‘¥2 âˆˆ ğ’³ with ğ‘¥1 âˆ•= ğ‘¥2 ,
such that
1. for all ğ‘– âˆˆ â„, ğ‘¢ğ‘– (ğ‘¥1 ) = ğ‘¢ğ‘– (ğ‘¥2 ) ;
13

âŒ©
(
)
âŒª
âŒ©
âŒª
Ëœ
Ëœ ğ›¿, ğ›½/ğ›½
Ëœ
Ë† ğ›¿ :
Note that if the identification of ğ›½ğ›¿,
1âˆ’ğ›½
is isomorphic to the identifcation of ğ›½, ğ›½,
(
)
Ëœ + 1âˆ’ğ›½
Ëœ ğ›¿;
ğ›¿ = ğ›½ğ›¿

Ëœ=
ğ›½

Ëœ
ğ›½ğ›¿
(
) ;
Ëœ + 1âˆ’ğ›½
Ëœ ğ›¿
ğ›½ğ›¿

17

ğ›½=

(Ëœ)
Ëœ
ğ›½ğ›¿
ğ›½
(
) /
.
ğ›½
Ëœ + 1âˆ’ğ›½
Ëœ ğ›¿
ğ›½ğ›¿

2. for some ğ‘– âˆˆ â„, ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥1 , ğ‘–) âˆ•= ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥2 , ğ‘–) .
More specifically, to satisfy the exclusion restriction assumption, there must exist at least one
variable that does not directly affect the contemporaneous utility function ğ‘¢ğ‘– (â‹…) for all ğ‘– âˆˆ â„, but
the variable may matter for choices because it affects the transition of state variables. The extent
to which individualsâ€™ choice probabilities differ at state ğ‘¥1 and ğ‘¥2 reveals information about the
discount factors. This is the key intuition from Magnac and Thesmarâ€™s (2002) result where they
are interested in identifying a single long-term discount factor ğ›¿. In their setting, if ğ›¿ = 0, i.e., if
individuals are completely myopic, then the choice probabilities would have been the same under
ğ‘¥1 and ğ‘¥2 ; to the extent that choice probabilities differ at ğ‘¥1 and ğ‘¥2 , it reveals information about
the degree of time discounting. Their intuition, however, can be easily extended to the hyperbolic
discounting case, as we will exploit in the proposed estimation strategy below.
For notational simplicity, we will divide the state variables into two groups (ğ‘¥ğ‘Ÿ , ğ‘¥ğ‘’ ) where
ğ‘¥ğ‘Ÿ âˆˆ ğ’³ğ‘Ÿ refers to the state variables that directly enter the contemporaneous payoff function ğ‘¢ğ‘– (ğ‘¥ğ‘Ÿ )
and ğ‘¥ğ‘’ âˆˆ ğ’³ğ‘’ refers to the state variables that satisfy the exclusion restriction (5). The key idea that
the existence of exclusion variables can provide the source of identification of the discount factors
âŒ©
âŒª
Ëœ ğ›¿ , Section 3.2.1 tells us that we can identify, from the
is as follows: for any given values for ğ›½, ğ›½,
âŒ©
âŒª
Ëœ ğ›¿ might be consistent
observed data, values of âŸ¨{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ }âŸ© , to the extent that ğ›½, ğ›½,
with the data at all. However, consider two state vectors ğ‘¥ = (ğ‘¥ğ‘Ÿ , ğ‘¥ğ‘’ ) and ğ‘¥â€² = (ğ‘¥ğ‘Ÿ , ğ‘¥â€²ğ‘’ ) that only
âŒ©
âŒª
Ëœ ğ›¿ are inconsistent
differ in the exclusion restriction components. If the postulated values of ğ›½, ğ›½,
with the true values, there is no guarantee that the identified values of ğ‘¢ğ‘– (ğ‘¥) and ğ‘¢ğ‘– (ğ‘¥â€² ) are equal,
as required by the exclusion restriction. The exclusion restriction will allow us to select the values
âŒ©
âŒª
Ëœ ğ›¿ such that the values of ğ‘¢ğ‘– (ğ‘¥) and ğ‘¢ğ‘– (ğ‘¥â€² ) identified from the data only differ if ğ‘¥ and ğ‘¥â€²
of ğ›½, ğ›½,
differ in components of ğ‘¥ğ‘Ÿ .
Before we show how we can use the exclusion restriction to construct estimators for the three
âŒ©
âŒª
âŒ©
âŒª
Ëœ ğ›¿ , it is useful to provide some intuition as to how ğ›½, ğ›½,
Ëœ ğ›¿ come to affect
discount factors ğ›½, ğ›½,
the observed choice behavior by the current self differently.
Distinguishing ğ›½ and ğ›¿. It may seem counterintuitive that ğ›½ and ğ›¿ could be separately identified
Ëœ = ğ›½.
in a short two-period panel data set. To provide some intuition, let us consider the case that ğ›½
The question is: â€œCan we distinguish the behavior of an agent with exponential discounting rate
Ë†ğ›¿ = ğ›½ğ›¿ from the behavior of a sophisticated time-inconsistent agent with preference (ğ›½, ğ›¿)?â€ Under
stationarity assumption, if an agent has time consistent exponential discounting rate Ë†ğ›¿ = ğ›½ğ›¿, her
expected continuation utilities is completely determined by the observed choice probabilities. To

18

Ëœ by 1 and ğ›¿ by Ë†ğ›¿, we will have
see this, observe that in equation (20), if one replaces ğ›½
ğ‘‰ (ğ‘¥) = ğ‘0 (ğ‘¥) + ln

{
âˆ‘

}
exp [ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥)] ,

ğ‘–âˆˆâ„

Ëœ
which only depends on ğ·ğ‘– (ğ‘¥) when ğ›½ = ğ›½.
However, for a sophisticated time-inconsistent agent with preference (ğ›½, ğ›¿) , there is an incongruence between current self and her perceived future self regarding how they evaluate the future
stream of payoffs. Though the current self has to defer to her next-period self in terms of the actual next-period choice that will be chosen, they disagree on how much weight to put on payoffs
two-periods from now. It is this incongruence that leads to the last term in Eq. (20), which in turn
breaks the tight link between observed choice probabilities and the continuation utilities.
As we demonstrated in Section 3.2.1, the continuation utilities will ultimately determine the
identified values of âŸ¨{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ }âŸ© . Thus ğ›½ and ğ›¿ can be distinguished when there are
exclusion variables because they requires that ğ‘¢ğ‘– (ğ‘¥) does not depend on the ğ‘¥ğ‘’ components of the
state vector.
Ëœ To help provide intuition for why ğ›½ could be distinguished from ğ›½,
Ëœ let
Distinguishing ğ›½ and ğ›½.
Ëœ
us suppose that ğ›¿ = 1. First note that the ratio ğ›½/ğ›½
appears in term ğ‘ğ‘– (ğ‘¥) [see Eq. (18)]. This
ratio regulates the incongruence between the current selfâ€™s own behavior and her perception of
Ëœ
the behavior of her future selves. Eq. (19) shows that if ğ›½/ğ›½
= 1, then ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥) is uniquely
determined by the observed ğ·ğ‘– (ğ‘¥) ; and thus the current selfâ€™s perception about her future selfâ€™s
Ëœ
action is identical to her own action. This implies that ğ›½/ğ›½
= 1 (and ğ›¿ = 1) will pin down completely the identified values of âŸ¨{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„, ğ‘¥ âˆˆ ğ’³ }âŸ© from the data, which could be refuted if the
identified values of ğ‘¢ğ‘– (ğ‘¥) do not satisfy the exclusion restrictions, i.e., ğ‘¢ğ‘– (ğ‘¥) should not depend on
the ğ‘¥ğ‘’ components of the state vector.

3.3

The Exponential Discounting Special Case: ğ›½ = ğ›½Ëœ = 1
Before discussing our estimation strategy, we here show that the non-linear equation system

(19) and (22), for the special case of dynamic discrete choice models with exponential discounting
Ëœ = ğ›½ = 1), replicates the known results in the literature. In that case, (19) is
(i.e., the case with ğ›½
reduced to the well-known relationship
ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥) = ln ğ‘ƒğ‘– (ğ‘¥) âˆ’ ln ğ‘ƒ0 (ğ‘¥) ;

19

(23)

that is, in standard models the difference in the choice probabilities for alternative ğ‘– and the reference alternative 0 informs us about the difference in the value from choosing ğ‘– relative to the value
Ëœ = ğ›½ < 1. The potential naivety we allow in
from choosing 0. This is of course also true when ğ›½
our setup breaks this direct relationship between ğ‘ƒğ‘– (ğ‘¥) /ğ‘ƒ0 (ğ‘¥) and ğ‘ğ‘– (ğ‘¥) âˆ’ ğ‘0 (ğ‘¥) .
Ëœ = ğ›½ = 1, (22) for ğ‘– = 0 is reduced to (using the normalization that ğ‘¢0 (ğ‘¥) =
Moreover, when ğ›½
0) :
ğ‘0 (ğ‘¥) = ğ›¿

âˆ‘
ğ‘¥â€² âˆˆğ’³

]
[
âˆ‘
âˆ‘ ğ‘ƒğ‘– (ğ‘¥â€² )
(
)
( â€²) ( â€²
)
ğœ‹ ğ‘¥â€² âˆ£ğ‘¥, 0 .
ğ‘0 ğ‘¥ ğœ‹ ğ‘¥ âˆ£ğ‘¥, 0 + ğ›¿
ln
â€²
ğ‘ƒ0 (ğ‘¥ )
â€²
ğ‘¥ âˆˆğ’³

ğ‘–âˆˆâ„

For simplicity, denote the ğ‘‹ Ã— 1 vector {ğ‘0 (ğ‘¥)}ğ‘¥âˆˆğ’³ as Z0 ; write the ğ‘‹ Ã— ğ‘‹ matrix ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, 0) as Î 0 ,
{ [âˆ‘
]}
ğ‘ƒğ‘– (ğ‘¥â€² )
and write the ğ‘‹ Ã— 1 vector ln
as m. The above equation can be written as
ğ‘–âˆˆâ„ ğ‘ƒ0 (ğ‘¥â€² )
ğ‘¥âˆˆğ’³

Z0 = ğ›¿Î 0 (Z0 + m) .
Thus,
Z0 = (Iâˆ’ğ›¿Î 0 )âˆ’1 ğ›¿m.
Given this unique solution of Z0 , (23) immediately provides ğ‘ğ‘– (ğ‘¥) for all ğ‘– âˆˆ â„/ {0} and all ğ‘¥ âˆˆ ğ’³ .
To obtain ğ‘¢ğ‘– (ğ‘¥) for ğ‘– âˆˆ â„âˆ– {0}, note that (22) implies that
uğ‘– = Zğ‘– âˆ’ ğ›¿Î ğ‘– Z0 âˆ’ ğ›¿Î ğ‘– m,

(24)

where Zğ‘– and uğ‘– are ğ‘‹ Ã— 1 vectors of {ğ‘ğ‘– (ğ‘¥)}ğ‘¥âˆˆğ’³ and {ğ‘¢ğ‘– (ğ‘¥)}ğ‘¥âˆˆğ’³ respectively, Î ğ‘– is the ğ‘‹ Ã— ğ‘‹
matrix ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) . Recall that in the standard exponential discounting model we have ğ‘ğ‘– (ğ‘¥) =
ğ‘‰ğ‘– (ğ‘¥) , thus we can conclude that , {uğ‘– }ğ‘–âˆˆâ„âˆ–{0} and {Vğ‘– }ğ‘–âˆˆâ„ are identified once ğ›¿, ğº and {ğ‘¢0 (ğ‘¥)}ğ‘¥âˆˆğ’³
are fixed. This replicates the proof of Proposition 2 in Magnac and Thesmar (2002).14

4

Estimation Strategies
In this section, we describe two estimation strategies based on our discussion about identifica-

tion above. Both estimation strategy involves two steps, and they share the same first step. In the
first step, we estimate from the data the choice probabilities ğ‘ƒğ‘– (ğ‘¥) for all ğ‘– âˆˆ â„ and all ğ‘¥ âˆˆ ğ’³ , as
well as the state transition probabilities ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) for all ğ‘– âˆˆ â„ and all (ğ‘¥â€² , ğ‘¥) âˆˆ ğ’³ 2 .15
14

The only difference is that our argument above indicates that V0 does not have to be fixed. It can be identified from
the model.
15
It is useful to note that so far, our discussion has focused on short-panel (two period) data sets under stationarity
assumption. Having two-period data allows one to non-parametrically estimate the transition probabilities ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) ;
stationarity ensures that looking at a two-period slice of a potentially long panel is sufficient. Fang and Silverman (2006)
considered a case without stationarity (specifically a finite horizon model) and showed that ğ›½ and ğ›¿ could be poten-

20

The second step is different for the two estimation strategies. The first estimation strategy involves two loops. In the inner loop, we solve equation system (19) and (22) for ğ‘¢ğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥ğ‘’ )
âŒ©
âŒª
Ëœ ğ›¿ for all ğ‘– âˆˆ â„âˆ– {0} and all ğ‘¥ âˆˆ ğ’³ where we normalize
for a given triple of values for ğ›½, ğ›½,
ğ‘¢0 (ğ‘¥) = 0 for all ğ‘¥ âˆˆ ğ’³ . In the outer loop, we exploit the identifying assumption 5 in a straightforâŒ©
âŒª
Ëœ ğ›¿ , for all ğ‘¥
ward manner. We know that at the true values of ğ›½, ğ›½,
Ëœğ‘’ âˆˆ ğ’³ğ‘’ , the standard deviation
of ğ‘¢
Ë†ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ) with respect to ğ‘¥
Ëœğ‘’ should be 0, because Assumption 5 requires that ğ‘¢ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ) does not
âŒ©
âŒª
Ëœ ğ›¿ in our first estimation strategy is:
depend on ğ‘¥
Ëœğ‘’ . Therefore the estimator for ğ›½, ğ›½,
âŒ©

[ (
âŒ©
âŒª)]
âŒª
âˆ‘
Ëœ ğ›¿
Ëœ ğ›¿ = arg min 1
,
std ğ‘¢
Ë† ğ‘– ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ; ğ›½, ğ›½,
ğ›½, ğ›½,
Ëœ } âˆ£ğ’³ğ‘Ÿ âˆ£
{ğ›½,ğ›½,ğ›¿
ğ‘¥ğ‘Ÿ âˆˆğ’³ğ‘Ÿ

(25)

[ (
âŒ©
âŒª)]
Ëœ ğ›¿
where std ğ‘¢
Ë† ğ‘– ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ; ğ›½, ğ›½,
is simply the sample standard deviation of ğ‘¢
Ë†ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ) , calculated
âŒ©
âŒª
Ëœ ğ›¿ , with respect to ğ‘¥
under given values of ğ›½, ğ›½,
Ëœğ‘’ .
The second estimation strategy is a maximum pseudo-likelihood estimation. As in the first
estimation strategy, we first solve equation system (19) and (22) for ğ‘¢ğ‘– (ğ‘¥) = ğ‘¢ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥ğ‘’ ) for a given
âŒ©
âŒª
Ëœ ğ›¿ for all ğ‘– âˆˆ â„âˆ– {0} and all ğ‘¥ âˆˆ ğ’³ where we normalize ğ‘¢0 (ğ‘¥) = 0 for all
triple of values for ğ›½, ğ›½,
ğ‘¥ âˆˆ ğ’³ . Then we directly impose, by Assumption 5, the restriction that
ğ‘¢
Ë†ğ‘– (ğ‘¥ğ‘Ÿ ) =

1
âˆ£{(ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ) : ğ‘¥
Ëœğ‘’ âˆˆ ğ’³ğ‘’ }âˆ£

âˆ‘

ğ‘¢
Ë†ğ‘– (ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ )

(26)

{(ğ‘¥ğ‘Ÿ ,Ëœ
ğ‘¥ğ‘’ ):Ëœ
ğ‘¥ğ‘’ âˆˆğ’³ğ‘’ }

where ğ’³ğ‘’ is the set of possible values for the payoff irrelevant state variables ğ‘¥ğ‘’ we discussed in
Assumption 5. Given ğ‘¢
Ë†ğ‘– (ğ‘¥ğ‘Ÿ ) as defined by (26), we can then use the model to predict the implied
( âŒ©
âŒª)
Ëœ ğ›¿ , and formulate the pseudo-likelihood of the observed data,
choice probabilities ğ‘ƒË†ğ‘– ğ‘¥; ğ›½, ğ›½,
which can be written as:
( âŒ©
âŒª)ğ·ğ‘– (ğ‘¥) [
( âŒ©
âŒª)]1âˆ’ğ·ğ‘– (ğ‘¥)
Ëœ ğ›¿
Ëœ ğ›¿
â„’ = Î ğ‘›âˆˆğ’© Î ğ¼ğ‘–=1 Î ğ‘¥âˆˆğ’³ ğ‘ƒË†ğ‘– ğ‘¥; ğ›½, ğ›½,
1 âˆ’ ğ‘ƒË†ğ‘– ğ‘¥; ğ›½, ğ›½,
,

(27)

where in the likelihood function, ğ‘› stands for an individual and ğ’© stands for the set of individuals in the sample, and also note that we partialed out the contribution from the state transitions
ğœ‹ (ğ‘¥â€² âˆ£ğ‘¥, ğ‘–) in the likelihood since it is already estimated in step one. We then maximize the pseudoâŒ©
âŒª
Ëœ ğ›¿ .
likelihood function to estimate ğ›½, ğ›½,

tially distinguished without exclusion restriction if the researcher has access to at least three-period panel data. Also,
see Section 6 for discussions related to non-stationariy, longer panels and unobserved state variables or unobserved
heterogeity.

21

4.1

Discussions
Now we discuss a few practical issues that may arise in the estimation.

Solutions to the Equation System (19) and (22). Even though the equation system (19) and (22)
have the same number of equations and unknowns, there is no guarantee that the system will have
âŒ©
âŒª
Ëœ ğ›¿ .16 In practice, we deal with the potential
a unique solution for any arbitrary values of ğ›½, ğ›½,
âŒ©
âŒª
Ëœ ğ›¿ ,
no solution, or multiple solution problem as follows. If for a particular combination of ğ›½, ğ›½,
we are unable to find a solution to the equation system (19) and (22), we will simply set the objec[ (
âŒ©
âŒª)]
âˆ‘
Ëœ ğ›¿
tive
std ğ‘¢
Ë† ğ‘– ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ; ğ›½, ğ›½,
in (25) for estimation method 1 to +âˆ (i.e., a sufficiently
ğ‘¥ğ‘Ÿ âˆˆğ’³ğ‘Ÿ

large value), and the objective likelihood in (27) for estimation method 2 to âˆ’âˆ (i.e., a sufficiently
âŒ©
âŒª
Ëœ ğ›¿ , we find multismall value). On the other hand, if for some particular combination of ğ›½, ğ›½,
ple solutions to the equation system, we will, among all the solutions, pick the smallest values of
the objective (25) for estimation method 1 and pick the highest likelihood in (27) for estimation
method 2.
Size of the Support of exclusion Restriction State Variables ğ’³ğ‘’ .

As we described in Section 3.2,

the identification of the model comes from the presence of state variables that satisfy the exclusion
âŒ©
âŒª
Ëœ ğ›¿ by requiring that only those combinations
restriction 5. The exclusion variables identify ğ›½, ğ›½,
of the discount factors that can explain the observed data with payoffs âŸ¨{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„âˆ– {0} , ğ‘¥ âˆˆ ğ’³ }âŸ©
that do not vary with respect to changes in ğ‘¥ğ‘’ . Since we have three unknown discount factors
âŒ©
âŒª
Ëœ ğ›¿ , we need at least three cross-ğ‘¥ğ‘’ restrictions, i.e., a minimum of four different points in the
ğ›½, ğ›½,
support ğ’³ğ‘’ are required. Also, the requirement for the size of the support ğ’³ğ‘’ seems to differ between the two proposed estimation methods. In estimation method 1, the larger the size of ğ’³ğ‘’ , the
[ (
âŒ©
âŒª)]
âŒ©
âŒª
âˆ‘
Ëœ ğ›¿
Ëœ ğ›¿ .
smoother the objective function ğ‘¥ğ‘Ÿ âˆˆğ’³ğ‘Ÿ std ğ‘¢
Ë† ğ‘– ğ‘¥ğ‘Ÿ , ğ‘¥
Ëœğ‘’ ; ğ›½, ğ›½,
is with respect to ğ›½, ğ›½,
The effect of the size of ğ’³ğ‘’ on the properties of the objective function in (27) is less pronounced.
Parametric Utility Function Specifications. Even though we described how âŸ¨{ğ‘¢ğ‘– (ğ‘¥) : ğ‘– âˆˆ â„âˆ– {0} , ğ‘¥ âˆˆ ğ’³ }âŸ©
âŒ©
âŒª
Ëœ ğ›¿ .
can be non-parametrically solved from equation system (19) and (22) for given values of ğ›½, ğ›½,
In practice, we may often parameterize it as a function of observed state variables ğ‘¥, including the
exclusion variables ğ‘¥ğ‘’ . In such cases, the estimation methods described above can be adapted to
minimize the standard deviation of the coefficient estimates for the exclusion variables ğ‘¥ğ‘’ for estimation method 1. Estimation method 2, though, still goes through unmodified (see Footnote 18
for an illustration in our Monte Carlo experiments).
16

As we show in Section 3.3, the system does have a unique solution under the exponential discounting case, i.e.,
Ëœ = ğ›½ = 1, for any ğ›¿ âˆˆ (0, 1) .
when ğ›½

22

4.2

Monte Carlo Experiments
In this section we provide Monte Carlo evidence for the identification of discount factors in a

dynamic discrete choice model using the two estimation methods described above. In this simple
Monte Carlo exercise, we consider a binary choice decision problem, ğ‘– âˆˆ {0, 1} , facing an agent
with infinite horizon, stationary state transition, and linear utility functions. There are two state
variables ğ‘¥ğ‘Ÿ and ğ‘¥ğ‘’ . The state variable ğ‘¥ğ‘Ÿ âˆˆ ğ’³ğ‘Ÿ = {0, 1, 2, 3, 4, 5}, affects both instantaneous utility
and state transition; while state variable ğ‘¥ğ‘’ âˆˆ ğ’³ğ‘’ = {0, 1, 2, 3}, affects only the state transition.17
We parameterize the instantaneous payoff functions ğ‘¢ğ‘– (ğ‘¥ğ‘Ÿ ) as follows: ğ‘¢1 (ğ‘¥ğ‘Ÿ ) = ğ›¼0 + ğ›¼1 ğ‘¥ğ‘Ÿ ; and
normalize ğ‘¢0 (ğ‘¥ğ‘Ÿ ) = 0 for all ğ‘¥ğ‘Ÿ . The true parameters are set at: ğ›¼0 = âˆ’0.1, ğ›¼1 = 0.5, ğ›¿ = 0.8,
Ëœ = 0.7.18 For each sample size (240,000, 120,000 and 12,500), we randomly generate
ğ›½ = 0.6, and ğ›½
2,000 simulation samples, and estimate the discount factors and corresponding utility parameters
to examine the differences in performance of these two estimation methods.
Table 2 presents the Monte Carlo results. It shows that both estimation methods do a good
job in recovering the true parameter values in large samples. Estimation results improve with increases in sample sizes. Because the second estimation strategy, the maximum pseudo-loglikelihood
method, has only one loop in the second step, it is the method we use in our empirical exercise.

5

An Empirical Application: Mammography Decisions

In this section, we present an illustrative application of the identification and estimation method
âŒ©
âŒª
Ëœ ğ›¿ described in Sections 3.2 and 4. We provide estimates of these key time preference pafor ğ›½, ğ›½,
rameters and then examine the role of present bias and naivety in womenâ€™s decisions to undertake
mammography.
17
The state transition matrices are generated as follows. We first generate two random matrices ğ‘€0 and ğ‘€1 each with
dimension #ğ’³ğ‘Ÿ Ã— #ğ’³ğ‘’ = 6 Ã— 4 = 24, with each entry a random number generated from a uniform [0, 1] distribution.
We then normalize the entry in each row by its row sum to ensure a proper probability matrix. The resulting matrices
are denoted Î 0 and Î 1 , the choice-specific state transition probabilities. The (ğ‘—, ğ‘˜)-th entry of matrix Î ğ‘– where (ğ‘—, ğ‘˜) âˆˆ
{1, ..., 24}2 is the probability that (ğ‘¥â€²ğ‘Ÿ , ğ‘¥â€²ğ‘’ ) takes on ğ‘˜-th combination condition on (ğ‘¥ğ‘Ÿ , ğ‘¥ğ‘’ ) taking on ğ‘—-th combination
in this period and action chosen is ğ‘– âˆˆ {0, 1} . The matrices Î 1 and Î 0 are assumed to be known by the decision maker;
and are directly taken to be the state transition probabilities in our Monte Carlo exercise reported in Table 2.
18
Given the assumed linear utility functions in this Monte Carlo exercise, the objective function for the outer loop of
step two of the first estimation strategy can be simplified to:
âŒ©
âŒª
Ëœ ğ›¿ = arg min âˆ£âˆ£ğ›¼2 (ğ‘¥ğ‘’ )âˆ£âˆ£.
ğ›½, ğ›½,
Ëœ }
{ğ›½,ğ›½,ğ›¿
âŒ©
âŒª
Ëœ ğ›¿ and
where ğ›¼2 is the estimated utility parameter for the exclusive restriction variables for a given combination ğ›½, ğ›½,

âˆ£âˆ£.âˆ£âˆ£ refers to the Euclidean metric.

23

Estimation Method
Parameters

Estimation Strategy I

ğ›¿

True Values

ğ›½

Ëœ
ğ›½

ğ›¼0

Estimation Strategy II

ğ›¼1

ğ›¿

ğ›½

Ëœ
ğ›½

ğ›¼0

ğ›¼1

0.8

0.6

0.7

-0.1

0.5

0.8

0.6

0.7

-0.1

0.5

Mean

0.837

0.633

0.691

-0.098

0.499

0.815

0.588

0.696

-0.100

0.500

Std. Dev.

0.064

0.064

0.069

0.006

0.002

0.045

0.050

0.057

0.007

0.002

Mean

0.860

0.632

0.672

-0.096

0.499

0.821

0.584

0.691

-0.099

0.499

Std. Dev.

0.066

0.079

0.079

0.008

0.003

0.053

0.078

0.077

0.009

0.003

Mean

0.874

0.603

0.678

-0.095

0.499

0.838

0.553

0.713

-0.098

0.500

Std. Dev.

0.104

0.162

0.119

0.020

0.008

0.107

0.160

0.123

0.020

0.009

Sample Size: 240, 000

Sample Size: 120, 000

Sample Size: 12, 500

Table 2: Monte Carlo Results Under the Two Proposed Estimation Methods.
Notes: For each sample size, we generate 2000 random simulation samples. The Mean and Standard Deviations of the
estimated parameters are with respect to the 2000 samples.

5.1

Background on Mammography
Among American women, breast cancer is the third most common cause of death, and the

second leading cause of cancer death. According to American Cancer Society, from birth to age
39, one woman in 231 will get breast cancer (< 0.5% risk); from age 40-59, the chance is 1 in 25 (4%
risk); from age 60-79, the chance is 1 in 15 (nearly 7%). Assuming that a woman lives to age 90,
the chance of getting breast cancer over the course of an entire lifetime is 1 in 7, with an overall
lifetime risk of 14.3%.19
Breast cancer takes years to develop. Early in the disease, most breast cancers cause no symptoms. When breast cancer is detected at a localized stage before it spreads to the lymph nodes),
the 5-year survival rate is 98%. If the cancer has spread to nearby lymph nodes (regional disease),
the rate drops to 81%. If the cancer has spread (metastasized) to distant organs such as the lungs,
bone marrow, liver, or brain, the 5-year survival rate is 26%.
A screening, mammography, is the best tool available to find breast cancer before symptoms
appear. Mammography can often detect a breast lump before it can be felt and therefore save
lives by finding breast cancer as early as possible. For women over the age of 50, mammography
19

As a useful comparison, breast cancer has a higher incidence rate than lung cancer in the US. In 2004, there were
217, 440 new cases for breast cancer in the U.S. (American Cancer Society).

24

have been shown to lower the chance of dying from breast cancer by 35%.20,

21

Leading experts,

the National Cancer Institute, the American Cancer Society, and the American College of Radiology recommend annual mammography for women over 40.22 The guideline issued by the U.S.
Preventive Services Task Force in 2002 also recommended mammography screening for women
beginning at age 40 every 12-24 months in order to reduce the risk of death from breast cancer.23

5.2

Data
The data used in this analysis are from the Health and Retirement Study (HRS). The HRS is a

nationally representative biennial panel study of birth cohorts 1931 through 1941 and their spouses
as of 1992. The initial sample includes 12,652 persons in about 7,600 households who have been
interviewed every two years since 1992. The most recent available data are for year 2008 (wave
9). The survey history and design are described in more details in Juster and Suzman (1995).
Since the HRS started asking women questions about their usage of mammography in 1996, our
sample is limited to women interviewed in the HRS from 1996 to 2008. We focus on the age group
51 to 64, and exclude those observations with missing values for any of the critical variables.24
We also exclude those who have ever been diagnosed of (breast) cancer,25 since those who are
diagnosed of cancer might be of a different group who do not make decisions on mammography
or any other preventive health care the same way as do others. Our final sample consists of 12,307
observations (each observation is a two-period short panel pooled from two consecutive waves)
for 7,021 individuals.
20

Source: American Cancer Society.
Also note that finding breast cancers early with mammography has also meant that many more women being
treated for breast cancer are able to keep their breasts. When caught early, localized cancers can be removed without
resorting to breast removal.
22
See American Cancer Society website: http://www.cancer.org/Cancer/BreastCancer/DetailedGuide. Women age
40 and older should have a screening mammogram every year and should continue to do so for as long as they are in
good health.
23
The new guideline by the U.S. Preventive Service Task Force issued in November of 2009 changed its recommendation for women in their 40s. Now the guideline recommends that women in their 40s should not get routine mammograms for early detection of breast cancer. For women ages 50 to 74, it recommends routine mammography screenings
every two years. The American Cancer Society maintains its original recommendation that women from their 40s
should seek annual mammography.
24
The key variables are education status, non-Hispanic white, education, self-reported health, insurance status,
whether father and mother are alive or died after age 70, father and mothers education, income, and mammography
usage (see Table 3 for their summary statistics).
25
For those who entered in 1992 (i.e. the first wave), we know whether they have been diagnosed of breast cancer as
of 1992. But for those who entered HRS in later waves, we only know whether any cancer has been diagnosed of since
the survey from 1994 did not ask about breast cancer specifically.
21

25

5.3

Descriptive Statistics
Table 3 provides summary statistics of the key variables for the sample we use in our empirical

analysis. The sample of women we select are aged from 51 to 64 (note that we are combining twoperiod panels using individuals that appear in two consecutive samples), with an average age of
57.8. A large majority of the sample are non-Hispanic white (80%) and with at least high school
education (78%). The average household income in our sample is about 49,680 dollars. 23% of the
sample has a self-reported bad health and about 76% of the women undertook mammogram in
the survey year. About 1.5% of the women who were surveyed in a wave died within two years.
72% of our sample reported having at least one insurance plan. Finally, about 75% of the mothers
(respectively, about 61% of the fathers) of the women in our sample are either still alive or died
at age greater than 70 at the time of the interview. 43% of the mothers (respectively, about 40% of
the fathers) of the women in our sample finished at least high school. From one wave to the next
wave, there is slight increase in the fraction of survivors who report bad health (an increase from
23% to 25%).

5.4

Decision Time Line
Figure 1 depicts the time line for mammography decisions for women in our sample. As we

mentioned earlier, we only consider women who are alive and have not yet been diagnosed with
any cancer (thus not breast cancer) in the first period. Given her period-1 state variables, she makes
the decision of whether to undertake mammography. Mammography detects breast cancer with
very high probability, though not for certain, if the woman has breast cancer. In the event that the
woman has breast cancer, early detection of breast cancer will lead to higher survival probability.
To fully capture the diagnostic nature of mammography, we would need to have information
about whether the woman has breast cancer at any period, and estimate the probability of detecting breast cancer with (ğ‘1 in Figure 1) and without (ğ‘2 in Figure 1) mammogram. However, we do
not have access to such data. In HRS, even though we have information on womenâ€™s mammography choices from 1996 on and we know whether their doctors have told them that they have any
cancer, we do not have information on which kind of cancer they have been diagnosed of.26
Due to these data issues, we decide to go directly from the mammography decision to the
live/death outcome and health status if alive (see our empirical specification below), without
going through the intermediate step (having breast cancer or not). That is, we simply capture the
ultimate effect of undertaking mammography as to lower the probability of dying, and to lower
26
Even for those over age 65 with matching Medicare claim data, the number of observations is not big enough for
us to get the needed probabilities of being diagnosed with breast cancer with and without mammography stratified by
all the state variables we want to control in our model such as age, race, health status, income, and education status.

26

Variable

Mean

Std. Dev.

Min

Max

Obs.

Mammogram

0.760

0.427

0

1

12307

Bad Health

0.230

0.421

0

1

12307

Married

0.704

0.456

0

1

12307

White (Non-Hispanic)

0.797

0.402

0

1

12307

High School

0.775

0.417

0

1

12307

Age

57.82

3.95

51

64

12307

Death

0.015

0.120

0

1

12307

Insurance

0.720

0.449

0

1

12307

Household Income ($1000)

49.68

68.34

0.101

2,136

12307

Log of Household Income

10.31

1.06

4.62

14.57

12307

Mother Still Alive or Died After Age 70

0.750

0.432

0

1

12307

Mother Education (High School or Higher)

0.431

0.495

0

1

12307

Father Still Alive or Died After Age 70

0.611

0.488

0

1

12307

Father Education (High School or Higher)

0.404

0.491

0

1

12307

Bad Health (ğ‘¡ + 1)

0.249

0.432

0

1

12128

Household Income (ğ‘¡ + 1) ($1000)

48.75

178.70

0.103

17,600

12128

Log of Household Income (ğ‘¡ + 1)

10.27

1.05

4.64

16.68

12128

Table 3: Summary Statistics of Key Variables in the Estimation Sample.
Note: The last three variables in the table are observed only for those who survive to the second period.

27

Alive and Does Not
Detect Breast Cancer








=
Q

ğ‘1 


+

Detect

A
U
A
Dead




@
@
R
@
No Mammogram


+

Does Not Detect




Detect

Q
s
Q
Does Not Detect

ğ‘4 J

J
J
^
J

Alive

Q
Q

ğ‘2 

Q
Q
s
Q

ğ‘3 A





@




Mammogram

Alive

@

@



Dead

Alive

J
^
J
Dead



@
R
@

Alive

Dead

Figure 1: The Timeline for Mammography Decisions.
Notes: (1). ğ‘1 > ğ‘2 : mammogram can detect breast cancer at its early stage; ğ‘3 > ğ‘4 : survival rate is higher
when breast cancer is detected at earlier stage.
(2). The states with rectangular framebox are those in which she will keep making decisions on whether to undertake
mammography.

the probability of being in bad health status if alive.

5.5

Empirical Specification
For this application, we assume that each woman in our sample decides whether or not to

undertake mammography each period (ğ‘– = 1 if she does and ğ‘– = 0 if she does not). From the
previous section on identification, we need to impose some normalization of the contemporaneous
utilities. We normalize the individualâ€™s instantaneous utility at the death state to be zero. Note
that no decision is necessary if one reaches the death state.
Now we describe the state variables we use in our empirical specification. They include: Age
(A GE); Education Status (H IGH S CHOOL ); Bad Health (B AD H EALTH ) which indicates whether the
individual self reports bad health; Log of Per Capita Income (L OG I NCOME), Death (D EATH) and
whether her mother is still alive or died at age greater than 70 (M OTHER 70).
If an individual stays alive, then we specify her utility from taking mammogram relative to not
taking mammogram as:
ğ‘¢1 (ğ‘¥) âˆ’ ğ‘¢0 (ğ‘¥) = ğ›¼0 + ğ›¼1 B AD H EALTH + ğ›¼2 L OG I NCOME + ğœ€ğ‘¡ ,

28

(28)

where â€œB AD H EALTHâ€ is a binary variable indicating whether the agent is in bad health or not
at time ğ‘¡; â€œL OG I NCOMEâ€ denotes the logarithm of household income of the agent at time ğ‘¡, ğ›¼0
and ğ›¼1 are the utility parameters, and ğœ€ğ‘¡ denotes difference in the choice-specific utility shocks
at time ğ‘¡. It is important to remark that even though the other state variables A GE, W HITE and
H IGH S CHOOL do not show up in the above specification, it does not mean that these variables do
not affect the instantaneous utility of the individual; what it means is that these variables affect
the instantaneous utility under action 1 (mammogram) and action 0 (no mammogram) in exactly
the same way.
The agents make their decisions about whether to get mammography by comparing the expected summations of current and discounted future utilities from each choice. Individuals are
uncertain about their future survival probabilities, and if alive, the transition probabilities of future health and income. These probabilities depend on their choices about whether or not to
get mammography; time-variant state variables including their lagged health status, their lagged
income, and their age, denoted as A GE; and time-invariant state variables including their race,
denoted by a binary variable W HITE, their education status H IGH S CHOOL, and the longevity of
their mothers, denoted by the binary variable M OTHER 70 which takes value 1 if the mother is still
alive or died at the age older than 70 and 0 otherwise, and M OTHER H IGH S CHOOL (a binary variable which takes value 1 if mother finished high school or more, and 0 otherwise), or analogously,
FATHER 70 and FATHER H IGH S CHOOL (see Table 5 for the specifications).
Exclusion Variables.

From the assumptions for exclusion restriction variables (see Assumption

5), we know that any variables that do not enter the relevant instantaneous payoff (after normalization), i.e. ğ‘¢1 (ğ‘¥) âˆ’ ğ‘¢0 (ğ‘¥) , but affect the transition of payoff relevant state variables, can qualify
as exclusion variables. Since only the variables B AD H EALTH, L OG I NCOME and D EATH enter the
instantaneous payoff functions (after normalization), the other variables that affect the transition
of the above three variables can all qualify as potential exclusion restriction variables, including
M OTHER 70, W HITE, M ARRIED, H IGH S CHOOL, A GE, or any other variables that one may find to
have important effects on the transition of the state variables relevant to the instantaneous payoff
functions, but do not directly affect the instantaneous payoff function (e.g., we experimented with
insurance status in some of our specifications).27 In what follows, we report estimation results
under two sets of exclusion variables. The sets of exclusion restriction variables are listed in the
last panel in Table 6, and they differ in whether we use M OTHER 70 and M OTHER H IGH S CHOOL
or we use FATHER 70 and FATHER H IGH S CHOOL. The first step estimates reported in Table 4 and
27

See, e.g., Ayanian et al (1993) and Decker (2005) for the relationship between health insurance and health outcomes
for women with breast cancer.

29

Variable

(1)

(2)

Coeff. Est.

Std. Err.

Coeff. Est.

Std. Err.

B AD H EALTH

0.049

(0.059)

0.022

(0.062)

M ARRIED

0.220***

(0.058)

0.212***

(0.060)

W HITE

-0.212***

(0.060)

-0.159***

(0.062)

I NSURANCE

0.351***

(0.048)

0.354***

(0.050)

H IGH S CHOOL

0.373***

(0.061)

0.347***

(0.063)

L OG I NCOME

0.318***

(0.027)

0.324***

(0.028)

M OTHER 70

-0.106**

(0.054)

M OTHER H IGH S CHOOL

0.107***

(0.050)

FATHER 70

0.081*

(0.048)

FATHER H IGH S CHOOL

0.093***

(0.051)

A GE

0.008

(0.006)

0.007

(0.006)

C ONSTANT

-3.032***

(0.451)

-3.185***

(0.471)

Pseudo-ğ‘…2

0.0385

0.0380

Table 4: Determinants of Mammography Decisions: The Choice Probabilities from Logit Regression.
Notes: *, **, *** represents statistical significance at 10%, 5% and 1% respectively. Robust standard errors are presented.

5, as well as Figure 2, suggest that both mother and father side variables affect the transitions of
the payoff relevant state variables.

5.6

Estimation Results

5.6.1

First Step Estimates

As we noted earlier, our estimation strategy has two steps. In the first step, we need to use
the data to estimate choice probabilities, and the state transitions. Here we report these first-step
estimation results. The choice probabilities and the death probability are estimated using Logit
regressions; but the transition of B AD H EALTH and L OG I NCOME are estimated non-parametrically.
Logit Estimates of the Probability of Choosing Mammography as a Function of The State
Variables. Table 4 produces the reduced form Logit regression results for the determinants of
whether a woman will undertake mammogram in a given year under two specifications on the
exclusion variables. Column (1) uses M OTHER 70 and M OTHER H IGH S CHOOL together with other
exclusion variables, while Column (2) uses FATHER 70 and FATHER H IGH S CHOOL instead. In the
30

Variable

(1)

(2)

Coeff. Est.

Std. Err.

Coeff. Est.

Std. Err.

M AMMOGRAM

-0.525***

(0.174)

-0.498***

(0.182)

B AD H EALTH

1.733***

(0.191)

1.715***

(0.193)

M ARRIED

0.105

(0.197)

0.165

(0.202)

W HITE

-0.132

(0.191)

-0.105

(0.202)

I NSURANCE

0.209

(0.193)

0.357*

(0.205)

H IGH S CHOOL

0.295

L OG I NCOME

-0.240***

(0.082)

M OTHER 70

-0.366**

(0.180)

M OTHER H IGH S CHOOL

0.045

(0.194)

(0.198)

0.400*

(0.206)

-0.247***

(0.080)

FATHER 70

-0.325*

(0.175)

FATHER H IGH S CHOOL

-0.295

(0.206)

A GE

0.073***

(0.022)

0.067***

(0.017)

C ONSTANT

-6.609***

(1.557)

5.20

(20.47)

Pseudo-ğ‘…2

0.1073

0.1055

Table 5: Determinants of Probability of Dying in Two Years.
Notes: *, **, *** represents statistical significance at 10%, 5% and 1% respectively. Robust standard errors are presented.

specification reported in Column (1), we find that women who are married with higher household income, with high school education, and with health insurance are more likely to undertake
mammograms, while white women are less likely than black women to undertake mammogram.
All these coefficient estimates are significant at 1%. Interestingly, we also find that women whose
mothers are still alive or died after age 70 are less likely, but those whose mothers have at least high
school are more likely to undertake mammograms. Finally, older women and women with bad
health are more likely to undertake mammogram, though these coefficients are not statistically
different from zero.
In the specification reported in Column (2), where we use the information about womenâ€™s
father as the exclusion variables, none of the other coefficient estimates change qualitatively. Interestingly we found that FATHER 70 and FATHER H IGH S CHOOL both positively affect womenâ€™s
probability of undertaking mammogram.28
28

Note that the coefficient estimates from such reduced form regressions, while informative, does not shed light on
the mechanisms under which the observed relationships between a variable and the mammogram decision arises. For
example, we see in Table 4 that women whose mother is still alive or died after age 70 are less likely to undertake
mammogram. But it is not clear from the table why. The structural analysis we undertake below will help us to achieve

31

Transition Probabilities of the Payoff Relevant State Variables: Determinants of the Probability of Dying in Two Years

Table 5 reports the Logit regression results for the probability of dying

in two years, again using two sets of exclusion variables, with Column (1) using M OTHER 70 and
M OTHER H IGH S CHOOL and Column (2) using FATHER 70 and FATHER H IGH S CHOOL. The coefficient estimates show that undertaking mammogram significantly lowers the probability of death
(notice that the average age of the sample is about 58 years). Not surprisingly, women with bad
health are more likely to die, but mammogram reduces the probability of dying conditional on
bad health. Also note that women whose mothers are either still alive or died after age 70 as well
as women whose fathers are either still alive or died after age 70, are less likely to die, suggesting
a genetic link of longevity between mothers as well as fathers and daughters.
Transition Probabilities of the Payoff Relevant State Variables: Evolution of Bad Health in Two
Years Figure 2 depicts a subset of the results from the non-parametric estimation of the evolution
of B AD H EALTH for a selective combinations of the other state variables and the mammogram
choice, for our exclusion restriction variable specification listed in Column (1) in Table 6. For
example, Panel (a) shows that how the probability of having bad health in period 2 is affected by
mammogram decision in the previous period and L OG I NCOME, for women whose mothers are
alive or died after age 70 and had bad health in the previous period. It shows that the probability
of bad health decreases with Log Income, and is lower if one undertakes mammogram in the
previous period. Similar negative relationship between the probability of bad health and income is
also shown in other panels. Across all panels, we see that mammogram always reduces probability
of bad health , and good health in the previous period predicts a higher probability of good health
this period, and mother living or having died after 70 reduces the probability of bad health. A
similar non-parametric estimation of L OG I NCOME is also conducted.
5.6.2

Second Step Estimates: Utility Parameters and Discount Factors

Table 6 reports the estimation results for the parameters in the instantaneous utility function
Ëœ as well as standard errors calspecification (28) and the identified discount factors ğ›¿, ğ›½ and ğ›½,
culated from the asymptotic distributions of the maximum pseudo-likelihood estimator. We report results from two specifications using different sets of exclusion restriction variables. In the
specification reported in Column 1, we include only W HITE, A GE , M ARRIED , H IGH S CHOOL , I N SURANCE ,

M OTHER 70, and M OTHER H IGH S CHOOL as the exclusion restriction variables, while

in the specification reported in Column 2, we replace M OTHER 70, and M OTHER H IGH S CHOOL by
FATHER 70, and FATHER H IGH S CHOOL.
a better understanding of the observed reduced form relationship reported in Table 4.

32

33

Figure 2: Non-parametric Estimate of the Probability of B AD H EALTH as a Function of L OG I NCOME, Conditional on M OTHER 70,
B AD H EALTH and M AMMOGRAM in Previous Period.

(1)

(2)

Panel A: Instantaneous Utility Function Parameters

B AD H EALTH
L OG I NCOME
C ONSTANT

-0.278***

-0.443***

(0.084)

(0.102)

1.205***

1.278***

(0.060)

(0.034)

-1.035

-2.079***

(0.205)

(0.026)

Panel B: Time Preference Parameters

ğ›¿
ğ›½
Ëœ
ğ›½

0.722***

0.795***

(0.089)

(0.026)

0.718***

0.752***

(0.070)

(0.019)

0.9999***

0.9999***

(0.060)

(0.000)

Panel C: Hypothesis Tests
H0 : ğ›½ = 1

Reject

Reject

Ëœ=ğ›½
H0 : ğ›½

Reject

Reject

Exclusion Restriction Variables:

W HITE

Yes

Yes

A GE

Yes

Yes

M ARRIED

Yes

Yes

H IGH S CHOOL

Yes

Yes

I NSURANCE

Yes

Yes

M OTHER 70

Yes

No

M OTHER H IGH S CHOOL

Yes

No

FATHER 70

No

Yes

FATHER H IGH S CHOOL

No

Yes

Table 6: Parameter Estimates for the Instantaneous Utility Function and Time Preference Parameters Under Two Sets of Exclusive Restriction Variables.
Notes: (1). The last panel indicates the exclusive restriction variables used in the specification in that column,
with â€Yesâ€ meaning the variable is used, and â€Noâ€ otherwise; (2). Standard errors for parameter estimates are in
parenthesis, and *** indicates significance at 1% level; (3). For hypothesis tests reported in Panel C, all are rejected with
ğ‘-value less than 0.01.

34

The parameter estimates, both for the instantaneous payoff function parameters and the time
preference parameters, are quite similar both qualitatively and quantitatively, across the two specifications. We find that having bad health lowers the utility of undertaking mammography relative to not undertaking mammography. We also found that the relative utility of undertaking
mammography increases with income, consistent with the finding in Table 4 that women with
higher incomes are more likely to undertake mammography. The estimated negative constant
term, though not statistically significant for specification 1, is consistent with the idea that preventative health care typically involves huge one time instantaneous cost, which once combined with
present bias and naivety about present bias might lead to undesirable health-related decisions.
Ëœ to be 0.722, 0.718 and 0.9999 respectively in speciMore interestingly, we estimate ğ›¿, ğ›½ and ğ›½
fication 1 and 0.795, 0.752, and 0.9999 respectively in specification 2. These point estimates show
that women exhibit substantial present bias (ğ›½ < 1) as well as naivety about their present bias
Ëœ > ğ›½) when making mammography decisions. In Panel C, we reported the results from three
(ğ›½
Ëœ = ğ›½ (no naivety) are rejected
hypothesis tests: the null hypothesis ğ›½ = 1 (no present bias) and ğ›½
under both specifications with ğ‘-value less than 0.01.
It is also interesting to compare our estimates for ğ›½ğ›¿ with what is in the literature. Using the
estimates of ğ›½ and ğ›¿ reported in Table 6, we have that our estimates for ğ›½ğ›¿ is equal to 0.718âˆ—0.722 â‰ˆ
0.518 under specification 1 and is equal to 0.752 âˆ— 0.795 â‰ˆ 0.598 under specification 2. This can be
compared with the estimate in Fang and Silverman (2009) where they estimate ğ›½ to be 0.338 and ğ›¿
to be 0.88, with ğ›½ğ›¿ â‰ˆ 0.30 for a group of single mothers with dependent children. It is important to
note that our sample period is two years, while Fang and Silverman (2009)â€™s sample period is one
year; also the sample of women in this paper are older and have very different social economic
status (e.g. education and income) from the sample in Fang and Silverman (2009).

5.7

Counterfactual Experiments
Table 7 reports the mammography compliance rates predicted by the model and implied by

two counterfactual experiments where in experiment [1], we assess the mammography rates preËœ equal to the estimated ğ›½,
Ë† and in experiment [2],
dicted by the model if we hypothetically set ğ›½
Ëœ and ğ›½ to 1. Experiment [1] allows us to assess the impact of naivety on mammogwe set both ğ›½
raphy take-up rate, while experiment [2] allows us to assess the impact of both present bias and
the naivety about present bias. If women in our sample are present-biased but fully sophisticated (i.e. in experiment 1), then the mammography compliance rate increases from 76.12% in the
data to 77.96%, and both are which is very similar to a baseline model predicted compliance rate
(76.09%). If, however, we have a case where the agents are exponential discounters (i.e., in experiment 2), that is, they do not have time-inconsistent preference, then the compliance rate goes up
35

Exclusion Restriction Variables
(1)

(2)

Data

0.7612

0.7631

Model

0.7609

0.7794

Ëœ = ğ›½[= ğ›½]
Ë†
[1] No Naivety: ğ›½

0.7796

0.7874

Ëœ=ğ›½=1
[2] No Naivety and No Present Bias: ğ›½

0.8196

0.8099

Counterfactual Experiments:

Table 7: Mammography Compliance Rates Predicted by the Model and Implied by Different
Counterfactual Experiments.
Notes: (1). The sample sizes slightly vary as we change the set of the exclusive restriction variables, which explains the changes in the mommography compliance rates in the data; (2). The exclusive restriction variables used in
Columns 1 and 2 corresponds to those used in specifications 1 and 2 in Table 6 respectively.

from 76.12% to 81.96%, which represents a 23.5% (= [(1 âˆ’ 0.7612) âˆ’ (1 âˆ’ 0.8196)]/(1 âˆ’ 0.7512))
reduction in the mammography noncompliance rate. Thus, time-inconsistent preferences caused
by present-bias and naivety about present-bias indeed have significant policy implications for the
low compliance rates of preventive health care in the U.S.

6

Conclusion and Discussions
This paper extends the semi-parametric identification and estimation method for dynamic dis-

crete choice models using Hotz and Millerâ€™s (1993) conditional choice probability (CCP) approach
to the setting where individuals may have hyperbolic discounting time preferences and may be
naive about their time inconsistency.
Our analysis showed that the three discount factors, the present bias factor ğ›½, the standard
Ëœ for naive agents can be separately idendiscount factor ğ›¿ and the perceived present bias factor ğ›½
tified. The key identifying restriction is that there exist variables that do not directly enter the
instantaneous utility function but affect the transition of other payoff relevant state variables.
We proposed two estimation strategies based on the identification argument, and implement
the proposed estimation method to the decisions of undertaking mammography to evaluate the
importance of present bias and naivety in the under-utilization of mammography. Our estimates
are consistent with the presence of both present bias and naivety about present bias. In our counterfactual experiments, we found that time-inconsistent preferences caused by present-bias and
naivety about present-bias indeed have significant policy implications for the compliance rates of
mammography take-up rates.
36

In our paper, we also assume that the model is stationary. In many applications, such stationarity assumption may not be valid. However, we show in the Appendix that the identification
arguments, properly modified, still work for the case of finite horizon models with non-stationary
state transitions. Of course, estimating finite horizon models with non-stationary state transitions
requires longer panels.
In this paper, we assumed that other than the choice-specific idiosyncratic payoff shocks,
which we assume to be serially and cross-sectionally independent, we do not allow for any observed heterogeneity or unobserved state variables among individuals. Recent results by Kasahara and Shimotsu (2009) and Hu and Shum (2009) show that the conditional choice probabilities, which are crucial for implementing Hotz-Miller type estimators, can be identified in the
presence of unobserved heterogeneity or unobserved state variables in the context of dynamic
discrete choice models with exponential discounting.29 Whether their arguments still work for
dynamic discrete choice models with hyperbolic discounting preferences remains an open question. Provided that conditional choice probabilities for any given state, including both observed
and unobserved state variables, can be identified, the estimation methods we proposed here may
be still valid. This is an important question we will examine in future research.

References
[1] Aguirregabiria, Victor, and Pedro Mira (2007a). â€œSequential Estimation of Dynamic Discrete
Games.â€ Econometrica, Vol 70, 1519-1543.
[2] Aguirregabiria, Victor, and Pedro Mira (2007b). â€œDynamic Discrete Choice Structural Models:
A Survey.â€ Working Paper 297, Department of Economics, University of Toronto.
[3] Ainslie, G., Picoeconomics: The Strategic Interaction of Successive Motivational States Within the
Person (Cambridge [England]; New York: Cambridge University Press, 1992).
[4] Arcidiacono, P., H. Sieg, and F. Sloan (2007). â€œLiving Rationally Under the Volcano? An
Empirical Analysis of Heavy Drinking and Smoking.â€ International Economic Review, 48(1),
37-65.
[5] Arcidiacono, P., and R. Miller (2007). â€œCCP Estimation of Dynamic Discrete Choice Models
with Unobserved Heterogeneity.â€ Working Paper.
29

Arcidiacono and Miller (2007) proposed an EM algorithm to estimate such models with unobserved heterogeneity
using conditional choice probabilities.

37

[6] Ayanian, J. Z., B. A. Kohler, T. Abe, and A. M. Esptein (1993). â€œThe Relation between Health
Insurance Coverage and Clinical Outcomes among Women with Breast Cancer.â€ The New
England Journal of Medicine, 329(5), 326-331.
[7] Bajari, Patrick, C. Lanier Benkard and Jonathan Levin (2007). â€œEstimating Dynamic Models
of Imperfect Competition.â€ Econometrica, vol. 75, No. 5, 1331-1370.
[8] Bajari, Patrick, Han Hong and Denis Nekipelov (2010). â€œGame Theory and Econometrics: A
Survey of Some Recent Research.â€ Econometric Society World Congress in Shanghai.
[9] Barro, Robert J., â€œRamsey Meets Laibson in the Neoclassical Growth Model,â€ Quarterly Journal of Economics 114 (November 1999), 1125-1152.
[10] Carrillo, Juan D., and Thomas Mariotti, â€œStrategic Ignorance as a Self-Disciplining Device,â€
Review of Economic Studies 67 (July 2000), 529-544.
[11] Chung, Doug, Thomas J. Steenburgh and K. Sudhir (2009). â€œDo Bonuses Enhance Sales Productivity? A Dynamic Structural Analysis of Bonus-Based Compensation Plans.â€ Working
Paper, Yale School of Management.
[12] Decker, S. L. (2005). â€œMedicare and the Health of Women with Breast Cancer.â€ The Journal of
Human Resources, 40(4), 948-968.
[13] Degnan, D., R. Harris, J. Ranney, D. Quade, J. A. Earp, and J. Gonzalez (1992). â€œMeasuring the
Use of Mammography: Two Methods Compared.â€ American Journal of Public Health, 82(10),
1386-1388.
[14] Della Vigna, Stefano and Daniele Paserman (2005). â€œJob Search and Impatience.â€ Journal of
Labor Economics, 23(3), July, 527-588.
[15] Fang, Hanming, and Dan Silverman (2004). â€œOn the Compassion of Time-Limited Welfare
Programs.â€ Journal of Public Economics, 88, 1445-1470.
[16] Fang, Hanming, and Dan Silverman (2006). â€œDistinguishing Between Cognitive Biases: Belief
vs. Time Discounting in Welfare Program Participation.â€ in Behavioral Public Finance, edited
by Edward J. McCaffery and Joel Slemrod, Russell Sage Foundation.
[17] Fang, Hanming, and Dan Silverman (2009). â€œTime-inconsistency and Welfare Program Participation. Evidence from the NLSY.â€ International Economic Review, Vol. 50, No. 4, 1043-1076.
[18] Gruber, J., and B. Koszegi (2001). â€œIs Addiction â€œRationalâ€? Theory and Evidence.â€ Quarterly
Journal of Economics, 116(4), 935-958.
38

[19] Hausman, Jerry A. (1979). â€œIndividual Discount Rates and the Purchase and Utilization of
Energy-using Durables.â€ Bell Journal of Economics, 10(1): 33-54.
[20] Hotz, Joseph, and Robert Miller (1993). â€œConditional Choice Probabilities and Estimation of
Dynamic Models.â€Review of Economic Studies, 60, 497-529.
[21] Juster, F. Thomas, and Richard Suzman (1995). â€œAn Overview of the Health and Retirement
Study.â€ Journal of Human Resources, 30(5): S7-S56.
[22] Kasahara, H., and K. Shimotsu (2009). â€œNonparametric Identification of Finite Mixture Models of Dynamic Discrete Choices.â€ Econometrica, 77(1), 2009, 135-175.
[23] Krusell, Per, Burhanettin KurusÌ§cÌ§u and Anthony Smith, Jr., â€œEquilibrium Welfare and Government Policy with Quasi-Geometric Discounting,â€ Journal of Economic Theory 105 (July 2002),
42-72.
[24] Laibson, David (1997). â€œGloden Eggs and Hyperblic Discounting.â€ Quarterly Journal of Economics, 112(2), 443-477.
[25] Laibson, David, Andrea Repetto, and Jeremy Tobacman (2007). â€œEstimating Discount Functions with Consumption Choices Over the Lifecycle.â€ Working Paper, Harvard University.
[26] Loewenstein, George, and Jon Elster, Choice Over Time (Russell Sage: New York, 1992).
[27] Mahajan, Aprajit and Alessandro Tarozzi (2010). â€œTime Inconsistency, Expectations and Technology Adoption: The Case of Insecticide Treated Nets.â€ Work in Progress, Stanford and
Duke University.
[28] Magnac, T., and D. Thesmar (2002). â€œIdentifying Dynamic Discrete Decision Processes.â€
Econometrica, 20(2), 801-816.
[29] Miller, Robert (1984). â€œJob Matching and Occupational Choice.â€ Journal of Political Economy,
92(6), 1086-1120.
[30] Oâ€™Donoghue, T., and M. Rabin (1999a). â€œDoing It Now or Later.â€ The American Economic Review, 89(1), 103-124.
[31] Oâ€™Donoghue, T., and M. Rabin (1999b), â€œAddiction and Self-Control.â€ In Jon Elster, editor,
Addiction: Entries and Exits, New York: Russell Sage.
[32] Pakes, Ariel (1986). â€œPatents as Options. Some Estimates of the Value of Holding European
Patent Stocks.â€ Econometrica, 54, 755-785.
39

[33] Ariel Pakes and Paul McGuire (1994). â€œComputing Markov Perfect Nash Equilibrium: Numerical Implications of a Dynamic Differentiated Product Model.â€ RAND Journal of Economics, Vol. 25, No. 4, 555-589.
[34] Pakes, Ariel, Michael Ostrovsky, and Steven Berry (2007). â€œSimple Estimators for the Parameters of Discrete Dynamic Games (with Entry/Exit Samples).â€ RAND Journal of Economics,
Vol. 38, No.2, 373-399.
[35] Paserman, M. Daniele (2008). â€œJob Search and Hyperbolic Discounting: Structural Estimation
and Policy Evaluation.â€ Economic Journal, 118(531), 1418-1452.
[36] Pesendorfer, Martin, and Philipp Schmidt-Dengler (2003). â€œIdentification and Estimation of
Dynamic Games.â€ NBER working paper 9726.
[37] Phelps, Edmund S., and Robert. A. Pollak (1968). â€œOn Second-Best National Saving and
Game-Equilibrium Growth.â€The Review of Economic Studies, 35(2), 185-199.
[38] Rust, John (1987). â€œOptimal Replacement of GMC Bus Engines. An Empirical Model of
Harold Zurcher.â€ Econometrica, 55(5), 999-1033.
[39] Rust, John (1994a). â€œEstimation of Dynamic Structural Models, Problems and Prospects: Discrete Decision Processes,â€ in Christopher Sims and J.J. Laffont, eds., Proceedings of the 6th
World Congress of the Econometric Society. Cambridge University Press.
[40] Rust, John (1994b). â€œStructural Estimation of Markov Decision Processes,â€ in Robert Engle
and Daniel McFadden eds., Handbook of Econometrics, Vol. IV. Amsterdam: North-Holland.
[41] Strotz, Robert H. (1956). â€œMyopia and Inconsistency in Dynamic Utility Maximization.â€ The
Review of Economic Studies, 23(3), 165-180.
[42] Warner, John T., and Saul Pleeter (2001). â€œThe Personal Discount Rate: Evidence from Military
Downsizing Programs.â€ American Economic Review, 91(1): 33-53.
[43] Wolpin, Kenneth I. (1984). â€œAn Estimable Dynamic Stochastic Model of Fertility and Child
Mortality.â€ Journal of Political Economy, 92, 852-874.

40

A

Finite Horizon with Non-Stationary State Transition
This Appendix discusses the identification strategy for a dynamic discrete choice model for

(potentially naive) hyperbolic discounters with finite horizon and non-stationary state transitions.
The time period in this case goes from ğ‘¡, the current period, until ğ‘‡ , the end of horizon. In this
section, we will use superscripts ğ‘¡, ğ‘¡+1, ğ‘¡+2, ..., ğ‘‡ to denote the time period for all the components
in our analysis for clarification. The discussion in this section will be shorter and less detailed that
that in Section 2, as will soon be clear that the identification strategy for this non-stationary case is
essentially the same as the one for the stationary case, with only minor modification.
( )
First, define the current choice-specific value function, ğ‘Šğ‘–ğ‘¡ ğ‘¥ğ‘¡ , as follows:
ğ‘Šğ‘–ğ‘¡ (ğ‘¥ğ‘¡ ) = ğ‘¢ğ‘¡ğ‘– (ğ‘¥ğ‘¡ ) + ğ›½ğ›¿

âˆ‘

ğ‘‰ ğ‘¡+1 (ğ‘¥ğ‘¡+1 )ğœ‹(ğ‘¥ğ‘¡+1 âˆ£ğ‘¥ğ‘¡ , ğ‘–)ğ‘‘ğ‘¥ğ‘¡+1 .

(A1)

ğ‘¥ğ‘¡+1 âˆˆğ’³

Then, define the choice-specific value function of the next-period self as perceived by the current
self, ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ), as follows:
Ëœ
ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = ğ‘¢ğ‘¡+1
(ğ‘¥ğ‘¡+1 ) + ğ›½ğ›¿
ğ‘–

âˆ‘

ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 ) ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘–).

(A2)

ğ‘¥ğ‘¡+2 âˆˆğ’³

Given ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ), we know that the current selfâ€™s perception of her future selfâ€™s choice, i.e., ğœ
Ëœ
as defined in Definition 2 is simply
â¡
(

)
t+1

ğœ
Ëœ ğ‘¥ğ‘¡+1 , ğœºi

â¤

Ëœ
= max â£ğ‘¢ğ‘¡+1
(ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘–,ğ‘¡+1 + ğ›½ğ›¿
ğ‘–
ğ‘–âˆˆâ„

âˆ‘

ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘–)â¦

ğ‘¥ğ‘¡+2 âˆˆğ’³

[
]
= max ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘–,ğ‘¡+1 .
ğ‘–âˆˆâ„

Let us define the probability of choosing alternative ğ‘— by the the next period self as perceived
by the current period self, ğ‘ƒËœğ‘— (ğ‘¥ğ‘¡+1 ), when next period state is ğ‘¥ğ‘¡+1 :
ğ‘ƒËœğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = Pr [Ëœ
ğœ (ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ) = ğ‘—]
[
]
= Pr ğ‘ğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘—,ğ‘¡+1 â‰¥ ğ‘ğ‘—ğ‘¡+1
(ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘— â€² ,ğ‘¡+1 , âˆ€ğ‘— â€² âˆ•= ğ‘— .
â€²
Further denote
ğ‘‰ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = ğ‘¢ğ‘¡+1
(ğ‘¥ğ‘¡+1 ) + ğ›¿
ğ‘–

âˆ‘
ğ‘¥ğ‘¡+2 âˆˆğ’³

41

ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘–).

(A3)

According to the definition of ğ‘‰ (â‹…) as given by (2), ğ‘‰ ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) is simply the expected value
[ ğ‘¡+1
]
of ğ‘‰ğ‘– (ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘¡+1
where ğ‘– is the chosen alternative according to ğœ
Ëœ (ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ). Thus it must
ğ‘–
satisfy the following relationship:
[
]
ğ‘¡+1
ğ‘‰ ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = Eğœºt+1 ğ‘‰ğœËœğ‘¡+1
(ğ‘¥
)
+
ğœ€
ğ‘¡+1
(ğ‘¥ğ‘¡+1 ,ğœºğ‘¡+1 )
ğœ
Ëœ (ğ‘¥ğ‘¡+1 ,ğœºğ‘¡+1 ) .

(A4)

Now note from (A2) and (A3), we have
(
) âˆ‘
Ëœ ğ›¿
ğ‘‰ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) + 1 âˆ’ ğ›½
ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘–).

(A5)

ğ‘¥ğ‘¡+2 âˆˆğ’³

The relationship in (A5) is crucial as it allows us to rewrite (A4) as:
[
]
ğ‘‰ ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = Eğœºğ‘¡+1 ğ‘‰ğœËœğ‘¡(ğ‘¥ğ‘¡+1 ,ğœºğ‘¡+1 ) (ğ‘¥ğ‘¡+1 ) + ğœ€ğœËœ (ğ‘¥ğ‘¡+1 ,ğœºğ‘¡+1 ),ğ‘¡
â¤
â¡
ğ‘¡+1
ğ‘ğ‘– (ğ‘¥ğ‘¡+1 ) + ğœ€ğœËœ (ğ‘¥ğ‘¡+1 ,ğœºt+1 ),ğ‘¡
â¥
â¢
= Eğœºğ‘¡+1 â£ (
â¦
) âˆ‘
ğ‘¡+2 (ğ‘¥
Ëœ ğ›¿
ğ‘‰
)ğœ‹(ğ‘¥
âˆ£ğ‘¥
,
ğœ
Ëœ
(ğ‘¥
,
ğœº
))
+ 1âˆ’ğ›½
ğ‘¡+2
ğ‘¡+2 ğ‘¡+1
ğ‘¡+1 ğ‘¡+1
ğ‘¥ğ‘¡+2 âˆˆğ’³
[ ğ‘¡+1
]
= Eğœºğ‘¡+1 max ğ‘ğ‘– (ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘–,ğ‘¡+1
ğ‘–âˆˆâ„
(
)
âˆ‘
Ëœ ğ›¿Eğœº
+ 1âˆ’ğ›½
ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğœ
Ëœ (ğ‘¥ğ‘¡+1 , ğœºğ‘¡+1 ))
ğ‘¡+1
ğ‘¥ğ‘¡+2 âˆˆğ’³

[

ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 )

]
= Eğœºğ‘¡+1 max
+ ğœ€ğ‘–,ğ‘¡+1
ğ‘–âˆˆâ„
(
) âˆ‘
âˆ‘
Ëœ ğ›¿
+
1âˆ’ğ›½
ğ‘ƒËœğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 )
ğ‘‰ ğ‘¡+2 (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘—)
ğ‘—âˆˆâ„

(A6)

ğ‘¥ğ‘¡+2 âˆˆğ’³

The probability of observing action ğ‘– being chosen at a given state variable ğ‘¥, in this nonstationary case, is still:
ğ‘ƒğ‘–ğ‘¡ (ğ‘¥ğ‘¡ )

[
]
[
]
{ ğ‘¡
}
exp ğ‘Šğ‘–ğ‘¡ (ğ‘¥ğ‘¡ )
ğ‘¡
[
],
= Pr ğ‘Šğ‘– (ğ‘¥ğ‘¡ ) + ğœ€ğ‘–,ğ‘¡ > max ğ‘Šğ‘— (ğ‘¥) + ğœ€ğ‘—,ğ‘¡ = âˆ‘
ğ¼
ğ‘¡ (ğ‘¥ )
ğ‘—âˆˆâ„âˆ–{ğ‘–}
exp
ğ‘Š
ğ‘¡
ğ‘—=0
ğ‘—

(A7)

where ğ‘ƒğ‘–ğ‘¡ (ğ‘¥ğ‘¡ ) is the current-period selfâ€™s equilibrium choice probabilities and will be observed in
the data.
The relationship between ğ‘Šğ‘– and ğ‘ğ‘– can no longer be described as in Equation 13, however,
we still have
Eğœºğ‘¡+1 max{ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) + ğœ€ğ‘–,ğ‘¡+1 } = ln
ğ‘–âˆˆâ„

{
âˆ‘
ğ‘–âˆˆâ„

42

}
[ ğ‘¡+1
]
exp ğ‘ğ‘– (ğ‘¥ğ‘¡+1 ) ,

(A8)

and

[
]
exp ğ‘ğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 )
ğ‘ƒËœğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 ) = âˆ‘ğ¼
[ ğ‘¡+1
].
(ğ‘¥ğ‘¡+1 )
ğ‘–=0 exp ğ‘ğ‘–

(A9)

Using (A8) and (A9), we can rewrite (A6) as
ğ‘‰

ğ‘¡+1

(ğ‘¥ğ‘¡+1 ) = ln

{
âˆ‘

exp

[

ğ‘ğ‘–ğ‘¡+1 (ğ‘¥ğ‘¡+1 )

}
]

ğ‘–âˆˆâ„

[
]
) âˆ‘ exp ğ‘ğ‘—ğ‘¡+1 (ğ‘¥ğ‘¡+1 )
âˆ‘
Ëœ ğ›¿
ğ‘‰ (ğ‘¥ğ‘¡+2 )ğœ‹(ğ‘¥ğ‘¡+2 âˆ£ğ‘¥ğ‘¡+1 , ğ‘—).
+ 1âˆ’ğ›½
[ ğ‘¡+1
]
âˆ‘ğ¼
(ğ‘¥ğ‘¡+2 ) ğ‘¥ğ‘¡+2 âˆˆğ’³
ğ‘–=0 exp ğ‘ğ‘–
ğ‘—âˆˆâ„
(

(A10)

In this non-stationary case with finite horizon, at ğ‘¡ = ğ‘‡ where the continuation value is zero,
we have that
ğ‘ğ‘–ğ‘‡ = ğ‘¢ğ‘‡ğ‘– = ğ‘‰ğ‘–ğ‘‡
which leads to:
ğ‘‰ ğ‘‡ = ln

âˆ‘

exp[ğ‘ğ‘–ğ‘‡ ] = ln

ğ‘–âˆˆâ„

âˆ‘

exp[ğ‘¢ğ‘‡ğ‘– ].

(A11)

ğ‘–âˆˆâ„

Equations (A11) and (A2) combined give us ğ‘ğ‘–ğ‘‡ âˆ’1 , which can be further combined with equations (A9) and (A10) for ğ‘¡ = ğ‘‡ âˆ’ 1 to give us ğ‘‰ ğ‘‡ âˆ’1 . We can keep doing backward induction in
this way until we reach ğ‘‰ ğ‘¡+1 , which can be used in (A1) to derive ğ‘Šğ‘–ğ‘¡ , the current choice specific
continuation value function. Equation (A7) shows the relationship between the observed choice
pattern from the data and ğ‘Šğ‘–ğ‘¡ .

43

