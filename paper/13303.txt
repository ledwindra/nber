                               NBER WORKING PAPER SERIES




                 CLASS SIZE AND SORTING IN MARKET EQUILIBRIUM:
                              THEORY AND EVIDENCE

                                         Miguel Urquiola
                                         Eric Verhoogen

                                       Working Paper 13303
                               http://www.nber.org/papers/w13303


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                    August 2007




We thank Kensuke Teshima for excellent research assistance. For useful comments we thank (without
implicating) Josh Angrist, Jere Behrman, David Card, Ken Chay, Pierre-Andre Chiappori, Gregory
Elacqua, Helios Herrera, Kate Ho, Larry Katz, David Lee, Robert Moffitt, Richard Romano, Bernard
Salanie, and many seminar participants. We especially thank Patrick McEwan, who was involved
in the early stages of the project. The views expressed herein are those of the author(s) and do not
necessarily reflect the views of the National Bureau of Economic Research.

Â© 2007 by Miguel Urquiola and Eric Verhoogen. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
Â© notice, is given to the source.
Class Size and Sorting in Market Equilibrium: Theory and Evidence
Miguel Urquiola and Eric Verhoogen
NBER Working Paper No. 13303
August 2007
JEL No. C2,I2,L1,O1

                                               ABSTRACT

This paper examines how schools choose class size and how households sort in response to those choices.
Focusing on the highly liberalized Chilean education market, we develop a model in which schools
are heterogeneous in an underlying productivity parameter, class size is a component of school quality,
households are heterogeneous in income and hence willingness to pay for school quality, and schools
are subject to a class-size cap. The model offers an explanation for two distinct empirical patterns
observed among private schools that accept government vouchers: (i) There is an inverted-U relationship
between class size and household income in equilibrium, which will tend to bias cross-sectional estimates
of the effect of class size on student performance. (ii) Some schools at the class size cap adjust prices
(or enrollments) to avoid adding another classroom, which produces stacking at enrollments that are
multiples of the class size cap. This generates discontinuities in the relationship between enrollment
and household characteristics at those points, violating the assumptions underlying regression-discontinuity
(RD) research designs. This result suggests that caution is warranted in applying the RD approach
in settings in which parents have substantial school choice and schools are free to set prices and influence
their enrollments.

Miguel Urquiola
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York, NY 10027
and NBER
msu2101@columbia.edu

Eric Verhoogen
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York NY 10027
eric.verhoogen@columbia.edu
1        Introduction

There has been a long and heated debate on whether class-size reductions improve educational
performance. Hanushek (1995, 2003) reviews an extensive literature and concludes that class
size has no systematic eï¬€ect on student achievement in either developed or developing countries.
Krueger (2003), Kremer (1995) and others have countered that this conclusion is based largely
on cross-sectional evidence and subject to multiple potential sources of bias, including the en-
dogenous sorting of students into classes of diï¬€erent sizes, and have called for further analyses
using experimental and quasi-experimental designs. In the latter category, an inï¬‚uential approach
has been the regression-discontinuity (RD) design of Angrist and Lavy (1999), which exploits the
discontinuous relationship between enrollment and class size that results from class-size caps.1
        Despite a general awareness of the possible endogeneity of class size, relatively little attention
has been paid to how schools choose class size or to how households sort in response to those
choices. In this paper, we develop a model of class-size choices by heterogeneous schools and of
school choices by heterogeneous households, show that two central predictions are borne out in
data on Chilean schools, and argue that these ï¬ndings have important implications for attempts
to estimate the eï¬€ect of class size on student outcomes. Chileâ€™s educational market is well-suited
to such an investigation in part because private schools account for approximately half of the
market, and a majority of them are operated on a for-proï¬t basis. This makes it straightforward
to specify schoolsâ€™ objective functionsâ€”an otherwise diï¬ƒcult task in many public-sector contexts.
        In the model, schools are assumed to be monopolistically competitive, to be heterogeneous in
an underlying productivity parameter, and to oï¬€er quality-diï¬€erentiated â€œproducts,â€ where class
size is a component of school quality. Households are assumed to be heterogeneous in income
and hence in willingness to pay for quality. Schools face three constraints, corresponding to real
restrictions faced by private schools that accept vouchers in Chile: (1) a class size cap at 45
students; (2) an integer constraint on the number of classrooms; and (3) the restriction that
enrollment (a choice variable of schools) cannot exceed demand.
        The model delivers two main empirical predictions, both of which ï¬nd support in the data.
First, there is an inverted-U relationship between class size and household income in cross-section.
    1
    The RD approach has also been used to study the eï¬€ects of class size by Hoxby (2000) in the U.S., Dobbel-
steen, Levin, and Oosterbeek (2002) in Holland, Browning and Heinesen (2003) in Denmark, Asadullah (2005) in
Bangladesh, Jakubowski and Sakowski (2005) in Poland, Bressoux, Kramarz, and Prost (2005) and Piketty and
Valdenaire (2006) in France, WoÌˆssmann (2005) in ten European countries, and Urquiola (2006) in Bolivia.


                                                      1
The model predicts that higher-income households sort into higher-productivity, higher-quality
schools, as one might expect. The inverted U arises from the interaction of two eï¬€ects: higher
productivity enables schools to ï¬ll up their existing classrooms, and it also leads them to add
classrooms and reduce class size to appeal to higher-income households. The former tends to
dominate at lower levels of productivity, and the latter at higher levels. The inverted-U relation
between class size and income will tend to confound attempts to estimate the eï¬€ect of class size
in cross-sectional regressions.
   Second, in the presence of the class-size cap and the integer constraint on the number of
classrooms, schools at the cap adjust price (or enrollment) to avoid having to add an addi-
tional classroom. This results in stacking at enrollment levels that are multiples of 45. Because
higher-income households sort into higher-productivity schools, the stacking implies discontinu-
ous changes in average family income and hence in other correlates of income, such as mothersâ€™
schooling, at these multiples. The resulting discontinuities violate the assumptions underlying the
RD designs that have been used to estimate the eï¬€ect of class size. Our results thus provide a
concrete illustration of how endogenous sorting around discontinuities may invalidate RD designs
(Lee, forthcoming; McCrary, forthcoming). We view these results as a cautionary note regarding
the application of such designs in contexts where schools are able to set prices and inï¬‚uence their
enrollments, and parents have substantial school choice. As we discuss below, we have no reason
to believe that this conclusion generalizes to the public-school settings typically studied, in which
students are required to attend local schools and in which schools cannot control their enrollments
but rather react mechanically to them.
   In addition to the papers cited above, this paper is related to a growing body of theoretical
and empirical work on sorting in education markets, including Manski (1992), Epple and Romano
(1998), Clotfelter (1999), Epple, Figlio, and Romano (2002), Epple and Romano (2002), Nesheim
(2002), Caucutt (2002), Nechyba (2003), Bayer, McMillan, and Rueben (2004), Altonji, Huang,
and Taber (2005), Urquiola (2005), Epple, Romano, and Sieg (2006), Hsieh and Urquiola (2006),
Rothstein (2006), and Ferreyra (2007). Much of this work is focused on the impact of greater
school choiceâ€”either through greater school district availability or through vouchersâ€”on sorting
outcomes. The distinctive aspect of this paper is our focus on the role of institutional constraintsâ€”
the class-size cap and the integer constraintâ€”in a market that is already largely liberalized.
   One caveat is that this paper does not consider the role of peer eï¬€ects, which play a central role


                                                 2
in much of the previous theoretical work on sorting in educational markets (Epple and Romano,
1998, 2002; Epple, Figlio, and Romano, 2002). In many of these models, schools are essentially
passive â€œclubsâ€ whose main attribute is the average ability and income of their students. In our
model, as in Epple, Romano, and Sieg (2006), schools actively choose the level of educational
quality to supply. It is diï¬ƒcult to integrate both the peer-eï¬€ects and the quality-choice elements
in an analytically tractable model. Epple, Romano, and Sieg (2006) maintain both elements, but
must rely on numerical methods to compute equilibria. Our approach is to abstract from peer
eï¬€ects in order to arrive at analytical results. In the long run it would clearly be desirable to
develop an analytically tractable model that combines both elements.
        This paper is also related to work on quality choice by ï¬rms (Mussa and Rosen, 1978; Gab-
szewicz and Thisse, 1979; Shaked and Sutton, 1982; Anderson and de Palma, 2001). The structure
of the theoretical model has many elements in common with the framework of Verhoogen (2007),
which models quality choice by heterogeneous Mexican ï¬rms facing heterogeneous consumers in
the domestic and export markets.
        Finally, in seeking to understand the mechanisms behind the determination of class size, we
view our work as complementary to Lazear (2001), which focuses on how schools allocate students
with heterogeneous levels of self-discipline into classes of diï¬€erent sizes. We abstract from sorting
within schools and instead focus on sorting between schools with diï¬€erent average class sizes.
        The remainder of the paper is organized as follows. Section 2 provides institutional back-
ground, and section 3 sets out the model. Section 4 describes the data. Section 5 discusses
testable implications and presents the results. Section 6 concludes.


2        Chileâ€™s School System

There are three main types of schools in Chile:

    1. Public or municipal schools are run by roughly 300 municipalities which receive a per-
          student â€œvoucherâ€ payment from the central government. These schools cannot turn away
          students unless oversubscribed, and are limited to a maximum class size of 45.2 In most
          municipalities, they are the suppliers of last resort.
    2
     In some instances schools are temporarily authorized to have classes of 46 or 47, but they receive no payments
for the students above 45.



                                                        3
   2. Private subsidized or voucher schools are independent, and since 1981 have received exactly
         the same per student subsidy as municipal schools.3 They are also constrained to a maximum
         class size of 45, but, unlike public schools, have wide latitude regarding student selection.

   3. Private unsubsidized schools are independent, do not accept vouchers and receive no other
         explicit subsidies, and are not bound by the class-size cap.

       Parents can use the per-student voucher in any public or private voucher school that is willing
to accept their children. In 2003, private schools (both voucher and unsubsidized) accounted for
about 45 percent of all schools, and voucher schools alone accounted for about 36 percent. In
urban areas, these shares were 62 and 48 percent, respectively. Private schools can be explicitly
for-proï¬t, and using their tax status to classify them, Elacqua (2005) calculates that about 70
percent of them are indeed operated as such. Further, even non-proï¬t schools can legally distribute
dividends to principals or board members. A handful of private schools are run by privately or
publicly held corporations that control chains of schools, but the modal one is owned and managed
by a single principal/entrepreneur.
       Public primary schools are not allowed to charge â€œadd onâ€ tuition supplemental to the voucher
subsidy.4 While initially voucher private schools were subject to the same constraint, this restric-
tion was eased beginning in 1994. At present, they can charge tuition as high as approximately
1.7 times the voucher payment. In practice, this constraint appears not to be important for most
voucher schools; in 2006, for instance, fewer than 4 percent of them had per-student revenues
within 25 percent of the tuition cap.5 The resources these institutions raise through tuition are
equal to about 20 percent of their state funding.
       Rather than attempt to analyze the entire Chilean educational sector, we narrow our focus in
four important ways. First, we restrict attention to primary (K-8) schools because class size, a
central variable in our analysis, is more clearly deï¬ned at the primary than at the secondary level.
Second, we focus on private schools since, as mentioned above, we can plausibly assume that they
are proï¬t-maximizing. Third, we focus on urban areas because we want to consider settings where
enrollment and class size are determined by schoolsâ€™ and householdsâ€™ choices, and not constrained
   3
     The payment varies somewhat by location, but within an area voucher and municipal schools receive equal
payments. For further details on the creation of the voucher system, see Hsieh and Urquiola (2006).
   4
     Public secondary schools can charge add-ons, but in practice very few do.
   5
     The administrative data this ï¬gure is based on contain information on average revenue and not posted prices.
The former can be lower than posted tuition if some students receive discounts.


                                                       4
by the size of the market, as could happen in rural areas.6 Fourth, we focus on voucher schools,
the private schools subject to the class-size cap, and not on unsubsidized schools. We do so in
part because we are primarily interested in how the class-size cap aï¬€ects sorting outcomes, and in
part because the unsubsidized schools serve a very distinct, elite population,7 and are governed
by considerations that would be diï¬ƒcult to incorporate tractably into our theoretical framework.8
        A ï¬nal relevant fact is that as elsewhere, primary schools in Chile are not large; 95 percent
of urban ones have fewer than 135 students in the 4th grade.9 As Figure 1 illustrates, they run
relatively few classes per grade. In 2002, for instance, 53 percent of urban private schools had
only one 4th grade class, while 86 and 95 percent had two or fewer or three or fewer, respectively.
Public schools run a slightly higher average number of classes, but 91 percent of them still operate
three or fewer 4th grades. While in theory schools could combine students from more than one
grade into a single classroom, in practice very few do, especially in the urban areas we focus on.
In 2002, for instance, 4.3 percent of urban voucher schools reported they combined more than one
grade into a class.10 These facts motivate the integer constraint in our model.


3        The Model

This section develops a model of quality diï¬€erentiation and sorting in the Chilean school market.
We model parentsâ€™ demand for education in a standard discrete-choice framework with quality
diï¬€erentiation (McFadden, 1974; Anderson, de Palma, and Thisse, 1992). We solve the optimiza-
tion problem of proï¬t-maximizing voucher schools under realistic constraints. To simplify the
model, we take the set of voucher schools as given and abstract from entry decisions. This is a
strong assumption, but our view is that including a detailed analysis of entry would add more
    6
      The qualitative conclusions of our empirical analyses turn out not to be much aï¬€ected by this restriction.
    7
      The summary statistics in Table 1, discussed in more detail below, indicate that the students attending private
unsubsidized schools are from markedly richer households than those in voucher or public schools; for instance, the
average household income at the 10th percentile of the income distribution in unsubsidized schools is greater than
the average household income at the 90th percentile of the income distribution in voucher schools.
    8
      Indeed, in the context of our model, it is a puzzle that many unsubsidized schools refuse to accept vouchers.
Essentially all these schools have class sizes below 45, and while we do not have reliable data on their tuition,
it appears that many of them also charge average fees well below the maximum allowed for voucher schools.
Anecdotally, it appears that an important reason for why these schools do not accept vouchers is that exclusivity is
part of their appeal. This appears to be related to peer eï¬€ects and considerations of social status that are diï¬ƒcult
to model tractably.
    9
      As discussed below, we focus primarily on 4th grade observations because our testing data are at that grade
level. The results for other grades, however, are quite similar.
   10
      The administrative data do not allow us to discern how often this happened speciï¬cally at the 4th grade level,
the one we focus on below. They simply report that the school did this for some combination of grades.


                                                         5
tedious complication than real insight. Under the assumption that each school thinks of itself
as small relative to the market as a whole, the extent of entry would not aï¬€ect the optimizing
decisions of particular schools, and our two main implications would continue to hold. It is worth
emphasizing that our two main implications do not hold for all possible parameter values in our
model. Rather, we show that there exists a set of parameter values for which the implications do
hold and in Section 4 we examine whether there is empirical support for them.


3.1       Demand

There is a continuum of households of mass M , heterogeneous in income. Each is assumed to
have one child and to enroll the child in a school. The parameter Î», discussed in more detail
below, indexes schools. Let x(Î»), n(Î») and p(Î») represent the enrollment, number of classrooms
and tuition of school Î». We assume that school quality is observed by households and depends
on enrollment, the number of classrooms, and Î» in a manner to be made clear below. Households
are assumed to have the following indirect utility function:

                                                                
                       U p(Î»), q x(Î»), n(Î»), Î» ; Î¸ = Î¸q x(Î»), n(Î»), Î» âˆ’ p(Î») + Îµ                                                 (1)

                    
where q x(Î»), n(Î»), Î» is school quality and Îµ is a random term capturing the utility of a particular
household-school match. This speciï¬cation follows from a direct utility function in which house-
holds have identical utility functions and diï¬€er only in income.11 The parameter Î¸ represents
householdsâ€™ willingness to pay for quality, and is a monotonically increasing function of household
income. We assume that Î¸ has a distribution g(Î¸) with positive support over (Î¸, Î¸) where Î¸, Î¸ > 0;
this distribution reï¬‚ects the underlying distribution of income among households. We assume
the random-utility term Îµ is i.i.d. across households with a double-exponential distribution with
                                 
c.d.f. F (Îµ) = exp âˆ’ exp âˆ’ ÂµÎµ + Ï‡ ,12 where Âµ is a positive constant that captures the degree of
  11
       Suppose:
                                                e (z, q) = u(z) + q + Îµe
                                                U
where z is a non-diï¬€erentiated numeraire good, q is the quality of education, Îµe is a mean-zero random term, and
the sub-utility function u(Â·) has u (Â·) > 0 and u (Â·) < 0. If households are on their budget constraint, then indirect
utility is:
                                              e (p, q ; y) = u (y âˆ’ p) + q + Îµe
                                              U
                                                                                          e          u(y)
Taking a ï¬rst-order approximation of u(Â·) around y, and setting Î¸ â‰¡ 1/u (y) , U â‰¡       U
                                                                                        u (y)
                                                                                                 âˆ’   u (y)
                                                                                                            ,   and Îµ â‰¡     Îµe
                                                                                                                          u (y)
                                                                                                                                 ,   we
                         u(y)
have (1). Note that the    term is constant across schools and does not aï¬€ect the householdâ€™s choice probabilities.
                         u (y)
  12
     We assume Ï‡ = 0.5772 (Eulerâ€™s constant), ensuring that the expectation of Îµ is zero.



                                                           6
diï¬€erentiation between schools.13
       A standard derivation yields the probability that a household chooses school Î», conditional
on having willingness to pay for quality Î¸ and on the qualities and prices of all schools:14
                                                                                         
                                                 1                Î¸q x(Î»), n(Î»), Î» âˆ’ p(Î»)
                       s Î»| Î¸, q(Â·), p(Â·) =            exp                                               (2)
                                                  â„¦(Î¸)                         Âµ

where                                                                      
                                    Î»             Î¸q x(Î»Ìƒ), n(Î»Ìƒ), Î»Ìƒ âˆ’ p(Î»Ìƒ)
                          â„¦(Î¸) â‰¡        exp                                     f (Î»Ìƒ) dÎ»Ìƒ
                                   Î»                          Âµ

We assume that schools cannot discriminate among households, and hence that price and quality
are equal for all households in a given school. As is common in monopolistic-competition models,
we will treat individual schools as small relative to the market as a whole, and assume that they
ignore their eï¬€ect on the aggregate â„¦(Î¸).
       The expected market share of school Î», integrating over all households, is:

                                                      Î¸                             
                  s q x(Î»), n(Î»), Î» , p(Î») =                  s Î»|Î¸, q x(Î»), n(Î»), Î» , p(Î») g(Î¸)dÎ¸       (3)
                                                      Î¸


Expected demand for school Î» is then:

                                                                      
                        d q x(Î»), n(Î»), Î» , p(Î») = M s q x(Î»), n(Î»), Î» , p(Î»)                            (4)


The key implications of this demand speciï¬cation are that demand for school Î» is declining in
price and increasing in quality, and that higher-Î¸ households are more sensitive to quality for
a given price. Note that the speciï¬cation combines horizontal diï¬€erentiation, in the sense that
if all schoolsâ€™ tuitions are equal each will face positive demand with positive probability, with
vertical diï¬€erentiation, in the sense that if tuitions are equal, higher-quality schools will face
higher demand. Throughout we will assume schools are risk-neutral, and ignore the fact that the
expression for d(Â·) represents an expectation.
       It will be convenient to deï¬ne the expected willingness to pay of households that send their
  13
     As Âµ â†’ 0, the distribution of household-school-speciï¬c utility terms collapses to a point, and the model
approaches perfect competition.
  14
     See for example Anderson, de Palma, and Thisse (1992, theorem 2.2, p. 39).




                                                               7
children to school Î»:

                                                               
             Î˜ q x(Î»), n(Î»); Î» , p(Î»)  â‰¡ E Î¸ q x(Î»), n(Î»); Î» , p(Î»)
                                                â¡                                 â¤
                                            Î¸     s Î»| Î¸, q x(Î»), n(Î»), Î» , p(Î») g(Î¸)
                                       =      Î¸ â£                                 â¦ dÎ¸                     (5)
                                          Î¸           s q x(Î»), n(Î»), Î» , p(Î»)

where by Bayesâ€™ rule the term in brackets represents the probability density of Î¸ conditional on
households sending their children to school Î».


3.2      Production

We now think of Î» as an exogenously ï¬xed productivity parameter in which schools are hetero-
geneous. It can be interpreted as the ability of the school principal/entrepreneur.15 We assume
that there is a continuum of schools with continuous density f (Î») over the interval [Î», Î»). Each
school is uniquely identiï¬ed by its value of Î», which justiï¬es our use of Î» as an index above.
       Each school is constrained to oï¬€er just one â€œproduct,â€ and is assumed to produce quality with
a technology:                                                           
                                                                    T
                                           q(x, n; Î») = Î» ln                                                   (6)
                                                                   x/n

where x is enrollment, n is the number of classrooms, the denominator is class size, and T is a
constant that represents the technological maximum of class size. The term in parentheses is by
assumption always greater than or equal to one. This speciï¬cation captures the idea that the
larger is class size the less teacher attention is available for each individual student.16 Note that
a given reduction in class size raises quality more at higher-Î» schools. This complementarity will
be crucial in what follows.
       In order to guarantee an interior solution for the schoolâ€™s optimization problem we must impose
a lower bound on the degree of diï¬€erentiation between schools. The condition:


                                                     Âµ > Î»Î¸                                                    (7)
  15
     In a more complex, dynamic model, one might think of Î» as reputation. The important point is that it aï¬€ects
householdsâ€™ perceptions of quality and is unaï¬€ected by schoolsâ€™ decisions in the short run.
  16
     An interesting extension might be to include an endogenous term in the numerator representing teacher quality,
an additional choice variable for schools. We leave this task for future work, in part because we do not have data
on teacher salaries or other teacher characteristics.




                                                        8
will be suï¬ƒcient. Intuitively, this limits the extent to which demand for a school increases with
a given class-size reduction.
   We suppose that there is a ï¬xed cost Fs of running a school, a ï¬xed cost Fc of operating a
classroom, and a constant variable cost c for each student. Recall that p is tuition, and let Ï„ be
the per-student subsidy that schools receive from the government. Proï¬t is then:


                                Ï€(p, n, x; Î») = (p + Ï„ âˆ’ c) x âˆ’ nFc âˆ’ Fs                       (8)


There is assumed to be no cost of diï¬€erentiation; hence every school diï¬€erentiates its â€œproductâ€
and has a monopoly over the product it oï¬€ers.


3.3   Schoolsâ€™ Optimization Problem

The problem facing schools is to maximize proï¬t over the choice of tuition, enrollment, and the
number of classrooms:
                                           max Ï€(p, x, n; Î»)                                   (9)
                                           p,x,n

This optimization is subject to three constraints:

  1. The number of classrooms must be a positive integer


                                                    nâˆˆ                                      (10)


      where    is the set of natural numbers {1, 2, 3, ...}.
  2. Class size cannot exceed the class-size cap:

                                                    x
                                                      â‰¤ 45                                   (11)
                                                    n


  3. Enrollment cannot exceed demand:


                                             x â‰¤ d(q(x, n; Î»), p)                            (12)


      where q(Â·) is given by (6) and d(Â·) by (4).



                                                    9
Although the ï¬rst two constraints are designed to mimic the institutional environment in Chile,
they are likely to apply more generally. It is common in many countries for primary schools to
have a relatively small number of classrooms per grade and to be subject to class-size caps. The
third constraint clearly applies to all schools.17


3.4    Characterization of Equilibrium

The integer restriction complicates the solution of schoolsâ€™ optimization problems, since we cannot
simply solve a set of ï¬rst-order conditions. A common approach to such problems is to ï¬rst relax
this constraint, then compare solutions with and without the relaxation. This is how we proceed
below. In the main text, we report key results; derivations of those results appear in Appendix
A, with section numbers corresponding to the cases.


Case 1: Divisible Classrooms

If the integer constraint (10) is relaxed, it turns out that in equilibrium there is a critical value of
the entrepreneurial-ability parameter, call it Î±, to the right of which the class-size cap does not
bind and to the left of which it does bind. Consider each of these sub-cases in turn.


Sub-Case 1.1: Class-Size Cap Non-Binding
If Î» > Î± and the cap does not bind, then in equilibrium schoolsâ€™ optimal choices are deï¬ned
implicitly by the following:

                                                                           
                          pâˆ— (Î») = Âµ + c âˆ’ Ï„ + Î»Î˜ q xâˆ— (Î»), nâˆ— (Î»); Î» , pâˆ— (Î»)                                 (13a)
                                                              
                          xâˆ— (Î») = d q xâˆ— (Î»), nâˆ— (Î»); Î» , pâˆ— (Î»)                                              (13b)
                                    1                                   
                          nâˆ— (Î») =    Î»xâˆ— (Î»)Î˜ q xâˆ— (Î»), nâˆ— (Î»); Î» , pâˆ— (Î»)                                    (13c)
                                   Fc

where Î˜(Â·) is given by (5), d(Â·) is given by (4), and the asterisks indicate equilibrium values. In
order for the second-order conditions for a maximum to be satisï¬ed, it must be the case that:

                                                               Î»Ïƒ 2
                                                                     Î¸|Î»
                               Î¨ â‰¡ Î˜ q xâˆ— (Î»), nâˆ— (Î»); Î» , pâˆ— (Î») âˆ’      >0                                      (14)
                                                                    Âµ
  17
    The third constraint ends up binding in every case we present here, and we could treat it as an equality
constraint or substitute d(Â·) for x in (8) and (9). But there exist realistic cases in which it would not bindâ€”i.e. if
there were a tuition constraint. For conceptual clarity, we leave the constraint as an inequality.


                                                         10
       2 is the variance of Î¸ among households with children attending school Î» in equilibrium.18
where ÏƒÎ¸|Î»
Assumption (7) guarantees that this condition holds. (See Appendix A.1.1.) Unfortunately,
there is no explicit analytical solution to (13a)-(13c). Nonetheless, using the implicit function
theorem, we can sign the relationship between the various endogenous variables and the underlying
productivity parameter, Î». In particular:

                                                                âˆ‚pâˆ—
                                                                    >0                                                  (16a)
                                                                âˆ‚Î»
                                                                âˆ‚xâˆ—
                                                                    >0                                                  (16b)
                                                                âˆ‚Î»
                                                                âˆ‚nâˆ—
                                                                    >0                                                  (16c)
                                                                âˆ‚Î»
                                                                âˆ‚Î˜âˆ—
                                                                    >0                                                  (16d)
                                                                 âˆ‚Î» 
                                                                 âˆ‚ xâˆ—
                                                                       <0                                               (16e)
                                                                âˆ‚Î» nâˆ—

where Î˜âˆ— is shorthand for the equilibrium value of Î˜(Â·) for a given Î». In equilibrium, higher-Î»
schools charge higher tuition, have larger enrollments, operate more classrooms, have smaller class
sizes, and attract students whose families are on average wealthier and have higher willingness to
pay for quality. All of these relationships are monotonic in Î».
      In Figure 2, which plots class size vs. Î» in the divisible-classrooms case, this sub-case corre-
sponds to the declining portion of the curve, to the right of the critical value Î±. Intuitively, the
fact that class size is declining in Î» is a consequence of the fact that Î» and class-size reductions
are complementary in the quality production function (6).


Sub-Case 1.2: Class-Size Cap Binding
If Î» â‰¤ Î± and the class-size cap binds, then in equilibrium schoolsâ€™ optimal choices are deï¬ned
 18
      That is, deï¬ne:
                                                                      2 â€œ       `                 Â´        â€     3
                      Z           â€     â€œ `                        â€Â«2 s Î»| Î¸, q xâˆ— (Î»), nâˆ— (Î»), Î» , pâˆ— (Î») g(Î¸)
                              Î¸                           Â´
              2
             ÏƒÎ¸|Î» â‰¡                         âˆ—      âˆ—          âˆ—
                                   Î¸ âˆ’ Î˜ q x (Î»), n (Î»); Î» , p (Î»)    4     â€œ `                   Â´        â€     5 dÎ¸    (15)
                          Î¸                                                s q xâˆ— (Î»), nâˆ— (Î»), Î» , pâˆ— (Î»)




                                                                    11
implicitly by:

                                                   Fc
                              pâˆ— (Î») = c âˆ’ Ï„ + Âµ +                                              (17a)
                                                 45              
                                                          
                              x (Î») = d q x (Î»), nâˆ— (Î»); Î» , pâˆ— (Î»)
                               âˆ—             âˆ—
                                                                                                (17b)
                                             xâˆ— (Î»)
                              nâˆ— (Î») =                                                          (17c)
                                               45

The slopes with respect to Î» in this sub-case are:

                                                âˆ‚pâˆ—
                                                    =0                                          (18a)
                                                âˆ‚Î»
                                                âˆ‚xâˆ—
                                                    >0                                          (18b)
                                                âˆ‚Î»
                                                âˆ‚nâˆ—
                                                    >0                                          (18c)
                                                âˆ‚Î»
                                                âˆ‚Î˜âˆ—
                                                    >0                                          (18d)
                                                 âˆ‚Î» 
                                                 âˆ‚ xâˆ—
                                                       =0                                       (18e)
                                                âˆ‚Î» nâˆ—

Although class size and price are constant, enrollment, the number of classrooms, and average
household income are increasing in the productivity parameter. Average household income is
increasing in Î» because Î» raises quality conditional on class size. It is notable that proï¬ts are also
increasing in Î», even though price is constant, because enrollment is increasing in Î» and schools
charge a mark-up over costs. In Figure 2, this sub-case corresponds to the portion of the curve
to the left of Î± where class size is ï¬‚at at 45.
   The critical value Î± is deï¬ned implicitly by the equation

                                                               F
                                                                     c
                                  Î±Î˜ q xâˆ— (Î±), nâˆ— (Î±); Î± , pâˆ— (Î±) =                              (19)
                                                                    45

                                  x
This is the value of Î» at which   n   = 45 in the ï¬rst sub-case above. Note that there is no guarantee
that Î± âˆˆ (Î», Î»), i.e. that the class-size cap will be binding on any schools in the market. At the
critical value, the optimal choices pâˆ— , xâˆ— , and nâˆ— are equal in the two sub-cases (cap binding, cap
non binding). Hence over the entire range of Î» we have that pâˆ— , xâˆ— , nâˆ— and Î˜âˆ— are continuous; pâˆ—
                                                                                                   xâˆ—
is weakly monotonically increasing; xâˆ— , nâˆ— and Î˜âˆ— are strictly monotonically increasing; and      nâˆ—

is weakly monotonically decreasing.



                                                      12
Case 2: Indivisible Classrooms

Now add the restriction that the number of classrooms must be an integer (10). Our strategy
for dealing with the integer constraint is ï¬rst to characterize the optimal choices of schools for a
given number of classrooms, and then to characterize the sets of schools that choose each integer
number of classrooms.


Fixed Number of Classrooms

To begin, suppose that n is ï¬xed and think of it as a parameter. It will turn out that for a given
n there is a single critical value of Î», call it Î²(n), below which the class-size cap does not bind
and above which it binds. Again consider the two sub-cases in turn.


Sub-Case 2.1: Class-Size Cap Non-Binding
If Î» â‰¤ Î²(n) and the class-size cap does not bind, then schoolsâ€™ optimal choices are implicitly
deï¬ned by:

                                                                          
                     pâˆ— (n, Î») = Âµ + c âˆ’ Ï„ + Î»Î˜ q xâˆ— (n, Î»); n, Î» , pâˆ— (n, Î»)                 (20a)
                                                             
                     xâˆ— (n, Î») = d q xâˆ— (n, Î»); n, Î» , pâˆ— (n, Î»)                              (20b)


Price and average willingness to pay (i.e. average household income) are unambiguously increasing
in Î»:

                                           âˆ‚pâˆ—
                                               >0                                             (21a)
                                            âˆ‚Î»
                                           âˆ‚Î˜âˆ—
                                               >0                                             (21b)
                                            âˆ‚Î»

   There is a subtlety in the relationship between enrollment and Î». On one hand, there is a
direct eï¬€ect of a higher Î» on demand: for a given class size, households prefer higher-Î» schools.
On the other hand, there is an indirect eï¬€ect: from (6), at higher values of Î» a given increase
in enrollment has a larger negative eï¬€ect on quality and hence on demand. It is theoretically
possible in this case that the latter eï¬€ect dominates, making it optimal for higher-Î» schools to
raise prices such that enrollment, conditional on a given number of classrooms, is decreasing in Î».
In that case, our testable implications (discussed in the introduction and in more detail below)


                                                13
do not hold. We focus instead on the case where enrollment is increasing in Î». A necessary and
suï¬ƒcient condition for this, which we assume hereafter, is:19
                                                                                              
                                                                Î˜ q xâˆ— (n, Î»); n, Î» , pâˆ— (n, Î»)
                                             nT
                                 ln                       >                                                              (22)
                                          xâˆ— (n, Î»)                                       Î¨

where Î¨ is deï¬ned as in (14). Under this assumption, we have

                                                                    âˆ‚xâˆ—
                                                                        >0                                               (23)
                                                                    âˆ‚Î»

                                                 âˆ‚
                                                       xâˆ— 
Since n is ï¬xed, (23) implies that               âˆ‚Î»       n        > 0; for a given number of classrooms, class size is
increasing in Î». That is, conditional on n, higher-Î» schools are better able to ï¬ll their classrooms.


Sub-Case 2.2: Class-Size Cap Binding
If Î» > Î²(n) and the class-size cap binds, then we have two endogenous variables and two binding
constraints. The constraints pin down the values of p and x:


                                              pâˆ— (n, Î») = Âµ ln Î£ âˆ’ Âµ ln(45n)                                            (24a)

                                             xâˆ— (n, Î») = 45n                                                            (24b)


where                                                                              Î¸Î»
                                                              Î¸                      Âµ
                                                                   1          T
                                               Î£â‰¡                                         g(Î¸)dÎ¸                         (25)
                                                          Î¸       â„¦(Î¸)        45

The slopes with respect to Î» are:

                                                  âˆ‚pâˆ—
                                                                  > 0                                                   (26a)
                                                   âˆ‚Î»                                
                                                  âˆ‚xâˆ—                   âˆ‚          xâˆ—
                                                                  =                     =0                              (26b)
                                                   âˆ‚Î»                  âˆ‚Î»          n
                                                  âˆ‚Î˜âˆ—
                                                                  > 0                                                   (26c)
                                                   âˆ‚Î»
  19
       If we replace the production function for quality (6) by a general function q(x, n; Î»), then the condition is:
                                                            2
                                                                       !
                                                âˆ‚2q        ÏƒÎ¸|Î» âˆ‚q   1 âˆ‚q
                                             âˆ’       <             +
                                               âˆ‚xâˆ‚Î»       ÂµÎ˜âˆ— âˆ‚x     x âˆ‚Î»

                                                                                                      âˆ‚2q
which makes it clear that the indirect eï¬€ect of higher Î» described above (represented by             âˆ‚xâˆ‚Î»
                                                                                                          )   must be small in
                                                       âˆ‚q
magnitude relative to the direct eï¬€ect (represented by âˆ‚Î» ).



                                                                         14
    The critical value Î²(n) for a given n is deï¬ned implicitly by the equation:

                                                   
               Î²(n) Î˜ q xâˆ— (Î²(n)); n, Î²(n) , pâˆ— (Î²(n)) = Âµ ln Î£ âˆ’ Âµ ln(45n) âˆ’ c + Ï„ âˆ’ Âµ                 (27)


The critical value of Î» is the point at which class size reaches 45 in sub-case 2.1. At this value,
the optimal choices pâˆ— and xâˆ— are the same in the two sub-cases. Hence for a given n, pâˆ— , xâˆ— , and
                                                                                                          xâˆ—
Î˜âˆ— are continuous at Î²(n), pâˆ— and Î˜âˆ— are strictly monotonically increasing in Î», and xâˆ— and               n

are weakly monotonically increasing in Î».


Optimal Choice of Number of Classrooms

Now consider the issue of which integer number of classrooms schools choose. Let


                                      Ï€Ìƒ(n, Î») â‰¡ Ï€(pâˆ— (n, Î»), xâˆ— (n, Î»); n, Î»)                          (28)


be school Î»â€™s optimal proï¬t when the number of classrooms is ï¬xed at n, where pâˆ— (n, Î») and
xâˆ— (n, Î») are given by (20a)-(20b) for Î» â‰¤ Î²(n) and (24a)-(24b) for Î» > Î²(n). Deï¬ne Î›k to be the
set of all schools for which a given integer k is the optimal number of classrooms:


                                Î›k = {Î» : Ï€Ìƒ(k, Î») â‰¥ Ï€Ìƒ(j, Î») âˆ€ j = k, j âˆˆ      }                     (29)


The following lemma characterizes the sets Î›k :

Lemma 1. There exist unique positive integers k and k and a unique set of critical values
Î½k , Î½k+1 , ...Î½kâˆ’1 , Î½k such that:


                            Î›k = {Î» : Î½kâˆ’1 â‰¤ Î» < Î½k } for k = k, k + 1, ..., k


where Î» = Î½kâˆ’1 < Î½k < ... < Î½kâˆ’1 < Î½k = Î».

The proof is in Appendix A.2.3. The lemma indicates that the set of schools can be partitioned
into a set of intervals, [Î½kâˆ’1 , Î½k ), [Î½k , Î½k+1 ), [Î½k+1 , Î½k+2 ) etc., where the optimal integer number of
classrooms is k in the ï¬rst interval, k + 1 in the next, k + 2 in the next, and so on. Within each
of the subsets Î›k the above results for ï¬xed n hold.



                                                        15
       Appendix A.2.4 shows that at the critical values Î½k , Î½k+1 , ..., Î½kâˆ’1 , enrollment is strictly in-
creasing, class size is weakly decreasing, and average willingness to pay is strictly increasing in
Î».20 The fact that average willingness to pay is strictly increasing at the critical values, and
that it is strictly increasing between the critical values (refer to (21b) and (26c)), means that in
equilibrium average willingness to pay Î˜âˆ— is monotonically increasing in Î» for all Î».
       Note that there is no guarantee that the value of Î» at which the class-size cap starts to bind
for a given integer k, Î²(k), is to the left of the value of Î» at which it becomes optimal to add an
additional classroom, Î½k . In the empirical part of the paper, we present evidence consistent with
the hypothesis that Î²(k) < Î½k for low values of k.
       Figure 3 plots class size against Î» for the case where Î²(k) < Î½k for k = 1 and k = 2 but not
thereafter. The curve roughly resembles the curve for the divisible-classrooms case (Figure 2),
but with an overlaid saw-tooth pattern generated by the integer constraint. The ï¬gure exhibits
an approximately inverted-U relationship between class size and Î». It results from the interaction
of two eï¬€ects: (1) conditional on a value of n, class size is increasing in Î», since greater values of Î»
make schools better able to ï¬ll their classrooms; and (2) across values of n, class size is declining
in Î», since greater Î» leads schools to increase the number of classrooms, reducing class size.
       The inverted-U relationship between class size and Î» is not itself testable, because Î» is un-
observed. But since Î˜âˆ— is strictly increasing in Î» for all Î», we would also expect an inverted-U
relationship in equilibrium between class size and Î˜âˆ— . This gives us our ï¬rst testable implication:

Testable Implication 1 In equilibrium, there is an approximately inverted-U relationship be-
         tween class size and average household income.

       Figure 3 also illustrates that schools between Î²(1) and Î½1 have enrollment 45 and schools
between Î²(2) and Î½2 have enrollment 90. Intuitively, in these regions schools raise tuition rather
than incur the ï¬xed cost of starting a new classroom.21 Although we do not model the possibility
explicitly, one can easily imagine that in the presence of stochasticity in demand and menu costs of
changing tuition, schools might turn away potential students for the same reason.22 Since average
  20                                                                                                  âˆ‚p
     The direction of the change in price at each critical value is ambiguous in this case. The slope âˆ‚Î» is greater when
the class-size cap binds than when it does not bind, since higher Î» leads schools to raise prices to keep class-size
pegged at 45. Consequently, price may be greater to the left of Î½k than to the right.
  21
     Appendix A.2.2 shows that for a given number of classrooms, tuition (p) is more steeply sloped in Î» in the
region where the class-size cap binds than in the region where the cap does not bind.
  22
     In Chile, private schools have wide latitude regarding student selection, and can turn away students for reasons
ranging from the desire to maintain a given class size, to the desire to maintain religious uniformity.


                                                          16
household income is monotonically increasing in Î», the stacking implies discontinuous changes in
average household income with respect to enrollment at enrollments of 45, 90, and so on.23 More
generally, we have our second testable implication:

Testable Implication 2 In equilibrium, schools may stack at enrollments that are multiples of
           45, implying discontinuous changes in average household income with respect to enrollment
           at those points.

         It is worth considering brieï¬‚y what our model predicts for private unsubsidized schools, the
elite private schools that do not accept vouchers and are not subject to the class-size cap. In the
context of the model, the results for unsubsidized schools would be similar to those for voucher
schools in the sub-cases where the class-size cap is not binding. That is, if we were to set the
value of the voucher to zero and suppose that Î²(k) > Î½k for all k, then the results in sub-cases
1.1 and 2.1 would carry over to unsubsidized schools. In this case, the ï¬gure analogous to Figure
3 would not have the ï¬‚at regions between Î²(1) and Î½1 and between Î²(2) and Î½2 .


4         Data

To examine our modelâ€™s implications, we draw on two sources of information. The ï¬rst is school-
level administrative information on grade-speciï¬c enrollments and the number of classrooms from
the Chilean Ministry of Education; we use these data to calculate average class sizes in each grade.
The second source of information is the SIMCE testing system,24 which tracks schoolsâ€™ math and
language performance. SIMCE data are available at the school level since 1988. Since 1997, they
also exist at the individual level and include information on studentsâ€™ household income, parental
schooling, and other characteristics from a parental questionnaire sent home with students.
         Depending on the year, the SIMCE tests 4th , 8th , or 10th graders. We focus on the 4th grade
because as indicated above, class size is best-deï¬ned in early primary grades. We focus on the
2002 cross section because it is the most recent 4th grade testing round for which we have data.
    23
      Technically speaking, as long as the class-size cap is not binding to the right of the critical value, Î½k , the
model predicts a discontinuity in Î˜âˆ— even in the absence of stacking. Average willingness to pay in equilibrium
is a smooth, monotonically increasing function of class size. (See the discussions leading up to (58c) and (63) in
Appendix A.2.4.) Class size jumps discontinuously at the critical values Î½k . Hence Î˜âˆ— must also jump at Î½k . Our
view, however, is that the discontinuity due to stacking is the more empirically important one.
   24
      SIMCE, which stands for Sistema de MedicioÌn de la Calidad de la EducacioÌn (Educational Quality Measurement
System), is Chileâ€™s standardized testing program.



                                                         17
We note, however, that the general conclusions we obtain emerge in other cross-sections we have
analyzed (for instance, the 1999 4th grade and the 2004 8th grade waves).
         Table 1 presents descriptive statistics for public schools, private voucher schools and public
unsubsidized schools. As noted in Section 2, the table indicates that private unsubsidized schools
serve a very diï¬€erent demographic group than either the voucher or the public schools. Household
income and parentsâ€™ schooling are markedly higher in the unsubsidized schools. Studentsâ€™ test
scores, unsurprisingly, are highly correlated with these measures of socioeconomic status.


5         Results

We now take our two testable implications to the data. We review each implication, discuss how
it relates to the existing literature, and present the empirical results.


5.1        Class Size and Income in Cross-Section: The Inverted U

The ï¬rst testable prediction is an inverted-U relationship between class size and average household
income. The upward-sloping portion reï¬‚ects the fact that low-Î» schools may have trouble ï¬lling
their existing classrooms to achieve the desired class size. The downward-sloping portion reï¬‚ects
the fact that higher-Î» schools ï¬nd it proï¬table to restrict class size to appeal to richer households.
These mechanisms are consistent with anecdotal evidence from Chile, where there is a widespread
perception that many lower-quality voucher schools are small â€œmom and popâ€ operations that
struggle to ï¬ll their classrooms. In contrast, voucher schools run by larger ï¬rms have suï¬ƒcient
demand to operate multiple classrooms, and are generally perceived to be of higher quality.
         Panel A in Figure 4 plots class size against log average household income among urban voucher
schools. The central line plots ï¬tted values of a locally weighted regression of class size on
log income, and the outer lines plot point-wise conï¬dence intervals generated by a bootstrap
procedure.25 A clear inverted-U pattern is evident. Panel B produces a similar conclusion, using
mothersâ€™ schooling rather than income on the x-axis. Average class size rises with mothersâ€™
schooling up to about the point where the average mother is a high school graduate, and declines
thereafter.
    25
    Using a parametric regression with a ï¬fth-order polynomial produces very similar results, both for the condi-
tional mean and the conï¬dence intervals.




                                                       18
       A possible concern with these ï¬gures is that the inverted-U pattern may reï¬‚ect the aggregation
of schools across regions, rather than cross-sectional patterns within markets. To examine this
possibility, Table 2 reports simple regressions of class size on polynomials in log income (Panel A)
and motherâ€™s schooling (Panel B) among urban voucher schools. To facilitate interpretation, we
use second-order polynomials. Column 1 reports results without region dummies, and Columns 2
and 3 include dummies for 13 regions and 318 municipalities, respectively. The quadratic term is
uniformly negative and signiï¬cant, and not much aï¬€ected by the regional controls. That is, the
inverted-U pattern holds even within narrowly deï¬ned urban markets.
       The inverted-U ï¬nding is relevant to the literature on the eï¬€ect of class size on student
achievement. In this literature, it is common to see cross-sectional estimates that are of the
â€œwrongâ€ sign or essentially equal to zero. Since achievement tends to be strongly correlated with
household income and since income is often unobserved (or is observed with error), the inverted-
U pattern suggests that cross-sectional regressions are likely to understate the eï¬€ect of class size
reductions among lower-income voucher schools and to overstate it among higher-income ones.26
       Previous work has revealed positive correlations between class size and enrollment and between
enrollment and household socioeconomic status among public schools in Israel (Angrist and Lavy,
1999) and Bolivia (Urquiola, 2006),27 but to our knowledge our paper is the ï¬rst to provide either
a theoretical rationale or empirical evidence for a non-linear relationship between class size and
household income. We conjecture that the inverted-U pattern is likely to arise among private
primary schools in other countries.


5.2      Stacking at Multiples of Class-Size Cap

Our second testable implication is related to regression discontinuity (RD) designs that exploit the
discontinuous relationship between enrollment and class size induced by class-size caps.28 Figure
5 shows that the Chilean setting appears to be a promising one for an RD-based evaluation of
the eï¬€ect of class size. The solid line plots the relation between class size and enrollment that
  26
      Consistent with Figure 4, for instance, we ï¬nd that a cross-sectional bi-variate regression of test scores on class
size among all urban voucher schools results in an insigniï¬cant point estimate. If the sample is restricted to schools
with mean mothersâ€™ schooling below 12 years of age, however, the coeï¬ƒcient is positive and signiï¬cant. If it is
restricted to schools with a mean above 12, it is negative and signiï¬cant at the 10 percent level.
   27
      Mizala and Romaguera (2002) present evidence of a positive correlation between enrollment and household
socioeconomic status in Chile.
   28
      For overviews and history of the RD design, see Angrist and Krueger (1999), van der Klaauw (2002), and
Shadish, Cook, and Campbell (2002).



                                                           19
would be observed if schools mechanically expanded class size with enrollment until reaching the
class-size cap, i.e. if class size were determined by:

                                               x p                x
                                                       =          xâˆ’1                                           (30)
                                                n          int     45      +1

where the superscript p indicates this is the predicted level. This results in a â€œsaw-toothâ€ pattern
in which class size increases one for one with enrollment until, at 46, a new class is added and
average class size falls to 23, with other discontinuities observed at 90, 135, etc. Using data for
urban voucher schools for 2002, the circles plot enrollment-cell means of class size. Aggregated to
the enrollment-cell level as in this ï¬gure, a regression of actual on predicted class size produces
an R2 greater than 0.9â€”a clear â€œï¬rst stageâ€.29
       The idea behind RD designs, originally proposed by Thistlewaite and Campbell (1960), is that
discontinuities like those in Figure 5 can be used to identify the causal eï¬€ect of class size even if
enrollment is systematically related to factors that aï¬€ect studentsâ€™ outcomes. Intuitively, if enroll-
ment is smoothly related to student characteristics and other factors that aï¬€ect achievement at
multiples of the class-size cap, then for example students in schools with enrollments of 45 provide
an adequate control group for those in schools with enrollments of 46. In such a case, diï¬€erences
in studentsâ€™ performance can be attributed to the very diï¬€erent class sizes they experience.
       More formally, consider a standard RD model, assuming one class-size cut-oï¬€ and a homoge-
neous eï¬€ect of class size on test scores (van der Klaauw, 2002):


                                          T Si = Î³ E(CSi |Xi ) + f (Xi ) + ui                                    (31a)
                                                        0 ) + k(Xi )
                                 E(CSi |Xi ) = Î· 1(Xi â‰¥ X                                                        (31b)


where i indexes schools, T Si is the average 4th -grade test score in school i, CSi is average 4th -
                                               0 is the value of the class-size cut-oï¬€ (i.e. 45), f (Â·)
grade class size, Xi is 4th -grade enrollment, X
and k(Â·) are ï¬‚exible functions of enrollment, and E(Îµi |Xi ) = 0. In the present setting this model
corresponds to a â€œfuzzyâ€ (as opposed to â€œsharpâ€) regression discontinuity design, since, as Figure
5 indicates, enrollment aï¬€ects but does not perfectly explain class size.
                                                                         0 and the mean of class size
       In the context of this model, if f (Â·) and k(Â·) are continuous at X
  29
    For visual clarity, Figure 5 excludes schools that declare 4th grade enrollments above 180 students (less than
two percent of all schools), thus focusing on only the ï¬rst three discontinuities in the enrollment/class size relation.



                                                            20
                                                           0 , then the class-size eï¬€ect, Î³, is non-
conditional on enrollment, E(CSi |Xi ) is discontinuous at X
parametrically identiï¬ed at the cut-oï¬€ (Hahn, Todd, and van der Klaauw, 2001). Intuitively, in a
small enough neighborhood around the cut-oï¬€, f (Â·) and k(Â·) are constant and any discontinuity in
test scores can be attributed to the discontinuity in the conditional mean of class size. In practice,
one rarely has enough data in neighborhoods around the cut-oï¬€ to estimate Î³ precisely. As Lee
and Card (forthcoming) point out, if Xi is discrete, as in our case, one cannot estimate the class-
size eï¬€ect non-parametrically even with an inï¬nite amount of data, and one must therefore choose
parametric speciï¬cations for f (Â·) and k(Â·). If these are speciï¬ed correctly then they capture all
dependence of class size and test scores on enrollment away from the cut-oï¬€ and the instrumental-
variable (IV) procedure corresponding to (31a)-(31b) will consistently estimate Î³, eï¬€ectively using
only the discontinuity in E(CSi |Xi ). In our baseline speciï¬cations, we use four class-size cut-oï¬€s,
rather than just one as in (31b), and piecewise linear splines (with â€œkinksâ€ at the values of the
cut-oï¬€s) for f (Â·) and k(Â·).30
    Table 3 reports the results of a standard RD analysis using school-level data from 2002.
Column (1) presents the ï¬rst-stage regression of class size on indicators for whether enrollment is
above the ï¬rst four cut-oï¬€s, along with the piecewise linear spline for enrollment. The coeï¬ƒcients
on the cut-oï¬€ indicators are estimates of the average decline in class size at those breaks.31
Consistent with the visual evidence in Figure 5, the ï¬rst one suggests that class size drops by
about 17 students at the ï¬rst threshold. The declines at the ï¬rst three of the four cut-oï¬€s are
statistically signiï¬cant, but become progressively smaller.32 In this speciï¬cation, all standard
errors are clustered by enrollment levels, as Lee and Card (forthcoming) suggest is appropriate
when the assignment variable (here enrollment) is discrete.
    There is prima-facie evidence that the standard RD strategy would generate signiï¬cant re-
sults. Figure 6 presents â€œrawâ€ enrollment-cell means of math and language test scores, along with
the ï¬tted values of a locally weighted regression calculated within each enrollment segment. Par-
ticularly around the ï¬rst cut-oï¬€, which accounts for the greatest density of schools, the discrete
  30
     We return to the possibility of using higher order polynomials below. We note that the piecewise splines are
appropriate to the extent that equation (30) suggests that if the class size rule were strictly applied, the slope of
the relationship between class size and enrollment would be diï¬€erent in each segment.
  31
     For the sake of space, Table 3 and all subsequent ones exclude the small number of schools that declare 4th
grade enrollments above 225 (less than one percent of all schools), thus focusing on only the ï¬rst four discontinuities
in the enrollment/class size relation.
  32
     Although we omit the results, adding controls for individualsâ€™ characteristics has essentially no eï¬€ect on the
key coeï¬ƒcients.



                                                          21
reduction in class size is accompanied by an increase in average test scores. This observation is
also borne out by the regression results. Columns 2-3 of Table 3 present reduced-form regressions
of average math and language scores, showing positive and signiï¬cant increases in scores at the
ï¬rst cut-oï¬€, and positive (although not signiï¬cant) increases at subsequent ones. Columns 4-5
report IV speciï¬cations, where dummy variables for the ï¬rst four cut-oï¬€s are used as instruments
for class size. In both columns, class size appears to have a negative and signiï¬cant eï¬€ect on test
scores.
       Focusing more narrowly around the discontinuities as in van der Klaauw (2002), Columns 1-3
of Table 4 present IV results for bands of 5 students (panels A and C for math and language,
respectively) and 3 students (panels B and D) around the ï¬rst three breaks, omitting the piecewise
spline in enrollment.33 These are equivalent to simple Wald estimates of the eï¬€ect of class size
within the bands around each cut-oï¬€.34 Column 4 produces similar estimates pooling all three
local samples.35 In these pooled samples, the point estimates of the eï¬€ect of class size on test
scores are uniformly negative, although not statistically signiï¬cant.36
       One might be tempted to interpret Tables 3 and 4 as producing consistent estimates of the
causal eï¬€ect of class size on achievement. If the second testable implication of our model is correct,
however, then the smoothness conditions required for valid RD-based inference are likely to be
violated. Recall that the theoretical model predicts a non-negligible mass of schools stacking at
enrollments of 45; in Figure 3, for instance, all schools with productivity parameters between Î²(1)
and Î½1 have enrollment 45, and all those between Î²(2) and Î½2 have enrollment 90. Panel A of
Figure 7 presents a histogram of 4th grade enrollments among urban voucher schools, and the
evidence of such stacking is clear: more than 5 times as many schools report enrollments of 45 as
report enrollments of 46. The same happens at higher cut-oï¬€s as well: more than 7 times as many
schools have 90 4th graders as have 91, for instance.37 Panel B shows that there is no evidence
of stacking among private unsubsidized schools, which are not subject to the class-size cap. It
appears that the stacking among voucher schools is not due to technological factors unrelated to
  33
     The somewhat erratic results in Column 2 are due to outliers close to the 90-student cut-oï¬€; when we replicate
the results using 1999 data, the point estimates and standard errors around the second cut-oï¬€ are in line with those
around the other cut-oï¬€s.
  34
     In other words, the point estimates could be replicated by dividing the diï¬€erence in average test scores between
the schools above and below the cut-oï¬€ within each band, by the diï¬€erence in their respective average class sizes.
  35
     In this case dummies for whether enrollments are above the three cut-oï¬€s, 1{x > 45}, 1{x > 90}, and 1{x >
135}, as well as three sample-speciï¬c intercepts serve as instruments; see van der Klaauw (2002).
  36
     Note that clustering by enrollment level, as suggested by Lee and Card (forthcoming), lowers signiï¬cance levels.
  37
     Similar stacking occurs if 1st or 8th grade data are used.


                                                         22
the cap. In short, Figure 7 provides a clear illustration of what McCrary (forthcoming) terms
manipulation of the running variableâ€”enrollment in this case.
       Recall also that the model predicts that higher-income households on average sort into higher-Î»
schools. If so, then the stacking will generate discontinuities in the relationship between enrollment
and student characteristics close to the cut-oï¬€ points, violating the smoothness assumptions
underlying the RD approach. Again, Figure 3 illustrates the intuition: because of the stacking,
the average value of Î» among schools at the cap is strictly less than the average value just above the
cap; since average household income is strictly monotonically increasing in Î» (see the discussion
in Section 3.4 above), the stacking generates discontinuous changes in household income at the
class-size cut-oï¬€s.   38


       Panel A of Figure 8 presents enrollment cell means of household income, along with the ï¬tted
values of a locally weighted regression calculated within each enrollment segment. There is visual
evidence that income changes discontinuously around the ï¬rst cut-oï¬€â€”schools just to the right
contain students who come from wealthier households. Panel B shows, not surprisingly, that they
also have students with higher average mothersâ€™ schoolingâ€”as much as a full year. While jumps
at the subsequent cut-oï¬€ points are less evident, the clear discontinuities at the ï¬rst one (which
provides the bulk of observations, as shown in Figure 7) are suï¬ƒcient to cast doubt on the RD
approach in this context.
       Columns 1-3 of Table 5 present regressions of household characteristics on the piecewise linear
spline in enrollment and indicator variables for the class-size cut-oï¬€s. The results are consistent
with the visual evidence from Figure 8. In particular, they conï¬rm that mothersâ€™ schooling,
fathersâ€™ schooling and income display substantial and statistically signiï¬cant jumps at the ï¬rst
enrollment cut-oï¬€; the coeï¬ƒcients for subsequent cut-oï¬€s are positive but not signiï¬cant. This is
further evidence that the continuity assumption on the function f (Xi ) in (31a)â€”which is presumed
to capture the eï¬€ect of all variables that vary with enrollment except class sizeâ€”is violated.
       For another indication that something is amiss in the RD design, consider the sensitivity
of the estimates of the class-size eï¬€ect to the inclusion of socioeconomic controls. If the RD
approach were valid in this context, then including socioeconomic controls in (31a)-(31b) would
  38
    It is worth emphasizing that stacking alone may not violate the RD assumptions in our context. If student
performance depended only on class size and not directly on Î», and there were no sorting, then the students on one
side of the class-size cut-oï¬€ would still serve as a valid control group for those on the other side. The violation of
the RD assumptions arises from the interaction of the stacking and the endogenous sorting of households.



                                                         23
have little eï¬€ect on the estimate of Î³. If the conditional means of the controls with respect to
enrollment were continuous, then the component of each control that varied with enrollment would
be captured by k(Xi ) and f (Xi ), and the component that was orthogonal to enrollment would also
be orthogonal to the instrument. In fact, Columns 4-5 of Table 5 show that the IV estimates from
Columns 4-5 of Table 3 are sensitive to the inclusion of socioeconomic controls. The coeï¬ƒcient
on class size for the math-score speciï¬cation drops in magnitude from -0.7 and signiï¬cant (Table
3, Column 4) to -0.1 and insigniï¬cant (Table 5, Column 4) with the inclusion of the controls.
For the language-score speciï¬cation, the drop is from -0.6 to -0.1. The coeï¬ƒcients on mothersâ€™
schooling and income are strongly signiï¬cant in the test-score regressions; fathersâ€™ schooling is
signiï¬cant at the 10 percent level in the math-score speciï¬cation.39 This is clear evidence that
the exclusion restriction required for the IV estimates in Table 3 is invalid: the cut-oï¬€ dummies
used as instruments are correlated with household characteristics that are omitted from the Table
3 speciï¬cation, and those characteristics are in turn correlated with the test-score outcomes.
    Finally, we explore to extent to which the observed discontinuities in the treatment and out-
come variables, and in other covariates, are robust to more ï¬‚exible speciï¬cations of k(Xi ) and
f (Xi ) in (31a)-(31b). While the literature has not produced a consensus on the correct speciï¬ca-
tion of these functions,40 two practical guidelines for credible RD estimation seem uncontroversial.
First, there should not be evidence of discontinuities in relevant co-variates at the cut-oï¬€s using
the same speciï¬cation of f (Xi ) used in the outcome equation (31a), as for instance we found in
Columns 1-3 of Table 5. Second, it is worrisome if the results, either for the estimates of Î³ or
for the absence of discontinuities in other co-variates, are not robust to the choice of functional
form. To investigate this, Table 6 presents reduced-form regressions analogous to those in columns
1-3 of Tables 3 and 5, using higher order speciï¬cations of the piecewise control function, as in
van der Klaauw (2002).41 Note that the ï¬rst stage (Panel A) is not robust to the addition of
more ï¬‚exible controlsâ€”the estimated declines in class size become small or even positive at some
cut-oï¬€s. This is somewhat surprising given the apparent strength of the ï¬rst stage observed in
   39
      These results are qualitatively similar if we use the predicted class size in equation (30) as an instrument for
class size in place of the piecewise linear spline. Additionally, although we omit the exercise for the sake of space,
we note that the simple within-band IV results in Table 4 are similarly sensitive to the addition of controls for
socioeconomic status (results available from the authors).
   40
      In their very useful review of practical issues in implementing RD designs, for instance, Imbens and Lemieux
(forthcoming) do not make a speciï¬c recommendation.
   41
      For the sake of space we only report the coeï¬ƒcients on the ï¬rst two cut-oï¬€ indicators.




                                                         24
Figure 5.42 But more importantly for our story, note that the discontinuous jumps in test scores
and socioeconomic status (panels B-F) are robust and, if anything, grow stronger as one moves
to the right in the table. In short, Table 6 reaï¬ƒrms that sorting across the cut-oï¬€s appears too
strong to allow for reliable implementation of an RD approach.
       Lee and Card (forthcoming) propose an additional practical procedure to guide the choice of
polynomial for f (Xi ) in the outcome equation in a context such as ours in which the running
variable is discrete. The test is based on a goodness-of-ï¬t statistic for a â€œrestrictedâ€ low-order
polynomial speciï¬cation relative to an â€œunrestrictedâ€ model with a dummy for each value of
the discrete running variable. This is not a deï¬nitive testâ€”Lee and Card note that rejection of a
given polynomial does not necessarily imply that the corresponding estimate of Î³ is inconsistentâ€”
but our conï¬dence in a chosen polynomial speciï¬cation increases if it cannot be rejected by this
Lee-Card test. For the outcome equation (31a) in our case, the test does not reject any of
the speciï¬cations in columns 1-4 of Table 6. This is consistent with the ï¬nding that adding
higher-order polynomial terms does not eliminate the discontinuities in the outcome variables
and co-variates in Panels B-F of Table 6.
       To summarize, our results provide a concrete illustration of Leeâ€™s (forthcoming) observation
that â€œeconomic behavior can corrupt the RD design.â€ It is worth emphasizing that our results
apply to settings in which for-proï¬t schools can set prices and directly inï¬‚uence their enrollments,
and in which households enjoy substantial freedom to sort between schools; we have no reason to
believe that they extend to public-school contexts typically studied. For instance, Angrist and
Lavy (1999) point out that in the Israeli public school context they analyze, pupils are required
to attend their neighborhood schools, and schools in turn must accept applicants.43 Further,
migration and immigration may render it diï¬ƒcult for schools to predict enrollments, and private
participation is limited to orthodox schools.44
  42
      We have veriï¬ed that other years and grades of the administrative enrollment data produce similar results.
  43
      Similarly, in some exercises Urquiola (2006) considers Bolivian schools in rural towns in which school choice is
likely to be very limited.
   44
      The observation that Israeli institutions prevent strategic behavior of the kind we emphasize in this paper
is consistent with the ï¬nding of Angrist and Lavy (1999) that, controlling for secular enrollment eï¬€ects, adding
controls for the proportion of students with low socioeconomic backgrounds does not aï¬€ect their key estimates. For
an alternative approach to checking for discontinuities in co-variates at discontinuities, see McEwan and Shapiro
(forthcoming).




                                                         25
6         Conclusion

The model developed in this paper oï¬€ers an explanation for two distinct empirical patterns ob-
served in the Chilean data. First, there is an inverted-U cross-sectional relationship between class
size and household income, which is likely to bias non-experimental estimates of the eï¬€ect of
class size. Second, schoolsâ€™ enrollments tend to stack at multiples of the class-size cap, which, in
conjunction with the sorting of households into schools of diï¬€erent quality, generates discontinu-
ities in household characteristics at these points. These in turn violate the assumptions required
for regression-discontinuity analyses of class size. The fact that a single, relatively parsimonious
model can account for these two distinct phenomena suggests that it is a useful way to organize our
thinking about class size and sorting in liberalized education markets. Our ï¬ndings recommend
caution in interpreting cross-sectional and RD estimates of the eï¬€ect of class size in such settings,
and underline the value of randomized experiments to estimate class-size eï¬€ects in contexts where
schools are free to set prices and/or turn away students, and households are free to sort between
schools.45
         Our results also recommend caution more broadly in the application and interpretation of RD
designs. It has become increasingly common to use discontinuities in the application of regulations
to estimate causal eï¬€ects of those regulations. But in contexts where economic agents interact
freely in markets, such discontinuities are likely to generate discontinuities along more than one
dimension, undermining the RD approach. This general observation has been made before, by
Lee (forthcoming) and others. This paper has sought to provide a concrete illustration of such
behavior, in a setting with heterogeneity and sorting on two sides of an important market.




References
Altonji, J. G., C. Huang, and C. R. Taber (2005): â€œEstimating the Cream Skimming Eï¬€ect of
  Private School Vouchers on Public School Students,â€ Unpub. paper, Northwestern University.
Anderson, S., and A. de Palma (2001): â€œProduct Diversity in Asymmetric Oligopoly: Is the Quality
 of Consumer Goods Too Low?,â€ Journal of Industrial Economics, 49(2), 113â€“135.
Anderson, S., A. de Palma, and J.-F. Thisse (1992): Discrete-Choice Theory of Product Diï¬€erenti-
 ation. MIT Press, Cambridge, MA.
    45
    Banerjee, Cole, Duï¬‚o, and Linden (forthcoming) present randomized evaluations of two programs to increase
teacher attention per student in India.




                                                     26
Angrist, J., and A. Krueger (1999): â€œEmpirical Strategies in Labor Economics,â€ in Handbook of Labor
 Economics, ed. by O. Ashenfelter, and D. Card, vol. 3A. Elsevier Science.
Angrist, J. D., and V. Lavy (1999): â€œUsing Maimonidesâ€™ Rule to Estimate the Eï¬€ect of Class Size on
 Scholastic Achievement,â€ Quarterly Journal of Economics, 114(2), 533â€“575.
Asadullah, M. N. (2005): â€œThe Eï¬€ect of Class Size on Student Achievement:               Evidence from
  Bangladesh,â€ Applied Economics Letters, 12(4), 217 â€“ 221.
Banerjee, A., S. Cole, E. Duflo, and L. Linden (forthcoming): â€œRemedying Education: Evidence
  from Two Randomized Experiments in India,â€ Forthcoming in Quarterly Journal of Economics.
Bartle, R. G. (1976): The Elements of Real Analysis. John Wiley & Sons, New York, 2nd edition edn.
Bayer, P., R. McMillan, and K. Rueben (2004): â€œAn Equilibrium Model of Sorting in an Urban
  Housing Market,â€ NBER Working Paper # 10865.
Bressoux, P., F. Kramarz, and C. Prost (2005): â€œTeachersâ€™ Training, Class Size and Studentsâ€™
  Outcomes: Evidence from Third Grade Classes in France,â€ Unpub. paper, CREST.
Browning, M., and E. Heinesen (2003): â€œClass Size, Teacher Hours and Educational Attainment,â€
  Centre for Applied Microeconometrics Working Paper 2003-15, Institute of Economics, University of
  Copenhagen.
Caucutt, E. M. (2002): â€œEducational Vouchers When There are Peer Group Eï¬€ects: Size Matters,â€
  International Economic Review, 43(1), 195 â€“ 222.
Clotfelter, C. T. (1999): â€œPublic School Segregation in Metropolitan Areas,â€ Land Economics, 75(4),
  487â€“504.
Dixit, A. K. (1976): Optimization in Economic Theory. Oxford University Press, Oxford, UK.
Dobbelsteen, S., J. Levin, and H. Oosterbeek (2002): â€œThe Causal Eï¬€ect of Class Size on Scholastic
 Achievement: Distinguishing the Pure Class Size Eï¬€ect from the Eï¬€ect of Changes in Class Composi-
 tion,â€ Oxford Bulletin of Economics and Statistics, 64(1), 17â€“38.
Elacqua, G. (2005): â€œHow Do For-Proï¬t Schools Respond to Voucher Funding? Evidence from Chile,â€
  Occasional Paper, National Center for Study of Privatization in Education, Teachers College, Columbia
  University.
Epple, D., D. Figlio, and R. Romano (2002): â€œCompetition Between Private and Public Schools:
  Testing Stratiï¬cation and Pricing Predictions,â€ Unpub. paper, University of Florida.
Epple, D., and R. Romano (1998): â€œCompetition Between Private and Public Schools, Vouchers, and
  Peer Group Eï¬€ects,â€ American Economic Review, 88(1), 33â€“62.
        (2002): â€œEducation Vouchers and Cream Skimming,â€ NBER Working Paper #9354.
Epple, D., R. Romano, and H. Sieg (2006): â€œAdmission, Tuition, and Financial Aid Policies in the
  Market for Higher Education,â€ Econometrica, 74(4), 885 â€“ 928.
Ferreyra, M. M. (2007): â€œEstimating the Eï¬€ects of Private School Vouchers in Multi-District
  Economies,â€ American Economic Review, 97(3), 789â€“817.
Gabszewicz, J. J., and J.-F. Thisse (1979): â€œPrice Competition, Quality, and Income Disparities,â€
 Journal of Economic Theory, 20, 340â€“359.
Hahn, J., P. Todd, and W. van der Klaauw (2001): â€œIdentiï¬cation and Estimation of Treatment
 Eï¬€ects with a Regression-Discontinuity Design,â€ Econometrica, 69(1), 201â€“209.
Hanushek, E. A. (1995): â€œInterpreting Recent Research on Schooling in Developing Countries,â€ World
 Bank Research Observer, 10, 227â€“246.
        (2003): â€œThe Failure of Input-Based Schooling Policies,â€ Economic Journal, 113(485), F64â€“F98.



                                                  27
Hoxby, C. M. (2000): â€œThe Eï¬€ects of Class Size on Student Achievement: New Evidence from Population
 Variation,â€ Quarterly Journal of Economics, 115(4), 1239â€“1285.
Hsieh, C.-T., and M. Urquiola (2006): â€œThe Eï¬€ects of Generalized School Choice on Achievement
  and Stratiï¬cation: Evidence from Chileâ€™s School Voucher Program,â€ Journal of Public Economics, 90,
  1477â€“1503.
Imbens, G., and T. Lemieux (forthcoming): â€œRegression Discontinuity Designs: A Guide to Practice,â€
  Forthcoming in Journal of Econometrics.
Jakubowski, M., and P. Sakowski (2005): â€œQuasi-Experimental Estimates of Class Size Eï¬€ect in
  Primary Schools in Poland,â€ Unpub. paper, Warsaw University, Faculty of Economics.
Kremer, M. R. (1995): â€œResearch on Schooling: What We Know and What We Donâ€™t: A Comment,â€
 World Bank Research Observer, 10(2), 247â€“254.
Krueger, A. B. (2003): â€œEconomic Considerations and Class Size,â€ Economic Journal, 113(485), F34â€“63.
Lazear, E. P. (2001): â€œEducational Production,â€ Quarterly Journal of Economics, 116(3), 777â€“803.
Lee, D. S. (forthcoming): â€œRandomized Experiments from Non-Random Selection in U.S. House Elec-
  tions,â€ Forthcoming in Journal of Econometrics.
Lee, D. S., and D. Card (forthcoming): â€œRegression Discontinuity Inference with Speciï¬cation Error,â€
  Forthcoming in Journal of Econometrics.
Manski, C. (1992): â€œEducational Choice (Vouchers) and Social Mobility,â€ Economics of Education Review,
 11(4), 351â€“369.
McCrary, J. (forthcoming): â€œManipulation of the Running Variable in the Regression Discontinuity
 Design: A Density Test,â€ Forthcoming in Journal of Econometrics.
McEwan, P., and J. Shapiro (forthcoming): â€œThe Beneï¬ts of Delayed Primary School Enrollment:
 Discontinuity Estimates Using Exact Birth Dates,â€ Forthcoming in Journal of Human Resources.
McFadden, D. (1974): â€œConditional Logit Analysis of Qualitative Choice Behavior,â€ in Frontiers in
 Econometrics, ed. by P. Zarembka, pp. 105â€“142. Academic Press, New York.
Mizala, A., and P. Romaguera (2002): â€œEquity and Educational Performance,â€ EconomÄ±Ìa, 2(2), 219â€“
 262.
Mussa, M., and S. Rosen (1978): â€œMonopoly and Product Quality,â€ Journal of Economic Theory, 18,
 301â€“317, a.
Nechyba, T. J. (2003): â€œCentralization, Fiscal Federalism, and Private School Attendance,â€ International
  Economic Review, 44(1), 179â€“204.
Nesheim, L. (2002): â€œEquilibrium Sorting of Heterogeneous Consumers Across Locations: Theory and
  Empirical Implications,â€ CEMMAP Working Paper CWP08/02, University College London.
Piketty, T., and M. Valdenaire (2006): â€œLâ€™Impact de la Taille des Classes sur la ReÌussite Scolaire
  Dans les EÌcoles, ColleÌ€ges et LyceÌes Fran cais [The Impact of Class Size on Student Success in French
  Primary and Secondary Schools],â€ Les Dossiers, MinisteÌ€re de lâ€™EÌducation Nationale, no. 173.
Rothstein, J. (2006): â€œGood Principals or Good Peers? Parental Valuation of School Characteristics,
  Tiebout Equilibrium, and the Eï¬€ects of Inter-District Competition,â€ American Economic Review, 96(4),
  1333â€“1350.
Shadish, W. R., T. D. Cook, and D. T. Campbell (2002): Experimental and Quasi-Experimental
  Designs for Generalized Causal Inference. Boston.
Shaked, A., and J. Sutton (1982): â€œRelaxing Price Competition through Product Diï¬€erentiation,â€
  Review of Economic Studies, 49, 3â€“13.
Thistlewaite, D., and D. Campbell (1960): â€œRegression Discontinuity Analysis: An Alternative to


                                                   28
  the Ex-Post Facto Experiment,â€ Journal of Educational Psychology, 51, 309â€“317.
Urquiola, M. (2005): â€œDoes School Choice Lead to Sorting? Evidence from Tiebout Variation,â€ Ameri-
 can Economic Review, 95(4), 1310â€“1326.
         (2006): â€œIdentifying Class Size Eï¬€ects in Developing Countries: Evidence from Rural Schools in
  Bolivia,â€ Review of Economics and Statistics, 88(1).
van der Klaauw, W. (2002): â€œEstimating the Eï¬€ect of Financial Aid Oï¬€ers on College Enrollment: A
  Regression Discontinuity Approach,â€ International Economic Review, 43(4), 1249â€“1287.
Verhoogen, E. A. (2007): â€œTrade, Quality Upgrading and Wage Inequality in the Mexican Manufactur-
 ing Sector,â€ CEPR discussion paper no. 6385, July.
WoÌˆssmann, L. (2005): â€œEducational Production in Europe,â€ Economic Policy, (43), 445 â€“ 493.




                                                  29
A     Theory Appendix
In this appendix, to avoid clutter, we do not write explicitly the dependence of x, n and p on Î»,
of q(Â·) on x, n and Î», or of d(Â·) and Î˜(Â·) on p and q, but this dependence should be understood.
As above, asterisks indicate equilibrium values.

A.1     Case 1: Divisible Classrooms
To solve the schoolâ€™s optimization problem in this case, form the Lagrangian from (9), where the
constraints are (12) and (11):
                                                                           x     
               L(p, x, n; Î») = (p âˆ’ c + Ï„ ) x âˆ’ nFc âˆ’ Fs âˆ’ Ï†1 (x âˆ’ d) âˆ’ Ï†2    âˆ’ 45          (32)
                                                                            n
The ï¬rst-order conditions are:
                                          
                âˆ‚L                     d
                      = x + Ï†1       âˆ’         =0                                                (33a)
                âˆ‚p                     Âµ
                âˆ‚L                         Î¸
                                        âˆ‚s(Î»|Î¸, q, p)                   x
                      = âˆ’Fc + Ï†1                      M g(Î¸) dÎ¸ + Ï†2
                âˆ‚n                   Î¸      âˆ‚n                           n2
                                                  x
                                      Î»Î˜d
                      =   âˆ’Fc + Ï†1           + Ï†2         =0                                     (33b)
                                       Âµn             n2
                                                                               
                                                   Î¸
                âˆ‚L                                   âˆ‚s(Î»|Î¸, q, p)               1
                      =   p âˆ’ c + Ï„ âˆ’ Ï†1 1 âˆ’                       g(Î¸) dÎ¸ âˆ’ Ï†2
                âˆ‚x                               Î¸       âˆ‚x                      n
                                                             
                                               Î»Î˜d              1
                      =   p âˆ’ c + Ï„ âˆ’ Ï†1 1 +            âˆ’ Ï†2         =0                          (33c)
                                                Âµx              n
                âˆ‚L                          âˆ‚L
                      â‰¥   0, Ï†1 â‰¥ 0, and Ï†1       =0                                             (33d)
                âˆ‚Ï†1                         âˆ‚Ï†1
                âˆ‚L                          âˆ‚L
                      â‰¥   0, Ï†2 â‰¥ 0, and Ï†2       =0                                             (33e)
                âˆ‚Ï†2                         âˆ‚Ï†2

where s(Î»|Î¸, q, p) is given by (2). The interchanging of the partial derivatives and the integrals is
justiï¬ed by a standard property of integrals (see e.g. Bartle (1976, Theorem 31.7, p. 245)) and
the continuity of s(Î»|Î¸, q, p) and its partial derivatives.
                           âˆ‚L
    Suppose Ï†1 = 0 and âˆ‚Ï†    1
                               > 0, i.e. the demand constraint is not binding. Then (33a) implies
x = 0, and (33b) in turn implies Fc = 0, which is false. Hence if there is a solution it must be
      âˆ‚L
that âˆ‚Ï† 1
          = 0 and the demand constraint is binding: x = d. It follows from (33a) that Ï†1 = Âµ.
We then have two sub-cases.

A.1.1    Sub-Case 1.1: Class-Size Cap Non-Binding
                                                                âˆ‚L                      x       Fc
In this sub-case, the class size cap is non-binding: Ï†2 = 0 and âˆ‚Ï† 2
                                                                     â‰¥ 0. By (33b),     n   =   Î»Î˜   and
 âˆ‚L                    Fc
âˆ‚Ï†2 â‰¥ 0 implies Î»Î˜ â‰¥ 45 . Simple algebra then yields (13a)-(13c).




                                                    30
   To check the second-order conditions, form the bordered Hessian:
                                   â›                         â
                                            âˆ‚h     âˆ‚h    âˆ‚h
                                       0
                                   âœ âˆ‚h âˆ‚âˆ‚p  2
                                                   âˆ‚n
                                                  âˆ‚2L
                                                         âˆ‚x
                                                        âˆ‚2L âŸ
                                   âœ âˆ‚p âˆ‚pL2 âˆ‚nâˆ‚p            âŸ
                              Hâ‰¡âœ  âœ âˆ‚h âˆ‚ 2 L     âˆ‚2L
                                                        âˆ‚xâˆ‚p âŸ
                                                        âˆ‚2L âŸ
                                   â âˆ‚n âˆ‚pâˆ‚n âˆ‚n2 âˆ‚xâˆ‚n â 
                                                           âˆ‚h           âˆ‚2L          âˆ‚2L           âˆ‚2L
                                                           âˆ‚x           âˆ‚pâˆ‚x         âˆ‚nâˆ‚x          âˆ‚x2

where h(p, n, x; Î») â‰¡ x âˆ’ d. It is then straightforward (if tedious) to show that the last two leading
principal minors alternate in sign with the last one negative (and hence that the Hessian of L is
negative deï¬nite on the constraint set) if and only if (14) holds. Rewriting (14),

               Î¸                                                      Î¸                                              
                           s(Î»| Î¸, q âˆ— , pâˆ— )g(Î¸)                               Î»Î¸               s(Î»| Î¸, q âˆ— , pâˆ— )g(Î¸)              Î»Î˜âˆ—2
                   Î¸                                    dÎ¸ >                             Î¸                                    dÎ¸ âˆ’
           Î¸                    s(q âˆ— , pâˆ— )                        Î¸           Âµ                     s(q âˆ— , pâˆ— )                    Âµ

Under assumption (7), Î»Î¸ Âµ < 1 for all values of Î» and Î¸. Hence the left-hand-side term is greater
than the ï¬rst term on the right-hand side. Since the second term on the right-hand side is negative,
it follows that the solution to the ï¬rst-order conditions given is a local constrained maximum.
Moreover, the negative-deï¬niteness of L on the constraint set holds for all p, n and all x > 0,
hence the local maximum is a unique global maximum of the constrained optimization problem.
   Rewrite (13a)-(13c), together with (5), noting that Ï† = Âµ and x = d:

                                     G1 = pâˆ— âˆ’ (Âµ + c âˆ’ Ï„ + Î»Î˜âˆ— ) = 0                                                                       (34a)
                                                               Î¸
                                     G2 = xâˆ— âˆ’                     s(Î»|Î¸, q âˆ— , pâˆ— )M g(Î¸) dÎ¸ = 0                                           (34b)
                                                           Î¸
                                                               Î¸                                        
                                                    âˆ—   s(Î»|Î¸, q âˆ— , pâˆ— )g(Î¸)
                                     G3    â‰¡ Î˜ âˆ’     Î¸                                                       dÎ¸ = 0                         (34c)
                                                   Î¸        s(q âˆ— , pâˆ— )
                                                   Î»Î˜âˆ— xâˆ—
                                     G4    = âˆ’Fc +        =0                                                                                (34d)
                                                     nâˆ—
                                              âˆ—
It is convenient to deï¬ne z âˆ— = nxâˆ— (class size) and analyze (34a)-(34d) as a set of four equations
with four endogenous variables, pâˆ— , xâˆ— , Î˜, and z âˆ— , and one exogenous variable, Î». Let J be the
Jacobian:                              â› âˆ‚G1 âˆ‚G1 âˆ‚G1 âˆ‚G1 â
                                                           âˆ‚pâˆ—              âˆ‚xâˆ—      âˆ‚z âˆ—         âˆ‚Î˜âˆ—
                                                 âœ         âˆ‚G2              âˆ‚G2      âˆ‚G2          âˆ‚G2    âŸ
                                                 âœ         âˆ‚pâˆ—              âˆ‚xâˆ—      âˆ‚z âˆ—         âˆ‚Î˜âˆ—    âŸ
                                              J â‰¡âœ         âˆ‚G3              âˆ‚G3      âˆ‚G3          âˆ‚G3    âŸ
                                                 â         âˆ‚pâˆ—              âˆ‚xâˆ—      âˆ‚z âˆ—         âˆ‚Î˜âˆ—    â 
                                                           âˆ‚G4              âˆ‚G4      âˆ‚G4          âˆ‚G4
                                                           âˆ‚pâˆ—              âˆ‚xâˆ—      âˆ‚z âˆ—         âˆ‚Î˜âˆ—

   By the implicit function theorem:
                                                  â›     âˆ‚pâˆ—    â                         â›       âˆ‚G1   â
                                                         âˆ‚Î»                                       âˆ‚Î»
                                                  âœ     âˆ‚xâˆ—    âŸ         âœ                       âˆ‚G2   âŸ
                                                  âœ      âˆ‚Î»    âŸ = âˆ’J âˆ’1 âœ                        âˆ‚Î»   âŸ                                     (35)
                                                  â     âˆ‚z âˆ—   â          â                       âˆ‚G3   â 
                                                         âˆ‚Î»                                       âˆ‚Î»
                                                        âˆ‚Î˜âˆ—                                      âˆ‚G4
                                                         âˆ‚Î»                                       âˆ‚Î»




                                                                             31
   It is straightforward to show that:
                                                           Î¨
                                              det J = âˆ’       <0                                            (36)
                                                           Î˜âˆ—
since Î¨ > 0 (refer to (14)). Simplifying (35), we have:
                                        â›                                    â
                           â› âˆ‚pâˆ— â          Î˜âˆ—     âˆ— + Î» ln T Ïƒ 2
                                                 Î˜                âˆ—
                               âˆ‚Î»âˆ—      âœ Î¨          âˆ— Î˜âˆ—
                                                         Âµ
                                                              Tz  Î¸|Î»          âŸ
                           âœ âˆ‚x âŸ âœ     âœ          x
                                                          ln                     âŸ
                           âœ âˆ‚Î»âˆ— âŸ = âœ           Âµ   zâˆ—                      âŸ
                           â âˆ‚z â  âœ âˆ’ z âˆ— Î» ln Tâˆ— Ïƒ 2 + Î˜âˆ—                       âŸ                          (37)
                               âˆ‚Î»
                                                                                 âŸ
                              âˆ‚Î˜âˆ—       â Î»Î¨ âˆ— Âµ2         z      Î¸|Î»             â 
                                               Î˜ ÏƒÎ¸|Î»   T          
                               âˆ‚Î»                       ln         + 1
                                                ÂµÎ¨           z âˆ—


at the optimum.
                          2
    In the deï¬nition of ÏƒÎ¸|Î» in (15), the fact that the double-exponential distribution yields a
non-zero probability that any given household will choose any given school implies that the term
in brackets is non-zero for all Î¸. Hence as long as Î¸ = Î˜âˆ— for some Î¸, which follows from the
assumption that Î¸ has positive support over (Î¸, Î¸), we have:
                                                   2
                                                  ÏƒÎ¸|Î» >0                                                   (38)

The results (16a), (16b), (16d) and (16e) follow from (14), (37) and (38). Finally, we have:
                                       
                            âˆ‚nâˆ—     âˆ‚ xâˆ—         1 âˆ‚xâˆ—    xâˆ— âˆ‚z âˆ—
                                 =            =        âˆ’           >0
                             âˆ‚Î»    âˆ‚Î» z âˆ—       z âˆ— âˆ‚Î»    z âˆ— 2 âˆ‚Î»

where the inequality follows from (16b) and (16e). This gives (16c).

A.1.2    Sub-Case 1.2: Class-Size Cap Binding
                                                                   âˆ‚L                    x
In this sub-case, the class-size cap is binding: Ï†2 â‰¥ 0 and        âˆ‚Ï†2   = 0 (that is,   n   = 45). By (33b) and
                                                Ï†2    F                                     F
the facts that x = d and Ï†1 = Âµ, we have      = n  âˆ’ Î»Î˜. The fact that Ï†2 â‰¥ 0 implies Î»Î˜ â‰¤ 45
                                                      45                                      .
Algebra yields (17a)-(17c).
   To verify the second-order conditions, the bordered Hessian is:
                                 â›              âˆ‚h1    âˆ‚h1   âˆ‚h1
                                                                   â
                                     0     0    âˆ‚p     âˆ‚n     âˆ‚x
                                 âœ 0            âˆ‚h2    âˆ‚h2   âˆ‚h2 âŸ
                                 âœ         0                  âˆ‚x âŸ
                                 âœ âˆ‚h1 âˆ‚h2 âˆ‚âˆ‚p   2L
                                                       âˆ‚n
                                                        2      2L âŸ
                            Hâ‰¡âœ  âœ âˆ‚p      âˆ‚p   âˆ‚p2
                                                      âˆ‚
                                                      âˆ‚nâˆ‚p
                                                          L  âˆ‚
                                                            âˆ‚xâˆ‚p âŸ
                                                                   âŸ                      (39)
                                 âœ âˆ‚h1 âˆ‚h2 âˆ‚ 2 L      âˆ‚2L    âˆ‚2L âŸ
                                 â âˆ‚n âˆ‚n âˆ‚pâˆ‚n âˆ‚n2 âˆ‚xâˆ‚n â 
                                        âˆ‚h1     âˆ‚h2   âˆ‚2L     âˆ‚2L        âˆ‚2L
                                        âˆ‚x      âˆ‚x    âˆ‚pâˆ‚x    âˆ‚nâˆ‚x       âˆ‚x2

where L is given in (32), h1 (p, n, x, Î») â‰¡ x âˆ’ d and h2 (p, n, x, Î») â‰¡ nx âˆ’ 45. It is straightforward to
                       x3
verify that det H = âˆ’ Âµn 4 < 0 at the optimum, and hence that the second-order conditions for a
maximum are satisï¬ed.




                                                      32
   To analyze the slopes with respect to Î» in this sub-case, rewrite (17a)-(17c) with (5) as:
                                                       
                                  âˆ—                  Fc
                        G1 = p âˆ’ c âˆ’ Ï„ + Âµ +              =0                                 (40a)
                                                     45
                                                Î¸
                          G2 = xâˆ— âˆ’                 s(Î»|Î¸, q âˆ— , pâˆ— )M g(Î¸) dÎ¸ = 0             (40b)
                                            Î¸
                                                Î¸                             
                                      âˆ—               s(Î»|Î¸, q âˆ— , pâˆ— )g(Î¸)
                          G3 â‰¡ Î˜ âˆ’                  Î¸                              dÎ¸ = 0         (40c)
                                            Î¸             s(q âˆ— , pâˆ— )
                                           xâˆ—
                          G4 = nâˆ— âˆ’                 =0                                         (40d)
                                           45
   Applying the implicit function theorem (as in (35)) to (40a)-(40d), we have:
                                 â›   âˆ‚pâˆ—   â                            â›        â
                                                                             0
                                      âˆ‚Î»                           
                                 âœ   âˆ‚xâˆ—   âŸ 1                 T        âœ xâˆ— Î˜âˆ— âŸ
                                 âœ    âˆ‚Î»   âŸ = ln                       âœ x âˆ— Î˜âˆ— âŸ                 (41)
                                 â   âˆ‚nâˆ—   â  Âµ                 45       â        â 
                                      âˆ‚Î»                                    45
                                     âˆ‚Î˜âˆ—                                     2
                                                                          ÏƒÎ¸|Î»
                                      âˆ‚Î»

which in turn implies (18a)-(18e).
                     âˆ—
    The fact that âˆ‚Î˜                                           âˆ—
                   âˆ‚Î» > 0 in both sub-cases implies that Î»Î˜ is monotonically increasing in Î» and
guarantees that there is at most one critical value of Î», call it Î±, at which (19) holds. The results
for the ï¬rst sub-case apply for Î» â‰¥ Î± and the results for the second sub-case apply for Î» < Î±.

A.2    Case 2: Indivisible Classrooms
The Lagrangian in this case is the same as (32), but n is now interpreted as a parameter:
                                                                         x     
             L(p, x; n, Î») = (p âˆ’ c + Ï„ ) x âˆ’ nFc âˆ’ Fs âˆ’ Ï†1 (x âˆ’ d) âˆ’ Ï†2    âˆ’ 45                   (42)
                                                                          n
The ï¬rst-order conditions are:
                                        
                        âˆ‚L               d
                              = x âˆ’ Ï†1       =0                                                   (43a)
                        âˆ‚p               Âµ
                                                               
                        âˆ‚L                          Î»Î˜d          1
                              = p âˆ’ c + Ï„ âˆ’ Ï†1 1 +         âˆ’ Ï†2     =0                         (43b)
                        âˆ‚x                            Âµx         n
                       âˆ‚L                         âˆ‚L
                              â‰¥ 0, Ï†1 â‰¥ 0, and Ï†1      =0                                         (43c)
                       âˆ‚Ï†1                        âˆ‚Ï†1
                       âˆ‚L                         âˆ‚L
                              â‰¥ 0, Ï†2 â‰¥ 0, and Ï†2      =0                                      (43d)
                       âˆ‚Ï†2                        âˆ‚Ï†2
   We can quickly rule out the possibility that the demand constraint is not binding:
                                                                                 âˆ‚L
  1. If neither the demand constraint nor the class-size cap is binding (Ï†1 = 0, âˆ‚Ï† 1
                                                                                      â‰¥ 0, Ï†2 = 0
           âˆ‚L
     and âˆ‚Ï†2 â‰¥ 0) then by (43a), x = 0 and by (43b), p = c âˆ’ Ï„ . It is straightforward to verify
     that the second-order conditions are not satisï¬ed in this sub-case.
                                                                                            âˆ‚L
  2. If the demand constraint is not binding but the class-size cap is binding (Ï†1 = 0,     âˆ‚Ï†1   â‰¥ 0,


                                                          33
                   âˆ‚L
     Ï†2 â‰¥ 0 and âˆ‚Ï†   2
                       = 0) then by (43a), we have x = 0. This violates the class-size constraint
     ( nx = 45); hence there is no solution in this case.

   There are then two sub-cases to be considered.

A.2.1   Sub-Case 2.1: Class-Size Cap Non-Binding
In this sub-case, the demand constraint is binding and the class-size cap is non-binding: Ï†1 â‰¥ 0,
 âˆ‚L                âˆ‚L
âˆ‚Ï†1 = 0, Ï†2 = 0, âˆ‚Ï†2 â‰¥ 0. Equations (20a)-(20b) follow immediately from (43a)-(43b).
    The second-order conditions can be veriï¬ed by evaluating the determinant of the bordered
Hessian (3x3 in this case). The determinant is positive, and the second-order conditions are
satisï¬ed, if condition (14) is satisï¬ed. This condition is guaranteed by (7). We again have that
the Hessian of the proï¬t function is negative deï¬nite on the constraint set, and hence that the
solution given by (20a)-(20b) is a global maximum.
    Rewrite (20a)-(20b), together with (5):

                          G1 = pâˆ— âˆ’ [Âµ + c âˆ’ Ï„ + Î»Î˜âˆ— ] = 0                                         (44a)
                                                       Î¸
                          G2 â‰¡ xâˆ— âˆ’                         s(Î»|Î¸, q âˆ— , pâˆ— )M g(Î¸) dÎ¸ = 0         (44b)
                                                   Î¸
                                                        Î¸                            
                                             âˆ—                s(Î»|Î¸, q âˆ— , pâˆ— )g(Î¸)
                          G3 â‰¡ Î˜ âˆ’                          Î¸                             dÎ¸ = 0   (44c)
                                                    Î¸             s(q âˆ— , pâˆ— )

Note that these are the same as (34a)-(34c). (The number of classrooms is now treated as a
parameter, and we no longer have (34d).) Inverting the Jacobian (3x3 in this case) and using the
implicit function theorem (as in (35)) applied to (44a)-(44c), we have:
                                             â›            âˆ—2            2 â
                     â› âˆ‚pâˆ— â                    Î˜âˆ— + Î»Î˜Âµ + ÂµÎ» ln nT     xâˆ— ÏƒÎ¸|Î»
                         âˆ‚Î»âˆ—                 âœ                              âŸ
                     â âˆ‚x â  =           1    âœ     x âˆ—
                                                         Î¨ ln   nT
                                                                      âˆ’  Î˜ âˆ—    âŸ
                                             âœ      Âµ           x âˆ—             âŸ           (45)
                         âˆ‚Î»âˆ—
                        âˆ‚Î˜           1 +  Î»Î¨ â
                                           Âµ
                                                    2    
                                                   ÏƒÎ¸|Î» Î»Î˜âˆ—            nT    â 
                         âˆ‚Î»
                                                    Âµ       Âµ + ln xâˆ—

The results (21a),(21b) and (23) follow from (14), (22), (38), and (45).
                   âˆ‚L
   The condition âˆ‚Ï†  2
                       â‰¥ 0 requires:

                              Î¸                   Î¸Î»                           
                                   1         T      Âµ             c âˆ’ Ï„ + Âµ + Î»Î˜âˆ—
                  45n â‰¤                                     exp âˆ’                   M g(Î¸) dÎ¸
                          Î¸       â„¦(Î¸)       45                          Âµ

Taking the exponential term out of the integral and solving for Î»Î˜âˆ— , we have:

                                   Î»Î˜âˆ— â‰¤ Âµ ln Î£ âˆ’ Âµ ln(45n) âˆ’ c + Ï„ âˆ’ Âµ

where Î£ is deï¬ned as in (25). Setting this inequality to an equality yields (27), which implicitly
deï¬nes Î²(n), the value of Î» at which the class-size cap begins to bind.




                                                                  34
A.2.2    Sub-Case 2.2: Class-Size Cap Binding
                                                                                     âˆ‚L
In this sub-case, both the demand constraint and class-size cap are binding: Ï†1 â‰¥ 0, âˆ‚Ï† 1
                                                                                           = 0,
             âˆ‚L
Ï†2 â‰¥ 0 and âˆ‚Ï†2 = 0. The two constraints, x = d and x = 45n, pin down the values of p and x,
and the results (24a)-(24b) follow
                                   immediately.
                  âˆ‚xâˆ—    âˆ‚    x
    The fact that âˆ‚Î» = âˆ‚Î» n = 0 follows immediately. It is straightforward to show that
                                                    
                                    âˆ‚pâˆ—               T
                                        = Î˜âˆ— ln            >0                             (46a)
                                     âˆ‚Î»               45
                                                        
                                    âˆ‚Î˜âˆ—      1 2         T
                                        =      ÏƒÎ¸|Î» ln      >0                            (46b)
                                     âˆ‚Î»      Âµ           45

   It remains to establish the set of schools over which the condition Ï†2 â‰¥ 0 is satisï¬ed. The ï¬rst
order conditions imply:

                           Ï†2 = n {Âµ ln Î£ âˆ’ Âµ ln(45n) âˆ’ c + Ï„ âˆ’ Âµ âˆ’ Î»Î˜âˆ— }                         (47)

By the deï¬nition of Î²(n) above, if Î» = Î²(n) then Ï†2 = 0. Partially diï¬€erentiating (47):
                                                               
                             âˆ‚Ï†2            Âµ âˆ‚Î£     âˆ‚Î˜âˆ—      âˆ—
                                     = n         âˆ’Î»       âˆ’Î˜
                              âˆ‚Î»            Î£ âˆ‚Î»      âˆ‚Î»
                                                         
                                                  T       âˆ—
                                     = n Î¨ ln         âˆ’Î˜ >0
                                                  45

by assumption (22). Thus Ï†2 â‰¥ 0 for Î» â‰¥ Î²(n). The ï¬rst sub-case applies for Î» â‰¤ Î²(n) and the
second applies for Î» > Î²(n).
    Finally, it follows from (45), (46a), and (22) that:

                                               âˆ‚pâˆ—          âˆ‚pâˆ—
                                       lim         < lim
                                     Î»â†’Î²(n)âˆ’   âˆ‚Î»   Î»â†’Î²(n)+ âˆ‚Î»

That is, the slope of pâˆ— with respect to Î» is steeper to the right of the critical value, in the region
where the class-size cap binds.

A.2.3    Proof of Lemma 1
Our strategy for proof is to begin with a preliminary partition of the set of schools and show
that within each subset there are two possible optimal integer choices, and that there is a critical
value below which the lower integer is optimal and above which the higher integer is optimal.
These new critical values become the basis for the new partition described in the statement of
the lemma.

  1. For a given integer k, let Î´k be the value of Î» at which the optimal number of classrooms
     in Case 1, the divisible-classrooms case, is k. That is, Î´k â‰¡ nâˆ— âˆ’1 (k) where nâˆ— (Î») is deï¬ned
     by (13c) for Î» â‰¥ Î± and by (17c) for Î» < Î±. As noted above, nâˆ— (Î») is continuous and
     monotonically increasing in Î». This implies that Î´k > Î´k if k > k for any positive integers
     k, k . The values Î´k thus form an ordered partition the set of schools.



                                                  35
2. We now show that within the interval Î» âˆˆ [Î´k , Î´k+1 ), the optimal integer number of class-
   rooms is either k or k + 1.
   (a) Deï¬ne functions for proï¬ts under the counterfactual assumptions that the class-size
       cap never binds and that it always binds. That is, let:

                                  Ï€ âˆ— (n, Î») = Ï€(pâˆ— (n, Î»), xâˆ— (n, Î»), n, Î»)

       where pâˆ— (n, Î») and xâˆ— (n, Î») are given by (20a) and (20a), the optimal choices when the
       class-size cap does not bind. Let:

                                  Ï€ âˆ—âˆ— (n, Î») = Ï€(pâˆ— (n, Î»), xâˆ— (n, Î»), n, Î»)

       where pâˆ— (n, Î») and xâˆ— (n, Î») are given by (24b) and (24a), the optimal choices when the
       class-size cap binds. The deï¬nition of Ï€Ìƒ(Â·) in (28) can then be restated:
                                             âˆ—
                                               Ï€ (n, Î») if Î» â‰¤ Î²(n)
                                 (n, Î») =
                                 Ï€                                                         (48)
                                               Ï€ âˆ—âˆ— (n, Î») if Î» > Î²(n)

   (b) We now show that Ï€ âˆ— (n, Î»), Ï€ âˆ—âˆ— (n, Î») and hence Ï€
                                                          (n, Î») are concave in n for any given
       Î»:
         i. By the envelope theorem, we have:
                                                         âˆ‚Ï€ âˆ—   âˆ‚L
                                                              =                            (49)
                                                         âˆ‚n     âˆ‚n
                                                    âˆ—
            where L is given by (32) and âˆ‚Ï€
                                          âˆ‚n allows p and x to vary (holding Î» constant) but
            âˆ‚L
            âˆ‚n holds p, x and Î» constant. Then by (33b):
                                                                          
                         âˆ‚ 2 Ï€âˆ—    âˆ‚       âˆ‚L              âˆ‚          Î»Î˜âˆ— xâˆ—
                              2
                                =                       =      âˆ’Fc +
                         âˆ‚n       âˆ‚n       âˆ‚n             âˆ‚n            n
                                                              âˆ—
                                                            Î»Î˜ xâˆ—    Î»Î˜ âˆ‚xâˆ— Î»xâˆ— âˆ‚Î˜âˆ—
                                                                        âˆ—
                                                        = âˆ’       +           +            (50)
                                                             n2       n âˆ‚n      n âˆ‚n
            Applying the implicit function theorem (as in (35)) to (44a)-(44c),
                                                                     â›           â
                                       â›    âˆ‚pâˆ—     â                       2
                                                                         Î»ÏƒÎ¸|Î»
                                             âˆ‚n               Î»   âœ        n     âŸ
                                       â    âˆ‚xâˆ—     â =            âœ       xâˆ— Î¨   âŸ         (51)
                                             âˆ‚n
                                            âˆ‚Î˜âˆ—            Âµ + Î»Î¨ â        n
                                                                           2
                                                                                 â 
                                                                          ÏƒÎ¸|Î»
                                             âˆ‚n
                                                                           n

            Plugging into (50),
                                           âˆ‚ 2Ï€âˆ—      Î»xÎ¨
                                               2
                                                 =âˆ’          <0
                                           âˆ‚n      n2 1 + Î»Î¨         Âµ

             Hence Ï€ âˆ— (n, Î») is globally concave in n for all Î».
         ii. Combining (8), (24a) and (24b), and diï¬€erentiating twice with respect to n, we
                         2 âˆ—âˆ—
             have that âˆ‚âˆ‚nÏ€2 = âˆ’ 45Âµ                  âˆ—âˆ—
                                     n < 0. Hence Ï€ (n, Î») is globally concave in n for all Î» as
             well.

                                                    36
        iii. Implicitly diï¬€erentiating (27) with respect to n, we have:

                                       âˆ‚Î²(n)         Âµ
                                             =     T      >0                                (52)
                                        âˆ‚n    n Î¨ ln 45 âˆ’ Î˜

            for all n, where the inequality follows from (22). Hence there is a one-to-one
            mapping between Î²(n) and n for a given Î». Î² âˆ’1 (Î») is then the value of n at
            which the class-size cap starts to bind for a given Î». Note that the cap binds for
            n < Î² âˆ’1 (Î») and does not bind for n â‰¥ Î² âˆ’1 (Î»). The deï¬nition of Ï€Ìƒ(Â·) in (48) can
            then be rewritten:
                                             âˆ—
                                               Ï€ (n, Î») if n â‰¥ Î² âˆ’1 (Î»)
                                  (n, Î») =
                                  Ï€                                                        (53)
                                               Ï€ âˆ—âˆ— (n, Î») if n < Î² âˆ’1 (Î»)

            The function Ï€ âˆ— (n, Î») gives the maximized proï¬t for a given n and Î» under one
            equality constraint, namely x = d. The function Ï€ âˆ—âˆ— (n, Î») gives the maximized
            proï¬t for a given n and Î» under two equality constraints, namely x = d and
            x
            n = 45. For a given Î», the two points coincide at the point where the optimal
            class size is 45 even in the absence of the capâ€”that is, where n = Î² âˆ’1 (Î»)â€”and
            for all other n the function Ï€ âˆ—âˆ— (n, Î») lies under Ï€ âˆ— (n, Î»). A standard result in
            optimization theory is that (if both functions are continuously diï¬€erentiable) the
            two curves are tangent at that point (see e.g. Dixit (1976, Ch. 3)).
            Now consider the curvature of the Ï€   (n, Î») function. For n < Î² âˆ’1 (Î»), âˆ‚eÏ€
                                                                                       âˆ‚n is decreas-
            ing in n by the concavity of Ï€ âˆ—âˆ— (n, Î»). For n â‰¥ Î² âˆ’1 (Î»), âˆ‚e
                                                                         Ï€
                                                                        âˆ‚n is decreasing inâˆ— n by the
                                                                                                âˆ‚Ï€ âˆ—âˆ—
            concavity of Ï€ âˆ— (n, Î»). At n = Î² âˆ’1 (Î») the two curves are tangent and âˆ‚Ï€    âˆ‚n = âˆ‚n .
            It follows that âˆ‚eÏ€
                             âˆ‚n is decreasing in n for all n and all Î». Hence Ï€   (n, Î») is globally
            concave in n for all Î».
    (c) Recall the deï¬nition of nâˆ— (Î»), the optimal number of classrooms in the divisible-
        classroom case, from step 1 of this proof. Since nâˆ— (Î») is monotonically increasing
        in Î», Î» âˆˆ [Î´k , Î´k+1 ) implies nâˆ— (Î») âˆˆ [k, k + 1). From the concavity of Ï€
                                                                                  (n, Î») it follows
        that:

                                      Ï€         (k , Î») âˆ€ k < k
                                      (k, Î») > Ï€                                               (54)
                                                               
                                  Ï€             (k , Î») âˆ€ k > k + 1
                                  (k + 1, Î») > Ï€                                               (55)

        That is, within the interval Î» âˆˆ [Î´k , Î´k+1 ) either k or k + 1 must be the optimal integer
        number of classrooms.

3. We now show that in the interval Î» âˆˆ [Î´k , Î´k+1 ) there is a critical value of Î» to the left of
   which k is the optimal number of classrooms and to the right of which k + 1 is the optimal
   number. For Î» âˆˆ [Î´k , Î´k+1 ), deï¬ne:
                                    
                                    Î (Î») â‰¡Ï€
                                          (k + 1, Î») âˆ’ Ï€
                                                        (k, Î»)

   Since k is the unique optimal choice of number of classrooms at Î´k in the divisible-classrooms
   case,
                                 k) = Ï€
                                Î (Î´      (k + 1, Î´k ) âˆ’ Ï€
                                                         (k, Î´k ) < 0


                                               37
Similarly, since k + 1 is the unique optimal number of classrooms at Î´k+1 in the divisible-
classrooms case,
                            k+1 ) = Ï€
                          Î (Î´        (k + 1, Î´k+1 ) âˆ’ Ï€
                                                       (k, Î´k+1 ) > 0
From (52), we know that Î²(k) < Î²(k + 1); the class-size cap starts to bind at a higher value
                                                                  
of Î» for n = k + 1 than for n = k. Using (48), the deï¬nition of Î (Î»)   can be restated:
                      â§ âˆ—
                      â¨ Ï€ (k + 1, Î») âˆ’ Ï€ âˆ— (k, Î»)      if Î» â‰¤ Î²(k)
               
               Î (Î») =     Ï€ âˆ— (k + 1, Î») âˆ’ Ï€ âˆ—âˆ— (k, Î») if Î²(k) < Î» â‰¤ Î²(k + 1)
                      â© âˆ—âˆ—
                          Ï€ (k + 1, Î») âˆ’ Ï€ âˆ—âˆ— (k, Î») if Î²(k + 1) < Î»

Note that Ï€ âˆ— (k, Î²(k)) = Ï€ âˆ—âˆ— (k, Î²(k)) and Ï€ âˆ— (k + 1, Î²(k + 1)) = Ï€ âˆ—âˆ— (k + 1, Î²(k + 1)). Hence

Î (Î») is continuous. Now consider the slope of Î (Î»)       against Î» in each interval:

 (a) Î» â‰¤ Î²(k). The class-size cap binds neither for n = k nor for n = k + 1.
                                                                    
                âˆ‚ 2 Ï€âˆ—     âˆ‚ âˆ‚Ï€ âˆ—        âˆ‚ âˆ‚L          âˆ‚          Î»xâˆ— Î˜âˆ—
                       =              =             =      âˆ’Fc +           >0
                âˆ‚nâˆ‚Î»      âˆ‚Î» âˆ‚n         âˆ‚Î» âˆ‚n         âˆ‚Î»             n

     where the second equality follows from (49), the third equality follows from (33b), and
     the inequality follows from (21b) and (23). Hence:

                                 
                                dÎ    âˆ‚Ï€ âˆ— (k + 1, Î») âˆ‚Ï€ âˆ— (k, Î»)
                                   =                âˆ’            >0
                                dÎ»         âˆ‚Î»            âˆ‚Î»


(b) Î²(k) < Î» â‰¤ Î²(k + 1). The class-size cap binds for n = k but not for n = k + 1. Note
    that                                                 
                               âˆ‚Ï€ âˆ—    âˆ‚L      âˆ— âˆ—     nT
                                    =      = x Î˜ ln                                (56)
                                âˆ‚Î»     âˆ‚Î»              xâˆ—
     where L is given by (42), and the ï¬rst equality follows by the envelope theorem. Sim-
     ilarly,                                               
                                 âˆ‚Ï€ âˆ—âˆ—   âˆ‚L                 T
                                       =     = 45nÎ˜âˆ— ln                               (57)
                                  âˆ‚Î»     âˆ‚Î»                45
     At n = k, the optimal enrollment if there were no class-size cap would be greater than
     or equal to 45n; otherwise the cap would not be binding. Hence, comparing (56) and
     (57),
                                     âˆ‚Ï€ âˆ— (k, Î»)   âˆ‚Ï€ âˆ—âˆ— (k, Î»)
                                                 â‰¥
                                         âˆ‚Î»            âˆ‚Î»
     Using step 3a above,

                              âˆ‚Ï€ âˆ— (k + 1, Î»)   âˆ‚Ï€ âˆ— (k, Î»)   âˆ‚Ï€ âˆ—âˆ— (k, Î»)
                                              >             â‰¥
                                     âˆ‚Î»             âˆ‚Î»            âˆ‚Î»
     Hence:
                                
                               dÎ    âˆ‚Ï€ âˆ— (k + 1, Î») âˆ‚Ï€ âˆ—âˆ— (k, Î»)
                                  =                âˆ’             >0
                               dÎ»          âˆ‚Î»           âˆ‚Î»
 (c) Î²(k + 1) < Î». The class-size cap binds for both n = k and n = k + 1. Partially


                                            38
              diï¬€erentiating (57) and using (51),
                                                               
                                    âˆ‚ âˆ‚Ï€ âˆ—âˆ—              T       âˆ‚Î˜
                                                = 45 ln      Î˜+n      >0
                                   âˆ‚n    âˆ‚Î»              45      âˆ‚n

              Hence
                                              
                                             dÎ    âˆ‚Ï€ âˆ—âˆ— (k + 1, Î») âˆ‚Ï€ âˆ—âˆ— (k, Î»)
                                                =                 âˆ’             >0
                                             dÎ»          âˆ‚Î»            âˆ‚Î»
              
        Thus Î (Î»)   is continuous and monotonically increasing in Î» for all Î» âˆˆ [Î´k , Î´k+1 ). Together
        with the fact that it is negative at Î´k and positive at Î´k+1 , this implies that there is exactly
                                                   k ) = 0. For Î» âˆˆ [Î´k , Î½k ), k is the optimal integer
        one critical value, call it Î½k , at which Î (Î½
        number of classrooms; for Î» âˆˆ [Î½k , Î´k+1 ), k + 1 is optimal.

   4. It remains to consider the regions at the extremes of the support of Î». Without loss of
      generality, let j be the largest integer such that Î´j â‰¤ Î»,46 and let j be the smallest integer
      such that Î» â‰¤ Î´j . Within each interval, [Î´j , Î´j+1 ), [Î´j+1 , Î´j+2 ), ..., [Î´jâˆ’1 , Î´j ), the results from
      steps 1-3 above hold. Truncate the interval (Î´j , Î´j ) at Î» below and Î» above. If Î½j â‰¤ Î», then
      let k = j + 1; else if Î» < Î½j then let k = j. If Î½jâˆ’1 < Î», then let k = j; else if Î» â‰¤ Î½jâˆ’1 , then
      let k = j âˆ’ 1. Let Î½kâˆ’1 = Î» and Î½k = Î». Then

                                                   Î½kâˆ’1 < Î½k < ... < Î½k

        form a partition of the set of voucher schools, with the optimal integer number of classrooms
        equal to k, k + 1, ..., k between consecutive values, and the lemma is proved.

A.2.4       Discontinuities at Critical Values
Consider a given Î½k from Lemma 1, where k < k < k. The fact that Î²(k + 1) > Î²(k) (from (52))
implies that it will never be the case that the class-size cap is non-binding to the left of the critical
value but binding to the right of it. There are then three cases to consider:

   1. The class-size cap is binding neither to the left nor to the right of the critical value: Î½k â‰¤
      Î²(k) < Î²(k + 1). In this case, limÎ»â†’Î½ âˆ’ pâˆ— , limÎ»â†’Î½ âˆ’ xâˆ— and limÎ»â†’Î½ âˆ’ Î˜âˆ— (the limits as Î»
                                                 k           k                  k
      approaches Î½k from the left) are given by (20a), (20b), and (5) with n = k. limÎ»â†’Î½ + pâˆ— ,
                                                                                                  k
      limÎ»â†’Î½ + xâˆ— and limÎ»â†’Î½ + Î˜âˆ— are given by the same expressions with n = k+1. The diï¬€erences
              k                k
      in the left and right limits then have the same signs as the partial derivatives of the variables
                                                                âˆ—
                                                                       âˆ‚xâˆ—            âˆ‚Î˜âˆ—
      with respect to n. By (51), we have immediately that âˆ‚p  âˆ‚n > 0, âˆ‚n > 0, and âˆ‚n > 0. Hence:

                                                      lim pâˆ— < lim pâˆ—                                    (58a)
                                                     Î»â†’Î½kâˆ’      Î»â†’Î½k+

                                                      lim xâˆ— < lim xâˆ—                                    (58b)
                                                     Î»â†’Î½kâˆ’      Î»â†’Î½k+

                                                      lim Î˜âˆ— < lim Î˜âˆ—                                     (58c)
                                                     Î»â†’Î½kâˆ’      Î»â†’Î½k+

 46
      If Î» < Î´1 then let j = 0 and Î´0 = 0.




                                                         39
  Moreover,
                                          
                              âˆ‚       xâˆ—                  1 âˆ‚xâˆ—  xâˆ—
                                                =               âˆ’ 2
                             âˆ‚n       n                   n âˆ‚n   n
                                                           âˆ—
                                                                     
                                                          x     Î»Î¨
                                                =                   âˆ’1 <0
                                                          n2 Âµ + Î»Î¨

  and hence:
                                                      xâˆ—        xâˆ—
                                               lim       > lim                                   (59)
                                           Î»â†’Î½kâˆ’      n   Î»â†’Î½k+ n


2. The class-size cap is binding to the left of the critical value but not to the right: Î²(k) <
   Î½k < Î²(k + 1). It is immediate that,

                                                xâˆ—             xâˆ—
                                       lim         = 45 > lim                                    (60)
                                       Î»â†’Î½kâˆ’    n        Î»â†’Î½k+ n

  Consider xâˆ— and Î˜âˆ— in turn:
                                                                                             âˆ—
   (a) If there were no class-size cap, then for Î» âˆˆ (Î²(k), Î½k ), we would have âˆ‚x
                                                                                âˆ‚Î» > 0. In the
                                                                   âˆ‚xâˆ—
       presence of the class-size cap, for Î» âˆˆ (Î²(k), Î½k ) we have âˆ‚Î» = 0. Hence


                                           lim xâˆ—               < lim xâˆ—
                                        Î»â†’Î½kâˆ’                         Î»â†’Î½kâˆ’
                                                          cap                       no cap

        If there were no class-size cap, then by (58b) we would have:


                                               lim xâˆ—                   < lim xâˆ—
                                           Î»â†’Î½kâˆ’                             Î»â†’Î½k+
                                                            no cap

        Hence:
                                                lim xâˆ—                < lim xâˆ—
                                               Î»â†’Î½kâˆ’                        Î»â†’Î½k+
                                                                cap
                  âˆ—
   (b) Let z âˆ— = xn . Recalling the assumption that schools cannot price discriminate, the price
       term can be brought outside the integral in (5) and Î˜âˆ— can then be written:
                                                     !Î¸      1
                                                                       T  Î¸Î»
                                                                            Âµ
                                                     Î¸    Î¸ â„¦(Î¸)       zâˆ—        g(Î¸)dÎ¸
                                       Î˜âˆ— = !                       T  Î¸Î»                      (61)
                                              Î¸          1                Âµ
                                                      Î¸ â„¦(Î¸)          zâˆ—         g(Î¸)dÎ¸

        Note that Î˜âˆ— depends only on class size and Î», not on price, or enrollment or the
        number of classrooms separately. Diï¬€erentiating,
                                                âˆ‚Î˜âˆ—    Î» 2
                                                    = âˆ’ ÏƒÎ¸|Î» <0                                  (62)
                                                 âˆ‚z    Âµz




                                                      40
            Hence (60) implies:
                                                  lim Î˜âˆ— < lim Î˜âˆ—                                (63)
                                              Î»â†’Î½kâˆ’              Î»â†’Î½k+

  3. If the class-size cap is binding both to the left and to the right of the critical value: Î²(k) <
     Î²(k + 1) â‰¤ Î½k . It is immediate that:

                                          lim z âˆ— = lim z âˆ— = 45                                 (64)
                                          Î»â†’Î½kâˆ’          Î»â†’Î½k+

     and:
                                  lim xâˆ— = 45k < 45(k + 1) = lim xâˆ—
                                  Î»â†’Î½kâˆ’                                  Î»â†’Î½k+

     As (61) indicates, Î˜âˆ— depends only on class size and Î». Hence (64) implies:

                                             lim Î˜âˆ— = lim Î˜âˆ—
                                            Î»â†’Î½kâˆ’          Î»â†’Î½k+

               âˆ—
     Since âˆ‚Î˜                                                                               âˆ—
             âˆ‚Î» > 0 both to the left and to the right of Î½k (refer to (26c)), we have that Î˜ is
     strictly increasing in Î» at Î½k .
     In this case, pâˆ— is given by (24a) both to the left and to the right of the critical value. Hence
     the jump in number of classrooms from k to k + 1 implies:

                                             lim pâˆ— > lim pâˆ—
                                            Î»â†’Î½kâˆ’          Î»â†’Î½k+


To summarize, at Î½k , class size is either decreasing or constant in Î», and enrollment and average
willingness to pay are always increasing in Î». We have no unambiguous result for how price
changes with Î» at Î½k .




                                                    41
                             Figure 1: Histograms of the number of 4th grades in urban schools, 2002


                             Panel A: All schools                                                       Panel B: Public schools




                                                                               20 0 40 0 60 0 80 0
          500 1000 1500
       Nu mbe r of schools




                                                                              Number of sch ools
                                                                                         0
                0




                             1      2    3    4       5      6        7   8                              1     2    3   4      5     6        7   8
                                        Num ber of 4 th grad es                                                    Number of 4th grades


                             Panel C: Voucher private schools                                           Panel D: Unsubsidiz ed priv ate schools




                                                                               50 10 0 15 0 20 0 25 0
        200 400 600 800
       Nu mbe r of schools




                                                                              Number of sch ools
                                                                                         0
                0




                              1    2     3    4       5      6        7   8                              1     2    3   4      5     6        7   8
                                        Num ber of 4 th grad es                                                    Number of 4th grades



Note: Based on 2002 administrative data for urban schools with positive 4th grade enrollments. The figures cover
only schools Chileâ€™s Ministry of Education classifies as urban. For voucher schools, panel C excludes about 0.2
percent of schools which report having more than eight 4th grade classes.



                                                    Figure 2: Case 1â€” Divisible classrooms
      x/n




               45




                                                                  Î±                                                                       Î»
      Figure 3: Case 2 â€” Indivisible classrooms
x/n




 45




                                                            Î»
       Î²(1)   Î½1      Î² (2)   Î½2       Î½3         Î½4   Î½5
     Figure 4: Class size and income/mothersâ€™ schooling among urban private voucher schools, 2002

                                         Panel A: Log income




                               37
                               35   33
                         Class size
                            31 29
                               27
                               25




                                         11          11.5           12            12.5   13     13.5
                                                                         Log income




                                         Panel B: Mothers' schooling
                               37
                               35   33
                         Class size
                            31 29
                               27
                               25




                                               8               10              12        14       16
                                                                    Mothers' schooling



Note: Income and mothersâ€™ schooling come from 2002 individual-level SIMCE data aggregated to the school level. Class
size is based on 2002 administrative information. In each panel, the lines plot fitted values, along with point-wise confidence
intervals, of locally weighted regressions (using Stataâ€™s lowess command and a bandwidth of 0.2) of class size on log income
(Panel A) and mothersâ€™ schooling (Panel B). The figures omit observations below and above the 1st and 99th percentile of
income or mothersâ€™ schooling. Standard errors are based on a bootstrap procedure with 1,000 replications. We note that the
results are very similar if derived using regressions of class size on a 5th-order polynomial of the independent variables.
                                  Figure 5: 4th grade enrollment and class size in urban private voucher schools, 2002




                                                             50            40
                                               4t h grade class size (x/n)
                                                      20     10
                                                             0  30




                                                                                0   45            90                                135
                                                                                         4th grade enrollment

  Note: Based on administrative data for 2002. The solid line describes the relationship between enrollment and class
  size that would exist if the class size rule (equation 30 in the text) were applied mechanically. The circles plot actual
  enrollment cell means of 4th grade class size. Only data for schools with 4th grade enrollments below 180 are
  plotted; this excludes less than two percent of all schools.



                                      Figure 6: Test scores and enrollment in urban private voucher schools, 2002


                                Pan el A: Ma th                                                                             Pan el B: La nguage
                                                                                                  200 220 240 260 280 300
20 0 22 0 24 0 26 0 28 0 30 0




                                                                                                        Language score
          Math score




                                          45             90          135                                                             45           90           135
                                                4th-grade enrollment                                                                      4th-grade enrollment

  Note: Test scores come from 2002 individual-level SIMCE information aggregated to the school level, and
  enrollment is drawn from administrative data for the same year. The figures plot â€œrawâ€ enrollment-cell means of
  test scores, along with the fitted values of a locally weighted regression calculated within each enrollment segment.
                             Figure 7: Histograms of 4th grade enrollment in urban private schools, 2002

                         Panel A: Voucher private
           80       60
  Number of schools
        40 20
           0




                         0              45            90           135           180           225
                                                     4th grade enrollment


                         Panel B: Unsubsidized private
           20       15
  Number of schools
        10 5
           0




                         0              45            90           135           180           225
                                                     4th grade enrollment

Note: Enrollment is drawn from administrative data for 2002. For visual clarity, only schools with 4th grade
enrollments below 225 are displayed. This excludes less than one percent of all schools.
      Figure 8: Student characteristics and enrollment in urban private voucher schools, 2002
                                            Panel A: Log income




                              13  12.5
                    Household income
                     12       11.5




                                                           45                90             135
                                                                     4th-grade enrollment



                                            Panel B: Mothers' schooling
                              14       13
                    Mothers' schooling
                       11      12
                              10
                              9




                                                           45                90             135
                                                                     4th-grade enrollment




Note: Income and mothersâ€™ schooling come from 2002 individual-level SIMCE data aggregated to the school level.
Enrollment is drawn from administrative data for the same year. The figure presents â€œrawâ€ enrollment-cell means,
along with the fitted values of a locally weighted regression calculated within each enrollment segment. Only data
for schools with 4th grade enrollments below 180 are plotted; this excludes less than two percent of all schools.
                               Table 1: Descriptive statistics for urban schools, 2002

     Sample/variable                                                                   Quantile
                                     Mean         S.D.         10th        25th         50th          75th        90th
     Panel A: Full sample
     Income                             311.2       341.7       102.5        130            180        303.7       781.8
     Mothersâ€™ schooling                  11.1         2.4         8.3         9.3          10.7         12.7        14.9
     Fathersâ€™ schooling                  11.3         2.5         8.5         9.4          10.8         12.9        15.2
     Math score                         249.3          30       212.6       227.7         246.9        269.3       291.9
     Language score                     253.1        30.5       215.2       231.3         251.5        275.1         296
     4th grade class size                32.9            9.2          20          27         34         40.3        44.3
             th
     No. of 4 grade clases               1.88        1.09             1            1              2           2          3
      th
     4 grade enrollment                     65       45.1             21          33         56              86      122
     Panel B: Public schools
     Income                             152.8        69.1        94.4        113.6         138.6       172.1         217
     Mothersâ€™ schooling                   9.6         1.3         8.1          8.6           9.4        10.4        11.3
     Fathersâ€™ schooling                   9.7         1.4         8.1          8.8           9.6        10.6        11.5
     Math score                         235.1        21.4       208.7        220.6         233.8       248.8       262.2
     Language score                     237.9        21.6       211.2        223.9         237.5       251.8       265.8
     4th grade class size                34.7         7.2         25            30          35.5        40.3          44
     No. of 4th grade clases              2.1              1           1           1              2           3           3
      th
     4 grade enrollment             75.4                 42           29      41.5            70             98      130
     Panel C: Voucher private schools
     Income                        250.8            142.6       115.7        155.8         213.1       307.1       428.2
     Mothersâ€™ schooling             11.5              1.8         8.9         10.2          11.6        12.8        13.8
     Fathersâ€™ schooling             11.5              1.9           9         10.2          11.6        12.9        13.9
     Math score                    252.2             27.5       215.1        234.4         254.3       271.3       287.5
     Language score                256.9             28.4       218.4        239.1         259.7       277.4       290.7
      th
     4 grade class size             34.2              9.3         21            28           36          42          45
     No. of 4th grade clases              1.7        1.07              1           1              1           2           3
      th
     4 grade enrollment                  61.4        48.1             21          31          45         82.5        112
     Panel D: Unsubsidized private schools
     Income                       1050.2            419.3       506.3        770.9       1003.6         1350      1673.5
     Mothersâ€™ schooling              15.1             1.2        13.8         14.7         15.4          15.9       16.3
     Fathersâ€™ schooling              15.6             1.3          14           15         15.9          16.5       16.9
     Math score                     288.1            25.3       254.3          276        292.9        304.7       314.1
     Language score                 291.8            23.7       261.8         283         297.5          307       315.1
      th
     4 grade class size              22.4             8.6          10         16.8           23          28.5        34
     No. of 4th grade clases              1.7              1           1           1              1           2           3
      th
     4 grade enrollment                  41.7        33.2             10          17        31.5         57.5            85

Note: Data on monthly income, parental schooling, and test scores come from 2002 individual SIMCE information
aggregated to the school level. Income is in thousands of Chilean pesos (the average exchange rate for 2002 was about 700
pesos per U.S. dollar). Class size, the number of classes operated, and enrollment come from administrative data for the
same year. The table covers only urban schools. Panel A describes all 3,776 schools in the sample, panel B covers 1,652
public schools, panel C refers to 1,636 voucher private schools, and panel D refers to 488 private unsubsidized institutions.
   Table 2: Class size and income and mothersâ€™ schooling among urban private voucher schools, 2002


                                                                     Dependent var.: 4th grade class size
                                                                       (1)           (2)          (3)
                   Panel A
                   Log income                                           120.3***      125.5***      135.3***
                                                                          (15.2)        (15.6)        (16.7)
                   Log income2                                            -4.9***       -5.1***       -5.5***
                                                                            (0.6)         (0.6)         (0.7)
                   13 region dummies                                          No           Yes            No
                   318 commune dummies                                        No            No           Yes
                   R2                                                     0.038          0.073         0.209
                   N                                                      1,636          1,636         1,636
                   Panel B
                   Mothers' schooling                                      8.5***        8.7***        9.8***
                                                                            (1.2)         (1.3)         (1.4)
                   Mothers' schooling2                                    -0.4***       -0.4***       -0.4***
                                                                            (0.1)         (0.1)         (0.1)
                   13 region dummies                                          No           Yes            No
                   318 commune dummies                                        No            No           Yes
                   R2                                                     0.029          0.061         0.200
                   N                                                      1,636          1,636         1,636


Note: Income and mothersâ€™ schooling are drawn from 2002 individual-level SIMCE data aggregated to the school level.
Class size comes from administrative data for the same year. *** indicates statistical significance at the 1% level.
Table 3: 1st stage, reduced form, and base IV specifications; urban private voucher schools, 2002

                                        1st stage            Reduced form                         IV
                                         Class             Math      Language            Math          Language
                                           size            score       score             score           score
                                            (1)             (2)         (3)               (4)             (5)
          Class size                                                                    -0.7***          -0.6**
                                                                                         (0.3)           (0.3)
          1{x â‰¥46}                       -16.5***         11.8***       9.9***
                                           (2.7)           (3.2)        (3.3)
          1{x â‰¥91}                         -4.9**           0.0          1.6
                                           (2.3)           (4.0)        (4.0)
          1{x â‰¥136}                        -4.3**          11.5         10.9
                                           (2.0)          (13.6)       (12.9)
          1{x â‰¥181}                         -3.4           11.2         11.5
                                           (3.0)          (10.6)       (13.9)
          x                              0.95***           0.1           0.2*            0.8***         0.8***
                                          (0.01)           (0.1)        (0.1)            (0.2)          (0.3)
          (x -46)*1{x â‰¥46}                -0.6***           -0.1         -0.2            -0.6**         -0.6**
                                           (0.1)           (0.2)       (0.2)             (0.3)          (0.3)
          (x -91)*1{x â‰¥91}                 -0.3**           0.0         -0.1             -0.2*          -0.3**
                                           (0.1)           (0.1)       (0.1)             (0.1)          (0.1)
          (x -136)*1{x â‰¥136}                0.0             -0.6        -0.4              -0.2           -0.1
                                           (0.1)           (0.4)       (0.4)             (0.2)          (0.2)
          (x -181)*1{x â‰¥181}                -0.1            0.2         0.2                0.1           0.1
                                           (0.1)           (0.5)       (0.6)             (0.3)          (0.4)
          N                               1,623            1,623       1,623             1,623          1,623
          R2                              0.844            0.069       0.072


 Note: Test scores are based on 2002 SIMCE individual-level data, aggregated to the school level. Class size and
 enrollment come from administrative information for the same year. *** indicates statistical significance at the 1%
 level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels; see Lee and Card (forthcoming).
 The table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that
 report 4th grade enrollments in excess of 225 students.
         Table 4: Within-enrollment band IV regressions; urban private voucher schools, 2002

                                                                        Cutoff                     Pooled
                                                         1st
                                                                          2nd         rd
                                                                                      3            cutoffs
                                                          (45             (90         (135
                                                       students)       students)    students)
                                                           (1)             (2)          (3)          (4)
            Panel A: 5 student interval
            Dep. var.: Math score
            Class size                                          -3.3        -32.6           -4.4        -3.4
                                                               (2.5)      (185.3)          (7.3)       (2.4)
            N                                                   249          186              41        476
            Panel B: 3 student interval
            Dep. var.: Math score
            Class size                                         -6.9         -55.2      -13.9**             -7.4
                                                               (6.7)      (197.9)        (4.4)         (6.1)
            N                                                   185          145           33           363
            Panel C: 5 student interval
            Dep. var.: Language score
            Class size                                          -3.1        -38.1           -4.0        -3.2
                                                               (2.4)      (216.0)          (6.7)       (2.3)
            N                                                   249          186              41        476
            Panel D: 3 student interval
            Dep. var.: Language score
            Class size                                         -7.0          59.7      -13.0**             -7.3
                                                               (6.6)      (213.3)        (3.7)         (5.9)
            N                                                   185          145           33           363

Notes: Test scores are from 2002 SIMCE individual-level data, aggregated to the school level. Class size and
enrollment come from administrative information for the same year. Columns present regressions within 5 (panels A
and C) and 3 (panels B and D) student enrollment bands around the first three cut-offs. Separate results around the
fourth cut-off are omitted for the sake of space; they account for less than 1 percent of observations. Columns 1-3 are
IV specifications using an indicator for whether schoolsâ€™ enrollment is above the respective cut-off as an instrument.
As van der Klaauw (2002) indicates, these are equivalent to simple Wald estimates of the effect of class size around
each discontinuity. Column 4 produces similar estimates pooling all three local samples and using the three cut-offs
(1{x>45}, 1{x>90}, and 1{x>135}) as instruments. All regressions are clustered around enrollment levels, see Lee
and Card (forthcoming).
      Table 5: Behavior of selected variables around enrollment cut-offs and IV specifications;
                                urban private voucher schools, 2002

                                           Mothersâ€™       Fathersâ€™     Household                   IV
                                           schooling     schooling      income              Math      Language
                                              (1)           (2)           (3)                (4)         (5)
               Class size                                                                        -0.1         0.1
                                                                                                (0.1)       (0.1)
               1{x â‰¥46}                        0.93***       0.94***       66.6***
                                                 (0.2)         (0.2)        (14.1)
               1{x â‰¥91}                          0.03          0.03           17.6
                                                 (0.2)         (0.2)        (17.3)
               1{x â‰¥136}                         0.66          0.86        143.7*
                                                 (0.7)        (0.8)         (79.4)
               1{x â‰¥181}                          0.66         0.71           53.1
                                                 (1.1)        (1.1)         (77.7)
               x                                -0.02*       -0.02*        -2.4***             0.4***       0.4***
                                                 (0.0)        (0.0)           (0.8)             (0.1)        (0.1)
               (x -46)*1{x â‰¥46}                  0.02*         0.01          2.3***           -0.4***      -0.4***
                                                 (0.0)        (0.0)           (0.8)             (0.1)        (0.1)
               (x -91)*1{x â‰¥91}                  -0.01         0.00            -0.7               0.1            0
                                                 (0.0)        (0.0)           (0.6)             (0.1)        (0.1)
               (x -136)*1{x â‰¥136}                -0.02        -0.03            -3.5            -0.2**         -0.1
                                                 (0.0)        (0.0)           (2.3)             (0.1)        (0.1)
               (x -181)*1{x â‰¥181}                 0.01         0.02               4               0.1          0.1
                                                 (0.0)         (0.0)         (3.4)             (0.1)         (0.2)
               Mothersâ€™ schooling                                                             8.5***        9.5***
                                                                                               (0.9)         (1.0)
               Fathersâ€™ schooling                                                               1.6*           1.1
                                                                                               (0.9)        (0.9)
               Household income                                                               13.4**      16.6***
                                                                                               (5.4)        (5.5)
               N                                1,623         1,623         1,623             1,623        1,623
               R2                               0.034         0.032         0.029

Notes: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to
the school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. The
table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that report
4th grade enrollments in excess of 225.
      Table 6: Reduced form regressions with piecewise control functions of higher order

                                                          Specification of the piecewise control function
                                                            1st          2nd          3rd          4th
                                                           order        order        order        order
                                                            (1)           (2)         (3)          (4)
           Panel A-Dep. var.: Class size
           1{x â‰¥46}                                       -16.5***     -10.0**        0.6          1.5
                                                           (2.7)        (4.1)        (3.2)        (3.1)
           1{x â‰¥91}                                        -4.9**        -2.4        4.9**         3.3
                                                           (2.3)        (1.6)        (2.2)        (2.1)
           Panel B-Dep. var.: Math score
           1{x â‰¥46}                                        11.8***     11.5***      24.7***      22.3***
                                                            (3.2)       (3.8)        (4.8)        (4.7)
           1{x â‰¥91}                                          -0.0       6.6**       15.5***      19.8***
                                                            (4.0)       (3.3)        (2.8)        (4.0)
           Panel C-Dep. var.: Language score
           1{x â‰¥46}                                        9.9***      10.9***      24.2***      24.2***
                                                           (3.3)        (3.9)        (3.9)        (4.0)
           1{x â‰¥91}                                         1.6         7.4**       19.6***      18.6***
                                                            (4.0)       (3.2)        (2.9)        (3.4)
           Panel D-Dep. var.: Mothers' schooling
           1{x â‰¥46}                                        0.93***     0.91***      1.21***      1.11***
                                                           (0.20)      (0.22)       (0.24)       (0.24)
           1{x â‰¥91}                                         0.03        0.29         0.55         0.40
                                                           (0.22)      (0.26)       (0.35)       (0.40)
           Panel E-Dep. var.: Fathers' schooling
           1{x â‰¥46}                                        0.94***     0.93***      1.14***      1.05***
                                                           (0.20)      (0.24)       (0.29)       (0.28)
           1{x â‰¥91}                                         0.03        0.25         0.61*        0.47
                                                           (0.22)       (0.26)      (0.36)       (0.41)
           Panel F-Dep. var.: Household income
           1{x â‰¥46}                                        66.6***     76.1***      69.5***      68.4***
                                                           (14.1)      (14.5)       (17.4)       (19.0)
           1{x â‰¥91}                                         17.6        29.6         40.5         22.3
                                                           (17.3)      (20.1)       (27.6)       (31.1)
           N                                               1,623       1,623        1,623        1,623
Note: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to the
school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. This
table analyzes the robustness of reduced form results to the inclusion of higher order piecewise control functions
(Van der Klaauw, 2002). The results in column 1 (panels A-C) replicate those in Table 3 above (columns 1-3).
The results in column 1 (panels D-F) replicate those in Table 5 above (columns 1-3). The remaining columns then
explore how these results change as higher order piecewise control functions are added. For the sake of space, these
panels report only the coefficients on the first two cut-offs, which correspond to the majority of observations.
