NBER WORKING PAPER SERIES

MICRO TO MACRO: OPTIMAL TRADE POLICY WITH FIRM HETEROGENEITY
Arnaud Costinot
Andrés Rodríguez-Clare
Iván Werning
Working Paper 21989
http://www.nber.org/papers/w21989

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
February 2016

We thank Pol Antràs and Gene Grossman for very useful comments. Su Wang provided valuable research
assistance. The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2016 by Arnaud Costinot, Andrés Rodríguez-Clare, and Iván Werning. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Micro to Macro: Optimal Trade Policy with Firm Heterogeneity
Arnaud Costinot, Andrés Rodríguez-Clare, and Iván Werning
NBER Working Paper No. 21989
February 2016
JEL No. F10
ABSTRACT
The empirical observation that “large firms tend to export, whereas small firms do not” has transformed
the way economists think about the determinants of international trade. Yet, it has had surprisingly
little impact about how economists think about trade policy. In this paper, we characterize optimal
trade policy in a generalized version of the trade model with monopolistic competition and firm-level
heterogeneity developed by Melitz (2003). At the micro-level, we find that optimal import taxes discriminate
against the most profitable foreign exporters, while optimal export taxes are uniform across domestic
exporters. At the macro-level, we demonstrate that the selection of heterogeneous firms into exporting
tends to create aggregate nonconvexities that dampen the incentives for terms-of-trade manipulation,
and in turn, the overall level of trade protection.

Arnaud Costinot
Department of Economics, E17-232
MIT
77 Massachusetts Avenue
Cambridge MA 02139
and NBER
costinot@mit.edu
Andrés Rodríguez-Clare
University of California at Berkeley
Department of Economics
Berkeley, CA 94720-3880
and NBER
andres1000@gmail.com

Iván Werning
Department of Economics, E17-234
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
iwerning@mit.edu

1

Introduction

There are large firms and small firms. The former tend to export whereas the latter do
not. What are the policy implications of that empirical observation?
Models of firm heterogeneity have transformed the way economists think about the
determinants of international trade. Yet, the same models have had surprisingly little
impact about how economists think about trade policy.1 The goal of this paper is to fill
this large gap on the normative side of the literature and uncover the general principles
that should guide the design of optimal trade policy when heterogeneous firms select into
exporting.
Our basic environment is a strict generalization of the model of intra-industry trade
with monopolistic competition and firm-level heterogeneity developed by Melitz (2003).
On the supply side, we let firms be heterogeneous in terms of both their variable costs and
their fixed costs. We impose no restrictions on the joint distribution of these costs across
firms and markets. On the demand side, we maintain the assumption that the elasticity
of substitution between all varieties from a given country is constant, but we impose no
restrictions on the substitutability between domestic and foreign goods.
The first part of our analysis studies the ad-valorem taxes that maximize domestic
welfare, which we label unilaterally optimal taxes, when governments are free to impose
different taxes on different firms. At the micro-level, we find that optimal trade policy requires firm-level import taxes that discriminate against the most profitable foreign
exporters. In contrast, export taxes that discriminate against or in favor of the most profitable domestic exporters can be dispensed with. The fact that optimal import taxes discriminate against the most profitable exporters from abroad is similar to an anti-dumping
duty. The rationale, however, is very different. Here, discriminatory taxes do not reflect a
desire to deter the entry of the most profitable exporters. They reflect instead a desire to
promote the entry of the marginally unprofitable exporters who, if they were to face the
same tariff, would prefer not to export at all.
At the macro-level, standard terms-of-trade considerations pin down the overall level
of trade taxes. Specifically, the only reason why a welfare-maximizing government would
like to implement aggregate imports and exports that differ from those in the decentralized equilibrium is because it internalizes the impact of both quantities on the price of
the infra-marginal units that it buys and sells on the world markets. Like in a Walrasian
economy, the higher the elasticity of world prices with respect to exports and imports, in
1 The

last handbook of international economics, Gopinath, Helpman and Rogoff, eds (2014), is a case in
point. In their chapter on heterogeneous firms, Melitz and Redding (2014) have only one trade policy paper
to cite. In his chapter on trade policy, Maggi (2014) has no paper with firm heterogeneity to review.

1

absolute value, the larger the trade restriction that it optimally imposes.
The second part of our analysis focuses on optimal taxation under the polar assumption that governments are constrained to impose the same tax on all firms from the same
country selling in a given market. Our main finding in this environment is a new optimal
tariff formula that generalizes existing results in the literature. Under monopolistic competition with homogeneous firms, Gros (1987) has shown that optimal tariffs are determined by the elasticity of substitution between domestic and foreign goods and the share
of expenditure on local goods abroad. Our new formula establishes that, conditional on
these two statistics, firm heterogeneity lowers the overall level of trade protection if and
only if it creates aggregate nonconvexities abroad.2 When strong enough, these aggregate
nonconvexities may even turn the optimal import tariff into a subsidy, as a government
may lower the price of its imports by raising their volume.
The final part of our analysis extends our basic environment to incorporate intra- and
inter-industry trade. In this case, sector-level increasing returns to scale, the so-called
home market effects, can also shape optimal trade policy. The common wisdom in the
literature (Helpman and Krugman, 1989) is that such effects provide a very different rationale for trade protection. Our last set of results suggests a different interpretation, one
according to which home-market effects matter to the extent that they shape terms-oftrade elasticities, but not beyond.
While both the positive and normative implications of imperfectly competitive markets for international trade have been studied extensively, the same cannot be said of
the heterogeneous firms operating in these markets. On the positive side, the pioneering
work of Melitz (2003) has lead numerous researchers to revisit various results of Helpman
and Krugman (1985) under the assumption that firms are heterogeneous and select into
exporting. On the normative side, however, much less energy has been devoted to revisit
the classical results of Helpman and Krugman (1989).
To the best of our knowledge, only three papers—Demidova and Rodríguez-Clare
(2009), Felbermayr, Jung and Larch (2013), and Haaland and Venables (2014)—have used
the work of Melitz (2003) to explore the implications of firm heterogeneity for optimal
trade policy. All three papers are restricted to environments where utility functions are
CES; fixed costs of exporting are constant across firms; distributions of firm-level productivity are Pareto; and, importantly, trade taxes are uniform across firms.3 In this paper,
2 With homogeneous firms, aggregate production possibility frontiers are necessarily linear. With heterogeneous firms, nonconvexities are likely to arise, as the mild sufficient conditions of Section 5.4 establish.
3 A fourth paper by Demidova (2015) analyzes optimal trade policy under the assumption of quadratic
utility functions, similar to those in Melitz and Ottaviano (2008). All other assumptions are the same as
in the aforementioned papers. In this environment, markups vary across firms, which leads to domestic

2

we relax all of these assumptions, we derive new results about optimal trade taxes at the
micro-level, and we generalize prior results about optimal trade taxes at the macro-level.
Beside greater generality, these results uncover a novel connection between firm heterogeneity, aggregate nonconvexities, and lower levels of trade protection.
In terms of methodology, our analysis builds on the work of Costinot, Lorenzoni and
Werning (2014) and Costinot, Donaldson, Vogel and Werning (2015) who characterize the
structure of optimal trade taxes in a dynamic endowment economy and a static Ricardian
economy, respectively. Like in the two previous papers, we use a primal approach and
general Lagrange multiplier methods to characterize optimal wedges rather than explicit
policy instruments. The novel aspect of our analysis is to break down the problem of finding optimal wedges into a series of micro subproblems, where we study how to choose
micro-level quantities to deliver aggregate quantities at the lowest possible costs, and a
macro problem, where we solve for the optimal aggregate quantities. The solutions to
the micro and macro problems then determine the structure of optimal micro and macro
taxes described above. This decomposition helps to highlight the deep connection between standard terms-of-trade argument, as in Baldwin (1948) and Dixit (1985), and the
design of optimal trade policy in models of monopolistic competition.
In spite of their common rationale, i.e., terms-of-trade manipulation, the specific policy prescriptions derived under perfect and monopolistic competition differ sharply. In
Costinot, Donaldson, Vogel and Werning (2015), optimal export taxes should be heterogeneous, whereas optimal import tariffs should be uniform. This is the exact opposite of
what we find under monopolistic competition. In a Ricardian economy, goods exported
by domestic firms could also be produced by foreign firms. This threat of foreign entry
limits the ability of the domestic government to manipulate world prices and leads to
lower export taxes on goods for which its firms have a weaker comparative advantage.
Since the previous threat is absent under monopolistic competition, optimal export taxes
are uniform instead. Conversely, lower import tariffs on the least profitable foreign firms
under monopolistic competition derive from the existence of fixed exporting costs, which
are necessarily absent under perfect competition.
The previous discussion is related to recent results by Ossa (2011) and Bagwell and
Staiger (2012b,a, 2015) on whether imperfectly competitive markets create a new rationale for the design of trade agreements. We hope that our analysis can contribute to the
application of models with firm heterogeneity to study this question as well as other redistortions even within the same industry and opens up the possibility of terms-of-trade manipulation even
at the firm-level. Our baseline analysis abstracts from these issues and instead focuses on the implication
of the self-selection of heterogeneous firms into export markets, as in Melitz (2003). We come back to this
point in our concluding remarks.

3

lated trade policy issues. Bagwell and Lee (2015) offer an interesting first step in that
direction. They study trade policy in a symmetric version of the Melitz and Ottaviano
(2008) model that also features the selection of heterogeneous firms into exporting. They
show that this model provides a rationale for the treatment of export subsidies within the
World Trade Organization.
The rest of the paper is organized as follows. Section 2 describes our basic environment. Section 3 sets up and solves the micro and macro planning problems of a welfaremaximizing country manipulating its terms-of-trade. Section 4 shows how to decentralize
the solution to the planning problems through micro and macro trade taxes when governments are free to discriminate across firms. Section 5 studies the polar case where
governments can only impose uniform taxes. Section 6 explores the sensitivity of our results to the introduction of multiple industries. Section 7 offers some concluding remarks.

2
2.1

Basic Environment
Technology, Preferences, and Market Structure

Consider a world economy with two countries, indexed by i = H, F; one factor of production, labor; and a continuum of differentiated goods or varieties. Labor is immobile
across countries. wi and Li denote the wage and the inelastic supply of labor in country i,
respectively.
Technology. Producing any variety in country i requires an overhead fixed entry cost,
f ie > 0, in terms of domestic labor. Once the overhead fixed cost has been paid, firms
randomly draw a blueprint ϕ ∈ Φ. Ni denotes the measures of entrants in country i and
Gi denotes the multivariate distribution of blueprints ϕ across varieties in that country.
Each blueprint describes how to produce and deliver a unique variety to any country.
lij (q, ϕ) denotes the total amount of labor needed by a firm from country i with blueprint
ϕ in order to produce and deliver q ≥ 0 units in country j. We assume that
lij (q, ϕ) = aij ( ϕ)q + f ij ( ϕ), if q > 0,
lij (q, ϕ) = 0, if q = 0.
Technology in Melitz (2003) corresponds to the special case in which firms are heterogeneous in terms of productivity, but face constant iceberg trade costs, aij ( ϕ) ≡ τij /ϕ, and
constant fixed costs of selling in the two markets, f ij ( ϕ) ≡ f ij .
4

Preferences. In each country there is a representative agent with a two-level homothetic
utility function,
Ui = Ui ( Q Hi , Q Fi ),
ˆ
Q ji = [ Nj (q ji ( ϕ))1/µ j dGj ( ϕ)]µ j .
Φ

where Q ji denotes the subutility from consuming varieties from country j in country i,
q ji ( ϕ) denotes country i’s consumption of a variety with blueprint ϕ produced in country j, and µ j ≡ σj /(σj − 1), with σj > 1 the elasticity of substitution between varieties
from country j. We do not restrict the elasticity of substitution between domestic and
foreign goods. Melitz (2003) corresponds to the special case in which µ H = µ F ≡ µ and
1/µ
1/µ
Ui ( Q Hi , Q Fi ) ≡ [ Q Hi + Q Fi ]µ .4
Market Structure. All goods markets are monopolistically competitive with free entry.
All labor markets are perfectly competitive. Foreign labor is our numeraire, w F = 1.

2.2

Decentralized Equilibrium with Taxes

We focus on an environment in which governments have access to a full set of ad-valorem
consumption and production taxes. We let taxes vary across markets and across firms.
We view the previous assumption as a useful benchmark. In theory, there is a priori
no reason within the model that we consider why different goods should face the same
taxes. In an Arrow-Debreu economy, imposing the same taxes on arbitrary subsets of
goods would be ad-hoc. Changing the market structure from perfect to monopolistic
competition does not make it less so. In practice, perhaps more importantly, different
firms do face different trade taxes, even within the same narrowly defined industry. Antidumping duties are akin to import tariffs imposed on the most productive firms. Loan
subsidies provided to small exporters in many countries can also be thought of as export
subsidies that vary with firms’ productivity.
Formally, we let t ji ( ϕ) denote the tax charged by country i on the consumption in
country i of a variety with blueprint ϕ produced in country j. Let sij ( ϕ) denote the subsidy
paid by country i on the production by a domestic firm of a variety with blueprint ϕ sold
in country j. For i 6= j, t ji ( ϕ) > 0 corresponds to an import tariff while t ji ( ϕ) < 0
corresponds to an import subsidy. Similarly, sij ( ϕ) > 0 corresponds to an export subsidy
4 In

Section 5.3, we will exploit this slight generalization to disentangle terms-of-trade motives for protection from second-best arguments related to markup distortions.

5

while sij ( ϕ) < 0 corresponds to an export tax. Tax revenues are rebated to domestic
consumers through a lump-sum transfer, Ti .5
In a decentralized equilibrium with taxes, consumers choose consumption in order
to maximize their utility subject to their budget constraint; firms choose their output
in order to maximize their profits taking their residual demand curves as given; firms
enter up to the point at which expected profits are zero; markets clear; and the government’s budget is balanced in each country. Let p̄ij ( ϕ) ≡ µi wi aij ( ϕ)/(1 + sij ( ϕ)) and
q̄ij ( ϕ) ≡ [(1 + tij ( ϕ)) p̄ij ( ϕ)/Pij ]−σi Qij . Using the previous notation, we can characterize
a decentralized equilibrium with taxes as schedules of output, qij ≡ {qij ( ϕ)}, schedules
of prices, pij ≡ { pij ( ϕ)}, aggregate output levels, Qij , aggregate price indices, Pij , wages,
wi , and measures of entrants, Ni , such that

q̄ ( ϕ) , if (µ − 1) a ( ϕ)q̄ ( ϕ) ≥ f ( ϕ),
ij
i
ij
ij
ij
qij ( ϕ) =
0
, otherwise,

 p̄ ( ϕ) , if (µ − 1) a ( ϕ)q ( ϕ) ≥ f ( ϕ),
ij
i
ij
ij
ij
pij ( ϕ) =
∞
, otherwise,
Q Hi , Q Fi ∈ arg max {Ui ( Q̃ Hi , Q̃ Fi )| ∑ j= H,F Pji Q̃ ji = wi Li + Ti },
Q̃ Hi ,Q̃ Fi
ˆ
1−σj
Pji
=
Nj [(1 + t ji ( ϕ)) p ji ( ϕ)]1−σj dGj ( ϕ),
Φ
ˆ
e
f i = ∑ j= H,F [(µi − 1) aij ( ϕ)qij ( ϕ) − f ij ( ϕ)]dGi ( ϕ),
Φˆ
Li = Ni [∑ j= H,F
lij (qij ( ϕ), ϕ)dGi ( ϕ) + f ie ],
ˆ Φ
ˆ
Ti = ∑ j= H,F [ Nj t ji ( ϕ) p ji ( ϕ)q ji ( ϕ)dGj ( ϕ) −
Ni sij ( ϕ) pij ( ϕ)qij ( ϕ)dGi ( ϕ)].
Φ

Φ

(1)

(2)
(3)
(4)
(5)
(6)
(7)

Conditions (1) and (2) implicitly assume that when firms are indifferent between producing and not producing, they always choose to produce. In the rest of our analysis, we
restrict ourselves to economies where the distributions Gi are smooth in the sense that the
set of varieties ϕ such that (µi − 1) aij ( ϕ)q = f ij ( ϕ) is measure zero for any q > 0 and any
i, j = H, F. Accordingly, the previous assumption has no effect on any of our results.6
5 Throughout this paper, we rule out non-linear taxes, like two part-tariffs. This is not innocuous. If such
instruments were available, a government would be able to incentivize foreign firms to sell at marginal costs
and compensate them (exactly) for the fixed exporting costs that they incur. In contrast, our focus on advalorem rather than specific taxes is without loss of generality when firm-level taxes are allowed, as in our
baseline analysis.
6 Absent the previous restriction on G , one would need to compute explicitly the share of firms that,
i
when indifferent, choose either (q̄ij ( ϕ), p̄ij ( ϕ)) or (0, ∞). This would make notations more cumbersome,

6

2.3

Unilaterally Optimal Taxation

We assume that the government of country H, which we refer to as the home government,
is strategic, whereas the government of country F, which we refer to as the foreign government, is passive. Namely, the home government sets ad-valorem taxes, t H H ≡ {t HH ( ϕ)},
t F H ≡ {t FH ( ϕ)}, s H H ≡ {s HH ( ϕ)}, and s H F ≡ {s HF ( ϕ)}, and a lump-sum transfer TH in
order to maximize home welfare, whereas foreign taxes are all equal to zero. This leads
to the following definition of the home government’s problem.
Definition 1. The home government’s problem is
max

TH ,{t jH ,s H j } j= H,F ,{qij ,Qij ,pij ,Pij ,wi ,Ni }i,j= H,F

UH ( Q HH , Q FH ) subject to conditions (1)-(7).

The goal of the next two sections is to characterize unilaterally optimal taxes, i.e., taxes
that prevail at a solution to the domestic government’s problem. To do so we follow the
public finance literature and use the primal approach. Namely, we will first approach the
optimal policy problem of the domestic government in terms of a relaxed planning problem in which domestic consumption, output, and the measure of entrants can be chosen
directly (Section 3). We will then establish that the optimal allocation can be implemented
through linear taxes and characterize the structure of these taxes (Section 4).

3

Planning Problem(s)

Throughout this section we focus on a fictitious environment in which there are no taxes
and no markets at home. Rather, the domestic government directly controls the quantities
demanded by home consumers, q H H ≡ {q HH ( ϕ)} and q F H ≡ {q FH ( ϕ)}, as well as the
quantities exported by domestic firms, q H F ≡ {q HF ( ϕ)}, and the measure of domestic
entrants, NH , subject to the resource constraint,
NH [∑ j= H,F

ˆ
Φ

e
l Hj (q Hj ( ϕ), ϕ)dGH ( ϕ) + f H
] ≤ LH ,

(8)

as well as the foreign equilibrium conditions, namely condition (1) for i = F and j = F
and conditions (2)-(7) for i = F. In order to solve Home’s planning problem, we follow
a two-step approach. First, we take macro quantities, Q HH , Q HF , and Q FH , as given and
solve for the micro quantities, q H H , q H F , and q F H , as well as the measure of entrants,
NH , that deliver macro quantities at the lowest possible costs. Second, we solve for the
but would not change our conclusions about the structure of optimal taxes.

7

optimal macro quantities. The solution to these micro and macro problems will determine
the optimal micro and macro taxes, respectively, in the next section.

3.1

First Micro Problem: Producing Domestic Varieties

Consider the problem of minimizing the labor cost of producing Q HH units of aggregate
consumption for Home and Q HF units of aggregate consumption for Foreign. This can be
expressed as
L H ( Q HH , Q HF ) ≡
ˆ

min

q̃ H H ,q̃ H F ,N

N[

∑

ˆ

j= H,F Φ

e
l Hj (q̃ Hj ( ϕ), ϕ)dGH ( ϕ) + f H
]
1/µ

Φ

N (q̃ Hj ( ϕ))1/µ H dGH ( ϕ) = Q Hj H , for j = H, F.

(9a)
(9b)

This minimization problem is infinite dimensional and non-smooth. Since there are fixed
costs, the objective function is neither continuous nor differentiable around q Hj ( ϕ) = 0
for any ϕ such that f Hj ( ϕ) > 0. Given the additive separability of the objective and the
constraint, however, it is easy to solve using a Lagrangian approach, as in Everett (1963).
∗ ) that
The general idea is to proceed in two steps. First, we construct (q∗H H , q∗H F , NH
minimizes the Lagrangian associated with (9), given by L H = N ` H where

`H ≡

∑

ˆ 

j= H,F Φ

l Hj (q̃ Hj ( ϕ), ϕ) − λ Hj (q̃ Hj ( ϕ))

1/µ H



e
.
dGH ( ϕ) + f H

Since, for given N, the Lagrangian is additively separable in {q̃ Hj ( ϕ)}, the optimization over these variables can be performed variety-by-variety and market-by-market.
Although the discontinuity at zero remains, it is just a series of one-dimensional minimization problems that can be solved by hand. Second, we construct Lagrange multipliers, λ HH and λ HF , so that this solution satisfies constraint (9b) for j = H, F. By the
Lagrangian Sufficiency Theorem, e.g. Theorem 1, p. 220 in Luenberger (1969), we can
then conclude that the minimizer of L H that we have constructed is also a solution to the
original constrained minimization problem (9).7
For a given variety ϕ and a market j, consider the one-dimensional subproblem
min l Hj (q̃, ϕ) − λ Hj q̃1/µ H ,
q̃

7 In

general, a solution to the constrained minimization problem may not minimize the Lagrangian; see
Sydsaeter (1974). Establishing the existence of a solution to the Lagrangian problem that satisfies (9b) is
therefore a crucial part of the argument.

8

for an arbitrary Lagrange multiplier λ Hj > 0. This leads to a simple cut-off rule
(
q∗Hj ( ϕ) =

(µ H a Hj ( ϕ)/λ Hj )−σH , if ϕ ∈ ΦHj ,
0, otherwise,

(10)

with ΦHj ≡ { ϕ : (µ H − 1) a Hj ( ϕ)(µ H a Hj ( ϕ)/λ Hj )−σH ≥ f Hj ( ϕ)}. Since L H is linear in N
the condition ` H = 0 is necessary and sufficient for an interior solution for N that satisfies
(9b). Thus, the existence of a solution to the Lagrangian problem that satisfies (9b) reduces
∗ ) that solves
to finding (λ HH , λ HF , NH
ˆ
λ Hj =

∗
NH
[
ΦHj

e
fH

=

∑

H
(µ H a Hj ( ϕ))1−σH dGH ( ϕ)]1/(1−σH ) Q1/σ
Hj ,

(11)

ˆ

j= H,F Φ Hj

[(µ H − 1) a Hj ( ϕ)(µ H a Hj ( ϕ)/λ Hj )−σH − f Hj ( ϕ)]dGH ( ϕ).

(12)

A proof of existence and uniqueness is provided in Appendix A.1. This construction
delivers a solution to problem (9). As shown in Appendix A.2, this solution must also
be the unique solution to (9). We use this observation in the next section to establish
necessary properties of optimal taxes.
By comparing equations (1), (2), (4), and (5), on the one hand, and equations (10),
(11), and (12), on the other hand, one can check that conditional on Q HH and Q HF , the
output levels and number of entrants in the decentralized equilibrium with zero taxes and
the solution to the planning problem coincide. This reflects the efficiency of firm’s level
decision under monopolistic competition with Constant Elasticity of Substitution (CES)
utility conditional on industry size; see Dixit and Stiglitz (1977) and Dhingra and Morrow
(2012) for closed economy versions of this result. As shown in Section 4, this feature
implies that the home government may want to impose a uniform import tariff or an
export tax—in order to manipulate the fraction of labor allocated to domestic production
rather than export—but that it never wants to impose taxes that vary across domestic
firms, regardless of whether they sell on the domestic or foreign market.

3.2

Second Micro Problem: Importing Foreign Varieties

Let PFH ( Q FH , NF ) denote the minimum cost of one unit of aggregate imports at home
conditional on total imports, Q FH , as well as the measure of foreign entrants, NF . Since
foreign firms charge a constant markup over marginal cost and only enter home market
if they can earn non-negative profits—condition (2) for i = F and j = H—PFH ( Q FH , NF )

9

can be expressed as
ˆ
NF µ F a FH ( ϕ)q̃ FH ( ϕ)dGF ( ϕ)
PFH ( Q FH , NF ) ≡ min
q̃ F H Φ
ˆ
1/µ
NF q̃ FH F ( ϕ)dGF ( ϕ) = 1,

(13b)

(µ F − 1) a FH ( ϕ) Q FH q̃ FH ( ϕ) ≥ f FH ( ϕ).

(13c)

Φ

(13a)

This minimization problem is also additively separable in the objective and the constraint.
So, we can again solve it variety-by-variety using a Lagrangian approach.
Consider the one-dimensional subproblem of finding the amount of foreign imports
of variety ϕ per unit of Q FH that solves
minµ F a FH ( ϕ)q̃ − λ FH q̃1/µ F
q̃

(µ F − 1) a FH ( ϕ) Q FH q̃ ≥ f FH ( ϕ)

(14a)
(14b)

for an arbitrary Lagrange multiplier λ FH > 0. The first-order condition of the unconstrained problem, ignoring constraint (14b), can be expressed as
quFH ( ϕ) = (µ2F a FH ( ϕ)/λ FH )−σF .
If quFH ( ϕ) satisfies constraint (14b), then it is also a solution to (14). If it does not, then
the solution to (14) is given either by zero or by qcFH ( ϕ) > quFH ( ϕ) such that (14b) exactly
binds, that is
qcFH ( ϕ) = f FH ( ϕ)/((µ F − 1) a FH ( ϕ) Q FH ).
The former case occurs if µ F a FH ( ϕ)qcFH ( ϕ) − λ FH (qcFH ( ϕ))1/µ F > 0, while the latter case
occurs otherwise. To capture both cases in a compact way, it is convenient to introduce
the following “profitability” index of foreign varieties in the home market,
θ FH ( ϕ) ≡ (λ FH /µ2F )((µ F − 1) Q FH ( a FH ( ϕ))1−σF / f FH ( ϕ))1/σF .
Using this notation, we can then express optimal imports, q∗FH ( ϕ), as



(µ2 a ( ϕ)/λ FH )−σF Q FH

 F FH
q∗FH ( ϕ) = f FH ( ϕ)/((µ F − 1) a FH ( ϕ))



0

, if ϕ ∈ ΦuFH ≡ { ϕ : θ FH ( ϕ) ∈ [1, ∞)},
, if ϕ ∈ ΦcFH ≡ { ϕ : θ FH ( ϕ) ∈ [1/µ F , 1)}, (15)
, otherwise.

10

The set ΦcFH will play a key role in our subsequent analysis. For varieties ϕ ∈ ΦcFH ,
Home finds it optimal to alter its importing decision to make sure that foreign firms are
willing to produce and export strictly positive amounts. This feature, which is at the core
of models of trade with endogenous selection of firms into exporting, will lead to import
taxes that vary across firms in Section 4.2.
Like in the Section 3.1, the final step of our Lagrangian approach consists in finding
λ FH such that constraint (13b), evaluated at {q∗FH ( ϕ)}, holds, that is
ˆ
ΦuFH

ˆ

+

ΦcFH

NF (µ2F a FH ( ϕ)/λ FH )1−σF dGF ( ϕ)

NF ( f FH ( ϕ)/((µ F − 1) a FH ( ϕ) Q FH ))1/µ F dGF ( ϕ) = 1.

(16)

The left-hand side is continuous, strictly increasing in λ FH , with limits equal to zero and
infinity when λ FH goes to zero and infinity, respectively. By the Intermediate Value Theorem, there must therefore exist a unique λ FH that satisfies (16), and, by the same argument
as in Section 3.1, equations (15) and (16) characterize the unique solution to (13).

3.3

Macro Problem: Manipulating Terms-of-Trade

The goal of Home’s planner is to maximize UH ( Q HH , Q FH ) subject to the resource constraint (8) and the foreign equilibrium conditions. First, note that given the analysis of
Section 3.1, the resource constraint can be expressed as
L H ( Q HH , Q HF ) ≤ L H ,
with L H ( Q HH , Q HF ) given by (9). Second, note that the foreign equilibrium conditions
can be aggregated into a trade balance condition. Conditions (3), (6), and (7) for i = F
imply that the value of Foreign imports must be equal to the value of its exports,
PHF Q HF = PFH Q FH .
Given the analysis of Section 3.2, we also know that the value of Foreign’s exports must
be equal to PFH ( Q FH , NF ) Q FH , with PFH ( Q FH , NF ) given by (13). In Appendix A.3, we
show that using condition (1) for i = F and j = F and conditions (2)-(6) for i = F, we can
also solve for the measure of foreign entrants, NF ( Q FH ), and the price of Home’s exports,
PHF ( Q FH , Q HF ), as a function of aggregate exports and imports.
Combining the previous observations, we conclude that optimal aggregate quantities
11

must solve the following macro problem,
max

Q HH ,Q FH ,Q HF

UH ( Q HH , Q FH )

(17a)

P( Q FH , Q HF ) Q HF = Q FH ,

(17b)

L H ( Q HH , Q HF ) ≤ L H ,

(17c)

where P( Q FH , Q HF ) ≡ PHF ( Q FH , Q HF )/PFH ( Q FH , NF ( Q FH )) denotes the price of Home’s
exports relative to its imports as a function of aggregate imports and exports. At this
point, it should be clear that we are back to a standard terms-of-trade manipulation problem, with Home’s planner internalizing the impact of its aggregate imports and exports,
Q FH and Q HF , on its terms-of-trade, P. Compared to the decentralized equilibrium where
consumers and firms take P as given, this introduces curvature into Home’s consumption
possibility frontier; see e.g. Baldwin (1948). Like in a perfectly competitive model of international trade, foreign technology, endowments, and preferences only matter through
their combined effect on Home’s terms-of-trade.
The first-order conditions associated with (17) imply
UHH = Λ H L HH ,

(18)

UFH = Λ T (1 − ( PQ HF /Q FH )η FH ),

(19)

Λ T P(1 + η HF ) = Λ H L HF ,

(20)

where UiH ≡ ∂UH ( Q HH , Q FH )/∂QiH denotes the marginal utility at home of the aggregate good from country i = H, F; L Hj ≡ ∂L H ( Q HH , Q HF )/∂Q Hj denotes the marginal
cost of producing and delivering one unit of the home good in country j = H, F; Λ T
and Λ H are the Lagrange multipliers associated with constraints (17b) and (17c); and
ηij ≡ ∂ ln P( Q FH , Q HF )/∂ ln Qij , with i 6= j, denotes the elasticity of the Home’s terms
of trade with respect to exports and imports. For future reference, note that the trade
balance condition (17b) and the first-order conditions (18)-(20) imply
MRS H = MRTH P/(1 + τ ∗ ),

(21)

where MRS H ≡ UHH /UFH denotes the marginal rate of substitution at home, MRTH ≡
L HH /L HF denotes the marginal rate of transformation, and
∗
∗
∗
τ ∗ = −(η HF
+ ηFH
)/(1 + η HF
)

12

is the wedge that captures the terms-of-trade motive. Absent this motive, the only difference between MRS H and P would be coming from the cost of producing Home’s aggregate good for the domestic market relative to the foreign market, that is MRTH . If
there are no trade frictions, including no fixed fixed exporting costs, then MRTH = 1 and
equation (21) reduces to the familiar condition for an optimal tariff: MRS H = P/(1 + τ ∗ ).
Let us take stock. We have set up and solved the micro and macro problems of a
domestic government that directly controls q H H ≡ {q HH ( ϕ)}, q F H ≡ {q FH ( ϕ)}, q H F ≡
{q HF ( ϕ)}, and NH . Optimal macro quantities, Q∗HH , Q∗FH , and Q∗HF , can be computed
using equations (17b)-(20). The aggregate export and import prices as well as the measure
∗ = P ( Q∗ , Q∗ ), P∗ = P ( Q∗ , N ( Q∗ )),
of foreign entrants are then given by PHF
HF
FH
F
FH
FH
FH
FH
HF
∗
∗
∗
∗
∗
and NF = NF ( Q FH ). Finally, optimal micro quantities, q HH , q HF , and q FH as well as the
∗ , can be derived using equations (10), (12), and (15). We
optimal measure of entrants, NH
now turn to implementation and show how the previous allocation, which we will refer
to as the first-best allocation, can be decentralized using ad-valorem taxes.

4

Optimal Taxes

We proceed in two steps. First, we derive necessary properties that ad-valorem taxes
implementing the first-best allocation must satisfy. Second, we use these properties to
establish the existence of such taxes. Since they replicate the solution to Home’s planning
problem, they a fortiori solve the home government’s problem given by Definition 1.

4.1

Micro-level Taxes on Domestic Varieties

∗
∗
Consider first a schedule of domestic taxes, s∗H H ≡ {s∗HH ( ϕ)} and t H
H ≡ { t HH ( ϕ )}, that
implements the first-best allocation. Fix a benchmark variety ϕ HH that is sold domestically in the first-best allocation. Denote by s∗HH ≡ s∗HH ( ϕ HH ) and t∗HH ≡ t∗HH ( ϕ HH ) the
domestic taxes imposed on that variety. Now take any other variety ϕ ∈ ΦHH that is sold
domestically in the first-best allocation. By equations (1) and (2), we must have

q∗HH ( ϕ HH )
=
q∗HH ( ϕ)



(1 + t∗HH ) a HH ( ϕ HH )
(1 + t∗HH ( ϕ))
(1 + s∗HH )
(1 + s∗HH ( ϕ)) a HH ( ϕ)

−σH
.

Combining this expression with equation (10), we obtain our first result.
Lemma 1. In order to implement the first-best allocation, domestic taxes should be such that

(1 + s∗HH ( ϕ))/(1 + t∗HH ( ϕ)) = (1 + s∗HH )/(1 + t∗HH ) if ϕ ∈ ΦHH .
13

(22)

While we have focused on domestic taxes, there is nothing in the previous proposition
that hinges on domestic varieties being sold in the domestic market rather than abroad.
Thus, we can use the exact same argument to characterize the structure of export taxes,
s∗H F ≡ {s∗HF ( ϕ)}, that implement the first-best allocation. In line with the previous analysis, let ϕ HF denote a benchmark variety that is exported in the first-best allocation, with
s∗HF ≡ s∗HF ( ϕ HF ). The following result must hold.
Lemma 2. In order to implement the first-best allocation, export taxes should be such that
s∗HF ( ϕ) = s∗HF if ϕ ∈ ΦHF .

4.2

(23)

Micro-level Taxes on Foreign Varieties

Now consider a schedule of import taxes, t F∗ H ≡ {t∗FH ( ϕ)}, that implements the first-best
allocation. Fix again a benchmark variety ϕ FH that is imported in the first-best allocation.
Furthermore, choose ϕ FH such that the non-negativity constraint for foreigners’ export
profits is exactly binding at the unconstrained optimum: quFH ( ϕ FH ) = qcFH ( ϕ FH ). By
continuity of the profit function with respect to variable and fixed cost, such a variety
must exist. In line with our previous analysis, let t∗FH ≡ t∗FH ( ϕ FH ) denote the import tax
imposed on that benchmark variety. For any another variety ϕ ∈ Φ FH ≡ ΦuFH ∪ ΦcFH that
is imported in the first-best allocation, equations (1) and (2) now imply
q∗FH ( ϕ FH )
=
q∗FH ( ϕ)



(1 + t∗FH ) a FH ( ϕ FH )
(1 + t∗FH ( ϕ)) a FH ( ϕ)

−σF
.

(24)

There are two possible cases to consider. If ϕ ∈ ΦuFH ≡ { ϕ : θ FH ( ϕ) ∈ [1, ∞)}, then
equations (15) and (24) imply
t∗FH ( ϕ) = t∗FH .
If ϕ ∈ ΦcFH ≡ { ϕ : θ FH ( ϕ) ∈ [1/µ F , 1)}, then equations (15) and (24) imply
t∗FH ( ϕ) = (1 + t∗FH )θ FH ( ϕ) − 1.
This leads to our third result.
Lemma 3. In order to implement the first-best allocation, import taxes should be such that
t∗FH ( ϕ) = (1 + t∗FH ) min{1, θ FH ( ϕ)} − 1 if ϕ ∈ Φ FH ,

(25)

with the profitability index θ FH ( ϕ) ≡ (λ FH /µ2F )((µ F − 1) Q FH ( a FH ( ϕ))1−σF / f FH ( ϕ))1/σF .
14

Like an anti-dumping duty, optimal import taxes are higher for more profitable exporters.
However, in the context of a canonical model of intra-industry trade where heterogeneous
firms select into exporting, such heterogeneous taxes do not reflect the home government’s desire to prevent imports from more profitable exporters. Instead, they reflect the
desire to import from less profitable exporters as well. In contrast to an anti-dumping
duty, this motive leads to import taxes that are constant among the most profitable exporters, but vary among the least profitable ones.

4.3

Overall Level of Taxes

Our next goal is to characterize the overall level of taxes that is necessary for a decentralized equilibrium to implement the first-best allocation. In Sections 4.1 and 4.2, we
have already expressed all other taxes as a function of t∗HH , t∗FH , s∗HH , and s∗HF . So, this
boils down to characterizing these four taxes. To do so, we compare the ratio between
the marginal rates of substitution at home and abroad in the first-best allocation—which
is determined by equations (A.3), (A.4) and (21)—and their ratio in the decentralized
equilibrium with taxes—which is determined by equations (4)-(2). As expected, and as
∗ + η ∗ ) / (1 + η ∗ ), that apestablished formally in Appendix B.1, the wedge, τ ∗ = −(η HF
FH
HF
pears in the first-order conditions of Home’s macro planning problem anchors the overall
level of taxes in the decentralized equilibrium.
Lemma 4. In order to implement the first-best allocation, the overall level of optimal taxes, t∗HH ,
t∗FH , s∗HH , and s∗HF , should be such that
´
(1 + τ ∗ ) Φ FH ((min{1, θ FH ( ϕ)})µ F a FH ( ϕ))1−σF dGF ( ϕ)
(1 + t∗FH )/(1 + t∗HH )
´
=
.
1−σF dG ( ϕ )
(1 + s∗HF )/(1 + s∗HH )
F
Φ FH ((min{1, θ FH ( ϕ )}) a FH ( ϕ ))

(26)

Two remarks are in order. First, if ΦcFH is measure zero, then min{1, θ FH ( ϕ)} = 1 for all
ϕ ∈Φ FH so optimal import taxes are uniform and equation (26) reduces to

(1 + t∗FH )/(1 + t∗HH )
= (1 + τ ∗ ).
∗
∗
(1 + s HF )/(1 + s HH )
This is what would happen in the absence of fixed exporting costs, as in Krugman (1980).
We come back to this situation more generally in Section 5 when we study optimal uniform taxes. Second, if ΦcFH is not measure zero, then µ F > 1 implies

(1 + t∗FH )/(1 + t∗HH )
> (1 + τ ∗ ).
(1 + s∗HF )/(1 + s∗HH )
15

This merely reflects our choice of benchmark variety for imports. t∗FH is the tax on the
variety ϕ FH such that the non-negativity constraint for foreigners’ export profits is exactly
binding at the unconstrained optimum: quFH ( ϕ FH ) = qcFH ( ϕ FH ). We know from Lemma
3 that import taxes should be lower on varieties ϕ ∈ ΦcFH . So in order to implement
the same wedge, the domestic government must now impose import taxes on varieties
ϕ ∈ ΦuFH that, relative to other taxes, are strictly greater than 1 + τ ∗ .

4.4

Implementation

Lemmas 1-4 provide necessary conditions that linear taxes have to satisfy so that the
decentralized equilibrium replicates the first-best allocation. In the next lemma, which
is proven in Appendix B.2, we show that that if the previous taxes are augmented with
prohibitive taxes on the goods that are not consumed, ϕ ∈
/ ΦHH , ϕ ∈
/ ΦHF , and ϕ ∈
/ Φ FH ,
then they are also sufficient to implement the first-best allocation.
Lemma 5. There exists a decentralized equilibrium with taxes that implements the first-best allocation.
Since Home’s planning problem is a relaxed version of Home’s government problem introduced in Definition 1, the taxes associated with a decentralized equilibrium that
implements the first-best allocation must a fortiori solve Home’s government problem.
Lemmas 2-5 therefore imply that any taxes that solve Home’s government problem must
satisfy conditions (22), (23), (25), and (26). To summarize, we can characterize unilaterally
optimal taxes as follows.
Proposition 1. At the micro-level, unilaterally optimal taxes should be such that: (i ) domestic taxes are uniform across all domestic producers (condition 22); (ii ) export taxes are uniform
across all exporters (condition 23); (iii ) import taxes are uniform across Foreign’s most profitable
exporters and strictly increasing with profitability across its least profitable ones (condition 25).
At the macro-level, unilaterally optimal taxes should reflect standard terms-of-trade considerations
(condition 26).
Note that condition (26) only pins down the relative levels of optimal taxes. In the proof
of Lemma 5, we show how to implement the first-best allocation using only import taxes,
t∗HH = s∗HH = s∗HF = 0. There is, however, a continuum of optimal taxes that would
achieve the same allocation. For instance, we could have used a uniform export tax equal
to
´
1−σF dG ( ϕ )
F
Φ FH ((min{1, θ FH ( ϕ )}) a FH ( ϕ ))
´
s∗HF =
,
(1 + τ ∗ ) Φ FH ((min{1, θ FH ( ϕ)})µ F a FH ( ϕ))1−σF dGF ( ϕ)
16

while setting the overall level other taxes such that t∗HH = s∗HH = t∗FH = 0. This is an expression of Lerner symmetry, which must still hold under monopolistic competition. In
this case, all varieties ϕ ∈ ΦcFH would receive an import subsidy equal to θ FH ( ϕ) − 1 < 0.
As alluded to in Section 3.1, the fact that domestic taxes can be dispensed with derives
from the efficiency of the decentralized equilibrium with monopolistic competition and
CES utility. Here, as in Bhagwati (1971), trade taxes are the first-best instruments to exploit monopoly and monopsony power in world markets. We come back to this issue
in Section 6 when discussing how our results extend to environments subject to homemarket effects where the decentralized equilibrium is no longer efficient.

4.5

How Does Firm Heterogeneity Affect Optimal Trade Policy?

Using Proposition 1, we can take a first stab at describing how firm heterogeneity affects
optimal trade policy. There are two broad insights that emerge from our analysis.
∗ and η ∗ , determine the wedge, τ ∗ , between
The first one is that macro-elasticities, η HF
FH
Home and Foreign’s marginal rates of substitution at the first-best allocation and, in turn,
the overall level of trade protection, as established by condition (26). In line with the
equivalence result in Arkolakis, Costinot and Rodríguez-Clare (2012), this is true regardless of whether or not firms are heterogeneous and only the most profitable ones select
into exporting. This first observation derives from the fact that at the macro-level, Home’s
planning problem can still be expressed as a standard terms-of-trade manipulation problem where Home chooses aggregate exports and imports taking into account the effect
of these decisions on its terms-of-trade, where home consumers and firms do not; see
problem (17).
The second insight that emerges from Proposition 1 is that even conditioning on macroelasticities, firm heterogeneity does affect optimal trade policy, as it leads to optimal
trade taxes that are heterogeneous across foreign exporters (whenever ΦcFH is not measure zero). In order to lower the aggregate price of its imports, the home government has
incentives to impose tariffs that are increasing with the profitability of foreign exporters.
∗ and η ∗ ,
Since the overall level of trade protection is fixed by the macro-elasticities, η HF
FH
this implies that the import tariffs imposed on the most profitable firms from abroad are
higher, relative to other taxes, than they would be in the absence of selection, as also
established by condition (26).
These findings echo the results derived by Costinot, Donaldson, Vogel and Werning
(2015) in the context of a Ricardian model. As they note, the equivalence emphasized by
Arkolakis, Costinot and Rodríguez-Clare (2012) builds on the observation that standard

17

gravity models, like Anderson and Van Wincoop (2003) and Eaton and Kortum (2002),
are equivalent to endowment models in which countries directly exchange labor services.
Hence, conditional on the elasticity of their labor demand curves, the aggregate implications of uniform changes in trade costs, i.e. exogenous labor demand shifters, must be the
same in all gravity models. The previous observation, however, does not imply that optimal policy should be the same in all these models. To the extent that optimal trade taxes
are heterogeneous across goods, they will not act as simple labor demand shifters, thereby
breaking the equivalence in Arkolakis, Costinot and Rodríguez-Clare (2012). This is what
Proposition 1 establishes in the context of a canonical model of trade with monopolistic
competition and firm-level heterogeneity à la Melitz (2003).
This general conclusion notwithstanding—micro-structure matters for optimal policy,
even conditioning on macro-elasticities—it is worth noting that the specific policy prescriptions derived under perfect and monopolistic competition differ sharply. In Costinot,
Donaldson, Vogel and Werning (2015), optimal export taxes should be heterogeneous,
whereas optimal import tariffs should be uniform. This is the exact opposite of what
conditions (23) and (25) prescribe under monopolistic competition. In a Ricardian economy, goods exported by domestic firms could also be produced by foreign firms. This
threat of entry limits the ability of the home government to manipulate prices and leads
to lower export taxes on “marginal” goods. Since this threat is absent under monopolistic
competition, optimal export taxes are uniform instead. On the import side, lower tariffs
on “marginal” goods under monopolistic competition derive from the existence of fixed
exporting costs, which are necessarily absent under perfect competition.

5

Optimal Uniform Taxes

In previous sections, we have characterized optimal trade policy under the assumption
that the home government is not only free to discriminate between firms from different
countries by using trade taxes, but also unlimited in its ability to discriminate between
firms from the same country. While this provides a useful benchmark to study the normative implications of firm heterogeneity for trade policy, informational or legal constraints
may make this type of taxation infeasible in practice. Here, we turn to the other polar
case in which the home government is constrained to set uniform taxes: t HF ( ϕ) = t̄ HF ,
t HH ( ϕ) = t̄ HH , s HF ( ϕ) = s̄ HF , and s HH ( ϕ) = s̄ HH for all ϕ.

18

5.1

Micro to Macro Once Again

To solve for optimal uniform taxes, we can follow the same approach as in Sections 3
and 4. The only difference is that the micro problems of Sections 3.1 and 3.2 should now
include an additional constraint:
qij ( ϕ0 )/qij ( ϕ) = aij ( ϕ0 )/aij ( ϕ)

−σF

for any ϕ, ϕ0 such that qij ( ϕ0 ), qij ( ϕ) > 0.

(27)

By construction, whenever the solution to Home’s planning problem satisfies (27), it can
be implemented with uniform taxes over the goods that are being produced. Furthermore, since Home always prefers to produce or import the most profitable goods, any
solution that satisfies (27) can also be implemented with the same uniform taxes over the
goods that are not produced or imported. Like in Section 4.4, strictly higher taxes on those
goods can be dispensed with.
For domestic varieties that are sold in any market, i = H and j = H, F, constraint
(27) is satisfied by the solution to the relaxed problem (9). In this case, optimal taxes
were already uniform, as established in Lemmas 1 and 2. So the value of L H ( Q HH , Q HF )
remains unchanged. In contrast, for foreign varieties that are imported by Home, i = F
and j = H, constraint (27) binds at the solution to (13). Combining (13a)-(13c) with the
new constraint (27), one can check that the import price index now satisfies
ˆ

(µ F a FH ( ϕ))1−σF dGF ( ϕ))1/(1−σF ) ,

PFH ( Q FH , NF ) = ( NF

(28)

ΦFH

where ΦFH ≡ { ϕ : (µ F − 1) a FH ( ϕ)(µ F a FH ( ϕ)/PFH ( Q FH , NF ))−σF Q FH ≥ f FH ( ϕ)} is the
set of imported varieties, which depends on both aggregate imports, Q FH , and the measure of foreign firms, NF .
The other equations that characterize the solution to Home’s planning problem are
unchanged. In particular, one can still reduce Home’s macro planning problem to
max

Q HH ,Q FH ,Q HF

UH ( Q HH , Q FH )
Q FH ≤ P( Q FH , Q HF ) Q HF ,
L H ( Q HH , Q HF ) ≤ L H ,

where P( Q FH , Q HF ) ≡ PHF ( Q FH , Q HF )/PFH ( Q FH , NF ( Q FH )) and PHF ( Q FH , Q HF ) and
NF ( Q FH ) are given by the solutions of (A.3)-(A.6). Following the same reasoning as in
Section 4, and using the fact that domestic and export taxes are normalized to zero, one

19

can therefore show that optimal uniform taxes must satisfy

(1 + t̄∗FH )/(1 + t̄∗HH )
= 1 + τ∗.
(1 + s̄∗HF )/(1 + s̄∗HH )

(29)

∗ + η ∗ ) / (1 + η ∗ ),
Compared to the analysis of Section 4, the optimal wedge, τ ∗ = −(η HF
FH
HF
stills depends exclusively on the terms-of-trade elasticities. The only difference is that the
import price index that determines these elasticities is now given by equation (28).
In order to help our results to those in the existing literature, we set domestic and
export taxes to zero in the rest of this section: t̄∗HH = s̄∗HH = s̄∗HF = 0. For the same
reasons as in Section 4.4, this is without loss of generality. Under this normalization, we
can talk equivalently about optimal uniform taxes and optimal uniform tariffs, t∗FH = τ ∗ .

5.2

Terms-of-Trade Elasticities

In Section 3, terms-of-trade elasticities are complex objects that depend both on supply
and demand conditions in Foreign—as summarized by (A.3)-(A.6)—as well as the optimal micro-level choices of Home’s government. With uniform trade taxes, the constraints
imposed on the latter makes the determinants of terms-of-trade elasticities simpler. We
now take advantage of this simplicity to explore the deeper determinants of terms-oftrade elasticities. In the next subsection, this information will allow us to address whether
going from an economy without firm heterogeneity to an economy with firm heterogeneity affects the overall level of trade protection by changing the terms-of-trade elasticities.
In the absence of taxes that vary at the micro-level, it is convenient to summarize
technology in Foreign by the function
ˆ

L F ( Q FH , Q FF ) ≡ min N [∑ j= H,F
l Fj (q Fj ( ϕ), ϕ)dGF ( ϕ) + f Fe ]
q FH ,q FF ,N
Φ
ˆ
1/µ
N (q Fj ( ϕ))1/µ F dGF ( ϕ) ≥ Q Fj F , for j = H, F.
Φ

(30a)
(30b)

This is just the counterpart of problem (9) for Home in Section 3.1. By construction, Foreign’s production possibility frontier corresponds to the set of aggregate output levels
( Q FH , Q FF ) such that L F ( Q FH , Q FF ) = L F . Building on the efficiency of the decentralized
equilibrium under monopolistic competition with CES utility, one can then show that
Foreign necessarily operates on its production possibility frontier with the marginal rate
of transformation being equal to the price of foreign exports relative to foreign domestic
output. On the demand side, we already know that the marginal rate of substitution must

20

Q FF

Q FH
Figure 1: Aggregate Nonconvexities with Firm Heterogeneity
be equal to the price of foreign imports relative to foreign domestic consumption. Thus
foreign equilibrium conditions can be described compactly as follows; see Appendix C.1
for a formal proof.
Lemma 6. Conditional on Q HF and Q FH , the decentralized equilibrium abroad satisfies
MRS F ( Q HF , Q FF ( Q FH )) = PHF ( Q HF , Q FH )/PFF ( Q FH ),

(31)

MRTF ( Q FH , Q FF ( Q FH )) = PFH ( Q FH , NF ( Q FH ))/PFF ( Q FH ),

(32)

with local production, Q FF ( Q FH ), given by the implicit solution of
L F ( Q FH , Q FF ) = L F .

(33)

The key insight of Lemma 6 is that the decentralized equilibrium abroad under monopolistic competition with CES utility is isomorphic, in terms of aggregate quantities
and prices, to a perfectly competitive equilibrium with three goods, two of them being
produced, in quantities Q FF and Q FH , and two of them being consumed, in quantities
Q FF and Q HF . The only distinction between the two equilibria is that under monopolistic
competition, Foreign’s production set may not be convex, as depicted in Figure 1. We
come back to this point below.
Let e ≡ −d ln( Q HF /Q FF )/d ln( PHF /PFF ) denote the elasticity of substitution between
imports and domestic goods and let κ ≡ d ln( Q FH /Q FF )/d ln( PFH /PFF ) denote the elasticity of transformation between between exports and domestic goods (both in Foreign).
Since the marginal rate of substitution and the marginal rate of transformation abroad are

21

both homogeneous of degree zero,8 equations (31) and (32) imply
e = −1/(d ln MRS F ( Q HF /Q FF , 1)/d ln( Q HF /Q FF )),

(34)

κ = 1/(d ln MRTF ( Q FH /Q FF , 1)/d ln( Q FH /Q FF )).

(35)

By equations (31) and (32), we also know that Home’s terms of trade are given
P( Q FH , Q HF ) = MRS F ( Q HF , Q FF ( Q FH ))/MRTF ( Q FH , Q FF ( Q FH )).

(36)

Differentiating equation (36) with respect to Home’s aggregate exports and imports, Q HF
and Q FH , and using equations (34) and (35), we obtain Home’s terms-of-trade elasticities,
η HF = −1/e,

(37)

η FH = −(1/x FF − 1)/e − 1/( x FF κ ),

(38)

where x FF ≡ PFF Q FF /L F is the share of expenditure on domestic goods in Foreign.9
When κ ≥ 0, Foreign’s production set is convex and, everything else being equal, an
increase in Home’s imports tends to worsen its terms of trade by raising the opportunity
cost of foreign exports in terms of foreign domestic output. This is the mechanism at play
in a neoclassical environment. When κ < 0 instead, aggregate nonconvexities imply that
an increase in Home’s imports tends to lower the opportunity cost of foreign exports, and
in turn, improve its terms of trade.

5.3

A Generalized Optimal Tariff Formula

Combining equation (29)—under the restriction that t̄∗HH = s̄∗HH = s̄∗HF = 0—with equations (37) and (38), we obtain the following characterization of optimal uniform tariffs
under monopolistic competition with firm heterogeneity.
8 The homogeneity of degree zero of the marginal rate of substitution derives directly from our assumption that the foreign utility function is homothetic. Establishing the homogeneity of degree zero of
the marginal rate of transformation is more subtle since the transformation function, L F ( Q FH , Q FF ), is not
homogeneous of degree one. We do so formally in Appendix C.2.
9 To derive equation (38), we have also used the fact that

d ln Q FF ( Q FH )/d ln Q FH = Q0FF ( Q FH ) Q FH /Q FF ( Q FH ) = − Q FH MRTF ( Q FH , Q FF ( Q FH ))/Q FF ( Q FH ).
Together with equation (32), this implies
d ln Q FF ( Q FH )/d ln Q FH = −( PFH Q FH )/( PFF Q FF ) = −(1/x FF − 1).

22

Proposition 2. Optimal uniform tariffs are such that
t̄∗FH =

1 + (e∗ /κ ∗ )
,
(e∗ − 1) x ∗FF

(39)

where e∗ , κ ∗ , and x ∗FF are the values of e, κ, and x FF evaluated at those taxes.
Equation (39) is a strict generalization of the optimal tariff formula derived under monopolistic competition by Gros (1987), Demidova and Rodríguez-Clare (2009), and Felbermayr, Jung and Larch (2013). It applies to any economy in which: (i ) Home’s optimal
choices of exports and imports correspond to the solution to a planning problem that can
be reduced to (17); and (ii ) the decentralized equilibrium in the rest of the world can
be reduced to equations (31)-(33). Within that class of models, alternative assumptions
about technology, preferences, and market structure only matter for the overall level of
trade protection if they affect the three sufficient statistics: e∗ , κ ∗ , and x ∗FF .
Gros (1987) focuses on an economy à la Krugman (1980). There is no firm heterogeneity, no market-specific fixed costs, and the elasticity of substitution between domestic and
foreign goods is constant, e∗ = σH = σF ≡ σ. In this case, all firms export to all markets.
Thus, equation (32) implies that the marginal rate of transformation abroad is constant
and given by
´
( Φ ( a FH ( ϕ))1−σF dGF ( ϕ))1/(1−σF )
.
MRTF = ´
( Φ ( a FF ( ϕ))1−σF dGF ( ϕ))1/(1−σF )
In turn, the elasticity of transformation κ ∗ goes to infinity and equation (39) becomes
t̄∗FH =

1
> 0.
(σ − 1) x ∗FF

Proposition 2 demonstrates that Gros’s (1987) formula remains valid for arbitrary distributions of firm-level productivity and arbitrary upper-level utility functions provided
that Foreign’s production possibility frontier is linear. A sufficient condition for this to be
the case is that foreign firms face no fixed costs of selling in both markets, f Fj ( ϕ) = 0 for
j = H, F.
Beside greater generality, a benefit of our analysis is that it helps identify the economic
forces that determine optimal trade policy under monopolistic competition. Under the
restriction that e∗ = σH = σF ≡ σ, the optimal tariff formula derived by Gros (1987)
can be interpreted in two ways, as discussed by Helpman and Krugman (1989). One
can think of Home as manipulating its terms-of-trade, as we have emphasized in this
paper, or of Home imposing a tariff equal to the markup charged on domestic goods so
that the relative price of foreign to domestic goods equals the country’s true opportunity
23

cost. Indeed, the difference between the foreign firms’ prices and their marginal costs
is equal to µ F − 1 = 1/(σF − 1), which is the optimal tariff that a small open economy
would choose when e∗ = σF . By allowing the upper-level elasticity of substitution, e∗ ,
to differ from the lower-level elasticities of substitution, σH and σF , our analysis suggests
that the first of these two interpretations is the most robust. When e∗ 6= σF , foreign
firms still charge a markup µ F = σF /(σF − 1) on the goods that they export. Yet, the only
relevant elasticity in this case is e∗ because it is the one that shapes Home’s terms-of-trade
elasticities, as shown in equations (37) and (38). We come back to this issue in Section 6.3.
As noted above, Proposition 2 also generalizes the results of Demidova and RodríguezClare (2009) and Felbermayr, Jung and Larch (2013) who focus on an economy à la Melitz
(2003). Compared to the present paper, they assume a constant elasticity of substitution
between domestic and foreign goods, e∗ = σH = σF ≡ σ. They also assume that taxes
are uniform across firms, that firms only differ in terms of their productivity, and that
the distribution of firm-level productivity is Pareto. Under these assumptions, the decentralized equilibrium with taxes can be solved in closed-form. As discussed in Feenstra
(2010), models of monopolistic competition with Pareto distributions lead to an aggregate
production possibility frontier with constant elasticity of transformation,
κ∗ = −

σν − (σ − 1)
< 0,
ν − ( σ − 1)

(40)

where ν > σ − 1 is the shape parameter of the Pareto distribution; see Appendix C.3.10
Combining equations (39) and (40) and imposing e∗ = σ, we obtain
t̄∗FH =

1
> 0,
(νµ − 1) x ∗FF

as in Felbermayr, Jung and Larch (2013). In the case of a small open economy, the previous expression simplifies further into 1/(νµ − 1), as in Demidova and Rodríguez-Clare
(2009).

10 In

his analysis of models of monopolistic competition with Pareto distributions, Feenstra (2010) concludes that firm heterogeneity leads to strictly convex production sets. In contrast, equation (40) implies
that Foreign’s production set is non-convex: κ ∗ < 0. Both results are mathematically correct. The apparently opposite conclusions merely reflect the fact that we have defined the aggregate production possibility
frontier abroad as a function of the CES quantity aggregates, Q FH and Q FF , whereas Feenstra (2010) defines
1/µ
1/µ
them, using our notation, in terms of Q FH F and Q FF F .

24

5.4

Firm Heterogeneity, Aggregate Nonconvexities, and Trade Policy

Since ν > σ − 1, an intriguing implication of the results in Demidova and RodríguezClare (2009) and Felbermayr, Jung and Larch (2013) is that conditional on e∗ = σ and
x ∗FF , the optimal level of trade protection is lower when only a subset of firms select into
exports than when they all do, 1/((νµ − 1) x ∗FF ) < 1/((σ − 1) x ∗FF ). This specific parametric example, however, is silent about the nature and robustness of the economic forces
leading up to this result.
Our general analysis isolates aggregate nonconvexities as the key economic channel
through which firm heterogeneity tends to lower the overall level of trade protection.
Mathematically, the previous observation is trivial. From equations (20) and (37), we
know that e∗ − 1 > 0. Since κ ∗ → ∞ when firms are homogeneous, we arrive at the
following corollary of Proposition 2.
Corollary 1. Conditional on (e∗ , x ∗FF ), optimal uniform tariffs are strictly lower with than without firm heterogeneity if and only if firm heterogeneity creates aggregate nonconvexities, κ ∗ < 0.
Economically speaking, Home’s trade restrictions derive from the negative effects of exports and imports on its terms of trade. By reducing the elasticity of Home’s terms of
trade with respect to its imports, in absolute value, aggregate nonconvexities dampen
this effect, and in turn, reduce the optimal level of trade protection.
The final question that remains to be addressed is how likely it is that the selection of
heterogeneous firms into exporting will lead to aggregate nonconvexities. It is instructive
to consider first a hypothetical situation in which the measure of foreign firms, NF , is exogenously given. In that situation, the selection of heterogeneous firms would necessarily
lead to aggregate nonconvexities. To see this, note that equation (32) implies
´

1−σF dG ( ϕ ))1/(1−σF )
F
Φ ( a FH ( ϕ ))
,
MRTF = ´ FH
( Φ FF ( a FF ( ϕ))1−σF dGF ( ϕ))1/(1−σF )

(

with the set of foreign varieties sold in market j = H, F such that
ΦFj = { ϕ :

(µ F − 1) a1Fj−σF ( ϕ)( NF

ˆ
ΦFj

a1Fj−σF ( ϕ)dGF ( ϕ))−µ F Q Fj ≥ f Fj ( ϕ)}.

If selection is active in market j, in the sense that some foreign firms are indifferent between selling and non-selling in market j, then ΦFj must expand as Q Fj increases. Since
´
consumers love variety, this must lead to a decrease in ( Φ ( a Fj ( ϕ))1−σF dGF ( ϕ))1/(1−σF ) .11
Fj

11 Formally,

this requires that GF has strictly positive density around blueprints ϕ with profitability such

25

And since labor market clearing requires Q FF to be decreasing in Q FH , this implies that
MRTF ( Q FH , Q FF ( Q FH )) is decreasing in Q FH , i.e. that there are aggregate nonconvexities.
Intuitively, an increase in foreign exports, Q FH , has two effects. First, it expands the
set of foreign firms that export, which lowers the unit cost of Foreign’s exports. Second,
it lowers Q FF , which reduces the set of foreign firms that sell domestically and raises
the unit cost of Foreign’s domestic consumption. Both effects tend to lower Foreign’s
opportunity cost of exports in terms of domestic consumption.
Our next result provides sufficient conditions such that the previous selection forces
dominate any additional effect that changes in aggregate exports, Q FH , may have on the
number of foreign entrants, NF , and in turn, the monotonicity of MRTF . Let NF∗ ( Q FH , Q FF )
denote the measure of foreign firms associated with the solution to (30).
Lemma 7. If the measure of foreign entrants increases with aggregate output to any market,
∂NF∗ ( Q FH , Q FF )/∂Q Fj > 0 for j = H, F, then firm heterogeneity creates aggregate nonconvexities, κ ∗ ≤ 0, with strict inequality whenever selection is active in at least one market.
We view the monotonicity condition in Lemma 7 as very mild. The measure of foreign
entrants, NF∗ ( Q FH , Q FF ), is determined by free entry.12 When aggregate output in the two
markets shifts firms’ expected profits, the measure of foreign entrants adjust to bring them
back to the fixed entry costs, f Fe . In the absence selection effects, an increase in aggregate
output in any market raises profits and, in turn, the measure of foreign entrants. In this
case, the monotonicity condition in Lemma 7 would necessarily be satisfied.
In the presence of selection effects, an increase in aggregate output in market j may
actually decrease expected profits if the decrease in the price index associated with an expansion of ΦFj is large enough to offset the direct positive effect of aggregate output, Q Fj ,
on firms’ profits. For the monotonicity condition in Lemma 7 to be violated, there must be
large selection effects in one, but only one of the two markets so that expected profits shift
in opposite directions in response to changes in Q FH and Q FF . Under these circumstances,
NF∗ cannot be increasing in both Q FH and Q FF . For the interested reader, Appendix C.5
constructs one such example in which, in spite of the selection of heterogeneous firms,
Foreign’s aggregate production set remains locally convex.
Combining Corollary 1 and Lemma 7, we arrive at the following proposition.
that foreign firms are indifferent between selling and not selling in market j. Whenever we say that selection
is active in market j, we assume that this is the case.
12 Since the decentralized equilibrium is efficient, one can always interpret N ∗ ( Q
FH , Q FF ) as the measure
F
of foreign entrants in the decentralized equilibrium, conditional on the equilibrium values of Q FH and Q FF .
This is the interpretation we adopt here. Formally, NF∗ ( Q FH , Q FF ) is given by equation (C.3) in the proof of
Lemma 6.

26

Proposition 3. If the measure of foreign entrants increases with aggregate output to any market,
then conditional on (e∗ , x ∗FF ), optimal uniform tariffs are lower with than without firm heterogeneity, with strict inequality whenever selection is active in at least one market.
The active selection of heterogeneous firms may actually lower the overall level of
trade protection so much that the optimal uniform tariff may become an import subsidy.
To see this, note that as e∗ goes to infinity, the optimal uniform tariff in equation (39)
converges towards
t̄∗FH = 1/(κ ∗ x ∗FF ),
which is strictly negative if there are aggregate nonconvexities abroad, κ ∗ < 0.
The “new” trade theory synthesized by Helpman and Krugman (1985) and Helpman
and Krugman (1989) is rich in paradoxical results. For instance, a country with higher
demand for a particular good may be a net exporter of that good, the so-called homemarket effect. Such paradoxes derive from the presence of increasing returns at the sectorlevel: when employment in a sector expands, more firms enter, and since consumers
love varieties, the associated price index goes down. In a one-sector economy, however,
these considerations are mute, which explains why the optimal tariff formula derived
by Gros (1987) under monopolistic competition à la Krugman (1980) is the same as in a
perfectly competitive Armington model, or why the formula for gains from trade derived
by Arkolakis, Costinot and Rodríguez-Clare (2012) is the same for the two models.
Interestingly, the import subsidy paradox presented above derives from a very different type of nonconvexities, one that is unique to monopolistically competitive models
with firm heterogeneity and selection, and one that matters for trade policy, even with
only one sector. In a neoclassical environment with diminishing marginal returns, consumers and firms do not internalize the fact that, at the margin, an increase in imports
must raise their opportunity costs and, in turn, the price of all infra-marginal units, which
calls for a positive import tax. Here, in contrast, a government may lower the price of its
imports by raising their volume and inducing more foreign firms to become exporters,
which explains why an import subsidy may be optimal.

6

Optimal Taxes with Intra- and Inter-Industry Trade

The monopolistically competitive model of Section 2 is commonly interpreted as a model
of intra-industry trade where domestic and foreign firms specialize in differentiated varieties of the same product. We now consider a more general environment with both intraand inter-industry trade across multiple sectors indexed by k = 1, ..., K. Formally, the
27

utility function of the representative agent in each country is given by
Ui = Ui (Ui1 , .., UiK ),
Uik = Uik ( QkHi , QkFi ),
ˆ
1/µk
µk
k
Q ji = [ Njk (qkji ( ϕ)) j dGjk ( ϕ)] j ,
Φ

with Uik the utility from consuming all varieties from sector k in country i, Qkji the subutility associated with varieties from country j in that sector, and µkj ≡ σjk /(σjk − 1), with
σjk > 1 the elasticity of substitution between varieties from country j in sector k. The
model of Section 2 corresponds to the special case in which K = 1 and Ui = Q1i . In line
with our previous analysis, we assume that Uik (·, ·) is homothetic for all i and k. Assumptions on technology and market structure are unchanged.

6.1

More Micro Problems and a More Complex Macro Problem

The first goal of this section is to show that the micro-to-macro approach that we have
followed in previous sections readily extends to an economy with multiple industries. At
the micro-level, all our qualitative results about the structure of optimal trade taxes are
unchanged. At the macro-level, domestic taxes are now necessary to correct for the differences in markups across sectors, but, other than that, the overall level of trade protection
still reflects the manipulation of Home’s terms of trade, both within and between sectors.
Let us start with the micro problems of Sections 3.1 and 3.2. Within each sector k =
1, ..., K, one can still define the minimum labor cost at home of producing domestic output,
QkHH , and exports, QkHF ,
LkH ( QkHH , QkHF )

≡

min

qkHH ,qkHF ,N k

ˆ

Nk

k

N [

∑

ˆ

j= H,F Φ

k
l Hj (qkHj ( ϕ), ϕ)dGH
( ϕ) + f He,k ]
k

Φ

k
(qkHj ( ϕ))1/µ H dGH
( ϕ) ≥ ( QkHj )1/µ H , for j = H, F,

as well as the minimum unit cost of imports, conditional on the volume of aggregate

28

imports, QkFH , and the measure of foreign entrants, NFk ,
ˆ
k
PFH
( QkFH , NFk )

≡ min
N k µk a FH ( ϕ)q FH ( ϕ)dGFk ( ϕ)
q FH Φ F F
ˆ
1/µk
NFk q FH F ( ϕ)dGFk ( ϕ) ≥ 1,

Φ
k
µ F a FH ( ϕ) QkFH q FH ( ϕ)

≥ l FH ( QkFH qkFH ( ϕ), ϕ).

The exact same arguments as in Sections 4.1 and 4.2 imply that domestic taxes should be
uniform across firms within the same sector, but that import taxes should be lower on
the least profitable exporters from Foreign. Uniform domestic taxes, in particular, still
reflect the efficiency of firm’s level decisions under monopolistic competition with Constant Elasticity of Substitution (CES) subutility conditional on industry size, here QkHH
and QkHF .
Let Q HH ≡ ( Q1HH , ..., QKHH ), Q FH ≡ ( Q1FH , ..., QKFH ), and Q HF ≡ ( Q1HF , ..., QKHF ) denote
the vector of domestic output, imports, and exports across sectors, respectively, and let
k (Q
k
k
k
k
PFH
FH , Q HF ) ≡ PFH ( Q FH , NF ( Q FH , Q HF )) and PHF ( Q HF , Q HF ) denote the associated
import and export prices. These prices are still determined by the equilibrium conditions
in Foreign, which now consist of the sector-level counterparts of conditions (A.3)-(A.6),13
as well as a new set of first-order conditions associated with the optimality of foreign
consumption across sectors,

(∂UF /∂UFk1 )/(∂UF /∂UFk2 ) = PFk1 /PFk2 , for all k1 , k2 ,
k Q̃k + Pk Q̃k |U k ( Q̃k , Q̃k ) ≥ 1} denotes the foreign price
where PFk ≡ minQ̃k ,Q̃k { PHF
HF
FF FF
F
HF
FF
HF FF
index in sector k. Compared to the one-sector case, the key difference is that the share of
foreign employment allocated to each sector k is now endogenously determined, conditional on Home’s exports and imports, by the relative level of local demand in each sector,
which the new set of first-order conditions pins down.14
Like in Section 3.3, Home’s macro planning problem is simply to maximize the utility

13 The

sector-level counterpart of the free entry condition (A.5) now only holds with complementary
slackness, reflecting the fact that Foreign may only specialize in a subset of sectors in equilibrium.
14 Alternatively, one could have assumed no labor mobility across sectors in Foreign, so that the amount
of labor, LkF , is exogenously given in each sector. In this case, the previous first-order conditions would pin
down instead the foreign wage in sector k, wkF , as a function of Home’s imports and exports. When foreign
preferences are Cobb-Douglas, this is a simple environment to analyze, though one without home-market
effects, like in earlier sections.

29

of its representative agent subject to a trade balance condition and a resource constraint,
max

Q HH ,Q FH ,Q HF

1
K
U H (U H
( Q1HH , Q1FH ), ..., UH
( QKHH , QKFH ))

(41a)

k
k
(Q FH , Q HF ) QkFH ≤ ∑ PHF
(Q HF , Q HF ) QkHF ,
∑ PFH

(41b)

∑ LkH (QkHH , QkHF ) ≤ L H .

(41c)

k

k

k

Using the associated first-order conditions, one can check that Home’s planner would
like to set the marginal rate of substitution between sectors equal to the marginal rate
of transformation. Whenever markups differ across sectors, however, the marginal rate
of transformation will not be equal to the ratio of price indices across sectors in the decentralized equilibrium. Building on this observation, one can then show that Home’s
government would find it optimal to impose domestic taxes that vary across sectors. This
is just an application of the targeting principle: domestic instruments should be used to
correct the domestic distortions, here variable markups across sectors.
In terms of macro-level trade taxes, the above analysis implies that terms-of-trade
manipulation—i.e. the fact that the home government internalizes the impact of aggrek (Q
k
gate imports and exports, Q FH and Q HF , on prices, PFH
FH , Q HF ) and PHF ( Q HF , Q HF ),
whereas private agents do not—is the sole determinant of the overall level of trade protection. This is an important observation, which we come back to in the next subsection. But
it should be clear that, like in a neoclassical environment with arbitrarily many sectors,
see e.g. Bond (1990), there is little that can be said about the optimal structure of trade
protection. In general, export and import prices in each sector depend on export and import decisions in all sectors, Q FH and Q HF , not just export and import in that sector, QkFH
and QkHF .

6.2

A Simple Example with Homogeneous and Differentiated Goods

To provide further insights into the forces that shape terms-of-trade manipulation under
monopolistic competition, both within and between sectors, we turn to a simple example
that has received particular attention in the previous literature. Namely, we assume that
there are two sectors, a homogeneous outside sector (k = O) and a differentiated sector
(k = D), and that Foreign consumers have Cobb-Douglas preferences, as in the model
with homogeneous firms of Venables (1987), Ossa (2011), and Campolmi, Fadinger and
Forlati (2014), and the model with heterogeneous firms of Haaland and Venables (2014).
To facilitate the connection between previous results in the literature and ours, we also
30

restrict all taxes to be uniform within the same sector, as in Section 5. This is equivalent
to adding the sector-level counterpart of constraint (27) to the sector-level micro probD
D
D
lems in Section 6.1. We let t̄ D
HH , t̄ FH , s̄ HH , and s̄ HF denote the uniform ad-valorem taxes
in the differentiated sector and t̄O
H denote the ad-valorem trade tax-cum-subsidy in the
15
homogeneous sector.
In the outside sector, we assume that σFO → ∞, that there are no fixed costs of production and no trade costs, and that all firms at home and abroad have the same productivity, which we normalize to one. So, one can think of the homogeneous good as being
produced by perfectly competitive firms in both countries. In the rest of this section, we
use the outside good as our numeraire. As in the previous sections, we impose no restriction on the distributions of firm-level productivity and fixed costs in the differentiated
D and G D , nor on the sector-level aggregator, U D and U D , which determines the
sector, GH
F
H
F
substitutability between domestic and foreign varieties in both countries. Finally, we let
β F denote the share of expenditure on differentiated goods in Foreign. Given our CobbDouglas assumption, this share is constant.
O
O
Let XO
H ≡ Q FH − Q HF denote Home’s exports of the outside good. Under the previous
assumptions, Home’s macro planning problem reduces to
max

O D
D
D
QO
H ,X H Q HH ,Q FH ,Q HF

O
D
D
D
U H ( QO
H − X H , U H ( Q HH , Q FH ))
D
D
D
D
O
D
D
D
O
PFH
( XO
H , Q FH ) Q FH ≤ PHF ( X H , Q FH , Q HF ) Q HF + X H ,
D
D
D
QO
H + L H ( Q HH , Q HF ) ≤ L H ,

D ( X O , Q D ) and
with Home’s import and export prices in the differentiated sector, PFH
FH
H
D ( X O , Q D , Q D ), such that
PHF
HF
FH
H
D
D
D D
D
D
D
D
O
PFH
( XO
H , Q FH ) = µ F L FH ( Q FH , Q FF ( Q FH , L F ( X H ))),
O
D
D
D
D
D
D
D
O
D
D D
D
D
D
D
PHF
( XO
H , Q HF , Q FH ) = µ F L FF ( Q FH , Q FF ( Q FH , L F ( X H ))) MRS F ( Q HF , Q FF ( Q FH , L F ( X H ))),
D
where L D
for market i = H, F
Fi ≡ ∂L F /∂Q Fi denotes the marginal cost of aggregate output

D
D
D
D
D
O
D
D
D
D
D
D
and MRS F ( Q HF , Q FF ( Q FH , L F ( X H ))) ≡ ∂UF ( Q HF , Q FF )/∂Q HF /(∂UFD ( Q D
HF , Q FF ) /∂Q FF )
denotes the marginal rate of substitution in the differentiated sector in Foreign.
With two sectors, foreign production of the differentiated good for its local market,

15 For

notational convenience, we focus throughout this section on the structure of optimal trade taxes
under the normalization that domestic taxes are zero in the homogeneous sector. As mentioned above, the
difference in markups between the differentiated and homogeneous sectors implies that the optimal level
D
of domestic taxes in the differentiated sector, t̄ D
HH and s̄ HH , will no longer be zero.

31

D
D
O
QD
FF ( Q FH , L F ( X H ))), not only depends on foreign exports of the differentiated good,
D
O
QD
FH , but also on the total amount of labor allocated to the differentiated sector, L F ( X H ),
which now appears as a second argument. Given Cobb-Douglas preferences, this only
depends on Home’s net imports of the outside good. Since Foreign always spends (1 −
β F ) L F on the outside good, the amount of labor allocated to that sector must be equal to
(1 − β F ) L F − X O
H and the amount allocated to the differentiated sector must be equal to
O
O
L F minus this number, L D
F ( MH ) = β F LF + XH .
In spite of the introduction of an outside sector, the relative price of Home’s exports in
D /P D , still satisfies P D = MRS D /MRT D . Since there
the differentiated sector, P D ≡ PHF
FH
F
F
are now three aggregate goods that are traded internationally—Home’s and Foreign’s
differentiated goods as well as the homogeneous outside good—there are two relative
D , that Home can manipulate to improve its terms-of-trade both within
prices, P D and PFH
and between sectors. Mathematically, these considerations are captured by the first-order
conditions of Home’s new macro problem, which imply
D D
D
MRS D
H = MRTH P / (1 + τ ),
FO
D
MRS H
= PFH
(1 + τ O ),
FO ≡ ( ∂U /∂Q D ) / ( ∂U /∂U O ) the marginal rate of substitution for Home
with MRS H
H
H
FH
H
between Foreign’s differentiated good and the homogeneous good, and the two optimal
wedges, τ D and τO , such that

τD = −

D + zη D + ( z − 1) ζ
η HF
FH
FH
,
D
1 + η HF

(42)

τO = −

D + yzη D + ( z − 1)( yζ + ζ
zη FH
X
FH )
X
,
D
1 + yzηX + (z − 1)yζ X

(43)

D ≡ ∂ ln P D /∂ ln Q D , η D ≡ ∂ ln P D /∂ ln Q D , η D ≡ ∂ ln P D /∂ ln X O , ζ
with η HF
FH ≡
HF
FH
FH
X
H
D
D
D
O
D
D
O
D
D
D
∂ ln PFH /∂ ln Q FH , ζ X ≡ ∂ ln PFH /∂ ln X H , y ≡ PFH Q FH /X H , and z ≡ PHF Q HF /PFH Q D
FH .
D , η D , and η D , determine Home’s incentives to
The first group of price elasticities, η HF
FH
X
manipulate terms of trade within the differentiated sector, whereas the second group of
elasticities, ζ FH and ζ X , determine its incentives to manipulate terms of trade between the
differentiated sector and the homogeneous sector. When there is no inter-industry trade,
z = 1, only the first group of elasticities affects Home’s optimal wedges.16
D and ζ implicitly assume that Home is an exporter of the homogeneous good,
definitions of ηX
X
> 0. If Home is an importer of the homogeneous good, one can simply rewrite all our formulas in
D
O
terms of ∂ ln P D /∂ ln(− XO
H ) and ∂ ln PFH /∂ ln(− X H ). None of our results depend on this convention.
16 The

XO
H

32

The previous wedges, in turn, pin down the relative level of optimal trade taxes. Using
the same argument as in Section 4, one can show that
D
(1 + t̄ D
FH ) / (1 + t̄ HH )
= 1 + τD,
D
D
(1 + s̄ HF )/(1 + s̄ HH )

(44)

O
O
(1 + t̄ D
FH ) / (1 + t̄ H ) = 1 + τ .

(45)

Finally, one can check, as we do in Appendix D.1, that given the difference in markups
between the differentiated and homogeneous sectors, the domestic government would
like to use domestic taxes in order to undo the markup distortion,
D
D
(1 + t̄ D
HH ) / (1 + s̄ HH ) = 1/µ H .

When there is no active selection of firms in the differentiated sector, as in the model
with homogeneous firms of Venables (1987), Ossa (2011), and Campolmi, Fadinger and
Forlati (2014), equations (42)-(45) imply
D
(1 + t̄ D
1
FH ) / (1 + t̄ HH )
= 1+ D
,
D
D
D
(1 + s̄ HF )/(1 + s̄ HH )
(e − 1) x FF
D )( z/r D + (1 − z ) e D )
(1 − r FF
D
O
FF
(1 + t̄ FH )/(1 + t̄ H ) = 1 − D D
.
D )( σ D z/r D + (1 − z ) e D )
e (σF − 1) + (1 − r FF
F
FF

(46)
(47)

D ≡
with e D the elasticity of substitution within the differentiated sector in Foreign and x FF
D Q D / ( P D Q D + P D Q D ) and r D ≡ P D Q D / ( P D Q D + P D Q D ) the domestic exPFF
FF
FF FF
HF HF
FF
FF FF
FF FF
FH FH
penditure and revenue shares, respectively. The formal derivation can be found in Appendix D.2. From equation (46), we see that Gros’s (1987) formula, which determines the
optimal level of trade protection within the differentiated sector remains unchanged. Although the domestic government now wants to manipulate its terms-of-trade both within
O
and between sectors, the latter consideration only affects the choice of (1 + t̄ D
FH ) / (1 + t̄ H ).
According to equation (47), if Home is an exporter of the homogeneous good, z < 1,
O
then optimal taxes must be such that (1 + t̄ D
FH ) / (1 + t̄ H ) < 1. This can be achieved, for exO
ample, by subsidizing imports of the differentiated good, t̄ D
FH < 0 with t̄ H = 0, or by subO
sidizing exports of the homogeneous good, t̄ D
FH = 0 with t̄ H > 0. Intuitively, an increase
in Home’s exports of the homogeneous good creates a home-market effect: it increases
employment in the differentiated sector, β F L F + XO
H , which leads to more entry of foreign
firms in this sector and, because of love of variety, a lower price of Foreign’s differentiated
goods relative to the homogeneous good. When Home is an exporter of the homogeneous

33

good, this creates a first improvement in its terms of trade. In addition, an increase in either imports of the differentiated good or exports of the homogeneous good raises foreign
D /P D = MRS D
production of the differentiated good for its local market. Since P D ∝ PHF
FF
F
in the absence of selection, this must be accompanied by a decrease in the relative price of
Foreign’s differentiated goods relative to Home’s differentiated goods, a second improvement in Home’s terms of trade.17 When Home is a small open economy in the sense that
D = 1, it cannot manipulate entry or output abroad, which leads to zero subsidies:
r FF
O
D
(1 + t̄ D
FH ) / (1 + t̄ H ) = 1. The same is true when σF goes to infinity. In this case, the relative price of Foreign’s differentiated goods relative to the homogeneous good is fixed.
Hence, Home can only manipulate P D , which it will do optimally by setting an import
tariff or an export tax in the differentiated sector according to equation (46).
When there is active selection, equations (42)-(45) offer a strict generalization of the
results of Haaland and Venables (2014). In line with the papers cited in Section 5.3,
they assume a constant elasticity of substitution between domestic and foreign goods,
D = σ D ≡ σ D , that firms only differ in terms of their productivity, and that the
e D = σH
F
distribution of firm-level productivity is Pareto. Crucially, they also assume that Home is
small relative to Foreign in the sense that it cannot affect the number of foreign entrants,
D
NFD , nor local output, Q D
FF , in the differentiated sector. This implies ζ X = η X = 0 and
ζ FH = 1/κ D . Under this restriction, Appendix D.3 establishes that
D
(1 + t̄ D
1 + e D /κ D
FH ) / (1 + t̄ HH )
=
1
+
,
D
eD − 1
(1 + s̄ D
HF ) / (1 + s̄ HH )

(48)

O
D
(1 + t̄ D
FH ) / (1 + t̄ H ) = 1 + 1/κ .

(49)

By equation (48), the structure of optimal trade protection within the differentiated sector is again exactly the same as in the one-sector case, with firm heterogeneity lowering
trade protection if and only if there is active selection of foreign firms into exporting.18
Furthermore, by equation (49), the same aggregate nonconvexities, κ D < 0, should lead
17 If

Home is an importer of the homogeneous good, z > 1, then Home’s terms of trade unambiguously
D increase. Although a decrease in Home’s imports of the homogeneous good
improve if both P D and PHF
D , it only increases P D if Foreign’s
imports of differentiated goods necessarily increases P D and lowers PFH
HF
elasticity of substitution between domestic and foreign goods, e D , is low enough. Accordingly, Home only
D ( z − 1)).
taxes imports of the homogeneous good in this case if e D < z/(r FF
18 All formulas in this section are implicitly derived under the assumption that Home and Foreign produce in both sectors. A small open economy, however, is likely to be completely specialized in only one of
them. When Home is completely specialized in the differentiated sector, one can show that both equations
(48) and (49) must still hold. When Home is completely specialized in the outside sector, equation (49)
must again hold, but equation (48), while consistent with an optimum, is no longer necessary. Details are
available upon request.

34

to less trade protection in the differentiated sector relative to the homogeneous sector:
O
(1 + t̄ D
FH ) / (1 + t̄ H ) < 1. This reflects the fact that given aggregate nonconvexities, the imD , is a decreasing function of import volumes, Q D .
port price in the differentiated sector, PFH
FH
D
This can again be achieved by subsidizing imports of the differentiated good, t̄ FH < 0
D
O
with t̄O
H = 0, or by subsidizing exports of the homogeneous good, t̄ FH = 0 with t̄ H > 0,
an expression of Lerner symmetry.

6.3

Terms-of-Trade Manipulation and Optimal Trade Policy Redux

The existing literature on optimal trade policy under monopolistic competition draws a
sharp distinction between models with only intra-industry trade, like the one studied
by Gros (1987), and models with both intra- and inter-industry, like the one studied by
Venables (1987). In the former class of models, the standard view, as put forward by
Helpman and Krugman (1989), is that terms-of-trade manipulation can be thought of as
the rationale behind optimal trade policy since a strategic country can affect its relative
wage. In the latter class of models, however, the standard view would be that such termsof-trade motives are absent whenever the existence of an outside good pins down relative
wages between countries, and accordingly, that the rationale behind trade policy must lie
somewhere else, like the existence of so-called home-market effects.
Our analysis offers a different perspective, one suggesting that the terms-of-trade motive has greater scope than previously recognized. According to this view, imperfect competition and firm heterogeneity matter for the design of macro-level trade taxes, but only
to the extent that they affect terms-of-trade elasticities. In the simple example of Section
6.2, Home’s relative wage is fixed, whereas the number of foreign entrants in the differentiated sector is free to vary. Yet, if all elasticities of world prices are zero, that is if
Home has no market power, then optimal wedges and optimal trade taxes are zero, as
can be seen from equations (42) and (43). Our analysis echoes the results of Bagwell and
Staiger (2012b,a, 2015) who argue that terms-of-trade externalities remain the sole motive
for international trade agreements under various market structures.
The importance of the terms-of-trade motive in our analysis clearly depends on the
availability of a full set of domestic instruments. In the presence of domestic distortions,
trade policy can also be used as a second-best instrument, which means that if one were to
restrict the set of domestic taxes, such considerations would also affect the level optimal
trade taxes, as in Flam and Helpman (1987). This is true regardless of whether markets
are perfectly or monopolistically competitive and we have little to add to this observation.
The core of the difference between the standard view and ours has a simpler origin.

35

We define terms-of-trade manipulation at the macro-level as the manipulation of the relative price of sector-level aggregate prices, not the manipulation of relative wages. In the
one-sector case studied by Gros (1987), the two definitions coincide, but not otherwise.
While one may view the previous distinction as semantic, this does not mean that it is either irrelevant or trivial. Part of the reason why one builds theory is to develop a common
language that can be applied under seemingly different circumstances. The perspective
pushed forward in this paper is that within the class of models that we consider, international trade remains another transformation activity that turns aggregate exports into
aggregate imports, as summarized by the trade balance condition in (41), the shape of
which determines the structure of optimal trade policy at the macro-level.

7

Concluding Remarks

In this paper, we have characterized optimal trade policy in a generalized version of the
trade model with monopolistic competition and firm-level heterogeneity developed by
Melitz (2003). We have organized our analysis around two polar assumptions about the
set of available policy instruments. In our baseline environment, ad-valorem taxes are
unrestricted so that governments are free to impose different taxes on different firms. In
our extensions, ad-valorem taxes are uniform so that governments cannot discriminate
between firms from the same country.
When ad-valorem taxes are unrestricted, we have shown that optimal trade policy
requires micro-level policies. Specifically, a welfare-maximizing government should impose firm-level import taxes that discriminate against the most profitable foreign exporters. In contrast, export taxes that discriminate against or in favor of the most profitable domestic exporters can be dispensed with. When taxes are uniform, we have shown
that the selection of heterogeneous firms into exporting tends to create aggregate nonconvexities that lowers the overall level of trade protection. Under both assumptions, we
have highlighted the central role that terms-of-trade manipulation plays in determining
the structure of optimal trade taxes at the macro-level, thereby offering a unifying perspective on previous results about trade policy under monopolistic competition.
We conclude by pointing out three limitations of the present analysis that could be
relaxed in future research. The first one is the assumption that all firms charge a constant markup. In general, a government that manipulates its terms-of-trade may do so
by imposing different taxes on different firms and incentivize them to charge different
markups. In practice, we know that firms of different sizes tend to have different markups
and different pass-through rates; see e.g. Berman, Martin and Mayer (2012), Goldberg,
36

Loecker, Khandelwal and Pavcnik (2015), and Amiti, Itskhoki and Konings (2015). While
this channel is not directly related to the selection of heterogeneous firms into exporting,
this is another potentially important mechanism through which firm heterogeneity may
affect the design of optimal trade policy.
The second limitation is that fixed exporting costs are assumed to be paid in the exporting country. This implies that all trade is trade in goods. If fixed costs were paid
in the importing country, trade would also include trade in services, and manipulating
the prices of such services would also be part of the objective of a welfare-maximizing
government. More generally, our analysis abstracts from intermediate goods and global
supply chains, which is another exciting area for future research on optimal trade policy;
see Blanchard, Bown and Johnson (2015) for a first step in this direction.
The final limitation is that governments have access to a full set of tax instruments.
As discussed in the previous section, when domestic instruments are restricted, trade
policy would be called for not only to improve a country’s terms of trade, but also to
help in mitigating domestic distortions. We know little about the implications of trade
models with firm heterogeneity for the design of optimal industrial policy. They may be
particularly relevant in economies where credit markets are imperfect. In short, much
remains to be done on the normative side of the literature.

37

References
Amiti, Mary, Oleg Itskhoki, and Jozef Konings, “International Shocks and Domestic
Prices: How Large Are Strategic Complementarities?,” mimeo Princeton University, 2015.
Anderson, James E. and Eric Van Wincoop, “Gravity with Gravitas: A Solution to the
Border Puzzle,” The American Economic Review, 2003, 93 (1), 170–192.
Arkolakis, Costas, Arnaud Costinot, and Andres Rodríguez-Clare, “New Trade Models,
Same Old Gains?,” American Economic Review, 2012, 102 (1), 94–130.
Bagwell, Kyle and Robert W. Staiger, “The economics of trade agreements in the linear
Cournot delocation model,” Journal of International Economics, 2012, 88, 32–46.
and , “Profit shifting and trade agreements in imperfectly competitive markets,”
International Economic Review, 2012, 53 (4), 1067–1104.
and , “Delocation and trade agreements in imperfectly competitive markets,” Research in Economics, 2015, 69, 132–156.
and Seung Lee, “Trade policy under monopolistic competition with firm selection,”
mimeo Stanford, 2015.
Baldwin, Robert E., “Equilibrium in International Trade: A Diagrammatic Approach,”
Quarterly Journal of Economics, 1948, 62 (5), 748–762.
Berman, Nicolas, Philippe Martin, and Thierry Mayer, “How do different exporters
react to exchange rate changes?,” Quarterly Journal of Economics, 2012, 127 (1), 437–492.
Bhagwati, Jagdish N., The Generalized Theory of Distortions and Welfare, Vol. Trade, Balance
of Payments, and Growth: Papers in International Economics in Honor of Charles P.
Kindleberger, Amsterdam: North-Holland, 1971.
Blanchard, Emily J., Chad P. Bown, and Robert C. Johnson, “Global Supply Chains and
Trade Policy,” mimeo Dartmouth, 2015.
Bond, Eric W, “The Optimal Tariff Structure in Higher Dimensions,” International Economic Review, February 1990, 31 (1), 103–16.
Campolmi, Alessia, Harald Fadinger, and Chiara Forlati, “Trade Policy: Home Market
Effect versus Terms-of-Trade Externality,” Journal of Intermational Economics, 2014, 93
(1), 92–107.
38

Costinot, Arnaud, Dave Donaldson, Jonathan Vogel, and Ivan Werning, “Comparative
Advantage and Optimal Trade Policy,” Quarterly Journal of Economics, 2015, 130 (2), 659–
702.
, Guido Lorenzoni, and Ivan Werning, “A Theory of Capital Controls as Dynamic
Terms-of-Trade Manipulation,” Journal of Political Economy, 2014, 122 (1), 77–128.
Demidova, Svetlana, “Trade Policies, Firm Heterogeneity, and Variable Markups,” mimeo
McMaster University, 2015.
and Andres Rodríguez-Clare, “Trade policy under firm-level heterogeneity in a small
economy,” Journal of International Economics, 2009, 78 (1), 100–112.
Dhingra, Swati and John Morrow, “The Impact of Integration on Productivity and Welfare Distortions Under Monopolistic Competition,” mimeo, LSE, 2012.
Dixit, Avinash, “Tax policy in open economies,” in A. J. Auerbach and M. Feldstein,
eds., Handbook of Public Economics, Vol. 1 of Handbook of Public Economics, Elsevier, 1985,
chapter 6, pp. 313–374.
Dixit, Avinash K. and Joseph E. Stiglitz, “Monopolistic Competition and Optimum
Product Diversity,” The American Economic Review, 1977, 67 (3), 297–308.
Eaton, Jonathan and Samuel Kortum, “Technology, Geography and Trade,” Econometrica,
2002, 70 (5), 1741–1779.
Everett, Hugh, “Generalized Lagrange Multiplier Methods for Solving Problems of Optimal Allocation of Resources,” Operations Research, 1963, 11 (3), 399–417.
Feenstra, Robert C., “Measuring the Gains from Trade under Monopolistic Competition,”
Canadian Journal of Economics, 2010, pp. 1–28.
Felbermayr, Gabriel J., Benjamin Jung, and Mario Larch, “Optimal Tariffs, Retaliation
and the Welfare Loss from Tariff Wars in the Melitz Model,” Journal of Intermational
Economics, 2013, 89 (1), 13–25.
Flam, Harry and Elhanan Helpman, “Industrial Policy under Monopolistic Competition,” Journal of International Economics, 1987, 22 (79-102).
Goldberg, Pinelopi, Jan De Loecker, Amit Khandelwal, and Nina Pavcnik, “Prices,
Markups and Trade Reform,” forthcoming, Econometrica, 2015.

39

Gopinath, Gita, Elhanan Helpman, and Kenneth Rogoff, eds, Handbook of International
Economics, Vol. 4, Elsevier, 2014.
Gros, Daniel, “A Note on the Optimal Tariff, Retaliation and the Welfare Loss from Tariff
Wars in a Framework with Intra-Industry Trade,” Journal of Intermational Economics,
1987, 23, 357–367.
Haaland, Jan I. and Anthony J. Venables, “Optimal Trade Policy with Monopolistic
Competition and Heterogeneous Firms,” mimeo University of Oxford, 2014.
Helpman, Elhanan and Paul Krugman, Market Structure and Foreign Trade: Increasing Returns, Imperfect Competition, and the International Economy, Cambridge, Massachusetts:
MIT Press, 1985.
and Paul R. Krugman, Trade Policy and Market Structure, Cambridge, Massachussetts:
MIT Press, 1989.
Krugman, Paul, “Scale Economies, Product Differentiation, and the Pattern of Trade,”
The American Economic Review, 1980, 70 (5), 950–959.
Luenberger, David G., Optimization by Vector Space Methods, John Wiley and Sons, Inc,
1969.
Maggi, Giovanni, International Trade Agreements, Vol. 4 of Handbook of International Economics, Elsevier, 2014.
Melitz, Marc and Stephen Redding, Heterogeneous Firms and Trade, Vol. 4 of Handbook of
International Economics, Elsevier, 2014.
Melitz, Marc J., “The Impact of Trade on Intra-Industry Reallocations and Aggregate
Industry Productivity,” Econometrica, 2003, 71 (6), 1695–1725.
and Gianmarco I. P. Ottaviano, “Market Size, Trade, and Productivity,” The Review of
Economic Studies, 2008, 75 (1), 295–316.
Ossa, Ralph, “A "New Trade" Theory of GATT/WTO Negotiations,” Journal of Political
Economy, 2011, 119 (1), 112–152.
Sydsaeter, Knut, “Letter to the editor on some frequently occuring errors in the economic
literature concerning problems of maxima and minima,” Journal of Economic Theory,
1974, 9 (464-466).

40

Venables, Anthony J., “Trade and trade policy with differentiated products:
Chamberlinian-Ricardian model,” Economic Journal, 1987, 97 (700-717).

41

A

A

Proofs of Section 3

A.1

Existence and Uniqueness of the Solution to the Lagrangian Problem (Section 3.1)

Let us first rewrite equation (11) as
ˆ
1=

H
(µ H a Hj ( ϕ)/λ Hj )1−σH dGH ( ϕ)]1/(1−σH ) Q1/σ
Hj .

∗
NH
[

(A.1)

ΦHj

Since σH > 1, the integrand (µ H a Hj ( ϕ)/λ Hj )1−σH is increasing in λ Hj . In addition, the set over
which we integrate Φ Hj is increasing in λ Hj . Thus, the right-hand side of equation (A.1) is continuous and strictly decreasing in λ Hj . One can check that it has limits equal to zero and infinity
when λ Hj goes to zero and infinity, respectively. By the Intermediate Value Theorem, there exists
∗ ) that satisfies (A.1) given N ∗ . Furthermore λ ( N ∗ ) must be strictly
therefore a unique λ Hj ( NH
Hj
H
H
∗ goes to zero and infinity, respectively.
increasing with limits equal to zero and infinity when NH

Now let us turn to equation (12). Using our previous results, we can rewrite this expression as

`∗H (λ∗HH ( NH∗ ), λ∗HF ( NH∗ )) = 0,

(A.2)

with `∗H such that

`∗H (λ HH , λ HF )

=

∑

j= H,F

ˆ



min l Hj (q̃( ϕ), ϕ) − λ Hj (q̃( ϕ))1/µ H dGH ( ϕ) + f He .
q̃

`∗H is continuous and strictly decreasing in λ Hj . One can also check that it has limits equal to f He
and minus infinity when λ Hj goes to zero and infinity, respectively. By the Intermediate Value
∗ that satisfies (A.2). Together the previous results
Theorem, there exists therefore a unique NH
imply the existence and uniqueness of (q∗H H , q∗H F , N ∗ ) that minimizes L H .

A.2

Existence and Uniqueness of the Solution to the Constrained Problem (Section 3.1)

By the Lagrangian Sufficiency Theorem, e.g. Theorem 1, p. 220 in Luenberger (1969), we know that
∗ ) that minimizes L , then ( q∗ , q∗ , N ∗ ) is also a solution to the origif there exists (q∗H H , q∗H F , NH
H
HH
HF
H

inal constrained minimization problem (9). This establishes existence. We now demonstrate that
if such a solution exists, then any solution to the constrained problem (9) also minimizes L H . Con∗ ) that minimizes L . Since ( q∗ , q∗ , N ∗ )
sider (q H H , q H F , N ) that solves (9) and (q∗H H , q∗H F , NH
H
HH
HF
H

42

satisfies (9b) for j = H, F, we must have
N[

ˆ

∑

j= H,F

Φ

l Hj (q Hj ( ϕ), ϕ)dGH ( ϕ) +

f He ]

≤

∗
NH
[

∑

ˆ

j= H,F

Φ

l Hj (q∗Hj ( ϕ), ϕ)dGH ( ϕ) + f He ].

Since (q HH , q HF , N ) satisfies (9b) j = H, F, we must also have

−

∑

j= H,F

ˆ
λ Hj [

1/µ

Φ

N (q Hj ( ϕ))1/µ H dGH ( ϕ) − Q Hj H ] = −

∑

j= H,F

ˆ
λ Hj [

1/µ

Φ

∗ ∗
NH
(q Hj ( ϕ))1/µ H dGH ( ϕ) − Q Hj H ].

The two previous inequalities imply that (q HH , q HF , N ) minimizes L H . Since the set of minimizers
of L H is a singleton, as established in Appendix A.1, the solution to the constrained problem (9)
must be unique as well.

A.3

Measure of Foreign Entrants and Export Price (Section 3.3)

Let UiF ≡ ∂UF ( Q HF , Q FF )/∂QiF denote the marginal utility abroad of the aggregate good from
country i = H, F. Condition (1) for i = F and j = F and conditions (2)-(A.6) for i = F imply
UHF /UFF = PHF /PFF ,
ˆ
1−σF
PFF =
NF (µ F a FF ( ϕ))1−σF dGF ( ϕ),
Φ FF
ˆ
f Fe = PFF Q FF /NF −
l FF ((µ F a FF ( ϕ)/PFF )−σF Q FF , ϕ)dGF ( ϕ)
Φ FF
ˆ
+ PFH ( Q FH , NF ) Q FH /NF −
l FH (q∗FH ( ϕ), ϕ)dGF ( ϕ),
Φ

L F = PFF Q FF + PFH ( Q FH , NF ) Q FH

(A.3)
(A.4)

(A.5)
(A.6)

with Φ FF ≡ { ϕ : (µ F − 1) a FF ( ϕ)(µ F a FF ( ϕ)/PFF )−σF Q FF ≥ f FF ( ϕ)} and q∗FH ( ϕ) determined by
equations (15) and (16). Equations (A.3)-(A.6) provide a system of 4 equations with 6 unknowns:
Q FF , Q HF , Q FH , PFF , PHF , and NF . We can solve for 3 of these variables, Q FF , PFF , and NF as a
function of Q FH using equations (A.4)-(A.6). Given the previous solution—Q FF ( Q FH ), PFF ( Q FH ),
and NF ( Q FH )—we can then use equation (A.3) to solve for PHF ( Q FH , Q HF ).

43

B

Proofs of Section 4

B.1

Lemma 4

Proof of Lemma 4. First, consider the marginal rate of substitution, MRS j ≡ UHj /UFj , in country
j = H, F under the first-best allocation. In Foreign, equations (A.3) and (A.4) imply
∗
PHF
.
MRSF = ´
( ΦFF NF∗ (µ F a FF ( ϕ))1−σF dGF ( ϕ))1/(1−σF )

(B.1)

At home, we already know from equation (21) that
∗
∗
MRS H = MRTH PHF
/((1 + τ ∗ ) PFH
).

By the Envelope Theorem, we also know that
MRTH = (λ HH /λ HF )( Q HH /Q HF )−1/σH .
After substituting for the Lagrange multipliers using equation (11), this implies
´

1−σH dG ( ϕ ))1/(1−σH )
H
Φ ( a HH ( ϕ ))
MRTH = ´ HH
,
( Φ HF ( a HF ( ϕ))1−σH dGH ( ϕ))1/(1−σH )

(

and in turn,
MRS H =

´

1−σH dG ( ϕ ))1/(1−σH ) P∗
H
HF
Φ HH ( a HH ( ϕ ))
´
.
1/
(
1
−
σ
1
−
σ
∗
H ) P∗
(1 + τ )( Φ HF ( a HF ( ϕ)) H dGH ( ϕ))
FH

(

(B.2)

(B.3)

Next, consider a decentralized equilibrium with taxes that implements the first-best allocation.
The same marginal rate of substitution for the two countries are determined by equations (4)-(2).
Using the fact that the set of varieties available for consumption in the decentralized equilibrium
must be the same as in the first-best allocation, we obtain
MRSF =
MRS H =

(
(

´
Φ HF

´
Φ HH

∗ (µ w a
∗
1−σH dG ( ϕ ))1/(1−σH )
NH
H H HF ( ϕ ) / (1 + s HF ( ϕ )))
H
´
,
∗
1/
(
1
−
σF )
1
−
σ
( ΦFF NF (µ F a FF ( ϕ)) F dGF ( ϕ))

(B.4)

∗ ((1 + t∗ ( ϕ )) µ w a
∗
1−σH dG ( ϕ ))1/(1−σH )
NH
H H HH ( ϕ ) / (1 + s HH ( ϕ )))
H
HH
´
.
∗
∗
1/
(
1
−
σF )
1
−
σ
F
( ΦFH NF ((1 + t FH ( ϕ))µ F a FH ( ϕ))
dGF ( ϕ))

(B.5)

Combining equations (B.1)-(B.5) with the micro-level taxes in Lemmas 1-3, we get
∗
(1 + t∗FH )/(1 + t∗HH )
(1 + τ ∗ ) PFH
´
=
.
(1 + s∗HF )/(1 + s∗HH )
( ΦFH NF∗ (min {1, θ FH ( ϕ)} µ F a FH ( ϕ))1−σF dGF ( ϕ))1/(1−σF )

44

(B.6)

By definition of PFH (·, ·), we know that
ˆ
∗
PFH
Q∗FH

=
Φ

NF∗ µ F a FH ( ϕ)q∗FH ( ϕ)dGF ( ϕ).

Together with equation (15), this implies
´

∗
PFH

( NF∗ )1/(1−σF ) µ F

ΦuFH

=

( a FH ( ϕ))1−σF dGF ( ϕ) +

´
ΦcFH

(θ FH ( ϕ))µF a FH ( ϕ)

1−σF

dGF ( ϕ)

(µ2F /λ FH )σF ( NF∗ )σF /(1−σF )

.

Using equations (15) and (16), one can also check that

(µ2F /λ FH )σF −1
=
NF∗

ˆ

ˆ
ΦuFH

( a FH ( ϕ))

1−σF

dGF ( ϕ) +

ΦcFH

(θ FH ( ϕ) a FH ( ϕ))1−σF dGF ( ϕ).

Combining the two previous expressions, we then obtain
∗
PFH

( NF∗ )1/(1−σF ) µ F

´

= ´

1−σF
´
dGF ( ϕ)
( a FH ( ϕ))1−σF dGF ( ϕ) + Φc (θ FH ( ϕ))µF a FH ( ϕ)
FH
σF /(σF −1) .
´
( a FH ( ϕ))1−σF dGF ( ϕ) + Φc (θ FH ( ϕ) a FH ( ϕ))1−σF dGF ( ϕ)

ΦuFH
ΦuFH

FH

Substituting into equation (B.6) and using the definition of ΦuFH and ΦcFH we get equation (26).

B.2

Lemma 5

Proof of Lemma 5. We follow a guess and verify strategy. Consider: (i ) quantities such that
qij ( ϕ) = qij∗ ( ϕ),

(B.7)

Qij = Qij∗ ,

(B.8)

where q∗HH ( ϕ), q∗HF ( ϕ), and q∗FH ( ϕ) are given by equations (10) and (15) and q∗FF ( ϕ) is given by

q̄ ( ϕ)
FF
q∗FF ( ϕ) =
0

, if (µ F − 1) a FF ( ϕ)q̄ FF ( ϕ) ≥ f FF ( ϕ),

(B.9)

, otherwise;

(ii ) measures of entrants such that
Ni = Ni∗ for all i;

(B.10)

∗
w H = PHF
/µ H L HF ,

(B.11)

w F = 1;

(B.12)

(iii ) wages such that

45

(iv) goods prices such that

 p̄ ( ϕ)
ij
pij ( ϕ) =
∞

(B.13)

, otherwise,

ˆ

and
1− σ
Pji j

, if (µi − 1) aij ( ϕ)qij ( ϕ) ≥ f ij ( ϕ),

=
Φ

Nj [(1 + t ji ( ϕ)) p ji ( ϕ)]1−σj dGj ( ϕ);

(B.14)

and (v) taxes and a lump-sum transfer such that
s HF ( ϕ) = s HH ( ϕ) = t HH ( ϕ) = 0, for all ϕ,

(B.15)

t FH ( ϕ) = t∗FH ( ϕ), if ϕ ∈ Φ FH ,

(B.16)

t FH ( ϕ) ≥ t∗FH , otherwise,

(B.17)

and
TH =

∑ j= H,F [

ˆ

ˆ
Φ

Nj t jH ( ϕ) p jH ( ϕ)q jH ( ϕ)dGj ( ϕ) −

Φ

NH s Hj ( ϕ) p Hj ( ϕ)q Hj ( ϕ)dGH ( ϕ)],

(B.18)

where t∗FH ( ϕ) is given by equation (25).
We now check that the previous allocation and prices satisfy the equilibrium conditions (1)-(7).
First, consider conditions (2), (4), and (7). Since they are equivalent to equations (B.13), (B.14),
and (B.18), they are trivially satisfied by construction.
Second, consider condition (1). For goods locally sold by foreign firms, equations (A.4), (B.9),
(B.10), and (B.14) imply
∗
PFF = PFF
.

(B.19)

By equations (B.9) and (B.19), condition (1) must therefore hold for goods locally sold by foreign
firms. Now consider goods exported by home firms. Given equations (B.7), (B.11), (B.13), and
(B.15), condition (1) also holds for these goods if
∗
(µ H a HF ( ϕ)/λ HF )−σH = [ PHF
a HF ( ϕ)/( L HF PHF )]−σH Q HF .

(B.20)

Using the same argument as in Section 3.3, one can show that
1/σH
L HF = λ HF Q−
/µ H ,
HF
ˆ
∗
H
λ HF = [ NH
(µ H a HF ( ϕ))1−σH dGH ( ϕ)]1/(1−σH ) Q1/σ
HF ,
ΦHF

46

(B.21)

which imply

ˆ
∗
L HF = [ NH

(µ H a HF ( ϕ))1−σH dGH ( ϕ)]1/(1−σH ) .

(B.22)

ΦHF

By equations (B.10), (B.11), (B.13), (B.15), and (B.14), we know that
1−σH
∗ 1−σH
= ( PHF
)
PHF

ˆ
Φ HF

∗
NH
[ a HF ( ϕ)/L HF ]1−σH dGH ( ϕ).

Combining this expression with equation (B.22), we obtain
∗
PHF = PHF
.

(B.23)

By equations (B.21) and (B.23), condition (B.20) must hold, which establishes that condition (1)
also for goods exported by home firms.
We can use a similar logic to analyze micro-level quantities at home. Given equations (B.7),
(B.11), (B.13), and (B.15), condition (1) holds for goods locally sold by home firms if
∗
(µ H a HH ( ϕ)/λ HH )−σH = ( PHF
a HH ( ϕ)/( L HF PHH ))−σH Q HH ,

(B.24)

Using the same argument as in Section 3.3, one can also show that
1/σH
L HH = λ HH Q−
/µ H .
HH

Hence, condition (B.24) is equivalent to
∗
PHF
/PHH = L HF /L HH ,

(B.25)

which equations (B.2), (B.13), (B.14), and (B.23) guarantee. So, condition (1) holds for goods locally
sold by home firms. Lastly, consider goods exported by foreign firms. Given equations (B.7),
(B.12), (B.13), (B.16), and (B.17), condition (1) holds if

(µ2F a FH ( ϕ)/λ FH )−σF = [(1 + t∗FH )µ F a FH ( ϕ)/PFH ]−σF , if ϕ ∈ ΦuFH ,
f FH ( ϕ)/((µ F − 1) a FH ( ϕ)) = [(1 + t∗FH )θ FH ( ϕ)µ F a FH ( ϕ)/PFH ]−σF Q FH , if ϕ ∈ ΦcFH ,
Given the definitions of θ FH ( ϕ), both conditions reduce to
λ FH /µ F = PFH /(1 + t∗FH ).

(B.26)

Using equations (15) and (16), one can use the same strategy as in the proof of Lemma 4 to show

47

that
ˆ
λ FH /µ F = [
ˆ

ΦuFH

+
ΦcFH

NF∗ µ F ( a FH ( ϕ))1−σF dGF ( ϕ)

NF∗ µ F (θ FH ( ϕ) a FH ( ϕ))1−σF dGF ( ϕ)]1/(1−σF ) .

Together with equation (B.14), this expression leads to equation (B.26). Hence, condition (1) must
also hold for goods exported by foreign firms.
Third, consider the free entry condition (5). Abroad, equations (A.5) and (B.7) imply
∗
PFF
Q∗FF /NF∗

+

∗
PFH
Q∗FH /NF∗

− ∑ j= H,F

ˆ
Φ

l Fj (q Fj ( ϕ), ϕ)dGF ( ϕ) = f Fe .

(B.27)

For foreign goods that are locally sold, equations (B.8), (B.9), (B.10), (B.12), (B.13), and (B.14) imply
ˆ
∗
PFF
Q∗FF /NF∗ =

Φ

µ F a FF ( ϕ)q FF ( ϕ)dGF ( ϕ).

(B.28)

For foreign goods that are exported, the definition of PFH ( Q FH , NF ) and equations (B.7) and (B.8)
imply

ˆ
∗
PFH
Q∗FH /NF∗

=
Φ

µ F a FH ( ϕ)q FH ( ϕ)dGF ( ϕ).

(B.29)

Equations (B.27)-(B.29) lead to the free entry condition (5) abroad. At home, equations (12) and
(B.7) directly imply (5).
Fourth, consider the labor market condition (6). Abroad, this condition derives from equations
(A.6), (B.10), and (B.27). At home, the resource constraint (17c) must be binding at the first-best
allocation,
L H ( Q∗HH , Q∗HF ) = L H .

(B.30)

Condition (6) then derives from the definition of L H ( Q HH , Q HF ) and equations (B.7), (B.8), (B.10),
and (B.30).
Finally, consider condition (3). Abroad, we know from equations (A.3) and (A.6) that at the
first-best allocation,
∗
∗
UHF /UFF = PHF
/PFF
,
∗
∗
PFF
Q∗FF + PFH
Q∗FH = L F .

Thus equation (B.12), (B.8), (B.19), and (B.23) imply that condition (3) holds abroad. At Home, we
know from equations (18)-(20) that at the first-best allocation
∗
∗
UFH /UHH = (1 + τ ∗ )( L HF PFH
/L HH PHF
),

48

(B.31)

Equations (B.25) and (B.31) imply
∗
UFH /UHH = (1 + τ ∗ )( PFH
/PHH ).
∗ using equation (B.6), we then get
Substituting for (1 + τ ∗ ) PFH

UFH /UHH = PFH /PHH .

(B.32)

At the first-best allocation, we also know that constraint (17b) must be binding, which implies
∗
∗
PFH
Q∗FH = PHF
Q∗HF ,

and in turn, using equation (B.8),
∗
∗
PHH Q HH + PFH
Q FH = PHH Q HH + PHF
Q HF .

(B.33)

Since conditions (1) and (4) hold for goods sold by home firms at home and abroad, we know that
ˆ
PHj Q Hj = NH

Φ

p Hj ( ϕ)q Hj ( ϕ)dGH ( ϕ).

Combining this observation with equations (B.13), (B.15), and (B.23), we get
ˆ
PHH Q HH +

∗
PHF
Q HF

= NH w H ( µ H a HH ( ϕ)q HH ( ϕ)dGH ( ϕ)
Φ
ˆ
+
µ H a HF ( ϕ)q HF ( ϕ)dGH ( ϕ)).
Φ

Since condition (5) holds at home, this can be rearranged as
PHH Q HH +

∗
PHF
Q HF

= NH w H (∑ j= H,F

ˆ
Φ

l Hj (q Hj ( ϕ), ϕ)dGH ( ϕ) + f He ).

Since condition (6) also holds, we then get
∗
PHH Q HH + PHF
Q HF = w H L H .

Combining this expression with equation (B.33), we obtain
∗
PHH Q HH + PFH
Q FH = w H L H .

Since conditions (1) and (4) hold for goods sold by foreign firms at home, we must have
ˆ
PFH Q FH = NF

Φ

p FH ( ϕ)q FH ( ϕ)dGH ( ϕ),

49

(B.34)

which, using equations (B.13), (B.17), and (B.35), leads to
ˆ
PFH Q FH = NF

Φ

µ F (1 + t∗HF ( ϕ)) a FH ( ϕ)q FH ( ϕ)dGH ( ϕ).

(B.35)

From equations (B.8), (B.10) and (B.29), we also know that
ˆ
∗
PFH
Q FH

= NF

Φ

µ F a FH ( ϕ)q FH ( ϕ)dGF ( ϕ).

(B.36)

Combining equation (B.18) with equations (B.34), (B.35), and (B.36), we finally obtain
PHH Q HH + PFH Q FH = w H L H + TH .

(B.37)

Condition (3) at home derives from equations (B.32) and (B.37).

C

Proofs of Section 5

C.1

Lemma 6

Proof of Lemma 6. Take Home’s aggregate exports and imports, Q HF and Q FH , as given. Like in
Section 3.3, let Q FF ( Q FH ), PFF ( Q FH ), PHF ( Q HF , Q FH ), and NF ( Q FH ) denote the equilibrium values
of Q FF , PFF , PHF , and NF , respectively, conditional on Q HF and Q FH .
As already established in Section 3.3, utility maximization implies equation (31). To establish
equations (32) and (33), we can follow the same steps as in Section 3.1. Any solution to (30) must
be such that the optimal quantity of good ϕ produced for country j = H, F satisfies
(
q∗Fj ( ϕ)

=

(µ F a Fj ( ϕ)/λ Fj )−σF ,
0,

if ϕ ∈ ΦFj ,
otherwise,

(C.1)

with the set of varieties with non-zero output such that
ΦFj = { ϕ : µ F a Fj ( ϕ)(µ F a Fj ( ϕ)/λ Fj )−σF ≥ l Fj ((µ F a Fj ( ϕ)/λ Fj )−σF , ϕ)},
and the Lagrange multiplier associated with (30b) such that
ˆ
λ Fj =

F
(µ F a Fj ( ϕ))1−σF dGF ( ϕ)]1/(1−σF ) Q1/σ
Fj .

[ NF∗

(C.2)

ΦFj

Any solution to (30) must also be such that the optimal number of entrants, NF∗ , satisfies

∑

j= H,F

ˆ
Φ Fj

[µ F a Fj ( ϕ)q∗Fj ( ϕ) − l Fj (q∗Fj ( ϕ), ϕ)]dGF ( ϕ) = f Fe .

50

(C.3)

Like in Section 3.1, the comparison of equations (1), (4), (2), and (5), on the one hand, and equations
(C.1), (11), and (C.3), on the other hand, imply that the outputs of foreign varieties and the measure
of foreign entrants in the decentralized equilibrium, conditional on Q FH and Q HF , must coincide
with the solution of (30), conditional on Q FH and Q FF = Q FF ( Q FH ). Since the outputs of foreign
varieties and the measure of foreign entrants satisfy (6), we must therefore have
L F ( Q FH , Q FF ( Q FH )) = L F ,
which establishes equation (33). To conclude, note that by the Envelope Theorem, we must have
1/σF
∂L F ( Q FH , Q FF )/∂Q Fj = λ Fj Q−
/µ F .
Fj

(C.4)

Conditional on Q FH and Q FF = Q FF ( Q FH ), equations (A.4) and (C.2) further imply that
λ FF = PFF ( Q HF , Q FH )( Q FF ( Q FH ))1/σF .

(C.5)

Similarly, equations (28) and (C.2) imply that
F
λ FH = PFH ( Q FH , NF ( Q FH )) Q1/σ
FH .

(C.6)

Equation (32) follows from equations (C.4)-(C.6).

C.2

Marginal Rate of Transformation is Homogeneous of Degree Zero
(Section 5.2)

In Section 5.2, we have argued that MRTF ( Q FH , Q FF ) is homogeneous of degree zero. We now
establish this result formally. In the proof of Lemma 6, we have already shown that the solution
of (30) satisfies equations (C.1), (C.2), and (C.3). Combining these three conditions, one can check
that the measure of foreign firms is such that
NF∗ ( Q FH , Q FF ) = ( MF∗ ( Q FH , Q FF ))1/µF ,
with MF∗ ( Q FH , Q FF ) implicitly given by the solution to
MF =

∑ j= H,F Q Fj AFj ( MF /Q Fj )
h
i,
(σF − 1) f Fe + ∑ j= H,F FFj ( MF /Q Fj )

51

(C.7)

with
ˆ

a1Fj−σF ( ϕ)dGF ( ϕ))1/(1−σF ) ,

AFj ( MF /Q Fj ) ≡ (
ΦFj ( MF /Q Fj )

ˆ
FFj ( MF /Q Fj ) ≡

f Fj ( ϕ)dGF ( ϕ)),

(C.8)
(C.9)

ΦFj ( MF /Q Fj )

and
ΦFj ( MF /Q Fj ) ≡ { ϕ :

a1Fj−σF ( ϕ)

f Fj ( ϕ) MF
≥
(
µ F − 1 Q Fj

ˆ
ΦFj ( MF /Q Fj )

a1Fj−σF ( ϕ)dGF ( ϕ))µF }.

(C.10)

From equation (32), we know that
´

1−σF dG ( ϕ )]1/(1−σF )
F
Φ ( a FH ( ϕ ))
.
MRTF ( Q FH , Q FF ) = ´ FH
1
−
σ
[ ΦFF ( a FF ( ϕ)) F dGF ( ϕ)]1/(1−σF )

[

Using the notation above, this can be rearranged as
MRTF ( Q FH , Q FF ) =

AFH ( MF∗ ( Q FH , Q FF )/Q FH )
.
AFF ( MF∗ ( Q FH , Q FF )/Q FF )

By equation (C.7), MF∗ ( Q FH , Q FF ) is homogeneous of degree one. Together with the previous
expression, this implies that MRTF ( Q FH , Q FF ) is homogeneous of degree zero.

C.3

Marginal Rate of Transformation in the Pareto Case (Section 5.3)

In Section 5.3, we have argued that under the assumptions that (i ) firms only differ in terms of
their productivity, f ij ( ϕ) = f ij , (ii ) the distribution of firm-level productivity is Pareto, aij ( ϕ) =
τij /ϕ with GF ( ϕ) = 1 − (bF /ϕ)νF for all ϕ ≥ bF , and (iii ) there is active selection of Foreign firms
in both the Foreign and Home markets, then the elasticity of transformation, κ ∗ , satisfies equation
(40). We now establish this result formally.
The same arguments as in the proof of Lemma 6 imply
MRTF ( Q FH , Q FF ) =

1/σF
(λ FH Q−
/µ F )
FH
1/σF
(λ FF Q−
/µ F )
FF

with the Lagrange multipliers such that
ˆ
λ Fj =

F
(µ F a Fj ( ϕ))1−σF dGF ( ϕ)]1/(1−σF ) Q1/σ
Fj

[ NF∗
ΦFj

52

(C.11)

and the set of imported varieties such that
ΦFj = { ϕ : µ F a Fj ( ϕ)(µ F a Fj ( ϕ)/λ Fj )−σF ≥ l Fj ((µ F a Fj ( ϕ)/λ Fj )−σF , ϕ)}.
Under assumption (i ), the set of imported varieties must be such that ΦFj = { ϕ ≥ ϕ∗Fj }, with the
productivity cut-off such that

(µ F − 1)(τFj /ϕ∗Fj )1−σF (µ F /λ Fj )−σF = f Fj ,

(C.12)

while assumptions (ii ) and (iii ) imply that ϕ∗Fj ≥ bF and that the Lagrange multiplier must be
ˆ

such that
λ Fj =

[ NF∗ νF (bF )νF

ϕ∗Fj

F
(µ F τFj /ϕ)1−σF ϕ−νF −1 dϕ]1/(1−σF ) Q1/σ
Fj .

(C.13)

Equations (C.11) and (C.13) imply

(

´

ϕ∗FH ( τFH /ϕ )

1−σF ϕ−νF −1 dϕ )1/(1−σF )

,
MRTF ( Q FH , Q FF ) = ´
( ϕ∗ (τFF /ϕ)1−σF ϕ−νF −1 dϕ)1/(1−σF )

(C.14)

FF

whereas equations (C.12) and (C.13) imply
1/(1−σ )

ϕ∗Fj

F
τFj ( f Fj /(µ F − 1))1/(σF−1 ) Q Fj
´
=
.
[ NF∗ νF (bF )νF ϕ∗ (τFj /ϕ)1−σF ϕ−θF −1 dϕ]σF /((σF −1)(1−σF ))
Fj

We can use the last expression to solve for ϕ∗Fj . We obtain
(σ −1)/((σF −1)−νF σF )

ϕ∗Fj

=

τFj F

(σ −1)//((σF −1)−νF σF )

( f Fj /(µ F − 1))(1−σF )/((σF −1)−νF σF ) Q FjF

,

[ NF∗ νF (bF )νF /(σF − νF − 1)]σF /((σF −1)−νF σF )

and, in turn,
νF (σF −1)
νF σF −(σF −1)

ˆ

(
ϕ∗Fj

(τFj /ϕ)1−σF ϕ−νF −1 dϕ)1/(1−σF ) =

τFj

[ NF∗ νF (bF )

( f Fj /(µ F − 1))

σF (σF −νF −1)
νF (1−σF )((σF −1)−νF σF )

]

νF −(σF −1)
νF σF −(σF −1)

νF −(σF −1)
F σF −(σF −1)

−ν

Q Fj

(σF − νF − 1)

σF −1
F σF −(σF −1)

−ν

Substituting into equation (C.14) leads to
νF (σF −1)

νF −(σF −1)

MRTF ( Q FH , Q FF ) = (τFH /τFF ) νF σF −(σF −1) ( f FH / f FF ) σF νF −(σF −1) ( Q FH /Q FF )

νF −(σF −1)
F νF −(σF −1)

−σ

For νF = ν and σF = σ, the previous expression and equation (35) imply equation (40).

53

.

.

C.4

Lemma 7

Proof of Lemma 7. In Section C.2, we have established that
MRTF ( Q FH , Q FF ) =

AFH ( MF∗ ( Q FH , Q FF )/Q FH )
.
AFF ( MF∗ ( Q FH , Q FF )/Q FF )

with MF∗ , AFH , and AFF implicitly determined by equations (C.7)-(C.10). Taking log and totally
differentiating the previous expression with respect to Q FH , we get
d ln MRTF ( Q FH , Q FF ( Q FH ))
Q M
Q
M
A
M
M
= eA
FH (−(1 − e FH ) + e F e FF ) + e FF (− e FH + e F (1 − e FF )),
d ln Q FH
with
eA
Fj =

d ln AFj ( MF /Q Fj )
≥ 0,
d ln( MF /Q Fj )

d ln Q FF ( Q FH )
< 0,
d ln Q FH
∂ ln MF∗ ( Q FH , Q FF )
=
,
∂ ln Q Fj

eQ
F =
M
eFj

where the non-negativity of eA
Fj directly follows from equations (C.8) and (C.10). In Section C.2,
we have already argued that MF∗ ( Q FF , Q FH ) is homogeneous of degree one. Thus, we must have
M + e M = 1, which leads to
e FH
FF



d ln MRTF ( Q FH , Q FF ( Q FH ))
Q
M
A M
= eA
e
+
e
e
FF FH
FH FF ( e F − 1).
d ln Q FH

(C.15)

A
M
M
M
M
Since eQ
F − 1 < 0, e Fj ≥ 0, and e FH , e FF ≥ 0 with e FH + e FF = 1, we can conclude that if selection
A
is active in at least one market, eA
FF > 0 or e FH > 0, then

d ln MRTF ( Q FH , Q FF ( Q FH ))
< 0,
d ln Q FH
which is equivalent to κ ∗ < 0 by equation (35).

C.5

Locally Convex Production Sets with Selection (Section 5.4)

The goal of this subsection is to construct an economy where: (i ) the number of entrants in Foreign
is strictly decreasing with aggregate output in one market and (ii ) Foreign’s production set is
locally convex.
Suppose that firms in Foreign differ only in terms of their productivity, aij ( ϕ) = τij /ϕ and
f ij ( ϕ) = f ij for all ϕ, and that fixed exporting costs are equal to zero, f FH = 0, whereas fixed costs
of selling domestically are not, f FF > 0. Starting from these assumptions and the characterization

54

of the solution to (30)—equations (C.1)-(C.3) in the proof of Lemma 6—we can follow the same
strategy as in Section C.2 and write MF∗ ( Q FH , Q FF ) = ( NF∗ ( Q FH , Q FF ))µF as the implicit solution of
MF =

Q FH AFH + Q FF AFF ( MF /Q FF )
,
(σF − 1) [ f Fe + FFF ( MF /Q FF )]

(C.16)

with
ˆ
AFH = τFH ( ϕσF −1 dGF ( ϕ))1/(1−σF ) ,
Φ
ˆ
AFF ( MF /Q FF ) = (
ϕσF −1 dGF ( ϕ))1/(1−σF ) ,

(C.17)

FFF ( MF /Q FF ) = f FF (1 − GF ( ϕ∗FF )),

(C.19)

ϕ∗FF

(C.18)

and the productivity cut-off for foreign firms in their domestic market such that

( ϕ∗FF )σF −1 =

f FF MF
(
(µ F − 1) Q FF

ˆ
ϕ∗FF

ϕσF −1 dGF ( ϕ))µF .

(C.20)

By equation (C.16), a sufficient condition for MF to be decreasing in Q FH is that
eA
FF

AFF ( MF /Q FF )
F ( M /Q )
− eFFF e FF F FF
> 1,
( Q FH /Q FF )AFH + AFF ( MF /Q FF )
f F + FFF ( MF /Q FF )

F
with eA
FF = d ln A FF ( M F /Q FF ) /d ln( M F /Q FF ) ≥ 0 and e FF ≡ d ln F FF ( M F /Q FF ) /d ln( M F /Q FF ).

In the limit, when Q FH /Q FF → 0 and f Fe /FFF ( MF /Q FF ) → 0, the previous condition reduces to
F
eA
FF − e FF > 1.

(C.21)

We will now provide sufficient conditions on GF such that the previous inequality holds. By
equation (C.20), we know that
eFF =

1
σF − 1 +

´

ϕ∗
FF

µ F ϕ∗FF g F ( ϕ∗FF )
( ϕ/ϕ∗FF )σF −1 dGF ( ϕ)

,

with eFF ≡ d ln ϕ∗FF ( MF /Q FF )/d ln( MF /Q FF ). Combining this expression with equations (C.18)
and (C.19), we get
1 − (σF − 1)eFF
,
σF
´
(1 − (σF − 1)eFF ) ϕ∗ ( ϕ/ϕ∗FF )σF −1 dGF ( ϕ)
FF
=−
.
µ F (1 − GF ( ϕ∗FF ))

eA
FF =
eFFF

55

and, in turn,
F
eA
FF − e FF

´
(σF − 1) ϕ∗ ( ϕ/ϕ∗FF )σF −1 dGF ( ϕ)
1 − (σF − 1)eFF
FF
)(1 +
).
=(
σF
1 − GF ( ϕ∗FF )

Hence, the sufficient condition (C.21) can be rearranged as
´
(σF − 1) ϕ∗ ( ϕ/ϕ∗FF )σF −1 dGF ( ϕ) + µ F ϕ∗FF gF ( ϕ∗FF )
ϕ∗FF gF ( ϕ∗FF )
1
´ FF
>
σF − 1 1 − GF ( ϕ∗FF )
(σF − 1) ϕ∗ ( ϕ/ϕ∗FF )σF −1 dGF ( ϕ) + 1 − GF ( ϕ∗FF )
FF

Now taking σF = 2 and noting that

´

∗ σF −1 dG ( ϕ )
F
ϕ∗FF ( ϕ/ϕ FF )

H ( ϕ∗FF ) ≡

> 1, a sufficient condition is

1
1
− ∗
> 1,
∗
1 − GF ( ϕ FF )
ϕ FF gF ( ϕ∗FF )

which can always be satisfied by picking GF with finite support [ ϕ, ϕ̄] and setting
ϕ∗FF

f FF
( µ F −1)

such that

given equation (C.20),
converges to ϕ̄ and H ( ϕ∗FF ) goes to infinity. At this point, we have established that there exist sufficient conditions under which MF∗ ( Q FH , Q FF ) and hence NF∗ ( Q FH , Q FF )
is strictly decreasing in Q FH . To conclude, recall that by equation (C.15), we must have


d ln MRTF ( Q FH , Q FF ( Q FH ))
Q
M
A M
= eA
e
+
e
e
FF FH
FH FF ( e F − 1).
d ln Q FH
A
In the present economy, equations (C.17) and (C.18) imply eA
FF > 0 and e FH = 0. We have just
M < 0. Since e Q − 1 < 0, we therefore obtain
provided sufficient conditions under which eFH
F

d ln MRTF ( Q FH , Q FF ( Q FH ))
> 0,
d ln Q FH
which concludes our proof.

D
D.1

Proofs of Section 6
Domestic Taxes (Section 6.2)

The goal of this subsection is to show that if the assumptions of Section 6.2,
D
D
(1 + t̄ D
HH ) / (1 + s̄ HH ) = 1/µ H .

(D.1)

The first-order conditions associated with Home’s planning problem imply
HO
MRS H
= LD
HH ,

56

(D.2)

HO ≡ ( ∂U /∂Q D ) / ( ∂U /∂U O ) the marginal rate of substitution for Home between
with MRS H
H
H
HH
H
D
Home’s differentiated good and the homogeneous good and L D
HH ≡ ∂L H /∂Q HH the marginal cost

of aggregate output for the local market at home. Like in Section 4.3, one can use the Envelope
Theorem to show that
ˆ
LD
HH

D

=(
ΦD
HH

D

D
D
NH
( a HH ( ϕ))1−σH dGH
( ϕ))1/(1−σH ) .

(D.3)

In the decentralized equilibrium with taxes, utility maximization at home implies
HO
D
MRS H
= PHH
,

(D.4)

with the aggregate price index such that
ˆ
D
PHH

D

=(
ΦD
HH

D

D
D
D
1−σH
NH
((1 + t̄ D
dGH ( ϕ))1/(1−σH ) .
HH ) µ H a HH ( ϕ ) / (1 + s̄ HH ))

(D.5)

Equations (D.2)-(D.5) imply that in order to implement the solution of Home’s planning problem,
domestic taxes must be such that equation (D.1) holds.

D.2

Trade Taxes without Active Selection (Section 6.2)

The goal of this subsection is to establish equations (46) and (47) under the assumption that there
is no active selection. We first compute Home’s terms-of-trade elasticities within the differentiated
D ≡ ∂ ln P D /∂ ln Q D and η D ≡ ∂ ln P D /∂ ln Q D . Since P D ≡ P D /P D , still satisfies
sector, η HF
HF
FH
FH
HF
FH
D and η D must satisfy the counterparts of equations (37) and (38),
P D = MRSFD /MRTFD , η HF
FH
D
η HF
= −1/e D ,

(D.6)

D
D
D D
ηFH
= −(1/r FF
− 1)/e D − 1/(r FF
κ ),

(D.7)

where e D and κ D denote the elasticities of substitution and transformation, respectively, within
D ≡ P D Q D / ( P D Q D + P D Q D ) denote Foreign’s dothe differentiated sector in Foreign and r FF
FF FF
FF FF
FH FH

mestic share of revenue in the differentiated good.19 In the absence of active selection, Foreign’s
production possibility frontier for the differentiated sector is linear, κ D → ∞, so equation (D.7)
simplifies into
D
D
ηFH
= −(1/r FF
− 1)/e D .

(D.8)

D
Now, consider ηXD =≡ ∂ ln P D /∂ ln XO
H . The same steps used to compute η FH implies
O
D
ηXD = (d ln Q D
FF /d ln X H ) /e .
19 In

(D.9)

Section 5.2, we have expressed η FH as a function of the expenditure share, x FF ≡ PFF Q FF /L F . It
should be clear that with only one sector, shares of revenues and expenditures are equal by trade balance.

57

In the decentralized equilibrium abroad, we know that
O
D
D
D
D
QD
FF = ( β F L F + X H ) /PFF − ( PFH /PFF ) Q FH

with price indices such that
ˆ
D
PFF

D

=(
ˆΦFF

D
PFH
=(

NFD =

Φ FH

D

1−σF
dGF ( ϕ))1/(1−σF ) ,
NFD (µ D
F a FF ( ϕ ))
D

D

1−σF
NFD (µ D
dGF ( ϕ))1/(1−σF ) ,
F a FH ( ϕ ))

(σF − 1)[ f Fe

β F L F + XO
´ H
.
+ ∑ j= H,F ΦFj f Fj ( ϕ)dGF ( ϕ))]

In the absence of active selection, we can treat Φ FF and Φ FH as fixed. Thus, the previous equations
imply
O
D O
d ln Q D
FF /d ln X H = ( µ F X H ) / ( PFF Q FF ).

Combining this expression with equation (D.9), we obtain
O
D
ηXD = (µ D
F X H ) / ( e PFF Q FF ).

(D.10)

D /∂ ln Q D and ζ
D
O
Finally, consider ζ FH ≡ ∂ ln PFH
X ≡ ∂ ln PFH /∂ ln X H . In the absence of active
FH

selection, we must have
ζ FH = 0,
ζX =

(D.11)

XO
1
H
.
1 − σFD ( PFF Q FF + PFH Q FH )

(D.12)

Combining equations (42) and (43) with equations (D.6), (D.8), (D.10), (D.11), and (D.12), we obtain
τD =

(e D

τO = −

1
,
D
− 1) x FF

D )( z/r D + (1 − z ) e D )
(1 − r FF
FF
,
D )( σ D z/r D + (1 − z ) e D )
e D (σFD − 1) + (1 − r FF
F
FF

where the first expression uses the fact foreign expenditure and revenue shares are related through
D − 1) = (1/r D − 1) z. Equations (46) and (47) derive from equations (44) and (45) and the
(1/x FF
FF
two previous expressions.

D.3

Trade Taxes in a Small Open Economy (Section 6.2)

The goal of this subsection is to establish equations (48) and (49) under the assumption that Home
is a small open economy. We have already argued in the main text that if Home is a small open

58

D = 1 in equation (D.7), we
economy, then ζ X = ηXD = 0 and ζ FH = 1/κ D . In addition, setting r FF
D = −1/κ D . The last elasticity, η D , is unaffected by the fact that Home is a small open
obtain ηFH
HF
D = −1/e D by equation (D.6). Combining the previous observations with equations
economy: η HF

(42) and (43), we get
τ D = (1 + e D /κ D )/(e D − 1),
τO = 1/κ D .
Equations (48) and (49) derive from equations (44) and (45) and the two previous expressions.

59

