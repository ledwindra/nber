NBER WORKING PAPER SERIES

DIVERSIFICATION AND THE OPTIMAL
CONSTRUCTION OF BASIS PORTFOLIOS
Bruce N. Lehmann
David M. Modest
Working Paper 9461
http://www.nber.org/papers/w9461
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2003

We are grateful to the Columbia Business School for providing us with the computational resources to carry
out this analysis, and to Arthur Warga for helpful comments. The research reported here is part of the NBER's
research program in Asset Pricing. Any opinions expressed are those of the authors and not those of the
National Bureau of Economic Research or Morgan Stanley. The views expressed herein are those of the
authors and not necessarily those of the National Bureau of Economic Research.
©2003 by Bruce N. Lehmann and David M. Modest. All rights reserved. Short sections of text not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit including notice, is given
to the source.

Diversification and the Optimal Construction of Basis Portfolios
Bruce N. Lehmann and David M. Modest
NBER Working Paper No. 9461
January 2003
JEL No. G1
ABSTRACT
Nontrivial diversification possibilities arise when a factor model describes security returns. In this
paper, we provide a comprehensive examination of the merits of various strategies for constructing
basis portfolios that are, in principle, highly correlated with the common factors underlying security
returns. Three main conclusions emerge from our study. First, increasing the number of securities
included in the analysis dramatically improves basis portfolio performance. Our results indicate that
factor models involving 750 securities provide markedly superior performance to those involving
30 or 250 securities. Second, comparatively efficient estimation procedures such as maximum
likelihood and restricted maximum likelihood factor analysis (which imposes the APT mean
restriction) significantly outperform the less efficient instrumental variables and principal
components procedures that have been proposed in the literature. Third, a variant of the usual FamaMacBeth portfolio formation procedure, which we call the minimum idiosyncratic risk portfolio
formation procedure, outperformed the Fama-MacBeth procedure and proved equal to or better than
more expensive quadratic programming procedures.

Bruce N. Lehmann
University of California, San Diego
IR/PS
9500 Gilman Drive
La Jolla, CA 92093-0519
and NBER
blehmann@ucsd.edu

David M. Modest
Morgan Stanley

One of the basic tenets of investment management is that diversification pays: risk can be
reduced by spreading investments across a large number of imperfectly correlated assets. The
merits of diversification are particularly clear in linear factor models for equity returns. These
models assume returns are generated by a small number of common factors plus an additional
random component that can be diversified away in large portfolios. Linear factor models form
the basis of the arbitrage pricing theory (APT) of Ross (1976, 1977). They are also widely used
in quantitative investment management for a variety of purposes including risk management,
alpha detection, and performance evaluation.
One agnostic and prevalent approach to implementing factor models is to treat the
underlying common factors as unobserved random variables, and to infer them from the
covariance structure of returns. In this approach, the factor model parameters of individual
securities are estimated and then used to form basis or reference portfolios to mimic the common
factors. Cross-sectional regression based on factor sensitivity and idiosyncratic risk estimates
remains the most widely used portfolio formation procedure. In theory, these basis portfolio
returns will be both highly correlated with the common factors and relatively free of
unsystematic risk. In practice, there is no guarantee that a basis portfolio formation procedure
based on a finite sample will mimic the factors sufficiently well. Performance differences might
be expected across portfolio construction and factor model estimation procedures and might well
vary with the number of securities included and/or the number of factors being considered. It is
clearly important to know which methods do a good job of mimicking the common factors and
which do not.
Which strategy is best? This is an empirical question that has not been previously
addressed. In this paper, we remedy this omission by providing a comprehensive examination of

1

different basis portfolio formation strategies. In particular, we provide a detailed analysis of the
performance of variants of all of the portfolio formation procedures and estimation methods that
have been proposed in the literature, as well as an examination of the performance gains in crosssections of up to 750 securities.
The paper is organized as follows. The next section briefly reviews multifactor models of
asset returns and their implications for the behavior of diversified portfolios. The third section
delineates the different portfolio formation methods considered while the fourth describes the
estimation methods used to generate the inputs to these procedures. The fifth section analyzes the
problem of basis portfolio performance evaluation. The penultimate section empirically
compares and contrasts different estimation methods, different portfolio formation procedures,
and different numbers of securities. The final section provides some concluding remarks.
1. Diversification in Multifactor Models of Asset Returns
A return generating process within which it is easy to characterize diversifiable risk is
given by the following linear factor structure:

R%t = E + Bδ%t + ε%t ; E[δ%t ] = E[ε%tδ%t′] = 0; E[δ%tδ%t′ ] = I K ; E[ε%t ε%t′ ] = Ω

(1)

where R%t and E are N-vectors of returns and expected returns, respectively, B is an NxK matrix of
factor loadings, δ%t is a K-vector of mean zero common factors normalized to have a KxK identity
covariance matrix IK, and ε%t is an N-vector of mean zero disturbances with positive definite
covariance matrix Ω. The assumption that Ω is positive definite implies that no asset contains
only factor risk. No substantive assumptions are made in (1) except for the existence of the
relevant first and second moments.1 In particular, no assumption has yet been made regarding the
potential to diversify away idiosyncratic risk.

2

Additional structure can be placed on (1) by assuming that the common factors are the
dominant source of covariation among returns or, equivalently, that the residuals represent
diversifiable risk. The residuals will be diversifiable if a weak law of large numbers applies to
them. Chamberlain and Rothschild (1983) provide a particularly convenient sufficient condition
for such a weak law of large numbers to hold: that the largest eigenvalue of Ω remains finite as
N→∞.2 Chamberlain and Rothschild (1983) termed (1) coupled with this constraint on Ω an

approximate factor structure.
What diversification opportunities arise in a world with an approximate factor structure?
An arbitrary portfolio with weights wp has first and second moments of returns given by:
R% pt = w′p R% t = w′p E + w′p Bδ%t + w′pε%t ; Var[ R% pt ] = b′p bp + σ ε2%p
= E p + b′pδ%t + ε% pt ; σ ε2% p = w′p Ωw p

(2)

where Ep is the portfolio’s expected return, bp is a Kx1 vector of the portfolio’s factor loadings,
and ε% pt is the portfolio’s residual return at time t. Portfolio p is a well-diversified portfolio if its
weights are of the order 1/N and the sum of squared weights converges to zero (i.e., wp′wp → 0).
The idiosyncratic risk of a well-diversified portfolio vanishes in the limit when returns have an
approximate factor structure because σ ε2p = w′p Ωwp ≤ w′p wpξ max (Ω) → 0 where ξmax(Ω) is the
largest eigenvalue of Ω.
A well-diversified portfolio with no exposure to factor risk (i.e., bp = 0) generally exists
unless a vector of ones approximately lies in the column span of B. Such a factor-neutral
portfolio cannot be formed from a finite asset menu if the factors can be normalized so that Bι=ι,
where ι is a suitably conformable vector of ones. A convenient sufficient condition for the
1

At this stage, these moments can be either conditional or unconditional.

3

existence of such a portfolio in the infinite dimensional case is that the covariance matrix of the
rows of B is nonsingular in the limit.3 That is: Var[ B] =
definite where β =

1
N

∑

N
j =1

1
N

∑

N
j =1

( β j − β )( β j − β )′ is positive

β j and βj is the jth row of B. Note that the return of such a portfolio (if

it exists) must converge to the riskfree rate as N → ∞ or else there is an arbitrage opportunity.
The possibility of creating a riskless portfolio from a set of risky assets is one of the main
differences between mean-variance analysis in finite and infinite-dimensional asset markets.
The main restriction on the limiting behavior of well-diversified portfolios involves their
expected returns. Since the returns of any K+1 well-diversified portfolios are perfectly correlated
in the limit under these assumptions, their limiting expected returns must be linearly dependent
as well. Accordingly, there exists a K-vector λ and a constant λ0 such that Ep → λ0 + bp′λ for all
well-diversified portfolios p. Note that this mean restriction is not the APT, a theory that converts
this exact expression for well-diversified portfolio expected returns into an approximate
expression for individual asset expected returns. Hence, this analysis is free of the controversy
surrounding the APT.
2. Basis Portfolio Formation

A statistician seeking to estimate δ%t in (2), given a priori knowledge of R%t , B, E, and Ω,

would naturally use generalized least squares. This is the minimum variance linear unbiased
estimator:

2

In what follows, all limits will be taken as N→∞, with N left implicit to avoid notational
clutter.
3
Set Bι = ι + η and consider a unit cost portfolio wp. The sum of its betas is given
by w′p Bι ≡ b′pι = w′pι + w′pη. Hence, this sum will generically be one if p is well diversified and η
can be eliminated via diversification. A column vector of ones will approximately lie in the span
of B if, for example, one of the common factors is unanticipated inflation and all but a finite
number of securities returns are equally affected by this factor.
4

δˆtGLS = ( B′Ω −1 B)−1 B′Ω −1[ R%t − E ] = δ t + ( B′Ω −1 B)−1 B′Ω −1ε%t ; Var[δˆtGLS − δ%t ] = ( B′Ω −1 B)−1 (3)
where ( B′Ω −1 B) −1 B′Ω −1ε%t is the error in tracking δt. The estimator δˆtGLS is consistent if the
smallest eigenvalue of B′B grows without bound as N→∞, the usual OLS consistency condition.
The rate at which δˆtGLS converges hinges on two factors: (a) the structure of Ω and (b) the
dispersion across the rows of B. Ceteris paribus, convergence is faster when the securities used
in estimation have smaller idiosyncratic variances, lower correlations among their idiosyncratic
risks, and greater differences among their risk exposures. The last factor is well understood in a
regression setting: precise estimates of the covariance between the dependent and independent
variables are hard to obtain in small samples if the independent variables vary little across
observations. Similarly, large cross-sections are needed to obtain precise factor estimates if
securities typically possess similar risk exposures. For example, suppose two of the factors are
unexpected changes in expected inflation and unanticipated inflation but only a small fraction of
the assets respond differently to them (i.e., inflation has a neutral impact on most security
returns). In this case, accurate estimation of both common factors would require a much larger
cross-section than would typically be needed to merely eliminate idiosyncratic risk.
In practice, the choice among basis portfolio construction methods is further complicated
by the need to estimate B and Ω. The estimation of Ω requires the placement of constraints on its
functional form. Popular choices are the statistical factor analysis model, in which Ω is diagonal,
and the principal components model, in which Ω is a diagonal matrix with equal variances.
Measurement error in the estimates of B and Ω can impair the small sample properties of basis
portfolio estimators and, as a consequence, large cross-sections may be needed to produce
reliable basis portfolio estimates.

5

In what follows, we consider four procedures for constructing basis portfolios. Two of
the methods involve biased and unbiased versions of the generalized least squares estimator
discussed above. Unbiasedness is not a particular virtue, particularly in the presence of
measurement error and in the absence of a natural scale for the latent factors. Hence, it may be
desirable to seek a biased estimator with potentially lower variance. The other two methods use
mathematical programming procedures that constrain the reference portfolios to be welldiversified, which might mitigate some of the harmful effects of both sampling error in and the
imposition of constraints on Ω.
Before considering alternative portfolio formation procedures, it is useful to translate this
statistical formulation into the language of optimal portfolio formation after the fashion of
Litzenberger and Ramaswamy (1979) and Rosenberg and Marathe (1979). The generalized least
squares estimator provides what we usually refer to as Fama-MacBeth portfolios, after rescaling
the portfolios to cost a dollar.4 In particular, we choose the N portfolio weights wj to mimic the
jth factor so that they:
min w′j Dw j subject to w′j b j = 1; w′j bk = 0 ∀ j ≠ k
wj

(4)

where bk is the kth column of the sample factor loading matrix B and D is the diagonal matrix
consisting of the sample idiosyncratic variances.5 The solution is the unbiased minimum
idiosyncratic risk portfolio that mimics the jth unobservable common factor. We rescale the

weights wj so that the portfolio costs a dollar (i.e., w′jι = 1 ) to maintain comparability with other
basis portfolio formation procedures.
4

Of course, Fama and MacBeth (1973) used the ordinary least squares estimator. Our usage is,
however, common.

6

An alternative method that produces what we term minimum idiosyncratic risk portfolios
involves choosing portfolio weights wj so that:
min w′j Dw j subject to w′jι = 1; w′j bk = 0 ∀ j ≠ k
wj

(5)

In principle, this procedure should produce minimum idiosyncratic risk portfolios whose
fluctuations are proportional to the common factor. In contrast to the unbiased OLS estimator,
the proportionality factor need not equal one.6 This is easily seen by comparing (4) and (5).
It is easy to distinguish these minimum idiosyncratic risk portfolios from the more
familiar Fama-MacBeth portfolios in the one factor case. Assume for simplicity that the
idiosyncratic variances are identical (i.e., D = σ ε2 IN). In this case, the Fama-MacBeth portfolio
solves the programming problem:
min w′w subject to w′b = 1

(6)

w

with solution w = (b′b) −1 b prior to rescaling so that the portfolio weights sum to one where b is
the vector of sample factor loadings. Similarly, the minimum idiosyncratic risk portfolio satisfies:
min w′w subject to w′ι = 1

(7)

w

which is solved by the equally weighted portfolio w = N1 ι. Thus Fama-MacBeth portfolio weights
are proportional to the individual security sample factor loadings (i.e., the betas) and, thus, take
advantage of the differing information content of individual securities regarding the fluctuations
in the common factor. Minimum idiosyncratic risk portfolios, however, are merely well-

5

Note that we are now ignoring off-diagonal elements of Ω such as industry effects. As a
consequence, our procedures actually are better characterized as weighted least squares or
diagonal generalized least squares.
6
Let B = (b1b2…bK) and suppose we are interested in mimicking the jth factor. The minimum
idiosyncratic risk estimator is D-1B*[B*′D-1B*]-1 where B* = (b1b2…ι…bK) and ι is a vector of
ones in the jth column.
7

diversified and do not exploit such information. Note that the factor loading of the minimum
idiosyncratic portfolio is the average beta of the securities (i.e., b = N1 b′ι ) while that of the FamaMacBeth portfolio is unity prior to rescaling.
The diversification properties of Fama-MacBeth portfolios depend on the normalization
of the common factors. If the factors are normalized so that factor loadings are typically close to
one,7 both procedures yield portfolio weights of order 1/N. However, Fama-MacBeth portfolios
have very large weights in finite cross-sections when average factor loading estimates are on the
order of 0.001 to 0.0001 as is typical in daily data under the normalization Var (δ%t ) = I K . This is
not a problem when the factor model parameters are measured without error but it is a potentially
serious source of difficulty when large factor loadings can reflect measurement error as well as
responsiveness to common factors.
The comparative merits of minimum idiosyncratic risk and Fama-MacBeth portfolios in
the presence of measurement error can be investigated more fully by again considering the one
factor model:
R%t = E + βδ%t + ε%t ; E[ε%t ε%t′ ] = σ ε2 I N ; σ β2 > 0

(8)

where β ≠ βι is the N x 1 vector of the (not identical) population factor loadings and the
idiosyncratic disturbances are assumed, for simplicity, to have zero means, common (known)
variances σ ε2 , and to be distributed independently of one another. Suppose that we measure the
factor loadings β with error:
b = β + υ ; E[υ ] = 0; E[υυ ′] = Συ

(9)

7

We are not aware of any study in which the factors are normalized to ensure that the typical
loading is unity. The following transformation yields typical loadings of one. Transform B so

8

where υ is an N vector of the deviations of the sample factor loadings from their population
counterparts with υ assumed to be independent of δ%t and ε%t ∀ t. 8 We also normalize the factor
loading estimates such that b′b = b′ι. This normalization implies that 0< b <1 to ensure that the
sample variance of the bi’s is positive. The Fama-MacBeth procedure yields a basis portfolio
with a sample loading of unity and with weights that sum to one. Finally, we assume that the
cross-section is large enough to ensure that b ≈ β =

1
N

∑

N
j =1

β j [i.e., N1 ∑ j =1υ j ≈ 0 ] to simplify
N

the arithmetic.
In this setting it is easy to characterize the behavior of the Fama-MacBeth portfolio and
the relations between its returns and the common factor. The portfolio returns are:

R%tFM = (b′b) −1 b′[ E + βδ%t + ε%t ] = (b′b) −1[ β ′E + β ′βδ%t + β ′ε%t + υ ′E + υ ′βδ%t + υ ′ε%t ]
≈

1
[ β ′E + β ′βδ%t + β ′ε%t + υ ′E + υ ′βδ%t + υ ′ε%t ]
Nβ

(10)

where the approximation b ≈ β implies that N β ≈ b′b. The variance of Fama-MacBeth portfolio
returns as well as their squared correlation with the common factor are (approximately) given by:
Var[ R%tFM ] ≈
Corr[ R%

FM
t

1
N β
2

2

[( β ′β 2 + β ′Συ β )σ δ2 + β ′βσ ε2 + E ′Συ E + σ ε2tr (Συ )]

β ′β 2σ δ2
, δ%t ] ≈
( β ′β 2 + β ′Συ β )σ δ2 + β ′βσ ε2 + E ′Συ E + σ ε2tr (Συ )

(11)

2

that B′D-1B is diagonal and denote the jth diagonal element as γj. Then B*=BA where A is a
diagonal matrix with ζj/γj along the diagonal where ζ=B′D-1ι has a typical loading of one.
8
We assume that our estimates are unbiased for simplicity. The assumption that υ is independent
of δ%t and ε%t is less innocuous since we typically estimate factor loadings and form basis portfolios
on the same sample. Accounting for such problems would complicate the analysis considerably
without altering the basic point. For example, if b were estimated from an ordinary least squares
2
2
regression, then cov[υi , ε%t ] = δσT ε % 2 = T [σδσ2 +εδ 2 ] would typically be quite small in moderately large
δ
δ
∑ t =1 t
samples.

9

where σ δ2 is the variance of the common factor.
It is easier to evaluate the corresponding quantities for the minimum idiosyncratic risk
portfolio because it ignores the information in the betas. Hence, its returns and their
corresponding moments are:

σ ε2
1
2 2
MIRP
MIRP
%
%
%
%
%
′
Rt
= ι [ E + βδ t + ε t ] = E + βδ t + ε t ; Var[ Rt ] ≈ β σ δ +
N
N
Corr[ R%tMIRP , δ%t ]2 ≈

β 2σ δ2
β 2σ δ2 + σ ε2 / N

(12)

What are we to make of this tedious arithmetic? The latent nature of the factors makes
their scale arbitrary, making high correlation the appropriate objective as opposed to low
tracking error. When β is measured without error [i.e., υ = 0], the Fama-MacBeth portfolio
return is more highly correlated with the common factor than that of the minimum idiosyncratic
risk portfolio since:
Corr[ R%tFM , δ%t ]2 ≈

where σ β2 =

1
N

∑

N
j =1

(σ β2 + β 2 )σ δ2
β ′βσ δ2
β 2σ δ2
=
≥
≈ Corr[ R%tMIRP , δ%t ]2 (13)
2
2
2
2
2
2
2 2
2
β ′βσ δ + σ ε (σ β + β )σ δ + σ ε / N β σ δ + σ ε / N

( β j −β ) 2 > 0 is the sample cross-sectional variance of the population betas.

The same cannot be said when there is sampling error in the betas: the squared correlation of
minimum idiosyncratic risk portfolio returns with the common factor is unaffected by
measurement error in b while that of the Fama-MacBeth portfolio falls in the presence of
sampling error.
For example, consider the special case in which b is estimated by ordinary least squares
regression of R%t − E on δ%t , in which case the error covariance matrix is (approximately):
Συ ≈

σ ε2
IN
T σ δ2

(14)

10

where T is the sample size and the approximation arises because we replaced the sample mean
and variance of δ%t with their population values for ease of exposition. The squared correlation of
the Fama-MacBeth portfolio with the common factor is then:
Corr[ R%tFM , δ%t ]2 ≈

β ′β 2σ δ2
β ′β 2σ δ2 + β ′Συ βσ δ2 + β ′βσ ε2 + E ′Συ E + σ ε2tr (Συ )
1

≈
1+

σ ε2 

(σ E2 + E 2 + σ ε2 ) 
T +1
+


N  T (σ β2 + β 2 )σ δ2 T (σ β2 + β 2 ) 2 σ δ4 

; σ E2 =

1
N

N

∑ (E
j =1

j

− E )2

(15)

which will be smaller than that of the minimum idiosyncratic risk portfolio when:
T (σ β2 + β 2 ) 2 σ δ2 < (T + 1) β 2 (σ β2 + β 2 )σ δ2 + β 2 (σ E2 + E 2 + σ ε2 )

(16)

which can easily obtain when the sampling variation in the betas is small or, equivalently (given
the normalization

1
N

b′b = b and the approximation b ≈ β ), when β is close to one. Note that the

variances of sample betas computed with respect to the usual market proxies are often quite
small.
While both of these procedures produce well-diversified basis portfolios in the limit, they
may not do so in finite asset menus. This possibility led Chen (1983) to employ (proprietary)
mathematical programming methods to produce well-diversified basis portfolios with a finite
number of securities. Such portfolios might suffer only marginally from errors in estimating the
factor loadings and idiosyncratic variances due to the diversification constraint. Accordingly, our
other two portfolio formation procedures involve quadratic programming subject to fixed upper
and lower bounds as in:
min w′j Dw j subject to w′jι = 1; w′j bk = 0 ∀ j ≠ k ; l j ≤ w j ≤ u j
wj

(17)

where ℓj and uj are the fixed lower and upper lower bounds. We examined two choices for these
bounds. Following Chen (1983), we produced portfolios with non-negative weights (i.e., ℓj = 0)

11

that could take on maximum values of one to two per cent. We also examined portfolios that
were merely constrained to be well-diversified with weights taking on maximum and minimum
values of plus and minus one or two per cent. We experimented with constraints as large as five
per cent in absolute value and the results did not differ materially from the ones presented below
and, hence, are not reported.
Finally, we formed sample factor neutral portfolios for each portfolio formation method.
These portfolios are used to construct the excess return basis portfolios analyzed below. The
differences among excess return portfolios are also best illustrated in the one factor case with
identical and uncorrelated idiosyncratic risks. In this case, the required orthogonal portfolio
solves the programming problem:

min w′R f wR f subject to w′R f ι = 1; w′R f β = 0 ⇒ wR f =
wR f

1
N

 σ β2 + β 2
β 
ι − 2 β

2
σ β 
 σ β

(18)

The corresponding excess return portfolio weights are obtained by subtracting these weights
from w = N1 ι , the minimum idiosyncratic risk portfolio in this case as noted in (7) above. This
yields:
wMIRP − wR f =

1
1
ι−
N
N

 σ β2 + β 2
β 
β
ι− 2 β =
( β − ιβ )

2
σ β  Nσ β2
 σ β

(19)

The Fama-MacBeth excess return portfolio solves the programming problem:
ex ′ ex
ex ′
ex ′
ex
=
wFM
wFM subject to wFM
ι = 0; wFM
β = 1 ⇒ wFM
min
ex
wFM

1
Nσ β2

( β − ιβ )

(20)

These manipulations yield one nontrivial insight — the minimum idiosyncratic risk
procedure produces weights for excess return portfolios that are proportional to the FamaMacBeth excess return portfolios. Not surprisingly, the factor of proportionality is the average
factor loading β . Once again, when the average factor loading is much less than one, the Fama12

MacBeth procedure will produce very large positive and negative portfolio weights. In contrast,
the minimum idiosyncratic procedure yields a well-diversified excess return portfolio. A similar
result arises in the multiple factor case.
The choice of basis portfolio formation procedure should be a second order consideration
since well-diversified portfolios possess no idiosyncratic risk in the limit and so any K
imperfectly correlated well-diversified portfolios should suffice. In this section, we have argued
that the construction of reliable basis portfolios in practice requires a large enough asset menu so
as to virtually eliminate idiosyncratic risk and an asset menu with sufficiently different factor
sensitivities so as to allow statistical discrimination among the factors. Further, we have shown
that asymptotically efficient basis portfolio formation procedures that make use of sample
differences in factor sensitivities may have inferior small sample properties to those methods that
simply emphasize diversification and orthogonality.
3. Estimation Methods

The choice among estimation methods involves different tradeoffs than the choice among
basis portfolio formation procedures. The tradeoff here is between statistically efficient but
computationally costly methods such as factor analysis, and less efficient but less costly methods
such as instrumental variables or principal components. The question is whether comparatively
inefficient methods provide performance comparable to that of computationally burdensome
efficient estimation methods.
When the factors are not observed, estimates of B and Ω may be obtained from the
covariance structure of returns, Σ = BB′ + Ω. When returns are normally and independently
distributed — that is, when δ%t and ε%t are jointly normal and serially independent — the higher
moments of returns contain no information about these parameters. In these circumstances, the

13

log likelihood function is given by:
NT
T
1 T
ln 2π − ln Σ − ∑ ( R%t − R )′Σ −1 ( R%t − R )
2
2
2 t =1
NT
T
T
ln 2π − ln Σ − tr ( S Σ −1 )
=−
2
2
2

L (Σ | S ) = −

(21)

T
since the sample covariance matrix S = T1 ∑ t =1 ( R%t − R )( R%t − R )′ follows a Wishart distribution.

Unfortunately, the estimation of B and Ω when security returns possess an approximate
factor structure requires the imposition of further constraints on Ω. The two main alternatives
are factor analysis and principal components: Ω is a diagonal matrix D in the former while
Ω = σ ε2 I N in the latter. This observation highlights the intuitive distinction between factor
analysis and principal components — factor analysis implicitly involves weighted least squares
estimates of the factors and factor loadings (where the weights are the estimated idiosyncratic
variances) while principal components provides the corresponding ordinary least squares
estimates. Hence, factor analysis should tend to perform better than principal components when
there is nontrivial cross-sectional variation in idiosyncratic variances.
We used two relatively inexpensive techniques for estimating the statistical factor
analysis model. The first is a modified version of the EM algorithm as applied to factor analysis
in Lehmann and Modest (1988), which used an iterative multivariate regression procedure. The
first two steps of the EM algorithm in this paper are unchanged but the third step is new:
1. Given B and D, compute the minimum variance biased estimator of the factors

via δˆtBGLS = ( I + B′Ω-1B)-1 B′Ω-1[ R%t - E ]; 9

9

δˆtBGLS has lower mean squared error than (3) since it uses the information in the

normalization Var (δ%t ) = I K .
14

2. Estimate B and D via multivariate regression of R%t on δˆtBGLS and
½

3. Compute the MLE of B given D from step 2 via B = D Γ(D,S*)Λ

-½

(D,S*) where
-½

-½

Λ(D,S*) is a diagonal matrix comprised of the K largest eigenvalues of S* = D SD

and Γ(D,S*) are the associated eigenvectors. Return to step 1 if the algorithm has not
converged.
This revised EM algorithm usually converges much more rapidly than the conventional EM
algorithm.10 We refer to this below as unrestricted maximum likelihood.
The second technique, which we refer to as restricted maximum likelihood, makes use of
the information on B implicit in the vector of sample mean security returns when the APT is true.
In this case, expected security returns are linear combinations of the product of their factor
loadings and a set of factor risk premiums. In order to exploit this information, we also
performed maximum likelihood factor analysis subject to this constraint by maximizing:

L ( B, D, λ0 , λ | S ) = −

NT
T
T
T
ln 2π − ln Σ − tr ( S Σ −1 ) − ( R − ιλ0 − Bλ )′Σ −1 ( R − ιλ0 − Bλ ) (22)
2
2
2
2

where λ is the vector of factor risk premiums and λ0 = 0 if a column of ones lies in the column
span of B. We used the unrestricted estimates of B and D from maximum likelihood factor
analysis as starting values and then obtained these restricted maximum likelihood estimates using
a variant of the EM algorithm.
Principal components has been advocated by Chamberlain and Rothschild (1983) and
10

We found it necessary to create this modification because the conventional EM algorithm
spent a great deal of time slightly refining the factor loading estimates in the neighborhood of the
maximum of the likelihood function. Jones (2001) uses a very similar iterative principal
components procedure that differs in how the D estimate is updated. He shows that the resulting
factor estimates are consistent as N→∞ when B is time invariant if the factors are serially
correlated and the residuals are heteroskedastic and provides a method for dealing with missingat-random data along the lines of Connor, Korajczyk, and Uhlaner (2002). See Lehmann (1992)
for related results.
15

Connor and Korajczyk (1986,1988) as an inexpensive alternative to maximum likelihood factor
analysis. This method requires the extraction of the K largest eigenvalues of S and their
associated eigenvectors or, equivalently, the K largest singular values of the matrix of returns
and their corresponding singular vectors. We extracted all of the eigenvalues and eigenvectors of
S and scaled each eigenvector by the square root of the corresponding eigenvalue to set
Var (δ%t ) = I K . We then estimated D by substituting the transformed eigenvectors associated with

the K largest eigenvalues for B into the model Σ = BB′ + D.11
Finally, instrumental variables is another inexpensive alternative to maximum likelihood
factor analysis, a variant of which was employed in Chen (1983). The basic idea is quite simple:
substitute consistent estimates of the factors for the factors themselves in (1) and estimate the
factor loadings and idiosyncratic variances by ordinary least squares regression. Following
Madansky (1964) and Hagglund (1982), we normalize the factors so that IK is the factor loading
matrix of the first K securities, making are the corresponding factors correlated, and decompose
the vector of returns into three components:
r%1t = R%1t − E1 = δ%t + ε%1t
r%2t = R% 2t − E2 = γ 2′δ%t + ε%2t

(23)

r%3t = R%3t − E3 = Γ3′δ%t + ε%3t

where r%1t , r%2t , and r%3t are the demeaned returns on the first K, the K+1st, and the last N–K–1 assets,
respectively, and γ 2 and Γ 3 are the corresponding factor loading vector and factor loading matrix
of the K+1st and the last N–K–1 assets, respectively. Consider the regression of r%2t on r%1t :

11

Connor, Korajczyk, and Uhlaner (2002) avoid the comparatively expensive
eigenvalue/eigenvector decomposition by using a two-pass cross-sectional regression method
that is a close cousin of the EM algorithm. They also consider methods for dealing with data that
is missing-at-random.
16

r%2t = γ 2′r%1t + u%2t = γ 2′r%1t + ε%2t − γ 2′ε%1t

(24)

Clearly application of ordinary least squares will lead to biased and inconsistent estimates of γ2
since r%1t is correlated with its own idiosyncratic disturbance term. If instead we first
regress r%1t on r%3t :
r%1t = Πr%3t + u%3t

(25)

and then replace r%1t in equation (24) with the fitted values from this regression, ordinary least
squares can then be used to estimate γ2 consistently. This estimate is consistent because the fitted
values from (25) are purged of ε%1t and the idiosyncratic disturbances ε%3t are uncorrelated or
sufficiently weakly correlated with ε%2t by assumption. Repeated application of this procedure
after swapping r%2t with each element of r%3t yields consistent estimates of the corresponding rows
of Γ3. Finally, solution of the matrix equations:
Γ′( S − ΓΦΓ′ − D)Γ = 0
Diag ( S − ΓΦΓ′ − D) = 0

(26)

yields estimates of the factor covariance matrix Φ and the idiosyncratic variances D. The Φ
estimate can be used to transform Γ into B by implicitly rescaling the factors to be uncorrelated
with unit variances.
4. Basis Portfolio Comparison

It would be a simple matter to determine which combination of basis portfolio formation
procedure and estimation method works best if the factors were observed. Of course, we would
not need to construct basis portfolios if we observed the common factors. One heuristic approach
to comparing basis portfolios is to examine the behavior of their weights and the sample means
and variances of their returns in order to check whether the results appear to be reasonable. For

17

example, basis portfolios ought to be well-diversified in order to diminish idiosyncratic risk. The
quadratic programming portfolios are well-diversified by construction but the same need not be
true of Fama-MacBeth or minimum idiosyncratic risk portfolios in finite samples. Similarly, the
sample moments of basis portfolio returns can reveal peculiarities in their performance. For
example, we have examined basis portfolios with mean returns and standard deviations as high
as 120 percent and 450 percent per month, respectively. Good basis portfolios probably do not
exhibit such behavior. Unfortunately, searching for reasonable reference portfolios in this
fashion is not likely to eliminate many candidates.
Fortunately, some plausible large sample approximations facilitate the comparison of
well-diversified basis portfolios. The sample mean vector and covariance matrix of R% pt are given
by:
Rp =

1 T %
1 T %
1 T
;
;
(
);
R
=
ιλ
+
B
λ
+
ε
δ
=
δ
λ
=
λ
+
δ
ε
=
∑ pt 0 p p
∑ t
∑ ε%t
p
T t =1
T t =1
T t =1

Sp =

1 T %
∑ ( Rpt − Rp )( R% pt − Rp )′ = Bp Sδ Bp′ + Bp Sδε p + Sδε p ′ Bp′ + Sε p
T t =1

Sδ =

T
T
1 T %
% − δ )′; S = 1 (δ% − δ )ε%′ ; S = 1 ε% ε%′
(
)(
δ
−
δ
δ
∑ t
∑ t
∑ pt pt
δε p
εp
t
pt
T t =1
T t =1
T t =1

(27)

where λ0 is zero if a vector of ones (approximately) lies in the column span of B and is the
riskless rate otherwise. Sδε p , the matrix comprised of the sample covariances between the actual
factor realizations and the idiosyncratic returns of the basis portfolios, should be close to its
probability limit of zero in large samples (i.e., S p ≈ B p Sδ B p′ + Sε p ). Similarly, the sample mean
vector ε p will be close to zero as well if the basis portfolios are large, well-diversified, and
constructed so that their weights are not systematically related to the ε% pt realizations (i.e.,
R p ≈ ιλ0 + B p λ ). We do not assume that Sε p is close to zero since ε p will converge to zero faster

18

than Sε p for well-diversified portfolios of large numbers of securities.
Now consider the usual χ2 statistic for testing the hypothesis that the K mean excess
returns of the basis portfolios over λ0 are all zero:
T ( R p − ιλ0 )′S p−1 ( R p − ιλ0 ) ≈ T λ ′B′p S p−1B p λ ; S p−1 = Sε−p1 − Sε−p1B p ( Sδ−1 + B′p Sε−p1B p ) −1 B′p Sε−p1
≈ T λ ′[( B′p Sε−p1B p ) −1 + Sδ ]−1 λ ; B′p S p−1B p = [( B′p Sε−p1B p ) −1 + Sδ ]−1

(28)

The structure of Sp simplifies matters considerably and the χ2 statistic is (approximately)
bounded by the maximum attainable value of T λ ′Sδ−1λ . When B′p Sε−p1B p is large (i.e., when

ξ min ( B′p Sε−1B p ) is large), [( B′p Sε−1B p ) −1 + Sδ ]−1 is small and the χ2 statistic will be large as well.
p

p

Ceteris paribus, reductions in the idiosyncratic variances and increases in the factor loadings of
the basis portfolios will increase the percentage of basis portfolio return variance explained by δ%t
and, thus, the χ2 statistic. Hence, the usual χ2 statistic for testing the joint significance of mean
excess basis portfolio returns can rank different combinations of portfolio formation procedures
and factor loading estimation methods.
For example, in the one factor case discussed earlier, the χ2 statistics for the FamaMacBeth and minimum idiosyncratic risk portfolios with no measurement error in β are
(approximately):
2
χ FM
≈T

χ

2
MIRP

β ′β 2 λ 2
=T
β ′β 2σ δ2 + β ′βσ ε2

λ2
σ δ2 +

σ ε2
β2
N β 2 (σ β2 + β 2 )

β 2λ 2
λ2
T
≈T
=
σ ε2
σ ε2
2 2
2
β σδ +
σδ +
N
Nβ 2

(29)

That is, the Fama-MacBeth portfolio performs better as long as σ β2 > 0. However, the inequality

19

can be reversed when there is measurement error in b since:

χ

2
FM

β ′β 2λ 2
≈T
σ ε2
1
2 2
2
( β ′β 2 λ 2 + Nσ ε2 )
β ′β σ δ + (1 + ) β ′βσ ε +
2
T
Tσ δ

(30)

λ2

≈T

σ δ2 +



σ ε2
1
N
β2
(1 + ) +
[1 + λ 2 (σ β2 + β 2 )]
2
2
2 
2
N β (σ β + β ) 
T Tσ δ


1

N
2
if σ β2 < β 2  +
This statistic will be smaller than χ MIRP
[1 + λ 2 (σ β2 + β 2 )] , which will
2
T Tσ δ


generically occur for N sufficiently large. Sampling error can indeed cause minimum
idiosyncratic risk portfolios to outperform their Fama-MacBeth counterparts.
This reasoning points to a problem with testing the APT after using the χ2 statistic to
assess

basis

portfolio

performance.

Consider

the

fitted

multivariate

regression

of R%t − ιλ0 on R% pt − ιλ0 and a constant:
R%t − ιλ0 = αˆ + Bˆ ( R% pt − ιλ0 ) + εˆt

(31)

where α̂ is the vector of estimated intercepts, B̂ is the estimated factor loading matrix, and εˆt is the
fitted residual vector. The population value of α will be zero if the APT is true and the basis

portfolios measure the common factors with negligible error. The usual χ2 for testing this
hypothesis is:
T αˆ ′Σˆ ε−1αˆ = T [ R − ιλ0 − Bˆ ( R p − ιλ0 )]′Σˆ ε−1[ R − ιλ0 − Bˆ ( R p − ιλ0 )]
= T [( R − ιλ0 )′S −1Σˆ ε Σˆ ε−1Σˆ ε S −1 ( R − ιλ0 )]

(32)

= T ( R − ιλ0 )′S −1 ( R − ιλ0 ) − T ( R p − ιλ0 )′S p−1 ( R p − ιλ0 )

where Σˆ ε is the sample residual covariance matrix of εˆt . The last equality follows directly from
three observations: (1) αˆ = Σˆ ε S -1 R; (2) Bˆ = Sω p (ω ′p Sω p ) −1 ; and (3) Σˆ ε = S − Sω ′p (ω ′p Sω p ) −1ω p S

20

where ωp is the NxK matrix of portfolio weights of the true basis portfolios. This representation
makes economic sense: the difference in squared Sharpe ratios measures the performance
improvement in mean-variance space arising from the addition of the individual securities to the
basis portfolios, which will be zero, apart from sampling error, if α = 0.12
Thus the χ2 statistic for testing the null hypothesis α = 0 is the difference between the χ2
statistics for testing the joint significance of two sets of mean excess returns, those of individual
securities and those of the basis portfolios. Choosing the basis portfolios with the largest χ2
statistic minimizes the test statistic for α = 0 and thus reduces its power, although the magnitude
of the bias when the APT is false cannot be analyzed without further assumptions. Fortunately,
this problem can be mitigated to a considerable extent by using known empirical anomalies such
as those associated with market to book, firm size and dividend yield to increase the power of
tests of the APT since basis portfolios tend to be well-diversified while the anomalies are not.
That is, characteristics such as small market to book or firm size, zero dividend yield, or high
dividend yield are clearly not distributed uniformly over securities.
Finally, it is worth emphasizing a major limitation of the analysis. It is not possible to
test analytically whether the differences in χ2 statistics are significant at conventional levels
because they are dependent across portfolio formation and estimation procedures.13 Hence, the
results that follow should be thought of as suggestive ones to be weighed along with other
evidence such as the sensitivity of absolute and relative mutual fund performance measures to
alternative basis portfolio construction methods as documented in Lehmann and Modest (1987).
5. Empirical Results

Evaluation of basis portfolio performance requires consideration of the frequency of
12

This was first noted in Jobson and Korkie (1982).
21

observation, the sample period, the asset menu, and the number of postulated factors. The main
virtue of daily data is the increased precision of second moment estimates while the biases in
mean returns associated with bid-ask spreads and the biases in second moments arising from
non-trading and thin trading constitute their principal defects. As in most investigations of the
APT, we opted for the putative virtues of a large sample and used daily data to estimate the
factor loadings and idiosyncratic variances.
We estimated factor models for four subperiods covered by the CRSP daily returns file:
1963 through 1967, 1968 through 1972, 1973 through 1977, and 1978 through 1982. In each
period, we confined our attention to continuously listed firms in order to have the same number
of observations for each security and ignored any potential selection bias associated with this
choice. This yielded samples of 1001, 1350, 1350, and 1346 securities and 1259, 1234, 1263, and
1264 daily observations in these four subperiods, respectively. To guard against any biases
induced by the natural progression of letters (General Dynamics, General Electric, etc.), we
randomly reordered the securities in each subperiod.
We also made choices as to the number of securities and the number of factors included
in the analysis. In order to study the impact of the size of the asset menu on reference portfolio
performance, we estimated factor models for the first 30, 250, and 750 securities in our randomly
sampled data files for each period after seeing little improvement in experiments with larger
cross-sections. We chose to remain agnostic about the true number of factors and examined
models containing five, ten, and fifteen factors, although for obvious reasons we did not estimate
a fifteen factor model with only thirty securities. We also normalized the models so that the
factors were uncorrelated with unit variances and that B'D-1B was diagonal. This is the standard

13

The bootstrap could be employed here under suitable regularity conditions.
22

normalization in the literature, although it is worth noting that Fama-MacBeth portfolios are not
invariant with respect to normalization.
We first provide evidence on the diversification properties of alternative combinations of
Fama-MacBeth and minimum idiosyncratic risk portfolios and estimation methods, omitting the
quadratic programming portfolios since they are well-diversified by construction. There are
several ways to quantify the diversification properties of reference portfolio weights. We confine
our attention to one simple summary measure: the sum of squared portfolio weights, which
converges to zero as the number of assets grows without bound when a portfolio is welldiversified. The minimum sum that can be attained with portfolio weights that sum to one is the
inverse of the number of securities: 0.03333 for thirty securities, 0.004 for 250 securities,
and 0.001333 for 750 securities.
Table 1 summarizes the diversification properties of Fama-MacBeth and minimum
idiosyncratic risk portfolios across estimation methods, numbers of assets, and factors. For each
combination, we report two numbers: the average sum of squared portfolio weights across both
factors and sample periods and the sample standard deviation of the sum of squared portfolio
weights. These quantities are given by:
wk′ wk =

1 T 1 K
1 T K N 2
1 T K
′
′
;
(
)
( wkt′ wkt − wk′ wk ) 2 (33)
w
w
w
Var
w
w
=
=
∑ ∑ kt kt TK ∑∑∑
∑∑
ikt
k k
T t =1 K k =1
TK
t =1 k =1 i =1
t =1 k =1

where k indexes factors, t refers to time periods (where T=4), and i indexes firms. Obviously,
these measures are descriptive and are not appropriate for inference without further assumptions.
The overwhelming message of Table I is that Fama-MacBeth portfolios formed under the
usual factor model normalization are extremely poorly diversified. In contrast, minimum
idiosyncratic risk portfolios proved to be quite well-diversified with mean sums of squared
weights only ten to twenty times the minimum attainable ones. The contrast is striking — Fama23

MacBeth portfolios yielded values of wk′ wk between 40 and 50,000 times those of minimum
idiosyncratic risk portfolios. Examination of the results for individual basis portfolios (not
reported here) reveals that similar differences occur in the disaggregated data as well. In fact,
every minimum idiosyncratic risk portfolio was better diversified than its Fama-MacBeth
counterpart. The evidence is less clear on the comparative performance of different estimation
methods. Minimum idiosyncratic risk portfolios formed from principal components estimates
appear to be slightly better diversified than those computed from the other three estimation
methods but the difference is slight and is reversed often when individual basis portfolios are
compared.
What accounts for the sharp contrast in the diversification behavior of these two portfolio
formation methods? As noted earlier, the answer is scaling: Fama-MacBeth portfolios are the
minimum idiosyncratic risk portfolios with a loading of one on one factor and loadings of zero
on the other factors prior to rescaling to cost a dollar. Factor loading estimates as usually
normalized are typically much smaller than one (on the order of 0.001 to 0.0001 in daily data)
and, hence, some weights must be very large and positive to insure a portfolio loading of one on
the factor being mimicked while others must be large and negative in order to have loadings of
zero on the other factors. This problem does not arise in the CAPM context since the natural beta
on a market proxy is one. By contrast, minimum idiosyncratic risk portfolios need not have any
particular loading on the factor being mimicked and they need only have small positive and
negative weights to insure orthogonality to the other factors.
The remainder of this section is devoted to the evaluation of alternative methods using
the χ2 statistic (28). Tables 2 through 4 contain aggregate χ2 statistics summed over the four
subperiods, a valid procedure since sums of independent χ2 statistics are distributed χ2 as well

24

and the subperiod statistics are independent by assumption. Few nontrivial differences in
performance are obscured by aggregation and we summarize any relevant ones in the text. Table
2 provides the fitted χ2 statistics based on daily data and five, ten, and fifteen factor models for
various combinations of portfolio formation procedures, estimation methods, and number of
securities in the asset universe. Table 3 presents the same statistics based on daily returns from
the subsequent five-year period to guard against any overfitting caused by using the same sample
to estimate the factor models and to compute the χ2 statistics.14 These statistics are based on a
smaller number of securities since not all securities were continuously listed during both five
year periods. Table 4 contains the same statistics computed from weekly returns in order to
mitigate any bid-ask spread bias that might inflate mean basis portfolio returns.
Each table contains a plenitude of information. Panels A, B, and C report on 5, 10, and 15
factor models, respectively. The four columns listed at the top of each table correspond to the
four portfolio formation methods under consideration: minimum idiosyncratic risk, FamaMacBeth, positive weight quadratic programming, and well-diversified quadratic programming.
Eight combinations of estimation methods and numbers of securities comprise the rows of each
table: maximum likelihood and restricted maximum likelihood factor analysis with 30, 250, and
750 securities and principal components and instrumental variables with 750 securities. The χ2
statistic for the null hypothesis that the raw and excess mean returns of the K basis portfolios are
all zero along with the associated marginal significance level (in parentheses underneath it) is
reported for each portfolio formation method, estimation method, and number of securities. The
excess returns are the difference between raw reference portfolio returns and minimum
idiosyncratic risk orthogonal portfolio returns. Note that the χ2 statistics for the excess returns of

14

Hence, there are no results for the first five year period.
25

the minimum idiosyncratic risk and Fama-MacBeth portfolios are identical as noted earlier.15
The results strongly suggest the importance of using large cross-sections to construct
basis portfolios. The 750 security basis portfolios always outperformed their 250 security
counterparts which, in turn, always dominated 30 security portfolios. The typical χ2 statistics for
250 and 750 securities were roughly twice and three times as large, respectively, as those for 30
securities. These rankings hold across estimation and portfolio formation procedures, time
periods, and observation intervals for both raw return and excess return portfolios (not all of
which are reported here). These differences increase with the number of factors in sample in the
daily data, although this finding does not persist in the weekly data or out of sample. Note that
this need not have occurred — we have found randomly selected 250 security portfolios with
larger χ2 statistics than those of 750 securities.
For example, the χ2 statistics for the minimum idiosyncratic risk basis portfolio mean
excess returns based on unrestricted maximum likelihood factor analysis were 35.20, 81.14, and
116.88 using 30, 250, and 750 securities, respectively. The mean returns of the 30 security raw
return basis portfolios were insignificant at the ten per cent level for two out of four subperiods
in daily data while the corresponding mean excess returns were insignificant in three out of four
periods. In contrast, the 250 and 750 security raw return portfolios were highly significant at
conventional levels in all subperiods while the excess return portfolios were highly significant in
daily data for all but the five factor model in the third period.
The four estimation methods exhibited similarly striking contrasts. Restricted maximum

15

Recall that the Fama-MacBeth and minimum idiosyncratic risk excess return portfolio weights
are proportional where the factor of proportionality is the inverse of the average factor loading in
the one factor model. Fama-MacBeth portfolio weights tend to be much larger since the average
loading is typically much smaller than one. However, the proportionality factor cancels out in the
construction of the χ2 statistic.
26

likelihood factor analysis systematically outperformed its unconstrained counterpart in daily and
weekly data but this dominance did not persist out of sample, where they achieved almost
identical performance. Both maximum likelihood procedures consistently outperformed the less
efficient instrumental variables and principal components methods. Consider, for example, ten
factor minimum idiosyncratic risk excess return portfolio results in daily data in sample: the χ2
statistics based on restricted and unrestricted maximum likelihood factor analysis, principal
components, and instrumental variables were 143.92, 116.88, 97.88, and 82.94, respectively.
Perusal of the tables indicates that the differences in χ2 statistics across estimation methods were
typically much larger for ten and fifteen factor models than for five factor models. The
superiority of the relatively efficient maximum likelihood procedures also persisted out of
sample and in weekly data. The four estimation methods generated χ2 statistics of 53.82, 53.50,
37.13 and 39.07 out of sample and 90.33, 73.83, 53.08, and 62.48 in weekly data, respectively.
An examination of the subperiod results mostly supports this conclusion, albeit with
some interesting intertemporal variation in performance. Principal components performed well
in-sample only in the first five year period while achieving performance comparable to the 250
security basis portfolios in the subsequent three periods. Instrumental variables provided more
consistent performance than principal components in-sample but was consistently inferior to the
more efficient estimation procedures. The out-of-sample results were broadly consistent with
these findings with some idiosyncrasies in the individual subperiods. In five factor models, the
efficient methods proved superior in the second subperiod while all methods yielded similar
performance in the first and third subperiods. In ten factor models, all methods provided similar
performance in the first and second subperiods except for the superior performance of
instrumental variables in the first and its inferior performance in the second. The efficient

27

methods outperformed the inefficient methods by a wide margin in the final out-of-sample
period. Similar inconsistencies emerged in the fifteen factor runs. The methods provided similar
performance in the first out-of-sample period except for the inferior results provided by principal
components. In the second subperiod, only instrumental variables provided inferior results to the
similar performance of the other three methods. Again, the efficient methods outperformed the
inefficient methods in the final subperiod.
The final comparisons are among the four portfolio formation methods. Minimum
idiosyncratic risk portfolios provided almost identical performance to well-diversified quadratic
programming portfolios using 750 securities and provided consistently superior performance
with 250 securities. Other observations depend on the estimation method and choice of raw or
excess returns.16 For the efficient estimation methods and raw returns, minimum idiosyncratic
risk portfolios consistently dominated Fama-MacBeth portfolios in-sample in both daily and
weekly data which, in turn, typically outperformed the positive weight quadratic programming
portfolios. For instance, the daily in-sample χ2 statistics for five factor minimum idiosyncratic
risk and Fama-MacBeth raw return portfolios based on maximum likelihood factor analysis were
131.96 and 92.28, respectively. The corresponding numbers for ten factors were 201.21 and
144.94, respectively, and for fifteen factors were 227.77 and 168.24, respectively. However,
Fama-MacBeth portfolios slightly outperformed minimum idiosyncratic risk portfolios out-ofsample while both continued to dominate the positive weight quadratic programming portfolios.
The picture regarding the relative merits of the minimum idiosyncratic risk, Fama-MacBeth, and
quadratic programming excess return basis portfolios was virtually identical for the efficient
16

As noted above, the minimum idiosyncratic risk and Fama-MacBeth portfolio formation
procedures yield identical χ2 statistics for excess return basis portfolios. However, the χ2 statistics

28

estimation methods. The only difference is that the positive weight quadratic programming
portfolios provided superior performance for five factor models in-sample, an improvement
which did not persist out-of-sample.
The final question considered here is whether less efficient estimation methods or smaller
cross-sections coupled with quadratic programming provides a good substitute for more
computationally costly alternatives. With two exceptions, no such combination outperformed
minimum idiosyncratic risk portfolios of 750 securities based on efficient estimates. Both
exceptions involve five factor excess return portfolios in-sample in daily data. First, positive
weight quadratic programming portfolios based on instrumental variables estimates yielded a χ2
statistic of 77.64 compared to 64.40 obtained from minimum idiosyncratic risk portfolios based
on unrestricted maximum likelihood estimates. Second, 250 security quadratic programming
portfolios based on efficient estimates outperformed 750 security minimum idiosyncratic risk
basis portfolios in-sample. Neither result obtained out-of-sample.
6. Conclusion

This paper has provided a comprehensive examination of the merits of different basis
portfolio formation strategies. The analysis involved the main factor model estimation and
portfolio formation methods proposed in the literature as well as some that have not been
considered previously. In addition, this study provided a detailed evaluation of the impact of
increases in the number of securities underlying the analysis. The result is a detailed set of data
measuring the performance of excess and raw return basis portfolios both in and out of sample
over a variety of time periods and observation frequencies.
Three conclusions emerge from the examination of the more than 2300 statistics reported
of the raw return basis portfolios are relevant if excess returns are computed with respect to a

29

on in this document. First, increasing the number of securities included in the analysis
dramatically improves basis portfolio performance with 750 security factor models proving
markedly superior to those involving 30 or 250 securities. Second, comparatively efficient
estimation procedures such as unrestricted and restricted maximum likelihood factor analysis
significantly outperform the less efficient instrumental variables and principal components
procedures. In particular, less efficient estimation methods typically performed as well as
maximum likelihood factor analysis with 250 securities. Third, the minimum idiosyncratic risk
portfolio formation procedure proposed in the second section outperformed both the FamaMacBeth and positive weight quadratic programming portfolios and proved equal to or better
than the more expensive well-diversified quadratic programming procedure. The Fama-MacBeth
procedure, the dominant method in the literature, yielded poorly diversified portfolios that
provided inferior performance in this context, albeit performance that can be improved upon with
more appropriate factor model normalizations. In sum, if an investigator had to choose one basis
portfolio formation strategy from the formidable list considered here, the clear winner is
minimum idiosyncratic risk portfolios coupled with maximum likelihood factor analysis of 750
securities.

given riskless rate such as the Treasury bill rate.
30

Number of
Securities
30

250

750

TABLE 1: Average Sum of Squared Portfolio Weights
[Standard deviation of sums in parentheses]
Five Factors
Ten Factors
Fifteen Factors
Minimum
Minimum
Minimum
Idiosyncratic
FamaIdiosyncratic FamaIdiosyncratic
FamaEstimation Method
Risk
MacBeth
Risk
MacBeth
Risk
MacBeth
Maximum
Likelihood
Restricted Maximum
Likelihood
Maximum
Likelihood
Restricted Maximum
Likelihood
Maximum
Likelihood
Restricted Maximum
Likelihood
Principal
Components
Instrumental
Variables

0.397
(0.494)
0.399
(0.496)
0.048
(0.049)
0.048
(0.049)
0.016
(0.016)
0.016
(0.016)
0.013
(0.019)
0.015
(0.018)

75.011
(459.206)
2178.232
(16057.81)
4.491
(28.928)
5.209
(34.645)
0.659
(4.297)
0.659
(4.310)
1.391
(5.784)
77.021
(605.504)

31

1.276
(6.063)
1.257
(5.941)
0.063
(0.045)
0.063
(0.045)
0.022
(0.015)
0.022
(0.015)
0.017
(0.035)
0.019
(0.013)

98.150
(846.203)
273.641
(2781.711)
51.643
(551.863)
195.268
(2277.061)
72.689
(798.788)
22.570
(189.855)
26.992
(251.929)
1087.395
(9194.892)

N/A

N/A

N/A
0.071
(0.041)
0.071
(0.041)
0.025
(0.014)
0.025
(0.014)
0.019
(0.043)
0.022
(0.012)

N/A
502.614
(4253.059)
81.613
(492.380)
255.234
(3267.704)
46.992
(469.129)
244.917
(2912.448)
93.953
(1310.661)

TABLE 2: Basis Portfolio Comparisons: Aggregate Daily In-Sample 2 Statistics
[p-values in parentheses]
Portfolio Formation Procedure
Quadratic Programming
Minimum
Idiosyncratic Risk
Fama-MacBeth
Positive Weights
Well-Diversified
Number of
Raw
Excess
Raw
Excess
Raw
Excess
Raw
Excess
Securities Estimation Method Returns Returns Returns Returns Returns Returns Returns Returns
Panel A: Five Factors
Maximum
47.37
26.30
41.96
26.30
42.83
33.11
30
Likelihood
(0.001) (0.160) (0.003) (0.160) (0.002) (0.033)
N/A
N/A
Restricted Maximum
50.22
29.68
44.44
29.68
42.06
32.81
Likelihood
(0.000) (0.075) (0.001) (0.075) (0.003) (0.035)
N/A
N/A
Maximum
102.10
61.53
83.76
61.53
81.38
75.61
86.40
50.89
250
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Restricted Maximum 108.26
70.09
91.08
70.09
83.32
80.03
91.18
58.29
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Maximum
131.96
64.49
92.28
64.49
106.85
76.32
131.93
64.32
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Restricted Maximum 138.26
73.89
99.66
73.89
118.77
78.42
138.13
73.77
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
750
Principal
109.00
57.34
84.18
57.34
92.93
37.57
108.17
57.08
Components
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Instrumental
122.81
54.53
70.49
54.53
126.04
77.64
125.66
55.39
Variables
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Panel B: Ten Factors
Maximum
54.59
35.20
50.17
35.20
53.63
46.85
30
Likelihood
(0.062) (0.690) (0.130) (0.690) (0.073) (0.210)
N/A
N/A
Restricted Maximum
57.77
37.70
52.41
37.70
25.79
19.66
Likelihood
(0.034) (0.570) (0.090) (0.570) (0.690) (0.930)
N/A
N/A
Maximum
129.94
81.14
102.78
81.14
103.64
87.96
105.96
63.49
250
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.010)
Restricted Maximum 154.72 105.57 124.81 105.57 113.10
95.79
124.08
81.28
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Maximum
201.21 116.88 144.94 116.88 133.84 101.76 201.68 115.83
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Restricted Maximum 225.06 143.92 171.22 143.92 140.36 112.74 225.40 142.58
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
750
Principal
143.62
97.88
124.14
97.88
123.07
74.52
143.64
97.73
Components
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Instrumental
160.28
82.94
102.36
82.94
139.14
97.84
162.13
85.61
Variables
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Panel C: Fifteen Factors
Maximum
136.61
90.57
114.23
90.57
95.41
78.08
115.33
73.55
250
Likelihood
(0.000) (0.007) (0.000) (0.007) (0.003) (0.058) (0.000) (0.110)
Restricted Maximum 162.99 116.21 138.54 116.21
97.66
78.55
134.88
93.32
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.002) (0.054) (0.000) (0.004)
Maximum
227.77 137.59 168.24 137.59 142.48 112.92 228.59 136.25
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Restricted Maximum 261.81 174.62 204.05 174.62 144.82 116.15 261.14 172.99
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
750
Principal
169.59 112.50 139.73 112.50 139.94
92.04
168.96 112.36
Components
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
Instrumental
168.29 106.75 135.14 106.75 149.52 109.47 174.90 109.25
Variables
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)

32

TABLE 3: Basis Portfolio Comparisons: Aggregate Daily Out-of-Sample χ2 Statistics
[p-values in parentheses]
Portfolio Formation Procedure
Minimum
Quadratic Programming
Idiosyncratic Risk
Fama-MacBeth
Positive Weights
Well-Diversified
Number of
Raw
Excess
Raw
Excess
Raw
Excess
Raw
Excess
Securities Estimation Method Returns Returns Returns Returns Returns Returns Returns Returns
Panel A: Five Factors
Maximum
40.98
17.95
44.24
17.95
32.86
19.04
37.60
14.11
250
Likelihood
(0.000) (0.270) (0.000) (0.270) (0.005) (0.210) (0.001) (0.520)
Restricted Maximum
41.52
18.37
44.61
18.37
31.82
18.45
37.81
14.18
Likelihood
(0.000) (0.240) (0.000) (0.240) (0.007) (0.240) (0.001) (0.510)
Maximum
60.29
33.03
63.32
33.03
35.66
27.03
61.55
33.13
Likelihood
(0.000) (0.005) (0.000) (0.005) (0.002) (0.028) (0.000) (0.005)
Restricted Maximum
60.79
33.27
63.61
33.27
35.83
27.14
62.02
33.36
Likelihood
(0.000) (0.004) (0.000) (0.004) (0.002) (0.028) (0.000) (0.004)
750
Principal
57.70
24.96
41.82
24.96
36.24
16.31
57.69
24.68
Components
(0.000) (0.050) (0.000) (0.050) (0.002) (0.360) (0.000) (0.054)
Instrumental
49.62
20.90
50.26
20.90
34.93
15.86
49.77
20.76
Variables
(0.000) (0.140) (0.000) (0.140) (0.003) (0.390) (0.000) (0.140)
Panel B: Ten Factors
Maximum
56.83
31.11
58.57
31.11
34.61
33.23
46.04
21.24
250
Likelihood
(0.002) (0.410) (0.001) (0.410) (0.260) (0.310) (0.031) (0.880)
Restricted Maximum
58.27
31.83
59.07
31.83
34.23
29.15
46.08
23.07
Likelihood
(0.002) (0.380) (0.001) (0.380) (0.270) (0.510) (0.031) (0.810)
Maximum
80.67
53.50
85.09
53.50
45.83
38.83
81.49
53.82
Likelihood
(0.000) (0.005) (0.000) (0.005) (0.032) (0.130) (0.000) (0.005)
Restricted Maximum
80.90
53.82
85.41
53.82
44.73
37.90
81.69
54.14
Likelihood
(0.000) (0.005) (0.000) (0.005) (0.041) (0.150) (0.000) (0.004)
750
Principal
70.36
37.13
60.88
37.13
43.33
28.18
71.22
37.29
Components
(0.000) (0.170) (0.001) (0.170) (0.055) (0.560) (0.000) (0.170)
65.83
39.07
69.75
39.07
45.44
37.13
72.15
40.07
Instrumental
Variables
(0.000) (0.120) (0.000) (0.120) (0.035) (0.170) (0.000) (0.100)
Panel C: Fifteen Factors
Maximum
65.45
40.44
66.93
40.44
42.61
38.51
57.51
31.25
250
Likelihood
(0.025) (0.670) (0.019) (0.670) (0.570) (0.740) (0.100) (0.940)
Restricted Maximum
64.59
40.58
67.18
40.58
40.95
39.15
56.84
30.87
Likelihood
(0.029) (0.660) (0.018) (0.660) (0.640) (0.720) (0.110) (0.950)
Maximum
101.63
66.13
99.86
66.13
57.96
53.17
99.26
64.77
Likelihood
(0.000) (0.022) (0.000) (0.022) (0.093) (0.190) (0.000) (0.028)
Restricted Maximum 101.42
66.62
100.36
66.62
57.82
54.54
101.22
65.29
Likelihood
(0.000) (0.020) (0.000) (0.020) (0.095) (0.160) (0.000) (0.026)
750
Principal
79.33
46.25
73.68
46.25
47.08
34.31
80.49
46.44
Components
(0.001) (0.420) (0.005) (0.420) (0.390) (0.880) (0.001) (0.410)
Instrumental
91.62
53.26
88.85
53.26
40.06
26.46
90.45
53.11
Variables
(0.000) (0.190) (0.000) (0.190) (0.680) (0.990) (0.000) (0.190)

33

TABLE 4: Basis Portfolio Comparisons: Aggregate Weekly In-Sample 2 Statistics
[p-values in parentheses]
Portfolio Formation Procedure
Quadratic Programming
Minimum
Idiosyncratic Risk
Fama-MacBeth
Positive Weights
Well-Diversified
Number of
Raw
Excess
Raw
Excess
Raw
Excess
Raw
Excess
Securities Estimation Method Returns Returns Returns Returns Returns Returns Returns Returns
Panel A: Five Factors
Maximum
34.95
26.51
31.47
26.51
31.55
26.61
30
Likelihood
(0.020) (0.150) (0.049) (0.150) (0.049) (0.015)
N/A
N/A
Restricted Maximum
37.24
29.62
33.89
29.62
30.77
26.35
Likelihood
(0.011) (0.076) (0.027) (0.076) (0.058) (0.150)
N/A
N/A
Maximum
65.69
42.12
53.50
42.12
44.71
37.02
55.08
36.01
250
Likelihood
(0.000) (0.003) (0.000) (0.003) (0.001) (0.012) (0.000) (0.015)
Restricted Maximum
69.89
47.45
58.02
47.45
47.85
40.58
58.73
41.02
Likelihood
(0.000) (0.001) (0.000) (0.001) (0.000) (0.004) (0.000) (0.004)
Maximum
77.69
42.20
55.48
42.20
56.83
55.80
78.09
42.31
Likelihood
(0.000) (0.003) (0.000) (0.0030) (0.000) (0.000) (0.000) (0.003)
Restricted Maximum
82.27
47.76
59.97
47.76
57.64
56.00
82.79
47.98
Likelihood
(0.000) (0.000) (0.005) (0.000) (0.000) (0.000) (0.000) (0.000)
750
Principal
49.69
28.09
40.95
28.09
37.43
20.03
49.56
28.00
Components
(0.000) (0.110) (0.000) (0.110) (0.100) (0.460) (0.000) (0.110)
Instrumental
71.49
37.87
42.56
37.87
51.41
45.35
71.94
37.93
Variables
(0.000) (0.009) (0.009) (0.009) (0.000) (0.001) (0.000) (0.009)
Panel B: Ten Factors
Maximum
43.59
34.94
39.72
34.94
43.65
40.91
30
Likelihood
(0.32)
(0.700) (0.480) (0.700) (0.320) (0.430)
N/A
N/A
Restricted Maximum
45.81
37.32
41.69
37.32
23.41
19.84
Likelihood
(0.240) (0.590) (0.400) (0.590) (0.800) (0.920)
N/A
N/A
Maximum
87.22
58.69
71.11
58.69
67.18
61.19
71.87
50.68
250
Likelihood
(0.000) (0.028) (0.002) (0.028) (0.005) (0.017) (0.002) (0.120)
Restricted Maximum 105.24
75.51
87.32
75.51
70.63
65.57
84.44
63.90
Likelihood
(0.000) (0.001) (0.000) (0.001) (0.002) (0.007) (0.000) (0.010)
Maximum
121.29
73.83
88.69
73.83
84.07
73.72
122.63
74.01
Likelihood
(0.000) (0.001) (0.000) (0.001) (0.000) (0.001) (0.000) (0.001)
Restricted Maximum 137.12
90.33
105.22
90.33
92.54
84.43
138.51
90.39
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000) (0.000)
750
Principal
76.37
53.08
66.00
53.08
61.55
49.45
76.40
52.98
Components
(0.000) (0.081) (0.006) (0.081) (0.016) (0.150) (0.000) (0.082)
Instrumental
104.51
62.48
72.03
62.48
85.23
78.25
104.88
65.63
Variables
(0.000) (0.013) (0.001) (0.013) (0.000) (0.000) (0.000) (0.007)
Panel C: Fifteen Factors
Maximum
94.95
68.77
82.18
68.77
64.04
54.28
82.97
59.71
250
Likelihood
(0.003) (0.200) (0.000) (0.200) (0.340) (0.680) (0.026) (0.490)
Restricted Maximum 114.98
87.19
100.20
87.19
62.89
52.51
101.14
77.10
Likelihood
(0.000) (0.012) (0.001) (0.012) (0.370) (0.740) (0.001) (0.068)
Maximum
149.60
94.10
109.57
94.10
94.55
90.94
151.71
93.91
Likelihood
(0.000) (0.003) (0.000) (0.003) (0.003) (0.006) (0.000) (0.003)
Restricted Maximum 174.71 119.72 134.83
119.72
100.82
98.09
175.89 119.34
Likelihood
(0.000) (0.000) (0.000) (0.000) (0.001) (0.001) (0.000) (0.000)
750
Principal
94.73
63.84
79.67
63.84
80.73
67.64
94.68
63.93
Components
(0.003) (0.340) (0.046) (0.340) (0.038) (0.230) (0.003) (0.340)
Instrumental
112.48
81.06
97.52
81.06
98.26
96.63
119.52
84.65
Variables
(0.000) (0.036) (0.002) (0.036) (0.001) (0.002) (0.000) (0.020)

34

References

Chamberlain, Gary and Michael Rothschild, 1983. "Arbitrage and Mean Variance Analysis on
Large Asset Markets," Econometrica 51, 1281-1304.
Chen, Nai-fu, 1983. "Some Empirical Tests of the Theory of Arbitrage Pricing," Journal of
Finance 38, 1393-1414.
Connor, Gregory and Robert A. Korajczyk, 1986. "Performance Measurement with the Arbitrage
Pricing Theory: A New Framework for Analysis." Journal of Financial Economics 15,
373-394.
Connor, Gregory and Robert A. Korajczyk, 1988. "Risk and Return in an Equilibrium APT:
Application of a New Test Methodology." Journal of Financial Economics 21, 255-289.
Connor, Gregory, Robert A. Korajczyk, and Robert T. Uhlaner 2002, "Sunspots, Iterative TwoPass Cross-Sectional Regressions, and Asymptotic Principal Components," unpublished
manuscript.
Fama, Eugene F. and James D. MacBeth, 1973. "Risk, Return, and Equilibrium: Some Empirical
Tests," Journal of Political Economy 81, pp. 607-636.
Hagglund, Gösta, 1982. "Factor Analysis by Instrumental Variables Methods," Psychometrika
47, pp. 209-221.
Jobson, J. D. and Robert M. Korkie, 1982. "Potential Performance and Tests of Portfolio
Efficiency," Journal of Financial Economics 10, pp. 433-466.
Jones, Christopher S., “Extracting Factors from Heteroskedastic Asset Returns.” Journal of
Financial Economics 62 (September 2001): 293-325.
Lehmann, Bruce N., 1992. "Notes on Dynamic Factor Pricing Models." Review of Quantitative
Finance and Accounting 2, 69-87.
Lehmann, Bruce N. and David M. Modest, 1987. "Mutual Fund Performance Evaluation: A
Comparison and Benchmarks and Benchmark Comparisons." Journal of Finance 42,
233-265.
Lehmann, Bruce N. and David M. Modest, 1988. "The Empirical Foundations of the Arbitrage
Pricing Theory." Journal of Financial Economics 21, 213-254.
Litzenberger, Robert H. and Krishna Ramaswamy, 1979. "The Effects of Dividends on Common
Stock Prices: Theory and Empirical Evidence," Journal of Financial Economics 7, pp.
163-195.
Madansky, Albert, 1964. "Instrumental Variables in Factor Analysis." Psychometrica 29, 105113.
35

Roll, Richard and Stephen A. Ross, 1980. "An Empirical Investigation of the Arbitrage Pricing
Theory," Journal of Finance 35, 1073-1103.
Rosenberg, Barr and Vinay Marathe, 1979. “Tests of Capital Asset Pricing Hypotheses” in
Research in Finance: A Research Annual, Greenwich, Connecticut: JAI Press.
Ross, Stephen A., 1976. "The Arbitrage Theory of Capital Asset Pricing." Journal of Economic
Theory 13, 341-360.
———, 1977. "Return, Risk and Arbitrage" in Irwin Friend and James L. Bicksler (eds.) Risk
and Return in Finance. Cambridge, MA: Ballinger.

36

