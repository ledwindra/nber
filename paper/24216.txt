NBER WORKING PAPER SERIES

IDENTIFICATION AND ESTIMATION OF DYNAMIC CAUSAL EFFECTS IN MACROECONOMICS
USING EXTERNAL INSTRUMENTS
James H. Stock
Mark W. Watson
Working Paper 24216
http://www.nber.org/papers/w24216

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2018

This work was presented by Stock as the Sargan Lecture to the Royal Economic Society on April
11, 2017. We thank Paul Beaudry, Mark Gertler, Oscar Jordà, Daniel Lewis, Karel Mertens,
Mikkel Plagborg-Møller, Glenn Rudebusch, Jose Luis Montiel Olea, Valerie Ramey, Morten
Ravn, Giovanni Ricco, Neil Shephard, Leif Anders Thorsrud, Christian Wolf and an anonymous
referee for helpful comments and/or discussions. The views expressed herein are those of the
authors and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2018 by James H. Stock and Mark W. Watson. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Identification and Estimation of Dynamic Causal Effects in Macroeconomics Using External
Instruments
James H. Stock and Mark W. Watson
NBER Working Paper No. 24216
January 2018
JEL No. C36,E17
ABSTRACT
An exciting development in empirical macroeconometrics is the increasing use of external
sources of as-if randomness to identify the dynamic causal effects of macroeconomic shocks.
This approach – the use of external instruments – is the time series counterpart of the highly
successful strategy in microeconometrics of using external as-if randomness to provide
instruments that identify causal effects. This lecture exposits this approach and provides
conditions on instruments and control variables under which external instrument methods
produce valid inference on dynamic causal effects, that is, structural impulse response functions.
These conditions can help guide the search for valid instruments in applications. We consider two
methods, a one-step instrumental variables regression and a two-step method that entails
estimation of a vector autoregression. Under a restrictive instrument validity condition, the
onestep method is valid even if the vector autoregression is not invertible, so comparing the two
estimates provides a test of invertibility. Under a less restrictive condition, where multiple lagged
endogenous variables are needed as control variables in the one-step method, the conditions for
validity of the two methods are the same.

James H. Stock
Department of Economics
Harvard University
Littauer Center M26
Cambridge, MA 02138
and NBER
James_Stock@harvard.edu
Mark W. Watson
Department of Economics
Princeton University
Princeton, NJ 08544-1013
and NBER
mwatson@princeton.edu

A data appendix is available at http://www.nber.org/data-appendix/w24216

1. Introduction
The identification and estimation of dynamic causal effects is a defining challenge of
macroeconometrics. In the macroeconomic tradition dating to Slutzky (1927) and Frisch (1933),
dynamic causal effects are conceived as the effect, over time, of an intervention that propagates
through the economy, as modeled by a system of simultaneous equations. Restrictions on that
system can be used to identify its parameters.
In a classic result by the namesake of this lecture, Denis Sargan (1964) (along with
Rothenberg and Leenders (1964)) showed that full information maximum likelihood estimation,
subject to identifying restrictions, is asymptotically equivalent to instrumental variables (IV)
estimation by three stage least squares. The three stage least squares instruments are obtained
from restrictions on the system, typically that some variables and/or their lags enter some
equations but not others, and thus are internal instruments – they are internal to the system. The
massive modern literature since Sims (1980) on point-identified structural vector autoregressions
(SVARs) descends from this tradition, and nearly all the papers in that literature can be
interpreted as achieving identification through internal instruments. In these models, structural
shocks are the interventions of interest, and the goal is to estimate the dynamic causal effect of
these shocks on macroeconomic outcomes.
In contrast, modern microeconometric identification strategies exploit external sources of
variation that provide quasi-experiments to identify causal effects. Such external variation might
be found, for example, in institutional idiosyncrasies that introduce as-if randomness in the
variable of interest (the treatment). The use of such external instruments in microeconometrics
has proven highly productive and has yielded compelling estimates of causal effects.
The subject of this lecture is the use of external instruments to estimate dynamic causal
effects in macroeconomics. By an external instrument, we mean a variable that is correlated with
a shock of interest, but not with other shocks, so that the instrument captures some exogenous
variation in the shock of interest. These instruments are typically not a macro variable of ultimate
interest, and as such they are external to the system. In referring to these instruments as external,
we also connect with the original term for instruments, external factors (Wright (1928)).
External instruments can be used to estimate dynamic causal effects directly without an
intervening VAR step. This method uses an instrumental variables (IV) version of what is called
in the forecasting literature a direct multistep forecasting regression; in the impulse response
1

literature, this method is called a local projection. Alternatively, the instruments can be used in
conjunction with a VAR to identify structural impulse response functions; this is the IV version
of an iterated multistep forecast.
The use of external instruments has opened a new and rapidly growing research program
in macroeconometrics, in which credible identification is obtained using as-if random variation
in the shock of interest that is distinct from – external to – the macroeconomic shocks hitting the
economy. In many applications, the instrument is constructed as a partial measure of the shock of
interest: the quantity of oil kept from market because of a political disruption, a change in fiscal
policy not related to business cycle conditions, or the part of a monetary shock revealed during a
monetary policy announcement window. Such constructed measures typically have measurement
error, which in general leads to bias if the measure is treated as the true shock. However, that
measurement error need not compromise the validity of the measure as an instrument. As in the
microeconometric setting, finding such instruments is not easy. Still, in our view this research
program holds out the potential for more credible identification than is typically provided by
SVARs identified using internal restrictions.
This lecture unifies and explicates a number of strands of recent work on external
instruments in macroeconometrics. The idea that constructed shock series are best thought of as
instruments is not new: Blanchard and Sims made this observation in the published general
discussion of Romer and Romer (1989), but it seems not have been followed up. To our
knowledge, the earliest work to use constructed shocks as an instrument in a SVAR is Beaudry
and Saito (1998), who use the Romer and Romer (1989) indicators to estimate impulse responses
to monetary shocks. The method of external instruments for SVAR identification (SVAR-IV)
was introduced by Stock (2008), and has been used by Stock and Watson (2012), Mertens and
Ravn (2013), Gertler and Karadi (2015), Caldara and Kamps (2017), and a growing list of other
researchers. Turning to single-equation methods, Hamilton (2003) developed a list of exogenous
oil supply disruptions, which he used as an instrument for autoregressive-distributed lag
estimation of the effect of oil supply shocks on GDP. The modern use of external instruments to
estimate structural impulse response functions directly (that is, without estimating a VAR or
iterating) dates to independent contributions by Jordà, Schularick, and Taylor (2015) and Ramey
and Zubairy (2017), and is clearly exposited in Ramey (2016). The condition for instrument
validity in the direct regression without control variables, given in Section 2 below, appears in

2

unpublished lecture notes by Mertens (2015). Those notes and Fieldhouse, Mertens, and Ravn
(2017) discuss the extension of these conditions to control variables. Jordà, Schularick, and
Taylor (2015) and Ramey (2016) call these direct IV regressions “local projections-IV” (LP-IV)
in reference to Jordà’s (2005) method of local projections (LP) on which it builds. We adopt this
terminology while noting that these IV regressions emerge from the much older tradition of
simultaneous equations estimation in macroeconomics pioneered by Sargan and his
contemporaries. Although these methods increasingly are being used in applications, we are not
aware of a unified presentation of the econometric theory and theoretical connections between
the SVAR-IV and LP-IV methods.
In addition to expositing the use of external instruments in macroeconomics, this lecture
makes five contributions to this literature.
First, we provide conditions for instrument validity for LP-IV, and show that under those
conditions LP-IV can estimate dynamic causal effects without assuming invertibility, that is,
without assuming that the structural shocks can be recovered from current and lagged values of
the observed data. Because of the dynamic nature of the macroeconometric problem, exogeneity
of the instrument entails a strong “lead-lag exogeneity” requirement that the instrument be
uncorrelated with past and future shocks, at least after including control variables. This condition
provides concrete guidance for the construction of instruments and choice of control variables
when undertaking LP-IV.
Second, we recapitulate how IV estimation can be undertaken in a SVAR (the SVAR-IV
method). This method is more efficient asymptotically than LP-IV under strong-instrument
asymptotics, and it does not require lead-lag exogeneity. But to be valid, this method requires
invertibility. Invertibility is a very strong, albeit commonly made, assumption: under
invertibility, a forecaster using a VAR would find no value in augmenting her system with data
on the true macroeconomic shocks, were they magically to become available.
Third, having a more efficient estimator of the structural impulse response function
(SVAR-IV) that requires invertibility for consistency, and a less efficient estimator (LP-IV) that
does not, gives rise to a Hausman (1978) -type test for whether the SVAR is invertible. We
provide this test statistic, obtain its large-sample null distribution, introduce the concept of local
non-invertibility, and derive the local asymptotic power of the test against this alternative. The
focus of this test on the impulse response function – the estimand of interest – differs from

3

existing tests for invertibility, which examine the no-omitted-variables implication by adding
variables, see for example Forni and Gambetti (2014).
Fourth, lest one think that LP-IV is too good to be true, we provide a “no free lunch”
result. Suppose an instrument satisfies a contemporaneous exogeneity condition, but not the no
lead-lag exogeneity condition because it is correlated with past shocks. A natural approach is to
include additional regressors – lagged macro variables – that control for the lagged shocks. We
show, however, that the condition for these control variables to produce valid inference in LP-IV
is in general equivalent to assuming invertibility of the corresponding VAR, in which case
SVAR-IV provides more efficient inference.
Fifth, we discuss some econometric odds and ends, such as heteroskedasticity- and
autocorrelation-robust (HAR) standard errors, what to do if the external instruments are weak,
estimation of cumulative dynamic effects, forecast error variance decompositions, and the pros
and cons of using generic controls including factors (factor-augmented LP-IV).
Following Ramey (2016), we illustrate these methods using Gertler and Karadi’s (2015)
application, in which they estimate the dynamic causal effect of a monetary policy shock using
SVAR-IV, with an instrument that captures the news revealed in regularly scheduled monetary
policy announcements by the Federal Open Market Committee.
Before proceeding, we note two substantial simplifications made throughout this lecture.
First, we focus exclusively on linear models and identification through second moments, so that
conditional expectations are typically replaced by projections. Second, we assume homogenous
treatment effects so that valid instruments all have the same estimand (that is, the local average
treatment effect equals the average treatment effect). Both these simplifications are nontrivial.
The assumption of nonlinearity in particular rules out a frequent justification for using LP
methods (either OLS or LP-IV), which is that LP methods can estimate nonlinear effects without
needing to model them as a system. That said, there is a tension between the assumption that the
control variables and specification are correct in the single-equation specification, and what this
must imply for the full system, and this tension is unresolved in the literature and merits further
investigation. We return to this point in the conclusions.
Finally, we use two notational devices: the subscript “2:n” denotes the elements of a
vector or matrix other than the first row or column, and {…} denotes a linear combination of the
terms inside the braces.

4

2. Identifying Dynamic Causal Effects using External Instruments and Local Projections
The LP-IV method emerges naturally from the modern microeconometrics use of
instrumental variables. Making this connection requires some translation between two sets of
jargon, however, so we start with a brief review of causal effects and instrumental variables
regression in the microeconometric setting.
2.1 Causal effects and instrumental variables regression
Our starting point is that the expected difference in outcomes between the treatment and
control groups in a randomized controlled experiment with a binary treatment is the average
treatment effect.1 In brief, if a binary treatment X is randomly assigned, then all other
determinants of Y are independent of X, which implies that the (average) treatment effect is
E(Y|X=1) – E(Y|X=0). In the linear model Y = γ +X + u, where β is the treatment effect, random
assignment implies that E(u|X) = 0 so that the population regression coefficient is the treatment
effect. If randomization is conditional on covariates W, then the treatment effect for an individual
with covariates W = w is estimated by the outcome of a random experiment on a group of
subjects with the same value of W, that is, it is E(Y|X=1,W=w) – E(Y|X=0,W=w). With the
additional assumptions of linearity and homogeneous treatment effects, this treatment effect is
estimated by ordinary least squares estimation of
Y = X + γW + u,

(1)

where the intercept has been subsumed in 'W.
In observational data, the treatment level X is often endogenous. This is generally the
case when the subject has some control over receiving the treatment in an experiment. But if
there is some source of variation Z that is correlated with treatment, such as random assignment
to the treatment or control group, conditional on observed covariates W, then the causal effect
1

This starting point is actually a result, or conclusion, of a vast literature on defining causal
effects for statistical analysis. See Imbens (2014) for a review, including discussion of both the
potential outcomes framework and graphical models.
5

can be estimated by instrumental variables. Let “” denotes the residual from the population
projection onto W, for example X   X  Proj( X | W ) . If the instrument satisfies the conditions

(i) E ( X  Z  )  0 (relevance)

(2)

(ii) E (u Z  ) = 0 (exogeneity),

(3)

and if the instruments are strong, then instrumental variables estimation of (1) consistently
estimates the causal effect .
2.2 Dynamic causal effects and the structural moving average model
In macroeconomics, we can imagine a counterpart of randomized controlled experiment.
For example, in the United States, the Federal Open Market Committee (FOMC) could set the
Federal Funds rate according to a rule, such as the Taylor rule, perturbed by a randomly chosen
amount. Although we have only one subject (the U.S. macroeconomy), by repeating this
experiment through time, the FOMC could generate data on the effect of these random
interventions.
More generally, let 1,t denote the mean-zero random treatment at date t. Then the causal
effect on the value of a variable Y2, h periods hence, of a unit intervention in 1 is
Et Y2,t  h |  1,t  1  Et Y2,t  h |  1,t  0  .

We now assume linearity and stationarity, assumptions we maintain henceforth. With
these assumptions, the h-lag treatment effect is the population coefficient in the regression,

Y2,t h  h,211,t  ut h ,

(4)

where throughout we omit constant terms for convenience. Because 1,t is randomly assigned,
E  ut  h | 1t  = 0, so  h ,21  E Y2,t  h |  1,t  1  E Y2,t  h |  1,t  0  . Thus  h ,21 is the causal effect

of treatment 1 on variable 2, h periods after the treatment. Were 1,t observed, this causal effect
could be estimated by OLS estimation of (4).

6

The path of causal effects mapped out by h,21 for h = 0, 1, 2,… is the dynamic causal
effect of treatment 1 on variable 2. 2
The macroeconometric jargon for this random treatment 1,t is a structural shock: a
primitive, unanticipated economic force, or driving impulse, that is unforecastable and
uncorrelated with other shocks.3 The macroeconomist’s shock is the microeconomists’ random
treatment, and impulse response functions are the causal effects of those treatments on variables
of interest over time, that is, dynamic causal effects.
The Slutzky-Frisch paradigm represents the path of observed macroeconomic variables as
arising from current and past shocks and measurement error. If we collect all such structural
shocks and measurement error together in the m×1 vector  t , the n×1vector of macroeconomic
variables Yt can be written in terms of current and past  t :
Yt = (L) t ,

(5)

where L is the lag operator and (L) = 0 + 1L + 2L2 + …, where h is an n×m matrix of
coefficients. The shock variance matrix Σεε = E  t  t  is assumed to be positive definite to rule out
trivial (non-varying) shocks. We assume that the shocks are mutually uncorrelated. Throughout,
we treat Yt as having been transformed so that it is second order stationary, for example real
activity variables would appear in growth rates.
The assumption that the structural shocks are mutually uncorrelated accords both with
their interpretation as randomly assigned treatments and with their being primitive economic
forces; see Ramey (2016) for a discussion. We assume that any measurement error included in

 t is uncorrelated with the structural shocks, although measurement error could be correlated
2

There is a literature that defines dynamic causal effects in terms of primitives and connects
those to what can be identified in an experiment with data collected over time; see Lechner
(2009), Angrist, Jordà, and Kuersteiner (2017), Jordà, Schularick, and Taylor (2017), and
especially Bojinov and Shephard (2017) for discussion and references. With the additional
assumptions of linearity and stationarity, Bojinov and Shephard’s (2017) dynamic potential
outcomes framework leads to (4).
3
For an extensive discussion, see Ramey (2016).
7

across variables. Because 1,t is uncorrelated with the other shocks and with any measurement
error, the causal effect can be written as E Y2,t  h | 1,t  1,  2:n,t ,  s , s  t  –

E Y2,t  h | 1,t  0,  2:n,t ,  s , s  t  . Although conditioning on the other shocks is redundant by
randomization, this alternative expression connects with the definition, seen in the older macro
literature, of the causal effect as the partial derivative Y2,t  h 1,t , holding all other shocks
constant.
Representation (5) is the structural moving average representation of Yt. The coefficients
of (L) are the structural impulse response functions, which are the dynamic causal effects of
the shocks. In general, the number of shocks plus measurement errors, m, can exceed the number
of observed variables, n.
The recognition that, if 1,t were observed, h,21 could be estimated by OLS estimation of
(4) – or by OLS estimation of the distributed lag regression of Yt on 1,t , 1,t 1 , 1,t 2 ,... – underpins
a productive and insightful research program. In this program, which dates to Romer and Romer
(1989), researchers aim to measure directly a specific macroeconomic shock. Influential
examples include Rudebusch (1998), who measured monetary shocks by Fed Funds surprises
controlling for employment report announcements, and Kuttner (2001), Cochrane and Piazzesi
(2002), and Faust, Rogers, Swanson, and Wright (2003), Gürkaynak, Sack, and Swanson (2005),
and Bernanke and Kuttner (2005), all of whom used interest rate changes around Federal
Reserve announcement dates to measure monetary policy shocks.
2.3 Direct estimation of structural IRFs using external instruments (LP-IV)
One difficulty with directly measured shocks is that they capture only part of the shock,
or are measured with error. For example, Kuttner (2001)-type variables measure that part of a
shock revealed in a monetary policy announcement but not the part revealed, for example, in
speeches by FOMC members. This concern applies to other examples, including Romer and
Romer’s (1989) binary indicators, Romer and Romer’s (2010) measure of exogenous changes in
fiscal policy, and Hamilton’s (2003) and Kilian’s (2008) lists of exogenous oil supply
disruptions. In all these cases, the constructed variable is correlated with the true (unobserved)
shock and, if the author’s argument for exogeneity is correct, the constructed variable is

8

uncorrelated with other shocks. That is, the constructed variable is not the shock, but is an
instrument for the shock. This instrument is not obtained from restrictions internal to a VAR (or
some other dynamic simultaneous equations model); rather, it is an external instrument.
This reasoning suggests using instrumental variables methods to estimate the dynamic
causal effects of the shock. To do so, however, requires resolving a difficulty not normally
encountered in microeconometrics, which is that the shock/treatment 1,t is unobserved. As a
result, the scale of 1,t is indeterminate, that is, (4) holds for all h if 1,t is replaced by c1,t and

h,21 is replaced by c-1h,21. This scale ambiguity is resolved by adopting, without loss of
generality, a normalization for the scale of 1,t . Specifically, we assume that 1,t is such that a
unit increase in 1,t increases Y1,t by one unit:

0,11 = 1 (unit effect normalization).

(6)

For example, if 1,t is the monetary policy shock and Y1,t is the federal funds rate, (6) fixes the
scale of 1,t so that a 1 percentage point monetary policy shock increases the federal funds rate
by 1 percentage point.
The unit effect normalization has advantages over the more common unit standard
deviation normalization, which sets var(1,t ) = 1. Most importantly, the unit effect normalization
allows for direct estimation of the dynamic causal effect in the native units relevant for policy
analysis. While one can convert one scale normalization to another, doing so entails rescaling by
estimated values and care must be taken to conduct inference incorporating that normalization
(we elaborate on this below). As discussed in Stock and Watson (2016), the unit effect
normalization also allows for direct extension of SVAR methods to structural dynamic factor
models.
The unit effect normalization underpins the local projection approach because it allows
the regression (4) to be rewritten in terms of an observable regressor, Y1,t. Specifically, use the
unit effect normalization to write Y1,t = 1,t  { 2:n,t ,  t 1,  t 2 ,...} (recall the notational devices that

9

 2:n,t  ( 2,t ,...,  n,t ) and that {…} denotes a linear combination of the terms in braces).
Rewriting this expression in terms of 1,t and substituting it into (4) yields,

Yi,t+h = h,i1Y1,t + uih,t  h ,

(7)

where uih,t  h = { t h ,...,  t 1 ,  2:n,t ,  t 1 ,  t 2 ,...} . Because Y1,t is endogenous, it is correlated with
uih,t  h , so OLS estimation of (7) is not valid. But with a suitable instrument, (7) can be estimated

by IV.
Let Zt be a vector of instrumental variables. These instruments can be used to estimate
the dynamic causal effect using (7) if they satisfy:
Condition LP-IV

 
(ii) E   Z    0
(iii) E   Z    0 for j ≠ 0
(i) E 1,t Zt     0

(relevance)

2:n ,t

t

(contemporaneous exogeneity)

t j

t

(lead/lag exogeneity).

Conditions LP-IV (i) and (ii) are conventional IV relevance and exogeneity conditions,
and are the counterparts of the microeconometric conditions (2) and (3) in the absence of control
variables.
Condition LP-IV (iii) arises because of the dynamics. The key idea of this condition is
that Y2,t+h generally depends on the entire history of the shocks, so if Zt is to identify the effect of
shock 1,t alone, it must be uncorrelated with all shocks at all leads and lags. The requirement
that Zt be uncorrelated with future ε’s is generally not restrictive: when Zt contains only variables
realized at date t or earlier, it follows from the definition of shocks as unanticipated structural
disturbances. In contrast, the requirement that Zt be uncorrelated with past ε’s is restrictive and
strong.

10

We will refer to Condition LP-IV (iii) as requiring that Zt be unpredictable given past 's,
although strictly the requirement is that it not be linearly predictable given past ε’s. Note that Zt
could be serially correlated yet satisfy this condition. For example, suppose Zt = 1,t   t , where

t is a serially correlated error that is independent of {εt}; then Zt satisfies Condition LP-IV.
The IV estimator of h,i1 obtains by noting two implications of the assumptions. First,
Condition LP-IV and equation (5) imply that E(Yi ,t  h Z t  ) = h,i1. Second, Condition LP-IV, the
unit effect normalization (6), and equation (5) imply that E(Y1,t Z t  ) =. Thus when Zt is a scalar,

E(Yi ,t h Zt )
 h,i1 .
E(Y1,t Zt )

(8)

For a vector of instruments, E (Yi ,t  h Z t )HE ( Z tY1,t ) E (Y1,t Z t )HE ( Z tY1,t )   h ,i1 for any positive
definite matrix H. These are the moment expressions for IV estimation of (7) using the
instrument Zt.
These moment expressions provide an intuitive interpretation of LP-IV. Suppose that Yi,t
is GDP growth, Y1,t is the Federal Funds rate, and Zt is a monetary policy announcement
instrument, constructed so that it satisfies Condition LP-IV. Then the causal effect of a monetary
policy shock on GDP growth h periods hence is estimated by regressing ΔlnGDPt+h on FFt, using
the announcement surprise Zt as an instrument. In this two stage least squares interpretation, the
unit effect normalization is imposed automatically.
Another interpretation of the moment condition (8) relates to the distributed lag
representation of Yt in terms of Zt,

Yt  (L)Zt  vt .

(9)

This is Theil and Boot’s (1962) final form of the dynamic model for (Yt, Zt). It is also the time
series counterpart to what is (somewhat confusingly) called the reduced form for non-dynamic
simultaneous equations systems. In the non-dynamic setting with a single instrument, a familiar
result is that the Wald IV estimator is the ratio of the reduced-form coefficients. Similarly, in the

11

dynamic context, when Zt is serially uncorrelated and a scalar, h,1 is the ratio of the hth
distributed lag coefficient in the Yi,t equation, Πh,i to the impact effect on the first variable, Π0,1;
that is, h;i1 = Πh,i/ Π0,1. In the monetary policy announcement example, Π(L) is the impulse
response function of Yt with respect to the announcement surprise. The older literature treated
this as the causal effect of interest, but as explained in Gertler and Karadi (2015), the surprise is
better thought of as an instrument for the shock. Akin to the Wald estimator in the static setting,
the IV estimator of the dynamic causal effect is the impulse response function of the effect of the
shock on ΔlnGDP, divided by the impact effect of the announcement on the Federal Funds rate.
The lag exogeneity condition LP-IV(iii) is testable: Zt should be unforecastable in a
regression of Zt on lags of Yt. If the lag exogeneity condition fails, then the LP-IV methods laid
out in this section are not valid because Zt will be correlated with the error ut+h in (4). This
problem can potentially be addressed by adding control variables to the LP-IV regression.
2.4. Extension of LP-IV to Control Variables
There are two reasons to consider adding control variables to the IV regression (7).
First, although an instrument might not satisfy Condition LP-IV, it might do so after
including suitable control variables; that is, the instruments might satisfy the exogeneity
conditions only after controlling for some observable factors. As discussed in Section 5, this is
the case in the Gertler-Karadi (2015) application.
Second, even if Condition LP-IV is satisfied, including control variables could reduce the
sampling variance of the IV estimator by reducing the variance of the error term. The reasoning
is standard: because the variance of the LP-IV estimator depends on the scale of the errors,
including control variables that explain the error term can reduce the variance of the estimator.
Here, the relevant variance is the long-run variance of the instrument-times-error, so the aim of
including additional control variables is to reduce this long-run variance. Under Condition LPIV, Yt-1, Yt-2,… and possibly future Zt+h,…, Zt+1 are candidate control variables.
Adding control variables Wt to (7) yields,
Yi ,t  h   h ,i1Y1,t   hWt  uih,t h ,

(10)

12

where xt = xt  Proj(xt | Wt) for some variable xt. and uih,t h = { th ,...,  t1 ,  2:n,t ,  t1 ,  t2 ,...} .
With control variables W, the conditions for instrument validity are,
Condition LP-IV

 
(ii) E   Z    0
(iii) E   Z    0 for j ≠ 0.
(i) E 1,t Zt     0

2:n ,t


t j


t


t

By projecting on Wt, (10) can be written, Yi ,t  h   h ,i1Yi ,t  uih,t h . For a scalar instrument,
multiplying both sides of this expression by Zt and using Condition LP-IV and the unit effect
normalization (6) yields,

E(Yi ,t  h Zt )
E(Y1,t Zt )

 h,i1 .

(11)

For a vector of instruments, E (Yi ,t  h Z t )HE ( Z tY1,t ) E (Y1,t Z t )HE ( Z tY1,t )   h ,i1 for any positive
definite matrix H. Equation (11) is the moment condition for IV estimation of (10) using
instrument Zt.
Equation (11) holds for all h, including the impact effect h = 0, with the proviso that for h
= 0, the effect for the first variable is normalized to 0,11 = 1. Under the unit effect
normalization, for h = 0 and i = 1, (10) become the identity Y1,t = Y1,t (or Y1.t  Y1.t ).
The question of what control variables to include, if any, is a critical one that depends on
the application.
Even if condition LP-IV (iii) holds, including control variables could reduce the variance
of the regression error and thus improve estimator efficiency. This suggests using control
variables aimed at capturing some of the dynamics of Y1,t and Y2,t. Such control variables could
include lagged values of Y1 and Y2, or additionally lagged values of other macro variables. Such

13

control variables could also include generic controls, such as lagged factors from a dynamic
factor model. Whether or not lagged Y’s are used as controls, under condition LP-IV(iii), leads
and lags of Zt can be included as controls to improve efficiency.
A more difficult problem arises if Conditions LP-IV (i) and (ii) hold, but Condition LPIV (iii) fails because Zt is correlated with one or more lagged shocks. Then instrument validity
hinges upon including in W variables that control for those lagged shocks, so that Condition LPIV (iii) holds. It is useful to think of two cases.
In the first case, suppose Zt is correlated with past values of 1,t , but not with past values
of other shocks. As we discuss below, this situation arises in the Gertler-Karadi (2015)
application, where the construction of Zt induces a first-order moving average structure. In this
case, including lagged values of Z as controls would be appropriate. Another example is oil
supply disruptions arising from political disturbances as in Hamilton (2003) and Kilian (2008),
where the onset of the disruption might plausibly be unpredictable using lagged 's, but the
disruption indicator could exhibit time series correlation because any given disruption could last
more than one period. If so, it could be appropriate to include lagged values of Z as controls, or
otherwise to modify the instrument so that it satisfies condition LP-IV (iii).
A second case arises when Zt is correlated with past shocks including those other than 1,t .
If so, instrument validity given the controls requires that the controls span the space of those
shocks. If it were known which past shocks were correlated with Z, then application-specific
reasoning could guide the choice of controls, akin to the first case. But without such information,
the controls would need to span the space of all past shocks. This reasoning suggests using
generic controls. One such set of generic controls would be a vector of macro variables, say Yt.
Another such set could be factors estimated from a dynamic factor model; using such factors
would provide a factor-augmented IV estimate of the structural impulse response function. We
show in Section 3.2 that the requirement that Condition LP-IV (iii) be satisfied by generic
controls, when Condition LP-IV (iii) does not hold, is quite strong.
2.5 LP-IV: Econometric Odds and Ends
Levels, differences, and cumulated impulse responses. In many applications, Yi,t will be
specified in first differences, but interest is in impulse responses for its levels. Impulse responses

14

for levels are cumulated impulse responses for first differences. The cumulated impulse
responses can be computed from the IV regression,
h

Y
k 0

i ,t  k

cum

  cum
Wt  uih,t,cum
h ,i1 Y1,t   h
h

(12)

where  cum
h ,i1   k  0  k ,i1 . For example, if Yi,t = ΔlnGDPt, then the left-hand side of (12) is
h

ln(GDPt+h) – ln(GDPt), that is, the log-point change in GDP from t to t+h.
If Zt satisfies LP-IV, it is a valid instrument for IV estimation of (12).
Another measure of a dynamic causal effect is the ratio of cumulative impulse responses.
For example, a shock to government spending typically induces a flow over time of government
outlays. As discussed by Ramey and Zubairy (2017, Section 3.2.2), a useful measure of the effect
on output of government spending is the cumulative GDP gain resulting from cumulative
government spending over the same period. Fieldhouse, Mertens, and Ravn (2017) make a
similar argument for considering ratios of cumulative multipliers in their study of the effect on
residential investment of U.S. housing agency purchases of mortgage-backed securities. As
Ramey and Zubairy (2017) point out, this ratio of cumulative multipliers can be estimated in the
LP-IV regression,
hi

h1

k 0

k 0

Wt  uih,it,h1h ,
 Yi,t k  ih1i ,h1  Y1,t  k  hcum
i , h1

where ih1i ,h1 =



hi
k 0

 k , i1



h1
k 0

(13)

 k ,11 (in (13), we generalize Ramey and Zubairy (2017) slightly

to allow for different cumulative periods for Yi and Y1). When the instrument Zt satisfies
condition LP-IV, E  ki0 Yi ,t  k zt =
h



hi
k 0

 k ,i1  and E  k10 Y1,t  k zt =
h



h1
k 0

 k ,11  . Thus,

when there is a single instrument, the IV moment condition is E  ki0 Yi ,t  k zt E  k10 Y1,t  k zt =
h



hi
k 0

 k , i1



h1
k 0

h

 k ,11 = ih1i ,h1 . Thus, if Zt satisfies LP-IV, it is a valid instrument for IV

estimation of (13).

15

HAC/HAR inference and long-horizon impulse responses. When the instruments are
strong, the validity of inference can be justified under standard assumptions of stationarity, weak
dependence, and existence of moments (see for example Hayashi (2000)). However, the
multistep nature of the direct regressions in general requires an adjustment for serial correlation
of the instrumenterror process: the error terms in (7), (10), and (12) include future and lagged
values of t, and in general terms like Ztt+j and Zt+jt will be correlated. Inference based on
standard heteroskedasticity- and autocorrelation robust (HAR) covariance matrix estimators are
valid at short to medium horizons.
One special case in which HAR inference is not needed is when the Ws are lagged Ys, the
VAR for Y is invertible, and the Zs are serially uncorrelated conditional on the Ws. In this case,

Ztuthh is serially uncorrelated4 and standard heteroskedasticity-robust standard errors can be
used. If in addition the errors are homoskedastic, homoskedasticity-only standard errors can be
used.
Historical and forecast error variance decompositions. The historical decomposition
decomposes the path of Yt to the contributions of the individual shocks. The contribution of
shock 1,t to Yi,t+h can be read off the structural moving average representation (5):
Historical contribution of 1,t to Yi,t+h = h,i11,t .

(14)

The forecast error variance decomposition (FEVD) decomposes the variance of the
unforecasted change in a variable h periods hence to the variance contributions from the shocks
that occurred between t and t+h. Because the shocks are uncorrelated over time and with each
other, this decomposition, expressed in R2 form, is
h 1

FEVDh ,i1 

4


k 0

 2

2
k ,i1

1

var Yi ,t  h |  t ,  t 1 ,...

.

(15)

This result follows by direct calculation using the invertibility results in Section 3.2.
16

If 1,t can be recovered, then the historical decomposition can be computed using the LPIV estimates of {h,j1}, h = 0, 1, 2,….. Similarly, if  21 and var Yi ,t  h |  t ,  t 1 ,... are identified,
then the forecast error variance decomposition is identified and also can be computed using the
LP-IV estimates of h,j1, h = 0, 1, 2,….
In general, even though Conditions LP-IV and LP-IV serve to identify the impulse
response function, they do not identify either 1,t or  21 without additional assumptions. A
sufficient condition for identifying 1,t and the FEVD is that the VAR for Yt is invertible; a
somewhat weaker condition for identifying 1,t (but not the FEVD) is that Yt is partially
invertible. Weaker yet is the “recoverability” condition discussed in Plagborg-Møller and Wolf
(2017) and Chahrour and Jurado (2017). Further discussion, including expressions for 1,t ,  21 ,
and the FEVD, are deferred until the next section.
Smoothness restrictions. The IV estimator of (7), (10), and (12) impose no restrictions
across the values of the dynamic causal effects for different horizons. In many applications,
smoothness across horizons is sensible. The VAR methods discussed in the next section impose
smoothness by modeling the structural moving average (5) as the inverse of a low-order VAR,
however as is discussed in that section those methods require the additional assumption that

(L) is invertible. A few recent papers develop methods for smoothing IRFs estimated by local
projections using OLS. Plagborg-Møller (2016a) and Barnichon and Brownlees (2017) use
smoothness priors to shrink the IRFs across horizons. Miranda-Agrippino and Ricco (2017)
smooth LP IRFs by shrinking them towards SVAR IRVs. Although these papers develop these
methods for OLS estimates of LP and SVARs, the extension to IV estimates seems
straightforward.
Weak instruments. If the instruments are weak, then in general the distribution of the IV
estimator in (7), (10), and (12) is not centered at h,i1, and inference based on conventional IV
standard errors is unreliable. However, a suite of heteroskedasticity- and autocorrelation-robust
methods now exists to detect weak instruments and to conduct inference robust to weak
instruments in linear IV regression. For example, see Kleibergen (2005) for a HAR version of
Moreira’s (2003) conditional likelihood ratio statistics, and Andrews (2017) and Montiel Olea

17

and Pflueger (2013) for HAR alternatives to first-stage F statistics for detecting weak
identification.
As previously discussed, HAR inference is not needed in the special case that the Ws are
lagged Ys, the VAR for Y is invertible, and the Zs are serially uncorrelated conditional on the Ws.
If in addition the errors are homoskedastic, then the suite of tools for weak identification in
homoskedastic cross-section data can be applied, including the usual first-stage F statistic for
assessing instrument strength.
News shocks and the unit-effect normalization. In some applications interest focuses on
a “news shock,” which is defined to be a shock that is revealed at time t, but has a delayed effect
on its natural indicator. For example, Ramey (2011) argues that many fiscal shocks are news
shocks because they are revealed during the legislature process but have direct effects on
government spending and/or taxes only with a lag. Despite this lag, forward looking variables,
like consumption, investment, prices, and interest rates may respond immediately to the shock.
This differential timing changes the scale normalization for the shock because 0,11 may equal
zero; that is, the news shock 1,t affects its indicator Y1,t only with a lag. Thus, the
contemporaneous unit-effect normalization (0,11 = 1) is inappropriate.
Instead, for a news shock, a k-period ahead unit-effect normalization, k,11 = 1 for prespecified k, should be used. For example, if government spending reacts to news about spending
with a 12-month lag, then the 12-month-ahead unit-effect normalization 12,11 = 1 would be
appropriate: this normalizes the spending shock so that a 1 pp increase in the shock at time t
corresponds to a 1 pp increase in observed government spending 12 months hence. With this kperiod ahead normalization, Y1,t+k = 1,t  { t k ,...,  t 1 ,  2:n,t ,  t 1,  t 2 ,...} . Accordingly, Y1,t+k
replaces Y1,t in the IV regressions (7), (10), and (12). In practice, implementing this strategy
requires a choice of the news lead-time k, and this choice would be informed by applicationspecific knowledge.
3. Identifying Dynamic Causal Effects using External Instruments and VARs
Since Sims (1980), the standard approach in macroeconomics to estimation of the
structural moving average representation (5) has been to estimate a structural vector

18

autoregression (SVAR), then to invert the SVAR to estimate (L). This approach has several
virtues. Macroeconomists are in general interested in responses to multiple shocks, and the
SVAR approach provides estimates of the full system of responses. It emerges from the long
tradition, dating from the Cowles Commission, of simultaneous equation modeling of time series
variables. It imposes parametric restrictions on the high-dimensional moving average
representation that, if correct, can improve estimation efficiency. And, importantly, it replaces
the computationally difficult problem of estimating a multivariate moving average with the
straightforward task of single-equation estimation by OLS.
These many advantages come with two requirements. The first is that the researcher has
some scheme to identify the relation between the VAR innovations and the structural shocks,
assuming that the two span the same space; this is generally known as the SVAR identification
problem. The second is that, in fact, this spanning condition holds, a condition that is generally
referred to as invertibility. Here, we begin by discussing how IV methods can be used to solve
the thorny SVAR identification problem. We then turn to a discussion of invertibility, which we
interpret as an omitted variable problem.
3.1. SVAR-IV
A vector autoregression expresses Yt as its projection on its past values, plus an
innovation νt that is linearly unpredictable from its past:
A(L)Yt = vt,

(16)

where A(L) = I – A1L – A2L2  … . We assume that the VAR innovations have a non-singular
covariance matrix (otherwise a linear combination of Y could be perfectly predicted). Because
the construction of νt = Yt – Proj(Yt|Yt-1, Yt-2,…) is the first step in the proof of the Wold
decomposition, the innovations are also called the Wold errors.
In a structural VAR, the innovations are assumed to be linear combinations of the shocks
and, moreover, the spaces spanned by the innovations and the structural shocks are assumed to
coincide:

 t  0 t where 0 is nonsingular .
19

(17)

A necessary condition for (17) to hold is that the number of variables in the VAR equal the
number of shocks (n = m).
Because Yt is second order stationary, A(L) is invertible. Thus (16) and (17) yield a
moving average representation in terms of the structural shocks,

Yt  C(L)0 t ,

(18)

where C(L)=A(L)-1 is square summable.
If (17) holds, then the SVAR impulse response function reveals the population dynamic
causal effects; that is, C(L)o = (L).5 Condition (17) is an implication of the assumption that
the structural moving average is invertible. This “invertibility” assumption, which underpins
SVAR analysis, is nontrivial and we discuss it in more detail in the next subsection.
Under the assumption of invertibility, the SVAR identification problem is to identify 0.
Here, we summarize SVAR identification using external instruments.
Suppose there is an instrument Zt that satisfies the first two conditions of condition LPIV, which we relabel as Condition SVAR-IV:
Condition SVAR-IV
(i) E1t Zt     0

(relevance)

(ii) E 2:n ,t Z t  0

(exogeneity w.r.t. other current shocks)

Condition SVAR-IV and (17) imply that,

 Z  
   
1t t
  0     0,11
E t Z t  E  0 t Z t   0 E 
.
0   0,2:n ,1  
 Z  

 2:n ,t t 
5

Note that from (5) and (16), νt = A(L)(L) t . With the addition of condition (17), we have

0 t = A(L)(L) t , so that 0 = A(L)(L), so that (L) = A(L)-10 = C(L)0.

20

(19)

With the help of the unit effect normalization (6), it follows from (19) that, in the case of
scalar Zt,

E ( i ,t Zt )
E ( 1,t Zt )

 0,i1 ,

(20)

with the extension to multiple instruments as follows (8). Thus 0,i1 is the population estimand of
the IV regression,

 i ,t  0,i11,t  { 2:n,t }

(21)

using the instrument Zt.
Because the innovations νt are not observed, the IV regression (21) is not feasible. One
possibility is replacing the population innovations in (21) with their sample counterparts ˆt ,
which are the VAR residuals. However, while doing so would provide a consistent estimator
with strong instruments, the resulting standard errors would need to be adjusted because of
potential correlation between Zt and lagged values of Yt since ˆ1,t is a generated regressor.
Instead, 0,i1 can be estimated by an approach that directly yields the correct largesample, strong-instrument standard errors. Because νi,t = Yi ,t  Proj Yi ,t | Yt 1 ,Yt 2 ,... , equation
(21) can be rewritten as

Yi ,t  0,i1Y1,t   i (L)Yt 1  { 2:n,t } ,

(22)

where γi(L) are the coefficients of Proj Yi ,t  0,i1Y1,t | Yt 1 ,Yt 2 ,... . The coefficients 0,i1 and γi(L)
can be estimated by two-stage least squares equation-by-equation using the instrument Zt. By
classic results of Zellner and Theil (1962) and Zellner (1962), this equation-by-equation
estimation by two stage least squares entails no efficiency loss – is in fact equivalent to – system
estimation by three stage least squares.

21

To summarize, SVAR-IV proceeds in three steps:
1. Estimate (22) using instruments Zt for the variables in Yt, using p lagged values of Yt
as controls. This, along with the unit effect normalization 0,11 = 1, yields the IV

ˆ SVAR  IV .
estimator of the first column of 0, 
0,1
2. Estimate a VAR(p) and invert the VAR to obtain Ĉ(L) = Â(L)1 .
3. Estimate the dynamic causal effects of shock 1 on the vector of variables as

ˆ SVAR  IV  Cˆ 
ˆ SVAR  IV .

h ,1
h 0,1

(23)

It is useful to compare the SVAR-IV and LP-IV estimators. For h = 0, the SVAR-IV and
LP-IV estimators of 0,i1 are the same when the control variables Wt are Yt-1, Yt-2,…, Yt-p. For h >
0, however, the SVAR-IV and LP-IV estimators differ. In the SVAR-IV estimator, the impulse
response functions are generated from the VAR dynamics. In contrast, the LP-IV estimator does
not use the VAR parametric restriction: the dynamic causal effect is estimated by h distinct IV
regressions, with no parametric restrictions tying together the estimates across horizons.
Inference. Let  denote the unknown parameters in A(L) and 0,1 (the first column of

0). Under standard regression and strong instrument assumptions (e.g., Hayashi (2000)),





p
ˆ SVAR  IV from Step 3 is a smooth function of
T ˆ   
 N(0,  ) . And, because estimator 
h ,1

̂ ,





d
ˆ SVAR IV   
T 
 N(0,  ) where  can be calculated using the -method.
h ,1
h ,1

Alternatively, and often more conveniently, confidence intervals can be computed using a
parametric bootstrap. Doing so requires specifying an auxiliary process for Zt. We provide some
details in the appendix in the context of our empirical illustration.

ˆ SVAR  IV is not normal;
When instruments are weak, the asymptotic distribution of 
h ,1
Montiel-Olea, Stock and Watson (2017) discuss weak-instrument robust inference for SVARs
identified by external instruments.
We stress that the normalization of ultimate interest – typically the unit effect
normalization – needs to be incorporated into the computation of standard errors. In general, it is
incorrect to use a different normalization (such as the unit standard deviation normalization),

22

compute confidence bands, then rescale the bands and point estimates to obtain the unit effect
normalization. In practice, this means the unit effect normalization must be “inside” the
bootstrap, not “outside.”
Different data spans for Z and Y (“unbalanced panels”). The SVAR-IV estimator of the

ˆ SVAR  IV . In general these can be
impulse response function in (23) has two parts, Ĉh and 
0,1
estimated over different sample periods. For example, in Gertler-Karadi (2015), the data on the
macro variables Yt are available for a longer period than are data on the instruments, and they

ˆ SVAR  IV over the shorter sample
estimate the VAR coefficients A(L) over the longer sample and 
0,1
when Zt is available. Using the longer sample for the VAR improves efficiency at all horizons.
In contrast, there is less opportunity to improve efficiency by using the longer sample for

Y using LP-IV. If Z satisfies condition LP-IV, then the estimation must all be done on the shorter
sample because the moments in (8) are only available over the period of overlap of the Y and Z
samples. If control variables are included, the longer sample can be used to estimate Yt  and Yt h
, but the moments in (11) must still be estimated over the period of overlap of the Y and Z
samples.
A related limitation of LP-IV is that the number of observations available for estimation
decreases with the horizon h. This is true regardless of whether the data samples for Z and Y are
the same, but becomes more of an issue (compared to SVAR-IV) if the sample for Z is already
short.
News shocks and the unit-effect normalization. A structural moving average may be
invertible even when it includes news shocks as long as Yt contains forward-looking variables.
But, as in analysis in the previous section, news variables require a change in the unit-effect
normalization from contemporaneous 0,11 = 1 to k periods ahead k,11 = 1. To implement this
normalization in the SVAR, note that the effect of t on Yt+k is given by ηt = kt = Ck0t = Ckvt.
The k-period ahead unit-effect normalization is k,11 = 1, so η1,t = 1,t  { 2:n,t } . Thus, letting Xt =

Cˆ k Yt, the normalization is implemented by replacing Y1,t with X1,t in (22) and carrying out the
three steps given above. Because X1,t is a generated regressor, standard errors differ from the
model using Y1,t and are most easily calculated using simulation (parametric bootstrap) methods
like those outlined in the appendix.

23

Historical and forecast error variance decompositions. As discussed in Section 2.4, if
the shock 1,t is identified, then the historical decomposition can be computed using (14). The
forecast error variance decomposition, given in (15), further requires identification of  21 and the
object in the denominator of that expression. The IRFs (’s) appearing in (14) and (15) can be
estimated using either LP-IV or SVAR-IV. By using the same estimator for the IRFs and the
historical decompositions, the set of results will be internally consistent.
The shock 1,t ,  21 , and the denominator of (15) are all identified from 0,1 if the VAR is
1
invertible. Specifically, if (17) holds, then 1,t    t , where λ = 0,1



1
follows from this expression that  21 =    = 0,1
0,1



1





1

0,1 .6 It

0,1

. Also, under invertibility the

denominator of (15) is var(Yi ,t h |  t ,  t 1 ,...) = var(Yi ,t h | t , t 1 ,...) = var(Yi ,t h | Yt ,Yt 1 ,...) , so the
denominator is also identified. Thus, if 0,1 is identified and if the VAR is invertible, the
historical decomposition and FEVD are also identified.
Recall that if LP-IV is implemented using the control variables Wt = Yt-1, Yt-2,…, then

ˆ LP IV = 
ˆ SVAR  IV . If so, the values of λ and  2 computed using LP-IV and SVAR-IV are the

0,1
0,1
1
same, as is the expression in the denominator of (15). Even if LP-IV is implemented using a
reduced set of controls or, if Condition LP-IV holds, no controls, the full VAR must be used to
obtain the innovations needed to compute λ and  21 .
3.2. Invertibility, Omitted Variable Bias, and the Relation between Assumptions SVAR-IV
and LP-IV

6



1
To show this result, first write 0,1
 t = 0,1 0  0



1

 t =  0,1 (0 ) 1 101 t =

e11 t = 1,t /  21 , where the first line uses (17) to write   0  0 ; the second line uses
invertibility of 0; the third line uses the fact that A-1A1 = e1 (the first unit vector) where A1 is
the first column of the invertible matrix A and uses (17) plus invertibility to write  t  01 t ; and
the final line uses the assumption that 1,t is uncorrelated with  2:n,t . Similar algebra shows that
1
 0,1
 0,1 = 1 /  21 , and the result follows.

24

The structural moving average (L) in (5) is said to be invertible if t can be linearly
determined from current and lagged values of Yt :

 t  Proj   t Yt , Yt 1 ,... .

(invertibility)

(24)

In the linear models of this lecture, condition (24) is equivalent to saying that (L)-1 exists.7 The
reason we state the invertibility condition as (24) is that it is closer to the standard definition, t =
E(t | Yt, Yt 1, … ), which applies to nonlinear models as well.
In this subsection, we make four points. First, we show that (24), plus the assumption that
the innovation covariance matrix is nonsingular, implies (17). Second, we reframe (24) to show
how very strong this condition is: under invertibility, a forecaster using a VAR who magically
stumbled upon the history of true shocks would have no interest in adding those shocks to her
forecasting equations. Third, this reframing provides a natural reinterpretation of invertibility as
a problem of omitted variables; thus LP-IV can be seen as a solution to omitted variables bias,
akin to a standard motivation for IV regression in microeconometrics. Fourth, we show that there
is, at a formal level, a close connection between the choice of control variables in LP-IV and
invertibility. Specifically, we show that, for a generic instrument Zt, using lagged Yt as control
variables to ensure that Condition LP-IV holds is equivalent to assuming that Condition SVARIV and invertibility (24) both hold.
Demonstration that invertibility (24) implies (17). This result is well known but we show

it here for completeness. Recall that by definition, νt = Yt - Proj Yt | Yt 1 ,Yt 2 ,... =

(L) t  Proj  (L) t | Yt 1 , Yt 2 ,... = 0 t   i 1 i  t i  Proj   t i | Yt 1 , Yt  2 ,...  , where the


second equality uses (5), and the third equality uses the fact that Proj   t | Yt 1 ,Yt 2 ,... = 0 and
collects terms. Equation (24) implies that Proj   t i | Yt 1 , Yt  2 ,...   t i , so the term in brackets in
the final summation is zero for all i; thus we have that  t  0 t as in (17).

By (L)-1 existing we mean that it is a square-summable limit of a sequence of matrix
polynomials in positive powers of L
7

25

To see why (24) implies that 0 is invertible, note that  t = Proj   t | Yt ,Yt 1 ,... =

Proj   t | t , t 1 ,... = Proj   t | 0 t , 0 t 1 ,... = Proj  t | 0 t  = Proj  t | t  , where the first
equality is (24), the second follows because current and past innovations span the space of
current and past Y’s, the third and fifth follows from  t  0 t , and the fourth follows from the
serial independence of  t . Because  t = Proj   t | t  , the equation  t  0 t must yield a
unique solution for  t , so that 0 has rank m. Moreover, because var(vt) is assumed to have full
rank, n ≤ m. Taken together these imply that n = m and 0 has rank n. Therefore, if (24) holds,
then (17) holds.
Invertibility as omitted variables. One interpretation provided in the literature on

invertibility is that invertibility implies that there are no omitted variables in the VAR (e.g.
Fernández-Villaverde et. al. (2007)): because invertibility implies that the spans of εt and νt are
the same, there is no forecasting gain from adding past shocks to the VAR. That is, the
invertibility condition (24) implies that,8

Proj(Yt | Yt 1 ,Yt 2 ,...,  t 1 ,  t 2 ,...)  Proj(Yt | Yt 1 ,Yt 2 ,...) .

(25)

Condition (25) both shows how strong the assumption of invertibility is, and provides an
interpretation of invertibility as a problem of omitted variables. If invertibility holds, then
knowledge of the history true shocks would not improve the VAR forecast. If instead those
forecasts were improved by adding the shocks to the regression – infeasible, of course, but a
thought experiment – then the VAR has omitted some variables, and that omission is an
indication of the failure of the invertibility assumption.9
8

Equation (25) follows from (17) by writing, Proj Yt | Yt 1 , Yt 2 ,...,  t 1 ,  t 2 ,... =

Proj Yt | t 1 , t 2 ,...,  t 1 ,  t  2 ,... = Proj Yt | t 1 , t 2 ,... = Proj Yt | Yt 1 , Yt  2 ,... , where the first
and third equalities uses the fact that the innovations are the Wold errors, and the second equality
uses the implication of (17) that span(εt) = span(νt) .
9
Condition (25) is closely related to Proposition 3 in Forni and Gambetti (2014), which states
(with some refinements) that the structural moving average is invertible if no added state variable
in a VAR have predictive content for Yt. That observation leads to their test for invertibility,
which involves estimating factors using a dynamic factor model and including them in the VAR.
26

In general, one solution to omitted variable problems is to include the omitted variables
in the regression. In the case at hand, that is challenging, because the omitted variables are the
unobserved structural shocks. Pursuing this line of reasoning suggests using a large number of
variables in the VAR, a high dimensional dynamic factor model, or a factor-augmented vector
autoregression (FAVAR). This is a potentially useful avenue to dealing with the invertibility
problem, see for example Forni, Giannone, Lippi, and Reichlin (2009) and the survey in Stock
and Watson (2016).10
It is important to note that expanding the number of variables will not necessarily result
in (24) being satisfied, so that moving to large systems does not assure invertibility.
Relation between assumptions SVAR-IV, LP-IV, and invertibility. A major appeal of

LP-IV is that the direct regression approach does not explicitly assume invertibility. If, however,
the instrument depends on lagged shocks and lagged Ys are used as control variables, then in
general the instrument is valid with these controls (i.e., condition LP-IV⊥ holds) if and only if
condition SVAR-IV holds and that the SVAR is invertible. Intuitively, if the instrument depends
on lagged shocks, the control variables must span the space of those shocks; but the requirement
that the Ys span the space of the shocks is simply the invertibility condition. This result is stated
in the following theorem.
Theorem 1. Let Z denote the set of scalar stochastic processes (instruments) such that for

all Z ∈ Z, Z satisfies LP-IV conditions (i), (ii), and (iii for j > 0), but not (iii for j < 0).
Let Wt = {Yt-1, Yt-2, …}. Then LP-IV⊥ is satisfied for all Z ∈ Z if and only if (a) Z
satisfies Condition SVAR-IV and (b) the invertibility condition (24) holds.
Proof. We first show that condition SVAR-IV plus invertibility (24) implies condition

LP-IV⊥. First note that for j ≥ 0, Proj( t  j | Yt 1 , Yt  2 ,...) = 0 so  t j =  t  j  Proj( t  j | Yt 1 , Yt  2 ,...)

10

Aikman, Bush, and Taylor (2016) use lagged macro factors as controls in local projection OLS
regression, which they call factor-augmented local projections. This method is the local
projection counterpart of FAVARs.
27

 t  j . Thus, for j ≥ 0, E   t j Zt  = E  t  j  Z t  Proj( Z t | Yt 1 , Yt  2 ,...)   = E   t  j Z t  . Setting j =
0, it follows that SVAR-IV (i) and (ii) are equivalent to LP-IV (i) and (ii). In addition,
Condition LP-IV (iii for j > 0) (which holds by definition of Z) is equivalent to Condition LPIV (iii for j > 0). For j < 0, (24) directly implies that  t  j = Proj   t  j | Yt 1 , Yt  2 ,... , so  t j = 0
and thus E   t j Zt  = 0 trivially; thus (24) implies LP-IV⊥(iii for j < 0). Thus condition SVARIV plus (24) implies condition LP-IV⊥ for all Z ∈ Z.
We now show that, if condition LP-IV⊥ holds for all Z ∈ Z, then conditions SVAR-IV
and (24) hold. First, as noted above, LP-IV⊥ (i) and (ii) are equivalent to SVAR-IV (i) and (ii). It
remains to show that, if LP-IV⊥ (iii) holds for all Z ∈ Z, then (24) holds. Consider Z ∈ Z, and let



Zt = Zt   t 1 ; by construction, Z ∈ Z. Because LP-IV⊥ holds by assumption for all Z ∈ Z, it


holds in particular for Z and Z , so LP-IV⊥ (iii, j < 0) implies that E  t1Zt = E  t1Zt = 0.




2
But E  t1Zt = E  t1Zt  E  t1 , so it must be that E  t1









 

 

2







= 0; but E( et^-1 )2 = 0 implies

that (24) holds.
We interpret this theorem as a “no free lunch” result. Although LP-IV can estimate the
impulse response function without assuming invertibility, to do so requires an instrument that
either satisfies LP-IV (iii) or that can be made to do so by adding control variables that are
specific to the application. Simply including past Y’s out of concern that Zt is correlated with past
shocks is in general valid if and only if the VAR with those past Y’s is invertible; but if so, it is
more efficient to use SVAR-IV.11

11

It is well known that in VARs, distributions of estimators of impulse response functions are
generally not well approximated by their asymptotic distributions in sample sizes typically found
in practice. A more relevant comparison would be of the efficiency of the estimators in a
simulation calibrated to empirical data. Kim and Kilian (2011) did such an exercise comparing
LP and SVAR estimators, with identification by a Cholesky decomposition (what we would call
28

3.3. Observable Shocks, VAR Misspecification, and Partial Invertibility

The external instrument approach to impulse response estimation treats shock measures,
such as the Romer and Romer (1989) narrative shocks or a monetary announcement surprise as
in Kuttner (2001), as instrumental variables. Originally, however, that literature treated those
measures as the shocks directly. Given our focus on invertibility, we therefore briefly digress to
consider issues of VAR specification when the shock of interest is observed. We will refer to the
situation in which 1,t is observed, or at least is recoverable from the VAR innovations νt, as
partial invertibility: we will say that the VAR is partially invertible if there is some λ such that

1,t = λ´νt. The leading case is the observed shock case in which λ = (1 0 … 0)´, with the
observed shock ordered first in the VAR. Here, we first consider partial identification in the case
that λ is identified without assuming full invertibility (the “observed shock” case), so that the
shock can be used directly as a regressor. We then contrast this with the case of identification by
external instruments.
First consider the case that 1,t is observed, and let Y1,t = 1,t , and as usual let Y2:n,t denote
the remaining Y’s. Write the structural moving average representation for Y2:n,t as Y2:n,t =

1 (L)1,t  t , where ωt is the distributed lag all the shocks other than 1,t . Because ωt is
stationary, it has a population VAR representation, ωt = A22 (L)t 1   t . Premultiplying Y2:n,t =

1 (L)1,t  t by I  LA22 (L) and rearranging yields, Y2:n,t =
( I  LA22 (L))1 (L)1,t  A22 (L)Y2:n,t 1   t = A21 (L)1,t 1  A22 (L)Y2:n,t 1  0,11,t   t , where
A21 ( L) = L1 ( I  LA22 (L))1 (L)  0,1  (note that the leading term of ( I  LA22 (L))1 (L) is
0,1). The expressions for Y1,t and Y2:n,t combine to yield the VAR,

 Y1,t   0
Yt  

 Y2:n,t   A21 (L)

0   Y1,t 1    1,t 

 , where

A22 (L)   Y2:n ,t 1   2:n ,t 

  1,t   1 0   1,t 


  .
 2:n,t   0,1 I    t 

(26)

internal instruments). Their results are consistent with improvements in efficiency, and tighter
confidence intervals, for SVARs than LP.
29

Assuming correct lag specification, the VAR coefficient estimator is consistent for the
population lag matrix in (26). The lack of feedback in the population VAR coefficient matrix to
the first variable, combined with the lower triangular error structure in (26), imply that the IRFs
produced by a Cholesky factorization of the VAR innovations, with the observed shock ordered
first, produce an IRF that simply iterates on the second block of equations. That is, the IRF is
computed from the difference equation Y2:n,t = ( I  LA22 (L))1 (L)1,t  A22 (L)Y2,t 1 , which yields
the IRF 1 (L) .
The conclusion that the VAR “ 1,t first” IRF is consistent for 1 (L) was reached without
ever assuming that t spans the space of the remaining shocks: the VAR can have omitted
variables in the sense that the shocks are not fully observable. The reason for this result is that

1,t is strictly exogenous. Because of this strict exogeneity, 1 (L) can be consistently estimated
by a distributed lag regression of Y2:n,t on 1,t , an autoregressive distributed lag regression, by
GLS, or using a VAR with arbitrary choice of VAR variables, including a choice of VAR
variables that differs from one variable of interest to the next.
These observations all extend to the case of partial invertibility, in which there is an
identified λ such that 1,t =   t . Let  be a n×(n-1) matrix such that  = 0 and  = I. Then
the algebra of the preceding paragraph goes through using the transformed variables Yt =

Y

1,t

 



, Y2:n,t =  Yt , Y .
Returning to IV methods, an implication of these observations is that if the IV methods

identify λ such that 1,t =   t , then the additional assumption of invertibility of the SVAR can
be dispensed with for the validity of SVAR-IV. This said, as discussed in Section 3.2,
identification of 0,1 is insufficient to identify λ, and the expression for λ given there (that λ =
1
0,1





1

0,1 was derived under the invertibility assumption (17). While the partial

0,1

invertibility assumption that 1,t =   t is weaker than invertibility assumption (17), it remains

30

to be seen whether there are empirical applications in which this weaker condition would hold
but invertibility does not.12
4. A Test of Invertibility

Suppose one has an instrument that satisfies condition LP-IV. Under invertibility, SVARIV and LP-IV are both consistent, but SVAR-IV is more efficient, at least under
homoskedasticity. If, however, invertibility fails, LP-IV is consistent but SVAR-IV is not. This
observation suggests that comparing the SVAR-IV and LP-IV estimators provides a Hausman
(1978)-type test of the null hypothesis of invertibility. Throughout, we maintain the assumption
that Yt has the linear structural moving average (5). We additionally assume the VAR lag length
p is finite and known.
Before introducing the test, we make precise the null and alternative hypothesis. We also
provide a nesting of local departures from the null, which we refer to as local non-invertibility.
Null and local alternative. Under invertibility (24), the structural moving average can be

written Yt = C ( L)0 t as in (18), where C(L) = A(L)-1; that is, that (L) = C(L)0. The null and
alternative hypotheses thus are,
H0: Ch0,1 = h,1, all h v. H1: Ch0,1 ≠ h,1, some h.

(27)

In addition to establishing the null distribution of the test, we wish to examine its
distribution under an alternative to check that the test has power against non-invertibility.
Beaudry et. al. (2015) and Plagborg-Møller (2106b) provide numerical evidence that in many
cases the noninvertible (nonfundamental) representation of a time series may be very close to its
invertible representation. With this motivation, we focus on noninvertible IRFs that represent
small departures from an invertible null.

12

Evidently, without partial invertibility or recoverability, the historical and forecast error
variance decompositions in (14) and (15) are not point-identified. Plagborg-Møller and Wolf
(2017) derive set identification results for these decompositions using external instruments in the
absence of invertibility or recoverability.
31

Specifically, we consider the drifting sequence of alternatives:
Ch ,T  0,1   h ,1  T 1/2 d h  o(T 1/2 ) ,

(28)

where under the null dh = 0, while under the alternative dh is a nonzero n×1 vector for at least
some h > 0. In Appendix A.1, we construct a sequence of models that are noninvertible because
of a small amount (specifically, Op(T-1/4)) of measurement error contamination, and show that
this sequence of models induces local non-invertibility of the form (28).
Test of invertibility. We now turn to the test statistic. Let ˆ SVAR  IV denote an m×1 vector

of SVAR -IV estimators (23), computed using a VAR(p), for different variables and/or horizons,
and let ˆ LP  IV denote the corresponding LP-IV estimators. Compute the LP-IV estimator using
as control variables the p lags of Y that appear in the VAR; because Zt satisfies condition LP-IV,
including these lags as controls is not necessary for consistency but makes the two statistics
comparable for use in the same test statistic.
It is shown in the appendix that, with strong instruments and under standard
moment/memory assumptions, under the null and local alternative,

(

)

d
T qˆLP-IV - qˆSVAR-IV ¾¾
 N(d ,V ) ,

(29)

where d consists of the elements of {dh} corresponding to the variable-horizon combinations that
comprise qˆ LP- IV and qˆ SVAR-IV .
The Hausman-type test statistic is,

x = T (qˆ LP-IV - qˆSVAR-IV )¢Vˆ -1 (qˆ LP-IV - qˆSVAR-IV ) ,

(30)

d
 cm2 .
where Vˆ is a consistent estimator of V. Under the null of invertibility, x ¾¾

We make four remarks about this test.
1. We suggest computation of the variance matrix Vˆ using the parametric bootstrap, and we
discuss some specifics in Appendix A.2.

32

2. The LP-IV and SVAR-IV estimators for the impact effect (h = 0) are identical when
lagged Ys are used as controls. Thus this test compares the LP-IV and SVAR-IV
estimates of the impulse responses for h  1. This test therefore assesses the validity of
the parametric restrictions imposed by inverting the SVAR, compared to direct estimation
of the impulse response function by LP-IV. Here, we have maintained the assumption
that the structural moving average is linear and the VAR lag length is finite and known.
Under these maintained assumptions, any divergence between the SVAR impulse
responses and the direct estimates, in population, is attributable to non-invertibility.
3. Under the local alternative (28), the test statistic has a noncentral chi-squared distribution
with m degrees of freedom and noncentrality parameter 2 = dV-1d . The expressions in
the Appendix show that, for a given local alternative d, the noncentrality parameter is
zero if  = 0, and increases to a finite limit as  increases. Thus the power of the test is
increasing as the strength of the instrument increases, according to this local stronginstrument approximation.
4. Existing tests for invertibility (e.g. Forni and Gambetti (2014)) test the implication of
invertibility that Zt does not Granger-cause Yt. The test here differs because it focuses not
on forecasting contribution, but on the object of interest in the analysis, the impulse
response function. In both approaches – directly testing Granger non-causality and the
Hausman-type test approach here, the testable implications all stem from moments
involving Z: second moments of Y alone cannot distinguish invertible from non-invertible
processes.
5. Illustration: Gertler-Karadi (2015) Identification of the Dynamic Causal Effect of
Monetary Policy

Gertler and Karadi (2015) use the SVAR-IV method to estimate the effect of a monetary
policy shock on real output, prices, and various credit variables, and Ramey (2016) applies LPIV to their data to illustrate the differences between the two methods. Here, we extend Ramey’s
comparison and formally test invertibility. We use this application to discuss several
implementation details.

33

Gertler and Karadi’s (2015) benchmark analysis uses U.S. monthly data to estimate the
effect of Federal Reserve policy shocks on four variables: the index of industrial production and
the consumer price index (both in logarithms, denoted here as IP and P), the interest rate on 1year U.S. Treasury bonds (Rt), and a financial stress indicator, the Gilchrist and Zakrajšek (2012)
excess bond premium (EBP). We first-difference IP and P, so the vector of variables is Yt = (Rt,
100IP, 100P, EBP), where R and EBP are measured in percentage points at annual rate and
IP and P are multiplied by 100 so these variables are measured in percentage point growth
rates.
Gertler and Karadi (GK) identify the monetary policy shock using changes in Federal
Funds futures rates (FFF) around FOMC announcement dates. In doing so, they draw on insights
from Kuttner (2001) and others who argued that this measure is plausibly uncorrelated with other
shocks because they are changes across a short announcement window. Whereas the original
literature treated such a measure as the shock, GK use it as an instrument; that is, Zt = FFFt.
Column (a) of Table 1 shows results for the LP-IV regression (7), the equation without
controls, using the GK data that span 1990m1 – 2012m6. Standard errors in Table 1 for LP-IV
impulse responses are Newey-West with h+1 lags. We highlight three results. First, the table
shows that the estimated contemporaneous (h = 0) effect of monetary policy shocks on interest
rates (R) is 0,11 = 1.0; this is the unit-effect normalization. Second, the first-stage F-statistic 
that is the (standard) F-statistic from the regression of Rt onto FFFt  is small, only 1.7, raising
weak instrument concerns. Third, the estimated standard errors for the estimated causal effects
are large, particularly for large values of h.
These final two results are related. To see why, rewrite equation (5) to highlight the
various components of Yi,t+h:

Yi ,t h  h,i11,t  { t h ,...,  t 1}  { 2:n,t }  { t 1 ,...}

(31)

where, again, the notation {∙} denotes a linear function of the variables included in the braces.
The first-stage F-statistic is from the regression of Y1,t (= Rt) onto Zt (= FFFt). From (31), the
error term in the first-stage regression is comprised of { 2:n,t } and { t 1 ,...} . Because interest
rates are very persistent, only a small fraction of the variance is attributable to contemporaneous

34

shocks, t; a fraction of this contemporaneous effect is associated with the monetary policy shock

1,t , and only a fraction of 1,t can be explained by the instrument Zt. Taken together, these
effects yield a first-stage regression with R2 = 0.006 and a correspondingly small F-statistic.
Similar logic explains the large standard errors for the estimated causal effects because these are
associated with IV regressions with error terms comprised of { t h ,...,  t 1}  { 2:n,t }  { t 1 ,...} .
Column (b) of Table 1 repeats the estimation, but now using four lags of Yt and Zt as
controls. The controls serve two purposes. First, because these controls are correlated with
lagged values of ε, they reduce the variance of the regression error term and, for example, the
first-stage (partial) R2 in (b) increases to R2 = 0.09 with a first-stage F-statistic increases to F =
23.7. Second, the controls adjust for a data processing issue that makes the FFF variable an
invalid instrument in the LP-IV regression without controls. Specifically, as pointed out by
Ramey (2016), Gertler and Karadi (2015) form their FFF instrument as a moving average of
returns from month t and month t 1. Thus, FFFt will be correlated with both 1,t and 1,t 1 ,
violating Assumption LP-IV (iii). Because Zt has an MA(1) structure, using lags of Zt as controls
eliminates the correlation with 1,t 1 , so that Condition LP-IV (iii) is satisfied. Despite the
MA(1) structure, it is plausible that this instrument is uncorrelated with other shocks. Thus, to
satisfy Condition LP-IV (iii), it would suffice to include Zt-1 as a control; including lagged Ys
and additional lags of Z serves to improve precision (increase the first-stage F).13
If there are more than four shocks that affect Yt, or if some elements of Yt are measured
with error (as IP and P surely are), then the innovations to the four variables making up Yt will
not span the space of the shocks. This is not a problem for the validity of LP-IV with lagged Zs,
however it does suggest that including additional variables that are correlated with the shocks
could further reduce the regression standard error and thus result in smaller standard errors. One
plausible set of such variables are principal components (factors) computed from a large set of
macro variables. With this motivation, column (c) adds lags of four factors computed from the

13

The construction of Zt is described in footnote 6 in GK. The MA(1) structure invalidates the
LP-IV regression reported in column (1), but it does not affect its validity in the SVAR-IV
regression used by GK. An additional issue is that the weights used in GK’s construction of Zt
are time varying because of floating FOMC meeting dates. In principle this could yield a timevarying MA(1) structure but we approximate the MA coefficients as constant.
35

FRED-MD dataset (McCracken and Ng (2016)). In this illustration, these additional controls
yield results that are largely consistent with the results using lags of Z and Y.
Both specification (b) and (c) in Table 1 improve on the model without controls, (a), by
eliminating some of the variability associated with lagged  and in particular by making Z satisfy
LP-IV (iii), whereas (a) does not satisfy LP-IV (iii). However, neither eliminates the variability
associated with of future ’s, the { t h ,...,  t 1} component of the error term shown in (31). The
variability of this component increases with the horizon h, and this is evident in the large
standard errors in estimates associated with long-horizons. When the structural moving average
model is invertible, it is in effect possible to control for both lagged and future values of  in the
IV regression using VAR methods.
Column (d) of Table 1 shows results from a SVAR with 12 lags, with monetary policy
identified by the FFF instrument. Because the data on the Ys are available for a longer span than
the data on the instrument, we follow Gertler and Karadi (2015) and estimate the VAR over the
sample 1980m7-2012m6, while 0,1 is estimated over the sample 1990m1-2012m6 (see the
discussion of data spans towards the end of Section 3.1). Standard errors for the SVAR-IV
estimate are computed by the parametric bootstrap described in the Appendix. Because the VAR
uses 12 lags of Y instead of the 4 lags used as controls in the local projections, the first stage Fstatistics differ slightly in columns (b) and (d). As expected, the standard errors for the estimated
dynamic causal effects are smaller for the SVAR than for the local projections, particularly for
large values of h, for two reasons. First, the local projections are estimated using regressions with
error terms that include leads and lags of  (see (31)), and these terms are absent from the IV
regression used in the SVAR, because only the impact effect, 0, is estimated by IV. Second, the
VAR parameterization imposes smoothness and damping on the moving average coefficients in
Ch, which further reduces the standard errors. Still, in this empirical application, the standard
errors in the SVAR remain large.
The final column of Table 1 shows the difference in estimates of dynamic causal effects
from the LP-IV estimator in column (b) and the SVAR-IV estimator in column (d). These
differences form the basis for the invertibility test developed in the last section, and the standard
errors shown in final column are computed from the parametric bootstrap, which imposes
invertibility. Some of the differences between the SVAR and LP estimates are large, but so are

36

their estimated errors, and none of the differences are statistically significant. Relative to the
sampling uncertainty, the differences in the LP and SVAR estimates shown in Table 1 are not
large enough to conclude that the SVAR suffers from misspecification associated with a lack of
invertibility.
Table 2 shows results for two additional tests for invertibility. The first row shows results
for the test  in (30) for the differences of the LP-IV and SVAR-IV estimates jointly across the
lags shown in Table 1. The second row shows results from Granger-causality tests that include
four lags of Z in each of the VAR equation. Despite the large differences, in economic terms,
between the two estimates of the impulse responses, the table indicates that there is no
statistically significant evidence against the null of hypothesis of invertibility.
6. Conclusions

It is well known that, with Gaussian errors, every invertible model has multiple
observationally equivalent noninvertible representations, so if one is to distinguish among them,
some external information must be brought to bear. One approach is to assume that the shocks
are independent and non-Gaussian, and to exploit higher order moment restrictions to identify
the causal structure (cf. Lanne and Saikkonen (2013), Gospodinov and Ng (2015) and
Gouriéroux, Monfort, and Renne (2017)). A second approach is to use a-priori informative
priors (Plagborg-Møller (2016b)). Here, we have shown that there is a third approach, which is to
use an external instrument. Through an external instrument, additional information can be
brought to bear to identify dynamic causal effects. Under a lead-lag exogeneity condition, the
external instrument identifies the structural impulse response function without assuming
invertibility.
A number of methodological issues concerning the use of external instruments merit
further research. For example, this discussion assumes homogenous treatment effects. Although
this assumption seems plausible in a macroeconomic setting (there is only one “subject,”
although effects may be state-dependent), more work is warranted. Also, the usual weakinstrument toolkit does not cover all the methods used here, for example one open question is
how to robustify our test of invertibility to potentially weak instruments.

37

Additionally, an informal argument sometimes made in favor of the local projections
method is that it is robust to VAR misspecification concerning lag length, nonlinearities, and
state dependence. In this lecture, we have put these arguments to one side by assuming a linear,
constant-coefficient structural moving average representation. To us, the robustness of LP-IV to
nonlinearities is not obvious, particularly when the instrument depends in part on lagged shocks:
if so, the control variables would need to span the space of those shocks, and it seems that there
would be a nonlinear counterpart to our no free lunch theorem (Theorem 1). In any event, it
would be of interest to see these arguments made precise.
In our view, the most exciting work to be done in this area is empirical. We look forward
to the development of new external instruments that provide plausibly exogenous variation to
provide more credible identification of dynamic causal effects.

38

Appendix
A.1 Asymptotic distribution of the Hausman test statistic for invertibility

This appendix derives the asymptotic distribution (29) under the null of invertibility and
under a sequence of local alternatives. For simplicity, we consider the case that the test is based
on all impulse responses for a single horizon h and that the instrument is a scalar; extensions to
multiple horizons and a vector of instruments is straightforward. Accordingly, we show that





d
ˆ SVAR  IV  
ˆ LP  IV 
T 1/2 
 N (d h ,Vh ) . This result implies that the test statistic  given in (30)
h ,1
h ,1

has an asymptotic chi-squared distribution with n degrees of freedom under the null, and a
noncentral chi-squared distribution with noncentrality parameter 2 = d hVh1d h under the local
alternative.
We begin with the analysis under the null of invertibility. The SVAR is
A(L)Yt  (L) t ,

(A.1)

where A(L) is a polynomial of order p. The Wold moving average polynomial is C(L) = A(L)-1 =
I + C1L + … . Under the null hypothesis of invertibility (17), with the maintained hypothesis that
Yt has the linear structural MA representation (5), the structural IRF satisfies H0 in (27), that is,
h,1 = Ch0,1 for all h.
For future reference, we note that the SVAR can be written in state-space form as
Yt  SX t

(A.2)

X t  AX t 1  G t

where Xt = (Yt' Yt-1' … Yt-p+1')', A is the VAR companion matrix, the upper block of G is 0 and
all other elements of G are zero, and S   I n

0  0  is a selection matrix.

The local projection equation, written for the vector Y, is
Yt+h = h,1Y1,t + hWt + uthh ,

(A.3)
39

where the control variables are Wt = Xt-1 and, from (A.2) , h = SAh+1. Consistent with
Assumption LP-IV⊥, we represent Zt as

Zt = 1,t  BWt  et ,

(A.4)

where et is uncorrelated with  s for all t and s. All variables are assumed to be second-order
stationary with sample moments that satisfy





d
 N (0,  ab )
T 1/2  vec at bt  E(at bt ) 

(A.5)

for any variables (at, bt).
The LP-IV estimator is
ˆ LP  IV = (Z'MWY1,0)-1(Yh'MWZ),

h ,1

(A.6)

where Z denotes the T×1 vector of instruments, Y0,1 denotes the T×1 vector (Y1,1 … Y1,T)', Yh
denotes the T×n matrix with t'th row Yt+h', and MW = I – W(W'W)-1W, where W is a T×(np) matrix
with tth row Wt'. The SVAR-IV estimator is
ˆ 
ˆ SVAR  IV  C
ˆ LP  IV ,

h ,1
h 0,1

(A.7)

ˆ
ˆ 1 , where Â(L) is the OLS estimator of A(L).
 A(L)
where C(L)
Under H0 in (27) and the assumption that Zt is a strong instrument, a straightforward
calculation then yields:

40









ˆ  C  LP  IV
ˆ SVAR  IV  
ˆ LP  IV  T 1/ 2 C
T 1/2 
h ,1
h ,1
h
h
0,1
 1  C hT 1/2  Z tut0  T 1/2  Z tuthh   o p (1)

(A.8)

d

 N (0, Vh )

where the result uses Z'MWY1,0 = Z⊥'MW Y1,0 = Z⊥' Y1,0 + Op(1) and similarly for Yh'MWZ,
p
  = E  Zt1,t  , and the delta-method.
T-1Z⊥' Y1,0 

We now consider a sequence of stochastic processes that are local to the invertible model
and the resulting estimators. Specifically, maintain the definitions of all of the variables and
parameters given above (so that Yt is generated by the invertible model, etc.), but now consider
the sequence of stochastic processes Yt,T :
Yt,T = SXt + T-1/4t,

(A.9)

where t is white noise and uncorrelated with  for all t and . Notice that Yt,T = Yt + T-1/4t, so
that var(Yt,T) = var(Yt) + T-1/2var(t), and the autocovariances of Yt,T and Yt coincide for all nonzero lags. The measurement error T-1/4t in (A.9) means that Xt cannot be perfectly recovered
from current and lagged values of Yt,T and t ≠ Proj(t|Yt,T, Yt-1,T, …), so the model is not
invertible.
The implied p-th order VAR for Yt,T is local to the VAR for Yt; that is,
AT(L) = A(L) + T-1/2a(L) + o(T-1/2),

(A.10)

where AT(L) denotes the projection of Yt,T onto (Yt-1,T, … , Yt-p,T). Similarly, the implied moving
coefficients, AT(L)-1 = I + C1,TL + … satisfy Ch ,T  Ch  T 1/2 ch  o(T 1/2 ) . Because Ch0 = h
(the invertible null), we have that Ch ,T  0  Ch 0  T 1/2 ch 0  o(T 1/2 ) = h  T 1/2 d h  o(T 1/2 ) ,
where dh = ch0. Thus, the local contamination in (A.9) implies that the nearly invertible moving
average sequence (28).

41

Let ÂT (L) denote the OLS estimator of AT(L) using Yt,T. A calculation shows that





ˆ (L)  A(L)
ˆ
T 1/2 A
 a (L)  o p (1) and
T





ˆ C
ˆ  c  o (1) .
T 1/2 C
h ,T
h
h
p

(A.11)

Although the VAR and MA models for Yt and Yt,T differ by a T-1/2 component, the LP-IV
estimators using Yt,T and Yt are equivalent to order T-1/2. To see this, write the LP equation as
Yt+h,T = h,1Y1,t,T + h,TWt,T + uthh ,T ,

(A.12)

where Wt,T = (Yt-1,T … Yt-p,T). From (A.2) and (A.12), h,TWt,T = SAh+1× Proj(Xt-1|Wt,T) and uthh ,T =

uthh  T 1/4t  h  gth h , where gth h = SAh+1× [Xt 1  Proj(Xt-1|Wt,T)] = Op(T-1/4). Similarly, let the
instruments satisfy
Zt,T = 1,t  BWt ,T  et ,

(A.13)

where now et is assumed to be uncorrelated with  and  for all t and . Using instruments that
satisfy (A.13) ensures that Condition LP-IV⊥ holds under both the null and local alternative. Let
ˆ LP  IV

h ,1

Y

t ,T



, Z t ,T  denote the LP-IV estimators using {Yt,T, Zt,T}. Using (A.12) and (A.13), it

follows that

Y

ˆ LP  IV
T 1/2  
 h ,1

t ,T



ˆ LP  IV Y , Z    = op(1).
, Z t ,T   
h ,1
t
t


(A.14)

Finally, the SVAR estimator constructed from {Yt,T, Zt,T} is
ˆ SVAR  IV

h

Y

t ,T



ˆ LP  IV
, Z t ,T   Cˆ h ,T 
0

Y

42

t ,T



, Z t ,T  .

(A.15)

Equations (A.8), (A.11), (A.14) and (A.15) imply









ˆ SVAR  IV Y , Z   
ˆ LP  IV Y , Z  
T 1/2 
t ,T
t ,T
h ,1
t ,T
t ,T
 h ,1

ˆ SVAR  IV Y , Z    
ˆ LP  IV Y , Z     c   o (1)
 T 1/ 2 
h ,1
t
t
h ,1
t
t
 h 0,1 p
d

 N (d h , Vh )

(A.16)

where dh = ch0,1.
A.2 Parametric Bootstrap Estimation of Vh

The standard errors of the estimators in Tables 1 and 2 were computed using the sample
variances computed from 1000 draws from a parametric bootstrap. For each draw, we generated
samples of size T for (Yt , Zt ) from the stationary VAR,
ˆ
 A(L)
 0   Svvˆ ˆ
t 
0   Yt  t 

       , where    i.i.d .N    , 
ˆ (L)   Z t   et 
 et 
 0   Sevˆ ˆ
 0

Sveˆ ˆ  
,
Seeˆ ˆ  

(A.17)

where Â(L) is estimated from a VAR(12), ˆ (L) is estimated from an AR(4), and Svvˆˆ , Svvˆˆ , and
Seeˆˆ are sample covariances for the VAR/AR residuals. These samples are used to compute the
SVAR-IV and LP-IV estimates of h,1.

43

References

Aikman, D., O. Bush, and A.M. Taylor (2016), “Monetary versus Macroprudential Policies:
Causal Impacts of Interest Rates and Credit Controls in the Era of the UK Radcliffe
Report.” NBER Working Paper 22380.
Andrews, I. (2017), “Valid Two-Step Identification-Robust Confidence Sets for GMM.”
Forthcoming, The Review of Economics and Statistics.
Angrist, J.D., Ò. Jordà, and G.M. Kuersteiner (2017). “Semiparametric Estimates of Monetary
Policy Effects: String Theory Revisited,” Journal of Business and Economic Statistics,
forthcoming.
Barnichon, R. and C. Brownlees (2016). “Impulse Response Estimation by Smooth Local
Projections,” CEPR Discussion paper DP11726.
Beaudry, P., P. Fève, A. Guay, and F. Portier (2015). “When is Nonfundamentalness in VARs a
Real Problem? An Application to News Shocks,” manuscript, University of British
Columbia.
Beaudry, P. and M. Saito (1998), “Estimating the Effects of Monetary Policy Shocks: An
Evaluation of Different Approaches,” Journal of Monetary Economics 42, 241-260.
Bernanke, B.S. and K.N. Kuttner (2005). “What Explains the Stock Market’s Reaction to Federal
Reserve Policy?”, The Journal of Finance 40, 1221-1257.
Bojinov, I. and N. Shephard (2017). “Time Series Experiments, Causal Estimands, Exact pvalues, and Trading.” manuscript, Harvard University.
Caldara, D. and C. Kamps (2107). “The Analytics of SVARs: A Unified Framework to Measure
Fiscal Multipliers,” forthcoming, The Review of Economic Studies.
Chahrour, R. and K. Jurado (2017). “Recoverability,” manuscript, Duke University.
Cochrane, J.H., and M. Piazzesi (2002). “The Fed and Interest Rates: A High-Frequency
Identification,” American Economic Review 92 (May), 90-95.
Faust, J., Rogers, J.H., Swanson, E., and J.H. Wright (2003). “Identifying the Effects of
Monetary Policy Shocks on Exchange Rates Using High Frequency Data,” Journal of the
European Economic Association 1(5), 1031-57.
Fernández-Villaverde, J., J.F. Rubio-Ramírez, T.J. Sargent, and M.W. Watson (2007). “The
ABCs (and Ds) of Understanding VARs” American Economic Review, Vol. 97, No. 3,
1021-1026.
44

Fieldhouse, A., K. Mertens, and M.O. Ravn (2017). “The Macroeconomic Effects of
Government Asset Purchases: Evidence from Postwar U.S. Housing Credit Policy,”
NBER Working Paper 23154.
Forni, M. and L. Gambetti (2014). “Sufficient Information in Structural VARs,” Journal of
Monetary Economics 66C), 124-136.
Forni, M., D. Giannone, M. Lippi, and L. Reichlin (2009). “Opening the Black Box: Structural
Factor Models with Large Cross Sections,” Econometric Theory, 25, 1319-1347.
Frisch, R. (1933). “Propagation problems and impulse problems in dynamic economics,” in:
Economic Essays in Honor of Gustav Cassel. Allen & Unwin, London, 171–205.
Gertler, M. and P. Karadi (2015). “Monetary Policy Surprises, Credit Costs, and Economic
Activity.” American Economic Journal: Macroeconomics 7, 44-76.
Gilchrist, S. and E. Zakrajšek (2012). “Credit Spreads and Business Cycle Fluctuations,”
American Economic Review 102 (4), 1692-1720.
Gospodinov, N. and S. Ng (2015). “Minimum Distance Estimation of Possibly Noninvertible
Moving Average Models.” Journal of Business & Economic Statistics 33, 403–417.
Gouriéroux, C., A. Monfort and J-P. Renne (2017), "Statistical inference for independent
component analysis: Application to structural VAR models," Journal of Econometrics,
196, pp 111-126.
Gürkaynak, R.S., Sack, B., and E. Swanson (2005). “The sensitivity of long-term interest rates to
economic news: Evidence and implications for macroeconomic models,” American
Economic Review 95, 425–436.
Hamilton, J. D. (2003) “What Is an Oil Shock?” Journal of Econometrics 113: 363–98.
Hausman, J.A. (1978), "Specification Tests in Econometrics," Econometrica, 46(6), 1251-1271.
Hayashi, F., Econometrics. Princeton: Princeton University Press, 2000.
Imbens, G. (2014). “Instrumental Variables: An Econometrician’s Perspective.” Statistical
Science 29, 323-58.
Jordà, Ò. (2005). “Estimation and Inference of Impulse Responses by Local Projections,”
American Economic Review 95(1), 161-182.
Jordà, Ò., M. Schularick, and A.M. Taylor (2015). “Betting the House,” Journal of International
Economics 96, S2-S18.

45

Jordà, Ò., M. Schularick, and A.M. Taylor (2017). “Large and State-Dependent Effects of QuasiRandom Monetary Experiments,” NBER Working Paper 23074.
Kilian, L. (2008). “Exogenous Oil Supply Shocks: How Big Are They and How Much Do They
Matter for the U.S. Economy?” Review of Economics and Statistics 90, 216–40.
Kim, Y.J. and L. Kilian (2011). “How Reliable are Local Projection Estimators of Impulse
Responses?” The Review of Economics and Statistics 93, 1460-1466.
Kleibergen, F. (2005). “Testing Parameters in GMM without Assuming They Are Identified,”
Econometrica 73, 1103-1123.
Kuttner, K.N. (2001). “Monetary Policy Surprises and Interest Rates: Evidence from the Fed
Funds Futures Market.” Journal of Monetary Economics 47, 523-544.
Lanne, M. and P. Saikkonen (2013). “Noncausal Vector Autoregression.” Econometric Theory
29, 447-481.
Lechner, M. (2009). “Sequential Causal Models for the Evaluation of Labor Market Programs,”
Journal of the American Statistical Association 27, 71-83.
Lütkepohl, H. (2005). New Introduction to Multiple Time Series Analysis. Berlin: Spring-Verlag.
Mertens, K. (2015). “Bonn Summer School – Advances in Empirical Macroeconomics, Lecture
2” (slide deck).
Mertens, K. and M.O. Ravn (2013). “The Dynamic Effects of Personal and Corporate Income
Tax Changes in the United States,” American Economic Review 103: 1212-1247.
McCracken, M. and S. Ng (2016). “FRED-MD: A Monthly Database for Macroeconomic
Research,” Journal of Business and Economic Statistics 34, 574-589.
Miranda-Agrippino, S. and G. Ricco (2017). “The Transmission of Monetary Policy Shocks.”
Manuscript, Department of Economics, University of Warwick.
Montiel Olea, J.L. and C. Pflueger (2013). “A Robust Test for Weak Instruments,” Journal of
Business and Economic Statistics 31, 358-369.
Montiel Olea, J., J.H. Stock, and M.W. Watson (2017). “Inference in Structural VARs with
External Instruments,” in preparation.
Moreira, M. (2003). “A Conditional Likelihood Ratio Test for Structural Models,” Econometrica
71, 1027-1048.
Plagborg-Møller, M. (2016a), “Estimation of Smooth Impulse Response Functions,” manuscript,
Harvard University.

46

Plagborg-Møller, M. (2016b), “Bayesian Inference on Structural Impulse Response Functions,”
manuscript, Harvard University.
Plagborg-Møller, M. and C. Wolf (2017), “On Structural Inference with External Instruments,”
manuscript, Princeton University.
Ramey, V. (2011). “Identifying government spending shocks: it’s all in the timing,” Quarterly
Journal of Economics 126, 1–50
Ramey, V. (2016). “Macroeconomic Shocks and their Propagation,” Handbook of
Macroeconomics, Vol. 2A. Amsterdam: Elsevier, pp. 71-162.
Ramey, V. and S. Zubairy, (2017). “Government Spending Multipliers in Good Times and in
Bad: Evidence from U.S. Historical Data,” Journal of Political Economy, forthcoming.
Romer, C.D. and D.H. Romer (1989). “Does Monetary Policy Matter? A New Test in the Spirit
of Friedman and Schwartz” (with discussion), in O.J. Blanchard and S. Fischer (eds.),
NBER Macroeconomics Annual 1989. Cambridge, MA: MIT Press, 121-70.
Romer, C.D. and D.H. Romer (2010). “The Macroeconomic Effects of Tax Changes: Estimates
Based on a New Measure of Fiscal Shocks,” American Economic Review 100, 763-801.
Rothenberg, T.J. and C.T. Leenders (1964). “Efficient Estimation of Simultaneous Equation
Systems,” Econometrica 32, 57-76.
Rudebusch, G.D. (1998). “Do Measures of Monetary Policy in a VAR Make Sense?”
International Economic Review 39(4), 907-948.
Sargan, D. (1964). “Three-Stage Least-Squares and Full Information Maximum Likelihoood
Estimates,” Econometrica 32, 77-81.
Sims, C.A. (1980). “Macroeconomics and Reality,” Econometrica 48, 1-48.
Slutsky, E. (1937). The summation of random causes as the source of cyclic processes,”
Econometrica 5, 105-146.
Stock, J.H. (2008). What’s New in Econometrics: Time Series, Lecture 7. Short course lectures,
NBER Summer Institute, at http://www.nber.org/minicourse_2008.html.
Stock, J.H. and M.W. Watson (2012). “Disentangling the Channels of the 2007-09 Recession.”
Brookings Papers on Economic Activity, no. 1: 81-135.
Stock, J.H. and M.W. Watson (2016). “Dynamic Factor Models, Factor-Augmented Vector
Autoregressions, and Structural Vector Autoregressions in Macroeconomics,” Handbook
of Macroeconomics, Vol. 2A. Amsterdam: Elsevier, pp. 415-525.

47

Theil, H. and J.C.G. Boot (1962). “The Final Form of Econometric Equation Systems,” Review
of the International Statistical Institute, 30, 136-152.
Wright, P.G. (1928). The Tariff on Animal and Vegetable Oils. New York: McMillan.
Zellner, A. (1962). “An Efficient Method of Estimating Seemingly Unrleated Regressions and
Tests for Aggregation Bias,” Journal of the American Statistical Association 63, 502-511.
Zellner, A. and H. Theil (1962). “Three-Stage Least Squares: Simultaneous Estimation of
Simultaneous Equations.” Econometrica 30, 54-78.

48

Table 1: Estimated causal effect of monetary policy shocks on selected economic
variables: Gertler-Karadi (2015) variables, instrument and sample period
lag (h)
0
6
12
24

(a)
1.00 (0.00)
-0.07 (1.34)
-1.05 (2.51)
-2.09 (5.66)

LP-IV
(b)
1.00 (0.00)
1.12 (0.52)
0.78 (1.02)
-0.80 (1.53)

(c)
1.00 (0.00)
0.67 (0.57)
-0.12 (1.07)
-1.57 (1.48)

SVAR
(d)
1.00 (0.00)
0.89 (0.31)
0.78 (0.46)
0.40 (0.49)

SVAR – LP
(d)-(b)
0.00 (0.00)
-0.23 (1.19)
0.00 (1.79)
1.19 (2.57)

IP

0
6
12
24

-0.59 (0.71)
-2.15 (3.42)
-3.60 (6.23)
-2.99 (10.21)

0.21 (0.40)
-3.80 (3.14)
-6.70 (4.70)
-9.51 (7.70)

0.03 (0.55)
-4.05 (3.65)
-6.86 (5.49)
-8.13 (7.62)

0.16 (0.59)
-0.81 (1.19)
-1.87 (1.54)
-2.16 (1.65)

-0.06 (0.35)
3.00 (2.32)
4.83 (4.00)
7.35 (6.40)

P

0
6
12
24

0.02 (0.07)
0.16 (0.42)
-0.26 (0.88)
-0.88 (3.08)

-0.08 (0.25)
-0.39 (0.52)
-1.35 (1.03)
-2.26 (1.31)

-0.04 (0.25)
-0.79 (0.83)
-1.37 (1.23)
-2.58 (1.69)

0.02 (0.23)
0.31 (0.41)
0.45 (0.54)
0.50 (0.65)

0.10 (0.13)
0.71 (0.98)
1.80 (1.53)
2.76 (2.60)

EBP

0
6
12
24

0.51 (0.61)
0.22 (0.30)
0.56 (0.91)
-0.44 (1.29)

0.67 (0.40)
1.33 (0.81)
0.84 (0.65)
0.94 (0.66)

0.82 (0.49)
1.66 (1.04)
0.91 (0.80)
0.85 (0.76)

0.77 (0.29)
0.48 (0.20)
0.18 (0.13)
0.06 (0.07)

0.09 (0.24)
-0.85 (0.51)
-0.66 (0.55)
-0.88 (0.62)

none

4 lags of (z,y)

4 lags of (z,y,f)

na

1.7
1.1

23.7
15.5

18.6
12.7

12 lags of y
4 lags of z
20.5
19.2

R

Controls
First-stage FHom
First-stage FHAC

na
na

Notes: The instrument, Zt, is available from 1990m1-2012m6; the other variables are available
from 1979m1-2012m6. The LP-IV estimates in (a)-(c) use data from 1990m1-2012m6. The VAR
for (d) is computed over 1980m7-2012m6; and the IV-regression computed over 1990m52012m6. The numbers in parentheses are standard errors computed by Newey-West HAC with
h+1 lags for the local projections, and using a parametric Gaussian bootstrap for the SVAR and
the SVAR – LP differences shown in (e). In the final two rows FHom is the standard (conditional
homoscedasticity, no serial correlation) first-stage F-statistic, while FHAC is the Newey-West
version using 12 lags in (a) and heteroskedasticity-robust (no lags) in (b), (c), and (d).
Table 2: Tests for VAR Invertibility (p-values)
VAR-LP difference (lags 0,6,12,24)
VAR Z-GC test

1Year Rate
0.95
0.16

ln(IP)
0.55
0.09

ln(CPI)
0.75
0.38

GZ EBP
0.26
0.97

Notes: The first row is the bootstrap p-value for the test  in (30) of the null hypothesis that IVLP and IV-SVAR causal effects are same for h = 0, 6, 12, and 24. The second row shows pvalues for the F-statistic testing the null hypothesis that the coefficients on four lags of Z are
jointly equal to zero in each of the VAR equations.

49

