NBER WORKING PAPER SERIES

BACKTESTING STRATEGIES BASED ON MULTIPLE SIGNALS
Robert Novy-Marx
Working Paper 21329
http://www.nber.org/papers/w21329

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
July 2015

The views expressed herein are those of the author and do not necessarily reflect the views of the National
Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
¬© 2015 by Robert Novy-Marx. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including ¬© notice, is given to
the source.

Backtesting Strategies Based on Multiple Signals
Robert Novy-Marx
NBER Working Paper No. 21329
July 2015
JEL No. C58,G11
ABSTRACT
Strategies selected by combining multiple signals suffer severe overfitting biases, because underlying
signals are typically signed such that each predicts positive in-sample returns. ‚ÄúHighly significant‚Äù
backtested performance is easy to generate by selecting stocks on the basis of combinations of randomly
generated signals, which by construction have no true power. This paper analyzes t-statistic distributions
for multi-signal strategies, both empirically and theoretically, to determine appropriate critical values,
which can be several times standard levels. Overfitting bias also severely exacerbates the multiple
testing bias that arises when investigators consider more results than they present. Combining the best
k out of n candidate signals yields a bias almost as large as those obtained by selecting the single best
of nk candidate signals.

Robert Novy-Marx
Simon Graduate School of Business
University of Rochester
305 Schlegel Hall
Rochester, NY 14627
and NBER
Robert.Novy-Marx@Simon.Rochester.edu

1. Introduction
Multi-signal equity strategies, i.e., strategies that select or weight stocks on the basis
of a composite measure that combines multiple signals, are common in the money
management industry. For example, the MSCI Quality Index (according to its fact sheet)
identifies ‚Äústocks with high quality scores based on three main fundamental variables: high
return on equity (ROE), stable year-over-year earnings growth, and low financial leverage.‚Äù
Popular ‚Äúsmart beta‚Äù products, such as Research Affiliates‚Äô Fundamental Indices, also
rely heavily on the methodology, weighting stocks on the basis of multiple ‚Äúfundamental‚Äù
measures such as sales, cash flow, book value, and dividends.
Increasingly, multi-signal strategies are attracting scholarly attention.

Notable

examples of composite signals employed by academics for stock selection include
Piotroski‚Äôs (2000) F-score measure of financial strength, constructed from nine market
signals; the Gompers, Ishii, and Metrick‚Äôs (2003) Index, which combines 24 governance
rules to proxy for shareholder rights; the Baker and Wurgler (2006) Index, which combines
six signals of investor sentiment; and Asness, Frazzini, and Pedersen‚Äôs (2013) quality score,
which combines 21 stock level characteristics.
Unfortunately, inferences drawn from tests of these sorts of strategies are misleading,
because the backtested performance of strategies selected on the basis of multiple signals
is biased, often severely. The bias results from overfitting. Underlying signals are typically
signed such that each predicts positive in-sample returns. That is, an aspect of the data
(in-sample performance of the individual signals) is used when constructing the strategy,
yielding a particular form (and a particularly pernicious form) of the data-snooping biases
considered generally by Lo and MacKinlay (1990).
This overfitting bias is distinct from the selection bias (or multiple testing bias)
confronted by McLean and Pontiff (2013) and Harvey, Liu, and Zhu (2013). Selection
1

bias results when the researcher employs the best performing signal or signals from among
multiple candidates, and fails to account for doing so. The overfitting bias considered here
is strong even when there is no selection bias, i.e., even when a researcher employs each
and every signal considered.
While the overfitting and selection biases are distinct, they do interact, with the
selection bias severely exacerbating the overfitting bias. In fact, the presence of the two
makes the bias exponentially worse. The bias resulting from combining the best k signals
out of a set of n candidates is almost as bad as that from using the single best signal out of
nk candidates.
To demonstrate the severity of the overfitting bias, I construct empirical distributions of
backtested t-statistics for multi-signal strategies, constructed on the basis of purely random
signals. The sorting variable (i.e., the random signals) have no real power, but strategies
based on combinations of the ‚Äúsignals‚Äù perform strongly. Essentially, diversifying across
the recommendations of stock pickers that performed well in the past yields even better
past performance, even when the recommendations just follow (or go against) the results of
monkeys throwing darts at the Wall Street Journal. This strong backtested performance in
no way suggests, of course, that these recommendations have any power predicting returns
going forward. For some of the constructions I consider strategies usually backtest, in real
data, with t-statistics in excess of five, and statistical significance at the 5% level requires
t-statistics in excess of seven.
To develop intuition for the observed empirical results, I derive theoretical distributions
for critical t-statistics under the null that signals are uninformative and strategy returns are
normally distributed. These critical values, which have close analytic approximations, are
similar to those observed in the data. Analysis of these results yields several additional
intuitions. First, it suggests that the overfitting bias is severely exacerbated, at least when
there is little selection bias, when more weight is put on stronger signals. That is, when
2

researchers allow themselves more flexibility to overfit the data, in the form of freedom
to weight different signals differently, then backtested performance is significantly more
biased. It also suggests that when researchers constrain themselves to weight signals
equally, then the optimal use of the roughly half of the signals that backtest least strongly,
at least for the purpose of maximizing backtested t-statistics, is to simply ignore them.
Finally, the model implies the approximate power law for the interaction of the overfitting
and selection biases, suggesting that the bias that results from combining the best k out of
n candidate signals yields biases almost as bad as selecting the single best of nk candidate
signals.
Note that these results do not suggest that strategy performance cannot be improved
by combining multiple signals. The basic tenants of Markowitz‚Äôs (1952) modern portfolio
theory hold, and efficient combinations of high Sharpe ratio assets have even higher Sharpe
ratios. The results do strongly suggest, however, that the marginal contribution of each
individual signal should be evaluated individually. That is, while one should combine
multiple signals they believe in, one should not believe in a combination of signals simply
because they backtest well together.
The rest of the paper is organized as follows. Section 2 provides results from a large
scale bootstrapping exercise. It describes empirical distributions for backtested t-statistics
for strategies, using real stock returns data, selected on the basis of combinations of
fictitious, randomly generated ‚Äúsignals.‚Äù Section 3 presents and analyzes a simplified
model, in which signals are uninformative (i.e., do not predict cross sectional differences in
average returns), and the returns to strategies selected on the basis of individual signals are
uncorrelated and normally distributed. It derives critical t-statistics for strategies selected
on the basis of combinations of signals, and uses these results to develop intuition regarding
the factors that determine the magnitude of the backtesting biases. Section 4 derives the
approximate power law governing the interaction between the selection and overfitting
3

biases, showing that backtests of a strategy based on the best k of n candidate signals
are biased almost as badly as those of a strategy based on the single best of nk candidate
signals. Section 5 concludes.

2. Empirical results
This section considers the backtested performance of strategies selected by combining
random signals. It generates empirical distributions of backtested t-statistics for a general
class of multi-signal strategies, when signals are uninformative about expected returns, by
considering combinations of multiple random signals thousands of times. By construction,
these signals have no real power, and cannot predict performance out-of-sample.

2.1 Strategy construction
Given any signal, I construct a long/short strategy, rebalanced at the end of June, using
return and capitalization data for individual stocks from CRSP. The weight of a stock in
the long or short side of a strategy is proportional to both the signal and a capitalization
multiplier. That is, stock i is held proportionally to .Si;t

St /mi;t , where Si;t and mi;t

are the signal and capitalization multiplier for the stock i at time t, and St is the median
signal across all stocks. This specification embeds many common construction schemes.
For example, if the signal is an indicator for whether some stock characteristic is in the
extreme 10% of the cross-sectional distribution, then the strategies are just long and short
extreme deciles, equal weighted if the capitalization multiplier is one for all stocks and
value weighted if it is market equity. If the signal is the cardinal ranking of the characteristic
and the capitalization multiplier is always one, then it gives the rank-weighting scheme
employed by Frazzini and Pedersen (2014) to construct their betting-against-beta (BAB)

4

factor.
I focus on signal-and-capitalization weighted strategies, because these strategies
map most closely into the theoretical model presented in Section 3, and because the
methodology is similar to that commonly employed in industry. For the capitalization
multiplier I use market equity. The signals are randomly generated ‚Äúz-scores,‚Äù drawn
independently for each stock at the end of each June from a standard normal distribution,
or linear combinations of these randomly generated signals.1 Using rank weighting, or
a simple quantile sort, does not change any of the conclusions of the analysis. In fact,
Appendix A shows that the performance of both signal and rank weighted strategies is
essentially indistinguishable from that of strategies based on simple tercile sorts, equal
weighted if the capitalization multiplier is one and value weighted if the capitalization
multiplier is market equity. So, for example, the salient feature of the rank-weighting
scheme employed by Frazzini and Pedersen (2014) to construct their BAB factor is not
the rank-weighting, but that the scheme ignores market capitalizations. The long and short
sides of the strategy are thus almost indistinguishable, before levering or unlevering, from
equal-weighted portfolios holding the top or bottom 35% of stocks by estimated market
betas.

2.2 A simple illustration
Before analyzing the full scope of the overfitting bias that results form combining
multiple signals, it is useful to illustrate the associated problems as simply as possible.
This illustration simply demonstrates that combining signals that backtest positively can
yield impressive backtested results, even when none of the signals employed to construct
1

In particular, because these strategies‚Äô portfolio weights are linear in the signals, and the composite
signals are linear combinations of the underlying signals, strategies based on composite signals are linear
combinations of the strategies based on individual signals. This fact is employed in Section 3, and simplifies
analysis of the model.

5

the composite signal has real power, or even individually generates significant backtested
results.
To do this, I generate 10,000 sets of 100 random signals. By construction, none of
the signals have any true power to predict returns. For each set of signals I construct
signal-and-cap weighted strategies, and record t-statistics for these strategies‚Äô excess
returns. For each set I then combine the signals of the two to ten strategies that backtested
with absolute t-statistics closest to either one, or to one and a half.2 These signals are
combined through simple addition, after first flipping the signs on strategies that generated
negative excess returns. Because of the computational intensity of the procedure, I limit
the analysis to a relatively short sample, covering July 1993 through the end of 2014.
Figure 1 shows the average backtested t-statistics for strategies based on combinations
of from two to ten signals that all individually backtest with t-statistics of basically one
(lower solid line) or one and a half (upper solid line). Despite the fact that none of the
underlying signals are themselves significant, or have any true power, the figure shows that
the combined signals often look highly significant in the backtests. In fact, the figure shows
that the average t-statistic is almost as large as the average t-statistic of the underlying
signals times the square root of the number of signals employed (dotted lines). As a
result, combining just two signals with t-statistics of 1.5, or five signals with t-statistics
of one, yields strategies that have average t-statistics significant at the 5% level, at least if
one counterfactually assumes, as is common, that the combined strategy t-statistics have a
standard normal distribution.
2

Specifically, I select the k D 2; 3; :::; 10 strategies corresponding to those with consecutive order
statistics with absolute backtested t-statistics with means closest to either one or 1.5.

6

Average combined strategy t-statistic

5

‚àö
1.5 √ó n
Empirical, t for underlying signals = 1.5
‚àö
n
Empirical, t for underlying signals = 1

4.5
4
3.5
3
2.5
2
1.5
1
1

2

3

4

5

6

7

8

9

10

Number of signals used (k)
Fig. 1. Average t-statistic on strategies that combine insignificant signals. The figure shows the
t-statistic on the excess return to strategies that combine from one to ten random signals, where each
of the underlying signals yields strategies with t-statistics of one (lower solid line) or 1.5 (upper solid
line). Strategies are signal-and-cap weighted, i.e., stocks are held in direct proportion to both market
capitalization and the demeaned signal used for strategy construction. Return and capitalization data
come from CRSP, and the sample covers July 1993 through December 2014. Average t-statistics
are calculated over 10,000 sets of random signals. Dotted lines show the average t-statistic of the
underlying signals, multiplied by the square-root of the number of signals combined.

n strategies
2.3 Best k -of-n
The previous subsection clearly illustrates the overfitting problem that biases backtested
performance of multi-signal strategies. The construction of those strategies, however,
with all the underlying signals selected to produce similar, modest performance, is highly
artificial. This section analyses strategies that are more likely to arise naturally out of a real
7

research process. In this process a researcher may have a concept or model that suggests
a certain sort of stocks will have higher returns. She then investigates a set of possible
empirical proxies that she thinks might signal stocks that look good on this dimension,
and chooses to somehow combine the few that work the best. If an investigator considers n
signals, and combines the best k of these to select stocks, the result is a best k-of-n strategy.
When k D 1 this results in pure multiple testing, or selection, bias. This bias is relatively
well understood, and interesting here primarily as a point of comparison. At the opposite
extreme, when k D n the result is a pure overfitting bias. When 1 < k < n the result is a
combination of sample selection and overfitting bias.
For strategies that combine multiple signals, there is an additional issue, related to how
signals are combined. In particular, will the investigator constrain herself to putting the
same weight on each signal, or will she give herself the additional degrees of freedom to
employ different weights for each signal? I consider both cases here, proxying for the latter
by signal weighting the signals, i.e., weighting each signal in proportion to the in-sample
performance of strategies based on the individual signals. These correspond to the weights
on the ex-post mean-variance portfolio of the individual strategies, assuming the strategies
are uncorrelated and have identical volatilities.
2.3.1

Distribution of t-statistics from multi-signal strategies

Figure 2 shows the distribution of t-statistics for some simple best k-of-n strategies.
Results are again created by generating 10,000 sets of n random signals. The figure shows
results kernel smoothed with a bandwidth of 0.2.
Panel A shows the case of pure selection bias (k D 1), for n 2 f1; 2; 4; 6; 10g. It
also shows, for comparison, the density for the absolute value of the standard normal. The
empirical distribution of t-statistics for best 1-of-1 strategy looks approximately normal,
though with a slightly fatter tail, reflecting the excess kurtosis and heteroskedasticity
8

Absolute t-statistic distribution, pure selection bias

0.8

Standard normal
n = 1, k = 1
n = 2, k = 1
n = 4, k = 1
n = 6, k = 1
n = 10, k = 1

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Absolute t-statistic distribution, pure overfitting bias

0.8

Standard normal
n=k=2
n=k=3
n=k=5

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Absolute t-statistic distribution, combined selection and overfitting biases

0.8

Standard normal
n = 4, k = 2
n = 6, k = 3
n = 10, k = 5

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Fig. 2. Empirical t-statistic distribution for best k-of-n strategies, equal-weighted signals. Panel
A shows the case of pure selection bias (k D 1), for n 2 f1; 2; 4; 6; 10g; Panel B the case of pure
overfitting bias (k D n), for n 2 f2; 3; 5g; and Panel C the combined case, when n D 2k for
n 2 f2; 3; 5g. Distributions are bootstrapped from 10,000 draws of n randomly generated signals,
and kernel smoothed with a bandwidth of 0.2. Strategies are signal-and-cap weighted, with stocks
held in direct proportion to both market capitalization and the demeaned signal used for strategy
construction, and rebalanced annually, at the end of June. Return and capitalization data come from
CRSP, and the sample covers July 1993 through December 2014.

9

observed on equity strategy returns. The densities for the cases when n > 1 still look
approximately normal, but are shifted to the right. For n D 2 the mode has shifted out from
zero to almost one. For n D 10 it is almost two.
Panel B shows the case of pure overfitting bias (k D n), for n 2 f2; 3; 5g. Results are
shown for signals that are equal weighted; signals weighting the signal yields even more
extreme results (shown in Appendix B). The figure suggests that even the pure overfitting
biases are more acute that the selection biases. The distribution of t-statistics for the best
5-of-5 strategy is shifted almost as far as it is for the best 1-of-10 strategy.
Panel C shows the impact of the biases, depicting the cases when the investigator
considers twice as many signals as she uses (n D 2k), for n 2 f2; 3; 5g. The effects clearly
compound. More than half of the mass of the distribution for the best 3-of-6 strategy
is to the right of two‚Äîso most strategies selected this way look ‚Äúhighly significant.‚Äù
Employing three signals in the selection criteria when constructing marketed indices is
relatively common, suggesting that the highly significant performance of many of these
indices, inferred from t-statistics greater than 1.96, is anything but.
2.3.2

Critical t-statistics for multi-signal strategies

Because the distribution of t-statistics for multi-signal strategies does not have a
standard normal distribution, critical values derived from that distribution cannot be used
to draw inferences regarding significance of performance for multi-signal strategies.
Figure 3 shows empirical 5% critical values for best 1-of-n strategies, which suffer
from pure selection bias, and best n-of-n strategies, which suffer from pure overfitting
bias. For the pure overfitting results, it shows both the case when the composite signal is
constructed by equal weighting the individual signals and by signal weighing the individual
signals. It shows that the impact on the critical threshold from the sample selection and
equal weighted overfitting biases are similar for very small n, but that the impact of the
10

Empirical 5% critical values, special cases (k D 1 and k D n)

5

Signal-weighted signals
Equal-weighted signals
Single best signal

4.5

kDn

4

3.5

kDn

3
kD1

2.5

2
1

2

3

4

5

6

7

8

9

10

Number of signals considered (n)
Fig. 3. Five percent critical t-statistics for best 1-of-n and best n-of-n strategies. The bottom, dotted
line shows 5% critical thresholds for the pure selection bias case, when the investigator presents the
strongest result from a set of n random strategies, where n 2 f1; 2; :::; 10g. The middle, solid line
and the top, dashed line, shows 5% critical thresholds when there is pure overfitting bias. In these
cases stocks are selected by combining all n random signals, but the underlying signals are signed
so that they predict positive in-sample returns. In the top, dashed line signals are signal-weighted,
while in the middle, solid line signals are equal-weighted. Critical values come from generating
10,000 sets of n randomly generated signals. Strategies are signal-and-cap weighted, with stocks
are held in direct proportion to both market capitalization and the demeaned signal used for strategy
construction, and rebalanced annually, at the end of June. Return and capitalization data come from
CRSP, and the sample covers July 1993 through December 2014.

11

overfitting bias is more acute for even moderately large n. It also shows that overfitting
by signal weighting the signals yields much higher critical values than equal weighting the
signals. That is, the pure overfitting problem is more acute when the investigator has more
freedom to overweight good signals. The critical value of 2.1 at n D 1 reflects the fat
tail of the distribution of t-statistics for the best 1-of-1 case, observed in Figure 2. This
excess kurtosis yields a higher frequency of extreme t-statistics, pushing up the critical
value relative to the one obtained under the standard normal assumption.
Figure 4 shows empirical 5% critical values for best k-of-n strategies, which suffer
from both selection and overfitting biases. It shows these critical values for the cases when
the best one to ten signals are employed, when 10, 20, 40, or 100 signals are considered,
both when signals are equal-weighted (solid lines) and when signals are signal-weighted
(dotted lines). The combined biases yield extreme critical values. For the best 3-of-10
strategies the 5% critical t-statistic is almost four; for the best 3-of-20 strategies it is
almost five; for the best 7-of-100 strategies it is almost seven. The figure also shows a
non-monotonicity in the critical value for the equal weighted signal case when n D 10,
and a large divergence between the critical values of the equal weighted signal and signal
weighted signal strategies when most the signals considered are employed. This occurs
because in-sample performance is impaired by putting significant weight on poor quality
signals, an effect that is considered in greater detail in the next section.

12

Empirical 5% critical values, general cases (arbitrary k  n)

7.5

Signal weighted strategies
Equal weighted strategies

7

n D 100

6.5
n D 40

6
5.5

n D 20

5
4.5

n D 10

4
3.5
3
1

2

3

4

5

6

7

8

9

10

Number of signals employed (k)
Fig. 4. Five percent critical t-statistics for best k-of-n strategies. The figure shows 5% critical
thresholds for strategies selected using a signal constructed by combining the best k D 1; 2; :::; 10
performing signals, when the investigator considered n 2 f10; 20; 40; 100g candidate signals. Solid
lines show the cases when the composite signal is constructed by equal-weighting the k best
performing candidate signals, and dotted lines the cases when the composite signal is constructed
by signal-weighting the signals. Critical values come from generating 10,000 sets of n randomly
generated signals. Strategies are signal-and-cap weighted, with stocks are held in direct proportion
to both market capitalization and the demeaned signal used for strategy construction, and rebalanced
annually, at the end of June. Return and capitalization data come from CRSP, and the sample covers
July 1993 through December 2014.

13

3. Model results
To develop intuition for the results observed in the preceding section, I now analyze a
simplified model of strategy performance, deriving distributions of backtest t-statistics, and
properties of these distributions, when stocks are selected on the basis of multiple signals.

3.1. Model
Suppose there are n underlying ‚Äúsignals‚Äù used for stock selection, and that the returns
to signal-weighted strategies (i.e., long/short strategies that hold stocks in proportion to
the demeaned signals) are normally distributed, uncorrelated across signals, and have the
same volatilities (or are levered to have the same volatilities). Under these assumptions,
the performance of strategies based on composite signals, formed as linear combinations
of the underlying signals, are relatively easy to analyze. First, the normality of returns
implies that the standard results from modern portfolio theory hold. Second, weights
on individual stocks in a strategy are proportional to the signal used to select them, and
composite signals are linear combinations of the underlying signals, so a strategy selected
on the basis of a composite signal is consequently identical to a portfolio of strategies based
on the individual underlying signals, held in proportion to the weights used to construct the
composite signal.3
Given n signals, the ex-post Sharpe ratio to the strategy that selects stocks based on a
composite signal that puts weights !E on the individual signals is thus the same as that to
3

That is, the assumption that individual stock weights are proportional to the signal used to select them,
together with composite signals that are linear combinations of the underlying signals, yields an exact
equivalence between ‚Äúsiloed‚Äù and ‚Äúintegrated‚Äù solutions (i.e., the solution that runs multiple pure strategies
side-by-side, and the one that select stocks to get exposure to all the signals simultaneously). While these
assumptions are not satisfied for standard quantile sorted strategies, Appendix A shows that the performance
of quantile sorted strategies is essentially indistinguishable from that of rank-weighted strategies, or from
z-score weighted strategies, which do satisfy the assumptions.

14

the portfolio that puts weights !E on strategies selected from the individual signals,
!E 0 
Ee
SR!E D p
;
!E 0‚Ä†!E

(1)

where 
E e is the vector of realized excess returns to strategies selected using the n signals,
and ‚Ä† D  I is the variance-covariance matrix for the strategy returns, where  is the
volatility of the individual strategies. The sample t-statistic estimated on the combined
strategy is thus
!E 0 tE
;
tO!E D p
!E 0 !E

(2)

where tE is the vector of t-statistics estimated on the individual strategies.
The back-tested performance of strategies formed on the basis of multiple signals
consequently depends on how the signals are used. The two most common choices, equal
weighting the signals (!E D 1= k1k1 ) and signal-weighting the signals (!E D tE= tE 1 ), here
correspond to well understood strategies, the minimum variance and ex-post mean-variance
efficient portfolios, respectively.
Without loss of generality, we may assume that the elements of tE are arranged in
increasing order, and letting In;k be the orthogonal projection onto the lower k dimensional
sub-space (i.e., .In;k /ij D 1 if i D j > n

k, and zero otherwise), we then have that

the sample t-statistics for the minimum variance (i.e., equal weighted) and mean variance
MV
efficient (i.e., signal weighted) strategies based on the best k-of-n signals, denoted tn;k
and

15

MVE
tn;k
, respectively, are given by

MV
tn;k

10In;k tE
D
D p
10 In;k 1
E0

t In;k tE
MVE
tn;k
D q
D
Et 0 In;k tE

In;k tE
p
k
In;k tE

2

1

D

Pk

iD1 t.nC1 i/

p
k

v
u k
uX
2
D t
t.nC1

i/ ;

(3)

(4)

iD1

there t.j / denotes the j th order statistic of ft1 ; t2 ; :::; tn g.
That is, the t-statistic for the best k-of-n strategy that equal weights signals is the
p
L1 -norm of the vector of the largest k order statistics of tE divided by k. Equivalently, it
p
is k times the average t-statistic of the strategies corresponding to the signals employed.
This conceptualization is basically consistent with the empirical results presented in Figure
1, which showed that the backtested performance of strategies selected on an average of k
p
signals that individually backtest with similar strength was roughly k times as strong as
the backtested performance of strategies based on the individual signals.
For the strategy that signal weights the signals, the t-statistic is the L2 -norm of the
MV
MVE
largest k order statistics. Strategy construction tells us that tn;k
 tn;k
, and standard

results for Lp -norms imply that the bound is tight if and only if the k largest order statistics
are all equal.
When employing k signals from a set of n candidates, I will denote the critical threshold
MV
MVE


for tn;k
and tn;k
at a p-value of p by tn;k;p
and tn;k;p
, respectively.

n and n -of-n
n strategies
3.2. Critical values for special cases: Best 1-of-n


Before analyzing arbitrary tn;k;p
and tn;k;p
, it is again useful to develop some intuition

by first considering the extreme cases in k. The first of these occurs when the investigator
considers several signals, but only reports results for the single best performing strategy

16

(k D 1), and again corresponds to pure selection bias. The properties of the critical
threshold in this case are well understood, but provide a useful point of comparison. The
second occurs when the investigator employs all the signals considered (k D n), but signs
each to predict positive in-sample returns, and again corresponds to pure overfitting bias.
It is free from sample-selection bias, but is biased nevertheless because the joint signal
is constructed using information regarding the directionality with which each individual
signal predicts returns that come from the whole sample.

3.2.1. Pure sample selection bias: Inference when a single signal is used
For the best 1-of-n strategies, note that the order statistics for standard uniform random
variables follow beta distributions, u.k/  B.k; n C 1 k/. So for the maximal order


statistic P u.n/ < x D x n , or P u.n/ > .1 p/1=n D p, implying a critical t-statistic

for rejection at the p level for the single best result from n draws from a standard, normal
random variable of

tn;1;p

where N

1

D


tn;1;p

D N

1



1


p 1=n
2



;

./ is the inverse of the cumulative normal distribution.

These critical values can be interpreted by recognizing that, for small p, 1
1

(5)

p
.
2n


p 1=n
2



In fact, when p < 35% then for any n the difference is at least an order of
Àá

 
Àá
Àá 1
p 1=n
p Àá
1
magnitude smaller than p, ÀáN
1 2
N
1 2n Àá < p=10. That is, to close

approximation the actual p-value is n times as large as the p-value commonly claimed
for an observed t-statistic, p  n  2 .N . jtj//. Put simply, the observed result is n
times more likely to have occured randomly than is typically reported. If one suspects that

the observer considered 10 strategies, significance at the 5% level requires that the results
appear significant, using standard tests, at the 0.5% level. This is the standard Bonferroni
17

correction for multiple comparison when the hypothesis is that the expected returns to all
n candidate strategies are zero.

3.2.2. Pure overfitting bias: Inference when all signals considered are used
When all the signals considered are used there is no selection bias, but overfitting
still occurs because the signals are typically signed so that they predict high returns
in-sample. In this case the distribution of the observed t-statistic for the strategy based on
the signal-weighted signal (i.e., the ex post MVE combination of the n strategies) is trivial.
All the signals are employed, and the t-statistics on the excess returns to the strategies based
on the underlying signals come from independent standard normal draws. The t-statistic on
the signal-weighted straegy is consequently distributed as a chi-distribution with n degrees
of freedom,

MVE
tn;n

D

tE

2



q

2n :

(6)

The critical t-statistic for the ex-post MVE combined strategy constructed using the n
randomly selected signals comes from inverting the chi-squared distribution,

tn;n;p

D

q

ÀÜ21 .1
n

p/;

(7)

where ÀÜX denotes the cumulative distribution function for the random variable X .
The critical values for the strategies based on the equally weighted signals are more
difficult, but have a simple asymptotic approximation. The mean and variance of the
p
absolute value of the standard normal variable are 2= and 1 2=, respectively, so

18

limn!1 tE

1

p
 N.n 2=; n.1
MV
tn;n

D

2=//, and
tE
p

q



1

n

n!1

2n


q
C
1

2




:

(8)

This implies an asymptotic critical value of

tn;n;p



q 
2


p

nC

q

2


1



1

N

.1

p/ :

(9)

MV
The true distribution of tn;n
is positively skewed and has excess kurtosis, especially when
MV
n is small, so the true probability that tn;n
exceeds this critical value exceeds p. That is,

the estimate is a lower bound on the true critical value. The performance of this estimator
is improved, especially for small n, by replacing p with

tn;n;p



q 
2


p

nC

q

1

2




np
,
nC1

N

1

1

np
nC1



:

(10)

Figure 5 shows 5% critical values for these special cases. The bottom, dotted line shows

t1;n;5%
, the critical value for the best 1-of-n strategy, which suffers from pure selection


bias. The top, dashed line, and the solid, middle line, show tn;n;5%
and tn;n;5%
, the critical

values for the best n-of-n strategies when signals are signal-weighted and equal-weighted,
respectively, which suffer from pure overfitting bias. The dash-dotted line shows the

analytic approximation for tn;n;5%
, provided in equation (10), which closely matches the

exact value. The figure shows a remarkable resemblance to the empirical distributions
bootstrapped from real stock market data using random signals, provided in Figure 3. The
model critical values are uniformly roughly 7% below their empirical counterparts, for all
three cases and across the range of signals employed (k), because the model lacks the
excess kurtosis and heteroskedasticity observed in the data.

19

Model 5% critical thresholds, special cases (k D n and k D 1)

4.5

Signal-weighted signals
Equal-weighted signals (exact)
Equal-weighted signals (approximation)
Single best signal

4

kDn

3.5

kDn
3

kD1

2.5

2

1.5
1

2

3

4

5

6

7

8

9

10

Number of signals considered (n)
Fig. 5. Model 5% critical t-statistics for best 1-of-n and best n-of-n strategies. The bottom, dotted
line shows 5% critical thresholds for the pure selection bias case, when the investigator presents the
strongest result from a set of n random strategies, where n 2 f1; 2; :::; 10g. The middle, solid line
and the top, dashed line, show 5% critical thresholds when there is pure overfitting bias. In these
cases stocks are selected by combining all n random signals, but the underlying signals are signed
so that they predict positive in-sample returns. In the top, dashed line signals are signal-weighted,
while in the middle, solid line signals are equal-weighted. The dot-dashed line shows the analytic
approximation for the equal-weighted best n-of-n case.

n strategies
3.3. General case: best k -of-n
To calculate the critical t-statistic more generally, when the selection and overfitting
biases interact, note that the order statistics for n draws of the standard uniform distribution
are distributed uniformly on the standard n-simplex ¬Ån D f.u1 ; u2 ; :::; un / 2 Rn j0 
u1  u2  :::  un  1g, which has a volume of 1=n≈†. Using the symmetry of the
20

normal distribution, the order statistics for the absolute values of n draws of the standard
normal distribution is obtained by pulling the simplex back through the cumulative normal


1C¬Ån

distribution, N 1
, where the inverse normal is taken element-by-element. The
2
MV
MVE
probability that tn;k
and tn;k
are greater than any given  are thus

MV
P ≈ítn;k

MV
P ≈ítn;k

where t D N

u
1 1Cu
2



>  ¬ç D E 1 kI t k pk
n;k
1


n
o
>  ¬ç D E 1 kI t k  ;
n

o

n;k



(11)
(12)

2


, and u is distributed uniformly on the simplex ¬Ån . These equations


implicitly define critical thresholds for the best k-of-n strategy for any p-value, tn;k;p
D
n
o
n
o
MV
MVE

 jP ≈ítn;k
>  ¬ç D p and tn;k;p
D  jP ≈ítn;k
> ¬ç D p .

While these do not admit analytic solutions, they are easy to calculate numerically.

Figure 6 shows 5% critical values as a function k, the number of signals employed, for
k D 1; 2; :::10, for cases in which the investigator considers ten, 20, 40, or 100 signals (i.e.,
n 2 f10; 20; 40; 100g). The figure again shows a strong resemblance to the corresponding
empirical critical values provided in Figure 4. The model shows similar, though slightly
lower, critical values for the pure selection bias cases (k D 1), strong, but slightly weaker
dependence on k for small k, and slightly high sensitivity to k for large k.4 The figure also
shows the same non-monotonicity in the critical value for the equal-weighted signal case
when n D 10, and a large divergence between the critical values for strategies that equaland signal-weight signals when k  n. These effects are considered in greater detail in the
next subsection.

4

The model‚Äôs results correspond even more closely to the empirical distribution of critical t-statistics for
signal-weighted strategies constructed without regards to market capitalizations (i.e., mi;t D 1 for all i and
t). The empirical critical values for these strategies are shown in Table 11 of Appendix C.

21

Model 5% critical values, general cases (arbitrary k  n)

7.5

Signal weighted strategies
Equal weighted strategies

7

n D 100

6.5
n D 40

6
5.5

n D 20

5
4.5

n D 10

4
3.5
3
2.5
1

2

3

4

5

6

7

8

9

10

Number of signals employed (k)
Fig. 6. Model 5% critical t-statistics for best k-of-n strategies. The figure shows 5% critical
thresholds for strategies selected using a signal constructed by combining the best k D 1; 2; :::; 10
performing signals, when the investigator considered n 2 f10; 20; 40; 100g candidate signals. Solid
lines show the cases when the composite signal is constructed by equal-weighting the k best
performing candidate signals, and dotted lines the cases when the composite signal is constructed
by signal-weighting the signals.

3.3.1. Critical value approximation, general case
Appendix D derives relatively simple analytic approximations, given by

tn;k;p

tn;k;p

1


1

kp
kC1

 t MV C t MV N
n;k
n;k
r

 t MVE 2 C  t MVE 2 N
. n;k /
. n;k /
22

1




1

(13)
kp
kC1


;

(14)

where
p

t MV

D

t2MV

D ‚Ä†n;k

n;k

n;k

k n;k
2n;k C

k.n k/.n;k n;k /
.kC1/.nC2/

2

 t MVE 2 D k‚Ä†n;k
. n;k /
 2 MVE 2 D k 3n;k n;k C 3‚Ä†n;k
.tn;k /


‚Ä†2n;k C

k 2 .n k/.‚Ä†n;k 2n;k /
.kC1/.nC2/

2

;

and

n;k  N

1

E

1

2

1 C U.n

n;k  E ≈íj > n;k ¬ç D

k/



D N

1



1

n.n;k /
D 2
1 N .n;k /



‚Ä†n;k  E 2 j > n;k D 1 C n;k n;k :

kC1
2.nC1/
nC1
kC1




n.n;k /

The variances terms in equations (13) and (14) are relatively insensitive to n and k, while
the means are strongly increasing in both indices (at least for small k), consistent with the
basic rightward shift in the empirical distributions observed in Figure 2.
Figure 7 compares these analytic approximations to the exact critical values, calculated
using numeric integration. Panel A shows the case when the investigator considers 100
candidate signals (n D 100), for the full range of the possible number of signals employed
(k D 1; 2; :::; 100). The top, light solid line shows the exact critical values for the
cases when signals are signal-weighted, while the closely tracking dotted line shows the
corresponding approximation. The lower, dark lines show the same for the cases when
signals are equal-weighted. Panels B and C show similar results, when the investigator
considers only 40 or 20 candidate signals.

An obvious feature of Figure 7 is the peak in tn;k;p
near the middle, where k  n=2.

23

Critical t-statistic with n = 100 candidate signals

12
10
8

Signal weighted (MVE), exact
Signal weighted (MVE), approximation
Equal weighted (MV), exact
Equal weighted (MV), approximation

6
4
10

20

30

40

50

60

70

80

90

100

Number of signals employed (k)

Critical t-statistic with n = 40 candidate signals

8
7
6
5
4
3
5

10

15

20

25

30

35

40

Number of signals employed (k)

Critical t-statistic with n = 20 candidate signals

6
5.5
5
4.5
4
3.5
3
2

4

6

8

10

12

14

16

18

20

Number of signals employed (k)
Fig. 7. Comparison of exact and approximate 5% critical t-statistics for best k-of-n strategies. The
figure shows 5% critical thresholds for best k-of-n strategies. Solid lines are exact values, while
dotted lines are analytic approximations. The top, lighter lines show critical values for strategies
that signal-weight signals, while the lower, darker lines correspond to strategies that equal-weight
signals.

24

The performance of the ex-post mean variance efficient strategy is always weakly improved
by adding strategies to the investment opportunity set, so the critical t-statistic threshold for

the signal weighted combination of strategies, tn;k;p
, is increasing in k  n for all n and p.

The same is not true for the critical t-statistic threshold for the equal weighted combination

of strategies, tn;k;p
. With these strategies there is a tension. Increasing the number of

signals used decreases strategy volatility, which tends to improve performance. At the same
time, using more signals reduces average returns, as the average quality of the signals for
predicting in-sample performance falls, which tends to hurt performance. Initially the first
effect dominates, and performance improves with more signals, but eventually the quality
of the signal deteriorates sufficiently that the gains from additional strategy diversification
are more than offset by the loss in average returns. At that point employing additional
signals is detrimental to performance. The point at which overall performance starts to
deteriorate, i.e., the optimal number of signals to use to predict in-sample performance,
can be approximated by noting that this occurs (abusing the infinitesimal notation) when
h i
d
MV
E
tn;k
D 0. Differentiating the expected t-statistic using the right hand side of
dk

equation (3), this implies



E t.n k/
hP
k
E
iD1 t.nC1

i/

i D

1
;
2k

(15)

or, after rearranging and using iterated expectations, that



E t.n

k/



2

D E4

E

hP
k

iD1 t.nC1

2k

i/

Àá
Àát.n

k/

i3


E  t.n
5 D
2

k/



:

(16)

That is, there is no longer a benefit to using additional signals when the next signal is only
half as good as the average of all the better signals already employed.






Finally, using E  t.n k/   E t.n k/ and E t.n k/  n;k , the previous
25

equation implies that n;k D .n;k / =2; or using n;k D N
x  D 0:612 be the solution to 2x D n.x/=N. x/, that
kC1
nC1

 2N . x  / D 0:541;

1


1

kC1
2.nC1/



and letting

(17)

or that k  n=2. Consistent with Figure 7, given n candidate signals the maximal Sharpe
ratio strategy that equal-weights signals employs roughly half the signals. That is, when
forming equal-weighted strategies, the optimal ‚Äúuse‚Äù of the worst performing half of the
typical set of candidate signals is to simply ignore them. Observing that a multi-signal
strategy fails to employ any poor quality signals consequently raises concerns that the
investigator threw out poor performing candidates, suggesting selection bias (i.e., n > k)
as well as overfitting bias (i.e., signing each signal so that it performs well in sample).
p
p
MV
In this case the expected t-statistic is E≈ít2k;k
¬ç  4n N 1 .3=4/ k D 1:27 k, almost

60% higher that the t-statistic that would have been expected absent the selection bias,
p
p
MV
E≈ítk;k
¬ç  2k= D 0:8 k.

4

Pure selection bias equivalence
Another way to quantify the impact of the combined sample selection and overfitting

biases, and how they interact, is to calculate the number of candidate signals an investigator
would need to consider to get the same bias selecting stocks using a single signal. That is,

 
p 1=n

1
given any critical value  and p-value p, we can find n such that  D N
1 2
.
Solving for n , the number of single-signal strategies the investigator would need to
consider to have the same critical value, is thus

n




ln 1 p2
D
:
ln .N . //
26

(18)

Table 1. Single-signal candidates required to get best k-of-n 5% critical threshold
The table reports the number of candidates a researcher would need to consider, when selecting the single
strongest signal, to get the same 5% critical t-statistic for a best k-of-n strategy. Panel A reports the cases


when the signals are equal-weighted (i.e., reports n such that t1;n
 ;5% D tk;n;5% ). Panel B reports the cases



when the signals are signal-weighted (i.e., reports n such that t1;n ;5% D tk;n;5%
).

Signals
considered (n)

Signals used (k)
2

3

4

5

10

305
4,490
147,000
2.02 106

426
12,000
900,000
2.33 107

141
113,000
5.03108
2.85 1011

614
7,680
223,000
2.88106

1,102
24,400
1.55106
3.70107

2,690
658,000
1.70109
7.781011

Panel A: Equal-weighted signals (minimum variance strategies)
10
20
50
100

57
227
1,360
5,220

164
1,250
17,500
128,000

Panel B: Signal-weighted signals (mean-variance efficient strategies)
10
20
50
100

73
277
1,600
6,020

260
1,810
23,400
165,000

Table 1 shows single-signal equivalent sample sizes, for actual sample size from ten to
100 (rows), when employing two to ten signals (columns). The table shows the pernicious
interaction between the sample selection and overfitting biases. Panel A, which shows
the case when multiple signals are signal-weighted, shows that using just the best three
signals from 20 candidates yields a bias as bad as if the investigator had used the single best
performing signal from 1,250 candidates. With five signals selected from 50 candidates,
the bias is almost as bad as if the investigator had used the single best performing signal
from one million. Panel B shows even stronger results when the researcher has the freedom
to overweight more strongly performing signals.
A key feature of Table 1 is that the equivalent number of single signals considered (n)
generally grows quickly with the number of signals employed (k). To quantify this relation,
note that n 

p=2
.
N.  /

Taking logs, using the approximation N.  /  n. /= for large  ,


gives that ln n is of order  2 , or using the approximation for tn;k;p
given in equation (13),

27

Equivalent number of single signal strategies (n), log scale

8

10

Signal weighted strategies
Equal weighted strategies

107

kD5

106

105

kD3

4

10

103

kD2
102

101
101

Number of strategies considered (n), log scale

102

Fig. 8. Number of single candidates strategies to generate the five percent critical thresholds for
best k-of-n strategies. The figure plots, using a log-log scale, the number of single signals required

to generate the best k-of-n critical values at the 5% level, tn;k;5%
(equal-weighted signals, solid

lines) and tn;k;5% (signal-weighted signals, dotted lines), as a function of the number of candidate
strategies actually considered (n, from ten to 100). Strategies are constructed using the best two,
three, and five signals (k). The figure shows the expected approximately linear log-log relation,
with slopes proportional to the number of signals employed.



kC1
for k  n
that ln n is of order k2n;k . Finally, using n;k  n;k D N 1 1 2.nC1/
q
ln .4.1 //
p
and the inverse normal approximation N 1 ./ 
, this implies that ln n is
=8

approximately affine in ln n, with a slope approximately proportional to k. That is, n is
roughly proportional to nk .
This approximate power relation is evident in Figure 8, which plots, on a log-log
scale, the number of single-signal candidates required (n ) to generate the best k-of-n


5% critical values, tn;k;5%
(equal-weighted signal, solid lines) and tn;k;5%
(signal-weighted

28

signal, dotted lines), as a function of the number of candidate strategies actually considered
(n, form ten to 100). This n is plotted for strategies constructed using the best two, three,
and five signals. As predicted, the figure shows an approximately linear log-log relation,
with slopes proportional to the number of signals employed.
This approximate power law can be understood intuitively as follows. The biases that
result from using the best k-of-n signals are worse than one would get by partitioning the
signals into k random sub-samples of size n=k, and then using the single best signal from
each sub-sample. The expected in-sample improvement in the quality of the employed
signals that results from going from one candidate to n=k signals is almost as large as
going from one signal to n signals, because the oversampling bias is highly convex in the
candidate sample size, and the effects on n are multiplicative. The bias that results from
the best k-of-n strategies is consequently almost as pronounced as if the investigator had
used the single best signal from nk candidate strategies.

5. Conclusion
Multi-signal strategies cannot be evaluated using conventional tests.

Combining

spurious, marginal signals, it is easy to generate backtested performance that looks
impressive, at least when evaluated using the wrong statistics. One solution is to evaluate
multi-signal strategies using different statistics. An easier solution is to evaluate the
marginal power of each signal separately.
This is not to say that one should not use multiple signals that one believes in. Signals
that work well individually will work even better together. One should not, however,
believe in multiple signals because they backtest well together. Backtesting well together
does not imply that any of the signals, or even the combined signal, has any power.

29

A. Signal and rank weighted strategies
The strategies considered in Section 2 hold stocks in proportion to .Si;t

St /mi;t ,

where Si;t and mi;t are the signal and capitalization multiplier for stock i at time t, and
St is the median signal across all stocks. This specification embeds standard quantile
sorts (when Si;t equals an indicator that the sorting characteristic is in the top x% of
the cross-sectional distribution, minus an indicator that it is in the bottom x% of the
cross-sectional distribution), rank-weighted strategies (when Si;t is the cross-sectional rank
of the sorting characteristic), and z-score weighted strategies (when Si;t is the z-score of the
sorting characteristic). It also embeds both value-weighted and equal-weighted strategies
(the former when market cap multiplier mi;t is a stock‚Äôs market capitalization; the latter
when it is one for all stocks).
To facilitate comparison between the empirical results of Section 2 and the theory
presented in Section 3, I assume that the signals were uncorrelated normally distributed
z-scores. Under this assumption, integrated solutions (i.e., strategies based on composite
signals) are exactly equivalent to siloed solutions (i.e., to portfolios of strategies based
on the individual signals). This simplifies the analysis, because it allows us to use well
known results from portfolio theory. This section shows that this assumption is largely
immaterial, as the performance of strategies based on quantile sorts, rank-weighting, and
z-score weighting are essentially indistinguishable.
This fact should not, perhaps, be very surprising. Figure 9 shows the relative weights
on the long side of long/short strategies constructed by tertile (top 35%) sorting (dotted
line), rank-weighting (dashed line), and z-score weighting (solid line). The figure shows
that each dollar of the long side of a z-score weighted strategy differs from the quantile
portfolio that equal weights the top 35% of stocks by the sorting characteristic by only

30

Portfolio weights (relative)

2.5
Signal weighting
Rank weighting
Quantile (top 35%)

2

1.5

1

0.5

0
50

55

60

65

70

75

80

85

90

95

100

Characteristic rank (percentile)
Fig. 9. Relative weights on tertile (top 35%) and signal-weighted strategies. The figure shows the
relative weights on individual stocks in the long side of long/short equity strategies, as a function of
the cross-sectional rank of the stocks on the sorting characteristic. Weights are given relative to the
weights put on stocks in the tertile sorted (top 35%) portfolio (dotted line). The dashed line shows
rank-weighted strategies, and the solid line shows z-score weighted strategies.

23 cents. The impact of this relatively modest deviation is holdings is also unclear, as
relative to the quantile portfolio, the z-score weighted portfolio overweights the stocks
with the most extreme and most marginal characteristic rankings, and underweights those
with moderately strong characteristic rankings. The rank-weighted strategies differ even
less, deviating from the quantile portfolio‚Äôs holdings by only 17 cents per dollar.
These similarities are reflected in the performance of strategies constructed by quantile
sorting, rank-weighting, and z-score weighting. Table 2 compares the performance of

31

value-minus-growth (VMG) strategies, based on book-to-market, constructed using the
three different methodologies.5

It also compares strategies that are equal and value

weighted. The table provides compelling evidence that the most relevant feature of
rank-weighting or z-score weighting is the fact that these weighting schemes weight
without respect for capitalization, and thus look like equal weighted, not value weighted,
strategies. Similarly, the most relevant feature of the rank and capitalization weighted or
z-score and capitalization weighted strategies is the fact that they weight proportional to
capitalization, and thus look like value weighted, not equal weighted, strategies.
Panel A regresses the returns to the rank-weighted VMG strategy on to the returns to an
equal-weighted, tertile sorted VMG strategy, and onto a rank and capitalization weighted
VMG strategy. It shows that the rank-weighted strategy is almost indistinguishable from the
simple equal-weighted, tertile strategy, which explains 99.4 percent of its return variation.
The rank-weighted strategy and the rank and capitalization weighted strategy are much
less correlated, and actually do not even have a significant relation, after controlling for the
performance of the equal-weighted, tertile sorted strategy.
Panels B through D tell similar stories. The z-score weighted strategy looks like an
equal weighted, tertile strategy, not a z-score and capitalization weighted strategy. The rank
and capitalization weighted, and z-score and capitalization weighted, strategies both look
like value-weighted, tertile sorted strategies, not like rank-weighted or z-score weighted
strategies.
Overall, the evidence is remarkably consistent. The use of quantile sorting, or rank
or z-score weighting, has little impact on the performance of the strategies, which always
look highly similar. The choice of equal-weighting or value-weighting for the capitalization
multiplier, however, has a material impact on the nature of the strategies.
5

N

Because of the extreme skew
in book-to-market, I use normal

.ri;t 1=2/=.maxj frj;t g C 1=2/ where ri;t is firm i ‚Äôs B/M rank at time t.

1

32

z-scores,

zi;t

D

Table 2. Rank weighted, normal z-score weighted, and quantile sorted strategy relations
The table reports results from time-series regressions of value-minus-growth (VMG) strategy returns onto the
returns of other VMG strategies. Stocks are weighted in proportion to a demeaned signal of book-to-market
(quantile sorted using the high and low
 35%; rank-weighted; or normal z-score weighted, where zi;t D
N 1 .ri;t 1=2/=.maxj frj;t g C 1=2/ and ri;t is firm i ‚Äôs B/M rank at time t). Portfolios are rebalanced
annualy, at the end of June. Data come from CRSP and Copmustat, and the sample covers July 1963 through
December 2014.

Explanatory strategies

(1)

Panel A: y D rank weighted VMG
Àõ

0.78
[6.42]

Equal weighted VMG

Rank weighted
(2)
(3)
0.02
[2.28]
1.01
[320.4]

Rank and cap weighted VMG
Adj.-R2

99.4

Panel B: y D Normal z-score weighted VMG
Àõ

0.82
[6.50]

Equal weighted VMG

0.04
[2.16]
1.05
[177.0]

Normal z-score and cap weighted VMG
Adj.-R2

98.1

Panel C: y D rank and cap weighted VMG
Àõ

0.31
[2.63]

Value weighted VMG

0.01
[0.66]
0.99
[166.9]

Rank weighted VMG
Adj.-R2

97.8

Panel D: y D Normal z-score and cap weighted VMG
Àõ
Value weighted VMG

0.33
[2.70]

0.02
[0.97]
1.04
[132.5]

Signal weighted VMG
Adj.-R2

96.6

33

0.57
[6.25]

0.70
[22.6]
45.3
0.60
[6.28]

0.69
[22.3]
44.6
-0.20
[-2.22]

0.65
[22.6]
45.3
-0.20
[-2.14]

0.65
[22.3]
44.6

(4)
0.02
[2.19]
1.02
[236.2]
-0.00
[-0.85]
99.4
0.04
[2.10]
1.05
[130.6]
-0.00
[-0.61]
98.1
-0.02
[-0.99]
0.96
[126.8]
0.05
[6.81]
98.0
-0.02
[-0.71]
0.99
[101.0]
0.06
[6.84]
96.8

B. Densities for t-statistics, signal weighted strategies
Absolute t-statistic distribution, pure sample selection bias

0.8

Standard normal
n = 1, k = 1
n = 2, k = 1
n = 4, k = 1
n = 6, k = 1
n = 10, k = 1

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Absolute t-statistic distribution, pure overfitting bias

0.8

Standard normal
n=k=2
n=k=3
n=k=5

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Absolute t-statistic distribution, combined sample selection and overfitting biases

0.8

Standard normal
n = 4, k = 2
n = 6, k = 3
n = 10, k = 5

0.6
0.4
0.2
0
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Fig. 10. Empirical t-statistic distribution for best k-of-n strategies, signal-weighted signals. Panel A shows
the case of pure selection bias (k D 1), for n 2 f1; 2; 4; 6; 10g; Panel B the case of pure overfitting bias
(k D n), for n 2 f2; 3; 5g; and Panel C the combined case, when n D 2k for n 2 f2; 3; 5g. Distributions are
bootstrapped from 10,000 draws of n randomly generated signals, and kernel smoothed with a bandwidth of
0.2. Strategies are signal-and-cap weighted, with stocks held in proportion to both market capitalization and
the demeaned signal used for strategy construction, and rebalanced annually, at the end of June. Return and
capitalization data come from CRSP. The sample covers July 1993 through December 2014.

34

n critical values, without cap weighting
C. Best k -of-n

Empirical 5% critical values, general cases (arbitrary k  n)

8

Signal weighted strategies
Equal weighted strategies

7.5

n D 100

7
6.5

n D 40

6
5.5

n D 20

5
4.5
n D 10

4
3.5
3
1

2

3

4

5

6

7

8

9

10

Number of signals employed (k)
Fig. 11. Five percent critical t-statistics for best k-of-n strategies, without capitalization weighting.
The figure shows 5% critical thresholds for strategies selected using a signal constructed by
combining the best k D 1; 2; :::; 10 performing signals, when the investigator considered n 2
f10; 20; 40; 100g candidate signals. Solid lines show the cases when the composite signal is
constructed by equal-weighting the k best performing candidate signals, and dotted lines the cases
when the composite signal is constructed by signal-weighting the signals. Critical values come from
generating 10,000 sets of n randomly generated signals. Strategies are signal weighted, with stocks
are held in direct proportion to the demeaned signal used for strategy construction, and rebalanced
annually, at the end of June. Return and capitalization data come from CRSP, and the sample covers
July 1993 through December 2014.

35

D. Critical value approximation
Recall, from equations (3) and (4), that

MV
tn;k


MVE 2
tn;k

D

Pk

D

k
X

iD1 t.nC1 i/

p

(19)

k

2
t.nC1

i/ :

(20)

iD1

Then the top k order statistics of the standard uniform random variable,
U.n/; U.n

1/ ; :::; U.nC1 k/ ,

k
X

t.nC1

i/

iD1

are distributed uniformly on the interval ≈íU.n

D k t.n

k/



k
X
 Àá
C
ti Àáti > t.n
iD1

k/



k/ ; 1¬ç,

 t.n

k/



so

;

(21)

where .x/  E≈íj > x¬ç D n.x/=N. x/ denotes the inverse Mill‚Äôs ratio. The first
term on the right hand side of the previous equation inherits the approximate normality of

U.n k/, with mean and variance, using t.n k/  N 1 12 .1 C U.n k// and letting n;k 




kC1
N 1 E 12 1 C U.n k/ D N 1 1 2.nC1/
and n;k  .n;k /, given by

E k t.n

Var k t.n

k/

k/





 kn;k

Àá
 k 2 Var 0 .x/ Àá
D

k 2 .n

(22)
n;k

 N


1 0

k/ .n;k n;k /2
;
.k C 1/.n C 2/

Àá
.x/ ÀáE ≈í 1 .1CU
2

where the last equality follows from 0 .x/ D .x/2 x.x/ and N

.n k/


1 0

/¬ç 

U.n
2

k/


(23)

.x/ D 1=n.x/, and

because the order statistics of the standard uniform random variable have beta distributions,



kC1
U.n k/  B.n k; k C 1/, so E 12 1 C U.n k/ D 1 2.nC1/
and Var U.n k/ D
.n k/.kC1/
.
.nC1/2 .nC2/

36

The second term on the right hand side of equation (21) is mean zero, converges to
normality for large k by the central limit theorem, and has a variance of approximately

Àá

kVar ti Àáti > n;k D k 1 C n;k n;k
MV
Taken together these imply tn;k

p

appr ox:


t MV

D

t2MV

D 1 C n;k n;k

n;k


2n;k :

(24)



N t MV ; t2MV where
n;k

n;k

k n;k

(25)
2

n;k

2n;k C

k.n k/.n;k n;k /
.kC1/.nC2/

:

(26)

Then

MV

p D P tn;k
> tn;k;p



 P t MV C t MV  > tn;k;p
n;k
n;k
!

D 1

tn;k;p 

N

t MV
n;k

;



t MV
n;k

which implies

tn;k;p
 t MV C t MV N
n;k

n;k

37

1

.1

p/ :

(27)


2
MVE
Similarly, tn;k
is approximately normally distributed. Its mean is
E

h

MVE
tn;k

2 i

h h
ii
 Àá
MVE 2 Àá
D E E tn;k
t.n k/
h
i
 Àá
MVE 2 Àá
t.n k/ D n;k
 E tn;k

(29)

D k .1 C n;k n;k / ;

(31)

(28)

 Àá

D kE ti2 Àá ti > n;k

(30)

where we have again used the fact that the top k order statistics of a uniform random
variable are distributed jointly uniformly over the interval exceeding the next highest order
statistic. Its variance is

Var



MVE
tn;k

2 

 h
 Àá
MVE 2 Àá
D Var E tn;k
t.n

k/

i

h

 Àá
MVE 2 Àá
C E Var tn;k
t.n

k/

i

: (32)

For the second term on the right hand side of the previous equation,
h

 Àá
MVE 2 Àá
E Var tn;k
t.n

k/

i

 Var




MVE 2
tn;k

Àá
Àá t.n

k/

Àá

D kVar ti2 Àá ti > n;k

D n;k



D k 3n;k n;k C 3 .1 C n;k n;k /

(33)

.1 C n;k n;k /2 ;

where the last line follows from the known conditional moments of the normal distribution.

38

For the first term on the right hand side of equation (32), note that

E

h

2 Àá
t MVE Àá t.n
n;k

k/

i

D E

"

k
X

2
t.nC1

i/

iD1

Àá
Àá t.n

k
X
Àá
D E
ti2 Àá ti > t.n

"

k/

k/

iD1

D k 1 C t.n

k/

 t.n

k/

#

#

(34)



:

So
 h
 Àá
MVE 2 Àá
Var E tn;k
t.n

k/

i

D k 2 Var t.n

k/

 t.n

k/



(35)

and

Var  t.n

k/




Àá
Àá
0
 Var ≈íx.x/¬ç0 Àá  N 1 .x/ ÀáE ≈í 1 .1CU
.n
n;k
2

2
.n k/ 1 C n;k n;k 2n;k
D
;
.k C 1/.n C 2/

k/

/¬ç 

U.n
2

k/


(36)

where the last equality follows from the results of equation (23), together with the fact that



2 x2
.
≈íx.x/¬ç0 D .x/ 1 C x.x/ x 2 D 0 .x/ 1Cx.x/
.x/ x



2
MVE
appr ox:
Taken together these imply tn;k
N  t MVE 2 ;  2 MVE 2 where

. n;k / .tn;k /
 t MVE 2 D k 2 .1 C n;k n;k /
. n;k /
 2 MVE 2 D k 3n;k n;k C 3 .1 C n;k n;k / .1 C n;k n;k /2
.tn;k /
2
k 2 .n k/.1Cn;k n;k 2n;k /
C
:
.kC1/.nC2/

39

(37)


(38)

Then

MVE

p D P tn;k
> tn;k;p


2

 P  t MVE 2 C  t MVE 2  > tn;k;p
. n;k /
. n;k /
0
1
2

.tn;k;p
/  t MVE 2
. n;k / A
D 1 N@
;
 MVE 2
.tn;k /
which implies

tn;k;p


q

 t MVE 2 C  t MVE 2 N
. n;k /
. n;k /

40

1 .1

p/:

(39)

References
[1] Asness, Cliff, Andrea Frazzini, and Lasse H. Pedersen. 2013. ‚ÄúQuality Minus Junk.‚Äù
AQR working paper.
[2] Baker, Malcolm, Jeffrey Wurgler. 2006. ‚ÄúInvestor sentiment and the cross section of
stock returns.‚Äù Journal of Finance 55, 1645‚Äì1680.
[3] Frazzini, Andrea, and Lasse H. Pedersen. 2013. ‚ÄúBetting against beta.‚Äù Journal of
Financial Economics 111, 1‚Äì25.
[4] Gompers, Paul, Joy Ishii, and Andrew Metrick. 2003. ‚ÄúCorporate governance and
equity prices‚Äù Quarterly Journal of Economics 118, 107‚Äì156.
[5] Harvey, Campbell R., Yan Liu, and Heqing Zhu. 2013. ‚Äú...and the cross-section of
expected returns.‚Äù Working paper.
[6] Lo, Andrew W., and A. Craig MacKinlay. 1990. ‚ÄúData-snooping biases in tests of
asset pricing models.‚Äù Review of Financial Studies.
[7] Markowitz, Harry. 1952. ‚ÄúPortfolio selection.‚Äù Journal of Finance 7, 77‚Äì91.
[8] McLean and Pontiff, 2013, ‚ÄúDoes Academic Research Destroy Stock Return
Predictability?‚Äù Working paper.
[9] Piotroski, Joseph D. 2000. ‚ÄúValue Investing: The Use of Historical Financial
Statement Information to Separate Winners from Losers.‚Äù Journal of Accounting
Research, pp. 1‚Äì41.

41

