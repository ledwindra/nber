NBER WORKING PAPER SERIES

IDENTIFICATION IN DIFFERENTIATED PRODUCTS MARKETS USING MARKET
LEVEL DATA
Steven T. Berry
Philip A. Haile
Working Paper 15641
http://www.nber.org/papers/w15641

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2010

Earlier drafts were circulated under the title .Identi.cation of Discrete Choice Demand From Market
Level Data. We had helpful early conversations on this topic with Rosa Matzkin and Yuichi Kitamura.
We also had valuable feedback from Liran Einav, Jon Levin, Tim Bresnahan, and participants in the
2008 Game Theory World Congress, the 2008 LAMES, the 2009 FESAMES, 2009 SETA Conference,
the Brown Conference on the Econometrics of Demand, and seminars at Boston College, CREST,
Penn, Stanford, USC, UCSD, Virginia, and Wisconsin. Financial support from the NSF is gratefully
acknowledged. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Steven T. Berry and Philip A. Haile. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.

Identification in Differentiated Products Markets Using Market Level Data
Steven T. Berry and Philip A. Haile
NBER Working Paper No. 15641
January 2010, Revised March 2010
JEL No. C35,L0
ABSTRACT
We consider nonparametric identification in models of differentiated products markets, using only
market level observables. On the demand side we consider a nonparametric random utility model nesting
random coefficients discrete choice models widely used in applied work. We allow for product/market-specific
unobservables, endogenous product characteristics (e.g., prices), and high-dimensional taste shocks
with arbitrary correlation and heteroskedasticity. On the supply side we specify marginal costs nonparametrically,
allow for unobserved firm heterogeneity, and nest a variety of equilibrium oligopoly models. We pursue
two approaches to identification. One relies on instrumental variables conditions used previously to
demonstrate identification in a nonparametric regression framework. With this approach we can show
identification of the demand side without reference to a particular supply model. Adding the supply
side allows identification of firms' marginal costs as well. Our second approach, more closely linked
to classical identification arguments for supply and demand models, employs a change of variables
approach. This leads to constructive identification results relying on exclusion and support conditions.
Our results lead to a testable restriction that provides the first general formalization of Bresnahan's
(1982) intuition for empirically discriminating between alternative models of oligopoly competition.
Steven T. Berry
Yale University Department of Economics
Box 208264
37 Hillhouse Avenue
New Haven, CT 06520-8264
and NBER
steven.berry@yale.edu
Philip A. Haile
Department of Economics
Yale University
37 Hillhouse Avenue
P.O. Box 208264
New Haven, CT 06520
and NBER
philip.haile@yale.edu

1

Introduction

Models of discrete choice between di¤erentiated products play a central role in the modern
empirical literature in industrial organization (IO) and are used in a wide range of other
applied …elds of economics.1

In many applications, the discrete choice demand model

is combined with an oligopoly model of supply.

Typically these models are estimated

using econometric speci…cations incorporating functional form restrictions and parametric
distributional assumptions.

Such restrictions may be desirable in practice: estimation

in …nite samples always requires approximations and, since the early work of McFadden
(1974), an extensive literature has developed providing ‡exible discrete-choice models well
suited to estimation and inference.

Furthermore, parametric structure is necessary for

the extrapolation involved in many out-of-sample counterfactuals. However, an important
question is whether parametric speci…cations and distributional assumptions play a more
fundamental role in determining what is learned from the data.

In particular, are such

assumptions essential for identi…cation?
In this paper we examine the nonparametric identi…ability of di¤erentiated products
models that are in the spirit of Berry, Levinsohn, and Pakes (1995) (henceforth, “BLP”) and
a large applied literature that has followed.

We consider identi…cation of demand alone,

identi…cation of marginal costs, and discrimination between di¤erent models of oligopoly
competition.
On the demand side, the models motivating our work incorporate two essential features.
One is rich heterogeneity in preferences, which allows for ‡exible demand substitution pat1
Applications include studies of the sources of market power (e.g., Berry, Levinsohn, and Pakes (1995),
Nevo (2001)), welfare gains from new goods or technologies (e.g., Petrin (2002), Eizenberg (2008)), mergers
(e.g., Nevo (2000), Capps, Dranove, and Satterthwaite (2003)), network e¤ects (e.g., Rysman (2004), Nair,
Chintagunta, and Dube (2004)), product promotions (e.g., Chintagunta and Honoré (1996), Allenby and
Rossi (1999)), environmental policy (e.g., Goldberg (1998)), vertical contracting (e.g., Villas-Boas (2007),
Ho (2007)), market structure and product quality (e.g., Fan (2008)), media bias (e.g., Gentzkow and Shapiro
(2009)), asymmetric information and insurance (e.g., Cardon and Hendel (2001), Bundorf, Levin, and Mahoney (2008), Lustig (2008)), trade policy (e.g., Goldberg (1995), Berry, Levinsohn, and Pakes (1999),
Goldberg and Verboven (2001)), residential sorting (e.g., Bayer, Ferreira, and McMillan (2007)), and school
choice (e.g., Hastings, Staiger, and Kane (2007)).

1

terns (e.g., cross-price elasticities).2 The second is the presence of product/market-level unobservables.3

These unobservables give rise to the endogeneity of prices, and only by

explicitly modeling them can one account simultaneously for endogeneity and heterogeneity in preferences for choice characteristics.

Surprisingly, this combination of factors has

not been treated in the prior literature on identi…cation. Indeed, although there is a large
literature on identi…cation of discrete choice models,4 there are no nonparametric or semiparametric identi…cation results even for the linear random coe¢ cients random utility model
widely used in the applied literature that motivates us.
On the supply side the applied literature employs empirical models derived from equilibrium conditions for multi-product oligopolists, building on early insights of Rosse (1970)
and Bresnahan (1981). Following BLP, recent work typically allows for latent cost shocks
and unobserved heterogeneity in cost functions, but employs a parametric speci…cation of
costs.
We consider identi…cation within nonparametric generalizations of the demand-side and
supply-side models used in the applied literature.

We focus on the common situation in

which market level data are available, as in BLP. In such a setting, one observes market
shares, market characteristics, product prices and characteristics, and product/market level
cost shifters. Individual choices and …rms’costs are not observed.5
We begin with a nonparametric generalization of standard random coe¢ cients discrete
choice models. Our model incorporates an important index restriction on the way product/market2

See, e.g., the discussions in Domencich and McFadden (1975), Hausman and Wise (1978) and Berry,
Levinsohn, and Pakes (1995). Early models of discrete choice with heterogeneous tastes for characteristics
include those in Quandt (1966) and Quandt (1968).
3

While our work is motivated by IO applications, these models are relevant in in many other discretechoice contexts where there are unobservables at the level of a “group” (the analog of our “market”). For
example, employees’ choices among o¤ered insurance plans may depend on unobservable characteristics of
the plans. A broad set of examples with “group level unobservables”is discussed in Berry and Haile (2009a)
for the case of binary choice and related models. Although an oligopoly supply side may not be appropriate
for all such examples, several results are obtained here without reference to a supply side, and the overall
approach may be useful in other cases as well.
4

Important early work includes Manski (1985), Manski (1988), Matzkin (1992), and Matzkin (1993),
which examine semiparametric models with exogenous regressors.
5

We consider the case of “micro” (consumer-level) choice data in Berry and Haile (2009b).

2

speci…c unobservables enter preferences, but is otherwise ‡exible. It allows for market/choicespeci…c unobservables, endogenous choice characteristics, unknown heteroskedasticity, and
taste shocks with arbitrary dimension and correlation.

We consider identi…cation of de-

mand as well as full identi…cation of the joint distribution of consumers’conditional indirect
utilities, the latter enabling characterization of standard aggregate welfare measures. Identi…cation of demand naturally requires instruments for prices (or other endogenous choice
characteristics), and we show that standard nonparametric instrumental variables conditions
(Newey and Powell (2003)) su¢ ce. This result demonstrates that the essential requirement
for identi…cation of demand in this type of model is identical to that for regression models:
the availability of instruments. Further, this result can be extended to full identi…cation
of the random utility model using standard arguments under additional quasilinearity and
support conditions.
Given identi…cation of demand, we consider nonparametric identi…cation of each …rm’s
marginal cost function and cost shocks, again relying on an index restriction and on nonparametric instrumental variables conditions. These results provide a nonparametric foundation
for a large body of applied work that estimates marginal costs in order to address positive
and normative questions concerning imperfectly competitive markets.
Although these are strong positive results, nonparametric instrumental variables conditions themselves can be di¢ cult to interpret or verify.

This is one reason we consider a

second approach to identi…cation, this time making simultaneous use of the demand model
and a partially speci…ed model of oligopoly competition. We show that the resulting system
of “supply and demand”equations can be “inverted,”leading to identi…cation of demand and
of the latent shocks to marginal costs. If we further commit to a particular oligopoly model
(e.g., Nash equilibrium in prices) we also recover each …rm’s marginal costs. This approach
enables us to o¤er constructive identi…cation arguments relying on traditional exclusion and
support conditions, but under somewhat stronger restrictions on the model.
Finally, we show that (using either identi…cation approach) our results lead to testable
restrictions that can distinguish between alternative models of oligopoly competition. This

3

result o¤ers the …rst general formalization of Bresnahan’s (1982) intuition for empirically
discriminating between alternative “oligopoly solution concepts.”
Together these results provide a positive message regarding the faith we may have in
a growing body of applied work on di¤erentiated products markets allowing for rich consumer and …rm heterogeneity, choice-speci…c unobservables, and endogeneity. Such models
are identi…ed without parametric or distributional assumptions under the same sorts of conditions that yield identi…cation of simpler and more familiar models. This positive message
is not without quali…cation: in addition to the index restrictions, our results require instruments for price that are excluded from the demand system, as well as demand shifters that
are excluded from …rm costs. Of course, it should not be surprising that identi…cation in an
environment with limited dependent variables and endogeneity requires both some structure
and adequate exogenous variation. Our results shed light on key assumptions and essential
sources of variation one should look for in applications.
To our knowledge, we provide the …rst and only results on the nonparametric identi…cation of market-level di¤erentiated products models of the sort found in BLP and other
applications in IO. However, there is large related literature on the identi…cation and estimation of semi- and nonparametric discrete choice models. On the demand side, our work
is related to (and makes use of) much of this literature. Our work is also related to a large
parametric literature on the estimation of “supply and demand”models, to a large literature
on the estimation and testing of oligopoly models, and to work on the nonparametric identi…cation of simultaneous equations models.

In the following section we brie‡y place our

work in the context of these and other prior literatures. We then set up the model in section
3 and discuss a key preliminary result in section 4. We provide our two sets of identi…cation
results in sections 5 and 6. Discrimination between alternative oligopoly models is discussed
in 7. We conclude in section 8.

4

2

Related Literature

Our work relates to several literatures, including a large body of work on identi…cation of
discrete choice models. Much of that literature considers models allowing for heterogeneous
preferences through a random coe¢ cients random utility speci…cation, but ruling out endogeneity. Ichimura and Thompson (1998) studied a linear random coe¢ cients binary choice
model. Briesch, Chintagunta, and Matzkin (2005) consider multinomial choice, allowing
some generalization of a linear random coe¢ cients model. Our work relaxes functional form
and distributional assumptions relied on in this earlier work, incorporates market/choicespeci…c unobservables, and allows for endogeneity.
A number of papers address the identi…cation of discrete-choice models with endogeneity—
sometimes only in a binary context, sometimes without consumer heterogeneity, and usually
without the kind of endogeneity considered in the applied literature that motivates our work.
Examples include Lewbel (2000), Honoré and Lewbel (2002), Hong and Tamer (2004), Blundell and Powell (2004), Lewbel (2005), and Magnac and Maurin (2007). These all consider
linear semiparametric models, allowing for a single additive scalar shock (analogous to the
extreme value or normal shock in logit and probit models) that may be correlated with some
observables. Among these, Lewbel (2000) and Lewbel (2005) consider multinomial choice.
Extensions to non-additive shocks are considered in Matzkin (2007a) and Matzkin (2007b).
Compared to these papers, we relax functional form restrictions and, more fundamental,
add the important distinction between market/choice-speci…c unobservables and individual
heterogeneity in preferences. This distinction allows the model to de…ne comparative statics
that account for both heteroskedasticity (heterogeneity in tastes for characteristics) and
endogeneity.6 For example, to de…ne a demand elasticity one must quantify the changes in
market shares resulting from an exogenous change in price. Accounting for heterogeneity in
consumers’marginal rates of substitution between income and other characteristics requires
6

Matzkin (2004) (section 5.1) makes a distinction between choice-speci…c unobservables and an additive preference shock, but in a model without random coe¢ cients or other sources of heteroskedasticity/heterogeneous tastes for product characteristics. See also Matzkin (2007a) and Matzkin (2007b).

5

allowing the price change to a¤ect the covariance matrix (and other moments) of utilities.
On the other hand, controlling for endogeneity requires holding …xed the market/choicespeci…c unobservables. Meeting both requirements is impossible in models with a single
composite error for each product.
Blundell and Powell (2004), Matzkin (2004), and Hoderlein (2008) have considered binary
choice with endogeneity in semiparametric triangular models, leading to the applicability of
control function methods or the related idea of “unobserved instruments”(see also Petrin and
Train (2009), Altonji and Matzkin (2005), Gautier and Kitamura (2007), and Fox and Gandhi
(2009)). However, standard models of oligopoly pricing in di¤erentiated products markets
imply that each equilibrium price depends on the entire vector of demand shocks (and
typically the vector of cost shocks as well). This rules out a triangular structure. Nonetheless,
our “change of variables”approach uses a related strategy of inverting a multiproduct supply
and demand system to recover the entire vector of shocks to costs and demand. This can
be interpreted as a generalization of the control function approach.
On the supply side, Rosse (1970) introduced the idea of using …rst-order conditions for
imperfectly competitive …rms to infer their marginal costs from prices and demand parameters.7 Our approach to identi…cation of marginal costs is a nonparametric extension of that
idea.
Our insights regarding discrimination between alternative oligopoly models are closely
related to ideas from the early empirical IO literature on conjectural variations models.
Bresnahan (1982), in particular, provided in‡uential intuition for how “rotations of demand”
could distinguish between alternative oligopoly models.

While Bresnahan’s intuition was

very general, formal results (Lau (1982)) have been limited to deterministic homogeneous
goods conjectural variations models, and have required shifters of aggregate demand.
Our change of variables approach, which exploits the simultaneous determination of prices
and market shares, has links to the prior literature on nonparametric identi…cation of simul7
Bresnahan (1989) provides a review of the early literature on oligopoly estimation that followed. BLP
inverted the multiproduct oligopoly …rst-order conditions to solve for unobserved shocks to marginal cost.

6

taneous equations models (e.g., Brown (1983), Roehrig (1988), Matzkin (2005), and Matzkin
(2008)). A standard strategy in this literature is to relate the joint density of latent variables to that of the observables using restrictions from theory and a standard change of
variables. A complication, emphasized in Benkard and Berry (2006), is that the change of
variables involves the Jacobian of the transformation. This introduces substantial challenges
and has limited the set of models for which identi…ability has been shown using the change
of variables approach. However, in our context the same index restriction that enables us
to use the nonparametric instrumental variables strategy permits us to use a new change
of variables argument to obtain a constructive proof of identi…cation. Here our work is
closely related to that of Matzkin (2005, 2008), who has explored identi…cation in a variety
of nonparametric simultaneous equations models. Although she does not explicitly address
discrete choice models, for our change of variable argument we transform our model to a
form equivalent to one she considers. This transformation maps our index restriction to a
separability condition whose advantages she emphasizes in a variety of other contexts. Even
starting from the transformed model, however, our assumptions and proof di¤er from hers
in important ways.8 Our strategy and results may therefore complement those in Matzkin
(2008) for other applications of simultaneous equations models.
For an important preliminary result, we rely heavily on insights in Gandhi (2008), which
recently showed how to extend a key invertibility result of Berry (1994) and Berry and
Pakes (2007) to a more general class of discrete choice demand models.

We reinterpret

Gandhi’s key assumption graphically as our “connected substitutes” condition, requiring
that for every pair of products fj; kg there be some path of local substitution linking j to
Although Gandhi (2008) focused on invertibility of demand, we show that the same

k.

connected substitutes condition plays an important role in ensuring the invertibility of the
oligopoly supply side.
Turning to other recent unpublished papers, Berry and Haile (2009b) explores the iden8

For example, we use the same independence and support assumptions she uses in discussing supply and
demand, but we do not require any conditions on (even existence of) derivatives of densities.

7

ti…cation of discrete choice models in the case of “micro data” relying in part on ideas
similar to those used here. The distinction between “market data” and “micro data” has
been emphasized in the recent industrial organization literature (e.g., Berry, Levinsohn, and
Pakes (2004)), but not the econometrics literature on identi…cation. A key insight in Berry
and Haile (2009b) is that within a market all market/choice-speci…c unobservables are held
…xed.

One can therefore learn a great deal about the distribution of utilities from “vari-

ation in choice sets” created by within-market heterogeneity in consumer/choice-speci…c
covariates— variation that is not confounded by variation in the market/choice-speci…c unobservables. That strategy is exploited throughout Berry and Haile (2009b), but cannot be
applied to market level data.9 In Berry and Haile (2009a) we have explored related ideas in
the context of a “generalized regression model”(Han (1987)), which nests the binary choice
model.

For that class of models, the index restriction we require throughout the present

paper can be dropped.

Unfortunately, many applications fall outside the binary choice

setting.
Concurrent work by Fox and Gandhi (2009) explores identi…ability of several related
models, including a ‡exible model of polychotomous choice in which consumer types are
themselves multinomial and the conditional indirect utility functions are analytic. They do
not consider our case with market-level data and endogenous prices set in a (non-triangular)
system of equations.10 A recent working paper by Chiappori and Komunjer (2009) considers
a related change of variables approach in a “micro data”context.
9

Berry and Haile (2009b) includes an example in which what appears to be a “market data”environment
is actually isomorphic to the “micro data”environment. In that example one has a continuum of observations
for which choice-speci…c unobservables are held …xed while observables vary. In general this is not the case.
10

A recent paper by Bajari, Fox, Kim, and Ryan (2009) considers identi…cation in a linear random coef…cients model without endogeneity, assuming that the distribution of an additive i.i.d. preference shock is
known.

8

3

Demand Model

3.1

Consumers, Products and Markets

Each consumer i in market t chooses a single good from a set Jt . We will use the terms
“good,” “product,” and “choice” interchangeably. The term “market” is synonymous with
the choice set. In practice, markets will typically be de…ned geographically and/or temporally. The choice set always includes the option not to purchase, i.e., to choose the
“outside good,”which we index as choice j = 0. We denote the number of “inside goods”by
Jt = jJt j

1.11

Each inside good/market has observable (to us) characteristics xjt 2 RKx and price pjt 2
R. We treat xjt and pjt di¤erently because we will allow pjt to be endogenous. The restriction
to a single endogenous characteristic re‡ects the usual practice, but is not essential.12 We
allow xjt to include components that vary only with the market t, only with the product j
(these could be product dummies), or both. Unobservables at the level of the product and
market are represented by an index

jt

2 R.

In applications this is typically motivated

by the presence of unobserved product characteristics and/or unobserved variation in tastes
across markets.
We let

3.2

A market (choice set) t is thus characterized by Jt ; xjt ; pjt ;

= supp xjt ; pjt ;

jt

and

Jt

=supp xjt ; pjt ;

jt j2Jt

.

jt j2Jt .

Preferences

We consider preferences represented by a random utility model. Each consumer i in market t
has conditional indirect utilities vijt for each product j determined by a function uit :

! R.

Consumers have heterogeneous tastes, even conditional on all observables. This is modeled
by specifying each consumer i’s utility function uit as a random draw from a set U. We
11

In applications with no “outside choice”our approach can be adapted by normalizing preferences relative
to those for a given choice. The same adjustment applies when characteristics of the outside good vary across
markets in observable ways.
12
The modi…cations required to allow higher dimensional pjt are straightforward, although the usual
challenge of …nding adequate instruments for more than one endogenous product characteristic would remain.

9

discuss restrictions on U below.
More formally, let ( ; F; P) denote a probability space. Given any xjt ; pjt ;

jt

2

,

consumer i’s conditional indirect utility from good j is given by

vijt = uit xjt ; pjt ;

= u xjt ; pjt ;

jt

(1)

jt ; ! it

where u is measurable in ! it ; and u ( ; ; ; !) 2 U for all ! 2

. Thus, conditional indirect

! R.13

utilities are represented with a random function u :

This formulation super…cially resembles models in which randomness in utilities is captured by a scalar random variable (e.g., Lewbel (2000), Matzkin (2007a), Matzkin (2007b));
however, here ! it is not a random variable but an elementary event in
an arbitrary number of random variables.

that can determine

The following example illustrates by mapping

our model to a much more restrictive but more familiar special case.
Example 1. A special case of the class of preferences we consider is generated by the linear
random coe¢ cients random utility model

u xjt ; pjt ;

where (

it ;

it ; i1t ; : : : ; iJt )

(! it ) ;

This structure permits (

it ;

jt ; ! it

= xjt

+

jt

+

ijt

(2)

are de…ned on the probability space ( ; F; P) as
(1)

(! it ) ; : : : ;

(Kx )

it ; i1t ; : : : ; iJt )

(! it ) ;

1

(! it ) ; : : : ;

J

(! it ) :14

to have an arbitrary joint distribution but is more

restrictive than necessary. For example, specifying
preference heterogeneity/heteroskedasticity.
13

it pjt

it

ijt

=

j

(xjt ; pjt ; ! it ) would allow richer

If we relax the model further by specifying

See, e.g., Gikhman and Skorokhod (1980).

14

The fact that we allow product dummies as components of xjt enables us to write choice-speci…c functions
like j here. Note also that this structure permits variation in Jt across markets. The realization of ! it
should be thought of as generating values of ijt = j (! it ) for all possible choices j, not just those in the
current choice set. Thus, the utility function de…nes preferences even over products not available.

10

ijt

=

j

xjt ; pjt ;

jt ; ! it

, the terms xjt

obtain our original model u xjt ; pjt ;

it pjt

it

jt ; ! it

=

+

jt

xjt ; pjt ;

in (2) become redundant and we
jt ; ! it

:

Note that there is no market subscript t on the probability measure P.
our assumption that

jt

This re‡ects

captures all unobserved heterogeneity at the market and/or product

level. This is standard in the literature but is an important restriction.15 Aside from this
restriction, however, our representation of preferences is so far fully general. For example, it
allows arbitrary correlation of consumer-speci…c tastes for di¤erent goods or characteristics.
Because xjt can include product dummies, it allows marginal utilities of characteristics to
di¤er arbitrarily across products. It also allows arbitrary heteroskedasticity in utilities across
di¤erent products, or in utilities for a given product j as its characteristics xjt ;

jt

However, we will rely on two restrictions on preferences throughout the paper.

vary.
First,

for simplicity we will assume that for all functions u~it 2 U, any Jt , any distinct k; ` 2 Jt ,
and any

xjt ; pjt ;

jt j2fk;`g ,

the random di¤erences u~it (xkt ; pkt ;

kt )

u~it (x`t ; p;`t ;

`t )

are

continuously distributed with convex support. This simpli…es the analysis by enabling us
to ignore ties and choice probabilities that are invariant to a strict (stochastic) increase in
vijt for some j.

The second restriction is more signi…cant, imposing an index restriction on

the way market/choice-speci…c unobservables enter the random utility function. To state
(1)

(2)

(1)

this condition, partition xjt as xjt ; xjt , with xjt 2 R, and de…ne the index
(1)

jt

= xjt +

Assumption 1a. For all u~it 2 U, u~it xjt ; pjt ;

jt

jt :

=

it

(2)
jt ; xjt ; pjt

for some function

it

that is strictly increasing in its …rst argument.
This assumption limits attention to random utility functions admitting representations
15

An exception is Athey and Imbens (2007), although they do not address identi…ability of their model.
Athey and Imbens (2007) point out testable restrictions in “micro data” settings if one assumes that the
same scalar product/market-level unobservable applies to all subpopulations of consumers. A similar testable
restriction exists in the model of Berry and Haile (2009b), which allows the unobservable to vary with some
(but not all) consumer observables. The model of binary choice nested in the generalized regression model
of Berry and Haile (2009a) permits a di¤erent unobservable for every vector of consumer-level observables.

11

of the form
vijt = u
with u monotonic in

jt .

(2)
jt ; xjt ; pjt ; ! it

(3)

There are two parts to this restriction.

to a “vertical”unobservable

jt ;

The …rst is a restriction

i.e., all else equal, an increase in

jt

makes product j more

attractive to all consumers. This is standard in the applied literature and is a property we rely
on to allow recovery of each
substitutability between

16
jt .

The second is a linear index restriction requiring perfect
(1)

jt

and xjt inside the function u.17

As already mentioned, this

index restriction plays an important role in both of our identi…cation approaches. However,
we show in Appendix B that strengthening the instrumental variables requirements used for
(1)

our nonparametric IV approach would allow us to replace the linear indices xjt +
nonlinear indices

(1)

j

xjt ;

jt

that are strictly monotonic in

jt

with

jt .

With this structure on preferences we will show identi…cation of demand, identi…cation
of marginal costs, and the falsi…ability of a given oligopoly model. To obtain results that
also allow characterization of standard welfare measures, we will strengthen Assumption 1a
to require quasilinearity in price.18
Assumption 1b. For all u~it 2 U there is a monotonic function
(2)
jt ; xjt

it

pjt for some function

it

it

such that

it

u~it xjt ; pjt ;

jt

that is strictly increasing in its …rst argument.

Assumption 1b di¤ers from Assumption 1a in requiring conditional indirect utilities with
16

Athey and Imbens (2007) and Berry and Haile (2009b) discuss testable implications in the case of micro
data.
17

In the linear random coe¢ cients model of Example 1, Assumption 1a holds if either (a) one covariate
(1) (1)
(1)
(2) (2)
enters with a …xed coe¢ cient (common in practice) or (b) uijt = xjt it + jt it + xjt it
it pjt + ijt ,
with

(1)
it

> 0. Of course, we do not require the linear random coe¢ cients structure.

18

We assume quasilinearity in price because this is the natural unit for measuring compensating variation.
(2)
However, quasilinearity in any element of xjt (or in jt ) would also su¢ ce.

12

=

quasilinear representations19

vijt =

Quasilinearity plays two roles for us.
gregate welfare measures.

(2)
jt ; xjt ; ! it

(4)

pjt :

First, it allows the model to de…ne standard ag-

Second, it provides a mapping between the observable units

of choice probabilities and the latent units of utilities. This is a standard strategy in the
literature on discrete choice. Note, however, that we do not require independence between
pjt and the random variable

(2)
jt ; xjt ; ! it

; in fact, this is ruled out by standard models

of supply. However, the restriction that P does not vary across markets does imply that
(2)
jt ; xjt ; ! it

is independent of pjt conditional on

(2)
jt ; xjt

.20

To relate this to more

familiar models, observe that in the linear random coe¢ cients model of Example 1, this
conditional independence holds if (

it ; it )

are assumed independent of pjt .

Finally, two types of normalizations will be needed to obtain a unique representation of
preferences.

Such normalizations are without loss of generality.

of utilities, which have no natural location or units (scale).

One is a normalization

Throughout the paper we

normalize the location of utilities by setting the utility from the outside good to zero: vi0t =
0. We will require a scale normalization of utilities only for the results using Assumption
1b, which already incorporates such a normalization. The second type of normalization
involves the choice-speci…c unobservables

jt .

(1)

Linear substitutability between xjt and

(Assumption 1a) already de…nes the scale of each

jt ,

jt

but its location must be normalized. It

will be convenient to use a di¤erent location normalization for each of our two identi…cation
approaches, so we will provide these below.
19

As long as vijt is strictly decreasing in pjt with probablity one, (4) is equivalent to a spe…cation allowing
a random coe¢ cient on price: the scale of each consumer’s utility function can be normalized by her price
coe¢ cient without loss.
20

Recall that each market is t is de…ned by Jt ; xjt ; pjt ;

13

jt j2Jt

.

3.3

Market Shares

Given the choice set, each consumer maximizes her utility, choosing product j whenever

u

(2)
jt ; xjt ; pjt ; ! it

>u

(2)
kt ; xjt ; pkt ; ! it

8k 2 Jt

fjg:

(5)

We denote consumer i’s choice by
(2)
jt ; xjt ; pjt ; ! it

yit = arg max u
j2 Jt

:

Given Jt ; market shares (choice probabilities) are given by
sjt = EP [1 fyit = jg]
h n
(2)
= EP 1 u jt ; xjt ; pjt ; ! it > u
sj (fxkt ; pkt ;

(2)

kt ; xkt ; pkt ; ! it

8k 2 Jt

fjg

kt gk2Jt ) :

oi

(6)

We will assume that all goods observed in equilibrium have positive market shares.
Assumption 2. For all Jt and fxkt ; pkt ;

kt gk2Jt

2

Jt

, sj (fxkt ; pkt ;

Market shares are positive for all goods at any fxkt ; pkt ;

kt gk2Jt

kt gk2Jt )

> 0.

in models for which the

support of fvijt gk2Jt is always RJt . In a parametric context this includes multinomial probit
or logit models, for example. Assumption 2 of course requires only that market shares be
positive at equilibrium values of fxkt ; pkt ;

3.4

21
kt gk2Jt .

Observables and Primitives of Interest

We let Mt denote the measure of consumers in market t (the “market size”). Let z~t denote instruments excludable from the utility function (we discuss appropriate excluded instruments
21

For example, in the usual price-setting oligopoly model an inside good can have zero market share only
if a good is o¤ered by a …rm even though it cannot be sold at any price above marginal cost. A necessary
condition for the outside good to have zero market share is that the there be no downward distortion in
market output due to imperfect competition. This can arise in some simple oligopoly models like that of
Hotelling (1929) if preferences and locations are such that the market is “covered.”

14

below). The observables consist of (t; Mt ; Jt ; z~t ; fsjt ; xjt ; pjt gj2Jt ). To study identi…cation,
for every (t; Mt ; Jt ) we treat the population distribution of (~
zt ; fsjt ; xjt ; pjt gj2Jt ) as known.
On the demand side of the market, we will consider two types of identi…cation results.
One is identi…cation of demand; i.e., identi…cation of each

jt

and the functions sj de…ned

in (6). These primitives fully characterize the demand system: they describe how product
characteristics (observed and unobserved, endogenous and exogenous) determine the market
shares of all goods, including the outside good.
Identi…cation of demand is su¢ cient for many purposes motivating demand estimation.
However, we also consider identi…cation of the joint distribution of indirect utilities conditional on the choice set (Jt ; fxkt ; pkt ;
the random utility model.

kt gk2Jt ).

We refer to this as full identi…cation of

These conditional distributions are the primitives determining

all quantities de…ned by our random utility model.

Under the quasilinear structure of

Assumption 1b this includes standard measures of aggregate welfare.22
Henceforth we will condition on Jt = J with jJ j = J. We also condition on a value
(2)

of xt

(2)

(2)

= x1t ; : : : ; xJt
(1)

(2)

and suppress xt
(2)

represent xjt : Conditioning on xt

in the notation. For simplicity we then let xjt

requires that we write

vijt = uj (

(7)

jt ; pjt ; ! it )

and
vijt =

j

(

jt ; ! it )

(8)

pjt

(with j subscripts on the functions u and ) to represent, respectively, (3) and (4) above,
(2)

since the utility functions will generally be evaluated at di¤erent xjt for each j.23 We will
work with these two representations of preferences in what follows.
22
The primitives of our model do not determine individual utilities. Thus, for example, it cannot be
used to characterize Pareto improvements. As usual, assuming quasilinearity will allow us to characterize
potential Pareto improvements. Parametric random utility models allow tracking of individual utilities
(even with market level data!) by associating realizations of random preference parameters with individual
consumers.
23

(2)

Because xt

may include product dummies, the functions uj and

15

j

may vary arbitrarily with j.

4

Connected Substitutes

Central to our identi…cation arguments is the inversion of equilibrium conditions— of choice
probabilities implied by utility maximization on the demand side and of …rst-order conditions
for oligopoly equilibrium the supply side. A key condition for ensuring invertibility is that
the choice set J be comprised of goods that “belong” (in a sense de…ned below) in the
same choice problem for at least some consumers.

To state this “connected substitutes”

assumption, we …rst need a de…nition.
De…nition 1. Product k substitutes to product ` at fxjt ; pjt ;

jt gj2J

such that vikt is strictly stochastically increasing in wkt ; s` fxjt ; pjt ;

if, for any variable wkt
jt gj2J

rises when wkt

falls.24
Our initial use of this de…nition involves the case wkt =
wkt =

pkt when we discuss identi…cation of supply.

kt ,

although we also consider

De…nition 1 provides a directional

notion of one product being a substitute for another. For example, if vikt is strictly decreasing
in pkt , we would say that product k substitutes to product ` if a rise in pkt leads (all else
equal) to a larger market share for product `.
Given a value of fxjt ; pjt ;

jt gj2J ,

let

(J ) denote the (J + 1)

and ones with the (r; c) element equal to one if product (r

1) substitutes to product (c

Assumption 3 (“Connected Substitutes”). At all fxjt ; pjt ;
graph of

(J + 1) matrix of zeros

jt gj2J

2

J

1).

, the directed

(J ) is strongly connected.

The directed graph of

(J ) has nodes (vertices) representing each product and an edge

from product k to product ` whenever product k substitutes to product `.25

Formally,

the connected substitutes condition requires that for any distinct products j and j 0 there
be a path of substitution, possibly indirect, from j to j 0 .

To describe the key economic

24

Because we introduce this assumption after normalizing the utility of the outside good to zero, we de…ne
a fall in w0t to mean equal increases in wjt for all j > 0. Thus product 0 substitutes to product j if the
market share of product j increases whenever wkt increases by an equal amount for all k > 0:
25

In standard examples (J ) is symmetric, so its directed graph can be represented with bi-directional
edges. See the additional discussion in Appendix D.

16

Figure 1: Graphs of (J ) at generic fxjt ; pjt ; jt gj2J for standard models. All edges are
bi-directional, so for simplicity we show undirected graphs. Panel a: multinomial logit,
multinomial probit, mixed logit, etc.; Panel b: pure vertical models e.g., (, Mussa and Rosen
(1978), Bresnahan (1981), etc.); Panel c: Salop (1979) with random utility for the outside
good; Panel d: Rochet and Stole (2002); Panel e: independent goods and an outside good.

17

implication, interpret wkt in De…nition 1 as the “quality” of product k. Then Assumption
3 implies that, all else equal, if “quality”rises (falls) for every product in some strict subset
J but for no product outside I, the total market share of all products outside I falls

I

(rises).26 This is a very natural property for an environment with unit demands.
It is also easy to verify that the connected substitutes property itself holds in standard
models. In fact, the usual random utility discrete choice models (e.g., multinomial probit,
logit, mixed logit, etc.) imply that every product substitutes directly to every other product,
a strong su¢ cient condition for connected substitutes.
graphs of

Figure 1 illustrates, showing the

(J ) for a variety of models. As panel e illustrates, even a market comprised of

independent goods satis…es this condition as long as each product substitutes to and from
the outside good.

5

Identi…cation with Nonparametric IV Conditions

5.1

Identi…cation of Demand

Let xt = (x1t ; : : : ; xJt ), pt = (p1t ; : : : ; pJt ), and
for any vector

t,

t

=(

1t ; : : : ; Jt ).

Under Assumption 1a,

market shares are given by

sjt = EP [1 fuj (
j

jt ; pjt ; ! it )

uk (

kt ; pjt ; ! it )

8k 2 J g]
(9)

( t ; pt ) :

Using the connected substitutes assumption, we can follow the argument in Theorem 2
of Gandhi (2008) to show the following lemma, which generalizes well-known invertibility
results for linear discrete choice models in Berry (1994) and Berry and Pakes (2007).27
26

This is demonstrated formally as Lemma 4 in Appendix A. An analogous implication follows if we
interpret wjt as the price of good j.
27

See Corollary 1 in Appendix A for the equivalence between Gandhi’s condition and our connected substitutes condition. Berry (1994) and Berry and Pakes (2007) show existence and uniqueness of an inverse
choice probability in models with an additively separable jt . Gandhi (2008) relaxes the separability requirement. Our lemma addresses only uniqueness conditional on existence. Under our maintained assumption

18

Lemma 1. Consider any price vector p and any market share vector s = (s1 ; : : : ; sJ )0 on
the interior of 4J . Under Assumptions 1a, 2, and 3 there is at most one vector
j

such that

( ; p) = sj 8 j.

Proof.

See Appendix A.

With this result we can write
1

jt

=

j

xjt +

jt

=

8j

(st ; pt )

(10)

or
1
j

(st ; pt )

8j:

(11)

To state the instrumental variables conditions, recall that z~t represents instruments for
pt excluded from the determinants of fvijt gj2J .

Standard excluded instruments include

cost shifters (e.g., input prices) or proxies for cost shifters such as prices of the same good in
other markets (Hausman (1996), Nevo (2001)). With the exogenous conditioning variables
(~
zt ; xt ), we take the following instrumental variables assumptions from Newey and Powell
(2003).
Assumption 4. E[

zt ; xt ]
jt j~

= 0 almost surely for all j.

Assumption 5. For all functions B (st ; pt ) with …nite expectation, if E [B (st ; pt ) j~
zt ; xt ] = 0
almost surely then B (st ; pt ) = 0 almost surely.
Assumption 4 is a standard exclusion restriction, requiring mean independence between
the instruments and the structural error

jt .

Note that setting E[

zt ; xt ]
jt j~

equal to zero

rather than another constant provides the required normalization of the location of

jt .

As-

sumption 5 is a “completeness”condition, which is the nonparametric analog of the standard
that the model is correctly speci…ed, given any observed choice probability vector, there must exist a vector ( 1 ; : : : ; J ) that rationalizes it. Gandhi (2008) provides conditions guaranteeing that an inverse exists
for every choice probability vector in 4J . Our uniqueness result di¤ers from his only slightly, mainly in
recognizing that the argument applies to a somewhat more general model of preferences. For a class of
single-agent dynamic discrete choice models similar to our model with an additive jt , Hotz and Miller
(1993) prove the uniqueness of the inverse of the share function and sketch a proof of existence of the inverse
that is correct for the binary case.

19

rank condition for linear models. This condition requires that the instruments move the endogenous variables (st ; pt ) su¢ ciently to ensure that any function of these variables can
be distinguished from other functions through the exogenous variation in the instruments.
See Newey and Powell (2003) (and references therein) and Severini and Tripathi (2006) for
helpful discussion and examples.28
Newey and Powell (2003) used analogs of Assumptions 4 and 5 to show the identi…ability
of a separable nonparametric regression model. The following result shows that the same
argument can be applied to show identi…cation of demand in our discrete choice setting.
Theorem 1. Under Assumptions 1a and 2–5, for all j (i)
the function sj (fxkt ; pkt ;

kt gk2J )

is identi…ed on

J

jt

is identi…ed for all t, and (ii)

.

Proof. For any j, rewriting (11) and taking expectations conditional on z~t ; xt , we obtain

E

zt ; xt
jt j~

=E

1
j

(st ; pt ) z~t ; xt

xjt

so that by Assumption 4,
1

E

j

(st ; pt ) z~t ; xt

xjt = 0

a:s:

xjt = 0

a:s:

Suppose there is another function ~ j 1 satisfying
E ~ j 1 (st ; pt ) z~t ; xt
Letting B (st ; pt ) =

1
j

(st ; pt )

~ j 1 (st ; pt ), this implies

E [B (st ; pt ) j~
zt ; xt ] = 0
But by Assumption 5 this requires ~ j 1 =
28

If we assumed bounded support for
completeness.

jt

1
j

a:s:

almost surely, implying that

1
j

is iden-

and xjt we could replace the completeness condition with bounded

20

ti…ed. Repeating for all j, each

jt

is then uniquely determined by (11), proving part

(i). Because choice probabilities are observed and all arguments of the demand functions
sj (J ; fxkt ; pkt ;

kt gk2J )

are now known, part (ii) follows immediately.

The proof is very similar to that given by Newey and Powell (2003) in the context of
nonparametric regression. A di¤erence is that we have, in addition to the nonparametric
function

1
j

(st ; pt ), the additive xjt , which drops out of the proof and becomes available as

as one of the 2J instruments for the 2J endogenous variables (st ; pt ).
If we strengthen the instrumental variables assumptions 4 and 5 as in Chernozhukov and
Hansen (2005), we can relax the linear index structure, allowing

jt

where each

j

=

j

xjt ;

jt

is any function that is strictly increasing in its second argument. We discuss

this extension in Appendix B.

5.2

Full Identi…cation of the Random Utility Model

We consider full identi…cation of the random utility model under the quasilinear speci…cation
of preferences in Assumption 1b. We will also make a large support assumption:29
Assumption 6. supp pt j xjt ;

jt j2J

supp (

1

(

1t ; ! it ) ; : : : ;

J

(

Jt ; ! it ))t

j xjt ;

jt j2J

:

This type of support condition is strong but also standard in the literature because it
provides a natural benchmark for evaluating identi…cation under ideal conditions on observables.30 It is intuitive that in order to trace out the full CDF of the random part of a random
29

This assumption on the support of pt is combined below with the restriction to quasilinearity in price
(Assumption 1b). An analogous assumption would be substituted if instead the quasilinearity were in jt
(2)
or and element of xjt .
30

To our knowledge, all results showing semiparametric or nonparametric identi…cation of a full random
utility model rely on a similar condition (e.g., Matzkin (1992), Matzkin (1993), Ichimura and Thompson
(1998), Lewbel (2000), Fox and Gandhi (2009)).

21

utility model, extreme values of observables will be needed.31 As the proof of the following
result makes clear, we use the large support condition only for this role; in particular, we do
not use the common “identi…cation at in…nity” argument that takes observables for all but
one choice to extreme values in order to reduce a multinomial choice problem to a binary
choice problem.

The argument here makes clear that if the support condition fails (the

support of pt excludes tail values), the implication will be that the joint distributions of
(vi1t ; : : : ; viJt ) will be unknown at its tail values.
Theorem 2. Under Assumptions 1b and 2–6, the joint distribution of (vi1t ; : : : ; viJt ) conditional on any fxkt ; pkt ;

kt gk2J

J

2

is identi…ed.

Proof. The market share of the outside good, conditional on pt , xt , and (

Pr (

By Theorem 1 each
independent of

(

jt

1

(

1t ; ! it )

p1t ; : : : ;

is identi…ed, so each

jt ; ! it )

conditional on

jt ,

jt

J

(

Jt ; ! it )

1t ; : : : ; Jt ) ;

is

pJt ) :

can be treated as known. Then, since pjt is

Assumption 6 ensures identi…cation of the joint

distribution of
(
for any (

5.3

1t ; : : : ; Jt ).

1

Since vijt =

(
j

1t ; ! it ) ; : : : ;

(

jt ; ! it )

J

(

Jt ; ! it ))

pjt , the result follows.

Adding A Supply Side

If we are willing to add a speci…cation of the supply model, we can obtain identi…cation
of …rms’marginal costs as well. Here we can return to the less restrictive speci…cation of
31

Given our normalization of utility from the outside good, Assumption 6 requires that there be some price
pjt at which all consumers would prefer good j to the outside good, at least weakly; i.e., letting pmin
= inf
j
min
supp pjt , we require j ( jt ; ! it )
pmin
.
Note,
however,
that
a
model
in
which
(
;
!
)
<
p
with
jt
it
j
j
j
positive probability is equivalent to (same implications for demand on J and for welfare) a model in which
all probability mass on j ( jt ; ! it ) < pmin
is moved to j ( jt ; ! it ) = pmin
Thus, as usual with welfare
j
j .
analysis, the critical assumption is that there be su¢ ciently high prices to pin down the willingness to pay
of high value consumers.

22

preferences in Assumption 1a.

Our approach generalizes arguments from the parametric

literature on the estimation of static oligopoly models, which utilize …rst-order conditions for
…rms to solve for marginal costs in terms of demand parameters. Using …rst-order conditions
requires that the market share function

j

( t ; pt ) be di¤erentiable with respect to prices, and

we will assume this directly.
Assumption 7.

j

( t ; pt ) is continuously di¤erentiable with respect to pk 8j; k 2 J .

We consider a nonparametric speci…cation of costs, but require su¢ cient structure to
ensure that behavior is characterized by …rst-order conditions that can be inverted to solve
for the unobserved cost shocks. As with the demand model, the most restrictive assumption
we require is an index restriction on how these shocks enter. In particular, we assume the
marginal cost associated with product j depends on its output quantity qjt = Mt

j

(pt ; t ),

a “cost index,”and other cost shifters:
(1)

mcj qjt ; zjt +
Here

(1)

jt

(2)

is an unobserved cost shock and zjt ; zjt
(2)

(2)

(2)
jt ; zjt

(12)

:
(1)

are observed cost shifters, with zjt 2 R.
(1)

We permit zjt to include components of xjt , although xjt is excluded. We will be explicit
(1)

(1)

below about the independent variation required of z1t ; : : : ; zJt .
Parallel to our model of demand, (12) imposes perfect substitution between the unob(1)

served cost shock

jt

and the cost shifter zjt inside the nonparametric function mcj . This

is an important restriction, but one that is satis…ed in many standard models.32 We denote
the cost index by

(1)

zjt +

jt

jt .

As with the parallel assumption on the demand side, the

linearity of the index can be relaxed under additional assumptions discussed in Appendix B.
(2)

We continue to condition on (and suppress) xt . We now also condition on a value of
(2)

zt

(2)

(2)

(1)

= z1t ; : : : ; zJt , likewise suppressing it in the notation and letting zjt denote zjt for

simplicity. We will show invertibility of the supply model under the following conditions.
32

(1)

Note that zjt and
shifters.

jt

could be any known transformations of some other observed and unobserved cost

23

Assumption 8. For all j
(i) mcj (qjt ;
(ii) uj (

jt )

is strictly monotonic in

jt ; pjt ; ! it )

jt ;

is strictly decreasing in pjt ;

(iii) there exists a function

j

(possibly unknown) such that for any equilibrium value of

(st ; pt )
mcj (Mt sjt ;
where Dt (st ; pt ) is the J

jt )

=

j

(st ; Mt ; Dt (st ; pt ) ; pt )

J matrix of partial derivatives

@

k

(pt ;

1
1

(st ;pt );:::;
@p`

1
J

(st ;pt ))

.
k;`

Given the index restriction, part (i) of Assumption 8 is fairly weak: weak monotonicity
in an unobservable could be assumed without loss, since that would merely de…ne an order
on the unobservable. Part (ii) requires strictly downward sloping demand.

Part (iii) is a

high-level condition requiring that it be possible to rewrite …rst-order conditions to express
marginal cost for each product as a function of equilibrium quantities (market shares), prices,
and derivatives of demand at these prices and quantities. Our ability to express this matrix
in terms of (st ; pt ) exploits the invertibility result of Lemma 1. We show in Appendix C that,
under assumptions already made, part (iii) holds for a variety of standard oligopoly models,
including the multi-product price-setting oligopoly model most often used in empirical work.
By referring to the high-level condition in part (iii) of Assumption 8 we will be able to
provide results for a class of models rather than just one. This will be particularly useful
when we discuss discrimination between alternative models.
The following lemma shows that under Assumption 8, …rms’…rst-order conditions imply
a unique vector of cost indices

t

for any vector of equilibrium prices and market shares.

Lemma 2. For any market size Mt and any given (st ; pt ), there is exactly one (

1t ; : : : ;

Jt )

2

RJ consistent with Assumption 8.
Proof. By part (i) of Assumption 8, the function mcj in part (iii) can be inverted, yielding

jt

= mcj 1

j (st ; Mt ; Dt

24

(st ; pt )t ; pt ); Mt sjt :

(13)

Given Mt , the right-hand side is an unknown function of st ; pt .
Henceforth we will …x a value of Mt and suppress it in the notation. We can then re-write
(13) as33
zjt +

jt

=

1
j

(st ; pt )

8j:

(14)

This provides a key set of equations for what follows.
Note that equation (14) takes the same form as (11). We will use this relation in the
same way. Let z~t include the exogenous cost shifters (z1t ; : : : ; zJt ) : We can then show the
following result.
Theorem 3. Suppose that Assumptions 1a, 2–5, 7 and 8 hold. Then for all j (i)
identi…ed for all t; and (ii) if
support of qjt ;

jt

j

is known, the function mcj (qjt ;

jt )

jt

is

is identi…ed on the

.

Proof. Part (i) follows by observing that the argument used in the proof of Theorem 1 can
be repeated with trivial modi…cation to recover the inverse pricing relations
shocks

jt

1
j

and the cost

using the instrumental variables (xt ; z~t ) : Now recall that

mcj (qjt ;

jt )

=

j

(st ; Dt (st ; pt ) ; pt ) .

Theorem 1 ensures that Dt (st ; pt ) is known. Thus all arguments of

(15)

j

are known and, if

j

is itself known, the right side of (15) is known. Since qjt = Mt sjt , by part (i) both arguments
of the left side of (15) are known. Part (ii) then follows.

6

A Change of Variables Approach

The preceding analysis yields encouraging results. A ‡exible model of demand (and supply) for di¤erentiated products is identi…ed under the same kind of instrumental variables
The function j 1 involves the composition of mcj 1 and j . Although we do not de…ne a function
1
as a reminder that this represents an “inversion” of supply side equilibrium
j ; we use the notation j
conditions.
33

25

conditions required for identi…cation of regression models. Full identi…cation holds as well
if we add the kind of separability and support conditions used to show identi…cation of even
the simplest semiparametric models of multinomial choice.

However, a limitation of the

results above is the abstract nature of the completeness condition, which can be di¢ cult
to interpret or verify.

Here we consider an alternative approach that treats the demand

and supply models as a system. This enables us to pursue a change of variables argument
often useful for simultaneous equations models (e.g., Brown (1983), Roehrig (1988), Matzkin
(2005), and Matzkin (2008)).
This approach has advantages and disadvantages relative to the previous approach. The
main disadvantages are the need to place some structure on the supply side even to identify
demand, and the need for additional conditions ensuring that we can relate a joint density
of the latent structural errors to a joint density of observables.

These involve regularity

conditions as well as a high level assumption to avoid problems that can be created by
multiple equilibria. We will also require full independence of the instruments. An advantage
is that we will be able to replace the abstract completeness condition with a transparent
support condition on demand and cost shifters. This leads to constructive arguments with
close connections to classical identi…cation arguments for models of demand and supply.
We begin with results on identi…cation of demand, which we can show without fully
specifying the supply side. We then address identi…cation of marginal costs under a complete
speci…cation of the supply model.

6.1

Identi…cation of Demand and the Random Utility Model

From the analysis above we repeat the two equations (11) and (14):

xjt +

jt

=

j

zjt +

jt

=

j

1

(st ; pt )

8j

1

(st ; pt )

8j:

Here we consider these 2J equations as a system.
26

As in the preceding sections, the linear structure of the indices normalizes the scale of the
unobservables

jt

and

jt .

To normalize locations, instead of setting means to zero, without

loss we take any (x0 ; z 0 ) and any (s0 ; p0 ) in the support of (st ; pt ) j (x0 ; z 0 ) and let
1

s 0 ; p0

x0j = 0 8j

1

s 0 ; p0

zj0 = 0 8j:

j
j

(16)

Although the invertibility results above ensure that there is a unique ( t ; t ) associated
with any (st ; pt ), the change of variables approach requires that this map be one-to-one.
The market share functions (9) ensure that there is exactly one vector st associated with
any ( t ; pt ). We will assume directly that there is also only one price vector pt consistent
with any ( t ; t ).
Assumption 9. There is a unique vector of equilibrium prices associated with any ( ; ).
This assumption is satis…ed if, at the true marginal cost and demand functions, the
equilibrium …rst-order conditions have a unique solution (for prices) given any ( ; ). This
is often di¢ cult to verify in models of product di¤erentiation (see, for example, Caplin and
Nalebu¤ (1991)), and it is not hard to construct examples in which multiple equilibria do
exist. If there are multiple equilibria, Assumption 9 requires an equilibrium selection rule
such that the same prices pt arise whenever ( t ; t ) is the same. This rules out random
equilibrium selection or equilibrium selection based on xjt or
(and similarly for

jt

instead of their sum

jt

jt ).

We also require regularity conditions that enable us to relate the joint density of the
structural errors (

1t ; : : : ; Jt ;

1t ; : : : ;

Jt )

to the joint density of the observables (st ; pt ).

Assumption 10. The random variables ( 1 ; : : : ;
f;

J;

1; : : : ;

J)

have a positive joint density

on R2J :

Assumption 11. The vector function

1
1

;:::;

derivatives and nonzero Jacobian determinant.
27

1
J

;

1
1

;:::;

J

1 0

has continuous partial

Finally, we add assumptions on the excluded demand and cost shifters.

Assumption

12 requires full independence from the structural errors, while Assumption 13 ensures that
these instruments have su¢ cient variation to trace out the demand and cost functions.
( t ; t ):

j=

Assumption 12. (xt ; zt )

Assumption 13. supp(xt ; zt ) = R2J :
With these assumptions, we can now show the identi…ability of demand.
Theorem 4. Suppose Assumptions 1a, 2, 3, and 8–13 hold. Then for all j (i)
for all t; and (ii) the function sj (fxkt ; pkt ;

kt gk2J )

J

is identi…ed on

jt

is identi…ed

.

Proof. We observe the joint density of market shares and prices, conditional on the vectors xt
and zt . Under Assumptions 8–12 this joint density is related to that of (

1t ; : : : ; Jt ;

1t ; : : : ;

Jt )

by

fs;p (st ; pt jxt ; zt ) =
f

1

;

1

(st ; pt )

x1t ; : : : ;

1
J

(st ; pt )

xJt ;

1
1

(st ; pt )

z1t ; : : : ;

1
J

(st ; pt )

zJt jJ(st ; pt )j

where jJ (st ; pt )j is the absolute value of the Jacobian determinant for the vector function
1
1

;:::;

1
J

;

1
1

;:::;

J

1 0

evaluated at the point (st ; pt ). Therefore, for any observed

(^
s; p^; x^; z^; x; z) we can construct the ratio

(^
s; p^; x^; z^; x; z)

f
f

;
;

1

(^
s; p^)
1
s; p^)
1 (^
1

x1 ; : : : ;
x^1 ; : : : ;

1
J
1
J

(^
s; p^)
(^
s; p^)

The Jacobian determinants cancel.34 Thus, …xing (^
s; p^; x^; z^),
34

zJ jJ (^
s; p^)j
:
z^J jJ (^
s; p^)j

(17)

(^
s; p^; x^; z^; x; z) is equal to the

This “trick”of using ratios of densities to cancel the Jacobian determinant is a critical step and was used
by Matzkin (2005) (section 6) to sketch a constructive identi…cation argument for a simultaneous equations
model with the same form that we obtain after inverting the market share and pricing equations. Her sketch
uses the trick in a di¤erent way and requires, in addition to our location and scale normalizations, knowledge
of the Jacobian determinant at one point. Completing the sketch would require showing that a particular
system of nonlinear simultaneous equations has a unique solution; this appears to require further conditions
on the density of unobservables. The formal results in Matzkin (2008) and Matzkin (2005) likewise rely on
conditions we do not require.

28

joint density f

1

;

1

(^
s; p^)

x1 ; : : : ;

1
J

(^
s; p^)

rescaled by the constant denominator

zJ

in (17). Since this density must integrate (over (x; z) 2 R2J ) to one, the constant is uniquely
determined and the value of

f

1

;

1

(^
s; p^)

1

x1 ; : : : ;

J

(^
s; p^)

zJ

is identi…ed for any (^
s; p^; x; z). Since
Z

f

x
~j xj ;~
x

F

1
j

1
j

j

tion

1
j

j

1

(^
s; p^)

x~1 ; : : : ;

1
J

(^
s; p^)

z~J d~
xd~
z=F

1
j

j

(^
s; p^)

xj

(18)

z
j ;~

the value of F
(16), F

1

;

1
j

j

(s0 ; s0 )

(st ; pt )

x

(^
s; p^)
x0j

xj is then known for any (^
s; p^; xj ).
= F j (0).

By the normalization

For any (st ; pt ) we can then …nd x such that

= F j (0), which reveals

1
j

(st ; pt ) = x .

(st ; pt ). With equation (11) this identi…es

jt

This identi…es the func-

for all t. Repeating for all j, all

jt

are identi…ed. Part (ii) then follows (see the proof of Theorem 1).
This provides a constructive proof of the identi…cation of demand. As with our analysis
using general IV conditions, we can extend the identi…cation of demand to obtain full identi…cation of the random utility model under the quasilinear speci…cation of preferences in
Assumption 1b. The proof follows that of Theorem 2 and is therefore omitted.
Theorem 5. Suppose Assumptions 1b, 2, 3, 6, and 8–13 hold. Then the joint distribution
of (vi1t ; : : : ; viJt ) conditional on any fxkt ; pkt ;

6.2

kt gk2J

2

is identi…ed.

Identi…cation of Marginal Costs

We obtained identi…cation of demand and of the full random utility model without a complete
speci…cation of the supply side. Without any additional assumption we can use the same
argument to show identi…cation of the cost shocks

jt .

If we are willing to assume a particular

model of oligopoly competition, we can also show identi…cation of marginal costs.

29

Theorem 6. Suppose that Assumptions 1a, 2, 3, and 8–13 hold. Then, for all j (i) each
jt

is identi…ed and (ii) if each

support of qjt ;

jt

j

is known, the function mcj (qjt ;

jt )

is identi…ed on the

.

Proof. Part (i) follows by observing that the argument used in the proof of Theorem 4 can
be repeated with trivial modi…cation to recover the inverse pricing relations
shocks

35
jt .

1
j

and the cost

Part (ii) then follows from the argument used to prove part (ii) of Theorem 3.

Combining this result with those in section 6.1, we have provided conditions for identi…cation of costs and demand. The overall argument is analogous to classical identi…cation
arguments for supply and demand models, which involve excluded demand shifters and cost
shifters with su¢ cient support to trace out the supply and demand functions.

7

Discriminating Between Oligopoly Models

A remaining question is whether the correct model of oligopoly competition can be distinguished from alternative models.

Bresnahan (1982) o¤ered an in‡uential insight for how

“rotations of demand” could be used to do this, citing formal results in Lau (1982) (see
also Bresnahan (1989)). While Lau (1982) considered homogeneous goods markets within
the context of deterministic conjectural variations models, Bresnahan’s original intuition
suggested much broader applicability. The following remark shows that a variation of this
insight can indeed be extended to our stochastic di¤erentiated products framework.
, with t0 6= t and/or j 0 6= j.

Remark 1. Suppose mcj ( ) = mcj 0 ( ) and qjt ;

jt

Under Assumption 8;

(st0 ; Dt0 (st0 ; pt0 ) ; pt0 ) :

j

(st ; Dt (st ; pt ) ; pt ) =

j0

= qj 0 t0 ;

j 0 t0

To see this, recall that under Assumption 8

mcj (qjt ;
35
1
j

jt )

=

j

(st ; Dt (st ; pt ) ; pt ) 8j; t:

Starting with equation (18), integrate instead over f~
x; z~ j ; z~j
s0 ; p0
zj0 = 0:

30

(19)

zj g and then use the normalization

The right-hand side of (19) cannot change unless the left-hand side does.
ample, qjt ;

jt

= qjt0 ;

jt0

implies

j

(st ; Dt (st ; pt ) ; pt ) =

j

(st0 ; Dt0 (st0 ; pt0 ) ; pt0 ). Like-

wise, if we assume that mcj 0 ( ) = mcj ( ) for some j 0 6= j, then
j0

(st ; Dt (st ; pt ) ; pt ) whenever qj 0 t ;

j0t

= qjt ;

jt

.

Thus, for ex-

j

(st ; Dt (st ; pt ) ; pt ) =

Thus, Remark 1 provides testable

restrictions that can be used to distinguish between alternative models of supply, as long
as the conditions for part (i) of Theorem 3 or part (i) of Theorem 6 hold for both models,
ensuring identi…cation of the cost shocks

jt

and

jt0 .

To illustrate, consider …rst the simple case of a market with one single-product …rm.
Consider the null hypothesis that the …rm prices at marginal cost and the alternative that
the …rm is a pro…t-maximizing monopolist. Figure 2 shows the market demand curve Dt .
Under the monopoly hypothesis the function
curve M Rt . We label this curve

1
jt ,

j

in Assumption 8 is the marginal revenue

indicating the alternative hypothesis: Under the null

of marginal cost pricing, however, it is the demand curve that is the function
this

0
jt .

j.

We label

The observed equilibrium outcome Et in market t maps to two possible values of

marginal cost at the quantity qt , depending on the model.
Now hold the cost shocks …xed— remember that these are identi…ed without knowledge
of the true model— and consider a change in market conditions that “rotates”the marginal
revenue curve
1
jt0 .

1
jt

around the point (qt ; mc1t ). This is illustrated in Figure 3 with the curve

Associated with this new marginal revenue curve is a market demand curve

Since the true model is monopoly, the new observed equilibrium outcome is Et0 .

0
jt0 .

Under

the alternative, the implied marginal cost at quantity qt is again mc1t , consistent with the
restriction in Remark 1. However, under the null, the implied marginal cost is mc0t0 , which
is di¤erent from mc0t . So the restriction is violated and the false null is ruled out.
This is a particularly simple example but describes a general “recipe”for ruling out false
models using Remark 1. Indeed, the heuristic illustration in Figure 3 applies to any null
and alternative oligopoly models.

Any false null can be ruled out as long as there exist

changes in the market environment that induce rotations of

j

for some product j under the

true model that are not also rotations under the false null. This is easy to see analytically

31

Figure 2: Market outcome Et maps to di¤erent marginal costs under the null and alternative.

Figure 3: A rotation of the true

32

j

rules out the false null.

as well.

Consider two markets t and t0 with

mcj qjt ;

jt

= mcj qjt0 ;

the null only if

j

jt0

jt

=

jt0

and qjt = qjt0 = q.

=

Since

= mcj (q; ), we can use (15) to rationalize qjt = qjt0 = q under

is the same in both markets under the null, as it is under the true model.

This observation falls directly out of our identi…cation analysis but is very closely related
to well known insights from an early literature on identi…cation of …rm “conduct”within the
class of conjectural variations models (e.g., Bresnahan (1982), Lau (1982)).36 Our graphical
illustration, in particular, is intentionally similar to that given by Bresnahan (1982),37 but
makes explicit the key role of the “residual marginal revenue” function,

j

( ). While we

generalize and reinterpret these earlier insights, the message is very similar: one can distinguish between competing models as long as there are changes in the market environment
that can shift equilibrium quantity and markup independently, at least for some product.
Conditions guaranteeing such variation will depend on the model.
in the environment that alter

j

However, the changes

form a larger set than the changes in aggregate demand

considered by Lau (1982) or the “rotations of demand”described by Bresnahan (1982, 1989).
For example, even if preferences are identical in markets t and t0 (i.e., there is no change in
demand),

jt

and

jt0

can di¤er due to variation in the number of competitors, the charac-

teristics of competitors’products (x
and/or

jt ).

(1)
jt

and/or

jt ),

or the costs of competing …rms (z
(2)

(2)

And although we have conditioned on xt , zt

(1)
jt

and Mt , variation in any of

these may also be exploited.

8

Conclusion

We have considered nonparametric identi…cation in a class of di¤erentiated products models
used in a growing body of empirical work in IO and other …elds of economics. We consid36

In these models products are homogeneous, so the demand side is equivalent to a binary choice model.
Our model can be adapted to a homogeneous goods environment by dropping the product (i.e., “j”) subscripts
on the demand side, interpreting j as a …rm subscript on the supply side, and applying the appropriate
convention for allocating total output among …rms.
37

Note that once the demand and cost shocks have been identi…ed and held …xed, we have a non-stochastic
environment, as in Breshnahan’s graphical illustration and the formal results of Lau (1982).

33

ered two types of arguments.

One links identi…cation of these models to the same kinds

of conditions used to show identi…cation of regression models, while the other has close
connections to classical identi…cation arguments for supply and demand models. We also
pointed to testable implications that can be used to discriminate between alternative models
of oligopoly competition.
Our hope is that our results will be useful to both producers and consumers of empirical
work on di¤erentiated products markets. The results should help practitioners focus on the
essential sources of variation needed to address a wide range of positive and normative questions. For identi…cation of demand or of marginal costs, the critical issue is the availability
of instruments. It should be no surprise that there is no getting around the need for instruments, and it should be comforting that this is essentially all that is needed.38 Likewise
our work should help policy makers, managers, and others who might rely on discrete choice
demand estimates for making decisions. Our results demonstrate that the nonparametric
foundation for empirical work based on these models is really no di¤erent from that for
simpler, more familiar models. We hope this will aid critical readers in focusing on the key
sources of variation in particular applications and ultimately lead to more informed decision
making.

38

An important caveat is that commonly used instruments— exogenous characteristics of competiting products (Berry, Levinsohn, and Pakes (1995)) may not be su¢ cient on their own without additional restrictions.
A point emphasized in Berry and Haile (2009b) is that with micro data, natural instruments will often
be more readily available. Combined with the stronger identi…cation results available in the micro data
environment, this provides a powerful motivation for researchers to seek individual-level data to replace or
complement market level data when possible.

34

Appendix A. Connected Substitutes
In this appendix we provide some key lemmas related to the connected substitutes assumption, including the proof of Lemma 1 stated in the text. Here we will repeatedly use the
condition “( ; p) 2

J

”as shorthand for “ xj ; pj ;

j j2J

2

J

with

j

xj +

j

8j:”

We begin by stating a useful elementary result in matrix theory (see, e.g., Horn and
Johnson (1990), section 6.2).
Lemma 3. Consider an n

n matrix A with elements aij . The following conditions are

equivalent:
(i) the directed graph of A is strongly connected;
(ii) for any strict subset K

f1; : : : ; ng, there exists k 2 K and ` 2
= K such that a`k 6= 0;

(iii) A is irreducible.39
The following corollary applies part (ii) of Lemma 3 to our model.
Corollary 1. Under Assumptions 1a, 2, and 3, for any ( ; p) 2
K

J , there exists k 2 K and ` 2
= K such that

`

J

and any strict subset

( ; p) is strictly decreasing in

k.

As discussed in the text, the following lemma provides the key implication of the connected substitutes assumption (Assumption 3) for our analysis.
, and 0 6= . Under Assumptions 1a, 2,
P
P
j : 0j > j is nonempty then j2I + j ( 0 ; p) > j2I + j ( ; p); (ii) if
P
P
is nonempty then j2I j ( 0 ; p) < j2I j ( ; p).

Lemma 4. Suppose ( ; p) 2
and 3, (i) if I +
I

j:

0
j

<

j

J

, ( 0 ; p) 2

J

Proof. Consider part (i) and note that because 0 2
= I + , I + is a strict subset of J . By
Corollary 1, for some k 2 I + and some ` 2
= I +,
one such pair (k; `), de…ne

`

( ; p) is strictly decreasing in

k.

Taking

by

k

=

0
k

j

=

j

39

j 6= k:

A matrix is reducible if and only if it can be placed into block upper triangular form by permutations of
rows and columns. A matrix that is not reducible is irreducible.

35

By monotonicity of vijt in

jt

for all j,

`2
= I+

X

j

( ; p)

( ; p) <

j

j 2I
= +

j

( ; p) for all j 2
= I + . Further, because

j

( ; p) :

X

j 2I
= +

Since market shares must sum to one, the result follows. Part (ii) follows from a symmetric
argument.
With these preliminary results, the invertibility of market shares follows easily:
Proof of Lemma 1.
0
j

all j. If
0

j

Arguing by contradiction, suppose
0
j

for all j 6= 0 then the set I = j :

0

<

6=

but

j

( 0 ; p) =

j

( ; p) for

must be nonempty to satisfy

j

6= . By Lemma 4 we would then have
X

j

( 0 ; p) <

j2I

contradicting the hypothesis that
I+
P

j:

j2I +

j

0
j

>

j

is nonempty.

X

j

( ; p)

j2I

( 0 ; p) =

( ; p) for all j. So it must be that the set
P
But then by Lemma 4 we must have j2I + j ( 0 ; p) >
j

j

( ; p), which again contradicts the hypothesis.

Finally, we state a related result that is used when considering relaxation of the linear
index assumption (see Appendix B).
Lemma 5. Suppose Assumptions 1a, 2, and 3 hold. For all j,

1
j

(s; p) is strictly increasing

in sj .
Proof. Arguing by contradiction, take j = 1 without loss and suppose
s01 > s1
s0j = sj

8j > 1

but
0
1

=

1
1

(s0 ; p)

1
1

36

(s; p) =

1:

Because probabilities sum to one, we must have
s00
If the set I +

j:

0
j

>

j

( 0 ; p) <

0

0

( ; p)

(20)

s0 :

is nonempty, by Lemma 4 we have
X

j

X

( 0 ; p) >

j2I +

j

( ; p) :

j2I +

Since 1 2
= I + and 0 2
= I + , this contradicts the hypothesis s0j = sj

8j > 1. Thus, I + must

be empty, i.e.,
0
j

But in that case monotonicity of vijt in

0

8j > 0:

j

j

for all j requires

( 0 ; p)

0

( ; p)

which contradicts (20).

Appendix B. Relaxing the Index Restriction
Here we show that, for our results based on nonparametric instrumental variables arguments,
the linear index restrictions can be relaxed if we are willing to strengthen the instrumental
variables conditions.
For this appendix, suppose
argument.

jt

=

(1)

j

xjt ;

jt

, with

j

strictly increasing in its second

This relaxes the linear separability assumed in the text, but retains the key

requirement of monotonicity in

jt .

(2)

As usual, we will condition on a value of xt , suppress
(1)

these arguments in the notation, and let xjt denote xjt .
Lemma 1 (whose proof did not require a linear index) now guarantees that for all j and

37

t
j

for some functions

1
j

xjt ;

jt

, j = 1; : : : ; J. With

jt

=

1

=

j

strictly increasing in

j

1

1

j

(st ; pt )

j

jt

we can then write

(st ; pt ) ; xjt

gj (st ; pt ; xjt )

for some function gj . Moreover, Lemma 5 (see Appendix A) implies that gj must be strictly
increasing in sjt . Thus,
sjt = gj 1

jt ; s jt ; pt ; xjt

hj s

where s

jt

(21)

jt ; pt ; xjt ; jt

denotes fskt gk6=j and hj is an unknown function that is strictly increasing in

Note that sjt and s

jt

jt .

are bounded by de…nition and that we may assume without loss that

pt has been transformed to be bounded as well.
Now consider the identi…cation of the functions hj in (21). Because xjt is exogenous, we
can condition on it and drop it from the notation, rewriting (21) as

sjt = hj s

We will assume for simplicity that
loss, we can normalize

jt

jt

(22)

jt ; pt ; jt

has an atomless marginal distribution. Then, without

to have a standard uniform marginal distribution. We will assume

that (st ; pt ) are continuously distributed conditional on z~t ; xt . We then let fjsp (s

zt ; xt )
jt ; pt j~

denote the conditional (marginal) density of s

denote the

jt ; pt ,

and let fjs (sjt js

~t ; xt )
jt ; pt ; z

conditional density of sjt .
Let

1

and

2

j (s jt ; pt )

be some small positive constants. Let

fs : fjs (sjs

~t ; xt )
jt ; pt ; z

1

38

8 (~
zt ; xt ) with fjsp (sjt ; pt j~
zt ; xt ) > 0g :

For each j and

2 (0; 1) de…ne Lj ( ) as the convex hull of functions mj ( ; ) that satisfy

(a) for all (~
zt ; xt ), Pr (sjt
mj (s

jt ; pt ; xjt ;

)2

mj (s

jt ; pt ;

) j~
zt ; xt ) 2 [

2;

+

and (b) for all (s

2 ];

jt ; pt ),

Consider the following instrumental variables conditions,

j (s jt ; pt ).

from Chernozhukov and Hansen (2005, Appendix C).
jt

(~
zt ; xt ) 8t:

j=

Assumption 14.

Assumption 15. For all j and

2 (0; 1),

(i) for any bounded function Bj (s
Lj ( ) and "jt
Bj (s

jt ; pt ;

sjt hj (s

) = 0 a.s. for

jt ; pt ;

(s

jt ; pt ;

) = mj (s

), E [B (s
~t ; xt ,
jt ; pt ; z

(ii) the conditional density f"j (ejs

jt ; pt ;

)=

)

R1
0

of

~t ; xt )
jt ; pt ; z

jt ; pt ;

(s

)

~t ; xt ,
jt ; pt ; z

f"j (bB (s
jt

hj (s

jt ; pt ;

jt ; pt ;

) with mj ( ; ) 2

) j~
zt ; xt ] = 0 a.s. only if
) js

~t ; xt )
jt ; pt ; z

db > 0.

is continuous and bounded in e over R

a.s.;
(iii) hj (s

jt ; pt ;

)2

j (s jt ; pt )

for all (s

jt ; pt ).

Assumption 14 strengthens the exclusion restriction of Assumption 4 to require full independence instead of mean independence.

Assumption 15 is a type of “bounded com-

pleteness” condition that replaces Assumption 5 in the text.

It was used previously by

Chernozhukov and Hansen (2005) to demonstrate nonparametric identi…cation of quantile
treatment e¤ects.
Theorem 7. Suppose Assumptions 1a, 2, 3, 14 and 15 hold.
identi…ed for all t, and (ii) the function sj (fxkt ; pkt ;
Proof. Identi…cation of hj ( ; ) for each

kt gk2J )

Then for all j, (i)

is identi…ed on

J

jt

is

.

2 (0; 1) follows from Theorem 4 of Chernozhukov

and Hansen (2005) after noting that for each value of

jt

2 (0; 1), the model (22) is equivalent

to the model they consider. Parts (i) and (ii) then follow immediately, as in the proof of
Theorem 1.
This shows that the analog of Theorem 1 (i.e., identi…cation of demand) can be obtained
with the relaxed index structure. Extension to full identi…cation of the random utility model
under the additional quasilinearity restriction follows exactly as in Theorem 2.
39

An analogous argument would apply to allow identi…cation of marginal costs under the
index structure
(2)
jt ; zjt

mcj qjt ;
with
jt

and

j

strictly monotone in

jt ,

=

(1)

j

zjt ;

jt

relaxing the linear structure

(1)

jt

= zjt +

jt

in the text.

Because the argument is parallel that for identi…cation of demand, we omit it.

Appendix C. Oligopoly First-Order Conditions
In the text we provided a high-level condition— part (iii) of Assumption 8— ensuring that
oligopoly …rst-order conditions can be inverted to solve for marginal cost, given the demand
system.

Here we show that, under assumptions already maintained in our analysis, this

high-level assumption is satis…ed in standard oligopoly models, including the multi-product
price- or quantity-setting models widely used in applications.

As emphasized in the text,

the strategy of solving …rst-order conditions for marginal costs has a long history in the IO
literature (e.g., Rosse (1970), Bresnahan (1981), Bresnahan (1987), and Berry, Levinsohn,
and Pakes (1995)).

The innovation in this appendix is the demonstration, under general

nonparametric conditions, of the invertibility of particular substitution matrices.

A key

condition used below is the same “connected substitutes”condition we relied on to show the
invertibility of the demand side.
We …rst discuss several standard models, noting the invertibility conditions that will
ensure a solution for marginal cost. We then show that the structure already assumed is suf…cient to ensure this invertibility in all the examples. Thus, for any of the models discussed
here, part (iii) of Assumption 8 could be viewed as a lemma (proved in this appendix) rather
than an assumption. Throughout this appendix will …x the market size Mt and suppress it.

40

Examples of First-Order Conditions
The simplest case is the perfectly competitive model, where …rms are symmetric and

j

(st ; Dt (st ; pt ) ; pt ) = pjt :

This provides a solution for marginal cost (marginal cost equals price) with no assumptions
on demand. Of course, perfect competition is seldom a natural assumption for di¤erentiated
products markets. We therefore turn to a set of standard oligopoly models. We consider
both the case of single-product …rms and the more general case of multi-product …rms, which
also nests the case of monopoly (perfect collusion).
The most common assumption for empirical work on di¤erentiated products markets is
Nash equilibrium in a complete information simultaneous price-setting game. For singleproduct …rms, the …rst-order condition is (letting

jt

+ (pjt

mcjt )

jt

=

j

(st ; pt ) as shorthand)

@ jt
=0
@pjt

which is easily solved for marginal cost:
jt

mcjt = pjt +

As long as the demand derivative @
required function

j

jt =@pjt

@

jt =@pjt

:

is non-zero, the right-hand side provides the

(st ; Dt (st ; pt ) ; pt ).

The condition needed for the multi-product price-setting case is slightly more complicated. The …rst-order condition for the price of good j, produced by …rm f , is

jt

+

X

(pkt

mckt )

k2Jf

@ kt
=0
@pjt

where Jf is the subset of products in J produced by f . As in the empirical work of Bresnahan

41

(1981) and Bresnahan (1987), the vector of …rst-order conditions can then be written as

t

+

t

(pt

(23)

mct ) = 0

where the (k; j) element of the square matrix

t

is equal to @

kt =@pjt

if products k and j

are produced by the same …rm and equal to zero otherwise. Following BLP, the supply-side
“inversion”for marginal cost is then
1

mct = pt +

t

st :

In this multi-product price-setting case, to satisfy part (iii) of Assumption 8 the matrix

t

must be invertible.
Turning to quantity-setting models, we …rst require existence of an inverse demand function
pt = (st ; t ):
Consider …rst the case of single-product …rms. Given inverse demand, the …rst-order condition for the simultaneous quantity setting game equates marginal cost and marginal revenue:

mcjt = pjt +

Thus we require that the derivative

@ j
@sjt

@ j
sjt :
@sjt

exist. With multi-product …rms (which nests multi-

product monopoly/perfect collusion), a change in the quantity of product j can change the
market-clearing price for the …rm’s other products as well.

Thus, rearranging the multi-

product …rm’s …rst-order conditions gives

mcjt = pjt +

X @
k
skt :
@sjt
k2J
f

This solution requires existence of the derivatives of the inverse demand function.

42

Solutions for Marginal Costs
Price-Setting
For the price-setting models, we need invertibility of the within-…rm substitution matrix

t,

which is a diagonal matrix in the case of single-product …rms. We will show that invertibility
is guaranteed by conditions already assumed in the text.
In the single-product price-setting case, we need existence of a nonzero derivative @

jt =@pjt

for all j. This is guaranteed by Assumption 7 and part (ii) of Assumption 8.
To show invertibility of the matrix

t

for the multi-product case, we rely on “Taussky’s

theorem” which shows that an irreducibly diagonally dominant matrix is invertible.40 A
matrix A is diagonally dominant if for all i

jaii j

X
j6=i

jaij j:

An irreducibly diagonally dominant matrix is a square matrix that is irreducible (see footnote
39) and diagonally dominant, with at least one of the diagonals being strictly dominant, i.e.,
with at least one row such that
jaii j >

X
j6=i

jaij j:

Proposition 1. For any strict subset of products K

(24)
J , re-index the products in K from 1 to

jKj and let D(K) be the jKj by jKj matrix with (k; j) element @

kt =@pjt .

Given Assumptions

1a, 2, 3, 7 and parts (i) and (ii) of Assumption 8, D(K) is invertible.
To show this, we begin with the following lemma:
Lemma 6. Given Assumptions 1a, 2, 3, 7 and parts (i) and (ii) of Assumption 8, for
any strict subset K

J , D(K) is a diagonally dominant matrix, with at least one strictly

dominant diagonal.
40

See Horn and Johnson (1990), p. 363. For further background on irreducibility and dominant diagonal
conditions, see chapter 6 in that text.

43

Proof. Recall that because

P

k2J

kt

= 1,

P

@ kt
k2J @pjt

= 0. For any product j 2 K, this

implies that the associated diagonal element of D(K) satis…es
@ jt
=
@pjt

X

k2K fjg

@ kt X @ `t
+
:
@pjt
@pjt

(25)

X

(26)

`2K
=

By part (ii) of Assumption 8, this implies
@ jt
@pjt

k2K fjg

@ kt
:
@pjt

Furthermore, by the connected substitutes assumption, Lemma 3 (see Appendix A), and the
strict monotonicity of vijt in pjt , the second sum in (25) is strictly positive for at least one
product j 2 K. For that j the inequality in (26) is strict.
Proof of Proposition 1.

We argue that D(K) must be either (i) an irreducibly diagonally

dominant matrix, or (ii) block-diagonal with each block being an irreducibly diagonally
dominant matrix; then, by Taussky’s theorem, D(K) must be invertible. By Lemma 3 (see
Appendix A) D(K) is irreducible if and only if the directed graph of D (K) is strongly
connected. If the directed graph of D (K) is strongly connected then, by Lemma 6, D(K) is
an irreducibly diagonally dominant matrix and is therefore invertible. So now consider the
case in which the directed graph of D (K) is not strongly connected. By Corollary 2 and
Lemma 8 (both in Appendix D) the directed graph of D (K) can be partitioned into isolated
strongly connected subgraphs. The nodes in each isolated subgraph correspond to a subset
of products that do not substitute outside of the subset. We can therefore rearrange the
order of products, with the products in the …rst strongly connected subset coming …rst, the
next subset following and so on. The resulting permutation of D(K) is block diagonal, with
each block being irreducible by Lemma 3. Further, by Lemma 6, each block is diagonally
dominant with at least one strictly dominant diagonal. Therefore, by Taussky’s theorem,
each block is invertible. This implies that the entire D(K) matrix is invertible.
We can now use Proposition 1 to prove that the matrix of within-…rm derivatives,
44

t,

is invertible. First note that
@

kt =@pjt

t

is itself block diagonal with each block consisting of the

terms for the product j and k produced by a given …rm.

Due to the outside

good, even in the case of monopoly, the set of products produced by one …rm will be a strict
subset of J . Thus, by Proposition 1, each of these blocks is invertible and so the matrix

t

is invertible.
Quantity Setting.
In the quantity setting example, the key condition is the existence of the inverse demand
function and its derivatives. We have assumed (part (ii) of Assumption 8) that vijt is strictly
decreasing in pjt . Thus, the same argument used to prove Lemma 1 (swapping the roles of
pt and

t)

implies that, due to the connected substitutes property, for every (st ; t ), there

is a unique price vector pt that solves st =

(pt ; t ). This implies existence of an inverse

demand function, which we write in vector form as pt = (st ; t ).
Proposition 1 guarantees the invertibility of the matrix of own- and cross-price derivatives
of market shares.

So by the inverse function theorem, derivatives of the inverse demand

function exist and are (as usual) equal to the elements of the inverse D(K) matrix, i.e.,
@ k
= D(K)
@sjt

1
kj

:

Appendix D
Here we present two results referenced in Appendix C. The …rst provides su¢ cient conditions
for the substitution incidence matrix
graph are bidirectional.

(Jt ) to be symmetric, so that all edges of its directed

The second concerns a simple property of a strongly connected

graph with bidirectional edges.
Lemma 7. Suppose Assumptions 1a and 2 hold and that for all j 2 J , Pr vijt

45

vjxjt ; pjt ;

jt

is strictly decreasing and continuous in wjt .41 Then good k substitutes to good ` at
if and only if good ` substitutes to good k at

xjt ; pjt ;

jt

j2Jt

xjt ; pjt ;

jt

.

Proof. For good k to substitute to good `, it must be the case that

Pr (vikt

i.e., letting di`kt = vi`t

< vi`t < vikt ) > 0 8 > 0

vikt ,

Pr fdi`kt 2 (

; 0)g > 0 8 > 0:

Thus, arguing by contradiction, suppose that for some
Pr (di`kt 2 (

> 0 and some

> 0, we have

; 0)) > 0 but Pr (di`kt 2 (0; )) = 0. For this to hold we must have either (a)

Pr (di`kt > 0) = 0, violating Assumption 2 , or (b) P r (di`kt > 0) > 0 when supp di`kt excludes
(0; ), violating the maintained assumption that the utility di¤erences (vilt

vikt ) have con-

vex support.
This symmetry of

(Jt ) was not required by our results. However, Lemma 7 demon-

strates why in standard models (where vijt is everywhere continuous in wjt ) the directed
graph of

(Jt ) is bidirectional (recall Figure 1). Further, the following Corollary is utilized

in Appendix C.
Corollary 2. Consider any K

J , re-index the goods in K from 1 to jKj ; and let D(K) be

the jKj by jKj matrix with (k; j) element @

kt =@pjt .

Under Assumptions 1a, 2, and 8 part

(ii), the directed graph of D(K) is bidirectional.
Finally, we provide the following result, referenced in Appendix C.
Lemma 8. Let G be a strongly connected directed graph, and let N be a subgraph of G with
at least one vertex.

If all edges of G are bidirectional, N can be partitioned into isolated

strongly connected subgraphs.
41

As in De…nition 1, wjt may be an element of xjt ; pjt ;
relevant cases in the text are wjt = jt and wjt = pjt .

46

jt

or an index derived from xjt ; pjt ;

jt

. The

j2J

Proof. Let N0 = N , and de…ne C (n0 ) to be the null graph (no nodes). Consider an iterative
argument, beginning with iteration t = 1: Let Nt be the subgraph of Nt

1

obtained by

excluding the nodes of C (nt 1 ). Let nt be any node of Nt and let C (nt ) be the subgraph
of Nt whose nodes are nt and all nodes from which there is a path in Nt to nt .

By

bidirectionality, C (nt ) is strongly connected. If C (nt ) = Nt , the argument is complete.
Otherwise, add 1 to t and iterate. The argument will be complete in at most jN j iterations.

References
Allenby, G. M., and P. E. Rossi (1999): “Marketing Models of Consumer Heterogeneity,”Journal of Econometrics, 89, 57–78.
Altonji, J., and R. L. Matzkin (2005): “Cross-Section and Panel Data Estimators for
Nonseparable Models with Endogenous Regressors,”Econometrica, 73, 1053–1102.
Athey, S., and G. W. Imbens (2007): “Discrete Choice Models with Multiple Unobserved
Choice Characteristics,”International Economic Review, 48, 1159–1192.
Bajari, P., J. Fox, K. i. Kim, and S. Ryan (2009): “The Random Coe¢ cients Logit
Model is Identi…ed,”Discussion paper, University of Minnesota.
Bayer, P., F. Ferreira, and R. McMillan (2007): “A Uni…ed Framework for Measuring
Preferences for Schools and Neighborhoods,” Journal of Political Economy, 115(5), 588–
638.
Benkard, L., and S. T. Berry (2006): “On the Nonparametric Identi…cation of Nonlinear Simultaneous Equations Models: Comment on Brown (1983) and Roehrig (1988),”
Econometrica, 74, 1429–1440.
Berry, S. (1994): “Estimating Discrete Choice Models of Product Di¤erentiation,”RAND
Journal of Economics, 23(2), 242–262.
47

Berry, S., J. Levinsohn, and A. Pakes (1995): “Automobile Prices in Market Equilibrium,”Econometrica, 60(4), 889–917.
(1999): “Voluntary Export Restraints on Automobiles: Evaluating a Strategic
Trade Policy,”American Economic Review, 89(3), 189–211.
(2004): “Di¤erentiated Products Demand Systems from a Combination of Micro
and Macro Data: The New Vehicle Market,”Journal of Political Economy, 112(1), 68–105.
Berry, S. T., and P. A. Haile (2009a): “Identi…cation of a Nonparametrc Generalized
Regression Model with Group E¤ects,”Discussion paper, Yale University.
(2009b): “Nonparametric Identi…cation of Multinomial Choice Demand Models
with Heterogeneous Consumers,”Discussion paper, Yale University.
Berry, S. T., and A. Pakes (2007): “The Pure Characteristics Demand Model,”Discussion paper, Yale University.
Blundell, R. W., and J. L. Powell (2004): “Endogeneity in Semiparametric Binary
Response Models,”Review of Economic Studies, 71, 655–679.
Bresnahan, T. (1981): “Departures from Marginal Cost Pricing in the Auomobile Industry,”Journal of Econometrics, 17, 457–482.
(1982): “The Oligopoly Solution Concept is Identi…ed,” Economics Letters, 10,
82–97.
(1987): “Competition and Collusion in the American Automobile Oligopoly: The
1955 Price War,”Journal of Industrial Economics, 35, 457–482.
(1989): “Empirical Studies of Industries with Market Power,” in The Handbook of
Industrial Organization, ed. by R. Schamlensee, and R. Willig, no. 10 in Handbooks in
Economics. North-Holland.

48

Briesch, R. A., P. K. Chintagunta, and R. L. Matzkin (2005): “Nonparametric
Discrete Choice Models with Unobserved Heterogeneity,”Discussion paper, Northwestern
University.
Brown, B. (1983): “The Identi…cation Problem in Systems Nonlinear in the Variables,”
Econometrica, 51(1), 175–96.
Bundorf, K., J. Levin, and N. Mahoney (2008): “Pricing and Welfare in Health Plan
Choice,”Discussion paper, Stanford University.
Caplin, A., and B. Nalebuff (1991): “Aggregation and Imperfect Competition: On the
Existence of Equilibrium,”Econometrica, 59(1), 1–23.
Capps, C., D. Dranove, and M. Satterthwaite (2003): “Competition and Market
Power in Option Demand Markets,”RAND Journal of Economics, 34(5), 737–763.
Cardon, J., and I. Hendel (2001): “Asymmetric Information in Health Care and Health
Insurance Markets" Evidence from the National Medical Expenditure Survery,” RAND
Journal of Economics, 32, 408–427.
Chernozhukov, V., and C. Hansen (2005): “An IV Model of Quantile Treatment Effects,”Econometrica, 73(1), 245–261.
Chiappori, P.-A., and I. Komunjer (2009): “On the Nonparametric Identi…cation of
Multiple Choice Models,”Discussion paper, University of California San Diego.
Chintagunta, P. K., and B. E. Honoré (1996): “Investigating the E¤ects of Marketing
Variables and Unobserved Heterogeneity in a Multinomial Probit Model,” International
Journal of Marketing Research, 13, 1–15.
Domencich, T., and D. McFadden (1975): Urban Travel Demand: A Behavioral Analysis. North Holland, Amsterdam.

49

Eizenberg, A. (2008): “Upstream Innovation and Product Variety in the United States
Home PC Market,”Discussion paper, Yale University.
Fan, Y. (2008): “Market Structure and Product Quality in the U.S. Daily Newspaper
Market,”Discussion paper, Yale University.
Fox, J., and A. Gandhi (2009): “Identifying Heterogeneity in Economic Choice Models,”
Discussion paper, University of Chicago.
Gandhi, A. (2008): “On the Nonparametric Foundations of Discrete Choice Demand Estimation,”Discussion paper, University of Wisconsin-Madison.
Gautier, E., and Y. Kitamura (2007): “Nonparametric Estimation in Random Coe¢ cients Binary Choice Models,”Discussion paper, Yale.
Gentzkow, M., and J. Shapiro (2009): “What Drives Media Slant? Evidence from U.S.
Newspapers,”Econometrica.
Gikhman, I. I., and A. V. Skorokhod (1980): The Theory of Stochastic Processes.
Springer-Verlag, Berlin.
Goldberg, P. (1998): “The E¤ects of the Corporate Average Fuel Economy Standards in
the Automobile Industry,”Journal of Industrial Economics, pp. 1–33.
Goldberg, P., and F. Verboven (2001): “The Evolution of Price Dispersion in the
European Car Market,”The Review of Economics Studies, 68(4), 811–848.
Goldberg, P. K. (1995): “Product Di¤erentiation and Oligopoly in International Markets:
The Case of the U.S. Automobile Industry,”Econometrica, 63(4), 891–951.
Han, A. K. (1987): “Nonparametric Analysis of a Generalized Regression Model,”Journal
of Econometrics, 35, 303–316.
Hastings, J., D. Staiger, and T. Kane (2007): “Preferences and Heterogeneous Treatment E¤ects in a Public School Choice Lottery,”Discussion paper, Yale University.
50

Hausman, J., and D. Wise (1978): “A Conditional Probit Model for Qualitative Choice:
Discrete Decisions Recognizing Interdependence and Heterogeneous Preferences,”Econometrica, 46, 403–426.
Hausman, J. A. (1996): “Valuation of New Goods under Perfect and Imperfect Competitioin,” in The Economics of New Goods, ed. by T. F. Bresnahan, and R. J. Gordon,
chap. 5, pp. 209–248. University of Chicago Press, Chicago.
Ho, K. (2007): “Insurer-Provider Networks in the Medical Care Market,”Discussion paper,
Columbia University.
Hoderlein, S. (2008): “Endogeneity in Semiparametric Binary Random Coe¢ cient Models,”Discussion paper, Brown University.
Hong, H., and E. Tamer (2004): “Endogenous Binary Choice Mode with Median Restrictions,”Economics Letters, pp. 219–224.
Honoré, B. E., and A. Lewbel (2002): “Semiparametric Binary Choice Panel Data
Models Without Strictly Exogenous Regressors,”emet, 70(5), 2053–2063.
Horn, R. A., and C. R. Johnson (1990): Matrix Analysis. Cambrige University Press.
Hotelling, H. (1929): “Stability in Competition,”Economic Journal, 39, 41–57.
Hotz, J., and R. A. Miller (1993): “Conditional Choice Probabilites and the Estimation
of Dynamic Models,”Review of Economic Studies, 60, 497–529.
Ichimura, H., and T. S. Thompson (1998): “Maximum Likelihood Estimation of a
Binary Choice Model with Random Coe¢ cients of Unknown Distribution,” Journal of
Econometrics, 86(2), 269–95.
Lau, L. (1982): “On Identifying the Degree of Competitiveness from Industry Price and
Output Data,”Economics Letters, 10, 93–99.

51

Lewbel, A. (2000): “Semiparametric Qualitative Response Model Estimation with Unknown Heteroscedasticity or Instrumental Variables,” Journal of Econometrics, 97, 145–
177.
(2005): “Simple Endogenous Binary Choice and Selection Panel Model Estimators,”
Discussion paper, Boston College.
Lustig, J. (2008): “The Welfare E¤ects of Adverse Selection in Privatized Medicare,”
Discussion paper, Boston University.
Magnac, T., and E. Maurin (2007): “Identi…cation and Information in Monotone Binary
Models,”Journal of Econometrics, 139, 76–104.
Manski, C. F. (1985): “Semiparametric Analysis of Discrete Response: Asymptotic Properties of the Maximum Score Estimator,”Journal of Econometrics, 27, 313–333.
(1988): “Identi…cation of Binary Response Models,”Journal of the American Statitical Association, 83(403), 729–738.
Matzkin, R. L. (1992): “Nonparametric and Distribution-Free Estimation of the Binary
Choice and Threshold Crossing Models,”Econometrica, 60(2).
(1993): “Nonparametric Identi…cation and Estimation of Polychotomous Choice
Models,”Journal of Econometrics, 58.
(2004): “Unobservable Instruments,”Discussion paper, Northwestern University.
(2005): “Identi…cation in Nonparametric Simultaneous Equations,”Discussion paper, Northwestern University.
(2007a): “Heterogeneous Choice,” in Advances in Economics and Econometrics, Theory and Applications, Ninth World Congress of the Econometric Society, ed.
by R. Blundell, W. Newey, and T. Persson. Cambridge University Press.

52

(2007b): “Nonparametric Identi…cation,”in Handbook of Econometrics, ed. by J. J.
Heckman, and E. Leamer, vol. 6B. Elsevier.
(2008): “Identi…cation in Nonparametric Simultaneous Equations,”Econometrica,
76, 945–978.
McFadden, D. (1974): “Conditional Logit Analysis of Qualitative Choice Behavior,” in
Frontiers of Econometrics, ed. by P. Zarembka. Academic Press, New York.
Mussa, M., and S. Rosen (1978): “Monopoly and Product Quality,”Journal of Economics
Theory, 18, 301–307.
Nair, H., P. Chintagunta, and J.-P. Dube (2004): “Empirical Analysis of Indirect
Network E¤ects in the Market for Personal Digital Assistants,” Quantitative Marketing
and Economics, 2, 23–58.
Nevo, A. (2000): “Mergers with Di¤erentiated Products: The Case of the Ready-to-Eat
Cereal Industry,”RAND Journal ofEconomics, 31(3), 395–421.
(2001): “Measuring Market Power in the Ready-to-Eat Cereal Industry,” Econometrica, 69(2), 307–42.
Newey, W. K., and J. L. Powell (2003): “Instrumental Variable Estimation in Nonparametric Models,”Econometrica, 71(5), 1565–1578.
Petrin, A. (2002): “Quantifying the Bene…ts of New Products: The Case of the Minivan,”
JPE, 110(4), 705–729.
Petrin, A., and K. Train (2009): “A Control Function Approach to Endogeneity in
Consumer Choice Models,”Journal of Marketing Research, forthcoming.
Quandt, R. E. (1966): “A Probabalistic Abstract Mode Model,” in Studies in Travel
Demand, Volume II, pp. 90–113. Mathematica, Princeton, N.J.
(1968): “Estimation of Modal Splits,”Transportation Research, 2, 41–50.
53

Rochet, J.-C., and L. A. Stole (2002): “Nonlinear Pricing with Random Participation,”
The Review of Economic Studies, 69(1), 277–311.
Roehrig, C. S. (1988): “Conditions for Identi…cation in Nonparametric and Parametic
Models,”Econometrica, 56(2), 433–47.
Rosse, J. N. (1970): “Estimating Cost Function Parameters without using Cost Function
Data: An Illustrated Methodology,”Econometrica, 38(2), 256–275.
Rysman, M. (2004): “Competition Between Networks: A Study of the Market for Yellow
Pages,”Review of Economic Studies, 71.
Salop, S. (1979): “Monopolistic Competition with Outside Goods,” RAND Journal of
Economics, 10, 141–156.
Severini, T. A., and G. Tripathi (2006): “Some Identi…cation Issues in Nonparametric
Models with Endogenous Regressors,”Econometric Theory.
Villas-Boas, S. B. (2007): “Vertical Relationships Between Manufacturers and Retailers:
Inference With Limited Data,”Review of Economic Studies, 74, 625–652.

54

