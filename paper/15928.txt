NBER WORKING PAPER SERIES

FORTUNE OR VIRTUE:
TIME-VARIANT VOLATILITIES VERSUS PARAMETER DRIFTING IN U.S. DATA
Jesús Fernández-Villaverde
Pablo Guerrón-Quintana
Juan F. Rubio-Ramírez
Working Paper 15928
http://www.nber.org/papers/w15928

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2010

We thank André Kurmann, Jim Nason, Serena Ng, Ricardo Reis, Frank Schorfheide, Tao Zha, and
participants at several seminars for useful comments, and Béla Személy for invaluable research assistance.
Beyond the usual disclaimer, we must note that any views expressed herein are those of the authors
and not necessarily those of the Federal Reserve Bank of Atlanta, the Federal Reserve Bank of Philadelphia,
or the Federal Reserve System. Finally, we also thank the NSF for financial support. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Jesús Fernández-Villaverde, Pablo Guerrón-Quintana, and Juan F. Rubio-Ramírez. All
rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted without explicit
permission provided that full credit, including © notice, is given to the source.

Fortune or Virtue: Time-Variant Volatilities Versus Parameter Drifting in U.S. Data
Jesús Fernández-Villaverde, Pablo Guerrón-Quintana, and Juan F. Rubio-Ramírez
NBER Working Paper No. 15928
April 2010
JEL No. C11,E10,E30
ABSTRACT
This paper compares the role of stochastic volatility versus changes in monetary policy rules in accounting
for the time-varying volatility of U.S. aggregate data. Of special interest to us is understanding the
sources of the great moderation of business cycle fluctuations that the U.S. economy experienced between
1984 and 2007. To explore this issue, we build a medium-scale dynamic stochastic general equilibrium
(DSGE) model with both stochastic volatility and parameter drifting in the Taylor rule and we estimate
it non-linearly using U.S. data and Bayesian methods. Methodologically, we show how to confront
such a rich model with the data by exploiting the structure of the high-order approximation to the decision
rules that characterize the equilibrium of the economy. Our main empirical findings are: 1) even after
controlling for stochastic volatility (and there is a fair amount of it), there is overwhelming evidence
of changes in monetary policy during the analyzed period; 2) however, these changes in monetary
policy mattered little for the great moderation; 3) most of the great performance of the U.S. economy
during the 1990s was a result of good shocks; and 4) the response of monetary policy to inflation under
Burns, Miller, and Greenspan was similar, while it was much higher under Volcker.

Jesús Fernández-Villaverde
University of Pennsylvania
160 McNeil Building
3718 Locust Walk
Philadelphia, PA 19104
and NBER
jesusfv@econ.upenn.edu
Pablo Guerrón-Quintana
Federal Reserve Bank of Philadelphia
pablo.guerron@phil.frb.org

Juan F. Rubio-Ramírez
Duke University
P.O. Box 90097
Durham, NC 27708
juan.rubio-ramirez@duke.edu

1. Introduction
This paper addresses one of the main open questions in empirical macroeconomics: what
is the role of time-varying variances versus changes in monetary policy rules in accounting
for the evolving volatility of U.S. aggregate data? This discussion is particularly relevant
for understanding the sources of the great moderation of business cycle ‡uctuations that the
U.S. economy experienced between 1984 and 2007 and to forecast whether low volatility will
return after the turbulence of 2008-2009.1 To answer this question, we build a medium-scale
dynamic stochastic general equilibrium (DSGE) model with both stochastic volatility in the
structural shocks that drive the economy, parameter drifting in the Taylor rule followed by
the monetary authority, and rational expectations of agents regarding these changes. Then,
we estimate the model non-linearly using U.S. data and Bayesian methods, assess its …t,
and compute its impulse response functions (IRFs). We use our results to run a battery
of counterfactual exercises in which we build arti…cial histories of economies in which some
source of variation has been eliminated or modi…ed in an illustrative manner.
The motivation for this investigation is transparent. Time-varying volatility tells a history
built around the changing size of the variance of structural shocks that hit the economy. The
great moderation is, then, a tale of fortune: for two and a half decades we were favored by
fate in the form of small variance of shocks. It is also a pessimistic perspective: we dwell
in joy during periods of low volatility and we struggle through times of high volatility, but
there is disappointingly little scope for the policy maker to battle the elements. Therefore,
our current turbulence may be the opening stages of an era of large business cycle swings.
Parameter drifting constructs a radically divergent account of the cause of higher stability.
It argues that some other changes in the economy, besides heteroscedastic disturbances,
explain the evolution of aggregate volatility. Some versions of the parameter drifting narrative
emphasize technological change. Two commonly cited factors are better inventory control
(McConnell and Pérez-Quirós, 2000, Ramey and Vine, 2006) or …nancial innovation (Dynan,
Elmendorf, and Sichel, 2006, or Guerrón-Quintana, 2009a). Other versions of the parameter
drift history, the most prominent of which is Clarida, Galí, and Gertler (2000), single out
monetary policy as the key to the reduced size of business cycle ‡uctuations. Thus, parameter
drifting is a tale of virtue: thanks to either better technologies or changed policies, the
1

Kim and Nelson (1998), McConnell and Pérez-Quirós (2000), and Blanchard and Simon (2001) were
the …rst papers to point out that time-varying volatility was an important component of U.S. aggregate
‡uctuations. While Kim and Nelson and McConnell and Pérez-Quirós emphasized a big change in volatility
around 1984, Blanchard and Simon saw the great moderation as part of a long-run trend toward lower
volatility only momentarily interrupted during the 1970s. Stock and Watson (2002) undertake a thorough
review of the evidence.

3

economy is more stable than before. It is also an optimistic view. As long as we do not
abandon new technologies or unlearn the lessons of monetary economics, we should expect
the great moderation to continue, current maladies notwithstanding.
There is evidence in favor of parameter drifting, particularly in monetary policy. Besides
the classic work by Clarida, Galí, and Gertler (2000), basic references include Cogley and Sargent (2002), Lubick and Schorfheide (2004), Boivin and Giannoni (2006), and Canova (2009),
among others. More recently, and most directly related to our investigation, FernándezVillaverde and Rubio-Ramírez (2008) report compelling evidence of parameter drifting in the
parameters that control the Taylor rule and in the degree of nominal rigidities in a standard
DSGE model.
Another branch of the literature, which appeared largely as a response to Clarida, Galí,
and Gertler (2000) and the other follow-up papers, has presented a strong case in favor of
heteroscedastic structural shocks. Perhaps the most in‡uential work in this tradition is Sims
and Zha (2006). Relying on a structural vector autoregression (SVAR) with regime switching,
Sims and Zha …nd that the model that best …ts the data only has changes over time in the
variances of structural disturbances and no variation in the monetary rule or in the private
sector of the model. But even when they allow for policy regime changes, Sims and Zha …nd
that the estimated changes cannot account for the evolution of observed volatility.2 Using
similar approaches, other papers corroborate this view. Among others, we can cite Cogley
and Sargent (2005), Primiceri (2005), and Canova and Gambetti (2009). In general, once
time-varying volatility is allowed, SVARs …nd little support for the tale of virtue; fortune
seems to be the preferred option.
But using an SVAR approach presents challenges of its own. Benati and Surico (2009)
use data generated from a simple New Keynesian DSGE model to show how regime-switching
SVARs may misinterpret changes in policy as changes in variances because changes in policy
also have implications for the volatility of endogenous variables (we can think about this
argument as one instance of the Lucas critique). They read their results as suggesting that
existing SVAR evidence may be uninformative for the question at hand.
To avoid these problems we follow a perspective more …rmly grounded in explicit equilibrium models. First attempts along this direction are Fernández-Villaverde and Rubio-Ramírez
(2007) and, in an important contribution, Justiniano and Primiceri (2008). These papers estimate DSGE economies that incorporate stochastic volatility on the structural shocks and
show that such models …t the data considerably better than economies with homoscedastic
structural shocks. However, neither of them allows for policy changes.
2

Furthermore, Sims and Zha (2006) reject single-equation approaches because they require the use of
instruments, which the authors argue rely on implausible restriction assumptions and fragile identi…cation.

4

The natural next step is, thus, to estimate a DSGE model that can measure how much of
the volatility change observed in the U.S. aggregate data can be attributed to either fortune,
through heteroscedastic shocks, or virtue, in our case through changes in monetary policy.
The project is challenging because, to get an econometrically satisfying answer, we need
to simultaneously allow for both stochastic volatility and parameter drifting. A “one-at-atime” approach is fraught with peril. If we only allow one source of variation in the model,
the likelihood may want to take advantage of this extra degree of ‡exibility to …t the data
better. For example, if the “true”model is one with parameter drifting in nominal rigidities,
an estimated DSGE model with stochastic volatility may interpret this drift as time-varying
volatility in mark-up shocks. If, instead, we had time-varying volatility in technological shocks
in the data, an estimated model with only parameter drifting may conclude, erroneously,
that the parameters of the Taylor rule are changing. Finally, it is important to have a model
where agents have rational expectations over changes in monetary policy and incorporate
the distributions over these changes into their decision rules (although, at a …rst pass and
because of computational constraints, we will assume that the agents recognize right away
when these changes occur, a restrictive hypothesis, since changes in policy are often di¢ cult
to detect even with hindsight).
Our contributions are both methodological and substantive. Methodologically, we show
how to confront a rich non-linear DSGE model with stochastic volatility with the data by
exploiting the structure of the second-order approximation to the decision rules that characterize the equilibrium of the economy. We prove a theorem, for a general class of DSGE
models, that characterizes the structure of these decision rules. This theorem allows us to
handily evaluate the likelihood function of the model. As an added bonus, this approach
allows us to estimate the model without measurement errors in observables. One of the advantages of having stochastic volatility is that we multiply the number of random shocks in
the model by two: for each exogenous stochastic process, we have a shock to level and a shock
to volatility.
Our substantive …ndings are as follows. First, and challenging the SVAR evidence, we
show that there is overwhelming evidence of changes in monetary policy during the analyzed
period even after controlling for the fair amount of stochastic volatility present in the data.
Second, we estimate that most of the reduction in aggregate volatility was caused by a
reduction in the volatility of the innovation to the structural shocks in the economy, whereas
the changes in monetary policy mattered less for the great moderation. Structural shocks
were large and volatility under Burns, Miller, and Volcker and smaller and favorable under
Greenspan. Third, our model suggests that the response of monetary policy to in‡ation
during Volcker’s tenure was stronger than under Burns, Miller, or Greenspan. According to
5

our econometric estimates, had monetary policy been conducted during the 1970s as it was
during the Volcker years, in‡ation would have been lower, in particular during the second oil
shock. Interestingly, the clear change in monetary policy during Volcker’s tenure is consistent
with one of the policy regimes identi…ed in Sims and Zha (2006). Fourth, in comparison, our
estimated model indicates that Greenspan’s response to in‡ation was mild (indeed, it was
slightly lower than under Burns and Miller), but that he ruled over a period of extraordinarily
positive shocks.
We establish these facts with a number of exercises. First, we compare the …t of di¤erent
versions of the model with and without parameter drifting. Second, we inspect the smoothed
series of the estimated parameter that controls the response of the monetary policy rule
to in‡ation. The series shows a steep increase at the arrival of Volcker and a fast drop
after the coming of Greenspan. In fact, the response of monetary policy to in‡ation is back
to the levels of Burns-Miller times by the early 1990s. Third, we construct two sets of
counterfactual histories. In the …rst set, we eliminate stochastic volatility by …xing variances
at their historical means. In the second set, we feed alternative policy rules to di¤erent
periods of time. In particular, we compute how the economy would have behaved during the
tenure of one chairman if the monetary authority had followed the policy rule dictated by
the average estimated response to in‡ation of some other chairman. In other words, we use
our model to evaluate how the “average”monetary policy rule under Greenspan would have
done during Volcker’s times.
An alternative to our stochastic volatility framework would be to work with Markov
regime-switching models (either in policy rules or in variances of shocks) with discrete jumps
such as those of Bianchi (2009) or Farmer, Waggoner, and Zha (2009). This class of models
provides an extra degree of ‡exibility in modelling aggregate dynamics that is highly promising. In fact, some of the fast changes in policy parameters that we document suggest that
discrete jumps may be a good representation of the data. However, current technical limitations regarding the computation of the equilibria induced by regime switches force researchers
to focus on small models that are only very stylized representations of an economy.
The rest of the paper is organized as follows. Section 2 presents the benchmark model that
we use for our exercise, while section 3 de…nes its equilibrium and how we approximate it.
Section 4, the core of the methodological contribution, explains how we evaluate the likelihood
of the model. This is achieved by stating a theorem that characterizes the structure of the
solution of second-order approximations to DSGE models with stochastic volatility. After
describing the data and the estimation approach in section 5, the empirical results appear
in sections 6 to 9. Section 10 constructs counterfactual histories. Section 11 concludes and
three appendices provide further technical details.
6

2. A Benchmark Model
We adopt as the benchmark economy for our empirical investigation what has become the
standard New Keynesian DSGE model in the literature (Woodford, 2003). The model is
based on Christiano, Eichenbaum, and Evans (2005) and Smets and Wouters (2007) and we
have used it, without stochastic volatility, in Fernández-Villaverde and Rubio-Ramírez (2008)
and in Fernández-Villaverde, Guerrón-Quintana, and Rubio-Ramírez (2009). The model has
many strengths but also important weaknesses. Su¢ ce it to say here that since this model has
been the base of much applied policy analysis by central banks,3 it is the natural laboratory
for this paper.
Since the model is well known, our presentation will be brief.4 A continuum of households
consume, save, hold real money balances, supply labor, and set wages subject to a demand
curve and nominal rigidities in the form of Calvo’s pricing with partial indexation. The …nal
good is produced by a representative …rm that aggregates a continuum of intermediate goods
produced by monopolistic competitive …rms. These …rms manufacture the intermediate good
by renting the labor supplied and the capital accumulated by the households. Intermediate
good producers set their prices subject to a demand curve and nominal rigidities in the form
of Calvo’s pricing with partial indexation. The model is closed with a monetary authority
that …xes the one-period nominal interest rate according to a Taylor policy rule. In our speci…cation, we introduce long-run growth through two unit roots: one in the neutral technology
and one in the investment-speci…c technology. Stochastic volatility appears in the form of
changing standard deviations of the …ve structural shocks to the model (two shocks to preferences, two shocks to technology, and one shock to monetary policy). Parameter drifting
appears in the form of changing values of the parameters in the Taylor policy rule.
2.1. Households
The economy is populated by a continuum of households indexed by j. Household j’s preferences are representable by a lifetime utility function:
E0

1
X
t=0

t

dt

(

log (cjt

hcjt 1 ) + log

3

mjt
pt

't

1+#
ljt
1+#

)

;

Closely related models are used by the Federal Reserve Board (Edge, Kiley, and Laforte, 2007), the
European Central Bank (Christo¤el, Coenen, and Warne, 2008) and the Bank of Sweden (Adolfson et al.,
2007).
4
The interested reader can …nd the web document, www.econ.upenn.edu/~jesusfv/benchmark_DSGE.pdf,
in which we present the model without stochastic volatility or parameter drifting in careful detail.

7

which is separable in consumption, cjt , real money balances, mjt =pt ; and hours worked, ljt . In
our notation, E0 is the conditional expectation operator,

is the discount factor, h controls

habit persistence, # is the inverse of the Frisch labor supply elasticity, dt is a shifter to
intertemporal preference that follows:
log dt =

d

log dt

1

+

dt "dt

where "dt

N (0; 1);

and 't is a labor supply shifter that evolves as:
log 't =

'

log 't

1

+

't "'t

where "'t

N (0; 1):

These two preference shocks are common to all households and provide ‡exibility for the
equilibrium dynamics of the model to capture ‡uctuations in interest rates and changes in
hours worked not accounted for by variations in consumption and wages.
The principal novelty of these preferences is that, for both shifters dt and 't , the standard
deviations,

dt

and

't ,

of their innovations, "dt and "'t , are indexed by time; that is, they

stochastically move period by period according to the autoregressive processes:
log

dt

= 1

d

log

d

+

d

log

dt 1

+

d udt

log

'

+

'

log

't 1

+

' u't

where udt

N (0; 1)

and
log

't

= 1

'

where u't

N (0; 1):

Our speci…cation for the law of motion of the standard deviations of the innovations is parsimonious and it introduces only four new parameters,

d

,

'

,

d,

and

'.

At the same

time, it is surprisingly powerful in capturing some important features of the data (Shephard,
2008). All the shocks and innovations (here and later in the paper) are perfectly observed
by the agents when they are realized. Agents have, as well, rational expectations about how
they evolve over time.
We can think about the shocks to preferences and to their stochastic volatility as re‡ecting
the random evolution of more complicated phenomena. For example, stochastic volatility may
appear as the consequence of changing demographic structures. An economy with older agents
might be both less patient because of higher mortality risk (in our notation, a lower dt ) and
less prone to reallocations in the labor force because of longer attachments to particular jobs
(in our notation, a lower

't ).

We assume complete …nancial markets: households can trade a whole set of securities
contingent on idiosyncratic and aggregate events. An amount of those securities, ajt+1 ; which
pay one unit of consumption in event ! jt+1;t , is traded at time t at unitary price qjt+1;t in
8

terms of the consumption good. We drop the dependence on the event to ease the notational
burden. In addition, households also hold bjt government bonds that pay a nominal gross
interest rate of Rt 1 . Therefore, the j

th household’s budget constraint is given by:
Z

mjt bjt+1
cjt + xjt +
+
+
pt
pt
1

= wjt ljt + rt ujt

[ujt ] kjt

t

1

+

qjt+1;t ajt+1 d! jt+1;t

mjt
pt

1

+ Rt

1

bjt
+ ajt + Tt + zt
pt

where xt is investment, wjt is the real wage, rt the real rental price of capital, ujt > 0 the
rate of use of capital,
good,

t

1

[ujt ] is the cost of utilizing capital at rate ujt in terms of the …nal

t

is an investment-speci…c technological level, Tt is a lump-sum transfer, and zt is the

pro…ts of the …rms in the economy. We specify that
[u] =

1

(u

1) +

2

2

a form that satis…es the standard conditions that

1)2

(u

0

[1] = 0,

[ ] = 0, and

00

[ ] > 0. This

function carries the normalization that u = 1 in the balanced growth path of the economy.
Using the relevant …rst-order conditions, we can …nd

1

0

=

[1] = re where re is the (rescaled)

balanced growth path rental price of capital (determined by all the other parameters in the
model). This will leave us with only one free parameter,

2.

The capital accumulated by household j at the end of period t is given by:
kjt = (1
where

) kjt

1

+

t

1

V

xjt
xjt 1

xjt

is the depreciation rate and V [ ] is a quadratic adjustment cost function:
V

xt
=
xt 1
2

xt
xt 1

2
x

with adjustment parameter . This function is written in deviations with respect to the
balanced growth rate of investment,
V0[

x]

x.

Therefore, along the balanced growth path, V [

x]

=

= 0.

Our third structural shock, the investment-speci…c technology level

t,

follows a random

walk in logs:
log
where

t

=

+ log

t 1

+

t" t

where "

t

N (0; 1)

is the drift of the process and " t is the innovation to its growth rate (see Greenwood,

Herkowitz, and Krusell, 1997, for the classic motivation for this shock). In a similar way to
9

the standard deviation of the innovations to the preference shocks, the standard deviation
evolves as an autoregressive process:

t

log

t

= 1

log

+

log

t 1

+

u

t

where u

N (0; 1):

t

Again, we can think about stochastic volatility as a stand-in for a more detailed explanation
of technological progress in capital production that we do not model explicitly.
We can de…ne two Lagrangian multipliers,

jt ,

the multiplier associated with the budget

constraint, and qjt (the marginal Tobin’s Q), the multiplier associated with the investment
adjustment constraint normalized by

jt .

Thus, the …rst order conditions of the household

problem with respect to cjt , bjt , ujt , kjt , and xjt can be written as:
dt (cjt

hcjt 1 )

1

jt

b Et dt+1 (cjt+1 hcjt )
Rt
= Et f jt+1
g;

1

=

jt ;

t+1

1

rt =
qjt = Et

jt+1

(1

t

0

[ujt ] ;

) qjt+1 + rt+1 ujt+1

jt

1
t+1

[ujt+1 ]

;

and
1 = qjt

t

1

V

xjt
xjt 1

V

0

xjt
xjt
xjt 1 xjt 1

+ Eqjt+1

jt+1
t+1

jt

V

0

xjt+1
xjt

xjt+1
xjt

2

:

We need more work to …nd the optimality condition with respect to labor and wages
because of the presence of monopolistic competition and nominal rigidities. Each household
j supplies a slightly di¤erent type of labor services ljt that are aggregated by a “labor packer”
into homogeneous labor ltd with the production function:
ltd

=

Z

1

1

1

ljt dj

0

that is rented to intermediate good producers at the wage wt . The “labor packer”is perfectly
competitive and it takes all di¤erentiated labor wages wjt and the wage wt as given.
The …rst-order conditions of the “labor packer”imply a demand function for labor:
ljt =

wjt
wt

ltd

10

8j

and, together with a zero pro…t condition wt ltd =
Z

wt =

1
1
wjt

R1
0

wjt ljt dj, an expression for the wage:
1
1

:

dj

0

Households follow a Calvo pricing mechanism when they set their wages. At the start
of every period, a randomly selected fraction 1

w

of households can reoptimize their

wages (where, by an appropriate law of large numbers, individual probabilities and aggregate
fractions are equal). All other households index their wages given past in‡ation with an
indexation parameter
changed wages for

2 [0; 1]. Therefore, the real wage of a household j that has not

w

periods is:

Y

w

t+s 1

wjt :

t+s

s=1

Since we postulated above both complete …nancial markets for the households and separable utility in consumption, the marginal utilities of consumption are the same for all
households. Thus, in equilibrium, cjt = ct , ujt = ut , kjt

1

= kt , xjt = xt , qjt = qt ;

jt

=

t,

and wjt = wt .
The last two equalities are the most relevant to simplify our analysis: they tell us that the
shadow cost of consumption is equated across households and that all households that can
reset their wages optimally will do it at the same level wt . With these two results, and after
several steps of algebra, we …nd that the evolution of wages is described by two recursive
equations:
ft =

1

d
t wt lt

(wt )

and
ft = dt 't

1

wt
wt

(1+#)

ltd

1+#

+

t

w Et

+

w

1

t+1

t

w Et

w

1

wt+1
wt
(1+#)

ft+1

wt+1
wt

t+1

(1+#)

ft+1

on the auxiliary variable ft .
Taking advantage that, in every period, a fraction 1
wage and the remaining fraction

w

w

of households set wt as their

partially index their price by past in‡ation, we can write

the law of motion of real wage as:
wt1

w

=

w

t 1
t

1

wt1

11

1

+ (1

w ) wt

1

:

2.2. The Final Good Producer
There is one …nal good producer that aggregates a continuum of intermediate goods according
to the production function:

Z

ytd =

1

"
" 1

" 1
"

(1)

yit di

0

where " is the elasticity of substitution.
The …nal good producer is perfectly competitive and minimizes its costs subject to the
production function (1) and taking as given all intermediate goods prices pti and the …nal
good price pt . The optimality conditions of this problem result in a demand function for each
intermediate good with the classic form:
"

pit
pt

yit =

ytd

8i

where ytd is the aggregate demand and a price for the …nal good:
pt =

Z

1
1 "

1

pit1 " di

:

0

2.3. Intermediate Good Producers
Each of the intermediate goods is produced by a monopolistic competitor whose technology
is given by a Cobb-Douglas production function with a …xed cost:
yit = At kit
where kit

1

1

litd

1

zt

is the capital rented by the …rm, litd is the amount of the “packed” labor input

rented by the …rm, the parameter

corresponds to the …xed cost of production, and At (our

fourth structural shock) is neutral productivity that follows:
log At =
In this speci…cation,

A

A

+ log At

1

+

At "At

where "At

N (0; 1):

is the drift of the neutral technological level and "At is the innovation

to its growth rate.
The time-varying standard deviation of this innovation evolves stochastically following
our, by now already familiar, speci…cation:
log

At

= 1

A

log

A

+

A

log

12

At 1

+

A uAt

where uAt

N (0; 1):

The technology is translated by a …xed cost parameter

and a scale variable zt =

1
1

1

At

. Given our de…nitions of neutral productivity, At , and investment-speci…c pro-

t

ductivity,

t,

we have that:
log zt =

where

=

z

A+

1

, zzt =

zAt + z
1

t

, zAt =

z

+ log zt

At "At ,

1

+ zzt

and z

=

t

t" t.

We can think about zt as

the weighted level of technology in the economy, where the weight is given by the elasticity of
output with respect to capital. The constant
The role of

z

is the average growth rate of the economy.

is to make economic pro…ts roughly equal to zero. We scale it by zt to keep the

…xed costs constant in relative terms to the technology level. Finally, note that zzt will also
have a stochastic volatility structure that is the product of the mixture of two processes with
stochastic volatility themselves.
Intermediate good producers produce the quantity demanded of the good by renting litd
and kit

at prices wt and rt . Then, by minimization, we have a marginal cost of:

1

1

mct =

1

wt1 rt
At

1

1

The marginal cost is constant for all …rms and all production levels given At , wt , and rt .
The quantity sold of the good is determined by the demand function derived above.
Given this demand function, the intermediate good producers set prices to maximize pro…ts.
However, when they do so, they follow the same Calvo pricing scheme as households. In each
period, a fraction 1

p

of intermediate good producers reoptimize their prices. All other

…rms partially index their prices by past in‡ation with an indexation parameter
Therefore, prices are set to solve the problem:
max Et
pit

1
X

(

p)

t+
t

=0

(

Y

t+s

s=1

pit
1
pt+

subject to
yit+ =

Y

t+s

s=1

pit
1
pt+

!

mct+

!

yit+

2 [0; 1].

)

"
d
yt+
:

In this problem, future pro…ts are discounted using the pricing kernel of the economy,
t+

=

t

(which is the right valuation criteria from the perspective of the households),

and the probability of the event “only indexation for

periods,”

p:

The solution for the …rm’s pricing problem has a recursive structure in two new auxiliary

13

variables gt1 and gt2 that take the form:
"

gt1
gt2 =

d
t mct yt

=

d
t yt

t

+

+

t

p Et

p Et

1
gt+1

t+1
1 "

t

t

t+1

t+1

2
gt+1

and
1)gt2

"gt1 = ("
where

pt
pt

=

t

is the ratio between the optimal new price (common across all …rms that can reset their
prices) and the price of the …nal good. With this structure, the price index follows:
"

p1t

1 "

=

p

t 1

or, normalizing by p1t " :

"
1

p1t

+ (1

p ) pt

1 "

1 "

1=

t 1

p

+ (1

1 "

p)

t

t

:

2.4. The Monetary Authority
The model is closed by the presence of a monetary authority that sets the nominal interest
rates through open market operations …nanced with lump-sum transfers Tt and a balanced
budget. The monetary authority follows a modi…ed Taylor rule:
Rt
=
R

Rt 1
R

R

0
@

The …rst term on the right-hand side,

;t

t

Rt 1
,
R

0
@

ytd
ytd 1

exp

yd

1
A

y;t

11
A

R

t:

represents a desire for interest rate smoothing,

expressed in terms of R; the balanced growth path nominal return of capital. The second
term,

t

, an “in‡ation gap,”responds to the deviation of in‡ation from its balanced growth

path level

. The third term,
ytd
ytd 1

exp

yd

is a “growth gap”: the ratio between the growth rate of the economy and
path gross growth rate of

ytd .

The term, log

t

=

14

m;t "mt ,

yd ,

the balanced

is the monetary policy shock. The

innovation "mt to the monetary policy shock follows a N (0; 1) process with a time-varying
standard deviation,

m;t ,

log

that follows an autoregressive process:

mt

= 1

log

m

m

+

log

m

mt 1

+

m um;t :

In this policy rule, we have two drifting parameters: the responses of the monetary authority,

;t

and

y;t ,

to the in‡ation and growth gap. The parameters drift over time in an

autoregressive fashion:
log

t

= 1

log

yt

= 1

log

+

log

+

t 1

"

where "

t

t

N (0; 1)

and
log

y

y

+

y

log

yt 1

+

y "yt

where "yt

N (0; 1):

We assume here that the agents perfectly observe the changes in monetary policy parameters. A more plausible scenario would involve some …ltering in real time by the agents
who need to learn the stand of the monetary authority from observed decisions. A similar
argument can be made for the values of the standard deviations of all the other shocks in the
economy. But since this learning would further complicate what is already a large model, we
leave this extension for future work.
2.5. Aggregation
Aggregate demand is given by:
ytd = ct + xt +

1
t

[ut ] kt 1 :

By relying on the observation that the capital-labor ratio is constant across …rms, we can
derive that aggregate supply is:
yts

=

ltd

At (ut kt 1 )

1

zt

vtp

where:
vtp

=

Z

0

1

pit
pt

"

di

is the aggregate loss of e¢ ciency induced by price dispersion of the intermediate goods.
Market clearing requires that
yt = ytd = yts :

15

By the properties of Calvo’s pricing:
"

vtp =

vtp

t 1

p

t

1

+ (1

"

p)

t

:

Finally, demanded labor is given by:
ltd

1
= w
vt

Z

Z

wjt
wt

where:
vtw

=

1

0

1

ljt dj

0

dj:

is the aggregate loss of labor input induced by wage dispersion among di¤erentiated types of
labor. Again, by Calvo’s pricing, this ine¢ ciency evolves as:
vtw =

wt 1
wt

w

w

t 1

vtw 1 + (1

t

w) (

w
t

)

:

3. Equilibrium
We can characterize an equilibrium in our economy by compiling all the …rst-order conditions
of the household and …rms, the Taylor rule of the monetary authority, and market clearing. This equilibrium is not stationary because we have two unit roots in the processes for
technology. However, we circumvent this problem by rescaling the model e
ct = ct , et = t zt ,

ret = rt t , qet = qt t , x
et =

xt
,
zt

w
et =

wt
,
zt

w
et =

wt
zt

, e
kt =

kt

zt

t

, and yetd =

ytd
.
zt

zt

The model is

stationary in these transformed variables and, therefore, along the balanced growth path:
c

=

x

=

w

=

w

=

yd

=

z:

With these rescaled variables, the states of the economy are stacked in a vector St with
19 components:

St =

bet 1 ; b
b
e
bt 1 ; b
;R
k t 1 ; bpt 1 ; bw
e
ct 1 ; b t 1 ; x
et 1 ; b
yet 1 ;
t 1; w

dbt 1 ; '
bt 1; b

t 1 ; byt 1 ; bdt 1 ; b't 1 ; b t 1 ; bAt 1 ; bmt 1

!0

where we have expressed each variable vart in terms of log deviation with respect to the
steady state, vd
art = log vart

log var, and

is the perturbation parameter to be described

below.

At this moment, it is also useful to clarify our wording with respect to the sources of
16

randomness in the model. Thus, (dt ; 't ; At ;

t; t)

is the vector of structural shocks (two

to preferences, two to technology, and one to monetary policy), ("dt ; "'t ; "At ; " t ; "mt ) is the
vector of innovations to the structural shocks, and (" t ; "yt ) is the vector of innovations to the
parameter drifts (one to the response to in‡ation and one to the response to output). We stack
these two vectors of innovations in the vector W1t = ("dt ; "'t ; " t ; "At ; "mt ; " t ; "yt )0 : Finally,
(

dt ;

't ;

At ;

t;

mt )

is the vector of volatility shocks and W2t = (udt ; u't ; u t ; uAt ; umt )0 is

the vector of innovations to the volatility shocks.
The equilibrium does not have a closed-form solution and we need to resort to a numerical
approximation to compute it. This computation presents three challenges. The …rst challenge
is that the dynamics of the state variables depend on St = (St0 ; W1t0 ; W2t0 ), a vector that stacks
states and innovations and has 31 components, an extremely demanding structure to keep
track of. The second challenge is that since we have stochastic volatility, an inherently nonlinear structure, standard linearization techniques cannot be applied. More pointedly, if we
linearized the model, stochastic volatility would disappear from the scene because the solution
of the model would be certainty equivalent. The third challenge is that since we will need to
compute the model for a large number of di¤erent parameter values in our estimation process,
speed is of the utmost importance.
Perturbation methods provide a nice solution to the computation of the model that addresses these challenges. Beyond being extremely fast, perturbation o¤ers high levels of accuracy even relatively far away from the perturbation point (Aruoba, Fernández-Villaverde,
and Rubio-Ramírez, 2006). Therefore, we perform a second order perturbation around the
deterministic steady state of the model and with respect to the perturbation parameter
that we introduced earlier. The quadratic terms of this approximation allow us to capture, to
a large extent, the e¤ects of volatility shocks and parameter drift while keeping computational
complexity at a reasonable level.
The solution of the model is then given by a transition equation for states:
0

B
St+1 = B
@

1 0
s1 St

..
.

1
0
s19 St

1

0

C 1B
C+ B
A 2@

St
St

2 0
s1 St

..
.

2
0
s19 St

1
C
C
A

(2)

and an observation equation:
0

B
Yt = C+ B
@

0
1
1
(St ; St 1 ) 2o1 (St ; St 1 )0
(St ; St 1 )0
C
C 1B
..
..
C+ B
C
.
.
A
A 2@
0
0
2
1
(S
;
S
)
(S
;
S
)
(S
;
S
)
t
t 1
t
t 1
t
t 1
o5
o5
1
o1

17

(3)

where Yt is a vector of observables for the econometrician (…ve in our case) and C is a vector
of means of these observables. The lagged vector St

1

appears in the equation because, as

we will see momentarily, our observables have components in …rst di¤erences.
In these equations,

1
si

2
si

is a 1 31 vector and

is a 31 31 matrix for i = 1; : : : ; 19. The

…rst term is the linear solution of the model while the second term is the quadratic component
of the solution. Similarly,

1
oi

is a 1 62 vector and

2
oi

a 62 62 matrix for i = 1; : : : ; 5 and

the interpretation of each term is the same as before: the …rst term is the linear component
and the second one the quadratic component of the solution.
It is important to emphasize that we are not assuming the presence of any measurement
error. Although we consider measurement errors both plausible and empirically relevant,
in our exercise we want to measure how heteroscedastic structural shocks and parameter
drifting help in accounting for the data. Consequently, we eliminate measurement errors to
sharpen our analysis. This decision also helps to illustrate how DSGE models with stochastic
volatility have a profusion of shocks that we can exploit in our estimation. We will elaborate
on this last point below.
The transition equation (2) is unique (up to an equivalence class of representations) but
the observable equation (3) is not, because it depends on what we assume the econometrician
can observe. Guerrón-Quintana (2009b) discusses the consequences for inference of selecting
di¤erent observables.
We pick as observables the …rst di¤erence of the log of the relative price of investment, the
log federal funds rate, log in‡ation, the …rst di¤erence of log output, and the …rst di¤erence
of log real wages, or in our notation:
Yt = ( 4 log
This implies that C =

0
t ; 4 log yt ; 4 log wt )

t ; log Rt ; log

; log R; log ;

yd ;

w

0

:

. Later, when we take the model to the

data, we will let the likelihood pick these means, since

; log R; log ;

yd ;

and

w

depend

on the structural parameters. We select these variables because they bring us information
about aggregate behavior (output), the stand of monetary policy (the interest rate and in‡ation), and the di¤erent shocks (the relative price of investment about investment-speci…c
technological change, the other four variables about technology and preference shocks) that
we are concerned about.
The state space representation generated by the transition equation (2) and the measurement equation (3) has an interesting structure that we exploit to evaluate the likelihood of
the model. In the next section, we present a general description of that structure and how it
applies to our economy.

18

4. Stochastic Volatility and Evaluation of the Likelihood
In this section we explain how to evaluate the likelihood function of our model. If we allow
to be the
; : : : ; Ydata
to be the data counterpart of our observables, Ydata;t = Ydata
Ydata
t
1
t
history up to time t of our observables, we can write the likelihood as:
T

p Y =Y

data;T

;

=

T
Y
t=1

p Yt = Ydata
jYdata;t 1 ;
t

;

where

=

Z Z Z

p Yt = Ydata
jYdata;t 1 ;
t
p Yt = Ydata
jSt ; W1t ; St 1 ;
t

p St ; W1t ; St 1 jYdata;t 1 ;

dSt dW1t dSt

1

(4)

and Ydata;0 = f?g.

Computing this likelihood is a di¢ cult problem. It cannot be evaluated exactly and deter-

ministic integration problems are too slow for practical use (we have three integrals period per
period over large dimensions). Instead, we use a sequential Monte Carlo method to obtain a
numerical estimate of (4).5 As shown in Fernández-Villaverde and Rubio-Ramírez (2007), coni
ditional on having N draws of sit ; w1t
; sit

N
1 i=1

from the densities p St ; W1t ; St 1 jYdata;t 1 ;

(we will explain later how we generate them), a law of large numbers implies that the integral
(4) can be approximated by:
p Yt =

Ydata
jYdata;t 1 ;
t

N
1 X
i
'
p Yt = Ydata
jsit ; w1t
; sit 1 ;
t
N i=1

(5)

Hence, we need to evaluate:
i
p Yt = Ydata
jsit ; w1t
; sit 1 ;
t

(6)

for each draw. This evaluation step is crucial not only because it is a term in (5), but
also because, in the sequential Monte Carlo that we will implement, we need (6) to resample from the draws from p St ; W1t ; St 1 jYdata;t 1 ;
p St+1 ; W1t+1 ; St jYdata;t ;

and, in that way, get draws from

.

5

This is not the only possible algorithm to do so, although it is a procedure that we have found useful
in previous work. Alternatives include DeJong et al. (2007), Kim, Shephard, and Chib (1998), Fiorentini,
Sentana, and Shepard (2004), and Fermanian and Salanié (2004).

19

The measurement equation (3) implies that evaluating (6) involves solving the equation:
0

B
=C+B
Ydata
t
@

1
1
0
(St ; St 1 )0
(St ; St 1 ) 2o1 (St ; St 1 )0
C 1B
C
..
..
C+ B
C
.
.
A 2@
A
0
0
1
2
(St ; St 1 ) o5 (St ; St 1 )
o5 (St ; St 1 )
1
o1

(7)

i
for W2;t given Ydata
; sit ; w1t
; and sit 1 . Since (7) is quadratic, we will have 25 di¤erent solutions
t

to this equation. We are not aware of any accurate and e¢ cient way to …nd these 25 di¤erent
solutions. This problem would seem to prevent us from achieving our goal of evaluating the
likelihood function of this model.
But considering stochastic volatility allows us to convert the above-described quadratic
problem into a linear and simpler one. In particular, we illustrate how, when stochastic
volatility is present in the problem, equation (7) has only one solution. Moreover, that
solution can be found by simply inverting a matrix. Thanks to this insight, the evaluation of
the likelihood function becomes possible.6
The key to our approach is to note that, when stochastic volatility is considered, the
optimal policies functions of many economies share a particular pattern that we can exploit.
To make this point more generally, we switch in the next few paragraphs to a more abstract
notation.
The set of equilibrium conditions of a wide variety of DSGE models (including the one
described in the paper) can be written as:
Et f (Yt+1 ; Yt ; St+1 ; St ; Zt+1 ; Zt ) = 0

(8)

where Et is the expectation operator conditional on information available at time t, Yt =

(Y1t ; Y2t ; : : : ; Ykt ) is the vector of non-predetermined variables of size k, St = (S1t ; S2t ; : : : ; Snt )

is the vector of endogenous predetermined variables of size n, Zt = (Z1t ; Z2t ; : : : ; Zmt ) is the

vector of exogenous predetermined variables of size m (which we call structural shocks), and
f maps R2

k+2 n+2 m

into Rk+n+m .

We want to consider the case where the structural shocks follow a stochastic volatility
6
Stochastic volatility may also help to circumvent a problem of some DSGE models: stochastic singularity.
In general, we need at least as many shocks as observables for the likelihood function to be well de…ned. This
requirement forces researchers to add extra shocks or measurement errors in situations where they might
not desire to do so. Stochastic volatility, by introducing an additional volatility shock for each structural
shock, doubles the number of shocks in the model. Even if in our model this is not necessary, on some other
occasions, the researcher might want to take advantage of this extra ‡exibility and either augment the number
of observables or reduce the number of shocks.

20

process of the form:
Zit+1 =

i Zit

+

it+1 "it+1

where the standard deviation of the innovations evolves as:
log

it+1

= #i log

it

+

i uit+1

for all i = f1; : : : ; mg.

To ease notation, we are assuming that all structural shocks face volatility shocks. It

is straightforward yet cumbersome to generalize the notation to other cases (in fact, in our
model, some of the shocks, the ones in the parameter drifting, do not follow a stochastic
volatility process).
The solution to the model given in equation (8) can be summarized by the following two
equations, one describing the evolution of predetermined variables:
St+1 = h (St ; Zt 1 ;

t 1 ; Et ; U t ;

)

(9)

);

(10)

and one describing the evolution of non-predetermined ones:
Yt = g (St ; Zt 1 ;
where

t

= (log

1t ; log

2t ; : : : ; log

mt ),

t 1 ; Et ; U t ;

Et = ("1t ; "2t ; : : : ; "mt ); and Ut = (u1t ; u2t ; : : : ; umt )

(this assumes that the volatility shocks are uncorrelated, a restriction that could be relaxed
by the appropriate extension of the state space). To clarify notation, we think of

t

as the

volatility shocks, Et are the innovations to the structural shocks, and Ut are innovations to
volatility shocks.

We wish to …nd a second-order approximation of the functions h ( ) : Rn+(4
and g ( ) : Rn+(4

m)+1

! Rk around the steady state, St = S and

m)+1

! Rn

= 0. Therefore, we need

to characterize the …rst- and second-order derivatives of the functions h ( ) and g ( ) evaluated
at the steady state. The following theorem shows that the …rst partial derivatives of h ( ) and
g ( ) with respect to any component of Ut and

t 1

evaluated at the steady state is zero; that

is, volatility shocks and their innovations do not a¤ect the linear component of the optimal
decision rule of the agents for any i = f1; : : : ; mg (the same occurs with the perturbation
parameter

). A similar result has been already established by Schmitt-Grohé and Uribe

(2004) for the homoscedastic shocks case. More important, the theorem also shows that the
second partial derivative of h ( ) and g ( ) with respect to ui;t and any other variable but "i;t
is also zero for any i = f1; : : : ; mg.
21

i
! ]j

Theorem 1. Let us denote [
with respect to the j

as the derivative of the i

th element of generic function

th element generic variable ! evaluated at the non-stochastic steady

state (where we drop this index if ! is unidimensional). Then, for the dynamic equilibrium
model speci…ed in equation (8), we have that:
h

t 1

i1
j

= g

i2
j

t 1

= [hUt ]ij1 = [gUt ]ij2 = [h ]i1 = [g ]i2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
Furthermore, if we denote [

function

!

]ij1 ;j2 as the derivative of the i

with respect to the j1

th element of generic

th element generic variable ! and the j2

th element

generic variable evaluated at the non-stochastic steady state (where again we drop the index
for unidimensional variables), we have that:
[h

i1
;St ]j

= [g

i2
;St ]j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; ng ;
h

;Zt

1

i1
j

= g

;Zt

i2
j

1

= h

;

t 1

i1
j

= g

;

t 1

i2
j

= [h

i1
;Et ]j

= [g

i2
;Et ]j

= [h

i1
;Ut ]j

= [g

i2
;Ut ]j

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg,
hSt ;

i1
j1 ;j2

t 1

= gSt ;

t 1

i2
j1 ;j2

= [hSt ;Ut ]ij11 ;j2 = [gSt ;Ut ]ij21 ;j2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg ;
hZt

1;

t 1

i1
j1 ;j2

= gZt

1;

t 1

i2
j1 ;j2

= h

t 1;

t 1

i1
j1 ;j2

= g

t 1;

t 1

i2
j1 ;j2

=0

and
hZt

1 ;Ut

i1
j1 ;j2

= gZt

1 ;Ut

i2
j1 ;j2

= h

t 1 ;Ut

i1
j1 ;j2

= g

t 1 ;Ut

i2
j1 ;j2

= [hUt ;Ut ]ij11 ;j2 = [gUt ;Ut ]ij21 ;j2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg, and
hEt ;

t 1

i1
j1 ;j2

= gEt ;

t 1

i2
j1 ;j2

= [hEt ;Ut ]ij11 ;j2 = [gEt ;Ut ]ij21 ;j2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg if j1 6= j2 .
Proof. See Appendix.

22

=0

Since the statement of the theorem is long and involved, we clarify it with a table in
which we characterize the second derivatives of h ( ) and g ( ) with respect to the di¤erent
variables (St ; Zt 1 ;

t 1 ; Et ; U t ;

). The way to read the table is as follows. Take an arbitrary

entry, for instance entry (1,2), St Zt

1

6= 0. In this entry, we state that the cross-derivatives

of h ( ) and g ( ) with respect to St and Zt
t 1 Ut

1

are di¤erent from zero. Similarly, entry (3,3),

= 0, tells us that the cross-derivatives of h ( ) and g ( ) with respect to

t 1

and Ut are

all zero. Entries (3,2) and (4,2) have a “*”to denote that the only cross-derivatives of those
entries that are di¤erent from zero are those that correspond to the same index j (that is, the

cross derivatives of each innovation to the structural shocks with respect to its own volatility
shock and the cross derivatives of the innovation to the structural shocks to the innovation
to its own volatility shock). The lower triangular part of the table is empty because of the
symmetry of second derivatives.
Table 4.1: Second Derivatives
St St 6= 0

Z t 1 Zt
t 1

1

t 1

St Zt

6= 0 Zt

=0

Et Et 6= 0

Ut Ut = 0
6= 0

1

1

6= 0

t 1

t 1 Et

=0

6= 0

Et Ut 6= 0

Ut = 0

St

=0

t 1

Zt 1 Et 6= 0
t 1 Ut

=0

St Et 6= 0

St Ut = 0

Z t 1 U t = 0 Zt
t 1

1

=0

St = 0

=0

Et = 0

Table 4.1 tells us that, of the 21 possible sets of second derivatives, 12 are zero and 9
are not. The implications for the decision rules of agents and for the equilibrium function
are striking. The perturbation parameter,

, will only have a coe¢ cient di¤erent from zero

in the term where it appears in a square by itself. This term is a constant that corrects
for precautionary behavior induced by risk. Volatility shocks,

t 1

, appear with coe¢ cients

di¤erent from zero only in the term where they are multiplied by the innovation to its own
structural shock. Finally, innovations to the volatility shocks, Ut , also appear with coe¢ cients

di¤erent from zero when they show up with the innovation to their own structural shock Et .

The main implication of Theorem 1 for our goal of evaluating the likelihood function is

that, of the terms that complicate our work, only the ones associated with [hEt ;Ut ]ij21 ;j1 and

[gEt ;Ut ]ij11 ;j1 are di¤erent from zero. As we will see in the next corollary, this result has an
important yet rather direct implication for the structure of the observation equation.

23

Corollary 2. The second-order approximation to the measurement equation (3) can be written as:
0

B
Yt = C+ B
@

where

2;1
oi

1
0
(St ; St 1 )0
(St0 ; W1t0 ; St 1 )
C
B
1
..
C+ B
.
A 2@
0
1
(St0 ; W1t0 ; St 1 )
(S
;
S
)
t
t 1
o5
0
1
W1t0 2;2
o1
B
C
..
B
C W2;t
+@
.
A
2;2
0
W1t o5
1
o1

2;1
o1

(St0 ; W1t0 ; St 1 )0

2;1
o5

(St0 ; W1t0 ; St 1 )0

..
.

1
C
C
A

denotes the cross-derivative between elements of (St0 ; W1t0 ; St 1 ) and

2;2
oi

denotes

the cross-derivative between elements of W1t and elements of W2t for i 2 f1; : : : ; 5g.
We are now ready to evaluate the likelihood function. Using corollary 2 and if we de…ne:

At (St0 ; W1t0 ; St 1 )
0

1B
B
2@

0

B
C B
@

Ydata
t

1
o1

..
.

1
o5

1

C
C (St ; St 1 )0
A

(St0 ; W1t0 ; St 1 )

2;1
o1

(St0 ; W1t0 ; St 1 )0

(St0 ; W1t0 ; St 1 )

2;1
o5

(St0 ; W1t0 ; St 1 )0

and
Bt (W1t0 )
we have that:
p Yt = Ydata
jSt ; W1t ; St 1 ;
t

..
.

0

W0
B 1t.
B
..
@
W1t0

2;2
o1

2;2
o5

10
C
C
A

1
C
C
A

= det Bt 1 (W1t0 ) p W2;t = Bt 1 (W1t0 ) At (St0 ; W1t0 ; St 1 )

which is evaluated directly given that we know Bt (W1t0 ), At (St0 ; W1t0 ; St 1 ), and the distribution of W2t .
With this expression, evaluated at N draws of
densities p St ; W1t ; St 1 jYdata;t 1 ;
p Yt =

Ydata
jYdata;t 1
t

i
sit ; w1t
; sit

N
1 i=1

from the conditional

, the likelihood (4) can be approximated by:

N
1 X
i0
'
det Bt 1 w1t
N i=1

24

0

i0
i0
p W2;t = Bt 1 w1t
At sit ; w1t
; sit

1

In addition, we can …nd the importance weights for each draw:
qti

0

i0
i0
i0
det Bt 1 (w1t
) p W2;t = Bt 1 (w1t
) At sit ; w1t
; sit

= PN

i=1 det Bt

1

i0
)
(w1t

p W2;t = Bt

1

i0
) At
(w1t

1
i0
i0
st ; w1t ; sit 1

(11)

that we will use momentarily to update our swarm of particles.
i
; sit
To generate the N draws of sit ; w1t

N
1 i=1

; we rely on a sequential Monte Carlo that

proceeds as follows (see Fernández-Villaverde and Rubio-Ramírez, 2007, for details):

Step 0, Initialization: Set t
from p St 1 ; W1t 1 ; St 2 jY

data;t 1

;

1.

Sample N values

.

n
sit

1jt

i
1 ; w1t

1jt

i
1 ; st

2jt 1

oN

i=1

N

i
; sit 1 i=1 from p St ; W1t ; St 1 jYdata;t 1 ;
Step 1, Prediction: Sample N values sit ; w1t
oN
n
i
i
, the law of motion for states and the distribution
using sit 1jt 1 ; w1t
1jt 1 ; st 2jt 1

of shocks fW1t ; W2t 1 g.

i=1

i
Step 2, Filtering: Assign to each draw sit ; w1t
; sit

1

the weight qti in (11).

Step 3, Sampling: Sample N times with replacement from
weights

N
fqti gi=1 .

to step 1.

Call each draw

i
sitjt ; w1tjt
; sit

1jt

.

i
; sit
sit ; w1t

If t < T; set t

N
1 i=1

and

t + 1 and go

Otherwise stop.

Del Moral and Jacod (2002) and Künsch (2005) prove, under weak conditions, that this
sequential Monte Carlo delivers a consistent estimator of the likelihood function and that a
central limit theorem applies.

5. Data and Estimation
We estimate our model using …ve time series for the U.S. economy: 1) the relative price of
investment goods with respect to the price of consumption goods, 2) the federal funds rate,
3) real output per capita growth, 4) the consumer price index, and 5) real wages per capita.
Our sample covers 1959.Q1 to 2007.Q1, with 192 observations. Appendix B explains how we
construct the series.
Once we have evaluated the likelihood as outlined earlier, we can either maximize it or
combine it with a prior and rely on a Markov chain Monte Carlo algorithm to simulate from
the posterior distribution. We follow the second route. However, we pick ‡at priors on a
bounded support for all the parameters. The bounds are either natural economic restrictions
(for instance, the Calvo and indexation parameters lie between 0 and 1) or are so wide that
the likelihood assigns (numerically) zero probability to values outside them. Bounded ‡at
25

priors induce a proper posterior, a convenient feature for our exercise below that assesses the
…t of the model.
We resort to ‡at priors for two reasons. First, to reduce the impact of presample information and show that our results arise mainly from the shape of the likelihood and not from
the prior (although, of course, ‡at priors are not invariant to reparameterization). Thus, the
reader who wants to interpret our posterior modes as maximum likelihood point estimates
can do so. Second, because as we learned in Fernández-Villaverde et al. (2009), eliciting
priors for stochastic volatility is di¢ cult, since we deal with unfamiliar units, such as the
variance of volatility shocks, about which we do not have clear beliefs.
Flat priors come, though, at a price: before proceeding to the estimation, we have to …x
several parameters. We are dealing with a large model that su¤ers from weak identi…cation
along some dimensions. Our ability to learn from the data is sharpened if we avoid searching
over these dimensions.
Table 5.1: Fixed Parameters
h
0:99 0:9

#
8

1:17

"
10

0:025

0:21 9:5

2

10

0

y

0:001

0:95

0

y

0

Table 5.1 lists the …xed parameters. Our guiding criterion in selecting them was to pick
conventional values in the literature. The discount factor,

= 0:99, is a default choice, habit

persistence, h = 0:9; matches the observed sluggish response of consumption to shocks, the
parameter controlling the level of labor supply,
in the data, and the depreciation rate,

= 8; captures the average amount of hours

= 0:025, induces the appropriate capital-output

ratio. The elasticities of substitution, " =

= 10, deliver average mark-ups of around 10

percent, a common value in these models. We set the …xed cost of production, , to zero,
since it is nearly irrelevant for the dynamics of the model, and we set the cost of capital
utilization,

2,

to a small number to introduce some curvature in this decision.

Three parameter values are borrowed from the point estimates from a similar model without stochastic volatility or parameter drifting presented in Fernández-Villaverde, GuerrónQuintana, and Rubio-Ramírez (2009). The …rst is the inverse of the Frisch labor elasticity,
# = 1:17. As argued by Rogerson and Wallenius (2009), this aggregate elasticity is compatible with microeconomic data, once we allow for intensive and extensive margins on labor
supply. The second is the coe¢ cient of the intermediate goods production function,

= 0:21.

This value is lower than the common calibration of Cobb-Douglas production functions in
26

real business cycle models because, in our environment, we have positive pro…ts that also
appear as capital income in the National Income and Product Accounts. The third value
that we borrow is the adjustment cost,

= 9:5, a number in line with other estimates from

DSGE models ( would be particularly hard to identify, since investment is not one of our
observables).
The autoregressive parameter of the evolution of the response to in‡ation,

, is set to

0.95. In preliminary estimations, we discovered that the likelihood pushed this parameter
to 1. When this happened, and although the model was still in the determinacy region, the
simulations became numerically unstable: after some shocks, the reaction of interest rates
to in‡ation could be too tepid for too long. The 0.95 value seems to be the highest possible
value of

such that the problem does not appear. The last two parameters,

y

and

y;

are equal to zero because, also in exploratory estimations, the likelihood favored values of
y

0: Thus, we decided to forget about them and make

y;t

=

y:

To …nd the posterior, we proceed as follows. First, we de…ne a grid of parameter values and
check for the regions of high posterior density by evaluating the likelihood function in each
point of the grid. This is a time-consuming procedure, but it ensures that we are searching
in the right zone of the parameter space. Once we have identi…ed the global maximum in
the grid, we initialize a random-walk Metropolis-Hastings algorithm from this point. After
an extensive …ne-tuning of the algorithm, we draw 10,000 times from the chain.

6. Parameter Estimates
We now examine our parameter estimates. To ease the discussion, we group them in di¤erent
tables, one for each set of parameters dealing with related aspects of the model. In all cases,
we report the mode of the posterior and the standard deviation in parenthesis below (in the
interest of space, we do not include the whole histograms of the posterior).
Table 6.1: Posterior, Parameters of Nominal Rigidities
p

w

w

0:8139 0:6186 0:6869 0:6340
(0:0143)

(0:024)

(0:0432)

(0:0074)

Table 6.1 presents the results for the nominal rigidities parameters. Our estimates indicate
an economy with substantial rigidities in prices, which are reoptimized roughly once every …ve
quarters, and in wages, which are reoptimized approximately every three quarters. Moreover,
since the standard deviations are small, there is enough information on the data about this
result. At the same time, there is a fair degree of indexation, between 0.62-0.63, which brings
27

a strong persistence of in‡ation. While it is tempting to compare our estimates with the
evidence on the individual duration of prices as reviewed by Klenow and Malin (2009), in
our model all prices and wages change every quarter. That is why, to a naive observer, our
economy would look like one displaying tremendous price ‡exibility.
Table 6.2: Posterior, Parameters of the Stochastic Processes for Structural Shocks
d

A

'

0:1182 0:9331 0:0034 0:0028
(0:0049)

(0:0425)

(6:6e 5)

(4:1e 5)

Table 6.2 reports the …ndings for the parameters of the stochastic processes for the structural shocks. We estimate a low persistence of the intertemporal preference shock and a high
persistence of the intratemporal one. The low estimate of

d

gets the quick variations in

marginal utilities of consumption that match output growth and in‡ation ‡uctuations. The
intratemporal shock is persistent to account for long-lived movements in hours worked. We estimate mean growth rates of technology of 0.0034 (neutral) and 0.0028 (investment-speci…c).
Those numbers give us an average growth of the economy of 0.44 percent per quarter, or
around 1.77 percent on an annual basis (0.46 and 1.86 percent in the data, respectively).
Technology shocks, in our model, are deviations with respect to these drifts. Thus, we estimate that At falls in only 8 of the 192 quarters in our sample (which roughly corresponds to
the percentage of quarters where measured productivity falls in the data), even if we estimate
negative innovations to neutral technology in 103 quarters.
Table 6.3: Posterior, Parameters of the Stochastic Processes for Volatility Shocks
log

d

1:9834
(0:0726)
d

0:9506
(0:0298)
d

0:3246
(0:0083)

log

'

2:4983
(0:0917)

log
6:0283
(0:1278)

'

0:1275
(0:0032)

(0:0669)

A

3:9013
(0:0745)
a

0:7508
(0:035)

'

2:8549

log

0:2411
(0:005)
a

0:4716
(0:006)

0:7955
(0:013)

log

m

6:000
(0:1471)
m

0:8550
(0:0231)
m

1:1034
(0:0185)

The results for the parameters of the stochastic volatility processes appear in table 6.3. In
all cases, the ’s and the ’s are far away from zero: the likelihood strongly favors values where
stochastic volatility plays an important role. The standard deviations of the innovations of
the intertemporal preference shock and of the monetary policy shock are the most persistent,
while the standard deviation of the innovation of the intratemporal preference shock is the
28

least persistent. The standard deviation of the innovations of the volatility shock to the
intratemporal preference shock,

'

= 2:8549, is large: the model asks for fast changes in the

size of movements in marginal utilities of leisure to reproduce the hours data.
Table 6.4: Posterior, Policy Parameters
log

R

0:7855
(0:0162)

log

y

1:4034 1:0005 0:0441 0:1479
(0:0498)

(0:0043)

(0:0005)

(0:002)

In table 6.4., we have the estimates of the policy parameters. The autoregressive component of the federal funds rate is high, 0:7855, although somewhat smaller than in estimations
without parameter drift. The value of

y

(0.24 in levels) is similar to other results in the lit-

erature. The in‡ation along the balanced growth path is estimated to be 0.0005 per quarter.
This parameter requires some comment. As for all the other endogenous variables, the law of
motion of in‡ation is not centered around its value along the balanced growth path. Instead,
it is moved away by the second-order terms in the solution. In this case, the constant in
the second order associated with the squared value of the perturbation parameter is 0.0013.
These e¤ects allow the model to capture the level of in‡ation in the data.7
Finally, the estimated value of

(1.045 in levels) guarantees local determinacy of the

equilibrium. To see this, note that the relevant part of the solution of the model for local
determinacy is the linear component. This component depends on
sponse, and not on the current value of
survives even if

t

t.

, the mean policy re-

The economic intuition is that local unicity

temporarily violates the Taylor principle as long as there is reversion

to the mean in the policy response and, thus, the agents have the expectation that

t

will

satisfy the Taylor principle on average. For a related result in models with Markov-switching
regime changes, see Davig and Leeper (2006). While we cannot …nd an analytical expression
for the determinacy region, numerical experiments show that, conditional on the other point
estimates, values of
bility to values of

above 0.98 ensure uniqueness. Since the likelihood assigns zero probalower than 1.01, well inside the determinacy region, multiplicity of local

equilibria is not an issue here.
7

These e¤ects also enormously complicate the introduction of time variation in . The likelihood wants
to match the moments of the ergodic distribution of in‡ation, not the level of , which is in‡ation along the
balanced growth path. When we have non-linearities, the mean of that ergodic distribution may be far from
: Therefore, learning from that mean about is hard. Learning from that mean about a time-varying is
even harder.

29

7. Impulse Response Functions
Before continuing the exploration of our results, we plot the impulse response functions (IRFs)
generated by the model to a monetary policy shock. This exercise is a powerful reality check.
If the IRFs match the shapes and sizes of those gathered by time series methods such as
SVARs, it will strengthen our belief in the rest of our results. Otherwise, we should at least
understand where the di¤erences come from.

Figure 7.1: IRFs of in‡ation, output growth, and the federal funds rate to a monetary
policy ("mt ) shock. The responses are measured as log di¤erences with respect to the mean
of the ergodic distribution.

30

Auspiciously, the answer is positive: our model generates dynamic responses that are close
to the ones from SVARs (see, for instance, Sims and Zha, 2006). Figure 7.1 plots the IRFs
to three variables commonly discussed in monetary models: the federal funds rate, output
growth, and in‡ation. Since we have a non-linear model, in all the …gures in this section,
we report the generalized IRFs starting from the mean of the ergodic distribution (Koop,
Pesaran, and Potter, 1996). After a one-standard-deviation shock to the federal funds rate,
in‡ation goes down in a hump-shaped pattern for many quarters and output growth drops.
Figure 7.2 plots the IRFs after a one-standard-deviation innovation to the monetary policy
shock computed conditional on …xing

t

to the estimated mean during the tenure of each of

three di¤erent chairmen of the Board of Governors: the combination Burns-Miller, Volcker,
and Greenspan. This exercise tells us how the variation on the systematic component of
monetary policy has a¤ected the dynamics of aggregate variables. Furthermore, it allows a
comparison with numerous similar exercises done in the literature with SVARs where the
IRFs are estimated on di¤erent subsamples.
The most interesting di¤erence is that the response of output growth under Volcker was
the mildest: the estimated average stand of monetary policy under his tenure reduces the
volatility of output. In‡ation responds more moderately as well since the agents have the
expectation that future shocks will be smoothed out by the monetary authority. In models
such as ours, this stabilization of the economy is generally welfare improving since it reduces
price and wage dispersion and lowers consumption ‡uctuations. This …nding also explains
why the IRFs of the interest rate are nearly on top of each other for all three periods: while
we estimate that monetary policy responded more during Volcker’s years for any given level
of in‡ation than under Burns-Miller or Greenspan, this policy lowers in‡ation deviations and
hence moderates the actual movement along the equilibrium path of the economy. Moreover,
this second set of IRFs already points out one important result of this paper: we estimate
that monetary policy under Burns-Miller and Greenspan was similar, while it was di¤erent
under Volcker. This …nding will be reinforced by the results we present below.

31

Figure 7.2: IRFs of in‡ation, output growth, and the federal funds rate to a monetary
policy ("mt ) shock conditional on the mean of the Taylor rule parameters of each chairmen.
The responses are measured as log di¤erences with respect to the mean of the ergodic
distribution.

32

Figure 7.3: IRFs of in‡ation, output growth, and the federal funds rate to an intertemporal
demand ("dt ) shock, an intratemporal demand (" t ) shock, an investment-speci…c (" t )
shock, and a neutral technology ("At ) shock. The responses are measured as log di¤erences
with respect to the mean of the ergodic distribution.
For completeness, we also plot, in …gure 7.3, the IRFs to each of the other four shocks in our
model: the two preferences shocks (intertemporal and intratemporal) and the two technology
shocks (investment-speci…c and neutral). The behavior of the model is standard. A onestandard-deviation intertemporal preference shock raises output growth and in‡ation because
there is an increase in the desire for consumption in the current period. The intratemporal
shock lowers output because labor becomes less attractive, driving up the marginal costs and
with it, prices. The two supply shocks raise output growth and lower in‡ation by increasing
productivity.
33

8. Model Fit
After the point estimates and the IRFs, our next step is to examine the …t of the model
and how it compares with alternative speci…cations. In this way, we document the …rst
main …nding of the paper: the data strongly support the view that monetary policy has
changed over time even after including stochastic volatility. This …nding corroborates our
interpretation that the di¤erences in IRFs reported in …gure 7.2 are empirically relevant.
Given our Bayesian framework, a natural approach for model comparison is the computation of log marginal data densities (log MDD) and log Bayes factors. The log MDD of version
i of a model is de…ned as
T

log p Y = Y

data;T

; i = log

Z

p YT = Ydata;T ; ; i p ( ; i) d ;

(12)

where p YT = Ydata;T ; ; i is the likelihood and p ( ; i) is the prior for the parameters of
version i. The log Bayes factor between speci…cations i and j, a measure of the evidence in
the data for one speci…cation above the other, is
log Bi;j = log p YT = Ydata;T ; i

log p YT = Ydata;T ; j :

The Bayes factor is attractive because it automatically penalizes speci…cations with unneeded
free parameters.
We compare the full model with stochastic volatility and parameter drifting (drift) with
a version without parameter drifting (no drift) but with stochastic volatility. In this second
case, we have two parameters less,

and

(but we still have the mean response log

of

monetary policy to in‡ation deviations). To ease notation, we partition the parameter vector
as

= e;

;

where e is the vector of all the other parameters, common to the two

versions of the model.

Given that 1) our priors are uniform, 2) independent of each other, and 3) covers all the

area where the likelihood is (numerically) positive, and that 4) the priors on e are common

across the two speci…cations of the model, we can write

log p YT = Ydata;T ; drift
Z
= log p YT = Ydata;T ; ; drift p (e) p
p( )d =
Z
= log p YT = Ydata;T ; ; drift d + log p (e) + log p

34

+ log p ( ) ;

where log p (e), log p

, and log p ( ) are constants and

log p YT = Ydata;T ; no drift
Z
Z
data;T
T
= log p Y = Y
; e; no drift p (e) de = log p YT = Ydata;T ; e; no drift de + log p (e) :

Thus

log Bdrift, no drift = log p YT = Ydata;T ; drift
log p YT = Ydata;T ; no drift
Z
Z
data;T
T
= log p Y = Y
; ; drift de log p YT = Ydata;T ; e; no drift de log p
The …rst two terms, log

R

p YT = Ydata;T ; ; drift d

log

R

log p ( ) :

p YT = Ydata;T ; e; no drift de,

tell us how much better the version with parameter drift …ts the data in comparison with the
version with no drift. The last two terms, log p

+ log p ( ) ; penalize for the presence

of two extra parameters in the version with parameter drift.
We estimate the log MDDs following Geweke’s (1998) harmonic mean method. This
requires us to generate a new draw of the posterior of the model for the speci…cation with no
R
parameter drift to compute log p YT = Ydata;T ; e; no drift de. After doing so, we …nd that
log Bdrift, no drift = 126:1331 + log p

+ log p ( ) :

This expression shows a potential problem of Bayes factors: by picking uniform priors for
and

spread out over a su¢ ciently large interval, we could overcome any di¤erence in

…t. But the prior for

is pinned down by our desire to keep that process stationary, which

imposes natural bounds in [ 1; 1] and makes log p

=

0:6931. Thus, there is only one

degree of freedom left: our choice of log p ( ).
Any sensible prior for

will only put mass in a relatively small interval: the point

estimate is 0:1479, the standard deviation is 0:002, and the likelihood is numerically zero for
values bigger than 0.2. Hence, we can safely impose that log p ( ) >

1 (log p ( ) =

1

would imply a uniform prior between 0 and 2:7183, a considerably wider support than any
evidence in the data) and conclude that log Bdrift, no drift > 124:4400. This is conventionally
considered overwhelming evidence in favor of the model with parameter drift (Je¤reys, 1961,
for instance, suggests that di¤erences bigger than 5 are decisive).8 Thus, even after controlling
for stochastic volatility, the data strongly prefer a speci…cation of the model where monetary
policy has changed over time. This …nding, however, does not imply that volatility shocks
8

An alternative way to see this is that, to overcome the evidence in the data as recorded by the di¤erence
in loglikelihoods, log p ( ) should be de…ned between 0 and 3:0054e + 054, clearly an absurd proposition.

35

did not play an important role in the great moderation. In fact, as we will see in section 10,
they were a key mechanism to account for it.
It has been noted that the estimation of log MDDs is dangerous because of numerical
instabilities in the evaluation of the integral (12). This concern is particularly relevant in our
case, since we have a large model saddled with a burdensome computation. As a robustness
analysis, we also computed the Bayesian Information Criterion (BIC) (Schwarz, 1978). The
BIC, which avoids the need to handle the integral in (12), can be understood as an asymptotic approximation of the Bayes factor that also automatically penalizes for unneeded free
parameters. The BIC of model i is de…ned:
BICi =

2 ln p YT = Ydata;T ; b; i + ki ln n

where b is the maximum likelihood estimator (or, in our case given our ‡at priors, the mode
of the posterior), ki is the number of parameters, and n is the number of observations. Then,

the BIC of the model with stochastic volatility and parameter drifting is:
BICdrift =

2 3885 + 28 ln 192 =

If we eliminate parameter drifting and the parameters

7; 622:8

and

associated with it (and, of

course, with a new point estimate of the other parameters):
BICno drift =

2 3810:7 + 26 ln 192 =

7; 484:7

The di¤erence is, therefore, of over 138 log points, which is again overwhelming evidence in
favor of the model with parameter drifting.
The comparison with the case without stochastic volatility is more di¢ cult, since we
are taking advantage of its presence to evaluate the likelihood. Fortunately, Justiniano and
Primiceri (2008) and Fernández-Villaverde and Rubio-Ramírez (2007) estimate models similar to ours with and without stochastic volatility (in the …rst case, using only a …rst-order
approximation to the decision rules of the agents and in the second with measurement errors).
Both papers …nd that the …t of the model improves substantially when we include stochastic
volatility. Finally, Fernández-Villaverde and Rubio-Ramírez (2008) compare a model with
parameter drifting and no stochastic volatility with a model without parameter drifting and
no stochastic volatility and report that parameter drifting is also strongly preferred by the
likelihood. These …ndings corroborate the evidence of the importance of changes in volatility
gathered by Sims and Zha (2006) using an SVAR perspective.

36

9. Smoothed Shocks
We present now the smoothed estimates of the structural shocks, volatility shocks, and drifting
parameters of the model. Figure 9.1 reports the log-deviations with respect to their means
for the intertemporal, intratemporal, and monetary shocks and deviations of the growth rate
of the investment and technological shocks with respect to their means. To ease reading of
the results, we color di¤erent vertical bars to represent each of the periods at the Federal
Reserve: the McChesney Martin years from the start of our sample in 1959 to the appointment
of Burns in February 1970 (white), the Burns-Miller era (light blue), the Volcker interlude
from August 1979 to August 1987 (grey), the Greenspan times (orange), and Bernanke’s
tenure from February 2006 (yellow).
We see in the top left panel of …gure 9.1 that the intertemporal shock, dbt ; is particularly

high in the 1970s. This increases households’desire for current consumption (for instance,

because of the entrance of baby boomers into adulthood). A higher aggregate demand trig-

gers, in the model, the higher in‡ation observed in the data for those years and generates
challenges for the monetary authority that we will discuss below. The shock has a dramatic
drop in the second quarter of 1980. This is precisely the quarter where the Carter administration invoked the Credit Control Act (started on March 14, 1980). Schreft (1990) documents
that this measure caused turmoil in …nancial markets and, most likely, distorted intertemporal choices of households, which is re‡ected in the large negative innovation to dbt . The low
values of dbt in the 1990s with respect to the 1970s and 1980s eased the in‡ationary pressures
in the economy.

The shock to the utility of leisure, '
b t , grows in the 1970s and falls in the 1980s to stabilize

at a very low value in the 1990s. The likelihood wants to track, in this way, the path of
average hours worked: low in the 1970s, increasing in the 1980s, and stabilizing in the 1990s.
Higher hours also lower the marginal cost of …rms (wages fall relative to the technological

level). The reduction in marginal costs also helped to reduce in‡ation during Greenspan’s
tenure.
t
, shows a clear drop after 1973
The evolution of the investment-speci…c technology, d
t 1

(when it is likely that energy-intensive capital goods su¤ered the consequences of the oil shocks

in the form of economic obsolescence) and very positive realizations in the late 1990s (our
model interprets the sustained boom of those years as the consequence of strong improvements
in investment technology). These positive realizations were an additional help to contain
At
in‡ation during those years. In comparison, the neutral-technology shocks, d
, have been
At

stable since 1959, with only a few big shocks at the end of the sample.

37

1

Figure 9.1: Smoothed intertemporal demand (dbt ) shock, intratemporal demand (bt ) shock,
At
t
investment-speci…c ( d
) shock, technology ( d
) shock, and monetary policy (b ) shock.
t 1

At

1

t

The evolution of the monetary policy shock, bt , reveals large innovations the early 1980s.

This is due both to the fast change in policy brought about by Volcker in and to the fact
that a Taylor rule might not fully capture the dynamics of monetary policy during a period
in which money growth targeting was attempted. Sims and Zha (2006) also …nd that the
Volcker period appears to be one with large disturbances to the policy rule and argue that
the Taylor rule formalism can be a misleading perspective from which to view policy during
that time. Our evidence from the estimated intertemporal, intratemporal, and investment
shocks suggests that monetary authorities faced a more di¢ cult environment in the 1970s
and early 1980s than in the 1990s.
38

As a way to gauge the level of uncertainty of our smoothed estimates, we plot in …gure
9.2 the same shock plus/minus two standard deviations. The lesson to take away from this
…gure is that, in all cases, the data are informative about the history we just narrated.

Figure 9.2: Smoothed intertemporal demand (dbt ) shock, intratemporal demand (bt ) shock,
At
t
) shock, and monetary policy (b ) shock
investment-speci…c ( d
) shock, technology ( d
t 1

At

1

t

+/- 2 Standard Deviations.

We move now, in …gure 9.3, to plot the evolution of the standard deviation of the innovation of the structural shocks, all of them in log-deviations with respect to their estimated
means. We see in this …gure that the standard deviation of the intertemporal shock was
particularly high in the 1970s and only slowly went down during the 1980s and early 1990s.
39

By the end of the sample, the standard deviation of the intertemporal shock was roughly at
the level where it started. In comparison, the standard deviation of all the other shocks is
relatively stable except, perhaps, for the big drop in the standard deviation of the monetary
policy shock in the early 1980s and the big changes in the standard deviation of the investment shock during the period of oil price shocks. Hence, the 1970s and the 1980s were more
volatile than the 1960s and the 1990s, creating a tougher environment for monetary policy.
This result also con…rms Blanchard and Simon’s (2001) observation that volatility had a
downward trend in the 20th century with an abrupt and temporal increase in the 1970s.

Figure 9.3: Smoothed standard deviation shocks to the intertemporal demand (bdt ) shock,
the intratemporal demand (b t ) shock, the investment-speci…c (b t ) shock, the technology
(bAt ) shock, and the monetary policy (bmt ) shock.

40

In …gure 9.4, we plot the same results except that now we add two standard deviations to
assess posterior uncertainty. Again, the lesson from this …gure is that the big movements in
the di¤erent series that we report can be ascertained with a reasonable degree of con…dence.

Figure 9.4: Smoothed standard deviation shocks to the intertemporal demand (bdt ) shock,
the intratemporal demand (b t ) shock, the investment-speci…c (b t ) shock, the technology
(bAt ) shock, and the monetary policy (bmt ) shock +/- 2 standard deviations.

Finally, in …gure 9.5, we plot the evolution of the response of monetary policy to in‡ation
plus/minus a two-standard-deviation interval. Figure 9.5 shows us an intriguing narrative.
The parameter

t

started the sample around its estimated mean, slightly over 1, and it grew

more or less steadily during the 1960s until reaching a peak in early 1968. After that year,
41

t

su¤ered a fast collapse that took it below 1 in 1971. To put this evolution in perspective, it
is useful to remember that Burns was appointed chairman in February 1970. The parameter
stayed below 1 for all of the 1970s, showing either that monetary policy did not satisfy the
Taylor principle or that our postulated monetary policy rule is not a good description of the
behavior of the Fed at the time (for example, because the Fed was using real-time data to
make its decisions; see Orphanides, 2002).

Figure 9.5: Smoothed path for the Taylor rule parameter on in‡ation +/- 2 standard
deviations.

The arrival of Volcker is quickly picked up by our smoothed estimates:

t

increases to over

2 after a few months and stays high during all the years of Volcker’s tenure. Interestingly, our
42

estimate captures well the observation by Goodfriend and King (2007) that monetary policy
tightened in the spring of 1980 as in‡ation and long-run in‡ation expectations continued to
grow. The level of

t

stayed roughly constant at this high during the remainder of Volcker’s

tenure.
But as quickly as

t

rose when Volcker arrived, it went down again when he departed.

Greenspan’s tenure at the Fed meant that, by 1990, the response of the monetary authority
to in‡ation was again below 1. During all the following years,

t

was low, probably even

below the values that it took during Burns-Miller’s time. Moreover, our estimates of

t

are relatively tight, suggesting that posterior uncertainty may not be the full explanation
behind these movements. But if monetary policy in the 1970s was similar to policy in the
1990s, how can our model account for the di¤erent economic performance between the two
decades? While our smoothed shocks already hint at the reason (the 1990s were characterized
by favorable shocks and low volatility, compared with either Burns-Miller’s or Volcker’s time),
to satisfactorily answer this question, in the next section we build counterfactual histories.

10. Historical Counterfactuals
One important goal of our research is to quantify how much of the observed changes in the
volatility of aggregate variables can be accounted for by changes in the standard deviations
of shocks and how much by changes in policy. To accomplish this, we build a number of
historical counterfactuals. These are internally coherent exercises in which we remove one
source of variation at a time and we measure how aggregate variables would have behaved
when hit only by the remaining shocks. Since our model is structural in the sense of Hurwicz
(1962) (it is invariant to interventions, including shocks by nature such as the ones we are
postulating), we will obtain an answer that is robust to the Lucas critique.
In the next two subsections, we will always plot the same three basic variables that we used
in Section 7: in‡ation, output growth, and the federal funds rate. Counterfactual histories
of other variables could be built analogously. Also, we will have vertical bars for the tenure
of each chairman, following the same color scheme as in Section 9.
10.1. Counterfactual I: No Volatility Changes
In our …rst historical counterfactual, we compute how the economy would have behaved in the
absence of changes in the volatility of the shocks, that is, if the volatility of the innovation
of the structural shocks had been …xed at its historical mean. We can think about this
exercise as measuring the e¤ect of virtue by eliminating fortune. To do so, we back up the
smoothed structural shocks as we did in section 9 and we feed them to the model, given
43

our parameter point estimates and the historical mean of volatility, to generate series for
in‡ation, output, and the federal funds rate. We present our …ndings in two steps. First, we
discuss several moments of the data and the counterfactuals. Second, we compare the paths
of our counterfactual histories over time with the observed data.
10.1.1. Moments
Table 10.1 reports the moments of the data (in annualized terms) and the moments from the
counterfactual history (no s.v. in the table stands for “no stochastic volatility”). In both
cases, we include the moments for the whole sample and for the sample divided before and
after 1984.Q1, a conventional date for the start of the great moderation (McConnell and
Pérez-Quirós, 2000). In the last two rows of the table, we compute the ratio of the moments
after 1984.Q1 over the moments before 1984.Q1.9

Table 10.1: No Volatility Changes, Data versus Counterfactual History
Means
Output

In‡ation

Growth

Standard Deviations
FFR

In‡ation

Output
Growth

FFR

Data

3.8170

1.8475

6.0021

2.6181

3.5879

3.3004

Data, pre 1984.1

4.6180

1.9943

6.7179

3.2260

4.3995

3.8665

Data, after 1984.1

2.9644

1.6911

5.2401

1.3113

2.4616

2.3560

No s.v.

2.5995

0.7169

6.9388

3.5534

3.1735

2.4128

No s.v., pre-1984.1

2.0515

0.9539

6.3076

3.7365

3.4120

2.7538

No s.v., after-1984.1

3.1828

0.4647

7.6106

3.2672

2.8954

1.7673

Data, post-1984.1/pre-1984.1

0.6419

0.8480

0.7800

0.4065

0.5595

0.6093

No s.v., post-1984.1/pre-1984.1

1.5515

0.4871

1.2066

0.8744

0.8486

0.6418

Some of the numbers in table 10.1 are well known. For instance, after 1984, the standard
deviation of in‡ation falls by nearly 60 percent, the standard deviation of output growth falls
by 44 percent, and the standard deviation of federal funds rate falls by 39 percent. In terms
of means, after 1984, there is less in‡ation and the federal funds rate is lower, but output
growth is also 15 percent lower.
More novel are the numbers that come from our counterfactual. Without changes in
volatility, the great moderation would have been noticeably smaller. The standard deviation
9

The benchmark model with stochastic volatility plus parameter drifting replicates the data exactly. Hence,
there is no need to report the volatility results from the model in table 10.1.

44

of in‡ation would have fallen by only 13 percent, the standard deviation of output growth
would have fallen by 16 percent, and the standard deviation of the federal funds rate would
have fallen by 35 percent, that is, only 33, 20, and 87 percent, respectively, of how much they
would have fallen otherwise.10
Table 10.1 documents the second main …nding of the paper: without changes in the
standard deviations of the innovation of the structural shocks, the great moderation would
not have been nearly as big as we observed in the data. How do we reconcile these …ndings
with the …ndings in section 8? While there is strong evidence of changes in the systematic
component of monetary policy, they can account for only a fraction of the great moderation
observed after 1984. In other words: according to our estimated model, monetary policy
has a relatively small role in a¤ecting aggregate outcomes besides in‡ation. Also, without
stochastic volatility, output growth would have been quite lower on average. As we will see
in the next section, this would have had important consequences for the performance of the
economy during the last 15 years of our sample.
10.1.2. Counterfactual Paths
To further illustrate the previous results, …gure 10.1 compares the whole path of the counterfactual history (blue line) with the observed one (red line). Figure 10.1 tells us that volatility
shocks mattered all across the sample. The run-up for in‡ation would have been much slower
in the late 1960s (in‡ation would have actually been negative during the last years of Martin’s tenure) with small e¤ects on output growth or the federal funds rate (except at the very
end of the sample). In‡ation would not have picked up as nearly as much during the …rst
oil shock, but output growth would have su¤ered. During Volcker’s time, in‡ation would
also have fallen faster with little cost to output growth. These are indications that both
Burns-Miller and Volcker su¤ered from large and volatile shocks to the economy.
In comparison, during the 1990s, in‡ation would have been more volatile, with a big
increase in the middle of the decade. Similarly, during those years, output growth would
have been much lower, with a long recession between 1994 and 1998, and the federal funds
rate would have been prominently higher. Con…rming the results presented in section 9, this
is yet another manifestation of how placid the 1990s were for policymakers.
10

We must resist here the temptation of undertaking a standard variance decomposition exercise. Since we
have a second-order approximation to the policy function and its associated cross-product terms, we cannot
neatly divide total variance among the di¤erent shocks as we could do in the linear case.

45

Figure 10.1: Counterfactual history with no changes in volatility.

46

10.2. Counterfactual II: Switching Chairmen
In our second counterfactual we move one chairman from his mandate to an alternative time
period. For example, we appoint Greenspan as chairman during the Burns-Miller years. By
that, we mean that the monetary authority would have followed the policy rule dictated by
the average

t

that we estimated during Greenspan’s time while starting from the same

states as Burns-Miller and su¤ering the same shocks (both structural and of volatility). We
repeat this exercise with all the other possible combinations: Volcker in the Burns-Miller
decade, Burns-Miller in Volcker’s mandate, Greenspan in Volcker’s time, Burns-Miller in the
Greenspan years, and, …nally, Volcker in Greenspan’s time.
It is important to be careful in interpreting this exercise. By appointing Greenspan at
Volcker’s time, we do not literally mean Greenspan as a person, but Greenspan as a convenient
label for a particular monetary policy response to shocks that according to our model were
observed during his tenure. The real Greenspan could have behaved in a di¤erent way, for
example, as a result of some non-linearities in monetary policy that are not properly captured
by a simple rule as the one we postulated in section 2. In fact, the argument could be pushed
one step further and we could think about the appointment of Volcker as an endogenous
response of the political-economic equilibrium to high in‡ation.11
Another issue that we sidelined is the evolution of expectations. In our model, agents
have rational expectations and observe the changes in monetary policy parameters. This
hypothesis may be a poor approximation of the agents’behavior in real life. It could be the
case that

t

was high in 1984, even though in‡ation was already low by that time, because

of the high in‡ationary expectations that economic agents held during most of the 1980s (this
point is also linked to issues of commitment and credibility that our model does not address).
While we see all these arguments as interesting lines of research, we …nd it important to
focus …rst on our basic counterfactual conditional. As before, in the next two subsections,
we explore …rst the moments of the counterfactual and later we plot the whole paths.
10.2.1. Moments
In table 10.2, we report the mean and the standard deviation of in‡ation, output growth, and
the federal funds rate in the observed data and in the six counterfactual ones. The means of
the observed data present us with a history similar to that in table 10.1. In‡ation was high
with Burns-Miller, fell with Volcker, and stayed low with Greenspan. Output growth went
11

In our model agents have a probability distribution regarding possible changes of monetary policy in
the next periods, but those changes are uncorrelated with current conditions. Therefore, our model cannot
capture the endogeneity of policy selection.

47

down during the Volcker years to recover with Greenspan. The federal funds rate reached its
peak with Volcker. The standard deviation of the observed data tells us yet one more time
about the great moderation: from a standard deviation of output growth of 4.7 in BurnsMiller’s time, we went to a standard deviation of 2.45 with Greenspan, a cut in half. Similarly,
in‡ation volatility fell nearly 54 percent and the federal funds rate volatility 5 percent.

Table 10.2: Switching Chairmen, Data versus Counterfactual Histories
Means
In‡ation Output Gr.

Standard Deviations
FFR

In‡ation Output Gr.

FFR

BM (data)

6.2333

2.0322

6.5764

2.7347

4.7010

2.2720

Greenspan to BM

6.8269

1.8881

6.5046

3.3732

4.6781

2.0103

Volcker to BM

4.3604

1.5010

7.6479

2.4620

4.6219

2.3470

Volcker (data)

5.3584

1.3846

10.3338

3.1811

4.4811

3.4995

BM to Volcker

6.4132

1.3560

10.4126

2.9728

4.4220

3.0648

Greenspan to Volcker

6.7284

1.3423

10.4235

2.9824

4.3730

2.8734

Greenspan (data)

2.9583

1.5177

4.7352

1.2675

2.4567

2.1887

BM to Greenspan

2.3355

1.5277

4.4529

1.5625

2.4684

2.4652

Volcker to Greenspan

-0.4947

1.3751

3.6560

1.7700

2.4705

2.7619

But table 10.2 also tells us other things. Contrary to the conventional wisdom, our
estimates suggest that the stand of monetary policy against in‡ation under Greenspan was
not particularly strong. In Burns-Miller’s time, the monetary policy under Greenspan would
have delivered slightly higher average in‡ation, 6.83 versus the observed 6.23, accompanied
by a slightly lower federal funds rate and lower output growth, 1.89 versus the observed 2.03.
The di¤erence is even bigger in Volcker’s time, during which average in‡ation would have
been nearly 1.4 percent higher, while output growth would have been virtually identical (1.34
versus 1.38). The key for this …nding is in the behavior of the federal funds rate, which would
have increased only by 9 basis points, on average, if Greenspan had been in charge of the
Fed instead of Volcker. Given the higher in‡ation in the counterfactual, the slightly higher
nominal interest rates would have implied much lower real rates.
The counterfactual of Burns-Miller in Greenspan’s and Volcker’s time casts doubts on
the malignant reputations of these two short-lived chairmen, at least when compared with
Greenspan. Burns-Miller would have brought even slightly lower in‡ation than Greenspan,
thanks to a higher real federal funds rate and a bit higher output growth. However, BurnsMiller would have delivered higher in‡ation than Volcker.
48

This is the third main empirical …nding of the paper: according to our estimates, Volcker’s
response to in‡ation was high. Greenspan’s response was milder. Instead, he was favored by
a long sequence of good shocks and low volatility. In fact, Greenspan seems to have behaved
quite similarly to how Burns-Miller would have behaved. This result will be con…rmed by
the counterfactual paths in the next subsection.
10.2.2. Counterfactual Paths
Our next exercise is to plot the whole counterfactual histories summarized in table 10.2. We
…nd it interesting to plot the whole history because changes in the economy’s behavior in one
period will propagate over time and we want to understand, for example, how Greenspan’s
legacy would have molded Volcker’s tenure. Also, plotting the whole history allows us to
track the counterfactual response of monetary policy to large economic events such as the oil
shocks.
Our …rst plot is …gure 10.2, where we put Greenspan in Burns-Miller’s time. The pick
up in in‡ation after the …rst oil shock of 1973 would have been even higher. This would
have been caused by a lower federal funds rate, which, coupled with faster price increases,
would have turned out to yield a much lower real interest rate. Greenspan would have left
Volcker with approximately the same legacy as Burns-Miller. We can see this from how
close the counterfactual history was during Volcker’s mandate (where, remember, Volcker is
responding to in‡ation as our estimates indicate he did in the data but where he is facing
the states of the economy left by Greenspan, not the ones left by Burns-Miller).
In …gure 10.3, we repeat the same exercise for Greenspan during Volcker’s time. The main
di¤erence is that, in our counterfactual history, Greenspan would have disin‡ated more slowly
than Volcker did. Moreover, the disin‡ation would have lasted longer, well into the 1990s.
As we saw before, this slower disin‡ation would not have had increased output growth. In
terms of nominal interest rates, those would have been lower at the beginning of the 1980s,
re‡ecting a softer stand against in‡ation, but higher in the late 1980s because of the higher
in‡ation during those years.

49

Figure 10.2: Greenspan during the Burns-Miller years

50

Figure 10.3: Greenspan during the Volcker years

In …gure 10.4, we move to Burns-Miller being reappointed in Greenspan’s time. The …rst
thing we see is that in‡ation would have been lower with Burns-Miller than it was in the
data, while output growth would have been nearly identical. Also, the federal funds rate
would have been a bit lower due to lower in‡ation. This is yet another piece of evidence
that the di¤erences in monetary policy under Greenspan’s and Burns-Miller may have been
overstated by the literature.

51

Figure 10.4: Burns-Miller during the Greenspan years

In …gure 10.5, we plot the counterfactual of Burns-Miller extending their tenure to 1987.
The results are very similar to the case in which we move Greenspan to the same period:
slower disin‡ation and no improvement in output growth.

52

Figure 10.5: Burns-Miller during the Volcker years

A particularly interesting exercise is to check what would have happened if Reagan had
decided to reappoint Volcker and not Greenspan. We plot these results in …gure 10.6. The
quick answer is: lower in‡ation and interest rates. Our estimates also suggest that Volcker
would have reduced price increases with little cost to output. In fact, the di¤erence in output
growth is mainly caused by the period 2004-2007. Without those years, output growth under
Volcker would have been higher than under Greenspan.

53

Figure 10.6: Volcker during the Greenspan years

This exercise has the problem that, according to the estimated policy rule, during 20042005, the Federal Reserve should have implemented a negative federal funds rate. Forgetting
for a moment the practicality of schemes to push the nominal interest rate below zero, this
evidence points out that an extension of the model should take the zero-lower bound on
interest rates seriously. This, however, would preclude us from using a perturbation method
and, given the current computational frontier, make it impossible to estimate such a model.
54

Figure 10.7: Volcker during the Burns-Miller years
Our …nal exercise is to plot, in …gure 10.7, the counterfactual in which we move Volcker
to the time of Burns-Miller. The main …nding is that in‡ation would have been rather lower
especially because the e¤ects of the second oil shock would have been much more muted.
This counterfactual is plausible: other countries, such as Germany, Switzerland, and Japan,
that undertook a more aggressive monetary policy during the late 1970s were able to keep
in‡ation under control at levels below 5 percent at an annual rate, while the U.S. had peaks
of price increases over 10 percent.
55

11. Conclusion
In this paper, we have built and estimated a non-linear DSGE model with both stochastic
volatility in the structural shocks that drive the economy and parameter drifting in the
monetary policy rule. We have shown how such a rich model can be successfully taken to the
data by using our characterization of a second-order approximation of the decision rules of a
large class of DSGE models. We can see many future applications for these tools in all those
situations in which being explicit about heteroscedastic shocks is crucial (see, among others,
Bloom, Jaimovich, and Floetotto, 2008, or Fernández-Villaverde et al., 2009).
With respect to our main empirical …ndings, a simple way to summarize them is to think
about the recent monetary history of the U.S. as being characterized by three eras:
1. An era of small responses to in‡ation and large and volatile structural shocks: Burns
and Miller, 1970-1979.
2. An era of large responses to in‡ation and large and volatile structural shocks: Volcker,
1979-1987.
3. An era of small responses to in‡ation and small and positive structural shocks: Greenspan,
1987-2006.
Like all empirical work, our approach su¤ers from several shortcomings, many of which
we have discussed in the main body of the paper. The most important, in our opinion, is the
limitation of how much we can learn from the data given our relatively short sample. In fact,
we are reluctant to estimate even more complicated versions of our model precisely because
of these limits of aggregate time series. A source of information that can complement our
quantitative investigation is a historical narrative based on the Federal Reserve statements
and documents. We have in mind the type of work pioneered by Romer and Romer (2004)
or Hetzel (2008). If the changes in policy uncovered by our estimates did, in fact, occur,
we should …nd telltale signs of them in the written record. We undertake this exercise
in Fernández-Villaverde, Guerrón-Quintana, and Rubio-Ramírez (2010), where we use our
estimates to read the recent monetary history of the U.S.

56

12. Appendix A: Theorem 1
Let us now prove theorem 1. In this theorem, we characterize the …rst- and second-order
derivatives of the functions h ( ) and g ( ) evaluated at the non-stochastic steady state. We
…rst show that the …rst partial derivatives of h ( ) and g ( ) with respect to any component
of

t 1,

Ut , or

evaluated at the non-stochastic steady state is zero (or, in other words,

that the the …rst order of the solution does not depend on volatility levels or shocks nor on
the perturbation parameter). Second, it shows that, among many other results, the second
partial derivative of h ( ) and g ( ) with respect to uj;t and any other state variable but "j;t is
also zero for any j = f1; : : : ; mg.

Before proceeding, note that we can write Zt as a function of Zt 1 ;
Zt = & (Zt 1 ;

and that

t 1 ; Et ;

and Ut :

t 1 ; Et ; Ut )

can be expressed as:

t

t

where # and

are both m

=#

t 1

+ Ut

m diagonal matrices with diagonal elements equal to #i and

i

respectively. If we substitute the two functions (9) and (10) into (8) we get that:

0

B
Et f @

F (St ; Zt 1 ;
g (h (St ; Zt 1 ;

t 1 ; Et ; U t ;

g (St ; Zt 1 ;

) ; & (Zt 1 ;

t 1 ; Et ; Ut ;

t 1 ; Et ; Ut ) ; #

& (& (Zt 1 ;

t 1 ; Et ; U t ;

t 1

)

t 1 ; Et ; U t ) ; #

) ; h (St ; Zt 1 ;

t 1

+ Ut ; Et+1 ; Ut+1 ; ) ;

t 1 ; Et ; Ut ;

) ; St ;

+ Ut ; Et+1 ; Ut+1 ) ; & (Zt 1 ;

t 1 ; Et ; U t )

1

C
A = 0:

To ease reading, we divide the proof into four parts, the …rst dealing with the …rst derivatives
and the next three dealing with the second derivatives.
Proof, part 1.

The …rst part of the proof deals with the …rst derivatives of (9) and

(10) that are equal to zero. In particular, we want to show that:
h

t 1

i1
j

= g

t 1

i2
j

= [hUt ]ij1 = [gUt ]ij2 = [h ]i1 = [g ]i2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.

We show this result in three steps that basically repeat the same argument based on

homogeneity of a system of linear equations:
1. We can write the derivative of the i

th element of F with respect to the j

57

th element

of
F

t 1

t 1

as:
i
j

= fYt+1

i
i2

[gSt ]ii21 h

t 1

i1
j

+ g

i2
j

t 1

#j +[fYt ]ii2 g

t 1

i2
+
j

fSt+1

i
i1

h

t 1

i1
j

=0

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. This is a homogeneous system on
h

t 1

i1
j

and g

t 1

i2
j

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg. Thus:
h

i1
j

t 1

= g

t 1

i2
j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
2. We can write the derivative of the i

th element of F with respect to the j

th element

of Ut as:
[FUt ]ij = fYt+1

i
i2

[gSt ]ii21 [hUt ]ij1 + g

t 1

i2
j

j

+ [fYt ]ii2 [gUt ]ij2 + fSt+1

i
i1

[hUt ]ij1 = 0

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. Since we have already shown that
g

t 1

i2
j

= 0 for i2 2 f1; : : : ; kg and j 2 f1; : : : ; mg, this is a homogeneous system on

[hUt ]ij1 and [gUt ]ij2 for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg, Thus:
[hUt ]ij1 = [gUt ]ij2 = 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
3. Finally, we can write the derivative of the i
[F ]i = fYt+1

i
i2

th element of F with respect to

[gSt ]ii21 [h ]i1 + [g ]i2 + [fYt ]ii2 [g ]i2 + fSt+1

i
i1

as:

[h ]i1 = 0

for i 2 f1; : : : ; k + n + mg. Since this is a homogeneous system on [h ]i1 and [g ]i2 for

i1 2 f1; : : : ; ng and i2 2 f1; : : : ; kg, we have that:

[h ]i1 = [g ]i2 = 0
for i1 2 f1; : : : ; ng and i2 2 f1; : : : ; kg.
Proof, part 2. The second part of the proof deals with the cross-derivatives of (9) and
(10) with respect to

and any of St , Zt 1 ,

t 1,

58

Et , or Ut and it shows that all of them are

equal to zero. In particular, we want to show that:
[h

i1
;St ]j

i2
;St ]j

= [g

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; ng and:
h

;Zt

1

i1
j

= g

;Zt

i2
j

1

= h

;

t 1

i1
j

= g

;

t 1

i2
j

i1
;Et ]j

= [h

= [g

i2
;Et ]j

= [h

i1
;Ut ]j

i2
;Ut ]j

= [g

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.

We show this result in …ve steps that, as in part 1 of the proof, exploit the homogeneity of

a system of linear equations (and where we have already taken advantage of the terms that
we know from part 1 of the proof that they are equal to zero and eliminate them from our
expressions):
1. We consider the cross-derivative of the i
j
[F

th element of F with respect to

and the

th element of St :
i
;St ]j

= fYt+1

i
i2

[gSt ]ii21 [h

i1
;St ]j

+ [g

i2
;St ]i1

[hSt ]ij1 +[fYt ]ii2 [g

i2
;St ]j +

fSt+1

i
i1

i1
;St ]j

[h

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; ng. This is a homogeneous system on [h

and [g

i2
;St ]j

=0

i1
;St ]j

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; ng. Thus:
[h

i1
;St ]j

= [g

i2
;St ]j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; ng.
2. We consider the cross-derivative of the i
j

th element of F with respect to

and the

th element of Zt 1 :
F

;Zt

1

i
j

= fYt+1

i
i2

[gSt ]ii21 h

+ [fYt ]ii2 g

;Zt

1

;Zt
i2
j

1

i1
j

+ [g

+ fSt+1

i
i1

i2
;St ]i1

h

hZt

;Zt

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. Since [g

1

i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg. Hence:
;Zt

1

i1
j

= g

;Zt

1

i2
j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
59

i1
j

+

j

g

;Zt

1

i2
j

=0

i2
;St ]j

and j 2 f1; : : : ; ng, this is a homogeneous system on h

h

i1
j

1

;Zt

= 0 for i2 2 f1; : : : ; kg
1

i1
j

and g

;Zt

1

i2
j

for

3. We consider the cross-derivative of the i
th element of

j

F

th element of F with respect to

and the

t 1:

;

t 1

i
j

i
i2

= fYt+1

+ [fYt ]ii2 g

;

t 1

[gSt ]ii21 h
i2
j

;

+ fSt+1

i1
j

t 1

i
i1

h

+ g
;

;
i1
j

t 1

i2
j

t 1

#j

=0

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. This is a homogeneous system on
h

;

i1
j

t 1

and g

;

i2
j

t 1

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.

Hence:

h

;

i1
j

t 1

= g

;

i2
j

t 1

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
4. We consider the cross-derivative of the i
j

th element of F with respect to

and the

th element of Et :
[F

i
;Et ]j

= fYt+1

i
i2

[gSt ]ii21 [h

i1
;Et ]j

+ [g

i2
;St ]i1

+ [fYt ]ii2 [g

i2
;Et ]j

+ fSt+1

[hEt ]ij1 + exp#j

i
i1

[h

i1
;Et ]j

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. Since g
and j 2 f1; : : : ; mg and [g

homogeneous system on [h

i2
;St ]j
i1
;Et ]j

j 2 f1; : : : ; mg. Thus:

j;t 1

g

;Zt

1

i2
j

=0

;Zt

1

i2
j

= 0 for i2 2 f1; : : : ; kg

= 0 for i2 2 f1; : : : ; kg and j 2 f1; : : : ; ng, this is a
and [g

i2
;Et ]j

i1
;Et ]j

= [g

[h

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and

i2
;Et ]j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
5. We consider the cross-derivative of the i
j
[F

th element of F with respect to

and the

th element of Ut :
i
;Ut ]j

= fYt+1

i
i2

[gSt ]ii21 [h

i1
;Ut ]j

+

g

j

;

t 1

i2
j

+[fYt ]ii2 [g

i2
;Ut ]j +

fSt+1

i
i1

for i 2 f1; : : : ; k + n + mg and j 2 f1; : : : ; mg. Since we have shown that g

[h
;

i1
;Ut ]j

t 1

i2
j

=0
=0

for i2 2 f1; : : : ; kg and j 2 f1; : : : ; mg ; we have that the above system is a homogeneous
system on [h
Then:

i1
;Ut ]j

and [g

i2
;Ut ]j

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
[h

i1
;Ut ]j

= [g

i2
;Ut ]j

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j 2 f1; : : : ; mg.
60

The third part of the proof deals with the cross-derivatives of (9) and

Proof, part 3.
(10) with respect to

t 1

and any of St , Zt 1 ,

t 1,

or Et and it shows that all of them are

equal to zero with one exception. In particular, we want to show that:
hSt ;

t 1

i1
j1 ;j2

= gSt ;

t 1

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg,
hZt

1;

t 1

i1
j1 ;j2

= gZt

1;

t 1

i2
j1 ;j2

= h

t 1;

t 1

i1
j1 ;j2

= g

t 1;

t 1

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg, and
hEt ;

t 1

i1
j1 ;j2

= gEt ;

t 1

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg if j1 6= j2 .

We show this result in four steps (and where we have already taken advantage of the

terms that we know from part 1 of the proof are equal to zero and eliminate them from our
expressions):
1. We consider the cross-derivative of the i
element of St and the j2
F St ;

t 1

i
j1 ;j2

th element of F with respect to the j1

th element of

= fYt+1

i
i2

+ [fYt ]ii2 gSt ;

t 1:

[gSt ]ii21 hSt ;
t 1

i2
j1 ;j2

th

t 1

+ fSt+1

i1
j1 ;j2
i
i1

+ gSt ;

hSt ;

t 1

t 1

i1
j1 ;j2

i2
i1 ;j2

[hSt ]ij11 #j2

=0

for i 2 f1; : : : ; k + n + mg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg. This is a homogeneous
system on hSt ;

t 1

i1
j1 ;j2

and gSt ;

t 1

i2
j1 ;j2

f1; : : : ; ng, and j2 2 f1; : : : ; mg. Therefore:
hSt ;

t 1

i1
j1 ;j2

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2

= gSt ;

t 1

i2
i2 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg.
2. We consider the cross-derivative of the i

61

th element of F with respect to the j1

th

element of Zt

1

and the j2

th element of
F Zt

= fYt+1

i
i2

[gSt ]ii21 hZt

1;

i1
j1 ;j2

t 1

+ [fYt ]ii2 gZt

1;

1;

+ g St ;
i2
j1 ;j2

t 1

t 1:
i
j1 ;j2

t 1

i2
i1 ;j2

t 1

+ fSt+1

hZt
i
i1

1

hZt

i1
j1

#j2 + gZt

1;

t 1

i1
j1 ;j2

1;

t 1

i2
j1 ;j2

#j2

j1

=0

for i 2 f1; : : : ; k + n + mg, and j1 ; j2 2 f1; : : : ; mg. Since we just found that gSt ;

t 1

i2
j1 ;j2

0 for i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg, this is a homogeneous system on hZt

1;

t 1

i1
j1 ;j2

and gZt

1;

i2
i2 ;j2

t 1

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and

j1 ; j2 2 f1; : : : ; mg. Therefore:
hZt

1;

t 1

i1
j1 ;j2

= gZt

1;

t 1

i2
i2 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg.
3. We consider the cross-derivative of the i
element of

t 1

and the j2

th element of
F

i
i2

fYt+1

th element of F with respect to the j1

[gSt ]ii21 h

+ [fYt ]ii2 g

t 1;

t 1;

t 1

t 1;

i2
j1 ;j2

t 1:
i
j1 ;j2

t 1

t 1

th

i1
j1 ;j2

=

+ g

+ fSt+1

i
i1

t 1;

h

i2
j1 ;j2

t 1

t 1;

#j1 #j2

i1
j1 ;j2

t 1

=0

for i 2 f1; : : : ; k + n + mg and j1 ; j2 2 f1; : : : ; mg. This is a homogeneous system on
h

t 1;

t 1

i1
j1 ;j2

and g

t 1;

t 1

i2
j1 ;j2

f1; : : : ; mg, therefore:
h

t 1;

t 1

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2
i1
j1 ;j2

= g

t 1;

t 1

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg.
4. We consider the cross-derivative of the i
element of Et and the j2

th element of
FEt ;

fYt+1

i
i2

[gSt ]ii21 hEt ;

t 1

th element of F with respect to the j1

i1
j1 ;j2

+ gSt ;

+ [fYt ]ii2 gEt ;

t 1

t 1

t 1

i2
i1 ;j2

t 1

i2
j1 ;j2

if j1 6= j2 :

i
j1 ;j2

=

[hEt ]ij11 #j2 + gZt

+ fSt+1

62

th

i
i1

hEt ;

t 1

1;

i1
j1 ;j2

t 1

i2
j1 ;j2

=0

exp#j1

j1 ;t 1

#j2

=

for i 2 f1; : : : ; k + n + mg and j1 ; j2 2 f1; : : : ; mg. Since we know that gZt
gSt ;

t 1

i2
j;j2

1;

t 1

i2
j1 ;j2

=

= 0 for i2 2 f1; : : : ; kg, j 2 f1; : : : ; ng, and j1 ; j2 2 f1; : : : ; mg, this

is a homogeneous system on hEt ;

i1
j1 ;j2

t 1

and gEt ;

t 1

i2
j1 ;j2

f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg if j1 6= j2 . Therefore:
hEt ;

t 1

i2
j1 ;j2

= gEt ;

t 1

i1
j1 ;j2

for i1 2 f1; : : : ; ng, i2 2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg if j1 6= j2 .
Note that if j1 = j2 , we have that:
FEt ;
[gSt ]ii21 hEt ;

t 1

i1
j1 ;j1

+ #j1 gSt ;

t 1

i2
i1 ;j1

+ [fYt ]ii2 gEt ;

t 1

+ [fZt ]ij1 +

j1

and since [fZt ]ij1 and fZt+1

i
j1

i
j1 ;j1

t 1

= fYt+1

[hEt ]ij11 +

i2
j1 ;j1

fZt+1

gZt
i
i1

+ fSt+1
i
j1

i
i2

exp#j1

1;

t 1

i2
j1 ;j1

+ gZt

1

i2
j1

exp#j1

j1 ;t 1

i1
j1 ;j1

hEt ;

t 1

j1 ;t 1

#j1 = 0

are di¤erent from zero in general for i 2 f1; : : : ; k + n + mg

and j1 2 f1; : : : ; mg ; we have that this system is not homogeneous and
hEt ;

t 1

i2
j1 ;j1

= gEt ;

t 1

i1
j1 ;j1

6= 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 2 f1; : : : ; mg.
Proof, part 4. The fourth, and …nal, part of the proof deals with the cross-derivatives
of (9) and (10) with respect to Ut and any of St , Zt 1 ,

t 1,

Et , or Ut and it shows that all of

them are equal to zero with one exception. In particular, we want to show that:
[hSt ;Ut ]ij11 ;j2 = [gSt ;Ut ]ij21 ;j2 = 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg,
hZt

1 ;Ut

i1
j1 ;j2

= gZt

1 ;Ut

i2
j1 ;j2

= h

t 1 ;Ut

i1
j1 ;j2

= g

t 1 ;Ut

i2
j1 ;j2

= [hUt ;Ut ]ij11 ;j2 = [gUt ;Ut ]ij21 ;j2 = 0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg, and
[hEt ;Ut ]ij11 ;j2 = [gEt ;Ut ]ij21 ;j2 = 0
63

#j1

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 ; j2 2 f1; : : : ; mg, and j1 6= j2 .

Again, we follow the same steps for each part of the result as before and use our previous

…ndings regarding which terms are zero.
1. We consider the cross derivative of the i
element of St and the j2

th element of F with respect to the j1

th

th element of Ut :
i
i2

[FSt ;Ut ]ij1 ;j2 = fYt+1

[gSt ]ii21 [hSt ;Ut ]ij11 ;j2 + gSt ;

+ [fYt ]ii2 [gSt ;Ut ]ij21 ;j2 + fSt+1

i
i1

t 1

i2
i1 ;j2

[hSt ]ij11

j2

[hSt ;Ut ]ij11 ;j2 = 0

for i 2 f1; : : : ; k + n + mg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg. Since gSt ;

t 1

i2
j1 ;j2

=0

for i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg, this is a homogeneous system
on [hSt ;Ut ]ij11 ;j2 and [gSt ;Ut ]ij21 ;j2 .Therefore:

[hSt ;Ut ]ij11 ;j2 = [gSt ;Ut ]ij21 ;j2 = 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 2 f1; : : : ; ng, and j2 2 f1; : : : ; mg.
2. We consider the cross-derivative of the i
element of Zt

1

and the j2

i
i2

[gSt ]ii21 hZt

th

th element of Ut :
F Zt

fYt+1

th element of F with respect to the j1

1 ;Ut

i1
j1 ;j2

+ [fYt ]ii1 gZt

+

1 ;Ut

1 ;Ut

g St ;

j2
i1
j1 ;j2

i
j1 ;j2
t 1

=

i2
i1 ;j2

+ fSt+1

i
i1

[hZt ]ij11 +
hZt

1 ;Ut

j1 j2
i1
j1 ;j2

for i 2 f1; : : : ; k + n + mg, and j1 ; j2 2 f1; : : : ; mg. Since gZt

1;

gZt

1;

t 1

i2
j1 ;j2

=0

t 1

i2
j1 ;j2

= gSt ;

t 1

i2
j;j2

0 for i2 2 f1; : : : ; kg, j 2 f1; : : : ; ng, and j1 ; j2 2 f1; : : : ; mg, this is a homogeneous
system on hZt

1 ;Ut

i1
j1 ;j2

and gZt

1 ;Ut

i1
j1 ;j2

j1 ; j2 2 f1; : : : ; mg. Therefore:
hZt

1 ;Ut

i1
j1 ;j2

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and

= gZt

1 ;Ut

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg.
3. We consider the cross-derivative of the i

64

th element of F with respect to the j1

th

=

element of

t 1

and the j2

th element of Ut :
F

fYt+1

i
i2

[gSt ]ii21 h

+ [fYt ]ii1 g

i1
j1 ;j2

t 1 ;Ut

i1
j1 ;j2

t 1 ;Ut

i
j1 ;j2

t 1 ;Ut

=

+ g

+ fSt+1

i
i1

t 1;

t 1

h

t 1 ;Ut

i2
j1 ;j2

#j1

i1
j1 ;j2

j2

=0

for i 2 f1; : : : ; k + n + mg, and j1 ; j2 2 f1; : : : ; mg. Since g

t 1;

t 1

i2
j1 ;j2

i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg, this is a homogeneous system on h

and g

t 1 ;Ut

i2
j1 ;j2

= 0 for
t 1 ;Ut

i1
j1 ;j2

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg. Therefore:
h

t 1 ;Ut

i1
j1 ;j2

= g

t 1 ;Ut

i2
j1 ;j2

=0

for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, j1 ; j2 2 f1; : : : ; mg.
4. We consider the cross-derivative of the i
element of Ut and the j2

th element of F with respect to the j1

th

th element of Ut :
[FUt ;Ut ]ij1 ;j2 =

fYt+1

i
i2

j1 j2

g

t 1;

t 1

i2
j1 ;j2

+ [fYt ]ii2 [gUt ;Ut ]ij21 ;j2 + fSt+1

+ [gSt ]ii21 [hUt ;Ut ]ij11 ;j2
i
i1

[hUt ;Ut ]ij11 ;j2 = 0

for i 2 f1; : : : ; k + n + mg and j1 ; j2 2 f1; : : : ; mg. Since g

t 1;

t 1

i2
j1 ;j2

= 0 for i1 2

f1; : : : ; kg and j1 ; j2 2 f1; : : : ; mg, this is a homogeneous system on [hUt ;Ut ]ij11 ;j2 and
[gUt ;Ut ]ij21 ;j2 for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg. Therefore:
[hUt ;Ut ]ij11 ;j2 = [gUt ;Ut ]ij21 ;j2 = 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg.

5. Finally, consider the cross-derivative of the i
j1

th element of Et and the j2

th element of F with respect to the

th element of Ut if j1 6= j2 :
[FEt ;Ut ]ij1 ;j2 =

fYt+1

i
i2

[gSt ]ii21 [hEt ;Ut ]ij11 ;j2 +

j2

gSt ;

t 1

i2
i1 ;j2

[hEt ]ij11 + gZt

+ [fYt ]ii2 [gEt ;Ut ]ij21 ;j2 + fSt+1

65

i
i1

1;

t 1

[hEt ;Ut ]ij11 ;j2 = 0

i2
j1 ;j2

exp#j1

j1 ;t 1

j2

for i 2 f1; : : : ; k + n + mg and j1 ; j2 2 f1; : : : ; mg. Since gZt

1;

t 1

i2
j1 ;j2

= gSt ;

t 1

i2
j;j2

=

0 for i2 2 f1; : : : ; kg, j 2 f1; : : : ; ng, and j1 ; j2 2 f1; : : : ; mg, this is a homoge-

neous system on [hEt ;Ut ]ij11 ;j2 and [gEt ;Ut ]ij21 ;j2 for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and
j1 ; j2 2 f1; : : : ; mg if j1 6= j2 . Therefore:

[hEt ;Ut ]ij21 ;j2 = [gEt ;Ut ]ij11 ;j2 = 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 ; j2 2 f1; : : : ; mg if j1 6= j2 .
Note that if j1 = j2 , we have that:
[FEt ;Ut ]ij1 ;j1 =
fYt+1

i
i2

exp#j1

j1 ;t 1

j1

g Zt

1;

t 1

i2
j1 ;j1

+ gZt

1

i2
j1

+

+ [fYt ]ii2 [gEt ;Ut ]ij21 ;j1 + fSt+1
+ exp#j1
and since [fZt ]ij1 and fZt+1

i
j1

j1 ;t 1

j1

[fZt ]ij1 +

j1

i
i1

j1

g St ;

t 1

i2
i1 ;j1

[hEt ]ij11 + [gSt ]ii21 [hEt ;Ut ]ij11 ;j1

[hEt ;Ut ]ij11 ;j1
fZt+1

i
j1

=0

are di¤erent from zero in general for i 2 f1; : : : ; k + n + mg

and j1 2 f1; : : : ; mg ; we have that this system is not homogeneous and hence:
[hEt ;Ut ]ij21 ;j1 = [gEt ;Ut ]ij11 ;j1 6= 0
for i1 2 f1; : : : ; ng, i2 2 f1; : : : ; kg, and j1 2 f1; : : : ; mg.

13. Appendix B: Computation
In this appendix we provide some more details regarding the computation of the paper. We
generate all the derivatives required by our second-order perturbation with Mathematica 6.0.
In that way, we do not need to recompute the derivatives, the most time-intensive step, for
each set of parameter values in our estimation. Once we have all the relevant derivatives, we
export them automatically into Fortran …les. This whole process takes about 3 hours.
Then, we compile the resulting …les with the Intel Fortran Compiler version 10:1:025
with IMSL. Previous versions failed to compile our project because of the length of some of
the expressions. Compilation takes about 18 hours. The project has 1798 …les and occupies
2:33 Gbytes of memory.
The next step is, for given parameter values, to compute the …rst- and second-order
approximation to the decision rules around the deterministic steady state using the analytic
derivatives we found before. For this task, Fortran takes around 5 seconds. Once we have the
66

solution, we approximate the likelihood using the particle …lter with 10; 000 particles. This
number delivered a good compromise between accuracy and time to compute the likelihood.
The evaluation of one likelihood requires 22 seconds on a Dell server with 8 processors. Once
we have the likelihood evaluation, we guess new parameter values and we start again. This
means that drawing 5,000 times from the posterior (even forgetting about the initial search
over a grid of parameter values) takes around 38 hours.
It is important to emphasize that the Mathematica and Fortran code were highly optimized in order to 1) keep the size of the project within reasonable dimensions (otherwise, the
compiler cannot sparse the …les and, even when it can, it delivers code that is too ine¢ cient)
and 2) provide a fast computation of the likelihood.
Perhaps the most important task in that optimization was the parallelization of the
Fortran code using OPENMP as well as the compilation options: OG (global optimizations)
and Loop Unroll. In addition, we tailored specialized code to perform the matrix multiplications required in the …rst- and second-order terms of our model solution.
Implementing corollary 1 requires the solution of a linear system of equations and the
computation of a Jacobian. For our particular application, we found that the following
sequence of LAPACK operations delivered the fastest solution:
1. DGESV (computes the solution to a real system of linear equations A X = B).
2. DGETRI (computes the inverse of a matrix using the LU factorization from the previous
line).
3. DGETRF (helps to compute the determinant of the inverse from the previous line).
Without the parallelization and our optimized code, the solution of the model and evaluation of its likelihood take about 70 seconds.
With respect to the random-walk Metropolis-Hastings, we performed an intensive process
of …ne-tuning of the chain, both in terms of initial conditions as well as in terms of getting
the right acceptance level. The only other important remark is to remember that as pointed
out by McFadden (1989) and Pakes and Pollard (1989), we must keep the random numbers
used for resampling in the particle …lter constant across draws of the Markov chain. This
is required to achieve stochastic equi-continuity, and even if this condition is not strictly
necessary in a Bayesian framework, it reduces the numerical variance of the procedure, which
was a serious concern for us given the complexity of our problem.

67

14. Appendix C: Construction of Data
When we estimate the model, we need to make the series provided by the National Income
and Product Accounts (NIPA) consistent with the de…nition of variables in the theory. The
main adjustment that we undertake is to express both real output and real gross investment
in consumption units. Our DSGE model implies that there is a numeraire in terms of which
all the other prices need to be quoted. We pick consumption as the numeraire. The NIPA, in
comparison, uses an index of all prices to transform nominal GDP and investment into real
values. In the presence of changing relative prices, such as the ones we have seen in the U.S.
over the last several decades with the fall in the relative price of capital, NIPA’s procedure
biases the valuation of di¤erent series in real terms.
We map theory into the data by computing our own series of real output and real investment. To do so, we use the relative price of investment, de…ned as the ratio of an investment
de‡ator and a de‡ator for consumption. The denominator is easily derived from the de‡ators
of non-durable goods and services reported in the NIPA. It is more complicated to obtain the
numerator because, historically, NIPA investment de‡ators were poorly constructed. Instead,
we rely on the investment de‡ator computed by Fisher (2006). Since the series ends early in
2000Q4, we have extended it to 2007.Q1 by following Fisher’s methodology.
For the real output per capita series, we …rst de…ne nominal output as nominal consumption plus nominal gross investment. We de…ne nominal consumption as the sum of
personal consumption expenditures on non-durable goods and services. We de…ne nominal
gross investment as the sum of personal consumption expenditures on durable goods, private
residential investment, and non-residential …xed investment. Per capita nominal output is
equal to the ratio between our nominal output series and the civilian non-institutional population between 16 and 65. To obtain per capita values, we divide the previous series by the
civilian non-institutional population between 16 and 65. Finally, real wages are de…ned as
compensation per hour in the non-farm business sector divided by the CPI de‡ator.

68

References
[1] Adolfson, M., S. Laséen, J. Lindé, and M. Villani (2007). “Bayesian Estimation of an
Open Economy DSGE Model with Incomplete Pass-Through.”Journal of International
Economics 72, 481-511.
[2] Aruoba, S.B., J. Fernández-Villaverde, and J. Rubio-Ramírez (2006). “Comparing Solution Methods for Dynamic Equilibrium Economies.” Journal of Economic Dynamics
and Control 30, 2477-2508.
[3] Benati, L. and P. Surico (2009). “VAR Analysis and the Great Moderation.”American
Economic Review 99, 1636-1652.
[4] Bianchi, F. (2009). “Regime Switches, Agents’ Beliefs, and Post-World War II U.S.
Macroeconomic Dynamics.”Mimeo, Duke University.
[5] Blanchard, O.J. and J. Simon (2001). “The Long and Large Decline in U.S. Output
Volatility.”Brookings Papers on Economic Activity 2001-1, 187-207.
[6] Bloom, N., N. Jaimovich, N., and M. Floetotto (2008). “Really Uncertain Business
Cycles.”Mimeo, Stanford University.
[7] Boivin, J. and M.P. Giannoni (2006). “Has Monetary Policy Become More E¤ective?”
Review of Economics and Statistics 88, 445-462.
[8] Canova, F. (2009). “What Explains the Great Moderation in the U.S.? A Strutural
Analysis.”Journal of the European Economic Association 7, 697-721.
[9] Canova, F. and L. Gambetti (2009). “Structural Changes in the US Economy: Is There
a Role for Monetary Policy?”Journal of Economic Dynamics and Control 33, 477-490.
[10] Christiano, L., M. Eichenbaum, and C.L. Evans (2005). “Nominal Rigidities and the
Dynamic E¤ects of a Shock to Monetary Policy.” Journal of Political Economy 113,
1-45.
[11] Christo¤el, K., G. Coenen, and A. Warne (2008) “The New Area-Wide Model of the Euro
Area: A Micro-Founded Open-Economy Model for Forecasting and Policy Analysis.”
ECB Working Paper No. 944.
[12] Clarida, R., J. Galí, and M. Gertler (2000). “Monetary Policy Rules and Macroeconomic
Stability: Evidence and Some Theory.”Quarterly Journal of Economics 115, 147-180.
[13] Cogley, T. and T.J. Sargent (2002). “Evolving Post-World War II U.S. In‡ation Dynamics.”NBER Macroeconomics Annual 2001, 331-388.
[14] Cogley, T. and T.J. Sargent (2005). “Drifts and Volatilities: Monetary Policies and
Outcomes in the Post WWII U.S.”Review of Economic Dynamics 8, 262-302.
[15] Davig, T. and E.M. Leeper (2006). “Generalizing the Taylor Principle.”American Economic Review 97, 607-635.
69

[16] DeJong, D.N., H. Dharmarajan, R. Liesenfeld, and J.F. Richard (2007). “An E¢ cient Filtering Approach to Likelihood Approximation for State-Space Representations.”Mimeo,
University of Pittsburgh.
[17] Del Moral P. and J. Jacod (2002). “The Monte-Carlo Method for Filtering with Discrete
Time Observations. Central Limit Theorems.”in T. J. Lyons and T. S. Salisbury (eds.),
Numerical Methods and Stochastics. The Fields Institute Communications, American
Mathematical Society.
[18] Dynan, K.E., D.W. Elmendorf, and D.E. Sichel (2006). “Can Financial Innovation Help
to Explain the Reduced Volatility of Economic Activity?” Journal of Monetary Economics 53, 123-150.
[19] Edge, R., M.T. Kiley, and J.-P. Laforte (2007). “Documentation of the Research and
Statistics Division’s Estimated DSGE Model of the U.S. Economy: 2006 Version.”Board
of Governors of the Federal Reserve System, Finance and Economics Discussion Series
2007-53.
[20] Farmer, R.E., D.F. Waggoner, and T. Zha (2009). “Understanding Markov-Switching
Rational Expectations Models.”Journal of Economic Theory 144, 1849-1867.
[21] Fermanian, J.D. and B. Salanié (2004). “A Nonparametric Simulated Maximum Likelihood Estimation Method.”Econometric Theory 20, 701-734.
[22] Fernández-Villaverde, J. and J. Rubio-Ramírez (2007). “Estimating Macroeconomic
Models: A Likelihood Approach.”Review of Economic Studies 74, 1059-1087.
[23] Fernandez-Villaverde, J. and J. Rubio-Ramirez (2008). “How Structural Are Structural
Parameters?”NBER Macroeconomics Annual 2007, 83-137.
[24] Fernández-Villaverde, J., P. Guerrón-Quintana, and J. Rubio-Ramírez (2009). “The New
Macroeconometrics: A Bayesian Approach.”in A. O’Hagan and M. West (eds.) Handbook
of Applied Bayesian Analysis, Oxford University Press.
[25] Fernández-Villaverde, J., P. Guerrón-Quintana, and J. Rubio-Ramírez (2010). “Reading
the Recent Monetary History of the U.S., 1959-2007”Mimeo, University of Pennsylvania.
[26] Fernández-Villaverde, J., P. Guerrón-Quintana, J. Rubio-Ramírez, and M. Uribe (2009).
“Risk Matters: The Real E¤ects of Volatility Shocks.”NBER Working Paper 14875.
[27] Fiorentini, G., E. Sentana, and N. Shephard (2004). “Likelihood Estimation of Latent
Generalised ARCH Structures.”Econometrica 72, 1481-1517.
[28] Fisher, J., (2006). “The Dynamic E¤ects of Neutral and Investment-Speci…c Technology
Shocks.”Journal of Political Economy 114, 413-52.
[29] Geweke, J. (1998). “Using Simulation Methods for Bayesian Econometric Models: Inference, Development and Communication.” Sta¤ Report 249, Federal Reserve Bank of
Minneapolis.
70

[30] Goodfriend, M. and R. King (2007). “The Incredible Volcker Disin‡ation.” Journal of
Monetary Economics 52, 981-1015.
[31] Greenwood, J., Z. Herkowitz, and P. Krusell (1997). “Long-Run Implications of
Investment-Speci…c Technological Change.”American Economic Review 87, 342-362.
[32] Guerrón-Quintana, P. (2009a). “Money Demand Heterogeneity and the Great Moderation External Link.”Journal of Monetary Economics 56, 255-266.
[33] Guerrón-Quintana, P. (2009b). “What You Match Does Matter: The E¤ects of Data on
DSGE Estimation.”Journal of Applied Econometrics, forthcoming.
[34] Hetzel, R.L. (2008). The Monetary Policy of the Federal Reserve: a History. Cambridge
University Press.
[35] Hurwicz, L. (1962). “On the Structural Form of Interdependent Systems.” Logic,
Methodology and Philosophy of Science, Proceedings of the 1960 International Congress,
232-39.
[36] Je¤reys H. (1961). The Theory of Probability (3rd ed). Oxford University Press.
[37] Justiniano A. and G.E. Primiceri (2008). “The Time Varying Volatility of Macroeconomic Fluctuations.”American Economic Review 98, 604-641.
[38] Kim, C. and C.R. Nelson (1998) “Has the U.S. Economy Become More Stable? A
Bayesian Approach Based on a Markov-Switching Model of the Business Cycle.”Review
of Economics and Statistics 81, 608-616.
[39] Kim, S., N. Shephard, and S. Chib (1998). “Stochastic Volatility: Likelihood Inference
and Comparison with ARCH Models.”Review of Economic Studies 65, 361-93.
[40] Klenow, P.J. and B.A. Malin (2009). “Microeconomic Evidence on Price-Setting.”Chapter prepared for the Handbook of Monetary Economics.
[41] Koop G., M. Hashem Pesaran, and S. Potter (1996). “Impulse Response Analysis in
Nonlinear Multivariate Models.”Journal of Econometrics 74, 199-147.
[42] Künsch, H.R. (2005). “Recursive Monte Carlo Filters: Algorithms and Theoretical
Analysis.”Annals of Statistics 33, 1983-2021.
[43] Lubick, T. and F. Schorfheide (2004). “Testing for Indeterminacy: An Application to
U.S. Monetary Policy.”American Economic Review 94, 190-217.
[44] McConnell, M.M. and G. Pérez-Quirós (2000). “Output Fluctuations in the United
States: What Has Changed Since the Early 1980’s?” American Economic Review 90,
1464-1476.
[45] McFadden, D.L. (1989). “A Method of Simulated Moments for Estimation of Discrete
Response Models Without Numerical Integration.”Econometrica 57, 995-1026.

71

[46] Orphanides, A. (2002). “Monetary Policy Rules and the Great In‡ation.” American
Economic Review 92, 115-120.
[47] Pakes, A. and D. Pollard (1989). “Simulation and the Asymptotics of Optimization
Estimators.”Econometrica 57, 1027-1057.
[48] Primiceri, G.E. (2005). “Time Varying Structural Vector Autoregressions and Monetary
Policy.”Review of Economic Studies 72, 821-852.
[49] Ramey, V.A. and D.J. Vine (2006). “Declining Volatility in the U.S. Automobile Industry.”American Economic Review 96, 1876-1889.
[50] Rogerson, R. and J. Wallenius (2009). “Micro and Macro Elasticities in a Life Cycle
Model with Taxes.”Journal of Economic Theory, forthcoming.
[51] Romer, C.D. and D. H. Romer (2004). “A New Measure of Monetary Shocks: Derivation
and Implications.”American Economic Review 1055-1084.
[52] Schmitt-Grohé, S., and M. Uribe (2004). “Solving Dynamic General Equilibrium Models
Using a Second-Order Approximation to the Policy Function.” Journal of Economic
Dynamics and Control 28, 755-775.
[53] Schreft, S. (1990). “Credit Controls: 1980.”Federal Reserve Bank of Richmond Economic
Review 1990, 6, 25-55.
[54] Schwarz, G.E. (1978). “Estimating the Dimension of a Model.” Annals of Statistics 6,
461–464.
[55] Shephard, N. (2008). “Stochastic Volatility.” The New Palgrave Dictionary of Economics. Palgrave MacMillan.
[56] Sims, C.A. and T. Zha (2006). “Were There Regime Switches in U.S. Monetary Policy?”
American Economic Review 96, 54-81.
[57] Smets, F. and R. Wouters (2007). “Shocks and Frictions in US Business Cycles: A
Bayesian DSGE Approach.”American Economic Review 97, 586-606.
[58] Stock, J.H. and M.W. Watson (2002). “Has the Business Cycle Changed, and Why?”
NBER Macroeconomics Annual 17, 159-218.
[59] Woodford, M.D. (2003). Interest and Prices. Princeton University Press.

72

