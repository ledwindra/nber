                                  NBER WORKING PAPER SERIES




                                ESTIMATING STATIC MODELS OF
                                   STRATEGIC INTERACTION

                                              Patrick Bajari
                                               Han Hong
                                              John Krainer
                                             Denis Nekipelov

                                          Working Paper 12013
                                  http://www.nber.org/papers/w12013


                       NATIONAL BUREAU OF ECONOMIC RESEARCH
                                1050 Massachusetts Avenue
                                  Cambridge, MA 02138
                                      January 2006




The application in this paper is based on an earlier draft, by Bajari and Krainer ‚ÄúAn Empirical Model of
Stock Analysts‚Äô Recommendations: Market Fundamentals, Conflicts of Interest, and Peer Effects.‚Äù Bajari
and Hong would like to thank the National Science Foundation for genereous research support. The views
expressed in this paper are those of the authors and not necessarily those of the Federal Reserve System. We
thank Ulrich Doraszelski and participants at various seminars for helpful comments. The views expressed
herein are those of the author(s) and do not necessarily reflect the views of the National Bureau of Economic
Research.

¬©2006 by Patrick Bajari, Han Hong, John Krainer, and Denis Nekipelov. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including ¬© notice, is given to the source.
Estimating Static Models of Strategic Interaction
Patrick Bajari, Han Hong, John Krainer and Denis Nekipelov
NBER Working Paper No. 12013
January 2006
JEL No. L0, L5, C1

                                           ABSTRACT

We propose a method for estimating static games of incomplete information. A static game is a

generalization of a discrete choice model, such as a multinomial logit or probit, which allows the

actions of a group of agents to be interdependent. Unlike most earlier work, the method we propose

is semiparametric and does not require the covariates to lie in a discrete set. While the estimator we

propose is quite flexible, we demonstrate that in most cases it can be easily implemented using

standard statistical packages such as STATA. We also propose an algorithm for simulating the model

which finds all equilibria to the game. As an application of our estimator, we study recommendations

for high technology stocks between 1998-2003. We find that strategic motives, typically ignored in

the empirical literature, appear to be an important consideration in the recommendations submitted

by equity analysts.

Patrick Bajari
Department of Economics
University of Michigan
266 Lorch Hall
611 Tappan Street
Ann Arbor, MI 48109-1220
and NBER
bajari@umich.edu

Han Hong
Duke University
han.hong@duke.edu

John Krainer
Federal Reserve Bank of San Francisco
john.krainer@sf.frb.org

Denis Nekipelov
Duke University
denis.nekipelov@duke.edu
1    Introduction
Game theory is one of the most commonly applied tools in economic theory, with substantive
applications in all major Ô¨Åelds in economics. In some Ô¨Åelds, particularly industrial organization,
game theory has not only transformed the analysis of market interactions, but also serves as an
important basis for policy recommendations. Given the importance of gaming in economic theory,
it is not surprising that the empirical analysis of games has been the focus of a recent literature in
econometrics and industrial organization.
    In much of the literature, a discrete game is modeled much like a standard discrete choice
problem, such as the multinomial logit. An agent‚Äôs utility is often assumed to be a linear function
of covariates and a random preference shock. However, unlike a discrete choice model, utility
is also allowed to depend on the actions of other agents. A discrete game strictly generalizes a
standard random utility model, but does not impose the often strong assumption that agents act
in isolation. Early attempts at the econometric analysis of such games included Bjorn and Vuong
(1984), Bresnahan and Reiss (1991a), Bresnahan and Reiss (1991b). Other recent examples include
Haile, Hortacsu, and Kosenok (2003), Aradillas-Lopez (2005), Ho (2005), Ishii (2005), Pakes, Porter,
Ho, and Ishii (2005), Augereau, Greenstein, and Rysman (2005), Seim (2005), Sweeting (2005) and
Tamer (2003).
    An important insight in the recent literature is that it is often most straightforward to estimate
discrete games in two steps. For examples see Aguirregabiria and Mira (2002), Bajari, Benkard, and
Levin (2004), Berry, Pakes, and Ostrovsky (2003) and Pesendorfer and Schmidt-Dengler (2003).
In a Ô¨Årst step, the economist estimates the reduced forms implied by the model. This often boils
down to using standard econometric methods to estimate the probability that one, out of a Ô¨Ånite
number of possible choices, is observed conditional on the relevant covariates. In the second step,
the economist estimates a single agent random utility model, including as controls the equilibrium
beliefs about the behavior of others from the Ô¨Årst step.
    In this paper, we propose an estimator that can be applied to static games of strategic interac-
tion. Like the two-step approach discussed above, we estimate the reduced form choice probabilities
in a Ô¨Årst stage in order to simplify the estimation of the model. The approach that we propose,
however, diÔ¨Äers from earlier work in four ways. First, much of the earlier literature on two step
estimation considered fully dynamic games. This made it diÔ¨Écult for researchers unfamiliar with
dynamic programming to understand how to estimate a game. Also, we note that to date, the ma-
jority of empirical applications of discrete games have been static. Therefore, proposing methods
for static games is of practical importance for many researchers.
    Second, the approach that we propose can be done nonparametrically or semiparametrically.


                                                  2
Much of the earlier literature on two-step estimation of games considered the case where the set
of regressors was discrete or the Ô¨Årst stage was a correctly speciÔ¨Åed parametric model. In this
paper, we allow for continuous covariates and a fully nonparametric Ô¨Årst stage. We establish
two useful properties of this estimator. First, despite the fact the Ô¨Årst stage is nonparametric
and might converge at a slow rate, the structural parameters estimated in the second stage have
normal asymptotics and converge at a rate proportional to the square root of the sample size.
This follows from arguments based on Newey (1994). Second, we demonstrate in many cases our
model can be estimated, with correct standard errors, using a two stage least squares procedure in
a standard statistical package like STATA. We hope that the simplicity of this approach will make
the estimation of these models accessible to a larger audience of researchers. In Bajari and Hong
(2004) we demonstrate that the ideas in this paper can be generalized to dynamic games. However,
this estimator is more diÔ¨Écult to implement and requires quite distinct econometric arguments.
   Third, we consider the problem of identiÔ¨Åcation in games with continuous state variables. Our
results, as in Bajari and Hong (2004), show that a suÔ¨Écient condition for identiÔ¨Åcation is to
exclude payoÔ¨Ä relevant covariates for a particular player i from the utilities of the other players.
For instance, in an entry model, if the productivity shock of Ô¨Årm i inÔ¨Çuences its own entry decision,
but only indirectly inÔ¨Çuences the entry decisions of other players, then our results imply that the
model is identiÔ¨Åed. An alternative identiÔ¨Åcation strategy is to search for events that change which
equilibrium to the game is played, but otherwise do not inÔ¨Çuence payoÔ¨Äs. Our results can be
interpreted as standard rank conditions for an appropriately deÔ¨Åned linear system. We note that
Pesendorfer and Schmidt-Dengler (2003) demonstrate that exclusion restrictions are suÔ¨Écient for
identiÔ¨Åcation in a particular set of entry games with discrete states. Sweeting (2005) demonstrates
that multiplicity of equilibrium can assist with identiÔ¨Åcation in a symmetric location game.
   Finally, we consider the problem of simulating the model, which is required to study predictions
of the model such as counterfactuals. It is widely known that models of the form that we consider
can generate multiple solutions. However, outside of certain speciÔ¨Åc examples (e.g., those studied
in Sweeting (2005)), it is not possible to analytically derive all of the solutions of the model or
even to determine the number of possible solutions. Therefore, we propose an algorithm that can
compute all of the equilibria to the model. This algorithm uses the ‚Äúall solutions homotopy‚Äù, which
is available in standard numerical libraries such as hompack. Therefore, we can use this to Ô¨Ånd the
entire set of equilibrium actions at our estimated parameter values. We discuss the potential uses
of this algorithm in our application.
   As an application of our methods, we model the determination of stock recommendations (e.g.
strong buy, buy, hold, sell) issued by equity analysts for high technology stocks listed in the NAS-
DAQ 100 between 1998 and 2003. The determination of recommendations during this time period

                                                 3
is of particular interest in the wake of the sharp stock price declines for technology Ô¨Årms in 2000.
Recommended stocks underperformed the market as a whole during this period by a wide margin.
Highly-publicized allegations of conÔ¨Çicts of interest have called into question whether analysts were
more concerned with helping their Ô¨Årms win investment banking business than with producing
accurate assessments of the prospects for the Ô¨Årms under scrutiny. While there is a fairly large
literature in Ô¨Ånance on recommendations, we are not aware of any papers that formally consider
the simultaneity of recommendations due to strategic motives.
   In our model, recommendations submitted by analysts depend on four factors. First, recom-
mendations must depend on fundamentals and commonly shared expectations about the future
proÔ¨Åtability of the Ô¨Årm. These expectations will be embedded in the stock price. Second, analysts
are heterogeneous, both in terms of talent and perhaps in terms of access to information. We try to
capture an individual analyst‚Äôs private belief about the stock by looking at the diÔ¨Äerence between
the quarterly earnings forecast submitted by the analyst (or the analyst‚Äôs brokerage Ô¨Årm) and the
distribution of forecasts from other Ô¨Årms. Mindful of the large number of inquiries into possible
conÔ¨Çicts of interest among research analysts, we include as a third factor a dummy variable for an
investment banking relationship between the Ô¨Årm and the analyst‚Äôs employer.
   Finally, we consider the inÔ¨Çuence of peers on the recommendation decision. Peer eÔ¨Äects can
impact the recommendation in diÔ¨Äerent ways. Individual analysts have incentive to condition their
recommendation on the recommendations of their peers, because even if their recommendations
turn out to be unproÔ¨Åtable ex-post, performance evaluation is typically a comparison against the
performance of peers. More subtly, recommendations are relative rankings of Ô¨Årms and are not
easily quantiÔ¨Åable (or veriÔ¨Åable) objects. As such, ratings scales usually reÔ¨Çect conventions and
norms. The phenomenon is similar to the college professor‚Äôs problem of assigning grades. If a
professor were to award the average student with a C while other faculty give a B+ to the average
student, the professor might incorrectly signal his views of student performance. Even while there
is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance.
Similarly, analysts might have an incentive to benchmark their recommendations against perceived
industry norms.
   The paper is organized as follows. In section 2 we outline the general economic environment.
For purposes of exposition, we develop many of the key formulae within the context of a simple
entry model. In section 3 we discuss the problem of nonparametric identiÔ¨Åcation. In section 4 we
show how to derive nonparametric and semiparametric estimates of the structural parameters for
our class of models. Section 5 describes the all solutions homotopy algorithm for simulating the
model. Section 6 contains the empirical application to equity analyst recommendations. Section 7

                                                 4
concludes the paper.


2     The model
In the model, there are a Ô¨Ånite number of players, i = 1, ..., n and each player simultaneously
chooses an action ai ‚àà {0, 1, . . ., K} out of a Ô¨Ånite set. We restrict players to have the same set of
actions for notational simplicity. However, all of our results will generalize to the case where all
players have diÔ¨Äerent Ô¨Ånite sets of actions. Let A = {0, 1, . . ., K}n denote the vector of possible
actions for all players and let a = (a1 , ..., an) denote a generic element of A. As is common in the
literature, we let a‚àíi = (a1 , ...ai‚àí1, ai+1 , ..., an) denote a vector of strategies for all players excluding
player i. We will abstract from mixed strategies since in our model, with probability one each player
will have a unique best response.
    Let si ‚àà Si denote the state variable for player i. Let S = Œ†i Si and let s = (s1 , ..., sn) ‚àà S
denote a vector of state variables for all n players. We will assume that s is common knowledge to
all players in the game and in our econometric analysis, we will assume that s is observable to the
econometrician. The state variable is assumed to be a real valued vector, but Si is not required to
be a Ô¨Ånite set. Much of the previous literature assumes that the state variables in a discrete games
lie in a discrete set. While this assumption simpliÔ¨Åes the econometric analysis of the estimator and
identiÔ¨Åcation, it is a strong assumption that may not be satisÔ¨Åed in many applications.
    For each agent, there are also K + 1 state variables which we label as i (ai ) which are pri-
vate information to each agent.            These state variables are distributed i.i.d. across agents and
actions. Let i denote the 1 √ó (K + 1) vector of the individual i (ai ). The density of i (ai ) will
be denoted as f (i (ai)). However, we shall sometimes abuse notation and denote the density for
Œµi = (Œµi (0), ..., Œµi(K)) as f (i ).
    The period utility function for player i is:

                                  ui (a, s, i; Œ∏) = Œ†i (ai , a‚àíi , s; Œ∏) + i (ai ).                      (1)

The utility function in our model is similar to a standard random utility model such as a multinomial
logit. Each player i receives a stochastic preference shock, i (ai ), for each possible action ai . In
many applications, this will be drawn from an extreme value distribution as in the logit model.
In the literature, the preference shock is alternatively interpreted as an unobserved state variable
(see Rust (1994)). Utility also depends on the vector of state variables s and actions a through
Œ†i (ai , a‚àíi , s; Œ∏). For example, in the literature, this part of utility is frequently parameterized as
a simple linear function of actions and states. Unlike a standard discrete choice model, however,
note that the actions a‚àíi of other players in the game enter into i‚Äôs utility. A standard discrete

                                                             5
choice model typically assumes that agents i act in isolation in the sense that a‚àíi is omitted from
the utility function. In many applications, this is an implausible assumption.
   In this model, player i‚Äôs decision rule is a function ai = Œ¥i (s, i ). Note that i‚Äôs decision does not
depend on the ‚àíi since these shocks are private information to the other ‚àíi players in the game
and hence unobservable to i. DeÔ¨Åne œÉi (ai|s) as:
                                        
                         œÉi (ai = k|s) = 1 {Œ¥i (s, i ) = k} f (i )di .                               (2)

In the above expression, 1 {Œ¥i (s, i) = k} is the indicator function that player ƒ±ÃÅ‚Äôs action is k given
the vector of state variable (s, i ). Therefore, œÉi (ai = k|s) is the probability that i chooses action
k conditional on the state variables s that are public information. We will deÔ¨Åne the distribution
of a given s as œÉ(a|s) = Œ†ni=1 œÉ(ai|s).
   Next, deÔ¨Åne œÄi (ai, s, i ; Œ∏) as:
                                               
                       œÄi (ai , s, i ; Œ∏) =         Œ†i (ai , a‚àíi , s; Œ∏)œÉ‚àíi(a‚àíi |s) + i (ai )         (3)
                                               a‚àíi
                                                     where œÉ‚àíi (a‚àíi |s) = Œ†j=i œÉj (aj |s).             (4)

In (3), œÄi (ai , s, i; Œ∏) is player i‚Äôs expected utility from choosing ai when the vector of parameters is
Œ∏. Since i does not know the private information shocks, j for the other players, i‚Äôs beliefs about
                                                  
their actions are given by œÉ‚àíi (a‚àíi |s). The term   a‚àíi Œ†i (ai , a‚àíi , s, Œ∏)œÉ‚àíi(a‚àíi |s) is the expected
value of Œ†i (ai , a‚àíi , s; Œ∏), marginalizing out the strategies of the other players using œÉ‚àíi (a‚àíi |s). The
structure of payoÔ¨Äs in (3) is quite similar to standard random utility models, except that the
probability distribution over other agents‚Äô actions enter into the formula for agent i‚Äôs utility. Note
that if the error term has an atomless distribution, then player i‚Äôs optimal action is unique with
probability one. This is an extremely convenient property and eliminates the need to consider
mixed strategies as in a standard normal form game.
   We also deÔ¨Åne the deterministic part of the expected payoÔ¨Ä as
                                                 
                             Œ†i (ai , s; Œ∏) =              Œ†i (ai , a‚àíi , s, Œ∏)œÉ‚àíi(a‚àíi |s).             (5)
                                                     a‚àíi



It follows immediately then that the optimal action for player i satisÔ¨Åes:



            œÉi (ai|s) = P rob {i |Œ†i (ai , s; Œ∏) + i (ai ) > Œ†i (aj , s; Œ∏) + i (aj ) for j = i.}   (6)




                                                                 6
2.1      A Simple Example.

For expositional clarity, consider a simple example of a discrete game. Perhaps the most commonly
studied example of a discrete game in the literature is a static entry game (see Bresnahan and
Reiss (1991a), Bresnahan and Reiss (1991b),Berry (1992), Tamer (2003), Ciliberto and Tamer
(2003), Manuszak and Cohen (2004)). In the empirical analysis of entry games, the economist
typically has data on a cross section of markets and observes whether a particular Ô¨Årm, i, chooses
to enter a particular market. In Berry (1992) and Ciliberto and Tamer (2003), for example, the
Ô¨Årms are major U.S. airlines such as American, United and Northwest and the markets are large,
metropolitan airports. The state variables, si might include the population in the metropolitan
area surrounding the airport and measures of an airline‚Äôs operating costs. Let ai = 1 denote the
decision to enter a particular market and ai = 0 denote the decision not to enter the market. In
many applications, Œ†i (ai , a‚àíi , s; Œ∏) is assumed to be a linear function, e.g.:
                                                                    
                                                      s ¬∑ Œ≤ + Œ¥          1 {aj = 1} if ai = 1
                             Œ†i (ai , a‚àíi , s; Œ∏) =                 j=i                                     (7)
                                                                        0 if ai = 0
In equation (7), the mean utility from not entering is set equal to zero.2 The term Œ¥ measures the
inÔ¨Çuence of j‚Äôs choice on i‚Äôs entry decision. If proÔ¨Åts decrease from having another Ô¨Årm enter the
market then Œ¥ < 0. The parameters Œ≤ measure the impact of the state variables on Œ†i (ai , a‚àíi , s).
      The random error terms Œµi (ai ) are thought to capture shocks to the proÔ¨Åtability of entry that
are private information to Ô¨Årm i. Suppose that the error terms are distributed extreme value.
Then, utility maximization by Ô¨Årm i implies that:
                                                            
                                           exp(s ¬∑ Œ≤ + Œ¥          œÉj (aj = 1|s))
                                                            j=i
                      œÉi (ai = 1|s) =                                                   for i = 1, ..., n   (8)
                                        1+   exp(s    ¬∑Œ≤+Œ¥             œÉj (aj = 1|s))
                                                                 j=i

In the system of equations above, applying the formula in equation (5) implies that Œ†i (ai , s; Œ∏) =
          
s ¬∑ Œ≤ + Œ¥ œÉj (aj = 1|s). Since the error terms are distributed extreme value, equation (6) implies
            j=i
that the choice probabilities, œÉi (ai = 1|s) take a form similar to a single agent multinomial logit
model. We note in passing that it can easily be shown using Brouwer‚Äôs Ô¨Åxed point theorem an
equilibrium to this model exists for any Ô¨Ånite s (see McKelvey and Palfrey (1995))).
      We exploit the convenient representation of equilibrium in equation (8) in our econometric
analysis. Suppose that the econometrician observes t = 1, ..., T repetitions of the game. Let ai,t
  2
      We formally discuss this normalization in our section on identiÔ¨Åcation.



                                                             7
denote the entry decision of Ô¨Årm i in repetition t and let the value of the state variables be equal
to st . By observing entry behavior in a large number of markets, the econometrician could form a
                    i (ai = 1|s) of œÉi (ai = 1|s) for i = 1, ..., n. In an application, this simply boils
consistent estimate œÉ
down to Ô¨Çexibly estimating the probability that a binary response, ai is equal to one conditional
on a given set of covariates. This could be done using any one of a number of standard techniques.
    We let L(Œ≤, Œ¥) denote the pseudo-likelihood function deÔ¨Åned as:
                         ‚éõ                                     ‚éû1{ai,t =1} ‚éõ                                          ‚éû1{ai,t =0}
                             exp(s ¬∑Œ≤+Œ¥       œÉÃÇj (aj =1|s))                     exp(s ¬∑Œ≤+Œ¥          œÉÃÇj (aj =1|s))
                
                T 
                  n
                         ‚éú             j=i                      ‚éü        ‚éú                     j=i                     ‚éü
                         ‚éú                                       ‚éü        ‚éú1 ‚àí                                           ‚éü
    L(Œ≤, Œ¥) =            ‚éù 1+exp(s ¬∑Œ≤+Œ¥œÉÃÇ                      ‚é†        ‚éù      1+exp(s ¬∑Œ≤+Œ¥
                                                                                                                        ‚é†
                t=1i=1                            j (aj   =1|s))                                        œÉÃÇj (aj   =1|s))
                                           j=i                                                  j=i
                              i (ai = 1|s), we could then estimate the structural parameters of the payoÔ¨Ä,
Given Ô¨Årst stage estimates of œÉ
Œ≤ and Œ¥, by maximizing the above pseudo-likelihood function. There are two attractive features of this
strategy. The Ô¨Årst is that it not demanding computationally. First stage estimates of choice probabilities
could be done using a strategy as simple as a linear probability model. The computational burden of the
second stage is also light since we only need to estimate a logit model. A second attractive feature is that
it allows us to view a game as a generalization of a standard discrete choice model. Thus, techniques from
the voluminous econometric literature on discrete choice models can be imported into the study of strategic
interaction. While the example considered above is simple, it nonetheless illustrates many of the key ideas
that will be essential in what follows.
    We can also see a key problem with identiÔ¨Åcation in the simple example above. Both the Ô¨Årst stage
          i (ai = 1|s) and the term s ¬∑ Œ≤ depend on the vector of state variables s. This suggests that we
estimates œÉ
will suÔ¨Äer from a collinearity problem in order to separately identify the eÔ¨Äects of Œ≤ and Œ¥ on the observed
choices. The standard solution to this type of problem in many settings is to impose an exclusion restriction.
Suppose, for instance, a Ô¨Årm speciÔ¨Åc productivity shock is included in s. In most oligopoly models, absent
technology spillovers, the productivity shocks of Ô¨Årms ‚àíi would not directly enter into Ô¨Årm i‚Äôs proÔ¨Åts. These
shocks only enter indirectly through the endogenously determined actions of Ô¨Årms ‚àíi, e.g. price, quantity
or entry decisions. Therefore, if we exclude the productivity shocks of other Ô¨Årms from the term s ¬∑ Œ≤, we
would no longer suÔ¨Äer from a collinearity problem. While this idea is quite simple, as we shall discover in
the next section, similar restrictions are required to identify more general models.


3     Nonparametric IdentiÔ¨Åcation
In this section, we consider the problem of identifying the deterministic part of payoÔ¨Äs, without making
particular assumptions about its functional form (e.g. that it is a linear index as in the previous example).
In the context of nonparametric identiÔ¨Åcation, we let Œ∏ be completely nonparametric and write Œ†i (ai , a‚àíi , s)
instead of Œ†i (ai , a‚àíi , s; Œ∏).

DeÔ¨Ånition We will say that Œ†i (ai , a‚àíi , s) is identiÔ¨Åed if Œ†i (ai , a‚àíi , s) = Œ†i (ai , a‚àíi , s) for some i = 1, ..., n
       implies that for the corresponding equilibrium choice probabilities œÉi (ai = 1|s) = œÉi (ai = 1|s) for some
       i = 1, ..., n.


                                                                      8
Formally, identiÔ¨Åcation requires that diÔ¨Äerent values of the primitives generate diÔ¨Äerent choice probabilities.
If this condition is not satisÔ¨Åed, then it will be impossible for us to uniquely recover the structural parameters
Œ†i (ai , a‚àíi , s) (for i = 1, ..., n) from knowledge of the observed choice probabilities, œÉi (ai = 1|s).
    It is well known that even in a single agent problem, it is not possible to nonparametrically identify both
Œ†i (ai , a‚àíi , s) and the joint distribution of the error terms F (i ). To take the simplest possible example,
consider a simple binary response model and assume that the error terms are normally distributed, as in the
probit model. Let œÉi (ai = 1|s) denote the probability that the response is equal to one in the data conditional
on s. DeÔ¨Åne Œ†i (ai = 0|s) = 0 and Œ†i (ai = 0|s) = F ‚àí1 (œÉi (ai = 1|s)) where F ‚àí1 denotes the normal cdf. It
can easily be veriÔ¨Åed that this deÔ¨Ånition of Œ†i perfectly rationalizes any set of choice probabilities œÉi (ai = 1|s).
Since our model is not identiÔ¨Åed without a parametric assumption on the error term in even a simple probit
model, assumptions at least as strong will be required in the more general set up that we consider here.
In Bajari, Hong, and Ryan (2004) we demonstrate that when we allow for nonparametric Œ†i (ai , a‚àíi , s) an
independence assumption is required to identify our model in even single agent problems. In what follows,
we will typically impose the assumption that the error terms are distributed i.i.d. extreme value since both
an independence and parametric form assumption on the error terms are required for identiÔ¨Åcation.
    Based on the discussion above, we shall impose the following assumption in order to identify the model.

A1 The error terms i (ai ) are distributed i.i.d. across actions ai and agents i. Furthermore, the parametric
         form of the distribution F comes from a known family.
                                                                                             
    Analogous to the notation in the previous section, deÔ¨Åne Œ†i (k, s) =                         a‚àíi   Œ†i (ai = k, a‚àíi , s)œÉ‚àíi (a‚àíi |s).
It is straightforward to show that the equilibrium in this model must satisfy:

                   Œ¥i (s, i ) = k if and only if Œ†i (k, s) + i (k) > Œ†i (k  , s) + i (k  ) for all k  = k.                   (9)

That is, action k is chosen if and only if the deterministic expected payoÔ¨Ä and error term associated with
action k is greater than the analogous values of k  = k. An implication of (9) is that the equilibrium choice
probabilities œÉi (a|s) must satisfy:

        œÉi (ai |s) = Pr {i (ai ) + Œ†i (ai , s) ‚àí Œ†i (0, s) > i (k) + Œ†i (k, s) ‚àí Œ†i (0, s), ‚àÄk = 0, . . . , K, k = ai }         (10)

Equation (10) is a simple consequence of (9) where we can subtract Œ†i (0, s) from both sides of the inequality.
    Suppose we generate i (ai ) from an extreme value distribution as in the logit model. Then (10) implies
that:
                                                      exp(Œ†i (ai , s) ‚àí Œ†i (0, s))
                                        œÉi (ai |s) = K                                                                            (11)
                                                      k=0 exp(Œ†i (k, s) ‚àí Œ†i (0, s))

A key insight due to Hotz and Miller (1993) is that equation (11) implies that the equilibrium choice
probabilities, œÉi (ai |s), have a one-to-one relationship to the ‚Äúchoice speciÔ¨Åc value functions‚Äù, Œ†i (ai , s) ‚àí
Œ†i (0, s). To see why, note that taking logarithms of both sides of (11) implies that for any k, k  :

                                     log (œÉi (k|s)) ‚àí log (œÉi (k  |s)) = Œ†i (k, s) ‚àí Œ†i (k  , s).



                                                                    9
    The one-to-one mapping between choice probabilities and choice speciÔ¨Åc value functions holds more
generally than in just the logit model. It is obvious that we should expect it in any model where the
distribution of i has full support. We let Œì : {0, ..., K} √ó S ‚Üí [0, 1] denote the map in general from choice
speciÔ¨Åc value functions to choice probabilities, i.e.

                     (œÉi (0|s), ..., œÉi(K|s)) = Œìi (Œ†i (1, s) ‚àí Œ†i (0, s), ..., Œ†i(K, s) ‚àí Œ†i (0, s)) .                       (12)

We will denote the inverse mapping by Œì‚àí1 :

                 (Œ†i (1, s) ‚àí Œ†i (0, s), ..., Œ†i(K, s) ‚àí Œ†i (0, s)) = Œì‚àí1
                                                                       i (œÉi (0|s), ..., œÉi(K|s)) .                           (13)

    The above analysis implies that we can invert the equilibrium choice probabilities to nonparametrically
recover Œ†i (1, s) ‚àí Œ†i (0, s), ..., Œ†i(K, s) ‚àí Œ†i (0, s). However, the above analysis implies that we will not be
able to separately identify Œ†i (1, s) and Œ†i (0, s), we can only identify the diÔ¨Äerence between these two terms.
Therefore, we shall impose the following assumption:

A2 For all i and all a‚àíi and s, Œ†i (ai = 0, a‚àíi , s) = 0.

The above assumption is similar to the ‚Äúoutside good‚Äù assumption in a single agent model where the mean
utility from a particular choice is set equal to zero. In the context of our entry model, this assumption is
satisÔ¨Åed if the proÔ¨Åt from not entering the market is equal to zero regardless of the actions of other agents.
Just as in the single agent model, there are alternative normalizations that we could use to identify the
Œ†i (ai , a‚àíi , s) just as in a single agent model. However, for expositional simplicity we shall restrict attention
to the normalization A2.
    Given assumption A2 and knowledge of the equilibrium choice probabilities, œÉi (ai |s), we can then apply
the mapping in (13) to recover Œ†i (ai , s) for all i, ai and s. Recall that the deÔ¨Ånition of Œ†i (ai , s) implies that:
                                    
                    Œ†i (ai , s) =         œÉ‚àíi (a‚àíi |s)Œ†i (ai , a‚àíi , s), ‚àÄi = 1, . . . , n, ai = 1, . . . , K.                (14)
                                    a‚àíi


    Even if we know the values of Œ†i (ai , s) and œÉ‚àíi (a‚àíi |s) in the above equation, it is not possible to uniquely
determine the values of Œ†i (ai , a‚àíi , s). To see why, hold the state vector s Ô¨Åxed, determining the utilities of
all agents involves solving for n √ó K √ó (K + 1)n‚àí1 unknowns. That is, there are n agents, for each action
k = 1, ..., K, utility depends on the (K + 1)n‚àí1 possible actions of the other agents.                           However, the left
hand side of (14) only contains information about n √ó (K + 1) scalars holding s Ô¨Åxed.                             It is clearly not
possible to invert this system in order to identify Œ†i (ai , a‚àíi , s) for all i, all k = 1, ...., K and all a‚àíi ‚àà A‚àíi .
Related nonidentiÔ¨Åcation results have been found by Bresnahan and Reiss1991a, 1991c and Pesendorfer and
Schmidt-Dengler (2003) in the context of dynamic games with discrete state spaces.
    Obviously, there must be cross-equation restrictions across either i or k in order to identify the system.
One way to identify the system is to impose exclusion restrictions. Partition s = (si , s‚àíi ), and suppose
Œ†i (ai , a‚àíi , s) = Œ†i (ai , a‚àíi , si ) depends only on the subvector si . An example of this might be in an entry
model.    In this type of model the state is usually a vector of productivity shocks.                            While we might
expect the proÔ¨Åt of Ô¨Årm i to depend on the entry decisions of other agents, it should not depend on the


                                                                   10
productivity shocks of other agents. See Bajari, Hong, and Ryan (2004) for other examples of possible
exclusion restrictions that can be used in applications. If such an exclusion restriction is possible, we can
then write
                                                         
                                 Œ†i (ai , s‚àíi , si ) =         œÉ‚àíi (a‚àíi |s‚àíi , si )Œ†i (ai , a‚àíi , si ).                       (15)
                                                         a‚àíi

Clearly, a suÔ¨Écient identiÔ¨Åcation condition is that for each si , there exists (K + 1)n‚àí1 points in the support
of the conditional distribution of s‚àíi given si , such that this system of equations form by these (K + 1)n‚àí1
                                                                               (K+1)n‚àí1
points given si is invertible. In other words, Let s1‚àíi , . . . , s‚àíi                       denote these points, then identiÔ¨Åcation
requires that the matrix
                                                                                                   
                        œÉ(a‚àíi |sj‚àíi , si ), a‚àíi = 1, . . . , (K + 1)n‚àí1 , j = 1, . . . , (K + 1)n‚àí1

be nonsingular and invertible. Note that this assumption will be satisÔ¨Åed as long as s‚àíi contains a continu-
ously distributed variable with Œ†i (ai , a‚àíi , si ) suÔ¨Écient variability.

Theorem 1 Suppose that A1 and A2 hold. Also suppose that for each si , there exists (K + 1)n‚àí1 points in
the support of the conditional distribution of s‚àíi given si so that (15) is invertible. Then the latent utilities
Œ†i (ai , a‚àíi , si ) are identified.

    Another approach to identiÔ¨Åcation is to exploit the multiplicity of equilibria. Suppose that there is some
state variable z which shifts which equilibrium to the game is played, but otherwise does not enter into the
payoÔ¨Äs. Then we can write the payoÔ¨Äs are œÉi (ai |s, z) but the utilities do not directly depend on the variable
z. We shall give a detailed example of such a variable in our application which is due to the intervention
in the market by a regulator which we interpret as shifting the equilibrium to the game but not directly
entering payoÔ¨Äs. This generates variation in the right hand size of (15) which allows us to check similar rank
conditions. We note that Sweeting (2005) has also pointed out that the multiplicity of equilibrium can help
in identifying a special case of the model above.


4     Estimation
In the previous section, we demonstrated that there is a nonparametric inversion between choice probabil-
ities and the choice speciÔ¨Åc value functions, Œ†(ai , s). Furthermore, we demonstrated that the structural
parameters of our model are identiÔ¨Åed if appropriate exclusion restrictions are made on payoÔ¨Äs. In this
section, we exploit this inversion to construct nonparametric and semiparametric estimates of our structural
parameters.

Step 1: Estimation of Choice Probabilities. Suppose the economist has access to data on t =
1, . . . , T repetitions of the game. For each repetition, the economist observes the actions and state variables
                                                                    i (k|s) of œÉi (k|s) using sieve series expansions
for each agent (ai,t , si,t ). In the Ô¨Årst step we form an estimate œÉ
( see Newey (1990) and Ai and Chen (2003)). We note, however, that we could alternatively estimate the Ô¨Årst
stage using other nonparametric regression methods such as kernel smoothing or local polynomial regressions.

                                                                      11
    Let {ql (s), l = 1, 2, . . .} denote a sequence of known basis functions that can approximate a real valued
measurable function of s arbitrarily well for a suÔ¨Éciently large value of l. The sieve could be formed using
splines, Fourier Series or orthogonal polynomials. We let the basis become increasingly Ô¨Çexible as the number
of repetitions of the game T becomes large. Let Œ∫(T ) denote the number of basis functions to be used when
the sample size is T. We shall assume that Œ∫(T ) ‚Üí ‚àû, Œ∫(T )/T ‚Üí 0 at an appropriate rate to be speciÔ¨Åed
below. Denote the 1 √ó Œ∫(T ) vector of basis functions as

                                            q Œ∫(T ) (s) = (q1 (s), . . . , qŒ∫(T ) (s)),                          (16)

and its collection into a regressor data matrix as

                                               QT = (q Œ∫(T ) (s1 ), . . . , q Œ∫(T ) (sT ).

                                      i (k|s), k = 1, . . . , K is a linear probability model, i.e.:
    One potential sieve estimator for œÉ
                                            
                                            T
                               i (k|s) =
                               œÉ                  1(ait = k)q Œ∫(T ) (st )(QT QT )‚àí1 q Œ∫(T ) (s).                (17)
                                            t=1

Equation (17) is the standard formula for a linear probability model where the regressors are the sieve
functions Œ∫(T ) in equation (16). We note that in the presence of continuous state variables, the sieve
                                                                                                  ‚àö
          i (k|s) will converge to the true œÉi (k|s) at a nonparametric rate which is slower than T .
estimator œÉ

Second Step: Inversion In our second step, we take as given our estimates œÉi(k|s) of the equilibrium
choice probabilities. We then form an estimate of the expected deterministic utility functions, Œ†ÃÇi (k, st ) ‚àí
Œ†ÃÇi (0, st ) for k = 1, ..., K and t = 1, ..., T .                                                i (k|s) in place of
                                                        This can be done by evaluating (13) using œÉ
œÉi (k|s). That is:
                                                                         
                Œ†               i (0, st ), ...Œ†
                 i (1, st ) ‚àí Œ†                 i(K, st ) ‚àí Œ†
                                                               i (0, st ) = Œì‚àí1 (
                                                                                  œÉi (0|st ), ..., 
                                                                                                   œÉi(K|st ))    (18)
                                                                                  i

In the speciÔ¨Åc case of the logit model, this inversion would simply be:

                                Œ†ÃÇi (k, st ) ‚àí Œ†ÃÇi (0, st ) = log (
                                                                   œÉi (k|st )) ‚àí log (
                                                                                      œÉi (0|st ))                (19)

In an alternative model, such as one with normal shocks, we would need to solve a nonlinear system. In
what follows, we shall impose A2 so that Œ†ÃÇi (0, s) = Œ†ÃÇi (0, a‚àíi , s) = 0 for all a‚àíi .

Third Step: Recovering The Structural Parameters In the Ô¨Årst step we recovered an estimate
of œÉÃÇi (ai , s) and in the second step we recovered an estimate of the choice speciÔ¨Åc value function Œ†ÃÇi (k, s). In
our third step, we use the empirical analogue of (14) to form an estimate of Œ†(ai , a‚àíi , si ). We shall assume
that we have made a suÔ¨Écient number of exclusion restrictions, as discussed in the previous section, so that
the model is identiÔ¨Åed. For a given value of si , for a given a = (ai , a‚àíi ), we estimate Œ†i (ai , a‚àíi , si ) by
minimizing the following weighted least square function
    Œ†i (ai , a‚àíi , si ), which are taken to be a vector of coeÔ¨Écients:
                          ‚éõ                                                                    ‚éû2
                      T                           
                          ‚éùŒ†ÃÇi (ai , s‚àíit , si ) ‚àí   œÉÃÇ‚àíi (a‚àíi |s‚àíit , si ) Œ†i (ai , a‚àíi , si )‚é† w (t, si ) ,    (20)
                     t=1                          a‚àíi



                                                                  12
where the nonparametric weights w (t, si ) can take a variety of forms. For example,
                                                       T              
                                             sit ‚àí si            siœÑ ‚àí si
                            w (t, si ) = k             /     k                                                 (21)
                                                 h       œÑ=1
                                                                     h

uses kernel weights, and other local weights are also possible. The identiÔ¨Åcation condition in the previous
section ensures that the regressor matrix in this weighted least square regression is nonsingular asymptoti-
cally.


4.1      A Linear Model of Utility
The nonparametric estimation procedure described in the previous section follows the identiÔ¨Åcation argu-
ments closely and oÔ¨Äers the advantage of Ô¨Çexibility and robustness against misspeciÔ¨Åcation. However, without
a huge amount of data nonparametric estimation methods can be subject to severe curve of dimensionality
when we intend to control for a large dimension of state variables s. Also, in small samples, diÔ¨Äerent imple-
mentations of nonparametric procedures may lead to drastically diÔ¨Äerent point estimates. Therefore in the
following we consider a semiparametric estimation where the deterministic utility components Œ†i (ai , a‚àíi , s)
are speciÔ¨Åed to be a linear function of a Ô¨Ånite dimensional parameter vector Œ∏. This is the typical econometric
speciÔ¨Åcation that is commonly used in the empirical literature. In this section we describe a straightforward
estimation and inference procedure for this model.
    The deterministic part of the utility is assumed to take the form of
                                                                              
                                      Œ†i (ai , a‚àíi , si ) = Œ¶i (ai , a‚àíi , si ) Œ∏.                             (22)

In the above expression, the deterministic part of utility is a linear combination of a vector of basis functions,
Œ¶i (ai , a‚àíi , si ). For instance, we might let utility be a linear index as in our simple entry game example of the
previous section. Alternatively, we might choose Œ¶i (ai , a‚àíi , si ) to be a standard Ô¨Çexible functional form, such
as a high order polynomial, spline function or orthogonal polynomial. The estimator we discuss below can
easily be generalized to allow for the possibility that Œ∏ enters the utility nonlinearly. However, the exposition
of the properties of the estimator is facilitated by the linearity assumption. Also, most applications of
discrete choice models and discrete games usually are linear in the structural parameters of interest.
    This linearity assumption implies that the choice speciÔ¨Åc value function, given ai and s, takes the
convenient form:
                                                                                       
                             Œ†i (ai , s) = E [Œ†i (ai , a‚àíi , si ) |s, ai ] = Œ¶i (ai , s) Œ∏.                    (23)

where Œ¶i (ai , s) is deÔ¨Åned as:

                            Œ¶i (ai , s) =              E [Œ¶i (ai , a‚àíi , si ) |ai , s]                         (24)
                                                                        
                                        =        a‚àíi Œ¶i (ai , a‚àíi , si )  j=i œÉ(aj = kj |s).

    Arguing as in Section 2, it follows that if the error terms are distributed extreme value, the equilibrium
choice probabilities must satisfy:
                                                                    
                                                     exp Œ¶i (ai , s) Œ∏
                                   œÉi (ai |s) =      K                 
                                                                            .                                  (25)
                                                  1 + k=1 exp Œ¶i (k, s) Œ∏

                                                             13
    More generally, if the error terms are not distributed extreme value, it may not be possible to express the
equilibrium choice probabilities in closed form as above. However, equation (6) implies that each œÉi (ai |s)
depends on œÉj (aj |s) , j = i through (24). We denote this mapping as:

                              œÉi (ai |s) = Œìi,ai (s, œÉj (k|s) , j = i, k = 1, . . . , K) .                           (26)

If we deÔ¨Åne œÉ (s) to be the stacked vector of choice probabilities œÉi (k|s) for all k = 1, . . . , K, i = 1, . . . , n,
then we can collect (26) into a Ô¨Åxed point mapping:

                                                   œÉ (s) = Œì (œÉ (s)) .                                                (27)

To emphasize the dependence on the parameter Œ∏, we can also write

                                              œÉ (s; Œ∏) = Œì (s, Œ∏; œÉ (s; Œ∏)) .                                         (28)


4.2    Semiparametric Estimation.

Step 1: Estimation of Choice Probabilities. The simple semiparametric procedure we propose
proceeds in two steps. We begin by forming a nonparametric estimate of the choice probabilities, œÉÃÇi (k|s).
We will do this like above using a sieve approach, however, one could alternatively use kernels or a local
polynomial method.


                                                                ‚àí1
                                                                     
                                                                     T
                           œÉÃÇi (k|s) = q Œ∫(T ) (s) (QT QT )              q Œ∫(T ) (sœÑ )1 (ai = k) .                  (29)
                                                                     œÑ=1

Given our estimates of the choice probabilities, we can then estimate Œ¶i (k, s) correspondingly by
                                                                               
                                 Œ¶ÃÇi (k, s) =          Œ¶i (ai = k, a‚àíi , si )          œÉÃÇ(aj |s)                      (30)
                                                 a‚àíi                            j=i
                                                                                                           
For instance, take the example presented in (7). In this example, Œ†i (ai = 1, a‚àíi , s) = (s,               j=i   1{aj =
                                                                                                           
1})¬∑(Œ≤, Œ¥) where ‚Äú ¬∑‚Äù denotes an inner product. Thus, in the above formula, Œ¶i (ai = 1, a‚àíi ) = (s,           j=i 1{aj   =
                                                                                                       
1}) and Œ∏ = (Œ≤, Œ¥). Then, given our Ô¨Årst stage estimates of the choice probabilities, Œ¶ÃÇ (ai = 1, a‚àíi ) =
   
(s, j=i 1{aj = 1}œÉj (aj |s)).
    Then for each parameter value Œ∏, we can evaluate the empirical analogue of (28). For example, in the
multinomial logit case,
                                                                             
                                                                           
                                                         exp Œ¶ÃÇi (ai , s) Œ∏
                                œÉi       ai |s, Œ¶ÃÇ, Œ∏ =    K                                                       (31)
                                                                                
                                                        1 + k=1 exp Œ¶ÃÇi (k, s) Œ∏




                                                                14
Step 2: Parameter Estimation. In the second stage a variety of estimators can be used to recover
the value of Œ∏. Most of these estimators can be written as GMM estimators with a properly deÔ¨Åned set of
instruments. To describe the second stage, deÔ¨Åne yikt = 1 if ait = k and yikt = 0 otherwise, for k = 0, . . . , K.
DeÔ¨Åne yit = (yi1t , . . . , yiKt ) and the vector
                                                                                  
                                    œÉi st , Œ¶ÃÇ, Œ∏ = œÉi k|st , Œ¶ÃÇ, Œ∏ , k = 1, . . . , K                                (32)

Furthermore,
             collect yit , i = 1, . . . , n into a long
                                                        vector  yt with n √ó K elements, and similarly collect
œÉi st , Œ¶ÃÇ, Œ∏ , i = 1, . . . , n into a long vector œÉ st , Œ¶ÃÇ, Œ∏ with corresponding n √ó K elements. Then for
any dimension dim (Œ∏) √ó (nK) matrix of instruments AÃÇ (st ), a GMM estimator Œ∏ÃÇ can be deÔ¨Åned by solving
the sample equations:

                                            1 
                                               T                           
                                                  AÃÇ (st ) yt ‚àí œÉ st , Œ¶ÃÇ, Œ∏ÃÇ = 0.                                    (33)
                                            T t=1

The instrument matrix AÃÇ (st ) may be known as A (st ), may be estimated in the Ô¨Årst stage (such as two-step
optimally weighted GMM), or may be estimated simultaneously (such as pseudo MLE). For example, with
a pseudo MLE method, Œ∏ÃÇ is deÔ¨Åned by maximizing the pseudo likelihood function, which can be written as
the following because of the independent error terms across agents:
                  K                                                                 
           T n                                   
                                                      K              
                                                                     K                
                       yikt log œÉi k|st , Œ¶ÃÇ, Œ∏ + 1 ‚àí   yikt log 1 ‚àí   œÉi k|st , Œ¶ÃÇ, Œ∏     .                          (34)
            t=1 i=1   k=1                                               k=1                          k=1
                                                  
In the following we let œÉÃÇikt (Œ∏) = œÉi k|st , Œ¶ÃÇ, Œ∏ . The Ô¨Årst order condition for the ‚Äúpseudo‚Äù MLE estimator
is then given by
                                                   K                      
                                                                             ‚àÇ                 
                    T  n 
                                                     j=1 (yijt ‚àí œÉÃÇijt (Œ∏))
                            K
                                 yikt ‚àí œÉÃÇikt (Œ∏)
                                                  +      K                      œÉi k|st , Œ¶ÃÇ, Œ∏ÃÇ ,                   (35)
                   t=1 i=1 k=1
                                     œÉÃÇikt (Œ∏)       1 ‚àí j=1 œÉÃÇijt (Œ∏)        ‚àÇŒ∏

In term 
        of expressing
                       it as an instrumental variable estimator, this corresponds to (33) with AÃÇ (st ) equal to
the ‚àÇŒ∏ œÉ st , Œ¶ÃÇ, Œ∏ÃÇ √ó WÃÇ (st , Œ∏), where WÃÇ (st , Œ∏) is the nK √ó nK diagonal matrix, such that the ith diagonal
     ‚àÇ

block, for i = 1, . . . , n, is given by
                                  ‚é°    1
                                                                        ‚é§    ‚é°       1
                                                                                             ‚é§
                                     œÉÃÇi1t (Œ∏)      0          0                 œÉÃÇi0t (Œ∏)
                                 ‚é¢                                      ‚é• ‚é¢         ..       ‚é•
                                 ‚é¢                 ..                   ‚é•+‚é¢                  ‚é• [1 ¬∑ ¬∑ ¬∑ 1] ,          (36)
                                 ‚é£      0               .      0        ‚é¶ ‚é£          .       ‚é¶
                                                                1                    1
                                        0           0       œÉÃÇiKt (Œ∏)            œÉÃÇi0t (Œ∏)

                        K
where œÉÃÇi0t (Œ∏) = 1 ‚àí       j=1 œÉÃÇijt (Œ∏).    If we deÔ¨Åne W (st , Œ∏) in analog to WÃÇ (st , Œ∏), except with Œ¶ÃÇ replaced by
                                                                                                                      ‚àí1
the true unknown Œ¶ in each œÉÃÇikt (Œ∏), then it is easy to verify that W (st , Œ∏0 ) = V ar (yt ‚àí œÉ (st , Œ¶, Œ∏0 ) |st )       ,
where the ith diagonal block of the              block diagonal matrix V ar (yt ‚àí œÉ (st , Œ¶, Œ∏0 ) |st ) is given by
                           ‚é°                                ‚é§ ‚é°         ‚é§
                              œÉi1t                0     0         œÉi1t
                           ‚é¢                                ‚é• ‚é¢ . ‚é•
                           ‚é¢                     ..         ‚é• ‚é¢         ‚é•
                           ‚é£ 0                      .   0 ‚é¶ ‚àí ‚é£ .. ‚é¶ [œÉi1t ¬∑ ¬∑ ¬∑ œÉiKt ] .                             (37)
                               0                  0 œÉiKt          œÉiKt

                                                                        15
It is well known that the estimation errors in AÃÇ (st ) will not aÔ¨Äect the asymptotic distribution of Œ∏ÃÇ deÔ¨Åned
by (33), regardless of whether AÃÇ (st ) is estimated in a preliminary step or is estimated simultaneously with
Œ∏ÃÇ. Therefore, the asymptotic distribution of the pseudo MLE is the same as that of an infeasible GMM IV
estimator with an instrument matrix A(st ) which is given by
                                          ‚àÇ
                                             œÉ (st , Œ¶0 , Œ∏0 ) √ó W (st , Œ∏0 )                             (38)
                                          ‚àÇŒ∏
Here note that in terms of (28)
                                                                                   !
                            ‚àÇ                       ‚àÇ                              !
                               œÉ (st , Œ¶0 , Œ∏0 ) =     Œì (st , Œ∏1 , œÉ (st ; Œ∏2 )) !!                      (39)
                            ‚àÇŒ∏                     ‚àÇŒ∏1                               Œ∏1 =Œ∏2 =Œ∏

Therefore, assuming all Œ¶ are known, the MLE corresponds to the eÔ¨Écient choice of instruments AÃÇ (st )
in (33), under the eÔ¨Éciency framework of Newey and McFadden (1994). Therefore, next we will focus on
deriving the large sample properties of Œ∏ÃÇ deÔ¨Åned by (33) where A(st ) is known.
    The estimator that we consider falls within the class of semiparametric estimators considered by Newey
(1994). A somewhat surprising conclusion is that even though the Ô¨Årst stage is estimated nonparametrically
                                                      ‚àö
and can be expected to converge at a rate slower than T , the structural parameters will be asymptotically
                                      ‚àö
normal and will converge at a rate of T . Moreover, under appropriate regularity conditions, the second
stage asymptotic variance will be independent of the particular choice of nonparametric method used to
estimate the Ô¨Årst stage (e.g. sieve or kernel). As a practical matter, these results justify the use of the
bootstrap to calculate standard errors for our model.
    In the appendix, we derive the following result, applying the general framework developed by Newey
(1990). Under appropriate regularity conditions, the asymptotic distribution of Œ∏ÃÇ deÔ¨Åned in 33 satisÔ¨Åes the
following:
                                    ‚àö                     
                                                               
                                     T Œ∏ÃÇ ‚àí Œ∏ ‚àí‚Üí N 0, G‚àí1Œ©G‚àí1 ,
                                               d



where
                                                          ‚àÇ
                                         G = EA (st )        œÉ (st , Œ¶0 , Œ∏0 ) ,                          (40)
                                                          ‚àÇŒ∏
and Œ© is deÔ¨Åned such that

                             1 
                                 T                           
                                                                   d
                            ‚àö       A (st ) yt ‚àí œÉ st , Œ¶ÃÇ, Œ∏0    ‚àí‚Üí N (0, Œ©) .                           (41)
                              T t=1

In the appendix, we also compare the asymptotic variance of alternative estimators.


4.3     Linear Probability Model
Next, we demonstrate that in many cases it is possible to estimate our model using a simple two stage
least squares method. While the formal econometrics in this section are quite straightforward, we believe
that this observation is useful for researchers. Much of the previous literature on estimating games has
concentrated on the case of fully dynamic models and required an understanding of dynamic programming.

                                                              16
In this section, we demonstrate that the methods in their simplest version only require invoking the ivreg
command in STATA.
    To simplify notation, we will focus on a binary choice model in the following. The extension to multino-
mial models is straightforward. Therefore consider a special case of (1) where K = 1, Œ†i (0, a‚àíi , s) = i (0) ‚â°
                                                      
0, Œ∏, Œ¶i (1, a‚àíi , s; Œ∏) = Œ¶1i (si ) Œ≤ + Œ¶1i (a‚àíi , s) Œ≥ so that
                                                                                          
                                  ui (1, a‚àíi , s; Œ∏) = Œ¶1i (si ) Œ≤ + Œ¶2i (a‚àíi , s) Œ≥ + i (1) ,

and i (1) is uniformly distributed on the interval (‚àí1, 0). The decision rule of agent i is such that action 1
is chosen if and only if
                                                                  "                #
                        E [ui (1, a‚àíi , s; Œ∏) |s] = Œ¶1i (si ) Œ≤ + E Œ¶2i (a‚àíi , s) |s Œ≥ + i (1) > 0.

Because of the uniform distribution assumption of i (1), this implies that
                                                           "                #
                              P (ai = 1|s) = Œ¶1i (si ) Œ≤ + E Œ¶2i (a‚àíi , s) |s Œ≥,

which can be written as
                                                          "                #
                                       ai = Œ¶1i (si ) Œ≤ + E Œ¶2i (a‚àíi , s) |s Œ≥ + Œ∑it (1) ,                  (42)

such that E (Œ∑it (1) |st ) = 0.
  In this model Œ¶1i (si ) and Œ¶2i (a‚àíi , s) are known functions, but Œ≤ and Œ≥ are unknown parameters.
 " 2             #
E Œ¶i (a‚àíi , s) |s needs to be estimated nonparametrically. As before, this can be consistently estimated
by a linear least square regression with a suÔ¨Éciently large number of sieve approximating functions in the
Ô¨Årst step:
                         " 2             #                     ‚àí1
                                                                   
                                                                   T
                                              Œ∫(T )       
                       EÃÇ Œ¶i (a‚àíi , s) |s = q       (s) (QT QT )     q Œ∫(T ) (sœÑ ) Œ¶2i (a‚àíiœÑ , sœÑ ) .
                                                                              œÑ=1

In the second step, a linear regression is used to estimate Œ≤ and Œ≥:
                                           T 
                                                                        "                    # 2
                            Œ≤ÃÇ, Œ≥ÃÇ = arg min     ait ‚àí Œ¶1i (sit ) Œ≤ ‚àí EÃÇ Œ¶2i (a‚àíit , st ) |st Œ≥ .
                                           Œ≤,Œ≥
                                                 t=1

Note that this is precisely a two stage least square estimator. Also note that this is a special case of (33)
where
                                                                                              
                                                                       Œ¶1i (sit )
                                            AÃÇi (st ) =          "                     #           ,
                                                               EÃÇ Œ¶2i (a‚àíit , st ) |st
                                   "                    #
                              
and œÉ st , Œ¶ÃÇ, Œ∏ÃÇ = Œ¶1i (sit ) Œ≤ + EÃÇ Œ¶2i (a‚àíit , st ) |st and yit ‚àí œÉi (st , Œ∏0 ) = Œ∑it (1).
    In the following we will demonstrate that the ivreg procedure with the robust standard error options in
stata will give correct standard errors for this model, when ai is entered as the dependent variable, Œ¶1i (s) is
entered as the exogenous regressor, Œ¶2i (a‚àíi , s) is entered as the endogenous regressor, and q Œ∫(T ) (s) is used
as the set of instruments to instrument for Œ¶2i (a‚àíi , s). In other words, Œ≤ÃÇ and Œ≥ÃÇ are computed as
                                              
                                                           1
                                                              T
                                            Œ≤ÃÇ
                                    Œ∏ÃÇ =          = A‚àí1T        AÃÇi (st ) ait ,
                                            Œ≥ÃÇ             T t=1


                                                                    17
where
                                                     1 
                                                        T
                                                
                                                AT =       AÃÇi (st ) AÃÇi (st ) .
                                                     T t=1

Then it follows from a standard manipulation that
                                           
                               ‚àö                     1 
                                                         T
                                     Œ≤ÃÇ ‚àí Œ≤
                                 T            = A‚àí1
                                                  T ‚àö       mÃÇi (st , Œ≤, Œ≥) ,
                                     Œ≥ÃÇ ‚àí Œ≥           T t=1

where
                                                                          "                    # 
                                                                    
                        mÃÇi (st , Œ≤, Œ≥) = AÃÇi (st ) ait ‚àí Œ¶1i (sit ) Œ≤ ‚àí EÃÇ Œ¶2i (a‚àíit , st ) |st Œ≥ .

The asymptotic variance is then a special case of section (C). We will use a slightly diÔ¨Äerent notation here
to facilitate comparison with 2SLS. In particular, it follows from Newey (1994) that

                                    1                        1 
                                        T                         T
                                   ‚àö       mÃÇi (st , Œ≤, Œ≥) = ‚àö       mi (st , Œ≤, Œ≥) + op (1) ,
                                     T t=1                     T t=1

where mi (st , Œ≤, Œ≥) = Ai (st ) (Œ∑it (1) ‚àí vit (1) Œ≥) , and
                                                                     "                    #
                                       vit (1) = Œ¶2i (a‚àíit , st ) ‚àí E Œ¶2i (a‚àíit , st ) |st .

The asymptotic distribution of the 2SLS estimator is then given by, letting A = EAi (st ) Ai (st ) :
                                  ‚éõ                                                      ‚éû
              ‚àö         
                                  ‚éú                                                   ‚éü
                T Œ∏ÃÇ ‚àí Œ∏ ‚àí‚Üí N ‚éù0, A‚àí1 EAi (st ) V ar Œ∑it (1) ‚àí vit (1) Œ≥|st Ai (st ) A‚àí1 ‚é† .
                            d
                                                  $           %&            '
                                                                              Œ£(st )

To obtain a consistent estimate of this asymptotic variance matrix, both A and Œ£ (st ) needs to be estimated.
A can be estimated by AT . The key in estimating Œ£ (st ) is to estimate Œ∑it (1) ‚àí vit (1) consistently. This can
be estimated by
                                                      
            eit =ait ‚àí Œ¶1i (sit ) Œ≤ÃÇ ‚àí Œ¶2i (a‚àíit , st ) Œ≥ÃÇ
                                         "                  #                       "                    #
                =ait ‚àí Œ¶1i (sit ) Œ≤ÃÇ ‚àí E Œ¶2i (a‚àíit , st ) |st Œ≥ÃÇ ‚àí Œ¶2i (a‚àíit , st ) ‚àí E Œ¶2i (a‚àíit , st ) |st Œ≥ÃÇ.
                               
Then EAi (st ) Œ£ (st ) Ai (st ) can be consistently estimated by

                                                 1 
                                                    T
                                                                                   
                                                       AÃÇi (st ) eit eit AÃÇi (st ) .
                                                 T t=1

Now note that this is precisely how Stata ivreg calculates robust standard errors for 2SLS estimators.


5     Fixed eÔ¨Äect model of unobserved heterogeneity
5.1     Nonparametric identiÔ¨Åcation
Unobserved heterogeneity can be a potentially important source of misspeciÔ¨Åcation if it is not accounted for
in the model. In this section, we discuss how to introduce market speciÔ¨Åc Ô¨Åxed eÔ¨Äects into our model. For

                                                                 18
each market t = 1, . . . , T , all the players in that market observe a market speciÔ¨Åc proÔ¨Åt shifter Œ±t that is not
observed by the econometrician. We will assume that Œ±t is an unknown but smooth function of the state
variables st = (st1 , . . . , stn ) in that market, which we will denote as Œ± (st ). In principal, we would prefer a
model where the unobserved heterogeneity was not required to be a function of the observables. However,
in highly nonlinear models, such as ours, similar assumptions are commonly made (see, for example, Newey
(1994)).
    This assumption is convenient technically since it implies that the equilibrium choice probabilities, œÉi can
still be written as a function of the state st . If the unobserved heterogeneity were not a function of st , then
it would be quite diÔ¨Écult to estimate the choice probabilities, œÉi since they would depend on an unknown,
market speciÔ¨Åc parameter in a nonlinear manner. There is no obvious method to identify or estimate the
Ô¨Årst stage in this case.
    With the inclusion of a market speciÔ¨Åc Ô¨Åxed eÔ¨Äect, the mean period utility function in (1) for player i
in market t is now modiÔ¨Åed to

                                    Œ†i (ai , a‚àíi , s) = Œ± (ai , s) + Œ†ÃÉi (ai , a‚àíi , s).                              (43)

In the above, and what follows, we drop the market speciÔ¨Åc subscript t for notational simplicity.
    Under the normalization assumption that Œ†i (0, a‚àíi , s) ‚â° 0 for all i = 1, . . . , n, our previous results show
that, as in (14), the choice speciÔ¨Åc value functions Œ†i (ai , s) are nonparametrically identiÔ¨Åed. Note that the
choice speciÔ¨Åc value functions must satisfy ‚àÄi = 1, . . . , n, ai = 1, . . . , K:
                                                    
                             Œ†i (ai , s) =                œÉ‚àíi (a‚àíi |s)Œ†i (ai , a‚àíi , s)
                                                        a‚àíi
                                                         
                                       =     Œ± (ai , s) + a‚àíi œÉ‚àíi (a‚àíi |s)Œ†ÃÉi (ai , a‚àíi , si ).                       (44)

    Obviously, since Œ± (ai , s) is unknown but is the same function across all market participants, they can
be diÔ¨Äerenced out by looking at the diÔ¨Äerence of Œ†i (k, s) and Œ†j (k, s) between diÔ¨Äerent players i and j. By
diÔ¨Äerencing (44) between i and j one obtains
                                                                       
          Œ†i (k, s) ‚àí Œ†j (k, s) =   œÉ‚àíi (a‚àíi |s) Œ†ÃÉi (ai , a‚àíi , si ) ‚àí   œÉ‚àíj (a‚àíj |s) Œ†ÃÉj (aj , a‚àíj , sj )
                                     a‚àíi                                     a‚àíj

Here we can treat Œ†ÃÉi (ai , a‚àíi , si ) and Œ†ÃÉj (aj , a‚àíj , sj ) as coeÔ¨Écients, and œÉ‚àíi (a‚àíi |s) and œÉ‚àíj (a‚àíj |s) as regres-
sors in a linear regression. IdentiÔ¨Åcation follows as in Theorem 1. As long as there is suÔ¨Écient variation in the
state variables si , sj , the coeÔ¨Écients Œ†ÃÉi (ai , a‚àíi , si ) and Œ†ÃÉj (aj , a‚àíj , sj ) can be nonparametrically identiÔ¨Åed.
    We could nonparametrically estimate Œ†ÃÉj (aj , a‚àíj , sj ) using an approach analogous to the nonparametric
approach discussed in section Section 4. However, in practice, semiparametric estimation will typically be a
more useful alternative. Denote the mean utility (less the market speciÔ¨Åc Ô¨Åxed eÔ¨Äect) as:
                                                                                
                                       Œ†ÃÉi (ai , a‚àíi , si ) = Œ¶i (ai , a‚àíi , si ) Œ∏.                                  (45)

    In practice, we imagine estimating the structural model in two steps. In the Ô¨Årst step, we estimate
the equilibrium choice probabilities nonparametrically. In the second stage, we estimate Œ†ÃÉi treating Œ± (st )
as a Ô¨Åxed eÔ¨Äect in a discrete choice model. Estimating discrete choice models with Ô¨Åxed eÔ¨Äects is quite
straightforward is many cases.

                                                               19
    For instance, consider a model of entry and suppose that the error terms are distributed extreme value.
In the Ô¨Årst step, we nonparametrically estimate Œ¶ÃÇi (1, sit ), the probability of entry by Ô¨Årm i when the state is
sit . As in the previous section, we could do this using a sieve linear probability model. In the second stage,
we can form a conditional likelihood function as in Chamberlain (1984)). This allows us to consistently
estimate Œ∏ when market speciÔ¨Åc Ô¨Åxed eÔ¨Äects Œ± (st ) are present. The likelihood function is then:
                            n                                    n                     
                
                T                                                        
                                                                        
        log L =     log exp Œ∏       ait Œ¶ÃÇi (1, sit )   ‚àí log     exp Œ∏      dit Œ¶ÃÇi (1, sit )
                   t=1                        i=1                       dt ‚ààBt          i=1
                     n                n
where Bt ‚â° {dt :         i=1   dit =    i=1    ait } is the set of actions that give rise to the same number of entrants
as observed in the data. In other words, the likelihood is formulated conditional on the number of entrants.
One can follow similar steps as in previous derivations to prove consistency and demonstrate asymptotic
normality of this semiparametric conditional logit estimator where Œ¶ÃÇi (1, sit ) is estimated in the Ô¨Årst stage
nonparametrically.
    We also note that we could estimate this model using a using a panel data rank estimation type procedure
as in (Manski (1987)). While this is a more challenging model computationally, it is free of distributional
assumptions on the error term.


6     Computing Models with Multiple Equilibria.
In the previous sections, we have either assumed that the model has a unique equilibrium (which can be the
case, for example, for a linear probability interaction model), or that only a single equilibrium outcome out of
several possible multiple equilibria is being observed in the data set. However, in many static game models,
multiple equilibria are possible. The importance of multiple equilibria in empirical research is emphasized
by many authors, including Brock and Durlauf (2001) and Sweeting (2005). In the rest of this manuscript
we present a method for estimating parametric models of interactions in the presence of possible multiple
equilibria.
    In the previous sections we have considered a model with known distribution F (i ) of the error terms
and a parametric model for the mean utility functions Œ†i (ai , a‚àíi , Œ∏). At every possible parameter value
Œ∏, given the known distribution F (i ), equations (10), (12) and (14) deÔ¨Åned a Ô¨Åxed point mapping in the
conditional choice probabilities:
                                                                                                           
                                
              œÉi (ai |s) = Œìi     œÉa‚àíi (a‚àíi |s) [Œ†i (k, a‚àíi , s; Œ∏) ‚àí Œ†i (0, a‚àíi , s; Œ∏) , k = 1, . . . , K] .     (46)
                                   ‚àíi

For example, under the linear mean utility speciÔ¨Åcation (5), this system of Ô¨Åxed point mappings in the choice
probabilities takes the form of
                                 ‚éõ                                                      ‚éû
                                  
                 œÉi (ai |s) = Œìi ‚éù  œÉ‚àíi (a‚àíi |s)Œ¶i (ai , a‚àíi , s) Œ∏, ai = 1, . . . , K ‚é† , i = 1, . . . , n.      (47)
                                        a‚àíi


    In previous sections, we have assumed that either there is a unique solution to this system of Ô¨Åxed


                                                               20
mapping with K √ó n equations and K √ó n unknown variables

                                      œÉi (ai |s) , ‚àÄai = 1, . . . , K, i = 1, . . . , n,

or that only one particular Ô¨Åxed point of this system gets realized in the observed data. However, this
system of Ô¨Åxed point mapping can potentially have multiple solutions, leading to the possibility of multiple
equilibria.
    In the following of this section, we will Ô¨Årst give a brief introduction to the use of homotopy methods
for Ô¨Ånding multiple solutions to a system of nonlinear equations. We will then discuss how the homotopy
method can be used to compute multiple equilibria for our model of static interactions. In the next section,
we will describe an innovative estimation method that we develop for estimating the parameters in static
interaction models with multiple equilibria. While brief, this section is highly technical. Readers can proceed
to the application in section 7 after reading section 6.1.


6.1    The homotopy method
The homotopy continuation method (which will simply be referred to as the homotopy method in the rest of
the paper) is a well known generic algorithm for looking for a Ô¨Åxed point to a system of nonlinear equations.
Based on the particular nonlinear system of equations to be solved, a well designed homotopy system is
capable of Ô¨Ånding multiple solutions of the nonlinear system, and in some cases, all solutions to the system.
A concise and clear introduction to the homotopy method can be found in the book by Zangwill and Garcia
(1981). Algorithms for implementing the homotopy method can be found in several papers including Watson,
Billups, and Morgan (1987), Kostreva and Kinard (1991), ? and ?.
    Our goal is to Ô¨Ånd, for all possible parameter values and realized state variables s, the solutions for the
Ô¨Åxed point system (28):

                                                     œÉ ‚àí Œì (œÉ) = 0.

To simplify the notation, we suppress the fact that the choice probabilities depend on the state œÉ = œÉ (s).
    The basic idea behind the homotopy method is to take a system for which we know the solution and
map this system into the system that we are interested in. Under the right conditions, the solution to the
original system will also map into the solution that we are seeking. Formally, a homotopy is a linear mapping
between the two topological spaces of functions of the form

                             H (œÉ, œÑ ) = œÑ G (œÉ) + (1 ‚àí œÑ ) (œÉ ‚àí Œì (œÉ)) ,            œÑ ‚àà [0, 1] ,               (48)

where each of H (œÉ, œÑ ) and G (œÉ) are vectors of functions with n √ó K component functions:

                    Hi,ai (œÉ, œÑ )   and Gi,ai (œÉ)       for i = 1, . . . , n and           ai = 1, . . . , K.

    H (œÉ, œÑ ) is the homotopy function and œÑ is the homotopy parameter. As one can see, for œÑ = 1 we get
H (œÉ, 0) = G (œÉ) and for œÑ = 0 we obtain H (œÉ, 0) = œÉ ‚àí Œì (œÉ) so varying œÑ from 1 to 0 maps the function
G (¬∑) into the function Œì(¬∑). The homotopy method suggests that we start with œÑ = 1 and choose G (œÉ) to


                                                             21
be a system for which it is very easy to obtain the solutions to G (œÉ) = 0. If for each 0 ‚â§ œÑ < 1, we can solve
for the nonlinear equations, H (œÉ, œÑ ) = 0, then by moving along the path in the direction of œÑ = 1 to œÑ = 0,
at the end of the path we should be able to reach a solution of the original nonlinear equations œÉ ‚àí Œì (œÉ) = 0.
This path then constructs a mapping between a solution of the initial system G (œÉ) = 0 and a solution to
the Ô¨Åxed point problem of interest, œÉ ‚àí Œì (œÉ) = 0.
    In practice, algorithms for solving diÔ¨Äerential equations can be used to trace the path from œÑ = 1 to
œÑ = 0. At each œÑ , we denote the solution along a particular path by œÉ (œÑ ):

                                                   H (œÉ (œÑ ) , œÑ ) = 0.

By diÔ¨Äerentiating this homotopy function with respect to œÑ :
                                      d                   ‚àÇH   ‚àÇH ‚àÇœÉ
                                        H (œÉ (œÑ ) , œÑ ) =    +   ¬∑   = 0.
                                     dœÑ                   ‚àÇœÑ   ‚àÇœÉ ‚àÇœÑ
This deÔ¨Ånes a system of diÔ¨Äerential equations for œÉ (œÑ ) with initial condition œÉ (1) calculated from the
solution of the (easy) initial system G (œÉ (1)) = 0. A number of computer algorithms are available to
compute numerical solutions of nonlinear systems of diÔ¨Äerential equations can then be used to trace this
diÔ¨Äerential equation system to reach an end point in the path of œÑ = 1 to œÑ = 0 in order to obtain a solution
œÉ (0) of the original system œÉ ‚àí Œì (œÉ) = 0.
    A regularity condition is necessary to insure the stability and the proper behavior of the homotopy
diÔ¨Äerential equation system.

Condition 1 (Regularity) Let ‚àá (œÑ ) denote the Jacobian of the homotopy functions with respect to œÉ at
the solution path œÉ (œÑ ):
                                                                    !
                                                    ‚àÇ               !
                                        ‚àá (œÑ ) =      Re{H (œÉ, œÑ )}!!        ,
                                                   ‚àÇœÉ                 œÉ=œÉ(œÑ)

where Re{H (œÉ, œÑ )} denotes the real component of the homotopy functions. The jacobian ‚àá (œÑ ) has full rank
for almost all œÑ .

    This condition ensures the smoothness and diÔ¨Äerentiability of the paths. It rules out cases of bifurcation,
branching and inÔ¨Ånite spiraling. The mapping between G (œÉ) and œÉ ‚àí Œì (œÉ) is called a conformal one if the
path that links them is free of these complications. If a homotopy system satisÔ¨Åes the regularity condition,
it will either reach a solution or drift oÔ¨Ä to inÔ¨Ånity.
    Obviously, in applied work where the system of diÔ¨Äerential equations above will be solved numerically, it
will be convenient to work with conformal mappings. A convenient way of generating a conformal mapping,
or a homotopy that satisÔ¨Åes the above regularity condition, is to extend the original homotopy into the
complex space. A homotopy, as deÔ¨Åned in equation (48) is extended to the complex space by permitting
the argument œÉ to take on complex values, which will result in complex values of the homotopy. When the
real and complex components of œÉ are considered two diÔ¨Äerent sets of arguments, and the real and complex
components of the output are considered two diÔ¨Äerent sets of components of the homotopy, this deÔ¨Ånes
a real valued homotopy with 2nK inputs and 2nK outputs. If the original homotopy (48) is an analytic

                                                           22
function in the complex space, then the Cauchy-Riemann conditions will ensure that the extended real-value
2nK √ó 2nK homotopy system satisÔ¨Åes the regularity condition above.
       The all solution homotopy is one where the initial system G (œÉ) is chosen such that, if we follow the paths
originating from each of the solutions to G (œÉ) = 0, we will reach all solutions of the original system œÉ = Œì (œÉ)
at the end of the path. The extension of a real homotopy system into the complex space is essential to the
idea of all-solution homotopy. It is related with the property of the complex space that conformal mappings
                                                                                3
in the complex space do not change the algebraic properties of the sets.            The concept of conformal mapping
is widely used in complex analysis. It implies that we can conformally map a function with a complicated
set of roots to another function with a simple set of roots, then the results from an analysis of the function
with the simple set of roots should apply to the function with the complicate set of roots. An all solution
homotopy has to satisfy an additional path Ô¨Åniteness condition:

Condition 2 (Path Finiteness) Define H ‚àí1 (œÑ ) to be the set of solutions œÉ (œÑ ) to the homotopy system
at œÑ . H ‚àí1 (œÑ ) is bounded for all 0 ‚â§ œÑ < 1. In other words, for all œÑ > 0.

                                                   lim H (œÉ, œÑ ) = 0.
                                                ||œÉ||‚Üí‚àû


6.2       Multiple equilibria in static discrete games
As we noted in the previous section, the issue of multiple equilibria in static interaction models amounts
to the issue of computing all the Ô¨Åxed points to the system of equations of choice probabilities deÔ¨Åned in
equation (46). Note that the argument to the mapping from expected utility to choice probabilities, Œì (¬∑),
is linear in the choice probabilities of competing agents œÉ‚àíi (a‚àíi |s). Therefore, the question of possible
multiplicity of equilibria depends crucially on the functional form of Œì, which in turn depends exclusively on
the assumed joint distribution of the error terms.
       Interestingly, if we are content with the linear probability model where Œì is a linear function of the
individual choice probabilities, and the model has only two agents, then the equilibrium will be guaranteed
to be unique and the issue of multiple equilibria is not relevant. Œì is a linear function of the individual
choice probabilities if the underlying utility functions depend linearly on the indicator function of whether
individual competitors make a particular choice or not. For example, this would be the case if the proÔ¨Åt
from entering a market depends on the total number of competitors who also enter the market. On the
other hand, if we have nonlinear interactions of the individual choice probabilities in the linear probability
model, or if the joint distribution of the error term in the multinomial choice model is speciÔ¨Åed such that Œìi
is a polynomial function for each i = 1, . . . , n, then all the equilibria can be found by choosing a homotopy
system where the initial system of equations

                                  Gi,ai (œÉ) ,   i = 1, . . . , n and ai = 1, . . . , K.
   3
       The conformal mapping is a mapping in the complex space that does not locally change the argument of a
complex number. It is known that if the function is analytic and does not have stationary points then the associated
mapping is conformal.



                                                           23
takes the following simple polynomial form:

                                        qi,ai
                   Gi,ai (œÉ) = œÉi (ai )         ‚àí 1 = 0 for           i = 1, . . . , n and ai = 1, . . . , K,   (49)

where qi,ai is an integer that exceeds the degree of the polynomial of Œìi,ai as a function of œÉ‚àíi (a‚àíi ). This
results in a homotopy mapping

                                                qi,ai
                   Hi,ai (œÉ, œÑ ) = œÑ {œÉi (ai )          ‚àí 1} + (1 ‚àí œÑ ) (œÉi (ai ) ‚àí Œìi,ai (œÉ)) , œÑ ‚àà [0, 1].    (50)

For œÑ = 0 the system (48) coincides with the original system while for œÑ = 1 it is equal to the ‚Äôsimple‚Äô system
(49).
    It is a well known result from complex analysis that there are exactly qi,ai complex roots to Gi,ai (œÉ) that
are evenly distributed on the unit circle. It is known that nondegenerate polynomial functions are analytic
and the regularity condition of the resulting homotopy system is automatically satisÔ¨Åed. The particular
choice of qi,ai also ensures the path Ô¨Åniteness property of the homotopy system (c.f. Zangwill and Garcia
(1981)).
    While a polynomial model for Œì (¬∑) is convenient for calculating multiple equilibria, it is rarely used in
applied problems because it is not clear what parametric utility speciÔ¨Åcation will give rise to a polynomial
choice probability function. The most popular multinomial choice probability function is probably the
multinomial logit, which follows from the assumption of i.i.d. extreme value distributions in the unobserved
component of the latent utilities. The logit choice model is given in (25). Our analysis in the following will
consist of three steps. First we will establish that this model has a Ô¨Ånite number of equilibria represented
by real solutions to (25). Second, we will show that by letting the degree of the initial polynomial system
increase to inÔ¨Ånity at an appropriate rate, we will be able to Ô¨Ånd all the equilibria for the multinomial logit
choice model (25) using the homotopy method. We prove it by Ô¨Årst verifying that the homotopy mapping
is regular in the complex space when the discontinuity points of the original function are isolated, and then
providing a method to make homotopy work in the small vicinity of discontinuity points.
    It is not diÔ¨Écult to show that the Ô¨Åxed point system (25) has a Ô¨Ånite number of solutions in the real
line. To see this, note that in general, this function is clearly continuous and inÔ¨Ånitely diÔ¨Äerentiable with
nonsingular derivatives. In particular, it is easy to verify this condition for the multinomial logit and probit
models that are commonly used in practice. Consider a compact ball BR in RnK with radius larger than
1. By Sard‚Äôs theorem the set of irregular values of Œì (¬∑) has measure zero. In particular, it can be veriÔ¨Åed
by diÔ¨Äerentiation through the implicit function theorem that zero is its regular value. This implies that the
submanifold of œÉ satisfying œÉ = Œì (œÉ) is compact as a closed subset of this ball BR . Thus it contains a
Ô¨Ånite number of points. This veriÔ¨Åes that the set of solutions in BR in Ô¨Ånite. It is also obvious that all the
solutions must satisfy 0 ‚â§ œÉi (ai ) ‚â§ 1 because of the choice probability functional form. Therefore there can
not be solutions outside BR .
    While we have just shown that there are in general a Ô¨Ånite number of multiple equilibria, to compute
these equilibria we need to make use of an all solution homotopy system. In particular, we choose to use the
all solution homotopy deÔ¨Åned in (50). In the following we will show that there exists a homotopy system
of the form of (50) with a suÔ¨Éciently high orders of the initial system qi,ai ‚Äôs, such that we will Ô¨Ånd all the


                                                                 24
solution to the original system of choice probabilities. As described in the previous subsection, verifying
the validity of the all solution homotopy requires checking the regularity condition and the path Ô¨Åniteness
condition, which in terms require extension of the real homotopy system into the complex space. Verifying
these conditions require us to specify the particular functional form of the joint distribution of the error
terms in the latent utilities. In the following we will focus on the multinomial logit case which is the most
widely used discrete choice model in the empirical literature.
    The following Theorem 2 and Theorem 3 formally state this result. In the statement of the theorems,
œÉ = {œÉr , œÉi } denotes more generally a vector of the real part and the imaginary part of complex numbers
which extend the real choice probabilities we considered early into the complex space. Theorem 2 Ô¨Årst
establishes the regularity properties of the homotopy outside the imaginary subspace.

Theorem 2 Define the sets H ‚àí1 = {(œÉr , œÉi , œÑ ) | H(œÉr , œÉi , œÑ ) = 0} and

                   H ‚àí1 (œÑ ) = {(œÉr , œÉi ) | H(œÉ, œÑ ) = 0}    for   œÉr ‚àà RnK ,   and   œÉi ‚àà RnK .

Note that H is a homotopy of dimension R2nK that include both real and imaginary parts separately. Also
define, for any small , ‚Ñò = ‚à™i,ai {|œÉr,i,ai | ‚â§ } to be the area around the imaginary axis. Then:

1) The set H ‚àí1 ‚à© {R2nK \ ‚Ñò √ó [0, 1]} consists of closed disjoint paths.

2) For any œÑ ‚àà (0, 1] there exists a bounded set such that H ‚àí1 (œÑ ) ‚à© R2nK \ ‚Ñò is in that set.

3) For (œÉr , œÉi , œÑ ) ‚àà H ‚àí1 ‚à©{R2nK \‚Ñò √ó[0, 1]} the homotopy system allows parametrization H(œÉr (s), œÉi (s), œÑ (s)) =
      0. Moreover, œÑ (s) is a monotone function.

Remark: Theorem 2 establishes the regularity and path Ô¨Åniteness conditions for the homotopy (50) for
the multinomial logit model in areas that are not close to the pure imaginary subspace in the complex
domain CnK . The homotopy system can become irregular along the pure imaginary subspace, because the
denominator in the system can approach zero and the system will become nonanalytic in the case. However,
the next theorem shows that there exists a sequence q such that homotopies with initial system of order q
will have paths that stay away from the imaginary subspace. Homotopies with these orders will be able to
trace out all the solutions of the original multinomial logit system.

Theorem 3 For given œÑ one can pick the power qi,ai of the initial function (49) such that the homotopy
system is regular and path finite given some sequence of converging polyhedra ‚Ñò ,  ‚Üí 0.

    Theorem 3 implies that if we continue to increase the power qi,ai of the initial system (49) of the
homotopy, we will eventually be able to Ô¨Ånd all the solutions to the original multinomial logit system. This
also implies, however, we might lose solutions when we continue to increase qi,ai . But Theorem 3 does
imply that for suÔ¨Éciently large qi,ai , no new solutions will be added for larger powers. In the monte carlo
simulation that we will report in the next section, we do Ô¨Ånd this to be the case.




                                                             25
6.3    Monte Carlo Analysis
We perform several Monte-Carlo simulations for an entry game with a small number of potential entrants.
Player‚Äôs payoÔ¨Ä functions for each player i were constructed as linear functions of the indicator of the rival‚Äôs
entry (ai = 1), market covariates and a random term:
                                           ‚éõ           ‚éû
                                            
               Ui (ai = 1, a‚àíi ) = Œ∏1 ‚àí Œ∏2 ‚éù  1(aj = 1)‚é† + Œ∏3 x1 + Œ∏4 x2 + i (a), i = 1, . . . , n.          (51)
                                              j=i


The payoÔ¨Ä of staying out is equal to Ui (ai = 0, a‚àíi ) = i (a), where the i (a) have i.i.d extreme value
distributions across both a and i. The coeÔ¨Écients in the model are interpreted as: Œ∏1 is the Ô¨Åxed beneÔ¨Åt of
entry, Œ∏2 is the loss of utility when one other player enters, Œ∏3 , Œ∏4 are the sensitivities of the beneÔ¨Åt of entry
to market covariates.
    The game can be solved to obtain ex-ante probabilities of entry in the market. The solution to this
problem is given by:                            
                                        eŒ∏1 ‚àíŒ∏2 (    j=i   Pj )+Œ∏3 x1 +Œ∏4 x2
                               Pi =                                                , i = 1, . . . , n.       (52)
                                      1 + eŒ∏1 ‚àíŒ∏2 (      j=i   Pj )+Œ∏3 x1 +Œ∏4 x2

Here Pi is the ex-ante probability of entry for the player i, Pi = p (ai = 1|x). Both coeÔ¨Écients of the model
and market covariates were taken from independent Monte-Carlo draws. The parameters of generated
random variables are presented in Table 6.1. The means and variances of parameter values and market
covariates were chosen so to have a fair percentage of cases with more then one equilibrium. For the games
with 3,4 and 5 players 400 independent parameter combinations for every player were taken. The modiÔ¨Åcation
of the HOMPACK algorithm was run to solve for all equilibria in each game.
    Throughout the Monte-Carlo runs both coeÔ¨Écients and covariates x1 and x2 were changing. So, every
equilibrium was calculated for a speciÔ¨Åc set of parameters. Summary statistics for the results of computations
are presented in Table 6.1. It is possible to see from Table 6.1 that in the constructed games the players
have approximately same average parameters in every type of game. This agrees with the symmetric form
of underlying data generating process for the coeÔ¨Écients and market covariates.
    Table 6.2 and 6.3 tabulate the frequencies of diÔ¨Äerent number of equilibria that are being observed in the
simulations, classiÔ¨Åed according to the number of players in the market. Interestingly, a dominant number
of simulations have only a single equilibrium. In addition, the frequency of observing multiple equilibria
seems to decrease with the number of players in the market. In other words, we observe a large number of
multiple equilibria in the two player case but only observe a handful of them in the Ô¨Åve player case.
    Table 6.4 tabulates the probability of entry of the Ô¨Årst player classiÔ¨Åed by the number of equilibria
and the number of players in the market. In general, what we see from this table is that there is no clear
correlation pattern between the entry probability and the numbers of equilibria and players in the market.




                                                                  26
7        Application to stock market analysts‚Äô recommendations and
         peer eÔ¨Äects
Next, we discuss an application of our estimators to the problem of analyzing the behavior of equity market
analysts and the stock recommendations that they issue (e.g. strong buy, buy, hold sell). There is a fairly
sizeable empirical literature on this topic. However, the literature does not allow for strategic interactions
between analysts. We believe that this is a very strong assumption. Accurate forecasts and recommendations
are highly valued, of course. But the penalty for issuing a poor recommendation depends on whether
competitor analysts also made the same poor recommendation. Therefore, the utility an analyst receives
from issuing a recommendation is a function of the recommendations issued by other analysts. Therefore,
we apply the framework discussed in the previous sections to allow payoÔ¨Äs to be interdependent.
        There has been a revival of interest on the determinants of analyst recommendations as researchers
have tried to explain the remarkable behavior of the analysts in the run-up and subsequent collapse of the
                       4
NASDAQ in 2000.            The focus in this paper is on the recommendations generated for Ô¨Årms in the high tech
sector, which includes the Ô¨Årms most aÔ¨Äected by the excitement surrounding the development of e-commerce
and the spread of the Internet. Given the great uncertainty surrounding the demand for new products and
new business models, the late 1990‚Äôs would seem to have been the perfect environment for equity analysts to
add value. Yet analyst recommendations were not particularly helpful or proÔ¨Åtable during this period. For
example, the analysts were extremely slow to downgrade stocks, even as it was apparent that the market
had substantially revised its expectations about the technology sector‚Äôs earnings potential. Barber, Lehavey,
McNichols, and Trueman (2003) show that the least recommended stocks earned an average abnormal return
of 13% in 2000-2001, while the most highly recommended stocks earned average abnormal returns of -7%.
Observations like this have led commentators to wonder whether the analysts had ulterior motives for keeping
their recommendations unjustiÔ¨Åably optimistic, such as the pressure to win investment banking business.
Allegedly, this conÔ¨Çict of interest took the form of analysts keeping recommendations on stocks high in order
to appease Ô¨Årms, who would then reward the analyst‚Äôs company by granting it underwriting business or
other investment advisory fees.5 Indeed, these suspicions came to a head when New York State Attorney
General Elliot Spitzer launched an investigation into conÔ¨Çicts of interest in the securities research business.
        In this application we develop an empirical model of the recommendations generated by stock analysts
from the framework outlined in section 1. We quantify the relative importance of four factors inÔ¨Çuencing
the production of recommendations in a sample of high technology stocks during the time period between
1998 and 2003.
    4
        See for example Barber, Lehavey, McNichols, and Trueman (2003) and Chan, Karceski, and Lakonishok (2003).
Research prior to the NASDAQ collapse includes Womack (1996), Lin and McNichols (1998), and Michaely and
Womack (1999).
  5
    In 1998, Goldman Sachs estimated that Jack Grubman, a prominent telecommunications industry analyst, would
bring in $100 to $150 million in investment banking fees. This estimate was based on the fees generated by 32 of
the stocks he covered that also had banking relationships with Citigroup, including WorldCom, Global Crossing and
Winstar Communications. (Wall Street Journal, October 11, 2002).




                                                         27
       First, recommendations must depend on expectations about the future proÔ¨Åtability of a Ô¨Årm. There
should be some systematic component to these expectations common across all analysts and investors that
will be embedded in the current stock price.
       Second, analysts are heterogeneous, both in terms of talent and perhaps in terms of access to information.
We try to capture an individual analyst‚Äôs private belief about the stock by looking at the diÔ¨Äerence between
the quarterly earnings forecast submitted by the analyst (or the analyst‚Äôs brokerage Ô¨Årm) and the distribution
of forecasts from other Ô¨Årms.
       Mindful of the large number of inquiries into possible conÔ¨Çicts of interest among research analysts, we
include as a third factor a dummy variable for an investment banking relationship between the Ô¨Årm and the
analyst‚Äôs employer.
       Finally, we consider the inÔ¨Çuence of peers on the recommendation decision. Peer eÔ¨Äects can impact the
recommendation in diÔ¨Äerent ways. Individual analysts have incentive to condition their recommendation
on the recommendations of their peers, because even if their recommendations turn out to be unproÔ¨Åtable
ex-post, performance evaluation is typically a comparison against the performance of peers. More subtly,
recommendations are relative rankings of Ô¨Årms and are not easily quantiÔ¨Åable (or veriÔ¨Åable) objects. As such,
ratings scales usually reÔ¨Çect conventions and norms. The phenomenon is similar to the college professor‚Äôs
problem of assigning grades. If a professor were to award the average student with a C while other faculty give
a B+ to the average student, the professor might incorrectly signal his views of student performance. Even
while there is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance. Similarly,
analysts have an incentive to benchmark their recommendations against perceived industry norms.


7.1       Data
Our data consist of the set of recommendations on Ô¨Årms that made up the NASDAQ 100 index as of
year-end 2001. The recommendations were collected from Thomson Firstcall. Firstcall is one of the most
comprehensive historical data sources for analysts‚Äô recommendations and earnings forecasts, containing real-
time recommendations and forecasts from hundreds of analysts. It is common for analysts to rate Ô¨Årms on
a 5 point scale, with 1 denoting the best recommendation and 5 denoting the worst. When this is not the
case, Firstcall converts the recommendations to the 5 point scale (see Table 7.1).
       We have 12,719 recommendations from analysts at 185 brokerage Ô¨Årms over this time period (see Table
7.2). The dependent variable in our data set is a recommendation submitted between January of 1998
and June of 2003 for a Ô¨Årm in the NASDAQ 100. The data set was formed by merging the earnings and
recommendations Ô¨Åles from Firstcall. In a given quarter, for a given stock, we merge a quarterly earnings
forecast with a recommendation from the same brokerage.6 This will allow us to determine if analysts that
are more optimistic than the consensus tend to give higher recommendations. In the Firstcall data, quarterly
earnings forecasts are frequently made more than a year in advance. In order to have a consistent time frame,
   6
       When there were multiple recommendations by the same analyst within a quarter, we chose to use the last
recommendation in the results that we report.




                                                        28
we limit analysis to forecasts that were made within the quarter that the forecast applies.7 Note that not
every recommendation can be paired with an earnings forecast made within the contemporaneous quarter.
Recommendations that could not be paired with an earnings forecast were dropped from the results that
we report. However, qualitatively similar results were found for a data set where this censoring was not
performed. We choose not to report these results in the interests of brevity. The variables in our data
include:

       ‚Ä¢ REC- Recommendation from 1-5 for a stock listed in the NASDAQ 100 recorded by I/B/E/S.

       ‚Ä¢ QUARTER- Quarter during which the recommendation was submitted.

       ‚Ä¢ STOCK-Name of the stock for which the recommendation applies.

       ‚Ä¢ BROKERAGE-The brokerage employing the analyst.

       ‚Ä¢ EPS-Earnings per share forecast submitted by the analyst‚Äôs brokerage associated with the recommen-
         dation. Submitted during the same quarter as the recommendation.

       ‚Ä¢ AEPS-Average of the earnings per share forecasts submitted for that quarter.

       ‚Ä¢ %DEV-(EPS-APS)/APS, the percent deviation of an individual broker‚Äôs earnings forecast from the
         average earning‚Äôs forecast.

       ‚Ä¢ RELATION-A dummy variable that is one if the analyst‚Äôs brokerage engages in investment banking
         business with the company to which the recommendation applies.

       ‚Ä¢ IBANK-A dummy variable that is equal to one if the brokerage does any investment banking business
         with stocks in the NASDAQ 100.

       The investment banking relationship was identiÔ¨Åed from several diÔ¨Äerent sources. First, we checked form
424 Ô¨Ålings in the SEC‚Äôs database for information on the lead underwriters and syndicate members of debt
issues. When available, we used SEC form S-1 for information on Ô¨Ånancial advisors in mergers. We also
gathered information on underwriters of seasoned equity issues from Securities Data Corporation‚Äôs Platinum
database. To be sure, transaction advisory services (mergers), and debt and equity issuance are not the only
services that investment banks provide. However, these sources contribute the most to total proÔ¨Åtability of
the investment banking side of a brokerage Ô¨Årm.
       The average recommendation in our data set is 2.2, which is approximately a buy recommendation (see
Table 7.2). The mean value of RELATION is 0.035. The mean value of IBANK is 0.81. That is, 3.5 percent of
the analyst-company pairs in our data set were identiÔ¨Åed as having a potential conÔ¨Çict of interest due to some
kind of investment banking activity for the stock in question. Eighty-one percent of the recommendations
in our data were generated by Ô¨Årms engaging in investment banking with some Ô¨Årm list in the NASDAQ
100. Both of these variables are potentially useful measures of potential conÔ¨Çict of interest. The variable
   7
       We chose to merge the brokerage Ô¨Åeld, instead of the analysts Ô¨Åeld, because the names and codes in the analysts
Ô¨Åeld were not recorded consistently across IBES data sets for recommendations. It was possible to merge at the level
of the brokerage.


                                                           29
RELATION is more direct, since it indicates that the brokerage is engaged in investment banking with the
company during the quarter the recommendation was issued. However, brokerages might view any company
it is giving a recommendation to as a potential client, particularly in the NASDAQ 100, where many of the
companies generated considerable investment banking fees.
    The variable earnings was formed by merging the recommendations and earnings Ô¨Åles in Firstcall. In a
given quarter, for a given stock, we merge the quarterly earnings forecast with the recommendation from the
same brokerage. This allows us to determine if analysts that are more or less optimistic than the consensus
tend to give higher recommendations. In the Firstcall data, quarterly earnings forecasts are frequently made
more than a year in advance. In order to have a consistent time frame, we limit analysis to forecasts that
were made within the quarter for which the forecast applies. We chose to merge the brokerage Ô¨Åeld, instead
of the analysts Ô¨Åeld, because the names and codes in the analysts Ô¨Åeld were not recorded consistently across
Firstcall data sets for recommendations. It was possible to merge at the level of the brokerage. Note that
not every recommendation can be paired with an earnings forecast made in the contemporaneous quarter.


7.2    Empirical model
An observation is a recommendation submitted for a particular stock during a speciÔ¨Åc quarter. We will
let t = 1, ..., T denote a quarter, s = 1, ..., S a stock and and i = 1, ..., I an analyst. We will denote a
particular recommendation by ri,s,t. The recommendation can take on integer values between 1 and 5, where
1 is the highest recommendation and 5 the lowest. Since the dependent variable can be naturally ranked
from highest to lowest, we will assume that the utilities come from an ordered logit. Let x(i, s, t) denote a
set of covariates that inÔ¨Çuence the recommendation for analyst i for stock s during quarter t. Let x(s, t)
denote a vector of (x(i, s, t)) of payoÔ¨Ä relevant covariates that enter into the utility of all the analysts who
submit a recommendation for stock s during quarter q. Let z(s, t) denote a set of covariates that shift the
equilibrium, but which do not inÔ¨Çuence payoÔ¨Äs.
    DeÔ¨Åne the utility or payoÔ¨Ä to analyst i for a recommendation on stock s in quarter t to be,


                               yi,s,t = Œ≤  x(i, s, t) + Œ∑E(r|x(s, t), z(s, t)) + Œµi,s,t                   (53)


In equation (53), the term E(r|x(s, t), z(s, t)) is the expected recommendation for stock s during quarter t
and Œµi,s,t is an error term drawn from an extreme value model. Thus, conforming to the expected actions
of peers enters into an individual analyst‚Äôs utility. The model would is the familiar ordered logit, where the
probability that a particular recommendation is observed is determined as follows:




                                                          30
                         P (r = 1) = Œ¶(‚àíŒ≤  x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                        (54)
                         P (r = 2) = Œ¶(Œº1 ‚àí Œ≤  x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                    (55)
                                       
                              ‚àí Œ¶(‚àíŒ≤ x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                               (56)
                                                 
                         P (r = 3) = Œ¶(Œº2 ‚àí Œ≤ x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                      (57)
                              ‚àí Œ¶(Œº1 ‚àí Œ≤  x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                         (58)
                                                 
                         P (r = 4) = Œ¶(Œº3 ‚àí Œ≤ x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                      (59)
                              ‚àí Œ¶(Œº2 ‚àí Œ≤  x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                         (60)
                         P (r = 5) = 1 ‚àí Œ¶(Œº3 ‚àí Œ≤  x(i, s, t) ‚àí Œ∑E(r|x(s, t), z(s, t)))                (61)



In equations (53)-(61), the likelihood that determines the probability that the recommendation is r depends
on the latent estimated covariates Œ≤ and Œ∑ along with the cut points Œº1 ‚àí Œº3 .
   The analysis of the previous section suggests that identiÔ¨Åcation depends crucially on having appropriate
exclusion restrictions. First, we need covariates that inÔ¨Çuence the payoÔ¨Äs of one particular agent, but not
other agents. In our analysis, the covariates will include IBANK and RELATION. This assumption would
imply, for instance, that the amount of investment banking done by Merrill Lynch should not directly
inÔ¨Çuence the recommendations submitted by analysts working for Goldman Sachs. We believe that this is a
reasonable assumption.
   In addition, we have attempted to control for unobserved heterogeneity in several ways. First, in many
speciÔ¨Åcations, we include a full set of stock and quarter Ô¨Åxed eÔ¨Äects to control for factors that remain Ô¨Åxed
in a quarter that inÔ¨Çuence recommendations. Second, we have controlled for unobserved heterogeneity using
both a Ô¨Åxed eÔ¨Äects and random eÔ¨Äects speciÔ¨Åcation. Equations (53)-(61) imply that the probability of 1 or
a recommendation between 2 and 5 is a binary logit. This implies that we can estimate our model using a
Ô¨Åxed eÔ¨Äect logit speciÔ¨Åcation. We choose to present a random eÔ¨Äect logit speciÔ¨Åcation since almost all of
the coeÔ¨Écient estimates in the Ô¨Åxed eÔ¨Äects logit model were insigniÔ¨Åcant. Given the number of observations
in our data, we believe that the Ô¨Åxed eÔ¨Äect logit model is too diÔ¨Äusely speciÔ¨Åed. We therefore use random
eÔ¨Äects instead.


7.3     Results

7.3.1    Fundamentals

The Ô¨Årst question that we ask is the extent to which recommendations were determined by publicly observable
information about the stocks. In our data, these fundamentals correspond to time Ô¨Åxed eÔ¨Äects, stock Ô¨Åxed
eÔ¨Äects and the diÔ¨Äerence between an individual analyst‚Äôs beliefs about earnings and beliefs in the market as
whole. In Table 7.4, we run an ordered logit to explore these questions. The variable %DEV is the percentage
deviation of an analyst‚Äôs recommendation from the average recommendation and ABS. DEV is the algebraic
diÔ¨Äerence. In both cases, a more optimistic earnings forecast has the anticipated sign, but is not signiÔ¨Åcant


                                                       31
at conventional levels in any of the speciÔ¨Åcations that we have tried. On the other hand, quarterly and stock
Ô¨Åxed eÔ¨Äects are almost all statistically signiÔ¨Åcant (not reported in this Table). If quarter and stock Ô¨Åxed
eÔ¨Äects proxy for publicly available information about the stock, then this information is considerably more
important than measures of an individual analyst‚Äôs optimism. We note, however, that there could be other
interpretations of these variables.
    In Table 7.5, we report the estimated quarterly Ô¨Åxed eÔ¨Äects and compare these estimates to the NASDAQ
Index and NASDAQ 100. The quarterly eÔ¨Äects are labeled qdum2-qdum22 for the 2nd quarter (1998.Q2)
through the 22nd quarter (2003.Q2) of our data set. Several points emerge. First, the quarterly eÔ¨Äects
are typically signiÔ¨Åcant. Second, the quarterly eÔ¨Äects are highly correlated with the NASDAQ index and
with the QQQ. We take these results as evidence that the quarterly eÔ¨Äects can reasonably be interpreted
as reÔ¨Çecting publicly observed information about the the Ô¨Årms that is embedded in the share prices as
opposed to some other latent eÔ¨Äects. The movement in share prices can explain most of the movement in the
recommendations in the previous tables. In Table 7.6, we regress the quarterly dummies on these indexes.
We Ô¨Ånd that the indexes are statistically signiÔ¨Åcant at conventional levels and that the measures of goodness
of Ô¨Åt are quite high.


7.3.2    ConÔ¨Çicts of Interest

In Table 7.7 we run an ordered logit model of recommendations as a function of our conÔ¨Çict of interest
measures. The coeÔ¨Écient on RELATION indicates that potential conÔ¨Çicts of interest are statistically signif-
icant at conventional levels, except for the third column where quarterly and stock Ô¨Åxed eÔ¨Äects are included,
and the fourth column where the full set of Ô¨Åxed eÔ¨Äects are included along with the more inclusive IBANK
variable. The coeÔ¨Écient sign on RELATION is also consistent with our a priori beliefs that conÔ¨Çicts of in-
terest could lead to issuing more favorable recommendations. Consistent with the work of prior researchers
and market regulators, these results do suggest that a potential conÔ¨Çict of interest exists when a brokerage
engaged in investment banking business with a company that quarter. However, these results must be in-
terpreted with some caution. Since brokerage Ô¨Årms are expected to cover companies with whom they have
signiÔ¨Åcant investment banking business, the Ô¨Årms have an incentive to select brokerages that already view
them favorably. It would be hard to imagine that a rational manager would want to hire an investment
banking Ô¨Årm that views her company in an unfavorable manner.
    Interestingly, we note (column 4 of table 7.7) that when we include the IBANK variable denoting that
the brokerage Ô¨Årm has investment banking relationships with at least one Ô¨Årm in the index, the coeÔ¨Écient is
positive and signiÔ¨Åcant. Evidently, analysts at general investment banking Ô¨Årm tend to issue slightly more
conservative recommendations. This is consistent with a view of the world that companies tended to select
investment banking Ô¨Årms that were more favorably disposed towards them. Alternatively, our results could
be interpreted as suÔ¨Äering from a bias due to some omitted variable.
    Our results suggest that even though investment banking relationships may generate potential conÔ¨Çicts
of interest for equity analysts, the magnitude of the eÔ¨Äects recommendations may be small in practice. No-
tice that measures of the goodness of Ô¨Åt are very low when only investment banking is included. Also, the
marginal eÔ¨Äects of engaging in investment banking are small. In our data, the expected recommendation


                                                     32
is -0.08 when we allow for quarterly Ô¨Åxed eÔ¨Äects, but not stock Ô¨Åxed eÔ¨Äects. This Ô¨Ånding is not consistent
with the prosecutors belief that ‚Äúunbiased‚Äù research, separate from investment banking, will generate rec-
ommendations less tainted by potential conÔ¨Çicts of interest. However, the behavior of analysts after large
settlements have been paid and signiÔ¨Åcant damage has been done to their brokerage‚Äôs reputation, in some
cases, may be more conservative.


7.3.3    Peer EÔ¨Äects

The Ô¨Ånal question we consider is whether there are peer eÔ¨Äects in submitting recommendations. We do
this in Tables 7.8-7.10 by using the two stage procedure described in the previous sections. We regress the
recommendations on a broker Ô¨Åxed eÔ¨Äect, a full set of stock and quarterly dummies, IBANK, RELATION,
and %DEV. In Table 7.8, the regressions are done using linear regression while in the later tables we use
a 3rd order spline. We will let IVBELIEF denote the expected average recommendation, excluding broker
i. If the coeÔ¨Écient on IVBELIEF is positive, this means that broker i has an incentive to conform to the
recommendations of other brokers. If it is negative, it means there is a return from submitting a dissenting
recommendation.
    In all of the speciÔ¨Åcations that we examine in Table 7.8, peer eÔ¨Äects seem to be important. An individual
analyst will raise his recommendation proportionally to the recommendation that he expects from other
analysts. This is intuitive. A given recommendation does not make senses in isolation, but only relative to
the recommendations of other analysts. If no one else in the market is issuing recommendations of ‚Äúmarket
underperform‚Äù or ‚Äúsell‚Äù, an individual analysts may give the wrong signal by issuing such a recommendation
even if he believes the recommendation is literally true. It is worth noting that the results for our measure of
peer eÔ¨Äects are not only statistically signiÔ¨Åcant, but peer eÔ¨Äects also explain the results quite well compared
to the other covariates. The Pseudo-R2 suggests that quarterly dummies, stock dummies and IVBELIEF
explain most of the variation in the data. We note that the presence of the peer eÔ¨Äect is robust to allowing
for a more Ô¨Çexible Ô¨Årst stage (see Table 7.9). Also, the peer eÔ¨Äect remains signiÔ¨Åcant allowing for unobserved
heterogeneity in the form of a stock/quarter speciÔ¨Åc random eÔ¨Äect in Table 7.10.
    With estimates of the model‚Äôs key parameters in hand, it is possible to simulate the model and Ô¨Ånd the
set of equilibria to the analyst recommendation game. In keeping with the static nature of our analysis, we
solve for all possible equilibria at two points in time: the Ô¨Årst just prior to the regulatory regime change in
2000.Q1, and then again in 2003.Q1 after the Spitzer inquiry was well-underway. These results are based
on assuming that there are two analysts making a recommendation and that the recommendations are
determined as in (53)-(61). All of the variables are set to their sample averages for 2000.Q1 and 2003.Q1
respectively. The parameter values were set equal to the estimates in the last column of Table 7.8. Since we
are interested in the eÔ¨Äect of investment banking on recommendations, we consider two cases: one is when
IBANK is 0 for both players and the other when it is 1 for both players.
    Evidently, the pre-Spitzer era was characterized by two diÔ¨Äerent equilibria (see Table 7.11). These
equilbrium diÔ¨Äer by a roughly uniform, upward shift in the overall recommendation. This is consistent with
our story that there is the possibility of multiple equilibrium in our model, one of which has ‚Äúgrade inÔ¨Çation‚Äù.
In the post-Spitzer era, there was only one equilibrium. Overall, recommendations fall compared to either


                                                      33
equilibrium in the pre-Spitzer era. This can be attributed, in large part, to the poor environment for high
technology stocks during this period.
     We note that the average recommendation tends to fall when the Ô¨Årms engage in investment banking
business. This is because the coeÔ¨Écient on IBANK is positive in our estimates. Our model suggests that,
contrary to the allegations made by the prosecutor and in the press, on average, engaging in investment
banking does not tend to generate higher recommendations on average.


8      Conclusion
In this paper we propose a method for estimating static games of incomplete information. The method
we propose is semiparametric and does not require the covariates to lie in a discrete set. Perhaps most
importantly, the method is both Ô¨Çexible and easy to implement using standard statistical packages. We also
introduce an algorithm for computing all equilibria to a game, which is useful for policy simulations using
the estimated model.
     We apply these methods to the problem of determining the factors that govern the assignment of stock
recommendations by equity analysts for a set of high tech stocks between 1998 and 2003. Two factors seem
to be most important for explaining the production of stock recommendations. First, publicly observable
information about the stocks under recommendation, as reÔ¨Çected in our time and quarter dummies, plays
a large role in explaining the distribution of recommendations. As we saw in Table 7.3, these variables
explained a large fraction of the variation in the data and were highly correlated with market indexes such
as the NASDAQ or QQQ. Simply put, recommendations improved in 1999-2000 as the stock market rose.
The second and most important factor for explaining recommendations is the peer group eÔ¨Äect. Individual
analysts raise their recommendations proportionally to the recommendations they expect from their peers.
Investment banking relationships are shown to be statistically signiÔ¨Åcant in the recommendations regressions,
but the economic eÔ¨Äect of the investment banking relationship is estimated to be small, and the variable
does not add much to the total Ô¨Åt of the model.




References
Aguirregabiria, V., and P. Mira (2002): ‚ÄúSequential simulation-based estimation of dynamic discrete
    games,‚Äù Technical Report, Boston University.

Ai, C., and X. Chen (2003): ‚ÄúEÔ¨Écient Estimation of Models with Conditional Moment Restrictions
    Containing Unknown Functions,‚Äù Econometrica, 71(6), 1795‚Äì1843.

Allgower, E. L., and K. Georg (1980): Numerical Continuation Methods. An Introduction. Springer-
    Verlag.

Aradillas-Lopez, A. (2005): ‚ÄúSemiparametric Estimation of a Simultaneous Game with Incomplete In-
    formation,‚Äù working paper, University of California, Berkeley.

                                                      34
Augereau, A., S. Greenstein, and M. Rysman (2005): ‚ÄúCoordination vs. diÔ¨Äerentiation in a standards
  war: 56K modems,‚Äù working paper, Boston University.

Bajari, P., L. Benkard, and J. Levin (2004): ‚ÄúEstimating Dynamic Models of Imperfect Competition,‚Äù
  working paper.

Bajari, P., and H. Hong (2004): ‚ÄúSemiparametric Estimation of a Dynamic Game of Incomplete Infor-
  mation,‚Äù working paper, University of Michigan.

Bajari, P., H. Hong, and S. Ryan (2004): ‚ÄúIdentiÔ¨Åcation and Estimation of Discrete Games of Complete
  Information,‚Äù Working paper, Department of Economics, Duke University.

Barber, B., R. Lehavey, M. McNichols, and B. Trueman (2003): ‚ÄúReassessing the Returns To
  Analysts‚Äô Stock Recommendations,‚Äù Financial Analysts Journal.

Berry, S. (1992): ‚ÄúEstimation of a model of entry in the airline industry,‚Äù Econometrica, 60(4), 889‚Äì917.

Berry, S., A. Pakes, and M. Ostrovsky (2003): ‚ÄúSimple estimators for the parameters of dynamic
  games (with entry/exit examples),‚Äù Technical Report, Harvard University.

Bjorn, P. A., and Q. Vuong (1984): ‚ÄúSimultaneous Equations Models for Dummy Endogenous Variables:
  A Game Theoretic Formulation with an Application to Labor Force Participation,‚Äù SSWP No. 537,
  Caltech.

Bresnahan, T., and P. Reiss (1991a): ‚ÄúEmpirical Models of Discrete Games,‚Äù Journal of Econometrics,
  48, 57‚Äî81.

         (1991b): ‚ÄúEntry and competition in concentrated markets,‚Äù Journal of Political Economy, 99,
  977‚Äì1009.

         (1991c): ‚ÄúEntry and competition in concentrated markets,‚Äù Journal of Political Economy, 99,
  977‚Äì1009.

Brock, W., and S. Durlauf (2001): ‚ÄúDiscrete Choice with Social Interactions,‚Äù Review of Economic
  Studies, 68, 235‚Äì260.

Chamberlain, G. (1984): ‚ÄúPanel Data,‚Äù in Handbook of Econometrics, Vol. 2, ed. by Z. Griliches, and
  M. Intriligator. North Holland.

Chan, L., J. Karceski, and J. Lakonishok (2003): ‚ÄúAnalysts‚Äô ConÔ¨Çict of Interest and Biases in Earnings
  Forecasts,‚Äù University of Illinois Working Paper.

Ciliberto, F., and E. Tamer (2003): ‚ÄúMarket Structure and Multiple Equilibria in Airline Markets,‚Äù
  North Carolina State University and Princeton University.




                                                      35
Haile, P., A. Hortacsu, and G. Kosenok (2003): ‚ÄúOn the Empirical Content of Quantal Response
  Equilibrium,‚Äù working paper, Yale University.

Ho, K. E. (2005): ‚ÄúInsurer-Provider Networks in the Medical Care Market,‚Äù working paper, Columbia
  University.

Hotz, J., and R. Miller (1993): ‚ÄúConditional Choice Probabilties and the Estimation of Dynamic Mod-
  els,‚Äù Review of Economic Studies, 60, 497‚Äì529.

Ishii, J. (2005): ‚ÄúInterconnection Pricing, Compatibility, and Investment in Network Industries: ATM
  Networks in the Banking Industry,‚Äù working paper, Stanford University.

Kostreva, M. M., and L. A. Kinard (1991): ‚ÄúA diÔ¨Äerential homotopy approach for solving polynomial
  optimization problems and noncoorperative games,‚Äù Computers and Mathematics with Applications, 21,
  135‚Äì143.

Lin, H., and M. McNichols (1998): ‚ÄúUnderwriting Relationships, Analysts‚Äô Earnings Forecasts, and
  Investment Recommendations,‚Äù Journal of Accounting Economics, 25, 1‚Äì34.

Manski, C. F. (1987): ‚ÄúSemiparametric Analysis of Random EÔ¨Äect Linear Models from Binary Panel
  Data,‚Äù Econometrica, 55(2), 357‚Äì362.

Manuszak, M., and A. Cohen (2004): ‚ÄúEndogenous Market Structure with Discrete Product DiÔ¨Äerentia-
  tion and Multiple Equilibria: An Empirical Analysis of Competition Between Banks and Thrifts,‚Äù working
  paper.

McKelvey, R., and T. Palfrey (1995): ‚ÄúQuantal Response Equilibria for Normal Form Games,‚Äù Games
  and Economic Behavior, 10(1), 6‚Äì38.

Michaely, R., and K. Womack (1999): ‚ÄúConÔ¨Çict of Interest and Credibility of Underwriter Analyst
  Recommendations,‚Äù Review of Financial Studies, 12, 653‚Äì686.

Newey, W. (1990): ‚ÄúSemiparametric EÔ¨Éciency Bounds,‚Äù Journal of Applied Econometrics, 5(2), 99‚Äì135.

           (1994): ‚ÄúThe Asymptotic Variance of Semiparametric Estimators,‚Äù Econometrica, 62, 1349‚Äì82.

Newey, W., and D. McFadden (1994): ‚ÄúLarge Sample Estimation and Hypothesis Testing,‚Äù in Handbook
  of Econometrics, Vol. 4, ed. by R. Engle, and D. McFadden, pp. 2113‚Äì2241. North Holland.

Pakes, A., J. Porter, K. Ho, and J. Ishii (2005): ‚ÄúMoment Inequalities and Their Application,‚Äù working
  paper, Harvard University.

Pesendorfer, M., and P. Schmidt-Dengler (2003): ‚ÄúIdentiÔ¨Åcation and Estimation of Dynamic
  Games,‚Äù NBER working paper No. w9726.




                                                   36
Rust, J. (1994): ‚ÄúStructural Estimation of Markov Decision Processes,‚Äù in Handbook of Econometrics, Vol.
  4, ed. by R. Engle, and D. McFadden, pp. 3082‚Äì146. North Holland.

Seim, K. (2005): ‚ÄúAn Empirical Model of Firm Entry with Endogenous Product-Type Choices,‚Äù forthcom-
  ing, Rand Journal of Economics.

Sweeting, A. (2005): ‚ÄúCoordination Games, Multiple Equilibria and the Timing of Radio Commercials,‚Äù
  Northwestern University Working Paper.

Tamer, E. (2003): ‚ÄúIncomplete Simultaneous Discrete Response Model with Multiple Equilibria,‚Äù Review
  of Economic Studies, 70(1).

Watson, L. T., S. C. Billups, and A. P. Morgan (1987): ‚ÄúAlgorithm 652 HOMPACK: A Suite of
  Codes of Globally Convergent Homotopy Algorithms,‚Äù ACM Transactions on Mathematical Software,
  13(3), 281‚Äì310.

Watson, L. T., M. Sosonkina, R. C. Melville, A. P. Morgan, and H. F. Walker (1997): ‚ÄúAlgo-
  rithm 777: HOMPACK90: A Suite of Fortran 90 Codes for Globally Convergent Homotopy Algorithms,‚Äù
  ACM Transactions on Mathematicsl Software, 23(4), 514‚Äì549.

Womack, K. (1996): ‚ÄúDo Brokerage Analyst Recommendations Have Investment Value,‚Äù Journal of Fi-
  nance, 51(1), 137‚Äì167.

Zangwill, W. I., and C. B. Garcia (1981): Pathways to Solutions, Fixed Points, and Equilibria. Prentice-
  Hall.



A      Proof for Theorem 2
Before we set out to prove the theorem we need to introduce some notations. Collapse the indexation for
i = 1, . . . , n and ai = 1, . . . , K to a single index j = 1, . . . , nK. In other words, each j represents a (i, ai )
pair. First we will rewrite the expression (47) for the case of multinomial choice probability as:

                                                       exp (Pj (œÉ))
                                          œÉj =                           ,                                          (62)
                                                 1+     k‚ààIi exp (Pk (œÉ))

where Ii = {(i, ai ) , ai = 1, . . . , K} is the set of all indices j = (i, ai ) that corresponds to the set of strategies
available to player i, and Pj (œÉ) is the expected utility associated with player i for playing ai when j = (i, ai ):
                                                    
                               Pj (œÉ) = Pi,ai (œÉ) =     œÉ‚àíi (a‚àíi |s) Œ¶i (ai , a‚àíi , s) Œ∏,
                                                        a‚àíi

which is in general a polynomial function in œÉj . Let P(¬∑) denote the vector-function of polynomials of size
nK √ó 1 that collects all the elements Pj (¬∑) for j = 1, . . . , nK. Let Q be the product of the degrees of the
                                                                           nK
polynomial over all elements of the vector P(¬∑). In other words, Q = j=1 Qj where Qj is the degree of
polynomial Pj (¬∑). For each complex argument Œæ ‚àà CnK the system of polynomials has exactly Q solutions.

                                                              37
Because of this, for each Œæ ‚àà CnK we can Ô¨Ånd Q vectors œÉ ‚àó such that P(œÉ ‚àó ) = Œæ. Let us denote each
                          ‚àí1
particular vector œÉ ‚àó by P(k) (Œæ).
      The complex-valued vector P(¬∑) of dimension nK √ó 1 can be transformed into a real-valued vector of
dimension 2nK √ó1 by considering separately real and complex part of vector P(¬∑). Because of the polynomial
                ‚àí1
property, each P(k) (Œæ) is a continuously diÔ¨Äerentiable function of Œæ for almost all Œæ. It is possible that for
                                                            ‚àí1           ‚àí1                   
some range of the argument Œæ, two (or more) solution paths P(k) (Œæ) and P(k  ) (Œæ) for k = k might coincide

with each other. In this case we will relabel the paths k so that the merged paths create a total Q of smooth
                ‚àí1
solution paths P(k) (Œæ).
                                                                   ‚àí1
      The following analysis will apply to each individual branch P(k) (Œæ), which we will just denote by P ‚àí1 (Œæ)
without explicit reference to thepath indice k. For j = 1, . . . , nK introduce the following notations: Œæj =
                                   yj
xj + iyj , œÅj = Œæj , œïj = arctan xj . Then a homotopy system can be constructed for (62) as:
                                                                        (
                           H1j (Œæ, œÑ ) = {œÅqj cos(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Re{P ‚àí1 (Œæ)}‚àí
                                                                                                         )
                                            e2xj +exj cos(yj )+ k=j exj +xk cos(yj ‚àíyk )
                           ‚àí 1+          e2xk +2
                                                         xk
                                                                      
                                                             cos(yk )+ l‚ààI
                                                                                     xk +xl
                                                                                             cos(yl ‚àíyk )
                                   k‚ààIi             k‚ààI e
                                                        i                      k=l e
                                                                               i


and
                                                                        (
                           H2j (Œæ, œÑ ) = {œÅqj sin(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Im{P ‚àí1 (Œæ)}‚àí
                                                                                                          )
                                                exj sin(yj )+ k=j exk +xj sin(yj ‚àíyk )
                           ‚àí 1+                                     
                                          e2xk +2 k‚ààI exk cos(yk )+ l‚ààI
                                                                                      xk +xl
                                                                                              cos(yl ‚àíyk )
                                   k‚ààIi                 i                      ik=l e



      If the system P(¬∑) is polynomial, P ‚àí1 (Œæ) is smooth and has a Jacobian of full rank for almost all Œæ.
Therefore, we can locally linearize it so that P ‚àí1 (Œæ) ‚âà ŒõŒæ + C. (This expansion is used only for the purpose
of clarity. A suÔ¨Écient fact for the validity of the proof is that there exist Œõ and C such that |P ‚àí1 (Œæ)| ‚â§ Œõ|Œæ|+C
which is true if P(¬∑) is a polynomial.) The homotopy system can then be written as:
                                                                           (
                          H1j (Œæ, œÑ ) = {œÅqj cos(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Œõj xj ‚àí
                                                                                                )
                                        e2xj +exj cos(yj )+ k=j exj +xk cos(yj ‚àíyk )                              (63)
                          ‚àí 1+        2x
                                      e k +2
                                                     x
                                                    e k cos(yk )+
                                                                              x +x
                                                                              e k l cos(yl ‚àíyk )
                                   k‚ààIi             k‚ààIi                  l‚ààIi     k=l


and
                                                                        (
                           H2j (Œæ, œÑ ) = {œÅqj sin(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Œõj yj ‚àí
                                                                                                        )
                                                exj sin(yj )+ k=j exk +xj sin(yj ‚àíyk )                            (64)
                           ‚àí 1+                                     
                                          e2xk +2 k‚ààI exk cos(yk )+ l‚ààI
                                                                                      xk +xl cos(y ‚àíy )
                                   k‚ààIi                 i                      ik=l e             l  k



where Œõj is the jth row of the nK √ó nK matrix Œõ. Without loss of generality we will let C = 0 in subsequent
analysis for the sake of brevity because all the results will hold for any other given C. To simplify notation
we will denote:
                                                                             
                       Œòi (x, y) =          e2xk + 2          exk cos(yk ) +               exk +xl cos(yl ‚àí yk )
                                     k‚ààIi              k‚ààIi                    l‚ààIi k=l

Now given some index k ‚àà {1, . . . , Q}, we consider the solutions of the system {H(x, y, œÑ )} = 0 for all possible
real values of the vectors of x and y.
      Now we set out to prove the statements of Theorem 2. First we will prove statement (2). DeÔ¨Åne œÅ = Œæ
to be the Euclidean norm of the entire nK √ó 1 vector Œæ. We need to prove that there will not be a sequence

                                                                  38
of solutions along a path where œÅ ‚Üí ‚àû. We will show this by contradiction. Consider a path where œÅ ‚Üí ‚àû.
Choose the component j of the homotopy system for which œÅqj cos(q œïj ) ‚Üí ‚àû at the fastest rate among all
                                                  8
the possible indexes j where œÅj ‚Üí ‚àû.
       Consider the real part of the homotopy function, H1j (¬∑, ¬∑, ¬∑). The equation H1j (x, y, œÑ ) = 0 is equivalent
                         H1j (x,y,œÑ)
to the equation     œÑ (œÅqj cos(q œïj )‚àí1)
                                           = 0 for œÅj > 1. The last equation can be rewritten as:
                                              *                                                      +
                       (1 ‚àí œÑ )                      e2xj + exj cos(yj ) + k=j exj +xk cos(yj ‚àí yk )
               1+  q                          Œõ x‚àí
                                                  j
                                                                                                        = 0.                     (65)
                 œÑ œÅj cos(q œïj ) ‚àí 1                                   1 + Œòi (x, y)

We will show that the second term in the curly bracket of the previous equation is uniformly bounded from
above in absolute terms:
               ! 2xj                                          !
               ! e + exj cos(yj ) + k=j exj +xk cos(yj ‚àí yk ) !
               !                                               !‚â§C                        and for a constant C,                  (66)
               !                1 + Œòi (x, y)                  !

where the constant C can depend on . Therefore the term in the curly bracket in the homotopy (65) will
                                                                                            
grow at most at a linear rate |x| ‚â§ CœÅj . On the other hand, denominator œÑ œÅqj cos (qœïj ) ‚àí 1 outside the
curly bracket grows at a much faster polynomial rate for large q. Hence the second term in (65) is close to 0
for large q for large values of Œæ, and equation (65) can not have a sequence of solutions that tends to inÔ¨Ånity.
       In other words, there exists R0 > 0 such that for any Œæ = (x, y) outside ‚Ñò with Œæ ‚â• R0 and any
œÑ ‚àà (0, 1] we have that H1 (x, y, œÑ ) = 0, that is, homotopy system does not have solutions. This implies that

                          H ‚àí1 (œÑ ) ‚à© ‚Ñò ‚äÇ BR
                                           œÑ
                                             0
                                               = {(x, y, œÑ ) ‚àà R2nK \ ‚Ñò √ó (0, 1] ‚à© Œæ < R0 }.

This proves the statement 2).
       Finally, we will prove both statements 1) and 3) of Theorem 2. Again we consider the above homotopy
                           œÑ
system on the compact set BR 0
                               . The homotopy function is analytic in this set so Cauchy - Riehmann
theorem holds. This implies that
                         ‚àÇH1j   ‚àÇH2j                     ‚àÇH1j    ‚àÇH2j
                              =                 and           =‚àí      ,      for all j, k = 1, . . . , 2nK.
                         ‚àÇxk     ‚àÇyk                      ‚àÇyk     ‚àÇxk
       This means that if the Jacobian is considered:
                                               ‚àÇH                 ‚àÇH1j    ‚àÇH1j
                                                                                  
                                                              1j
                                                            ‚àÇx     ‚àÇy     ‚àÇœÑ
                                                  Ji =      ‚àÇH2j   ‚àÇH2j    ‚àÇH2j       ,
                                                             ‚àÇx    ‚àÇy     ‚àÇœÑ
                                                                                                       2       2
                                                                                                 ‚àÇH1j        ‚àÇH
then it contains at least one 2√ó2 submatrix with nonnegative determinant                         ‚àÇxk      + ‚àÇy1jk
                                                                                                                     . Calculating the
derivatives directly due to the fact that  < œÅ < R0 this determinant is strictly positive for all (x, y, œÑ ) ‚àà BR
                                                                                                                 œÑ
                                                                                                                   0
                                                                                                                     .
   8
       In case when instead of œÅqj cos(q œïj ) ‚Üí ‚àû we have that œÅqj sin(q œïj ) ‚Üí ‚àû, the proof can be appropriately modiÔ¨Åed
by considering the imaginary part of the j-th element of the homotopy system without any further changes. The logic
of the proof can be seen to hold as long as there is a slower growing element of x or y. In case when all components
of x and y grow at the same rate to inÔ¨Ånity in such a way that the second terms inside the curly brackets of (63) and
(64) explode to inÔ¨Ånity, one can take a Laurent expansion around the values of yk ‚Äôs such that the denominators are
close to zero. Then one can see that these terms in (63) and (64) explode to inÔ¨Ånity at quadratic and linear rates in
1/(y ‚àí y‚àó ), respectively. Therefore (63) and (64) can not both be zero simultaneously for large x and y.


                                                                   39
Therefore, the implicit function theorem veriÔ¨Åes that the pair (x, y) can be locally parameterized by œÑ .
Moreover, this representation is locally unique and continuous. This proves the Ô¨Årst statement. The same
arguments above, which show that the determinant is positively almost everywhere, also immediately implies
the third statement.                                                                                                        2

Proof of equation (66):
    We are to bound the left hand side of equation (66) by a given constant. First of all we can bound the
denominator from below by
                              ,           , ,                                         ,
                              ,          , ,
                                            ,                
                                                                                      ,
                                                                                      ,
                              ,       2xk , ,
              1 + Œòi (x, y) ‚â• ,1 +   e , ‚àí ,2    xk
                                                e cos(yk ) +     exk +xl
                                                                         cos(yl ‚àí yk ),
                                                                                      ,,
                              ,           , ,                                         ,
                                         k‚ààIi                  k‚ààIi                    l‚ààIi k=l


as a + b ‚â• a ‚àí b . Then we can continue to bound:
                                                                                                  
                       1 + Œòi (x, y) ‚â• 1 +            k‚ààIi   e2xk ‚àí 2      k‚ààIi   exk ‚àí       l‚ààIi       k=l e
                                                                                                               xk +xl
                                                                                                                      .   (67)

The last expression was obtained taking into account the fact that
                                                     
                           max 2       exk cos(yk ) +        exk +xl cos(yl ‚àí yk )
                             yk , k‚ààIi
                                           k‚ààIi                       l‚ààIi k=l

is attained at the point cos(yk ) ‚â° cos(yk ‚àí yl ) = 1, ‚àÄk, l ‚àà Ii .
For the same reason, we can bound the numerator from above by
                  ,                                            ,
                  , 2xj                                         ,
                  ,e + exj cos(yj ) + k=j exj +xk cos(yj ‚àí yk ), ‚â§ e2xj + exj cos(yj )
                                             ,               
                                              ,
                  + k=j exj +xk cos(yj ‚àí yk ), ‚â§ e2xj + exj + k=j exj +xk .

    Recall that j - th component was assumed to be the fastest growing x component as œÅ ‚Üí ‚àû. Then from
equation (67) for some small but positive constant œà we can write:

                                                  1 + Œòi (x, y) ‚â• 1 + œàe2xj

    Collecting terms we have that:
                                                                                              
                         e2xj +exj cos(yj )+ k=j exj +xk cos(yj ‚àíyk )            1+e2xj +exj + k=j exj +xk
                                         1+Œòi (x,y)
                                                                              ‚â§            1+œàe2xj
                                                                                                                   .

which is clearly uniformly bounded from above by a large constant.
    The same arguments can be used by looking at the imaginary part of the homotopy system when there
exists a yj that converges to inÔ¨Ånity at the fastest rate.                                                                  2


B      Proof for Theorem 3
For the clarify of exposition we will present the proof in the case of two strategies for each player. In the
case with more than two strategies for each player, the expansions for the homotopy system will be more


                                                                  40
complex and will involve more terms in the denominator. But the proof strategy is very similar, except it
involves more points around which expansions have to be taken.
      In the two strategy case case, we can rewrite the homopoty system (63) and (64) as

                                                                  -                                              .
                                                                                           e2xj +exj cos(yj )
                     H1j (Œæ, œÑ ) = {œÅqj cos(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Œõj xj ‚àí               1+e2xj +2exj cos(yj )
                                                                                                                     ,

and
                                                                  -                                              .
                                                                                             exj sin(yj )
                     H2j (Œæ, œÑ ) = {œÅqj sin(qœïj ) ‚àí 1}œÑ + (1 ‚àí œÑ ) Œõj yj ‚àí               1+e2xi +2exj cos(yj )
                                                                                                                     .

      We need to check the presence of solutions in the small vicinity of the imaginary axis. Now consider
positive increments of xj such that xj is equal to some small value . If we linear the above homotopy system
around xj = 0, we can approximate them linearly by
                                    (1 ‚àí œÑ )      1         1+œÑ                   
                H1j =œÑ qyjq‚àí1 ‚àí                           ‚àí     + Œªjj (1 ‚àí œÑ ) +   Œªjk xk (1 ‚àí œÑ )
                                       2      1 + cos(yj )    2
                                                                                                   k=j
                                                                                                                        (68)
                                                        1 ‚àí œÑ sin(yj )
                H2j =œÑ yjq   + (1 ‚àí œÑ )        Œªjk yk ‚àí                  ‚àíœÑ
                                                          2 1 + cos(yj )
                                          k

where Œªjj is the j, jth element of the Œõ matrix.
      One can see that these two functions are continuous everywhere except for the set of points {yj =
œÄ + 2œÄk, k ‚àà Z} where cos (yj ) = ‚àí1.
      We will prove that for appropriate large values of q this system has no solutions in the vicinity of this
set. First of all note that if we take a second order expansion of 1 + cos (yj ) around some yj‚àó = œÄ + 2œÄk we
                                            2
can approximate 1 + cos (yj ) ‚âà 12 yj ‚àí yj‚àó . Then we can further linearize these two equations in (68) to:
                                                                                            1+œÑ    (1 ‚àí œÑ )
                    H1j =œÑ qyj‚àó q‚àí1 ‚àí Œªjj (1 ‚àí œÑ ) +                   Œªkj xk (1 ‚àí œÑ ) ‚àí       ‚àí
                                                                                              2    (yj ‚àí yj‚àó )2
                                                                  k=j
                                                                                                                        (69)
                                                                                                           1
                    H2j =œÑ yj‚àó q   + (1 ‚àí     œÑ )Œªjj yj‚àó   ‚àí          Œªkj yk (1 ‚àí œÑ ) ‚àí œÑ + (1 ‚àí œÑ )
                                                                                                       (yi ‚àí yi‚àó )
                                                               k=j
                                             
where we have also used sin (yj ) ‚âà ‚àí yj ‚àí yj‚àó .
      Now we can construct a sequence of homotopies with the order q increasing to inÔ¨Ånity at appropriate
rate such that these homotopies do not have solutions with extraneous solution of |yj | ‚Üí ‚àû. This sequence
of q is constructed by letting q = 1 + 1/, as  ‚Üí 0. Along this sequence, we will see below that the solutions
yj ‚àí yj‚àó to H1j and H2j will be of diÔ¨Äerent orders of magnitude. Therefore there can not solutions yj ‚àí yj‚àó
that simultaneously satisfy both equations H1j = 0 and H2j = 0.                                           1
                                                                                                           ‚àó
      To see this, consider the Ô¨Årst part H1j = 0 of (69). For small  only the Ô¨Årst term œÑ qyj‚àó q‚àí1 = O yj 
and the last term (y(1‚àíœÑ)                                              ‚àó
                           ‚àó 2 dominate. Therefore the solution yj ‚àí yj has to have the order of magnitude
                       j ‚àíyj )
   /         1
                
        1 ‚àó‚àí 2
O        yj       . On the other hand, for the second part H2j = 0 of (69). For small  only the Ô¨Årst term
             1
                ‚àó
œÑ yj‚àó q = O yj  and the last term (1 ‚àí œÑ ) (yi ‚àíy
                                                1
                                                   ‚àó  dominate. Therefore the solution yj ‚àí yj‚àó has to have the
                                                   i)
                                                                          /          
                            ‚àó‚àí 1                                                     1
                                                                                1 ‚àó‚àí 2
order of magnitude O yj  which increases to ‚àû much slower than O                yj       as  ‚Üí ‚àû. Therefore


                                                                       41
there can be no solution yj to both H1j and H2j simultaneously for the sequence of q chosen above. This
proves that the homotopy is path Ô¨Ånite along that sequence of q.
          The considered homotopy function is analytic outside the balls of Ô¨Åxed radius around the members of
countable set of points {xj = 0, yj = œÄ + 2œÄk}, k ‚àà Z 9 . Therefore a monotone smooth parametrization is
available except for the interior of these balls because the determinant of the Jacobian is strictly positive
everywhere else.
          This establishes regularity of the homotopy and concludes the proof.                                      2


Proof of equation (68): We consider each term individually. First of all
                                                 œÄ                    œÄ  
                              œï = arctan (y/) = ‚àí arctan (/y) ‚âà ‚àí .
                                                 2                    2  y
                                                                  œÄ
Hence, as long as q is chosen so that qœÄ/2 is 2kœÄ +           for some k,
                                                                  2
                                                                                   
                                                                    œÄ               q  q
                           cos (qœï) = cos (q arctan (y/)) ‚âà cos q ‚àí q        = sin     ‚âà .
                                                                    2    y           y   y
Together with œÅq ‚âà yjq , this gives the Ô¨Årst term in H1j .
          Secondly, a Ô¨Årst order expansion around  = 0 gives
                                             exj sin(yj )   1 1      1
                                            2x       x
                                                           ‚âà +               .
                                       1 + e + 2e cos(yj )
                                               i       j    2 2 1 + cos (yj )
Therefore the H1j is proved in (68).
          The second part of H2j follows similarly, noting that given the choice of q where sin(qœï) = 1, and
                                                                  exj sin(yj )
œÅqj   ‚âà yjq , and the Ô¨Årst Taylor expansion term for          1+e2xi +2exj cos(yj )
                                                                                      vanishes.


End of proof for equation (68).


C           Semiparametric Variance
To derive Œ©, we need to follow Newey (1990) and derive the asymptotic linear inÔ¨Çuence function of the left
hand side of the above relation. For this purpose, note that

                     1 
                         T                           
                    ‚àö       A (st ) yt ‚àí œÉ st , Œ¶ÃÇ, Œ∏0
                      T t=1
                    1 
                        T
                                                               1 
                                                                   T                                        
                  =‚àö       A (st ) (yt ‚àí œÉ (st , Œ¶0 , Œ∏0 )) ‚àí ‚àö       A (st ) œÉ st , Œ¶ÃÇ, Œ∏0 ‚àí œÉ (st , Œ¶0 , Œ∏0 ) .
                     T t=1                                      T t=1

Since Œ¶ÃÇ depends only on the nonparametric estimates of choice probabilities œÉÃÇj (k|s) , j = 1, . . . , n, k =
1, . . . , K in (29) through (24), the second part can also be written as

                                   1 
                                       T
                                  ‚àö       A (st ) (Œì (st , Œ∏0 ; œÉÃÇ (s)) ‚àí Œì (st , Œ∏0 ; œÉ0 (s))) ,
                                    T t=1
      9
          Moreover, it is possible to check that the homotopy system has no solutions when all arguments are purely
imaginary in case if q is an arbitrary odd number


                                                                  42
where œÉÃÇ (s) is the collection of all œÉÃÇj (k|s) for j = 1, . . . , n and k = 1, . . . , K, and the function Œì (¬∑) is
deÔ¨Åned in (28). Then using the semiparametric inÔ¨Çuence function representation of Newey (1994), as long
as Œì (st , Œ∏, œÉ (s)) is suÔ¨Éciently smooth in œÉ (s) and as long as the nonparametric Ô¨Årst stage estimates satisfy
certain regularity conditions regarding the choice of the smoothing parameters, we can write this second
part as

                                   1 
                                       T
                                  ‚àö       A (st ) (Œì (st , Œ∏0 ; œÉÃÇ (s)) ‚àí Œì (st , Œ∏0 ; œÉ0 (s)))
                                    T t=1
                                  1 
                                      T
                                                  ‚àÇ
                                =‚àö       A (st )    Œì (st , Œ∏0 ; œÉ0 (s)) (yt ‚àí œÉ (st , Œ∏0 )) + op (1) .
                                   T t=1         ‚àÇœÉ
                                                ‚àÇ
In other words, if we write ŒìœÉ (s) =           ‚àÇœÉ Œì (st , Œ∏0 ; œÉ0 (s)),   we can write

                                       1 
                                           T                           
                                      ‚àö       A (st ) yt ‚àí œÉ st , Œ¶ÃÇ, Œ∏0
                                        T t=1
                                     1 
                                         T
                                   =‚àö       A (st ) (I ‚àí ŒìœÉ (st )) (yt ‚àí œÉ (st , Œ∏0 )) + op (1) .
                                      T t=1

      Therefore we can derive the asymptotic distribution of the two-step semiparametric Œ∏ÃÇ deÔ¨Åned through
(33) as

          ‚àö        
                                            ‚àí1 1
                                                  T
           T Œ∏ÃÇ ‚àí Œ∏0 = ‚àí (EA (st ) ŒìŒ∏ (st )) ‚àö        A (st ) (I ‚àí ŒìœÉ (st )) (yt ‚àí œÉ (st , Œ∏0 )) + op (1) .
                                                T t=1
Hence
                                                 ‚àö        
                                                             d
                                                  T Œ∏ÃÇ ‚àí Œ∏0 ‚àí‚Üí N (0, Œ£)

where Œ£ is equal to
                           ‚àí1 "                                                         #                ‚àí1
        E (A (st ) ŒìŒ∏ (st ))       EA (st ) (I ‚àí ŒìœÉ (st )) Œ© (st ) (I ‚àí ŒìœÉ (st )) A (st ) E ŒìŒ∏ (st ) A (st )      .

In the above, we have deÔ¨Åned
                                                                                  !
                                                   ‚àÇ                              !
                                       ŒìŒ∏ (st ) =     Œì (st , Œ∏1 , œÉ (st ; Œ∏2 )) !!            ,
                                                  ‚àÇŒ∏1                               Œ∏1 =Œ∏2 =Œ∏0

and

                                             Œ© (st ) = V ar (yt ‚àí œÉ (st , Œ∏0 ) |st ) .

The eÔ¨Écient choice of the instrument matrix (which can be feasibly estimated in preliminary steps without
aÔ¨Äecting the asymptotic variance) is then given by
                                                                   ‚àí1         ‚àí1                  ‚àí1
                               A (st ) = ŒìŒ∏ (st ) (I ‚àí ŒìœÉ (st ))         Œ© (st )    (I ‚àí ŒìœÉ (st ))       .

With this eÔ¨Écient choice of the instrument matrix, the asymptotic variance of Œ∏ÃÇ becomes
                                                                                 ‚àí1
                                             ‚àí1      ‚àí1              ‚àí1
                      EŒìŒ∏ (st ) (I ‚àí ŒìœÉ (st )) Œ© (st ) (I ‚àí ŒìœÉ (st ))     ŒìŒ∏ (st )    .                               (70)


                                                                    43
C.1       EÔ¨Éciency Considerations
We present two eÔ¨Éciency results in this section. First of all, we show that with the above eÔ¨Écient choice of
the instrument matrix A (st ), the semiparametric two step estimation procedure above is as eÔ¨Écient as the
full maximum likelihood estimator where the Ô¨Åxed point mapping in (28) is solved for every parameter value
Œ∏ which is then nested inside maximum likelihood optimization to obtain choice probabilities as a function
of Œ∏. Secondly, we show that estimating œÉÃÇ (st ) may even improves eÔ¨Éciency over the hypothesis case where
œÉ (st ) is known and the pseudo MLE in (34) is used to estimate Œ∏ (but using Œ¶0 instead of Œ¶ÃÇ).


C.1.1      EÔ¨Éciency comparison with full maximum likelihood

Consider a full maximum likelihood approach where a Ô¨Åxed point calculation (assuming the solution is
unique) of (28) is nested inside the numerical optimization. For each Œ∏, (28) is solved to obtain œÉ (st , Œ∏) as
a function of Œ∏, which is then used to form the likelihood function as in (34). DeÔ¨Åne the total derivative of
(28) as
                                                                                !
                                    d                d                          !
                                      œÉ (st , Œ∏0 ) =    Œì (st , Œ∏, œÉ (st ; Œ∏)) !!
                                   dŒ∏                dŒ∏                           Œ∏=Œ∏0
                                                        d
                                  =ŒìŒ∏ (st ) + ŒìœÉ (st ) œÉ (st , Œ∏0 )
                                                       dŒ∏
which can be used to solve for
                                    d                               ‚àí1
                                       œÉ (st , Œ∏0 ) = (I ‚àí ŒìœÉ (st )) ŒìŒ∏ (st ) .                           (71)
                                    dŒ∏
    Following the same logic as the discussions of pseudo MLE after (34), but with the pseudo log likelihood
function replaced by the full maximum likelihood function, it is easy to show that the asymptotic distribution
of the full maximum likelihood estimator, which is the same as an iv estimator with the instruments chosen
optimally, satisÔ¨Åes
                                   ‚àö              
                                                     d
                                    T Œ∏ÃÇF M LE ‚àí Œ∏0 ‚àí‚Üí N (0, Œ£F M LE )

where
                                                                                        ‚àí1
                                             d                 ‚àí1 d              
                            Œ£F M LE =       E œÉ (st , Œ∏0 ) Œ© (s)      œÉ (st , Œ∏0 )             .
                                             dŒ∏                    dŒ∏

Using (71), we can also write
                                                                                   ‚àí1
                                                   ‚àí1      ‚àí1             ‚àí1
                  Œ£F M LE = EŒìŒ∏ (st ) (I ‚àí ŒìœÉ (st )) Œ© (st ) (I ‚àí ŒìœÉ (st )) ŒìŒ∏ (st )    .

This is identical to (70) for the asymptotic variance of the two step semiparametric iv estimator when the
instrument matrix is chosen optimally.




                                                          44
C.1.2       EÔ¨Éciency comparison with infeasible pseudo MLE

Consider an infeasible pseudo MLE, which is similar to (34) except with Œ¶ÃÇ replaced by the true but unknown
Œ¶0 :
                 K                                                                                             
             
             T 
               n                                                     
                                                                      K                    
                                                                                           K
                             yikt log œÉi (k|st , Œ¶0 , Œ∏) +       1‚àí         yikt log 1 ‚àí         œÉi (k|st , Œ¶0 , Œ∏)     .              (72)
             t=1 i=1   k=1                                            k=1                  k=1

                                                                                                              d             
The asymptotic variance of this estimator is similar to that of Œ£F M LE except with                          dŒ∏ œÉ (st , Œ∏0 )    replaced by
ŒìŒ∏ (st ). In other words,
                                                                          ‚àí1
                                                                 ‚àí1
                                      Œ£IP M LE = EŒìŒ∏ (st ) Œ© (st ) ŒìŒ∏ (st )    .

where IP M LE stands for infeasible pseudo MLE.
       The relation between Œ£F M LE and Œ£IP M LE is obviously ambiguous and depends on the response matrix
ŒìœÉ (st ). It is clear possible that Œ£F M LE < Œ£IP M LE , in which case estimating Œ¶ÃÇ may improve eÔ¨Éciency over
the case where Œ¶0 is known.




                                                                      45
                      Table 6.1: Characteristics of the Parameters
     PARAMETER              MEAN                  VARIANCE            DISTRIBUTION
Œ∏1                    2.45                   1                       Normal
Œ∏2                    5.0                    1                       Normal
Œ∏3                    1.0                    1                       Normal
Œ∏4                    -1.0                   1                       Normal
x1                    1.0                    0.33                    Uniform
X2                    1.0                    0.33                    Uniform


                Table 6.2 (i): Results of Monte-Carlo Simulations, n=3.
 PARAMETER             MEAN              STD. DEV           MAX                 MIN
# of equilibria   1.592                1.175           7                    1
P1                0.366                0.362           0.998                0
P2                0.360                0.367           0.995                0
P3                0.363                0.348           0.993                0.003


                Table 6.2 (ii): Results of Monte-Carlo Simulations, n=4.
 PARAMETER             MEAN               STD. DEV           MAX                MIN
# of equilibria   1.292                0.777            5                   1
P1                0.278                0.328            0.981               0.001
P2                0.246                0.320            0.981               0.003
P3                0.276                0.338            0.999               0.001
P4                0.280                0.338            0.987               0.002


                Table 6.2 (iii): Results of Monte-Carlo Simulations, n=5.
 PARAMETER              MEAN              STD. DEV            MAX               MIN
# of equilibria    1.106                0.505            5                  1
P1                 0.104                0.201            0.964              0
P2                 0.138                0.252            0.975              0
P3                 0.315                0.338            0.992              0
P4                 0.356                0.385            0.983              0
P5                 0.319                0.344            0.982              0
            Table 6.3 (i): Frequencies for the number of equilibria, n=3.
    # OF EQUILIBRIA             NUMBER OF CASES                 FREQUENCY (%)
n=1                          192                           47.93
n=3                          132                           33.06
n=5                          64                            16.12
n=7                          12                            2.89
Total                        400                           1.00

            Table 6.3 (ii): Frequencies for the number of equilibria, n=4.
    # OF EQUILIBRIA             NUMBER OF CASES                 FREQUENCY (%)
n=1                          287                           71.84
n=3                          93                            23.30
n=5                          20                            4.85
Total                        400                           1.00

            Table 6.3 (iii): Frequencies for the number of equilibria, n=5.
    # OF EQUILIBRIA              NUMBER OF CASES                 FREQUENCY (%)
n=1                           373                           93.16
n=3                           25                            6.21
n=5                           2                             0.62
Total                         400                           1.00
                Table 6.4 (i): Entry Probability of First Player, n=3.
    # OF EQUILIBRIA                    MEAN                            STD
n=1                         0.375                            0.386
n=3                         0.337                            0.341
n=5                         0.353                            0.322
n=7                         0.601                            0.367

               Table 6.4 (ii): Entry Probability of First Player, n=4.
    # OF EQUILIBRIA                    MEAN                            STD
n=1                         0.211                           0.300
n=3                         0.431                           0.328
n=5                         0.129                           0.235

               Table 6.4 (iii): Entry Probability of First Player, n=5.
    # OF EQUILIBRIA                    MEAN                             STD
n=1                         0.116                            0.216
n=3                         0.080                            0.206
n=5                         0.007                            0.232
                  Table 7.1: Recommendation Variables.
         RECOMMENDATION              NUMERICAL VALUE RECORDED BY
                                                     I/B/E/S
Strong Buy                                              1
Buy                                                     2
Hold                                                    3
Underperform                                            4
Sell                                                    5



                                  Table 7.2: Summary Statistics.
  VARIABLE                 MEAN           STD.         MIN.                     MAX.             NOBS
Recommendation              2.210        0.9168          1                        5              12719
Relation                   0.0350        0.1839          0                        1              12719
Ibank                      0.8155        0.3878          0                        1              12719
Earnings                   0.1111        0.2439       -3.010                    1.720            12719



                Table 7.3: Tabulation of Recommendations by Quarter.
  VARIABLE/TIME              Q1 1998            Q1 2000              Q2 2003
      PERIOD
  % Recs. Equal to 1          30.51              46.73                11.65
  % Recs. Equal to 2          30.51              41.46                18.12
  % Recs. Equal to 3          37.62              11.81                53.07
  % Recs. Equal to 4          1.02                0.00                12.62
  % Recs. Equal to 5          0.34                0.00                4.53


          Table 7.4 Ordered Logit Estimates of the Effect of Fundamentals.
   VARIBLE          COEF.             COEF.              COEF.             COEF.
    %DEV        -.0539 (-0.276) -.1030 (-0.519)              -               -
   ABS. DEV                                          -.1030 (-0.519)         -

Log Likelihood           -16171.589           -14861.218             -14861.218             -14861.352
   Psueo-R2                0.0000               0.0810                 0.0810                 0.0810
 Fixed Effects              none             quarterly,stock       quarterly, stock       quarterly, stock
In the ordered logit model, the dependent variable is the analyst‚Äôs recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses. Most
of the quarterly and stock fixed effects are significant in the specifications that we study.
                  Table 7.5 Quarterly Effects Versus Market Indexes.
VARIABLE          COEFFICIENT T-STATISTIC NASDAQ                       QQQ
qdum2                -0.1865            -1.979            1,770
qdum3               -0.15266            -1.803            1,509
qdum4               -0.24117            -2.258            1,928
qdum5               -0.27011            -3.134            2,207          102.25
qdum6               -0.36868            -4.297            2,467          103.87
qdum7               -0.46412            -5.485            2,752          120.12
qdum8               -0.43603            -5.149            3,341          148.63
qdum9                -0.6408            -7.394            4,732          214.5
qdum10              -0.43113            -4.973            3,471           85.19
qdum11              -0.35704            -3.958            4,252            103
qdum12              -0.08381            -1.031            2,664           64.06
qdum13               0.07177             0.955            2,126          46.97
qdum14               0.04712             0.632            2,131          85.19
qdum15              0.063716              0.79            1,802          36.51
qdum16              0.128908             1.671            1,915          39.29
qdum17              0.217669              2.86            1,745          34.15
qdum18              0.349657             4.631            1,613            30
qdum19              0.630952             8.753            1,403          26.05
qdum20              1.009163            13.389            1,887          21.07
qdum21              0.572553             7.596            1,345          24.72
qdum22              0.989535             12.45            1,374          26.06



               Table 7.6 Regression of Dummies on Market Indexes.
            VARIABLE            COEFFICIENT         COEFFICIENT
           Constant            .8208896 (3.965)       0.6270 (4.3)
           Nasdaq Index       -.0003467 (-4.960)            -
           QQQ Price                   -              -0.007 (-4.7)

           Nobs                         21                     18
           R2                          0.48                  0.6830
       Table 7.7 Ordered Logit Estimates of the Effect of Conflicts of Interest.
   VARIBLE           COEF.             COEF.              COEF.              COEF.
  RELATION       -.3231 (-6.19)    -.1108 (-2.06)     .05397 (0.94)      .03932 (0.68)
    IBANK                                                                 .1080 (4.18)

Log Likelihood           -16152.389             -15314.605             -14860.888             -14855.94
   Psueo-R2                0.0012                 0.0530                 0.0811                 0.0814
 Fixed Effects              none                 quarterly           quarterly, stock       quarterly, stock
In the ordered probit model, the dependent variable is the analyst‚Äôs recommendation as coded by IBES.
This takes on discrete values from one to five. In the table above, t-statistics are included in parentheses.
We do not report ancillary parameters, such as the cut values and values of the fixed effects.




   Table 7.8 Ordered Logit Estimates including Peer Effects (Parametric First Stage)
  VARIABLE           COEF.             COEF.             COEF.              COEF.
IVBELIEF           1.121982           1.108108          .2531818          .2531353
                     (24.66)            (7.90)            (5.80)            (5.75)

IBANK                           -                      -                      -                .2938029
                                                                                                 (4.41)
RELATION                        -                      -                      -                -.0879437
                                                                                                 (-1.16)

%DEV                            -                      -                      -                 .0073782
                                                                                                  (0.71)


Log Likelihood           -15113.967             -14930.088             -14823.868             -14535.476
Psueo- R 2                 0.0472                 0.0588                 0.0830                 0.0837
Fixed Effects               none                   stock             quarterly, stock       quarterly, stock
In the ordered logit model, the dependent variable is the analyst‚Äôs recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses (the t-
statistic for the variable IVBELIEF is corrected using bootstrap). IVBELIEF is constructed by subtracting
the individual fitted values (divided by the number of the other analysts for a specific stock in a specific
quarter) from the conditional expectations of fitted values (conditional on quarter and stock), with these
fitted values being from the parametric first stage regression. Most of the quarterly and stock fixed effects
are significant in the specifications that we study.
 Table 7.9 Ordered Logit Estimates including Peer Effects (Semiparametric First Stage)
  VARIABLE           COEF.             COEF.              COEF.            COEF.
IVBELIEF            1.121863          1.108009          .2542394          .2540114
                     (10.73)           (23.20)             (5.95)           (5.90)

IBANK                            -                     -                      -                 .2935598
                                                                                                   (4.41)
RELATION                         -                     -                      -                  -.0880207
                                                                                                  (-1.16)
%DEV                             -                     -                      -                 .0072834
                                                                                                   (0.70)

Log Likelihood            -15113.55             -14929.674               -14545.766           -14535.35
Psueo- R 2                  0.0472                0.0588                   0.0830               0.0837
Fixed Effects                none                  stock               quarterly, stock     quarterly, stock

In the ordered logit model, the dependent variable is the analyst‚Äôs recommendation as
coded by IBES. This takes on discrete values from one to five. In the table above, t-statistics are included in
parentheses (the t-statistic for the variable IVBELIEF is
corrected using bootstrap). IVBELIEF is constructed by subtracting the individual fitted values (divided by
the number of the other analysts for a specific stock in a specific quarter) from the conditional expectations
of fitted values (conditional on quarter and stock), with these fitted values being from the first stage
semiparametric sieve regression. Most of the quarterly and stock fixed effects are significant in the
specifications that we study.



Table 7.10 Random Effect Estimates including Peer Effects (Semiparametric First Stage)
  VARIABLE        COEF.         COEF.          COEF.          COEF.         COEF.
IVBELIEF         .766924            -             -          .7631302     .7672082
                  (11.53)                                     (11.51)      (10.63)

IBANK                        -            .6669054                 -                 -           .6559327
                                            (7.94)                                                 (7.87)
RELATION                     -                 -             -.2539996         -.1754189         -.2416273
                                                               (-1.61)           (-1.22)           (-1.67)

Log                  -6454.5547          -6687.9966         -6717.4526        -6453.8047        -6423.6011
Likelihood
The dependent variable is equal to zero if the analyst‚Äôs recommendation is recorded as 1
(i.e. strong buy) in IBES and one otherwise. IVBELIEF is constructed by subtracting the individual fitted
values (divided by the number of analysts for a specific stock in a specific quarter) from the conditional
expectations of fitted values (conditional on quarter and stock), with these fitted values being from the first
stage semiparametric sieve regression. In the table above, t-statistics are included in parentheses (the t-
statistic for the variable IVBELIEF is corrected using bootstrap). There was a unique fixed effect for
each stock during each quarter. In the data, 3447 observations were dropped due to all
positive or negative recommendations.
                   Table 7.11 Equilibrium Simulations.
             REC=1       REC=2          REC=3        REC=4      REC=5
IBANK=0      0.6353      0.2785       0.08113      0.4650E-03   0.3400E-04
QUARTER=9
IBANK=1      0.06847     0.68742      0.22397      0.014376     0.5753E-02
QUARTER=9
FIRST
EQUILBRIUM
IBANK=1      0.4042      0.4009       0.1821       0.01183      0.87246E-04
QUARTER=9
SECOND
EQUILBRIUM
IBANK=0      0.2096      0.4076       0.3507       0.2967E-02   0.2235E-03
QUARTER=21
IBANK=1      0.09775     0.2936       0.5316       0.7127E-02   0.5653E-03
QUARTER=21
