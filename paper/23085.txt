NBER WORKING PAPER SERIES

REGRESSIVE SIN TAXES
Benjamin B. Lockwood
Dmitry Taubinsky
Working Paper 23085
http://www.nber.org/papers/w23085

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2017, Revised March 2017

We thank Hunt Allcott, Alan Auerbach, Raj Chetty, Stefano DellaVigna, Emmanuel Farhi,
Xavier Gabaix, Nathaniel Hendren, Louis Kaplow, David Laibson, Erzo F.P. Luttmer, Matthew
Rabin, Alex Rees-Jones, Emmanuel Saez, Jim Sallee, Florian Scheuer, Stefanie Stantcheva,
Matthew Weinzierl, and participants at seminars and conferences for helpful comments and
discussions. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2017 by Benjamin B. Lockwood and Dmitry Taubinsky. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Regressive Sin Taxes
Benjamin B. Lockwood and Dmitry Taubinsky
NBER Working Paper No. 23085
January 2017, Revised March 2017
JEL No. H0,I18,I3,K32,K34
ABSTRACT
A common objection to “sin taxes”—corrective taxes on goods like cigarettes, alcohol, and
sugary drinks, which are believed to be over-consumed—is that they fall disproportionately on
low-income consumers. This paper studies the interaction between corrective and redistributive
motives in a general optimal taxation framework. On the one hand, redistributive concerns
amplify the corrective benefits of a sin tax when sin good consumption is concentrated on the
poor, even when bias and demand elasticities are constant across incomes. On the other hand, a
sin tax can generate regressivity costs, raising more revenue from the poor than from the rich. Sin
tax regressivity can be offset by targeted transfers or income tax reforms if differences in sin
good consumption are driven by income effects, but not if they are driven by preference
heterogeneity, and not if the indirect incentives the sin tax generates for labor supply decisions
are not salient. The price elasticity of demand determines the extent to which corrective benefits
versus regressivity costs determine the size of the optimal tax. We implement our optimal tax
formulas in a calibrated model of sugar-sweetened beverage consumption for a range of
parameter values suggested by empirical work.

Benjamin B. Lockwood
Business Economics and Public Policy
Wharton School
University of Pennsylvania
1400 Steinberg Hall-Dietrich Hall
3620 Locust Walk
Philadelphia, PA 19104
ben.lockwood@wharton.upenn.edu
Dmitry Taubinsky
Department of Economics
Dartmouth College
Rockefeller Hall
Hanover, NH 03755
and NBER
dtaubinsky@gmail.com

“The only way to protect all of us, including the poor, from further harm is through a
sugary drink tax....”
– Forbes article [April 2016]
“A tax on soda and juice drinks would disproportionately increase taxes on low-income
families in Philadelphia.”
– Bernie Sanders, U.S. Senator [April 2016]
“They’ve [big soda] made their money of the backs of poor people, but this money [soda
tax revenue] will stay in poor neighborhoods.”
– Jim Kenney, Philadelphia Mayor [in The Nation, May 2016]

1

Introduction

A large literature in behavioral economics shows that poor self control, inattention, and incorrect
beliefs lead to overconsumption of goods such as cigarettes, alcohol, unhealthy junk foods, and energy
inefficient appliances. Consequently, “sin taxes” that discourage the consumption of such goods have
the potential to increase social welfare.1 This corrective logic is frequently mentioned in policy
debates, and has played a role in the passage of taxes on cigarettes and alcohol, as well as the recent
rise of taxes on sugar-sweetened beverages (SSBs) in US cities that include Chicago, Philadelphia,
and San Francisco.
One simple principle for the optimal tax that has been emphasized in behavioral economics is the
basic logic of Pigou: the optimal bias-correcting tax should equal the average mistake (or “internality”)
of marginal consumers.2 But this efficiency-maximizing principle depends on strong assumptions that
ensure that consumers do not vary in their marginal utility from wealth.
Such strong assumptions are starkly out of sync with public debates about sin taxes. Indeed, a
common objection to sin taxes is that they are regressive. Cigarettes and sugary drinks are consumed
disproportionately by the poor, and energy efficiency subsidies are taken up disproportionately by
the rich.3 This has lead to forceful opposition to the taxes on the grounds of fairness and equality.4
Yet at the same time, others argue that the regressivity of the tax can be offset through progressive “revenue recycling”: government revenue from the tax can be used to fund progressive initiatives
and transfers to low-income consumers.5 And some also point out that the biases that cause over1

See, e.g., Chetty (2015), Mullainathan et al. (2012), and Bernheim and Rangel (2009), for an overview of the
various biases and their implications for welfare calculations.
2
See, e.g., O’Donoghue and Rabin (2006), Gruber and Kőszegi (2001), Allcott et al. (2014), Allcott and Taubinsky
(2015), Heutel (2015), Tsvetanov and segerson (2013), Mullainathan et al. (2012).
3
See, e.g., Gruber and Kőszegi (2004) and Goldin and Homonoff (2013) on cigarettes, and Allcott et al. (2015),
Davis and Borenstein (2016), Davis and Knittel (2016) on energy efficiency subsidies and fuel economy standards.
4
See, e.g., Lavin (2013) on cigarettes taxes or Sanders (2016) on SSB taxes.
5
For example, this reasoning led Philadelphia to direct a share of SSB tax revenues toward the development of
Pre-K education initiatives in low income neighborhoods. Philadelphia mayor James Kenney has proposed the soda
tax under the promise that its revenues “will stay in poor neighborhoods.” Consistent with this, Blumgart (2016), for
example, writes that “By earmarking the revenues to programs that are at the top of the progressive agenda, Kenney
has provided a strong counterargument to those concerned by the regressive nature of the tax: The money will go right
back into those very neighborhoods that are hit hardest.”

1

consumption are themselves regressive—e.g., cigarette consumption among the poor leads to higher
insurance premiums for the poor—and that, therefore, a corrective tax might confer greater benefits
on the poor than on the rich.6
What is the optimal tax in the presence of such diverse policy considerations? This paper is
the first to thoroughly address this question in a context sufficiently comprehensive to account for
each of these arguments. We allow for individuals who over- or under-consume some “sin good,” the
consumption of which varies across the income distribution. We allow for differences in consumption
to be driven by income effects, preference heterogeneity, or some combination of the two. And we
incorporate a motive for redistribution and a nonlinear income tax that can be used to recycle sin
tax revenue progressively.
Our baseline model builds on Saez’s (2002a) extension of Atkinson and Stiglitz (1976) by considering an economy of consumers with heterogenous earning abilities and tastes, who choose labor
supply and a consumption bundle that exhausts their after-tax income. The policymaker chooses a
set of linear commodity taxes and a non-linear income tax which can be used to provide transfers
to low income consumers, to raise money for commodity subsidies, or to distribute commodity tax
revenue (in a progressive way, if desired). But while the standard approach in optimal tax theory
assumes that the planner is in agreement with consumers about what is best for them, we instead
analyze the general case in which the policymaker disagrees with the consumers’ assessment due to
“mistakes” such as present bias, limited inattention, or incorrect beliefs. This approach nests a variety of behavioral economics models of biases as special cases, and generates robust economic insights
across a number of domains of behavior. Moreover, although externalities are not the primary focus
of the paper, optimal tax policy in the presence of externalities is obtained as a corollary of our more
general results.
Our main theoretical results show that redistributive concerns have a nuanced effect on the optimal
commodity tax, and can make the tax substantially larger or smaller than a benchmark Pigouvian
tax. We show that the optimal commodity tax can be written as the sum of two terms: the “corrective
benefits” (representing the welfare gains from reducing harmful internalities), and the “regressivity
costs” (representing the welfare costs of shifting net resources from poorer to richer consumers). When
a harmful good is consumed primarily by poorer consumers, redistributive motives tend to amplify
the corrective benefits, since the beneficial reductions in harmful internalities accrue mostly to the
poor.
On the other hand, redistributive motives also generate regressivity costs when the taxed good
is consumed more heavily by the poor than by the rich. The extent to which the regressivity of
the commodity tax can be offset (e.g., by making the income tax more progressive, or by targeting
commodity tax revenues toward programs that benefit the poor) depends on how much of the sin
good consumption profile is driven by income effects vs. preference heterogeneity. In the extreme
6

See Gruber and Kőszegi (2004) for a formal argument along these lines for cigarette taxes. Less formally on the
recent SSB debate, Huehnergarth (2016) writes “Here’s why Sanders’ position on sugary drink taxes plays right into
the hands of Big Soda, and hurts America’s most vulnerable citizens: Big Soda’s targeted marketing to communities
of color and low-income communities is regressive.... Type 2 diabetes, linked to excessive sugary drink consumption, is
regressive....”

2

case where all differences are from income effects, regressivity can be fully offset, so that only the
corrective benefits are relevant, and the optimal tax is unambiguously higher than the Pigouvian
benchmark when elasticities and biases are non-decreasing with income. But when income effects
play a smaller role, no such offset is feasible because a more progressive income tax will lead to labor
supply distortions whose cost to public funds outweighs the redistributive benefits.
The price elasticity of demand determines the relative importance of corrective benefits versus
regressivity costs. When the elasticity is low, the tax has little effect on behavior and thus little
corrective benefit—and so its regressivity costs dominate. Conversely, corrective benefits dominate
when the elasticity is high.
We provide a number of extensions to our baseline model and results. In theory, small changes
in the tax (or price) of any particular good affect the returns from labor supply, and the standard
model assumes that individuals adjust their labor supply perfectly in response to all possible changes.
In our first extension, we relax this assumption and allow consumers to under-react to such indirect
incentives for labor supply. We show formally that such underreaction to commodity taxes makes
progressive revenue recycling of commodity tax revenue inefficient, and thus decreases the size of the
optimal sin tax. In fact, we show that a non-salient (for labor supply choice) commodity tax operates
on behavior almost as if the consumption profile were driven purely by preference heterogeneity, even
when sin good consumption is driven entirely by income effects.
Second, we consider an extension to multiple goods (possibly complements or substitutes) that
may be over- or under-consumed to different degrees. We present general formulas that shed light
on questions like how the government should set taxes jointly on standard tobacco cigarettes and
electronic cigarettes, or on regular soda and diet soda. Third, we show how results for externalities
(or a combination of both externalities and internalities) can be obtained as corollaries of our results.
To demonstrate the quantitative importance of our theoretical results, we apply our optimal
tax formulas to a calibrated model of sugar-sweetened beverage (SSB) consumption for a range of
parameter values suggested by empirical work. Consumption of SSBs generates large health costs that
are likely to be at under-appreciated by many consumers, and it also declines rapidly across the income
distribution. We find that if SSBs are inferior goods, so that the profile of SSB consumption is driven
by income effects, the optimal tax is modestly higher than a Pigouvian tax. When instead the SSB
consumption profile is the consequence of preference heterogeneity, regressivity costs lower the optimal
tax. At the lower end of empirical demand elasticity estimates, regressivity costs are large relative
to corrective benefits, lowering the optimal tax by about 50%. For moderate levels of consumer
bias, the welfare gains from the optimal tax range from $0.14 billion to $34.1 billion, depending
on the elasticity and on how much of the consumption profile is due to preference heterogeneity.
The simulations thus show that the comparative statics implied by our theoretical formulas are
quantitatively very significant. At the same time, our results also suggest that for a broad swath of
reasonable parameters, the optimal tax is moderately higher than the 1 to 2 cent per ounce taxes
currently in place in US cities.
We derive our optimal tax formulas in terms of sufficient statistics that consist of elasticities
and an empirically estimable, price-metric definition of bias. We generalize the seminal theorem of
3

Atkinson and Stiglitz (1976) and the qualitative results of Saez (2002a) by providing expressions for
the commodity tax in the presence of arbitrary preference heterogeneity, arbitrary bias in consumption
of the sin good, and potential underreaction to commodity taxes on the labor supply margin. As a
technical contribution, our results provide a novel generalization of the Atkinson-Stiglitz Theorem
even in the absence of any consumer misoptimization.7
Our results also generalize and qualify several recent advances in behavioral public economics. A
number of papers abstract from redistributive concerns and focus purely on the corrective benefits of
a corrective “internality tax.” 8 Such frameworks can essentially be obtained as a special case of our
model by setting social marginal welfare weights to 1.9
Amongst the small number of papers that do consider redistributive concerns, Gruber and Kőszegi
(2004) study the incidence of cigarette taxes on low- and high-income consumers with self-control
problems, and show that low-income consumers with sufficiently elastic consumption can benefit
from such taxes, but they do not characterize the optimal tax implications. Bernheim and Rangel
(2004) and Farhi and Gabaix (2015) study optimal commodity taxation with behavioral consumers
who differ in their marginal utility from income. Bernheim and Rangel (2004) study the optimal
tax on addictive substances in a dynamic framework in which environmental cues trigger mindless
consumption, and differences in the marginal utility from wealth arise from differences in spending
on the addictive good or on rehabilitation. Farhi and Gabaix (2015) focus on an application of their
general framework that assumes two types of consumers—behavioral and rational—with potential
differences in the marginal utility from income. Both Farhi and Gabaix (2015) and Bernheim and
Rangel (2004) assume that commodity taxes are the sole source of redistribution: the commodity tax
revenue has to be distributed lump-sum and cannot, for example, be spent on transfers to the poor
or programs that benefit the poor. Our model complements and extends their approach by allowing
for a nonlinear income tax in addition to commodity taxes, while also allowing for richer assumptions
about biases and heterogeneity.10
The rest of the paper proceeds as follows. Section 2 presents our general model. Section 3 derives
results for a simple, illustrative example. Section 4 characterizes the optimal commodity and income
taxes in our general model with a continuum of consumers. Section 5 presents extensions to the
baseline model. Section 6 presents numerical results for the optimal tax in a calibrated model of
sugar-sweetened beverage consumption. Section 7 concludes.
7

Moreover, our results also generalize Jacobs and Boadway (2014), who study optimal commodity taxation in the
absence of any market failure under the assumption that consumption preferences are homogeneous while allowing
for non-separability between consumption and labor in the utility function, and also Jacobs and de Mooij (2015)
and Kaplow (2012), who study the taxation of environmental externalities under the assumptions of homogeneous
preferences. By considering a flexible role of income effects vs. preference heterogeneity, our model accounts for the
potential labor supply distortions discussed in Goulder and Williams (2003), and contributes to the “double dividend”
debate in environmental economics (see Goulder (1995) for a review).
8
See, e.g., the papers in footnote 2.
9
See, in particular, Corollary 2 in Section 4.3.1.
10
Also closely related is the work on health insurance by Baicker et al. (2015), Spinnewijn (forthcoming), and Handel
et al. (2016). See also Mullainathan et al. (2012) for a model that links the insights from the health insurance literature
to commodity tax results; they derive formulas similar to those in Farhi and Gabaix (2015) for an economy in which
consumers make a binary choice.

4

2

Model

2.1

The environment

We consider individuals with multidimensional types denoted θ ∈ Θ, distributed with measure µ(θ).
Individuals choose a level of earnings z, which is taxed according to the nonlinear income tax T (z).
Consumers use their net income to consume a commodity c2 (the “sin good”) which is subject to a
linear commodity tax t, and a composite of all other goods c1 (the “numeraire”) which does not face
a commodity tax. We normalize the price of c1 to 1, so that the individual’s budget constraint is
c1 + (p + t)c2 ≤ z − T (z), where p is the price of c2 . Individuals make their choices to maximize
“decision utility” U (c1 , c2 , z; θ) subject to this constraint. U is assumed to be increasing and weakly
concave in its first two arguments, and decreasing and strictly concave in the third.
The policymaker believes consumers should be maximizing V (c1 , c2 , z; θ), which may differ from
from U because of the mistakes that the policymaker believes that consumers might be making.
The policymaker selects T (·) and t to maximize aggregate experienced utility, subject to a budget
constraint and individual optimization. That is, the policymaker’s problem is to maximize aggregate
experienced utility, weighted by type-specific Pareto weights α(θ):
Z
max

α(θ)V (c1 (θ), c2 (θ), z(θ); θ)µ(θ),

T,t

subject to the budget constraint
Z
(tc2 (θ) + T (z(θ)))µ(θ) = 0
and to individual optimization
{c1 (θ), c2 (θ), z(θ)} = arg max U (c1 , c2 , z; θ) s.t. c1 + (1 + t)c2 ≤ z − T (z) for all θ.
{c1 ,c2 ,z}

The difference between U and V can capture a variety of different psychological biases, such as:
1. Incorrect beliefs, as documented for food choices and energy-efficiency choices by Allcott (2013),
Attari et al. (2010), Bollinger et al. (2011), and Schofield (2015). Consumers may have incorrect
beliefs about certain attributes of c2 , such as its calorie content, it’s future health costs, or its
energy efficiency.
2. Limited attention or salience bias with respect to certain attributes of c2 , as modeled in Gabaix
and Laibson (2006), DellaVigna (2009), Gabaix (2014), and Bordalo et al. (2013), and as documented by Allcott and Taubinsky (2015) for energy-efficient appliances. For example, consumers
may be attentive to the product features advertised by the manufactures, but less attentive to
features not advertised: A sugary ice cream that is advertised as “fat free” may appear healthy
to consumers who did not examine the less conspicuously displayed information on sugar content. Alternatively, suppose that c2 represents investment in energy-efficiency, which generates

5

both hedonic utility and energy cost savings. Inattentive consumers may underweight the future
costs.
3. Present bias/time inconsistency. As in O’Donoghue and Rabin (2006), suppose that consumers
underweight the future health costs of c2 (e.g, potato chips) because of β − δ time-inconsistent
preferences. For example, if true utility from c2 is given by m(c2 ) − h(c2 ), where h is health
costs and m is immediate consumption utility, consumers may instead perform optimization
over m(c2 ) − βh(c2 ). Our framework allows us to treat β as a bias. However, our framework
also allows us to study other welfare criteria that may be applied to the model. For example, a
policymaker maker’s objective function may assign m(c2 ) − (κ + (1 − κ)β)h(c2 ) to be the utility
from c2 , reflecting that the policymaker gives weight κ to the “future-oriented self” and weight
1 − κ to the “in the moment self.” 11
4. Any combination of the above biases, as well as any other biases that allow consumer choice to
be represented by a differentiable utility function.
However, it is not always clear that all deviations of behavior from the standard model constitute
mistakes, and it is not the purpose of this paper to contribute to the relevant debates. The analysis in
this paper is perhaps best understood as a policy design calculation, given a well-specified objective
function from the policymaker. For example, if a policymaker deems that V should correspond to
the “future-oriented” self’s preferences in cases of time inconsistency, then our framework and results
deliver sharp policy design implications for such an objective function. Alternatively, a policymaker
may instead deem that decisions made in the present are “truer,” and that the future-oriented self
suffers from an over-abstraction bias. This also constitutes a well-specified objective function, and in
this case our framework and results deliver sharp policy design implications as well. Relatedly, in the
framework of Bernheim and Rangel (2009), the utility function U can be thought of as representing
choices in the normal market frame, whereas V represents choices in the welfare-relevant domain.12

2.2

Defining consumer bias

A key goal of our theoretical analysis is to derive optimal formulas that on the one hand can be
applied to a variety of possible consumer biases, while on the other hand can be directly connected to
empirical measurement through an intuitive and operationalizable definition of bias. We thus adopt
a general, yet empirically grounded definition of consumer bias in the spirit of the sufficient statistics
approach. We do this by constructing a price metric for consumer bias.
11
See Bernheim and Rangel (2009) and Bernheim (2016) for a discussion of why treating β < 1 fully as a bias may
be problematic.
12
What our framework does not allow explicitly, however, is ambiguity about which choices are optimal for a consumer; that is, we assume that the “welfare-relevant choices” can be represented by a utility function and do not, e.g.,
exhibit cycles. This may be a strong assumption in some circumstances, as argued by Bernheim and Rangel (2009)
and Bernheim (2016). Note, however, that all of our derivations are immediately relevant even if there is uncertainty
about whether the normative criterion
be V 1 or V 2 , or V 3 . . . . If the policymaker attaches probability πi to
P should
i
i
each possible
V , and maximizes
πi V , then our results immediately carry over to this policy
by setting
P
Pproblem
V :=
πi V i . More generally, because we can characterize optimal policy for any criterion V :=
π̂i V i for any set of
weights π̂i , our results can be used to characterize the set of all “justifiable policies.”

6

Formally, let c2 (θ, y, p, t, T ) be the consumption chosen by a type θ individual with after-tax
earnings y = z − T (z) at price p and tax t. Analogously, define cV2 (θ, y, p, t, T ) to be the amount of c2
that would be chosen if the individual were maximizing V instead. We define the bias γ(θ, z, t, T ) as
the value for which c2 (θ, y, p, t, T ) = cV2 (θ, y −c2 γ, p−γ, t, T ). In words, γ is equal to the compensated
price change that produces the same effects on demand as the bias does. In terms of primitives,
γ=

U2
U1

−

V2 13
V1 .

Sometimes we suppress some of the arguments and simply write γ(θ).

A key feature of γ is that it is not tied to the policymaker’s redistributive preferences, and that it
is invariant to any monotonic transformation of the utility functions U and V . The statistic depends
only on a consumer’s observable choices in the “biased” and “debiased” states.14
Although in some cases γ can only be measured indirectly by, for example, using structural
estimates of present bias and then constructing the price metric, in other cases it can be measured
directly. Chetty et al. (2009) estimate the (average) value of γ directly when bias arises from lack
of tax salience by computing the change in upfront prices that would alter demand as much as
a debiasing intervention that displays tax-inclusive final prices. Similarly, Allcott and Taubinsky
(2015) run an experiment that provides a direct estimate of γ for each consumer’s biased valuation
of energy efficient lightbulbs (CFLs). They compute willingness to pay (WTP) for more versus less
energy efficient lightbulbs in a standard market frame, and then measure how the distribution of
WTP changes when biases arising from inattention or incorrect beliefs are eliminated.15

2.3

Redistributive motives

To represent redistributive motives concisely, we adopt the notation, common in the optimal taxation
literature, of “marginal social welfare weights”—the marginal social welfare generated by a marginal
unit of composite consumption for a particular individual, in terms of public funds—formally defined
here as g(θ) = α(θ)V1 /λ, where V1 represents the derivative of V with respect to its first argument,
and λ is the marginal value of public funds (i.e., the multiplier on the government budget constraint
at the optimum). These weights are endogenous to the tax system, but are useful for characterizing
R
the necessary conditions which must hold at the optimum. We use ḡ = Θ g(θ)dµ(θ) to denote the
average marginal social welfare weight. If there are no income effects on consumption and labor
supply, then ḡ = 1 by construction. In this case, a social marginal welfare weight is simply the
(normalized) value of giving one unit of (after-tax) income to this consumer.
Note that because the weights α(θ) are exogenous, and because U and V produce identical
13

To see this, note that by definition, U2 /U1 = p + t and V2 /V1 = p + t − γ when the arguments c1 , c2 , z are the same
in the Ui and Vi terms . This also shows that the equivalence only holds under the assumption that the tax t is fully
U2
salient; otherwise, γ may deviate from U
− VV21 .
1
14
Assuming that “debiased” choices are observable, as they are for most behavioral models; see Bernheim (2016)
for the argument that the identification of almost all biases in behavioral economics can be done, and typically is, by
directly measuring choices V in the “unbiased frame” and comparing those to the choices U in the potentially biased
frame. Otherwise, γ can also be thought of as a function of observable choices and the policymaker’s desired choice.
15
Even in contexts in which the analyst has a particular psychological bias in mind, estimating γ may sometimes be
easier than estimating the primitives of the particular psychological model. For example, if the analyst believes that
individuals overconsume sugary drinks due to present bias, γ can be estimated directly by comparing an individual’s
period 0 demand for period 1 sugary drink consumption (reflecting choices according to V ) to the individual’s period
1 demand for period 1 sugary drink consumption (reflecting choices according to U ).

7

behavior (and identical choice-based measures of bias) up to monotonic transformations, redistributive
motives correspond to a policymaker’s or society’s tastes for reducing wealth inequality, and cannot
be derived from consumers’ choices alone. As in the rest of the optimal taxation literature, our
formulas for optimal taxes will thus depend not just on observable behavior (and people’s quantifiable
mistakes), but also on the policymaker’s (or society’s) preferences for wealth equality, captured by
these weights.

3

The optimal tax in a simple model with discrete types

We first derive the optimal sin tax in two contrasting contexts where the consumption profile of
c2 is driven by either preference heterogeneity or income effects. For simplicity, in this section
we assume two types of consumers, θ ∈ {L, H}, in equal proportion, with wages wL < wH . For
concreteness, suppose the internality is harmful (γ(θ) > 0) and that L consumes more c2 than H.
We normalize the units of c2 so p = 1, so that each individual’s budget constraint requires that
c∗1 (θ) = z ∗ (θ) − Tθ − (1 + t)c∗2 (θ), where c∗i (θ) denotes type θ’s of ci .

3.1

Example 1: Regressivity caused by heterogeneous preferences

We assume the following functional forms:
U (c1 , c2 , z; θ) =G(c1 + v(c2 , θ) − Ψ(z/wθ ))
V (c1 , c2 , z; θ) =G(c1 + v(c2 , θ) − γ(θ)c2 − Ψ(z/wθ ))
where v is increasing and strictly concave in its first argument, and its dependence on θ represents
preference heterogeneity, which generates differences in consumption of c2 even if both types were
given the same net income. Moreover we assume vc0 2 (c2 , H) < vc0 2 (c2 , L) for all c2 , so that c∗2 (H) <
c∗2 (L).16 Labor supply disutility Ψ is increasing and convex, implying a single crossing condition,
and G is a concave function, implying diminishing marginal utility of consumption. Thus γ(θ)
represents the money-metric bias wedge, in keeping with the definition from the previous section.
One implication of this specification is that there are no income effects—shocks to a person’s wealth
do not change one’s choice of c2 , nor one’s chosen labor supply.
The policy maker chooses a commodity tax t and taxes TL and TH (possibly negative) on the the
earnings of the two types to maximize social welfare
W :=

X

V (c∗1 (θ), c∗2 (θ), z ∗ (θ); θ) µ(θ)

θ

subject to the resource constraint

1
2

P

θ

(Tθ + tc∗2 (θ)) ≥ 0 and subject to the individual optimiza-

tion constraint that (c∗1 (θ), c∗2 (θ), z ∗ (θ)) maximizes U (c1 , c2 , z; θ) subject to each individual’s budget
constraint. To solve for the optimal commodity tax t, we form the Lagrangian
00
Notationally, we use fx0 (x, y) to denote the partial derivative of f with respect to x, fxy
(x, y) the cross partial, etc.,
throughout the paper.
16

8

L=W +

λX
(Tθ + tc∗2 (θ)) .
2
θ

The multiplier λ represents the marginal value of public funds. The social marginal welfare weights
are given by g(θ) = G0 (c∗1 (θ) + v(c∗2 (θ), θ) − γ(θ)c∗2 (θ) − Ψ(z ∗ (θ)/wθ )) /λ, and average to one because
the utility function does not exhibit income effects. The derivative of the Lagrangian with respect to
t must equal zero at the optimum, implying
0=

X
θ


 X
dc∗2 (θ)
dc∗2 (θ)
∗
∗
g(θ) −γ(θ)
c2 (θ) + t
,
− c2 (θ) +
dt
dt


θ

where we have used the fact that individual optimization implies vc0 2 (c2 , θ) = 1 + t. Rearranging, the
optimal commodity tax t∗ satisfies
∗

P

θ

t =
|

dc∗2 (θ)
dt

g(θ)γ(θ)
P dc∗2 (θ)
θ dt
{z

corrective benefits

}

P
−
|

θ

c∗2 (θ)(1 − g(θ))
P dc∗2 (θ)
θ dt
{z
}

(1)

regressivity costs

Written this way, the optimal tax can be transparently decomposed into two terms. The first term
represents the corrective benefits from reducing c2 —correction is more valuable to the extent that
the consumers who respond most to the tax have (1) greater bias γ(θ), or (2) higher welfare weight
g(θ). The second term represents the regressivity costs of taxing a commodity consumed primarily
by the poor. Since c∗2 (H) < c∗2 (L) and the welfare weights average to one, the regressivity costs term
reduces the optimal tax. This force captures the common intuition that corrective taxes on goods
consumed by the poor should be reduced for redistributive reasons. As will be apparent from the
next example, this intuition depends crucially on the the assumption that preference heterogeneity is
the reason low earners consume more c2 .

3.2

Example 2: Regressivity caused by income effects

We now consider the case where income effects are responsible for differences in c2 consumption. Here
we assume the following functional forms:
U (c1 , c2 , z; θ) =G(c1 + v(c2 , c1 ) − Ψ(z/wθ ))
V (c1 , c2 , z; θ) =G(c1 + v(c2 , c1 ) − γc2 − Ψ(z/wθ ))
This specification is similar to that in the previous example, with a key modification: the function
v now has numeraire consumption c1 as its second argument, rather than type θ.17 The moneymetric value of marginal bias γ(θ) for θ now differs slightly from the structural value of γ, with

γ(θ) = γ/ 1 + vc0 1 (c∗2 (θ), c∗1 (θ)) ; the difference is small provided that dependence of utility from c2
on numeraire consumption only minimally changes the marginal utility of numeraire consumption.
17

As a result, the expression for the marginal social welfare weight (defined as the social value of marginally more numeraire consumption for θ) is now g(θ) = G0 (c∗1 (θ) + v(c∗2 (θ), c∗1 (θ)) − γc∗2 (θ) − ψ(z ∗ (θ)/wθ )) (1 + vc0 1 (c∗2 (θ), c∗1 (θ))) /λ.

9

We let ḡ denote the average social marginal welfare weights, which will be greater than one because
income effects generate a fiscal externality from a lump-sum tax.
To characterize the optimal commodity tax in this case, consider raising the commodity tax by
dt while adjusting the income tax to neutralize the effect on wealth, so that consumers do not change
their choice of income.18 The income tax reform must therefore reduce TL by dt · c∗2 (L) and reduce TH
by dt · c∗2 (H). That reform exactly absorbs the funds generated mechanically by the commodity tax
increase, so the only first-order effect on government revenues
 comes through the fiscal externality
dc∗2 (θ)
dc∗2 (θ)
t
from the adjustment of c2 , equal to 2
+ dt
.19 Note that these are compensated
dt
u

u

demand responses, since the income effect from the change in t has been offset by the income tax
perturbation.
The only effect
on consumer welfare is through changing the consumption of c2 ,
 of this reform

dc∗2 (θ)
1P
given by 2 θ −g(θ)γ(θ) dt
. Absent bias, this term would be equal to the zero due to the
u

envelope theorem. Under the optimal tax system, the perturbation of the commodity and income
taxes must have no first-order effect on welfare, requiring that the net effects on government revenues
and consumer welfare sum to zero:
X dc∗ (θ)
2
t
dt
θ

!
u


X
dc∗2 (θ)
−
g(θ)γ
= 0.
dt u
θ

Rearranging this expression, we find that the optimal commodity tax satisfies
dc∗ (θ)

P 
t∗ =

θ

2
g(θ)γ dt
P dc∗2 (θ)

θ

dt


u

.

(2)

u

The optimal tax in this case is equivalent to the “corrective benefits” term in (1). However, the
“regressivity costs” term does not carry through to this context. This is because when consumption
differences are due to income effects, as in this example, an income-tax reform can (and, at the
optimum, must) perfectly neutralize the effects of the commodity tax on income.

3.3

Discussion

These examples illustrate how redistributive concerns play a nuanced role in determining the optimal
tax. Equation (1) illustrates how the optimal tax can be decomposed into two components representing corrective benefits and regressivity costs, only the former of which is relevant when consumption
heterogeneity comes from income effects.
Although it is intuitive that redistributive concerns affect regressivity costs, it is perhaps more
surprising that they also affect the size of corrective benefits. In the case of a constant elasticity
of demand for c2 , redistributive concerns push the tax in the opposite direction from the standard
18

In the previous example, since there were no income effects on labor supply, changes in the commodity tax did not
affect labor supply, and thus no such neutralizing income tax reform was required.
19

The notation

dc∗
j (θ)
dt

income adjustment.

denotes a compensated demand response, with U held constant through a compensatory
u

10

regressivity concern: greater inequality aversion pushes toward a larger corrective tax. Intuitively, the
corrective benefit is proportional to the change in c2 consumption, and constant elasticity of demand
implies that those who consume the most of the sin good (poor consumers) reap the largest benefits
from correction. A more redistributive planner values this concentration of corrective benefits on the
poor more heavily, and thus perceives a larger corrective benefit from taxation. This result stands in
contrast to the common intuition that concentration of sin good consumption among the poor should
dampen the optimal tax, and it highlights the importance of understanding the source of variation
in the consumption of internality-producing goods across the income distribution.
When consumption differences are due to preference heterogeneity, redistributive concerns magnify
both corrective benefits and regressivity costs and so the net effect is ambiguous. We generalize this
idea, and discuss the intuition in more detail in Section 4.3.4. In the numerical simulations in
Section 6 we illustrate that the optimal tax can indeed be either larger or smaller than the Pigouvian
benchmark.

4

A general formula for the optimal commodity tax

4.1

Assumptions and elasticity concepts

We now turn to the general case with a continuum of types. For the remainder of the paper we
impose the following assumptions, common in the optimal commodity taxation literature, in order
to focus on the interesting features of sin taxes in a tractable context.
1. No labor supply misoptimization:

U3
U1

=

V3
V1

for all types, at all allocations. That is, although

there is a bias wedge between c1 and c2 , there is no such wedge between c1 and z. This
assumption is not crucial, and we relax it in Section 5.5.
2. Constant marginal social welfare weights conditional on income: g(θ) = g(θ0 ) if z(θ) = z(θ0 ).
This assumption is analogous to Assumption 1 in Saez (2002a). It holds immediately if types are
homogeneous conditional on income. More generally, Saez (2002a) argues this is a reasonable
normative requirement even under heterogeneity: “if we want to model a government that
does not want to discriminate between different consumption patterns, it seems reasonable to
assume that the primitive conditions on utilities and social weights have been specified so that
Assumption 1 is true at the optimum.”
3. U and V are smooth functions that are strictly concave in c1 , c2 , z, and µ is differentiable with
full support.
4. The optimal income tax function T (·) is twice differentiable, and each consumer’s choice of
income z admits a unique global optimum, with the second-order condition holding strictly at
the optimum.
Assumptions 3 and 4 ensure that the income distribution does not exhibit any atoms and individuals’
labor supply and consumption decisions respond smoothly to perturbations of the tax system (see
11

Jacquet and Lehmann (2014) for the role of these assumptions). We represent the behavioral responses
of c2 (θ) to taxes using the following parameters, which can be measured empirically:


p+t
• ζ(θ, t, T ): the price elasticity of demand for c2 from type θ, formally equal to − dc2 (θ,t,z)
dt
c2 (θ,t,T ) .
• ζ c (θ, t, T ): the compensated price elasticity of demand for c2 , equal to −



dc2 (θ,t,z)
dt
u



p+t
c2 (θ,t,T ) .

• η(θ, t, T ): the income effect on c2 , equal to ζ − ζ c .
Additionally, we represent the labor supply response to tax reforms using the following parameters,
which are defined formally in Appendix A:
• ζzc (θ, t, T ): the compensated elasticity of taxable income with respect to the marginal income
tax rate.
• ηz (θ, t, T ): the income effect on labor supply.
These responses are defined to include the full sequence of adjustments due to any nonlinearities in
the income tax. See Jacquet and Lehmann (2014) for an extensive discussion of such “circularities.”
For each of the above parameters, we will sometimes suppress the arguments t and T , though endogeneity to the tax is acknowledged throughout. Moreover, it will prove convenient to average these
statistics across all agents with a given
income;
such averages are denoted c̄2 (z), etc., with behavioral



p+t
2 (z)
responses then denoted ζ̄(z) = − dc̄dt
c̄2 (z) , and similarly for other parameters. Aggregate con

R
p+t
2
sumption of c2 is denoted C2 = Θ c2 (θ)dµ(θ), with aggregate elasticity of demand ζ̄ = − dC
dt
C2 ,
R
etc. The income distribution is denoted H(z) = Θ 1 {z(θ) ≤ z} dµ(θ), with density h(z).

Finally, as has been suggested in Section 3, and as will be formalized in this section, it is important
to distinguish between two sources of cross-sectional variation in c̄2 (z): income effects, and preference
heterogeneity. We use c̄02 (z) to denote the total change in c̄2 (z) with respect to z. This incorporates
both that 1) a given θ-type may choose to consume a different amount of c2 when his income goes
up (the income effect) and that 2) the types of consumers earning z 0 rather than z have different
tastes for c2 (preference heterogeneity). The portion of this change that is explained by income
∂

effects is defined ψ(z) := E ∂z
c2 (z, θ)|z ∗ (θ) = z , where z ∗ (θ) is the z-choice of a type θ. We set
Rz
φ(z) := x=0 ψ(x)dx + c2 (0); intuitively, φ(z) is how much c2 an average z-earner would consume if
all variation in c2 was explained solely by income effects. Indeed, c̄2 (z) = φ(z) when preferences over
c1 and c2 are homogeneous:
Lemma 1. If for all z, U2 (c1 , c2 , θ, z)/U1 (c1 , c2 , θ, z) does not depend on θ, then φ(z) = c̄2 (z).
We set φ̃(z) :=

c̄2 (z)−φ(z)
.
C2

This unitless index φ̃(z) measures how much of the difference between

c̄2 (z) and c̄2 (0) is explained by preference heterogeneity, rather than income effects, normalized by
average consumption of c2 .

12

4.2

An expression for the optimal commodity tax

To aggregate bias across individuals, we will follow Allcott et al. (2014) and Allcott and Taubinsky
(2015) in defining the average marginal bias (i.e., bias weighted by compensated demand response):


dc2 (θ,t,T )
dµ(θ)
γ(θ,
t,
T
)
dt
Θ
u
γ̄(t, T ) =
R  dc2 (θ,t,T ) 
dµ(θ)
dt
Θ
R

u

as well as the average marginal bias among z-earners:


dc2 (θ,t,T )
γ(θ,
t,
T
)
1 {z(θ, t, T ) = z} dµ(θ)
dt
Θ
u
γ̄(z, t, T ) =
R  dc2 (θ,t,T ) 
1 {z(θ, t, T ) = z} dµ(θ)
dt
Θ
R

u

Intuitively, this aggregation represents the marginal bias weighted by individuals’ marginal responses to a tax reform which raises the tax t while reforming T to offset the average effect on wealth
at each income z. If dC2 is the marginal change in total consumption of c2 generated by such a tax
reform, γ̄ is the average amount by which consumers over- or under-estimate the change in utility
from that change in consumption. We also define

σ := CovH

γ̄(z) ζ̄ c (z) c̄2 (z)
g(z),
γ̄
ζ̄ c C2



as the covariance of welfare weight with consumption-weighted bias and elasticity. If bias and elasticity
are invariant with income, then this is positive when low earners consume more c2 . In general,
σ captures the extent to which the bias correction is concentrated on the low-end of the income
distribution.
We proceed under assumption A below, which simplifies the ensuing equations but is not crucial
for the derivation. We explore the effect of relaxing Assumption A in Appendix C.1, which provides
guidance for the directional effect of non-zero income conditional covariances on the optimal tax. A
particularly simple case in which assumption A holds is when heterogeneity is uni-dimensional; that
is, when individuals earning the same income z have the same tastes for c2 .
Assumption A. At each before-tax income z, the elasticities η, ζ c , ηz , ζzc , the bias γ, and consumption c2 are all mutually independent at the optimal tax system.
We begin by characterizing taxes not in terms of the social marginal welfare weights g(z), but
in terms of the social marginal utility of income ĝ(z), defined (as in Farhi and Gabaix, 2015) as the
average welfare effect of marginally increasing the incomes of consumers currently earning income
z. The weights ĝ(z) account for fiscal externalities resulting from income effects, and for the fact
that some of this additional consumption will be mis-spent due to bias.20 We then show that under
empirically realistic assumptions, we can replace ĝ(z) with g(z) in the commodity tax formula. We
conclude this section by providing formulas for the general case in terms of the weights g(z).
20

0

T
Formally, ĝ(z) = g(z) − (1 + ηz ) g(z)γ̄(z)−t
η(z) + ηz 1−T
0.
p+t

13

Proposition 1. The optimal commodity tax t and income tax T satisfy the following at the optimum:
h
i
p+t
(3)
t = γ̄(ḡ + σ) − c Cov ĝ(z), φ̃(z)
ζ̄
h
i
ζ̄ c γ̄(ḡ + σ) − pCov ĝ(z), φ̃(z)
h
i
=
(4)
ζ̄ c + Cov ĝ(z), φ̃(z)
T 0 (z)
g(z)γ̄(z) − t
1
=
η(z) + c
1 − T 0 (z)
p+t
ζz zh(z)

Z

∞

(1 − ĝ(x))dH(x)
z

Proposition 1 shows that the optimal tax is the combination of two terms. The term γ̄(ḡ + σ)
corresponds to the corrective benefits of the tax. The corrective benefits are increasing in 1) the
average marginal bias γ̄, 2) the average social welfare weight ḡ and 3) the extent to which bias
correction is concentrated
onithe low-income consumers, σ.
h
The term Cov ĝ(z), φ̃(z) roughly corresponds to the regressivity costs of the tax that cannot be
offset by progressive revenue recycling. Importantly, this term depends on the extent to which the
variation of c2 consumption by income is due to preference heterogeneity rather than income effects.
When preference heterogeneity explains a constant portion κ of c2 consumption, φ̃(z) = κc2 (z)/C2 ,
and regressivity costs are an increasing function of κ.
Equation (3), written in a form which echoes equation (2) from the binary types model in the
previous section, illustrates that the optimal tax can be written as the corrective benefits per unit
change in c2hconsumption—given
by γ̄(ḡ+σ)—less regressivity costs per unit of c2 consumption—given
i
p+t
Cov
ζ̄ c

ĝ(z), φ̃(z) . In (4) we rearrange so that t does not appear on the right side. The terms
h
i
ζ̄ c γ̄(ḡ + σ) and pCov ĝ(z), φ̃(z) roughly correspond to the corrective benefits and regressivity costs

by

per percent change in the price.
Equation (4) provides key guidance about the relative influence of the corrective benefits versus
the regressivity costs in the optimal tax formula. The higher is the elasticity, the higher are the
corrective benefits per unit change in the tax. Correspondingly, the relative importance of corrective
benefits, as well as how sensitive the optimal tax t is to different levels of bias γ̄ depends crucially on
the price elasticity of demand—an issue we return to in subsection 4.3.6.
A complication in the formulas in Proposition 1 that lead to expressions involving ĝ instead of g is
the potential relevance of labor supply income effects ηz . However, Gruber and Saez (2002) find small
and insignificant income effects and Saez et al. (2012) review the empirical literature on labor supply
elasticities and argue that “in the absence of compelling evidence about significant income effects in
the case of overall reported income, it seems reasonable to consider the case with no income effects.”
We now consider this case and also simplify further by assuming that consumers’ expenditures on
c2 are sufficiently small to have a negligible impact on the marginal utility from consumption of c1 ,
rendering income effects on c2 negligible as well.


−U12
Corollary 1. Assume that ηz ≈ 0. And assume, additionally, that terms O c2 (p+t)UU11
are
1
negligible; that is, consumers’ expenditures on c2 , given by (p + t)c2 , are sufficiently small as to have
a negligible impact on the marginal utility from the numeraire good c1 . Then
14

h
i
ζ̄ c γ̄(ḡ + σ) − pCov g(z), φ̃(z)
h
i
t≈
ζ̄ c + Cov ĝ(z), φ̃(z)
The corollary shows that that under the simplifying assumptions, the optimal commodity tax
formula in Proposition 1 can be simplified by replacing ĝ(z) with g when income effects are small
relative to income inequality. This simplification is exactly accurate in the special cases of pure
preference heterogeneity (since income effects are nonexistent) and pure income effects (since the
regressivity costs term is then zero). Moreover, we show in Appendix F.3 that this approximation
is very accurate numerically even outside these special cases. For brevity, we defer the intermediate
case, in which ηz ≈ 0 but expenditures on c2 are large, to Appendix C.2.
Of course, the assumption of negligible income effects is not necessary to provide optimal tax
formulas that are expressed in terms of the social marginal welfare weights. The key variable needed
for this solution is the following: “When we raise the commodity tax by dt, how much money can
we give back to each person to offset the tax so as to keep the average labor supply choices of each
z-earner constant?” Roughly, we seek to characterize the extent to which we can offset the regressivity
costs of the commodity tax by making the income tax more progressive. We begin with a lemma
providing this characterization:
Lemma 2. Let χ(z) := φ(z) −

Rz
0

R x0 =z

w(x, z) ζ̄ηczx (c2 (x) − φ(x))dx, where w(x, z) = e

z 0 =x

− ζηczz dx0
z

. Then

z

increasing the commodity tax by dt and decreasing the income tax by χ(z)dt leaves the average labor
supply of z-earners unchanged.
Note that χ(z) = φ(z) when ηz = 0. That is, in the absence of labor supply income effects,
the term φ(z)—which we defined as the portion of c2 consumption explained by consumption income
effects—is the extent to which the income tax should be optimally lowered for z-earners. When ηz 6= 0
and φ(z) < c2 (z), χ(z) will be higher than φ(z). Intuitively, this is because giving back φ(z)dt to
consumers offsets the effective impact on the marginal keep-rate from before-tax earnings, but does
not fully offset the income effect as it leaves consumers poorer by an amount (c2 − φ)dt. Analogous
to φ̃(z), we define the index χ̃(z) :=

c̄2 (z)−χ(z)
.
C2

Proposition 2. The optimal commodity tax t satisfies
corrective benefits

t=

z }| {
γ̄(ḡ + σ)

regressivity costs

additional impact from income effect

}|
{
z
}|
{ z Z
1
p+t
+ c E[(1 − g(z))χ̃(z)] − c χ̃(z)η(z)(t − g(z)γ̄(z))
ζ̄
ζ̄

(5)

Proposition 2 provides a commodity tax formula similar to Corollary 1, with two differences. First,
the covariance term Cov[g(z), φ̃(z)] corresponding to regressivity costs is written more generally as
E[(g(z) − 1)χ̃(z)]. These two terms are equivalent when E[g(z)] = 1, but differ when E[g(z)] > 1 in
the presence of labor supply income effects (ηz 6= 0). Second, the presence of income effects η means
that a tax reform that decreases consumers’ after-tax income by c2 (z)−χ(z) also impacts consumption
of c2 , beyond the compensated elasticity with respect to prices. This generates fiscal externalities
15

proportional to tη(c2 (z) − χ(z)) and additional corrective benefits proportional to gγ̄(c2 (z) − χ(z)).
Combined, this generates the third term in equation (5) above. In the absence of income effects, the
formula reduces to
t = γ̄(ḡ + σ) −

h
i
p+t
Cov
g(z),
φ̃(z)
,
ζ̄ c

which can be solved for tto get the formula in Corollary 1.

4.3
4.3.1

Interpretation and implications
Optimal taxes in the absence of redistributive concerns

We begin by relating the general formula in Proposition 1 to known sin tax results, derived under
the assumptions of no redistributive concerns.
Corollary 2. Suppose that either 1) z(θ) is constant in θ or 2) g(θ) = 1 for all θ. Then t∗ = γ̄.
Corollary 2 considers two special cases that correspond to existing work on sin taxes. In the
first case, we assume that there is no wealth inequality: z(θ) is constant in θ. In the second case,
we allow for differences in wealth, but assume that utility is quasilinear and that the policymaker
has no aversion to this wealth inequality. In both cases, the optimal commodity must exactly offset
the average marginal bias. The first case is a slight generalization of known sin tax results (e.g.,
O’Donoghue and Rabin 2006; Mullainathan et al. 2012; Allcott et al. 2014; Allcott and Taubinsky
2015) to the case of income effects, while the second case is a slight generalization of known sin tax
results to situations in which the policymaker also has a nonlinear income tax at his disposal.
4.3.2

Optimal taxes in the absence of corrective concerns

Another special case of our framework is the case in which there are no corrective concerns. Proposition 1 implies that for this case,
h
i
pCov ĝ(z), φ̃(z)
h
i,
t=−
ζ̄ c + Cov ĝ(z), φ̃(z)

(6)

and Proposition 2 can similarly be used to obtain a formula in terms of g(z) rather than ĝ(z).
Equation (6) generalizes the seminal Atkinson-Stiglitz theorem to the case of arbitrary preference
heterogeneity. The Atkinson-Stiglitz theorem itself obtains as a special case of (6) when all variation
in c2 consumption is driven by income effects, which then implies that t = 0. Additionally, formula
(6) generalizes the qualitative analyses about the usefulness of commodity taxes by Saez (2002b)
and Edwards et al. (1994), the results for two-type models by Edwards et al. (1994) and Nava et al.
(1996), and results for homogeneous preferences by Jacobs and Boadway (2014).
4.3.3

Optimal taxes when income effects do not affect c2 consumption

Consider next the case in which all differences in c2 consumption are due to differences in tastes; that
is, there are no income effects.
16

Corollary 3. Suppose that there are no income effects: η ≡ 0 and ηz ≡ 0. Then
t∗ =

γ̄ (ḡ + σ)
| {z }

Corrective benefits

−

p + t∗
Cov[g(z), c̄2 (z)]
ζ̄ c
|
{z
}

(7)

Regressivity costs

The formula, which generalizes our results from Example 1 in Section 3, consists of two terms.
The first term—corrective benefits—reflects the extent to which changing consumer demand for c2
increases welfare because it counteracts consumer biases. Note that the magnitude of the first term is
now dependent on σ, the extent to which the corrective benefits are concentrated on the low-income
consumers.
The second term—regressivity costs—reflects the extent to which the tax (or subsidy) is regressive
and contributes to wealth inequality. This term persists in the formula despite the policymakers’
ability to offset the commodity regressivity using a more progressive income tax. This is because
making the income tax more progressive in this case will generate fiscal externalities that outweigh
its redistributive benefits.
To provide some intuition for the second term, consider the case in which low-wage consumers
also have a higher preference for c2 . In this case, a positive tax falls more heavily on the lowincome consumers, making the total tax burden less progressive. Despite the fact that the total tax
burden has become less progressive, however, consumers are not more motivated to increase their
labor supply—precisely because all differences in c2 are due to heterogeneous preferences, rather than
differences in wealth. Thus, any tax reform that increases a regressive sin tax and attempts to offset
that by making the income tax more progressive will generate fiscal externalities by lowering overall
labor supply in the economy.
A stark implication of (7) is that the optimal sin tax will be negative (a sin subsidy) when the
consumers who over-purchase the good are inelastic to the tax. This captures the spirit of a key
result of Bernheim and Rangel (2004) about the optimality of subsidizing addictive goods when the
marginal utility of income is increasing with the consumption of the addictive good.21 Although
the Bernheim and Rangel (2004) result that the sin good should be subsidized is seemingly in stark
contrast to the sin tax results in, e.g., O’Donoghue and Rabin (2006), our general tax formula clarifies
the economic forces that lead each result.
At the same time, our results also extend this earlier work by allowing the policymaker to cary
out redistribution through the income tax. Although Corollary 3 would continue to hold exactly if
the policymaker did not have access to an income tax, or if the income tax was constrained to be
fixed at particular levels,22 we now discuss in more detail how the optimal commodity tax deviates
from this formula when preferences heterogeneity does not explain all variation in c2 consumption.
21
Because in Bernheim and Rangel (2004) over-consumption of the good is a consequence of cue-triggered neural
processes that render the individual inelastic to prices, the average bias of consumers who are elastic to the tax is zero.
Thus, their subsidy result is a direct consequence of the positive covariance between consumption of the addictive good
and the marginal utility from income—analogous to our “regressivity costs term.
22
Note that more generally, we do not need to assume that the commodity tax authority have full control over the
income tax per se—they could instead employ other progressive revenue recycling policies to offset regressivity, such
as Philadelphia’s promise to direct a share of SSB tax revenues toward targeted pre-K programs.

17

4.3.4

Optimal taxes when all differences in c2 consumption are due to income effects

When differences in consumption are due purely to differences in wealth, any regressive consequences
of a tax or subsidy can be perfectly offset by changes to the income tax, in such a way that the there
are no fiscal externalities resulting from the full policy reform.
Corollary 4. Suppose that U2 (c1 , c2 , θ, z)/U1 (c1 , c2 , θ, z) is constant in θ for each z. Then
t∗ = γ̄ (ḡ + σ)

(8)

Formula (8) generalizes the results in our Example 2 in Section 3, and shows that when preferences
for c2 are homogeneous, the optimal commodity tax is proportional to the average marginal bias,
irrespective of how consumption of c2 varies across the income distribution.
Note, however, that redistributive concerns still play a role in the size of the optimal commodity
tax, and are reflected in the σ term. The more elastic the low-income consumers are, and the more
biased they are relative to the high income consumers, the higher is σ and thus the higher is the benefit
of bias correction. The intuition for this is a consequence of two principles. First, as we illustrated
in Example 2, the mechanical wealth effect of the commodity tax can be directly offset by making
the income tax more progressive. The welfare effects of this tax reform can thus be decomposed into
only two effects: 1) bias correction and 2) the fiscal externality from lowering consumption of c2 . The
social welfare benefits of bias correction are shaped by the following principle: a policymaker with
redistributive motives should be willing to spend more than $1 to eliminate a $1 mistake made by
the poor consumers. Thus, corrective motives are amplified when “bias correction” is concentrated
on the low-income consumers—either because they are more biased or because they are more elastic
to the income tax. Conversely, when bias correction is concentrated on high-income concerns, a
policymakers’ motives for correcting that bias will be diminished.
4.3.5

Redistributive motives can amplify corrective benefits

The above discussion underscores a broader point: although in some cases redistributive motives
can lower the size of the optimal tax because of regressivity concerns, in other cases redistributive
motives can actually amplify the size of the optimal tax if bias correction is concentrated on the low
income consumers. As we discuss next, redistributive concerns are most likely to amplify the size of
the optimal tax when the elasticity is high.
4.3.6

The key role of the price elasticity of demand in determining the importance of
corrective benefits

Proposition 1 shows that as that elasticity grows large, the optimal tax t approaches γ̄(ḡ +σ), which is
the formula for the optimal tax when there are no regressivity costs due to heterogeneous preferences.
In this case, if σ > 0 then the size of the optimal tax will be higher than what it would be in the
absence of redistributive concerns.

18

Intuitively, as the elasticity grows large, the corrective benefits per unit change in the tax, as
well as the fiscal externalities from substitution away from c2 , grow very large. On the other hand,
regressivity costs per unit change in the tax—which correspond to how much of the mechanical
revenue effect from the unit increase in the tax falls on the low income consumers—do not change
with the size of the tax. Thus, when the elasticity is large, the regressivity costs become negligible,
and the optimal tax is determined by the tradeoff between corrective benefits and fiscal externalities
from substitution.
At the opposite extreme, as the elasticity grows small, corrective benefits become negligible compared to the regressivity costs, and the optimal tax approaches the formula in equation (6). If
preference heterogeneity accounts for any share of the decrease in c2 consumption across incomes,
then a sufficiently low elasticity implies the optimal tax becomes has to be negative (a subsidy) whenever it is regressive. Intuitively, if individuals do not respond to commodity taxes, then such taxes
become a powerful instrument to enact redistribution through targeted subsidies.
More generally, the results clarify that the role of consumer bias in shaping both the sign and
magnitude of the optimal commodity tax is modulated by the price elasticity of demand. But perhaps
most importantly, the elasticity also provides practical guidance on how sensitive the optimal tax is
to different values of the bias γ̄. Consider, for example, two different estimates of bias in sugary drink
consumption: 5 cents per ounce versus 3 cents per ounce. For a high elasticity, the high estimate
implies an optimal tax that is almost 2 cents per ounce higher than under the low estimate. For a
low elasticity, the difference in the estimates could translate to a difference in taxes that is, e.g., only
1 cent.
4.3.7

The importance of decomposing cross-sectional variation in c2 into income effects
and preference heterogeneity

As the two special cases we have examined so far show, whether the cross-sectional variation of c2 is
explained by preference heterogeneity or income effects plays a crucial role in whether concerns about
regressivity are reflected in commodity taxes. In practice, of course, both preference heterogeneity
and income effects like play a role in explaining the variation in consumption of the sin good. In
the case of energy efficiency subsidies, both of these likely contribute to the fact that higher-income
consumers purchase more energy efficient products. In the case of sin goods such as cigarettes or
unhealthy foods, both likely play a role as well, though it is entirely possible that the sin goods are
normal goods, meaning that income effects actually decrease the cross-sectional variation that we
observe.
Our general results in Propositions 1 and 2 provide a quantitative, elasticity-based formula that
covers all of these cases. Broadly speaking, the more that c2 variation across incomes is driven by
income effects, the smaller the magnitude of regressivity costs.
But at the same time, our results also imply that the regressivity costs may be higher than what
many would conjecture. If c2 is a normal good and yet consumption of c2 decreases with income, our

19

results show that regressivity costs are actually larger than Cov[ĝ(z), c̄2 (z)],23 since the commodity
both falls more heavily on the poor than the rich and decreases labor supply.

5

Extensions

5.1

Tax Salience on the labor supply Margin

Most sin taxes take the form of excise taxes that are incorporated into the final posted price of
the good, and are thus likely to be fully salient at the time of purchase. However, the assumption
that people can correctly compute how various commodity taxes—or differences in prices, more
generally—determine the implicit marginal tax rate on their labor income may be too demanding.
A tax on a particular luxury good, for example, indirectly decreases the returns from labor supply;
but in practice, its effect may be smaller than that of an equivalent, but direct, increase in marginal
income tax rates on wealthy consumers.
A reasonable hypothesis is that the effects of commodity taxes on labor supply may be minimal,
even when the variation consumption is due to income effects rather than preference heterogeneity.24
If that is the case, then offsetting the effects of regressive commodity taxes by making the income
tax more progressive will be undesirable even when there is little preference heterogeneity.
Formally, we consider consumers whose perceived price of c2 is given by (1 − ϑ)p̂ + ϑ(p + t) when
they are making a labor supply decision, where p̂ is a “mental default” and p + t is the actual after-tax
price. The attention parameter ϑ captures the extent to which consumers’ labor supply is sensitive to
variations in prices generated by the commodity tax. However, we assume that prices are understood
when consumers choose how to spend their after-tax earnings z − T (z) on c1 and c2 .
We provide a fully general characterization of the optimal commodity tax, as well as a derivation
of the optimal income tax, in Appendix B.5. In this section, we discuss the results for the commodity
tax in the illustrative case in which ϑ does not vary by z and ηz = 0.
Proposition 3. Suppose that ϑ is constant and ηz = 0. Then the optimal commodity tax satisfies
h
i
p + t∗
t = γ̄(ḡ + σ) −
Cov
ĝ(z),
(1
−
ϑ)c
(z)
+
ϑ
φ̃(z)
2
ζ̄ c
h
i
ζ̄ c γ̄(ḡ + σ) − pCov ĝ(z), (1 − ϑ)c2 (z) + ϑφ̃(z)
h
i
=
ζ̄ c + Cov ĝ(z), (1 − ϑ)c2 (z) + ϑφ̃(z)
Proposition 3 show that the less people consider commodity taxes on the labor supply margin, the
closer the formula is to the case of pure preference heterogeneity.
The result is particularly stark in the case of ϑ = 0, leading to the following corollary of the
derivations in Appendix B.5:
23
This is because the term φ(z), corresponding to how much variation is explained by income effects, is actually
negative in this case.
24
A possible micro-foundation for this is along the lines of the sparsity-based bounded rationality model of Gabaix
(2014). Because expenditures on any one of many dimensions of consumption are relatively small, while the total tax
burden paid through the income tax is relatively high, the framework of Gabaix (2014) would predict that people pay
less attention to changes in taxes or prices on particular commodities than they do to changes in the income tax.

20

Corollary 5. Suppose that ϑ = 0 for all individuals. Define γ̄ u and σ u analogously to γ̄ and σ, but
with respect to uncompensated demand responses. Then the optimal commodity tax satisfies
p+t
Cov [g(z), c2 (z)]
ζ̄ c
ζ̄ c γ̄ u (ḡ + σ u ) − pCov [g(z), c2 (z)]
.
ζ̄ c + Cov [g(z), c2 (z)]

t = γ̄ u (ḡ + σ u ) −
=

In this case, even under the standard assumptions of the Atkinson-Stiglitz theorem—that preferences are homogeneous, so that income effects explain all variation in c2 consumption and φ̃ = 0—the
regressivity costs will still be given by Cov[ĝ(z), c2 (z)]. Intuitively, if labor supply does not respond
to differences in the commodity tax, then the welfare effects of increasing the commodity tax depend
only on 1) its corrective benefits and 2) the extent to which it is regressive. Because the commodity
tax has no effect on the labor supply margin, any attempts to offset its regressivity through the
income tax would generate additional fiscal externalities.25
Beyond the implications for sin taxes, these results also underscore that the Atkinson-Stiglitz
theorem depends crucially on the assumption that consumers can perfectly calculate how changes in
commodity taxes affect their returns to labor supply.

5.2

N > 2 Dimensions of Consumption

Our results easily generalize to N > 2 dimensions of consumption. As before, we treat c1 as the
numeraire, and assume that U1 /UN +1 = V1 /VN +1 . Let S denote the Slutsky matrix of compensated
demand responses in which the j, i entry is the compensated demand response of cj with respect to
ti .
Let γi (θ), for i ≥ 2, denote the bias in consumption dimension i, and let γ̄i (z) denote the statistic
for z-earners. Let γ̄ij denote the average marginal bias from consumption of cj with respect to tax i:


dhj (θ,t,T )
γ
(θ,
t,
T
)
dµ(θ)
dti
Θ j


γ̄ij =
R
dhj (θ,t,T )
dµ(θ)
dti
Θ
R

"
where hj is the compensated (Hicksian) demand for good j. We also define σij := CovH g(z),
We define R to be a column vector in which the jth entry is Ri = −

P dhj
dti

γ̄(z)
γ̄

dhj (θ,t,T )
dti
dhj (θ,t,T )
dti

γ̄ij (ḡ + σij ). That is, Ri

is the total corrective benefit from increasing tax ti , keeping income constant.
As before, we define φj (z) to be the portion of cj consumption explained by income effects, and
we define φ̃j (z) := (cj − φj )/Cj to be the variation due to preference heterogeneity. We define ρ to
be the column vector in which the jth entry is Cov[ĝ(z), φ̃j (z)].
Proposition 4. The optimal commodity taxes t = (t1, . . . , tN ) satisfy
tS = ρ − R
25

Moreover, the formula for the commodity tax in Corollary 5 would continue to hold even when

21

(9)

#
.

and the optimal income tax satisfies
X g(z)γ̄i (z) − ti
1
T 0 (z)
ηi (z) + c
=
1 − T 0 (z)
pi + ti
ζz zh(z)
i

Z

∞

(1 − ĝ(x))dH(x)

(10)

z

The system of linear equations in (9) can be easily solved for the optimal commodity taxes using
Cramer’s rule. As an example, consider the case of three commodities, where c1 is the numeraire as
before. Solving the system of linear equations in (9) using Cramer’s rule yields
t2 =
t3 =
where D :=

dh2 dh3
dt2 dt3

−

dh2
dt3

·

dh3
dt2

dh3
3
−(R2 − ρ2 ) dh
dt3 + (R3 − ρ3 ) dt2

D
dh2
2
−(R3 − ρ3 ) dh
dt2 + (R2 − ρ2 ) dt3
D

(11)
(12)

> 0.

Equations (11) and (12) generate several economic insights. Assume for simplicity that ḡ = 1 and
that γ2 and γ3 are homogeneous across incomes. Then the expressions above simplify to
t2 =
t3 =

dh3
3
γ2 D + ρ2 dh
dt3 − ρ3 dt2

D
dh2
2
γ3 D + ρ3 dh
dt2 − ρ2 dt3

D

(13)
(14)

We now consider two special cases with policy relevance. First, consider a stylized example in
which c2 represents regular soda, consumed primarily by poorer consumers (ρ2 > 0) and c3 represents
diet soda, consumed more heavily by richer consumers (ρ3 < 0). Suppose also that R2 − ρ2 > 0,
meaning that corrective benefits outweigh regressivity costs when taxing good 2, while −ρ3 + R3 > 0,
meaning that the progressivity benefits of taxing good 2 outweigh the indirect corrective costs from
consumers substituting from good 3 to good 2. In this case it is straightforward to verify that,
beginning from the case where

dh2
dt3

=

dh3
dt2

= 0 (independence) for which t2 > 0 and t3 > 0, the first-

order effect of introducing a small degree of substitutability is to reduce t3 while raising t2 .26 Thus
although a positive tax on diet soda may be optimal for redistributive reasons, the first order effect
of substitutability between diet and regular soda reduces the magnitude of the tax on diet soda and
magnifies the optimal tax on regular soda.27 (For larger degrees of substitutability, this first-order
effect need not dominate, so the ultimate effect of substitutability could be ambiguous.)
As a second special case, consider a stylized example in which c2 represents regular tobacco
cigarettes, and c3 represents electronic cigarettes which, though overconsumed, are less harmful than
regular cigarettes (γ2 > γ3 ). Both are consumed more heavily by poorer consumers (ρ2 , ρ3 > 0). In
this case, beginning again from the case of independence, the effect of substitutability is to lower
the optimal tax on both goods. Thus, the emergence of e-cigarettes suggests, perhaps somewhat
3
2
To see this, let x = dh
= dh
(the latter equality is implied by symmetry of the Slutsky matrix), and compute
dt2
dt3
3
2
2
2
the derivatives of each tax with respect to x, evaluated at x = 0: dt
= −ρ
and dt
= −ρ
.
dx x=0
D
dx x=0
D
27
This result is relevant for Philadelphia’s SSB tax, which applies equally both to sugar-sweetened beverages and
“diet beverages” with artificial sweeteners.

26

22

counterintuitively, that taxes on tobacco cigarettes should be lower.

5.3

Externalities

Of course, many sin goods also generate externalities. Driving gas guzzlers, for example, contributes
to carbon emissions, while smoking cigarettes may decrease the welfare of those in the vicinity of
the smoker. And consumption of unhealthy goods generates fiscal externalities arising from medical
expenses that are not fully internalized by individuals with insurance.
To see how how externalities are a special case of our framework, suppose that marginal social
damages from consumption of c2 are given by E(C2 ). Individuals maximize U , while the policymaker
wants them to maximize V = U − E 0 (C2 )c2 /α(θ). A simple corollary of Proposition 1 is that the
optimal commodity tax is then given by
h
i
− pCov ĝ(z), φ̃(z)
h
i
ζ̄ c + Cov ĝ(z), φ̃(z)

ζ̄ c E 0 (C2 )
t=

(15)

Formula (15) above generalizes Jacobs and de Mooij (2015) and Kaplow (2012), both of which derive
the optimal externality-correcting tax under the assumption that preferences are homogeneous. More
generally, in the presence of both externalities and internalities, the optimal tax is given by
h
i
ζ̄ c (γ̄(ḡ + σ) + E 0 (C2 )) − pCov ĝ(z), φ̃(z)
h
i
t=
.
ζ̄ c + Cov ĝ(z), φ̃(z)
In addition to generalizing our main results, the formula in (15) also clarifies a key difference
between externalities and internalities. In the case of consumer bias, it is necessary to know whether
the bias is bigger for the rich or for the poor, and whether the rich or the poor are more elastic. With
externalities—even if they are heterogeneously produced in the population—analogous questions are
irrelevant. It is not necessary to know 1) whether marginal damages generated by the poor are higher
than marginal damages generated by the rich or 2) how the price elasticity of c2 consumption varies
for the rich versus the poor.

5.4

Optimal tax formulas without the first-order approach

Throughout, we have assumed that the optimal tax system can be characterized by first order conditions. This assumption is made almost universally in the optimal taxation literature, including work
on commodity taxation such as Saez (2002) or Jacobs and Boadway (2014). In Appendix D, however,
we show that this assumption can be relaxed.
There are three special cases in which our results hold verbatim even without the differentiability
assumption. The first case is when there are no income effects: ηz = η = 0. In this case, a commodity
has no impact on labor supply, and the formula in Corollary 7 continues to hold. Similarly, if the
commodity tax is completely not salient on the labor supply margin, as in Section 5.1 with ϑ = 0,

23

then the commodity tax will again have no impact on labor supply, and the formula in Corollary 5
will continue to hold.
Third, when all variation of c2 is explained by income effects, labor supply will always remain
unchanged if an increase dt of the commodity tax is followed by a decrease dtc2 (z) in the income tax
T (z). In this case, the formula in Corollary 8 continues to hold.
Finally, in Appendix D, we provide a general solution for the case of uni-dimensional θ. The case
with no labor supply income effects is particularly simple. For z ∈ limdθ→0 [z(θ), z(θ + |dθ|)], define
c2 (θ + |dθ|, z(θ + |dθ|)) − c2 (θ + |dθ|, z(θ))
dθ→0
z(θ + |dθ|) − z(θ)

ω(z) = lim

At all values θ at which z is differentiable, ω(z) = φ(z). But when earnings z are discontinuous in
θ, ω(z) is simply the slope of the line connecting (z(θ), c2 (z(θ))) to (z(θ + dθ), c2 (z(θ + dθ))). Now
Rz
define χ(z) = c2 (0) + x=0 ω(z)dz. The solution is then exactly as in Proposition 2, using this more
general definition of χ(z).

5.5

Labor supply misoptimization

It is also possible to relax the assumption that U1 /U3 = V1 /V3 . Labor supply misoptimization modifies
the optimal income tax formula to allow to correct for labor supply internalities, as shown in Farhi
and Gabaix (2015), Lockwood (2016), and Gerritsen (forthcoming). Labor supply misoptimization
does not alter the optimal commodity tax in two special cases: (1) c2 consumption differences come
from preference heterogeneity, or (2) the commodity tax t is not salient when labor supply is chosen
(in this case, the formula from Corollary 5, employing uncompensated demand elasticities, should be
used). More generally, the same formulas could be applied under labor supply misoptimization in
the presence of income effects, with the exception that ĝ(z)—the welfare impact of giving z-earners
one more unit of post-tax income—must be modified to incorporate the corrective benefit (or cost)
from any change in labor supply behavior from this income shock, in addition to the usual fiscal
externalities.

6

Numerical application: A tax on sugar-sweetened beverages

We now turn to the quantitative implications of our theoretical results in the context of a prominent
current policy debate: a tax on soda and other sugar-sweetened beverages (SSBs). As we will discuss
below, consumption of SSBs declines across the income distribution and there is a substantial body of
research in the public health literature documenting the large health costs associated with SSBs (and
sugar consumption generally). Although SSB taxes have thus far been levied only at the city-level,
here we simulate the welfare impacts of a hypothetical federal SSB tax, analogous to the federal
cigarette tax that is currently in place in the US.
Because little is known about consumer biases in SSB consumption—and because there is no
consensus on what the elasticity of SSB consumption is or on how much of the cross-sectional variation
in consumption is due to preference heterogeneity versus income effects—our simulations embrace
24

this uncertainty and calculate the shape of the optimal tax as a function of these key parameters.
This allows us to quantify the key comparative statics from our theory—e.g., the central role of the
elasticity and preference heterogeneity—and underscores the importance of empirical measurement
of these statistics.

6.1

Empirical model

We employ the following functional forms for decision and experienced utility, extending the simple
examples in Section 3:

U (c, s, z; θ) =c + v(s, c, θ) − Ψ

z
wθ




V (c, s, z; θ) =c + v(s, c, θ) − γ̃s − Ψ

z
wθ



Consumption of SSBs (in ounces) is denoted s, and for simplicity we drop the subscript on
numeraire consumption. Bias γ̃ denotes the unanticipated internality cost of from each ounce of SSB
consumption. Disutility of labor effort is given by
Ψ

z
w

1
=
1 + 1/



z
wθ

1+1/
,

and subutility of SSB consumption is given by

v(s, c, θ) = a(c, θ)

s1−k
1−k


.

This functional form flexibly allows for heterogeneous levels of SSB consumption that can be
driven by either pure preference heterogeneity (in which case a varies only with θ), pure income
effects (in which case a varies only with c), or by some combination of the two. The parameter k
controls the elasticity of demand for soda, which is 1/k in the case of pure preference heterogeneity.28
To parameterize the relative influence of preference heterogeneity and income effects on soda consumption, we assume a(c, θ) is the product of two univariate functions ac (c) and aθ (θ)—one varying
solely with consumption, the other solely with type—with the parameter ϕ governing the weight on
income effects:
a(c, θ) = ac (c)ϕ aθ (θ)(1−ϕ)
Thus ϕ = 0 and ϕ = 1 correspond to the special cases where all SSB variation is driven by either
preference heterogeneity or income effects, respectively. Intermediate cases with ϕ ∈ (0, 1) attribute
a portion of SSB variation to each channel. We also consider ϕ < 0, which corresponds to positive
income effects, so that SSBs are a normal good; in this case, the taste for SSBs must decline sufficiently steeply across incomes to more than compensate for the positive income effects. To relate
28

One can allow the elasticity to vary across the income distribution by allowing k to vary with c and θ. We omit
that possibility here for simplicity.

25

the structural parameter ϕ to the more economically interpretable parameters used in Section 4,
we define the aggregate statistic Φ to represent the average amount of cross-sectional SSB variation
which is locally driven by income effects:


 Z 

ψ(z)
ψ(z)
Φ=E 0
=
dH(z),
c2 (z)
c02 (z)
so that Φ = 0 and Φ = 1 correspond ϕ = 0 and ϕ = 1, respectively.
For the purposes of crisp exposition of the comparative statics, we assume that the pareto weights
α(θ) are not endogenous to the tax system itself, and are given by α(θ) = (cU S (θ))−1 , where cU S
represents total consumption (aggregating numeraire and soda consumption) under the US status quo
in the calibration. Appendix F.2 explores the sensitivity of our results to the strength of redistributive
preference. We derive analytic expressions for elasticities and income effects using the specification
above in Appendix E.

6.2

Calibration and data

The income distribution is drawn from CPS, equally weighting the 2001–2010 March survey waves,
restricted to households with positive total income and two children. We assume an elasticity of
taxable income of 0.33, the preferred value from Chetty (2012).29 Following Saez (2001) and Saez
(2002b), we calibrate the skill distribution so that it generates the observed income distribution in the
presence of the status quo tax code, which we approximate for simplicity using a linear tax function
with a marginal tax rate of 40% and a lump sum grant of $6000. Results are not sensitive to these
values.
We calibrate a(c, θ) to match the pattern of soda consumption across the income distribution. Figure 1 plots the average number of non-diet soda drinks and other sugar sweetened beverages—juices
with added sugar, energy, and sports drinks—consumed per day across the income distribution according to the 2009–2010 National Health and Nutrition Examination Survey.30 Data is reported
separately for soda and other SSBs. The horizontal axis reports the income quantile (in our income
distribution from CPS) which corresponds to the central value of each income bin in the survey. To
generate a smooth and continuous schedule of consumption across the income distribution, we regress
soda and other SSB consumption on those income quantiles. The best fit lines are displayed in Figure 1, and we use the sum of these best fit lines as our calibration of total SSB consumption across
incomes.31 We assume 8 ounces of soda per drink, and we follow Long et al. (2015) in assuming an
29

Specifically, we set  = 0.33;  is the compensated elasticity of taxable income at points where the income tax is
linear; it diverges if the income tax is very curved, see Appendix A, but in practice the difference is extremely small in
our simulations.
30
The question wording for the first category was: “During the past month, how often did you drink regular soda
or pop that contains sugar? Do not include diet soda.” The wording for the second category was: “During the past
month, how often did drink sweetened fruit drinks, sports or energy drinks, such as Koolaid, lemonade, HiC, cranberry
drink, Gatorade, Red Bull or Vitamin Water? Include fruit juices you made at home and added sugar to. Do not
include diet drinks or artificially sweetened drinks.”
31
In our baseline specification, we exclude the data point corresponding to the lowest income bracket in the National
Health and Nutrition Examination Survey. That point is an outlier, reporting a lower level of SSB consumption than

26

average price of $0.06 per ounce of SSB.
We present results for a wide range of different price elasticities of demand for SSBs. A growing
literature in public health and economics attempts to measure this elasticity, but estimates so far have
been wide-ranging and inconclusive.32 Due to a lack of credible exogenous variation, the estimates
generally rely on cross-sectional variation. The estimates range from a low of 0.15 (Zheng and Kaiser,
2008) to a high of 2.25 (Dharmasena and Capps, 2011).33 We present our results for five elasticity
values spanning this range: 0.15, 0.3, 0.6, 1.2 , and 2.4.
We also present our results for a range of different levels bias, ranging from 0 to 8, measured
in cents per ounce of SSB consumption.34 To compute the level of bias, two statistics are needed:
the marginal health costs of drinking soda, and the extent to which these health costs are underappreciated. Long et al. (2015) estimate the impact of SSB consumption on quality-adjusted life
years (QALY) by tracing its impact on the likelihood of suffering a stroke, ischemic heart disease,
hypertensive heart disease, diabetes mellitus, osteoarthritis, postmenopausal breast cancer, colon
cancer, endometrial cancer, and kidney cancer. Long et al. (2015) estimate that a permanent 20%
reduction in SSB consumption generates an average increase of 0.00278 QALYs per person in the first
ten years. A “back of the envelope” calculation suggests this equates to a total increase of 0.0021
QALYs per person from a one-year SSB reduction of 20%.35 This translates to $105 per person using
the commonly used conservative estimate of $50,000 for the value of a QALY (Hirth et al., 2000), or
to $210 per person under the less conservative estimate of $100,000 (Hirth et al., 2000). These values
correspond to marginal health costs of either $0.10 or $0.20 per ounce of SSB.36
To our knowledge, there is no empirical work directly measuring bias in SSB consumption, but to
get a sense of how this may translate to γ̃, note for a present bias parameter β, we have bias equal
to γ̃ = (1 − β) ∗ (marginal health costs). Thus values of β = 0.7 or β = 0.8 lead to γ̃ = 3 cents/oz
or γ̃ = 2 cents/oz for conservative valuations of a QALY, or to values of γ̃ = 6 cents/oz or γ̃ = 4
cents/oz for less conservative valuations of a QALY.
at slightly higher incomes, and we are concerned that it reflects misreporting by survey respondents who do not wish
to reveal their incomes. We report results which include the lowest income point in Appendix F.1, and which show
that the magnitudes of optimal taxes are not sensitive to this assumption.
32
While significant variation in excise taxes enables precise estimates of elasticities for cigarettes and alcohol, such
variation does not yet exist for sugary drinks. Excise taxes for SSBs currently exist in only a few cities, and many have
not yet come into effect.
33
See Andreyeva et al. (2010) for a review of the literature.
34
Specifically, since the structural parameter γ̃ is slightly different from the money-metric bias γ(θ) in the presence
of income effects, we select the structural γ̃ which gives rise to the reported money-metric bias.
35
The simulated experiment in Long et al. (2015) is a 20% permanent reduction of SSB consumption, whereas we
are interested in the QALY cost of each SSB consumed. To reach this, we first compute the approximate total QALYs
gained from reducing SSB consumption for a single year. If the 10-year total of 0.00278 QALYs were composed of 10
years of exposure to the effects of a 20% reduction during year 1, 9 years of exposure from the reduction during year
2, etc., then the first year’s reduction would account for 10/55 = 0.18 of the 10 year total, or 0.00051 QALYs. This
accounts only for the QALY difference in the first 10 years. If the per-year effect were the same in the ensuing years
(a conservative assumption, given that health costs typically compound later in life), then this ten-year effect should
be multiplied by four, given a median US age of 38 and life expectancy of 78. This yields a total approximate effect of
0.0021 QALYs for a one-year 20% SSB reduction.
36
Long et al.’s (2015) estimates imply that on average, people consume 5475 oz of SSBs per year which implies that
a 20% reduction would reduce consumption by 1095 oz.

27

6.3

Results

Figure 2 plots the optimal SSB tax as a function of the degree of bias γ̃ for several specifications.
We first plot the optimal tax for a corrective tax with no redistributive motives (the “Pigouvian
benchmark”), which lies on the 45-degree, exactly offsetting the negative internality of SSBs—this
case is given by the dotted black line. The blue dashed line plots the optimal SSB tax when Φ = 1;
that is, when all SSB consumption variation is due to income effects. By the logic in Section 4.2, only
the corrective force of the SSB tax is relevant in this case, since any regressivity costs can be offset
by a more progressive income tax. Thus the optimal tax is larger than the Pigouvian benchmark in
this case, illustrating how redistributive concerns magnify the optimal tax in the case of pure income
effects.
We also plot the optimal tax across five elasticities of demand in the case where all variation is due
to preference heterogeneity, Φ = 0.37 For low elasticity values, the optimal tax is substantially lower
than in the case of pure income effects, since the change in behavior, and thus the corrective benefits,
will be small. For a demand elasticity of 0.15, for example, regressivity costs reduce the optimal SSB
tax substantially—to less than half of the optimal Pigouvian corrective tax. Under higher elasticity
values, however, corrective benefits become relatively large compared to the regressivity costs. At an
elasticity of 2.4, for example, regressivity costs are sufficiently small that the optimal SSB tax is higher
than the Pigouvian benchmark, and is almost as high as the tax under pure income effects.38 This
highlights the importance of assessing both the source of SSB variation (income effects vs. preference
heterogeneity) and the elasticity of demand when determining the optimal tax.39
Figure 2 also highlights the theoretical insight that the sensitivity of the tax to the bias is increasing in the elasticity when there are regressivity costs. As the elasticity decreases, the curve plotting
the optimal tax against the bias not only shifts downward, but also becomes flatter.
Figure 3 explores the role of income effects vs. preference heterogeneity in greater detail, by
plotting the optimal tax across Φ. The dotted line represents the Pigouvian benchmark without
redistributive motives, while the solid lines plot the optimal SSB tax in the presence of redistributive
concerns for a range of demand elasticities. The solid lines all converge at Φ = 1 (pure income effects)
to a value above the Pigouvian benchmark, but fan out due to the presence of regressivity costs when
Φ < 1. If SSBs are a normal good (Φ < 0) then the regressivity costs are even larger than in the case
of pure preference heterogeneity, and the optimal tax is reduced further still. The importance of the
regressivity costs is modest at high demand elasticities, but becomes very large at low values.
Figure 3 also illustrates a helpful insight for computing a simple, yet accurate, approximation of
the optimal SSB tax. As is evident from the figure, the optimal SSB tax varies nearly linearly with Φ.
As a result, one can obtain an accurate approximation of the optimal tax at values other than Φ = 0
37

Note that the demand elasticity is not relevant for the optimal tax in the previous case of pure income effects.
It is also helpful to note that for elasticities greater than one, a higher tax actually raises numeraire consumption,
since consumers reduce their soda spending by more than enough to offset the higher tax. This implication echoes the
point in (Gruber and Kőszegi, 2004) that a tax increase on harmful addictive goods can have negative incidence on
highly elastic consumers.
39
Appendix F.2 reproduces Figure 2 under stronger and weaker inequality aversion, which magnify and dampen the
regressivity costs of the tax, respectively.
38

28

or Φ = 1 by computing the “corrective benefit” and “regressivity costs” terms, and adding them, with
weights equal to 1 and 1 − Φ, respectively. This approximation greatly simplifies the computation
of the optimal tax for two reasons. First, simulations with pure income effects and pure preference
heterogeneity are much simpler than those for intermediate cases, as is apparent from the analytic
derivations of elasticities in Appendix E. Second, the simplifying technique discussed in Corollary 1
of using the weights g rather than ĝ (which include income effects) is exactly correct for both Φ = 0
(since income effects are nonexistant) and Φ = 1 (since regressivity costs are zero). We confirm
this insight numerically by reproducing Figure 3 in Appendix F.3 employing this simplification. The
approximated optimal tax never differs from the true optimum by more than 0.01 cents per ounce.
Figure 4 considers the case in which all SSB variation is due to income effects, but the SSB tax
is not salient at the time labor supply is chosen. Section 5.1 derived a striking theoretical result in
this context: the expression for the optimal commodity tax in this case is remarkably similar to the
case of pure preference heterogeneity (i.e., with full weight given to regressivity costs). We explore
this insight numerically in Figure 4, which plots the optimal commodity tax across various degrees of
SSB tax salience when labor supply choices are made.40 The horizontal axis ranges from 0 (complete
non-salience) to 1 (fully salient SSB tax). Figures 4 shows that the (non) salience of SSB taxes is a
force very similar to role of preference heterogeneity. When SSB taxes are non-salient, the optimal
tax is considerably reduced, particularly at low elasticities of demand.41
Figure 5 further explores the implications of income effects vs. preference heterogeneity by displaying the effect of the optimal SSB tax on the overall progressivity of the tax system. For this
exercise we restrict to γ̃ = 4 and elasticity  = 0.6. Results for alternative elasticities are displayed
in Appendix F.4. We compute the optimal SSB tax, as well as the difference between the optimal
income tax and the income tax that would be optimal if the commodity tax was constrained to t = 0.
Panel (a) displays the difference in taxes paid (income taxes, SSB taxes, and combined taxes) under
the full optimum relative to the constrained optimum, when SSB consumption is driven by income
effects. The substantial positive SSB tax results in more SSB taxes paid at every level of income,
particularly at the bottom of the income distribution where SSB consumption is concentrated. At
the same time, the income tax becomes more progressive, largely offsetting the regressivity of the
SSB tax, so that the total difference in taxes paid is mostly flat.42
In contrast, panel (b) shows that when SSB consumption differences are driven by preference
heterogeneity, the income tax cannot offset the optimal SSB tax’s regressivity. The revenue is recycled
lump-sum and the total tax regime becomes more regressive. This shows that the smaller SSB tax
which obtains under pure preference heterogeneity (relative to pure income effects) in Figures 2 and
3 should not be interpreted to imply a less regressive tax system—on the contrary, the tax is smaller
precisely because it generates regressivity costs that cannot be efficiently offset.
40

In all cases we assume the SSB tax is fully salient when choosing SSB consumption.
This result also emphasizes the nuanced role of salience in determining optimal commodity taxes more generally—unlike the context of Chetty et al. (2007), where non-salience tends to dampen efficiency costs and thus magnify
the optimal commodity tax, here nonsalience tends to reduce the optimal tax due to regressivity costs.
42
The slight change in total taxes paid is due to the change in the income density when soda taxes change, as the
labor leisure choice is slightly affected by the soda tax.
41

29

Finally, we explore the theoretical insight that the corrective component of the optimal tax varies
with σ, which quantifies the covariation of marginal social welfare weight with the level of SSB
consumption, the elasticity of demand, and bias. Figure 6 plots the optimal SSB tax as a function of
average bias γ̄, when bias declines with income. Specifically, bias is assumed to decline linearly across
income percentiles, either from 2γ̄ to 0 or from 1.5γ̄ to 0.5γ̄. For simplicity, we restrict consideration
to the midrange elasticity value of 0.6. The quantitative effect of this correlated heterogeneity is
striking. Even the more modest decline from 1.5γ̄ to 0.5γ̄ is sufficient to reverse the directional
implication of redistributive concerns in the pure preference heterogeneity case: with declining bias,
the optimal SSB tax becomes slightly larger than the Pigouvian benchmark at high γ̄. This result
emphasizes the importance of empirically assessing not just the magnitude of consumption biases,
but also how they covary with income.

6.4

Impact on social welfare

We conclude our simulations by quantifying the welfare improvements from implementing the optimal
SSB tax, relative to the counterfactual in which the income tax is set optimally but the SSB tax is
constrained to equal zero. We compute these benefits in terms of a policymaker’s hypothetical
“willingness to pay” for the optimal SSB tax policy. These tables report the per-capita gains multiplied
by 240 million, the approximate number of US adults.43
Table 1 reports the welfare gains across the range of SSB demand elasticities explored above.
Each row reports the willingness to pay for the optimal tax under 1) pure income effects, 2) pure
preference heterogeneity, and 3) pure preference heterogeneity without regressivity costs. The last
column is computed by calculating the willingness to pay for a “nudge” policy that achieves the same
change in SSB demand as the optimal tax under pure preference heterogeneity, but without raising
any revenue from consumers.
The third column, which reports the welfare gains from the pure preference heterogeneity policy
without regressivity costs, contains values that lie between the values in columns 1 and 2. The values
are smaller than those in the first column because the optimal tax under pure preference heterogeneity
is smaller than the optimal tax under pure income effects, and thus achieves lower corrective benefits.
The difference between columns 2 and 3 quantifies the welfare costs of regressivity from the optimal
tax when that regressivity cannot be offset by income tax reforms.
Table 2 reports results similarly to Table 1, except that it measures the welfare benefit from
implementing a 1 cent per oz SSB tax, rather than the optimal tax.
Several key quantitative lessons emerge from these tables. First, the gains are substantial, considering that SSB consumption constitutes a small share of total consumption. Indeed, at high values
of bias and high elasticities, the gains are notably larger than total spending on SSBs. Relatedly,
Tables 1 and 2 also demonstrate that the welfare benefits are much larger under higher demand
elasticities—roughly an order of magnitude larger for an elasticity of 2.4 than for an elasticity of
0.15—because higher elasticities imply a larger response to the tax, and thus larger welfare gains
43
In this respect they constitute a conservative estimate, as they ignore any benefits from corrective policy for SSB
consumption among children.

30

from the corrective effect of the tax. Second, although the welfare benefit from existing one-cent-perounce SSB taxes is large, these tables show that for many plausible parameter values, welfare would
rise substantially from increasing such taxes further.

7

Conclusion

Recent research and policy reforms suggest a role for corrective taxes to correct uninternalized harms
(or benefits) from consumption of goods like sugar-sweetened beverages, cigarettes, or energy inefficient appliances. This paper addresses the common concern that such taxes may be highly regressive.
We derive conditions for the optimal tax policy in a general setting with a nonlinear income tax and
redistributive motives, and we show that distributional concerns affect the optimal tax in a nuanced
way.
Our theoretical and numerical results clarify that the optimal policy does not just depend on the
magnitude of consumer bias, but that it also depends critically on a number of other statistics: the
extent to which variation in consumption of the sin good is explained by preference heterogeneity
versus income effects, the extent to which the rich or the poor are more biased, the elasticity of
demand and how that varies across the income distribution, and the salience of commodity taxes on
the labor supply margin. Our numerical results show that the optimal SSB tax varies dramatically
with all of these statistics. Yet there is little consensus about the SSB elasticity, and even less is
known about the other key empirical parameters. For other goods such as cigarettes, alcohol, or
energy-using durables, significant uncertainty about some or all of these key parameters remains as
well. Our nuanced, but quantitatively significant theoretical insights thus underscore an enormous
need for more empirical work to help guide public policy.

References
Allcott, Hunt, “The Welfare Effects of Misperceived Product Costs: Data and Calibrations from the Automobile
Market,” American Economic Journal: Economic Policy, 2013, 5 (3), 30–66.
and Dmitry Taubinsky, “Evaluating Behaviorally-Motivated Policy: Experimental Evidence from the Lightbulb
Market,” American Economic Review, 2015, 105 (8), 2501–2538.
, Christopher Knittel, and Dmitry Taubinsky, “Tagging and Targeting of Energy Efficiency Subsidies,” American Economic Review Papers and Proceedings, 2015, May.
, Sendhil Mullainathan, and Dmitry Taubinsky, “Energy policy with externalities and internalities,” Journal
of Public Economics, 2014.
Andreyeva, Tatiana, Michael W. Long, , and Kelly D. Brownell, “The Impact of Food Prices on Consumption:
A Systematic Review of Research on the Price Elasticity of Demand for Food,” American Journal of Public Health,
2010, 100 (2), 216–222.
Atkinson, Anthony B and J.E. Stiglitz, “Design of Tax Structure - Direct Versus Indirect Taxation,” Journal of
Public Economics, 1976, 6, 55–75.
Attari, Shahzeen, Michael DeKay, Cliff Davidson, and Wandi Bruine de Bruin, “Public Perceptions of
Energy Consumption and Savings,” Proceedings of the National Academy of Sciences, 2010, 37, 16054–16059.

31

Baicker, Katherine, Sendhil Mullainathan, and Josh Schwartzstein, “Behavioral Hazard in Health Insurance,”
working paper, 2015.
Bernheim, B. Douglas, “The Good, the Bad, and the Ugly: A Unified Approach to Behavioral Welfare Economics,”
Journal of Cost Benefit Analysis, 2016, pp. 1–57.
Bernheim, B Douglas and Antonio Rangel, “Addiction and cue-triggered decision processes,” American Economic
Review, 2004, pp. 1558–1590.
and
, “Beyond revealed preference: choice-theoretic foundations for behavioral welfare economics,” The Quarterly
Journal of Economics, 2009, 124 (1), 51–104.
Blumgart, Jake, “A Soda Tax is Fundamentally Regressive. What if It’s Philadelphia’s Best Hope for Progressive
Change?,” 2016.
Bollinger, Bryan, Phillip Leslie, and Alan Sorensen, “Calorie Posting in Chain Restaurants,” American Economic
Journal: Economic Policy, 2011, 3 (1), 91–128.
Bordalo, Pedro, Nicola Gennaioli, and Andrei Shleifer, “Salience and Consumer Choice,” Journal of Political
Economy, 2013, 121, 803–843.
Chetty, Raj, “Bounds on elasticities with optimization frictions: A synthesis of micro and macro evidence on labor
supply,” Econometrica, 2012, 80 (3), 969–1018.
, “Behavioral Economics and Public Policy: A Pragmatic Perspective,” American Economic Review Papers and
Proceedings, 2015, 105 (5), 1–33.
, Adam Looney, and Kory Kroft, “Salience and Taxation: Theory and Evidence,” September 2007.
,

, and

, “Salience and Taxation: Theory and Evidence,” American Economic Review, 2009, 99 (4), 1145–1177.

Davis, Lucas and Christopher Knittel, “Are Fuel Economy Standards Regressive?,” working paper, 2016.
and Severin Borenstein, “The Distributional Effects of U.S. Clean Energy Tax Credits,” NBER Tax Policy and
the Economy, 2016, 30 (1), 191–234.
DellaVigna, Stefano, “Psychology and Economics: Evidence from the Field,” Journal of Economic Literature, 2009,
47 (2), 315–372.
Dharmasena, Senarath and Oral Capps, “Intended and unintended consequences of a proposed national tax on
sugar-sweetened beverages to combat the U.S. obesity problem.,” Health Economics, 2011, 21, 669–694.
Edwards, Jeremy, Michael Keen, and Matti Tuomala, “Income tax, commodity taxes and public good provision:
A brief guide,” FinanzArchiv, 1994, 51 (4), 83–95.
Farhi, Emmanuel and Xavier Gabaix, “Optimal Taxation with Behavioral Agents,” 2015.
Gabaix, Xavier, “A Sparsity Based Model of Bounded Rationality,” Quarterly Journal of Economics, 2014, 129,
1661–1710.
and David Laibson, “Shrouded attributes, consumer myopia, and information suppression in competitive markets,”
Quarterly Journal of Economics, 2006, 121 (2).
Gerritsen, Aart, “Optimal taxation when people do not maximize well-being,” Journal of Public Economics, forthcoming.
Goldin, Jacob and Tatiana Homonoff, “Smoke gets in your eyes: cigarette tax salience and regressivity,” American
Economic Journal: Economic Policy, 2013, 5 (1), 302–336.
Goulder, Lawrence H., “Environmental taxation and the double dividend: A reader’s guide,” International Tax and
Public Finance, 1995, 2 (2), 157–183.
and Roberton C. Williams, “The Substantial Bias from Ignoring General Equilibrium Effects in Estimating
Excess Burden, and a Practical Solution,” Journal of Political Economy, 2003, 111 (4), 898–927.

32

Gruber, Jon and Emmanuel Saez, “The elasticity of taxable income: evidence and implications,” Journal of public
Economics, 2002, 84 (1), 1–32.
Gruber, Jonathan and Botond Kőszegi, “Is Addiction “Rational”? Theory and Evidence,” The Quarterly Journal
of Economics, 2001, 116 (4), 1261–1303.
and
, “Tax incidence when individuals are time-inconsistent: the case of cigarette excise taxes,” Journal of Public
Economics, 2004, 88 (9), 1959–1987.
Handel, Benjamin R., Jonathan T. Kolstand, and Johannes Spinnewijn, “Information Frictions and Adverse
Selection: Policy Interventions in Health Insurance Markets,” working paper, 2016.
Heutel, Garth, “Optimal Policy Instruments for Externality-Producing Durable Goods under Present Bias,” Journal
of Environmental Economics and Management, 2015, 72, 54–70.
Hirth, Richard A., Michael E. Chernew, Edward Miller, Mark Fendrick, and William G. Weissert,
“Willingness to Pay for a Quality-adjusted Life Year: In Search of a Standard,” Medical Decision Making, 2000, 20,
332–342.
Huehnergarth, Nancy Fink, “Senator Sanders Is Wrong: A Soda Tax Is Progressive, Not Regressive,” 2016.
Jacobs, Bas and Robin Boadway, “Optimal Linear Commodity Taxation under Optimal Non-Linear Income Taxation,” Journal of Public Economics, 2014, 117 (1), 201–210.
and Ruud A. de Mooij, “Pigou Meets Mirrlees: On the Irrelevance of Tax Distortions for the Second-Best
Pigouvian Tax,” Journal of Environmental Economics and Management, 2015, 71, 90–108.
Jacquet, Laurence and Etienne Lehmann, “Optimal Nonlinear Income Taxation with Multidimensional Types:
The Case with Heterogeneous Behavioral Responses,” 2014.
Kaplow, Louis, “Optimal Control of Externalities in the Presence of Income Taxation,” International Economic
Review, 2012, 53 (2), 487–509.
Lavin, Timothy, “President Obama’s Unserious Tax Plans,” 2013.
Lockwood, Benjamin B, “Optimal Income Taxation with Present Bias,” 2016.
Long, Michael W., Steven L. Gortmaker, Zachary J. Ward, Stephen C. Resch, Marj L. Moodie, Gary
Sacks, Boyd A. Swinburn, Rob C. Carter, and Y. Claire Wang, “Cost Effectiveness of a Sugar-Sweetened
Beverage Excise Tax in the U.S.,” American Journal of Preventive Medicine, 2015, 49 (1), 112–123.
Mullainathan, Sendhil, Joshua Schwartzstein, and William J Congdon, “A reduced-form approach to behavioral public finance,” Annual Review of Economics, 2012, 4.
Nava, Mario, Fred Shroyen, and Maurice Marchand, “Optimal fiscal and public expenditure policy in a two-class
economy,” Journal of Public Economics, 1996, 61 (1), 119–137.
O’Donoghue, Ted and Matthew Rabin, “Optimal sin taxes,” Journal of Public Economics, 2006, 90 (10), 1825–
1849.
Saez, Emmanuel, “Using elasticities to derive optimal income tax rates,” The Review of Economic Studies, 2001, 68
(1), 205–229.
, “The desirability of commodity taxation under non-linear income taxation and heterogeneous tastes,” Journal of
Public Economics, 2002, 83 (2), 217–230.
, “Optimal income transfer programs: intensive versus extensive labor supply responses,” The Quarterly Journal of
Economics, 2002, 117 (3), 1039–1073.
, Joel Slemrod, and Seth H Giertz, “The elasticity of taxable income with respect to marginal tax rates: A
critical review,” Journal of Economic Literature, 2012, 50 (1), 3–50.
Sanders, Bernie, “A Soda Tax Would Hurt Philly’s Low-Income Families,” 2016.

33

Schofield, Heather, “The economic costs of low caloric intake: Evidence from India,” working paper, 2015.
Spinnewijn, Johannes, “Heterogeneity, Demand for Insurance and Adverse Selection,” American Economic Journal:
Economic Policy, forthcoming.
Tsvetanov, Tsvetan and Kathleen segerson, “Re-evaluating the role of energy efficiency standards: A behavioral
economics approach,” Journal of Environmental Economics and Management, 2013.
Zheng, Yugin and Harry M. Kaiser, “Advertising and U.S. Nonalcoholic Beverage Demand,” Agricultural and
Resource Economics Review, 2008, 37 (2), 147–159.

Figures
Figure 1: Sugar-sweetened beverage consumption across incomes
soda

other sweetened beverages

1.3

1.2

1.2

1.1

1.1

1

1

drinks per day

drinks per day

1.3

0.9
0.8
0.7

0.9
0.8
0.7

0.6

0.6

0.5

0.5

0.4

0.4

0.3

0.3
0

0.2

0.4

0.6

0.8

1

income percentile

0

0.2

0.4

0.6

0.8

1

income percentile

This figure plots the number of soda drinks and other sugar-sweetened beverages (SSBs) consumed
across the income distribution, according to survey data drawn from the National Health and Nutrition Examination Survey in 2009–2010. We also plot the linear best fit lines, which we use to generate
a continuous schedule of SSB consumption across incomes in our simulations. (See text for details.)

34

Figure 2: Optimal sugar-sweetened beverage tax across bias and elasticities
10
No redistributive motives
Pure income effects
Pure pref. het., elasticity = 2.4
Pure pref. het., elasticity = 1.2
Pure pref. het., elasticity = 0.6
Pure pref. het., elasticity = 0.3
Pure pref. het., elasticity = 0.15

tax (cents per ounce)

8

6

4

2

0

-2

-4
0

1

2

3

4

5

6

7

8

uninternalized harm (cents per ounce)

This figure plots the optimal sugar-sweetened beverage (SSB) tax as a function of the money-metric
uninternalized harm from $1 of SSB consumption. The 45 degree line (dotted black) represents the
optimal tax in the absence of redistributive concerns. The dashed blue line plots the optimal tax
when SSB consumption is driven by income effects, while the solid lines plot the optimal tax when
SSB consumption is driven by preference heterogeneity, across four values of the elasticity of demand
for SSBs.

35

Figure 3: Preference heterogeneity vs. income effects
=0

optimal SSB tax (cents/oz)

3

3

Elasticity = 2.4
Elasticity = 1.2
Elasticity = 0.6
Elasticity = 0.3
Elasticity = 0.15
Pigouvian

2
1

2
1

0

0

-1

-1

-2

-2
0

0.2

0.4

0.6

0.8

1

0

0.2

=4
optimal SSB tax (cents/oz)

=2

0.4

0.6

0.8

1

0.6

0.8

1

=8

8

8

6

6

4

4

2

2

0

0
0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

share from income effects ( )
share from income effects ( )
This figure plots the optimal sugar-sweetened beverage (SSB) tax against the strength of income
effects in determining consumption of sugar sweetened beverages. When Φ = 1, all differences in
SSB consumption are due to income effects (the “Atkinson Stiglitz benchmark”), implying soda is
a strongly inferior good. When Φ = 0, all differences are due to preference heterogeneity. And
when Φ < 0, SSBs are a normal good. Each panel represents a different degree magnitude of the
uninternalized harm from $1 of SSB consumption.

36

optimal SSB tax (cents/oz)

3

Figure 4: Optimal sugar-sweetened beverage tax across salience for labor supply choice
=0
=2
3

Elasticity = 2.4
Elasticity = 1.2
Elasticity = 0.6
Elasticity = 0.3
Elasticity = 0.15
Pigouvian

2
1

2
1

0

0

-1

-1

-2

-2
0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

optimal SSB tax (cents/oz)

=4

0.6

0.8

1

0.8

1

=8

8

8

6

6

4

4

2

2

0

0
0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

0.6

salience of SSB tax
salience of SSB tax
This figure plots the optimal sugar-sweetened beverage (SSB) tax when variation in SSB consumption
is driven by income effects, but the SSB tax is not salient when consumers select their labor supply.
The horizontal axis spans from 0 (completely non-salient tax) to 1 (fully salient tax).

37

Figure 5: Effect of optimal sugar-sweetened beverage tax on total taxes paid
(a) pure income effects
Income tax
SSB tax
Total taxes

Difference in taxes paid ($)

200

60
40

100

20
0

0

-20

-100

-40
-200
-60

% of per-capita SSB consumption

300

-300
0

0.2

0.4

0.6

1

Income tax
SSB tax
Total taxes

200

60
40

100

20
0

0

-20

-100

-40
-200
-60

% of per-capita SSB consumption

300

Difference in taxes paid ($)

0.8

Income percentile
(b) pure preference heterogeneity

-300
0

0.2

0.4

0.6

0.8

1

Income percentile

These figures compare the total tax burden as a function of income under the optimal soda tax
(assuming γ̃ = 1 and a sugar-sweetened beverage (SSB) demand elasticity of 0.6), relative to the case
in which the soda tax is constrained to equal zero. Net income taxes and soda taxes are displayed
for the specification in which differences in soda consumption are driven by income effects (panel a)
and preference heterogeneity (panel b).

38

Figure 6: Optimal sugar-sweetened beverage tax when bias declines across incomes
12
No redistributive motives
=1, bias declines 2 to 0
=1, bias declines 1.5 to 0.5
=1, constant bias
=0, bias declines 2 to 0
=0, bias declines 1.5 to 0.5
=0, constant bias

tax (cents per ounce)

10
8
6
4
2
0
-2
0

1

2

3

4

5

6

7

8

uninternalized harm (cents per ounce)
This figure plots the optimal tax across values of the uninternalized harm (“bias”) from consuming
sugar-sweetened beverages (SSBs), assuming that bias declines across incomes. Average bias γ̄ is
displayed on the horizontal axis, and simulations plot the optimal tax when bias declines from 2γ̄ (at
the bottom of the income distribution) to 0 (at the top) linearly interpolated, and also for a decline
from 1.5γ̄ to 0.5γ̄. This figure assumes a demand elasticity for SSBs of 0.6.

39

Tables
Table 1: Welfare gains from optimal sugar-sweetened beverage tax
SSB elasticity Pure income effects Pure pref. het.
Pref. het. without
regressivity costs
γ̃ = 2
0.15
$0.78 Bn
$0.17 Bn
—
0.3
$1.6 Bn
$0.09 Bn
$0.66 Bn
0.6
$3.0 Bn
$1.2 Bn
$2.6 Bn
1.2
$6.9 Bn
$3.9 Bn
$5.6 Bn
2.4
$11.1 Bn
$8.9 Bn
$10.2 Bn
γ̃ = 4
0.15
$2.9 Bn
$0.14 Bn
$1.1 Bn
0.3
$5.7 Bn
$2.0 Bn
$4.6 Bn
0.6
$10.6 Bn
$7.0 Bn
$10.2 Bn
1.2
$22.7 Bn
$16.3 Bn
$19.1 Bn
2.4
$34.1 Bn
$30.3 Bn
$31.9 Bn
γ̃ = 8
0.15
$9.9 Bn
$3.2 Bn
$7.6 Bn
0.3
$19.1 Bn
$11.6 Bn
$17.7 Bn
0.6
$34.3 Bn
$28.2 Bn
$34.0 Bn
1.2
$68.0 Bn
$54.7 Bn
$58.5 Bn
2.4
$92.7 Bn
$87.1 Bn
$88.4 Bn
This table reports the welfare gains from the optimal sugar-sweetened beverage (SSB) tax in the US
by quantifying a hypothetical policymaker’s willingness to pay to implement the optimal policy. This
is computed by calculating the welfare change from the economy where the SSB tax is constrained to
equal zero (but the income tax is optimal) to the economy where both the SSB tax and the income tax
are optimal—the columns 2 and 3 report the resulting change in welfare, normalized by the marginal
value of public funds. Column 4 reports willingness to pay for a “nudge” which has the same effect
on SSB consumption as the tax in Column 3, but which does not raise revenue and therefore has no
regressivity costs. (Note: WTP is not reported for γ = 2, and an elasticity of 0.15, as the optimal
tax is negative in that case, and thus there is not a welfare benefit from a pure nudge policy.)

40

Table 2: Welfare gains from a $0.01 per ounce sugar-sweetened beverage tax
SSB elasticity Pure income effects Pure pref. het.
Pref. het. without
regressivity costs
γ̃ = 2
0.15
$0.60 Bn
–$0.69 Bn
—
0.3
$1.2 Bn
–$0.06 Bn
—
0.6
$2.3 Bn
$1.2 Bn
$2.4 Bn
1.2
$5.2 Bn
$3.4 Bn
$4.5 Bn
2.4
$8.9 Bn
$7.5 Bn
$8.4 Bn
γ̃ = 4
0.15
$1.4 Bn
$0.12 Bn
$1.4 Bn
0.3
$2.8 Bn
$1.5 Bn
$2.8 Bn
0.6
$5.4 Bn
$4.3 Bn
$5.5 Bn
1.2
$11.8 Bn
$9.4 Bn
$10.5 Bn
2.4
$20.1 Bn
$18.4 Bn
$19.3 Bn
γ̃ = 8
0.15
$3.0 Bn
$1.7 Bn
$3.0 Bn
0.3
$5.9 Bn
$4.7 Bn
$6.0 Bn
0.6
$11.4 Bn
$10.5 Bn
$11.7 Bn
1.2
$24.9 Bn
$21.3 Bn
$22.4 Bn
2.4
$42.4 Bn
$40.2 Bn
$41.1 Bn
This table reports the welfare gains computed as in Table 1, except it compares the zero tax equilibrium to a one cent per ounce tax on SSBs.

41

Appendices (not for publication)
A

Income Elasticity Definitions

We define labor supply responses to include any “circularities” due to the curvature of the income
tax function, which is assumed to be differentiable. Thus, following Jacquet and Lehmann (2014),
we define a tax function T̂ which has been locally perturbed around the income level z0 by raising
the marginal tax rate by τ and reducing the marginal tax level by ν:
T̂ (z; z0 , τ, ν) = T (z) + τ (z − z0 ) − ν.
Let z ∗ (θ) denote a type θ’s choice of earnings under the status quo income tax T , and let ẑ(θ; τ, ν)
denote θ’s choice of earnings under the perturbed income tax T̂ (z; z ∗ (θ), τ, ν). Then the compensated
elasticity of taxable income is defined in terms of the response of ẑ to τ , evaluated at τ = ν = 0:
ζzc (θ) :=


∂ ẑ(θ; τ, 0)
−
∂τ


τ =0

1 − T 0 (z ∗ (θ))
z ∗ (θ)

The income tax is similarly defined in terms of the response of ẑ to a tax credit ν (this statistic will
be nonpositive if leisure is a non-inferior good):

ηz (θ) :=

∂ ẑ(θ; 0, ν)
∂ν




1 − T 0 (z ∗ (θ)) .

ν=0

These definitions are comparable to those in Saez (2001), except that they include circularities and
thus permit a representation of the optimal income tax in terms of the actual earnings density, rather
than the “virtual density” employed in that paper.

B

Proofs of Propositions in the Paper

B.1

Proof of Proposition 1, with additional derivations without assumption A

Income tax:
Following Saez (2001), we have the following effect form increasing the marginal tax rate between z ∗
and z ∗ + dz:
R∞
1. Direct effect (fiscal and welfare): z=z ∗ (1 − g(z))dH(z)
0

T
∗
c
0
∗
∗
∗
2. Compensated elasticity effect (fiscal and welfare): −ζzc z 1−T
0 h(z )−(ζz z/(1−T ))h(z )(g(z )γ̄(z )−
0

c ∗ T
∗
c ∗ g(z
2
t) dc
dz or −ζz z 1−T 0 h(z ) + ζz z

∗ )γ̄(z ∗ )−t

p+t

η(z ∗ )h(z ∗ )

(a) Note: for simplicity I am assuming here an independence between ζzc , η, and γ.

42

3. Income effect (fiscal and welfare):

R

z≥z ∗

0

T
ηz 1−T
0 h(z)−

R
ηz g(z)γ̄(z)−t
η(z)h(z)+ z≥z ∗
p+t

R

z≥z ∗

g(z)γ̄(z)−t
η(z)h(z)
p+t

(note that the second term is the income effect on c2 from the change earnings z, while the
second term is the income effect on c2 from the change in after-tax income y = z(1 − T ).)
These three terms must sum to zero, as the net welfare effect of this reform should be zero. Using
0

T
our definition of ĝ(z) = ĝ(z) = g(z) − (1 + ηz ) g(z)γ̄(z)−t
η(z) + ηz 1−T
0 , this yields
p+t

T 0 (z)
1 − T 0 (z)

=

g(z)γ̄(z) − t
1
η(z) + c
p+t
ζz zh(z)

Z

∞

(1 − ĝ(x))dH(x)
z

Commodity tax:
First, consider the total effect on welfare of a marginal increase in the commodity tax dt. The total
welfare effect, written in terms of the marginal value of public funds, can be decomposed into the
following components:
• Mechanical revenue effect: the reform mechanically raises revenue from each consumer by
dtc2 (θ), for a total of dtC2 .
• Mechanical welfare effect: the reform mechanically reduces each consumer’s net income by
dtc2 (θ). To isolate the mechanical effect, we compute the loss in welfare as if this reduction
all comes from composite consumption c1 for a welfare loss of dtc2 (θ)g(θ), and we account for
adjustments in c2 and z in the behavioral effects below. Thus the total mechanical welfare effect
R
is −dt Θ c2 (θ)g(θ)dµ(θ).
• Direct effect on c2 consumption: the reform causes each consumer to decrease their c2 conR
2 (θ)
2 (θ)
sumption by dtζ(θ) cp+t
. This generates a fiscal externality equal to dt Θ tζ(θ) cp+t
dµ(θ). It


2 (θ)
, or
also generates a behavioral welfare effect equal to α(θ) (V2 (θ) − V1 (θ)(1 + t)) dtζ(θ) cp+t
R
c2 (θ)
dt Θ g(θ)γ(θ)ζ(θ) p+t dµ(θ).
) 0
• Effect on earnings: The reform causes a change in labor supply equal
to dz(θ,t,T
T (z(θ, t, T )), 
dt
R T 0 (z(θ))  c
∂c2 (z,θ)
creating a fiscal externality through the income tax equal to Θ 1−T 0 ζz (θ)z(θ) ∂z + ηz c2 (θ) dµ(θ).

To compute

dz(θ,t,T )
,
dt

we use Lemma 1 from Saez (2002a), which carries through in this context:

the change in earnings for type θ due to the increase in the commodity tax dt is equal to the
change in earnings which would be induced by imposing a type-specific income tax reform, raising the income tax by dT (z) = dtc2 (z|θ), where c2 (z|θ) is a function of z denoting the amount of
c2 that θ would consume at each possible income level. Intuitively, an increase in the commodity
tax alters the utility that type θ would gain from selecting each possible level of earnings, in
proportion to the amount of c2 that θ would consume at each income. This alternative income
tax reform reduces the utility θ would realize at each possible income by instead altering the
income tax. The resulting adjustment in earnings can be decomposed into a compensated elasticity effect and an income effect. The former depends on the change in the marginal income

43

(z|θ)
tax rate, equal to dt dc2dz
= dtη(θ); the latter depends on the
 change in the tax level, equal
dz(θ,t,T )
to dtc2 (θ). Combining these effects, we have
η(θ) + ηz (θ)c2 (θ).
= ζzc (θ) 1−Tz(θ)
0 (z(θ))
dt

• Indirect effects on c2 consumption: The change in earnings affects consumption indirectly. This
generates both additional fiscal externalities and additional welfare effects. These total to
R c ∂c2 (z,θ) η(gγ−t)
R
η(gγ−t)
zζz ∂z
p+t dµ(θ) + ηz c2 p+t dµ(θ)
Combining these components, the total welfare effect of the tax reform dt is equal to

dW
dt



ζ c (θ)
η(θ)
+
(t − g(θ)γ(θ)) dµ(θ)
c2 (θ)(1 − g(θ)) + c2 (θ)
p+t p+t
Θ


Z
T 0 (z(θ))
∂c2 (z, θ)
c
ζz (θ)z(θ)
+ ηz c2 (θ) dµ(θ)
1 − T0
∂z
Z
ZΘ
η(gγ − t)
c ∂c2 (z, θ) η(gγ − t)
dµ(θ) + ηz c2
dµ(θ)
zζz
∂z
p+t
p+t


 c
Z 
η(θ)
ζ (θ)
+
(t − g(θ)γ(θ)) dµ(θ)
c2 (θ)(1 − g(θ)) + c2 (θ)
p+t p+t


ZΘZ
ηz c2 (θ)
∂c2 (z, θ)
+ c
dµ(θ)
(1 − ĝ(s))ds
∂z
ζz (θ)z(θ)
θ s≥z(θ)
Z 

=
−
+
=
−



If the income tax is optimal, any small perturbation to it generates no first-order change in welfare. In
particular, this statement must hold for a reform which raises the income tax at each z in proportion
to average c2 consumption at that z, i.e., for the perturbation dT (z) = dtc̄2 (z). Letting

dW
dT

denote

the total welfare effect of this marginal reform, we have

dW
dt

=
−
+
=
−


Z 
η(θ)
c̄2 (z(θ))(1 − g(θ)) − c̄2 (z(θ))
(t − g(θ)γ(θ)) dµ(θ)
1 − T 0 (z(θ))
Θ
Z

T 0 (z(θ)) c
ζz (θ)z(θ)c̄02 (z(θ)) + ηz c̄2 (θ) dµ(θ)
0
1−T
Z
ZΘ
η(gγ − t)
η(gγ − t)
c 0
zζz c̄2 (z(θ))
dµ(θ) + ηz c̄2
dµ(θ)
p+t
p+t
 c


Z 
ζ (θ)
η(θ)
+
(t − g(θ)γ(θ)) dµ(θ)
c2 (θ)(1 − g(θ)) + c2 (θ)
p+t p+t


ZΘZ
ηz c2 (θ)
0
(1 − ĝ(s))ds c̄2 (z(θ)) + c
dµ(θ)
ζz (θ)z(θ)
θ s≥z(θ)

Since the income tax is optimal by assumption, we can simplify

dW
dt

by subtracting

dW
dT

= 0. The re-

sulting expression can be simplified by writing the integral over incomes and over types conditional on
income. Then employing the assumption that g(θ) is constant conditional on income, the mechanical
effects cancel out, leaving

44

∞



c̄2 (z)ζ̄ c (z)
1
(z)
(z)
dH(z)
=
(t − g(z)γ̄(z)) +
g(z)Σηγ,c2 − tΣη,c2
p+t
1 − T 0 (z)
0




(z)
Z ∞ Z
0 (z)Σ(z)
Σ

c
T
ζ ,η
ηz ,c2 

dH(z)
(1 − ĝ(s))ds  ψ(z) − c̄02 (z) + cz  +
+
c (z)
z
ζ̄
(z)
z
ζ̄
0
s≥z
z
z
Z

dW
dt

(16)

(z ∗ )

where Σx,y = Covµ|z ∗ [ x(θ), y(θ)| z(θ) = z ∗ ] denotes the income-conditional covariance between two
variables x(θ) and y(θ) at the optimum. Under the optimal commodity tax, (16) is equal to zero. This
expression is similar to the derivation in Saez (2002a) of the effect of introducing a small commodity
tax (expression (5) in that paper) with three important differences. First, (16) depends on the bias γ,
which is not present in that paper. Second, since Saez (2002a) considers the introduction of a small
commodity tax (rather than the perturbation of a possibly non-zero tax) there is no first-order fiscal
externality from the change in c2 consumption. Since we are interested in characterizing the optimal
tax in situations where the optimal t∗ is non-zero, (16) includes that fiscal externality—it therefore
represents a necessary condition at the optimum, rather than a test of whether the optimal t is zero
as in Saez (2002a). Third, the income responses ζzc and ηz in this expression represent the full income
response, accounting for nonlinearities in T (z), which simplifies the expression.
Employing assumption A, the Σ terms are equal to zero. This is the extension of Assumption 2
in Saez (2002a). (More generally, the same formula obtains if the level of c2 consumption and the
income effect η are orthogonal to other behavioral responses conditional on income.) In this case, the
necessary condition for optimality reduces to
dW
=
dt

Z
0

∞

c̄2 (z)ζ̄ c (z)
(t − g(z)γ̄(z)) +
p+t

Z
(1 − ĝ(s))ds

c̄02 (z(θ))



− ψ(z) dH(z).

(17)

s≥z

The second term can be integrated by parts and rewritten as follows:
∞Z ∞

Z

(1 − ĝ(s))dH(s) η̄(z) −
0

c̄02 (z)



Z

∞

Z
(1 − ĝ(z))h(z)

dz =

z

0

Z

z


ψ(s)ds − ∆c̄2 (z) dz

0
∞

(1 − ĝ(z)) (φ(z) − c̄2 (z)) dH(z)

=

(18)

0

Substituting this into 17 and rearranging yields Proposition 1.

B.2

Proof of Corollary 1

We show that η/ζ is negligible under the assumptions of the corollary. The result will follows directly
from this, as Appendix C.2 shows that when ηz = 0,


p+t
g(z)γ̄(z) − t
t = γ̄(ḡ + σ) − c Cov g(z) −
η(z), φ̃(z) .
p+t
ζ̄
And when η/ζ is negligible, this reduces to

45

t = γ̄(ḡ + σ) −

h
i
p+t
Cov
g(z),
φ̃(z)
.
ζ̄ c

To derive the uncompensated elasticity, differentiate the FOC
−(p + t)U1 (y − (p + t)c2 , c2 , . . . ) + U2 (y − (p + t)c2 , c2 , . . . ) = 0,
where y denotes after-tax income, to get
−U1 + (p + t)c2 U11 − c2 U12 + D

dc2
= 0,
dt

where D is the partial derivative of the FOC with respect to c2 , the sign of which is negative since
we assume a strict second-order condition. Thus
dc2
−U1 + (p + t)c2 U11 − c2 U12
=
.
dt
−D
The income effect is similarly given by
−(p + t)U11 + U12
dc2
=
dy
−D
Thus




(p + t)U11 − U12
η = (p + t)
D


−U1 (p + t)U11 − U12
ζ = (p + t)
+
c2 D
D


−U1
= (p + t)
+η
c2 D
and so

B.3

η
(p + t)U11 − U12
= c2
.
ζc
−U1

Proof of Lemma 2

We can instead ask the following intuitive question: “When we raise the commodity tax by dt, how
much money can we give back to each person to offset the tax so as to keep the average labor supply
choices of each z-earner constant?” Call this quantity χ(z). Under Assumption A, this term satisfies
the following differential equation:
ζ̄zc zχ0 (z) + ηz χ(z) = ζ̄zc zψ(z) + ηz c̄2 (z)
(19)
h
i
(z,θ) ∗
|z (θ) = z . The right-hand side is the impact of the commodity-tax, as
where ψ(z) = E dc2dz
shown in Appendix B.1. The left-hand side follows straightforwardly. The first term is just compensated effect of increasing the marginal tax rate, while the second term is the income effect. Rearranging
46

yields
χ0 (z) +

ηz
ηz
χ(z) = ψ(z) + c c2 (z)
ζ̄zc z
ζ̄z z

The solution to this first-order differential equation is
Rz
χ(z) =

Rx

x=0 e

ηz
0
c x0 dx
ζ̄z



ψ(x) +
Rz

ηz
c (x)
ζ̄zc x 2



dx + K

ηz
0
c z dx
ζ̄z

e

.

where K is some integration constant.
Rz
Now set φ(z) = x=0 ψ(x)dx + c2 (0). Then
d
φ(x)e
dx

Rx

Rx

ηz
0
c x0 dx
ζ̄z

=e

ηz
0
c x0 dx
ζ̄z



ηz
ψ(x) + c φ(x)
ζ̄z x

and thus

χ(z) = φ(z) +

K − φ(0)
Rz

e
R x0 =z

where w(x, z) = e

x0 =x

− ζηczz dx0
z

ηz
0
c z dx
ζ̄z

Z
+

z

w(x, z)
0

ηz
(c2 (x))dx
ζ̄zc x

. And to get the initial conditions right χ(0) = φ(0), we must have

K = φ(0), so that
Z
χ(z) = φ(z) +

z

w(x, z)
0

|

ηz
(c2 (x) − φ(x))dx .
ζ̄zc x
{z
}

(20)

labor supply income effect adjustment

The intuition for the “income effect adjustment” term is that the higher the income effect, the more
the commodity tax increases labor supply through the income effect, and thus the higher φ can be.

B.4

Proof of Proposition 2

Consider now the welfare impacts of a reform that increase the commodity tax by dt and the income
tax χ(z) at each point z. Because by Lemma has the following impact on welfare, under Assumption
A:




Corrective benefit II
{
z
}|
{
revnue and welfare
Z Mechanical

}|
{
ζ̄ c (z) η(z)
z

=
−
(t − g(z)γ̄(z))(c2 (z) − χ(z)) dH(z)
(21)
 (1 − g(z))(c2 (z) − χ(z)) − c̄2 (z)(t − γ)
p
+
t
p
+
t


z
Corrective benefit I

z

dW

}|

Equation (21) follows from the following effects. The first effect is the direct revenue and welfare
effect of decreasing each individual’s income by c̄2 (z) − χ(z). The second effect corresponds to the
compensated demand response, which generates both a welfare effect and a fiscal externality from
substitution. The third effect comes from the effect that a wealth decrease of c2 (z) − χ(z) has on c2
47

consumption; again, this generates both a fiscal externality and a welfare effect.

Z
p+t
1
t = γ̄(ḡ + σ) − c χ̃(z)η(z)(t − g(z)γ̄(z)) + c E[(1 − g(z))χ̃(z)].
ζ̄
ζ̄
1
t
p+t
= γ̄(ḡ + σ) + c E [χ̃(z)η(z)g(z)γ̄(z)] − c E[χ̃(z)η(z)] + c E[(1 − g(z))χ̃(z)]
ζ̄
ζ̄
ζ̄
Thus

t = ζ̄ c − E [χ̃(z)(1 − g(z) − η(z))]



= ζ̄ c γ̄(ḡ + σ) + pE[(1 − g(z))χ̃(z)] + E [χ̃(z)η(z)g(z)γ̄(z)]
from which the result follows.

B.5
B.5.1

General Analysis of Tax Salience, Including a Proof of Proposition 3
Income tax

Agent chooses labor supply to maximize U (z − (p̂(1 − ϑ) + (p + t)ϑ)ĉ2 (z) − T (z), ĉ2 (z), z, θ), where
p̂ is some anchor for agents’ perceptions of the final post-tax price. The first order condition for
the consumer is (1 − T 0 )U1 (ĉ1 , ĉ2 , z, θ) + U3 (·) = 0. The perceived consumption bundle satisfies
−(p + ϑt)U1 (ĉ1 , ĉ2 , ...) + U2 (ĉ1 , ĉ2 , ...) = 0, while the actual consumption bundle satisfies −(p +
t)U1 (c1 , c2 , ...) + U2 (c1 , c2 , ...) = 0. The impact of changing z for this consumer is (1 − T 0 − (p +
t)c02 )V1 + c02 V2 + V3 which equals
(1 − T 0 )V1 (c1 , c2 , ...) + V3 (c1 , c2 , ...) − V1 [(U2 /U1 ) − V2 /V1 ]c02 .
This equals

V1 [1 − T 0 + U3 (c1 , c2 , ...)/U1 (c1 , c2 , ...)] − V1 [(U2 /U1 ) − V2 /V1 ]

∂c2
∂z

=V1 [U3 (c1 , c2 , ...)/U1 (c1 , c2 , ...) − U3 (ĉ1 , ĉ2 , ...)/U1 (ĉ1 , ĉ2 , ...)] − V1 [(U2 /U1 ) − V2 /V1 ]

∂c2
∂z

We define the labor supply bias induced by salience γϑ := U3 (c1 , c2 , ...)/U1 (c1 , c2 , ...)−U3 (ĉ1 , ĉ2 , ...)/U1 (ĉ1 , ĉ2 , ...).
Note that the lower is ϑ, the higher is consumption of c2 and thus U1 (if uncompensated elasticity is
positive). Thus γ(θ) > 0. Now the above equation can be rewritten as
g(z)γϑ − g(z)γ

∂c2
∂z

We derive the formula in the Theorem, and then we solve the differential equation. Following Saez
(2001), we have the following effect form increasing the marginal tax rate between z ∗ and z ∗ + dz:

48

R∞
1. Direct effect (fiscal and welfare): z=z ∗ (1 − g(z))dH(z)

h
∂c2
T0
∗
c
0
∗
∗
∗
2. Compensated elasticity effect (fiscal and welfare): −ζzc z 1−T
0 h(z )−(ζz z/(1−T ))h(z ) (g(z )γ̄(z ) − t) ∂z − γ̄
h
i
∗
∗
T0
∗
c ∗ g(z )γ̄(z )−t η(z ∗ ) + γ̄ϑ
∗
or −ζzc z ∗ 1−T
0 h(z ) + ζz z
p+t
1−T 0 h(z )
(a) Note: for simplicity I am assuming here an independence between ζzc , η, and γ.
h
i
R
R
g(z)γ̄(z)−t
γ̄ϑ
T0
3. Income effect (fiscal and welfare): z≥z ∗ ηz 1−T
η(z)
+
h(z) −
0 h(z) − z≥z ∗ ηz
0
p+t
1−T
R
g(z)γ̄(z)−t
η(z)h(z) (note that the second term is the income effect on c2 from the change
p+t
z≥z ∗
earnings z, while the third term is the income effect on c2 from the change in after-tax income
y = z(1 − T ).)
Thus

T0
g(z ∗ )γ̄(z ∗ ) − t
γ̄ϑ
1
=
η(z ∗ ) +
+
1 − T0
p+t
1 − T 0 ζzc z ∗ h(z ∗ )

where
ĝ(z) = g(z) − (1 + ηz )
B.5.2

Z
(1 − ĝ(z))h(z)
z≥z ∗

g(z)γ̄(z) − t
T 0 − γ̄ϑ
η(z) + ηz
p+t
1 − T0

Commodity tax
 c


Z 
ζ (θ)
η(θ)
c2 (θ)(1 − g(θ)) + c2 (θ)
−
(t − g(θ)γ(θ)) dµ(θ)
p+t p+t


ZΘ
T 0 (z(θ))
∂c2 (z, θ)
−
ϑ
ζzc (θ)z(θ)
+ ηz c2 (θ) dµ(θ)
0
1−T
∂z
Θ
 Z



Z
η(gγ − t)
c ∂c2 (z, θ)
η(gγ − t) + γϑ + ϑηz c2
+ γ̄ϑ
+ ϑzζz
∂z
p+t




Z
ζ c (z)
η(z)
=
c2 (1 − g(z)) + c2 (z)
+
(t − g(z)γ(z)) h(z)
p+t p+t
z
Z
Z 
∂c2 (z) ηz c2 (z)
− ϑ
+
(1 − ĝ(x))dxh(z)dz
∂z
zζzc
z

dW
=
dt

The welfare impact of an income tax reform that gives back z-earners c2 (z)dt is given by

η(θ)
c̄2 (z(θ))(1 − g(θ)) − c̄2 (z(θ))
(t − g(θ)γ(θ)) dµ(θ)
p+t
ZΘ 0

T (z(θ)) c
−
ζz (θ)z(θ)c̄02 (z(θ)) + ηz (θ)c̄2 (z(θ)) dµ(θ)
0
1−T




ZΘ
Z
γ̄ϑ
η(gγ − t)
γ̄ϑ
c 0 η(gγ − t)
+
zζz c2
+
dµ(θ) + ηz c2
+
dµ(θ)
p+t
1 − T0
p+t
1 − T0

ZΘ
η(z)
=
c2 (z)(1 − g(z)) − c̄2 (z)
(t − g(z)γ(z)) h(z)dz
p+t
Z
Z 
ηz c2 (z)
0
−
c̄2 (z) +
(1 − ĝ(x))h(x)dz
zζzc
x≥z

dW
0=
=
dT

Z 

49

(22)
(23)

Now under assumption A,

c̄2 (z)ζ̄ c (z)
(t − g(z)γ̄(z)) h(z)
p+t
Z
Z 
∂c̄2 (z)
(1 − ĝ(x))dxh(z)
c02 (z) − ϑ
+
∂z
x≥z
Z
Z
ηz c̄2 (z)
+ (1 − ϑ)
(1 − ĝ(x))dxh(z)dz
zζzc
x≥z

dW
dW
−
=
dt
dT

Z

When ηz = 0 and when ϑ is constant, we perform calculations analogous to the proof of Proposition
1 to get the modified formula

h
i
p+t
ĝ(z),
(1
−
ϑ)c
+
ϑ
φ̃(z)
Cov
2
ζ̄ c
h
i
ζ̄ c γ̄(ḡ + σ) − pCov ĝ(z), (1 − ϑ)c2 + ϑφ̃(z)
h
i
ζ̄ c + Cov ĝ(z), (1 − ϑ)c2 + ϑφ̃(z)

t = γ̄(ḡ + σ) −

=

Note that for the simple formula, we need ϑ to be constant. More generally,
when the salience param
R x=z  0
˜
(z,θ)
1
dx,
eter might differ by incomes, we can define a new term φ̃ equal to C2 x=0 c2 (x) − ϑ(x, t) ∂c2∂z
and obtain

h
i
p+t
˜
Cov
ĝ(z),
φ̃(z)
ζ̄ c
h
i
˜
ζ̄ c γ̄(ḡ + σ) − pCov ĝ(z), φ̃(z)
h
i
˜
ζ̄ c + Cov ĝ(z), φ̃(z)

t = γ̄(ḡ + σ) −

=

When ηz 6= 0, we also have to add an additional term given by n(z) =

1
C2

Rz

x=0 (1 − ϑ)

ηz c2 (x)
zζzc dx.

This

corresponds to the additional revenue that can be raised from the commodity tax through the fact
that people underestimate the effect it has on the total budget. Incorporating this term leads to the
more general formula

h
i
p+t
˜
Cov
ĝ(z),
φ̃(z)
+
n(z)
ζ̄ c
h
i
˜
ζ̄ c γ̄(ḡ + σ) − pCov ĝ(z), φ̃(z) + n(z)
h
i
˜
ζ̄ c + Cov ĝ(z), φ̃(z) + n(z)

t = γ̄(ḡ + σ) −

=

When ϑ = 0, the formula is particularly simple, as the expression in (23) drops out. Define γ̄ u and
σ u analogously to γ̄ and σ, but with respect to uncompensated demand responses. Then expression

50

(22) implies that that the optimal tax satisfies

p+t
E [(1 − g(z))c2 (z)]
ζ̄ c
ζ̄ c γ̄ u (ḡ + σ u ) + pE [(1 − g(z))c2 (z)]
.
ζ̄ c + E [(1 − g(z))c2 (z)]

t = γ̄ u (ḡ + σ u ) +
=

B.6

Many Dimensions of Consumption: Proof of Proposition 4

Analogous to our calculations for the income tax in the proof of Proposition 1, we can show that the
income tax must satisfy
T 0 (z)
1 − T 0 (z)

=

X g(z)γ̄i (z) − ti
i

p + ti

1
ηi (z) + c
ζz zh(z)

Z

∞

(1 − ĝ(x))dH(x)
z

Under assumption A, the welfare impact of increasing commodity tax ti is given by

Direct effect on consumption

dW
dti

=

z
XZ 
j

}|
{

∂c̄j (z)
c̄i (z)(1 − g(z)) +
(tj − g(z)γj ) dH(z)
∂ti

Direct effect on labor supply

z
Z
−

T 0 (z)
1 − T0

}|
{


c ∂c̄i (z)
ζz z
+ ηz c̄i dH(z)
∂z

Indirect effect on consumption through changes in z

z Z 
X

}| 
{
ηj (gγj − tj )
+
+ ηz c̄i
dH(z)
∂z
p + tj
j



XZ 
ηj c̄i
∂
hj +
(tj − g(z)γj ) dH(z)
=
c̄i (z)(1 − g(z)) +
∂ti
p + tj
j


Z Z
∂c̄i (z) ηz c̄i
−
(1 − ĝ(s))ds
+ c dH(z)
∂z
zζz
s≥z
∂c̄i (z)
ζzc z

The welfare impact of an income tax perturbation dT (z) = dtc̄i (z) is

51

dW
dT


XZ 
ηj c̄i
c̄i (z)(1 − g(z)) −
(tj − g(z)γj ) dH(z)
=
p + tj
j
Z

T 0 (z) c 0
−
ζ
zc̄
(z)
+
η
c̄
(z)
dH(z)
z
i
z
i
0
Θ 1−T
Z
X
 ηj (gγj − tj )
+
ζzc zc̄0i (z) + ηz c̄i
dH(z)
p + tj
j

XZ 
ηj c̄i
c̄i (z)(1 − g(z)) −
=
(tj − g(z)γj ) dH(z)
p + tj
j
!
XZ Z
ηz c̄i
0
(1 − ĝ(s))ds c̄j (z) + ηz c̄i dH(z)
−
j

Setting

dW
dT

s≥z

= 0 and subtracting that from

dW
dti

zζzc

dW
dt

shows that


XZ 
∂
=
hj (tj − g(z)γj ) dH(z)
c̄i (z)(1 − g(z)) +
∂ti
j


Z Z
∂c̄i (z)
0
−
(1 − ĝ(s))ds
− c̄j (z) dH(z)
∂z
s≥z

(24)
(25)

We can transform equation (25) using integration by parts as in the proof of Proposition 1, exactly
as we did in equation (18). This yields the desired result.

C

Additional theoretical results

C.1

For discussion of term with conditional covariances

As is apparent from Equation (16), this derivation of the optimal commodity tax using the perturbation approach can accommodate heterogeneity conditional on income. Although Assumption A
simplifies the form by assuming that the income-conditional covariances which appear there are equal
to zero, that restriction is not necessary for the basic approach, and here we relax it by writing the
necessary conditional for the optimal tax with flexible multidimensional heterogeneity:

h
i
p+t
t = γ̄ (ḡ + σ) − c Cov ĝ(z), φ̃(z)
ζ̄
Z


p+t ∞
1
(z)
(z)
− c
g(z)Σ
−
tΣ
ηγ,c2 /C2
η,c2 /C2 dH(z)
1 − T 0 (z)
ζ̄
0

 Z
Z 


1
p+t ∞
(z)
0
(z)
− c
(1 − ĝ(s))ds Σζ c ,η + T (z)Σηz ,c2 dH(z)
z
ζ̄
z ζ̄zc (z)C2
0
s≥z

(26)

Equation 26 resembles Equation (3) in Proposition 1, with additional terms corresponding to the

52

income conditional covariances between income effects, elasticities, and consumption concentration
(c2 (θ)/C2 ). (Note that although this expression allows for more general multidimensional heterogeneity, it still requires that the first-order approach characterizes the optimal tax system—i.e., heterogeneity must not lead to discontinuous jumping of earnings or consumption bundles in response to
small tax perturbations.) As with Proposition 1, this equation is implicit, and thus it does not represent a closed form solution for the optimal commodity tax—however it could be solved numerically
via fixed point iteration, like the simulations in Section 6. Additionally, it provides a heuristic guide
to the likely comparative static effects of the income-conditional covariance terms on the optimal tax.
(z)

For example, focusing on the final term, suppose Σηz ,c2 > 0 for all z, indicating that labor supply
income effects are smallest in magnitude (least negative) among those who consume the most c2 at
each income—then the optimal commodity tax will tend to be reduced. Intuitively, the joint reform
of a higher t and a regressivity-offsetting income tax reform confers a greater benefit on those who
consume little c2 at each income. If those individuals exhibit larger labor supply responses to such
benefits, then the negative fiscal externality (through the income tax) of this joint reform is larger,
suggesting a lower optimal income tax. Similar reasoning can be applied to the other covariance
terms.

C.2

Optimal taxes when ηz = 0 but η is not negligible

Corollary 6. Suppose that labor supply income effects are negligible ηz ≈ 0. Then
h
i
Cov
g(z),
φ̃(z)
c
ζ̄ γ̄(ḡ + σ) + Cov[φ̃(z), ηg(z)γ̄(z)]
h
i
h
i
t ≈
−p
ζ̄ c + Cov g(z) + η, φ̃(z)
ζ̄ c + Cov g(z) + η, φ̃(z)

T 0 (z)
1 − T 0 (z)

≈

g(z)γ̄(z)−t
η(z)+
p+t

1
c
ζz zh(z)

Z
z

∞

g(x)γ̄(x) − t
η(x)(1 + ηz (x))dH(x) +
p+t

Z

∞


(1 − g(x))dH(x)

z

Proof. We set ηz = 0 in equation (3), with
ĝ(z) = g(z) − (1 + ηz )

g(z)γ̄(z) − t
T0
η(z) + ηz
p+t
1 − T0

to get


p+t
g(z)γ̄(z) − t
t = γ̄(ḡ + σ) − c Cov g(z) −
η(z), φ̃(z)
p+t
ζ̄
h
i
h
i
p+t
1
= γ̄(ḡ + σ) − c Cov g(z), φ̃(z) + c Cov (g(z)γ̄(z) − t)η(z), φ̃(z)
ζ̄
ζ̄
Solving equation (27) for t yields the expression in the Corollary above.

53

(27)

C.3

Solving the differential equation for the optimal income tax

We now solve the differential equation for the optimal income tax. To that end, define Y (z) =
R ∞ ηz T 0 (x)
z − 1−T 0 (x) h(x)dx. Then the equation comes down to
Z

1
1
1
Y =
Y0−
ηz h(z)
zh(z)ζ c
zh(z)ζ c

∞

(1 − ĝ(x))h(x)dx +
z

γ̄gη − t
p+t

or
Y 0 (z) − B(z)Y (z) = B(z)A(z) + D(z)

R∞
where A(z) = z 1 − g(x) + g(z)γ̄(z)−t
η(x)(η
(x)
+
1)
h(x)dx and B(z) =
z
p+t

ηz
zζzc ,

D(z) =

g(z)γ̄(z)−t
η(z)ηz h(z).
p+t

This gives us a first order differential equation, which can be solved for Y

R∞
Y

=
=−

x=z

−
R∞

e

Rx

−B(x0 )dx0

(A(x)B(x) + D(x)) dx + K
Rz

0

0

e −B(x )dx
Rx
R ∞ R x −B(x0 )dx0
0 )dx0
−B(x
D(x)dx
A(x)B(x)dx + K
x=z e R
x=z e
Rz
−
z
0
0
0
0
e −B(x )dx
e −B(x )dx

where K is a constant of integration. But because Y (∞) = 0, we must have K = 0. Thus

Y

0

= D(z)−
−

B(z)

Rx

R∞

x=z Re

−B(x0 )dx0 D(x)dx

z

0

0

)dx
e −B(x
Rz
R∞ Rx
0
0
0 )dx0
−B(x
−A(z)B(z)e
+ B(z) x=z e −B(x )dx A(x)B(x)dx

e

Rz

−B(x0 )dx0

Now integration by parts shows that

Z

∞

Rx

e

−B(x0 )dx0

A(x)B(x)dx = −A(x)e

Rx

−B(x0 )dx0 x=∞
|x=z

x=z

= A(z)e

Rz

−B(x0 )dx0

Z

Z

∞

−

(1 − g̃(x))h(x)e

−B(x0 )dx0

dx

x=z

∞

(1 − g̃(x))h(x)e

+

Rx

Rx

−B(x0 )dx0

dx.

x=z

Thus

Y

0

= D(z)e

Rz

B(x)dx

Z

∞

+ B(z)

e

R x0 =x
x0 =z

−B(x0 )dx0

(D(x) + (1 − g̃(x))h(x)dx

x=z

and so
g(z)γ̄(z) − t
1
T0
=
η(z)+
0
1−T
p+t
zh(z)ζzc

Z
z

∞

 R 0
x =x
g(x)γ̄(x) − t
c
0
1 − g(x) −
η(x)ηz (x) e x0 =z −ηz /(zζz )dx h(x)dx.
p+t

54

This formula is the same formula as Saez (2001), except with 1) g(z) replaced by g(x)+ g(x)γ̄(x)−t
η(x)ηz (x),
p+t
and also the presence of the term

D

g(z)γ̄(z)−t
η(z).
p+t

Non-differentiable labor supply choices

We assume that types θ are unidimensional. Let Û (y, z, θ) denote a type θ’s indirect utility from
after-tax income y and before-tax income z.
We solve for χ(θ). We need for dθ > 0 and approaching 0,

lim Û (y(θ + dθ) − dtc2 (θ + dθ, z(θ + dθ)) + χ(θ + dθ), z(θ + dθ), θ + dθ) − Û (y(θ) − dtc2 (θ + dθ, z(θ)) + χ(θ), z(θ)

dθ→0

= lim Û (y(θ + dθ), z(θ + dθ), θ + dθ) − Û (y(θ), z(θ), θ + dθ)
dθ→0

We now compute χ(θ + dθ) − χ(θ). We Taylor expand to get that

(−dtc2 (θ + dθ, z(θ + dθ)) + χ(θ + dθ))Û1 (y(θ + dθ), z(θ + dθ), θ + dθ)
+(dtc2 (θ + dθ, z(θ)) − χ(θ))Û1 (y(θ), z(θ), θ + dθ)
=O((dt)2 )
and thus that

lim χ(θ + dθ) − χ(θ)

dθ→0

A(θ, θ + dθ)
= lim −χ(θ)
dθ→0
Û1 (y(θ + dθ), z(θ + dθ), θ + dθ)
"
+dt c2 (θ + dθ, z(θ + dθ)) − c2 (θ + dθ, z(θ)) + c2 (θ + dθ, z(θ))

#

A(θ, θ + dθ)
Û1 (y(θ + dθ), z(θ + dθ)), z(θ + dθ); θ + dθ)
(28)

where
A(θ, θ + dθ) = Û1 (y(θ + dθ), z(θ + dθ); θ + dθ) − Û1 (y(θ), z(θ); θ + dθ)
Note that when z is differentiable at θ, limdθ→0 A(θ, θ+dθ) = [U11 y 0 (θ) + U12 z 0 (θ)] dθ, or [(1−τ )U11 +
U12 ]z 0 (θ)dθ.
Now from the first order condition (1 − τ )U1 + U2 = 0, an exogenous change in income y on labor
earnings z is
dz
∝ (1 − τ )U11 + U12
dy
55

while the compensated response with respect to (1 − τ ) is
dz c
∝ U1.
d(1 − τ )
Now since ζzc =

dz c
d(1−τ )

lim

dθ→0

·

1−τ
z

and since ηz =

dz
dy

· (1 − τ ), we have that at all points of differentiability,

A(θ, θ + dθ)

=

Û1 (y(θ + dθ, z(θ + dθ)), z(θ + dθ); θ + dθ)

ηz (θ) 0
z (θ)dθ
z(θ)ζzc (θ)

When c1 , c2 , z are differentiable at θ, we can divide both sides by dθ and arrive at the differential
equation
χ0 (θ) + χ(θ)

ηz (θ) 0
∂c2 (z, θ) 0
ηz (θ)
z (θ) =
z (θ) +
c2 (z, θ)z 0 (θ)
z(θ)ζzc (θ)
∂z
z(θ)ζzc (θ)

(29)

We can solve the first-order ODE (29) in any region in which z(θ) is differentiable. We can then solve
the general equation (28) by setting proper initial conditions for the differential equation solutions so
as to guarantee that the pasted together differential equation solutions satisfy the general equation
at points of non-differentiability.
The solution is particularly simple when there are no labor supply income effects. In this case, it
follows that A(θ, θ + dθ) = 0, even at discontinuities, and thus
lim [χ(θ + dθ) − χ(θ)] = lim [c2 (θ + dθ, z(θ + dθ)) − c2 (θ + dθ, z(θ))]

dθ→0

dθ→0

Now for z ∈ limdθ→0 [z(θ), z(θ + |dθ|)], define
c2 (θ + |dθ|, z(θ + |dθ|)) − c2 (θ + |dθ|, z(θ))
z(θ + |dθ|) − z(θ)
Rz
Then as before, it follows that if z ∗ (θ) = z, then χ(θ) = c2 (0) + x=0 ω(z)dz. Note that in cases in
ω(z) = lim

dθ→0

which z exhibits a jump at point θ, ω(z) is simply the slope of the line connecting (z(θ), c2 (z(θ))) to
(z(θ + dθ), c2 (z(θ + dθ))).
In the general case, suppose that z(θ) is continuous on [z0 , z1 ], (z2 , z3 ], (z4 , z5 ], . . . In between the
intervals there are gaps in the earnings distribution, and there is possibly bunching at the endpoints.
Now for z ∈ [z2i , z2i+1 ], analogous computations show that χ(z) must satisfy

Z
χ(z) = c2 (z2i ) +

z

Z

ω(x)dx
x=zi
|
{z
}

z

+

w(x, z)
zi

amount of c2 variation explained by income effects

|

ηz
(c2 (x) − φ(x))dx .
ζ̄zc x
{z
}

(30)

labor supply income effect adjustment

or alternatively, in terms of types such that z(θ) is continuous except at θ1 , θ2, . . . , where z(θ) exhibits
a jump.

56

Z

θ

χ(θ) = c2 (θi ) +

Z

ω(ϑ)x0 (ϑ)dϑ

ϑ=θi

|

ϑ=θ

+
ϑ=θi

{z

|

}

ηz
w(x(ϑ), z(ϑ)) c (c2 (ϑ) − φ(ϑ))dϑ .
ζ̄ x
{zz
}

labor supply income effect adjustment

amount of c2 variation explained by income effects

(31)
Next, for z2i−1 =

z ∗ (θ)

and z2i = limdθ→

z ∗ (θ + |dθ|),

we determine χ(θi + dθ) − χ(θi ) to satisfy (28).

In particular, we have
lim χ(θ) = c2 (z(θ), θ) − [(c2 (θi ), θ) − χ(θi )]

θ→θi+

E

A(θi , θ)
Û1 (y(θ), z(θ), z(θ); θ)

.

Analytic derivations for numerical simulations

The first-order condition governing choice of soda consumption is

− (1 + t) 1 + vc0 (s, c, θ) + vs0 (s, c, θ) = 0
with
vs0 (s, c, θ) = a(c, θ)s−k
and
vc0 (s, c, θ) = a0c (c, θ)



s1−k
1−k



The expressions above are all conditional on type θ. For some of the following expressions, we also
need the partial derivative of v with respect to type:
vθ0 (s, c, θ)

=

a0θ (c, θ)



s1−k
1−k



Second-order condition (SOC) for interior solution:
00
00
00
(s, c, θ) − 2vsc
(s, c, θ)(1 + t) + vcc
(s, c, θ)(1 + t)2 < 0
vss

with
00
vss
(s, c, θ) = −a(c, θ)ks−k−1
00
vsc
(s, c, θ) = a0c (c, θ)s−k − a(c, θ)s−k log(s)

00
vcc
(s, c, θ)

=a00cc (c, θ)



s1−k
1−k

Compensated demand response of soda:
ds
dt

=
c

1 + vc0 (s, c, θ)
SOC
57



Now with the above expressions, can solve for the a(c, θ) which generate the observed pattern of soda
consumption levels and desired pattern of elasticities. As described in the text, we assume a(c, θ)
is the product of two functions, each of which is a univariate function: a(c, θ) = ac (c)aθ (θ), so that
a0c (c, θ) = a0c (c)aθ (θ), a00cc (c, θ) = a00c (c)aθ (θ), a00cθ (c, θ) = a0c (c)a0θ (θ), etc.
For pure preference heterogeneity, a is a function of θ only; for pure income effects, they are
functions of c only. For intermediate values, there’s a free degree of freedom determining how much
a and k are changing c vs. θ—that degree of freedom maps monotonically to the aggregate statistic
Φ as defined in the text.
The cross-sectional derivative of s with respect to income z is can be decomposed into an income
effect and a preference heterogeneity effect. The income effect is the change in soda consumption
which would come from giving someone 1 − T 0 (z) more of post-tax consumption, while holding their
type θ fixed:
ψ(θ) =


1 − T 0 (z)
00
00
(1 + t)vcc
(s, c, θ) − vsc
(s, c, θ)
SOC

The “type effect” is the variation in soda consumption that comes solely from the type difference
(preference heterogeneity) across earners, holding their income constant:
 ∂θ
∂s ∂θ
1
00
00
=
(1 + t)vcθ
(s, c, θ) − vsθ
(s, c, θ)
∂θ ∂z
SOC
∂z
with
00
(s, c, θ)
vcθ

=a00cθ (c, θ)



s1−k
1−k



and
00
(s, c, θ) = a0θ (c, θ)s−k
vsθ

The total cross-sectional variation in soda consumption is the sum of these two effects

ds
1
=
dz
SOC



0

1 − T (z)



(1 +

00
t)vcc
(s, c, θ)

−

00
vsc
(s, c, θ)




∂θ
00
00
+
(1 + t)vcθ
(s, c, θ) − (1 + t)vcθ
(s, c, θ)
∂z

Labor supply FOC:

1 − T 0 (z)




1 + vc0 (s, c, θ) −

Ψ0



z
wθ



wθ

Solve for w:
wθ =

z 1/ε
0
(1 − T (z)) (1 + vc0 (s, c, θ))

!

=0
ε
1+ε

And for z (note c and T 0 (z) are endogenous to z, but by updating those in term during the numerical

58



iteration, we’ll converge to the solution):
1 − T 0 (z)

z = wθ1+ε



ε
1 + vc0 (s, c, θ)

And labor supply second-order condition SOCz :
2 00

1 − T 0 (z) vcc
(s, c, θ) − 1 + vc0 (s, c, θ) T 00 (z) −

Ψ00



z
wθ
wθ2


<0

Define income tax perturbation that is relevant for computing labor responses. Let
T̂ (z; zθ , ρ, τ ) = T (z) + τ (z − zθ ) − ρ
so that τ represents a local perturbation of the marginal tax rate, and ρ represents an increase
in income, both of which preserve the tax function curvature at zθ . Then the income effect is

dz
dρ

evaluated at ρ = 0 and τ = 0. Income effect on labor supply:
ηz (θ) =
and compensated ETI:
ζzc (θ) =
Bias:
γ(θ) =

00 (s, c, θ)
(1 − T 0 (z)) vcc
SOCz

1 + vc0 (s, c, θ) 1 − T 0 (zθ )
SOCz
zθ

Us Vs
γ̃
−
=
Uc
Vc
1 + vc0 (s, c, θ)

The marginal social utility of net consumption cnet is:



dV (c, s, z, θ)
ψ(θ)
= 1 + vc0 (s, c, θ) −
(1 + t) 1 + vc0 (s, c, θ) +
0
dcnet
1 − T (z)


ψ(θ)
=1 + vc0 (s, c, θ) − γ̃
1 − T 0 (z)



ψ(θ)
1 − T 0 (z)



vs0 (s, c, θ)


− γ̃

ψ(θ)
1 − T 0 (z)

And in this specification, there is no misoptimization wedge between c and z, though that does imply
a wedge between cnet and z.
Since utility is nearly quasilinear, we introduce declining Pareto weights to generate a redistributive motive. These are denoted α(θ), and we set them so that α(θ) is declining linearly with income
percentile, equaling zero at the top. (The results are not particularly sensitive to the precise pattern
of Pareto weights, provided they are exogenous to the equilibrium.) Marginal social utility from
additional c:

g(θ)λ = α(θ) 1 + vc0 (s, c, θ)
Marginal value of a marginal dollar of income tax reduction for θ, accounting for fiscal externalities

59



and biases from misallocation:

ĝ(θ) = g(θ) + ψ(θ)


1
+ ηz (θ) (t − γ(θ)g(θ)) + ηz (θ)T 0 (z)
1 − T 0 (zθ )

Marginal value of public funds satisfies
Z
ĝ(θ)λdµ(θ)

λ=
Θ

Solving for λ:




1
0 (s, c, θ)) 1 − ψ(θ)
α(θ)
(1
+
v
+
η
(θ)
γ(θ)
dµ(θ)
0
z
c
Θ
1−T (zθ )



λ=
R 
1 − Θ ψ(θ) 1−T10 (zθ ) + ηz (θ) t + ηz (θ)T 0 (zθ ) dµ(θ)
R

Optimal income tax:
Z

∞


(1 − ĝ(θ(y)))dF (y) + f (z)

z
0

T (z) = −
f (z)

F
F.1

1


dzθ
dτ c

Z


dzθ
dτ




T 0 (z) + ψ(θ) (t − g(θ)γ(θ)) = 0

c

∞

(1 − ĝ(θ(y)))dF (y) − ψ(θ) (t − g(θ)γ(θ))
z

Alternative numerical results and robustness checks
Alternative calibration of sweetened beverage consumption

The baseline calibration of sugar-sweetened beverage consumption across incomes excludes the data
points for the lowest income bracket from the National Health and Nutrition Examination Survey,
which are outliers relative to neighboring income brackets, raising the possibility that they reflect
income misreporting. Figures 7 and 8 check the robustness of this restriction. Figure 7 plots the
alternative schedule of SSB consumption across incomes which results when the lowest income bracket
is included. Figure 8 reproduces Figure 2 from the text under this alternative calibration assumption,
and shows that the optimal tax magnitudes are not sensitive to this calibration decision.

60

Figure 7: Alternative calibration of SSB consumption across incomes.
soda

1.3

Data points
Best fit excluding bottom income point
Best fit including all points

1.2
1.1

Data points
Best fit excluding bottom income point
Best fit including all points

1.2
1.1
1

drinks per day

1

drinks per day

other sweetened beverages

1.3

0.9
0.8
0.7

0.9
0.8
0.7

0.6

0.6

0.5

0.5

0.4

0.4

0.3

0.3
0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

income percentile

0.6

0.8

1

income percentile

This figure plots the number of soda drinks and other sugar-sweetened beverages (SSBs) consumed
across the income distribution, according to survey data drawn from the National Health and Nutrition Examination Survey in 2009–2010. Whereas the baseline calibration in the text excludes the
lowest income bracket, which reports a lower level of SSB consumption than neighboring brackets,
the dotted line in this specification shows the effect of including that point in the calibration.

Figure 8: Optimal sugar-sweetened beverage tax across bias and elasticities
10
No redistributive motives
Pure income effects
Pure pref. het., elasticity = 2.4
Pure pref. het., elasticity = 1.2
Pure pref. het., elasticity = 0.6
Pure pref. het., elasticity = 0.3
Pure pref. het., elasticity = 0.15

tax (cents per ounce)

8

6

4

2

0

-2
0

1

2

3

4

5

6

7

8

uninternalized harm (cents per ounce)

This figure reproduces Figure 2 from the text, using the SSB consumption calibration which includes
the data point for the lowest income bracket (the dotted line in Figure 7).

61

F.2

Alternative redistributive preferences

In the baseline simulations, we use Pareto weights equal to α(θ) = 1/cU S (θ), where cU S (θ) is θ’s net
income under the US status quo income tax (approximated by a flat tax for simplicity). This generates
weights comparable to those which arise under optimal tax models with logarithmic utility from
consumption. To explore the effect of the strength of redistributive preferences, in Figure 9 we plot
optimal soda taxes when Pareto weights are instead given by α(θ) = cU S (θ)−0.25 and α(θ) = cU S (θ)−4 ,
representing substantially weaker and stronger redistributive preferences, respectively.

F.3

Optimal tax computed using the simplification in Corollary 1

Figure 10 reproduces Figure 3 from the body of the paper, but using the simplification in Corollary
1, wherein the optimal tax is computed replacing the weights ĝ with g, which exclude income effects.
Comparing the figures verifies that the approximation is quite accurate.

F.4

Tax differences under alternative elasticity values

Figure 11 displays the equivalent of Figure 5 from the body of the paper, which shows the change
in total SSB taxes and income taxes paid across the income distribution (relative to the constrained
optimum without an SSB tax), here shown for higher and lower values of the SSB demand elasticities.

Appendix Figures
Figure 9: Optimal SSB tax for alternative redistributive preferences
9

10
No redistributive motives
Pure income effects
Pure pref. het., elasticity = 2.4
Pure pref. het., elasticity = 1.2
Pure pref. het., elasticity = 0.6
Pure pref. het., elasticity = 0.3
Pure pref. het., elasticity = 0.15

8

8

6

tax (cents per ounce)

tax (cents per ounce)

7

No redistributive motives
Pure income effects
Pure pref. het., elasticity = 2.4
Pure pref. het., elasticity = 1.2
Pure pref. het., elasticity = 0.6
Pure pref. het., elasticity = 0.3
Pure pref. het., elasticity = 0.15

5
4
3
2

6

4

2

0

1
-2

0
-1

-4

0

1

2

3

4

5

6

7

8

0

uninternalized harm (cents per ounce)

1

2

3

4

5

6

7

8

uninternalized harm (cents per ounce)

This figure plots optimal soda taxes for alternative redistributive preferences, with declining Pareto
weights equal to α = c−0.25
and α = c−4
US
US.

62

Figure 10: Optimal SSB tax computed using simplifying approximation
=0

optimal SSB tax (cents/oz)

3

Elasticity = 2.4
Elasticity = 1.2
Elasticity = 0.6
Elasticity = 0.3
Elasticity = 0.15
Pigouvian

2
1

=2

3
2
1

0

0

-1

-1

-2

-2
0

0.2

0.4

0.6

0.8

1

0

0.2

optimal SSB tax (cents/oz)

=4

0.4

0.6

0.8

1

0.6

0.8

1

=8

8

8

6

6

4

4

2

2

0

0
0

0.2

0.4

0.6

0.8

1

0

share from income effects ( )

0.2

0.4

share from income effects ( )

This figure reproduces Figure 3 from the paper, but with a simplification that replaces the weights ĝ
with g.

63

Figure 11: Tax differences under alternative demand elasticities
Income tax
SSB tax
Total taxes

= 2.4
Income tax
SSB tax
Total taxes

80
60

200

40

100

20

0

0
-20

-100

-40

-200

-60
-300
-80

100

30
20

50

10
0

0

-10

-50

-20
-100
-30

-400

-150
0.4

0.6

Income percentile
(b) pure preference heterogeneity,

400

0.8
c

1

= 0.15

0.2

0.4

0.6

Income percentile
(b) pure preference heterogeneity,

150

Income tax
SSB tax
Total taxes

300

0

60

200
40
100

20

0

0
-20

-100

-40
-200
-60
-300

-80

0.8
c

1

= 2.4

Income tax
SSB tax
Total taxes

80
100

Difference in taxes paid ($)

0.2

% of per-capita SSB consumption

0

Difference in taxes paid ($)

c

30
20

50

10
0

0

-10

-50

-20
-100
-30

-400

% of per-capita SSB consumption

Difference in taxes paid ($)

300

(a) pure income effects,

150

% of per-capita SSB consumption

= 0.15

Difference in taxes paid ($)

c

% of per-capita SSB consumption

(a) pure income effects,

400

-150
0

0.2

0.4

0.6

0.8

1

0

Income percentile

0.2

0.4

0.6

0.8

1

Income percentile

This figure reproduces Figure 5 from the text, but with alternative demand elasticities for sugarsweetend beverages.

64

