NBER WORKING PAPER SERIES

MACROECONOMICS AND VOLATILITY:
DATA, MODELS, AND ESTIMATION
Jesús Fernández-Villaverde
Juan Rubio-Ramírez
Working Paper 16618
http://www.nber.org/papers/w16618

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2010

We thank Pablo Guerrón, a coauthor in some of the research discussed here, for useful comments,
and Béla Személy for invaluable research assistance. Beyond the usual disclaimer, we must note that
any views expressed herein are those of the authors and not necessarily those of the Federal Reserve
Bank of Atlanta, the Federal Reserve System, or the National Bureau of Economic Research. Finally,
we also thank the NSF for financial support.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Jesús Fernández-Villaverde and Juan Rubio-Ramírez. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Macroeconomics and Volatility: Data, Models, and Estimation
Jesús Fernández-Villaverde and Juan Rubio-Ramírez
NBER Working Paper No. 16618
December 2010
JEL No. C01,C22,E10
ABSTRACT
One basic feature of aggregate data is the presence of time-varying variance in real and nominal variables.
Periods of high volatility are followed by periods of low volatility. For instance, the turbulent 1970s
were followed by the much more tranquil times of the great moderation from 1984 to 2007. Modeling
these movements in volatility is important to understand the source of aggregate fluctuations, the evolution
of the economy, and for policy analysis. In this chapter, we first review the different mechanisms proposed
in the literature to generate changes in volatility similar to the ones observed in the data. Second, we
document the quantitative importance of time-varying volatility in aggregate time series. Third, we
present a prototype business cycle model with time-varying volatility and explain how it can be computed
and how it can be taken to the data using likelihood-based methods and non-linear filtering theory.
Fourth, we present two "real life" applications. We conclude by summarizing what we know and what
we do not know about volatility in macroeconomics and by pointing out some directions for future
research.

Jesús Fernández-Villaverde
University of Pennsylvania
160 McNeil Building
3718 Locust Walk
Philadelphia, PA 19104
and NBER
jesusfv@econ.upenn.edu
Juan Rubio-Ramírez
Duke University
P.O. Box 90097
Durham, NC 27708
juan.rubio-ramirez@duke.edu

1. Introduction
Macroeconomics is concerned with the dynamic e¤ects of shocks. For instance, the real business
cycle research program originated with an investigation of the consequences of changes in productivity (Kydland and Prescott, 1982). Later, the new generation of monetary models of the
late 1990s and early 2000s was particularly focused on shocks to monetary policy (Christiano,
Eichenbaum, and Evans, 2005). In open macroeconomics, considerable attention has been devoted to shocks to the interest rate (Mendoza, 1991) or to the terms of trade (Mendoza, 1995).
Similar examples can be cited from dozens of other sub…elds of macroeconomics, from asset pricing to macro public …nance: researchers postulate an exogenous stochastic process and explore
the consequences for prices and quantities of innovations to it.
Traditionally, one key feature of these stochastic processes was the assumption of homoscedasticity. More recently, however, economists have started to relax this assumption. In particular,
they have started considering shocks to the variance of the innovations of the processes. A …rst
motivation for this new research comes from the realization that time series have a strong timevarying variance component. The most famous of those episodes is the great moderation of
aggregate ‡uctuations in the U.S. between 1984 and 2007, when real aggregate volatility fell by
around one third and nominal volatility by more than half. A natural mechanism to generate
these changes is to have shocks that also have themselves a time-varying volatility and to trace
the e¤ects of changes in volatility on aggregate dynamics.
A second motivation, particularly relevant since the summer of 2007, is that changes to the
volatility of shocks can capture the spreading out of distributions of future events, a phenomenon
that many observers have emphasized is at the core of the current crisis. For example, an increase
in the variance of future paths of …scal policy (a plausible description of the situation of many
European countries) can be incorporated in a parsimonious way by a rise in the variance of the
innovations to a …scal policy rule in an otherwise standard dynamic stochastic general equilibrium
(DSGE) model. Similarly, the higher volatility of sovereign debt markets can be included in our
models as a higher variance in the innovations to a country-speci…c spread.
A third, and …nal motivation, is that, even when the main object of interest is the conditional
mean, economists should care about time-varying volatility. As illustrated in two examples by
Hamilton (2008), inference about means can be unduly in‡uenced by high variance episodes and
standard statistical tests can become misleading. For instance, if we do not control for timevarying variance, a true null hypothesis will be asymptotically rejected with probability one.
1

Thus, ignoring changes in volatility is simply not an option in many empirical applications even
when we do not care about volatility per se.
In this paper, we want to study time-varying volatility with the help of DSGE models, the
workhorse of modern macroeconomics and the most common laboratory for policy evaluation.
How do we incorporate time-varying volatility in the models? How do we solve models with this
time-varying volatility? How do we take them to the data? What are the policy implications of
volatility?
To address these questions, the rest of this chapter is organized as follows. First, we review the
existing literature. Instead of being exhaustive, we will focus on those papers that have a closer
relation with the rest of the chapter. Second, we present data to make the case that time-varying
volatilities are an important feature of macroeconomic time series. Then, we present a prototype
real business cycle model with time-varying volatility and show how we compute it and take it to
the data using a likelihood-based approach. We move them into the summary of two “real life”
applications from our own previous work. We conclude by discussing what we know and what we
do not know about time-varying volatility and by pointing out directions for future research.

2. Review of the Literature
In one form or another, economists have talked for a long time about time-varying volatility. Just
to give an example that mixes theory, data, and policy, David Ricardo, in his defense of free
trade on corn in the House of Commons explicitly talked about the volatility of corn prices as an
important factor to consider in the design of trade policy (although he dismissed it as an argument
for protection).1 But it was perhaps Haavelmo’s 1944 work that opened the path for the modern
understanding of changes in volatility. Haavelmo taught economists to think about observed time
series as the realization of a stochastic process. Once this was accomplished, and since nothing in
the idea implied that the variance of the stochastic process had to be constant, it was natural to
start thinking about processes whose variances changed over time.
Unfortunately, for a long time, most of the procedures that economists used to incorporate
time-varying volatility were ad hoc and lacked a sound foundation in probability theory. As late as
the mid 1970s, two papers published in the Journal of Political Economy, one of the top journals
of the profession, when trying to measure the time component in the variance of in‡ation, resorted
to such simple devices as using the absolute value of the …rst di¤erence of in‡ation (Khan, 1977)
1

David Ricardo, speech of 9 May 1822. Collected works, volume V, p. 184, Ricardo (2005).

2

or a moving variance around a moving mean (Klein, 1977). And even these primitive approaches
were merely empirical and never made an explicit connection with theoretical models.
A major breakthrough came with Engle’s (1982) paper on autoregressive conditional heteroscedasticity, or ARCH. Engle postulated that a fruitful way to study the evolution of variance
over time of time series xt was to model it as an autoregressive process that is hit by the square
of the (scaled) innovation on the level of xt . The beauty of the assumption was that it combined
simplicity with its ability to deliver an estimation problem that was straightforward to solve using a scoring iterative maximum likelihood procedure and ordinary least squares. The empirical
application in Engle’s original paper was the estimation of an ARCH process for British in‡ation.
Engle found that indeed time-varying components were central to understanding the dynamics of
in‡ation.
The profession quickly embraced Engle’s contribution. Furthermore, after Bollerslev (1986)
expanded the original model and created the Generalized ARCH, or GARCH, researchers joined
an arms race to name yet another ARCH that would provide an extra degree of ‡exibility in modeling the data: Nonlinear GARCH, or NGARCH (Engle and Ng, 1993), Exponential GARCGH,
or EGARCH (Nelson, 1991), Quadratic GARCH, or QGARCH (Sentana, 1995), or Threshold
GARCH, or TGARCH (Zakoïan, 1994) are some of the most popular extensions, but Bollerslev
(2010) has recently counted 139 variations.
But it was not in macro where ARCH models came to reign, as one might have guessed from
Engle’s original application. The true boom was in …nance, where the research on volatility took
on a life of its own. The reason was simple. Financial institutions are keenly interested in the
amount of risk they load onto their books. This risk is a function of the volatility on the return of
their assets (in fact, the Basel II regulatory capital requirements depended on the Value-at-Risk
of a bank’s portfolio and, hence, on the level of variance). Similarly, the price of many assets,
such as options depends directly on their volatility. Finally, time-varying volatility is a simple
way to generate fat tails in the distribution of asset returns, a salient property of the data. The
availability of high frequency data complemented in a perfect way the previously outlined need
to describe volatility by providing economists with large samples with which to estimate and test
their models.
The situation changed with the publication of the work by Kim and Nelson (1998), McConnell
and Pérez-Quirós (2000), and Blanchard and Simon (2001). These in‡uential papers documented
that the volatility of U.S. aggregate ‡uctuations had changed over time. While Kim and Nelson
and McConnell and Pérez-Quirós highlighted a change in volatility around 1984, Blanchard and
3

Simon saw the great moderation as part of a long-run trend toward lower volatility only momentarily interrupted during the 1970s. In a famous review paper, Stock and Watson (2002) named
this phenomenon the “great moderation,” a title that became so popular that it even jumped
into the popular media (and became rather unfairly attached to economists’alleged complacency
during the real estate boom of the 2000s).
The documentation of the great moderation led to an exploration of its causes and of a need
to have models with mechanisms that generated time-varying volatility. McConnell and PérezQuirós (2000) had already pointed out the possibility of better inventory control as one possible
explanation of the great moderation. Other mechanisms put forward have included …nancial
innovation (Dynan, Elmendorf, and Sichel, 2006) and, in an well-cited study by Clarida, Galí,
and Gertler (2000), changes in monetary policy.
A few years later, and in response to the previous work, Sims and Zha (2006) estimated a
structural vector autoregression (SVAR) with Markov regime switching both in the autoregressive
coe¢ cients and in the variances of the disturbances. They found that the model that best …t the
data had changes over time only in the variances of structural disturbances and no variation in the
monetary rule or in the private sector of the model. But even when they allowed for policy regime
changes, Sims and Zha found that the estimated changes could not account for the evolution
of observed volatility. From those results, Sims and Zha concluded that models in which the
innovations to the shocks had time-varying volatilities are a key element in the toolbox of applied
macroeconomics.2
All of this research has convinced us that 1) time-varying volatility is an important feature
of the data and that 2) we need DSGE models that allow us to generate it, quantify its e¤ects,
perform welfare analysis, and design optimal policy. First attempts in this direction are FernándezVillaverde and Rubio-Ramírez (2007) and Justiniano and Primiceri (2008). These papers estimate
DSGE economies that incorporate stochastic volatility on the structural shocks and show that
such models …t the data considerably better than economies with homoscedastic structural shocks.
More recently, Christiano, Motto, and Rostagno (2009) have shown that, in a …nancial accelerator
model, shocks to the volatility of individual …rms’productivity have a signi…cant impact on the
business cycle because of their consequences for the level of leverage that …rms can take. A related
result is found by Arellano, Bai, and Kehoe (2010).
2

Sims and Zha’s conclusion is, nevertheless, not incontrovertible. Benati and Surico (2009) illustrate that it is
di¢ cult to map between changes in the autoregressive coe¢ cients or in the variance of disturbances in a regimeswitching SVARs and equivalent elements in a New Keynesian DSGE model. This would be a key motivation for
our application in section 5.

4

Another strand of the literature starts from the real-option e¤ect of risk. In a situation
where investment (in capital, durable goods or any similar item) is subject to frictions such as
irreversibilities or non-convex adjustment costs, a change in volatility may have a substantial
e¤ect on the investment decision. Think, for example, about a household’s decision to buy a new
car to substitute its old clunker. If labor market volatility increases, the household may be quite
concerned about its own job status in the next few months. By delaying the purchase of a new car,
the household loses the di¤erential utility between the services of the old and the new car times
the length of the delay. On the other hand, it avoids both the costs of purchasing an expensive
item and the risk of facing a liquidity constraint that may force the household to sell the car
(with a loss of value) or re-adjust other consumption items. This mechanism is particularly well
explored by Bloom (2009) and in Bloom, Jaimovich, and Floetotto (2008).
Guerrón-Quintana (2009) …nds that volatility shocks à la Bloom induce depreciations in the
real exchange rate in the US, particularly vis-a-vis the Canadian dollar. Fatás (2002) discusses the
e¤ects of business cycle volatility on growth. Lee, Ni, and Ratti (1995) show that the conditional
volatility of oil prices matter for the e¤ect of oil shocks on the economy. Grier and Perry (2000)
and Fountas and Karanasos (2007) relate in‡ation and output volatility with average output
growth, while Elder (2004a and 2004b) links nominal and real volatility.
Of course, the importance of these observations and models is not universally accepted (see
Bachmann, Elstner, and Sims, 2010, for a much less sanguine reading of the importance of volatility shocks), but we judge that the preponderance of the evidence is clearly on the side of timevarying volatility. To show this, we start now with a brief summary of some data that will help
us to understand better the literature we just discussed.

3. Data
In this section we illustrate the presence of time-varying volatility in two contexts that we will
revisit later in the paper: ‡uctuations in the U.S. economy and ‡uctuations in the interest rates
at which small open emerging economies borrow.
We start with the evolution of aggregate variables in the U.S. In that way we document (once
more) the great moderation, which has been the motivating fact of much of the literature on
time-varying volatility. In …gure 3.1, we plot the absolute deviations of real GDP growth with
respect to their mean. In this …gure we can see how, since 1984, the absolute deviation rarely
crosses 4 percentage points (except in a couple of brief spikes around the 1992 and 2008-2009
5

recession), while before it did it rather often. Even the great recession of 2008-2009 did not imply
a di¤erence in growth rate as big as the two Volcker recessions (although the 2008-2009 recession
was longer). Besides, we can also see fat tails in the distribution of deviations.

Figure 3.1: Real GDP Growth, Absolute Deviations from
Mean
This change in volatility also appears in nominal variables. Figure 3.2 plots the absolute
deviations of the GDP de‡ator with respect to its mean. Again, we see how the big spikes of the
1970s and early 1980s disappeared after 1984 and they did not come back even brie‡y in the last
recession.

Figure 3.2: GDP De‡ator, Absolute Deviations from Mean

6

In table 3.1, we summarize the graphical information into statistical moments for the sample
1959.Q1 to 2007.Q1 that we will use in section 5 and we add the federal funds rate as a measure
of monetary policy. These three variables, in‡ation, output growth, and the federal funds rate
are the most commonly discussed series in monetary models (for example, the “trinity”model so
dear to the New Keynesian tradition has only these three variables). We can see in table 3.1 how
the standard deviation of in‡ation falls by 60 percent after 1984.Q1, the standard deviation of
output growth by 44 percent, and the standard deviation of the federal funds rate by 39 percent.
Again, the evidence of changes in variances over time is rather incontrovertible.
Table 3.1: Changes in Volatility of U.S. Aggregate Variables
Means
In‡ation

Output

Standard Deviations
FFR

In‡ation

Growth

Output

FFR

Growth

All sample

3.8170

1.8475

6.0021

2.6181

3.5879

3.3004

Pre 1984.Q1

4.6180

1.9943

6.7179

3.2260

4.3995

3.8665

After 1984.Q1

2.9644

1.6911

5.2401

1.3113

2.4616

2.3560

Post-1984.Q1/pre-1984.Q1

0.6419

0.8480

0.7800

0.4065

0.5595

0.6093

Our second example of time-varying volatility is …gure 3.3, where we use the Emerging Markets
Bond Index+ (EMBI+) Spread reported by J.P. Morgan at a monthly frequency to plot the
country spreads of Argentina, Brazil, Ecuador and Venezuela. This index tracks secondary market
prices of actively traded emerging market bonds denominated in U.S. dollars. For comparison
purposes, we also plot the real U.S. T-bill rate as a measure of the international risk-free nominal
interest rate. We build the real T-bill rate by subtracting expected in‡ation measured as the
average U.S. CPI in‡ation in the current month and in the eleven preceding months. This is
motivated by the observation that U.S. in‡ation is well approximated by a random walk. The
results are nearly identical with more sophisticated methods to back up expected in‡ation. Both
the T-bill rate and the in‡ation series are obtained from the St. Louis Fed’s FRED database. We
use annualized rates in percentage points.
In this …gure we can see how the international risk-free real rate is low (with negative interest
rates in 2002-2006) and relatively stable over the sample. In comparison, all country spreads are
large and volatile, with times of turbulence following much calmer months. The spreads are nearly
always larger than the real T-bill rate itself and ‡uctuate, at least, an order of magnitude more.
The most prominent case is Argentina, where the 2001-2002 crisis raised the country spreads to
7

70 percentage points. In the …gure, we also see the problems of Ecuador in 1998-1999 and the
turbulence in all four countries during the virulent international turmoil of 1998.

Figure 3.3: Country Spreads and T-Bill Real Rate

Besides the data in these …gures, we could present many others, such as those in Bloom
(2009). However, we feel we have already made the case for the empirical relevance of timevarying volatility and it seems a better use of our allocated space to jump into the substantive
questions by presenting a prototype business cycle model where volatility changes over time.

4. A Prototype Business Cycle Model with Time-Varying Volatility
A simple exercise to illustrate the theoretical, computational, and empirical issues at hand when
we deal with DSGE models that incorporate changes in variances is to write down a prototype
economy and to introduce in it the minimum modi…cations required to capture time-varying
volatility in a plausible way. The perfect vehicle for such a pedagogical e¤ort is the real business
cycle model for two reasons.
First, the stochastic neoclassical growth model is the foundation of modern macroeconomics.
Even the more complicated New Keynesian models are built around the core of the neoclassical
growth model augmented with nominal and real rigidities. Thus, once we understand how to
deal with time-varying volatility in our prototype economy, it will be straightforward to extend
it to richer environments. Second, the model is so well known, its working so well understood,
8

and its computation so thoroughly explored that the role of time-varying volatility in it will be
staggeringly transparent.
Once we are done with our basic model, we will move on to analyzing two applications, one in
monetary economics and one in international macroeconomics, where changes in volatility play a
key role. While these applications are more complicated than our prototype economy, they are
explicitly designed to account for a richer set of observations and to demonstrate the usefulness
of DSGE models with time-varying volatility in “real life.”
4.1. Environment
To get into the substantive questions as soon as possible, our description of the standard features
of our prototype economy will be limited to …xing notation. There is a representative household
in the economy, whose preferences over stochastic sequences of consumption, ct ; and work, lt , are
representable by a utility function:
U = E0

1
X

t

u (ct ; lt )

(1)

t=0

where

2 (0; 1) is the discount factor and E0 is the conditional expectation operator. We leave

the concrete parameterization of the utility function open since we will consider below the e¤ects
of di¤erent period utility kernels.
The household’s budget constraint is given by:
ct + it +

bt+1
= wt lt + rt kt + bt
Rt

where it is investment, Rt is the risk-free gross interest rate, bt is the holding of an uncontingent
bond that pays 1 unit of consumption good at time t + 1, wt is the wage, lt is labor, rt is the rental
rate of capital, and kt is capital. Asset markets are complete and we could have also included in the
budget constraint the whole set of Arrow securities. Since we have a representative household, this
is not necessary because the net supply of any security must be equal to zero. The uncontingent
bond is all we need to derive a pricing kernel for the economy. Capital is accumulated according
to the law of motion kt+1 = (1

)kt + it where

is the depreciation rate.

The …nal good is produced by a competitive …rm with a technology yt = ezt Akt lt1

where zt

is the productivity level whose evolution we will describe momentarily and A is a constant. Thus,
the economy must satisfy the aggregate resource constraint yt = ct + it :
9

Productivity follows an autoregressive process zt =
innovations "t

zt

1

+

t "t

with

< 1 and random

N (0; 1). We impose stationarity in the process to save on notation (otherwise

we would need to rescale the variables in the model by the level of technology), but besides the
notational burden, it would be easy to have a martingale on zt . Note, and here is where we are
introducing time-varying volatility, that the standard deviation of innovations,

t,

is indexed by

the period t. That is, the dispersion of the productivity shocks changes over time: sometimes
there are large shocks, sometimes there are smaller shocks. Our speci…cation is extremely simple
and we present it only as a default process to start the conversation.
The …rst question that we need to handle at this point is how to model these changes in
volatility. The literature has proposed three alternatives: stochastic volatility, GARCH processes,
and Markov regime switching.
The …rst approach is stochastic volatility, or SV. More concretely, it assumes that

t

evolves

over time as an autoregressive process, for example, with the form:
log

t

= (1

) log +

log

t 1

+ ut ; where ut

N (0; 1)

The law of motion is expressed in terms of logs to ensure the positivity of
that will be important later: by mixing levels (zt ) and logs (log

t ),

t.

(2)
This is a point

we create a structure that

is inherently non-linear and it twists the distribution of technology. This will have consequences
both for the solution and for the estimation of the model.
Our speci…cation (2) is parsimonious and it introduces only two new parameters,

, the

autoregressive coe¢ cient of the log standard deviation, and , the standard deviation of the
innovations to volatility. At the same time, it is surprisingly powerful in capturing some important
features of the data (Shephard, 2008). Another important point is that, with SV, we have two
innovations, an innovation to technology, "t ; and an innovation to the standard deviation of
technology, ut . As we will see below, this will help the researcher to sort out the speci…c e¤ects
of volatility per se.3
The second approach is to specify that the variance of the productivity innovations follows
a GARCH process

2
t

=!+

(

the squared scaled innovation ((

t 1 "t 1 )

2

+

2
t 1 "t 1 ) ).

2
t 1,

that is,

2
t

is a function of its own past and

As with SV, instead of our simple GARCH, we could

3

It is trivial to correlate "t and ut . For example, in the data, times of large volatility such as the 1970s are
often also times of low productivity growth. In international macro, times of large spreads are also times of high
volatility. This correlation is sometimes called the “leverage e¤ect” of level shocks on volatility shocks because, in
asset pricing, one can generate it through the presence of leverage in the …rm’s balance sheet.

10

think about any of the many incarnations of GARCHs mentioned in section 2. Most of what we
have to say in the next few lines would be unchanged.
In the GARCH speci…cation there is only one shock driving the dynamics of the level and
volatility of technology: "t . This means that, when we have a large innovation, we will have
a large volatility in the next period. Thus, we cannot separate a volatility shock from a level
shock: higher volatilities are triggered only by large level innovations. While this constraint may
not be very important when we are dealing with time series from a reduced-form perspective, it
is quite restrictive in structural models. In particular, the interconnection of levels and volatilities precludes the use of GARCH models to assess, in a DSGE model, the e¤ects of volatility
independently from the e¤ects of level shocks.
Another way to think about it is as follows. In time series analysis, GARCHs are a popular
alternative to stochastic volatility because they are much easier to estimate and the loss in empirical …t is minor. In the case of DSGE models, this simplicity advantage disappears because,
with either SV or GARCH, we need to solve the model non-linearly. Not only that, but, as we
argued before, the presence of two shocks in SV provides the researcher with an extra degree of
freedom that can be put to good use.
The third approach to time-varying volatility is Markov regime switching models. For instance,
we can postulate that

t

follows a Markov chain that takes two values,

for low and H stands for high (

L

<

H

L

and

H

, where L stands

), and with transition matrix:

0
@

a1
1

1

a2

a1
a2

1
A

where a skillful choice of a1 and a2 allows us to introduce a large range of behaviors (for example,
a1

a2 can be read as low volatility being the normal times and high volatility as the rare times).

Moreover, there is nothing special about two values of volatility and we could have an arbitrary
number of them.
A big di¤erence between this approach and the previous two is the size of the change. We can
interpret both SV and GARCH processes as re‡ecting a continuously changing process that has
innovations in every period. In comparison, Markov regime switching models evolve in a more
abrupt, discrete way, with sudden jumps interrupted by periods of calm.
In the rest of the paper we will follow the …rst approach, SV, but we will say a few words
about GARCH and Markov regime switching as we move along. As we argued before, we do

11

not really see any advantage to using a GARCH process instead of SV: it has one less degree
of freedom, it prevents us from neatly separating level from volatility shocks, it …ts the data
worse, and, in the context of DSGE models, it is not any easier to handle. The choice between
SV and Markov-regime switching is more subtle. In the real world, the change in the volatility
of technology is probably a mix of continuous and discrete events. While there are phenomena
a¤ecting technological change that are easier to interpret as a discrete change (for example, the
approval of a new patent law), other developments (such as the growth in our understanding of
natural laws) are probably better understood as continuous changes. The preference for one or
another is an empirical question.
We could even postulate a more encompassing approach that incorporate discrete jumps and
continuous changes. The problem with such a model would be that, with the data frequency in
macro, we do not have enough observations to tease out these two sources of variation (as we would
have, for instance, in …nance, where continuous time versions of this process have been taken to
the data, see the review in Aït-Sahalia, Hansen, and Scheinkman, 2009). This is disappointing
because, as …rst pointed out by Diebold (1986), ignoring jumps may severely bias the estimates of
towards one, creating the misleading impression of non-stationarites and invalidating inference.
One advantage of SV, which we will exploit below and that tips the balance in its favor, is that,
since under that speci…cation log

t

can take any value, we will be able to di¤erentiate the decision

rules of the agents in the economy with respect to it, and hence to apply perturbation methods
for the computation of the equilibrium dynamics, which are a fast and reliable algorithm.4 This
is not the case with Markov regime switching models since log

t

takes only a …nite set of values.

However, it is fair to point out that SV has a few problems of its own. A salient one is
that, if the real process has a discrete jump, SV will “anticipate”the change by showing changes
in volatility before they happen. The reason is that the likelihood (or most other estimating
functions) dislikes huge changes in one period and prefers a sequence of smaller ut over time
before and after the actual change to an exceptionally large ut that captures the jump.5
4

Unfortunately, we do not have proof that the decision rules are di¤erentiable with respect to log t . As we will
explain later, this is one of the many issues related to volatility that we do not fully understand.
5
This could also be a virtue. Coming back to our example of a new patent law, we could think about a situation
where the volatility of technological change evolves over time as the proposal goes through the legislative process
and hence the conditional probability of its approval changes. Whether the anticipation e¤ect is a feature or a bug
would depend on the context.

12

4.2. Equilibrium
The de…nition of competitive equilibrium of this model is standard and we include it to demonstrate how we are deviating only a minuscule amount from the standard model.
De…nition 1. A competitive equilibrium is a sequence of allocations fct ; lt ; it ; yt g1
t=0 and prices

fwt ; rt ; Rt g1
t=0 such that:

1. Given prices fwt ; rt ; Rt g1
t=0 , the representative household maximizes:
U = E0

1
X

t

u (ct ; lt )

t=0

s.t. ct + it +

bt+1
= wt lt + rt kt + bt
Rt

2. Given prices fwt ; rt ; Rt g1
t=0 , the …rm minimizes costs given its production function:
yt = ezt Akt lt1

(3)

3. Markets clear:
kt+1 = (1

(4)

)kt + it

(5)

yt = ct + it

4. Productivity follows:
zt = zt
log

t

= (1

1

+

) log +

(6)

t "t

log

t 1

+ ut

(7)

The presence of SV does not a¤ect the welfare theorems and this economy is still Pareto
optimal. While this is a convenient feature, our analysis of SV will not rely on it. In fact, neither
of the economies in the two applications in the sections below will be Pareto-optimal.
4.3. Solution Methods
The solution of models with time-varying volatility presents some challenges. First, the system
is, at its very essence, non-linear. If we are employing SV, we are combining a linear process for
13

the log of technology with a linear process for the log of the standard deviation of technology
innovations. Analogously, in the other two speci…cations we discussed before, GARCH implies a
quadratic law of motion and Markov regime switching a discrete support. Second, we have an
additional state, log

t,

that agents need to keep track of in order to forecast future volatility.

4.3.1. Value Function Iteration
A …rst, natural approach is to work with the value function of the social planner problem:
V (kt ; zt ; log

t)

= max fu (ct ; lt ) + Et V (kt+1 ; zt+1 ; log
ct ;lt ;kt+1

t+1 )g

subject to (3), (4), (5), (6), and (7). This value function can be computed with value function
iteration (VFI). The only conceptual di¢ culty is to ensure that the conditional expectation Et is
properly evaluated at each point in time.
While VFI is a safe and straightforward procedure, it su¤ers from two shortcomings. First, it
forces us to cast the problem in a recursive form, which may be di¢ cult to do in economies with
market imperfections or rigidities. Second, VFI su¤ers from the “curse of dimensionality” that
limits the size of the problems we can handle. The curse of dimensionality is particularly binding
when we deal with SV because we double the number of states for each stochastic process that
incorporate a time-varying volatility: one state to capture the level of the process and one to keep
track of the variance.
4.3.2. Working with the Equilibrium Conditions
A second solution is to work with the equilibrium conditions:
u1 (ct ; lt ) = Et u1 (ct+1 ; lt+1 ) (1 + rt+1

)

u2 (ct ; lt ) = u1 (ct ; lt ) wt
wt = (1

) ezt Akt lt

rt = ezt Akt

1 1
lt

plus (3), (4), (5), (6), and (7). Equilibrium conditions enjoy the advantage that we do not need
to rely on any social planner problem or on being able to write the model in terms of a Bellman
equation.
The …rst step is to write the decision rules of the agents as a function of the states, (kt ; zt 1 ; log
14

t 1)

and the two innovations ("t ; ut ). Thus, we have, for the three controls ct = c (kt ; zt 1 ; log
lt = l (kt ; zt 1 ; log

t 1 ; "t ; ut ),

and kt+1 = k (kt ; zt 1 ; log

de…ned by the model xt = x (kt ; zt 1 ; log

t 1 ; "t ; ut ).

t 1 ; "t ; ut ),

t 1 ; "t ; ut ) ;

and for any other variable xt

Then, we plug these unknown decision rules

into the equilibrium condition and solve the resulting system of functional equations.
This can be accomplished in two ways. The …rst alternative is to parameterize the unknown
Pn x x
functions, for example, as xt =
i is a multivariate
i=0 i i (kt ; zt 1 ; log t 1 ; "t ; ut ) ; where
polynomial built with some combination of univariate polynomials of the 5 state variables (the
tensor product of univariate Chebyshev polynomials is a default choice). Next, we plug the
parameterized decision rules into the equilibrium conditions and we solve for all the unknown
coe¢ cients

x
i

by making the equilibrium conditions to hold as closely as possible over the state

space under some metric (for example, in a collocation, by forcing the equilibrium conditions to
be zero at the zeros of the n + 1-th order Chebyshev polynomial).
This approach, called a projection method (because we build a projection of the unknown
decision rule into the parameterized approximated decision rule), has the advantage of delivering
a high level of accuracy in the whole state space (it is a “global” solution method). As was the
case with VFI, the only possible conceptual di¢ culty is the correct evaluation of the conditional
expectation Et . On the negative side, we need to solve for a large number of

x
i

coe¢ cients to

achieve a good level of accuracy with a …ve-dimensional problem, yet another manifestation of
the curse of dimensionality.
The second approach to solve for the unknown decision rules in the equilibrium conditions
is to build a higher-order perturbation, an approach that has been shown to be both accurate
and fast (Aruoba, Fernández-Villaverde, and Rubio-Ramírez, 2006). The main idea is to …nd a
Taylor approximation of the decision rules around the steady state of the model. The …rst step
to doing so is to introduce a new parameter, called the perturbation parameter,

, and rewrite

the stochastic process (6) and (7) as:
zt = zt
log
Then, if we make

t

= (1

+

t "t

) log +

log

1

(8)
t 1

+

ut

(9)

= 1, we get back the original formulation of the problem. However, if we set

= 0, we eliminate the sources of uncertainty in the model and the economy will (asymptotically)
settle down at the steady state.
The second step is to rewrite all variables in terms of deviations with respect to the steady
15

state. Thus, we write x
bt = xt

log

t 1

where bt

1

= log

t 1

x for any arbitrary variable xt with steady state x, except for
log . Also, de…ne an augmented state vector of the model
1

0

st = @b
kt ; zt 1 ; bt 1 ; "t ; ut ; A = (St 1 ; Wt ; )
{z
} | {z }
|
St

1

Wt

where we stack the states in deviations to the mean, St 1 , and innovations Wt and we have
incorporated the perturbation parameter, , as a pseudo-state (where the “pseudo”is emphasized
by the use of a semicolon to separate it from the pure states). Then, the decision rules we are
looking for are b
ct = c (st ) ; b
lt = l (st ), and b
kt+1 = k (st ).
To approximate them, we will search for the coe¢ cients of the Taylor expansion of these

decision rules evaluated at the steady state, s = 01 5 . For example, for consumption, we write:
1
1
b
ct = c (st ) = ci;ss sit + cij;ss sit sjt + cijl;ss sit sjt slt + H:O:T:
2
6

where each term c:::;ss is a scalar equal to a derivative of the value function evaluated at the steady
state, ci;ss

ci (s) for i = 1; :::; 5; cij;ss

cij (s) for i; j = 1; :::; 5; and cijl;ss cijl (s) for i; j; l =
P P
P
1; :::; 5; where we follow the tensor notation ci;ss sit = 5i=1 ci;ss si;t , cij;ss sit sjt = 5i=1 5i=1 cij;ss si;t sj;t ;,
P
P P P
and cijl;ss sit sjt slt = 5i=1 5j=1 5l=1 cijl;ss si;t sj;t sl;t ; that eliminates the symbol 5i=1 when no confusion arises, and where we represent all the higher-order terms by H:O:T: (it will become clear

momentarily why we were explicit about the …rst three orders of the solution). We can proceed
in analogous ways for all other variables and derive the appropriate formulae.
To …nd the coe¢ cients ci;ss , cij;ss , and cijl;ss , we take derivatives of the equilibrium conditions
with respect to each component of st and solve for the resulting unknown coe¢ cients that make
these derivatives hold. Conveniently, this procedure is recursive; that is, we …nd the coe¢ cients
of each order of the approximation one step at a time. For example, by taking …rst derivatives
of the equilibrium conditions with respect to st , we …nd all the coe¢ cients of the …rst-order
ci;ss . Then, we take second derivatives of the equilibrium conditions with respect to st , we plug
in the coe¢ cients of the …rst-order ci;ss that we already know and we solve for the coe¢ cients
cij;ss , and so on for any arbitrary order. Furthermore, while in the …rst-order problem we have
a quadratic system (with two solutions that satisfy the necessary conditions, one that violates
the transversality condition and one that does not), all the higher-order systems are linear and
therefore easy to solve.

16

In addition to all these coe¢ cients, we also need to …nd a Taylor expansion of the stochastic
processes (8) and (9) or in our transformed state variables:
zt = zt
bt =

1

bt

+
1

+

e b t "t
ut

(10)
(11)

In standard DSGE models solved by linearization, this step is often overlooked because the conventional law of motion for zt is already linear, but in our case, since we have the term ebt "t , we

cannot avoid approximating (10) (equation 11 is already linear in the transformed variables). The

reason is that, when we perform a perturbation, all the variables should be perturbed at the same
order. This is required by the theorems that ensure that perturbation works (see Jin and Judd,
2002). The unfortunate practice, often seen in the literature, of mixing di¤erent orders of approximation, for instance, getting a …rst-order approximation for consumption and a second-order for
the stochastic processes, is wrong.6 Beyond its theoretical ‡aw, mixing orders of approximation is
not even particularly accurate and it is simple to show that standard measures as Euler equation
errors deteriorate when we follow this practice.
While, theoretically, we could …nd all the derivatives of the decision rules and the exogenous
processes and coe¢ cients by paper and pencil, in practice, we employ some symbolic software to
manipulate the equilibrium conditions of the model and take all the relevant derivatives. There
are programming languages, such as Mathematica, which are particularly suited to these type of
manipulations. Also, there is speci…c software developed in recent years for perturbation such as
the Dynare, a pre-processor and a collection of MATLAB and GNU Octave routines that compute up
to third-order approximations, or Dynare++, a standalone C++ version of Dynare that specializes
in computing n

th-order approximations.

4.3.3. Structure of the Solution
Our previous discussion gave us an abstract description of how to …nd the perturbation solution.
However, it overlooked the fact that the perturbation solution of the model has a particular pattern
that we can exploit. To make this point more generally, we switch in the next few paragraphs to
a more abstract notation.
6

This is also why we solve for consumption, labor, and capital. In principle, given two of these variables, we
could …nd the third one using the resource constraint of the economy. But this would imply that we are solving
two variables up to order n and the third one nonlinearly.

17

The set of equilibrium conditions of a large set of DSGE models, including the real business
cycle model with SV in this section, can be written in a compact way as:
Et f (Yt+1 ; Yt ; St+1 ; St ; Zt+1 ; Zt ) = 0

(12)

where Et is the conditional expectation operator at time t, Yt = (Y1t ; Y2t ; : : : ; Ykt ) is the vector of
non-predetermined variables of size k (such as consumption or labor), St = (S1t ; S2t ; : : : ; Snt ) is the
vector of endogenous predetermined variables of size n (such as capital), Zt = (Z1t ; Z2t ; : : : ; Zmt )
is the vector of exogenous predetermined variables of size m, which we refer to as structural shocks
(such as productivity), and f is a mapping from R2

k+2 n+2 m

into Rk+n+m .

We assume that structural shocks follow an SV process of the form Zit+1 =
where the standard deviation of the innovations evolves as log
i = f1; : : : ; mg and

it+1

= #i log

it

i Zit +

+

it+1 "it+1

i uit+1

for all

is still the perturbation parameter. To avoid carrying extra indices, we

are assuming that all structural shocks face volatility shocks. By setting the appropriate entries
of #i and

i

to zero, we can easily handle homoscedastic shocks. We are also assuming that the

volatility shocks are uncorrelated. This restriction can also be relaxed.
The solution to the system of functional equations de…ned by (12) can be expressed in
terms of two equations, one St+1 = h (St ; Zt 1 ;

t 1 ; Et ; Ut ;

determined variables, and another, Yt = g (St ; Zt 1 ;
non-predetermined ones, where

t

= (log

1t ; log

) ; describing the evolution of pre-

t 1 ; Et ; U t ;

2t ; : : : ; log

Ut = (u1t ; u2t ; : : : ; umt ). More intuitively, we think of

t

) ; describing the evolution of

mt ),

Et = ("1t ; "2t ; : : : ; "mt ); and

as the volatility shocks, Et are the

innovations to the structural shocks, and Ut are innovations to volatility shocks.
As we described in the previous subsection, we are seeking a higher-order approximation to the
functions h ( ) : Rn+(4
and

m)+1

! Rn and g ( ) : Rn+(4

m)+1

! Rk around the steady state, St = S

= 0. While a general characterization of these functions is di¢ cult, it is surprisingly easy

to obtain substantial results regarding the …rst- and second-order derivatives of the functions h ( )
and g ( ) evaluated at the steady state.7 In particular, we formally show in Fernández-Villaverde,
Guerrón-Quintana, and Rubio-Ramírez (2010a) (hereafter, FGR) that the …rst partial derivative
of h ( ) and g ( ) with respect to any component of Ut and

t 1

evaluated at the steady state is

zero. In other words, volatility shocks and their innovations do not a¤ect the linear component
of the optimal decision rule of the agents for any i = f1; : : : ; mg. The same occurs with the
7

We conjecture, based on our numerical results, that there exists relatively direct (yet cumbersome to state)
extensions of our theorem for higher-order terms.

18

perturbation parameter

. This is not a surprising result since Schmitt-Grohé and Uribe (2004)

have stated a similar theorem for the homoscedastic shocks case. The theorem also shows that
the second partial derivative of h ( ) and g ( ) with respect to ui;t and any other variable but "i;t
is also zero for any i = f1; : : : ; mg.
The interpretation of the theorem is simple. The …rst part just states that variances or
their evolution do not enter in the …rst-order component of the solution of the model. This is
nothing more than certainty equivalence: a …rst-order approximation is equivalent to a model
with quadratic utility functions and where, consequently, agents do not respond to variance. It
is only in the second-order component of the solution that we have terms that depend on the
variance since those depend on the third derivative of the utility function. In particular, we will
have a constant that corrects for risk.
But even in the second-order, time-varying volatilities enter into the solution is a very restricted
way: through the interaction term of the innovations to the structural shocks and the innovations
to volatility shocks of the same exogenous variable. That is, if we have two di¤erent shocks (for
instance, one to technology and one to preferences), the only terms di¤erent from zero in the
second-order perturbation involving volatility would be the term with the innovation to the level
of technology times the innovation to the volatility of technology and the term with the innovation
to the level of preferences times the innovation to the volatility of preferences.
It is only in the third-order part of the solution (not covered by the theorem) -that is, those
terms depending on the fourth derivative of the utility function- that the level of volatility enters
without interacting with any other variable. That is why, if we are interested, for instance, in
computing the impulse-response function (IRF) of a shock to volatility (as we will be in section
6), we need to compute at least a third-order approximation.
4.4. A Quantitative Example
We now present a quantitative example that clari…es our previous discussion. We start with
Greenwood-Hercowitz-Hu¤man (GHH) preferences u (ct ; lt ) = log ct

lt1+
1+

: We pick these

preferences because they do not have a wealth e¤ect. For our illustrative purposes, this is most
convenient. Given that the production function is of the form yt = ezt Akt lt1

; an increase in the

variance of zt has a Jensen’s inequality e¤ect that induces a change in expected output. GHH
kills that e¤ect and avoids distracting elements in the solution. Later, for completeness, we will
come back to a CRRA utility function.

19

The second step is to calibrate the model (below we will discuss how to estimate it, so we can
think about this step as just …xing some parameter values for the computation). For our goals
here, a conventional calibration will be su¢ cient. With respect to the preference parameters,
we set

= 0:99 to get an annual interest rate of around 4 percent, we set

Frisch elasticity of 2, and

= 0:5 to get a

= 3:4641 to get average labor supply to be 1/3 of available time.

With respect to technology, we set

= 1=3 to match labor income share in national income;

A = 0:9823 to normalize y = 1, and

= 0:025 to get a 10 percent annual depreciation. Finally,

with respect to the stochastic process parameters, we set

= 0:95 and log

standard values for the Solow residual in the U.S. economy, and

= log (0:007), the

= 0:95 and

= 0:1 as two

values that generate changes in volatility similar to the ones observed in the U.S. (since

does

not appear in the decision rules up to second-order, its value for our example is less important).
The solution for consumption is then:
b
ct = 0:055115b
kt + 0:576907zt

1

+ 0:004251"t

0:000830b
kt2 + 0:036281b
kt zt

1

+ 0:000267b
kt "t + 0:315513zt2

+0:000017"2t + 0:004251"t ut + 0:004038"t bt

1

+ 0:004650zt 1 "t

1

+ 0:000013 + H:O:T:;

(where we have already eliminated all terms with zero coe¢ cients), for labor
b
lt = 0:014040b
kt + 0:253333zt

1

+ 0:001867"t

0:000444b
kt2 + 0:010671b
kt zt

1

+ 0:000079b
kt "t + 0:096267zt2

+0:000005"2t + 0:001867"t ut + 0:001773"t bt

1

1

+ 0:001419zt 1 "t

+ H:O:T:;

and for capital

b
kt+1 = 0:983067b
kt + 0:563093zt

1

0:0005b
kt2 + 0:035747b
kt zt

+ 0:004149"t
1

+ 0:000263b
kt "t + 0:3342873zt2

+0:000018"2t + 0:004149"t ut + 0:003942"t bt

1

1

+ 0:004926zt 1 "t

0:000013 + H:O:T:

In this solution, the correction for risk in consumption is re‡ected by the constant 0:000013,
and for capital, by the constant

0:000013 (given the absence of wealth e¤ects in GHH preferences,

there is no constant shifting labor). This is because we have two mechanisms that act in di¤erent
directions. On the one hand, precautionary behavior caused by volatility induces higher saving,
20

but on the other hand, volatility increases the production risk of capital. In our calibration this
second e¤ect predominates. Furthermore, high levels of volatility raise the e¤ects of productivity
shocks on consumption, labor, and capital. This is given by the three terms on "t bt 1 . Finally,
shocks to the level and shocks to volatility also reinforce each other (the coe¢ cients on "t ut ).

Once we have the solution, there is the question of the quantitative importance of the second-

or higher-order terms and, with them, of SV. There are two considerations. First, the size of the
e¤ect will depend on the parameters for the SV process. For some countries, a small level of SV
may be plausible. For others, larger values are likely. A reasonable prior is that many developed
economies would fall into the …rst group and many emerging economies into the second (our choice
of

= 0:1 gets us closer to developed economies than to emerging ones). Second, the level of

accuracy required in a solution is context-dependent. For example, a linear approximation that
ignores SV may be good enough to compute some basic business cycle statistics, but it is unlikely
to be enough for an accurate evaluation of welfare, and by construction, it is unable to estimate
any of the parameters related to SV.
By modifying our utility kernel to the standard log-CRRA form u (ct ; lt ) = log ct
calibration stays the same except that we readjust

lt1+
1+

: The

= 4:5425 to keep l = 1=3. The new policy

functions for consumption:
b
ct = 0:043421b
kt + 0:199865zt

1

+ 0:001473"t

0:000810b
kt2 + 0:005249b
kt zt

for labor
b
lt =

1

+ 0:000039b
kt "t + 0:053136zt2

+0:000003"2t + 0:001473"t ut + 0:001399"t bt
0:008735b
kt + 0:148498zt

+0:000449b
kt2

1

0:000676b
kt zt

1

+ 0:000783zt 1 "t

0:000003 + H:O:T:

1

+ 0:001094"t
0:000005b
kt "t + 0:018944zt2

1

+0:000001"2t + 0:001094"t ut + 0:001039"t bt

1

1

+ 0:000279zt 1 "t

+ 0:000002 + H:O:T:

and for capital

b
kt+1 = 0:949211b
kt + 0:730465zt

1

+ 0:005382"t

0:000214b
kt2 + 0:017585b
kt zt

1

+ 0:000130b
kt "t + 0:351353zt2

+0:000019"2t + 0:005382"t ut + 0:005113"t bt
21

1

1

+ 0:005178zt 1 "t

+ 0:000006 + H:O:T:

show the consequences of the wealth e¤ect, in particular, the presence of a (small) precautionary behavior for labor, 0:000002, and the switch on the sign of the precautionary behavior for
consumption and capital.
Now we can use our solution to form a state space representation, with a transition equation
for the states given the innovations:
(13)

St = f (St 1 ; Wt ; )

that is the law of motion for capital that we just derived and (the second-order expansion of) the
laws of motion of the stochastic process for productivity and its volatility, and a measurement
equation for observables Yt = g (St ; Vt ; ) where Vt is measurement noise (either measurement
error or any other shock that a¤ects the observables but not the states). This measurement noise
is optional and, in our prototype model, we will not include it (one additional advantage of SV
is that, for every stochastic process, we have two innovations, one to the level and one to the
volatility) and we can write the simpler version:
(14)

Yt = g (St ; )
We index both equations by the vector

= f ; ; ; A; ; ; ; ;

; g of model parameters.

While the transition equation (13) is unique up to an equivalent class, the measurement equation depends on the assumptions about what we observe. For example, in our prototype business
cycle model we can assume we observe hours or consumption (or both of them), since the model
implies predictions about both variables. The choice should depend on the quality of the observables and on the goal of the empirical exercise. The only constraint is that we must select a
number of series less than or equal to dimensionality of (Wt ; Vt ) to avoid stochastic singularities.
4.5. Estimation
The next step in the analysis of our prototype business cycle model is its estimation with observed
data. Besides the usual arguments for a rigorous statistical treatment of any model, in this case,
a simple calibration exercise su¤ers from two serious challenges. First, in the presence of higherorder terms, the traditional strategy of selecting parameters by matching moments of the model
with steady state values is ‡awed. When we have non-linearities, the ergodic distribution of the
variables is not centered around their steady state, as it would be with a linearization. Instead, it

22

is translated by the non-linear coe¢ cients. Thus, the only logical stand is to match the moments of
the data with the simulated moments of the model, leaving us close to an SMM. Second, and even
if we follow an SMM, it is not obvious which moments to select to calibrate the parameters of the
SV process. Unfortunately, the experience from many years of methods of moments estimations is
that choosing di¤erent moments (all of them sensible) may lead to rather di¤erent point estimates.
The alternative is to use a likelihood-based approach. The advantages of the likelihood function
as the center of inference have been explained in other places (see An and Schorfheide, 2006,
Fernández-Villaverde and Rubio-Ramírez, 2004, and Fernández-Villaverde, 2010) and there is not
much point in reviewing them here. Su¢ ce it to say that the likelihood is a coherent procedure
that respects the likelihood principle and allows us to back up all the parameters of interest,
and that has good small and large sample properties. Furthermore, the likelihood function can
be easily complemented with presample information in the form of priors, which are particularly
useful in macroeconomics, where we have short samples.
The likelihood function p YT ;

is nothing more than the probability the model assigns to

a sequence of observables YT given parameter values

. The challenge with likelihood-based

inference is that we need to evaluate that probability. A way to think about how this task can
be accomplished for our model is as follows. Given the Markov structure of our state space
representation (13)-(14), we factorize the likelihood function as:
T

p Y ;

=

T
Y
t=1

p Yt jYt 1 ;

Then, conditioning on the states St , and the innovation to productivity "t , we can write:
p Yt jY

t 1

;

=

Z Z

p (Yt jSt ; "t ; ) p St ; "t jYdata;t 1 ;

except for the …rst one:
p (Y1 ; ) =

Z

p (Y1 jS1 ; "1 ; ) dS1 d"1

dSt d"t

(15)

(16)

If we know St and "t , computing p (Yt jSt ; "t ; ) is easy: it is just a change of variables implied by

the measurement equation. To illustrate this point, imagine that Yt = b
ct ,8 that is the observable
8

Note that b
ct is equal to the raw data ct minus the steady state c. Since the evaluation of the likelihood is
conditional on some , we can easily …nd that steady state and map the raw data c into b
ct . In real life, we are
likely to have growth in the data, and hence, we will need to solve the model in some (transformed) stationary
variable and undo the transformation in the measurement equation.

23

vector is just consumption which we have solved up to second-order:
b
c t = a1 b
kt + a2 zt

1

+ a3 " t +

a4 b
kt2 + a5 b
kt zt

1

+ a6 b
kt "t + a7 zt2

1

+ a8 zt 1 "t + a9 "2t + a10 "t ut + a11 "t bt

1

+ a12

where the at ’s are the coe¢ cients of the perturbation that are complicated non-linear functions
of

. Then, given St and "t , we …nd the value of u
et that accounts for the observation b
ct :
u
et =

1

a10 "t

2

b
ct
a6 b
kt "t

4

By evaluating the p.d.f. of u
et given

a1 b
kt

a7 zt2

a2 zt

1

1

a3 " t

a8 zt 1 "t

a4 b
kt2

a5 b
kt zt

a9 "2t + a11 "t bt

1

1

a12

3
5

(17)

(in our model, just a normal p.d.f.) and applying the change

of variables formula, we get p (Yt jSt ; "t ; ) : This computation of u
et in (17) takes advantage of the

structure of the solution to our model that we characterized before. The result can be generalized
to an arbitrary number n of observables and shocks with SV, in which case we would have a linear
system of n equations. If we did not know that some coe¢ cients were zero, we would need to
solve a quadratic system on ut , something much harder to do. For example, in the case with n
observables, it would be a quadratic system with 2n solutions, a daunting task.
In the same way, if we know how to draw from p (S1 ; ), we can compute (16) by Monte Carlo.
Generating this drawing is usually straightforward, although tedious. As described in Santos and
Peralta-Alva (2005), given some parameter values

, we can simulate the model for a su¢ ciently

large path (to wash out the e¤ect of the initial conditions, which we can make equal to the steady
state just for simplicity, although other starting points are admissible if convenient) and keep the
last realizations as a sample from p (S1 ; ).
Thus, the complication in evaluating (15) is reduced to a) …nding the sequence of conditional
T

densities fp (St ; "t jYt 1 ; )gt=1 and b) computing the di¤erent integrals. Fortunately, …ltering
theory aims at providing the user precisely that sequence of conditional densities and ways to
compute the required integrals.
Filtering is a recursive procedure that relies on two tools, the Chapman-Kolmogorov equation:
t

p St+1 ; "t+1 jY ;

=

Z

p (St+1 ; "t+1 jSt ; "t ; ) p St ; "t jYt ;

24

dSt d"t

(18)

and Bayes’theorem:
t

p St ; "t jY ;

=R

p (Yt jSt ; "t ; ) p (St ; "t jYt 1 ; )
p (Yt jSt ; "t ; ) p (St ; "t jYt 1 ; ) dSt d"t

(19)

The Chapman-Kolmogorov equation tells that the distribution of states and productivity innovations tomorrow given observations until today, p (St+1 ; "t+1 jYt ; ), is equal to the distribution
today, p (St ; "t jYt ; ) ; times the transition probabilities p (St+1 ; "t+1 jSt ; "t ; ) integrated over all

possible events. In other words, the Chapman-Kolmogorov equation just provides the researcher
with a forecasting rule for the evolution of states. Given that we have access to the solution of
the model, the computation of p (St+1 ; "t+1 jSt ; "t ; ) is direct given p (St ; "t jYt ; ) as an input.

Bayes’theorem updates the distribution of states p (St ; "t jYt ; ) when a new observation ar-

rives given its probability p (Yt jSt ; "t ; ), which, as we argued above, is also easy to evaluate

given our state space representation. Thus, with an input p (St ; "t jYt 1 ; ), the Bayes’ theo-

rem gives us p (St ; "t jYt ; ). We can see clearly the recursive structure of …ltering. Given some
initial p (S1 ; "1 ; ), Bayes’ theorem provides us with p (S1 ; "1 jY1 ; ), which we use as an input
for the Chapman-Kolmogorov equation and get p (S2 ; "2 jY1 ; ), the input for the next application of the Bayes’ theorem. By a recursive application of the forecasting and updating steps,
T

we generate the complete sequence fp (St ; "t jYt 1 ; )gt=1 we are searching for. But while the
Chapman-Kolmogorov equation and Bayes’theorem are conceptually straightforward, their practical implementation is cumbersome because they involve the computation of numerous integrals
again and again over the sample.
There is, of course, a well-known exception. If the state space representation (13)-(14) were
linear and the innovations normally distributed, we could use the Kalman …lter to e¢ ciently derive
T

fp (St ; "t jYt 1 ; )gt=1 and, by taking advantage of the fact that all the appropriate conditional
distributions are normal, to solve the required integrals.
Unfortunately, this cannot be done once we have SV since at least one component of (13)
T

is non-linear.9 The non-linearity of SV deforms fp (St ; "t jYt 1 ; )gt=1 in such a way that they
do not belong to any known parametric family. Instead, we need to resort to some numerical
procedure to compute the relevant integrals. A powerful algorithm for this non-linear …ltering is
9

Even if we kept the linear approximation of the decision rule and cut o¤ its quadratic terms, we would still
need to resort to some type of non-linear …ltering. We argued before that this mixing of approximation orders
(linear for endogenous state variables, non-linear for exogenous ones) violates the theorems that guarantee the
convergence of perturbations and it su¤ers from poor accuracy. Here, we show it does not even save time when
estimating the model.

25

the particle …lter, as described, for example, in Fernández-Villaverde and Rubio-Ramírez (2005
and 2007) (see also the technical appendix to Fernández-Villaverde and Rubio-Ramírez, 2007, for
alternative algorithms).
The particle …lter is a sequential Monte Carlo method that replaces the unknown sequence
oN
n
T
i
t 1
i
(where we follow
fp (St ; "t jY ; )gt=1 with an empirical distribution of N draws stjt 1 ; "1t
i=1

the short-hand notation that a variable xijjm is the draw i at time j conditional on the information
up to period m) generated by simulation. Then, by an appeal to the Law of Large Numbers, we
can substitute the integral in (15) by:
t 1

p Yt jY

;

N
1 X
p Yt jsitjt 1 ; "i1t ;
'
N i=1

(20)

The key to the success of the particle …lter is that the simulation is generated through a procedure
known as sequential importance resampling (SIR) with weights:

qti

p Yt jsitjt 1 ; "i1t ;

(21)

=P
N

i
i
i=1 p Yt jstjt 1 ; "1t ;

oN
oN
n
n
that incorporates inforto a draw sitjt ; "it
SIR allows us to move from a draw sitjt 1 ; "it
i=1

i=1

mation about the observable at period t. The reason is that resampling with weights qti is just
oN
n
is the
equivalent to the application of Bayes’theorem in equation (19): the draw sitjt 1 ; "it
i=1

prior and the weights are the normalized likelihood of Yt . SIR guarantees that the Monte Carlo
method achieves su¢ cient accuracy in a reasonable amount of time, something that cannot be
achieved without resampling as most draws would wander away from the true unknown state. The
forecast step in the Chapman-Kolmogorov equation (18) is extremely simple because we have the
law of motion for states given sitjt 1 ; "it , the volatility innovation it implies, and the distribution

of the level innovation p ("j ). Under weak conditions, the particle …lter delivers a consistent
estimator of the likelihood function and a central limit theorem applies (Künsch, 2005).
In pseudo-code, this resampling works as follows:

26

Step 0, Initialization: Set t

1.

Sample N values

p ("j ).

oN
n
si0j0 ; "i0

i=1

from p (S0 j ) and

n
oN
i
i
Step 1, Prediction: Sample N values stjt 1 ; "t
from p (St ; "t jYt 1 ; ) using the
i=1
oN
n
, the law of motion for states and p ("j ).
draw sit 1jt 1 ; "it 1
i=1

the weight qti in (21).
oN
n
with weights
Step 3, Sampling: Sample N times with replacement from sitjt 1 ; "it
i=1
n
oN
N
fqti gi=1 . Call the new draw sitjt ; "it
. If t < T; set t
t + 1 and go to step 2.
Step 2, Filtering: Assign to each draw

sitjt 1 ; "it

i=1

Otherwise stop.

Once we have evaluated the likelihood function given

, the researcher can either maximize it

by searching over the parameter space or we can combine it with a prior p ( ) and use a Markov
chain Monte Carlo (McMc) to approximate the posterior:
p

jYt = R

p YT ;
p( )
T
p (Y ; ) p ( ) d

An and Schorfheide (2006) is a standard reference for details about to how to implement McMc’s.
Moreover, the McMc method (or close relatives such as simulated annealing) can be used for the
maximization of the likelihood. One inconvenient consequence of the resampling in the particle
…lter is that the evaluation of the likelihood is not di¤erentiable with respect to the parameters: a
small change in one parameter may imply that we resample a di¤erent draw than in the previous
pass of the algorithm.10 Therefore, derivative-based optimization algorithms cannot be applied
without further smoothing of the likelihood.
4.6. Implications for Policy
The …nal step in our discussion is to think about policy implications. The …rst, and most direct, is
that if volatility shocks a¤ect aggregate ‡uctuations in a signi…cant way, policy makers may need
10

For the maximum likelihood to converge, we need to keep the simulated innovations "t and the uniform
numbers that enter into the resampling decisions constant as we modi…ed the parameter values. This is required
to achieve stochastic equicontinuity. With this property, the pointwise convergence of the likelihood (20) to the
exact likelihood is strengthened to uniform convergence and we can swap the argmax and the lim operators (that
is, as the number of simulated particles converges to in…nity, the MLE also converges). Otherwise, we would su¤er
numerical instabilities induced by the “chatter” of random numbers. In the Bayesian approach, keeping these
random numbers constant is not strictly needed but it improves accuracy.

27

to consider volatility when implementing …scal and monetary policy. Imagine, for example, that
we extend our model with the need to …nance an exogenously given ‡ow of public expenditure and
the government only has access to distortionary taxes. This is the same framework as in Chari,
Christiano, and Kehoe (1994), except that now technology shocks have SV. A Ramsey optimal
policy would prescribe how debt, and …scal policy in general, needs to respond to volatility shocks.
For instance, we conjecture that the presence of SV, by augmenting the risk of having a really bad
shock, may imply that governments want to accumulate less public debt on average to leave them
enough space to respond to these extreme shocks. Similarly, an optimal interest rate rule followed
by the central bank to implement monetary policy could also depend on the level of volatility
in addition to the traditional dependence on the levels of in‡ation and the output gap. In fact,
Bekaert, Hoerova, and Lo Duca (2010) have gathered evidence that, in the U.S., the Fed responds
to increased stock market volatility by easing monetary policy.
A second policy consideration is that countries subject to volatility shocks require a more
sophisticated management of the maturity structure of their debt that takes into account the
future paths of the level and volatility of interest rates. This is central in environments with
non-contingent public debt, arguably a fair description of reality. Thus, volatility highlights the
importance of improving our understanding of the optimal management of government debt in a
world with incomplete markets, a …eld still relatively unexplored.
Now, after our fairly long discussion of the prototype business cycle model, we are ready for
our …rst “real life” application, an exercise in reading the recent monetary history of the U.S.
through the lens of DSGE models.

5. Application I: Understanding the Recent Monetary History of the
U.S.
As we documented in section 3, around 1984, the U.S. economy entered into a period of low
volatility known as the great moderation. Among the many reasons presented in the literature,
two have received a considerable amount of attention. One branch of the literature argues that the
great moderation was just the consequence of low volatility shocks (for example, Sims and Zha,
2006). Another branch of the literature argues that some other changes in the economy, usually
better monetary policy, explain the evolution of aggregate volatility (more famously, Clarida, Galí,
and Gertler, 2000, and Lubick and Schorfheide, 2004). The …rst explanation is pessimistic: we
enjoy or su¤er periods of low or high volatility, but there is little that policy makers can do about
28

it. The second one is optimistic: as long as we do not unlearn the lessons of monetary economics,
we should expect the great moderation to continue (even after the current turbulence).
Sorting the two di¤erent approaches requires that we analyze the question using a model that
has both changes in volatility and changes in policy. Moreover, we need an equilibrium model.
As shown by Benati and Surico (2009), SVARs may be uninformative for the question at hand
since we cannot easily map between changes in variances of the SVAR and changes in variances
of the shocks of a DSGE model.
The techniques presented in this paper can help us to …ll this gap. In particular, we can
build and estimate a medium-scale DSGE model with SV in the structural shocks that drive the
economy, parameter drifting in the Taylor rule followed by the monetary authority, and rational
expectations of agents regarding these changes. In the next pages, we summarize the material in
FGR.
5.1. The Model
We adopt what has become the standard New Keynesian DSGE model, based on Christiano,
Eichenbaum, and Evans (2005). Since the model is well known, our description will be brief. In
our speci…cation, SV appears in the form of changing standard deviations of the …ve structural
shocks to the model (two shocks to preferences, two shocks to technology, and one shock to
monetary policy). Parameter drifting appears in the form of changing values of the parameters
in the Taylor policy rule followed by the monetary authority.
In more detail, household j’s preferences are:

E0

1
X

t

dt

t=0

(

log (cjt

hcjt 1 ) + log

mjt
pt

't

1+#
ljt
1+#

)

;

which is separable in consumption, cjt , real money balances, mjt =pt ; and hours worked, ljt . In
our notation, E0 is the conditional expectation operator,

is the discount factor, h controls habit

persistence, # is the inverse of the Frisch labor supply elasticity, dt is a intertemporal preference
shock that follows log dt =
that evolves as log 't =

'

d

log dt

log 't

1

1

+

+

dt "dt

't "'t

where "dt

where "'t

As in section 4, the standard deviations,
cording to log
1

'

log

dt
'

= 1

+

'

log

d

log

't 1

+

d

+

' u't

d

log

dt

and

dt 1

where u't

29

+

N (0; 1) and 't is a labor supply shock
N (0; 1):
't ,
d udt

of innovations "dt and "'t move acwhere udt

N (0; 1):

N (0; 1) and log

't

=

All the shocks and innovations are perfectly observed by the agents when they are realized.
Agents have, as well, rational expectations about how they evolve over time.
We assume complete …nancial markets. An amount of state-contingent securities, ajt+1 ; which
pay one unit of consumption in event ! jt+1;t , is traded at time t at unitary price qjt+1;t in terms
of the consumption good. In addition, households also hold bjt government bonds that pay a
nominal gross interest rate of Rt 1 . Therefore, the j

th household’s budget constraint is given

by:
Z
mjt bjt+1
+
+ qjt+1;t ajt+1 d! jt+1;t
cjt + xjt +
pt
pt
mjt 1 Rt 1 bjt
[ujt ]
kjt 1 +
+
+ ajt + Tt
= wjt ljt + rt ujt
pt
pt
t
where xt is investment, wjt is the real wage, rt the real rental price of capital, ujt > 0 the rate of
use of capital,

1

[ujt ] is the cost of utilizing capital at rate ujt in terms of the …nal good,

t

t

is

an investment-speci…c technological level, Tt are lump-sum transfers and the pro…ts. We specify
[ ] such that it satis…es the conditions that

0

[1] = 0,

[ ] = 0, and

00

[ ] > 0. This function

carries the normalization that u = 1 in the balanced growth path. The capital accumulated by
household j at the end of period t is given by:
kjt = (1
where

) kjt

1

+

t

(1

V [xjt =xjt 1 ]) xjt

is the depreciation rate and V [ ] is a quadratic adjustment cost function written in

deviations with respect to the balanced growth rate of investment,
the investment-speci…c technology level

t,

follows log

t

=

x.

Our third structural shock,

+ log

N (0; 1). The standard deviation of the innovation also evolves as log
log

t 1

+

u

t

where u

t

t 1
t

+

t" t;

= 1

where "
log

t

+

N (0; 1):

The household chooses cjt , bjt , ujt , kjt , and xjt taking prices as given. Labor and wages, ljt
and wjt , are chosen in the presence of monopolistic competition and nominal rigidities. Each
household j supplies a slightly di¤erent type of labor services ljt that are aggregated by a “labor
packer”into homogeneous labor ltd with the production function:
ltd

=

Z

1

1

1

ljt dj

0

that is rented to intermediate good producers at the wage wt . The “labor packer” is perfectly
30

competitive and it takes wages as given. Households follow a Calvo pricing mechanism when they
set their wages. Every period a randomly selected fraction 1

of households can reoptimize

w

their wages to wjt . All other households index their wages given past in‡ation with an indexation
parameter

w

2 [0; 1].

There is one …nal good producer that aggregates a continuum of intermediate goods and it is
perfectly competitive and minimizes its costs subject to the production function
ytd

Z

=

1

"
" 1

" 1
"

yit di

0

and taking as given all prices. Each of the intermediate goods is produced by a monopolistic
competitor whose technology is given by a production function yit = At kit

1

litd

1

; where kit

1

is

the capital rented by the …rm, litd is the amount of the “packed”labor input rented by the …rm, and
At (our fourth structural shock) is neutral productivity that follows log At =
where "At
log

At

A +log At 1 + At "At ;

N (0; 1). The standard deviation of this innovation evolves following the speci…cation

= 1

A

log

A

+

A

log

At 1

+

A uAt

where uAt

N (0; 1):

Given the demand function from the …nal good producer, the intermediate good producers set
prices to maximize pro…ts. They also follow a Calvo pricing scheme. In each period, a fraction
1

p

reoptimize their prices to pt . All other …rms partially index their prices by past in‡ation

with an indexation parameter .
The model is closed by the presence of a monetary authority that sets the nominal interest
rates. The monetary authority follows a modi…ed Taylor rule:
Rt =R = (Rt 1 =R)
The term
path level

t=

R

(

t=

)

ytd =ytd

;t

= exp (

y

y)

1

R

t:

, an “in‡ation gap,”responds to the deviation of in‡ation from its balanced growth
and the term ytd =ytd

1

= exp (

y)

is a “growth gap” (

economy along its balanced growth path). The term log
The innovation "mt
m;t ,

1

that follows log

t

=

m;t "mt

y

is the growth rate of the

is the monetary policy shock.

N (0; 1) to the monetary policy shock has a time-varying standard deviation,
mt

= 1

m

log

m+

m

log

mt 1 + m um;t

where um;t

N (0; 1): In this

policy rule, we have a drifting parameter: the response of the monetary authority to the in‡ation
gap,
where "

;t .
t

The parameter drifts over time as log

t

= 1

log

+

log

t 1

+

"

t

N (0; 1): We assume here that the agents perfectly observe the changes in monetary

policy parameters.

31

5.2. Solution and Estimation
The equilibrium of the model does not have a closed-form solution and we need to resort to a
numerical approximation to compute it. For the reasons outlined in section 5, we perform a
second-order perturbation around the (rescaled) steady state of the model. The quadratic terms
of this approximation allow us to capture, to a large extent, the e¤ects of volatility shocks and
parameter drift while keeping computational complexity at a reasonable level.
We estimate our model using …ve time series for the U.S. economy: 1) the relative price of
investment goods with respect to the price of consumption goods, 2) the federal funds rate, 3)
real output per capita growth, 4) the consumer price index, and 5) real wages per capita. Our
sample covers 1959.Q1 to 2007.Q1, with 192 observations. Then, we follow again section 5 and
exploit the structure of the state space representation of the solution of the model to evaluate the
likelihood of the model. FGR provide further details.
5.3. The Empirical Findings
We invite the interested reader to check FGR, where all the results are shown in detail and
Fernández-Villaverde, Guerrón-Quintana, and Rubio-Ramírez (2010b) where the …ndings are compared with the historical record. Here, as a summary, we highlight our main …ndings: 1) there is
overwhelming evidence of changes in monetary policy even after controlling for the large amount
of stochastic volatility existing in the data; 2) these changes in monetary policy were key for the
reduction of average in‡ation; 3) and the response of monetary policy to in‡ation under Burns,
Miller, and Greenspan was similar, while it was much higher under Volcker.
The …rst …nding can be documented in …gure 5.1 with the evolution of the (smoothed) Taylor
rule parameter of the response of the monetary authority to in‡ation that we recover from the
data. This …gure summarizes how our model understands the recent monetary history of the U.S.
The parameter

t

started the sample around its estimated mean, slightly over 1, and it grew

more or less steadily during the 1960s until reaching a peak in early 1968. After that year,

t

su¤ered a fast collapse that pushed it below 1 in 1971, one year after the appointment of Burns as
chairman of the Fed in February 1970. The parameter stayed below 1 for all of the 1970s, showing
either that monetary policy did not satisfy the Taylor principle or that our postulated monetary
policy rule is not a good description of the behavior of the Fed at the time (for example, because
the Fed was using real-time data). The arrival of Volcker is quickly picked up by our estimates:
t

increases to over 2 after a few months and stays high during all the years of Volcker’s tenure.

32

Interestingly, our estimate captures well the observation by Goodfriend and King (2007) that
monetary policy tightened in the spring of 1980 as in‡ation and long-run in‡ation expectations
continued to grow. The level of

t

stayed roughly constant at this high during the remainder

of Volcker’s tenure. But as quickly as

t

rose when Volcker arrived, it went down again when

he departed. Greenspan’s tenure at the Fed meant that, by 1990, the response of the monetary
authority to in‡ation was again below 1. During all the following years,

t

was low, even below

the values that it took during Burns-Miller’s time. Moreover, our estimates of

t

are tight,

suggesting that posterior uncertainty is not the full explanation behind these movements.

Drift on Taylor Rule Param. on Inflation +/- 2 Std. Dev.
Burns-Miller
Volcker
Greenspan
Bernanke

5

Level of Parameter

4

3

2

1

0

-1
1960

1965

1970

1975

1980

1985

1990

1995

2000

Period

Figure 5.1: Smoothed path for the Taylor rule parameter on in‡ation +/- 2 standard deviations.
With respect to SV, we plot in …gure 5.2 the evolution of the standard deviation of the
innovation of the structural shocks, all of them in log-deviations with respect to their estimated
means. A …rst lesson from that …gure is that the standard deviation of the intertemporal shock
was particularly high in the 1970s and only slowly went down during the 1980s and early 1990s. By
the end of the sample, the standard deviation of the intertemporal shock was roughly at the level
where it started. This is important to understand the behavior of in‡ation. A high volatility of
intertemporal shocks creates a volatile aggregate demand and, with it, an in‡ation that is harder
to control. Thus, we conclude that a signi…cant component of the volatility of in‡ation in the
1970s and 1980s was due to the volatility of preferences. In comparison, the standard deviation of
33

2005

all the other shocks is relatively stable except, perhaps, for the big drop in the standard deviation
of the monetary policy shock in the early 1980s and the big changes in the standard deviation of
the investment shock during the period of oil price shocks. Hence, the 1970s and the 1980s were
more volatile than the 1960s and the 1990s, creating a tougher environment for monetary policy.

Std. Dev. Inter. Shock +/- 2 Std. Dev.

Std. Dev. Intra. Shock +/- 2 Std. Dev.

2

2
0
-2

Log Diff. form S.S.

5
Log Diff. form S.S.

Log Diff. form S.S.

4

Std. Dev. Invest. Shock +/- 2 Std. Dev.

0

-5

1960 1970 1980 1990 2000

1960 1970 1980 1990 2000

Period
Std. Dev. Tech. Shock +/- 2 Std. Dev.

Period
Std. Dev. Mon. Shock +/- 2 Std. Dev.

1
0
-1
1960 1970 1980 1990 2000
Period

Log Diff. form S.S.

Log Diff. form S.S.

4
2

0

-2
1960 1970 1980 1990 2000

2

Burns-Miller

0

Volcker

-2

Greenspan

-4

Bernanke

-6
-8
1960 1970 1980 1990 2000

Period

Period

Figure 5.2: Smoothed standard deviation shocks to the intertemporal (bdt ) shock, the intratemporal

(b t ) shock, the investment-speci…c (b t ) shock, the technology (bAt ) shock, and the monetary policy
(bmt ) shock +/- 2 s.d.

One advantage of estimating a structural model is that we can use it to compute counterfactual
histories where we remove a source of variation in the data to measure its impact. With one of
these counterfactuals, we document our third main …nding. We measure that without changes
in volatility, the great moderation would have been noticeably smaller. The standard deviation
of in‡ation would have fallen by only 13 percent, the standard deviation of output growth would
have fallen by 16 percent, and the standard deviation of the federal funds rate would have fallen
by 35 percent, that is, only 33, 20, and 87 percent, respectively, of how much they actually fell.
This application has shown how SV is a fundamental element in our understanding of the
recent monetary history of the U.S. and how the methods presented in section 5 can be put to
good use in a developed economy. In the next section we show how SV is also important (perhaps
even more) for small, open emerging economies.
34

6. Application II: Small Open Economies
Now we summarize the results in Fernández-Villaverde et al. (2009) and show how changes in the
volatility of the real interest rate at which emerging economies borrow have a substantial e¤ect
on real variables like output, consumption, investment, and hours worked. These e¤ects appear
even when the level of the real interest rate itself remains constant.
To prove our case, we use the evidence of time-varying volatility in the real interest rates faced
by countries such as Argentina that we brie‡y showed in …gure 3 and that is documented formally
in Fernández-Villaverde et al. (2009). Then, we feed this time-varying process into an otherwise
standard small, open economy business cycle model calibrated to match the data from Argentina.
We …nd that an increase in real interest rate volatility triggers a fall in output, consumption,
investment, and hours worked, and a notable change in the current account. Hence, we show that
the time-varying volatility of real interest rates might be an important force behind the distinctive
size and pattern of business cycle ‡uctuations of emerging economies.
We do not o¤er a theory of why real interest rate volatility changes over time. Instead, we
model it as an exogenous process. Part of the reason is that an exogenous process focuses our
attention on the mechanism through which real interest rate risk shapes the trade-o¤s of agents in
small, open economies. More important, the literature has not developed, even at the prototype
level, an equilibrium model to endogenize these volatility shocks. Fortunately, the …ndings of
Uribe and Yue (2006) and Longsta¤ et al. (2007) justify our strategy. The evidence in both
papers is strongly supportive of the view that a substantial component of changes in volatility is
exogenous to the country. These results should not be a surprise because the aim of the literature
on …nancial contagion is to understand phenomena that distinctively look like exogenous shocks
to small open economies (Kaminsky et al., 2003).
6.1. The Model
We postulate a simple small, open economy model with incomplete asset markets. The economy
is populated by a representative household with preferences:
E0

1
X
t=0

t

Ct1 v
1 v

!

Ht1+
1+

:

(22)

Here, E0 is the conditional expectations operator, Ct denotes consumption, Ht stands for hours
worked, and

2 (0; 1) corresponds to the discount factor. The household can invest in two types
35

of assets: the stock of physical capital, Kt , and an internationally traded bond, Dt . We maintain
the convention that positive values of Dt denote debt. Then, the household’s budget constraint
is given by:
Dt+1
= Dt
1 + rt

Wt Ht

Rt Kt + Ct + It +

D

2

D)2

(Dt+1

(23)

where Wt represents the real wage, Rt stands for the real rental rate of capital, It is gross domestic
investment,

> 0 is a parameter that controls the costs of holding a net foreign asset position,

D

and D is a parameter that determines debt in the steady state. The cost, assumed to eliminate
the unit root otherwise built into the dynamics of the model, is paid to some foreign international
institution (for example, an investment bank that handles the issuing of bonds for the household).
We write the real interest rate faced by domestic residents in international markets at time t
as rt = r + "tb;t + "r;t : In this equation, r is the mean of the international risk-free real rate plus the
mean of the country-spread. The term "tb;t equals the international risk-free real rate subtracted
from its mean and "r;t equals the country-spread subtracted from its mean. Both "tb;t and "r;t
follow AR(1) processes:
"tb;t =

tb "tb;t 1

"r;t =
The standard deviations

tb;t

r "r;t 1

and

tb;t

=

1

tb

r;t

=

1

r

The parameters

tb

and

tb

r;t

tb
r

+e

+e

tb;t

r;t

utb;t ; where utb;t

ur;t ; where ur;t

N (0; 1)

(24)

N (0; 1)

(25)

also follow:

+

+

r

+

tb;t 1

tb

r;t 1

+

tb u

ru

r ;t

tb ;t

; where u

; where u

r ;t

tb ;t

N (0; 1)

(26)

N (0; 1)

(27)

control the degree of mean volatility and SV in the international

risk-free real rate. The same can be said about

and

r

r

and the mean volatility and SV in

the country spread. We call utb;t and ur;t innovations to the international risk-free real rate
and the country-spread, respectively. We call u

tb ;t

and u

r ;t

innovations to the volatility of the

international risk-free real rate and the country spread, respectively. Sometimes, for simplicity,
we call

tb;t

and

r;t

volatility shocks and u

tb ;t

and u

r ;t

The stock of capital evolves according to Kt+1 = (1
is the depreciation rate. The parameter

innovation to the volatility shocks.
)Kt + 1

2

It
It 1

2

1

It , where

> 0 controls the size of these adjustment costs. Finally,

the representative household is also subject to the typical no-Ponzi-game condition.

36

Firms rent capital and labor from households to produce output in a competitive environment
according to the technology Yt = Kt eXt Ht

1

where Xt =

x Xt 1

+ e x ux;t and ux;t

N (0; 1).

Firms maximize pro…ts by equating wages and the rental rate of capital to marginal productivities.
Thus, we can rewrite equation (23) in terms of net exports N Xt :
N X t = Yt

Ct

Dt+1
D
+
(Dt+1
1 + rt
2

It = Dt

D)2

6.2. Solving and Calibrating the Model
We solve the model by relying on perturbation methods. We want to measure the e¤ects of a
volatility increase (a positive shock to either u

r ;t

or u

tb ;t

), while keeping the interest rate itself

unchanged (…xing ur;t = 0 and utb;t = 0). Consequently, we need to obtain a third approximation
of the policy functions. As we saw in section 4, a …rst-order approximation to the model would miss
all of the dynamics induced by volatility because this approximation is certainty equivalent and
a second-order approximation would only capture the volatility e¤ect indirectly via cross product
terms of the form ur;t u

r ;t

and utb;t u

tb ;t

; that is, up to second-order, volatility does not have an

e¤ect as long as the real interest rate does not change. It is only in a third-order approximation
that the SV shocks, u

;t

and u

tb ;t

, enter as independent arguments in the policy functions with a

coe¢ cient di¤erent from zero. Furthermore, these cubic terms are quantitatively signi…cant.
To calibrate the model, we …rst estimate the process for the interest rate (24), (25), (26), and
(27) using EMBI+ data and a Bayesian approach and we set the parameters for the law of motion
of the real interest rate equal to the median of the posterior distributions. Then, we pick the
remaining parameters of the model by targeting some moments of the Argentinian economy. Our
calibration must target the moments of interest generated by the ergodic distributions and not
the moments of the deterministic steady state, since those last ones are not representative of the
stochastic dynamics.
6.3. Impulse Response Functions
Now we can analyze the IRFs of shocks to the country spreads and their volatility. In …gure 6.1, we
plot the IRFs to these shocks (rows) of consumption (…rst column), investment (second column),
output (third column), labor (fourth column), the interest rate (…fth column), and debt (the sixth
column). Interest rates are expressed in basis points, while all other variables are expressed as
percentage deviations from the mean of their ergodic distributions (computed by simulation).

37

Figure 6.1: IRFs Argentina

The …rst row of panels plots the IRFs to a one-standard-deviation shock to the Argentinean
country spread, ur;t . Following an annualized rise of 385 basis points (that corresponds to an
increase of nearly 33 basis points at a monthly rate) in Argentina’s spread, the country experiences
a persistent contraction, with consumption dropping 3.20 percent upon impact and investment
falling for seven quarters. Furthermore, the decline in output is highly persistent: after 16 quarters,
output is still falling (at that time it is -1.16 percent below its original level). Labor starts by
slightly increasing (due to the negative wealth e¤ects) but later falls (by a very small margin
given our preferences) due to the reduction in investment and the subsequent decrease of marginal
productivity. Debt falls for 14 quarters, with a total reduction of nearly 19 percent of the original
value of the liability. The intuition for these movements is well understood. A higher rt raises
the service payment of the debt, reduces consumption, forces a decrease in the level of debt (since
now it is more costly to …nance it), and lowers investment through a non-arbitrage condition
between the returns to physical capital and to foreign assets. This exercise shows that our model
delivers the same answers as the standard model when hit by equivalent level shocks and to place
in context the size of the IRFs to volatility shocks.
The second row of panels plots the IRFs to a one-standard-deviation shock to the volatility
of the Argentinean country spread, u ;t . To put a shock of this size in perspective, we estimate
that the collapse of LTCM in 1998 meant a positive volatility shock of 1.5 standard deviations
and that the 2001 …nancial troubles amounted to two repeated shocks of roughly 1 standard
deviation. First, note that there is no movement on the domestic interest rate faced by Argentina
or its expected value. Second, there is a) a contraction in consumption, b) a decrease of investment,
c) a slow fall in output, d) labor increases slightly to fall later, and e) debt shrinks upon impact
38

and keeps declining until it reaches its lowest level, roughly three and a half years after the shock.
These IRFs show how increments in risk have real e¤ects on the economy even when the real
interest rate remains constant.
The intuition is as follows. Small, open economies rely on foreign debt to smooth consumption
and to hedge against idiosyncratic productivity shocks. When the volatility of real interest rates
rises, debt becomes riskier as the economy becomes exposed to potentially fast ‡uctuations in the
real interest rate and their associated and unpleasant movements in marginal utility. To reduce
this exposure, the economy lowers its outstanding debt by cutting consumption. Moreover, since
debt is suddenly a worse hedge for the productivity shocks that drive returns to physical capital,
investment falls. A lower investment also reduces output. Interestingly enough, we do not have
any of the real-option e¤ects of risk emphasized by the literature, for example, when we have
irreversibilities (Bloom, 2009). Introducing those e¤ects would increase the impact of shocks to
volatility on investment. Thus, our results are likely to be a lower bound to the implications of
time-varying risk.

7. What We Know and What We Do Not Know About Volatility
We arrive now towards the end of our long trip and it seems a …tting conclusion to take stock and
enumerate what we know and what we do not know about volatility.
If we try to summarize what we know, we can venture three lessons. First, there is strong
evidence that, in many contexts, time series experience time-varying volatility and that an understanding of the behavior of the data requires in consequence an understanding of the behavior
of the volatility changes. Second, it is easy to write DSGE models in which volatility changes
over time and in which we can measure the impact of these variations in risk. Third, there are a
number of contexts where these variations in risk seem su¢ ciently important from a quantitative
perspective as to deserve a more careful consideration.
On the other hand, there are also plenty of issues that we do not understand. First, and
foremost, we do not have a good explanation of why aggregate volatility changes over time. In the
models that we presented in this chapter, SV was assumed as exogenous. In some more involved
models (for instance, where monetary and …scal policy changes), part of the time-variation in
volatility can be endogeneized but, at the same time, it is often the case that the question of
why volatility changes is just pushed one step back to some unexplained change in policy. It is
fair to note that macroeconomics, in general, lacks a very solid theory of why we have shocks,
39

either technological, preferences or any other. Much progress has been made just by investigating
the consequences of a given exogenous shock without too much attention to its origins. By
analogy, much progress may still be made by investigating the consequences of volatility shocks.
Second, we do not fully understand many of the theoretical properties of models with SV. Just
as an example, we do not have theorems regarding the di¤erentiability of the decision rules with
respect to the relevant components of SV beyond some simple cases. Third, there are still many
questions regarding the best computational and empirical strategies to take these models to the
data, including the best speci…cations for the structure of the changes of volatility over time.
Finally, we know very little about the implications of volatility for optimal policy design.
But, fortunately, we do not see this lack of understanding as a fundamental problem but
as a challenge to motivate research for many years to come. We expect to see much work on
documenting and measuring the changes in volatility over time, on working out models that
generate variations in risk in an endogenous way, and on assessing the implications for policy.

References
[1] Aït-Sahalia, Y., L.P. Hansen, and J.A. Scheinkman (2009). “Operator Methods for
Continuous-Time Markov Processes.”In Y. Aït-Sahalia and L.P. Hansen (eds.), Handbook of
Financial Econometrics, North Holland.
[2] An, S. and F. Schorfheide (2006). “Bayesian Analysis of DSGE Models.”Econometric Reviews
26, 113-172.
[3] Arellano, C., Y. Bai, and P.J. Kehoe (2010). “Financial Markets and Fluctuations in Uncertainty.”Mimeo, Federal Reserve Bank of Minneapolis.
[4] Aruoba, S.B., J. Fernández-Villaverde, and J. Rubio-Ramírez (2006). “Comparing Solution
Methods for Dynamic Equilibrium Economies.”Journal of Economic Dynamics and Control
30, 2477-2508.
[5] Bachmann, R., S. Elstner, and E. Sims (2010). “Uncertainty and Economic Activity: Evidence from Business Survey Data.”NBER Working Paper 16143.
[6] Bekaert, G., M. Hoerova, M. and M. Lo Duca (2010). “Risk, Uncertainty and Monetary
Policy.”Mimeo, Columbia University.
[7] Benati, L. and P. Surico (2009). “VAR Analysis and the Great Moderation.”American Economic Review 99, 1636-1652.
[8] Blanchard, O.J. and J. Simon (2001). “The Long and Large Decline in U.S. Output Volatility.”Brookings Papers on Economic Activity 2001-1, 187-207.
40

[9] Bloom, N. (2009). “The Impact of Uncertainty Shocks.”Econometrica 77, 623–685.
[10] Bloom, N., N. Jaimovich, N., and M. Floetotto (2008). “Really Uncertain Business Cycles.”
Mimeo, Stanford University.
[11] Bollerslev, T. (1986). “Generalized Autoregressive Conditional Heteroskedasticity.” Journal
of Econometrics 31, 307-327.
[12] Bollerslev, T. (2010). “Glossary to ARCH (GARCH)” in Volatility and Time Series Econometrics Essays in Honor of Robert Engle. Mark Watson, Tim Bollerslev and Je¤rey Russell
(eds.), Oxford University Press.
[13] Chari, V.V., L.J. Christiano, and P.J. Kehoe (1994), “Optimal Fiscal Policy in a Business
Cycle Model.”Journal of Political Economy 102, 617-652.
[14] Christiano, L., M. Eichenbaum, and C.L. Evans (2005). “Nominal Rigidities and the Dynamic
E¤ects of a Shock to Monetary Policy.”Journal of Political Economy 113, 1-45.
[15] Christiano, L., R. Motto, and M. Rostagno (2009). “Financial Factors in Economic Fluctuations.”Mimeo, Northwestern University.
[16] Clarida, R., J. Galí, and M. Gertler (2000). “Monetary Policy Rules and Macroeconomic
Stability: Evidence and Some Theory.”Quarterly Journal of Economics 115, 147-180.
[17] Cogley, T. and T.J. Sargent (2005). “Drifts and Volatilities: Monetary Policies and Outcomes
in the Post WWII U.S.”Review of Economic Dynamics 8, 262-302.
[18] Diebold, F.X. (1986). “Modeling the Persistence of Conditional Variances: A Comment.”
Econometric Reviews 5, 51-56.
[19] Dynan, K.E., D.W. Elmendorf, and D.E. Sichel (2006). “Can Financial Innovation Help to
Explain the Reduced Volatility of Economic Activity?”Journal of Monetary Economics 53,
123-150.
[20] Elder, J. (2004a). “Some Empirical Evidence on the Real E¤ects of Nominal Volatility.”
Journal of Economics and Finance 28, 1-13.
[21] Elder, J. (2004b). “Another Perspective on the E¤ects of In‡ation Uncertainty.” Journal of
Money, Credit and Banking 36, 911-928.
[22] Engle, R.F. (1982). “Autoregressive Conditional Heteroskedasticity With Estimates of the
Variance of UK In‡ation.”Econometrica 50, 987-1008.
[23] Engle, R.F. and V.K. Ng (1993). “Measuring and Testing the Impact of News on Volatility.”
Journal of Finance 48, 1749-1778.
[24] Fatás, A. (2002). “The E¤ects of Business Cycles on Growth.” in Norman Loayza and
Raimundo Soto (eds), Economic Growth: Sources, Trends and Cycles. Central Bank of Chile.
41

[25] Fernández-Villaverde, J. (2010). “The Econometrics of DSGE Models.”SERIES: Journal of
the Spanish Economic Association 1, 3-49
[26] Fernández-Villaverde, J. and J. Rubio-Ramírez (2004). “Comparing Dynamic Equilibrium
Models to Data: A Bayesian Approach.”Journal of Econometrics, 123, 153-187.
[27] Fernández-Villaverde, J. and J. Rubio-Ramírez (2005). “Estimating Dynamic Equilibrium
Economies: Linear Versus Nonlinear Likelihood.”Journal of Applied Econometrics, 20, 891910.
[28] Fernández-Villaverde, J. and J. Rubio-Ramírez (2007). “Estimating Macroeconomic Models:
A Likelihood Approach.”Review of Economic Studies 74, 1059-1087.
[29] Fernández-Villaverde, J., P. Guerrón-Quintana, and J. Rubio-Ramírez (2010a). “Fortune or
Virtue: Time-Variant Volatilities Versus Parameter Drifting in U.S. Data.” NBER Working
Paper 15928.
[30] Fernández-Villaverde, J., P. Guerrón-Quintana, and J. Rubio-Ramírez (2010b). “Reading the
Recent Monetary History of the U.S., 1959-2007” Federal Reserve Bank of St. Louis Review
92, 311-338.
[31] Fernández-Villaverde, J., P.A. Guerrón-Quintana, J. Rubio-Ramírez, and Martín Uribe
(2009). “Risk Matters: The Real E¤ects of Volatility Shocks.” American Economic Review,
forthcoming.
[32] Fountas, S. and M. Karanasos (2007). “In‡ation, Output Growth, and Nominal and Real
Uncertainty: Empirical Evidence for the G7.” Journal of International Money and Finance
26, 229-250.
[33] Grier, K.B. and M.J. Perry (2000). “The E¤ects of Real and Nominal Uncertainty on In‡ation
and Output Growth: Some GARCH-M Evidence.”Journal of Applied Econometrics 15, 4558.
[34] Guerrón-Quintana, P. (2009). “Money Demand Heterogeneity and the Great Moderation
External Link.”Journal of Monetary Economics 56, 255-266.
[35] Goodfriend, M. and R. King (2007). “The Incredible Volcker Disin‡ation.”Journal of Monetary Economics 52, 981-1015.
[36] Hamilton, J. (2008). “Macroeconomics and ARCH.” Mimeo, University of California-San
Diego.
[37] Haavelmo, T. (1994). “The Probability Approach in Econometrics.” Econometrica 12 (Supplement), iii-vi+1-115.
[38] Jin, H. and K.L. Judd (2002). “Perturbation Methods for General Dynamic Stochastic Models.”Mimeo, Hoover Institution.
42

[39] Justiniano A. and G.E. Primiceri (2008). “The Time Varying Volatility of Macroeconomic
Fluctuations.”American Economic Review 98, 604-641.
[40] Kaminsky, G.L., C.M. Reinhart and C.A. Vegh (2003). “The Unholy Trinity of Financial
Contagion.”Journal of Economic Perspectives 17, 51-74.
[41] Khan, M. S. (1977). “The Variability of Expectations in Hyperin‡ations.”Journal of Political
Economy 85, 817-827.
[42] Kim, C. and C.R. Nelson (1998) “Has the U.S. Economy Become More Stable? A Bayesian
Approach Based on a Markov-Switching Model of the Business Cycle.”Review of Economics
and Statistics 81, 608-616.
[43] Klein, B. (1977). “The Demand for Quality-Adjusted Cash Balances: Price Uncertainty in
the U.S. Demand for Money Function.”Journal of Political Economy 85, 692-715.
[44] Künsch, H.R. (2005). “Recursive Monte Carlo Filters: Algorithms and Theoretical Analysis.”
Annals of Statistics 33, 1983-2021.
[45] Kydland, F., and E. C. Prescott (1982). “Time to Build and Aggregate Fluctuations.”Econometrica 50, 1345–1370.
[46] Lee, K., S. Ni, and R. Ratti (1995). “Oil Shocks and the Macroeconomy: The Role of Price
Variability.”Energy Journal 16, 39-56.
[47] Longsta¤, F.A., J. Pan, L.H. Pedersen, and K.J. Singleton (2007). “How Soverign Is Sovereign
Credit Risk?”Mimeo.
[48] Lubick, T. and F. Schorfheide (2004). “Testing for Indeterminacy: An Application to U.S.
Monetary Policy.”American Economic Review 94, 190-217.
[49] McConnell, M.M. and G. Pérez-Quirós (2000). “Output Fluctuations in the United States:
What Has Changed Since the Early 1980’s?”American Economic Review 90, 1464-1476.
[50] Mendoza, E. (1991). “Real Business Cycles in a Small Open Economy.”American Economic
Review 81, 797-818.
[51] Mendoza, E. (1995). “The Terms of Trade, the Real Exchange Rate, and Economic Fluctuations.”International Economic Review 36, 101-37.
[52] Nelson, D.B. (1991). “Conditional Heteroskedasticity in Asset Returns: A New Approach.”
Econometrica 59, 347-370.
[53] Ricardo, D. (2005). The Works and Correspondence of David Ricardo, Vol. 5: Speeches and
Evidence. Edited by Piero Sra¤a with the Collaboration of M.H. Dobb. Indianapolis, Liberty
Fund.

43

[54] Santos, M.S. and A. Peralta-Alva (2005). “Accuracy of Simulations for Stochastic Dynamic
Models”. Econometrica 73, 1939-1976.
[55] Schmitt-Grohé, S., and M. Uribe (2004). “Solving Dynamic General Equilibrium Models Using a Second-Order Approximation to the Policy Function.”Journal of Economic Dynamics
and Control 28, 755-775.
[56] Sentana, E. (1995). “Quadratic ARCH Models.”Review of Economic Studies 62, 639-661.
[57] Shephard, N. (2008). “Stochastic Volatility.” The New Palgrave Dictionary of Economics.
Palgrave MacMillan.
[58] Sims, C.A. and T. Zha (2006). “Were There Regime Switches in U.S. Monetary Policy?”
American Economic Review 96, 54-81.
[59] Stock, J.H. and M.W. Watson (2002). “Has the Business Cycle Changed, and Why?”NBER
Macroeconomics Annual 17, 159-218.
[60] Uribe M., and V. Yue (2006). “Country Spreads and Emerging Countries: Who Drives
Whom?”Journal of International Economics 69, 6-36.
[61] Zakoïan, J.-M. (1994). “Threshold Heteroskedastic Models.”Journal of Economic Dynamics
and Control 18, 931-955.

44

