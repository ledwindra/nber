NBER WORKING PAPER SERIES

OPTIMAL PORTFOLIO CHOICE WITH WAGE-INDEXED SOCIAL SECURITY
Jialun Li
Kent Smetters
Working Paper 17025
http://www.nber.org/papers/w17025

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2011

This research was supported by the U.S. Social Security Administration through a grant to the National
Bureau of Economic Research as part of the SSA Retirement Research Consortium. The findings and
conclusions expressed are solely those of the author(s) and do not represent the views of SSA, any
agency of the Federal Government, or the NBER. This paper is based, in part, on an earlier project
with Ying Chen.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2011 by Jialun Li and Kent Smetters. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.

Optimal Portfolio Choice with Wage-Indexed Social Security
Jialun Li and Kent Smetters
NBER Working Paper No. 17025
May 2011
JEL No. G11,H0
ABSTRACT
This paper re-examines the classic question of how a household should optimally allocate its portfolio
between risky stocks and risk-free bonds over its lifecycle. We show that allowing for the wage indexation
of social security benefits fundamentally alters the optimal decisions. Moreover, the optimal allocation
is close to observed empirical behavior. Households, therefore, do not appear to be making large "mistakes,"
as sometimes believed. In fact, traditional financial planning advice, as embedded in "target date"
funds – whose enormous recent growth has been encouraged by new government policy – often leads
to even relatively larger "mistakes" and welfare losses.

Jialun Li
3620 Locust Walk
Philadelphia, PA 19104
jialunli@wharton.upenn.edu
Kent Smetters
University of Pennsylvania
SH-DH 3303
3620 Locust Walk
Philadelphia, PA 19104
and NBER
smetters@wharton.upenn.edu

1 Introduction
A considerable literature has examined how households should optimally allocate their savings between stocks and bonds over their lifecycle. Samuelson (1969) and Merton (1969)
first addressed this problem in discrete and continuous time, respectively, assuming complete
markets without labor income. Merton (1971) then introduced deterministic labor income
into the continuous time framework while Bodie, Merton and Samuelson (1992) allowed for
it to be elastically supplied. In more recent years, attention has shifted toward examining how
the presence of uninsurable labor income risk and uncertain lifespans might impact savings
and portfolio allocations over the life cycle.1
It is well known, though, that the actual portfolio decisions made by households are not
consistent with standard expected-utility model. Households could, therefore, be making
large mistakes and suffering significant welfare losses.
The standard expected utility model predicts a very high stock allocation (near 100% or
even exceeding it2 ) early in life that declines with age as human capital depreciates. When
a simple representation of a social security system is included in the model, the optimal
allocation is then often “U shaped” in age, caused by an inflection point that emerges at the
point of retirement.3 The homotheticity property of the standard model also leads to a similar
lifetime stock-bond allocation across varying levels of permanent income.4
In contrast, the actual empirical evidence suggests three stylized facts: (I) the portfolio
share in equities is much less than 100% for most households; (II) the portfolio’s equity share
tends to be “hump shape” (∩) in age; and (III) the lifetime poor tend to invest less in equities
than richer households.5
1
See Bertaut and Haliassos (1997); Gakidis (1998); Storesletten, Telmer, and Yaron (2000, 2007); Viceira
(2001); Bodie, Detemple, and Walter (2004); Benzoni, Collin-Dufresne and Goldstein (2004); Cocco, Gomes and
Maenhout (2005) and Gomes and Michaelides (2005). Related papers by Balduzzi and Lynch (1997), Brennan
and Xia (1998), Campbell and Viceira (1999), and Kim and Omberg (1996) study the effects caused by the
changes of riskfree interest rate or equity premium over the time. Carroll (2002) and Campbell and Cochrane
(1999) propose models in which risk aversion varies with wealth.
2
See, for example, Ayres and Nalebuff (2008).
3
These models tie the social security benefit to an individual’s final year of earnings prior to retirement to
simplify the state space. That background risk is suddenly eliminated upon reaching retirement, creating an
immediate reversal of the allocation.
4
The homothetic property, however, is the easiest to break by including borrowing constraints or a social
security system with a flat benefit that does not scale to permanent income.
5
See Ameriks and Zeldes 2000, Heaton and Lucas 2000, and Poterba and Samwick, 2002.

1

Several modifications to the standard model have been proposed in the past to deal with or
more of these empirical facts. These alterations include the addition of liquidity constraints
(Brown 1990; Ameriks and Zeldes 2000), saving for illiquid assets such as a house (Faig
and Shum 2002), habit persistence utility (Polkovnichenko, 2007), and, incomplete trading
markets between generations in a real business cycle economy where wages and stock returns
are perfectly correlated (Storesletten, Telmer, and Yaron, 2007).
The current paper returns to the standard expected utility framework and simply considers the impact of a more detailed modeling of the social security system. For a majority
U.S. households, the U.S. Social Security program is their largest source of retirement income (Social Security Administration 2002). Incorporating the key details of the system,
therefore, could be quite important.
One key feature that has been missing in previous analyses is the wage-indexation of
social security benefits. (We also more fully model the progressive nature of benefits.) In
particular, when determining a pensioner’s initial benefit level at retirement, the retiree’s past
wages are adjusted upward by wage-indexed factors that track the growth in the economywide average wage over time. Wage indexation is, therefore, naturally exposed to some
of the same productivity shocks that influence stock returns over long periods of time. Even
though a single person’s own wage, which includes all sorts of idiosyncratic shocks, is poorly
correlated with stock returns, the economy-wide average wage is empirically more highly
correlated, especially over the longer periods of time that are most relevant for computing social security benefits. Wage indexation, therefore, causes a potentially strong low-frequency
correlation with stock returns for young savers, which becomes less correlated as they age.
The presence of this large unchosen wage-indexed pension asset, as we show, fundamentally
alters the household decision rules over their lifecycle.
Our study focuses on the “optimal” lifecycle portfolio allocation (normative analysis).
Our intention is not to explain the empirical evidence per se (positive analysis). Nonetheless,
it is interestingly that the optimal allocations that we find are not so different from actual
empirical behavior under reasonable parameter assumptions. In fact, we find that the “errors”
being made by households often produce smaller welfare losses in our model relative to
the standard advice given by financial planners. This standard advice has been recently
2

incorporated into popular “target date" mutual funds. These funds have grown enormously
in popularity during the past six years, encouraged by recent government policy. While this
policy might improve welfare for some households, it appears to decrease it for many others.

2 Empirical Evidence
Although our study primarily focuses on determining the optimal stock-bond portfolio over
the lifecycle, it is helpful to start with an overview of the actual behavior of U.S. households
as background. The Survey of Consumer Finances (SCF) is generally considered the best
data source for reporting the financial wealth of U.S. families. It provides comprehensive
coverage of different measures of wealth as well as key characteristics (age, education, etc.)
that tend to be correlated with wealth. The SCF is conducted every three years with different
families; we report evidence from sample in 2004.6 However, as Ameriks and Zeldes (2000)
warn, the exact magnitude of these estimates should be taken with a “grain of salt” due to
data definitions and other issues. Appendix A describes the definitions and variables from
SCF 2004 that we use in our empirical estimation.
Figure 1 reports the average (mean) percent of a household’s portfolio invested in risky
stocks by age for families in which the “household head” (primary earner) falls into one of
three different education groups: “No High School” education; with “High School” education only; with “College” education. Households are grouped into five-year “age buckets” in
order to increase the sample size per cell. Figure 1 reveals the three key stylized facts: (I) the
portfolio share in equities is much less than 100% for most households; (II) the portfolio’s
equity share tends to be “hump shape” (∩) in age; and (III) the lifetime poor tend to invest
less in equities than richer households.
Figure 2 reports the average of total wealth relative to total (labor) income for these
same education groups, respectively. Overall, wealth-income ratios increase with age and
education. The age-shape of the accumulation profiles also suggest a significant bequest
motive that is increasing in the education class. However, the exact steepness post-retirement
6

The SCF is a non-panel data dataset that uses a dual-frame sample design. One part is selected to obtain a
sufficiently large and unbiased sample. The other part is designed to disproportionately select wealthier families.
We use the provided weights to adjust the unequal probabilities of selection in the survey and for nonresponse.

3

Figure 1: Stock Allocation from SCF2004

Figure 2: Wealth/Income Ratio from SCF2004

4

should also be taken with a “grain of salt” due to potential survivor bias where wealthier
households tend to live longer on average.
We calibrate our model across different education groups using the population weighted
average wealth-income ratios presented in Figure 2. We then report how our resulting simulated portfolio allocations compare with the evidence shown in Figure 1. This approach to
calibration purposely reduces our ability to pick the model’s deep structural parameters in
order to try to simply match Figure 1. We will demonstrate that the stylized facts presented
in Figure 1 are potentially quite consistent with optimal decision rules within a standard
expected utility framework that is augmented with a wage-indexed social security system.

3 Specification of the Model
We now present a lifecycle portfolio choice model with standard preferences where households face uncertain wage earnings. Individuals make their consumption, saving and portfolio decisions over risk-free bonds and risky stocks at the beginning of each period. Their
savings and portfolio choices are motivated by three main factors: precautionary savings in
the presence of incomplete insurance markets; consumption needs during retirement; and, a
joy-of-giving desire to leave a bequest. Individuals also pay a mandatory social security tax
during their working years in exchange for a benefit during retirement.

3.1 Preferences
Each individual i works from age t0 to retirement age M . The maximum length of life is
T and pt is the probability that the individual is still alive at age t + 1 conditional on being
alive at age t. Preferences take the standard Constant Relative Risk Aversion (CRRA) form
and are additively separable over time. The household’s maximum expected utility at t0 is
⎛
⎞Ã
!
1−γ
1−γ
T
t−2
X
Y
C
W
i,t
i,t
+ b(1 − pt−1 )
max Et0
β t−t0 ⎝
pj ⎠ pt−1
(1)
1
−
γ
1
−
γ
t=t
0

j=t0 −1

where β < 1 is the weight placed on future utility, Ci,t is i’s consumption at age t, and γ

is the coefficient of relative risk aversion. Wi,t is the wealth (bequest) left at the time of the
death where b represents the intensity of the bequest motive.

5

3.2 Financial Assets
Investors have access to two investment instruments: risk-free bonds and risky stocks. The
riskless bonds pay a constant gross real return Rf , while the risky asset pays a gross real
return RtS :
RtS = Rf + μ + η t

(2)

where μ is the deterministic equity premium and η t is the innovation to this excess return
at time t. η t is independently and identically distributed (i.i.d.) over time and normally
distributed N(0, σ η ).

3.3 Labor Income
Similar to Carroll (1997), Gourinchas and Parker (2002), Cocco, Gomes and Maenhout
(2005), and several other papers, exogenous labor income for agent i at time t is modeled as
Yi,t = exp(yi,t ) with probability 1 − λ
= 0

with probability λ

(3)
(4)

where λ is the probability of being unemployed. Before retirement, log income is composed
of three terms:
yi,t = g(t, Fi,t ) + ω i,t + zi,t

(5)

where g(t, Fi,t ) is a deterministic function of age t and other individualistic characteristics
Fi,t . The term ωi,t is an idiosyncratic i.i.d. normally distributed shock N (0, σ ω ). The
variable zi,t is a permanent first-order autoregressive shock:
zi,t = θzi,t−1 + ξ t + φi,t

(6)

with an autocorrelation coefficient equal to θ, an aggregate (economy-wide) component ξ t
distributed i.i.d. N(0, σ ξ ), and an idiosyncratic component φi,t distributed i.i.d. N (0, σ φ ).
We also allow the correlation between the innovation to excess stock returns η t and the
aggregate labor income shock ξ t to equal ρξη so that η t and ξ t are jointly bivariate distributed

6

(see Appendix B).
Individuals pay a flat social security tax rate of τ SS through their working years plus a
nonlinear labor income tax rate τ w that is calibrated below. The (net of tax) disposable labor
income at time t for individual i, therefore, is:
d
= (1 − τ SS )(1 − τ w [Yi,t ])Yi,t for t < M
Yi,t

(7)

= 0 for t ≥ M

3.4 Wage-Indexed Social Security
In the United States, a retiree’s initial Social Security benefit level is calculated by first multiplying each year of his or her previous wage by the relevant wage-indexed factor. This
factor tracks the average wage growth experienced across the entire economy since the year
in which that particular wage was earned. For example, suppose that you retired today and
you earned $30,000 twenty years ago. Also suppose that the average wage in the economy
grew on average 5% (nominal) per year during the past 20 years. Your recorded wage of
$30,000 would, therefore, be multiplied upward by a factor of 1.0520 = 2.65, to create a
wage representation of $79,598.93 today. Similar wage factors are applied to each of your
other previous wages. Your individual Average Indexed Yearly Earnings (AIYE) is then set
equal to the average of these adjusted wages.7 Progressivity is then introduced by calculating
your Primary Insurance Amount (PIA) using a nonlinear (convex) function of your AIYE.
Your PIA then forms the basis of your Social Security benefit amount before some additional
adjustments are made (e.g., a spousal benefit).8
Empirically, these wage-index factors are highly correlated with stock returns over time.
At first glance, this fact might be surprising since wages and stock returns are not highly
correlated at “high frequency" (e.g., yearly) even at the sectorial level where some of the
idiosyncratic component has already been removed (e.g., Davis and Paul 2000). However,
7
Technically speaking, in the United States, this calculation is done at monthly (not yearly) frequency to
calculuate the Average Indexed Monthly Earnings (AIME). Moreover, only the best “best 35” years of earnings
– those with the larged adjusted wages – are included in the AIME. We ignore these finer details in order to keep
the state space more manageable. The U.S. system also has a cap on yearly wages subject to the payroll tax, and
the AIME is, therefore, calculated over capped wages. Our calculations include this cap.
8
Individuals with a larger AIYE receive a larger PIA, thereby recognizing that they paid more into the system.
However, the PIA / AIYE ratio – the “replacement rate” – is a declining function of the AIYE so that the lifetime
poor receives a relatively larger replacement rate of their previous earnings.

7

idiosyncratic (including sector-specific) risks tend to cancel inside of the economy-wide average wage-index factor used by Social Security. Moreover, wage factors are often calculated
at a very “low frequency,” especially for wages earned early in the lifecycle. The economywide average wage and stock returns are much more highly correlated at this low frequency
(Jermann, 1999).9
Returning to our model framework, social security benefits received at the point of retirement at age M are a function of an individual’s Average Indexed Yearly Earnings (AIYE)
during their working years. The AIYE is calculated by adjusting upward each wage earned
by individual i during the previous year t by the growth in the aggregate (economy-wide)
average wage between year t and the retirement year, M . Denote YtA as the aggregate average wage level at time t. The appropriate wage index adjustment factor for wages earned
in year t, therefore, equals

A
YM
,
YtA

which is the cumulative growth in aggregate wages between

times t and M . Individual i’s AIYE at the point of retirement, therefore, is equal to the sum
of all previous wages adjusted upward by their respective wage index factors, divided by the
number of working years:

YA

Y i,M

YA

YA

t0 +1

M−1

=

Yi,t0 YMA + Yi,t0 +1 Y AM + · · · + Yi,M−1 Y AM

=

µµ
YA
Yi,t0 Yt0A+1 + Yi,t0 +1

t0

t0

M − t0
¶

YtA+2
0

YtA+1
0

M − t0

(8)

¶

+ Yi,t0 +2 · · ·

The aggregate wage level is modeled as a first-order autoregressive process with a unitroot in logs:
A
= YtA · exp ξ t+1
Yt+1

(9)

which we can rewrite as:
A
Yt+1
= exp ξ t+1
YtA

(10)

We can then track individual i’s AIYE at each age based on his AIYE in the previous age
9

This result is consistent with a neoclassical model with shocks to productivity and depreciation.

8

with the additional of just one state variable:
Y i,t+1 =

(t − t0 )Y i,t · exp ξ t+1 + Yi,t+1
t − t0 + 1

(11)

Social security benefits at retirement, therefore, are a function of individual i’s AIYE:
¢
¡
SSi,t = Q Y i,M for t ≥ M
= 0 for t < M

where Q() is a nonlinear function calibrated to the U.S. Social Security system (discussed
below).
The correlation between the aggregate average wage and stock returns, therefore, is
ρξη =

cov(ξ t ,η t )
σξ ·σ η .

However, the correlation between individual i’s (log) wage and stock

returns is approximately one-fourth of the size due to additional idiosyncratic risk that is
present in the individuals wage:
ρyη =

cov (ξ t , η t )
cov (ξ t , ηt )
cov (ξ t , η t )
q
q
≈
=
4 · σξ · ση
σ η · 16 · σ 2ω
σ η · σ 2ξ + σ 2φ + σ 2ω

The distinction between these correlations allows us to increase the aggregate average wage
correlation with stocks (without the idiosyncratic terms) to a larger low-frequency value
while preserving a much smaller correlation value that households individually face at high
frequency (with idiosyncratic terms).10

3.5 Optimization Problem
As in several previous papers, we treat the share of income spent on housing, ht , as an
“above-the-line” expense (in both model and data) that exogenously reduces disposable income. In each period t, individual i has some “cash on hand” denoted as Xi,t , which is
composed of the following resources: wealth Wi,t at the beginning of each period (which is
equal to the bequest in the case of death), plus disposable income net of housing expenditures
10

The aggregate average wage correlation with stocks will, therefore, also be large even at a high frequency.
However, as described in the text, any individual household’s wage contains idiosyncractic components that
substantially reduce its own high frequency correlation with stock returns. Only wage-indexed factors and stock
returns are highly correlated at low frequency for households.

9

received before retirement, plus social security benefits (after retirement):
d
+ SSi,t
Xi,t = Wi,t + (1 − ht )Yi,t

(12)

Given the cash on hand at time t, individual i then jointly decides how much to consume Ci,t
and the share of the residual savings, Xi,t − Ci,t , that is invested into risky equities versus
risk-free bonds. Denote αi,t as the proportion invested into the risky asset; hence, (1 − αi,t )
is the share invested into risk-free bonds. We assume αi,t ∈ [0, 1], so that the allocation into
bonds and stocks has to be non-negative during any period.11
For calibration purposes, we allow the investment return to be taxed at a rate τ d . Ri,t
denotes the total gross real return on the portfolio at time t. When the net stock return is
S > 1, the investor is taxed on both asset classes; otherwise, only the risk-free
positive Ri,t

asset is taxed:12
Ri,t =

£
¤
S
S
αi,t · Ri,t
+ (1 − αi,t ) · Rf − 1 · (1 − τ d ) + 1 for Ri,t
>1

(13)

S
S
+ (1 − αi,t ) · [(Rf − 1) · (1 − τ d ) + 1] for Ri,t
≤1
= αi,t · Ri,t

Putting these pieces together, the amount of wealth in the following period t + 1 equals13
Wi,t+1 = Ri,t (Xi,t − Ci,t )

(14)

©
ª
The model, therefore, has four state variables, t, Xi,t , zi,t , Y i,t+1 , along with two age-

indexed control variables: {Ci,t , αi,t }Tt=t0 .14 Individual i’s maximization problem can be
11
A short position in equities (α < 0) would expose agent i to potentially unbounded losses, a risk that would
never be taken under the Inada conditions implied by CRRA utility. However, a short position in bonds (α > 1)
is possible (with a low CRRA parameter γ and a large enough equity premium η) provided that unemployement
risk where zero (λ = 0) so there is some present value of “safe” future labor income.
12
Thus, we take a conservative view on the value of the carry forward provisions in the tax law for loss offsets.
13
In some simulation results not reported herein, we imposed the constraint that the total amount of saving
invested into the risky asset αi,t (Xi,t − Ci,t ) exceed a minimum threshold m in each period of life. This
constraint is potentially relevant for households without access to employer-based defined-contribution plans.
However, this constraint did not seem to materially impact our key results.
14
Despite our choice of homothetic utility, our model is not homogenous of degree 1 due to the presence
of nonlinear fiscal policies. We, therefore, cannot drop the current state of income. We must also track the
household’s average wage.

10

restated recursively as follows
Vi,t (Xi,t , zi,t ) = max

Ci,t ,αi,t

(

"
!#)
Ã
(Ci,t )1−γ
(Wi,t+1 )1−γ
+ βEt pt · Vi,t+1 (Xi,t+1 , zi,t+1 ) + b(1 − pt ) ·
1−γ
1−γ
(15)

subject to15
αi,t ∈ [0, 1]

(16)

d
+ SSi,t
Xi,t+1 = Ri,t (Xi,t − Ci,t ) + (1 − ht+1 )Yi,t+1

(17)

3.6 Numerical Solution
This maximization problem cannot be solved analytically. So numerical dynamic programming methods are used. We pay a considerable amount of attention to “implementation
details" in order to ensure that our results produced small Euler errors away from boundaries
(Appendix C), which is ultimately the best way to double-check the accuracy of the results.
The model is solved using backward iteration over the time (that is, age) dimension
to derive the policy functions Ci,t (Xi,t , zi,t , Y i,t+1 ) and αi,t (Xi,t , zi,t , Y i,t+1 ).The continuous state space is approximated using a power-spaced discrete grid. The value of the function Vi,t+1 must be approximated between grid points across the three non-time dimensions:
Schumaker shape-preserving quadratic splines are used for interpolating within the cash-onhand dimension while bilinear interpolation is inside the other two dimensions.16 There exist
three labor income shocks (ω i,t , ξ t and φi,t ) as well as uncertainty in excess stock returns η t .
Gauss-Hermite quadrature is used for the numerical integration to compute the expectations.
However, since the innovations to stock returns are allowed to be correlated with an aggre15
We also require that total savings at time t be positive (i.e., (Xi,t − Ci,t ) > 0) to prevent any attempt to
borrow against the “safe” portion of future labor income or social security benefits. To be sure, this constraint
should also never bind for households before retirement under the Inada conditions. The reason is that, under our
distributional assumptions, the individual i’s labor income in any year could be zero, as could the aggregate wage
index factor. (In other words, there is actually no positive levels of “safe” labor or social security income prior
to retirement.) Of course, in actual simulations, both of these terms must be bounded above zero when using
standard numerical integration methods. Hence, the constraint is enforced by making sure that the minimum
integrated node is sufficiently small.
16
We thanks Ken Judd for this suggestion. Consistent with suggestions in Judd (1998), we found several
other approximation methods to be very inaccurate, including Chebyshev polynomials. Schumaker splines do
not generalize easily to more than one dimension.

11

gate permanent income shock, a transformation to the Gauss-Hermite quadrature is required
in order to implement the bivariate normal distribution (Appendix B). Maximization at each
grid point is performed using a combination of simplex optimization (Nelder-Mead) and
Brent’s method. While slower than gradient-based methods, they are more reliable.17
Correctly imposing the constraint (16) requires some care. The optimization problem is
first solved (using simplex optimization) at the given grid point without the constraint (16)
imposed. If the constraint (16) is not violated then that solution is obviously used. Otherwise,
two additional conditional optimization problems are solved (now using Brent’s method):
where αi,t = 0 and where αi,t = 1. The best solution (highest value function) of those
two optimizations is then chosen, which under our convexity assumptions, must be larger
than any interior point where 0 < αi,t < 1. Solving individual i’s lifetime maximization
problem, therefore, requires up to 600,000,000 optimization subproblems to be solved.18
The simulation is solved with FORTRAN 90 MPI using a grid network with parallelizatio.
Following Judd (1992, 1998), the accuracy of any simulation is judged from the Euler
equation errors produced by the approximation. Appendix C describes how we calculate
the Euler errors for our model as a fraction of consumption, thereby giving a meaningful
(scale independent) interpretation to the errors. Except at corner constraints (where the Euler
equation does not hold), the optimizations are required to satisfy a small sup norm error.

4 Calibration
Our model is calibrated to the United States economy in 2004, prior to the rise of target
date funds. We group individuals by their maximum amount of education obtained: i ∈
{“No High School”,“High School”, “College”}. Specifically, individuals with “No High
School” do not have a high school diploma; individuals with “High School” have a high
school diploma but not college; individuals with “College” have obtained a college degree.
17

Several other maximization methods and approaches were explored, including derivative-based methods as
well as quasi-Newton methods that ensure a correctly signed inverse Hessian matrix. A high-end commerical
package was also tested. However, none of them were either as accurate (based on Euler Equation errors) or even
as as fast (due to many interations caused by instability) as the approaches that we eventually settled upon.
18
We reject any simulation (and, hence, try another approach) if any of the subproblems fail to solve. Hence,
we are forced to use methods that are very stable and perform well globally.

12

4.1 Preferences
Individual i without a college degree starts working at age 20 while individuals with a college
degree begin working at age 22. All households retire at age 65 and can live up to age
100. The mortality data for the whole population follow the National Vital Statistics Reports
from National Center for Health Statistics (Elizabeth Arias 2004). The benchmark bequest
intensity parameter b is set equal to 3 to help best calibrate the model.

4.2 Asset Properties
The riskfree return Rf is set equal to 2.00% while the average equity premium μ is equal to
4.00% per year, close to their empirical averages. The standard deviation of the innovation
to excess returns σ η is set equal to its historical value 0.157.19 Empirically, the correlation
of stocks and individual i’s wages at an annual frequency ρyη is fairly small. The value of
the correlation between the aggregate average wage and stock returns ρξη , however, is quite
large at a low (30-year) frequency, although it is measured with considerable uncertainty. We
use a point estimate of 0.80 as our benchmark parameter which is consistent with Jermann
(1999) and with our own estimates.

4.3 Labor Income and Housing Expenditures
Our labor income process follows the careful empirical analysis of Cocco, Gomes and Maenhout (CGM) (2005), who used the Panel Study of Income Dynamics (PSID) to estimate the
deterministic function of labor income g(t, Fi,t ), which they interpret broadly to include
all of the sources of income listed in Appendix A. The variable g(t, Fi,t ) is assumed to be
additively separable in t and Fi,t and a third-order polynomial that is estimated to fit the
age-wage profiles. Like them, we adopt the variances of transitory shocks and permanent
shocks on labor income from Carroll (1997). The unemployment probability is set to be
0.5%, approximately equal to the percentage of zero income observations in CGM. The correlation coefficient between stock returns shocks and labor income shocks follows Campbell
19

This value has been used in a couple previous papers; most of the literature uses a value between 0.15 - 0.20.

13

Table 1: Common Parameters in All Simulations
Description
Parameter Value
Start working age (t0 )
20/22
Retirement age (M )
65
Coefficient of relative risk aversion (γ)
5
1.02
Riskless returns (Rf )
1.06
Mean risky returns (Rf + μ)
0.01
Variance of transitory income shocks (σ 2ω )
Variance of permanent income shocks (σ 2u )
0.01
0.157
Standard deviation of stock returns (σ η )
0.8
Correlation between stock returns and income shocks (ρξη )
Social security tax rate (τ SS )
0.124
0.20
Investment return tax rate (τ SS )
Bequest intensity (b)
3
Unemployment probability (λ)
0.5%
Minimum income (m)
$10,000
Marital status
single
Family size
1
Table 2: Labor Income Process
Coefficient of characteristic variables for labor income No High School
Constant
2.6275
Marital status
0.4008
Family size
-0.0176
Coefficient of age dummies for labor income
Constant
-2.1361
Age
0.1684
-0.0353
Age2 /10
0.0023
Age3 /100

High School
2.7004
0.4437
-0.0236

College
2.3831
0.4831
-0.0228

-2.1700
0.1682
-0.0323
0.0020

-4.3148
0.3194
-0.0577
0.0033

et al. (2001).20 We also impose a minimum income threshold of $10,000 to model the safety
net for poor people.21 The share of expenditures spent on housing ht is taken from Gomes
and Michaelides (2005), which they estimate using PSID data between 1976 and 1993 as a
function of age. Table 1 reports the key parameter values while Table 2 reports the income
process coefficients by education grouping.
20
Since the underlying data was in 1992 dollars while the fiscal policy part of our model is scaled to 2004
dollars, we use the change in the Consumer Price Index 34.11% as the inflation rate from 1992 to 2004.
21
This threshold is approximately equal to the 2004 US Department of Health & Human services poverty
threshold. See http://aspe.hhs.gov/poverty/04poverty.shtml

14

Table 3: 2004 Progressive Federal Personal Income Tax Rates
Tax Rate
Single Filers
10%
Up to $7,150
15%
$7,151 - $29,050
25%
$29,051 - $70,350
28%
$70,351 - $146,750
33%
$146,751 - $319,100
35%
$319,101 or more

4.4 Progressive Federal Tax and Social Security Benefit Formula
We adopt the 2004 federal personal income tax rates (shown in Table 3 for single filers).
Taxes on both risky and riskless asset returns τ d are set at proportional rate of 20%.The
social security tax rate τ SS is 12.4%. After calculating the AIYE, we calculate the annual
social security benefit using the following three-region “bend point” formula used by the
U.S. Social Security system in 2004: 90 percent of the first $7,344 of AIYE, plus 32 percent
of the AIYE over $7,344 through 44,268, plus 15 percent of the AIYE above 44,268.

5 Results for High School Education
After obtaining the optimal policy functions for each grid point on the state, we generate an
initial distribution of random variables for labor income shocks and portfolio return shocks
then simulate over 10,000 households. This section reports the average (mean) outcomes by
age for those individuals in the middle education group, namely, those people with a high
school degree. We calibrate the value of β = 0.9 so that the model generates a populationweighted average wealth-income ratio that is close to its empirical counterpart for the High
School group.22
Figure 3 shows the average labor (plus social security) income and consumption profiles
by age for the High School group. Average labor income takes the standard “hump shape”
(∩) and drops to zero at retirement when Social Security benefits become positive. Consumption is also hump shaped, which is not standard in a deterministic lifecycle model where
consumption should be monotonic in age. Intuitively, in the presence of income uncertainty
22

Hence, we are not separately targeting the portfolio choice over the lifecycle. Moreoever, we are not able to
control the wealth-income ratio over the entire lifecycle.

15

Figure 3: Income and Consumption Profile for High School Group

and CRRA utility (where the third derivative in consumption is positive), individuals save for
precautionary reasons in addition to standard retirement reasons. Hump-shaped consumption
profiles emerge as a combination of precautionary savings and impatience, producing an optimal consumption path that often closely tracks income (Zeldes 1989; Deaton 1991; Carroll
1992; Hubbard, Skinner and Zeldes 1994).
Figure 4 shows that the model’s simulated wealth-income ratio appears to match the data
quite closely over the lifecycle. One obvious exception is at the oldest age group where
survivor bias might play a role in the data since wealthier households tend to live longer
than poorer households. Our simulations do not attempt to correct for this wealth-longevity
correlation.23
Figure 5 shows the share of financial assets allocated to stocks versus bonds for the
benchmark case as well as the empirical allocation in the SCF from Figure 1. Notice that the
simulated stock allocation is much less than 100% and fairly close to the actual empirical
23
While allowing for a wealth-longevity correlation would not require an additional state variable, it is actually
fairly complicated when γ > 1, due to negative utility. In particular, longer longevity would actually reduce
utility. In effect, allowing for longer longevity changes the preference parameters (the augmented utility weight)
of an individual, making it difficult to compare.

16

Figure 4: High School Group Wealth/Income Ratio

Figure 5: High School Group Stock Allocation

17

data. This result is in contrast to the traditional lifecycle model where the stock allocation is
near 100% when young and decreases to about 60% nearer retirement. Moreover, the stock
allocation profile in Figure 5 is fairly reasonable to the “hump shape” (∩) pattern observed in
empirical data. Of course, the results are not a perfect fit by any means. Our model is clearly
stylized and the data itself likely also contains a fair amount of “noise.”
The hump shape is produced by the model in presence of several competing factors that
vary by age. First, risky stocks and social security are highly substitutable during young ages
where aggregate wage-indexed social security benefits are still quite uncertain. However, as a
person ages, bonds and social security become more substitutable over time as social security
benefits accrue and the potential risk in the wage-indexed factor is reduced. The net effect
is to cause the allocation in stocks to start relatively low at a young age and then increase in
age. Second, similar to previous models, agent i’s specific human capital depreciates over
the lifecycle. Since stock returns and individual wages are not highly correlated, this effect
produces a larger stock allocation in middle age that then decreases with additional age.
Third, the background risk caused by non-insurability of human capital returns interacting
with the utility function’s Inada condition diminishes over the lifecycle, which can increase
the share allocated toward risky stocks. Putting these competing factors together produces a
“hump” shaped stock allocation.
In fact, a “second hump” (creating a “M” like pattern) also emerges as households retire.
After retirement – that is, once the initial benefit amount is calculated – Social Security
benefits are not adjusted for wage growth and only keep pace with inflation. As households
retire and the Social Security benefit is safe, households with longer horizons (more weight
on future utility) will shift their allocation again toward stocks.

6 College and No High School
We also calibrated our model for the College and No High School groups by targetting
the empirical population-weighted average wealth-income ratios for the respective education group. The resulting value of β is equal to 0.95 for the College group and 0.8 for No
High School group. (Recall that β = 0.9 for the baseline High School group considered
earlier.) Notice that the required calibrated value of β increases with education level, which
18

Figure 6: College Group Wealth/Income Ratio

Figure 7: College Group Stock Allocation

19

Figure 8: No High School Group Wealth/Income Ratio

Figure 9: No High School Group Stock Allocation

20

is intuitive because the education decision likely reflects their time preferences. People who
choose to invest in more education are likely to be relatively more patient.
Figures 6 and 8 show the corresponding lifecycle wealth-income ratios for each education
group, compared with the empirical counterpart. Figure 7 and 9 show the stock allocation
for College group and the No High School group, respectively. The stock allocation pattern
produced by the model for households with College eduction (Figures 7) is similar to the
benchmark High School group considered earlier. One key exception is that College educated
households hold relative more equities at younger ages, which produces a smoother portoflio
over the lifecycle. Intuitively, the progressive nature of Social Security benefits in our model
implies that wage indexation is relatively less important for College educated households. As
a result, a College educated household invests a greater fraction of their assets into equities
at a younger age relative to the High School group (i.e., our model is not homogenous of
degree 1). Consistently, the poorest No High School group hold fewer equities (Figure 9).

7 Sensitivity Analysis
7.1 Low correlation between aggregate average wage and stock returns
To explore the importance of the role of wage-indexed Social Security, Figure 10 shows the
stock allocation of the benchmark High School group when the correlation between the aggregate average wage and stock returns is smaller (ρξη = 0.15). The results are similar to
those found in previous papers. The stock allocation starts near 100% for younger households and declines over time. Reducing the correlation between the aggregate average wage
and stock returns makes social security less correlated with stocks, therefore significantly
increasing the demand for stocks.

7.2 Risk aversion
We now also show the results for the High School group with a lower risk aversion (γ = 3)
and with a higher risk aversion (γ = 7). In order to rematch the empirical average wealthincome ratio, the beta is recalibrated accordingly (0.95 for γ = 3 and 0.8 for γ = 7).
Figure 11 shows the stock allocation when risk aversion is low (γ = 3). Since households
are less risk averse relative to the baseline, their stock allocation is relatively larger and close
21

Figure 10: Stock Allocation with Low Correlation

to 100% throughout the entire lifecycle. Figure 12 shows the stock allocation when risk
aversion is large (γ = 7). Now, the stock allocation is much lower than the benchmark and
the empirical data.

8 Target Date Funds
“Target date” (or “lifecycle”) funds have grown enormously during the past five years in the
United States.24 A given target date fund targets a given retirement date (e.g., 2035) and automatically rebalance the stock-bond allocation over time toward more bonds as the targeted
retirement date is approached. Their main purpose is to essentially simplify the portfolio allocation process along the lines that is consistent with the traditional financial advice, thereby
reducing “mistakes.” The Pension Protection Act of 2006 increased the popularity of target
date funds by allowing employers to make them the “default option” in their 401(k) plans
without fear of liability.25 Of the 380 target-date funds currently in existence, more than 300
24

The SCF data presented herein corresponds to a period before the popularity of target date funds.
To encourage savings by less affluent households, the Pension Protection Act of 2006 allows for automatic
(“opt out”) enrollment, which is especially important for less affluent households who do not make active decisions. Plan sponsors (employers) are protected from liability associated with potential future losses in fund value
25

22

Figure 11: Stock Allocation with Low Risk Aversion

Figure 12: Stock Allocation with High Risk Aversion

23

Figure 13: Model Generated Stock Allocation vs. Data and Target Date Fund

are less than six years old and have originated after the 2004 SCF data was collected.26
Of course, relative to our model, any lifecycle allocation rule would, by definition, produce a lower level of welfare than the age-based allocation produced by our model itself.
So, we instead ask a more meaningful question: do target date funds actually produce a
higher level of welfare relative to what households were achieving on their own before they
these funds were introduced? In other words, do target date funds potentially introduce more
mistakes than what households were already making?
Figure 13 shows the lifecycle stock allocation corresponding to a standard target date
fund (“Advisory”), which starts at 90% and declines over time to about 20% by age 99. This
allocation is informally recommended by the U.S. Securities and Exchange Commission.27
It is also very similar to allocations offered by commercial providers. For comparison, Figure
13 also shows the actual empirical allocation for our baseline “High School” education class
(“Data”) as well as our model generated allocation (“Model”).
if they follow the safe harbor guidelines of a Qualified Default Investment Account (QDIA). Target date funds
are an acceptable and popular QDIA choice.
26
http://money.cnn.com/2009/04/27/news/companies/kimes_targetfunds.fortune/index.htm?postversion=2009042713
27
http://www.sec.gov/investor/pubs/assetallocation.htm

24

Notice that above age 55, the Advisory allocation already closely tracks the Data allocation pretty well. As a result, a target date fund provides very little opportunity to improve
welfare for older households relative to their existing behavior; indeed, older households
with more assets are already likely to be aware of the traditional advice that underlies the
target date funds. For households between age 35 and 50, the Advisory allocation traces the
optimal Model allocation fairly well, indicating that the target date fund may provide optimal
recommendation. However, for household before age 35, the Model allocation is generally
closer to the Data allocation relative to the Advisory allocation. This fact suggests that the
adoption of a target date fund could be welfare decreasing; households might be better off
with their current allocations. Overall, the effect on lifetime utility, therefore, is ambiguous
and needs formal measurement.
To measure the change in welfare from adopting a target date fund, we solve a constrained version of our model where the asset allocation is taken as exogenous. The constrained optimal solution is calculated under the Advisory allocation. The constrained optimal solution is also calculated under the Data allocation shown in Figure 13. In each case,
households are allowed to reoptimize their lifetime savings decision under the given sttockbond allocation.
R R
Let Ω = X z Vi,20 (Xi,20 , zi,20 )dX20 dz20 denote the ex-ante expected utility at age 20

across the different sources of uncertainty upon entering age 20. The corresponding compensating variation (welfare change) associated with adopting the target date fund at age 20
h Advisory i 1
1−γ
− 1, where ΩAdvisory and ΩData are the expected utilities
is then defined as Ω ΩData
from the Advisory and Data allocations, respectively. A positive compensating variation indicates a welfare gain from adopting the target date allocation, while a negative compensating
variation indicates a welfare loss.
The compensating variation for the College group and No High School group are both
negative (at -0.2% and -0.3% respectively), indicating a small welfare loss from adopting the
target date fund. The compensating variation for the High School education group, though,
is positive (about 1.4%), indicating a small welfare gain from adopting the target date fund.
These losses grow (and the positive gain turns negative) at higher level of risk aversion,
which, incidentially, is consistent with the literature examining the equity premium puzzle.
25

It is, therefore, unclear that the recent government policy encouraging the adoptation of
target funds actually improves welfare. Of course, more work on this issue is needed. To the
extent that target date funds move people to save and invest in the first place, they could be
welfare improving. However, to the extent that an otherwise participating household believes
that a target date fund was created by experts and provides a better allocation, investing
in the target date fund could be welfare decreasing. Future analysis should consider these
counterfactual scenarios at the household level in more detail.

9 Conclusion
Social security benefits are the largest asset for a majority of U.S. households. This paper
examines how households should optimally allocate their portfolio choices between stocks
and bonds when we recognize that this large unchosen benefit is progressive and wage indexed. The household decision rules are fundamentally altered. Empirically, households
appear to be doing quite well and make only small “mistakes” at reasonable parameter values. Recent government attempts to simplify the investment process could very well leave
many households worse off.

26

References
[1] Ameriks, John, Zeldes, Stephen (2000). How do household portfolio shares vary with
age? Unpublished manuscript. Columbia University.
[2] Ayers, Ian and Barry Nalebuff (2008). “Life-Cycle Investing and Leverage: Buying
Stock on Margin Can Reduce Retirement Risk.” Working Paper, Yale Law School.
[3] Attanasio, Orazio, (1995). “The Intertemporal Allocation of Consumption: Theory and
Evidence,” Carnegie-Rochester Conference Series on Public Policy, 39-89
[4] Balduzzi, Perluigi, and Anthony Lynch, (1997). “The impact of Predictability and
Transaction Costs on Portfolio Choice in a Multiperiod Setting,” Working Paper,
Boston College and New York University
[5] Benzoni, Luca, Pierre Collin-Dufresne, and Goldstein S. Robert (2004). “Portfolio
Choice over the Life-Cycle in the presence of ‘Trickle Down’ Labor Income,” Working
Paper
[6] Bertaut, Carol C. and Michael Haliassos, (1997). “Precautionary Portfolio Behavior
from a Life Cycle Perspective,” Journal of Economic Dynamics and Control, 21, 15111542
[7] Bodie, Zvi; Robert C Merton; William F Samuelson (1992). “Labor Supply Flexibility and Portfolio Choice in a Life Cycle Model.” Journal of Economic Dynamics and
Control, vol. 16, no. 3-4: 427-49
[8] Bodie, Z., J. Detemple, S. Otruba and S. Walter (2004). “Optimal ConsumptionPortfolio Choices and Retirement Planning,” Journal of Economic Dynamics and Control, 28.
[9] Brennan, Michael J. and Y. Xia, (1998). “Resolution of a Financial Puzzle,” Working
Paper, Anderson Graduate School of Management, UCLA
[10] Brown, D.P. (1990). “Age clienteles induced by liquidity constraints.” International
Economic Review 31, 891–911.
[11] Campbell, John Y., Joao F. Cocco, Francisco J. Gomes, and Pascal J. Maenhout, (2001).
“Investing Retirement Wealth: A Life-Cycle Model”, Risk Aspects of Social Security
Reform, University of Chicago Press
[12] Campbell, John Y. and John H. Cochrane, (1999). "By Force of Habit: A ConsumptionBased Explanation of Aggregate Stock Market Behavior," Journal of Political Economy, 107, 205-251
[13] Campbell, John Y. and Luis M. Viceira, (1999). “Consumption and Portfolio Decisions When Expected Returns are Time Varying,” Quarterly Journal of Economics,
May 1999, 433-496

27

[14] Carroll, Christopher. D., (1992). “The Buffer Stock Theory of Saving: Some Macroeconomic Evidence,” Brookings Papers on Economic Activity, 2, 61-135
[15] Carroll, Christopher. D., (1997). “Buffer-Stock Saving and the Life-Cycle/Permanent
Income Hypothesis,” Quarterly Journal of Economics, 112, 1-55
[16] Carroll, Christopher. D., (2002). "Portfolio of the rich, in Luigi Guiso, Michael Haliassos, and Tullio Jappelli, eds," Household Portfolios, MIT Press, Cambridge, MA
[17] Carroll, Christopher. D., and A. A. Samwick, (1997). “The Nature of Precautionary
Wealth,” Journal of Monetary Economics, 40, 41-71.
[18] Cocco, Joao F., (1998). “Owner-Occupied Housing, Permanent Income, and Portfolio
Choice”, working paper, Harvard University
[19] Cocco, Joao F., Francisco J. Gomes, and Pascal J. Maenhout, (1998), “Consumption
and Portfolio Choice over the Life Cycle,” The Review of Financial Studies, Vol. 18,
No. 2
[20] Davis, S., and W. Paul (2000). “Occupation-Level Income Shocks and Asset Returns:
Their Covariance and Implication for Portfolio Choice,” NBER Working Paper 7905.
[21] Deaton, A. (1991). “Saving and Liquidity Constraints,” Econometrica, 59, 1121-1142
[22] Elizabeth Arias, (2004). “United States Life Tables,” National Vital Statistics Reports,
Vol. 53, No. 6, November 10, 2004
[23] Faig, M., and P. Shum (2002). “Portfolio Choice in the Presence of Personal Illiquid
Projects,” Journal of Finance. 57(1), 303–328.
[24] Gakidis, Haralabos (1998). “Portfolio Choice with Uninsurable Labor Earnings.”
Massachusetts Institute of Technology, Mimeo.
[25] Gomes, Francisco, and Alexander Michaelides (2005), "Optimal Life-Cycle Asset Allocation: Understanding the Empirical Evidence," The Journal of Finance, April 2005,
869-904
[26] Gourinchas, P. O., and J. Parker (2002), “Consumption Over the Life Cycle,” Econometrica, 70, 47-91
[27] Gourinchas, Pierre-Olivier and Jonathan Parker (1996), “Consumption Over the Life
Cycle,” working paper, MIT
[28] Heaton, John and Deborah J. Lucas (1997), “Market Frictions, Saving Behavior and
Portfolio Choice,” Macroeconomic Dynamics, 1, 76-101
[29] Horneff, Wolfram, Raimond Maurer, Olivia Mitchell, Michael Stamos (2009), “Asset
allocation and location over the life cycle with investment-linked survival-contingent
payouts.” Journal of Banking and Finance 33: 1688 - 1699.

28

[30] Hubbard, Glenn, Jonathan S. Skinner and Stephen Zeldes, (1994), “Precautionary Saving and Social Insurance,” Journal of Political Economy, 103, 360-399
[31] Jagannathan, R., and N. R. Kocherlakota, (1996), “Why Should Older People Invest
Less in Stocks Than Younger People?” Federal Reserve Bank of Minneapolis Quarterly
Review, 20, 11-23
[32] Jermann, Urban (1999). “Social Security and Institutions for Intergenerational, Intragenerational and International Risk Sharing: A Comment,” Carnegie-Rochester Conference Series on Public Policy: 205-212
[33] Judd, Kenneth L (1992). “Projection Methods for Solving Aggregate Growth Models.”
Journal of Economic Theory, 58: 410-452.
[34] Judd, Kenneth L., (1998). “Numerical Methods in Economics” MIT Press.
[35] Kim, Tong Suk, and Edward Omberg, (1996). “Dynamic Nonmyopic Portfolio Behavior,” Review of Financial Studies, 9, 141-161
[36] Merton, Robert C., (1969). “Lifetime Portfolio Selection under Uncertainty: The
Continuous-Time Case,” Review of Economics and Statistics, 51, 247-257
[37] Merton, Robert C., (1971). “Optimum Consumption and Portfolio Rules in a
Continuous-Time Model,” Journal of Economic Theory, 3, 373-413
[38] Samuelson, Paul A., (1969). “Lifetime Portfolio Selection by Dynamic Stochastic Programming,” Review of Economics and Statistics, 51, 239-246
[39] Social Security Administration, Office of Policy (2002). Income of the Aged Chartbook, 2002.
[40] Storesletten, Kjetil, Chris I. Telmer, and Amir Yaron, (2000). “Asset Pricing with Idiosyncratic Risk and Overlapping Generations,” Working Paper, Carnegie Mellon University
[41] Viceira, Luis M., (2001). “Optimal Portfolio Choice for Long Horizon Investors with
Nontradable Labor Income,” Journal of Finance, 55, 1163-1198
[42] Zeldes, S. P. (1989). “Optimal Consumption with Stochastic Income: Deviations from
Certainty Equivalence,” Quarterly Journal of Economics, 104, 275-298

29

Appendix A
To construct the the household income, we include wages and salaries (X5702), practice/business/partnership/farm income (X5704), rent/trusts/royolties (X5714), unemployment
or worker’s compensation (X5716), child support or alimony (X5718), food stamps and welfare income (X5720) and other income (X5724).
Bonds and stocks are constructed as follows. All the acronym-variables are defined in
the SAS program supplied by the SCF, which creates summary variables for SCF. Bonds
consist of SAVING and MMA (savings and money market accounts), CDS (cerfiticates of
deposit), TFBMUTF (tax free bond mutual funds), GBMUTF (government bond mutual
funds), OBMUTF (other bond mutual funds), BOND (state, US government and corporate
bonds), SAVBND (saving bonds) and COMUTF (combination and other mutual funds), for
which we assume that half is invested to bonds. We also add ANNUIT (annuities) and
TRUSTS (trusts), for which we count the full value if the individuals invest all in interest
earning assets, while the percentage other than stock allocation if the individuals split the
investment. Other bond investment includes bonds in IRA/KEOGH plans, bonds in accounttype retirement plans and FUTPEN (other future pension benefits). We also subtract CCBAL
(revolving credit card debt), OTHLOC (unsecured loans and loans secured by pensions)
and other debt, which includes loans against pensions (X11027, X11127, X11327, X11427,
X11527), loans against life insurance (X4010) and loans against margin loans (X3932).
Stocks are made up of STOCKS (directly held stocks), STMUTF (stock mutual funds),
half of COMUTF (combination and other mutual funds), OMUTF (other non-bond mutual
funds), PENEQ (thrift amounts invested in stock), ANNUIT (annuities) and TRUSTS (trusts)
that are invested in stocks. Other stock investment includes stocks in IRA/KEOGH plans,
stocks in account-type retirement plans and FUTPEN (other future pension benefits).
The total financial wealth is defined as the total of bonds, stocks, CHECKING (checking
accounts) and CALL (call accounts).

30

Appendix B
f (·) denotes the p.d.f. of the variables. I, J, K, L are the numbers of interpolation nodes
for labor income shocks and stock returns shocks η, ξ, ω, φ, respectively. The distributions
of the shocks are summarized as,

d

ω −→ N (μω , σ 2ω )

(18)

d

φ −→ N (μφ , σ 2φ )

(19)

µ
¶
µ ¶
η
σ 2η
ρξη σ ξ σ η
μη
d
−→ N
,
σ 2ξ
μξ ρξη σ ξ σ η
ξ

(20)

For each individual i, at any time t and any state point (Xi,t , zi,t ), the expectation of the
value function can be expressed as follows.

Eξηωφ Vt (ξ, η, ω, φ, Xt , zt ) =

=

Z∞ Z∞ Z∞ Z∞

Vt (ξ, η, ω, φ, Xt , zt )f (ξ, η, ω, φ)dξdηdωdφ

−∞−∞−∞−∞
Z∞ Z∞ Z∞ Z∞

Vt (ξ, η, ω, φ, Xt , zt )f (η|ξ)dη · f (ξ)dξ · f (ω)dω · f (φ)dφ

−∞−∞−∞−∞

For the bivariate normal distribution, the conditional distribution for one of the variables,
given the value for the other variable, is normally distributed. Therefore,

d

η|ξ −→ N (μη|ξ , σ 2η|ξ )

(22)

where

μη|ξ = μη +

(21)

ρξη σ η
(ξ − μξ )
σξ

(23)

σ 2η|ξ = σ 2η (1 − ρ2ξη )

(24)

Following P.262 of Kenneth Judd, if a normal random variable X is distributed N (μ, σ 2 ),
then the general Gauss-Hermite quadrature rule for expectation of X is as follows,
31

E(X) = π −1/2

n
X
√
wi · ( 2σxi + μ)
i=1

where wi are the Gauss-Hermite quadrature weights, and xi are the quadrature nodes,
i = 1, 2, ..., n.
So, the functional approximation of Gauss-Hermite quadrature to η is

Eξηωφ Vt (ξ, η, ω, φ, Xt , zt ) = π

− 12

Z∞ Z∞ Z∞ X
I
√
wi,η Vt (ξ, 2σ η|ξ + μη|ξ , ω, φ, Xt , zt )

(25)

−∞−∞−∞ i=1

1

= π− 2

· f (ξ)dξ · f (ω)dω · f (φ)dφ
Z∞ Z∞ Z∞ X
I
q
√
wi,η Vt (ξ, 2σ η 1 − ρ2ξη ηi + μη +

−∞−∞−∞ i=1

ρξη σ η
(ξ − μξ ), ω, φ, Xt , zt ) · f (ξ)dξ · f (ω)dω · f (φ)dφ
σξ

is the weights, ηi is the nodes over [−∞, ∞].The procedure of discretizing ξ
where wi,η √
is to substitute 2σ ξ ξ j + μξ for ξ, which yields the following,
(26)
Eξηωφ Vt (ξ, η, ω, φ, Xt , zt )
Z∞ Z∞ X
J X
I
q
√
= π −1
wi,η wj,ξ Vt ( 2σ η ( 1 − ρ2ξη η j + ρξη ξ j ) + μη , ω, φ, Xt , zt ) · f (ω)dω · f (φ)dφ
−∞−∞ j=1 i=1

Again wj,ξ and ξ j are the Gauss-Hermite quadrature weights and nodes, respetively. Proceeding with the integral over ω and φ,

Eξηωφ Vt (ξ, η, ω, φ, Xt , zt )
= π −2

(27)
q
√
√
wi,η wj,ξ wk,ω wl,φ · Vt ( 2σ η ( 1 − ρ2ξη η j + ρξη ξ j ) + μη , 2σ ω ω k

I
K X
J X
L X
X
l=1 k=1 j=1 i=1

√
+ uw , 2σ φ φl + uφ ; Xt , zt )

This model is expensive to compute. The number of nodes in the dynamic programming
tree is I ×J ×K ×L×T ×S1 ×S2 ×S3 ×2, where I, J, K, L are the nodes for different shocks
as described above, T is the maximum age that individual can live up to, S1 , S2 and S3 are
the numbers of nodes for three state variables separately. Taking 80 as the total life periods
and 5 nodes for each shock, the number of nodes for cash on hand is 60, while the number of
nodes for income and indexed wage is 10, separately. A non-uniform power function is used
32

to map grid points into state values (details available from the authors). When the minimum
stock investment threshold, m, is imposed we have two optimization problems at each state:
one with bond investment only, the other with both bonds and stocks. Altogether, there are
I × J × K × L × T × S1max × S2max × S3max × 2 = 600, 000, 000 optimization problems.
If any single optimization problem fails to converge, the entire program is repeated.

33

Appendix C
Take the first-order condtion of Bellman equation

Vi,t (Xi,t , zi,t ) = max {U (Ci,t ) + β [pt · Et Vi,t+1 (Xi,t+1 , zi,t+1 ) + b(1 − pt ) · Et U (Wi,t+1 )]}
Ci,t ,αi,t

(28)
Subject to
d
Xi,t+1 = Ri,t (Xi,t − Ci,t ) + (1 − ht+1 )Yi,t+1

(29)

d
Xi,t = Wi,t + (1 − ht )Yi,t

(30)

We have
∂Vi,t (Xi,t , zi,t )
(31)
∂Ci,t
)]}
= U 0(Ci,t ) + β {pt · Et [Vi,t+1 0 (Xi,t+1 , zi,t+1 ) · (−Ri,t )] + b(1 − pt ) · Et [U 0(Wi,t+1 ) · (−Ri,t(32)

= 0

(33)

Change the equation, we have

U 0(Ci,t ) = β {pt · Et [Vi,t+1 0 (Xi,t+1 , zi,t+1 ) · Ri,t ] + b(1 − pt ) · Et [U 0(Wi,t+1 ) · Ri,t ]}
(34)

According to the Envelope Therorem, the partial derivative with respect to Xi,t is
∂Vi,t (Xi,t , zi,t )
= β {pt · Et [Vi,t+1 0 (Xi,t+1 , zi,t+1 ) · Ri,t ] + b(1 − pt ) · Et [U0(Wi,t+1 ) · Ri,t ]}
∂Xi,t
(35)
The right hand sides of Equations (34) and (35) are equal, which gives us

U 0(Ci,t ) = Vi,t 0 (Xi,t , zi,t )

(36)

Thus, we rewrite Equation (34) as follows,

U 0(Ci,t ) = βpt · Et [U 0(Ci,t+1 ) · Ri,t ] + βb(1 − pt ) · Et [U 0(Wi,t+1 ) · Ri,t ]
34

(37)

Ci,t = U 0−1 {βpt · Et [U 0(Ci,t+1 ) · Ri,t ] + βb(1 − pt ) · Et [U 0(Wi,t+1 ) · Ri,t ]} (38)
We define the Euler error as

Ci,t ·(1+error) = U 0−1 {βpt · Et [U 0(Ci,t+1 ) · Ri,t ] + βb(1 − pt ) · Et [U 0(Wi,t+1 ) · Ri,t ]}
(39)

error =

U 0−1 {βpt · Et [U 0(Ci,t+1 ) · Ri,t ] + βb(1 − pt ) · Et [U 0(Wi,t+1 ) · Ri,t ]} − Ci,t
Ci,t
(40)

We then take a log10 of the error, the acceptable range is around -3 or smaller.

35

