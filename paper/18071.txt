NBER WORKING PAPER SERIES

THE SMART GRID, ENTRY, AND IMPERFECT COMPETITION IN ELECTRICITY
MARKETS
Hunt Allcott
Working Paper 18071
http://www.nber.org/papers/w18071
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2012

I thank, without implicating, Susan Athey, Severin Borenstein, Eric Budish, Drew Fudenberg, Michael
Greenstone, Bill Hogan, Steven Joyce, Erin Mansur, Erich Muehlegger, Sendhil Mullainathan, Chris
Nosko, Ariel Pakes, Rob Stavins, Frank Wolak, and seminar participants at Carnegie Mellon, Duke,
Georgetown, Harvard, IBS Hyderabad, Michigan, NYU, NYU Stern, Notre Dame, Resources for the
Future, Stanford GSB, Stanford MS&E, Tufts, and UC Davis. Joe Bowring, Howard Haas, Ellen Krawiec,
and Matt Thompson of Monitoring Analytics facilitated my access to the bidding and cost data and
provided valuable insights on the PJM market. I thank Sam Newell, Harvey Reed, Alex Rudkevich,
Paul Sotkiewicz, and Assef Zobian for helpful conversations on the details of restructured electricity
markets. Financial support is acknowledged from the Harvard University Center for the Environment
and from Harvard’s Mossavar-Rahmani Center for Business and Government. The views expressed
herein are those of the author and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2012 by Hunt Allcott. All rights reserved. Short sections of text, not to exceed two paragraphs, may
be quoted without explicit permission provided that full credit, including © notice, is given to the source.

The Smart Grid, Entry, and Imperfect Competition in Electricity Markets
Hunt Allcott
NBER Working Paper No. 18071
May 2012
JEL No. D24,D43,D44,L10,L51,L94,Q4,Q41
ABSTRACT
Most US consumers are charged a near-constant retail price for electricity, despite substantial hourly
variation in the wholesale market price. The Smart Grid is a set of emerging technologies that, among
other effects, will facilitate "real-time pricing" for electricity and increase price elasticity of demand.
This paper simulates the effects of this increased demand elasticity using counterfactual simulations
in a structural model of the Pennsylvania-Jersey-Maryland electricity market. The model includes
a different approach to the problem of multiple equilibria in multi-unit auctions: I non-parametrically
estimate unobservables that rationalize past bidding behavior and use learning algorithms to move
from the observed equilibrium counterfactual bid functions. This routine is nested as the second stage
of a static entry game that models the Capacity Market, an important element of market design in some
restructured electricity markets.
There are three central results. First, I find that an increase in demand elasticity could actually increase
wholesale electricity prices in peak hours, contrary to predictions from short run models, while decreasing
Capacity Market prices and total entry. Second, although the increased demand elasticity from the
Smart Grid reduces producers' market power, in practice this would be a small channel of efficiency
gains relative to forestalled entry. Third, I find that the gross welfare gains from moving a typical consumer
to the Smart Grid, under the assumed demand parameters and before subtracting out the initial infrastructure
costs, are about 10 percent of the consumer's total wholesale electricity costs.
Hunt Allcott
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
hunt.allcott@nyu.edu

1

Introduction

In two-thirds of the United States, "restructured" wholesale markets for electricity have replaced the
traditional vertically-integrated "natural monopoly." Since electricity is economically non-storable,
wholesale prices vary from hour to hour, but most retail consumers are charged some average price
that does not reflect the wholesale price at the time of consumption. Not only does this induce
these consumers to misallocate consumption across time relative to a structure under which they
pay the "real-time price," but it also creates some of the central challenges of wholesale electricity
market design. Inelastic demand gives producer firms market power, and markups above marginal
cost can cause an ineﬃcient allocation of production between firms. Inelastic short-term demand
also contributes to the need for minimum capacity regulations, called Planning Reserve Margins, to
ensure that suﬃcient capacity enters to satisfy essentially any realization of quantity demanded1 .
The "Smart Grid" is a set of electric power information technologies that many analysts believe
will begin to change this picture. The 2009 US economic stimulus package included $3.9 billion for
Smart Grid projects, and utilities in many states are introducing Smart Grid technologies to large
groups of customers. While these multifaceted technological changes will have many eﬀects, one
of the principal economic implications of the Smart Grid is that it will increase the price elasticity
of demand in each day’s wholesale electricity auction. Two classes of Smart Grid technologies
drive this eﬀect: advanced metering infrastructure that will make it cheaper to introduce real-time
pricing (RTP) to retail consumers, and energy management technologies that will allow consumers
to respond to prices more easily.
As Smart Grid technologies are expanded to a larger group of consumers, the increased price
elasticity of demand would aﬀect equilibrium prices in a restructured wholesale market through
three primary channels. First, the changes in demand would result in new equilibria along the
existing aggregate supply curves. Second, increased demand elasticity would aﬀect producers’
profit-maximizing bid markups, inducing them to bid closer to marginal cost. Third, this would
change incentives for entry and exit and aﬀect the market institutions that govern total system
capacity, the Reserve Margin and the "Capacity Market." There appears to be no existing model
that captures all of these eﬀects in equilibrium.
This paper simulates the equilibrium eﬀects of an increase in the price elasticity of demand
from expanding the Smart Grid to a large group of consumers, using a new simulation model of
the Pennsylvania-Jersey-Maryland (PJM) market. The model takes the form of a two stage entry
game, where in the first stage, potential entrants set capacity, and in the second stage, entrants bid
along with incumbent firms in the daily electricity market auctions. In equilibrium, entrants’ zero
profit conditions hold, and all entrants and incumbents set prices in the second stage to maximize
profits conditional on available capacity and beliefs about the distribution of other firms’ bids. This
1
Short-term demand inelasticity has either been the subject of or a principal motivation for much of economists’
recent work on market design, including Borenstein (2002), Borenstein and Holland (2005), Joskow and Tirole (2007),
Wilson (2002), and Wolak (2007).

2

model is unique in its ability to endogenize both entry and strategic bidding behavior with detail
on the market’s firms and institutions.
The second stage of this entry game models the central component of PJM and other restructured electricity markets: a daily multi-unit uniform price procurement auction. A key challenge
in analyzing changes in demand elasticity or other counterfactuals in this setting is that the equilibrium can be shown to be unique only under restrictive conditions, such as symmetric firms or
linear marginal costs. As an alternative to such restrictions, I instead exploit the information in
observed equilibria and assume a "learning" process through which firms would move from initial
conditions to a counterfactual equilibrium. Equilibrium selection by learning is relatively sensible
in electricity markets given the daily repetition of auctions, and this approach allows the inclusion
of realistic detail on firms’ costs and strategies and on the market price setting mechanism.
This procedure begins by non-parametrically estimating forward contract positions that rationalize firms’ bids between April 2003 and March 2004, exploiting confidential bidding and cost
data made available for this project. As pointed out by Guerre, Perrigne, and Vuong (2000) in
the single-unit setting and Hortacsu (2002) in the multi-unit setting, structural primitives such as
these forward contract positions are identified under the assumption that firms best respond given
their beliefs about the probability distribution of competitors’ bids. Estimating this distribution
requires "pooling" over a set of identical auctions. If input costs vary or auctions are otherwise
heterogeneous, they must be somehow "homogenized." One of the conceptual contributions of this
paper is to implement an approach that admits relatively realistic incomplete information and allows a set of electricity auctions to be homogenized on observables; this in several senses may be
preferable to the earlier approaches of Wolak (2003) and Hortacsu and Puller (2008).
To simulate counterfactual equilibria, I hold supply-side primitives constant and change the
demand functions to represent new Smart Grid consumers. I then simulate firms iteratively best
responding from their initial equilibrium bids until they converge to the counterfactual equilibrium.
I show that the precise results are of course diﬀerent under diﬀerent learning algorithms, but they
are relatively similar in a quantitative sense that I define, and the diﬀerent algorithms qualitatively
generate the same policy conclusions. A second conceptual contribution of this paper is thus to
explore equilibrium selection by learning in a relatively sensible application.
An additional challenge in modeling the equilibrium eﬀects of increased demand elasticity is that
substantial welfare benefits should flow through the reduced entry of new power plants, but nearly
all electricity market models assume a fixed capital stock. To endogenize entry, the auction model is
nested as the second stage of a two-stage entry model with heterogeneous entrants, building on the
work of Borenstein (2005). In the first stage, potential entrants of three diﬀerent technologies set
capacity. The Reserve Margin, which the market operator mandates to ensure system reliability, is
modeled as a minimum constraint on the sum of entry across the three technologies. In equilibrium,
the shadow price of this constraint is transferred to capacity owners, as it becomes the clearing
price in a separate market called the Capacity Market. This is a third conceptual contribution

3

of this paper: the first equilibrium model of a Capacity Market, which is an important feature of
electricity market design in the eastern United States2 .
The model is used to analyze a counterfactual scenario in which one-fifth of the market, or about
8 million households worth of of power demand, receives Smart Grid infrastructure that increases
short run demand elasticity by about -0.1 in absolute value. This "Smart Grid" counterfactual
scenario is compared to a "No Smart Grid" scenario in which these consumers remain without real
time pricing and have no change in demand elasticity. The results counter a seemingly-obvious
intuition about the eﬀects of real-time electricity pricing: short run supply models3 predict that
high prices in peak hours will fall once consumers are exposed to those prices and reduce quantity
demanded. In long run equilibrium, however, entering "peaker" power plants earn zero profits,
meaning that RTP must either reduce peak electricity prices and increase Capacity Market revenues,
or vice versa. As I will illustrate both intuitively and quantitatively, higher peak electricity prices
and lower Capacity Market prices are the likely outcome.
Reducing the exercise of unilateral market power has been a critical issue in discussions by
economists and market operators and is often cited as a motivation for real-time pricing and other
"demand response" programs that increase wholesale market demand elasticity. Despite this, the
counterfactual simulation results show that the eﬃciency gains through this channel are small
relative to the eﬀects of forestalled entry. The intuition for this result is that firms set markups
based on their perceived residual demand elasticity, which is the elasticity of other firms’ supply
plus the demand elasticity from RTP. Only at relatively high prices is supply suﬃciently sparse
that additional demand elasticity has a noticeable eﬀect, and the market clears at these high prices
in only a few hours each year. In an industry where capacity is a substantial part of the cost
structure, however, the capacity reduction that would result from increasing demand elasticity is a
substantial potential source of welfare gains.
The base case analysis concludes that, given the assumed demand parameters, the annual gross
welfare benefits would be just over $300 million per year. To determine net welfare gains from
Smart Grid technologies, these benefits would be subtracted from estimates of infrastructure costs,
which vary widely.
The paper proceeds by providing background on the Pennsylvania-Jersey-Maryland electricity
market, including the details of the bidding process and Capacity Market. This is followed by
a description of the demand functions, in Section 3, and then a discussion of the public and
confidential cost data to be exploited, in Section 4. Section 5 presents the second stage of the
two-stage model, including firms’ first order conditions, the process of backing out unobservable
forward contracts, and the learning algorithm. Section 6 details the first stage, including the entry
decision and my model of the Capacity Market. Section 7 presents the counterfactual simulation
2

Unlike Borenstein (2005), this analysis models a Capacity Market by including the set of incumbent firms. The
crucial insight is that the cost structure of these existing firms interacts with demand patterns and entrants’ costs to
determine Capacity Market prices.
3
Holland and Mansur (2006) and Brattle Group (2007) simulate the potential short run eﬀects of RTP and other
forms of "demand response."

4

results, and Section 8 concludes.

2

The Pennsylvania-Jersey-Maryland Electricity Market

In 1927, three electric utilities in the mid-Atlantic region of the United States recognized the
potential gains from trade in electricity supply and joined together to form a "power pool" called
PJM. Now the world’s oldest and largest power pool, PJM was also on the forefront of electric
power deregulation, becoming the first market certified under the federal restructuring rules of
the late 1990s. Because of its size and importance, PJM is an excellent “laboratory” to study
the potential eﬀects of the Smart Grid, real-time pricing, and demand elasticity on a restructured
wholesale market.
At the time of the April 2003-March 2004 study period4 , electricity flowing through PJM served
25 million people’s homes and businesses in seven states and the District of Columbia. See Figure
10.1 for a map of PJM’s geographic footprint. Table 9.1 provides an overview of market conditions
during the study period. The flow of electric power averaged 37,400 megawatts (MW), reaching a
maximum of 61,500 MW on the afternoon of August 22nd, 2003.
Total available capacity was approximately 80,000 MW, about eight percent of the US total5 .
During the study period, there were 45 distinct firms bidding into the market, which between them
owned just over 500 electricity generating units. Table 9.1 illustrates the distribution of capacity
ownership, showing that the largest six firms own approximately two-thirds of capacity. As a frame
of reference, a typical home uses just over a kilowatt of power, and a typical power plant might
have capacity between 100 and 1000 megawatts.
Figure 10.2 shows the short-run supply curve, highlighting three major production technologies.
The lowest units on the supply curve are baseload coal-fired and nuclear plants, some large enough
to power millions of homes. These plants have high fixed and low variable cost and typically run
continuously except for scheduled maintenance periods during low-priced "shoulder months" in the
spring and fall. The highest units on the curve are smaller peaker plants fueled by oil and natural
gas, which employ gas turbine or steam turbine technologies that entail lower capital costs but less
eﬃcient fuel use and thus higher variable cost. In between in both size and cost structures are
mid-merit facilities, typically smaller coal plants and combined-cycle plants that run on natural
gas. The model will include entrant firms corresponding to these three technologies6 .
4

The period April 2003 through March 2004 is chosen to provide initial equilibria for the auction resimulations
primarily because it has relatively low natural gas input prices that are similar to the US Energy Information
Administration (2008a) forecast for the latter part of the coming decade, when the larger group of consumers has
access to Smart Grid technologies in the counterfactual scenario. Also, this study period predates a large expansion
of PJM that added new transmission constraints to the system, which my model cannot capture.
5
Many of the statistics in this section are from the PJM State of the Market reports (Monitoring Analytics 2003,
2004, 2008, 2009, 2010) and public data available on the PJM website, www.pjm.com.
6
PJM has recently seen construction of some wind generation capacity, but I do not endogenize entry of this
technology.

5

A key stylized fact of electricity markets is the "hockey stick" shape of the short run supply
curve. This is created by a small number of old, ineﬃcient plants with high marginal costs and
often large additional markups above cost. The hockey stick shape means that equilibrium prices
will be relatively low in most hours of the year, but can spike by an order of magnitude or more
for a small number of hours. These peak hours are of particular interest because they account for
a substantial flow of revenues from consumers to producers. The inelasticity of peak supply means
that an increase in demand elasticity from real-time pricing and the Smart Grid, even if providing
only a small change in quantity demanded, can substantially reduce peak prices in the short run.
Purchasing from the wholesale market are retailers, or Load Serving Entities, which then resell
electricity to residential, commercial, and industrial customers. These retailers are principally the
investor-owned utilities that had been regulated monopolies until the past 15 years of restructuring,
such as Public Service Electricity and Gas in New Jersey, Baltimore Gas and Electric, and Potomac
Electric Power Company in Washington, D.C. Retail prices set by these firms are regulated by state
Public Utilities Commissions such that they earn a market rate of return on investment. The model
will abstract away from the role of the retailer and directly model wholesale market demand curves.
PJM Interconnection, LLC, is a Regional Transmission Organization (RTO), charged by the
Federal Energy Regulatory Commission with operating and providing open access to the transmission network, clearing the market, and ensuring reliability and eﬃciency. This latter duty means
that PJM is responsible for limiting the exercise of unilateral market power and is interested in
market design that can help it to do so. As part of the regulatory arrangements that grew out
of US electricity restructuring, PJM also maintains an independent Market Monitor charged with
market design and oversight. PJM operates several markets, the largest of which are the Energy
and Capacity Markets.
The Energy Market is a daily reverse auction for electricity. The day before each Energy Market, every generating unit submits a supply function consisting of a maximum of ten segments, plus
startup costs. Given a set of bids by generators, quantities demanded by customers, and transmission constraints, PJM sets the lowest-cost production schedule and computes the Locational
Marginal Price at each node of the transmission network7 .
Producers’ incentives to exercise market power in the Energy Market depend on their net long
or short position when they submit bids. On the order of ten percent of electricity is sold at
spot through the Energy Market8 , while the remainder is sold via bilateral contracts or transferred
within vertically-integrated firms. A generating company that already has fixed price contracts for
all of its production has no incentive to aﬀect prices in the Energy Market. Many of the firms in
PJM are vertically integrated between electricity generation and retail. If a firm’s retail obligations
7

The Energy Market actually comprises two auctions, the Day-Ahead Market and the Balancing Market. It is
straightforward to arbitrage between these two markets, and annual average prices for the two markets diﬀered by
$0.16 per megawatt-hour in 2002. There are restrictions on modifying bid schedules between the two markets, in
particular to discourage firms from withholding from the Day-Ahead market.
8
This figure is made public in PJM’s State of the Market report, and it varies by year and by their calculation
method.

6

in a particular hour exactly match its production, it similarly has no incentive to exercise market
power. Financial hedging, through instruments such as options and futures, is also commonplace,
but there is little useful public data on firms’ hedge positions.
As Table 9.3 shows, PJM had a Herfindahl index of 926 over the study period. As the first order
conditions for profit maximizing bids will indicate, however, firms set prices for each unit based
on the concentration of competing firms’ capacity in the same price range. The Herfindahl index
is higher in particular portions of the supply curve, ranging from 1170 between $0 and $50 bids
to 4301 for bids between $500 and $1000. The PJM Market Monitor estimates that the average
markup of market-clearing bids over marginal cost averaged 10 percent in 2003, with much higher
markups in peak hours.
Since generating firms are often regional, transmission constraints can produce highly concentrated local markets. In the Energy Market in 2003, the Market Monitor’s primary tool for
restraining the exercise of local market power was oﬀer capping, in which any unit whose operation
was required to relieve a transmission constraint had its bid mitigated and instead received its
reported marginal cost plus ten percent. On average, two to three units were oﬀer-capped in each
hour of the study period. Although oﬀer capping means that it is diﬃcult for firms to capitalize
on local market power, firms still may exercise market power generated by higher concentration
in particular ranges of the market-wide supply curve, in particular during peak hours. Therefore,
my model will endogenize this exercise of market-level market power, while abstracting away from
local market power.
PJM’s second largest market is the Capacity Market. Each year, PJM predicts the quantity to be
demanded in the peak hour three years hence and increases this by a 13 percent cushion9 called the
Planning Reserve Margin, thereby arriving at the Reserve Margin requirement. In practice, revenues
from the Energy Market and payments for other "ancillary services" are insuﬃcient to maintain
that amount of capacity, and there is some shadow cost of the additional entry or forestalled exit.
The Capacity Market was designed to ensure suﬃcient capacity as demand grows over time by
transferring that shadow cost to producers. This is purely an administrative market; no actual
electricity is traded.
To operationalize the Capacity Market10 , PJM’s analysts set a simple, aﬃne, downward sloping
demand curve such that they expect market clearing quantity to be near the Reserve Margin requirement. Incumbent firms and entrants bid their capacity into the auction, and the market clears
at the intersection of the aggregate capacity supply curve and the administratively-determined demand curve. Plants later receive their Capacity Payment based on the proportion of peak hours
when their capacity is available, and each Load Serving Entity pays a share of total Capacity Mar9

The Reserve Margin is technically defined as 15 percent, but it is modeled here as 13 percent because this is
where the administratively-determined demand curve is actually designed to intersect the projected cost of new entry.
10
This describes PJM’s Reliability Pricing Model (RPM) Capacity Market design, which was implemented on June
1, 2007. I focus on the current capacity market because I am interested in simulating future entry. Because I use the
2003-2004 auction results to simulate the short-run equilibria, the Energy Market discussion focused on the rules in
eﬀect at that time.

7

ket costs proportional to its share of peak load. The two other major wholesale electricity markets
in the eastern United States also include Capacity Markets, and so the model I employ and the
resulting intuition is generalizable beyond PJM.

3

Demand Functions

The simulation model will require demand parameters  and  for two diﬀerent market segments,
the "Smart Grid Group," which for the sake of argument is assumed to be one-fifth of the market,
and the "Rest of Market." To keep the demand side as simple and as transparent as possible,
I use a simple semi-log demand specification11 with no substitution across hours12 . Combining
the quantities demanded for the two market segments, the aggregate wholesale market demand
function13 for hour  of day  is:
³
´
e

(
)
=
(
+
e

)
·
log(
)
+

+







(2)

e
   = Demand parameters for Smart Grid Group and Rest of Market, respectively
e
     = Demand shifters for Smart Grid Group and Rest of Market, respectively

All parameters are the same in both future counterfactuals, except that e
 takes value zero in the
"No Smart Grid" scenario and some non-zero value in the "Smart Grid" scenario. Each parameter
has distinct economic implications. The bigger e
 is, the more that equilibrium prices, markups,
and entry will vary between the No Smart Grid and Smart Grid counterfactuals. The demand
shifters  and e
 reflect underlying hourly demand patterns - how much power consumers want on
a hot summer day, for example, or on a mild afternoon in a "shoulder month" in the spring or fall.
The distribution of these parameters, which some call the "peakiness" of load, will influence the
distribution of equilibrium prices and the relative profitability of diﬀerent entrant technologies.
11

There is very little evidence on the shape of demand functions for any customer type, but this specification gives
the intuitive result that the absolute change in quantity demanded for a given absolute change in price is decreasing in
price. Most previous econometric estimations and market simulations, including Wolak and Patrick (2001), Borenstein
(2005), Holland and Mansur (2006), and others, specify constant elasticity, also implying decreasing absolute changes
to quantity demanded per unit change in price. While this seems reasonable in some ranges of price, it is also possible
that there is relatively little elasticity until price reaches some threshold.
12
Assuming away substitution across hours substantially simplifies the producer’s problem and the equilibrium
computation, and this specification will still produce the key desired result that equilibrium quantity demanded will
increase during the oﬀ-peak hours and decrease on-peak.
13
The demand function for the Rest of Market group, and analogously for the Smart Grid group, can be derived
using Roy’s identity from the following indirect utility function:

 =−






− · ( log  +   − )

This will be used later for welfare analysis.

8

(1)

Baseline demand parameters are specified to correspond to the weather and market conditions
over the April 2003 to March 2004 study period. The Rest of Market demand parameter  is
calibrated based on the proportion of consumers on diﬀerent pricing structures in 2003 and the
demand elasticity estimated in Patrick and Wolak (2001)14 . The total demand shifters  + e
 are
then backed out from the observed market level equilibrium prices and quantities for each hour the
simulation study period. Because I assume for the counterfactuals that the Smart Grid Group is
one-fifth of the market, the Rest of Market demand shifter is simply 80 percent of the total demand
shifter. To project into the future and accommodate entry in the simulations, the demand shifters
are inflated to reflect a continuation of recent demand growth trends.
For the 8 average gigawatts of Smart Grid consumers, I simply want some sensible assumption
for e
 , and I also will carry out two sensitivity analyses, with e
 increased and decreased by 50 percent.
I use e
 = −650 megawatts per log(dollar per megawatt-hour) for the "Smart Grid" scenario, which
corresponds to a price elasticity of approximately -0.1. The e
 parameters are such that the Smart
Grid group demand functions are "anchored" at $25/MWh, meaning that quantity demanded is
above (below) one-fifth of the original observed market quantity when prices are below (above)
$25/MWh. At a price of $100/MWh instead of $25/MWh, which is the 98.5th percentile of prices,
this implies that the Smart Grid Group demands 400 MW less power than it does at $25/MWh,
or about 5 percent. At $200/MWh, the Smart Grid Group would demand 600 MW less, or about
7.5 percent.

4

Data

There are three primary data sets, all relevant to the April 2003 through March 2004 study period.
The first dataset includes entrants’ fixed and variable cost parameters, as detailed in Table 9.2.
These are from publicly-available engineering data, which are considered to be reasonable representative estimates, and they therefore need not be estimated. Entrants’ input costs, specifically
for fuel and tradable air pollution emission allowances, are set to match those observed over the
study period.
The second dataset includes the bids from all auctions over the study period, which PJM makes
available on its website after a six-month delay. The firm and unit identifiers in these data are
masked but consistent. These publicly-available bids will be used to non-parametrically estimate
the distribution of opponents’ bids that each firm perceives. Table 9.3 details these data, including
the number of firms, average bids, Herfindahl indices, and input and output prices over the study
period. Figure 10.3 illustrates the supply functions oﬀered by several example firms on an example
day.
14
The Rest of Market segment includes larger commercial and industrial consumers that already had real time
electricity pricing, as well as residential, commercial, and industrial consumers that do not. PJM (2004) reports that
there were 1978 megawatts (MW) of large commercial and industrial customers already on RTP in 2003. Applying an
elasticity of -0.045 to this group, which approximates the results from Patrick and Wolak (2001), this gives  = −300.

9

The third dataset contains the bid and confidentially-reported marginal cost functions for all
incumbent firms during the study period. The PJM Market Monitor has taken the unusual step
of allowing my access to these data for the purposes of this study. By law, each generating unit in
PJM must confidentially submit its marginal cost function to the Market Monitor, which uses the
information to set the oﬀer caps paid if the unit’s bids are mitigated due to local market power.
In practice, there are no great concerns that the marginal cost data are biased due to strategic
misreporting15 . Table 9.4 presents the distribution of markups observed over the study period.
These data are very useful for two reasons. First, without the confidential cost estimates, I would
have followed the typical electricity market model by computing unit level marginal costs from
public data on on the monthly average "heat rate" (the rate of transformation of fuel to electricity)
and estimated fuel costs. While this publicly-available information is extraordinarily detailed and
accurate in comparison to the data available to study other industries, it is still problematic. Using
a monthly average heat rate does not capture nonlinearities in the production function, and in
particular the eﬃciency loss as a unit operates near capacity. This causes the analyst to understate
firms’ costs at high quantities and thus overstate markups. In this application, overstating initial
markups would cause the model to overstate the eﬀect of additional demand elasticity in reducing
those markups. Furthermore, plants have diﬀerent contractual arrangements for fuel that are not
observed in the public data, and using regional averages adds noise to the cost estimates.
Second, even if these cost estimates were reliable, it is diﬃcult to correctly match them to the
masked firms identifiers in the publicly-available bidding data. Having matched bidding and cost
data allows me to take costs as known, unlike in the typical empirical auction analysis, which estimates bidders’ costs or private values. This allows me to instead model unobservables corresponding
to forward contract positions, which are not fully observable. Both theoretically and empirically,
these forward contract positions are well-understood to aﬀect bidding behavior in multi-unit auctions, and in electricity markets in particular (e.g. Bushnell, Mansur, and Saravia (2008), Gans
and Wolak (2008), Wolak (2003, 2005)).

5

Second-Stage Subgames: The Energy Market

5.1

Model Overview

The second stage subgames determine hourly market clearing prices and quantities for each of
the 365 daily Energy Markets over the simulation. These equilibria are computed conditional on
the demand functions described in the previous section, incumbents’ exogenous available capacity,
15

The Market Monitor’s analysts check the reported costs against historical public and confidential heat rate and
fuel cost data and contact a firm if they believe that the firm has misreported; this occurs perhaps once or twice
each month. The most common discrepancy between the Market Monitor’s estimate and a firm’s reported cost is not
from strategic misreporting, but when "dual fuel" units switch inputs between natural gas and fuel oil. If a firm is
believed to be intentionally misreporting, it is reported to the Federal Energy Regulatory Commission and can be
prosecuted for fraud.

10

and the total capacity of each entrant technology as determined by the first stage. This section
derives the first order conditions, specifies firms’ beliefs over other firms’ bids, backs out unobserved
forward contracts implied by the initial study period equilibrium, and finally implements a learning
algorithm to move from the initial equilibrium to the future counterfactuals.
Before proceeding, it’s important to lay out why learning could be one of the sensible ways
to simulate counterfactuals in this setting. The motivating concern is that there may be multiple equilibria in multi-unit auction games. This has been shown in the complete information
supply function equilibrium (SFE) setting by Klemperer and Meyer (1989) and in the incomplete
information share auction framework by Wilson (1979).
A common response to multiple equilibria in any setting is to restrict the game such a unique
equilibrium exists. Unfortunately, an equilibrium has been shown to be unique only under assumptions that are unrealistic in this application, including linear supply functions, symmetric firms
(Green and Newbery 1992), constant marginal costs (Holmberg 2007), or fully inelastic demand
(Holmberg 2008). An alternative simplification is to assume that firms play a Cournot game. Not
only is this unsatisfying in the sense that it bears little resemblance to the actual price setting
process in electricity markets, it has been shown that Cournot prices are higher than any obtainable in supply function equilibrium except at the highest realization of the demand shifter (Green
and Newbery 1992, Baldick and Hogan 2006)16 .
Learning algorithms exploit the fact that past equilibria provide information useful for equilibrium selection, making assumptions on how firms move from past to future equilibria while
relaxing the above assumptions about firms and their strategy spaces. Myopic learning algorithms,
in which agents iteratively best respond to opponents’ play from previous iterations, are most commonly used because myopia greatly reduces computational and conceptual complexity17 . Learning
for equilibrium selection has seen several more recent applications in counterfactual simulations,
including Lee and Pakes (2009) in the banking industry and Rudkevich (2005) in electric power.
Electricity markets are a particularly reasonable place to use myopic learning for equilibrium
selection. The complexity of firms’ decision problems suggests that they might experiment with
diﬀerent strategies instead of directly solving for an equilibrium18 , and the daily repetition of
auctions provides them with ample opportunity to do so19 . There is anecdotal evidence that
16

If the distribution of the demand shifter has small support over the period during which bids are valid, as it would
in a market that allows separate bids for every hour, then Cournot may be a reasonable model. In most markets,
including PJM, bids must hold for an entire day, over which the demand shifter varies substantially.
17
The oldest and perhaps most familiar example of a myopic learning algorithm is Cournot Adjustment, in which
firms iteratively set quantities that best respond to the opponent’s play from the preceding period. Under appropriate
assumptions, this system converges to a fixed point, which is the Cournot equilibrium.
18
Wilson (2008) characterizes the equilibrium in a transmission constrained electricity market and concludes that
"The results presented here are not especially encouraging . . . If the conditions for an equilibrium are so complicated
as to impede academic and policy studies, then perhaps it is implausible to suppose that firms’ bidding strategies
approximate an equilibrium." He then points out that firms need only observe their own residual demand curve and
suggests that "some experimentation can complement observed market data to provide the requisite estimates."
19
Green and Newbery (1992) write that "since the bidding process is repeated daily and bids are published shortly
after they are made, we do not feel that there would be any "learning" problems in reaching these equilibria."

11

such experimentation occurs20 and empirical evidence that firms learn over time towards profitmaximizing bids21 .
There are several reasons to be cautious about using learning for equilibrium selection. First,
although it seems plausible that some form of learning may occur in this setting, there are a
panoply of apparently-reasonable learning algorithms, and Lee and Pakes (2009) find that diﬀerent
algorithms can lead to notably diﬀerent results. While I will focus on results from one particular
algorithm, I will also document that other plausible algorithms lead to similar counterfactual equilibrium bids. Second, learning algorithms sometimes do not converge to an equilibrium and instead
cycle between actions, making results diﬃcult to interpret. Principally because of the uncertainty
over competitors’ bids, however, the algorithm does converge to a pure strategy Bayesian Nash
equilibrium.
A third reason to be cautious in applying learning algorithms is that the assumption that
agents are myopic, or alternatively that they believe that other agents’ strategies are static, is often
implausible (Fudenberg and Levine 1998). The rollout of the Smart Grid to residential customers,
however, would occur gradually over a period of years. Between any two daily iterations, the change
in demand patterns would be very small, and firms’ strategies thus close to static, other things equal.
Furthermore, because opponents’ bids are not released until six months after the auction, firms are
less likely to exploit the repeated nature of the game to enforce dynamic collusive equilibria. While
the claim is not that firms literally follow myopic learning algorithms, this does appear to be a
potentially-sensible alternative approach.

5.2

Setup and First Order Conditions

Before beginning, note that much of the upcoming discussion applies only the incumbents in the
market during the April 2003 to March 2004 study period; the second-stage behavior of entrants
will be discussed later. Also, instead of estimating and resimulating each of the 365 auctions,
I reduce computational burden by focusing on 24 auctions, one for each day type (work day or
weekend) in each month of the year22 . To compute counterfactual equilibria, the aggregate supply
20
Cramton (2004) writes that "In some cases, I have observed power companies explicitly compute the residual
demand curves in order to determine their optimal price-quantity bids in power markets. In other cases, I have
observed the companies pursue a more experimental approach, where strategies are based more on intuition and
experience, which are then adjusted in response to performance."
21
Sioshansi and Oren (2007), for example, show that bids in the Texas market by a firm called Calpine move over
time toward the authors’ estimated ex-post profit maximizing supply functions. Hortacsu and Puller (forthcoming)
show that firms’ profits increase towards their ex-post profit maximizing benchmark at a rate of 3 percentage points
every 100 days.
Note that the "learning" implied by these analyses is movement from suboptimal play towards optimal play, while
my learning procedure will model learning from observed play that is assumed to be optimal to optimal counterfactual
play. I thus use these papers to motivate "learning" only in a loose sense.
22
This is reasonable because there is surprisingly little day-to-day variation in bids: most of the variation is as
input prices rise and fall over months and as firms take units oﬄine for extended maintenance in the spring and fall.
Two auctions are selected for each month, the first Wednesday and the first Saturday.

12

function from each of these 24 auctions is used for all of the corresponding workdays or weekend
days of the month.
I model an auction game in which a set of firms submit profit maximizing bid functions in pure
strategy Bayesian Nash Equilibrium. There is a set of firms F bidding into each auction . Each
firm submits a supply function   ( ), where  indexes firms and  indexes the day corresponding
to the auction  of the same day type and month. Recall that supply functions are simultaneously
submitted the day before the auction for which they are valid, and they hold for the entire day.
Making the strong but common assumption that there are no transmission constraints23 , the hourly
market clearing condition is:

∗
  (
)+

X

∗
∗
  (
) = 
 ( )

(3)

 ∈
∗ = Realized market-clearing price for hour  of day 

  ( ) = Import supply function (See Appendix I)

Each firm’s supply function   ( ) is a step function composed of the price and quantity for up
to ten segments for each of the firm’s generating units. Segment lengths are highly consistent across
auctions, as firms base them primarily on features of units’ production technologies. I therefore
model that the action space includes only the prices   ∈ [0 1000] for the segments  = 1   
available in auction , while the segment length   is exogenous. The set of segments J  available
in each auction is a function of maintenance decisions and forced outages, and this is also modeled
as exogenous. Each segment has constant marginal cost 0  ∈ [0 1000], which varies from day to
day due to changes in ambient temperatures24 , fuel prices, and other factors.
As discussed in the market overview, there is substantial financial hedging, long term contracting, and vertical integration, meaning that a firm’s profits on a particular day depend on prices
and quantities of electricity sold forward as well as electricity sold into the Energy Market. For
each hour  of auction day , firms have contracted forward a quantity   of electricity at price
   . These contracts are assumed to be fixed before bids are set.
23

Failing to model transmission constraints abstracts away from interesting strategic issues. As characterized in
Wilson (2007) and Hogan (1997), transmission constraints aﬀect how one unit’s bids aﬀect profits earned by the firm’s
other units at diﬀerent nodes of the network. Some firms, and in particular those that own a small number of units
exempted from oﬀer capping due to a loophole in federal regulations, are able to modify bids for plants on one side
of a transmission constraint so as to increase the Locational Marginal Prices received by their plants on the other
side. In theory, the returns to this form of strategic behavior would be lower if the short-term price response inside
the transmission constraint were stronger. Furthermore, the model determines only one system-wide hourly price,
meaning that it cannot capture the reduction that short-term price response could cause in relative price volatility
between diﬀerent locations in the transmission network. It is not obvious, however, that the abstraction away from
transmission constraints would substantially aﬀect the predicted market-wide welfare eﬀects. Much of the economics
literature similarly assumes away transaction constraints, although it is acknowledged that this is unsatisfying.
24
Air temperatures aﬀect power plants’ production functions, and some plants that discharge cooling water into
rivers are restricted from doing so when water temperatures are high.

13

At the time of submitting bids for auction , firms have some information set Ω  regarding
the distribution of demand and opponents’ bids. From bidders’ perspectives, the slopes of import
supply and of the demand functions are known, but the 24 hourly demand shifters   and e
  that
will be realized over auction  are stochastic. Firms’ beliefs about other firms’ bids −  , which hold
constant across all hours of auction , will be detailed momentarily. For notational convenience, I
define a vector   ≡ {   e
   −  } that contains all the variables uncertain from the perspective
of firm  . The elements of   have continuous joint distribution  (  ) over support U  25 .
The PJM system operator clears the market in each hour and "rations" the marginal segment
such that market-level quantity supplied equals quantity demanded. I define a variable  =
 (     ) to be the quantity of segment  that would be dispatched into the market as a
function of firm  ’s vector of bids   and a realization of uncertainty   . The segment is not
dispatched if its bid is above the market clearing price, fully dispatched if it is inframarginal, and
partially dispatched if it is the price-setting segment:

 = 0
 =   
0 ≤  ≤   

   
   
  = 

(4)

 =  (     ) = Price in hour  of auction 
A risk-neutral firm submits a vector of bids   for its set of segments J  to maximize profits
earned over the 24 hours of auction day :

max [   |Ω  ] =
 

⎧
24 Z ⎨
X
=1U
 

⎩

P

∈J 

( − 0  ) · 

+     −   

⎫
⎬
⎭

 (  ) 

(5)

A key insight is that the first order condition for segment ’s profit-maximizing bid can be
simplified by the fact that the segment only sets prices in some states of the world. In all other
regions of the distribution of   , the segment is either inframarginal or extramarginal, and marginal changes in its bid   do not aﬀect profits. In the states of the world in hour  where segment
 is marginal,  =   , all of the firm’s segments with bids less than   are dispatched with
certainty, and all segments with higher bids are not dispatched. The first order condition is thus:
25
To rationalize observed bids, the support U must be suﬃcient to produce a distribution of equilibrium prices that
spans the range [0 990]. There is often a higher density of bids between $990 and the $1000 price cap, and these bids
are assumed to be exogenous because they are often intended to reduce the probability that a unit is dispatched to a
negligible amount. Firms may do this because their Capacity Market payments are based on the percentage of hours
that they make capacity available to the market. If they report a maintenance outage, they lose Capacity credit, but
by bidding above likely realizations of the market price, they can earn credit while actually having their units oﬄine
for maintenance. These rules are under review by PJM.

14

24

[   |Ω  ] X  [   |Ω  ]
=
| =∗  = 0
 
 

(6)

=1

The function inside the integral is continuous because of the pro-rata rationing of  when 
is on the margin, so the order of integration and diﬀerentiation can be reversed. The above first
order condition therefore also equals:

=

24
X

Z

=1U | =∗
  
 

⎧
⎪
⎨


⎪
⎩ +  +

 ∗
  ( 

P

− 0  )

∈{J  |    }

⎫
⎪
⎬

  −   ⎪
⎭

 (  | = ∗  ) 

(7)

Each of the additive terms in the FOC can be simplified. First, since the firm’s quantity supplied
equals its residual demand   , the change in the marginal unit’s quantity dispatched equals the
slope of residual demand at price   :

 

= 0  (  )

(8)

Second, a term   can be defined that captures firm  ’s expected total quantity dispatched
when segment  is on the margin. Under the approximation of a continuous supply function26 , this
term includes all inframarginal segments and the entirety of segment  itself:
26

Diﬀerent forms of continuity assumptions are made by Hortacsu (2002), Hortacsu and Puller (2008), and the first
sections of Wolak (2003). While Kastl (2009a) shows that this discretization can produce biases, Kastl (2009b) shows
that the true discrete first order condition is equivalent to the continuous FOC holding on average over each step,
and as the number of steps grows, the discrete FOC limits to the continuous case. Discretization seems reasonable
given than fewer than ten percent of units use the full ten steps in the study period auctions, which suggests that
the requirement of discrete bids does not constrain their perceived ability to approximate profit maximizing supply
functions.
The fact that firms do not use all of their available steps is remarkable, because the closest mathematical approximation to the continuous profit-maximizing supply function would require all allowable steps. There are at least
three potential explanations. First, it has been suggested that firms do not submit complex step functions for fear of
drawing attention to an exercise of market power. This is problematic for the discretization of the continuous FOC,
because it implies a cost to bidding additional steps, causing discretization to be biased in the sense of Kastl (2009a).
Second, as suggested in the text, firms may use heuristics based on their units’ marginal cost functions to determine
segment lengths. Marginal cost functions for the typical generating technology can be closely represented with fewer
than ten steps.
Third, the observed bids may closely approximate profit maximizing strategies, as losses from submitting an
incomplete bid schedule are small. Kastl (2009b) shows that the losses from bidding a spline instead of a continuous
function are small for a firm with many units, as they decline by the square of the number of bid points. Hortacsu
and Puller (2008) show computationally that the losses from setting ex-post suboptimal bid prices for existing steps
dwarf the losses from submitting a bid schedule with too few steps.

15

X

 +

∈{J  |    }

  ≡  

(9)

Finally, a term   is introduced, which represents the firm’s expected forward contract quantity
in the states of the world in which segment  is on the margin:

24
X

Z

=1U | =∗
  
 

  ·  (  | =

∗  ) 

=

24
P

=1

  Pr( =   |Ω  )
24
P

=1

Pr( =   |Ω  )

≡  

(10)

  that rationalizes
This variable   is modeled as unobservable, and there is a quantity b
the observed bid for every segment in each auction. Making these substitutions and re-arranging,
we have that the following first order condition characterizes profit-maximizing bids in a Bayesian
Nash Equilibrium:

∗  −

  −  
= 0 
−[0  (∗  )|Ω  ]

[0  (  )|Ω  ] =   −   − 
  = Slope of import supply

"

P

6=

(11)

#

0 (

  )|Ω  = Expected residual demand slope

This first order condition is similar to the complete information Supply Function Equilibrium
first order condition derived by Klemperer and Meyer (1989), except with residual demand replaced
by an expectation of residual demand. The numerator   −  can be thought of as total capacity
inframarginal to   that is exposed to the prices of auction  instead of being contracted forward.
If   =   , all capacity is contracted forward, there is no incentive for bid shading, and setting
∗  = 0  maximizes profits.
The first order condition also resembles the standard monopoly pricing first order condition,
as bidding a supply function allows the firm to operate as a monopolist over residual demand at
all points. The left hand side of the first order condition is marginal revenue. From oﬀering a
marginal unit of capacity at price ∗  , the firm receives revenue ∗  from the additional sale, but
 − 
this reduces expected revenues from inframarginal capacity by −[ 
. The first order
0
  (  )|Ω  ]
0
condition equates this marginal revenue with marginal cost   .
As in any standard price setting problem, as residual demand becomes more elastic, profit
maximizing markups are lower and prices approach marginal cost. This is the formal illustration of
16

why the Smart Grid, real-time pricing, and other forms of demand response reduce the exercise of
market power in electricity markets. For the counterfactuals, the additional demand slope e
 
from the simulated Smart Grid Group will be added to the existing demand slope   in the
specification of firms’ residual demand. For the moment, notice that for the Smart Grid’s eﬀects
to be consequential, the additional demand slope must not be negligible compared to the existing
slope of residual demand.
While this approach is not unfamiliar, it contains several improvements over previous approaches to estimating multi-unit electricity auctions. The Wolak (2003) approach generates more
algebraically-complex FOCs where the optimal bids for one segment depend on functions of the
bids for the firm’s other segments. By assuming that other segments’ bids were set optimally,
recognizing that the FOC is automatically zero in the states of the world when the segment is not
marginal, and admitting a common assumption about continuity, I generate a much simpler FOC
that does not depend on the bids for the firm’s other segments. Furthermore, while the FOC is as
simple as the complete information SFE case or the Hortacsu and Puller (2008) ex-post optimal
case, we will see presently that this derivation admits incomplete information consistent with the
typical empirical auctions approach.

5.3

Firms’ Beliefs

Firm  ’s expectation of residual demand slope [0  (  )|Ω  ] is conditioned on an information
set that is unobservable to the analyst. There have been several approaches to this problem.
The standard supply function equilibrium setup assumes complete information, with uncertainty
entering the firm’s optimization problem only through the demand shifter . Since  only shifts the
residual demand curve horizontally, firms have no uncertainty about the slope of residual demand
0  (  ), and the expectation operator is removed. Complete information means that firms’ bids
are ex-post optimal, meaning that they are best responses to opponents’ realized bids for auction .
A second approach is to pool bids across multiple auctions and use a kernel smoothing procedure
to determine a continuous distribution of competitors’ bids. Inference about primitives is then made
under the assumption that each firm’s bids maximized profits subject to that distribution, following
the approaches of Guerre, Perrigne, and Vuong (2000) and Hortacsu (2002). The challenge in this
setting is heterogeneity across auctions: firms’ marginal costs change from day to day, and the
composition of bidders changes as units go oﬄine for maintenance. If firms observe heterogeneity
that the analyst does not capture, pooling bids across auctions causes the analyst to overstate
the extent of firms’ incomplete information, which can cause biased estimates of the underlying
primitives, as illustrated by Krasnokutskaya (2009).
In response to the heterogeneity problem, Hortacsu and Puller (2008) and Kuhn and Machado
(2004) employ a third approach, an a priori assumption that firms’ supply function strategies
be additively separable in price and private information. This implies that one firm’s private
information can shift other firms’ residual demand horizontally, in the same way that the uncertain
17

demand shifter  shifts residual demand, but the slope of residual demand is certain. As a result, we
have the same ex-post optimal first order condition, again without the expectation operator. Under
this restricted form of incomplete information, inference on the primitives in each auction could
be made using only the bids from that auction, obviating the need to pool across heterogeneous
auctions.
My approach pools across auctions and adjusts for heterogeneity by "homogenizing" bids using
segment-specific functions of observables, as inspired by Haile, Hong, and Shum (2006). I assume
that firms know which competitors’ segments  will bid into auction  and the lengths  of those
segments. Firms’ expectations of other firms’ supply functions are characterized by the following
equation:
⎡

⎣

X

∈{F \ }

⎤

 ( )|Ω  ⎦ =

X

X

∈{F \ } ∈J

1 X
 · 

∈D

Ã

 − e


!

(12)

 = Number of days that segment  of firm  submits bids over the study period
D = Set of days that the segment submits bids
 = "Length" of bid segment  of firm  in auction , in megawatts
e = Bid on day , homogenized to correspond to auction 
 = Kernel function
 = Kernel bandwidth
The homogenized bid prices over the entire study period for each segment that bids into auction
 are used to compute the firm’s expected residual demand slope. I assume that firms’ beliefs about
heterogeneity are captured by the following segment-specific polynomial series regression of bids on
observables over the set of days D that the segment is bid into the market:

 =

3
X
¡
¢

Γ 
+ Γ    + Γ   + Γ + Γ +  
=1

 = Natural gas spot price for day 
  = Temperature on day 
  = Maximum market-level quantity demanded on day .
Γ = Summer indicator variable, specific to segment  of firm 
Γ = Weekday indicator variable
  = Residual uncertainty

18

(13)

This regression predicts a bid b , as well as a fitted prediction error b
  , for each of the days
in D . Figure 10.4 illustrates this regression for two segments of an example unit. For this unit and
many others, bids hold constant across multiple days, which may reflect fixed price fuel contracts
or other inertia. The relative stability of bids at weekly frequencies suggests stable values of 0 
and   . Since bids are not made public for six months, however, these values are still unknown
to other firms, and most units’ bids change substantially before past bids are revealed.
The expected bid b is computed based on the observables corresponding to each of the 24
re-simulated auctions. I then generate a vector of length  of the homogenized bids for auction
 by adding the set of fitted prediction errors to b . This vector has the following characteristic
element:
e = b + b
 

(14)

Intuitively, this procedure computes the "average" supply curve across all days of the study
period, adjusting on observables for applicability to auction . Figure 10.5 illustrates firms’ expectations of the aggregate supply curve and its slope for an example auction on August 6th, 2003.
Notice that for much of the supply curve, the slope is steeper than 400 MW/($/MWh). For any
particular firm, the slope of its residual demand would be less steep, but of the same order of
magnitude. Under the demand parameters presented earlier, the additional demand slope from the
Smart Grid is -650/ MW/($/MWh), which even at the relatively high price of $100/MWh is -6.5
MW/($/MWh). This additional demand elasticity therefore has little eﬀect on residual demand
slope for any firm. Indeed, a very large demand response program would be required to measurably
aﬀect any firm’s residual demand slope. On the right side of the aggregate supply curve, however,
supply has a very steep slope, there are fewer firms bidding, and initial markups are substantially
higher. Additional demand elasticity from the Smart Grid could thus have a measurable eﬀect on
markups in that range.
Substituting these e back into the residual supply specification, diﬀerentiating, and inserting
this into the equation for residual demand slope, we have:

1
[0  (  )|Ω  ] =   −  −


X


X
1 X
 · 0


∈{F \ } =1

∈D

Ã

  − e


!

(15)

A triangular kernel is used for simplicity. Consistent with Hortacsu and Puller (2008), a
bandwidth is chosen such that approximately two-thirds of observations in the kernel fall within
$10/MWh of   .

19

Three implications of the above assumptions should be acknowledged. First, if linear functions
of econometric observables do not fully capture firms’ perception of heterogeneity across auctions,
the procedure overstates their uncertainty. Second, in this and any other auction estimations
where there may be multiple equilibria, pooling implicitly requires that the market is in the "same"
equilibrium over the study period. Third, this specification of beliefs is also heuristic, in the sense
that I have not specified a set of strategies consistent with these beliefs. This is a challenge in
the multi-unit setting because heterogeneity across days can aﬀect firms’ profit maximizing bids
through multiple channels - through costs 0  , unobservable forward contracts   , and through
the expected residual demand slope - which are not all additively or multiplicatively separable in
the first order condition. This diﬀers from the additively-separable homogenization possible in the
common value single unit setting of Haile, Hong, and Shum (2006). While this specification of
beliefs simplifies the analysis, it should be recognized as an a priori restriction.
This approach, however, may have substantial appeal over two previous approaches. First, the
ex-post optimality assumption, as in Supply Function Equilibrium and the limited-incomplete information setup of Hortacsu and Puller (2008), is diﬃcult to believe given that forward contracts
and plant-specific input prices change from day to day in ways unobservable to other firms. Furthermore, in any particular day’s auction, the realized residual demand curve is "lumpy," and at
high prices there may be substantial ranges within which there are only a few bids. As a result, the
choice of kernel bandwidth used to smooth competitors’ bids in estimating residual demand aﬀects
the predicted primitives. This bandwidth choice eﬀectively becomes the analyst’s opinion of the
precision with which firms perceived competitors’ bids: a large bandwidth means that even competitors’ bids that were realized far away from a bid aﬀected that firm’s belief of residual demand
slope, while a small bandwidth implies that the firm had more certainty about residual demand.
Second, heterogeneity has also been addressed by pooling across limited sets of auctions. Kastl
(2009a) pools only across the four neighboring auctions, while Gans and Wolak (2008) pool only
across auctions on days in neighboring months with similar peak quantity demanded. In my
application and many others, however, fuel prices are diﬀerent even from one month to the next, and
the composition of bidders changes as new plants come online and plants go oﬄine for maintenance.
Homogenization is therefore a useful additional tool.

5.4

Backing Out Unobservable Contracts

When estimating auctions, the marginal cost (or equivalently in an ordinary auction, the bidder’s
private value) is typically unobservable. Primarily because there is little public information on
financial hedging, however, forward contract quantities are diﬃcult to measure, and my access to
the confidentially-reported marginal cost data allows   to be unobservable. Given the above
expected residual demand slope and the firm’s bids and marginal costs, the unobservables b
  that
rationalize incumbents’ bids in each auction can be backed out:
20

b
  =   − (  − 0  ) · (−[0  (  )|Ω  ])

(16)

Figure 10.6 shows the distribution of implied unobservables across all 24 re-simulated auctions.


If b
  were taken literally as a measure of the firm’s forward contract position, the quantity 

represents the proportion of the firm’s inframarginal capacity that is contracted forward at the time
when segment  is expected to be on the margin. The majority of these realizations are between 0.5
and 1, with a higher density around 1. This is consistent with the high degree of vertical integration
and extensive forward contracting that exist in this market.
As in many applications, the profit function could be mis-specified. While the unobservable b
 
enters the profit function in place of forward contract quantities, it in reality captures all factors
that rationalize observed bids under my specification of the game. These factors may include
firms’ optimization error, a mis-specified economic environment, for example due to transmission
constraints, and mismeasured costs.
Although the cost data are very good, this source of specification error may be important. For
example, ramping constraints introduce dynamics into firms’ cost functions, inducing them to bid
units above or below their reported static marginal costs. Furthermore, some plants are limited
by environmental permits to a small number of annual hours of operation, and the shadow price
of this constraint is not currently included in the cost estimates submitted to PJM. The model,
however, interprets any diﬀerence between reported static marginal costs and observed bids as an
exercise of market power. If initial markups or markdowns were not actually an attempt to aﬀect
prices, the model will be mistaken in re-simulating these bids closer to marginal cost. To test the
importance of this sort of concern, the counterfactual simulations will include a sensitivity analysis
under the assumption that the data overstate true markups by a factor of two.

5.5

Counterfactual Bids via Myopic Best Response

Having estimated the initial equilibrium, I now turn to the counterfactual simulation procedure,
based on myopic learning. Both entry and the expansion of the Smart Grid would aﬀect incumbent
firms’ residual demand slope, which in turn changes their profit maximizing bids. For each segment,
holding fixed the initial   , b
  , and 0  , a new optimal bid can be computed in response to the
new residual demand slope27 . The changes in firms’ bids also aﬀect competitors’ [0  (  )|Ω  ],
so the best response process is iterated. For each iteration , each segment’s profit maximizing bid
  is the best response to the distribution of actions from the previous iteration:
27

Notice that the strategy space here only includes the oﬀer price of each bid segment, whereas firms might adjust
to real time pricing in ways other than their Energy Market bidding behavior. In particular, the unobservables 
 
are held constant. While this provides an appealing consistency between the initial and counterfactual equilibria,
the variance of hourly Energy Market prices diﬀers across the counterfactual scenarios, and this could change firms’
demand for hedge contracts if they are risk-averse. While modeling changes in forward contracting behavior would
be useful, I leave this for future analyses.

21

  =

  −  
+ 0 
−[0  (  )|Ω−1
]


(17)

Firms’ expectations must be updated between each iteration. I model that firms observe the
auction-specific change in opponents’ bids and update their mean expectation accordingly. The
vector that contains firms’ beliefs of the distribution of opponents’ bids now has characteristic
element:

e = b + b
  + ( − −1

 )

(18)

The equilibrium of the Energy Market game is the pure strategy steady state of this system,
such that firms’ beliefs about their residual demand curves are consistent with the distribution of
other firms’ bids. In practice, this steady state is defined by a suﬃciently small average absolute
percent diﬀerence  between bids from one iteration to the next:
¯
¯
−1
24

1 X 1 X 1 X ¯¯   −   ¯¯
¯
¯≤
¯
¯
24 =1 
 
0 
 ∈F

(19)

∈K 

K  = Set of segments oﬀered by firm  in auction 

Figure 10.7 illustrates this procedure on August 6th for an example firm. Across bids by
all firms, Table 9.5 presents the average absolute percent diﬀerence for the first iterations of the
example resimulated auction on that same example day. The algorithm converges to close to its
tolerance within 10 iterations.28
Figure 10.8 details the simulated change in markups from the introduction of the Smart Grid
for all firms in the auction on August 6th, 2003. Both negative and positive markups move toward
marginal cost, particularly for bids that were initially between $200 and $800. The eﬃciency gains
from these eﬀects will depend on how frequently these high-markup units are actually dispatched
in equilibrium.
28

Several other papers have experimented with learning-based algorithms in complete information electricity market
bidding models and shown that these procedures do not converge to stable pure strategy equilibria (Day and Bunn
(2001), Baldick and Hogan (2004)). As pointed out by von der Fehr and Harbord (1993), with step function bidding,
complete information about other firms’ bids would imply that firms maximize profits by iteratively undercutting
competitors’ bids. Because my formulation models incomplete information in the form of a continuous distribution
of beliefs about opponents’ bids with suﬃcient uncertainty, the algorithm can converge toward a stable pure strategy
Bayesian Nash Equilibrium. As one might intuitively expect, however, using a suﬃciently small kernel bandwidth
or re-simulating a more substantial change in demand parameters could cause the algorithm to cycle. This eﬀect is
more substantial for segments bidding at higher prices.
Outside of the multi-unit setting, incomplete information plays an analogous role: in the complete information
Bertrand game, prices equal marginal cost or exhibit Edgeworth cycles, but in first price auctions under incomplete
information, stable pure strategy markups exist in equilibrium.

22

This section has not yet discussed entrant firms’ behavior in the second stage. They are modeled
as having the same first order conditions, and their costs are from engineering data presented earlier.
These simulated entrants, however, have no initial b
. Although to derive a unique equilibrium in the
two stage entry game it is useful to assume that entrant capacity is atomless, example plant sizes
can be used to determine a reasonable value for this parameter. For peaker, combined cycle, and
baseload entrants, respectively, the unobservables   are set to correspond to 400, 500, and 1000
megawatt plants that enter the auctions 50, 80, and 95 percent hedged. Entrants’ residual demand
slopes are computed as if entrant plants of these sizes were unaﬃliated with other incumbent and
entrant firms. Because these entrant "firms" are small and because their bids are set against a
fairly elastic residual demand slope, their simulated markups are small, as shown in Table 9.2.
The simulated entrants, of course, did not submit a distribution of bids over the April 2003 to
March 2004 study period. For simplicity, I model that e =  for entrants, i.e. that competitors’
residual demand slope is computed from entrants’ actual bids, without additional uncertainty.

5.6

Alternative Learning Algorithms

Fudenberg and Levine (1998) and other work on learning in games has developed a multitude of
learning algorithms, many of which are equally plausible for equilibrium selection in an applied
setting. I experimented with a set of other common learning procedures to test the similarity of the
results. Under an "Immediate Update" specification, firms update their expectations immediately
after each competitor firm changes its bids, instead of updating only between iterations. Under
"Fictitious Play," firms’ expectations of a competitor’s bids are updated based on the average of
the competitor’s play in all previous iterations, instead of the play in the most recent iteration.
Under "Partial Best Response," the firms that change bids in each iteration are randomly selected
with probability 1/2. Under "Random Update Shock," firms’ beliefs are updated by the change in
competitors’ bids plus a mean-zero normally-distributed shock with standard deviation of one-half
of the change. Under "Random Bid Shock," firms bids (and competitors’ beliefs about those bids)
are the profit-maximizing bid plus a mean-zero normally-distributed error with standard deviation
of five percent of the markup. After the first 15 iterations, the random bid shocks are suspended,
and the algorithm is allowed to converge to a steady state equilibrium.
Table 9.6 compares the steady states of the alternative procedures. The first row presents
the average absolute percent diﬀerence between the initial equilibrium and the steady state of the
myopic best response learning procedure detailed above. The subsequent rows are the average
absolute percent diﬀerence between the myopic best response steady state and the steady state
under each alternative procedure. The results indicate that although the diﬀerent algorithms should
not be expected to converge to precisely the same steady state, they converge to counterfactual
equilibria that are within 15 to 25 percent of the distance from the initial equilibrium.

23

6

First Stage: Entry Decision and the Capacity Market

Each firm’s Energy Market profits in the equilibrium determined by the above learning algorithm
become the part of the payoﬀs in a two-stage entry model. This section details the first stage,
where the set of players are potential entrant firms of three technologies whose action spaces are
amount of capacity entering. The model builds on Borenstein (2005), but it diﬀers by including a
set of incumbent firms with exogenous capacity and by incorporating the Reserve Margin, which
in equilibrium constrains the sum of entering capacity across the three technologies. A unique
equilibrium in entering capacity is determined by zero-profit conditions: Energy Market revenues
(determined in the game’s second stage) plus Capacity Market revenues (the shadow price of the
Reserve Margin) equal fixed costs.
It will be clear that the entry model is a highly stylized version of reality, and some the assumptions required for uniqueness will be strong. As the results will show, however, some model of
entry is critical to understanding the eﬀects of the Smart Grid and real-time pricing. Furthermore,
this relatively simple two-stage model gives intuitive insight into how Capacity Markets work in
equilibrium.

6.1

Detailed Setup

The three entrant technologies, peaker, combined cycle, and baseload, are indexed by  ∈ {  }.
There are a large number of potential entrant firms with each technology. Every unit of capacity
within a technology is atomless and homogeneous: per-unit fixed costs are constant, there are
constant returns to scale, and capacity within each technology behaves identically in the second
stage Energy Markets. Although new plants may in reality be built by incumbent firms, I assume
that all new capacity is independent.
The players are potential entrants  , each with one technology . Their action spaces are to set
a non-negative capacity   ∈ [0 ∞). This results in a vector  = {     } of total entering
capacity of each technology29 . Because capacity within each technology is homogeneous, this vector
completely summarizes first stage outcomes; entrant plant size and the number of distinct firms
that own these plants are both indeterminate. The set I of 45 incumbent firms in PJM have
existing capacity  ∈ {1  2   45 }.
Each unit of capacity that actually enters incurs a certain annualized fixed cost   . Because
this is a static game and entrants thus cannot later exit, this fixed cost combines the amortized sunk
cost of entry as well as annualized fixed operating and maintenance costs. Although the second
stage includes incomplete information and uncertainty over demand from day to day, the sum of
entrants’ second stage profits over the life of the plant is assumed to be known with certainty. For
29
Although in reality there is a lower bound on plants’ eﬃcient scale and the standardized sizes of gas and steam
turbines mean that capacity investment is lumpy, I assume that potential entrant firms can set any nonnegative
capacity in the first stage. Given that the equilibrium quantity of entering capacity that will be computed represents
a number of discrete plants, this assumption should not substantially aﬀect the results.

24

firms of each of the three entrant technologies, the annualized profit function per unit of capacity
is:

Π () =  () +  −  

(20)

 () = Second stage net profits from the Energy Market
 ≥ 0 = Capacity Market price
  = Annualized fixed cost
(All units in $(  · ))
The equilibrium is such that no entrant firm could make higher profits by not entering, and
no potential entrant who does not enter could make higher profits from entry. Since profits from
non-entry are defined to be zero, actual entrants must also earn zero profits. An equilibrium vector
of entering capacity  ∗ thus must fulfill the following zero profit conditions:
(

6.2

Π ( ∗ ) = 0 ∗  0
Π ( ∗ ) ≤ 0 ∗ = 0

)

 ∀ ∈ {  }

(21)

The Capacity Market

The Capacity Market is fundamentally a mechanism to transfer the shadow price of the Reserve
Margin constraint to capacity owners. To model this market, I make three assumptions. First,
because sunk costs are relatively large, it is not unrealistic to assume that all incumbents clear in
the Capacity Market, meaning that no incumbents exit and entrants are the marginal suppliers
of capacity30 . Second, the highly inelastic, administratively-determined Capacity Market demand
curve is modeled as fully inelastic. Third, the distribution of entry has a negligible eﬀect on the
markup of the marginal Energy Market bidder in the maximum-demand hour31 .
As a result of these, the Reserve Margin implies a constraint on total entry across the three
technologies:
30
In practice, this is quite realistic: an analysis of the 2008 PJM Capacity Market shows that nearly all of incumbents’ bids were below the projected equilibrium bids of entrants (Pfeifenberger, et al, 2008). Similarly, abstracting
away from exit is not unreasonable in this industry: over the most recent ten years, for every megawatt of new
capacity constructed in the U.S., 0.11 megawatts were retired (US Energy Information Administration 2008b). This
most recent period may be somewhat unusual due to faster demand growth, a large amount of entry, and high input
and output prices. Even over longer periods, however, power plants have proven surprisingly durable.
31
This is reasonable given that entrants’ bids are always less than $100/MWh, while the market clearing bid in
the maximum-demand hour, submitted by an incumbent unit, is approximately $300. The benefit of this assumption
∗
is determined independently of the distribution of entering capacity, which helps ensure
is that total entry 
uniqueness and simplifies computation.

25

X

∈{}

∗
 ≥ 

(22)

∗ required in equilibrium under the 13 percent Reserve Margin constraint is
The total entry 
characterized by the following equation:

∗
e
113 · 
 (       ) =

X

∗
∗
∗
  (
) + 
+   (
)

(23)

 ∈F

 = Hour of maximum total demand shifter   + e
 
 = Auction corresponding to 
∗
is such that the maximum-demand hour’s demand
In words, the total required entry 
function intersects the aggregate supply curve at the point where 13 percent excess capacity remains.
Entrants’ zero profit conditions pin down their bids at   −  (), and this sets the equilibrium
Capacity Market price:

∗ =   −  ( ∗ )

6.3

(24)

Uniqueness, Computation, and Some Intuition

What remains is to find the equilibrium distribution of entry between the three technologies that
satisfies all three zero profit conditions and the Reserve Margin constraint. Depending on whether
second stage net profits () are large or small relative to fixed costs, the constraint might or
might not bind. This gives two kinds of potential equilibria, "Constrained" and "Unconstrained."
Although there are often multiple equilibria in games with heterogeneous entrants, there is
indeed a unique equilibrium in both the Constrained and the Unconstrained games. This result
is specific to multi-unit auctions in which entrants are independent of incumbents, marginal costs
are consistently ordered, and entrants’ eﬀects on markups are "local." The general intuition derives
from Borenstein (2005) and extends his model to imperfectly competitive second stage subgames.
For intuition, consider the Constrained game and simplify to two entrant technologies, peakers
∗
and combined cycles. Assume the existence of an equilibrium distribution of capacity, 
=
∗
∗
0
{   }. A second equilibrium  would have to satisfy two conditions. First, because fixed costs
∗
are constant and all technologies receive the same Capacity Market price, movement from 
to  0 would have to entail equal changes in the two technologies’ Energy Market profits per unit of
capacity in order for  0 to also satisfy the zero profit conditions. Second, to remain on the Reserve
26

∗
Margin constraint, the change in capacity of one technology between 
and  0 must be equal
and opposite to the change for the other technology. Put concisely, equal and opposite changes in
entering capacity must generate equal changes in per-unit Energy Market profits.
These two conditions cannot both be satisfied, and this second equilibrium  0 therefore cannot
exist. The reason is that in the Energy Market, combined cycle plants’ bids are always less than
peakers’ bids, because the latter technology has higher marginal cost. Combined cycles are thus
dispatched in all the hours that peakers are dispatched, plus many more. The price changes
resulting from a change in combined cycle entry therefore have a large eﬀect on combined cycles’
profits relative to peakers’ profits. A change in peaker entry, on the other hand, has similar eﬀects on
peaker and combined cycle profits. This means that the changes in per-unit Energy Market profits
cannot be equal if the changes in capacity entered are required to be equal and opposite. Appendix
II formalizes this intuition and uses similar logic to prove that the Unconstrained equilibrium is
unique.
The equilibrium is computed via backwards induction, using a modification of a secant-based
algorithm called Broyden’s method (Broyden 1965) to search in {     }-space. The algorithm
first searches for the Unconstrained equilibrium, which is the unique point such that annual Energy
P
Market Revenues  () are equal to annualized fixed costs   for all technologies. If
 
∈{}

∗ in the Unconstrained equilibrium, the constraint has zero shadow cost, the Capacity Price

∗ is zero, and this is the counterfactual equilibrium. In practice, the Unconstrained equilibrium
violates the Reserve Margin constraint. The algorithm then searches for the unique point on the
constraint where the diﬀerence between Energy Market Revenues  (  ) and fixed costs   for
all technologies is the same. The Capacity Market price is the payment per megawatt of capacity
to each technology that is required to bring entrants to zero profits. See Appendix III for more
details on this procedure.
Underlying all these calculations is some straightforward economic intuition about entry. Increased demand elasticity reduces peak quantity demanded, which through the Reserve Margin rule
mechanically reduces total entering capacity. This implies reduced capital expenditures for new
power plants, which is the crucial element of welfare gains.
The distribution of entering capacity between the diﬀerent technologies is determined by the
combination of the distribution of demand shifters across the hours of the year and the aggregate
supply curve from incumbent plants. For example, if demand is relatively constant, total equilibrium supply will favor baseload plants. If the distribution of demand shifters has high variance,
total equilibrium supply will include more peaker plants. Entrants essentially "fill in" the diﬀerence
between total equilibrium supply and existing incumbent supply.
Intuitively, one might also expect that less required entry would reduce the Capacity Market
price, because this is the shadow price of the minimum entry constraint. But because that shadow
price also depends on second stage profits, which are themselves aﬀected by entry, this need not be
the case. The next section will return to this issue.

27

7

Counterfactual Simulation Results

The supply and demand models are now used to simulate the potential equilibrium eﬀects of
expanding Smart Grid technology to one-fifth of the Pennsylvania-Jersey-Maryland market. First,
I detail how the interactions between entry and imperfect competition determine the Smart Grid’s
eﬀects on Energy and Capacity prices. Second, I present the welfare and distributional implications.
Finally, I discuss sensitivity analyses, which show how changes in demand elasticities change the
results.
Table 9.7 presents an overview of the results. Scenarios numbered 6 and 7 are the base case
simulations for No Smart Grid ("No SG") and Smart Grid ("SG"), respectively, per the demand
and supply models described above. The other scenarios are sensitivity analyses, including one pair
of analyses under which markups are exogenous, which could also be thought of as an assumption
of perfect competition.

7.1

Energy and Capacity Prices

As illustrated in Figure 10.9, in the sensitivity analysis with exogenous markups, RTP increases
prices in the top 10 percent of the distribution by an average of $0.95/MWh. This contradicts a
closely-held conventional wisdom on real-time pricing, the Smart Grid, and other forms of demand
response: they should reduce Energy Market prices in high demand hours. What explains these
results?
Under exogenous markups, the increase in near-peak prices is explained by the eﬀects of the
Capacity Market, which are illustrated by Figure 10.10. Total entry  ∗ must be such that peak
demand intersects the aggregate supply curve at a point that leaves a 13 percent Reserve Margin,
giving  ∗ () and  ∗ (  ) in the two scenarios. All three entrant technologies bid into the
Energy Market at lower prices than a large set of ineﬃcient incumbents, and these incumbents will
clear the market in the upper percentiles of prices in both scenarios. In the peak hour, eﬀectively
the same incumbent plant - 13 percent below the capacity limit in the aggregate supply curve - will
clear the market32 . This occurs at points  and  in the No SG and SG scenarios, respectively.
The additional downward-sloping demand from the Smart Grid reduces peak hour quantity
demanded, and thus the entry induced by the Capacity Market, more than it reduces demand in
any other hour. Maximum quantity demanded is 83.4 gigawatts with the Smart Grid, compared
with 85.0 in the No SG scenario, producing a diﬀerence of 1.6 gigawatts between point  and point
. The diﬀerence between the 99th percentiles of quantity demanded, illustrated in points  and
, is only 0.9 gigawatts. Since the market cleared at eﬀectively the same point on the supply curve
in the peak hour, and the Smart Grid reduces quantity demanded less at the 99th percentile than
32

The required excess capacity is actually slightly less under RTP compared to the Baseline because peak hour
quantity demanded is less, and thus the 13 percent Reserve Margin cushion is slightly less. This does not materially
aﬀect the explanation here.

28

at peak, the 99th percentile of demand will clear at a higher price in the SG scenario than in No
SG. In Figure 10.10, this means that point  has a higher price than point . This potentiallycounterintuitive result would not obtain without the inclusion of existing plants, making this in
some sense a "medium-run" model.
If exit were endogenized, lower Energy Market revenues in the No SG scenario could induce
more retirement compared to in the SG scenario. Figure 10.11 illustrates the diﬀerence in profits
between the SG and No SG scenarios under exogenous markups for ineﬃcient incumbents, showing
that the Smart Grid reduces total profits for the highest-cost plants by several percent. Diﬀerential
retirement under No SG relative to SG would reduce the diﬀerence in near-peak Energy Market
prices between the two scenarios, but it would not reverse the sign of the overall eﬀect.
Returning to Figure 10.9, observe that prices in the top five percent of the distribution are lower
when markups are endogenized. This is because the increase in residual demand elasticity causes
profit-maximizing bids to drop towards marginal cost. This eﬀect is not large enough, however, to
change the result that peak prices are still higher in the SG scenario.
Entrants make zero profits in equilibrium, so the change in Energy Market revenues for entrant
peaker capacity must be oﬀset by changes in Capacity prices. As shown in Table 9.7, the Smart
Grid causes Capacity prices to drop from $40.2 to $39.2 per kilowatt per year. This reduces total
annual Capacity Market payments by $156 million.

7.2

Welfare, Profits, and Distributional Eﬀects

As shown in Figure 10.12, real-time pricing reduces electricity costs both for the Smart Grid Group
and for the Rest of Market. Although peak Energy Market prices increase in the SG scenario, the
Smart Grid Group’s larger demand elasticity results in lower peak quantity demanded and thus
lower Energy Market costs. Their share of peak hour quantity demanded, and thus their share of
Capacity Market payments33 , is also lower. Table 9.7 presents this in terms of savings per average
kilowatt of power demanded, which is roughly equivalent to an average US household. Each average
kilowatt of residential, commercial, or industrial demand that adopts Smart Grid technologies saves
$16.80 per year in wholesale electricity costs, or about 4.4 percent.
There are slight positive spillovers to the Rest of Market: the net eﬀect of the changes in Energy
and Capacity expenditures is to reduce their overall costs by 0.13 percent. From an annual base
of $16.4 billion dollars, Smart Grid technology at one-fifth of the market reduces total wholesale
electricity costs for all consumers in both groups by 0.92 percent, or $151 million per year.
In equilibrium, adoption of retail Smart Grid technologies has only a small eﬀect on incumbent producers. This is because the three entrant technologies’ zero profit conditions constrain
incumbents with similar production technologies to the same total profits in any scenario. Only
33
Utilities pass through capacity costs to diﬀerent customer types in diﬀerent ways. For this analysis, I assume
that the Smart Grid group and the Rest of Market are charged lump sum amounts for peak capacity in proportion
to their share of peak load. For simplicity, I assumed that demand is inelastic to these capacity charges.

29

producers with substantially diﬀerent marginal costs than one of the entrant technologies will experience changes in profits. As illustrated in Figure 10.13, 1.7 gigawatts of entry is forestalled
with the introduction of the Smart Grid, most of which takes the form of reduced entry of peaker
capacity.
These numbers can be summarized in a basic welfare calculation that considers only the changes
in producer profits and "electricity-related compensating variation" for the Smart Grid Group and
the Rest of Market. This "electricity-related compensating variation" considers only the welfare
eﬀects of changes in electricity prices and price elasticity of demand. Because the net costs of
Smart Grid technologies are highly uncertain and variable across utilities, these are excluded from
the calculation. The basic welfare calculation gives annual welfare gains of $309 million, or $38.90
per average kilowatt of demand equipped with Smart Grid technologies.

7.3

Sensitivity Analyses and Market Power

Table 9.7 also presents sensitivity analyses under diﬀerent demand parameters and supply model
formulations. The first three columns present results under the assumption of fixed power plant
capital stock. Scenario 1 is a baseline scenario that simply re-creates the market prices over the
study period. Scenario 2 adds real-time pricing but holds firms’ bids constant, and scenario 3
accounts for imperfect competition by endogenously resimulating bids.
The next two columns, scenarios 4 and 5, compare No Smart Grid and Smart Grid scenarios,
allowing entry but holding bids constant. Scenarios 6 and 7 are the preferred base case results for
No SG and SG, respectively, in the model described in the text that endogenizes bidding and entry.
Scenarios 8 and 9 reduce and increase, respectively, the Smart Grid demand parameter e
 by 1/2
in absolute value. Finally, scenarios 10 and 11 are identical to scenarios 6 and 7, except with the
assumption that true marginal costs are halfway between each unit’s bid and its reported static
marginal cost.
The welfare eﬀects of the Smart Grid scale close to linearly with the demand system parameters.
When the demand parameter e
 is halved in scenario 8, the annual welfare improvements drop to
$19.2 per average kilowatt, and when they are doubled, the welfare improvements increase to $58.4
per average kilowatt.
Although reducing producers’ market power has been an important motivation for policies
and technologies that increase the price elasticity of demand, the reduction in markups is not an
important channel of welfare gains. This is illustrated by comparing the base case scenarios 6 and
7 to scenarios 5 and 6, which are identical except that they take producers’ markups as exogenous.
The annual welfare gain from the Smart Grid under exogenous markups vs. endogenous markups
are almost identical. The intuition for this result is that although the additional demand elasticity
does reduce markups, it only does so at high prices where residual supply is inelastic, and the
market clears at these prices only in a small number of hours each year.

30

8

Conclusion

This paper carries out counterfactual simulations of the eﬀects of the Smart Grid on the PennsylvaniaJersey-Maryland restructured wholesale market, using a unique model that captures both imperfect
competition and entry. I present an equilibrium selection mechanism based on myopic learning that
allows detailed counterfactual analysis in a multi-unit auction without the functional form assumptions usually required for the equilibrium to be unique. The model also endogenizes entry, which
is an important channel of welfare gains, and predicts equilibrium prices in the Capacity Market.
The results include several contributions to how economists, firms, and policymakers might
think about increases in demand elasticity from the Smart Grid and real-time pricing. First, the
analysis includes new intuition about the interactions between the markets for Energy and Capacity,
including the proposition that increased demand elasticity may actually increase peak and nearpeak Energy Market prices. Second, demand elasticity is important for welfare primarily because
it reduces peak demand, and thus the entry of new capacity required under the Reserve Margin;
the additional eﬃciency gains from reducing producers’ market power appear to be second-order.
Finally, Smart Grid technologies could have large gross welfare eﬀects, but whether these changes
increase net welfare depends on the cost of the new infrastructure, which is still highly uncertain.

31

References
[1] Anderson, Edward, and Xinmin Hu (2008). "Finding Supply Function Equilibria with Asymmetric Firms." Operations Research, Vol. 56, No. 3 (May-June), pages 697-711.
[2] Athey, Susan, and Phil Haile (2006). "Nonparametric Approaches to Auctions." In James
Heckman and Edward Leamer (Editors), Handbook of Econometrics, Vol. 6, Elsevier.
[3] Back, Kerry, and Jaime Zender (2001). "Auctions of Divisible Goods with Endogenous Supply."
Economics Letters, Vol. 73, No. 1 (October), pages 29-34.
[4] Baldick, Ross, Ryan Grant, and Edward Kahn (2004). "Theory and Application of Linear
Supply Function Equilibrium in Electricity Markets." Journal of Regulatory Economics, Vol.
25, No. 2 (March), pages 143-167.
[5] Baldick, Ross, and William Hogan (2002). "Capacity Constrained Supply Function Equilibrium
Models of Electricity Markets: Stability, Non-Decreasing Constraints, and Function Space
Iterations." Program on Workable Energy Regulation Working Paper PWP-089, August.
[6] Baldick, Ross, and William Hogan (2004). "Polynomial Approximations and Supply Function Equilibrium Stability." Working Paper, Center for Business and Government, Harvard
University.
[7] Baldick, Ross, and William Hogan (2006). "Stability of Supply Function Equilibria: Implications for Daily versus Hourly Bids in a Poolco Market." Journal of Regulatory Economics, Vol.
30, No. 2 (August), pages 119-139.
[8] Barbose, Galen, Charles Goldman, and Bernie Neenan (2004). "A Survey of Utility Experience
with Real-Time Pricing." Working Paper, Lawrence Berkeley National Laboratory, December.
[9] Boisvert, Richard N., Peter Cappers, Charles Goldman, Bernie Neenan, and Nicole Hopper
(2007). "Customer Response to RTP in Competitive Markets: A Study of Niagara Mohawk’s
Standard Oﬀer Tariﬀ." The Energy Journal, Vol. 28, No. 1 (January), pages 53-74.
[10] Borenstein, Severin (2002). "The Trouble With Electricity Markets: Understanding California’s Restructuring Disaster." Journal of Economic Perspectives, Vol. 16, No.1 (Winter), pages
191-211.
[11] Borenstein, Severin (2005). "The Long-Run Eﬃciency of Real-Time Electricity Pricing." The
Energy Journal, Vol. 26., No. 3 (April), pages 93-116.
[12] Borenstein, Severin, and James Bushnell (1999). "An Empirical Anlysis of the Potential for
Market Power in California’s Electricity Market." Journal of Industrial Economics, Vol. 47,
No. 3 (September), pages 285-323.
[13] Borenstein, Severin, James Bushnell, and Frank Wolak (2002). "Measuring Market Ineﬃciencies in California’s Restructured Wholesale Electricity Market." American Economic Review,
Vol. 92, No. 5 (December), pages 1376-1405.
[14] Borenstein, Severin, and Stephen Holland (2005). “On the Eﬃciency of Competitive Electricity
Markets with Time-Invariant Retail Prices.” RAND Journal of Economics, Vol. 36, No. 3,
pages 469-493.
32

[15] Borenstein, Severin, Michael Jaske, and Arthur H. Rosenfeld (2002). "Dynamic Pricing, Advanced Metering, and Demand Response in Electricity Markets." Center for the Study of
Energy Markets Working Paper 105, October.
[16] Brattle Group (2007). "Quantifying Demand
http://www.pjm.com/documents/reports.html

Response

Benefits

in

PJM."

[17] Broyden, Charles (1965). "A Class of Methods for Solving Nonlinear Simultaneous Equations."
Mathematics of Computation, Vol. 19, No. 92 (October), pages 577—593.
[18] Bushnell, James, Erin Mansur, and Celeste Saravia (2008). "Vertical Arrangements, Market
Structure, and Competition: An Analysis of Restructured US Electricity Markets." American
Economic Review, Vol. 98, No. 1 (March), pages 237-266).
[19] Cramton, Peter (2004). "Competitive Bidding Behavior in Uniform-Price Auction Markets."
Report to Federal Energy Regulatory Commission, Dockets EL00-95-075 and EL00-98-063.
[20] Day, Christopher, and Derek Bunn (2001). "Divestiture of Generation Assets in the Electricity
Pool of England and Wales: A Computational Approach to Analyzing Market Power." Journal
of Regulatory Economics, Vol. 19, No. 2 (March), pages 123-141.
[21] Fudenberg, Drew, and David Levine (1998). The Theory of Learning in Games. Cambridge,
MA: MIT Press.
[22] Gans, Joshua, and Frank Wolak (2008). "A Comparison of Ex Ante versus Ex Post Vertical
Market Power: Evidence from the Electricity Supply Industry." Working Paper, Stanford
University, October.
[23] Green, Richard, and David Newbery. "Competition in the British Electricity Spot Market."
Journal of Political Economy, Vol. 100, No. 5 (October), pages 929-953.
[24] Guerre, Emmanuel, Isabelle Perrigne, and Quang Vuong (2000). "Optimal Nonparametric
Estimation of First-Price Auctions." Econometrica, Vol. 68, No. 3 (May), pages 525-574.
[25] Haile, Philip, Han Hong, and Matthew Shum (2006). "Nonparametric Tests for Common
Values in First-Price Sealed-Bid Auctions." Working Paper, Yale University, November.
[26] Herriges, Joseph A., S. Mostafa Baladi, Douglas W. Caves, and Bernard F. Neenan (1993).
"The Response of Industrial Customers to Electric Rates Based Upon Dynamic Marginal
Costs." Review of Economics and Statistics, Vol. 75, No. 3 (August), pages 446-454.
[27] Hogan, William (1997). "A Market Power Model with Strategic Interaction in Electricity
Networks." The Energy Journal, Vol. 18, No. 4 (October), pages 107-142.
[28] Hogan, William (2000). "Flowgate Rights and Wrongs." Working paper, Center for Business
and Government, Harvard University, August.
[29] Hogan, William (2005). "On an Energy Only Electricity Market Design for Resource Adequacy." Working paper, Center for Business and Government, Harvard University, September.
[30] Holland, Stephen, and Erin Mansur (2006). "The Short-Run Eﬀects of Time-Varying Prices
in Competitive Electricity Markets." The Energy Journal, Vol. 27, No. 4 (October), pages
127-155.
33

[31] Holmberg, Par (2005). "Numerical Calculation of an Asymmetric Supply Function Equilibrium
with Capacity Constraints." Working Paper, Uppsala Universitet, March.
[32] Holmberg, Par (2007). "Supply Function Equilibrium with Asymmetric Capacities and Constant Marginal Costs." The Energy Journal, Vol. 28, No. 2 (April), pages 55-82.
[33] Holmberg, Par (2008). "Unique Supply Function Equilibrium with Capacity Constraints."
Energy Economics, Vol. 30, No. 1 (January), pages 148-172.
[34] Hortacsu, Ali (2002). "Mechanism Choice and Strategic Bidding in Divisible Good Auctions:
An Empirical Analysis of the Turkish Treasury Auction Market." Working paper, University
of Chicago, February.
[35] Hortacsu, Ali, and Steve Puller (2008). "Understanding Strategic Models of Bidding in Deregulated Electricity Markets: A Case Study of the Texas Electricity Spot Market." RAND Journal
of Economics, Vol. 39, No. 1, pages 86-114.
[36] Houthakker, Hendrik (1951). "Electricity Tariﬀs in Theory and Practice." The Economic Journal, Vol. 61, No. 241 (March), pages 1-25.
[37] Joskow, Paul, and Jean Tirole (2007). "Reliability and Competitive Electricity Markets."
RAND Journal of Economics, Vol. 38, No. 1 (Spring), pages 60-84.
[38] Kastl, Jakub (2009a). "Discrete Bids and Emprical Inference in Divisible Good Auctions."
Working Paper, Stanford University, October.
[39] Kastl, Jakub (2009b). "On the Properties of Equilibria in Private Value Divisible Good Auctions with Constrained Bidding." Working Paper, Stanford University, April.
[40] Klemperer, Paul, and Margaret Meyer (1989). "Supply Function Equilibria in Oligopoly Under
Uncertainty." Econometrica, Vol. 57, No. 6 (November), pages 1243-1277.
[41] Krasnokutskaya, Elena (2009). "Identification and Estimation of Auction Models with Unobserved Heterogeneity." Working Paper, University of Pennsylvania, August.
[42] Kuhn, Kai-Uwe, and Matilde Machado (2004). "Bilateral Market Power and Vertical Integration in the Spanish Electricity Spot Market." CEMFI Working Paper No. 0414, September.
[43] Lee, Robin, and Ariel Pakes (2009). "Multiple Equilibria and Selection by Learning in an
Applied Setting." Economics Letters, Vol. 104, No. 1 (July), pages 13-16.
[44] LiCalzi, Marco, and Alessandro Pavan (2005). "Tilting the Supply Schedule to Enhance Competition in Uniform-Price Auctions." European Economic Review, Vol. 49, No. 1 (January),
pages 227-250.
[45] Mansur, Erin, and Stephen P. Holland (2008). "Is Real-Time Pricing Green? The Environmental Impacts of Electricity Demand Variance." Review of Economics and Statistics, Vol. 90,
No. 3 (August), pages 550-561.
[46] McAdams, David (2007). "Adjustable Supply in Uniform Price Auctions: Non-Commitment
as a Strategic Tool." Economics Letters, Vol. 95, No. 1 (April), pages 48-53.

34

[47] Monitoring Analytics (2003, 2004, 2008, 2009, 2010). "State of the Market."
http://www.monitoringanalytics.com/reports/PJM_State_of_the_Market/2010.shtml
[48] Patrick, Robert, and Frank Wolak (2001). "Estimating the Customer-Level Demand for Electricity Under Real-Time Market Prices." NBER Working Paper No. 8213, April.
[49] Pfeifenberger, Johannes, Samuel Newell, Robert Earle, Attila Hajos, and Mariko Geronimo
(2008). "Review of PJM’s Reliability Pricing Model (RPM)." Report prepared for PJM Interconnection by The Brattle Group, June.
[50] Puller, Steven (2007). "Pricing and Firm Conduct in California’s Deregulated Electricity Market." Review of Economics and Statistics, Vol. 89, No. 1 (October), pages 75-87.
[51] Rubin, Donald (1974). "Estimating Causal Eﬀects of Treatments in Randomized and NonRandomized Studies." Journal of Educational Psychology, Vol. 66, pages 688-701.
[52] Rudkevich, Alex (2005). "On the Supply Function Equilibrium and its Applications in Electricity Markets." Decision Support Systems, Vol. 40, pages 409-425.
[53] Sioshansi, Ramteen, and Shmuel Oren (2007). "How Good Are Supply Function Equilibrium
Models? An Empirical Analysis of the ERCOT Balancing Market." Journal of Regulatory
Economics, Vol. 31, No. 1 (February), pages 1-35.
[54] Steiner, Peter (1957). "Peak Loads and Eﬃcient Pricing." Quarterly Journal of Economics,
Vol. 71, No. 4 (November), pages 585-610.
[55] US Energy Information Administration
http://www.eia.doe.gov/oiaf/aeo/

(2008a).

"Annual

Energy

Outlook."

[56] US Energy Information Administration (2008b). "Capacity Additions, Retirements, and
Changes by Energy Source." http://www.eia.doe.gov/cneaf/electricity/epa/epat2p6.html
[57] US Environmental Protection Agency (2008). "Documentation for EPA Base Case 2006."
http://epa.gov/airmarkt/progsregs/epa-ipm/#docs.
[58] von der Fehr, Nils-Henrik, and David Harbord (1993). "Spot Market Competition in the UK
Electricity Industry." The Economic Journal, Vol. 103, No. 418 (May), pages 531-546.
[59] Williamson, Oliver (1966). "Peak Load Pricing and Optimal Capacity under Indivisibility
Constraints." American Economic Review, Vol. 56, No. 4 (September), pages 810-827.
[60] Wilson, Robert (1979). "Auctions of Shares." Quarterly Journal of Economics, Vol. 93, No. 4
(November), pages 675-689.
[61] Wilson, Robert (2002). "Architecture of Power Markets." Econometrica, Vol. 70, No. 4 (July),
pages 1299-1340.
[62] Wilson, Robert (2008). "Supply Function Equilibrium in a Constrained Transmission System."
Operations Research, Vol. 56, No. 2 (March-April), pages 369-382.
[63] Wolak, Frank (2003). "Measuring Unilateral Market Power in Wholesale Electricity Markets:
The California Market, 1998-2000." American Economic Review, Papers and Proceedings, Vol.
93, No. 2 (May), pages 425-430.
35

[64] Wolak, Frank (2003). "Identification and estimation of cost functions using observed bid data:
an application to electricity markets." In Mathias Dewatripont, Lars Peter Hansen and Stephen
J. Turnovsky, Eds, Advances in Economics and Econometrics: Theory and Applications, Eighth
World Congress, Volume II. Cambridge, England: Cambridge University Press.
[65] Wolak, Frank (2005). "Quantifying the Supply-Side Benefits from Forward Contracting in
Wholesale Electricity Markets." Working paper, Stanford University, May.
[66] Wolak, Frank (2007). "Managing Demand-Side Economic and Political Constraints on Electricity Industry Restructuring Processes." Working paper, Stanford University, June.

36

8.1

Appendix I: Import Elasticity

This Appendix details the computation of the slope   ( ) of the import supply function. The slope
is estimated via a simple linear two-stage least squares procedure, pooling hourly data for the 24
months between April 2002 through March 2004. The first stage instruments for price with the
diﬀerence between heating and cooling degrees between PJM and neighboring regions:

2
X
©
ª
=
  ( −  ) +   ( −  ) +     +     +   +  



1

(25)

 = Heating degree days in cities in regions that export electricity to PJM: Cincinnati,
Cleveland, Detroit, Richmond, and New York.
 = Cooling degree days in those cities
  = Interactions of season and hour dummies
The second stage estimates the slope of import supply  :

 =  b +

2
X
©
ª
    +     +  + 

(26)

1

Table 8.8 presents for the results of this procedure for prices below $150/MWh, indicating an
estimated slope b
  of 44.2 MW/($/MWh). For prices above this amount, the slope of import
supply is likely to be much steeper. There are few observations in this higher range, but approximating the instrumental variables procedure on those observations suggests a slope of b
  = 622
MW/($/MWh).

8.2

Appendix II: Uniqueness

This appendix proves the uniqueness of pure strategy interior equilibria in both the Constrained
and Unconstrained entry games. Most fundamentally, the equilibrium is unique for three reasons:
entering capacity is independent of existing firms, bids by the three entrant technologies have a
consistent order, and entry has only small and local eﬀects on markups.

8.2.1

Conditions

e  (), the total annualized profit for an entrant of technology  net
Begin by defining a function Π
of Capacity Price :
e  () ≡ Π () −  =  () −  
Π
37

(27)

Note that entrant technologies’ bids are consistently ordered      . For   s.t.    ,
the set of hours in which  runs is therefore contained within the set of hours that  runs. This
means that any change in prices above  will have an equal eﬀect on the profits of  and  .
Entry by capacity of technology  has two eﬀects. Through the "shifting" eﬀect, the entrant
shifts the portion of the supply curve beginning with its bid  to the right, reducing market clearing
prices in all hours where they had been above  . Through the "competition" eﬀect, the entrant
increases the elasticity of residual demand for other firms’ segments nearby in the supply curve,
moving profit maximizing bids closer to marginal cost. The proof uses three conditions that rely
on the reality that the competition eﬀect is both small and local to  .
Condition 1 is Equal Downward Profit Stealing: additional peaker capacity equally aﬀects the
profits per unit capacity of the two lower technologies. Entry by peakers only aﬀects prices in hours
when the market clears near or above  , and since both lower technologies are dispatched in all
those hours, their profits are equally aﬀected.
e  ()
e  ()
Π
Π
=



(28)

Condition 2 is Equal Profit Stealing from Below: additional combined cycle and baseload entry
have equal eﬀects on peaker profits. This follows because the shifting eﬀect from any entrant lower
in the supply curve has the same impact on peakers’ profits, and the competition eﬀects are local
and thus do not aﬀect prices near  .
e  ()
e  ()
Π
Π
=



(29)

Condition 3 is Unequal Relative Profit Stealing: entering capacity of a particular technology
has a greater eﬀect on its own profits than on the profits of technologies higher in the supply
curve. The intuition is that entering capacity of technology  reduces prices near and above  , but
technologies with higher bids are exposed to less of that range than is technology .
e  ()  Π
e  ()
e  ()  Π
e  ()
Π
Π
−

−
∀  s.t.   





(30)

e  () to be diﬀerentiated. Condition
Finally, two regularity conditions are required to allow Π
4 is that there is a unique equilibrium in the second stage subgames, as discussed in the body of
e  () are continuous in . All five conditions
the paper. Condition 5 is that the profit functions Π
hold ∀{     } ∈ R3+ .
8.2.2

Constrained Equilibrium

Lemma: Under Conditions 1-5, if an interior equilibrium exists in the Constrained game, it is the
unique interior pure strategy equilibrium.

38

Proof: The proof proceeds from an initial equilibrium  ∗ . It assumes that a second equilibrium
 0 =  ∗ +∆ exists and characterizes that equilibrium. Finally, it shows that this characterization
contradicts the above conditions except in the trivial case where ∆ = 0.
e is the same for all entrant techIn equilibrium, all entrants earn zero profits, meaning that Π
nologies and equal in absolute value to the Capacity Price . If another interior equilibrium  0
e between  ∗ and  0 must be equal for all technologies:
exists, the change in Π
e  = ∆Π
e  = ∆Π
e
∆Π

(31)

These two equalities can be implicitly diﬀerentiated and then reintegrated over the space between  ∗ and  0 , giving two "equal profit change" conditions:

Z

Z
e  ()  Π
e  ()  Π
e  ()  Π
e  ()
e  ()  Π
e  ()
Π
Π
+
+
 =
+
+








(32a)

Z

Z
e  ()  Π
e  ()
e  ()  Π
e  ()  Π
e  ()  Π
e  ()
Π
Π
+
+
 =
+
+








(33a)

∆

∆

∆

∆

Note that these integrals are path independent, as they integrate over a gradient field. All
integrals use the boundary condition that zero change in capacity gives zero change in profits.
Along the Reserve Margin constraint, the total change in capacity must be zero:

∆ + ∆ + ∆ = 0

(34)

It can now be shown that the equilibrium  0 as characterized cannot exist unless  0 =  ∗ . To
begin, the Equal Downward condition is integrated. This gives that the change in combined cycle
profits from peaker entry must equal the change in baseload profits from peaker entry:
Z

∆

e  ()
Π
 =


Z

∆

e  ()
Π



(35)

Subtracting this from the equal profit change condition between baseload and combined cycle
gives:
Z

Z

∆ ∆

Z
e  ()  Π
e  ()
Π
+
  =



Z

∆ ∆

39

e  ()  Π
e  ()
Π
+
 



(36)

This condition means that entry by combined cycle and baseload plants must have oﬀsetting
eﬀects on the profits of both technologies. From Unequal Relative Profit Stealing, we know that
baseload entry has a greater impact on its own profits, meaning that the change in combined cycle
capacity must be larger to maintain equal profits:

|∆ |  |∆ |

(37)

The inequality could be weak only if ∆ = ∆ = 0, which requires ∆ = 0 and would give
=  ∗.
Rewriting slightly the second equal profit change condition, we have that entry by peakers and
the combined entry from combined cycle and baseload must equally aﬀect profits for peakers and
combined cycles:
0

Z Z

∆

Z Z
e  ()
e  ()
e  ()
e  ()
Π
Π
Π
Π
+
+
 ( +  ) =
 ( +  ) (38)

( +  )

( +  )
∆

Remaining along the Reserve Margin constraint requires that ∆ = −(∆ + ∆ ), i.e. that
the additional peaker capacity exactly oﬀset the combined cycle and baseload changes. By the
Unequal Relative condition, however, any (∆ + ∆ ) aﬀects the diﬀerence between combined
cycle and peaker profits more than the equivalent additional capacity of peakers. This condition
thus cannot hold unless ∆ = 0. ¥

8.2.3

Unconstrained Equilibrium

Lemma: Under Conditions 1-5, if an interior equilibrium  ∗  0 exists in the Unconstrained game,
it is the unique interior pure strategy equilibrium.
Proof: Here again, I assume a distinct equilibrium  0 =  ∗ +∆, characterize the equilibrium,
and then show that the five Conditions can be used to contradict the characterization.
In this situation, instead of equal profit conditions, we have zero profit conditions which must
hold for each technology over ∆. As before, each of these conditions can be diﬀerentiated using
the Implicit Function Theorem and re-integrated over ∆:
Z

∆

e  ()  Π
e  ()  Π
e  ()
Π
+
+
 = 0  ∈ {  }




(39)

As before, the Equal Downward condition can be integrated and substituted into the equality
between the baseload and combined cycle profit functions to pin down the relationship between ∆
and ∆ . This can then be substituted into the peaker and combined cycle zero profit conditions:

40

Z Z

∆

Z Z

∆

e  ()
e  ()
Π
Π
+
 ( +  ) = 0

( +  )
e  ()
e  ()
Π
Π
 ( +  ) = 0
+

( +  )

(40)

(41)

Each of these two zero-profit conditions holds along a particular line. For the peaker zero-profit
condition, for example, any combined entry ( +  ) requires a unique oﬀsetting  to keep the
peakers at zero profits. The Unequal Upward condition, however, gives that a larger change in
peaker entry is required to oﬀset a given ( +  ) in the combined cycle zero-profit equation than
in the peaker equation. These two conditions can thus only hold simultaneously if ∆ = 0¥
The existence of an interior equilibrium with positive entry of all three technologies depends on
e
Π(),
and in particular each technology’s Energy Market profits. In the simulations, an interior
equilibrium is computed; this represents well the fact that in the actual markets, entry by all three
technologies is expected. If entry of one technology were predicted to be zero, it is straightforward
to show uniqueness in the class of boundary equilibria where that technology has zero capacity.
This logic could also be extended to a larger number of technologies, or a continuum of technologies,
using the same conditions.

8.3

Appendix III: Search Procedure for Equilibrium Entry

I search for the unique interior equilibrium in the Constrained and the Unconstrained games. The
algorithm first calculates Unconstrained equilibrium, and if the Reserve Margin constraint is not
satisfied, recomputes the solution along the Reserve Margin constraint.
In the Unconstrained game, the three zero profit conditions form an unconstrained system of
nonlinear equations with a unique solution. Since the Capacity price is zero in the Unconstrained
game, the zero profit conditions are:
e  () ≡  () −   = 0 ∀ ∈ {  }
Π

(42)

Since computation of the profit function values involves re-simulation of the second-stage subgames, eﬃciency is important and analytical computation of gradients is not possible. I thus
use Broyden’s method (Broyden 1965), which finds the roots of a nonlinear system using secant
approximations of the gradients.
The computation algorithm for the Unconstrained game is:
1. Compute the initial Jacobian 0 from starting value 0 and three nearby points.
°
°
°e
°
2. Beginning at step  = 1, iterate until °Π()
° is suﬃciently small:

(a) Compute a new set of trial capacities  based on the current best guess at the equilibrium:
−1
( )
(43)
 = −1 − −1
41

(b) Update the Jacobian using the three most recent trial capacities.
If the total capacity in the Unconstrained equilibrium does not satisfy the Reserve Margin
constraint, the algorithm then computes the Constrained equilibrium using a modified version of
Broyden’s method applicable to nonlinear problems with linear constraints on the decision variables.
The solution to the system is no longer completely determined by the zero profit constraints
e
e  () = Π
e  () = Π
e  (),
Π()
= 0. Instead, it is determined by two equal
Π
P profit constraints,
∗ . These constraints can be solved,
 = 
and the (binding) reserve margin requirement
∈{}

stacked, and applied to the current iteration’s Jacobian,  , to compute the new value of .
The equal profit constraints can be written as:
(
)
½
¾
e  (−1 ) − Π
e  (−1 )
Π
1 −1 0
·  · ∆ = e
e  (−1 )
0 1 −1
Π (−1 ) − Π

(44)

The Reserve Margin constraint can be written as:

©
ª
∗
−
1 1 1 · ∆ = 

X

−1

(45)

∈{}

The algorithm is thus:
1. Begin with initial Jacobian 0 and capacities 0 .
°(
)°
° e
e  (−1 ) °
° Π (−1 ) − Π
°
2. Iterate until ° e
is suﬃciently small:
e  (−1 ) °
° Π (−1 ) − Π
°
(a) Update :

⎧
⎫
⎫−1 ⎪Π
⎧ ½
¾
e  (−1 ) − Π
e  (−1 )⎪
⎪
⎪
⎬
⎬ ⎨
⎨ 1 −1 0
· −1
e  (−1 ) − Π
e  (−1 )
Π
0 ©1 −1 ª
 = −1 +
P
∗
⎭ ⎪
⎩
−1 ⎪
⎪
⎪
1 1 1
⎩  −
⎭
∈{}

(b) Update the Jacobian using the three most recent trial capacities.

42

(46)

9
9.1

Tables
Firm Size Distribution

Firm Number
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
Other

9.2

Capacity (MW)

Share (Pct)

Cumulative Share (Pct)

10,389
9,957
8,079
8,041
6,083
5,718
5,301
4,118
3,404
3,187
1,884
1,818
1,589
989
780
642
623
600
600
521
1,784

14
13
11
11
8
8
7
5
4
4
2
2
2
1
1
1
1
1
1
1
1

14
27
37
48
56
63
70
76
80
84
87
89
91
93
94
95
95
96
97
98
98

Entrant Technologies

Type
Baseload
Comb. Cycle
Peaker
Average Fuel Price (Dollars/mmBtu)
1.6
5.14
5.14
Heat Rate (Btu/kWh)
9,800
7,000
10,500
Sulfur Emission Rate (lbs/mmBtu)
0.08
0
0
NOx Emission Rate (lbs/mmBtu)
0.06
0.009
0.018
Summer Env. Cost (Dollars/MWh)
0.26
0.02
0.07
Variable Op and Maint (Dollars/MWh)
2.67
2.00
6.47
Total Variable Cost (Dollars/MWh)
19
38
61
Plant Size (MW)
1,000
500
400
Percent Hedged
95
80
50
Initial Markup (Percent)
0.13
0.4
0.8
Fixed Cost (Dollars/MW-year)
155,000
75,000
50,000
Ancillary Serv. (Dollars/MW-year)
3500
3,000
2,100
Sources: Monitoring Analytics (2007), Borenstein (2005), and US Environmental Protection
Agency (2008).

43

9.3

Descriptive Statistics: Public Energy Market Data
Mean

SD

Min

Max

34.1
513
1310

2.58
6.52
46

499
1170

38
525
1390

Bids
Average Bid
Max Bid
Min Bid
Total Quantity Bid (GW)

146
999.999
0.55
77.2

9.3
0.0033
0.48
2.4

120
999.99
0.01
71.7

184
1000
1.0
81.4

Prices and Quantities
Average Hourly Price
Maximum Hourly Price
Average Quantity (GW)
Peak Quantity (GW)

37.6
77.1
37.4
43.2

13.2
25.8
4.85
6.2

8.66
20.5
27.9
31.1

87.6
166
49.8
61.5

Inputs
Natural Gas Price (/mmBtu)
Maximum Temperature (F)

5.29
60.2

0.63
18.4

3.99
15

7.1
87

Firms
Number of Firms
Number of Units
Number of Segments

Herfindahl Indices
Overall
926
21.2
894
990
0-50 Bids
1170
36.8
1100
1284
50-100 Bids
1290
210.0
878
1927
100-200 Bids
2015
390
1317
2911
200-500 Bids
1653
237.0
1188
2429
500-1000 Bids
4301
834
1648
5182
From publicly-available bidding data for all days between April 2003 and March 2004.
Price is PJM load-weighted average Locational Marginal Price.
Natural gas price is Henry Hub spot price.
Maximum temperature is the average of Philadelphia, Pittsburgh, and Baltimore weather stations, as reported by the National Climatic Data Center.

44

9.4

PJM Confidential Data: Segment-Level Markups

Distribution
Count
Bid Range
Mean
SD
Total
Markup>0
Markup=0
All
44
127
11673
7072
3482
0-50
2
3
3985
1488
2395
50-100
6
9
3570
2429
399
100-200
26
26
2413
1881
311
200-500
119
100
824
660
118
500-1000
372
276
881
614
259
From marginal cost data confidentially reported to PJM.
All bid segments from 24 auction days between April 2003 and March 2004.

45

Markup<0
1119
102
742
221
46
8

9.5

Learning Algorithm Convergence
Average Absolute Diﬀerence Between Iterations

Iteration
1
2
3
4
5
6
7
8
9
10

Original Bid Range
Overall
0.75
0.31
0.23
0.13
0.07
0.05
0.04
0.03
0.02
0.02

0-50
0.20
0.02
0.00
0.00
0.00
0.00
0.00
0.00
0.00
0.00

50-100
0.46
0.09
0.03
0.01
0.00
0.00
0.00
0.00
0.00
0.00

100-200
1.27
0.31
0.13
0.10
0.03
0.01
0.01
0.00
0.00
0.00

200-500
2.67
1.87
1.47
0.70
0.33
0.23
0.22
0.21
0.12
0.15

500-1000
0.97
0.81
0.99
0.72
0.49
0.33
0.24
0.16
0.14
0.11

August 6th, 2003 auction.

9.6

Alternative Learning Algorithms
Average Absolute Diﬀerence Between Steady States

Iteration
Initial vs. RTP (Myopic BR)
Immediate Update
Fictious Play
Partial Best Response
Random Update Shock
Random Bid Shock

Original Bid Range
Overall
1.77
0.49
0.37
0.32
0.45
0.46

August 6th, 2003 auction.

46

0-50
0.19
0.00
0.00
0.00
0.00
0.00

50-100
0.46
0.01
0.01
0.01
0.07
0.11

100-200
4.46
1.57
0.14
0.94
0.72
0.41

200-500
5.67
1.31
1.52
1.00
2.44
2.72

500-1000
3.25
1.16
2.86
0.80
1.09
1.56

9.7

Simulation Results

Scenario
Exogenous Markups
Entry
Smart Grid
Market Prices (/MWh)
Mean
80th Percentile
90th Percentile
99th Percentile
Maximum
Capacity Price (/kW-year)
Market Quantities (GW)
Mean
80th Percentile
90th Percentile
99th Percentile
Maximum
Entry (MW)
Peaker
Combined Cycle
Baseload

1
Yes
No
No

2
Yes
No
Yes

3
No
No
Yes

4
Yes
Yes
No

5
Yes
Yes
Yes

37.6
54.9
69.6
105.0
166.4
0

36.7
53.4
67.8
99.0
157.6
0

36.6
53.3
67.7
97.9
146.9
0

30.3
42.3
59.9
107.9
285.2
39.9

30.5
42.2
59.9
110.0
299.2
38.4

39.8
48.6
53.5
62.7
69.1

39.7
48.1
52.8
61.9
67.9

39.7
48.1
52.8
61.9
67.9

40.9
49.8
57.7
74.2
85.0

40.9
49.5
57.1
73.3
83.4

-

-

3891
2273
5304

2735
1791
5199

-

Profits
Incumbents’ Profits (billions)
Average Marginal Markup (/MWh)
Oligopoly Rents (millions)

9.85
2.87
1247.3

9.46
2.65
1128.1

9.42
3.19
1290.1

10.12
1.88
946.7

10.12
1.94
972.2

Wholesale Electricity Costs
Energy Market Costs (billions)
Capacity Payments (billions)
Total Electricity Costs (billions)
Costs to Rest of Market (billions)
SG Group Wholesale Costs (/kW)
SG Group Wholesale Savings (/kW)

15.07
0.00
15.07
12.1
378.7
-

14.56
0.00
14.56
11.7
354.5
24.2

14.53
0.00
14.53
11.7
353.6
25.0

12.93
3.47
16.41
13.4
377.9
-

12.99
3.28
16.27
13.4
361.4
16.6

Welfare Eﬀects
Smart Grid Group CV (millions)
337.3
401.2
Rest of Market CV (millions)
0.0
323.0
Producer Profit Change (millions)
-396.3
Net Welfare Eﬀects (millions)
337.3
327.9
Net Welfare Eﬀects (/SG kW)
42.4
41.2
All profits, costs, and welfare figures are annualized.

407.7
355.4
-431.7
331.4
41.6

-

305.4
6.7
-1.5
310.6
39.0

47

Simulation Results (Continued)
6
"No SG"
No
Yes
No

7
"SG"
No
Yes
Yes

8
0.5 e

No
Yes
Yes

9
1.5 e

No
Yes
Yes

10
1/2 Markup
No
Yes
No

11
1/2 Markup
No
Yes
Yes

30.2
42.1
60.2
106.9
301.3
40.2

30.4
42.0
60.2
107.9
290.8
39.2

30.3
42.0
60.2
107.2
293.5
39.8

30.5
42.0
60.2
108.7
292.0
38.7

30.2
42.2
60.0
107.2
281.7
40.3

30.4
42.1
59.9
108.6
302.8
38.8

Market Quantities (GW)
Mean
80th Percentile
90th Percentile
99th Percentile
Maximum

40.9
49.8
57.8
74.2
85.0

40.9
49.5
57.1
73.3
83.4

40.9
49.6
57.4
73.8
84.2

40.9
49.3
56.9
72.8
82.6

40.9
49.8
57.7
74.2
85.0

40.9
49.5
57.1
73.3
83.4

Entry (MW)
Peaker
Combined Cycle
Baseload

4215
2038
5217

3037
1623
5097

3668
1825
5154

2457
1410
5037

4059
2097
5314

2854
1673
5199

Profits
Incumbents’ Profits (billions)
Average Marginal Markup (/MWh)
Oligopoly Rents (millions)

10.15
1.85
864.4

10.14
1.93
913.6

10.14
1.85
856.1

10.13
1.83
859.8

10.09
0.93
444.8

10.07
0.96
462.3

Wholesale Electricity Costs
Energy Market Costs (billions)
Capacity Payments (billions)
Total Electricity Costs (billions)
Costs to Rest of Market (billions)
SG Group Wholesale Costs (/kW)
SG Group Wholesale Savings (/kW)

12.92
3.50
16.43
13.4
378.3
-

12.93
3.35
16.27
13.4
361.5
16.8

12.92
3.43
16.35
13.4
369.9
8.4

12.93
3.27
16.20
13.4
353.1
25.2

12.92
3.51
16.42
13.4
378.2
-

12.95
3.31
16.27
13.4
361.3
17.0

-

306.5
15.1
-12.2
309.4
38.9

153.0
5.5
-5.4
153.0
19.2

460.4
23.3
-19.3
464.4
58.4

-

308.3
17.8
-17.4
308.8
38.8

Scenario
Exogenous Markups
Entry
Smart Grid
Market Prices (/MWh)
Mean
80th Percentile
90th Percentile
99th Percentile
Maximum
Capacity Price (/kW-year)

Welfare Eﬀects
Smart Grid Group CV (millions)
Rest of Market CV (millions)
Producer Profit Change (millions)
Net Welfare Eﬀects (millions)
Net Welfare Eﬀects (/SG kW)

48

9.8

Import Supply Slope
First Stage
(1)

Price

Second Stage
(2)
44.2
(2.1)∗∗

HD Outside PJM
HD Outside PJM, Squared
CD Outside PJM
CD Outside PJM, Squared
HD Diﬀerence

0.8

-10.3

(0.1)∗∗

(7.6)

0.03

-.2

(0.005)∗∗

(0.3)

-.4

39.8

(0.05)∗∗

(3.6)∗∗

0.03

-1.7

(0.001)∗∗

(0.1)∗∗

2.3
(0.08)∗∗

CD Diﬀerence

0.7
(0.05)∗∗

HD Diﬀerence, Squared

0.04
(0.02)

CD Diﬀerence, Squared

0.1
(0.01)∗∗

Const.

1.7

411.2

(2.3)

(191.5)∗∗

Obs.
17489
0.55
2
 statistic
82.6
Dependent variable in first stage: Price
Dependent variable in second stage: Net Imports

49

17487
0.22

10

Figures

10.1

PJM Geographic Footprint

Source: 2003 PJM State of the Market report.

50

10.2

Energy Market Supply Curve

10.3

Example Firm Supply Functions

Source: Publicly-available PJM bidding data for August 14, 2003.

51

10.4

Example Unit: Predicted Bids

Steps 2 and 5 of unit "2RE8" owned by firm "2O," April 2003 through March 2004.

10.5

August 6th, 2003: Expected Supply Curves

52

10.6

Implied Unobservables

10.7

August 6th, 2003: Example Firm Iterative Best Response

53

10.8

August 6th, 2003: Change in Bids under Increased Elasticity

These data are smoothed so as not to reveal the markups of individual units.

10.9

Changes in Price Distribution

54

10.10

Reserve Margin and Near-Peak Prices

10.11

Change in Profits for Incumbent Peaker Plants

55

10.12

Change in Electricity Costs

10.13

Change in Entry from RTP

56

