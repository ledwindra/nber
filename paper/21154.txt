NBER WORKING PAPER SERIES

HOUSING CONSTRAINTS AND SPATIAL MISALLOCATION
Chang-Tai Hsieh
Enrico Moretti
Working Paper 21154
http://www.nber.org/papers/w21154

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2015, Revised May 2017

We are grateful to Klaus Desmet, Rebecca Diamond, Daniel Fetter, Cecile Gaubert, Ed Glaeser,
Erik Hurst, Pat Kline, Steve Redding, Jose Vasquez and several seminar participants for useful
suggestions. We thank Jihoon Sung for research assistance. An earlier version of this paper
circulated under the titles ”Why Do Cities Matter? Local Growth and Aggregate Growth.” and
"Growth in Cities and Countries." The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2015 by Chang-Tai Hsieh and Enrico Moretti. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Housing Constraints and Spatial Misallocation
Chang-Tai Hsieh and Enrico Moretti
NBER Working Paper No. 21154
May 2015, Revised May 2017
JEL No. E24,J01,R0
ABSTRACT
We quantify the amount of spatial misallocation of labor across US cities and its aggregate costs.
Misallocation arises because high productivity cities like New York and the San Francisco Bay
Area have adopted stringent restrictions to new housing supply, effectively limiting the number
of workers who have access to such high productivity. Using a spatial equilibrium model and data
from 220 metropolitan areas we find that these constraints lowered aggregate US growth by more
than 50% from 1964 to 2009.

Chang-Tai Hsieh
Booth School of Business
University of Chicago
5807 S Woodlawn Ave
Chicago, IL 60637
and NBER
chsieh@chicagoBooth.edu
Enrico Moretti
University of California, Berkeley
Department of Economics
549 Evans Hall
Berkeley, CA 94720-3880
and NBER
moretti@econ.berkeley.edu

SPATIAL MISALLOCATION

1

1

Introduction

Starting with Hsieh and Klenow (2009), a large number of studies have documented the existence and the costs of factor misallocation across firms. In this
paper, we focus on the spatial misallocation of labor across US cities. This analysis is motivated by the observation of a large and growing spatial dispersion of
nominal wages across US cities. After conditioning on worker characteristics,
the standard deviation of nominal wages (in logs) across US cities in 2009 is
twice as large compared to 1964, indicating that labor productivity is increasingly different across American cities. If productivity of labor is vastly different
across cities, output can in principle be increased by expanding employment
in high productivity cities at the expense of low productivity cities. We argue
that the growing dispersion of the nominal wage across cities reflects growing
spatial misallocation which ultimately lowers aggregate growth in the US.
The increase in spatial wage dispersion is driven at least in part by cities like
New York, San Francisco and San Jose, which experienced some of the strongest
growth in labor productivity over the last five decades (Moretti (2012)). These
cities also adopted land use restrictions that significantly constrained the amount
of new housing that can be built. As described by Glaeser (2014), since the 1960s
coastal U.S. cities have gone through a property rights revolution which has
significantly reduced the elasticity of housing supply: “In the 1960s, developers found it easy to do business in much of the country. In the past 25 years,
construction has come to face enormous challenges from any local opposition.
In some areas it feels as if every neighbor has veto rights over every project.”
Misallocation arises because the constraints on housing supply in the most
productive US cities effectively limit the number of workers who have access
to such high productivity. Instead of increasing local employment, productivity
growth in housing-constrained cities primarily pushes up housing prices and
nominal wages. The resulting misallocation of workers lowers aggregate output
and welfare of workers in all US cities.
This paper measures the aggregate productivity costs of local housing constraints through the prism of a Rosen-Roback model. In a spatial equilibrium,

2

HSIEH AND MORETTI

aggregate output and welfare growth are not simply the sum of local shocks in
each city. If workers can move across cities, a localized productivity shock in a
city affects wages and employment not only in that city but also in other cities.
We derive a formula that shows how local shocks aggregate to affect national
output and welfare. Aggregate output and welfare growth depend on a weighted
average of productivity shocks in each city and the efficiency of the allocation
of workers across cities, where the latter depends on the elasticity of housing
supply in high productivity cities. If a city with accommodating housing supply
experiences productivity growth, local employment rises and workers in other
cities benefit from the reallocation of jobs. If instead the city has restrictive
housing supply, the reallocation of jobs is limited and productivity growth in
the city is dissipated by the higher price of housing.
We use data from 220 metropolitan areas in the US from 1964 to 2009 to
perform two calculations. First, we quantify the effect of spatial misallocation.
We find that most of the increased spatial dispersion in the marginal product
of labor is due to the growing spatial dispersion in housing prices. In turn, the
growing spatial dispersion of housing prices is largely driven by strict zoning
laws in cities such as New York and the San Francisco Bay Area with strong
productivity growth. We find that the increased spatial misallocation of labor
due to housing supply constraints in cities with high productivity growth rates
lowered aggregate growth by almost 50% between 1964 and 2009.
Second, we calculate the contribution of each US city to aggregate US growth
and compare it to an “accounting” measure based solely on the growth of the
city’s GDP. The difference reflects the effect of a city’s growth on the efficiency
of labor allocation across cities. While the accounting measure suggests that
New York, San Francisco and San Jose’s contribution to aggregate GDP growth
between 1964 and 2009 is 12%, viewed through the lenses of our model, these
cities were only responsible for 5% of growth. The difference is because the
aggregate benefit of TFP growth in New York and Bay Area was in part offset by
increased misallocation of labor across cities. In contrast, for Southern cities the
accounting and model-based measures are the same. Due to an elastic supply of
housing, much of the growth in the South took the form of employment growth,

SPATIAL MISALLOCATION

3

with no effect on misallocation.
We conclude that local land use regulations that restrict housing supply in
dynamic labor markets have important externalities on the rest of the country.
Incumbent homeowners in high productivity cities have a private incentive to
restrict housing supply. By doing so, these voters de facto limit the number
of US workers who have access to the most productive of American cities. In
general equilibrium, this lowers income and welfare of all US workers.
This paper builds on four bodies of work. First, we build on the literature on
resource misallocation by showing that frictions stemming from the housing
market can impede the efficient allocation of resources across cities.1 Second,
our paper builds on the work that uses cities or regions within a country as
laboratories to understand differences in income across countries.2 We differ
from this work by highlighting how the distribution of economic activity across
cities itself affects aggregate outcomes in all cities in the country. Third, we build
on the research that measures the effect of local housing supply constraints on
housing supply and housing prices.3 Our focus is on the aggregate impact of
such regulations.4 Finally, we use a general equilibrium Rosen-Roback model
to measure the effect of local land use regulations on aggregate growth.5 Other
authors have used similar models to measure the effect of internal trade frictions, infrastructure, state taxes, and land misallocation.6
The paper is organized as follows. In Section 2 we present the model. Sec1

The existing literature on resource misallocation includes papers on on financial frictions
(Buera et al. (2011); Greenwood et al. (2013); Midrigan and Xu (2014); Moll (2014)); labor
market frictions (Hopenhayn and Rogerson (1993); Guner et al. (2008); Gourio and Roys (2014);
Garicano et al. (2016); Hsieh and Klenow (2009)); restrictions in land markets (Restuccia and
Santaeulalia-Llopis (2015)) and distortions in output markets (Peters (2016)).
2
See, for example, Barro and Sala-i Martin (1992) and Gennaioli et al. (2014).
3
Some examples are Mayer and Somerville (2000); Glaeser and Gyourko (2003); Quigley and
Raphael (2004); Glaeser et al. (2006); Saks (2008); Saiz (2010)); Ganong and Shoag (2013).
4
Hornbeck and Moretti (2017) use a different approach to estimate the local and aggregate
effects of TFP shocks.
5
There is by now a large literature on systems of cities in general equilibrium. Some examples
are Henderson and Ioannides (1981), Desmet and Rossi-Hansberg (2013), Henderson (1982), Au
and Henderson (2006a), Au and Henderson (2006b), Behrens et al. (2014) and Eeckhout et al.
(2014)
6
See Redding and Turner (2014) for internal trade frictions; Duranton et al. (2015) for land
misallocation in India; Ahlfeldt et al. (2015) for infrastructure and; Fajgelbaum et al. (2015) for
state taxes.

4

HSIEH AND MORETTI

tions 3 describes the data. Section 4 discusses how we infer the driving forces
in the model from the data. In Section 5 we present the main empirical results.
Section 6 discusses extensions of the model. Section 7 discusses policy implications.

2

Model

This section presents a Rosen-Roback model where local forces in a city affect
local employment, wages, and housing prices. We show how the GDP of the
country as whole and welfare of the workers are determined by aggregating the
effects of local forces in all cities.

2.1

Local Employment, Wages, and Housing Prices

A city indexed by i produces a homogeneous good with the following technology:
Yi = Ai Lαi Kiη Ti1−α−η

(1)

Here Ai captures total factor productivity (TFP), Li employment, Ki capital,
and Ti land available for business use. This production function makes three
assumptions. First, it assumes that all cities produce the same product. We
show in Section 6 that this model is isomorphic to one where each city produces
a differentiated product and imports products made in other cities. Second, it
assumes the production function elasticities α and η are the same in all cities.
We will also relax this assumption in Section 6. Third, we assume that the production function is constant returns to scale in capital, labor, and land. Since
the supply of land Ti is fixed in each city, this production function is isomorphic
to one without land with decreasing returns to scale in labor and capital.
We equate the marginal product of labor and capital to the local nominal
wage Wi and the cost of capital R, respectively.7 The (inverse) local labor de7

We assume the interest rate R is determined exogenously in world capital markets (and the
same in all cities).

5

SPATIAL MISALLOCATION

mand is then:

Li =

α1−η η η
Ai
· 1−η
η
R
Wi

1
 1−α−η

· Ti

(2)

Labor demand is increasing in Ai and Ti and decreasing in Wi . In what follows,
1

we will refer to the composite Ai1−α−η · Ti as “local TFP”.
Labor supply in a city is pinned down by the condition that workers are freely
mobile and indifferent across cities in equilibrium. Indirect utility of workers is
given by
V =

Wi Zi
Piβ

(3)

where Pi denotes the local housing price, β the expenditure share on housing,
and Zi the value of local amenities.8 This formulation makes three assumptions. First, it assumes that the price of the output good is the same in all
cities. Second, it assumes that workers have homogeneous tastes over locations which, combined with the assumption that workers are completely mobile across cities, implies that the labor supply facing a city is infinitely elastic.
Third, it assumes that that the housing stock and the land used by businesses
are owned by an absentee landlord so worker income is only wage income. We
relax all three assumptions in Section 6.
The local housing price is given by
Pi = P̄i Lγi i

(4)

where γi is the (inverse) elasticity of housing supply with respect to the number
of workers in the city and P̄i denotes the part of the local housing price that
does not vary with employment. Note that we allow γi to differ across cities.
There is abundant evidence that the housing supply elasticity varies significantly across US cities and that it is an important determinant of local housing
costs.9 Cities with a limited amount of land or stringent land use regulations
have a lower elasticity of housing supply (large γi ) and cities with abundant land
8

The share of expenditures on housing does not vary with income in the data (Davis and
Ortalo-Magné (2011); Lewbel and Pendakur (2009)), which suggests that β is roughly constant.
9
See, for example, Glaeser et al. (2006); Saks (2008); Glaeser and Ward (2009); Saiz (2010)

6

HSIEH AND MORETTI

or permissive land use regulations have higher elasticity (small γi ). Increases in
the number of workers in a city have larger effect on housing costs when the
elasticity of housing supply is small (γi is large).
We can use the definition of indirect utility (3) to express the nominal wage
as a function of utility V and the ratio of local housing prices and local amenities:

β

Wi = V ·

i
Piβ
P̄i Lβγ
i
=V ·
Zi
Zi

(5)

Differences in nominal wages across cities reflect differences in city size, local
amenities, and the local elasticity of housing supply. The nominal wage is increasing in a city’s employment with a city-specific elasticity that depends on
the elasticity of housing supply and decreasing the value of local amenities.
Conditional on having the same employment and amenities, the nominal wage
is lower in a city with a more elastic housing supply.
Equilibrium employment in a city is then given by equating labor demand
(2) with labor supply (5):
"

α1−η η η
Li =
· Ai Ti1−α−η ·
Rη V 1−η



Zi
P̄i

1
1−η # 1−α−η+βγ
i (1−η)

β

(6)

Differences in employment across cities are driven by differences in local TFP,
amenities, and the elasticity of housing supply. Cities with more employment
are those with high local TFP, high quality amenities, and abundant land, with
an elasticity that is increasing in the elasticity of the local housing supply.

2.2

Aggregate Output and Welfare

We are now in a position to aggregate the effect of local labor demand and
supply across all cities into aggregate output and utility. We start with aggregate
P
output Y defined as the sum of output in all cities Y ≡ i Yi . After we impose
the condition that aggregate labor demand is equal to aggregate labor supply

SPATIAL MISALLOCATION

7

(normalized to one), aggregate output is given by:

 1−α−η
1−η
1−η


η
 η  1−η
1−α−η
1
X
Q
1−α−η


Y =
Ai
· Ti ·
R
Q
i
i

(7)

Pβ

where Qi ≡ Zii is the ratio of the housing price Pi to local amenities Zi , Q ≡
P
i Li Qi is the employment-weighted average of Qi across all cities, and the
housing price is determined by equation 4. In what follows, for brevity we will
Piβ
Zi

refer to Qi ≡

as the “local price”, by which we mean the ratio of housing

prices to amenities. Aggregate output is a power mean of local TFP weighted
by the inverse of the local price in the city relative to the average in all cities.
Importantly, since (1 − η)/(1 − α − η) > 1, a mean preserving spread of local
prices lowers aggregate output.
Note the similarity of equation 7 with the expression for aggregate TFP in
Hsieh and Klenow (2009). In Hsieh and Klenow (2009), aggregate TFP is increasing in the power mean of firm TFP and decreasing in the dispersion of the firm
specific frictions. Here, aggregate output is increasing in the power mean of TFP
of individual cities and decreasing in the dispersion of local prices across cities.
It is important to note that in equilibrium, local wages and local prices are
linked, because workers need to be indifferent across cities. In particular, the
(inverse of ) the local price in a city Qi relative to the national average Q is equal
to the wage in the city relative to the national average:
Wi
Q
=
Qi
W
where W ≡

P

i

(8)

Li Wi is the employment-weighted average of Wi across all cities.10

Since the local nominal wage is equal to the marginal product of labor in a city,
dispersion in local prices results in a misallocation of labor across cities in the
same way that dispersion in firm specific frictions in Hsieh and Klenow (2009)
generate misallocation of labor across firms. Intuitively, if the marginal product
10

Equation 8 follows immediately from the equilibrium condition that workers are indifferent

across all cities so V ≡

Wi Piβ
Zi

is the same everywhere.

8

HSIEH AND MORETTI

of labor is different across cities, output can be increased by moving labor from
cities with low marginal product to cities with high marginal product, until the
marginal product is equalized.
Equations 7 and 8 make explicit the link between the housing and labor
market and aggregate output. Differences across cities in housing markets and
amenities show up as differences in wages, which generate differences across
cities in the marginal product of labor. In this sense, this paper is about how
differences in housing prices and amenities across cities generate gaps in the
marginal product of labor across firms located in different cities and to what
extent these gaps cause misallocation. More specifically, our focus is on the role
played by the elasticity of housing supply—the variable γi in the model, which
varies across cities—in driving spatial variation in housing prices and therefore
in marginal product of labor.
Aggregate utility is given by the ratio of aggregate labor income to the average
local price across all cities Q. Since the labor share of income is α, aggregate
utility is given by:
V =α·

Y
Q

(9)

where aggregate output Y is given by equation 7.
The equilibrium of the model is defined by the equations for local employment (2), housing prices (4), the nominal wage (5), aggregate output (7), and aggregate utility (9). The “exogenous” variables are local TFP, local amenities, and
the local elasticity of residential housing supply in all US cities. These variables
collectively determine local outcomes in each city (housing prices, wages, and
employment) and outcomes for the country as a whole (output and welfare). In
Section 6 we discuss the case of endogenous local TFP and amenities.

2.3

Intuition

We now illustrate the intuition for how local forces show up in local employment and wages, and also how they determine aggregate output and welfare.
Consider the effect of an increase in TFP in a city. At the local level, this raises
local employment, housing prices, and wages, where the elasticity of housing

SPATIAL MISALLOCATION

9

supply γi determines whether local employment or housing prices increase.
If the housing supply is elastic, the increase in local TFP has a large effect on
employment and a small effect on wages and housing prices. In the extreme
case where housing supply is perfectly elastic, there is no change in housing
prices or wages (relative to other cities). On the other hand, if housing supply is
perfectly inelastic, there is no change in employment, and the TFP shock is fully
reflected in higher housing prices and wages.
At the aggregate level, the increase in local TFP has three effects. First, an
increase in TFP in a city raises the weighted average of local TFP. From combining the equations for aggregate output (7) and welfare (9), the magnitude of
1

this effect is given by the change in Ai1−α−η . Intuitively, higher TFP raises how
much output is produced in the nation and therefore its welfare. We call this
the “direct effect” of an increase in local TFP.
Second, there is a “misallocation effect”, due to the fact that the TFP shock
changes the local marginal product of labor relative to the rest of the country
( QQi in equations 7 and 8). If the marginal product of labor in the city affected
by the TFP shock is initially above the nationwide mean, the increase in the
housing price increases the gap between the marginal product of labor in the
city and in other cities, worsening misallocation. This effect offsets the direct
benefit of higher local TFP on output and welfare. Importantly, the increase
in misallocation is larger when the housing supply is inelastic. (Of course, if
the local housing price is initially below the nationwide mean, misallocation
declines).
Third, there is a “price effect”: the increase in local TFP raises the local price,
and therefore the average of local prices in the country (Q̄ in equation 9). This
lowers aggregate welfare (but not output). Intuitively, this is akin to higher goods
prices that lowers real income (for a given level of nominal income). The magnitude of this effect is larger when the local housing supply is inelastic, because
the effect on the local price is larger.
Putting together the “direct”, “misallocation” and “price” effects, the change

10

HSIEH AND MORETTI

in welfare due to a change in local TFP is:
Ai
β(1−η)
Pi

dV ∝ d

1
! 1−α−η

(10)

The numerator measures the “direct” effect of TFP and the denominator the
”misallocation” and ”price” effects.
We note that the change in local employment is proportional to:11
(1−η)

dLi ∝ d

Ai Zi

1
! 1−α−η

(11)

β(1−η)

Pi

When local amenities Zi are fixed, the change in employment (equation 11) is
exactly equal to the contribution of TFP growth in a city to aggregate welfare
(equation 10). Put differently, a city’s employment is a sufficient statistic of
the “direct”, “misallocation” and “price” effect of local TFP on aggregate welfare
growth.
So far, we have focused on the case of a TFP shock. A similar logic holds
for the case where local amenities change and TFP is fixed. An improvement
in amenities generates “direct”, “misallocation” and “price” effects, where the
elasticity of housing supply determines the magnitude of the “misallocation”
and “price” effects.12 In general, when both TFP and amenities of a given city
change, the resulting change in aggregate welfare is given by:
(1−η)

dV ∝ d

Ai Zi

1
! 1−α−η

(12)

β(1−η)

Pi

The numerator measures the “direct” effect of TFP and amenities and the denominator the ”misallocation” and ”price” effects. This is equal to the change
11

We substitute the expression for the nominal wage (5) into the labor demand equation (2).

12

The direct effect of better amenities on aggregate utility is given by Zi

misallocation and price effects are given by

1
β(1−η)· 1−α−η

1
−β(1−η)· 1−α−η
Pi
.


three effects into account, is proportional to the change in

The effect on welfare, taking all
1
 1−α−η
. This is proportional

(1−η)
Zi
β(1−η)
Pi

to the change in employment in (11) when TFP is held fixed.

. The

SPATIAL MISALLOCATION

11

in the city’s employment in equation (11) when TFP and amenities change. In
sum, the change in employment is a sufficient statistic for the aggregate effect
of all the local forces in the model (TFP, amenities, and the endogenous change
in housing prices).
Looking forward to the empirical section, we will provide two sets of estimates. First, we will use employment data to measure the contribution of
specific cities to aggregate growth. This contribution can come either from TFP
growth, an improvement in local amenities, or an elastic housing supply, and
the change in employment measures the net effect of all these forces.
Second, we will decompose the contribution of TFP, amenities, and housing
supply to aggregate growth. For this second calculation, employment data is
not enough. We also need to know the parameters of the production function
(α and η), the local elasticity of housing supply γi and data on wages and housing prices. This decomposition will be sensitive to the model parameters, but
conditional on the observed data on employment, the net effect of these forces
on aggregate welfare does not depend on model parameters.

3

Data

The main data we use are the 1964, 1965, 2008 and 2009 County Business Patterns (CBP). We supplement this data with the 1960 and 1970 Census of Population, the 2008 and 2009 American Community Survey (ACS), and the 1964
and 2009 Current Population Survey (CPS). Since the earliest year for which we
could find city-industry level data on wages and employment is 1964, we focus
on changes between 1964 and 2009.13
Data on employment and average wages are available at the county and
county-industry level from the CBP and are aggregated to MSA and MSA-industry
level. The main strength of the CBP is its fine geographical-industry detail and
the fact that data are available for as far back as 1964.14 The main limitation of
13

The appendix provides additional details about the data. Table A.1 in the appendix presents
the summary statistics of the data.
14
The published tabulations of the Census of Population provide MSA-level averages of
worker characteristics, but the individual-level data on employment and salary with geocodes

12

HSIEH AND MORETTI

the CBP is that it does not provide worker-level information but only provide
county aggregates, and that it lacks information on worker characteristics. Obviously, differences in worker skill across cities can be an important factor that
affects average wages. In addition, union contracts may create a wedge between
the marginal product of labor and the wage, as union wages may contain economic rents. We augment the CBP data with MSA-level information on worker
characteristics from the Census of Population, the ACS and the CPS: three levels
of educational attainment (high school drop-out, high school, college); race;
gender; age; and union status.
To purge the average wage of differences in worker characteristics across
cities, we calculate a residual wage that conditions for geographical differences
in the composition of the workforce. Specifically, we use nationwide individuallevel regression based on the CPS in 1964 and 2009 to estimate the coefficients
on worker characteristics, and use those coefficients to compute residual wages
based on city averages.15 We end up with a balanced sample of 220 MSAs in
1964 and 2009.16
Data on the local elasticity of housing supply are from Saiz (2010). For each
MSA, these data provide the overall elasticity of housing supply γi as well as its
two main determinants: land availability and land use regulations.

4

Data Inference and Stylized Facts

We now describe how use the structure of the model to back out the forcing
variables of the urban system from the data. We also discuss some important
facts about geographical differences in our key variables.
are not available from the public version of the Census of Population on a systematic basis until
1980. Only a third of metro areas are identified in the 1970 Census.
15
The residual wage is defined as W −X 0 b, where W is a vector of the average wage in the MSA,
X is the vector of average worker characteristics in the MSA, and b is a vector of coefficients
on worker characteristics estimated from individual-level regressions in nationwide samples.
The appendix shows that in 2009 the estimated average residual wage obtained from MSA-level
data is highly correlated with the average residual wage obtained from individual level data. We
cannot do the same for 1964, which is why we rely on MSA-level data.
16
These MSAs account for 71.6% and 72.8% of US employment in 1964 and 2009, respectively,
and 74.3% and 76.3% of the US wage bill in 1964 and 2009.

SPATIAL MISALLOCATION

13

Employment. Remember that the contribution of a city to aggregate welfare
growth can be inferred from the city’s employment growth. Table 1 (top panel)
presents (log) average employment of four groups of U.S. cities in 1964 and 2009
relative to average employment in all US cities. The four groups are New York,
San Jose, and San Francisco; the Rust Belt (37 cities); Southern cities (96 cities);
and other large cities—defined as cities with 2009 employment above 600,000
and not in the other three groups (19 cities).
Three facts stand out. First, and unsurprisingly, employment in the Rust
Belt declined in relative terms between 1964 and 2009. Second, and more surprisingly, relative employment in New York, San Francisco, and San Jose also
fell. Despite torrid growth in labor demand —mainly driven by the growth of finance, high tech, biotech and other industries concentrated there— these three
cities are smaller today than they used to be (relative to other cities). Third,
employment grew in the South, which includes booming cities such as Houston, Atlanta, and Dallas. As we will see later, these differences have important
implications for aggregate growth.
Figure 1 plots the distribution of log employment for all the cities in our sample. There is a small decrease in the dispersion of city size, mostly driven by the
disappearance of the right and left tails in 1964. The right tail in 1964 includes
metropolitan areas such as Chicago, Los Angeles, New York, Boston, Philadelphia, Detroit, Cleveland, Pittsburgh, St Louis, and Baltimore. Employment in
all these cities shrunk between 1964 and 2009. The left tail in 1964 includes
cities such as Fort Walton Beach (FL), Bremerton (WA), and Fort Collins (CO).
Employment in 20 smallest US cities in 1964 increased by an average 0.81 log
points between 1964 and 2009. At the same time, relative employment in the
Southern cities increased between 1964 and 2009. Among these cities, Atlanta,
Houston, Washington DC, and Dallas joined the group of the ten largest cities
by 2009.
Wages. The amount of spatial misallocation depends on geographical differences in wages. In particular, remember from equations 7 and 8 that misallocation depends on the dispersion across cities in local prices, which in equilib-

14

HSIEH AND MORETTI

rium is simply the dispersion in the nominal wage. Figure 2 plots the employmentweighted distribution of the nominal wage across cities in 1964 and 2009. The
top panel presents the unconditional average wage and the bottom panel the
residual average wage after controlling for differences in worker characteristics
across cities. The standard deviation of the unconditional wage across US cities
increases by 0.073 log points between 1964 and 2009. After conditioning on
observables, the standard deviation of the residual wage increases by even more
(0.083 log points) over the same period.
The Figure also shows that the right tail of the wage distribution in 2009
is significantly thicker than in 1964. The bump in the right tail in the wage
distribution in 2009 includes New York, San Francisco, and San Jose. Table
1 (second panel) shows that the average residual wage (relative to the mean
residual wage) in New York, San Francisco and San Jose increased from 0.04
to 0.4 log points between 1964 and 2009. The left tail in 2009 is thicker than in
1964 and the mass of the distribution in 1964 where wages are slightly above the
mean wage has hollowed out. This change is driven in part by the cities in the
Rust Belt, where the mean residual wage (relative to other cities) fell by almost
0.2 log points between 1964 and 2009.
It is of course possible that heterogeneity in unobserved worker quality across
cities also increased between 1964 and 2009. We can not entirely rule this out,
but remember that the increase in the dispersion in the residual wage is even
larger than the increase in the dispersion of the unconditional wage. Also, using
data from the NLSY, we find that workers in high wage cities tend to have higher
AFQT scores, but the correlation disappears when we control for education,
race, and ethnicity.17
TFP. Since local employment is a function of local TFP and the local wage, we
can invert this relationship to express local TFP as a function of employment
17

Recent evidence based on longitudinal data that follow workers moving from low wage
cities to high wage cities also suggests that unobservable differences in skill are limited once
education is controlled for. Baum-Snow and Pavan (2012) finds that sorting on unobserved
ability within education group contributes little to observed differences in wages across cities
of different size. De la Roca and Puga (2017) find that workers in larger and higher wage cities
do not have higher unobserved initial ability, as measured by the individual fixed effects in a
wage regression. These findings are consistent with Glaeser and Mare (2001).

SPATIAL MISALLOCATION

15

and wages. Specifically, equation 2 can be expressed as:
1

1−η

Ai1−α−η · Ti ∝ Li · Wi1−α−η
The left hand side of this equation is “local TFP” and the right hand side is a
function of local employment, wages, and the parameters η and α.18 For our
baseline, we follow BEA (2013), Piketty et al. (2014), and Karabarbounis and
Neiman (2014) and assume α = 0.65 and η = 0.25, which imply a residual
share 1 − α − η of 10 percent.19 Later, we probe the robustness of our results
to alternative values of the parameters (Section 6). Although our estimates of
TFP are model-driven, they match well independent estimates of TFP obtained
from directly estimating production functions. In particular, the cross-sectional
correlation between our 2009 TFP estimates and TFP estimates obtained by
Hornbeck and Moretti (2017) using establishment-level data from the Census
of Manufacturers is .81.
Figure 3 plots the distribution of local TFP we infer from data on employment and wages. The dispersion of local TFP widened considerably from 1964
to 2009. The employment-weighted standard deviation of local TFP doubled
between 1964 and 2009 (from 0.74 to 1.4 log points). This is driven by two
changes. First, the mass of the distribution of TFP in 1964 (where TFP was
roughly 2 to 3 log points above the mean) has hollowed out. Table 1 indicates
that TFP in the Rust Belt cities fell from an average of 2.77 to 1.14 log points
above the TFP of the mean US city from 1964 to 2009. Detroit was the city
with the highest TFP in 1964. By 2009, TFP in Detroit was below that of the
average US city. Second, while there were no cities in 1964 where relative TFP
exceeded 5 log points, this was no longer true in 2009. The top three cities in
2009 are New York, San Jose, and San Francisco. In these three cities, relative
TFP increased from 3.8 log points above the mean US city in 1964 to 7.1 log
points above the mean city in 2009. This makes sense because these cities are
18

Intuitively, the elasticity of employment to the nominal wage depends on η and γ, and the
nominal wage captures the effect of housing prices and amenities.
19
The assumption that the residual of costs is 10 percent is consistent with Basu and Fernald
(1997)’s estimates of the returns to scale in U.S.

16

HSIEH AND MORETTI

where the most innovative parts of industries such as high tech, biotech and
finance have become increasingly concentrated (Moretti, 2012).
It is important to highlight that while the right tail of the distribution of local
TFP has thickened, the right tail of the distribution of employment across cities
has not. Intuitively, this is because some of the cities with largest TFP gains—
most importantly New York, San Jose, and San Francisco—are also some of the
most supply-constrained housing markets in the US. As we will see in detail
later, strong TFP gains in these cities have not translated in larger employment
but in higher housing costs and a higher marginal product of labor relative to
other US cities.
Housing Prices. Figure 4 plots the distribution of log housing prices. The change
in the distribution of housing prices across cities is striking. First, the dispersion
has widened: the standard deviation (in logs) increased from 0.11 in 1964 to 0.18
in 2009. Second, the shape of the distribution also changed. In 1964, the mass of
the distribution was in cities where housing prices were roughly 0.2 log points
higher than prices in the average city. Furthermore, there were no cities where
the housing price exceeded the average by more than .5 log points. By 2009,
however, there was significantly less density in the bins where relative housing
prices was roughly 0.2 log points, and significantly more mass where relative
housing prices exceed 0.5 log points.
Amenities We use equation 3 and data on housing prices and wages to impute
local amenities (net of a constant): Zi = Piβ /Wi .20 This measure of local amenities is standard in urban economics and has been shown to be highly correlated with local amenities that can be measured like weather, crime, number of
restaurants and various indices of the quality of life (Albouy (2008)).
Figure 5 plots the distribution of amenities. The overall dispersion of amenities has not changed very much. The employment-weighted standard deviation
is 0.076 in 1964 and 0.1 in 2009. The 1964 distribution is slightly left skewed with
20

We use Albouy (2008)’s number for the share of expenditures on housing of β = 0.32.
Following Albouy (2008), we also multiply wages by 0.52 to account for taxes and transfers. Since
V is unobserved, the absolute level of amenities is not identified. However, the relative level in
each city is identified.

SPATIAL MISALLOCATION

17

a mass at roughly 0.05 above the mean. The 2009 distribution is right skewed
with a mass at roughly -0.05.

5

Decomposing Aggregate Growth

Our descriptive evidence in the previous Section has uncovered large and growing differences across cities in the marginal product of labor, associated with
large and growing differences in housing costs. Consistent with growing misallocation, it appears that some of the cities that have experienced the largest
TFP gains—in particular New York, San Francisco, San Jose—have not expanded
their workforce. Rather, they have experienced increases in local costs and wages.
We now turn to our empirical estimates of the effect of spatial misallocation.
Our model gives us an expressison for how local shocks in a city—whether changes
in local TFP, amenities or housing supply—affect aggregate growth. We use our
model to decompose aggregate output and welfare growth in order to quantify
spatial misallocation and its sources.
We proceed in three steps. First, we estimate the aggregate effects of local
growth by quantifying the contribution of specific cities to aggregate growth.
This calculation identifies the effect of any local shock to a specific city—TFP,
amenities or housing supply—on aggregate output and welfare. We compare
model driven estimates to “accounting” estimates based only on the change
in local GDP. The accounting estimates differ from the model driven estimates
because they ignore the effect of a city’s growth on the efficiency of resource
allocation across cities. Having found a large difference, in our second step we
then isolate the contribution of changes in housing prices and amenities on
aggregate growth. Having found that housing prices play a major role, in our
third step we then focus on the role of housing supply: We isolate the effect of
the local elasticity of housing supply on aggregate growth.

18

HSIEH AND MORETTI

5.1

Aggregate Effect of Local Growth

Table 2 presents the contribution of our four groups of cities to growth in aggregate output (column 1) and welfare (column 2). Specifically, we use our model
to calculate the net effect of changes affecting a group of cities on aggregate output and welfare. In practice, this calculation assumes that the exogenous forces
in our model—local TFP, local amenities and elasticity of housing supply—of
a given group of cities change as in the data while holding these forces in the
other cities fixed. We allow employment, housing prices and wages in all cities
to change endogenously until the spatial equilibrium is restored—so that the
marginal product of labor is equal to the nominal wage and all workers are
indifferent across cities.21
The first row in Table 2 shows the observed growth rate of aggregate output.
The growth rate of aggregate GDP per worker from 1964 to 2009 was 0.795% per
year. Unlike output growth, which is observed in the data, there is no empirical
counterpart of welfare growth. Here we assume the growth rate of aggregate
welfare is the same as the growth rate of GDP. Note that the estimates in Table
2 do not depend on this assumption, because the contribution of a given city
to welfare growth is the same regardless of the growth rate of aggregate welfare.
(Remember that the summary statistic of the relative contribution of a city to
welfare growth is the growth of employment).
The second row shows the percentage contribution of New York, San Francisco and San Jose to aggregate growth. Column 1 shows these three cities account for 5% of aggregate GDP growth. Column 2 shows their contribution to
aggregate welfare growth is lower, accounting for only 0.8% of welfare growth.
Remember from Table 1 that the average wage in these three cities increased
from 1964 to 2009 relative to wage in the average US city (from 0.041 to 0.465
21

We chain the estimated effect for consecutive years over the entire time period (1964 to
2009). Specifically, we calculate growth between year t and t+1 allowing local TFP and amenities
of the city in question to change but holding local TFP and amenities of the other cities at their
values at time t. Then we calculate growth between year t and t + 1 holding local TFP and
amenities of the other cities at their values at time t + 1. We then take the geometric average
of these two estimates from changing local TFP and amenities of a given city. We calculate this
for each successive pair of years between 1964 and 2009 and cumulate the growth to obtain an
estimate for the entire time period (1964 to 2009).

SPATIAL MISALLOCATION

19

log points). Viewed through the lenses of the model, this fact indicates that
either the housing prices increased or amenities worsened by 0.45 log points in
these three cities (relative to the other cities). Higher housing prices or worse
amenities in these cities have a negative effect on welfare for a given level of
aggregate output (see equation 9).
The last column in Table 2 shows the contribution of these cities to GDP
growth from a naı̈ve accounting calculation based on the change in local GDP
of these cities as a share of aggregate GDP.22 This calculation suggests that New
York, San Jose, and San Francisco were responsible for 12% of aggregate growth.
The difference between the model-based estimate in column 1 and the “accounting” estimate is that the “accounting” estimate only reflects the “direct
effect” of local shocks, while the model-based estimate also takes into account
the “misallocation effect”.23
The third row in Table 2 shows the contribution of the Rust Belt cities. These
cities account for 15.6% of US GDP growth. Their contribution to welfare growth
is higher (18.5%) because local prices in the Rust Belt cities declined relative to
other cities (as we saw in Table 1). In our model, lower local prices (meaning
lower housing prices or better local amenities) result in lower mean local prices
across all cities, improving welfare.
The contribution of the Rust Belt cities to aggregate growth (output and welfare) is significantly higher than the contribution of New York, San Jose, and San
Francisco. This may seem surprising given the standard narrative of economic
decline in the Rust Belt cities and economic dynamism in New York and the Bay
Area. The accounting-based estimate of the contribution of the Rust Belt (11%
of GDP growth) to aggregate GDP growth is lower than the contribution of New
York, San Jose, and San Francisco. However, what the accounting estimates miss
are the general equilibrium implications of the decline in relative wages in the
Rust Belt and the rise in relative wages in New York and the Bay Area. First, the
decline in local prices in the Rust Belt narrows the gap in the marginal product
P Yi,t Yi,t−1
t
= i Yi,t−1
· Yt where Yt
The accounting decomposition of GDP growth is given by YYi−1
denotes aggregate GDP and Yi,t denotes local GDP of city i (both at time t).
23
The difference between the model-based welfare estimate in column 2 and the “accounting” estimate is the “misallocation effect” and “price effect”
22

20

HSIEH AND MORETTI

of labor between the Rust Belt and other US cities, while the rise in local prices
in New York and the Bay Area increases the gap in the marginal product. This
effect is seen in the gap between the accounting estimates and the model-based
estimates of the contribution of the Rust Belt cities to aggregate growth (11%
vs. 15.6%). Second, the gap in the model-based estimates of the Rust Belt’s
contribution to GDP (15.6%) vs. the contribution to welfare (18.5%) reflects the
effect of the Rust Belt in lowering the average of local prices across all US cities.
The fourth row in Table 2 shows that the cities in the South account for a
large fraction of US growth. In the period under consideration, employment in
the US South has grown 56% more rapidly than the rest of the country. Examples include Austin (employment growth of +1002%), Washington, DC (+550%),
Raleigh-Durham (+506%), Houston (+363%), and Atlanta (+376%). The implication of high employment growth is that Southern cities will account for a
large share of aggregate growth. Specifically, Southern cities were responsible
for 32.9% of aggregate GDP growth and about 35% of welfare growth in the US.
Also, the model-based estimate slightly exceed the accounting estimate, which
indicates that growth in these cities improved the allocation of labor across
cities.
The last row in Table 2 indicates that the other large cities account for about
one third of aggregate GDP and welfare growth. The model-based estimate is
about the same as the accounting estimate, suggesting that growth in these
cities did not change the efficiency of the allocation of labor across US cities.

5.2

Aggregate Effects of Local Changes in Housing Prices and
Amenities

We remind the reader that Table 2 presents the net effect of changes in local
TFP, amenities, and housing prices in a given city (or group of cities). We now
isolate the contribution of amenities and housing prices in Table 3. Remember
that the equilibrium nominal wage is proportional to

Piβ
Zi

and a localized change

in amenities and housing prices in a city affects aggregate output through its
effect on the dispersion of nominal wages across cities. When the dispersion

21

SPATIAL MISALLOCATION

of nominal wages across cities increases, the resulting misallocation of labor
across cities lowers aggregate output.
In Table 2, we calculate a counterfactual where we hold the distribution of
Piβ
Zi

in all US cities fixed at its 1964 level and assume that local TFP changes as in

the data. The entry in row 2 shows the percent difference between the growth
rate in this counterfactual and that observed in the data (shown in row 1). The
difference between the counterfactual and the actual growth rate of aggregate
output is more than a factor of two. This difference is the aggregate effect of the
increase in the spatial misallocation of labor across US cities between 1964 and
2009 due to the change in the spatial dispersion of

Piβ
.
Zi

The welfare results are shown in columns 2 and 3. (The welfare effect differs
from the output effect only because of changes in the average local price Q̄ ≡
P Piβ
i Li Zi .) As we mentioned above, we do not know the true rate of welfare
growth. But for a given rate of growth, we can compute the hypothetical rate under the scenario where the distribution of

Piβ
Zi

is unchanged. Entries in column 2

and 3 are based on the assumption that the rate of growth of welfare is the same
as the rate of growth of output or 1% higher, respectively. The empirical results
are not sensitive. In both cases, we find that the hypothetical growth rate of
aggregate welfare under the scenario where the distribution of

Piβ
Zi

is unchanged

differs from the assumed growth rate by more than a factor of two.
By definition, variation in local prices comes from housing costs Pi and local
amenities Zi . We now isolate the effect of each one at a time. The third row
isolates the effect of changes in the dispersion in local amenities. The effect
of holding the distribution of local amenities fixed at their 1964 levels appear
quantitatively small.24
In the fourth row of Table 3, we compute the counterfactual when we keep
the distribution of housing prices fixed at their 1964 levels and allow all the other
variables (amenities and local TFP) to vary as in the data. The growth rate of
aggregate output and welfare under this counterfactual is about twice as large
as the actual growth rate, and only slightly lower than the growth rate when we
24

For example, column 1 says that if the distribution of amenities across cities had not
changed between 1964 and 2009, the growth rate of aggregate output in the US would have
been 13.6% higher.

22

HSIEH AND MORETTI

keep the distribution of the ratio of housing prices to amenities fixed.
In sum, changes in the spatial dispersion in housing costs are an important
determinant of output and welfare growth in the US in this period, while the
aggregate effect of changes in the spatial distribution of amenities is limited.
Put differently, the change in the distribution of

Piβ
Zi

(and therefore margional

product of labor) is mostly driven by changes in the distribution of housing
prices across cities.
The top panel in Table 4 replicates the same exercise for the four groups of
cities. Specifically, we hold fixed the gap in housing prices between each group
of cities and the average housing price (in all cities) to its 1964 level and calculate
the equilibrium under this scenario. For ease of comparison, row 2 replicates
the estimates for all cities. In row 3 we show the effect of holding fixed the gap
in housing prices only in New York, San Francisco, and San Jose while allowing
other local forces (housing prices in the other cities and amenities and local
TFP in all cities) to change as in the data. We find that the aggregate growth rate
more than doubles. Put differently, the increase in housing prices in only these
three cities accounts for most of the aggregate output effects in Table 3.
In contrast, the growth rate of welfare is negative under this counterfactual
for the Rust Belt. Glaeser et al. (2006) show that housing prices fall significantly
in cities that experience large declines in labor demand, and the experience
of the Rust Belt cities is a prominent example of their finding. What Table 3
highlights is that the drop in housing prices has a large positive effect on welfare
(for a given level of aggregate output). Finally, when we hold housing prices
fixed in the South and in the other large cities, the counterfactual growth of
welfare is larger than the growth rate of GDP. This indicates that housing prices
have increased in these last two groups of cities, but the magnitude is much
lower than in New York and the Bay Area.

SPATIAL MISALLOCATION

5.3

23

Aggregate Effect of Local Changes in Housing Supply
Elasticity

So far, we have shown that the increase in the spatial distribution of housing
prices—and in particular changes in prices in New York and the Bay Area—
had important negative effects on aggregate output and welfare growth. We
now explicitly focus on the role played by local land use restrictions in driving
changes in local housing prices and ultimately aggregate growth.
Land use regulations are typically measured using the Wharton Residential
Land Use Regulatory Index. This index is based on a detailed survey of municipalities in 2007. According to the Wharton Index, the restrictions on land use
in New York, San Francisco and San Jose are among the tightest in the country.
The elasticity of housing supply due to land use regulations in San Francisco is
at the 99th percentile and New York and San Jose at the 96th percentile of the
nationwide distribution of the housing supply elasticity. In contrast, the average
restriction on land use in the US South are in the 46th percentile.
We cannot measure land use restrictions in 1964 because no systematic data
exist on land use restrictions in the past (the Wharton Index does not go back in
time). We thus illustrate the aggregate effect of land use restrictions by examining the counterfactual where we assume land use regulations in each of our
four groups of cities are equal to the level of regulations in the median US city.
More specifically, we hold the amount of land equal to its actual amount, and
only change land use regulations to the level observed in the median US city.
In practice, we proceed in three steps. First, we use Saiz (2010)’s estimates
to compute what would the elasticity of housing supply be in a given city if that
city changed its land use regulations to be equal to the median city, holding
constant land and everything else.25 Second, with this value of the housing
supply elasticity, we estimate the counterfactual equilibrium levels of housing prices, wages, and employment in each group of cities assuming that all
the other variables (amenities and local TFP) vary as in the data. Finally, we
calculate the counterfactual growth rate of output and welfare with this new
25

We use the estimates in Table 5, column 2 in Saiz (2010).

24

HSIEH AND MORETTI

allocation of labor.
The first row in the bottom panel of Table 4 shows the effect of changing
the housing supply regulation only in New York, San Jose, and San Francisco to
that in the median US City. This would increase the growth rate of aggregate
output from 0.795% to 1.49 % per year—a 87% increase. It would increase the
growth rate of aggregate welfare by about 50%. The net effect is that US GDP
in 2009 would be 8.9% higher under this counterfactual, which translates into
an additional $8,775 in average wages for all workers.26 In this counterfactual,
wages in these three cities would be on average 25% lower and employment
would be higher. Intuitively, the housing supply is more accommodating in this
counterfactual. Therefore, more workers can move to these three cities from the
rest of the US.
Table 5 shows how the growth rate of employment would change. By a vast
margin, New York is the city that would experience the largest percentage increase in employment growth: a staggering 1,010% increase. San Jose and San
Francisco growth would also accelerate significantly. Flint and Las Vegas would
also benefit. The median city, Richmond, VA would experience a slower growth.
The bottom of the table reports the cities that would experience the largest
decline in growth in employment. This group mostly includes Rust Belt cities
like Muncie IN, Mansfield, OH, Youngstown, OH and Kokomo IN.
Going back to Table 4, we now focus on the role played by land use regulations in the South. Housing supply is generally rather elastic in Southern cities.
This reflects abundant land and permissive land use regulations in Southern
cities. To see the importance of the permissive land use regulations in these
cities, we estimate counterfactual output under the assumption that land use
regulations in the South are set to the median city. This has the effect of making
land use regulations in the Southern cities more stringent and the housing supply more inelastic. Since local TFP in the Southern cities grew rapidly over this
26

US GDP in 2009 was $14.5 trillion so a GDP increase of 8.9% implies an additional aggregate
income of $1.95 trillion. Given a labor share of 0.65, this amounts to an increase of $1.27 trillion
in the wage bill, or $8,775 additional salary per worker assuming a fixed number of workers. The
salary increase would be smaller if more workers decide to enter the labor market in response
to the higher salary.

SPATIAL MISALLOCATION

25

period, this counterfactual housing supply elasticity results in higher housing
prices and wages and lower employment in the South. This has a large adverse
effect on the aggregate growth rate. The growth rate of aggregate output would
be almost 25% lower under this scenario. The effect on the growth rate of aggregate welfare is even larger (50% lower growth) because of the effect of higher
housing prices in the southern cities on the average price of housing in all cities.
We get similar results when we set land regulations in the other large cities equal
to that of the median US city.

6

Extensions

In this section, we consider how our results change when we generalize the
model.

6.1

Labor Demand Parameters

We remind the reader that the estimates of the contribution of specific cities to
aggregate growth are based only on data on employment growth, and do not
depend on the specific values we assume about the labor demand parameters.
These parameters only matter when we isolate the contribution of amenities
and housing prices, as well as when we measure the effect of the housing supply
elasticity. We will check the sensitivity of these estimates to alternative assumptions about the labor demand parameters.
First, if we keep the assumption that the labor demand parameters are the
same in all cities, the aggregate effect of changes in housing prices are not sensitive to the labor share, as long as the sum of the labor and the capital share
is fixed. This is shown in Appendix Table A.2. In Table A.3 we alter the labor or
capital share to vary their sum.27
27

While results are not sensitive to changes in labor or capital share for a given degree of return
to scale, they are quantitatively sensitive to the degree of decreasing return to scale. The closer
the sum α + η is to 1, the larger the output gain. This makes intuitive sense, because the sum
α + η governs the returns to scale. With α + η close to 1 our technology approaches constant
returns to scale and there is the most productive cities attracting an increasingly larger share of
the economic activity of the country.

26

HSIEH AND MORETTI

Second, we can drop the assumption that the labor demand parameters are
the same in all cities. The labor demand parameters can differ if industries
differ in terms of the importance of the resource (labor) affected by housing
costs and amenities and the mix of industries differs across cities. Specifically,
suppose that total output in a city is the sum of the output produced in different
industries indexed by j, where the production function of industry j in city i is
a

η

Yij = Aij Lijj Kijj . Note that the labor and capital shares are now indexed by
industry, and the effective labor share of a city depends on the particular mix of
industries in the city.
The local nominal wage is still given by Wi = V

Piβ
Zi

but the equations for labor

demand and aggregate output are different. Specifically, total employment in a

 1−α1 −η
i
i
P α1−ηj ηjηj
P
Aij
city is given by Li ≡ j Lij = j
·
and aggregate output
ηj
1−η
i
R
Wi

P P

1
1−αi −ηi



η

α1−ηj ηj j
αRηj Y

Q
Qi

1−ηi
 1−α
−η
i

i

where α ≡
Y is implicitly defined by 1 =
·
i
j Aij
P P Yij
i
j Y · αj is the aggregate labor share. Finally, aggregate utility is still given
by V = α YQ , but note that the relevant labor share is the aggregate labor share α.
This generalization has no effect on the estimates of the contribution of specific cities to aggregate growth, but it potentially changes the estimated effect of
changes in housing prices. To gauge this, we use data on total employment and
the labor share in each 1-digit industry in each city in 1964 and 2009 to estimate
the contribution of changes in housing prices on aggregate growth.28 When
we hold the distribution of housing prices fixed under this parameterization
of the labor share, the growth rate of GDP is 105.6% higher than in the data.
Remember that our baseline estimate where we assume the labor share is the
same in all cities (in Table 4, row 2) is that the growth rate of GDP is 103.5%
higher if the distribution of housing prices is fixed, so the results are virtually
identical.

28

We use data on employment by 1-digit industry and city from the County Business Pattern
database. The data on the labor share for each 1-digit industry is from Close and Shulenburger
(1971) for 1964 and BEA (2013) for 2009.

27

SPATIAL MISALLOCATION

6.2

Specialization by Cities

The baseline model assumes that output of a city is a perfect substitute for
the products made by other cities. Suppose instead that each city makes a
differentiated product with a production function given by Yi = Ai Li . The
demand for the product of each city is determined by utility per capita defined
σ
P σ−1 (1−β)· σ−1
hβ
j
σ
as
Y
·
where Yij denotes consumption of city i’s output in
i ij
Zj
city j, hj is per-capita housing and Zj is the value of amenities in city j. Each
city sells its product to other cities and buys the products made by the other
cities.
We initially assume that shipping costs are zero. Indirect utility is then given

 1
P  Aj 1−σ 1−σ
Wi
Zi
by V = Qi where the local price is now given by Qi = C·P β and C ∝
j Wj
i

is the cost minimizing price of a unit of the CES aggregate of the output good
σ
P σ−1  σ−1
σ
. Because shipping costs are zero, the price of the differentiated
i Yi
output goods are the same in all cities so C is also the same in all cities (and we
normalize this price to one). All the other assumptions are the same.
Aσ−1

i
Employment in a city is given by Li ∝ V σ−1
, aggregate output by Y =
Qσ
i
1


P σ−1  Q σ−1 σ−1
, and aggregate utility by V = σ−1
· YQ . The equations for
i Ai
Qi
σ

labor demand, aggregate output, and aggregate utility in this model with trade
are the same as in our baseline model (without capital and where commercial
1
land is normalized to one in all cities) where we substitute 1−α
with σ −1. There-

fore, as a long as we pick σ such that σ − 1 =

1
,
1−α

all the results will be identical.

We now drop the assumption of costless shipment of goods across cities.
Suppose τij denotes the iceberg cost of shipping from city i to j. The price of
the output goods now vary across cities because of the trade frictions. The local
price is still given by Qi =

Zi
,
Ci ·Piβ

where the key difference is that Ci now varies

across cities because of shipping costs. Holding amenities and housing prices
fixed, Ci will be lower in more productive cities as long as shipping costs within
a city are lower than shipping costs between cities. In addition, assuming that
shipping costs are a function of physical distance between cities, Ci will also be
lower in cities that are geographically proximate to high productivity cities.

28

HSIEH AND MORETTI

Allowing for trade frictions has the following implications. First, the local
nominal wage is still given by Wi =

V ·Zi
Ci ·Piβ

but now differences in the nominal

wage will reflect differences in the price of traded goods as well as differences in
housing prices and amenities. Holding everything equal, this effect will show as
lower wages in more productive cities and in cities close to productive cities.
Second, differences in prices of traded goods will also affect

P local employAσ−1
Yj σ σ
i
ment. Local labor demand is now given by Li ∝ V σ−1 Qσ
j Y τij Cj . The
i

effect of trade frictions shows up in two places. First, cities that are physically
closer to more productive cities have a lower price index because imports from
more productive cities will be cheaper. As discussed earlier, this lowers the local
nominal wage, which also increases local employment. Second, trade barriers
on a city’s exports also affect local employment (this is the second term in the
labor demand equation). Specifically, a city that faces larger trade barriers on
its exports will have lower employment. These are the agglomeration forces
modeled by Krugman (1991) and most recently by Allen and Arkolakis (2014).


Turning to aggregate output and welfare, aggregate output is given by Y =
 1
P σ−1  τij Q σ−1 σ−1
P P
C Y
where τ ≡ j i τji · jiY ji is the revenue-weighted
· Qi
i Ai
τ

average of the iceberg trade cost.29 Aggregate utility is still given by V =

σ−1
σ

· τQY ,

where the only difference is that labor income is the product of the labor share
and aggregate output net of the losses due to shipping costs.
The main empirical implication for the data inference exercise is that we can
no longer back out the value of local amenities from data on nominal wages
and housing prices. Put differently, the dispersion in the residual of the nominal wage (after controlling for housing prices) in Figure 5 reflects differences
across cities in the price of the traded good as well as the dispersion in local
amenities. In the previous section, we show that the increased dispersion in the
nominal wage is entirely driven by the increased dispersion in housing prices
(rather than dispersion in the residual of the nominal wage). Furthermore, our
calculations focus on the effect of changes in housing prices and the effect of
the housing supply elasticity on aggregate output and welfare, and these two
29

We normalize the CES price of the output goods in city i to 1.

SPATIAL MISALLOCATION

29

calculations are the same in a model where cities trade subject to shipping costs.

6.3

Imperfect Labor Mobility

We can also relax the assumption of infinite labor mobility. Suppose that workers differ in preferences over locations. Specifically, suppose the indirect utility
of worker j in city i is given by Vji = ji ·

Wi Zi
Piβ

where ji is a random variable

measuring preferences for city i by individual j. A larger ji means that worker is
particularly attached to city j for idiosyncratic reasons. We assume that workers
locate in the city where her utility Vji is maximized. The key difference is that
only marginal workers are indifferent across cities, but most workers are inframarginal in that their utility in their chosen city is higher than in all other cities.
The implication is that the marginal workers will relocate when real wages and
amenities change, but there will be some infra-marginal workers that will not.
To make this model tractable, we assume that ji are independently distributed and drawn from a multivariate extreme value distribution. Specifically,
we follow Kline and Moretti (2014) and assume the joint distribution of jt is
P −θ
given by Fg (1 , . . . , N ) = exp(− N
i i ) where the parameter 1/θ governs the
strength of idiosyncratic preferences for location and therefore the degree of labor mobility. When 1/θ is large, a larger wage or amenity differences are needed
to compensate a given number of works for moving. On the other hand, if 1/θ
is small, most workers are not particularly attached to their chosen community
and will be willing to move in response to small differences in wages or amenities.30
In this model, employment in a city is still given by 6 and aggregate output
by 7. Compared to our baseline model, there are two key differences. First,
the Rosen-Roback condition that differences in wages across cities are directly
proportional to the ratio of housing prices to amenities no longer holds because
workers are not indifferent across cities. Instead, the (inverse) labor supply
1/θ

of a city is given by Wi ∝

Piβ Li
Zi

. This says even when housing prices and

amenities are the same in all cities, wages will differ between large and small
30

None of the substantive results here hinge on the extreme value assumption. See Kline
(2010) and Busso et al. (2013) for analyses with a nonparametric distribution of tastes.

30

HSIEH AND MORETTI

cities with an elasticity that depends on the heterogeneity in preferences for
location. Intuitively, higher wages in large cities are needed to compensate
marginal individuals to live in the city.
Second, utility now differs across workers but average utility is the same in all
P 1+1/θ Piβ −1
cities and given by V = Y ·( i Li
· Zi ) . In sum, conditional on the observed
changes in the wage distribution, the implications for city size and aggregate
output is the same as before and does not depend on θ. But the effect of local
TFP, amenities, and the local housing supply elasticity on the wage distribution
(and by extension on aggregate output and average welfare) does depend on θ.
The key parameter then is the dispersion of preferences for location θ. Stronger
preferences for location induce some individuals to optimally choose to stay in
cities where real wages net of amenities are low. For this reason, a model that
includes stronger preferences for location predicts smaller aggregate effects of
housing supply. This is indeed what we find empirically in Table A.4.31

6.4

Ownership of Housing Stock

We have assumed that workers do not own the housing stock so that an increase in average housing prices lowers welfare holding aggregate output fixed.
Suppose we assume instead that the housing stock is owned by the workers
in equal proportions, irrespective of where they live. For example, suppose
that workers own equal shares of a mutual fund that owns all the housing in
the US. All the equations are the same, except that welfare is given by V ∝
P
P
Pβ
(Y + i Li hi Pi )·( i Li · Zii )−1 where hi denotes per-capita housing consumption
in city i. After imposing the condition that the share of nominal expenditures
on housing is equal to β, the change in housing prices has the same effect on
nominal income as on the average price of housing. In this case, changes in
housing prices only affect welfare through the effect of the dispersion of the
nominal wage on aggregate output, but changes in the average price of housing
31

It is of course difficult to know what θ is in practice. Serrato and Zidar (2016) and Diamond
(2016) estimate it to be lower than 1. We note, however, that both Serrato and Zidar’s and
Diamond’s parameters are unlilely to be the one relevant in our setting, as they are obtained
using 10 year changes or less. We use 45 years. A longer time horizon would likely imply more
mobility and a larger θ.

SPATIAL MISALLOCATION

31

has no effect on welfare.

6.5

Endogenous TFP and Amenities

We have so far assumed that TFP and amenities are exogenous. However, a
large literature in urban economics posits that city size (or density) also affects
TFP due to agglomeration economies. Similarly, noise, traffic and pollution can
worsen when cities get larger. Urban amenities such as the variety of restaurants and cultural events can also change with city size. Allowing for these
these forces makes our estimates of the effect of changes in housing prices more
complicated, as local TFP and amenities can change endogenously in response
to changes in housing prices via their effect on city size.
For our purposes, the question is not whether TFP and amenities change
endogenously when city size changes, but whether the elasticities of agglomeration and amenities to city size vary with the size of the city. If the elasticity of
agglomeration to city size is the same in all cities, then the gains in TFP in cities
that grow is exactly offset by TFP losses in cities that shrink. Similarly, if the
elasticity of congestion or urban amenities to city size is the same in all cities,
then the endogenous change in amenities in cities that increase is exactly offset
by the change in amenities in cities that shrink. In both cases, our estimates of
the aggregate implications of changes in housing prices is unchanged because
the endogenous gain in TFP and amenities is exactly offset by the endogenous
loss in TFP and amenities.
Empirically, the evidence from US manufacturing in Kline and Moretti (2014)
and Albouy (2008) suggests that the elasticity of endogenous agglomeration to
city size is the same in large vs. small cities. As for urban amenities, Albouy
(2008) shows that the quality of life in a city is positively correlated with the
city population, but when natural amenities such as weather and coastal location are controlled for, there is no relationship between city population and
the quality of life. This suggests that cities with better natural amenities are
bigger (just as predicted by the equilibrium expression for city size in equation
6), but endogenous amenities are not significantly better or worse in large cities

32

HSIEH AND MORETTI

compared to small cities.
If we believe the estimates in Kline and Moretti (2014) and Albouy (2008),
the aggregate effect of changes in housing prices are the same in a model where
amenities and TFP are endogenous as in a model where they are not. However,
the estimates of the elasticity of TFP and amenities to city size are based on
ranges of city size historically observed in the U.S. data, and there is no guarantee that the same estimates extend to variation in city size that are significantly
larger than the ones observed in the data.

7

Policy Implications

Housing regulations have historically been perceived has having only local effects—
affecting the quality of life and housing prices in the local community—and for
this reason they have always been set at the municipality level. Our main point
however is that local housing supply constraints can also have large effects on
other cites. Specifically, we find that a major impediment to a more efficient
allocation of labor across U.S. cities is the constraint to housing supply in high
TFP cities.
Although labor productivity and labor demand grew most rapidly in New
York, San Francisco, and San Jose, thanks to a concentration of human capital
intensive industries like high tech and finance, growth in these three cities had
limited benefits for the U.S. as a whole. In the presence of strong labor demand,
tight housing supply constraints effectively limited employment growth in these
cities. We estimate that holding constant land availability, lowering regulatory
constraints in New York, San Francisco, and San Jose cities to the level of the
median city would increase aggregate output and welfare growth.
For example, Silicon Valley - the area between San Francisco and San Jose has some of the most productive labor in the globe. But, as Glaeser (2014) puts
it, “by global urban standards, the area is remarkably low density” due to land
use restrictions. In a region with some of the most expensive real estate in the
world, surface parking lots, one-story buildings and underutilized pieces of land
are still remarkably common due to land use restrictions. While the region’s

SPATIAL MISALLOCATION

33

natural amenities - its hills, beaches and parks - are part of the attractiveness of
the area, there is enough underutilized land within its urban core that housing
units could be greatly expanded without any reduction in natural amenities.32
Our point is that a first-order effect of more housing in Silicon Valley is to raise
income and welfare of all US workers.
In principle, one possible way to minimize the negative externality created
by housing supply constraints in high TFP cities would be for the federal or
state government to constrain U.S. municipalities’ ability to set land use regulations. If such policies have meaningful nationwide effects, then the adoption of
federal or state standard intended to limit negative externalities may be in the
aggregate interest. These types of standards exist in other countries. The state
of California is currently debating a state statue that would significantly curtail
municipalities’ ability to deny or delay approval of housing projects that meet
certain criteria (SB 35-2017).
An alternative is the development of public transportation that links local
labor markets characterized by high productivity and high nominal wages to
local labor markets characterized by low nominal wages. For example, a possible benefit of high speed train currently under construction in California is
to connect low wage cities in California’s Central Valley - Sacramento, Stockton, Modesto, Fresno - to high productivity jobs in the San Francisco Bay Area.
This could allow the labor supply to the San Francisco economy to increase
overnight without changing San Francisco housing supply constraints. An extreme example is the London metropolitan area. A vast network of trains and
buses allows residents of many cities in Southern England - including far away
cities like Reading, Brighton and Bristol - to commute to high TFP employers located in downtown London. Another example is the Tokyo metropolitan area. While London and Tokyo wages are significantly above the UK and
Japan averages, they would arguably be even higher in the absence of these rich
transportation networks. Our argument suggests that UK and Japan GDP are
significantly larger due to the transportation network.
32

Of course, supply of local public services—schools, police, public transit—would have to be
expanded to keep the per-capita availability constant.

34

HSIEH AND MORETTI

References
Ahlfeldt, Gabriel M, Stephen J Redding, Daniel M Sturm, and Nikolaus Wolf, “The
Economics of Density: Evidence from the Berlin Wall,” Econometrica, 2015, 83 (6),
2127–2189.
Albouy, David, “Are Big Cities Bad Places to Live? Estimating Quality of Life Across
Metropolitan Areas,” Technical Report, National Bureau of Economic Research 2008.
Allen, Treb and Costas Arkolakis, “Trade and the Topography of the Spatial Economy,”
The Quarterly Journal of Economics, 2014, 129 (3), 1085–1140.
Au, Chun-Chung and J Vernon Henderson, “Are Chinese cities too small?,” The Review
of Economic Studies, 2006, 73 (3), 549–576.
and

, “How Migration Restrictions Limit Agglomeration and Productivity in

China,” Journal of Development Economics, 2006, 80 (2), 350–388.
Barro, Robert J and Xavier Sala i Martin, “Convergence,” Journal of Political Economy,
1992, 100 (2), 223–251.
Basu, Susanto and John G Fernald, “Returns to Scale in US Production: Estimates and
Implications,” Journal of Political Economy, 1997, 105 (2), 249–283.
Baum-Snow, Nathaniel and Ronni Pavan, “Understanding the City Size Wage Gap,” The
Review of economic studies, 2012, 79 (1), 88–127.
BEA, National Economic Accounts, 2013.
Behrens, Kristian, Gilles Duranton, and Frédéric Robert-Nicoud, “Productive Cities:
Sorting, Selection, and Agglomeration,” Journal of Political Economy, 2014, 122 (3),
507–553.
Buera, Francisco J, Joseph P Kaboski, and Yongseok Shin, “Finance and Development:
A tale of Two Sectors,” The American Economic Review, 2011, 101 (5), 1964–2002.
Busso, Matias, Jesse Gregory, and Patrick Kline, “Assessing the Incidence and Efficiency
of a Prominent Place-based Policy,” The American Economic Review, 2013, 103 (2),
897–947.

SPATIAL MISALLOCATION

35

Close, Frank A and David E Shulenburger, “Labor’s Share by Sector and Industry, 1948–
1965,” ILR Review, 1971, 24 (4), 588–602.
Davis, Morris A and François Ortalo-Magné, “Household Expenditures, Wages, Rents,”
Review of Economic Dynamics, 2011, 14 (2), 248–261.
Desmet, Klaus and Esteban Rossi-Hansberg, “Urban Accounting and Welfare,” The
American Economic Review, 2013, 103 (6), 2296–2327.
Diamond, Rebecca, “The Determinants and Welfare Implications of US Workers’
Diverging Location Choices by skill: 1980–2000,” The American Economic Review,
2016, 106 (3), 479–524.
Duranton, Gilles, Ejaz Ghani, Arti Grover Goswami, William Kerr et al., “The
Misallocation of Land and Other Factors of Production in India,” World Bank Working
Paper, 2015.
Eeckhout, Jan, Roberto Pinheiro, and Kurt Schmidheiny, “Spatial Sorting,” Journal of
Political Economy, 2014, 122 (3), 554–620.
Fajgelbaum, Pablo D, Eduardo Morales, Juan Carlos Suarez Serrato, and Owen M
Zidar, “State Taxes and Spatial Misallocation,” Technical Report, National Bureau of
Economic Research 2015.
Ganong, Peter and Daniel Shoag, “Why Has Regional Income Convergence in the US
Declined?,” 2013.
Garicano, Luis, Claire Lelarge, and John Van Reenen, “Firm Size Distortions and the
Productivity Distribution: Evidence from France,” The American Economic Review,
2016, 106 (11), 3439–3479.
Gennaioli, Nicola, Rafael La Porta, Florencio Lopez De Silanes, and Andrei Shleifer,
“Growth in Regions,” Journal of Economic growth, 2014, 19 (3), 259–309.
Glaeser, Edward, “Land Use Restrictions and Other Barriers to Growth,” 2014.
Glaeser, Edward L and Bryce A Ward, “The Causes and Consequences of Land use
Regulation: Evidence from Greater Boston,” Journal of Urban Economics, 2009, 65
(3), 265–278.

36

HSIEH AND MORETTI

and David C Mare, “Cities and Skills,” Journal of labor economics, 2001, 19 (2), 316–
342.
and Joseph Gyourko, “The Impact of Building Restrictions on Housing Affordability,”
2003.
,

, and Raven E Saks, “Urban Growth and Housing Supply,” Journal of Economic

Geography, 2006, 6 (1), 71–89.
Gourio, François and Nicolas Roys, “Size-dependent Regulations, Firm Size Distribution, and Reallocation,” Quantitative Economics, 2014, 5 (2), 377–416.
Greenwood, Jeremy, Juan M Sanchez, and Cheng Wang, “Quantifying the Impact of
Financial Development on Economic Development,” Review of Economic Dynamics,
2013, 16 (1), 194–215.
Guner, Nezih, Gustavo Ventura, and Yi Xu, “Macroeconomic Implications of Sizedependent Policies,” Review of Economic Dynamics, 2008, 11 (4), 721–744.
Henderson, J Vernon, “Systems of Cities in Closed and Open Economies,” Regional
Science and Urban Economics, 1982, 12 (3), 325–350.
and Yannis M Ioannides, “Aspects of Growth in a System of Cities,” Journal of Urban
Economics, 1981, 10 (1), 117–139.
Hirsch, Barry T, David A Macpherson, and Wayne G Vroman, “Estimates of Union
Density by State,” 2001.
Hopenhayn, Hugo and Richard Rogerson, “Job Turnover and Policy Evaluation: A
General Equilibrium Analysis,” Journal of political Economy, 1993, 101 (5), 915–938.
Hornbeck, Richard and Enrico Moretti, “Who Benefits from Productivity Growth? The
Local and Aggregate Impacts of Local TFP Shocks on Wages, Rents, and Inequality,”
Harvard University Working Papers, 2017.
Hsieh, Chang-Tai and Peter J Klenow, “Misallocation and Manufacturing TFP in China
and India,” The Quarterly Journal of Economics, 2009, 124 (4), 1403–1448.
Karabarbounis, Loukas and Brent Neiman, “The Global Decline of the Labor Share,”
The Quarterly Journal of Economics, 2014, 129 (1), 61–103.

SPATIAL MISALLOCATION

37

Kline, Patrick, “Place-based Policies, Heterogeneity, and Agglomeration,” The American
Economic Review, 2010, pp. 383–387.
and Enrico Moretti, “People, Places, and Public Policy: Some Simple Welfare
Economics of Local Economic Development Programs,” Annu. Rev. Econ., 2014, 6
(1), 629–662.
Krugman, Paul, “Increasing Returns and Economic Geography,” Journal of Political
Economy, 1991, 99 (3), 483–499.
la Roca, Jorge De and Diego Puga, “Learning by working in big cities,” The Review of
Economic Studies, 2017, 84 (1), 106–142.
Lewbel, Arthur and Krishna Pendakur, “Tricks with Hicks: The EASI Demand System,”
The American Economic Review, 2009, 99 (3), 827–863.
Mayer, Christopher J and C Tsuriel Somerville, “Land Use Regulation and New
Construction,” Regional Science and Urban Economics, 2000, 30 (6), 639–662.
Midrigan, Virgiliu and Daniel Yi Xu, “Finance and Misallocation: Evidence from Plantlevel Data,” The American Economic Review, 2014, 104 (2), 422–458.
Moll, Benjamin, “Productivity Losses from Financial Frictions: Can Self-financing
Undo Capital Misallocation?,” The American Economic Review, 2014, 104 (10), 3186–
3221.
Moretti, Enrico, The New Geography of Jobs, Houghton Mifflin Harcourt, 2012.
Peters, Michael, “Heterogeneous Mark-ups and Endogenous Misallocation,” Yale
University Working Papers, 2016.
Piketty, Thomas, Arthur Goldhammer, and LJ Ganser, “Capital in the Twenty-first
Century,” 2014.
Quigley, John M and Steven Raphael, “Is Housing Unaffordable? Why Isn’t It More
Affordable?,” The Journal of Economic Perspectives, 2004, 18 (1), 191–214.
Redding, Stephen J and Matthew A Turner, “Transportation Costs and the Spatial
Organization of Economic Activity,” Technical Report, National Bureau of Economic
Research 2014.

38

HSIEH AND MORETTI

Restuccia, Diego and Raül Santaeulalia-Llopis, “Land Misallocation and Productivity,”
2015.
Saiz, Albert, “The Geographic Determinants of Housing Supply,” The Quarterly Journal
of Economics, 2010, 125 (3), 1253–1296.
Saks, Raven E, “Job Creation and Housing Construction: Constraints on Metropolitan
Area Employment Growth,” Journal of Urban Economics, 2008, 64 (1), 178–195.
Serrato, Juan Carlos Suárez and Owen Zidar, “Who Benefits from State Corporate Tax
Cuts? A Local Labor Markets Approach with Heterogeneous Firms,” The American
Economic Review, 2016, 106 (9), 2582–2624.

39

SPATIAL MISALLOCATION

Table 1: Employment, Average Wages, TFP, Housing Prices, and Amenities
1964

2009

log Employment
New York, San Francisco, San Jose
Rust Belt Cities
Southern Cities
Other Large Cities

2.89
1.63
.82
2.68

2.55
0.96
1.14
2.23

log Residual Wage
New York, San Francisco, San Jose
Rust Belt Cities
Southern Cities
Other Large Cities

.041
.072
-.038
.010

.465
-.121
-.037
.046

log TFP
New York, San Francisco, San Jose
Rust Belt Cities
Southern Cities
Other Large Cities

3.81
2.77
1.14
3.36

7.14
1.14
1.95
3.68

log Housing Price
New York, San Francisco, San Jose
Rust Belt Cities
Southern Cities
Other Large Cities

.409
.125
-.128
.225

.610
-.104
.106
.333

log Amenities
New York, San Francisco, San Jose
Rust Belt Cities
Southern Cities
Other Large Cities

.094
-.040
-.065
.034

-.174
-.049
-.026
.020

Notes: The sample includes 220 metropolitan areas observed in both 1964 and 2009. There
are 37 Rust Belt Cities, 86 Southern Cities, and 19 Other Large Cities. The table presents the
employment-weighted average of each group of cities relative to the weighted average in all 220
cities in the year. Residual wage controls for three levels of educational attainment (high school
drop-out, high school, college); race; gender; age; and union status in each metropolitan area.

40

HSIEH AND MORETTI

Table 2: Contribution of Cities to Aggregate Growth
Output

Welfare

Output
(Accounting)

0.795%

0.795%

0.795%

Contribution to Aggregate Growth:
NY, San Francisco, San Jose

5.0%

0.8%

12.3%

Rust Belt Cities

15.6%

18.5%

11.1%

Southern Cities

32.9%

35.5%

31.9%

Other Large Cities

33.6%

30.3%

32.4%

Aggregate Growth Rate

Notes: The sample includes 220 metropolitan areas observed in both 1964 and 2009. Table
presents the percentage contribution of four groups of cities to aggregate output or welfare
growth. There are 37 Rust Belt Cities, 86 Southern Cities, and 19 Other Large Cities. Columns
1 and 2 presents the model-based estimates and Column 3 the accounting estimates. Aggregate
growth rate (in row 1) is the average annual growth rate of GDP or welfare from 1964 to 2009. See
text for details.

41

SPATIAL MISALLOCATION

Table 3: Aggregate Effect of Local Changes in Amenities and Housing Prices
Output

Welfare

Welfare

Aggregate Growth Rate

0.795%

0.795%

1.795%

Percent Difference in Growth:
Hold Housing Prices/Amenities Fixed

112.7%

115.0%

124.0%

Hold Amenities Fixed

13.6%

6.2%

6.9%

Hold Housing Prices Fixed

103.5%

86.8%

93.6%

Notes: The sample includes 220 metropolitan areas observed in both 1964 and 2009. Row
1 presents average annual growth rate of aggregate output or welfare. Rows 2-4 present the
Pβ

percentage difference in the growth rate when the distribution of Zii is fixed (row 2), only Zi is
held fixed (row 3), and only Pi is fixed (row 4). Column 2 presents the baseline welfare effect.
Column 3 assumes that the rate of growth of welfare between 1964 and 2009 is 1% higher. See text
for details.

42

HSIEH AND MORETTI

Table 4: Aggregate Effect of Local Changes in Housing Prices and Housing
Supply Elasticities
Output

Welfare

Welfare

0.795

0.795

1.795

Hold Housing Prices Fixed in:
All Cities
NY, San Francisco, San Jose
Rust Belt
South
Other Large Cities

103.5%
101.6%
4.8%
-2.7%
4.7%

86.8%
73.7%
-10.6%
18.7%
15.9%

93.6%
79.6%
-11.4%
20.2%
17.1%

Set Housing Supply Elasticity to Median City:
NY, San Francisco, San Jose
Rust Belt
South
Other Large Cities

86.1%
0.1%
-25.0%
-37.0%

51.8%
-14.7%
-44.7%
-38.3%

55.8%
-15.5%
-48.6%
-41.4%

Aggregate Growth Rate

Notes: The sample includes 220 metropolitan areas observed in both 1964 and 2009. There are
37 Rust Belt Cities, 86 Southern Cities, and 19 Other Large Cities. Column 2 presents the baseline
welfare effect. Column 3 assumes that the rate of growth of welfare between 1964 and 2009 is 1%
higher. See text for details.

43

SPATIAL MISALLOCATION

Table 5: Reallocation of Employment: More Elastic Housing Supply in New
York, San Francisco and San Jose
Percent Change in Rate of
Employment Growth
Cities with Largest Increases
NEW YORK-NEWARK, NY-NJ-PA
SAN FRANCISCO, CA
FLINT, MI
SAN JOSE, CA
LAS VEGAS, NV-AZ

1010
689
479
243
-35

Cities with Median Change:
RICHMOND-PETERSBURG, VA

-50

Cities with Largest Decreases:
BINGHAMTON, NY
MUNCIE, IN
MANSFIELD, OH
YOUNGSTOWN-WARREN, OH
KOKOMO, IN

-169
-171
-214
-218
-295

Notes: The sample includes 220 metropolitan areas observed in both 1964 and 2009.
Entries represents the percent difference between the rate of employment growth under the
counterfactual housing supply elasticity in New York, San Francisco and San Jose and the
observed rate of employment growth. Counterfactual housing supply elasticity for New York, San
Francisco and San Jose is the housing supply elasticity if New York, San Francisco and San Jose
adopted the housing regulations of the median US MSA.

44

HSIEH AND MORETTI

Figure 1: Spatial Distribution of Employment

Note: The graph shows the distribution of de-meaned log employment across MSAs
weighted by MSA employment in the relevant year.
The sample includes 220
metropolitan areas observed in both 1964 and 2009.

SPATIAL MISALLOCATION

Figure 2: Spatial Distribution of Nominal Wages
Unconditional Wage

Conditional Wage

Note: The graphs show the distribution of de-meaned log wages across MSAs weighted
by MSA employment in the relevant year. Conditional wage controls for three levels of
educational attainment (high school drop-out, high school, college); race; gender; age;
and union status in each metropolitan area. The sample includes 220 metropolitan areas
observed in both 1964 and 2009.

45

46

HSIEH AND MORETTI

Figure 3: Spatial Distribution of Local TFP

1

Note: Local TFP is defined as Ai1−α−η Ti . The graph shows the distribution of de-meaned
log local TFP weighted by MSA employment in the relevant year. The sample includes
220 metropolitan areas observed in both 1964 and 2009.

SPATIAL MISALLOCATION

Figure 4: Spatial Distribution of Housing Costs

Note: The graph shows the distribution of de-meaned log housing costs across
MSAs weighted by MSA employment in the relevant year. The sample includes 220
metropolitan areas observed in both 1964 and 2009.

47

48

HSIEH AND MORETTI

Figure 5: Spatial Distribution of Amenities

Note: The graph shows the distribution of de-meaned log amenities across MSAs
weighted by MSA employment in the relevant year.
The sample includes 220
metropolitan areas observed in both 1964 and 2009.

Appendix– Not Intended for Publication
In this appendix, we describe where each variable used in the paper comes
from. We measure average wages in a county or in a country-industry cell by
taking the ratio of total wage bill in private sector industries and total number
of workers in private sector industries using data from the County Business
Patterns (CBP) for 1964-65 (referred to as 1964) and 2008-2009 (referred to as
2009). To increase sample size and reduce measurement error, we combine
1964 with 1965 and 2008 with 2009. 1964 is the earliest year for which CBP data
are available at the county-industry level. Data on total employment by county
are never suppressed in the CBP. By contrast, data by county and industry are
suppressed in the CBP in cases where the county-industry cell is too small to
protect confidentiality. In these cases, the CBP only provides a range for employment. We impute employment in these cases based on the midpoint of
the range. We aggregate counties into MSAs using a crosswalk provided by the
Census based on the 2000 definition of MSA.
The main strength of the CBP is a fine geographical-industry detail and the
fact that data are available for as far back as 1964.33 But CBP is far from ideal.
The main limitation of the CBP data is that it does not provide worker-level
data on salaries, but only a county aggregate and therefore does not allow us to
control for changes in worker composition. We augment CBP data with information on worker characteristics from the Census of Population and the American Community Survey (ACS). Specifically, we merge 1964 CBP average wage
by MSA to a vector of worker characteristics from the 1960 US Census of Population; we also merge 2009 CBP average wage by MSA to a vector of worker
characteristics from the 2008 and 2009 ACS. These characteristics include: three
indicators for educational attainment (high school drop-out, high school, college); indicators for race; an indicator for gender; and age. We drop all cases
where education is missing. In the small number of cases where one of the
components of the vector other than education is missing, we impute it based
33

Unfortunately, individual level data on employment and salary with geocodes is not
available from the Census of Population on a systematic basis until 1980. A third of metro areas
are identified in the 1970 Census.

49

50

HSIEH AND MORETTI

on the relevant state average.
Because the Census does not report information on union status, we augment our merged sample using information on union density by MSA from
Hirsch et al. (2001). Their data represent the percentage of each MSA nonagricultural wage and salary employees who are covered by a collective bargaining
agreement. Their estimates for 1964 and 2009 are based on data from the Current Population Survey Outgoing Rotation Group (ORG) earnings files and the
now discontinued BLS publication Directory of National Unions and Employee
Associations (Directory), which contains information reported by labor unions
to the Federal Government. The exact methodology is described in Hirsch et al.
(2001).34
This allows us to estimate average residual wage in each MSA, defined as the
average wage conditional on worker characteristics. Specifically, we estimate
residual wages as Wic Xi0 b, where W is average wage in the MSA, X is the vector
of average worker characteristics in the MSA and b is a vector of coefficients on
worker characteristics from individual level regressions estimated on a nationwide sample in 1964 and 2009 based on CPS data. The coefficients for 1964 are:
high-school or more .44; college or more .34; female: -1.13; non white: -.44; age:
.004; union .14. The coefficients for 2009 are: high-school or more .50; college
or more .51; female: -.45; non white: -.07; age: .007; union .14. Because a union
identifier is not available in the 1964 CPS, the 1964 regression assumes that the
coefficient on union is equal to the coefficient from 2009, which is estimated to
be equal to .14.
For 2009, we can compare the wage residuals estimated our approach with
those that one would obtain from individual level data. (Of course we can’t do
this for 1964, because we don’t have micro data in that year). Figure A.1 shows
that while noisy, our imputed wage residuals do contain signal. The correlation
between the two measures of the residual wage is 0.75.
/

We also estimated the residual wage as Wic = Xi bs where bs is a vector of
34

For 1964, estimates are calculated based on figures in the BLS Directories, scaled to a level
consistent with CPS estimates using information on years in which the two sources overlap.
Only state averages are estimated in 1964. Thus, in 1964 we assume assign union density to
each MSA based on the state average.

coefficients on worker characteristics from individual level regressions which is
allowed to vary across states. The correlation in 2009 increases only marginally
to .78.
Data on housing costs are measured as median annual rent from the 1960,
1970 US Census of Population and the 2008 and 2009 American Community
Survey. For 1964, we linearly interpolate Census data between 1960 and 1970.
Data for 2009 are from individual level data from the American Community
Survey. To get a more precise estimate, we combine 2008 and 2009. Because
rents may reflect a selected sample of housing units, we have re-estimated all
our models using average housing prices. Results are essentially unchanged.
Results available upon request.
Our sample consists of 220 MSAs with non-missing values in 1964 and 2009.
These cities account for 71.6% of US employment in 1964 and 72.8% in 2009.
They account for 74.3% of US wage bill in 1964 and 76.3% in 2009. The average
city employment is 144,178 in 1964 and 377,071 in 2009. Table A.1 presents
summary statistics.
Data on housing supply elasticities, land use regulations and land availability are from Saiz (2010). They are intended to measure variation in elasticity that
arises both from political constraints and geographical constraints. In 19 cities,
Saiz data are missing. In those cases, we impute elasticity based on the relevant
state average.

Table A.1: Summary Statistics

Average Annual Salary - Private Sector Workers
Average Annual Rent
Private Sector Employment
Private Sector Wage Bill (billion)
High School Drop Out
High School or More
College or More
Hispanic
Non-White
Age
Female
Union
Number of cities

1964 Average

2009 Average

25,538
(3,868)
4,770
(932)
144,178
(294,016)
4.04
(8.95)
0.59
(0.11)
0.40
(0.08)
0.07
(0.02)
0.03
(0.05)
0.09
(0.11)
28.1
(3.3)
0.51
(0.01)
0.26
(0.12)

29,018
(5,278)
6,553
(1,826)
377,071
(604,448)
14.04
(25.5)
0.10
(0.05)
0.90
(0.04)
0.26
(0.07)
0.10
(0.07)
0.22
(0.15)
39.9
(0.9)
0.51
(0.01)
0.11
(0.06)

220

220

Note: Mean and standard error (in parenthesis) in 220 MSAs in each year.

Table A.2: Estimates Based on Alternative Parameters - Labor and Capital Share
Baseline
α = 65, η = 25

α = 6, η = 30

α = 55, η = 35

α = 70, η = 20

α = 75, η = 15

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

Hold Housing Prices/Amenities Fixed

112.7

115.0

95.5

100.0

79.7

86.8

131.2

131.0

151.0

147.9

Hold Housing Prices Fixed

103.5

86.8

87.1

74.4

72.2

63.0

121.3

100.1

140.6

114.5

Hold Housing Prices Fixed, NY-SF-SJ

101.6

73.7

84.0

62.8

68.4

53.0

120.9

85.9

141.9

99.4

Set Elasticity to Median, NY-SF-SJ

86.1

51.8

74.6

49.6

63.6

47.4

98.1

53.7

110.7

55.6

Notes: Columns 1 and 2 are from Table 3 (columns 1 and 2).

Table A.3: Estimates Based on Alternative Parameters - Diminishing Returns
Baseline
α = 65, η = 25

α = 68, η = 25

α = 62, η = 25

α = 65, η = 28

α = 65, η = 22

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

Hold Housing Prices/Amenities Fixed

112.7

115.0

251.8

233.0

59.5

67.6

231.0

215.4

65.5

73.2

Hold Housing Prices Fixed

103.5

86.8

280.6

189.0

55.3

48.3

219.6

173.3

58.9

52.7

Hold Housing Prices Fixed, NY-SF-SJ

101.6

73.7

250.9

172.6

48.9

40.7

228.3

156.8

54.6

44.3

Set Elasticity to Median, NY-SF-SJ

86.1

51.8

171.0

62.5

48.8

43.7

158.8

61.3

55.3

44.9

Notes: Column 1 and 2 are from Table 3 (columns 1 and 2).

Table A.4: Estimates Based on Alternative Parameters - Worker Preferences for Location
Baseline
Perfect Mobility

Set Elasticity to Median, NY-SF-SJ

θ=3

θ=2

θ=1

θ = 0.5

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

Output

Welfare

86.1

51.8

62.4

40.9

23.2

7.5

10.3

3.0

3.6

1.0

Notes: Column 1 and 2 are from Table 4.

Figure A.1: Estimated 2009 Average Wage Residual vs. Actual 2009 Average
Wage From Individual Level Data

Note: Each dot is a MSA. The x axis reports average residuals by MSA from an individual
level regression based on individual level data from the Census of Manufacturers. The
y axis has residuals based on CBP data used in the main analysis. The employment
weighted correlation is .75.

56

