NBER WORKING PAPER SERIES

BOND RISK PREMIA IN CONSUMPTION-BASED MODELS
Drew D. Creal
Jing Cynthia Wu
Working Paper 22183
http://www.nber.org/papers/w22183

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2016

We thank Frank Diebold, Stefano Giglio, Jim Hamilton, Lars Hansen, Frank Schorfheide, Ivan
Shaliastovich, Dongho Song, George Tauchen, and Jonathan Wright as well as seminar
participants at UPenn, NBER Summer Institute Forecasting & Empirical Methods, 5th
Conference on Fixed Income Markets, Bank of Japan, FRB Cleveland, FRB St. Louis, Chicago
Junior Macro and Finance meetings, 2nd FMND for helpful comments. Cynthia Wu gratefully
acknowledges financial support from the James S. Kemper Foundation Faculty Scholar at the
University of Chicago Booth School of Business. The views expressed herein are those of the
authors and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2016 by Drew D. Creal and Jing Cynthia Wu. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Bond Risk Premia in Consumption-based Models
Drew D. Creal and Jing Cynthia Wu
NBER Working Paper No. 22183
April 2016
JEL No. C11,E31,E43,E52,G12
ABSTRACT
Workhorse Gaussian affine term structure models (ATSMs) attribute time-varying bond risk
premia entirely to changing prices of risk, while structural models with recursive preferences
credit it completely to stochastic volatility. We reconcile these competing channels by
introducing a novel form of external habit into an otherwise standard model with recursive
preferences. The new model has an ATSM representation with analytical bond prices making it
empirically tractable. We find that time variation in bond term premia is predominantly driven by
the price of risk, especially, the price of expected inflation risk that co-moves with expected
inflation itself.

Drew D. Creal
University of Chicago
Booth School of Business
5807 South Woodlawn Ave
Chicago, IL 60637
dcreal@chicagobooth.edu
Jing Cynthia Wu
University of Chicago
Booth School of Business
5807 South Woodlawn Avenue
Chicago, IL 60637
and NBER
cynthia.wu@chicagobooth.edu

1

Introduction

Term premia, risk premia in the bond market, are a key object of interest for central banks.
They influence how monetary policy implementation via the short term interest rate gets
transmitted into the real economy through borrowing costs at longer maturities, and ultimately determines its effectiveness. Policy speeches – made by the current Fed Chair
Yellen(2014) and past Chairs Bernanke(2006) and Greenspan(2005), for example – call for
the importance of understanding how and why term premia fluctuate. Our paper aims to
answer these questions by proposing a new consumption based asset pricing model.
Central banks around the world rely on reduced form Gaussian affine term structure
models (ATSM) to produce estimates of term premia for policy discussion, because of the
tractability and reliability resulting from the affine structure. This class of models generate
variability in term premia through a time-varying price of risk that is a function of the
conditional mean of yields; see, e.g. Duffee(2002), Wright(2011) and Bauer, Rudebusch, and
Wu(2012). Conversely, structural consumption-based asset pricing models studying bond
risk premia often use recursive preferences, Bansal and Shaliastovich(2013) for example.
In these models, time-variation in term premia are driven only by stochastic volatility of
consumption growth and inflation, meaning that the levels of these macro variables play no
role. This conclusion is at odds with the empirical evidence from reduced form ATSMs.
We reconcile the two literatures by building a structural model with both time-varying
prices and quantities of risk. We introduce a time-varying price of risk through a new
formulation of habit formation. Just as in Abel(1999), the agent’s period utility relies on
the ratio of consumption to habit. Our habit specification depends on current and past
consumption and inflation, with the latter accounting for inflation non-neutrality as argued
by Piazzesi and Schneider(2007) and Bansal and Shaliastovich(2013). The novelty is that
the state dependent risk sensitivity function – how habit growth loads on economic shocks
– is chosen to make bond prices analytical and retain an affine structure. The tractability
gained from the affine structure allows us to empirically disentangle the roles that habit,
2

recursive preferences, and stochastic volatility have on term premia. We introduce timevarying quantities of risk through stochastic volatility, similar to the long run risk literature.
The difference is that the volatility process in our paper is guaranteed to remain positive,
unlike most of the literature.
We evaluate the empirical performance of our model by first quantifying the information
contained in observed inflation and consumption data about macroeconomic state variables
using Markov chain Monte Carlo and particle filters. We then ask how well these macroeconomic state variables do in terms of matching the bond yield data by least squares. We
show that empirically our model can adequately capture the time-variation of term premia.
It fits other key moments of Treasury bonds as well: it has an upward slope for the yield
curve; and it also mimics the time series dynamics of the average yield and slope of the yield
curve well.
Next, we turn to the key question that motivates our research: is a time-varying price
or quantity of risk the key driver for the time variation in term premia? We answer this
question by shutting down one channel at a time. First, we shut down the price of risk
channel. This model is similar to a long run risk model with stochastic volatility studied in
the literature. We find that although such a model produces time variation in term premia,
the implied term premia are implausible: they are economically insignificant, and have the
wrong sign.
On the other hand, a model with habit but not stochastic volatility mimics the time
variation of term premia produced by the reduced form Gaussian ATSM and our benchmark
model. Overall, our empirical evidence attributes the time variation in the term premia
primarily to a time-varying price of risk through habit.
We further examine whether it is inflation or consumption that drives this price of risk,
and we find the crucial component is the price of the expected inflation risk that comoves
with the expected inflation itself. This is consistent with inflation non-neutrality as argued by
Piazzesi and Schneider(2007) and Bansal and Shaliastovich(2013) in a structural framework.

3

The important contribution inflation makes to bond price dynamics are also highlighted in
the ATSM literature, see Ang and Piazzesi(2003) and Rudebusch and Wu(2008).
Introducing habit also has important implications for the unconditional slope of the
yield curve, which has been the main focus for the majority of the literature. Another
counterfactual implication of the long run risk model with stochastic volatility is a downward
sloping yield curve, once the macro latent factors are pinned down by the observed macro
data. Adding habit formation reverts the situation completely, and implies an unconditional
slope just like what we see in the data.
Habit formation grants an economic interpretation to a long standing intuition in the
ATSM literature: In a structural model without habit, the key parameters that determine
the autocorrelation of consumption growth and inflation are the same as the parameters
controlling the slope of the yield curve. This strong link between the two parameters has
undesirable implications. For example, in our sample, the time series properties of the data
dictate a downward sloping yield curve. Conversely, Gaussian ATSMs separate these two
parameters. This property of the model is the main reason for their success in fitting the
data because it is the mechanism that allows the price of risk to be time-varying. Habit
formation provides an economic motivation for this separation in a structural model.
This separation alone provides the same implications for bond slope and term premia
even when other preference parameters of the model – including the time discount factor,
intertemporal elasticity of substitution and risk aversion – vary substantially over regions
with different economic interpretations. We demonstrate this point using two local maxima
with these three structural parameters taking economically different values yet with the same
implications for bonds.
The empirical examination of the asset pricing implications discussed above requires
solving for the stochastic discount factor.1 However, such a solution does not always exist
1

Specifically, we implement a solution method developed by Bansal and Yaron(2004) that is widely used
in the macroeconomics and finance literatures; see, e.g. Bollerslev, Tauchen, and Zhou(2009), Bansal, Kiku,
and Yaron(2012) and Schorfheide, Song, and Yaron(2014). Rudebusch and Swanson(2012) and Caldara,
Fernández-Villaverde, Rubio-Ramı́rez, and Yao(2012) describe other solution methods.

4

for regions of the parameter space that researchers have traditionally found plausible. This is
an issue for all models in the literature that use recursive preferences with a few exceptions,
and not specific to our model. We provide conditions on the model’s parameters guaranteeing
the existence of a solution. The general rule is that agents cannot be too patient. A direct
implication is that an extremely patient agent faces strong restrictions in their risk aversion
and intertemporal elasticity of substitution. These conditions partition the parameter space
and make it cumbersome for econometricians implementing either an optimization-based
frequentist estimator or Bayesian Markov chain Monte Carlo algorithm.
This paper continues as follows. Subsection 1.1 discusses the literature. We introduce
the new model with habit formation and recursive preferences in Section 2, and discusses
its properties in Section 3. Section 4 describes empirical strategy for estimation and the
consequent estimates. Section 5 examines the model’s implication for bonds. In Section 6,
we discuss the conditions for a solution to exist. The paper concludes in Section 7.

1.1

Relationship to the literature

Our specification for habit is motivated by Abel(1999) and Campbell and Cochrane(1999).
Campbell and Cochrane(1999) introduce a risk sensitivity function that generates timevarying risk premia that are functions of the past history of shocks to consumption growth.
Our model uses ratio habits as in Abel(1999) and allows the habit to be influenced by a risk
sensitivity function as in Campbell and Cochrane(1999), albeit with a different functional
form. The combination of the two allow the representative agent’s period utility and their
marginal rate of substitution to depend on the state of the economy. Wachter(2006) studies
bonds with Campbell and Cochrane(1999) style habit formation. Dew-Becker(2014) introduces a multiplicative habit to study bonds in a DSGE model. Our primary contribution to
the habit literature is that we develop a model that has an analytical bond prices, making
this class of models tractable.
A large literature in macroeconomics and finance uses recursive preferences as developed
5

by Kreps and Porteus(1978), Epstein and Zin(1989), and Weil(1989). These preferences
separate intertemporal substitution from risk aversion, which are directly linked under power
utility. An endowment economy with recursive preferences and affine dynamics of the state
variables is particularly attractive because it generates (approximate) closed-form solutions
for bond and equity prices. A prime example is the long-run risk model of Bansal and
Yaron(2004). Several authors have studied the yield curve using this framework. Piazzesi
and Schneider(2007) study an economy with recursive preferences when the elasticity of
intertemporal substitution equals one and shocks to consumption growth and inflation are
homoskedastic; see also, e.g. Tallarini(2000), and Hansen, Heaton, and Li(2008). Bansal
and Shaliastovich(2013) evaluate a model where expected inflation and consumption growth
are slow moving and have stochastic volatility. The difference between our work and these
papers is the existence of habit formation, which is critical for introducing a time-varying
price of risk.
Albuquerque, Eichenbaum, and Rebelo(2014) and Schorfheide, Song, and Yaron(2014)
analyze models where the period utility has a time varying preference. We show how this
formulation relates to habit formation. In their specifications, shocks to preferences introduce
additional latent factors that can influence asset prices. But, these shocks do not introduce
time-varying risk premia, which is the key focus of our paper.
Another class of consumption-based models that have recently drawn attention for their
ability to explain asset pricing anomalies are models with rare consumption disasters; see,
e.g. Barro(2006), Gabaix(2012), and Wachter(2013). Wachter(2013) considers a model with
recursive preferences with a time-varying probability of a jump in consumption growth.
When applied to the yield curve, this model will generate time-varying term premia that are
driven by the time-varying intensities of jumps to consumption growth and/or inflation. This
mechanism can be seen as an alternative to stochastic volatility for generating a time-varying
quantity of risk. Note that the model has a constant price of risk.

6

2

Model

In this section, we build a structural model that encompasses the two competing channels
that drive time variation in term premia: time-varying price and quantity of risk. We do
so by introducing external habit into recursive preferences in a tractable framework. The
novelty is two fold. First, unlike a standard model with recursive preferences, such a model
generates a time-varying market price of risk. Moreover, different from the popular habit
formation models in the literature, our model gains its tractability by retaining an affine
form.

2.1

Agent’s problem

We consider an endowment economy, where the representative agent optimizes over his
lifetime utility
"



Vt = max (1 − β)
Ct

Ct
Ht

1−η

 1−γ 
+ β Et Vt+1


1−η
1−γ

1
# 1−η

(1)

with respect to consumption Ct . Ht is the level of the external habit. For the same amount of
consumption, a higher habit makes the agent less happy. The same as Abel(1999), we assume
that agent’s utility depends on the ratio between consumption and habit. For example,
doubling both the consumption and habit does not change the agent’s utility. β is the
time discount factor, γ measures risk aversion, and ψ =

1
η

is the elasticity of intertemporal

substitution when there is no uncertainty.
Agents maximize utility (1) subject to the budget constraint

Wt+1 = (Wt − Ct ) Rc,t+1 ,

(2)

where Wt is wealth and Rc,t+1 is the gross return on the consumption asset between t and
t + 1.
7

The first order condition of the agent’s problem implies that the log stochastic discount
factor (SDF) is

mt+1 = ϑ ln (β) + ϑ∆υt+1 − ηϑ∆ct+1 + (ϑ − 1) rc,t+1 ,

where ϑ ≡

1−γ
,
1−η

(3)

∆ct+1 = ln (Ct+1 ) − ln (Ct ) is consumption growth, and rc,t+1 = ln (Rc,t+1 )

is the continuously compounded return. These terms are standard in models with recursive
preferences.
The new term ∆υt+1 ≡ (η − 1)(ln Ht+1 − ln Ht ) measures the stochastic growth rate of
habit, and it is unique to our new model. It is this term that enables enough variation in
the pricing kernel to capture the time-varying risk premium in bond prices through a timevarying price of risk. For a derivation, see Appendix A. Nominal assets are priced using the
nominal pricing kernel

m$t+1 = mt+1 − πt+1 ,

(4)

where inflation is πt+1 = ln (Πt+1 ) − ln (Πt ) and Πt is the nominal price level.

2.2

Dynamics

The state of the economy is summarized by a G × 1 vector gt , which includes consumption
growth ∆ct and inflation πt
∆ct = Zc0 gt ,

(5)

πt = Zπ0 gt ,

(6)

8

where Zc and Zπ are G × 1 selection vectors containing only zeros and ones. The state vector
follows a heteroskedastic vector autoregressive process, summarized in companion form as

gt+1 = µg + Φg gt + Φgh ht + Σgh εh,t+1 + Σg,t εg,t+1
H
X
0
0
Σg,t Σg,t = Σ0,g Σ0,g +
Σi,g Σ0i,g hit

εg,t+1 ∼ N (0, I)

(7)

i=1

ht+1 ∼ NCG (νh , Φh , Σh )

(8)

εh,t+1 = ht+1 − Et [ht+1 |ht ]

where ht is a H × 1 vector following a non-central gamma (NCG) process as in Creal and
Wu(2015b). This process guarantees the non-negativity of volatility. This contrasts with
the Gaussian process that is prevalent in most of the literature, for example, see Bansal and
Yaron(2004) and Bansal and Shaliastovich(2013).
This is an affine process that is the exact discrete time equivalent of a multivariate
Cox, Ingersoll, and Ross(1985) process. The conditional mean is Et [ht+1 |ht ] = Σh νh + Φh ht
meaning that Φh controls the autocovariance of ht+1 and Σh νh is the drift. Σh is a matrix of
scale parameters and νh are a vector of shape parameters. The vector εh,t+1 are mean zero,
heteroskedastic shocks to volatility and Σgh measures the covariance between Gaussian and
non-Gaussian shocks, i.e. the volatility feedback effect. Further details on properties of the
model can be found in Appendix B.2
The general process (7) - (8) nests popular models in the literature. Consider a model
with long-run risks for consumption growth as in Bansal and Yaron(2004) and a time-varying
2

The timing of how volatility scales the shocks in discrete-time models such as (7) is an outstanding issue
in financial econometrics. Both timings Σg,t εg,t+1 and Σg,t+1 εg,t+1 lead to log-SDF’s that are linear in the
state variables and produce affine bond prices. Our analysis focuses on the timing in (7), which is common
in finance. However, the alternative timing Σg,t+1 εg,t+1 means the representative agent faces greater short
term uncertainty. Volatility has an immediate and potentially more significant impact on the short rate (and
consequently all yields) even when there is no volatility feedback effect.

9

trend in inflation similar to Stock and Watson(2007). The model is

πt+1 = π̄t + επ1 ,t+1

επ1 ,t+1 ∼ N (0, ht,π1 )

(9)

∆ct+1 = c̄t + εc1 ,t+1

εc1 ,t+1 ∼ N (0, ht,c1 )

(10)

π̄t+1 = µπ + φπ π̄t + φπ,c c̄t + επ2 ,t+1

επ2 ,t+1 ∼ N (0, ht,π2 )

(11)

c̄t+1 = µc + φc,π π̄t + φc c̄t + σc,π επ2 ,t+1 + εc2 ,t+1

εc2 ,t+1 ∼ N (0, ht,c2 )

(12)

where c̄t is the expected consumption growth rate and π̄t is expected inflation. The shocks
εc1 ,t and επ1 ,t are transitory, and determine the high-frequency movements in their respective
series whereas επ2 ,t and εc2 ,t are shocks to their persistent components. In our model, shocks
to expected inflation have a contemporaneous impact on expected consumption growth,
and all shocks have stochastic volatility. The state vectors are gt = (πt , ∆ct , π̄t , c̄t )0 and
ht = (ht,π1 , ht,c1 , ht,π2 , ht,c2 )0 . See Appendix B.2 for more details.
Although our empirical implementation will focus on this popular long run risk specification, note that our general framework in (7) - (8) can also nest a vector autoregressive moving
average model for consumption growth and inflation, like the one studied in Wachter(2006).

2.3

Habit

The empirical conclusion in the GATSM literature is that risk premia are driven by the
levels of the state variables through the price of risk. Motivated by this empirical finding, we
build this channel in our model through the time varying growth rate of habit. We discipline
our model using this empirical fact, and only allow habit growth to depend on the levels
of macroeconomic variables. Then we will empirically test whether such a parsimonious
specification generates enough variation in the term premium from our structural model to
capture the data. The habit growth is
∆υt+1 = Λ1 (gt ) + Λ2 (gt )0 εg,t+1 ,
10

(13)

which depends on the levels of past inflation and consumption as well as their shocks in the
current period. The dependence on inflation is motivated by the real effect of inflation as
argued by Piazzesi and Schneider(2007) and Bansal and Shaliastovich(2013).
The key term, the risk sensitivity function Λ2 (gt ), works through a similar mechanism
as in Campbell and Cochrane(1999) and Wachter(2006) to generate a time-varying price of
risk, and hence risk premium. The difference is that our choice of functional form allows the
model to stay within the affine family and have analytical bond prices:

Λ2 (gt ) = −ηΣ−1
g,t (λ0 + λg gt ) ,
2

and Λ1 (gt ) = − ϑη2 (λ0 + λg gt )0 Σg,t Σ0g,t

−1

(14)

(λ0 + λg gt ). This specification can be readily

extended to a more complex model where changes in habit ∆υt+1 also depend on the volatilities and their shocks, see the earlier working paper version of Creal and Wu(2015a). This
extension could potentially introduce more complex channels to explain movements in asset
prices. Instead, we keep the model intentionally simple and examine how well the current
channels can explain yields.
When γ = η, the model with recursive preferences reduces to power utility with habit.
In this case, if one chooses

Λ1t = (1 − φ) (ῡ − υt )
1p
η + 2 (υt − ῡ) + ησc ,
Λ2t =
H̄
∆ct+1 = c̄ + σc εc1 ,t+1 , and εg,t+1 = εc1 ,t+1 , then the resulting SDF in (3) becomes the SDF of
the habit formation model in Wachter(2006). Consequently, asset prices in the two models
are observationally equivalent.
There are two main differences. First, our choice for the risk sensitivity functions yield
an affine structure. This implies analytical bond prices which provide tractability. Second,
we allow not only consumption, but inflation risk to be priced. It turns out the price of
11

expected inflation is the key driving factor.

2.4

Solving rc,t+1

The SDF in (3) is a function of the return on the consumption asset rc,t+1 , which is generally
regarded as unobserved in the data. We solve for it using the log-linearization technique of
Campbell and Shiller(1989), applied by, for example, Bansal and Yaron(2004) and Bansal,
Kiku, and Yaron(2012).3 We express the return as a function of the price to consumption
ratio

rc,t+1 ≡ ln

Pt+1 + Ct+1
Pt


= ∆ct+1 − pct + ln (1 + exp (pct+1 ))

≈ κ0 + κ1 pct+1 − pct + ∆ct+1 ,

where Pt+1 is the price of consumption goods, pct = ln

(15)
 
Pt
Ct

is the log price to consump-

tion ratio. κ0 and κ1 are log-linearization constants that depend on the average price to
consumption ratio pc
¯ = E [pct ]. The derivation can be found in Appendix C.1.
As the real pricing kernel in (3) must also price the consumption good

1 = Et [exp (mt+1 + rc,t+1 )]

(16)

we can guess and verify a solution for

pct = D0 + Dg0 gt + Dh0 ht .

(17)

This is a fixed point problem: pct depends on κ0 , κ1 through D0 , Dg , Dh , which in turn
depend on pc.
¯ We discuss the details of this fixed point problem in Appendix C, and the
existence of a solution in Section 6.
3

The solution method used by Campbell, Giglio, Polk, and Turley(2014) for their ICAPM model is similar,
only they substitute out consumption instead of the return on the consumption asset.

12

Finally, (15) and (17) together express rc,t+1 and hence the pricing kernel mt+1 as functions of the underlying state variables gt and ht .

2.5

Relation to preference shock

The habit Ht can be re-parameterized to take on the interpretation of time-varying preference
in the recent macroeconomics literature, see Albuquerque, Eichenbaum, and Rebelo(2014)
and Schorfheide, Song, and Yaron(2014). If we define Υt ≡ Htη−1 , then (1) becomes

Vt = max (1 −
Ct

β) Υt Ct1−η

  1−γ 
+ β Et Vt+1

1−η
1−γ

1
 1−η

,

(18)

where Υt is the time preference. To demonstrate the basic intuition why these two interpretations are equivalent, let us suppose η < 1 for now. When the habit Ht is higher, agents
become less satisfied with the same amount of consumption. This is equivalent to saying
that agents reduce their preference for consumption this period, hence a smaller Υt .
The preference shock can be defined as ∆υt+1 = ln Υt+1 − ln Υt . If we re-parameterize
the process in (13) as ∆υt+1 = Zυ0 gt+1 and allow ∆υt+1 to be represented by a new latent
factor, then this gets us the specification in the macroeconomics literature, for example, Albuquerque, Eichenbaum, and Rebelo(2014) and Schorfheide, Song, and Yaron(2014). Note,
we can readily incorporate this ingredient into our model; see the original working paper
version of Creal and Wu(2015a). Adding this feature is expected to improve the model’s fit
to the data because the role of a preference shock factor is similar to the latent factors that
are present in reduced form Gaussian ATSMs. However, a key difference is that the latent
preference shock factors do not introduce a time-varying market price of risk, which is one
of the key ingredients of our paper.

13

3

Model properties

This section examines the different components contributing to time variation in bond risk
premia. Specifically, we examine how the new specification of habit in the previous section
translates into a time-varying price of risk, and hence time-varying risk premium. We then
analyze habit’s implication for bond prices.

3.1

Sources of risk premia

Using the solution method described, in Subsection 2.4, the nominal log-SDF in deviation
from the mean form becomes



$,0
m$t+1 − Et m$t+1 = −λg,t
Σg,t εg,t+1 − λh$,0 Σh,t ε̃h,t+1

(19)

where the vector of shocks to volatility ε̃h,t+1 = Σ−1
h,t εh,t+1 have been standardized to have
unit variance. Due to the risk sensitivity functions, shocks to the SDF are heteroskedastic
with time-varying price of level risks λ$g,t being
λ$g,t = γZc + Zπ
+κ1

← power utility

γ−η
Dg
1−η

+ϑη Σg,t Σ0g,t

← recursive preferences
−1

(λ0 + λg gt ) .

← habit formation

(20)

The first two terms are inherited from power utility, the second line comes from recursive
preferences, and the terms in the third line are due to habit.
The key term in (20) is λg gt . Only when λg is non-zero does the model have a timevarying price of level risk and produce time-varying term premia that are functions of gt .
This channel remains the same even when we shut off the stochastic volatility in the dynamics
(7) - (8). Conversely, if there were no habit, i.e. λ0 = 0, λg = 0, the price of level risk is a
constant as in the literature. A time-varying price of risk that co-moves with the levels of
14

macroeconomic variables and yields is a feature of Gaussian ATSMs that makes it successful
empirically, and it is a feature that is absent in standard models with recursive preferences.
If there were no habit, i.e. if λ0 = 0 and λg = 0 ⇒ Ht = 1, then the price of short run
consumption risk is equal to the risk aversion coefficient γ, the price of short run inflation
risk is 1 for the nominal pricing kernel, and 0 for the real pricing kernel. These are consistent
with the literature.
Next, we decompose the prices of risk for the non-Gaussian shocks as

λ$h = Σ0gh (γZc + Zπ )
+κ1

← power utility


(γ − η) 0
Σgh Dg + Dh
(1 − η)

← recursive preference

These terms have similar features and functional forms as those in (20). Power utility only
has an impact on the price of volatility risk if there is a volatility feedback effect and Σgh 6= 0,
while recursive preferences generates a price of risk even when Σgh = 0. To keep our model
simple and tractable, as in the standard models with recursive preferences, our model does
not have time-varying prices of volatility risk. Like the standard models, we also have timevarying quantities of risk through stochastic volatility.

3.2

Bond prices and term premium

The price of a zero-coupon nominal bond with maturity n at time t is the expected price of
the same asset at time t + 1 discounted by the stochastic discount factor
$,(n)

Pt

h
 $,(n−1) i
= Et exp m$t+1 Pt+1
.

(21)

Affine representation Following Creal and Wu(2015b), nominal yields are an affine function of both the Gaussian state vector and volatility
$,(n)

yt

$,0
= a$n + b$,0
n,g gt + bn,h ht ,

15

(22)

where the key coefficient b$n,g = − n1 b̄$n,g , and b̄$n,g follows this recursion
b̄$n,g = (Φg − ηϑλg )0 b̄$n−1,g + b̄$1,g .

(23)

This and the rest of the bond-loadings detailed in Appendix D are similar to those found in
ATSMs.
$

One key insight from the Gaussian ATSM literature is ΦQ
g ≡ Φg − ηϑλg 6= Φg . The basic
intuition is this separates the autoregressive coefficient driving the physical dynamics Φg
$

from the coefficient driving the cross section slope of the yield curve ΦQ
g . It is this feature
that enables Gaussian ATSM to fit the data and generate enough variation in term premia.
We micro found this key channel through habit. Another contribution of our paper is to map
a consumption-based model with habits and recursive preferences into an affine framework.

Consumption-inflation representation To gain more economic insight, we can express
yields as functions of expected consumption growth and expected inflation. Assume Σgh = 0
for the sake of intuition, the short term nominal interest rate is


$,(1)
rt$ ≡ − log Pt
= − ln (β) + ηEt [∆ct+1 ] + Et [πt+1 ]
−ηϑ(ηZc + Zπ )0 (λ0 + λg gt )
+Jensen’s ineq.

It captures the time discount through β, expected consumption growth, and expected inflation. The third line adjusts for risk compensation, and is newly introduced in our model
through the risk sensitivity function in habit specification.
If consumption growth increases, then the short term interest rate increases between t
and t + 1. This is due to the agent’s motive to smooth intertemporally. With relatively
higher expected consumption tomorrow, the representative agent borrows today against
16

tomorrow’s consumption goods to smooth consumption. This pushes the interest rate higher.
If consumption growth is expected to be negative, this motivates the agent to save. They
are willing to do so even at a lower nominal interest rate. If inflation is expected to increase,
then the nominal interest rate is higher.

Term premium The nominal term premium is defined as the difference between the model
$,(n)

implied yield yt

and the average of expected future short rates over the same period
$,(n)

tpt

$,(n)

= yt

−


1  $
$
$
.
+ . . . , +rt+n−1
Et rt + rt+1
n

(24)

The term premium has a simple portfolio interpretation. An investor can buy an n-period
bond and hold it until maturity or he can purchase a sequence of 1 period bonds, repeatedly
rolling them over for n periods. The term premium measures the additional compensation a
risk averse agent needs to choose one option over another. Under the expectations hypothesis,
term premia are constant. For Gaussian models with homoskedastic shocks, this coincides
with setting λg = 0 and eliminating time-variation in the risk sensitivity functions.

4

Estimation

Stacking (22) in order for N different maturities n1 , n2 , ..., nN and adding a vector of pricing
errors et , the observation equations for yields are
yt$ = A$ + Bg$ gt + Bh$ ht + et ,

where

yt$

=



$,(n ) $,(n )
$,(n )
yt 1 , yt 2 , . . . , yt N

et ∼ i.i.d. (0, Ω)

(25)


$,0
$,0
, A$ = (a$n1 , . . . , a$nN )0 , Bg$ = (bg,n
, ..., bg,n
)0 ,and
1
N

$,0
0
Bh$ = (b$,0
h,n1 , ..., bh,nN ) .

Let θQ = (β, γ, ψ, θλ ) denote the structural parameters that enter the bond loadings,
where θλ are the habit parameters. We estimate θQ by minimizing the average of the squared

17

pricing errors et as
T
1 X 0 −1
min
e Ω et .
N T t=1 t

(26)

Computing the pricing error et involves estimating the latent state variables gt and ht , which
capture aspects of inflation and consumption and their volatilities we do not directly observe
from the data.
To quantify the latent variables and capture uncertainty around them, we resort to their
joint posterior distributions with corresponding parameters in (7) - (8) given the observed
macroeconomic data p(gt , ht , θP |m1:T ). This distribution is approximated by a Particle Gibbs
sampler detailed in Subsection 4.2.
We then minimize (26) with respect to θQ where the pricing error is computed with
et = yt$ − A$ − Bg$ ĝt − Bh$ ĥt , and ĝt , ĥt , θ̂P are evaluated at their posterior means. This
procedure is similar to Piazzesi and Schneider(2007), who estimated a stochastic process
for consumption and inflation and calibrated the structural parameters. The difference is
that we estimate these parameters by minimizing the pricing errors. This procedure has the
benefit of ensuring that the latent factors (expected inflation, expected consumption growth,
and their stochastic volatilities) maintain their intended economic interpretation because it
only uses macroeconomic data to extract them. Given the macroeconomic factors, we then
ask the question: how much variation in asset prices can we explain with the structural
model? See details in Subsection 4.3. We then comment on the estimation method popular
in the literature in Subsection 4.4.

4.1

Data and restrictions

Data The data we use are standard in the literature. Our measure of monthly real per
capita consumption growth is constructed from nominal non-durables and services data
downloaded from the NIPA tables at the U.S. Bureau of Economic Analysis. We deflate

18

each of these series by their respective price indices, add them together, and divide by the
civilian population. The population series and monthly U.S. CPI inflation are downloaded
from the Federal Reserve Bank of St. Louis. Yields are the Fama and Bliss(1987) zero
coupon bond data available from the Center for Research in Securities Prices (CRSP) with
maturities of (3, 12, 24, 36, 48, 60) months. The data spans from February 1959 through
June 2014 for a total of T = 665 observations.
Parameter restrictions For the dynamics of consumption and inflation, Σ0,g is imposed
to be 0 for identification.4 We also impose Φh , Σh to be diagonal, and Φgh = 0 and Σgh = 0
for simplicity.
If there is no habit, there are three structural parameters (β, ψ, γ) to fit the cross section
of yields. In models with habit, to keep the model simple, we only introduce four new
parameters into the matrix λg (the elements related to expected consumption, expected
inflation, and their cross terms) while we set λ0 = 0. There are a total of seven free
structural parameters. We assume the variance for the pricing errors is the same across
different maturities Ω = ω 2 I.

4.2

Estimation of macroeconomic factors

We quantify the distribution of the latent macroeconomic factors related to consumption
growth and inflation by Bayesian methods. We use a particle Gibbs sampler which is an
MCMC algorithm that uses a particle filter to draw from distributions that are intractable;
see Creal and Wu(2015b) for an application on interest uncertainty, and Creal(2012) for a
survey on particle filtering.

Given a prior distribution p θP for the P parameters in (7) - (8), we sample from the
joint posterior distribution

p θP , g1:T , h0:T |m1:T
4







∝ p m1:T |g1:T , h0:T , θP p g1:T |h0:T , θP p h0:T |θP p θP (27)

This assumption is lifted in the Gaussian model with ht = 0.

19

Table 1: Estimates of time series parameters
µπ
–

µ̄π
0.0033
(0.708e−3 )
µc
µ̄c
–
0.0015
(0.750e−3 )

φπ
0.975
(0.10)
φc,π
0
(0.05)

φπ,c
0
(0.05)
φc
0.90
(0.10)

–

σh,c
0.00
(3.5)

µ̄h,π2
φh,π2
1.97e−7
0.975
(9.20e−7 ) (0.009)
µ̄h,c2
φh,c2
3.77e−8
0.975
(8.32e−8 ) (0.009)

σh,π2
1.70e−11
(2.51e−11 )
σh,c2
1.30e−12
(1.73e−12 )

µ̄h,π1
φh,π1
4.04e−6
0.975
(5.08e−6 ) (0.009)
µ̄h,c1
φh,c1
1.08e−5
0.975
(6.57e−6 ) (0.009)

σh,π1
6.23e−9
(5.35e−10 )
σh,c1
1.02e−8
(1.57e−9 )

µπ
µ̄π
φπ
φπ,c
–
µ̄h,π2
φh,π2
σh,π2
µ̄h,π1
φh,π1
σh,π1
−0.096e−4
0.0031
0.978
0.057
0.269e−6
0.984
0.317e−9
0.333e−5
0.989
0.724e−8
0.734e−4 (0.497e−3 ) (0.014) (0.033)
(0.091e−6 ) (0.007) (0.120e−9 ) (0.077e−5 ) (0.004) (0.0729e−8 )
µc
µ̄c
φc,π
φc
σc,π
µ̄h,c2
φh,c2
σh,c2
µ̄h,c1
φh,c1
σh,c1
0.856e−4
0.0014 -0.002
0.941 −0.394
0.664e−6
0.980
0.340e−10
0.891e−5
0.992
0.137e−7
(0.592e−4 ) (0.278e−3 ) (0.010) (0.029) (0.190) (0.372e−6 ) (0.009) (0.169e−10 ) (0.216e−5 ) (0.003) (0.225e−8 )

Prior (top) and posterior (bottom) mean and standard deviation (in parentheses) of our benchmark model
in (9)-(12).

where mt = (∆ct , πt ) and xt:t+k = (xt , . . . , xt+k ). Starting with an initial value for the
parameters θP,(0) , the particle Gibbs sampler draws from this distribution by iterating for
j = 1, . . . , M between the two full conditional distributions

(g1:T , h0:T )(j) ∼ p g1:T , h0:T |m1:T , θP,(j−1)


(j)
(j)
P,(j)
P
θ
∼ p θ |m1:T , g1:T , h0:T



(28)
(29)

This produces a Markov chain whose stationary distribution is the posterior (27). The
models for consumption growth and inflation (9)-(12) are non-linear, non-Gaussian state
space models. In these models, the full conditional distribution of the latent state variables
given the data and model’s parameters (28) is not easy to sample. The particle Gibbs
sampler overcomes this limitation by using a particle filter to jointly sample paths of the
state variables (g1:T , h0:T ) in large blocks. Consequently, it improves the mixing of the
MCMC algorithm and the efficiency with which the Markov chain explores the parameter
space. Further details of the algorithm can be found in Appendix F.1, see also Creal and
Tsay(2015) for a longer discussion.
Using the particle Gibbs sampler, we estimate the long-run risk model of consumption
and inflation in (9)-(12). Posterior means and standard deviations for the parameters of the
model are in Table 1. Filtered (in red) and smoothed (in blue) estimates of the latent state
20

Figure 1: Estimated factors from the long run risk model.

Filtered (red) and smoothed (blue) estimates of the factors from the long-run risk model. Top row is consumption growth and bottom row is inflation. Top left to right: long-run risk c̄t , variance of long-run risk ht,c2 ,
variance of high-frequency component ht,c1 . Bottom left to right: inflation trend π̄t , variance of expected
inflation ht,π2 , variance of high-frequency component ht,π1 .

variables are plotted in Figure 1.
There is considerable variation in the long-run risk factor c̄t of consumption growth (top
left). It shows a noticeable decline during each recession, with the largest decline during
the Great Recession. The pattern replicates the long run risk in the literature. While
the volatility of the long run growth rate (top middle) is economically small and does not
vary much, the stochastic volatility of the high frequency component (top right) is larger
with more variation. The volatility of trend inflation increases during the mid-1970’s, peaks
during the early 1980’s, and declines gradually until the mid 1980s and keeps at a low level
afterwards. The estimates of stochastic volatility from this model of inflation are similar to
those found by Stock and Watson(2007) and Creal(2012).

21

4.3

Cross sectional regression

Given the estimated parameters θ̂P and the factors ĝt and ĥt from Subsection 4.2, we estimate
the structural parameters θQ = (β, γ, ψ, θλ ) through non-linear least squares. We compute
the pricing error by






et = yt$ − A$ θQ , θ̂P − Bg$ θQ , θ̂P ĝt − Bh$ θQ , θ̂P ĥt ,

(30)

and then minimize the objective function in (26) with respect to θQ .
The structural parameter estimates are in Table 2. With the restrictions in Subsec$

tion 4.1, θλ = λg . Note that estimating (β, γ, ψ, λg ) is equivalent to estimating (β, γ, ψ, ΦQ
g ).
$

We implement the latter as we have a better prior knowledge of the scale of ΦQ
g . The left
panel reports the global maximum. The time discount factor β is 0.9998, the intertemporal
rate of substitution ψ is 1.02, and the risk aversion parameter γ is about 7. The risk-neutral
$

autoregressive matrix ΦQ
is much more persistent than its time series counterpart Φg in
g
Table 1, with both eigenvalues around 0.995. This high persistence generates the upward
sloping yield curve discussed in Subsection 5.3. In the right panel, we report a local maximum. This maximum also generates an upward sloping yield curve as the global, see Table 4,
and its implied term premium is qualitatively similar to the global maximum. However, the
structural parameters take economically different values.
There exists a long standing debate about the qualitative feature of the structural parameters, for example, whether ψ > 1. The long run risk literature (Bansal and Yaron(2004))
argues that values of ψ > 1 should be the case. On the other hand, Campbell(2011) argues
the opposite to be consistent with the aggregate evidence. Although the estimate in the
global maximum is consistent with the former ψ > 1, our local maximum features ψ < 1.
β is smaller than 1 in the global, and is bigger than 1 in the local. γ varies from 7 in the
global to about 2 in the local.
The differences in these preference parameters do not change the model’s implication for

22

Table 2: Structural parameter estimates
global
local
Preference ψ

1.02
(0.03)
0.9998
(0.0000)
6.75
(2.02)

β
γ
Habit

ΦQ
g

λg

0.70
(0.04)
1.003
(0.000)
1.73
(0.16)

$

0.993
0.018
0.994 -0.015
(0.002) (0.007) (0.003) (0.005)
0.000
0.997 -0.005
0.996
(0.001) (0.000) (0.002) (0.000)
1e−3 ×
0.05
-0.12 -0.007
0.030
0.00
0.18
0.001 -0.023

Structural parameters estimates for our benchmark model. Left: the global estimates. Right:
one local maximum. Standard errors are Newey and West(1987).
$

bond prices. The key that is consistent across the two maxima is how persistent ΦQ
is.
g
It is this feature that enables both maxima to capture the feature of the data, generating
upward sloping yield curve, and realistic term premia. This feature is also consistent with
the findings in the Gaussian ATSM literature.

4.4

Alternative methods in the literature

A popular alternative approach adopted, for example, by Bansal and Shaliastovich(2013)
among others, is to assume a subset of yields are measured without error and invert the
latent macroeconomic factors as linear combinations of yields. Specifically, a researcher could
assume that the pricing errors et in (25) are zero for N1 yields: yto,$ = Ao,$ + Bgo,$ gt + Bho,$ ht .
Then, the N1 latent factors among gt and ht can be estimated by inverting this relationship
making the estimated factors linear functions of yto,$ . Note that N1 does not have to be equal
to G+H. For example, Bansal and Shaliastovich(2013) choose N1 = 3 and estimate expected
consumption growth and the two volatilities for expected components as linear combinations
23

of yields. By construction, the latent macroeconomic factors are completely made of yields.
The factors can lose their intended interpretation as ‘macroeconomic’ factors.
Table 3 illustrates this point by computing the R2 ’s of regressing implied macroeconomic
factors on yields. The first column uses our estimated macro factors described in Subsection 4.2 as the dependent variables, and yields only account for less than 50% of their
variation for most variables. Put differently, macroeconomic variables and volatilities have
their own rich dynamics which are not spanned by the yields. This is consistent with the
ATSM literature, see Collin-Dufresne, Goldstein, and Jones(2008) and Creal and Wu(2015b).
If we use the alternative procedure that inverts all the latent factors from yields, the R2 are
100% by construction (the second column). That is because macro factors are linear combination of yields, and they look similar to the level and slope factors one would typically
estimate from a reduced-form GATSM.
The loss of economic interpretation resulting from the inversion method does not change
completely when we allow measurement errors on all the yields. More precisely, we use the
particle Gibbs sampler as discussed in Subsection 4.2 to estimate a long run risk model with
stochastic volatility but not habit when yields and macroeconomic variables are observed
simultaneously. In this case, we assume that all the yields are priced with errors.5 We report
the R2 ’s from this model in column 3. The R2 ’s are still extremely high, especially, the
numbers are still close to 100% for the level factors in the first two rows. This is because the
estimated latent factors load predominantly on the yields as we observe an entire cross section
of yields, and they display smaller idiosyncratic variance than macroeconomic data. The
forecasting errors for the macroeconomic data from this model are significantly larger than
our estimates, to the degree that the estimated latent factors do not resemble macroeconomic
variables themselves. The R2 for the expected growth volatility is 72% percent, much higher
than its counterpart in the first column. The only exception is the volatility of expected
inflation, only 36% of which is explained by yields. The explanation is intuitive: as expected
5

We impose η = 1 so the model has an analytical solution. This model generalizes the model in Piazzesi
and Schneider(2007) to include stochastic volatility.

24

Table 3: R2 regressing macro factors on yields
our estimates
inversion
w/o p.e w/ p.e.
expected inflation
expeted growth
expected inflation vol
expected growth vol

57%
31%
48%
31%

100%
100%
100%
100%

98%
96%
36%
72%

R2 s from regressing macro factors on 6 observed yields. First column: our estimates of latent macro factors
using only information from macro data as detailed in Subsection 4.2. Second column: we assume some of
the yields are priced without error and the latent factors are estimated from yields by inverting the pricing
equation. Third column: we estimate a long run risk model, with SV and without habit. The factors are
jointly estimated from both macroecomomic variables and yields, where the latter have pricing errors. Row
1-4: expected inflation, expected consumption growth and their volatilities.

inflation is basically a linear combination of yields with 98% of its variation explained,
therefore, much of its volatility can be explained by yield volatility rather than yields. The
R2 of a regression of this factor on yield volatility is 75%, when we use a simple GARCH
model to estimate the regressors.
The inversion approach is not without merit. As the estimated factors are close to the
level and slope factors associated with reduced-form ATSMs, it can fit the cross section of
yields well as expected.6 Therefore, from an econometric perspective, it lowers the prediction
errors overall by trading off an improved fit for yields while sacrificing the fit of macroeconomic variables. However, from an economic point of view, it is questionable whether these
objects should still be labeled as macroeconomic factors, as they do not resemble the true
dynamics of the observed macroeconomic data.
Instead, our goal is to take the macroeconomic factors as given, and ask how much
variation in asset prices the structural model can explain. To do this, we impose a strong
discipline on the estimation procedure such that the macroeconomic factors are estimated
using only information from macroeconomic data. This makes it harder for the model to fit
the yield data. But, we view retaining the factors’ intended economic interpretation as an
appealing feature of our approach.
6

Bansal, Gallant, and Tauchen(2007) demonstrate a similar point studying equity returns and dividends.

25

5

Bond term premium and habit

Bond term premia are a crucial input for central banks to implement monetary policy and
the key object of interest for our paper. In this section, we empirically study whether
the model proposed in Section 2 adequately captures the time-variation of term premia.
Then, we decompose this time variation into the alternative channels that contribute to
it. Empirically, we find the predominant channel is the time-varying habit that drives the
variation in the price of risk. Specifically, the key term is the price of expected inflation risk,
which loads on expected inflation itself. We then study the property of habit and its role
for the consumption based models to fit the slope of the yield curve, the key moment of the
term structure discussed in the literature.

5.1

Term premium and its sources

We plot the 1 year (in blue) and 5 year (in red) term premia from our model in the top left
panel of Figure 2. The long term (5-year) term premium displays more variation than the
medium term (1-year) term premium. The 5-year term premium was low (less than 1%) at
the beginning of our sample. It increased through the 1960s and 70s, peaked in the early
1980s at about 4%, and then it trended down. It became negative during the Great Recession.
This can be attributed to a flight to quality or the Fed’s large-scale asset purchases. For
comparison, we plot the output from a three factor reduced form Gaussian ATSM in the top
right panel, which serves as a benchmark for many policy discussions (for implementation
details, see for example, Hamilton and Wu(2012) and Creal and Wu(2015b)). Both the size
and time variation of our estimates resemble the reduced form ATSM estimates.
With both time-varying price and quantity of risk built in, our model does an adequate
job of capturing the pattern of term premia exhibited in the data. The question is then which
channel contributes more? The literature provides two opposite answers: the reduced form
Gaussian ATSM attributes the time-varying term premia completely to a time-varying price

26

Figure 2: Estimated term premia from alternative models
SV w habit

GATSM
1 year
5 years

4
2

2

0

0

-2
1960

1970

1980

1990

2000

1 year
5 years

4

-2
1960

2010

1970

SV w/o habit

0

1980

1990

2000

2010

Gaussian w/ habit
1 year
5 years

-0.01

1 year
5 years

4

-0.02

2

-0.03
0
-0.04
-0.05
1960

1970

1980

1990

2000

-2
1960

2010

1970

1980

1990

2000

2010

Estimated 1 and 5 year term premia from alternative models. Top left: SV model with habit; Top right:
reduced-form 3 factor Gaussian ATSM. bottom left: SV model with no habit; Bottom right: Gaussian model
with habit; Y-axis: interest rates measured in annualized percentage points.

of risk; while the literature on recursive preferences, especially the long run risk literature,
attributes it completely to a time-varying quantity of risk. Our unifying framework equips
us with a more comprehensive view to answer this question. We do so by studying how much
time variation there would be if we shut down one channel at a time.
$

First, we shut down the price of risk channel by setting λg = 0, or equivalently ΦQ
g = Φg .
This model is similar to those in the long run risk literature, Bansal and Shaliastovich(2013),
for example. The difference is that we model the volatility process with a non-central Gamma
process guaranteeing its non-negativity, whereas the literature models it with a Gaussian
process. We re-optimize the objective function subject to the constraint λg = 0, and plot
the implied term premium in the bottom left panel of Figure 2. Without habit, although
non-constant, the term premia are economically insignificant: the one year term premium is
essentially zero over time, and the five year term premium peaks at about -5 basis points,
27

orders of magnitude smaller than the estimates in the top panels. Moreover, the term premia
generated by this model are negative, which is the wrong sign.7 All these are counter-intuitive
and implausible. Hence, only time-varying quantity of risk is not sufficient to account for
variation in term premium.
The conclusion seems to be at odds with the long run risk literature. As discussed in detail in Subsection 4.4, the difference is a consequence of different estimation techniques. Our
approach disciplines the macroeconomic factors, such as expected inflation and consumption, to fit the observed macroeconomic data. Consequently, the estimated factors retain
their economic interpretations whereas the literature obtains these macroeconomic factors
as linear combinations of bond yields, potentially compromising their interpretation, see a
more detailed discussion in Subsection 4.4.
Next, we shut down the time variation in the quantity of risk channel by setting ht = 0 in
(7) - (8), but still allow habit λg 6= 0. Then the factor dynamics follow a Gaussian VAR. The
resulting term premia from re-optimizing this restricted model are depicted in the bottom
right panel. Interestingly, both the size and time variation of the term premia resemble the
estimates in the top panels. Hence, the price of risk alone generates the amount of variation
of term premia as we observe from the reduced form estimates.
We have established that a time-varying price of risk through habit is a channel that
can explain almost all of the variation in the bond term premia. We then further ask: is
the price of inflation risk or consumption risk time varying? What drives the variation in
this price? First, we only allow the price of expected inflation risk to vary over time, and
also restrict it to comove with the expected inflation itself. We implement this by imposing
the following restrictions on our estimates in Table 2: all components in λg are zero but the
$

$

Q
λπ̄,π̄ , or equivalently ΦQ
g = Φg for all but one component φπ̄,π̄ 6= φπ̄,π̄ . This is plotted in the

red line in Figure 3. As a comparison, we plot our benchmark estimate in blue, which is
7

Our results are not specific to our estimates for the structural parameters. If we calibrate the structural
parameters using the values from Bansal and Yaron(2004) for (β, γ, η), the model still produces the same
pattern.

28

Figure 3: Term premia

benchmark
inflation
consumption

4
2
0
-2
1960

1970

1980

1990

2000

2010

Estimated 5 year term premia. Blue: benchmark. Red: λg is all set to 0 but the component relating to price
of expected inflation risk loading on itself. Yellow: λg is all set to 0 but the component relating to price of
expected consumption risk loading on itself.

identical to the red line in the top left panel of Figure 2. We can see the variation in blue
is primarily coming from the price of expected inflation risk loading on itself, and this one
single component allows us to capture the predominant variation in the term premium. As
a contrast, we plot in yellow estimates of the term premia when we only allow the price of
expected consumption risk to be non-zero, and to vary with itself. Although displaying as
much variation, it does not resemble the key economic feature in the term premium. For
example, the term premium was lower in the 1960s, and peaked in the early 1980s in the
benchmark model. The yellow line showed an opposite pattern: it was high in the middle
of 1960s, and became negative during the 1970-1980s when the term premium was generally
considered to be extremely high. This is counter-intuitive.
The overall picture is that the key driver for the time variation in term premium of the
Treasury bond is a time-varying price of expected inflation, and the time variation comoves
with the expected inflation itself.

29

Figure 4: Habit and habit growth
0.05
habit growth

0

-0.05
1960

1970

1980

1990

2000

2010

2
habit

1

0
1960

1970

1980

1990

2000

2010

2
C/H

1

0
1960

1970

1980

1990

2000

2010

Top panel: demeaned ∆υt /(η − 1), black dashed line is 0. Middle panel: Ht accumulated by the demeaned
∆υt /(η − 1), and then initialized to have mean 1, black line is 1. Bottom panel: consumption to habit ratio
Ct /Ht , initializing at 1. Shades: NBER recessions.

5.2

Habit

In the previous subsection, we established that the time varying price of risk through habit
is the main channel that drives the dynamics of bond term premia. We now turn to study
the property of habit. Figure 4 plots the historical dynamics of habit and its growth rate.
Habit growth is ln Ht+1 − ln Ht = ∆υt+1 /(η − 1). We plot the demeaned version in the top
panel. Note, the habit growth is heteroskedastic, and the time-varying conditional variance
is determined by the risk sensitivity function. The habit growth rate fluctuates around its
mean. It peaked twice between 1970 and 1980. Then it dropped to its lowest point during the
first recession in 1980s. Since then it was mostly negative, and only went back to persistently
positive during the Great Recession.
The middle panel plots the habit Ht itself, which intuitively summarizes how agents
shift their desire for consumption goods over time. We initialize it such that the mean is 1.
30

The habit above 1 means that agents require more consumption to achieve the same utility;
when it is below 1, agents require less consumption goods. The bottom panel plots the
consumption-habit ratio Ct /Ht , where we take out the deterministic trend for both series8 ,
and initialize the consumption and habit at the same level, hence the ratio starts at 1.
The habit started at 0.8, and it was kept below 1 until the onset of the second recession in
the 1970s. For this period, a lower habit than average allows agents to be satisfied with less
consumption goods. The overall effect on agents’ utility reflected in the consumption-habit
ratio is above 1, meaning consumption is higher than habit, and agents are happier. Then
the habit kept increasing until the first recession in the early 1980s reaching a maximum of
about 1.9. At that point, 90% more consumption than average is required to maintain the
same satisfaction. Similarly, consumption dropped to about 46% of habit, making agents
least satisfied. Since then, habit displayed a downward trend for the second half of the
sample. It bottomed at 0.6 during the Great Recession. The consumption to habit ratio went
the opposite direction and peaked right before the Great Recession at about 1.5, meaning
consumption is 50% more than habit, making agents happier. Finally, habit leveled out at
about 0.8 since, which is the same level as the beginning of the sample. At the same time,
the consumption to habit ratio returned to 1.
The dynamics of habit is persistent, and it is this slow moving nature of the habit that
generates enough variation in (3), and hence capture the risk premium in asset prices. This
is consistent with the intuition in the literature on habit, see Campbell and Cochrane(1999)
and Wachter(2006) for examples.

5.3

Slope of the yield curve

This section assesses the role habit plays in capturing a key moment of the yield curve, its
unconditional slope. Table 4 shows the cross section of the yield curve, averaged over time.
The top row represents the data. A well established feature of the cross section of the yield
8

The deterministic trend of consumption to habit ratio is mathematically indistinguishable from β.

31

Table 4: Unconditional yield curves
3
12
24
36
48
data
SV w/ habit
Gaussian w/ habbit
SV w/o habit

global
local

60 average

slope

4.94

5.33

5.54

5.72

5.88

5.98

5.57

1.04

4.91
4.95

5.27
5.20

5.63
5.49

5.85
5.74

5.92
5.95

5.84
6.13

5.57
5.58

0.93
1.18

5.08
5.64

5.25
5.63

5.47
5.61

5.69
5.59

5.89
5.57

6.09
5.56

5.58
5.60

1.01
-0.08

Average yields in annualized percentage points across time in the data (first row), our benchmark model
with both stochastic volatility and habit (second and third row), model without stochastic volatility (fourth
row), and model without habit (last row) for maturities of 3 - 60 months. Each column corresponds to one
maturity. The last two columns are the average level of yields across all 6 maturities, and the slope is defined
as the difference between the 60 month and 3 month yields.

curve is that it slopes upwards, and the difference between the long end and the short end
(i.e. slope) is 1.04%. The second row captures our model, it mimics the first row closely, and
implies a slope of 0.93%. The third row is the local maximum of our model in Table 2. It
shows a similar slope of 1.18%. Row 4 allows habit but shuts down the stochastic volatility
channel, and it paints the same picture as our benchmark model.
In contrast, if we do not allow habit to play a roll by imposing λg = 0, then the 5th row
in Table 4 shows a counterfactual downward slope, and the number is -0.08%. The basic
intuition is: the stochastic volatility models seem to be flexible with 4 Gaussian factors and 4
volatility factors. However, the main constraint is that there are only 3 structural parameters
(β, γ, ψ) to control the cross section, and all of them mainly enter the intercept term a$n
in (22). Without habit λg = 0, the autoregressive coefficient determining the time series
dynamics Φg controls the slope of the yield curve at the same time reflected in the key term
b̄$n,g in (23). In the Gaussian ATSM literature, Duffee(2002) has shown that the separation
between the two is important for capturing key features of the data. With habit, we are able
$

to achieve this separation, and allow the risk neutral parameter ΦQ
g ≡ Φg − ηϑλg 6= Φg to
fit the cross section of the yield curve, and not be constrained by the time series dynamics.
We have demonstrated that our model fits the cross section of the yield curve well where

32

Figure 5: Level and slope
level

20
15

0

5

-2

1970

1980

1990

2000

data
model

2

10

0
1960

slope

4

data
model

-4
1960

2010

1970

1980

1990

2000

2010

Left panel: level defined as average of yields across all maturities. Right panel: slope defined as the 5 year 3 month yield. Blue dashed line: data. Red line: model. Y-axis: annulized percentage points

habit is a key ingredient. The more challenging task is to see if it fits the time series as
well. We showed its success in the dynamics of term premia in Subsection 5.1. Although
term premia have been studied elaborately in the ATSM literature, it is fundamentally an
unobserved object. Now we turn to our model’s ability to fit the observable moments in the
data: level and slope of the yield curve.
In the left panel of figure 5, we plot the level of the yield curve over time, defined as the
average of yields across all maturities in our sample. The red line is our model, and the blue
dashed line is the data. In the right panel, we plot the slope of the yield curve defined as
5 year yield minus 3 month yield. Our model implied level and slope trace the data well,
considering our model uses macro factors rather than latent yield factors.

6

Model properties

Empirical examination of the asset pricing implications of recursive preferences requires
solving for the SDF. We base our analysis on the approximation method of Campbell
and Shiller(1989), used by Bansal, Kiku, and Yaron(2012) and Schorfheide, Song, and
Yaron(2014), among many others. With this approach, we need to solve for the return
on the consumption asset rc,t+1 as a function of the underlying state of the economy as in
33

Subsection 2.4. Whether such a solution exists mathematically amounts to a fixed point
problem. In this section, we characterize the conditions that lead to a valid solution for the
Euler equation and asset prices.9
We partition the vector of all parameters of the model θ = (β, ψ, γ, θP , θλ ) into the
preference parameters (β, ψ, γ), the parameters governing the physical dynamics θP , and the
parameters controlling habit θλ . We condition our analysis on (θP , θλ ) and characterize the
restrictions on the parameter space for the more intuitive parameters (β, ψ, γ).

6.1

General case

Laid out briefly in Subsection 2.4, the fixed point problem can be rephrased more explicitly
as follows. Define the function f (pc,
¯ θ) as
f (pc;
¯ θ) = D0 (pc,
¯ θ) + Dg (pc,
¯ θ)0 ḡ + Dh (pc,
¯ θ)0 h̄.

(31)

For a given value of θ, a solution to the fixed point problem is obtained when f (pc;
¯ θ) = pc.
¯
Such a solution does not always exist. Instead, the parameters must lie in a restricted space
that ensures a solution.
Before we discuss the solution for the fixed point problem to exist, the parameters need
to satisfy some conditions that are specific to models with stochastic volatility.10
Assumption 1 The parameters θ ∈ Θr must satisfy that for any real pc,
¯
1. the loadings Dh (pc,
¯ θ) are real,
2. the expectation in (16) exists for Dh (pc,
¯ θ).
The first part of the assumption is used to guarantee that f (pc,
¯ θ) is real. It amounts to
a real solution for a system of H quadratic equations in H unknowns, i.e. their respective
9

Hansen and Scheinkman(2012) also discuss conditions that guarantee a solution to the representative
agent’s problem under recursive preferences.
10
Models with rare consumption disasters with time-varying jump intensities following a Cox, Ingersoll,
and Ross(1985) process will require similar conditions.

34

discriminant must be positive.11 Second, the guess and verify technique used to solve the
coefficients in (17) requires the expectation in (16) to exist. This expectation does not always
exist when stochastic volatility follows a multivariate Cox, Ingersoll, and Ross(1985) process.
The second part of Assumption 1 guarantees the existence of the integral. These conditions
are discussed in more detail in Appendix E.
Given these conditions, the following proposition provides a general condition that guarantees a solution to the representative agent’s problem.
Proposition 1 Given Assumption 1, there is a value β̄(ψ, γ, θP , θλ ) such that if β < β̄, then
there exists a real solution for the fixed point problem.
Proof: See Appendix E.1.
We use the proposition to characterize the joint restrictions that exist among all the parameters. Given the dynamics of the economy in θP and the parameters determining habit in θλ ,
agents’ risk appetite γ, and the intertemporal elasticity of substitution ψ, the representative
agent needs to be sufficiently impatient (small β) in order for a solution to exist. The nature
of the fixed point problem requires that all three conditions be jointly satisfied.

6.2

Special cases

In this section, we provide more intuition by discussing a special case where the dynamics
are Gaussian by imposing ht = 0 in (7) - (8). In this case, we are no longer constrained by
Assumption 1. We can provide stronger conditions that apply to any β ≤ 1, i.e., it reduces
to relationships between γ and ψ. The following corollary also characterizes the upper bound
β̄ as a monotonic function in γ.
Corollary 1

1. If Z1∞0 µ∗g ≤ 0 and β ≤ 1, then

1−γ
1−ψ

> 0 guarantees the existence of a

solution.
11

This condition is similar to an existence condition discussed by Campbell, Giglio, Polk, and Turley(2014)
in their ICAPM model. They do not provide a condition guaranteeing a solution to the fixed point problem.

35

2. If β ≤ 1, then there is a value γ̄(θP , θλ ) such that
3. For any ψ, β̄ is monotonic in γ: for ψ > 1, then

γ̄−γ
1−ψ
dβ̄
dγ

> 0 guarantees a solution.

> 0; for ψ < 1, then

dβ̄
dγ

< 0.

Under the condition specified in part 1 of Corollary 1, a solution exists if (γ > 1, ψ > 1) or
(γ < 1, ψ < 1). This divides the parameter space for (γ, ψ) into four quadrants, and only
two of these four have a solution. Part 2 of Corollary 1 says that (γ > γ̄, ψ > 1) or (γ < γ̄,
ψ < 1) guarantees a solution, regardless of how patient the agent is. Again, two out of the
four quadrants have a solution, similar to part 1. The intuition is also similar. Although the
cutoff for ψ is always 1, the difference is the boundary on γ now depends on the parameters
θP and θλ .
The separation of the parameter space into quadrants makes estimation more challenging.
For example, if the optimum is within the upper-right region and we start from the lower left
region, a numerical optimization algorithm or a Bayesian MCMC algorithm, can have a hard
time getting through the tiny bottleneck and reaching the correct part of the parameter space.
In practice, we observe these algorithms hitting the regions where no solution exists and
often stopping. Estimation gets more complicated when the structural parameters interact
with the remaining parameters of the model as the boundaries can shift creating strong
dependencies among the model’s parameters.
Corollary 1 part 3 states the relationship between the upper bound for β and γ. If ψ < 1,
then an agent cannot have a high risk aversion and be patient at the same time. The more
risk averse he is, the less patient he needs to be, vice versa. If ψ > 1, the opposite is true.

6.3

Numerical illustrations

Figure 6 provides numerical illustrations of Proposition 1 and Corollary 1. The top row
takes a special case without stochastic volatility or habit. The upper left panel provides
a demonstration for part 2 of Corollary 1. β = 0.9998 is taken from the global estimates
of Table 2. A similar pattern holds for other values of β ≤ 1 as well. Blue dots indicate

36

the existence of a solution, and red stars imply no solution. The green dashed lines mark
the boundaries ψ = 1 and γ = γ̄ = 146.5. Consistent with part 2 of Corollary 1, when γ
and ψ are both bigger than their corresponding boundaries (upper right quadrant) or both
smaller than the boundaries (lower left quadrant), a solution exists. The top right panel
illustrates part 3 of Corollary 1. We take ψ = 0.7 from the local of Table 2. As prescribed
by the Corollary, when ψ < 1, we see a downward sloping line that separates the parameter
space for (β, γ) into feasible (blue) and infeasible (red) regions. The larger the value of risk
aversion γ gets, the smaller the discount rate β needs to be to remain in a region with a
valid solution.
While the top panels brings a visualization for Corollary 1, the bottom panels demonstrate
how restrictive the space looks in the benchmark setting. In the bottom left, we take the
estimates from Table 1 and the global solution of Table 2. The upper-left and lower-right
regions remain infeasible as before with similar intuition as Gaussian models. The difference
is now the upper-right region becomes infeasible in addition to the earlier regions in order
to satisfy Assumption 1. This emphasizes that in stochastic volatility models both the
intertemporal elasticity of substitution and risk aversion need to be modest. We find although
the lower left region is still feasible, the region is much smaller. For ψ = 0.97, γ cannot exceed
4.8. For ψ = 0.52, γ cannot exceed 6.9. The upper bound for γ in the Gaussian case marked
by the green line is 146.5.
The implications are two-fold. First, much of the economics literature evaluates a model’s
success according to whether or not it can produce a small value for the risk aversion parameter γ. We need to interpret this result with caution. As we show, for stochastic volatility
models, a small value of γ is required to satisfy the constraints of the model. Second, stochastic volatility models have much smaller feasible regions of the parameter space, and they are
more likely to encounter numerical problems and boundaries.
The bottom right panel takes the estimates from Table 1 and the local solution of Table 2.
It is similar to the upper right plot. Again the downward sloping line that divides the blue

37

Figure 6: Feasible and infeasible regions of the parameter space.
Gaussian: β = 0.9998

Gaussian: ψ = 0.7

1
0.9998

3
0.9996
2.5

0.9994
0.9992

β

ψ

2

1.5

0.999
0.9988
0.9986

1

0.9984
0.5
0.9982

feasible
infeasible

0.998
50

100

150

50

200

100

γ

150

200

γ

SV: β = 0.9998

SV: ψ = 0.7

1
0.99

3
0.98
2.5

0.97
0.96

β

ψ

2

1.5

0.95
0.94
0.93

1

0.92
0.5
0.91
0.9
50

100

150

200

50

γ

100

150

200

γ

Feasible (blue dots) and infeasible (red stars) regions of the parameters space. Green dashed lines are the
theoretical bounds derived in Corollary 1 part 2. The top row is a simplified model without stochastic volatility:
θP is taken from the estimates of this model, and λg = 0. The bottom row shows our benchmark model with
stochastic volatility. Parameters θP are taken from Table 1. θλ is taken from the global solution of Table 2
for the bottom left, and local solution for the bottom right. Left: parameter space for (γ, ψ) with β = 0.9998.
Right: Parameter space for (γ, β) with ψ = 0.7.

and red regions indicates that with the intertemporal elasticity of substitution less than 1,
an agent needs to be less patient as their risk aversion increases. The difference is that the
feasible region again is much smaller. For example, for γ = 244, β can be as big as 0.9996
in the Gaussian model, but it will not be able to exceed 0.93 in the SV setting.

38

7

Conclusion

Two strands of related literature attribute the time variation in bond term premia to two
different sources: Gaussian ATSMs credit time-varying prices of risk, whereas structural
models with recursive preferences and long run risk attribute it to time-varying quantities of
risk. We developed a consumption based model to capture both of these competing sources.
We introduced time-varying prices of risk through an external habit that depends on current
and past components of consumption growth and inflation. This generates a time-varying
risk premia even when the shocks are homoskedastic. Our novel formulation of habit yields
analytical bond prices, gaining tractability for this class of model. We introduce time varying
quantity of risk through stochastic volatility, which follows a non-negative NCG process. We
found that the time-varying price of expected inflation risk driven by expected inflation itself
is the primary channel empirically. On the contrary, once habit is a component in the model,
the presence of stochastic volatility does not alter the economic implication of the dynamics
of term premia. Moreover, a stochastic volatility model without habit cannot match the
upward sloping unconditional yield curve, the fundamental moment in the term structure.
Adding habit solves this problem as well.
Empirical implementation of recursive preferences requires careful attention when solving
for the stochastic discount factor. A solution does not exist for certain combinations of
structural parameters. Our paper provided conditions that guaranteed the existence of a
solution. We use these conditions to provide guidelines for empirical implementation.
Several authors have studied term structure models with recursive preferences in DSGE
models, e.g. Rudebusch and Swanson(2008), Rudebusch and Swanson(2012), van Binsbergen, Fernández-Villaverde, Koijen, and Rubio-Ramı́rez(2012), and Dew-Becker(2014). How
to introduce our technology of capturing realistic dynamics of term premia and other key
aspects of bonds and other assets into a DSGE framework remains an open question, and
logical next step for the literature.

39

References
Abel, Andrew B. (1999) “Risk premia and term premia in general equilibrium.” Journal
of Monetary Economics 43, 3–33.
Albuquerque, R., Martin Eichenbaum, and Sergio Rebelo (2014) “Valuation risk and
asset pricing.” Unpublished manuscript, Northwestern University, Department of
Economics.
Andrieu, Christophe, Arnaud Doucet, and Roman Holenstein (2010) “Particle Markov
chain Monte Carlo methods (with discussion)” Journal of the Royal Statistical Society, Series B 72, 1–33.
Ang, Andrew, and Monika Piazzesi (2003) “A no-arbitrage vector autoregression of term
structure dynamics with macroeconomic and latent variables” Journal of Monetary
Economics 50, 745–787.
Bansal, Ravi, A. Ronald Gallant, and George Tauchen (2007) “Rational pessimism,
rational exuberance, and asset pricing models” The Review of Economic Studies 74,
1005–1033.
Bansal, Ravi, Dana Kiku, and Amir Yaron (2012) “An empirical evaluation of the
long-run risks model for asset prices.” Critical Finance Review 1, 1481–1509.
Bansal, Ravi, and Ivan Shaliastovich (2013) “A long-run risks explanation of predictability puzzles in bond and currency markets” The Review of Financial Studies 26, 1–33.
Bansal, Ravi, and Amir Yaron (2004) “Risks for the long run: a potential explanation
of asset pricing puzzles” The Journal of Finance 59, 1481–1509.
Barro, Robert J. (2006) “Rare disasters and asset markets in the twentieth century.”
Quarterly Journal of Economics 121, 823–866.
Bauer, Michael D., Glenn D. Rudebusch, and Jing Cynthia Wu (2012) “Correcting estimation bias in dynamic term structure models.” Journal of Business and Economic
40

Statistics 30, 454–467.
Bernanke, Ben S. (2006) “Reflections on the Yield Curve and Monetary Policy, March
20, 2006.” Board of Governers of the Federal Reserve.
Bollerslev, Timothy, George Tauchen, and Hao Zhou (2009) “Expected stock returns
and variance risk premia” The Review of Financial Studies 22, 4463–4492.
Caldara, Dario, Jesus Fernández-Villaverde, Juan Rubio-Ramı́rez, and Wen Yao (2012)
“Computing DSGE models with recursive preferences and stochastic volatility.” Review of Economic Dynamics 15, 188–206.
Campbell, John Y. (2011) “Asset Pricing I Class Notes, Consumption Based Asset
Pricing.” Harvard University, Department of Economics.
Campbell, John Y., and John H. Cochrane (1999) “By force of habit: a consumptionbased explanation of aggregate stock market behavior” Journal of Political Economy
107, 205–251.
Campbell, John Y, Stefano Giglio, Christopher Polk, and Bob Turley (2014) “An intertemporal CAPM with stochastic volatility.” Working Paper, Booth School of
Business, University of Chicago.
Campbell, John Y, and Robert J. Shiller (1989) “The dividend-price ratio and expectations of future dividends and discount factors.” The Review of Financial Studies
1, 195–228.
Chen, Rong, and Jun S. Liu (2000) “Mixture Kalman filters.” Journal of the Royal
Statistical Society, Series B 62, 493–508.
Collin-Dufresne, Pierre, Robert S. Goldstein, and Charles Jones (2008) “Identification
of maximal affine term structure models.” The Journal of Finance 63, 743–795.
Cox, John C., Jonathan E. Ingersoll, and Stephen A. Ross (1985) “A theory of the term
structure of interest rates” Econometrica 53, 385–407.

41

Creal, Drew D. (2012) “A survey of sequential Monte Carlo methods for economics and
finance.” Econometric Reviews 31, 245–296.
Creal, Drew D., and Ruey S. Tsay (2015) “High-dimensional dynamic stochastic copula
models.” Journal of Econometrics 189, 335–345.
Creal, Drew D., and Jing Cynthia Wu (2015a) “Bond risk premia in consumption based
models.” Working paper, University of Chicago, Booth School of Business.
Creal, Drew D., and Jing Cynthia Wu (2015b) “Estimation of affine term structure
models with spanned or unspanned stochastic volatility.” Journal of Econometrics
185, 60–81.
Dew-Becker, Ian (2014) “Bond pricing with a time-varying price of risk in an estimated
medium-scale Bayesian DSGE model.” Journal of Money, Credit, and Banking 46,
837888.
Duffee, Gregory R. (2002) “Term premia and interest rate forecasts in affine models”
The Journal of Finance 57, 405–443.
Durbin, James, and Siem Jan Koopman (2002) “A simple and efficient simulation
smoother for state space time series analysis.” Biometrika 89, 603–616.
Durbin, James, and Siem Jan Koopman (2012) Time Series Analysis by State Space
Methods Oxford University Press, Oxford, UK 2 edition.
Epstein, Lawrence, and Stanley Zin (1989) “Substitution, risk aversion and the temporal
behavior of consumption and asset returns: A theoretical framework” Econometrica
57, 937–969.
Fama, Eugene F., and Robert R. Bliss (1987) “The information in long maturity forward
rates.” American Economic Review 77, 680–692.
Gabaix, Xavier (2012) “An exactly solved framework for ten puzzles in macro-finance.”
Quarterly Journal of Economics 127, 645–700.

42

Godsill, Simon J., Arnaud Doucet, and Michael West (2004) “Monte Carlo smoothing
for nonlinear time series.” Journal of the American Statistical Association 99, 156–
168.
Gouriéroux, Christian, and Joann Jasiak (2006) “Autoregressive gamma processes.”
Journal of Forecasting 25, 129–152.
Greenspan, Alan (2005) “To the International Monetary Conference, Beijing, People’s
Republic of China (via satellite) June 6, 2005” Board of Governers of the Federal
Reserve.
Hamilton, James D., and Jing Cynthia Wu (2012) “Identification and estimation of
Gaussian affine term structure models.” Journal of Econometrics 168, 315–331.
Hansen, Lars Peter, John C. Heaton, and Nan Li (2008) “Consumption strikes back?
Measuring long-run risk” Journal of Political Economy 116, 260–302.
Hansen, Lars Peter, and José A. Scheinkman (2012) “Recursive utility in a Markov environment with stochastic growth.” Proceedings of the National Academy of Sciences
109, 11967–72.
Kreps, David M., and Evan L. Porteus (1978) “Temporal resolution of uncertainty and
dynamic choice theory.” Econometrica 46, 185–200.
Lindsten, Fredrik, Michael I. Jordan, and Thomas B. Schön (2145–2184) “Particle Gibbs
with ancestor sampling.” Journal of Machine Learning Research 15.
Liu, Jun S., and Rong Chen (1998) “Sequential Monte Carlo computation for dynamic
systems.” Journal of the American Statistical Association 93, 1032–1044.
Newey, Whitney K, and Kenneth D West (1987) “A simple positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix” Econometrica 55,
703–708.
Piazzesi, Monika, and Martin Schneider (2007) “Equilibrium yield curves.” in NBER

43

Macroeconomics Annual 2006, edited by Daron Acemoglu, Kenneth Rogoff, and
Michael Woodford MIT Press, Cambridge, MA pages 389–442.
Rudebusch, Glenn D., and Eric T. Swanson (2008) “Examining the bond premium
puzzle with a DSGE model.” Journal of Monetary Economics 55, 111–126.
Rudebusch, Glenn D., and Eric T. Swanson (2012) “The bond premium in a DSGE
model with long-run real and nominal risks.” American Economic Journal: Macroeconomics 4, 105–143.
Rudebusch, Glenn D., and Tao Wu (2008) “A Macro-Finance Model of the Term Structure, Monetary Policy and the Economy” The Economic Journal 118, 906–926.
Schorfheide, Frank, Dongho Song, and Amir Yaron (2014) “Identifying long-run risks:
a Bayesian mixed-frequency approach” Working paper, University of Pennsylvania,
Department of Economics.
Stock, James H., and Mark W. Watson (2007) “Why has U.S. inflation become harder
to forecast?” Journal of Money, Credit, and Banking 39, 3–34.
Tallarini, Thomas D. (2000) “Risk-sensitive real business cycles” Journal of Monetary
Economics 45, 507–532.
van Binsbergen, Jules H., Jesús Fernández-Villaverde, Ralph S.J. Koijen, and Juan
Rubio-Ramı́rez (2012) “The term structure of interest rates in a DSGE model with
recursive preferences.” Journal of Monetary Economics 59, 634–648.
Wachter, Jessica A. (2006) “A consumption-based model of the term structure of interest
rates.” Journal of Financial Economics 79, 365–399.
Wachter, Jessica A. (2013) “Can time-varying risk of rare disasters explain aggregate
stock market volatility?” The Journal of Finance 68, 987–1035.
Weil, Phillipe (1989) “The equity premium puzzle and the risk-free rate puzzle.” Journal
of Monetary Economics 24, 401–421.

44

Whiteley, Nick (2010) “Discussion on Particle Markov chain Monte Carlo Methods.”
Journal of the Royal Statistical Society, Series B 72, 306–307.
Wright, Jonathan H. (2011) “Term premia and inflation uncertainty: empirical evidence
from an international panel dataset.” American Economic Review 101(4), 1514–
1534.
Yellen, Janet (2014) “Transcript of Chair Yellens FOMC Press Conference, December
17, 2014.” Board of Governers of the Federal Reserve.

45

Appendix A

Stochastic discount factor

This appendix provides the derivation for the stochastic discount factor for the agent’s problem in (1) - (2).
Guess that the solution is Vt = φt Wt for some coefficients φt , then the agent’s problem becomes
1

1−η  1−η
n h
io 1−γ
1−γ
η−1 1−η
.
φt Wt = max (1 − β) Ht Ct
+ β Et (φt+1 Wt+1 )

Ct

Substitute in Wt+1 from the constraint (2)
"
#

1−η

1−η n h
1−η
io 1−γ
Ct
Ct
1−γ
1−η
η−1
φt = max (1 − β) Ht
+β 1−
Et (φt+1 Rc,t+1 )
.
Ct
Wt
Wt

(A.1)

Take the first-order condition w.r.t. Ct , we get
(1 − β) Htη−1



Ct
Wt

−η


−η n h
1−η
io 1−γ
Ct
1−γ
=β 1−
Et (φt+1 Rc,t+1 )
.
Wt

(A.2)

Use the first order condition to substitute out the expectation term in (A.1) to solve φt ,
φt = (1 − β)

1
1−η

Ht−1



Ct
Wt

η
− 1−η

.

Substitute back to the FOC in (A.2), and and use the budget constraint to get the pricing equation


!
−ηϑ
η−1 ϑ 
Ht+1
Ct+1
ϑ
.
1 = β ϑ Et 
Rc,t+1
Ct
Htη−1
Therefore, the pricing kernel is
Mt+1 = β

ϑ

η−1
Ht+1

!ϑ 

Htη−1

Ct+1
Ct

−ηϑ

ϑ−1
Rc,t+1
,

and the log SDF is shown in (3).

Appendix B
Appendix B.1

Dynamics of the state vector
General Model

The dynamics of the Gaussian state vector gt driving ∆ct and πt are
gt+1
Σg,t Σ0g,t

=
=

µg + Φg gt + Φgh ht + Σgh εh,t+1 + Σg,t εg,t+1 ,
Σ0,g Σ00,g +

H
X

εg,t+1 ∼ N (0, I) ,

Σi,g Σ0i,g hit ,

i=1

εh,t+1

= ht+1 − Et [ht+1 |ht ] ,

where the volatility dynamics are a non-central gamma process. They can be written as a Gamma distribution
and a Poisson distribution
ht+1
wi,t+1
zi,t+1

=

Σh wt+1 ,

∼ Gamma (νh,i + zi,t+1 , 1) ,

∼ Poisson e0i Σ−1
h Φh Σh wt ,

46

i = 1, . . . , H
i = 1, . . . , H.

(B.3)
(B.4)

This is a discrete-time, multivariate Cox, Ingersoll, and Ross(1985) process. To guarantee positivity and
existence of ht , the process requires Σh > 0, Σ−1
h Φh Σh > 0 and the Feller condition νh,i > 1 for i = 1, . . . , H.
The conditional mean and variance of the process are
Et [ht+1 |ht ]
Vt [ht+1 |ht ]

=

Σh νh + Φh ht ,

=

Σh,t Σ0h,t

(B.5)

=

 0
Σh diag (νh ) Σ0h + Σh diag 2Σ−1
h Φh ht Σh ,

(B.6)

where Σh is a H ×H matrix of scale parameters, Φh is a H ×H matrix of autoregressive parameters and the in−1
tercept is equal to Σh νh . The unconditional mean and variance of ht are µ̄h = (IH − Φh ) Σh νh and Σ̄h Σ̄0h =
−1
−1,0
−1
(IH − Φh ) Σh diag (νh ) Σ0h (IH − Φh )
. The unconditional mean of gt is µ̄g = (IG − Φg ) (µg + Φgh µ̄h ).
The transition density of ht is
p (ht+1 |ht , νh , Φh , Σh )

= |Σ−1
h |

H
Y

e0i Σ−1
h ht+1

 νh,i2 −1

e0i Σ−1
h Φh ht

− νh,i2 −1

i=1

exp −

H
X

!
e0i Σ−1
h ht+1

+

e0i Σ−1
h Φh ht

i=1


 q
 0 −1

−1
0
Iνh,i −1 2 ei Σh ht+1 ei Σh Φh ht

(B.7)

where Iν (x) is the modified Bessel function. The Laplace transform needed to solve the model with recursive
preferences and for pricing assets is
!
H
H
0 0
X
X
e
Σ
u
i h
0 −1
νh,i log (1 − e0i Σ0h u) ,
Et [exp (u0 ht+1 )] = exp
0 Σ 0 u e i Σh Φh h t −
1
−
e
i
h
i=1
i=1
which exists only if e0i Σ0h u < 1 for i = 1, . . . , H. Further properties of the univariate process are developed
by Gouriéroux and Jasiak(2006).

Appendix B.2

Long run risk

Non-Gaussian model The model with long-run risk to consumption growth and trend inflation maps
into the general form as follows





πt
0
1
 ∆ct 
 1 
 0




gt = 
 π̄t  Zc =  0  Zπ =  0
c̄t
0
0


Φgh

0
 0
= 
 0
0

0
0
0
0


Σ2,g

0
0
0
0

0
 0
= 
 0
0



0
0
 0
0 
Σ = 
 0
0  gh
0
0
0
√ 1
12000

0
0

0
0
0
0





0

 0
 Φg = 

 0
0
0
0
0
0

0
0
0
0

1
0
φπ
φc,π



0
0
 0
0 
Σ
= 
 0
0  0,g
0
0



0 0
0 0
 0 0
0 0 
 Σ3,g = 
 0 0
0 0 
0 0
0 0

47

0
0
√ 1
12000
σ
√ c,π
12000

0
0
0
0



0
1
φπ,c
φc
0
0
0
0





0
µ̄π

 0 
 µ̄c
 µg = 



 µπ  µ̄g =  µ̄π
µc
µ̄c



0

0 
Σ
= 

0  1,g
0



0
0
 0
0 


0  Σ4,g =  0
0
0

0
0
0
0

0
0
0
0

√ 1
12000

0
0
0
0
0
0
√ 1
12000







0 0 0
0 0 0 

0 0 0 
0 0 0





√
We have scaled these matrices by 1/ 12000 so that the volatility factors ht are roughly the same magnitude
as the Gaussian factors gt . For the volatility processes, the matrices are







σh,π1
0
0
0
φπ 1
0
0
0
νh,π1
µ̄h,π1
 0
 0

 νh,c1 
 µ̄h,c1 
σ
0
0
φ
0
0
h,c
c
1
1

 Σ = 



µ̄h = 
 0
 µ̄h,π2  νh =  νh,π2  Φh =  0
0
σh,π2
0
0 φπ 2
0  h
0
0
0
σh,c2
0
0
0
φc 2
νh,c2
µ̄h,c2
During estimation, we parameterize the model in terms of the unconditional mean of volatilities µ̄h .

Gaussian model For the Gaussian model, we keep everything
matrix which is equal to

σπ1
0
0
0
 0 σc 1
0
0
Σ0,g = 
 0
0
σπ 2
0
0
0 σc,π σc2

the same as above except for the scale


,


while Σi,g = 0 for i > 0, and µ̄h , νh = 0, Φh = 0, Σh = 0.

Appendix C
Appendix C.1

Recursive preferences model solution
Solution for rc,t+1

In order to simplify the expressions, we introduce the following notation
(1 − η) Zc + κ1 Dg

Z1

=

Z2

= −γZc + (ϑ − 1) κ1 Dg

Z3

=

Σ0gh ((1 − η) Zc + κ1 Dg ) + κ1 Dh

=

Σ0gh Z1 + κ1 Dh

=

Σ0gh (−γZc + (ϑ − 1) κ1 Dg ) + (ϑ − 1) κ1 Dh

=

Σ0gh Z2 + (ϑ − 1) κ1 Dh

Z4

where the vectors Zc , Zπ are selection vectors and the vectors Dg and Dh are part of the price to consumption
ratio pct = D0 + Dg0 gt + Dh0 ht .

Step 1: Campbell-Shiller approximation
Let pct = ln



Pt
Ct




rc,t+1

be the log price to consumption ratio. The return on the consumption asset is

Pt+1 + Ct+1
Pt





Pt+1 + Ct+1
Ct+1



= ln (Ct+1 ) + ln
− ln (Pt )


Pt+1
= ln (Ct+1 ) − ln (Ct ) + ln 1 +
− ln (Pt ) + ln (Ct ) = ∆ct+1 − pct + ln (1 + exp (pct+1 )) .
Ct+1
≡

ln

Take a first order Taylor expansion of the function f (x) = ln (1 + exp (x)) around x̄.
rc,t+1

≈ ∆ct+1 − pct + ln (1 + exp (pc))
¯ +
= κ0 + κ1 pct+1 − pct + ∆ct+1

where κ0 = ln (1 + exp (pc))
¯ − κ1 pc
¯ and κ1 =

exp(pc)
¯
1+exp(pc)
¯ .

48

exp (pc)
¯
(pct+1 − pc)
¯
1 + exp (pc)
¯
(C.8)






Step 2: Solve for the price/consumption ratio
The real pricing kernel in (3) prices the consumption asset.
1

=

Et [exp (mt+1 + rc,t+1 )] = Et [exp (ϑ ln (β) + ϑ∆υt+1 − ηϑ∆ct+1 + ϑrc,t+1 )]

=

exp (ϑ ln (β) + ϑκ0 − ϑpct ) Et [exp (ϑ∆υt+1 + ϑ (1 − η) ∆ct+1 + ϑκ1 pct+1 )]

(C.9)

where we have used (C.8). Conjecture a solution for the price to consumption ratio
pct

=

D0 + Dg0 gt + Dh0 ht

(C.10)

for unknown coefficients D0 , Dg and Dh . Substitute the guess, (5) and (13) into (C.9)
1

=

exp (ϑ ln (β) + ϑκ0 + ϑκ1 D0 − ϑpct + ϑΛ1 (gt ))

(C.11)

exp (ϑZ10

(C.12)

(µg + Φg gt + Φgh ht − Σgh (Σh νh + Φh ht )))
i
0
Et exp ϑΛ2 (gt ) + ϑΣ0g,t Z1 εg,t+1 Et [exp (ϑZ30 ht+1 )]
h



(C.13)

Calculate the expectations using the Laplace transform
0

= ϑ ln (β) + ϑκ0 + ϑκ1 D0 − ϑpct + ϑΛ1 (gt )
+ϑZ10 (µg + Φg gt + Φgh ht − Σgh (Σh νh + Φh ht )) +
−

H
X

νh,i ln (1 − e0i Σ0h ϑZ3 ) +

i=1

H
X
i=1

0

ϑ2
Λ2 (gt ) + Σ0g,t Z1 Λ2 (gt ) + Σ0g,t Z1
2

e0i Σ0h ϑZ3 0 −1
e Σ Φh ht
1 − e0i Σ0h ϑZ3 i h

The solution exists if e0i Σ0h ϑZ3 < 1 for i = 1, . . . , H. Solve for pct by plugging in the risk sensitivity functions
and cancel terms
pct

=

ln (β) + κ0 + κ1 D0
+Z10 (µg + Φg gt + Φgh ht − Σgh (Σh νh + Φh ht ))
−ηϑZ10 (λ0 + λg gt )
H
H
X
1X
e0i Σ0h Z3
ϑ
0 −1
νh,i log (1 − e0i Σ0h ϑZ3 ) +
+ Z10 Σg,t Σ0g,t Z1 −
0 Σ0 Z ei Σh Φh ht
2
ϑ i=1
1
−
ϑe
3
i
h
i=1

We now solve for the coefficients. Both D0 and Dg are analytical
D0

=

Dg

=

1
[ln (β) + κ0 + Z10 (µg − Σgh Σh νh − ηϑλ0 )
(1 − κ1 )
#
H
1X
ϑ 0
0 0
0
νh,i ln (1 − ei Σh ϑZ3 ) + Z1 Σ0,g Σ0,g Z1
−
ϑ i=1
2

−1
0
0
IG − κ1 (Φg − ηϑλg )
(Φg − ηϑλg ) (1 − η) Zc

A solution for Dg only exists when (IG − κ1 (Φg − ηϑλg )) is invertible. The vector Dh is the solution to the
system of equations
Dh

=

0

(Φgh − Σgh Φh ) Z1 +

H
X
e0i Σ0h Z3
ϑ
0
0 −1,0
(ιH ⊗ Z1 ) Σ̃g Σ̃0g (IH ⊗ Z1 ) +
ei
0 Σ0 Z Φ h Σh
2
1
−
ϑe
3
i h
i=1

(C.14)

where Σ̃g Σ̃0g is a GH × GH block diagonal matrix with Σi,g Σ0i,g along the diagonal. This cannot be solved
in closed-form in the general case. However, if Σh and Φh are lower triangular, then it can be calculated in
closed-form recursively for i = 1, . . . , H. We discuss the analytical solution of this equation in more detail

49

in Appendix C.2.

Step 3: Solve for the fixed-point
During estimation, we determine the value of pc
¯ and the log-linearization constants κ0 and κ1 as a function
of the model parameters by solving the fixed-point problem (averaging of (C.10))
0

=

0

0

pc
¯ − D0 (pc)
¯ − Dg (pc)
¯ µ̄g − Dh (pc)
¯ µ̄h

where the coefficients D0 , Dg and Dh are functions of pc
¯ through κ0 and κ1 . The parameters µ̄g and µ̄h are
the unconditional means of gt and ht .

Step 4: Substitute the solution into the SDF
If the fixed point problem has a solution, then the return on the consumption asset is
rc,t+1

≈ κ0 + κ1 (D0 + Dg0 gt+1 + Dh0 ht+1 ) − (D0 + Dg0 gt + Dh0 ht ) + ∆ct+1

by substituting (C.10) into (C.8). We can now write the log-SDF as a function of the r.v.’s εg,t+1 and ht+1
by substituting this, (5) and (13) into (3)
mt+1

= ϑ ln (β) + (ϑ − 1) (κ0 − (1 − κ1 ) D0 )
− (ϑ − 1) Dg0 gt − (ϑ − 1) Dh0 ht + ϑΛ1 (gt )
0
+Z20 (µg + Φg gt + Φgh ht − Σgh (Σh νh + Φh ht )) + ϑΛ2 (gt ) + Σ0g,t Z2 εg,t+1 + Z40 ht+1

Appendix C.2

Analytical solution of Dh

The H × 1 vector of loadings Dh are a system of H equations in H unknowns in (C.14). They can be solved
analytically when both Φh and Σh are lower triangular by recursively solving one equation after another.
We will consider the simpler case when they are both diagonal. Under this assumption, each equation is
independent of one another and they simplify to

Z̄3,i + κ1 Dh,i Φh,i

i = 1, . . . , H
(C.15)
Dh,i = D̄i +
1 − ϑΣh,i Z̄3,i + κ1 Dh,i
where Φh,i and Σh,i are the i-th diagonal elements and D̄i , Z̄3,i are the ith elements of the following quantities
0

D̄

=

(Φgh − Σgh Φh ) Z1 +

Z̄3

=

Σ0gh Z1

ϑ
0
(ιH ⊗ Z1 ) Σ̃g Σ̃0g (IH ⊗ Z1 )
2

Each loading (C.15) for i = 1, . . . , H is a quadratic equation
0

=



2
κ1 ϑΣh,i Dh,i
+ Dh,i κ1 Φh,i − κ1 ϑΣh,i D̄i − 1 + ϑΣh,i Z̄3,i + D̄i 1 − ϑΣh,i Z̄3,i + Z̄3,i Φh,i(C.16)

The solutions are
Dh,i

=


− κ1 Φh,i − κ1 ϑΣh,i D̄i − 1 + ϑΣh,i Z̄3,i
2κ1 ϑΣh,i
q
2



κ1 Φh,i − κ1 ϑΣh,i D̄i − 1 + ϑΣh,i Z̄3,i − 4κ1 ϑΣh,i D̄i 1 − ϑΣh,i Z̄3,i + Z̄3,i Φh,i
±
(C.17)
2κ1 ϑΣh,i

A real solution exists as long as the discriminant is greater than or equal to zero. If the discriminant is
greater than zero, there are two solutions. Only one solution leads to a sensible value. This is the value with

50

a negative sign, see also Campbell, Giglio, Polk, and Turley(2014) for the ICAPM model.

Appendix D

Bond prices

Define
= Z4 − Σ0gh Zπ

Z5
in addition to Z1 - Z4 defined in Appendix C.1.

Appendix D.1

Real bonds
(n)

We will guess and verify that the solution for zero coupon bonds is Pt



= exp ān + b̄0n,g gt + b̄0n,h ht for

some unknown coefficients ān and b̄n,g and b̄n,h .
(0)
(1)
For a maturity n = 1, the payoff is guaranteed to be Pt+1 = 1 in the next period, in which case Pt =
Et [Mt+1 ]. Using standard techniques for affine bond pricing in discrete-time (see Creal and Wu(2015b)), we
find that at maturity n = 1 the bond loadings are
ā1

=

ln (β) − ηZc0 (µg − Σgh Σh νh − ηϑλ0 )
−

H
X

H

νh,i log (1 − e0i Σ0h Z4 ) +

i=1

(ϑ − 1) X
νh,i log (1 − e0i Σ0h ϑZ3 )
ϑ
i=1

b̄1,g

=

(ϑ − 1) ϑ 0
1
−
Z1 Σ0,g Σ00,g Z1 + Z20 Σ0,g Σ00,g Z2
2
2
0
− (Φg − ηϑλg ) ηZc

b̄1,h

=

− (Φgh − Σgh Φh ) ηZc

0

+

H
X
i=1

e0i Σ0h Z4 0 −1
e Σ Φh
1 − e0i Σ0h Z4 i h

!0
− (ϑ − 1)

H
X
i=1

e0i Σ0h Z3
e0 Σ−1 Φh
1 − ϑe0i Σ0h Z3 i h

!0

(ϑ − 1) ϑ
1
0
0
(IH ⊗ Z1 ) Σ̃g Σ̃0g (ιH ⊗ Z1 )
+ (IH ⊗ Z2 ) Σ̃g Σ̃0g (ιH ⊗ Z2 ) −
2
2
(n)

0 0
where
h bond prices only
i exist if ei Σh Z4 < 1 for i = 1, . . . , H. At maturity n, we use the fact that Pt
(n−1)
Et exp (mt+1 ) Pt+1 . The bond loadings are

ān

= ān−1 + ā1 +

H
X
i=1


νh,i log 

1 − e0i Σ0h Z4





1 − e0i Σ0h Σ0gh b̄n−1,g + b̄n−1,h + Z4

b̄n,g

1
0
+ (µg − Σgh Σh νh − ηϑλ0 ) b̄n−1,g + b̄0n−1,g Σ0,g Σ00,g b̄n−1,g + b̄0n−1,g Σ0,g Σ00,g Z2
2
0
= (Φg − ηϑλg ) b̄n−1,g + b̄1,g

b̄n,h

=

0

(Φgh − Σgh Φh ) b̄n−1,g + b̄1,h





0
H
e0i Σ0h Σ0gh b̄n−1,g + b̄n−1,h + Z4
0 0
X
ei Σh Z4  0 −1 


−
+
e i Σh Φ h
1
−
e0i Σ0h Z4
0
0
0
1 − ei Σh Σgh b̄n−1,g + b̄n−1,h + Z4
i=1
+

(n)

Real yields are yt


0

1
0
IH ⊗ b̄n−1,g Σ̃g Σ̃0g ιH ⊗ b̄n−1,g + (IH ⊗ Z2 ) Σ̃g Σ̃0g ιH ⊗ b̄n−1,g
2

= an + b0n,g gt + b0n,h ht with an = − n1 ān , bn,g = − n1 b̄n,g and bn,h = − n1 b̄n,h .

51

=

Appendix D.2

Nominal bonds

Similar to the solution
for the real bond,we guess and then verify. The solution for zero coupon nominal bonds

$,(n)
$,0
$
$
$
$
is Pt
= exp ān + b̄$,0
n,g gt + b̄n,h ht for some unknown coefficients ān and b̄n,g and b̄n,h . For maturity
 $ 
$,(0)
$,(1)
n = 1, the payoff is guaranteed to be Pt+1 = 1 in the next period, in which case Pt
= Et Mt+1
. The
solutions are
ā$1

=

0

ln (β) − (ηZc + Zπ ) (µg − Σgh Σh νh − ηϑλ0 )
+

H
H
X
(ϑ − 1) X
νh,i log (1 − e0i Σ0h ϑZ3 ) −
νh,i log (1 − e0i Σ0h Z5 )
ϑ
i=1
i=1

b̄$1,g

1
1
(ϑ − 1) ϑ 0
Z1 Σ0,g Σ00,g Z1 + Z20 Σ0,g Σ00,g Z2 + Zπ0 Σ0,g Σ00,g Zπ − Z20 Σ0,g Σ00,g Zπ
2
2
2
0
= − (Φg − ηϑλg ) (ηZc + Zπ )

b̄$1,h

= − (Φgh − Σgh Φh ) (ηZc + Zπ )

−

0

− (ϑ − 1)

H
X
i=1

e0i Σ0h Z3
e0 Σ−1 Φh
1 − ϑe0i Σ0h Z3 i h

!0
+

H
X
i=1

e0i Σ0h Z5 0 −1
e Σ Φh
1 − e0i Σ0h Z5 i h

!0

1
0
0
+ (IH ⊗ Zπ ) Σ̃g Σ̃0g (ιH ⊗ Zπ ) − (IH ⊗ Z2 ) Σ̃g Σ̃0g (ιH ⊗ Zπ )
2
1
(ϑ − 1) ϑ
0
0
+ (IH ⊗ Z2 ) Σ̃g Σ̃0g (ιH ⊗ Z2 ) −
(IH ⊗ Z1 ) Σ̃g Σ̃0g (ιH ⊗ Z1 )
2
2
0
where bond prices
only exist if e0i Σ
h
i h Z5 < 1 for i = 1, . . . , H. At longer maturities n, we use the fact that

$,(n)
$,(n−1)
Pt
= Et exp m$t+1 Pt+1
. The bond loadings are

ā$n

0

= ā$n−1 + ā$1 + (µg − Σgh Σh νh − ηϑλ0 ) b̄$n−1,g


H
0 0
X
1 − e i Σh Z 5


+
νh,i log 
0
0
0
1 − ei Σh Σgh b̄$n−1,g + b̄$n−1,h + Z5
i=1

b̄$n,g

=

b̄$n,h

=

1
Σ0,g Σ00,g b̄$n−1,g + b̄$n−1,g Σ0,g Σ00,g (Z2 − Zπ )
+ b̄$,0
2 n−1,g
0
(Φg − ηϑλg ) b̄$n−1,g + b̄$1,g
0

(Φgh − Σgh Φh ) b̄$n−1,g + b̄$1,h




0

H
e0i Σ0h Σ0gh b̄$n−1,g + b̄$n−1,h + Z5
0 0
X
e
Σ
Z
i h 5  0 −1


−
e i Σh Φ h 
+
$
$
1
−
e0i Σ0h Z5
0
0
0
1 − ei Σh Σgh b̄n−1,g + b̄n−1,h + Z5
i=1
0

 
0
1
+
IH ⊗ b̄$n−1,g Σ̃g Σ̃0g ιH ⊗ b̄$n−1,g + IH ⊗ b̄$n−1,g Σ̃g Σ̃0g (ιH ⊗ (Z2 − Zπ ))
2
$,(n)

$,0
1 $
1 $
1 $ $
$
$
Nominal yields are yt
= a$n + b$,0
n,g gt + bn,h ht with an = − n ān , bn,g = − n b̄n,g and bn,h = − n b̄n,h . The
nominal short term interest rate is
$,(1)

rt$ = yt

$,0
= a$1 + b$,0
1,g gt + b1,h ht

52

(D.18)

Appendix E
Appendix E.1

Proof of Propositions
General case

Define the fixed point problem
κ1

=

κ0

=

exp (pc)
¯
1 + exp (pc)
¯
ln (1 + exp (pc))
¯ − κ1 pc
¯

Dg0

=

(1 − η) Zc0 (Φg − ϑηλg ) (I − κ1 (Φg − ϑηλg ))

Z1

=

(1 − η) Zc + κ1 Dg

Z3

=

Σ0gh ((1 − η) Zc + κ1 Dg ) + κ1 Dh

Dh

=

(Φgh − Σgh Φh ) Z1 +

(1 − κ1 ) D0

=

ln (β) + κ0 + Z10 (µg − Σgh Σh νh − ηϑλ0 )

0

−1

H
X
ϑ
e0i Σ0h Z3
0
0 −1,0
ei
(ιH ⊗ Z1 ) Σ̃g Σ̃0g (IH ⊗ Z1 ) +
0 Σ0 Z Φh Σh
2
1
−
ϑe
3
i
h
i=1

H

−
f (pc)
¯

ϑ
1X
νh,i ln (1 − e0i Σ0h ϑZ3 ) + Z10 Σ0,g Σ00,g Z1
ϑ i=1
2

= D0 + Dg0 µ̄g + Dh0 µ̄h

which is solved if pc
¯ = f (pc).
¯

Assumptions 1
The vector of coefficients Dh is a solution to the system of non-linear equations in (C.14). The system of
equations does not necessarily have a real solution for a given parameter vector θ.
In the special case when Σh and Φh are diagonal, each loading (C.15) reduces to a quadratic equation
given by (C.16) that can be solved separately for each element i. The solutions are in (C.17). The fixed
point problem only has a solution when Dh,i is real. The coefficient Dh,i is real if and only if the parameters
satisfy
κ1 Φh,i − κ1 ϑΣh,i D̄i − 1 + ϑΣh,i Z̄3,i

2




− 4κ1 ϑΣh,i D̄i 1 − ϑΣh,i Z̄3,i + Z̄3,i Φh,i ≥ 0

for i = 1, . . . , H.
In order to solve for the price to consumption ratio pct , the conditional expectation in (C.13) must exist.
This condition is


ϑe0i Σ0h Σ0gh ((1 − η) Zc + κ1 Dg ) + κ1 Dh < 1
i = 1, . . . , H
(E.19)
This defines another set of restrictions across the parameters θ of the model.

Proof of Proposition 1
First, derive the limiting property for pc
¯ → −∞: limpc→−∞
κ1 = 0 and limpc→−∞
κ0 = 0. In this case, both
¯
¯
D0 and Dh are finite due to ϑe0i Σ0h Z3 < 1 in Assumption 1. Therefore, pc
˜ is finite, so limpc→−∞
(pc
¯ − pc)
˜ →
¯
−∞.
Next, derive the limiting property for pc
¯ → ∞: limpc→∞
κ1 = 1 and limpc→∞
κ0 = 0. This im¯
¯
plies Dg is finite as long as the eigenvalue of (Φg − ϑηλg ) for consumption is smaller than 1. Dh is
finite due to ϑe0i Σ0h Z3 < 1. And limpc→∞
(1 − κ1 ) D0 = limpc→∞
ln (β) + Z10 (µg − Σgh Σh νh − ηϑλ0 ) −
¯
¯
PH
ϑ 0
1
0 0
0
0 0
i=1 νh,i ln (1 − ei Σh ϑZ3 ) + 2 Z1 Σ0,g Σ0,g Z1 . The right hand side is finite due to ϑei Σh Z3 < 1. Therefore,
ϑ
limpc→∞
κ1 = 1 leads to an infinite D0 . The condition limpc→∞
D0 → −∞ implies limpc→∞
(pc
¯ − pc)
˜ → ∞,
¯
¯
¯
which together limpc→−∞
(pc
¯ − pc)
˜ → −∞ guarantees there exists a solution for the fixed point problem.
¯

53

With κ1 < 1, the condition limpc→∞
D0 → −∞ is equivalent to
¯
"
β < lim exp −
pc→∞
¯

H

Z10

1X
ϑ
(µg − Σgh Σh νh − ηϑλ0 ) −
νh,i ln (1 − e0i Σ0h ϑZ3 ) + Z10 Σ0,g Σ00,g Z1
ϑ i=1
2

Therefore, the boundary condition is
"
β̄ = exp −

Z1∞0

H

1X
ϑ
νh,i ln (1 − e0i Σ0h ϑZ3∞ ) + Z1∞0 Σ0,g Σ00,g Z1∞
(µg − Σgh Σh νh − ηϑλ0 ) −
ϑ i=1
2

where
Z1∞ = (1 − η) Zc + Dg∞
−1
Dg∞0 = (1 − η) Zc0 (Φg − ϑηλg ) (I − (Φg − ϑηλg )) ,
∞
∞
∞
Z3 = Z̄3 + Dh
Z̄3∞ = Σ0gh Z1∞

 r 
2
Φh,i −1
1 Φh,i −1
∞
∞
∞
∞ + Z̄ ∞
−
D̄
Dh,i = − 2 ϑΣh,i − D̄i + Z̄3,i − 14 ϑΣ
−
i
3,i
h,i
0

D̄∞ = (Φgh − Σgh Φh ) Z1∞ +

Appendix E.2

ϑ
2

1
ϑΣh,i

!#
.

!#
,

 ∞


∞ + Z̄ ∞ Φ
D̄i 1 − ϑΣh,i Z̄3,i
3,i h,i

0

(ιH ⊗ Z1∞ ) Σ̃g Σ̃0g (IH ⊗ Z1∞ )

Special case with Gaussian dynamics

The fixed point problem simplifies to

Dg0

exp (pc)
¯
1 + exp (pc)
¯
= ln (1 + exp (pc))
¯ − κ1 pc
¯


$
$ −1
= (1 − η) Zc0 ΦQ
I − κ 1 ΦQ
g
g

Z1

=

κ1
κ0

D0 (1 − κ1 )
pc
˜

=

(1 − η) Zc + κ1 Dg

1
ln (β) + κ0 + Z10 µ∗g + ϑZ10 Σ0,g Σ00,g Z1
2
= D0 + Dg0 µ̄g
=

which is solved if pc
¯ = pc.
˜
First, the condition in Proposition 1 becomes


1
β < lim exp −Z10 µ∗g − ϑZ10 Σ0,g Σ00,g Z1 ,
pc→∞
¯
2

(E.20)

and β̄ simplifies to
 

ϑ ∞0
∞0 ∗
0
∞
,
β̄ = exp − Z1 µg + Z1 Σ0,g Σ0,g Z1
2
0

$

where Z1∞ ≡ limpc→∞
Z1 (pc)
¯ = (1 − η) Zc +Dg∞ and Dg∞0 ≡ limpc→∞
Dg (pc)
¯ = (1 − η) Zc0 ΦQ
¯
¯
g



I − ΦQ
g

$

−1

.

Proof of Corollary 1
1. The condition (E.20) is guaranteed by Z1∞0 µ∗g ≤ 0 and ϑ < 0 for any β ≤ 1. And
to ϑ < 0,
2. A stronger condition is

β ≤ 1 < lim exp
pc→∞
¯

−Z10 µ∗g

54


1 0
0
− ϑZ1 Σ0,g Σ0,g Z1 ,
2

1−γ
1−ψ

> 0 is equivalent

which can be simplified to

γ

> 1+

γ

< 1+

hence γ̄(θP , θλ ) = 1 +
3. We have

dϑ
dγ

1
= − 1−η
,


Zc0 I


Zc0 I



$ −1
µ∗g
2Zc0 I − ΦQ
g
,



$,0 −1
$ −1
Zc
− ΦQ
Σ0,g Σ00,g I − ΦQ
g
g


$ −1
2Zc0 I − ΦQ
µ∗g
g


−1 .
$ −1
Q$,0
0
I
−
Φ
− ΦQ
Σ
Σ
Zc
g
g
0,g 0,g


−1
$
2Zc0 I−ΦQ
µ∗
g
g

−1


,
$,0 −1
$
Q
0
0
Zc I−Φg
Σ0,g Σ0,g I−ΦQ
Zc
g
dDg∞0
dγ

= 0 and

dZ1∞0
dγ

d ln β̄
dγ
d ln β̄
dγ

=

1 dβ̄
β̄ dγ

=

dDg∞0
dγ

if

ψ>1

if

ψ<1

does not depend on ψ.

= 0. Hence, the derivative of ln β̄ w.r.t. γ is

1
Z ∞0 Σ0,g Σ00,g Z1∞
2(1 − η) 1

=

implies that the two derivatives have the same sign. Therefore, for ψ > 1, then

for ψ < 1, then

dβ̄
dγ

Appendix F
Appendix F.1

dβ̄
dγ

> 0;

< 0.

MCMC and particle filters
MCMC

Our MCMC algorithm is the particle Gibbs (PG) sampler. It iterates between two broad steps: (i) drawing
the latent state variables (g1:T , h0:T ) conditional on the model’s parameters; and (ii) drawing the model’s
parameters θP given the latent state variables. We make heavy use of the fact that the model is a conditionally
linear Gaussian state space model.

Appendix F.1.1

Conditionally linear, Gaussian state space form

Conditional on h0:T , the model is a linear, Gaussian state space model. We write the model using the state
space form of Durbin and Koopman(2012) given by
Yt
gt+1

= Zgt + d + ηt∗
=

T gt + ct +

Rε∗t+1

ηt∗ ∼ N (0, H) ,

(F.21)

ε∗t+1

(F.22)

∼ N (0, Qt ) ,

0

where Yt = (∆ct πt ) . The models in this paper can placed in this state space form as


Zc
Z =
T = Φg
d = 02×1
H = 02×2
Zπ
ct = µg + Φgh ht + Σgh εh,t+1

Qt = Σg,t Σ0g,t

For some models, there are free, estimable parameters in the matrices (µg , Φgh , Σgh ). We can place these in
the state vector. This allows any free parameters in (µg , Φgh , Σgh ) to be drawn jointly with the state variables
g1:T . It also allows us to marginalize over them when drawing other parameters, see ? for discussion.

55

Appendix F.1.2

Drawing the state variables

We draw (g1:T , h0:T ) from their full conditional distribution in two steps.

g1:T ∼ p g1:T |Y1:T , h0:T , θP

h0:T ∼ p h1:T |Y1:T , g1:T , θP
We draw g1:T conditional on h0:T from the conditionally linear, Gaussian state space model (F.21) and
(F.22) using a forward filtering backward sampling algorithm or simulation smoother; see, e.g. Durbin and
Koopman(2002). Conditional on the draw for g1:T , we draw h0:T using a particle Gibbs sampler.
There are two PG samplers developed in the literature. The original PG sampler of Andrieu, Doucet, and
Holenstein(2010) with the backward-sampling pass developed by Whiteley(2010), see Creal and Tsay(2015).
And, the PG sampler with ancestor sampling (PGAS) of Lindsten, Jordan, and Schön(2145–2184). The
former algorithm is simple to implement for Model #1. We describe its implementation here.
Let J be the total number of particles. In our work, we select J = 100. The PG sampler starts with a
(1)
set of existing particles h0:T that were drawn from the previous iteration.
For t = 1, . . . , T , run:

(j)
• For j = 2, . . . , J, draw from a proposal: (ht , ht−1 ) ∼ q ht , ht−1 |gt−1:t , θP .
• For j = 1, . . . , J, calculate the importance weight:

 

(j)
(j)
(j) (j)
p gt |gt−1 , ht , ht−1 , θP p ht |ht−1 , θP
(j)


wt
∝
(j)
(j)
q ht , ht−1 |gt−1:t , θP
(j)

(j)

• For j = 1, . . . , J, normalize the weights: ŵt

=

w
PJ t

j=1

• Conditionally resample the particles

n
oJ
(j)
ht

(j)

wt

.

with probabilities

j=1

particle

(1)
ht

n
oJ
(j)
ŵt
. In this step, the first
j=1

always gets resampled and may be randomly duplicated.

Implementation of the PG sampler is different than a standard particle filter due to the “conditional”
resampling algorithm used in the last step. We use the conditional multinomial resampling algorithm from
Andrieu, Doucet, and Holenstein(2010).
n
oJ
(j)
In the original PG sampler, the particles ht
are stored for t = 1, . . . , T and a single trajectory
j=1
n
oJ
(j)
is sampled using the probabilities from the last iteration ŵT
. An important improvement upon the
j=1

original PG sampler was introduced by Whiteley(2010), who suggested drawing the path of the state variables
from the discrete particle approximation using the backwards sampling algorithm of Godsill, Doucet, and
n
oM
(m)
(m)
West(2004). On the forwards pass, we store the normalized weights and particles ŵt , hi,t
for
t = 1, . . . , T . We draw a path of the state variables (h∗1 , . . . , h∗T ) from this discrete distribution.
(j)

m=1

(j)

At t = T , draw a particle h∗T = hT with probability ŵT .
For t = T − 1, . . . , 0, run:


(j)
(j)
(j)
• For j = 1, . . . , J, calculate the backwards weights: wt|T ∝ ŵt p h∗t+1 |ht , θ
(j)

(j)

• For j = 1, . . . , J, normalize the weights: ŵt|T =
(j)

• Draw a particle h∗t = ht

wt|T
PJ
(j)
j=1 wt|T

.

(j)

with probability ŵt|T .

The draw h0:T = (h∗0 , . . . , h∗T ) is a draw from the full-conditional distribution. In practice, when the dimension H of ht is high, the number of particles J required for satisfactory performance can be quite large. In
this case, we can separate each element of the state vector hi,t for i = 1, . . . , H and draw them one at a time.

56

Appendix F.1.3

Drawing the parameters

We block the parameters into groups that are highly correlated. These groups can be separated into parameters governing the dynamics of gt and the parameters that enter the dynamics of volatility ht .
1. Drawing parameters in µ̄g , Φgh , Σgh : We place these parameters in the state vector and draw them
jointly with the Gaussian state variables.
2. Drawing parameters in Φg , Σ0,g : We use the independence Metropolis Hastings algorithm. Conditional on the volatility state variables h0:T , the model is a linear, Gaussian state space model (F.21)
and (F.22). We maximize the likelihood using the Kalman filter and calculate the Hessian at the posterior mode. We then draw from a Student’s t proposal distribution with mean equal to the posterior
mode and covariance matrix equal to the inverse Hessian at the mode; see, e.g. ? for details.
3. Drawing parameters of the volatility process µ̄h , Φh , Σh : We use an independence MetropolisHastings step. When drawing these parameters, we can marginalize out the Gaussian state variables
using the Kalman filter. Conditional on the remaining parameters of the model (which we omit), the
target distribution of νh , Φh , Σh can be written as
p (µ̄h , Φh , Σh |Y1:T , h0:T ) ∝ p (Y1:T |h0:T , µ̄h , Φh , Σh ) p (h0:T |µ̄h , Φh , Σh ) p (µ̄h , Φh , Σh )
where p (Y1:T |h0:T , µ̄h , Φh , Σh ) is the likelihood from the Kalman filter, p (h0:T |µ̄h , Φh , Σh ) is the transition density of the volatility process (B.7). We maximize this target density and calculate the
Hessian at the posterior mode. We then draw from a Student’s t proposal distribution with mean
equal to the posterior mode and covariance matrix equal to the inverse Hessian at the mode.
For Gaussian models, we draw the free parameters in Σ0,g instead of µ̄h , Φh , Σh .

Appendix F.2

Particle filter

To estimate the structural parameters (β, γ, ψ) and the preference parameters θλ , we run cross-sectional
regressions on filtered estimates of the factors. In order to calculate the filtered estimates of the state
variables, we use a particle filter. The particle filter we implement is the mixture Kalman filter of Chen
and Liu(2000). Let gt|t−1 denote the conditional mean and Pt|t−1 the conditional covariance matrix of the
one-step ahead predictive distribution p(gt |Y1:t−1 , h0:t−1 ; θ) of a conditionally linear, Gaussian state space
model. Similarly, let gt|t denote the conditional mean and Pt|t the conditional covariance matrix of the
filtering distribution p(gt |Y1:t , h0:t ; θ). Conditional on the volatilities h0:T , these quantities can be calculated
by the Kalman filter.
Let J denote the number of particles and let Yt = (πt , ∆ct ) be N × 1. The particle filter then proceeds
as follows:
(i)
At t = 0, for i = 1, . . . , J, set w0 = J1 and
(i)

(i)

(i),0

• Draw h0 ∼ p (h0 ; θ) and calculate Σg,0 Σg,0 .
(i)

(i)

(i)

(i)

(i),0

• Set g1|0 = µ̄g + Φgh h̄0 , P1|0 = Σg,0 Σg,0 ,
• Set `0 = 0.
For t = 1, . . . , T do:
STEP 1: For i = 1, . . . , J:
(i)

(i)

• Draw from the transition density: ht+1 ∼ p(ht+1 |ht ; θ) given by:


(i)
(i)
zj,t+1 ∼ Poisson e0j Σ−1
Φ
h
j = 1, . . . , H
h
t
h


(i)
(i)
wj,t+1 ∼ Gamma νh,j + zj,t+1 , 1
j = 1, . . . , H
(i)

ht+1

=

(i)

Σh wt+1

57

(i)

(i)

(i)

• Calculate ct and Qt using ht .
(i)

=

Φgh ht + Σgh εh,t+1

(i)

=

Σg,t Σg,t

(i)

=

Yt − Zgt|t−1 − d

(i)

=

(i)

=

ZPt|t−1 Z 0 + H

−1
(i)
(i)
Pt|t−1 Z 0 Ft

gt|t

(i)

=

gt|t−1 + Kt vt

Pt|t

(i)

=

Pt|t−1 − Kt ZPt|t−1

gt+1|t

(i)

=

T gt|t + ct

(i)

=

T Pt|t T 0 + RQt R0

ct

Qt

(i)

(i)

(i)

(i),0

• Run the Kalman filter:
vt
Ft

Kt

Pt+1|t

(i)

(i)

(i)

(i) (i)

(i)

(i)

(i)

(i)

(i)

(i)
(i)


−1




(i)
(i)
(i)
(i)0
(i)
(i)
• Calculate the weight: log wt
= log ŵt−1 − 0.5N log (2π) − 0.5 log |Ft | − 21 vt
Ft
vt .
P

(i)
J
STEP 2: Calculate an estimate of the log-likelihood: `t = `t−1 + log
.
i=1 wt
(i)

(i)

STEP 3: For i = 1, . . . , J, calculate the normalized importance weights: ŵt =

w
PJ t

j=1

STEP 4: Calculate the effective

sample size Et = PJ 1 (j) 2 .
j=1 ŵt
n
oJ
(i)
(i)
(i)
gt+1|t , Pt+1|t , ht+1
with probabilities
i=1

STEP 5: If Et < 0.5J, resample
STEP 6: Increment time and return to STEP 1.

(i)

ŵt

(j)

wt

.

(i)

and set ŵt =

1
J.

Within the particle filter, we use the residual resampling algorithm of Liu and Chen(1998). We set J =
100000.

58

