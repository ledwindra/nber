NBER WORKING PAPER SERIES

WORKING THROUGH THE DISTRIBUTION:
MONEY IN THE SHORT AND LONG RUN
Guillaume Rocheteau
Pierre-Olivier Weill
Tsz-Nga Wong
Working Paper 21779
http://www.nber.org/papers/w21779

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2015

We thank for their comments participants at the 2015 West Coast Search-and-Matching Workshop
at the Federal Reserve Bank of San Francisco, 2015 annual meeting of the Society of Economic Dynamics,
2015 Summer Workshop on Money, Banking, Payments and Finance at the Federal Reserve Bank
of St Louis, and seminar participants at Simon Fraser University, University of Paris 2, and Banque
de France. The views expressed herein are those of the authors and do not necessarily reflect the views
of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2015 by Guillaume Rocheteau, Pierre-Olivier Weill, and Tsz-Nga Wong. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including © notice, is given to the source.

Working through the Distribution: Money in the Short and Long Run
Guillaume Rocheteau, Pierre-Olivier Weill, and Tsz-Nga Wong
NBER Working Paper No. 21779
December 2015
JEL No. E0,E4,E52
ABSTRACT
We construct a tractable model of monetary exchange with search and bargaining that features a nondegenerate distribution of money holdings in which one can study the short-run and long-run effects
of changes in the money supply. While money is neutral in the long run, a one-time money injection
in a centralized market with flexible prices generates an increase in aggregate real balances in the short
run, a decrease in the rate of return of money, and a redistribution of consumption levels across agents.
The price level in the short run varies in a non-monotonic fashion with the size of the money injection,
e.g., small injections can lead to short-run deflation while large injections generate inflation. We extend
our model to include employment risk and show that repeated money injections can raise output and
welfare when unemployment is high.

Guillaume Rocheteau
Department of Economics
University of California at Irvine
3151 Social Science Plaza
Irvine, California 9269
grochete@uci.edu
Pierre-Olivier Weill
Department of Economics
University of California, Los Angeles
Bunche Hall 8283
Los Angeles, CA 90095
and NBER
poweill@econ.ucla.edu

Tsz-Nga Wong
Research Department
Bank of Canada
234 Laurier Avenue West
Ottawa, Ontario, Canada
K1A 0G9
purpleteeth@gmail.com

1

Introduction

We develop a tractable model of monetary exchange with random matching and bargaining that features
non-degenerate distributions of money holdings and prices. We build on the workhorse of modern monetary
theory, the model of Lagos and Wright (2005), in which agents trade alternatively in decentralized markets,
with random search and bargaining, and in centralized markets with competitive pricing. Despite the
presence of idiosyncratic risk, the Lagos-Wright model is analytically tractable due to preferences that
eliminate wealth e¤ects in order to keep the distribution of money holdings degenerate.1 Our model provides a
simple and natural departure from the Lagos-Wright environment leading to ex-post heterogeneity in money
holdings while preserving tractability. By bringing the interplay between risk sharing and self-insurance
to the center stage of the analysis, our model generates new insights for classical, yet topical, questions
pertaining to the short-run and long-run e¤ects of changes in the money supply. Examples of questions our
model can address include: Does a one-time increase in the money supply a¤ect aggregate real balances in
the short run, thereby creating non-neutralities? Can a contractionary shock to monetary policy generate
short-run in‡ation? Are the e¤ects of an increase in the money supply monotone with the size of the money
injection? Are they long lasting? Can anticipated in‡ation raise output and welfare?
In order to answer these questions we adopt a version of the Lagos-Wright model with a single change:
we impose a …nite (possibly stochastic) bound, h, on agents’endowment of labor.2 Whenever the feasibility
constraint on agents’labor supply, h

h, binds, wealth e¤ects become operational: individual real balances

depend on past trading histories, value functions are strictly concave in money holdings, and the distribution
of money holdings is non-degenerate. Yet, the model remains tractable and can be solved in closed form—
including distributions and value functions— for a large class of equilibria. When it cannot be solved in
closed form, the equilibrium has a simple recursive structure allowing it to be easily computed.
The key ingredients for the tractability of the model are as follows. First, following Rocheteau and
Wright (2005) and Lagos and Rocheteau (2005), LRW hereafter, there is heterogeneity in terms of agents’
role in pairwise meetings: some agents are always buyers in bilateral matches in the decentralized goods
market (think of households) while other agents are always sellers (think of retailers). Sellers, who are riskneutral in terms of their centralized-market consumption, do not hold any real balances. As a result, buyers
e¤ectively trade with a representative seller. Second, the terms of trade in pairwise meetings are set by
buyers, allowing us to analyze savings and pricing decisions through a single dynamic programing problem.
1 The Lagos-Wright model discards distributional e¤ects not because they are thought to be unimportant, but because of the
view that they make models of monetary economies analytically untractable. Recent studies that …nd that distributional e¤ects
of monetary policy are quantitatively important include Doepke and Schneider (2006) and Coibion, Gorodnichenko, Kueng and
Silvia (2012).
2 Lagos and Wright (2005, p.467) do introduce an upper bound on hours of work, H, but they restrict their attention to
equilibria where H
H does not bind and they do not characterize policy and value functions for values of the state variable
when the constraint binds. Our key departure is to explicitly consider situations in which this constraint binds. Randy Wright
argues that we are introducing a second change relative to the Lagos-Wright model by not allowing intertemporal trades across
centralized markets. Our view is that the frictions that prevent such intertemporal trades— lack of commitment and the absence
of public monitoring— are the same frictions that shut down credit in the decentralized market. Lending and borrowing across
centralized markets would require some form of monitoring and enforcement and would introduce new securities that could
potentially serve as means of payment in decentralized markets.

2

Third, the buyer’s disutility of work in the centralized market is linear, which generates a simple policy rule
for the accumulation of real balances and simpli…es out-of-steady-state dynamics.3
We …rst characterize steady-state equilibria and show that buyers have a constant target for their real
balances, which represents their desired level of self-insurance. This target increases with their degree
of patience and the frequency of trading opportunities in the decentralized goods market. If their labor
endowment, h, is su¢ ciently large, agents can reach this target in a single period and the distribution of
real balances across buyers at the beginning of each period is degenerate. This special case is the one the
literature has been focusing on. In contrast, if h is su¢ ciently small, then it takes N

2 periods, where N is

endogenous, for an agent to reach his targeted real balances. As a result, the distribution of money holdings
is non-degenerate and risk-sharing considerations matter. Provided that the length of a period of time is
su¢ ciently small, ex-post heterogeneity with N

2 is a generic property of equilibrium. As a benchmark,

we calibrate the model using yearly data for the aggregate money demand. Parameter values are such that
N = 1, as in Lagos and Wright (2005). However, if we adjust the parameter values to be consistent with a
monthly frequency, then the equilibrium features N = 5 and a nondegenerate distribution of money holdings.
For most of the paper we focus on a class of tractable equilibria where buyers deplete their money
holdings in full whenever they are matched with a seller. Under such a trading pattern the distribution of
real balances is a truncated geometric distribution with N 2 N mass points. This heterogeneity in wealth
generates a distribution of consumption levels and prices across matches, with both output levels and prices
being higher for richer buyers. Equilibria where buyers do not deplete their money holdings in full in a match
are not solvable in closed form, but they can easily be solved numerically due to the recursive structure of
the equilibrium.
We then study the transitional dynamics for allocations and prices following a one-time money injection
through lump-sum transfer to buyers in the centralized market.4 If agents can reach their targeted real
balances in a single period, N = 1, as in the Lagos-Wright model, such a money injection has no real e¤ect
since the price level adjusts proportionally to the money supply and the economy instantly returns to its
steady state. However, if N

2 then our model features non-trivial transitional dynamics. We start the

economy at a steady-state equilibrium where the distribution of money holdings has two mass points at the
beginning of the period, N = 2. A one-time increase in the money supply raises aggregate real balances, i.e.,
the price level does not increase as much as the money supply. The economy returns to its steady state in
the following centralized market, i.e., the transition only lasts one period.
The reason the value of money fails to instantly reach its new steady-state value is because the centralized
market cannot reshu- e the units of money among buyers in a way that preserves neutrality. Indeed, in the
laissez-faire equilibrium buyers entering the competitive market with no money are constrained by their labor
endowment and cannot reach their desired real balances in a single period. Hence, if they receive a lump-sum
transfer, they will hold onto it in order to increase their real balances toward their target, which prevents
3 The
4 We

model remains tractable under general preferences, as shown in Rocheteau, Weill, and Wong (2015).
also consider other forms of transfers, including lump-sum transfers to both buyers and sellers.

3

an instant return of the distribution to its steady state. By market clearing, the anticipated rate of return
of money following the money injection is negative, which drives the target for real balances down. The
distribution of real balances becomes less dispersed in the following decentralized goods market, which raises
aggregate output if the seller’s production cost is strictly convex and leads to higher welfare by providing
risk sharing.
We provide conditions under which the injection of money triggers a de‡ation in the short run— the
value of money rises above its initial steady-state value— and aggregate output increases. Symmetrically, a
contraction of the money supply can generate an increase in the price level in the short run, thereby explaining
the "price puzzle" of Eichenbaum (1992). Su¢ ciently large money injections are always in‡ationary in both
the short and long run, and they make the distribution of money holdings degenerate in the short run.
If the initial steady state features a richer heterogeneity, at least three mass points in the distribution
of real balances, N

3, then the real e¤ects of a one-time money injection are long-lasting. We illustrate

this result by considering a 5 percent increase in the money supply for the same calibration as in Lagos
and Wright (2005). At a yearly frequency the model features N = 1 and such a shock instantly generates
a 5 percent in‡ation. At a weekly frequency the equilibrium features N = 17 (it takes 17 weeks for buyers
to reach their targeted real balances) and the (annualized) in‡ation peaks initially at about 0.4% and it is
persistent.
Finally, we extend the model to incorporate idiosyncratic unemployment risk in addition to the random
matching risk in the goods market. Formally, h follows a two-state Markov chain where the low state is
interpreted as unemployment. We study a simple class of equilibria where unemployed agents need multiple
periods in order to accumulate their targeted real balances and we show that the response of the economy to
a monetary shock depends on the size of the unemployment rate. We also study repeated money injections
leading to a constant money growth rate. An increase in the money growth rate reduces the rate of return
of money, but it also improves risk-sharing by raising the real balances of the poorest, unemployed agents.
Under some conditions on the steady-state unemployment rate and the income of the unemployed, the
positive risk-sharing e¤ect dominates and social welfare increases.

1.1

Literature review

Diamond and Yellin (1990) were the …rst to study non-degenerate distributions of money holdings analytically
in a search environment, but their model was not explicit about the frictions that make money essential—
money was introduced through a cash-in-advance constraint. Search-theoretic models of Shi (1995) and Trejos
and Wright (1995) added heterogeneity and frictions (lack of commitment/enforcement, no monitoring) to
make money essential, but the models were kept tractable by restricting money holdings to f0; 1g. The
model was extended by Camera and Corbae (1999) to allow for a more general support for the distribution
of money holdings, and it was solved numerically by Molico (2006) under the assumption that buyers make
take-it-or-leave-it o¤ers to sellers. Zhu (2005) provides an existence result for monetary steady states. Green
and Zhou (1998) and Zhou (1999) study a similar environment where goods are indivisible and prices are
4

posted by sellers. They characterize analytically a class of equilibria where all transactions occur at the same
price and show that there exists a continuum of such equilibria. In contrast, our model delivers a unique
laissez-faire equilibrium.
Menzio, Shi, and Sun (2013) consider an environment with directed search and posted prices where …rms
produce divisible goods and individuals choose to be either buyers or workers in a period.5 They show
that the laissez-faire monetary steady state is block-recursive in the sense that policy functions and value
functions are independent of the distribution of real balances. In contrast we use the Lagos-Wright model
with alternating market structures— random search and ex-post bargaining followed by price taking— and its
version with ex-ante heterogeneity from Lagos and Rocheteau (2005) and Rocheteau and Wright (2005). We
achieve a higher level of tractability by being able to solve for distributions and value functions in closed form,
and by characterizing the equilibrium analytically both at and out of the steady state. In Menzio-Shi-Sun,
agents’problems are not concave and the existence of equilibrium requires the use of monotone comparative
statics methods. In contrast, all individual problems in our model are concave, and we can use textbook
dynamic programming techniques to establish general properties of value and policy functions. Also, the
bargaining game in the decentralized market could easily be replaced by price taking or competitive search,
as in Rocheteau and Wright (2005). Finally, Sun (2012) extends Rocheteau and Wright’s (2005) quasi-linear
competitive search environment by introducing idiosyncratic shocks on the linear disutility of labor. While
the model generates ex-post heterogeneity, the distribution for real balances conditional on the marginal
disutility of labor is degenerate.
Closer to our approach, Chiu and Molico (2010, 2011) adopt the alternating-market structure of Lagos
and Wright (2005). They relax the assumption of quasi-linear preferences in order to obtain distributional
e¤ects. While the results in Chiu and Molico are numerical, we obtain a tractable model with closed-form
solutions. The main two di¤erences between our approach and the one in Chiu and Molico are as follows.
First, we assume ex ante heterogeneity between buyers and sellers as in LRW. As a result, the only relevant
distribution of money holdings is the one across buyers, and this distribution a¤ects the buyer’s problem only
through its …rst moment. Second, we adopt the fully linear speci…cation for preferences over the centralized
market good, again as in LRW, but we add an upper bound on the labor supply. This speci…cation implies
that buyers supply their full endowment of labor until they reach their targeted real balances. Moreover, it
allows us to have the LRW model with a degenerate distribution and linear value function as a particular
case. Zhu (2008) constructs a model with alternating market structures and general preferences and achieves
tractability by assuming that agents from overlapping generations can trade at most once in the decentralized
market with search and bargaining.
This model is related to our earlier work in Rocheteau, Weill, and Wong (2015) with important di¤erences.
The former describes a competitive economy in continuous time populated with ex-ante identical agents,
where the idiosyncratic uncertainty takes the form of preference shocks for lumpy consumption. In contrast,
5 Monetary models with divisible goods and directed search were …rst introduced by Rocheteau and Wright (2005) and Lagos
and Rocheteau (2005).

5

we study a discrete-time economy with search and bargaining, where ex-ante heterogenous agents face
idiosyncratic uncertainty due to random matching. These ingredients make our model more easily comparable
to the New-Monetarist framework. Moreover, the use of discrete time allows us to harness the ex-post
heterogeneity, thereby facilitating the study of transitional dynamics, a main focus of our paper. We also
assume that h is stochastic in order to study the positive and normative e¤ects of in‡ation when there is
employment risk.
Berentsen, Camera, and Waller (2005) generalize the Lagos-Wright model by assuming two rounds of trade
before agents can readjust their money holdings. This assumption generates a non-degenerate distribution of
money holdings at the start of the second decentralized market. In contrast to our environment, any money
injection in the centralized market is neutral. Yet, our model generates a rich distribution of money holdings
with a single round of pairwise meetings— the distribution can have any number of mass points as well as
continuous intervals. Williamson (2006) obtains short-run non-neutralities in the Lagos-Wright model by
introducing limited participation, while Faig and Li (2009) achieve a similar objective by adopting the Lucas
signal extraction problem. In our model all agents can participate in the centralized market in all periods,
and changes in the money supply are common knowledge.
Wallace (1997) considers an unanticipated change of the money supply in a random matching model with
f0; 1g money holdings and shows that the short-run e¤ects are predominantly real while the long-run e¤ects
are predominantly nominal. Jin and Zhu (2014) generalize the model by assuming a large upper bound
on money holdings and by allowing lotteries to overcome the indivisibility of money. They show, through
numerical examples, that a money injection can have a persistent e¤ect on output and price adjustments are
sluggish. Chiu and Molico (2014) study a closely related model with divisible money and no upper bound
on money holdings— as in our setting— and show numerically that unanticipated in‡ation shocks can have
persistent e¤ects on output, prices, and welfare.
Finally, Scheinkman and Weiss (1986), in the context of a Bewley economy with competitive markets
and aggregate endowment shocks, show that one-time money injections generate output and price e¤ects
which depend on the state of the economy. Similarly, Algan, Challe, and Ragot (2011) study temporary
and permanent changes in money growth in a Bewley economy with idiosyncratic employment shocks and
quasi-linear preferences, focusing on equilibria with two-state wealth distribution. In contrast, our economy
has two sectors and features an idiosyncratic consumption risk due to the assumption that some trades take
place under random, pairwise matching and bargaining. In the last part of the paper we combine both
random matching risk and unemployment risk in order to investigate how short-run non-neutralities and the
optimal in‡ation rate depend on the unemployment rate.

2

Environment

Time, t 2 N0 , is discrete and the horizon in…nite. Each period has two stages. In the …rst stage, agents trade
in a decentralized market (DM) with pairwise meetings and bargaining. In the second stage, they trade in

6

a centralized market (CM). The DM and CM consumption goods are perishable and the CM good is taken
as the numéraire.
The economy is populated by two types of agents: a unit measure of buyers and a measure

of sellers,

refering to an agent’s role in the DM. In the …rst stage buyers want to consume but cannot produce, while
sellers are able to produce but do not wish to consume. The period-utility function of a buyer is
u(y) + c

h;

(1)

where y 2 R+ is DM consumption, c is CM consumption, and h is CM labor supply. We assume that u

is bounded, and strictly concave with u(0) = 0, u0 (0) = 1, and u0 (+1) = 0. In order to apply dynamic
programming techniques with bounded returns we assume that c is bounded above by a satiation point,
c > 0.6 Throughout the analysis c is su¢ ciently large so that buyers never reach their satiation point along
the equilibrium path, and c does not a¤ect equilibrium outcomes. The technology to produce the CM good
is linear so that h units of labor generate h units of numéraire. The buyer’s endowment of labor is h. (h
is stochastic in Section 6). In contrast to the existing literature, we consider equilibria where the feasibility
constraint, h

h, binds for some agents, thereby departing from a quasi-linear environment with degenerate

distributions of money holdings. The period-utility function of a seller is
v(y) + c;

(2)

where v(y) is the disutility of producing y units of the DM good in a pairwise meeting and c

0 is the

linear utility of consuming the numéraire. We do not impose a satiation point for sellers’consumption. The
discount factor across periods,

2 (0; 1), is common to all agents.

Market structures di¤er in the DM and CM. In the DM a measure

minf1; g of bilateral matches

composed of one buyer and one seller is formed. The trading mechanism is such that the buyer in a match
makes a take-it-or-leave-it o¤er to the seller. In the CM all agents are price-takers and markets clear.
Intertemporal gains from trade exist when the seller produces y in the DM in exchange for c in the CM
with v(y)

c

u(y). However, these gains from trade cannot be exploited with unsecured credit since

buyers cannot commit to repay their debt and there is no monitoring. There is an intrinsically useless,
perfectly divisible and storable asset called money that agents can (but don’t have to) use as a medium of
exchange to overcome these frictions. We use M to denote the constant money supply in the DM. The CM
price of money in terms of the numéraire is

t.

The gross rate of return of money is denoted Rt

t= t 1.

Full insurance
Suppose that buyers can commit to an insurance contract according to which they supply h units of labor
every period in exchange for a consumption level y in the (observable) event they are matched in the DM.
The expected utility of the buyer in each period is
h, is promised to the
6 In

u(y)

h. The total CM output produced by buyers,

sellers who are matched in the DM, c = h= . We keep a similar trading mechanism

the appendix, we study the dynamic programming problem with the utility function written explicitly as min(c; c).

7

to the one described above: buyers make take-it-or-leave-it o¤ers to sellers. Sellers are willing to go along
with the proposed allocation if c

v(y), i.e., their consumption is greater than their disutility of production.

Hence, the optimal insurance contract among buyers, (hF I ; y F I ), solves:
max [ u(y)

h] s.t. c =

h

v(y):

y;c;h h

The solution is y F I = y^ and hF I = v(^
y ), where u0 (^
y ) = v 0 (^
y ), if h

v(^
y ). Otherwise, y F I = v

1

h=

< y^

and hF I = h. So provided that labor endowments are su¢ ciently large, the full-insurance allocation equalizes
the marginal utility of consumption of the buyer and the marginal disutility of the seller, as in LRW. In
contrast, if the labor endowment is not large enough to implement y^ then the full-insurance allocation is
such that DM output is maximum, hF I = h, and u0 (y F I ) > v 0 (y F I ).

3

Equilibrium

We characterize an equilibrium in three steps. First, we study the decision problem of a buyer who takes
as given the sequence of rates of return, fRt g+1
t=1 . Second, given the buyer’s optimal consumption/saving
decisions we write the law of motion for the distribution of real balances. Third, we clear the money market
+1

in every CM in order to obtain the value of money, f t gt=0 , and hence its rate of return.
Value functions Consider …rst the problem of a buyer at the beginning of the CM of period t holding z
real balances (money balances expressed in terms of the period-t CM good). In order to characterize this
problem we make two assumptions on the path for the gross rate of return of …at money, fRt+1 g+1
t=0 . First,
there exists some R > 0 such that, for all t

0, Rt+1 > R. This …rst assumption rules out hyper-in‡ationary

dynamics such that the gross rate of money approaches 0. Second, we assume the following condition holds:
1
X

i

)i

(1

1

i
Q

j=1

i=1

Rj < 1:

(3)

The second assumption is used to establish that the expected present marginal value of real balances is …nite,
which in turn allows us to prove the di¤erentiability of the value function. Note that both assumptions are
veri…ed for the steady states and transitional dynamics we analyze in the paper, whereby Rt ! 1 as t ! 1.
The value function of a buyer solves:
Wt (z) = max
fc
0
h;z

s.t. z 0 = Rt+1 (h

c + z)

h + Vt+1 (z 0 )g

(4)

0, h 2 0; h , c 2 [0; c] :

(5)

According to (4) the buyer chooses his consumption, c, labor supply, h, and next-period real balances, z 0 ,
in order to maximize his discounted continuation value in t + 1 net of the disutility of work. The budget
identity, (5), speci…es that the next-period real balances are equal to the sum of the current wealth and
savings (labor income net of consumption) multiplied by the gross rate of return of money. Moreover, the
buyer’s problem is subject to a non-negativity constraint for real balances, a feasibility constraint on labor
8

supply, and an optimality condition that speci…es that consumption cannot be larger than its satiation point.
The value functions are indexed by t as the gross rate of return of money, Rt , might vary over time.
In the DM each matched buyer makes a take-it-or-leave-it o¤er, (y; p), to a seller, where y is the DM
output to be produced by the seller in exchange for a payment, p, in the form of real balances.7 This payment
must satisfy the feasibility constraint p

z since buyers’IOUs are not accepted by sellers due to lack of both

commitment and monitoring. It must also satisfy the individual rationality constraint of the seller according
to which the payment must be at least equal to the disutility of production,

v(y) + p

0. When writing

this participation constraint we anticipated on the result that sellers spend all the money they accumulate
in the DM in the following CM. Indeed, sellers get no surplus in the DM and hence they have no motive for
carrying real balances from one period to the next. The seller’s participation constraint will hold at equality,
v(y) = p, as otherwise the buyer would have an incentive to reduce the size of the payment for the same
output level. Hence, the lifetime expected discounted utility of a buyer at the beginning of the DM is:
Vt (z) =
where !(p)

u

v

1

max [!(p) + Wt (z
p z

(p). With probability

p)] + (1

)Wt (z);

(6)

the buyer is matched in the DM, in which case he chooses

an output level, y, in exchange for p = v(y) units of real balances. With probability 1

the buyer is

unmatched and enters the next CM with z real balances.
We now prove the existence, continuity, and di¤erentiability of the value functions, Vt (z) and Wt (z).
From (4)-(5) and (6) we de…ne Wt recursively as follows:

Wt (z) = max
z
0
p;z

z0
+
Rt+1

s.t. z 0 2 Rt+1 (z

[!(p) + Wt+1 (z 0
c) ; Rt+1 z + h

)Wt+1 (z 0 )

p)] + (1
and p

z0.

(7)

Proposition 1 The Bellman equations (6)-(7) have unique bounded solutions, Vt (z) and Wt (z). The functions Vt (z) and Wt (z) are continuous, concave, strictly increasing, and satisfy
kW k

c+h+
1

k!k

and kV k

c + h + k!k
:
1

Moreover, Wt and Vt are continuously di¤ erentiable with Wt0 (0+ ) < 1 and Vt0 (0+ ) = 1.
In order to prove Proposition 1 we use (7) to de…ne a contraction mapping from the set of bounded
functions de…ned over N

R+ into itself. As a result the …xed point of this functional equation is continuous

and bounded. Moreover, concavity is preserved by this mapping according to Theorem 4.7 in Stokey and
Lucas (1989). The main di¢ culty we confront in order to establish di¤erentiability is that the Envelope
Theorem of Benveniste and Scheinkman, which requires that the optimal choice lies in the interior of the
constraint set, does not apply to our environment since the labor endowment constraint may bind. To
7 The model remains tractable under competitive pricing. See Rocheteau, Weill, and, Wong (2015) for a related model in
continuous-time where households trade in a competitive market.

9

address this di¢ culty, Rincón-Zapatero and Santos (2009) have established an envelope theorem for a broad
class of stationary dynamic optimization problems in which optimal choices may not lie in the interior of
the constraint set, but must lie in the interior of the state space. We apply their results to our environment.
The application is not immediate, however, because two of their maintained assumptions are violated. First,
our environment is non-stationary, since Rt+1 is not constant over time. Second, some optimal choices may
not lie in the interior of the state space: namely, when a buyer chooses to deplete his money holdings in full
in the DM, he enters the following CM with zero money balances.
Choice of real balances In the following we focus on equilibria such that the condition, c
binds for z in the support of the money distribution. Let
h. Substituting h = z 0 =Rt+1

with h

t (z)

c, never

denote the Lagrange multiplier associated

z from (5) into the objective, we can rewrite the buyer’s problem

as:
1
Wt (z) = z + Rt+1
max
0
z

If

t

0

z 0 + Rt+1 Vt+1 (z 0 ) +

t

Rt+1 (h + z)

z0

:

(8)

= 0, then the second term on the right side of (8) is independent of z, the choice of next-period real

balances is independent of current wealth, and Wt is linear, as in Lagos and Rocheteau (2005, Eq. (9)).
However, if the feasibility constraint on labor binds,

t

> 0, then the choice of real balances is no longer

independent of current wealth and Wt is no longer linear— the two key ingredients of the tractability of the
Lagos-Wright model. The envelope theorem applied to (8) gives:
Wt0 (z)

t (z)

=1+

t:

(9)

The …rst-order condition for the choice of real balances is
t (z)

where

t

= 1+

t

0
+ Rt+1 Vt+1
(z 0 )

0;

“ = ” if z 0 > 0;

(10)

0
measures the cost of accumulating real balances, and Rt+1 Vt+1
(z 0 ) is the marginal bene…t

of real balances in the CM of period t: the discounted marginal value of real balances in the DM of t + 1
?
times the gross rate of return of real balances. We de…ne a buyer’s targeted real balances for t + 1, zt+1
, as

a solution to (10) when

t

= 0, i.e.,
0
?
Rt+1 Vt+1
(zt+1
) = 1:

The target is the buyer’s choice when h

h does not bind, z + h

(11)
?
zt+1
=Rt+1 . It equalizes the marginal

disutility of labor, one, with the discounted marginal value of real balances in the next DM. We show in the
?
Appendix that the set of solutions to (11), denoted Zt+1
, is convex, bounded above, and bounded away from
?
zero. We will proceed in the following under the presumption that Zt+1
is a singleton, which is the relevant

case in the rest of our analysis. (The proofs in the Appendix do not rely on this simpli…cation.)
Let us turn brie‡y to the seller’s choice of real balances in the CM. Since sellers do not get any surplus
in the DM their problem is simply:
s
Wts (z) = max
c + Wt+1
(z 0 )
0
c;z

s.t. z 0 = Rt+1 (z

Hence, Wts (z) is linear in z and z 0 = 0 provided that Rt+1 < 1.
10

c):

Terms of trade in the DM. The solution to the maximization problem on the right side of (6) is p = v(y)
and
! 0 (p)
p

= Wt0 (z

p) if ! 0 (z) < Wt0 (0);

(12)

= z otherwise.

(13)

According to (12) the buyer equalizes his marginal utility from spending a unit of real balances in the DM,
u0 (y)=v 0 (y), with the marginal value of real balances in the CM as measured by Wt0 . We represent (12) in
Figure 1: the left side is the blue downward-sloping curve and the right side is the red upward-sloping curve.
From the (weak) concavity of W it follows that Wt0 (z

p) is non-increasing in z. Hence, as z increases the red

upward-sloping curve moves downward, illustrated by the two dashed curves located underneath the plain
upward-sloping curve. Those curves are horizontal for low values of p because the buyer enters the next CM
with enough real balances to reach his target, in which case the marginal utility of real balances is equal to
one. It follows that payment, p, and output, y, are non-decreasing in the buyer’s real balances. Similarly,
p then ! 0 (z

if we denote post-trade real balances by z~ = z

z ). Hence, post-trade real balances
z~) = Wt0 (~

are weakly increasing in pre-trade real balances.

Wt ' ( z − p)
Wt ' (0)

1
' ( p)

zt

v( y )

Figure 1: Bargaining outcome

From (13), if the marginal utility from spending real balances in the DM is larger than the marginal
value of money in the CM when money holdings are depleted in full, ! 0 (z)

Wt0 (0), then the buyer spends

all his real balances. We denote by zt the threshold below which there is full depletion of real balances. It
solves
! 0 (zt ) = Wt0 (0):

(14)

We have established in Proposition 1 that Wt0 (0) < +1, the marginal value of real balances of a buyer
entering the CM with no money is …nite. Given that ! 0 (0) = 1 it follows that zt > 0, i.e., there is an
interval of real balances for which buyers …nd it optimal to spend all their real balances in a DM match.
11

y( z)

z min

z max

Full depletion

v(y)
p(z) = z

p(z)

Figure 2: Terms of trade in DM pairwise meetings

In Figure 1 we represent W 0 (zt

p) by a dashed curve located above the plain upward-sloping curve. It

intersects the horizontal line given by Wt0 (0) and ! 0 (p) when p = zt .
There are two thresholds for real balances, ztmin and ztmax , such that for all z 2 ztmin ; ztmax buyers
anticipate that they will be able to reach their target in the following CM after consuming p(z) in the current
DM. Because agents can reach their target, their post-trade real balances must satisfy Wt0 [z

pt (z)] = 1 so

that, from (12), y = y^ and p = v(^
y ). Hence, the thresholds must be given by:
ztmin
ztmax

?
zt+1
h
Rt+1
z?
= v(^
y ) + t+1 + c:
Rt+1

= v(^
y) +

(15)
(16)

According to (15) in order to be unconstrained by his labor endowment in the following CM the buyer must
hold at least ztmin so that after spending v(^
y ) in the DM he can reach his target by working h. Equation
(16) has a similar interpretation.
?
=Rt+1 then there is an interval of
In contrast to the bargaining outcome in the LRW model, if h < zt+1

real balances, (zt ; ztmin ), for which buyers spend a fraction of their real balances even though they consume
less than y^. Buyers …nd it optimal not to spend all their real balances because they anticipate that they
will not be able to reach their targeted real balances in the following CM and hence, according to (12), they
equalize the marginal value of real balances in the DM, ! 0 (p), and the marginal value of real balances in the
CM, Wt0 (z

p) > 1. We summarize the outcome of the bargaining problem in the following proposition and

Figure 2.
Proposition 2 (Bargaining outcome) The buyer’s problem in the DM, (6), has a unique solution, pt (z).
This solution is continuous, increasing, and satis…es limz!0 pt (z) = 0 and limz!1 pt (z) = 1. Assume
12

?
Wt0 (0) > 1, i.e., h < zt+1
=Rt+1 . There exist zt < ztmin < ztmax de…ned in (14), (15), and (16), such that:

1. For all z

zt , pt (z) = z and yt (z) = v

1

(z).

2. For all z 2 zt ; ztmin , pt (z) < z, and yt (z) = v

1

[pt (z)] are increasing in real balances.

3. For all z 2 ztmin ; ztmax , pt (z) = v(^
y ), and yt (z) = y^.
The marginal value of real balances at the beginning of the DM is
Vt0 (z) = ! 0 [pt (z)] + (1

) t (z);

(17)

where pt (z) is the solution to the bargaining problem, (12)-(13). The marginal value of real balances in
the DM is equal to the marginal utility of DM consumption with probability
marginal utility of real balances in the following CM with probability 1
substitute

0
Vt+1
(z 0 )

(a match occurs) and the

(the buyer is unmatched). We

by its expression given by (17) into (10) to obtain the law of motion for the marginal

value of real balances:
t (z)

= Rt+1 f ! 0 [pt+1 (z 0 )] + (1

)

t+1 (z

0

)g :

(18)

The marginal value of real balances at time t is equal to the discounted marginal value of Rt+1 real balances
in t + 1 plus the present value of a liquidity term equal to

f! 0 [pt+1 (z 0 )]

t+1 (z

0

)g which corresponds to

the buyer’s expected marginal surplus from spending a unit of real balances in a DM match. Iterating (18)
forward we obtain a closed-form solution for the derivative of the value function:
!
1
X
i
Q
i
i 1
(1
)
Rt+j ! 0 [pt+i (zt+i )] ;
t (z) =

(19)

j=1

i=1

where zt+i is a sequence of optimal real balances starting from zt = z.

Distribution of real balances. Let us turn to the law of motion for the distribution of real balances.
We denote as Ft (z) the distribution of real balances at the beginning of period t. The distribution at time
t + 1 is given by:
Ft+1 (z) =

Z

Ifzt+1 [x

pt (x)] zg

+ (1

)Ifzt+1 (x)

zg dFt (x);

(20)

where zt+1 (x) is the policy function derived from (12)-(13) that speci…es the choice of real balances in t + 1,
given the real balances at the beginning of the CM in t. It is given by:
?
zt+1 (x) = minf(x + h)Rt+1 ; zt+1
g;

where we assume that the satiation point does not bind over the support of the distribution of real balances
?
(see appendix for the general case). Either the buyer can reach his target, zt+1
, or he supplies all his labor

so that his total wealth is composed of his initial wealth and his labor endowment, x + h. This wealth is
capitalized according to the gross real rate of return of …at money. The …rst term underneath the integral on
the right side of (20) represents the measure
x

of buyers who are matched in the DM and enter the CM with

pt (x) real balances, where x is their pre-trade real balances. In the CM they accumulate zt+1 [x

for period t + 1. The second term represents the unmatched buyers.
13

pt (x)]

Value of money Finally, the value of money is determined by the following money market clearing
condition:
tM =

Z

xdFt (x):

(21)

Hence, the rate of return of money is
t+1

Rt+1 =

t

R

xdFt+1 (x)
= R
:
xdFt (x)

De…nition 1 Given some initial distribution, F0 , an equilibrium is a sequence, fFt ;

(22)
+1
t ; Rt+1 gt=0 ,

that solves

(20), (21), and (22).
A steady-state equilibrium is such that fFt ;
money is Rt =

t+1 = t

tg

is constant over time and the gross rate of return of

= 1. From (18) with ( z ? ) = 0 the targeted real balances solve:
u0 [y(z ? )]
r
=1+ ;
v 0 [y(z ? )]

(23)

where from (12)-(13), y( z ? ) is the solution to
W 0 [z ?

v(^
y )]
z?

= 1+

r

if ! 0 (z ? ) < W 0 (0)

= v(^
y ) otherwise.

At the targeted real balances the ratio of the marginal utility of DM consumption to the marginal disutility
of DM production is equal to the marginal disutility of labor in the CM, one, plus the average holding cost
of real balances. This cost is equal to the rate of time preference multiplied by the average period length
until a match in the DM occurs, 1= .
Given z ? we can de…ne Q(z; [0; z 0 ]) as the probability that a buyer with z 2 [0; z ? ] real balances at the

beginning of period t ends up with less than z 0 at the beginning of the following period, t + 1. It solves:
Q(z; [0; z 0 ])

= 0 if z 0 < minfz
=
=

Since both z and z

if z 0 2 [minfz
1 if z 0

p(z) + h; z ? g
p(z) + h; z ? g; minfz + h; z ? g)

minfz + h; z ? g:

p(z) are weakly increasing, the transition probability is monotone. It satis…es the Feller

property since z and z

p(z) are continuous.8 It is also easy to verify the mixing property.9 Existence and

uniqueness of a stationary distribution follows from Theorem 12.12 in Stokey and Lucas (1989).
8 To see that it is satis…ed, consider for any z a continuity point of the CDF z 0 7! Q(z; [0; z 0 ]). That is, any z 0 di¤erent
from the discontinuity point of the CDF, which are minfz
p(z) + h; z ? g and minfz + h; z ? g. Suppose for example that
z 0 < minfz p(z) + h; z ? g. Then, by continuity, for any sequence zn ! z, z 0 < minfzn p(zn ) + h; z ? g as long as n is large
enough. This implies that Q(zn ; [0; z 0 ]) = Q(z; [0; z 0 ]). The result follows from Theorem 12.8 in Stokey and Lucas (1989),
together with point b in exercise 12.7.
9 To verify the mixing property of Assumption 12.1 in Stokey and Lucas (1989), we need to show that there exists some
c 2 [0; z ? ], some " > 0 and some N
1 such that QN (0; [c; z ? ])
" and QN (z ? ; [0; z ? ])
". Let c = z ? and N = bxc, i.e.,
the number of period of production required to reach the target z ? starting from zero. Then the mixing property is veri…ed for
" = (1
)N .

14

4

Money in the long run

We focus on equilibria where it takes N > 1 consecutive rounds of CM trades for a buyer with depleted
money holdings to rebuild his targeted real balances if he remains unmatched in all DMs. (The case N = 1
is the LRW model.) Moreover, we will …rst focus on equilibria where buyers deplete all their real balances
in the DM, z ? < z.10
Targeted real balances From (23), the buyer’s targeted real balances, z ? 2 (N
! 0 (z ? ) = 1 +

r

1)h; N h , solves

:

(24)

As buyers become more patient, or as the frequency of matches increases, the targeted real balances increase.
The condition z ? 2 (N

1)h; N h can be reexpressed as
(N

1 −α

h

1− α

1)h < ! 0

1− α

2h

1

1+

1−α

r

1− α

N h:

(25)

1−α

1− α

(N 1)h

nh

z * Nh

Figure 3: Support of the distribution of real balances

Distribution of real balances The support of the distribution of real balances across buyers at the
beginning of a period is fh; 2h; :::; (N

1)h; z ? g. As illustrated in Figure 3, buyers increase their real balances

by the size of their labor endowment, h, until they reach their target. The distribution F is composed of N
mass points, f

N
n gn=1 ,

where

n

is the measure of buyers holdings nh for all n 2 f1; :::; N

1g and

N

is

?

the measure of buyers holding their target, z . We have:
1

=

(26)

n

=

(1

)

n 1

N

=

(1

)

N 1:

for all n 2 f2; N

1g

(27)
(28)

1 0 The model is tractable numerically, even when the equilibrium features partial depletion, because it can be solved recursively.
First, W (z) is the …xed point of a contraction mapping, (7), that is independent of the distribution of real balances. Second,
once W (z) and the associated policy function, p(z), are obtained (by iterations of the Bellman equation) we can use them
to compute the distribution of real balances. Numerically, we generate a large number of long trading histories and we use
the resulting terminal real balances to compute the empirical distribution of real balances. (The algorithm is detailed in the
appendix.)

15

According to (26) each buyer is matched with a seller with probability , in which case he spends all his real
balances (since we are focusing on equilibria with full depletion). By the Law of Large Numbers the measure
of buyers entering the CM with depleted money balances is

. Those buyers supply their full endowment

of labor in order to start the following period with z1 = h real balances. According to (27) the measure of
agents holding zn = nh 2 (z1 ; z ? ) is equal to the measure of buyers holding zn
that they were unmatched in the last DM round, 1

1,

n 1,

times the probability

, so that such buyers add h to their existing real

balances. Finally, the measure of agents holding the targeted real balances is determined such that the
‡ow of buyers with the targeted real balances who are matched in the DM,
buyers holding zN

1

N,

is equal to the ‡ow of

?

who are unmatched in the DM and reach z in the next CM. It is straightforward from

(26)-(28) to solve for the distribution of real balances in closed form:
n

=

N

=

)n

(1

)N

(1

1
1

for all n = 1; :::; N

1

(29)

:

(30)

From (29)-(30) the distribution of real balances is a truncated geometric distribution.11
As a result of the ex-post heterogeneity across buyers, and because terms of trade are determined through
bargaining, the model features a distribution of nominal prices in the DM. The unit price of the DM output
for a buyer holding zn = nh real balances is zn =v

1

(zn ) , which is increasing in zn if v is strictly convex.

Thus, the richest agents in the DM purchase larger quantities and pay a higher price to compensate sellers
for their convex disutility of production. The fraction of the transactions taking place at that price is
Value of money and prices. Aggregate real balances are M =
some calculation, this gives
M =h

1

(1

)N

1

[(N

1) + 1]

PN

+ (1

n zn .

n=1

)N

n.

From (29)-(30), and after

1 ?

z :

(31)

Aggregate real balances do not depend on the nominal money supply and hence money is neutral in the long
run. For a given N the value of money increases with the buyer’s labor endowment, h, and it decreases with
the rate of time preference, r.
Marginal value of real balances Next, we determine the marginal value of real balances, (z) = 1+ (z),
recursively. Suppose z 2 ( z ?

h; z ? ). If the buyer can reach his targeted real balances by supplying less

than h, then the feasibility constraint on labor is slack, (z) = 0. As a result, (z) = 1 and W (z) is linear.
From (18),
(z) =
If a buyer enters the CM with z

! 0 z + h + (1
z?

) (z + h) ; for all z

z?

h.

(32)

h real balances then he supplies his endowment of labor and enters

the next period with z + h. With probability

the buyer is matched and spends all his real balances. The

1 1 Green

and Zhou (1998), Zhou (1999), and Rocheteau (2000) also …nd geometric distributions of money holdings in search
models with price posting and indivisible goods. However, the dynamics of individual real balances are di¤erent as individuals
accumulate and deplete real balances one unit at a time.

16

marginal value of a unit of money is then ! 0 z + h . With probability 1

the buyer is unmatched and

enters the CM with z + h, in which case the marginal value of money is (z + h). The di¤erence equation
(32) can be solved in closed form to give:
+1
X

(z) = 1 +

j

)j

(1

1

!0 z + j h

! 0 (z ? )

+

;

(33)

j=1

where [x]+ = maxfx; 0g. The marginal value of money is equal to one, the marginal disutility of work, plus
the discounted sum of the di¤erences between the marginal utility of DM consumption at a point in time
and his marginal utility of consumption at the targeted real balances. It is easy to check that (z) = W 0 (z)
is decreasing in z (from the concavity of u v

1

(z)) and continuous.

Given (z) we can obtain the value function, W (z), in closed form. At his targeted real balances the
lifetime expected utility of a buyer is
W (z ? ) =

f [!(z ? ) + W (0)] + (1

)W (z ? )g :

(34)

The buyer does not need to readjust his real balances, and hence he incurs no cost in the CM. In the following
DM he is matched with probability

in which case he depletes all his money balances. If he is unmatched

he enters the subsequent CM with his targeted real balances. Multiplying both sides of (34) by
R z?
using that W ( z ? ) W (0) = 0 (x)dx, W ( z ? ) can be rewritten as
"
#
Z ?

1

and

z

rW (z ? ) =

!(z ? )

(x)dx :

(35)

0

Given W ( z ? ) we obtain W (z) as follows:
?

W (z) = W (z )

Z

z?

(x)dx =

z

r

"

Z

?

!(z )

#

z?

(x)dx

0

Z

z?

(x)dx:

(36)

z

We represent W (z) in Figure 4.
The condition for full depletion of real balances is ! 0 ( z ? )
0

(0). The marginal utility that the buyer

?

gets from spending his last unit of real balances, ! ( z ), must be greater than the marginal utility from
holding onto this unit of money, (0). From (33) the condition for full depletion is
0

?

! (z )

1=

r

+1
X

j

(1

)j

1

!0 j h

! 0 (z ? )

+

:

(37)

j=1

We represent the condition (37) by a grey area in Figure 5. The dotted lines represent the conditions in
(25). The case studied in LRW, N = 1, requires the endowment in labor, h, to be large so that the buyer
can readjust his money balances in a single period. If the endowment is such that ! 0 (h) > 1 + r=

then it

will take more than one period for the buyer to reach his targeted real balances.
As indicated earlier, sellers who have linear preferences over CM consumption goods …nd it optimal to
spend all their real balances in the CM since R < 1, i.e., the rate of return of money does not compensate
sellers for their time preference. As a result, within each period sellers produce DM consumption goods in
17

W (z)
W(z*)

h
W ( z * h)
h h
does not bind

(0)

W (0)

z*

z* h

Figure 4: Value function at a steady-state monetary equilibrium

order to acquire real balances that they spend to purchase CM goods. Buyers are willing to acquire those real
balances in order to purchase DM goods in following periods. We can now de…ne a steady-state equilibrium
as follows.
De…nition 2 A steady-state, monetary equilibrium with full depletion of real balances is a list, (N; z ? ; ; f

N
n gn=1 );

that solves (23), (25), (29)-(30), (31), and (37).
Provided that the condition for full depletion, (37), holds we construct a steady-state equilibrium as
follows. From (23) we determine the targeted real balances, z ? . We use (25) to compute the number of
periods it takes to reach the target, N . Given N and z ? the steady-state distribution of real balances is
obtained from (29)-(30). Finally, the value of money is obtained from (31).
Proposition 3 (Existence of steady-state monetary equilibria with full depletion.) If (37) holds,
then there exists a steady-state monetary equilibrium with full depletion. If ! 0 (h)

1 + r= then the equilib-

rium features N = 1, i.e., there is a degenerate distribution of buyers’real balances. If ! 0 (h) > 1 + r= then
the equilibrium features N

2, i.e., the distribution of buyers’ real balances is non-degenerate.

We now characterize equilibria with full depletion when the length of a period of time, denoted

, is

small. Such limits are relevant because search-theoretic models of monetary exchange are typically viewed
as models of high-frequency trade. The variables with a time dimension are r,
variables by

and we denote r = r ,

do not depend on

=

, and h. We index these

, and h = h . From (24) the targeted real balances, z ? ,

. At su¢ ciently high frequency,

< !0

1

1+

r

=h, any equilibrium features a non-

degenerate distribution of real balances. Moreover, when the length of a time interval becomes very small, the
geometric distribution of real balances converges to a truncated exponential distribution, F (z) ! 1
18

e

z
h

,

ω ' (h ) − 1

ω' (2h ) −1

N 3

N

2
N

1

Equilibria with
partial depletion

(LRW model)

h
v( y )

v( y) v( y)
3
2

Figure 5: Existence of equilibria with full depletion of real balances

and aggregate real balances tend to h 1

T

e

=

where T = z ? =h.12 These limits are analogous to the

ones of the continuous-time economy of Rocheteau, Weill, and Wong (2015).
In order to illustrate the discussion above, we parameterize the model along the lines of Lucas (2000)
and Lagos and Wright (2005). For now, take the unit of time to be a year. The rate of time preference
is r = 0:03. Adopt the following functional forms: v(y) = y and u(y) = y 1

a

=(1

a). Assume that the

total output in the CM is h, i.e., buyers always produce the full amount and they consume whatever is
in excess of their demand for real balances. This will make the calibration strategy identical to the one
in Lagos-Wright. Total output is
is L

z + h. Hence, the aggregate demand for money normalized by GDP

z=( z + h). In order to allow for in‡ation we assume a constant growth of the money supply by

injecting Mt+1

Mt = (

1)Mt at the beginning of each CM through lump-sum transfers to buyers only.

(See Section 6.3 for details.) Assuming N = 1 the buyer’s choice of real balances generalizes (24) as follows:
! 0 ( z ? ) = 1 + i= , where i is de…ned as 1 + i = (1 + r) . Under the functional forms above, the individual
demand for real balances is z = (1 + i= )

1=a

. Hence, the aggregate demand for money is

L=
Fixing

1
:
+ h(1 + i= )1=a

= 0:5, we …nd that the parameter values h = 1:91 and a = 0:15 …t the US money demand. Given

that h > 1 = v( y^) we verify that N = 1.
Now we change the unit of time from a year to a month by dividing r,

and h by 12.13 The stationary

1 2 In order to determine the limit of the distribution we denote t = n
< T and zt = th < z and we take the limit as
goes
to 0 and n is kept constant and equal to t.
1 3 By doing this scaling we obtain parameter values that are very close to the ones of the monthly model of Lagos and Wright
(2005, Table 3). They …nd = 0:033, a = 0:2, and h = 0:17 (using our own notations). Note that their method to pin down
CM output, based on a logarithmic utility function, is slightly di¤erent from ours.

19

equilibrium with constant money supply features N = 5 and full depletion, i.e., it takes 5 months for a buyer
to accumulate his targeted real balances assuming he does not receive any trading opportunity during these
5 months. The cumulative distribution of real balances is plotted in Figure 6. If the unit of time is reduced
to a week then the stationary equilibrium under a constant money supply features N = 17, as shown in
Figure 6.
CDF of Real Balances

1
Weekly
Monthly

0.9
0.8
0.7

F(z)

0.6
0.5
0.4
0.3
0.2
0.1
0
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

z

Figure 6: Distribution of real balances under the Lagos-Wright calibration: Monthly and weekly frequency

In order to illustrate how the choice of the unit of time matters quantitatively we redo the traditional
exercise of Lucas (2000) that consists in computing the welfare cost of 10% in‡ation as the fraction of total
consumption that agents would be willing to give up in order to have 0% in‡ation instead of 10%. At the
annual frequency this cost is about 1.6% of total consumption. If the unit of time is a month then the welfare
cost of in‡ation drops to 1.32% of total consumption. At weekly frequency it is 1.30% of total consumption.
The reason the cost of in‡ation is smaller when the unit of time is small is that the distribution is no longer
degenerate, since there is a possibility that agents receive a trading opportunity before they have time to
reach their targeted real balances. As a result, in‡ation through lump-sum transfers has now a positive
welfare e¤ect by providing risk sharing. This positive e¤ect is worth about 0.3% of total consumption. So,
by simply changing the unit of time from a year to a month, we introduce risk sharing considerations that
lower the cost of in‡ation by about 20%.

5

Money in the short run

We now study the short-run e¤ects of a money injection. Following LRW, we assume that an agent’s type
as buyer or seller is observable so that the monetary authority can transfer (

1)M , with

> 1, in a

lump-sum fashion to all buyers at the time they enter the CM of t = 0. The change in the money supply is
common knowledge among all agents.
As a benchmark, consider …rst equilibria with N = 1, i.e., the distribution of money holdings is degenerate
20

?
at the beginning of each period. From (11) and (17) the buyer’s demand for real balances, zt+1
, is determined

by the following Euler equation:
?
! 0 (zt+1
)

1 = Rt+1

1 +1

for all t

1:

(38)

Note that when the distribution of real balances is degenerate, N = 1, individual real balances, zt? , coincide
with aggregate real balances,
equilibrium is a solution, (

t

M . Using R1 = z1? =(

? 1
0 ; fzt gt=1 ),
0

?
M ) and Rt+1 = zt+1
=zt? for all t

0

to the following dynamic system with

M

=

z1? f [! 0 (z1? )

zt?

=

?
zt+1

0

1, a monetary

> 0:

1] + 1g

?
! 0 (zt+1
)

1 +1

(39)
for all t

1:

(40)

?
This system is solved recursively: fzt+1
g1
t=0 solves the di¤erence equation (40) and

0

is obtained from

(39).14 The di¤erence equation (40) has a unique positive …xed point, z ? , solving ! 0 (z ? ) = 1 + r= . Given
z ? we use (39) to obtain

0

= z ? = M . So the economy reaches its steady state in the CM of t = 0. Such a

steady state exists if ! 0 h < 1 + r= .
The short-run neutrality of money can be explained as follows. At the beginning of the CM of t = 0 there
is a measure 1

of buyers holding M and a measure

M while the latter hold (

holding 0. Following the transfer, the former hold

1)M . If the rate of return of money is R1 =

1= 0

keep their real balances at z ? , which is feasible since h > z ? . By market clearing,
1

=

0

= 1, both types want to
t

M = z ? , which implies

= z ? = M . So buyers with M hold onto their units of money (since the target in nominal terms is

M ) while buyers with (

1)M acquire M additional units from sellers.

Proposition 4 (Neutral money injections) Suppose the economy is initially at a steady state with N = 1
and consider a one-time money injection, (

1)M , via lump-sum transfers to buyers in the CM of t = 0.

There is an equilibrium such that the value of money adjusts instantly to its new steady-state value,
z ? = M , and Rt = 1 for all t

0

=

1.

In the rest of this section we focus on equilibria with N = 2, as it is the minimum heterogeneity needed
for money injections to have real e¤ects. The economy starts at a steady state at the beginning of t = 0.
Before entering the DM, there is a measure
and a measure 1

holding mh = z ? M=

of buyers holding m` = hM=

h + (1

)z ? units of money

)z ? . At the beginning of the CM of t = 0, after

h + (1

a round of DM trades, the distribution of money balances across buyers has three mass points: there is
a measure
(1

of buyers holding no money (the buyers who were matched in the previous DM), a measure

) holding m` and a measure (1

)2 holding mh . This distribution is illustrated in Figure 7.

We will distinguish small money injections that do not a¤ect the number of mass points in the distribution
of real balances from larger money injections such that the distribution Ft is degenerate at t = 1.
1 4 Note that Lagos-Wright models, like other monetary models, have multiple dynamic equilibria. There are a continuum of
in‡ationary equilibria such that the value of money decreases over time and converges asymptotically to 0. These equilibria
can be re…ned away by assigning a small commodity component to money. Depending on the curvature of ! there can also be
multiple equilibria that converge to the unique steady state, periodic equilibria, and chaotic dynamics. For details, see Lagos
and Wright (2003).

21

(γ −1)M

α (1 − α )

(γ −1)M

(1 − α ) 2

(γ −1)M

ml

0

Money holdings
(start of CM)

mh

Figure 7: Distribution of money holdings at the start of the CM of t = 0

5.1

Small injection

We consider …rst the case where

is close to 1. By continuity with respect to the steady state we conjecture
1 the distribution of real balances has two mass points, zt1 and

that at the beginning of every period t

zt? . The quantity zt1 corresponds to the real balances of the measure

of buyers who depleted their money

holdings in the previous DM. (The superscript "1" stands for the number of CMs since the buyer experienced
his last DM match.) It solves:
z11

= R1 h + (

zt1

= Rt h for all t

1)

0M

(41)

2:

(42)

According to (41) a buyer who enters the CM of t = 0 with no money supplies h units of labor, which yields
R1 h real balances at t = 1, and he receives a lump-sum transfer of money of size (
price

1

= R1

0.

1)M valued at the

According to (42) a buyer with depleted money holdings in the CM of t

1

full labor endowment in order to enter the next DM of t with Rt h real balances. The quantity
the real balances of the remaining 1

buyers who were unmatched in the DM of t

1 saves his
zt?

represents

1. We guess and verify

that those buyers were not constrained by their labor endowment and were able to reach their target, which
from (38) can be reexpressed as:
! 0 (zt? ) = 1 +

1 + r Rt
for all t
Rt

1.

(43)

Aggregate real balances are equal to the population-weighted average of zt1 and zt? :
t

M = zt1 + (1

)zt? for all t

1:

(44)

From (44) written at two consecutive dates we obtain the following system to solve for
0

zt1 + (1

M

=

)zt?

=

z11 + (1
)z1?
R1
1
?
zt+1 + (1
)zt+1
for all t
Rt+1
22

0

and fRt g+1
t=1 :
(45)

1:

(46)

This system is the analog of (39)-(40) for equilibria that feature N = 2. As before, it can also be solved
recursively. Equation (46) for all t
solution

fRt g+1
t=2

2 de…nes a …rst-order, non-linear di¤erence equation in Rt . Given a

we can use (46) at t = 1 and (45) to solve for (

The di¤erence equation (46) for t

0 ; R1 ).

2 has a unique positive and constant solution, Rt = 1. Hence, there

exists an equilibrium that becomes stationary starting at t = 2, with zt? = z ? , z 1 = h, and Rt = 1 for all
t

2. Next, from (46) evaluated at t = 1 and (45), the pair (
0

z11 + (1

M

=

)z1?

=

0 ; R1 )

z11 + (1
R1
h + (1

solves:
)z1?

(47)

)z ? :

(48)

Substituting z11 by its expression given by (41) and solving (47) for aggregate real balances at t = 1, we
obtain:
1

)z1?

R1 h + (1

M=

1

1

1

:

(49)

Aggregate real balances at t = 1 are a linear combination of the capitalized labor endowment, R1 h, of
buyers with depleted money balances and the targeted real balances, z1? , of all other buyers. The term
[1

(1

1

1= )]

is a multiplier arising from the fact that the transfer received by buyers is proportional

to aggregate real balances.
From (48) and (49) we determine the gross real rate of return of …at money from t = 0 to t = 1. It solves:
)z1?

R1 h + (1
1

1

1

= h + (1

)z ? :

The left side of (50) is increasing in R1 : it is equal to 0 when R1 = 0 and greater than
(because 1 >
R1 < 1 and

1

1
0

>

1.

(50)

h + (1

) z?

) when R1 = 1. Hence, there is a unique R1 solution to (50) and it is such that

In words, aggregate real balances at the beginning of t = 1 are increasing with the

rate of return of money, R1 , because the 1

unconstrained buyers have incentives to accumulate higher

real balances when the rate of return of money is high, and the

constrained buyers enjoy a higher rate of

return on their (constrained) savings. Suppose the rate of return of money stays at its steady-state value,
R1 = 1. The real balances of unconstrained buyers are equal to their steady-state value, z1? = z ? , while
the real balances of constrained buyers, z11 = h + (

1)

0M ,

are larger than their steady-state value, h,

which is inconsistent with an equilibrium where the economy returns to its steady state in the CM of t = 1.
Hence, the rate of return of money falls below one in order to clear the market by reducing the targeted real
balances of the unconstrained buyers.
Figure 8 illustrates the determination of the equilibrium value for R1 , denoted R1e , where the left side of
(50) is represented by the upward-sloping red curve. As
R1e decreases. Moreover, lim

#1

increases this curve shifts upward and, as a result,

R1 ( ) = 1. So despite prices being ‡exible and all agents having access to

the centralized market, the value of money does not adjust instantly to its new steady-state value and money
is not neutral in the short run.15
1 5 Results

are qualitatively similar if the money supply increases though transfers to all agents in the economy.

23

φ 1γ M
α h + (1 − α ) z *
1 − α (1 − γ − 1 )

steady-state level

αh + (1 − α ) z *

R1e

R1

1

Figure 8: Determination of R1

Given R1 the value of money at the time of the money injection is
1

0

=

1 =R1 .

Using the expression for

M given by (48):
0

=

h + (1
)z ?
:
R1 M

(51)

This ends our characterization of the solution to the dynamic system (39)-(40). The Appendix lists the
conditions for an equilibrium featuring two mass points at the beginning of each period. In the rest of the
section we describe additional properties of the equilibrium in terms of price and output e¤ects.
Short-run prices. Let

1

=

)z ? =M =

h + (1

1

denote the value of money at the initial steady

state. We determine the condition under which a small increase in
0,

above its initial steady-state value,

1,

above 1 raises the value of money at t = 0,

i.e., there is de‡ation in the short run. Since

0=

1

= 1=(R1 ),

it is equivalent to check the condition under which R1 < 1= . Di¤erentiating R1 de…ned in (50) with respect
to

we show that
dR1 =R1
d =

<
=1

1,

z ? ! 00 (z ? )
> ?
! 0 (z ? )
z

z?
h

( + r)

:

(52)

It can easily be checked from (43) that the inverse "long-run" elasticity of money demand, (dRt =Rt )=(dzt? =zt? ),
is proportional to the term

z ? ! 00 (z ? )=! 0 (z ? ). So if the long-run money demand is su¢ ciently inelastic, the

clearing of the money market in the CM of t = 0 requires a large fall in R1 . Given that

1

is pinned down

by its steady-state value, the large fall in R1 required to clear the market is achieved by an increase of

0

above its initial steady-state value.
Output and labor-supply e¤ects. The output levels in the DM of t = 1 are y`;1 = v
yh;1 = v

1

(

z1? )

<v

1

?

1

(z11 ) > v

1

(h) and

( z ). Hence, the money injection reduces the dispersion of output and consumption

24

levels across matches. Aggregate output is
Y1 = y`;1 + (1

)yh;1

Y ss = v

with a strict inequality if v is strictly convex. The 1

1

(h) + (1

)v

1

(z ? );

buyers who hold their targeted real balances make

smaller payments relative to the steady state, because R1 < 1, while the

buyers who depleted their money

holdings in the previous DM make larger payments because they bene…ted from lump-sum transfers. Total
real balances spent in the DM are the same as in the steady state, but output is higher due to the seller’s
convex cost, i.e., the drop in consumption for the richest buyers is smaller than the increase for the poorest
ones. Hence, DM aggregate output increases relative to its steady-state value, Y ss . We summarize these
results in Figure 9 by plotting the trajectories for aggregate real balances,

t

M , and DM output levels.

yh

z*

φ tγM

αh + (1 − α )z *

yl

h

3

2

1

0

Figure 9: E¤ects of a small money injection

Next, we turn to CM aggregate output, denoted Ht

R

ht (i)di, where ht (i) is the choice of h at time t

by buyer i. Summing the buyers’budget constraints in the CM of t = 0, (5), we …nd:
H0 = h + (1

)h0 (m` ) + (1

)2 h0 (mh );

(53)

with
+

h0 (m` )

=

z1?
R1

0 [m` + (

1)M ]

h0 (mh )

=

z1?
R1

0

[mh + (

1)M ]

(54)
+

:

(55)

The …rst term on the right side of (53) corresponds to the labor supply of the buyers with depleted money
holdings: those buyers supply their labor endowment. The second term corresponds to the labor supply of
buyers with m` units of money, h0 (m` ), and the third term is the labor supply of buyers with mh units of
25

money, h0 (mh ). From (54) and (55) buyers holding m` and mh accumulate their targeted real balances,
z1? =R1 , and their wealth is composed of their initial real balances and the real transfer of money. (We assume
that buyers who supply labor in the CM, h > 0, do not consume, c = 0.) By de…nition of the money holdings
at the initial steady state,
0M

=

= h=(R1 ) and

0 mh

= z ? =(R1 ). Moreover, aggregate real balances are

)z ? =( R1 ). Substituting these expressions into (54)-(55) and using (50) to express z1?

h + (1

as a function of

0 m`

and R1 , i.e.,
z1 =

[(1

) + ]

h + (1
1

)z ?

R1 h

;

(56)

we obtain the following individual labor supplies:
h0 (m` )

=

h0 (mh )

=

R1 ) + (1
)(z ?
(1
) R1

h (1
h f1
(1

h)

+

(57)

+

R1 g
:
) R1

(58)

From (57) and (58) individual labor supplies are decreasing in R1 =

1= 0

=

1= 0.

Moreover, when

R1 = 1 labor supplies are at their steady-state levels. Hence, when R1 < 1— the value of money at t = 0
is larger than the one at the initial steady state— aggregate CM output is larger than its steady-state value.
Conversely, when R1 > 1 it is lower than its steady-state value. So high CM output is associated with
de‡ation while low CM output is associated with in‡ation.
In summary, the

buyers with depleted money holdings have an inelastic labor supply, h. So all the

action in terms of output changes comes from the 1

buyers entering the CM with positive money holdings,

m` and mh . There are three e¤ects. First, there is a standard wealth e¤ect under quasi-linear preferences
according to which any change in the buyer’s wealth leads to a one-to-one change in the buyer’s labor supply
in the opposite direction. Buyers’wealth changes because they receive a lump-sum transfer of real balances
and because the value of money decreases by a factor

1= 0

= R1 relative to its initial steady-state value.

Second, buyers reduce their target, z1? , because of the lower rate of return of money, R1 , which tends to
reduce the labor supply. Third, the real value of the target in t = 0, z1? =R1 , is higher than its value in t = 1
due to in‡ation, which tends to raise the labor supply. When R1 = 1 these three e¤ects cancel out. If
R1 < 1, which happens when the money demand from unconstrained buyers is inelastic, then the third
e¤ect dominates and buyers holding m` and mh units of money supply more labor in the short run in order
to maintain their targeted real balances, thereby generating a fall in the price level.
We summarize the results of this section in the following proposition.
Proposition 5 (Small money injection.) Suppose the economy is initially at a steady state with N = 2.
A small, one-time money injection, (
1. It raises aggregate real balances,

1)M , in the CM of t = 0 has the following consequences:
0

M , above their steady-state value, and reduces the gross rate of

return of money, R1 , below one.

26

2. If (52) holds and

is close to 1, then

0

>

1,

i.e., there is de‡ation in the short run, and CM output

increases, H0 > H1 .
3. It generates a mean-preserving reduction in the distribution of real balances in the DM of t = 1, an
increase in aggregate DM output if v 00 > 0, and an increase in society’s welfare.
4. The economy returns to its steady state in the CM of t = 1.
So far we have considered increases in the money supply. The empirical evidence regarding monetary
shocks is often stated in terms of shocks that are contractionary. In the context of our model this means
< 1, i.e., the monetary authority withdraws (1

)M through lump-sum taxation. We assume that the

government can enforce the payment of taxes and 1

is not too large so that buyers with depleted money

balances can a¤ord the tax. The e¤ects of a contraction of the money supply are symmetric to the ones
described in Proposition 5.
Corollary 1 ("Price puzzle") Consider a one-time contraction of the money supply,
then

0

<

1,

< 1. If (52) holds,

i.e., there is in‡ation in the short run, and CM output decreases, H0 < H1 .

This …nding is consistent with the "price puzzle" from Eichenbaum (1992) according to which a contractionary shock to monetary policy raises the price level in the short run. Moreover, Christiano, Eichenbaum,
and Evans (1999, Section 4.4.3) document that a contractionary shock to M 1 leads output to fall during two
quarters and then to rise. In our model output falls in the CM and following DM and then rises back to its
steady-state value.
Proposition 5 is obtained under the assumption that money transfers were received by buyers only. It is
straightforward to show that parts 1, 3, and 4 of the proposition go through if both buyers and sellers receive
the lump-sum transfer. However, whether Part 2 of Proposition 5 holds or not depends on the measure of
sellers, . To see this, suppose now that both buyers and sellers receive a transfer equal to (

1)M=(1 + ).

We show in the Appendix that the one-time money injection reduces the rate of return of money, R1 < 1,
and generates short-run de‡ation,

0

>

1,

if and only if:

z ? ! 00 (z ? )
>h
! 0 (z ? )
z?

(1 + ) z ?
i
1+ 1
h

:

(59)

(r + )

Given that the right side of (59) is increasing in , it follows that a short-run de‡ation is less likely to occur
when the transfer goes to both buyers and sellers. In particular, if

= 1, there is an equal measure of buyers

and sellers, then the inequality never holds. So a one-time money injection can generate a de‡ation in the
short run provided that z ? is su¢ ciently inelastic with respect to R and the transfer is not diluted among a
too-large measure of sellers.
Next, we disentangle the e¤ects of money injections according to the recipients of the transfers. Suppose
that the transfer is only received by sellers or buyers holding m` or mh . Those agents are not constrained
by their endowments when choosing real balances in the CM. We show in the Appendix that R1 = 1, i.e.,
27

money is neutral. As long as money is not transferred to the buyers for whom h

h binds, then the money

injection has no real e¤ect. Suppose in contrast that the money injection happens through transfers to
buyers with depleted money balances. Such transfers require that the monetary authority can observe the
money holdings of buyers. Then, R1 < 1 and there is short-run de‡ation if and only if:
! 00 (z ? )z ?
>
! 0 (z ? )

1
:
(r + )

(60)

This condition is weaker than (59) or (52). So the "price puzzle" is more easily explained for money injections
that target the poorest agents and for such interventions non-neutralities are the largest.

5.2

Large injections

We now consider the case of a large money injection with the maintained assumption that lump-sum transfers
go to buyers only. We focus on equilibria where transfers are large enough so that even the buyers who enter
the CM of t = 0 with depleted money holdings can reach their target z1? solution to (43), i.e., the distribution
of real balances is degenerate. Such an equilibrium is a

and fRt g+1
t=1 solution to the dynamic system,

0

(39)-(40), where z11 = z1? . By the same reasoning as before, R1 is determined by (39) and (40) at t = 1 under
the condition that the economy has reached its steady state in the CM of t = 1:
z1? = h + (1

)z ? :

(61)

The right side of (61), z1? , tends to 0 as R1 approaches 0 and is equal to z ? when R1 = 1. Hence, (61)
determines a unique R1 < 1, which is independent of . Therefore, an increase in the size of the money
injection a¤ects current and future prices in the same proportion so as to keep their ratio,

1= 0,

constant.

As before, the money injection generates a mean-preserving decrease in the spread of the distribution of real
balances across buyers. Aggregate output in the DM of t = 1 is
Y1 = v

1

)z ?

h + (1

Y ss = v

1

(h) + (1

)v

1

(z ? ):

The ouput is independent of the size of the money injection, but is larger than the steady-state value provided
that v 00 > 0.
We need to check that the buyers who enter the CM of t = 0 with no money balances are not constrained
1

by their endowment of labor. This will be the case if R1 h + 1
R1 >

h + (1
h

)z ?

1

M > z1? , i.e.,

:

(62)

So an equilibrium with a degenerate distribution of real balances at t = 1 exists provided that the size of
the transfer is su¢ ciently large. Moreover, from (62) the rate of return of money is R1 >
money injections it is always the case that

0

<

1

. So for large

)z ? =M ; prices increase relative to their initial

h + (1

steady-state value. As a result, from (58), buyers holding mh do not supply any labor. Buyers holding no
money supply
h+
0 (0) =

z1?
R1

(

1)

0M

=

28

h (1

R1 ) + (1
(1
) R1

)z ?

:

(63)

+
From (57) and (63) both h+
0 (0) and h0 (m` ) decrease with R1 . Using that R1 > 1 it follows that aggregate

output in the CM of t = 0 is lower than its steady-state value.
Proposition 6 (Large money injection.) Suppose the economy is initially at a steady state with N = 2.
A large one-time money injection, (

1)M , in the CM of t = 0 such that (62) holds has the following

consequences:
1. It raises aggregate real balances,

M , above their steady-state value, and reduces the gross rate of

0

return of money, R1 , below one. Moreover,

0

<

1

and H0 < H1 .

2. The distribution of real balances is degenerate in the DM of t = 1 and DM aggregate output is higher
than its steady-state value if v 00 > 0.
3. The economy returns to its steady state in the CM of t = 1.

5.3

Long-lasting e¤ects of a one-time money injection

So far we have restricted our attention to equilibria with N = 2 because such equilibria generate simple,
one-period transitions to a steady state. We now consider steady states with N

3 and assume a small

injection of money so that the distribution of real balances preserves N mass points with probabilities given
by (29)-(30). We will focus on equilibria with full depletion.
?
An equilibrium can now be described as a sequence, f t ; (ztj ); zt+1
g+1
t=0 , solution to the following system

of di¤erence equations:

t

M

=

N
X1

j
j zt

+

?
N zt

j
j z0

+

N

for all t

1

(64)

j=1

0

M

=

N
X1
j=1

ztj

= Rt ztj

zt0

=

z0j

=

0

! 0 (zt? )

=

1+

1
1

+h

0 for all t
mj
1

z1?
R1

(65)

for all t

1 and j 2 f1; :::; N

1g

(66)

1

1

+(
Rt
:
Rt

(67)
1)M + h for all j 2 f1; :::; N

1g

(68)
(69)

Equation (64) de…nes aggregate real balances as the sum of individual real balances at the beginning of each
period t

1. The right side of (64) indexes buyers by the last time they had a DM encounter and depleted

their money balances. There is a measure
balances, with j
t

1,
N

ztj 11 ,

N

j

of buyers who entered the CM of t

j with depleted money

1. From (66) those buyers entered period t with real balances inherited from period

plus their labor endowment, h, capitalized at the rate of return of money, Rt . There is a measure

of buyers who have reached their target as de…ned in (69). Equation (65) de…nes aggregate real balances

in the CM of t = 0 where individual real balances, z0j , are obtained from the initial steady state according to
(68), and mj indicates the steady-state nominal money balances of a buyer who had a DM match j periods
29

8

x 10

-3

Inflation Rate (%)

7
6
5
4
3
2
1
0

2

4

6

8

10

12

14

16

18

20

t

Figure 10: Weekly in‡ation rate following a one-time 5% increase in the money supply

ago when the aggregate money supply was M . (The exact expression is provided in the Appendix.) The
transition to a steady state is long lived because the real balances of a buyer whose last match was in t
with j < N

1, depends on the sequence of past rates of return, Rt

j+1

to Rt .

In Figure 10 we provide a numerical example for the transitional dynamics of the in‡ation rate,
t 1= t

j,

t

=

1, following a one-time money injection. We take the same functional forms as in Section 4. If we

take the period of time to be a year, so that N = 1, then the value of money adjusts instantly to its steadystate value, i.e.,

1

=

0 =1:05

or, equivalently,

1

= 5%. For all following periods, t > 1,

t

= 0. In Figure

10 the unit of time is a week so that the laissez-faire steady-state equilibrium features a non-degenerate
distribution with N = 17 mass points. The transitional dynamics for a 5% increase in the money supply
di¤ers from the one at the yearly frequency in that in‡ation is persistent and the in‡ation rate returns to
0 only asymptotically. Numerically convergence to the steady state takes about N = 17 periods, which is
analogous to our analysis of equilibria with N = 2. The weekly in‡ation rate peaks initially at about 0.008%,
which is about 0.4% in‡ation annually. It falls in a monotonic fashion over the following 17 weeks. To sum
up, at a weekly frequency the e¤ect of a monetary shock on in‡ation is spread out across a large number of
periods and the pick of in‡ation is mild relative to an annual model.

6

Money and unemployment risk

So far we have considered an environment where the only idiosyncratic risk comes from the random matching
process in the decentralized goods market. We now extend the model to add idiosyncratic employment shocks
formalized as shocks on labor endowments, h 2 fhU ; hE g, with 0 < hU < hE .16 We can think of hE as

the income of the buyer who is employed in the CM and hU the income of a buyer who is unemployed in
1 6 The description of the employment shocks is analogous to the one in Algan, Challe, and Ragot (2011). We di¤er from this
model in that we consider an environment with search and bargaining where the idiosyncratic risk comes from both matching
opportunities in a decentralized market and employment shocks in a centralized market.

30

the CM. The transition from E (employment state) to U (unemployment state) occurs at the beginning
of a period with probability s (think of s as the separation rate) while the transition from U to E occurs
with probability f (think of f as the job …nding rate).17 We de…ne the unemployment rate as the fraction
of buyers in state U . This extension allows us to study how money injections a¤ect allocations and prices
depending on the equilibrium unemployment rate.

6.1

Equilibria with full depletion

We focus on equilibria with full depletion of real balances. We de…ne

n;m

as the measure of buyers who

went through n periods of employment (state E in the CM) and m periods of unemployment (state U in the
CM) since their last DM match, and whose current employment state upon entering the DM is

2 fE; U g.

These buyers hold nhE + mhU real balances. Let H = f(n; m) 2 N20 n(0; 0) : nhE + mhU < z ? g be the set
of employment histories, (n; m), for which buyers have not reached their target. The distribution of buyers
across states is de…ned recursively as follows:
E
n;m

=

U
n;m

= s

(1

s)

E
n 1;m

E
n 1;m

+f

+ (1

f)

U
n;m 1

(70)

U
n;m 1 ;

(71)

for all (n; m) 2 H and n; m > 0. According to (70) a buyer is in state (n; m; E) if: (i) he was in state
(n

1; m; E) in the past period, in which case he enjoyed an endowment of hE in his last CM, and he

remained employed with probability 1

s; (ii) he was in state (n; m

1; U ) in the past period, in which case

he enjoyed an endowment of hU in his last CM, and he became employed with probability f . Equation (71)
has a similar interpretation. If n = 0 or m = 0 we have:

where

E
1;0

=

(1

s)

E

;

U
0;1

=

(1

f)

U

,

is measure of agents in labor state

entering the DM in state E. A fraction

U
1;0
E
0;1

=s
=f

U

(73)
E

of buyers

of those buyers deplete their money holdings. In the following CM

they accumulate h and stay in state E with probability 1

s or they transition to state U with probability

s. Equation (73) has a similar interpretation. At the steady state 1
unemployed buyers is

(72)

2 fE; U g. According to (72) there is a measure

E

U

E

U

s=

U

f so that the measure of

= s=(s + f ). Hence,
E

=

f
;
s+f

U

=

s
:
s+f

(74)

Finally, the measures of buyers at the targeted real balances are given by:
E
z?
U
z?

=
=

f
s+f
s
s+f

1 7 The

X

E
n;m

(75)

U
n;m :

(76)

(n;m)2H

X

(n;m)2H

description of employment/unemployment is similar to the one in Ljungqvist and Sargent (1998) where wages are
drawn from an exogenous distribution.

31

Equations (70)-(76) de…ne the distribution of buyers across states, f
balances are:
M=

X

E
n;m

(

+

U
n;m )

n;m ;

n h E + mh U + (

E
z?

+

z ? g,

recursively. Aggregate real

U
?
z ? )z :

(77)

(n;m)2H

The value of money increases with the income in the two employment states, hE and hU ; it increases with
the job …nding rate, f ; and it decreases with the separation rate, s. So the value of money is negatively
correlated with the unemployment rate.
The marginal value of real balances for a buyer in state 2 fU; Eg solves
n
h
io
0
(z) =
! 0 z + h + (1
) (1
) (z + h ) +
(z + h ) ;

for all z
U

z?

hU ,

2 fU; Eg,

= f . For all z 2 [ z

?

0

?

h ; z ],

2 fU; Egnf g and where the transition probabilities are
(z) = 1. Using that

U

E

(z)

(78)
E

= s and

(z) for all z, the condition for full

depletion of real balances is
U

r

! 0 (z ? ) = 1 +

(0)

:

(79)

As before, this condition holds provided that agents are su¢ ciently impatient.

6.2

Simple equilibria with constrained unemployed

In order to simplify the analysis further, suppose now that employed buyers can reach the targeted real
balances in a single period while unemployed workers need two periods to accumulate z ? , i.e.,
hU < ! 0

1

1+

r

minf2hU ; hE g:

The marginal value of real balances for an employed buyer is

E

(z) = 1 for all z on the support of the

distribution. So employed buyers are similar to the agents in the Lagos-Wright model: their choice of real
balances is una¤ected by their labor endowment. From (78) the marginal value of real balances for an
unemployed buyer solves
U

(z) =

n

h
) f + (1

! 0 (z 0 ) + (1

f)

U

io
(z 0 ) ;

(80)

where z 0 = minfz + hU ; z ? g. The condition for full depletion of real balances, (79), can be reexpressed as
r

>

! 0 hU

! 0 (z ? ) :

(81)

So the endowment of the unemployed, hU , cannot be too low— in particular, it cannot be zero— since
otherwise the buyer would not want to deplete his money holdings in full when matched in the DM. From
(77) the steady-state aggregate real balances simplify to
M=

U

hU + 1

U

z?:

(82)

The value of money increases with the income of unemployed workers, hU , and decreases with the unemployment rate,

U 18

.

1 8 The

chanel through which unemployment a¤ects the value of money is di¤erent from the one in Berentsen, Menzio, and
Wright (2011) where hU is large enough to allow unemployed workers to accumulate z ? . In that model it is assumed that is
U , so that an increase in U reduces
an increasing function of aggregate employment, 1
and hence z ? .

32

Consider a small money injection through a lump-sum transfer to all buyers. Unemployed buyers who
had depleted their real balances in t = 0 enter the following period with z10 = R1 hU + (

1)

1M .

The

real balances of the unemployed buyer who depleted his money holdings in the last DM corresponds to
his income when unemployed times the rate of return of currency, R1 hU , plus the real transfer of money,
(

1)

1M .

This transfer is analogous to some unemployment insurance …nanced with a proportional tax

on money holdings. Following the same reasoning as above, the rate of return of money solves
U

R 1 hU + 1
1

U

1

U

z1?

1

U

=

hU + 1

U

z?:

(83)

Accordingly, the e¤ect of a money injection on the rate of return of money depends on the unemployment
rate as represented by

U

. If

U

is small, then money is almost neutral whereas if

U

is large a money

injection has real e¤ects.

6.3

Bene…cial in‡ation and unemployment risk

So far we have described a one-time, unanticipated change in the quantity of money.19 We now turn to the
case where the government implements a constant growth of the money supply by injecting Mt+1
(

1)Mt at the beginning of each CM, where

Mt =

is close to 1, through lump-sum transfers to buyers only.

We focus on steady-state equilibria where aggregate real balances are constant. The gross rate of return of
money is R =

1

. Generalizing (18) the marginal value of real balances solves
(z) =

n

! 0 (z 0 ) + (1

)E

0

o
(z 0 ) ;

where the expectation is with respect to the future employment state,
employment state, . At the target z = z 0 = z ? with

2 fU; Eg;
0

(84)

2 fU; Eg, conditional on the current

( z ? ) = 1 for all

2 fU; Eg. Hence, from (84) z ?

solves
! 0 (z ? ) = 1 +

:

Suppose …rst that hE > hU > z ? , which will be the case if ! 0 (hU ) < 1 + (

(85)
)=

. All buyers, irrespective

of their labor state, can accumulate their targeted real balances in a single CM ,as is the case in Berentsen,
Menzio, and Wright (2011). As
DM output, and welfare, W =

rises above one, aggregate real balances, Z
!(z ? )

t Mt

= z ? , CM and

z ? , decrease. Indeed, there is no trade-o¤ for monetary policy

between risk sharing and self insurance since there is no ex-post heterogeneity in terms of real balances.
Hence, monetary policy should only promote self insurance by raising the rate of return of currency.20
Proposition 7 (Constant money growth with degenerate distributions.) Consider a laissez-faire
equilibrium with

= 1 and hE > hU > z ? . An increase of

reduces aggregate real balances, output, and

social welfare.
1 9 More precisely, we have assumed that agents do not assign a positive probability to a change in the money supply ahead of
time. However, when the change in the money supply happens it is common knowledge.
2 0 In Berentsen, Menzio, and Wright (2011) in‡ation reduces …rm entry and hence can raise welfare in the presence of congestion
externality.

33

For the rest of the section we study equilibria where buyers in state E have enough endowment to reach
their target, hE > z ? , while buyers in state U need two rounds of CM to reach z ? , hU < z ? < 2hU . At the
beginning of each period the distribution of real balances has two mass points. There is a measure
buyers holding z`

1 U

h +(

1) t Mt

1.

U

of

Those unemployed buyers depleted their money holdings in the

previous DM, supplied their full labor endowment in the CM, and held onto the money transfer provided by
U

the government. There is a measure 1

of buyers holding their targeted real balances, z ? . Aggregate

real balances are
Z

t Mt

hU

U

=

1

+ (1

U

) t Mt + (1

)z ? :

(86)

Solving for Z we obtain:
U

Z=

1 U

U

h + (1
U (1

1

)z ?

1)

:

(87)

Aggregate real balances (and CM output) are a weighted average of the buyer’s labor endowment when
unemployed and his targeted real balances, where the weights vary with the money growth rate and the
U

unemployment rate. The term 1

1

(1

U

tional to aggregate real balances, is saved by the
holdings. As

increases the weight on h

U

1

)

is a multiplier according to which the transfer, proporbuyers who are unemployed and have depleted money

decreases, which tends to raise real balances, but the targeted

real balances decrease, which tends to reduce aggregate real balances. As the unemployment rate increases,
aggregate real balances decrease. From (87) the real balances of the poorest unemployed buyers, z` , are
1 U

h + (1

z` =

U

1

)(1
1+1

U

)z ?

U

:

(88)

If the unemployment rate is higher, then aggregate real balances are lower and the lump-sum transfer to
unemployed buyers with depleted real balances is lower, which reduces their real balances. Di¤erentiating
z` we obtain
dz`
d

U

= (1

) z?

hU > 0:

=1

while z ? decreases with . This e¤ect corresponds to the redistri-

For low in‡ation rates z` increases with

butional role of in‡ation. The overall e¤ect on aggregate real balances is given by:
@Z
@

= (1

U

)

U

z?

hU +

=1

1
:
! 00 (z ? )

A small in‡ation raises aggregate real balances if the following inequality holds:
! 00 (z ? )z ?
>
! 0 (z ? )
(r + )
If ! 0 is very elastic then a change in

z?
U

z?

:

hU

(89)

does not a¤ect buyers’ target much but it raises the real balances

of the poorest buyers by the amount of the lump-sum transfer. In this case a small increase in

generates

an increase in the mean of the distribution of real balances and a decrease in its dispersion. Hence, welfare
increases. Note also that condition (89) is more likely to hold when the unemployment rate is high since the
measure of buyers who are unable to reach the target increases with

34

U

.

We de…ne society’s welfare at a steady state with money growth rate
2 U

W =

[!(z` )

U

z` ] + (1

by

!(z ? )

)

z? :

(90)

The …rst term on the right side of (90) corresponds to matches between an unemployed buyer holding z`
U

and a seller. There is a measure
so the total number of matches is

of such buyers and each of them has a probability

2 U

of being matched,

. The second term of the welfare function corresponds to matches
U

between buyers holding their targeted real balances— there is a measure 1

of such buyers— and sellers.

We di¤erentiate W in the neighborhood of a constant money supply to obtain:
dW
d

U

= (1

)

2 U

! 0 (hU )

1

z?

r
! 00 (z ? )

hU +

=1

:

Hence, in‡ation is welfare improving if
! 00 (z ? )z ?
>
! 0 (z ? )
(r + )

z?

r
2 U

! 0 (hU )

1

z?

hU

:

A positive in‡ation rate is more likely to be optimal when the unemployment rate,

(91)
U

, is high or when the

labor income of the unemployed, hU , is low. Indeed, the risk sharing bene…ts of in‡ation are larger when
the income of the unemployed, hU , is far from their desired level of insurance, z ? , and when the measure of
buyers with low labor endowments,

U

, is large.

Proposition 8 (Optimal in‡ation and unemployment.) Consider a laissez-faire equilibrium with
?

E

1, z < h , and h

U

?

=

U

< z < 2h . Moreover, assume that the equilibrium features full depletion of money

holdings, i.e., (81) holds. Anticipated in‡ation through lump-sum transfers to buyers raises aggregate real
balances if (89) holds and it raises social welfare if (91) holds.

7

Conclusion

We constructed a tractable model of monetary exchange with alternating market structures— search-andbargaining and price taking— featuring a non-degenerate distribution of real balances that can be used to
study the short-run and long-run e¤ects of monetary policy. Our model admits the Lagos-Wright equilibria
with degenerate distribution of money holdings (conditional on types) as a special case. At high time
frequency, equilibria featuring nondegenerate distributions and ex-post heterogeneity are generic and respond
di¤erently to policy than equilibria with degenerate distributions. For instance, we showed that a one-time
injection of money in a centralized market with ‡exible prices leads to higher aggregate real balances in the
short run and changes in output levels (the sign of which depends on fundamentals). Hence, money is not
neutral in the short run despite ‡exible prices and perfect information. The e¤ects on the rate of return of
money and prices are non-monotone with the size of the money injection. If the long-run money demand
is su¢ ciently inelastic, an expansionary monetary shock generates de‡ation in the short run. We provided
examples where money non-neutralities are long lived. Finally, we studied a version of the model with both
random-matching risk and employment risk. We showed that a constant money growth rate can lead to
higher output and welfare if the unemployment rate is large and agents are su¢ ciently risk averse.
35

References
[1] Algan, Yann, Edouard Challe, and Lionel Ragot (2011). "Incomplete markets and the output-in‡ation
trade-o¤," Economic Theory 46, 55-84.
[2] Berentsen, Aleksander, Gabriele Camera, and Christopher Waller (2005). "The distribution of money
balances and the nonneutrality of money," International Economic Review, 46, 465-487.
[3] Berentsen, Aleksander., Guido Menzio, & Randall Wright (2011). "In‡ation and unemployment in the
long run," The American Economic Review, 371-398.
[4] Camera, Gabriele, and Dean Corbae (1999). "Money and price dispersion," International Economic
Review 40, 985-1008.
[5] Chiu, Jonathan, and Miguel Molico (2010). "Liquidity, redistribution, and the welfare cost of in‡ation,"
Journal of Monetary Economics 57, 428-438.
[6] Chiu, Jonathan, and Miguel Molico (2011). "Uncertainty, in‡ation, and welfare," Journal of Money,
Credit, and Banking, 43, 487-512.
[7] Chiu, Jonathan, and Miguel Molico (2014). "Short-run dynamics in a search-theoretic model of monetary
exchange," Working Paper.
[8] Christiano, Lawrence , Martin Eichenbaum, Charles Evans (1999). “What have we learned and to what
end?” in Handbook of Macroeconomics, ed. Michael Woodford and John D. Taylor.
[9] Coibion, Olivier, Yuriy Gorodnichenko, Lorenz Kueng and John Silvia (2012). "Innocent bystanders?
Monetary policy and inequality in the U.S.," Working Paper.
[10] Diamond, Peter and Joel Yellin (1985). "The distribution of inventory holdings in a pure exchange
barter search economy," Econometrica 53, 409-432.
[11] Doepke, Matthias, and Martin Schneider (2006). "In‡ation and the redistribution of nominal wealth,"
Journal of Political Economy 114, 1069-1097.
[12] Eichenbaum, Martin (1992) “Comment on interpreting the macroeconomic time series facts: The e¤ects
of monetary policy,” European Economic Review 36, 1001-1011.
[13] Faig, Miquel, and Zhe Li (2009). “The welfare costs of expected and unexpected in‡ation.” Journal of
Monetary Economics 56, 1004-1013.
[14] Green, Edward and Ruilin Zhou (1998). "A rudimentary random-matching model with divisible money
and prices," Journal of Economic Theory 81, 252–271.
[15] Jin, Gu, and Tao Zhu (2014). "Non neutrality of money in dispersion: Hume revisited," Working Paper.
36

[16] Lagos, Ricardo and Guillaume Rocheteau (2005). "In‡ation, output and welfare," International Economic Review 46, 495-522.
[17] Lagos, Ricardo and Randall Wright (2003). "Dynamics, cycles, and sunspot equilibria in ‘genuinely
dynamic, fundamentally disaggregative’models of money," Journal of Economic Theory 109, 156–171.
[18] Lagos, Ricardo and Randall Wright (2005). "A uni…ed framework for monetary theory and policy
analysis," Journal of Political Economy 113, 463–484.
[19] Ljungqvist, Lars, and Thomas Sargent (1998). "The European unemployment dilemma," Journal of
Political Economy 106, 514-550.
[20] Lucas Jr, Robert E (2000). "In‡ation and welfare," Econometrica 68, 247-274.
[21] Menzio, Guido, Shouyong Shi, and Hongfei Sun (2013), "Monetary theory with non-degenerate distributions", Journal of Economic Theory 148, 2266-2312.
[22] Milgrom, Paul, and Segal, Ilya (2002), "Envelope Theorems for arbitrary choice sets", Econometrica
70, 583-601.
[23] Molico, Miguel (2006). "The distribution of money and prices in search equilibrium," International
Economic Review 47, 701-722.
[24] Rincoón-Zapatero, Juan Pablo and Santos, Manuel (2009). "Di¤erentiability of the Value Function
without Interiority Assumptions," Journal of Economic Theory, 144, 1948-1964.
[25] Rockafellar, Ralph Tyrell (1970). "Convex Analysis," Princeton University Press.
[26] Rocheteau, Guillaume, Pierre-Olivier Weill, and Tsz-Nga Wong (2015). "A tractable model of monetary
exchange with ex-post heterogeneity," NBER Working Paper 21179.
[27] Rocheteau, Guillaume, and Randall Wright (2005). "Money in search equilibrium, in competitive equilibrium, and in competitive search equilibrium," Econometrica 73, 175-202.
[28] Scheinkman, Jose, and Laurence Weiss (1986). "Borrowing constraints and aggregate economic activity",
Econometrica 54, 23-45.
[29] Shi, Shouyong (1995). "Money and prices: A model of search and bargaining," Journal of Economic
Theory 67, 467–496.
[30] Stokey, Nancy, Robert Lucas, and Edward Prescott (1989). Recursive Methods in Economic Dynamics.
Cambridge, Harvard University Press.
[31] Sun, Hongfei (2012). "Monetary and …scal policies in a heterogeneous-agent economy," Working Paper.

37

[32] Trejos, Alberto and Randall Wright (1995). "Search, bargaining, money, and prices," Journal of Political
Economy 103, 118–141.
[33] Wallace, Neil (1997). "Short-run and long-run e¤ects of changes in money in a random-matching model,"
Journal of Political Economy 105, 1293-1307.
[34] Williamson, Stephen (2006). "Search, limited participation, and monetary policy," International Economic Review 47, 107-128.
[35] Zhou, Ruilin (1999). "Individual and aggregate real balances in a random-matching model," International Economic Review 40, 1009-1038.
[36] Zhu, Tao (2005). "Existence of a monetary steady state in a matching model: Divisible money", Journal
of Economic Theory 123, 135-160.
[37] Zhu, Tao (2008). "An overlapping-generations model with search," Journal of Economic Theory 142,
318-331.

38

Appendix A1: Proofs of Propositions 1 and 2
This appendix provides a detailed analysis of the buyer’s dynamic programming problem, leading to the
results summarized in Propositions 1 and 2.
A.1.1. Elementary Properties of Value Functions
Consider the pair of Bellman equations, for all t 2 f0; 1; 2; : : :g:
Vt (z)

=

Wt (z)

=

sup f [!(p) + Wt (z

p)] + (1

sup minfc; cg + h

h + Vt+1 (z 0 )

z 0 ;h;c

)Wt (z)g

(92)
(93)

First, we substitute the Bellman equation for Vt (z) into the Bellman equation for Wt (z). Formally:
Lemma 1 The functions Wt (z) and Vt (z) solve the Bellman equations (92)-(93) if and only if
Wt (z) = max minfc; cg + h
with respect to c

0, 0

h

[!(p) + Wt+1 (z 0

h+

h, z 0 = Rt+1 (z

c + h), and 0

p)] + (1

p

)Wt+1 (z 0 ) :

z0.

Next, we apply standard contraction-mapping arguments to this Bellman equation. We obtain:
Lemma 2 The Bellman equations (92)-(93) have unique bounded solutions, Vt (z) and Wt (z). The functions
Vt (z) and Wt (z) are continuous, concave, strictly increasing, and they satisfy
kW k

c+h+
1

Proof. Consider the space C (N

k!k

and kV k

c + h + k!k
:
1

R+ ) of bounded and continuous functions from N R+ to R, equipped

with the sup norm. By Theorem 3.1 in Stokey, Lucas, and Edward Prescott (1989, henceforth SLP), this is
a complete metric space. Now, for any f 2 C (N
T [f ]t (z) = max minfc; cg + h
with respect to c

0, 0

h

h+

h, z 0 = Rt+1 (z

R+ ), consider the Bellman operator:
[!(p) + ft+1 (z 0

c + h), and 0

p

)ft+1 (z 0 )

p)] + (1

z 0 . It is straightforward to verify that T

satis…es the Blackwell su¢ cient condition for a contraction (Theorem 3.3 in SLP). Moreover, the constraint
set is non-empty, compact valued, and continuous. Hence by the Theorem of the Maximum (Theorem 3.6
in SLP), we obtain that T [f ] is continuous. It is clearly bounded since all the functions on the right-hand
side of the Bellman equation are bounded. Note as well that if f is concave, then T [f ] is also concave
since the objective is concave and the constraint correspondence has a convex graph. An application of the
Contraction Mapping Theorem (Theorem 3.2 in SLP) implies that the …xed point problem f = T [f ] has a
unique bounded solution, Wt (z), and that this solution is continuous and concave.
Also, consider any two z1 and some feasible c1 ; h1 ; z10 ; p1 . Then, for z2
feasible: c2 = c1 + z2
consume z2

z1 , h2 = h1 ,

z20

=

z10

z1 , the following choice is

and p2 = p1 . That is, a buyer starting with z2 can always

z1 and otherwise behave as if he started with z1 . Since this yield (weakly) higher utility
39

this implies that T [W ]t (z) = Wt (z) is increasing. Hence, the bounded solution of the Bellman equation is
increasing. One also sees that it must be, in fact, strictly increasing. Indeed, a buyer starting at z2 > z1
can wait to use z2

z1 in order to pay for more consumption in the DM, in which he receives a match with

strictly positive probability. Since !(p) is strictly increasing, this implies that T [W ]t (z) = Wt (z) is strictly
increasing.
Given a …xed point Wt (z) of the Bellman operator T , we can de…ne Vt (z) as in equation (92). By identical
arguments as above, one sees that Vt (z) is bounded, continuous, concave, and strictly increasing.
Finally, we can derive upper bounds for Wt (z) and Vt (z). From the Bellman equation we have:
kW k

c+h+

[k!k + kW k] + (1

)kW k ) kW k

c+h+
1

k!k

:

We obtain the bound on kV k following identical arguments but for Vt (z).
For the rest of this section, we slightly simplify the Bellman equation by reducing the number of optimizing
variables. To do so, we …rst note that, since Wt (z) is strictly increasing, it is strictly suboptimal for a buyer
to choose c > c: the buyer can instead reduce consumption, with no loss of utility, and choose higher savings
z 0 . Hence, in the objective of the Bellman equation, we can replace minfc; cg + h

h by h + c

h: hence, the

0

objective only depend on the di¤erence c h. The law of motion of z implies in turn that c h = z z 0 =Rt+1 .
Substituting this expression in the objective, and keeping in mind that 0

h

h and 0

c

c, we can

rewrite the Bellman equation as:
Wt (z) = max z

z0
+h+
Rt+1

[!(p) + Wt+1 (z 0

with respect to z 0 and p and subject to Rt+1 (z

z0

c)

p)] + (1

Rt+1 z + h and 0

)Wt+1 (z 0 ) :
p

(94)

z0.

It will be sometimes convenient to rewrite this equation di¤erently, using the indirect utility for real
balance in the DM as:
t (z)

= max f!(p) + Wt (z
0 p z

p)g :

(95)

With this new notation, the Bellman equation becomes:
Wt (z) = max z
with respect to z 0

z0
+h+
Rt+1

0 and subject to Rt+1 (z

t+1 (z

z0

c)

0

) + (1

)Wt+1 (z 0 ) :

(96)

Rt+1 z + h .

A.1.2. Elementary properties of decision rules
We …rst consider the problem of a buyer in the DM, (95).
Lemma 3 The buyer’s problem in the DM has a unique solution, pt (z). This solution is continuous, increasing, satis…es limz!0 pt (z) = 0 and limz!1 pt (z) = 1. The value of the buyer in the DM,
continuous, strictly increasing, concave, and satis…es

0 +
t (z )

t (z),

is

! 0 [pt (z)].

Proof. Note …rst that this problem is strictly concave since we have assumed that !(p) is strictly concave.
Hence, it has a unique solution, which we denote by pt (z). Together with the Theorem of the Maximum (SLP
40

Theorem 3.6), uniqueness implies that pt (z) is continuous. To show that pt (z) is increasing, consider any
two z1 < z2 . If pt (z2 )

z1 , then by feasibility it immediately follows that pt (z1 )

z1

pt (z2 ). Otherwise,

if pt (z2 ) < z1 , then a …rst-order condition for z2 is that
! 0 [pt (z2 )]

Wt0 z2

pt (z2 )+ ;

where we recall that Wt+1 (z) is concave and so it has left- and right-derivatives for all z > 0. By concavity
0
we also have that Wt+1
(z + ) is decreasing, which implies from the above equation that:

! 0 [pt (z2 )]
so pt (z1 )

0
z1
Wt+1

pt (z2 )+ ;

pt (z2 ).

Because of the feasibility constraint, 0

p

z, it immediately follows that limz!0 p(z) = 0. Suppose

that p(z) is bounded away from in…nity. Then the …rst-order condition ! 0 (p)

Wt [(z

p) ] cannot hold

for z large enough because Wt (z) must satisfy Inada condition at in…nity. Indeed, since Wt (z) is bounded,
W 0 (z )z

increasing, and concave, we have 0
The value

t (z)

Wt (z)

Wt (0)

kW k, so that limz!1 W 0 (z ) = 0.

is continuous by the Theorem of the Maximum. It is strictly increasing because Wt (z)

is strictly increasing: a buyer can always keep any additional unit of cash for the next CM, which increases
his utility strictly. To establish the lower bound on the right derivative, we note that, pt (z) is feasible for
any z 0

z. This implies that, for all z 0
t (z

0

)

z:
! [pt (z) + z 0

z] + Wt+1 [z 0

pt (z)] ;

with equality if z = z 0 . The result follows by subtracting the equality for z = z 0 to the above inequality,
dividing by z 0

z, and letting z 0 ! z + .

To solve for an optimal money holdings decision, we proceed as follows. We de…ne
?
Zt+1
= arg max

with respect to z 0

z0
+h+
Rt+1

[!(p) + Wt+1 (z 0

p)] + (1

)Wt+1 (z 0 ) ;

?
is the set of optimal money holdings, if the buyer has no labor
0. In other words, Zt+1

?
constraints and no satiation point for consumption. As we show below, the set Zt+1
represent the set of

“targeted" money holding for the buyer.
?
?
?
Lemma 4 The set Zt+1
is convex, bounded above, and bounded away from zero. Given any zt+1
2 Zt+1
, an

optimal money holdings decision for the buyer at time t is:
z 0 = max Rt+1 (z

?
c); min Rt+1 (z + h); zt+1

(97)

?
Proof. The set Zt+1
is bounded above because both !(z) and Wt+1 (z) are concave and bounded,

implying that they satisfy Inada condition at in…nity. To see that it is bounded away from zero, recall
that

0
t+1 (z)

that limz!0

! 0 [p(z)] and limz!0 p(z) = 0. Since !(p) satis…es an Inada condition at zero, it follows
t+1 (z

+

) = 1. This implies that, near zero, the right-derivative of the optimization program
41

?
?
de…ning Zt+1
are strictly positive. Hence 0 < min Zt+1
. The rest of the proposition follows because the
?
optimization program de…ning Zt+1
is concave.

The optimal rule for next period money holdings is to approach the target as closely as possible, keeping
labor below the endowment, h, and consumption below the satiation point, c. Hence, for low values of z, the
buyer approaches the target by working full time, and arrives next period with real balance z 0 = Rt+1 z + h .
For large enough values of z, the buyer approaches the target by consuming up to its satiation point c, and
arrive next period with real balance z 0 = Rt+1 (z

c). For values of z in some middle range, near the target,

the buyer can reach the target in one period, either by working less than h or consuming less than c.
Lemma 5 The derivative of the value function is bounded, W 0 (0+ ) < 1.
?
?
Proof. Choose any zt+1
2 Zt+1
and consider the following two cases.
?
If zt+1
0

z =

?
zt+1
.

Rt+1 h then, for all z > 0 and close enough to zero, an optimal choice of money holdings is
Substituting this into the Bellman equation, we obtain:
?
zt+1
+
Rt+1

Wt (z) = z

?
t+1 (zt+1 )

?
)Wt+1 (zt+1
);

+ (1

which immediately implies that Wt0 (0+ ) = 1.
?
If zt+1
> Rt+1 h then for all z > 0 and close enough to zero, an optimal choice of money holdings is

z 0 = Rt+1 z + h . Substituting this in the Bellman equation we obtain:
Wt (z) =

h+

t+1

Rt+1 z + h

+ (1

)Wt+1 Rt+1 z + h

Since Rt+1 > 0, z 0 = Rt+1 h lies in the interior of the domain of

t+1 (z

0

:

) and Wt+1 (z 0 ). Given that these

functions are concave, they have right-derivative at this interior point. Hence, Wt (z) has a right-derivative
at zero, i.e., Wt0 (0+ ) < 1.
With this result we establish:
Lemma 6 For all z > 0, the optimal payment in the DM is strictly positive: pt (z) > 0. Moreover, the
indirect utility of bringing z units of real balances in the DM,
(0; 1) with

0
t (z)

t (z),

is continuously di¤ erentiable over

= ! 0 [pt (z)].

Proof. The …rst point follows from the fact, shown in Lemma 5, that Wt+1 (0+ ) < 1 but ! 0 (0) = 1.
For the second point consider some z > 0. Since pt (z) > 0, pt (z)

(z

z 0 ) is feasible for z 0 < z and close

enough to z. Therefore, for such z 0 , we have
t (z

0

)

! [pt (z)

(z

z 0 )] + Wt [z

pt (z)] ;

with an equality for z = z 0 . Subtracting the inequality for z 0 < z to the equality for z 0 = z, and dividing
through by z

z 0 , we obtain:
t (z)

z

t (z
0
z

0

)

! [pt (z)]

42

! [pt (z)
z z0

(z

z 0 )]

:

Letting z 0 ! z, we obtain
! 0 [pt (z)], and since

t (z)

0
t (z

)

! 0 [pt (z)]. Since we have already shown in Lemma 3 that

is concave, we obtain that, for all z > 0,

t (z)

is di¤erentiable with

t (z

+

)

0
t (z)

=

0

! [pt (z)].
A.1.3: Di¤erentiability of the value function
In this section we establish the di¤erentiability of the value function and provide an explicit formula for the
derivative. The main di¢ culty we confront is that the Envelope Theorem of Benveniste and Scheinkman
does not apply to our environment, because it requires optimal choices to lie in the interior of the constraint
set –in contrast, in our setting, the labor endowment constraint may bind. To address this di¢ culty, RincónZapatero and Santos (2009) have established an Envelope Theorem for a broad class of stationary dynamic
optimization problems in which optimal choices may not lie in the interior of the constraint set, but must lie
in the interior of the state space. In this section, we apply their results to our environment and we establish
di¤erentiability. The application is not immediate however, because two of their maintained assumptions are
violated in our environment. First, our environment is non-stationary, since Rt+1 is not constant over time.
Second, some optimal choices may not lie in the interior of the state space: namely, when a buyer chooses
to deplete its money holding in full in the DM, he enters the following CM with zero money balance.
Maintained assumptions about returns. We will need two make assumptions on the path of grossreturns:
(A1) There exists some R > 0 such that, for all t
(A2)

P1

i=1

i

(1

)i

1

i
j=1 Ri

0, Rt+1 > R.

< 1.

The …rst assumption rules out hyper-in‡ationary dynamics and the second assumption helps with the
proof that the expected present value of marginal utilities from real balance is …nite –as required to apply the
argument of Rincón-Zapatero and Santos (2009). Note that both assumptions are veri…ed for the transitional
dynamics we analyze in the paper, whereby Rt ! 1 as t ! 1.
Bounds on decision variables Next, we establish bounds on decision variables.
Lemma 7 The DM payment satis…es pt (z)

p^(z) for some time-invariant function, p^(z), which is contin-

uous, strictly increasing, and satis…es p^(0) = 0 as well as 0 < p^(z)

z for all z > 0.

Proof. Suppose that pt (z) < z. Since there is partial depletion, the …rst-order condition for the DM
problem is
! 0 [pt (z)] = W 0 z
Consider now the equation (z

pt (z)+

z

kW k
) [z
pt (z)

pt (z)] ! 0 [pt (z)]

kW k:

(98)

p)! 0 (p) = kW k for z > 0. The left hand side is continuous and strictly

decreasing in p, goes to in…nity as p ! 0 and to zero as p ! z. Hence, the equation has a unique solution
p^(z), which satis…es 0 < p^(z) < z. Since the equation has a unique solution and is continuous in (z; p), the
43

function p^(z) is continuous as well. Since 0 < p^(z) < z, we can extend the function by continuity at z = 0
by setting p^(0) = 0.
Clearly, when pt (z) < z, the inequality (98) implies that pt (z)

p^(z) for all t. When pt (z) = z, this

inequality is also satis…ed since p^(z) < z.
The second preliminary result is:
Lemma 8 For all t

n
0, optimal money holdings are bounded below by z = min Rh; (! 0 )

1

R

Proof. A …rst-order condition for an optimal choice of target is:
1
Rt+1

! 0 [pt+1 (z)] + (1

+

)Wt+1 z +
! 0 [pt+1 (z)]

Since the value function is increasing, this implies that
obtain that

! 0 (z)

1

o
.

0:
1=Rt+1 . Since z

pt+1 (z), we

1=Rt+1 . Since ! 0 (z) is decreasing, this implies:
z

(! 0 )

1
Rt+1

1

(! 0 )

1
R

1

?
for all z 2 Zt+1
:

The result then follows from the policy function for optimal money holdings, in equation (97).
The main proposition. We now can state our di¤erentiability result:
Proposition 9 The value function is continuously di¤ erentiable, with:
Wt0 (z) =

1
X

i

)i

(1

1

i
j=1 Rt+j

! 0 [pt+i (zt+i )] ;

i=1

where zt+i is a sequence of optimal money holdings starting starting from zt = z.
Proof. We …rst use the Envelope Theorem stated in Corollary 5 of Milgrom and Segal (2002), which
applies to optimization problems with parameterized constraints. To see that all the conditions are satis…ed,
we …rst note that, given Rt+1 > 0, there exists a single z 0

0 and a neighborhood of z such that, for all real

balances in this neighborhood, z 0 lies in the interior of the constraint set. Note as well that the the objective
function and the function de…ning the constraint are continuous and concave, and have partial derivatives
with respect to z which are continuous in (z; z 0 ). Let the Lagrangian associated with the optimization
problem (96) is:
L(z; z 0 ; )

z0
+
Rt+1
Rt+1 z + h

= z
+

where

denote the vector ( ; ). Let

?

t+1 (z

0

)Wt+1 (z 0 )

) + (1

z 0 + [z 0

Rt+1 (z

c)] :

denote the set of Kuhn-Tucker multipliers and

?

denote the set of

optima associated with this optimization problem. These sets are non empty and compact under the stated
conditions. Then by the above mentioned Envelope Theorem, we have:
0 : Wt0 (z + )

=

for all z > 0 : Wt0 (z )

=

for all z

@L
(z; z 0 ; ) = min? 1 + Rt+1
2
@z
@L
(z; z 0 ; ) = max? 1 + Rt+1
max? min
z 0 2 ? @z
2
2
min? max
0
?
2

(99)

z 2

44

:

(100)

By taking derivative of the Lagrangian with respect to z 0 , we can obtain natural bounds for the Kuhn-Tucker
multipliers entering the above expression for the left- and right-derivatives. Namely, …x some optimal money
holdings zt+1 2
2

?

?

. Then, by Theorem 28.3 in Rockafellar (1970), we know that any Kuhn-Tucker multipliers

must satisfy:
@L
+
(z; zt+1
; )
@z 0

0

@L
(z; zt+1 ; ):
@z 0

Taking derivatives explicitly and rearranging the resulting …rst-order condition, we obtain that for any
2

?

:
1
+
Rt+1
1
+
Rt+1

! 0 [pt+1 (zt+1 )] + (1

+
0
)Wt+1
(zt+1
)

! 0 [pt+1 (zt+1 )] + (1

0
)Wt+1
(zt+1 ):

Plugging this back into the expression for Wt0 (z + ) and Wt0 (z ), we obtain the inequalities:
0 : Wt0 (z + )

Rt+1 ! 0 [pt+1 (zt+1 )] + (1

+
0
)Rt+1 Wt+1
(zt+1
)

for all z > 0 : Wt0 (z )

Rt+1 ! 0 [pt+1 (zt+1 )] + (1

0
)Rt+1 Wt+1
(zt+1 ):

for all z

Iterating forward, we obtain:
for all z

I
X

0 : Wt0 (z + )

i

(1

)i

1

i
j=1 Rt+i

! 0 [pt+i (zt+i )] +

I

(1

)I

I
i=1 Rt+i

+
0
Wt+1
(zt+I
)

i

(1

)i

1

i
j=1 Rt+i

! 0 [pt+i (zt+i )] +

I

(1

)I

I
i=1 Rt+i

0
Wt+1
(zt+I );

i=1

I
X

for all z > 0 : Wt0 (z )

i=1

where zt+i denote some sequence of optimal money holdings decisions generated by (97) starting starting
from zt = z. From Lemma 8, we know that optimal money holdings are bounded below by . By Lemma 7,
this implies that optimal payments in the DM are bounded below by p^( ). This implies the upper bounds
! 0 [p(zt+i )]

0
(zt+I )
k!k=^
p( ) and Wt+I

kW k= . Together with assumption (A2) stated at the beginning

of the section, these upper bound allow us to take limits as I ! 1 in the above expressions, and we obtain:
for all z

0 : Wt0 (z + )

1
X

i

(1

)i

1

i
j=1 Rt+i

! 0 [pt+i (zt+i )]

i

(1

)i

1

i
j=1 Rt+i

! 0 [pt+i (zt+i )] :

i=1

for all z > 0 : Wt0 (z )

1
X
i=1

Given that Wt0 (z + )

Wt0 (z ), this implies that Wt (z) is di¤erentiable at z, and that the derivative is as

stated in the Proposition. The derivative is continuous by Theorem 24.1 in Rockafeller (1970).

45

Appendix A2: Conditions for equilibria in Section 5
Equilibria with N = 2 From (25) and (30) steady-state equilibria with N = 2 exist if
! 0 (2h)

1+

r

< !0 h

1+r

1+

1+

r

:

(101)

First, we check that z11 < z1? . From (41)
1

R1 h + 1
As

)z ? < z1? :

h + (1

(102)

approaches 1 the left side tends to h while the right side tends to z ? . Hence, by continuity (102) holds

for low values of . Substituting z1? by its expression given by (56) this condition can be rewritten as:
h + (1
h

R1 <

)z ?

:

(103)

According to (103) the ex-post rate of return of money at time t = 0, R0 = 1=(R1 ), must be above a
threshold less than one. Second, we check that buyers holding m` units of money at the beginning of the CM
of t = 0 (before transfers) can accumulate z1? , i.e., h+
0 (m` )

h. From (57) this condition can be rewritten

as:
)(z ?

(1
The right side tends to (1
of

)h as

h)

( R1

) h:

(104)

goes to 1. Hence, under the condition z ?

close to 1. Finally, we check that the 1

2h, (104) holds for values

measure of agents with money balances at the beginning of

the CM of t = 1 can accumulate z ? since z11 > h. Indeed, from the clearing condition of the money market,
z11 + (1

) z1? = h + (1

) z ? , i.e.,
z11

1

h=

(z ?

z1? ) > 0:

Equilibria with N

3 In order to guarantee that we have an equilibrium we check that h

the buyer of type N

1 but not for the type N . These conditions can be written as
N
tm

1 t

< zt?

h

t
X

t

n=1

h

N
X1
n=1

(

1) t M

N t
,
tm

t n

t

< zt?

h

t n

N
X

n=1

t
t n

, 8t

8t

N

N;

1

h binds for

(105)

(106)

where
mj = j

h f1

)N 1

(1

[(N

hM
1) + 1]g + (1

)N

1z?

:

(107)

We must also check that buyers have incentives to deplete their money holdings in full at all point in
time, i.e.,
1+

1

Rt
Rt

t (0)

46

for all t;

(108)

where, from (18),
t (0)

=

N
X1

n 1 n

(1

)

!

0

t

n=1

+(1

t+n

)N

1 N 1

t+N 1
t

47

"
:

h

n
X

u=1

t+n
t+n u

#
(109)

Appendix A3: Directed vs undirected transfers
Proposition 10 (Undirected transfers.) A one-time money injection, (

1)M , through lump-sum

transfers to both buyers and sellers reduces the rate of return of money, R1 < 1, and it generates short-run
de‡ation,

0

>

1,

if and only if:
z ? ! 00 (z ? )
>h
! 0 (z ? )
z?

(1 + ) z ?
i
h
1+ 1

:

(110)

(r + )

Proof. The real balances at the beginning of t = 1 of the buyers holding m = 0 at the time of the money
injection are
z11 = R1 h + (

1)

1

M
:
1+

(111)

The only di¤erence with respect to (41) is the second term on the right side where M is replaced with
M=(1 + ). Buyers holding m` and mh accumulate z1? solution to (43). Aggregate real balances at the
beginning of t = 1 are

1

M = z11 + (1

) z1? . Assuming that the economy returns to its steady state in

the CM of t = 1 we have:
1

M=

1

R1 h + (1
)z1?
= h + (1
1
(1
) =(1 + )

)z ? :

(112)

The last term on the right corresponds to aggregate real balances at the steady state. The rest of the proof
is analogous to the reasoning in the text.
Proposition 11 (Directed transfers.) A one-time money injection, (

1)M , through transfers to sellers

or buyers holding m` or mh is neutral, i.e., R1 = 1. In contrast, if money is only received by the buyers with
depleted money holdings, then R1 < 1 and short-run de‡ation,
! 00 (z ? )z ?
>
! 0 (z ? )

0

>

1,

occurs if and only if:

1
:
(r + )

(113)

Proof. Suppose that the transfer is only received by sellers or buyers holding m` or mh . Those agents
are not constrained by their endowments when choosing real balances in the CM. In this case the rate of
return of money in the short run is determined by:
R1 h + (1

)z1? = h + (1

)z ? :

Relative to (49) the denominator of the left side is equal to one because the poorest buyers with depleted
money balances do not receive any money. It is easy to check that R1 = 1. Let us consider next a
money injections through transfers to buyers with depleted money balances. Such transfers require that the
monetary authority can observe the money holdings of buyers. Each one of the
balances at the beginning of the CM receives (

1)M= . The rate of return of money in the short-run

solves:
R1 h + (1

buyers with depleted money

) z1 = h + (1

)z ? :

It is easy to check that R1 < 1. Di¤erentiating this equation leads to (113).
48

Appendix A4: Map of equilibria
In the following we illustrate the set of equilibria for our economy for di¤erent values for h, r, and . We
p
adopt the following functional forms: u(y) = 2 y and v(y) = y. In Figure 11 we set r = 0:04. The colored
area corresponds to equilibria with full depletion of real balances. The white area is when the equilibrium
features partial depletion. Equilibria with full depletion exist when h is above a threshold. Moreover, as h
increases N decreases since buyers can reach their targeted real balances in a smaller number of periods.

Figure 11: Typology of equilibria with full depletion in the (h; ) space

In Figure 12 we allow r to vary and we set

= 0:1. This …gure is analogous to 5. For a given labor

endowment N decreases as r decreases since more patient buyers have higher targeted real balances. When
r is su¢ ciently low the equilibrium features partial depletion of real balances.

Figure 12: Typology of equilibria with full depletion in the (h; r) space

49

Appendix A5: Algorithm to compute value functions and stationary distributions
The algorithm to compute the value function, W (z), and the distribution of real balances, F , at a steady-state
equilibrium is composed of four steps:
Step 0. Fix some initial guess of W0 (z) for the domain z 2 [0; z], where z should be reasonably large.

For example set W0 (z) to be the closed-form case with N = 2, and z = 3 (u0 )

1

(1 + r= ).

Step 1. Iterate the following k-th value function
Wk+1 (z) = z + max f h +

[ [u (y) + Wk (z + h

y)] + (1

) Wk (z + h)]g ;

h h;
y h+z

until it reaches some tolerance level, for example kWk+1 (z)

Wk (z)k

10

6

. Obtain the value function

W (z) = Wk (z).
Step 2. Obtain the policy function h (z) and y (z). Initiate s = 1; 2:::106 sample points with z1s = 0.
s
Step 3. For each s, generate a uniform random variable Us . Set zt+1
= zts + h (zts )

IUs

p (zts ).

Step 4. Iterate zts until t = T = 105 . Obtain the stationary distribution F (z) as the empirical CDF of
zTs .

50

Appendix A6. Numerical Algorithm to Compute the Transitional Dynamics
Step 0. Fix a parameter that features a full-depletion stationary equilibrium with N mass points, for
example we set N = 4 in the numerical example. Set a large T > N number of periods of the transitional
dynamics R = fR1 ; R2 ; :::RT g and

=f

0;

1 ; ::: T g,

Step 1. De…ne the constraints: for all t

t

M=

N
"

N
X1

j

j=1

and for all t

N

j
n
X
Y
h
Rt+1

n=1

s

s=1

#

?
N zt

+

(114)

1
Pt

1
j=1

t

for example we set T = 100 in the numerical example.

M=

j

"

Pj

n=1 h

n
Y

Rt+1

s=1

1

1

)N

1

+

PN

1

j=t

where
mj =

s

#

(j
h f1

(1

[(N

PN

1
j

j=t

Pt

n=1 h

n=1

j=1

s+1

s=1

Rt+1

)N

1z?

1)]

t)h
1) + 1]g + (1

!

j
Y

Rt+j

s+1

s=1

s

?
N zt

+

s=1

j [mj + (

The real balances of the N-1 th agent is
8
>
< (Nh 1) hR0 , ifQt = 0
Pt Qj
t+1
h (N 1 t) s=1 Rt+1 s + j=1 s=1 Rt+1
zN 1;t =
>
: PN 1 Qn
n=1 h
s=1 Rt+1 s , otherwise
The marginal value of real balances is
(
j
n
N
Y
X1
X
j 0
h
Rt+j
!
t (0) =
j

n
Y

)

s

+

i

(115)

:

, if t 2 f1:::N

N 1
N

N
Y1

2g

Rt+N

j

j=1

The su¢ cient condition for full depletion is
1+

(1 + r) =Rt

1
t

(0) :

(116)

The su¢ cient condition for N mass point is
! 0 (zN

1;t )

>1+

(1 + r) =Rt

1

! 0 (zN;t )

Step 2. Solve the standard constrained minimization problem: "
t= t 1,

min

(117)
;R

(RT

2

1) subject to Rt =

(114), (115), (116), and (117). Accept the transitional dynamics R if the error " is less than some

tolerance level, says 10

6

: after T period RT is in the neighborhood of its steady state level 1. Notice that

the algorithm does not always guarantee to reach a solution R for any parameter values, as the economy
may feature partial depletion or the number of mass point changes along the transition dynamics.

51

