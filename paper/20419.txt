NBER WORKING PAPER SERIES

TRADE DYNAMICS IN THE MARKET FOR FEDERAL FUNDS
Gara Afonso
Ricardo Lagos
Working Paper 20419
http://www.nber.org/papers/w20419

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2014

We are grateful to Todd Keister for his feedback at various stages. We also thank Darrell Duffie, Huberto
Ennis and Tan Wang for comments. Lagos thanks the support from the C.V. Starr Center for Applied
Economics at NYU, and the hospitality of the Cowles Foundation for Research in Economics at Yale
University. While working on this project, Lagos was a short-term visiting scholar at the Federal Reserve
Banks of Minneapolis, Philadelphia, New York, and St. Louis. The views expressed in the paper are
those of the authors and are not necessarily reflective of views at the Federal Reserve Bank of Minneapolis,
New York, Philadelphia, St. Louis, the Federal Reserve System, or the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2014 by Gara Afonso and Ricardo Lagos. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice,
is given to the source.

Trade Dynamics in the Market for Federal Funds
Gara Afonso and Ricardo Lagos
NBER Working Paper No. 20419
August 2014
JEL No. E4,E43,E5,E52,E58,G21,G28
ABSTRACT
We develop a model of the market for federal funds that explicitly accounts for its two distinctive
features: banks have to search for a suitable counterparty, and once they meet, both parties negotiate
the size of the loan and the repayment. The theory is used to answer a number of positive and normative
questions: What are the determinants of the fed funds rate? How does the market reallocate funds?
Is the market able to achieve an efficient reallocation of funds? We also use the model for theoretical
and quantitative analyses of policy issues facing modern central banks.

Gara Afonso
Federal Reserve Bank of NY
33 Liberty Street
New York, NY 10045
Gara.Afonso@ny.frb.org
Ricardo Lagos
Department of Economics
New York University
19 West Fourth Street
New York, NY 10014
and NBER
ricardo.lagos@nyu.edu

1

Introduction

Financial institutions in the United States keep reserve balances at the Federal Reserve Banks
to meet requirements, earn interest, or clear financial transactions. The market for federal funds
is an interbank over-the-counter market for unsecured, mostly overnight loans of dollar reserves
held at Federal Reserve Banks. This market allows institutions with excess reserve balances
to lend reserves to institutions with reserve deficiencies. A particular average measure of the
market interest rate on these loans is commonly referred to as the fed funds rate.
The fed funds market is primarily a mechanism that reallocates reserves among banks. As
such, it is a crucial market from the standpoint of the economics of payments and the branch of
banking theory that studies the role of interbank markets in helping banks manage reserves and
offset liquidity or payment shocks. The fed funds market is the setting where the interest rate on
the shortest maturity, most liquid instrument in the term structure is determined. This makes it
an important market from the standpoint of finance. The fed funds rate affects commercial bank
decisions concerning loans to businesses and individuals, and has important implications for the
loan and investment policies of financial institutions more generally. This makes the fed funds
market critical to macroeconomists. The fed funds market is the epicenter of monetary policy
implementation: The Federal Open Market Committee (FOMC) communicates monetary policy
by choosing the fed funds rate it wishes to prevail in this market and implements monetary
policy by instructing the trading desk at the Federal Reserve Bank of New York to â€œcreate
conditions in reserve marketsâ€ that will encourage fed funds to trade at the target level. As
such, the fed funds market is of first-order importance for economists interested in monetary
theory and policy. For these reasons, we believe it is crucial to pry into the micro mechanics
of trade in the market for federal funds in order to understand the mechanism by which this
market reallocates liquidity among banks and the determination of the market price for this
liquidity provisionâ€”the fed funds rate. To this end, we develop a dynamic equilibrium model
of trade in the fed funds market that explicitly accounts for the two distinctive features of
the over-the-counter structure of the actual fed funds market: search for counterparties and
bilateral negotiations. In the theory, banks randomly contact other banks over time, and once
they meet, they bargain over the loan size and interest rate.
Section 2 offers a brief institutional description of the market for federal funds. Section 3
presents the theoretical model and relates the main ingredients to the institutional features of

2

the fed funds market. Section 4 defines and characterizes equilibrium. In Section 5 we use the
theory to identify the determinants of empirical measures of trade volume, trading delays, and
the fed funds rate. We show that the equilibrium exhibits endogenous intermediation: although
all banks have the same trading technology, some borrow reserves from counterparties who are
willing to lend at relatively low rates and later lend those reserves to counterparties who are
willing to borrow at higher rates. We also propose theory-based measures of the importance of
bank-provided intermediation in the process of reallocation of reserves. In Section 6 we calibrate
and simulate a large-scale version of the model to assess the ability of the theory to capture
the salient empirical features of the market for federal funds in the United States, such as the
intraday evolution of the distribution of reserve balances and the dispersion in loan sizes and
fed funds rates. Finally, we use the large-scale calibrated model as a laboratory to study a key
issue in modern central banking, namely, the effectiveness of policies that use the interest rate
on banksâ€™ reserves as a tool to manage the fed funds rate. Appendix A contains all proofs.1
Previous research on the fed funds market includes the theoretical work of Poole (1968),
Ho and Saunders (1985), and Coleman, Gilles, and Labadie (1996), and the empirical work of
Hamilton (1996) and Hamilton and JordaÌ€ (2002). The over-the-counter nature of the fed funds
market was highlighted by Ashcraft and Duffie (2007) in their empirical investigation and used
by Bech and Klee (2011), Ennis and Weinberg (2009), and Furfine (2003) to try to explain
certain aspects of interbank markets such as apparent limits to arbitrage, stigma, and banksâ€™
decisions to borrow from standing facilities. Relative to the existing literature on the fed funds
market, our contribution is to model the intraday allocation of reserves and pricing of overnight
loans using a dynamic equilibrium search-theoretic framework that captures the salient features
of the decentralized interbank market in which these loans are traded. Our work is related to
an emerging literature that studies search and bargaining frictions in financial markets. To
date, this literature consists of two subfields: one that deals with macro issues and another that
focuses on micro considerations in the market microstructure tradition.
On the macro side, for instance, Lagos (2010a, 2010b, 2011) uses versions of the Lagos and
Wright (2005) search-based model of exchange to study the effect of liquidity and monetary
policy on asset prices. On the micro side, Duffie, GaÌ‚rleanu, and Pedersen (2005) and Lagos and
1

There are also three online appendices: Appendix B studies the problem of a social planner who can reallocate
reserves subject to the same bilateral trading technology available to private agents and shows that the equilibrium
implements the efficient reallocation of reserves. Appendix C describes the data and estimation procedures used
in the quantitative implementation of the theory. Appendix D contains supplementary policy experiments.

3

Rocheteau (2009) employ search-theoretic techniques to model the trading frictions characteristic of real-world over-the-counter markets.2 Relative to this particular micro branch of the
literature, our contribution is twofold. First, our model of the fed funds market provides a theoretical framework to interpret and rationalize the findings of existing empirical investigations
of this market, such as Furfine (1999), Ashcraft and Duffie (2007), Bech and Atalay (2008), and
Afonso, Kovner, and Schoar (2011). Our second contribution is methodological: we offer the
first analytically tractable formulation of a search-based model of an over-the-counter market
in which all trade is bilateral and agents can hold essentially unrestricted asset positions.3

2

Institutional features of the market for federal funds

The market for federal funds is a market for unsecured loans of reserve balances at the Federal
Reserve Banks that allows participants with excess reserve balances to lend (or sell funds) to
those with reserve balance shortages. These unsecured loans, commonly referred to as federal
funds (or fed funds) are delivered on the same day, and their duration is typically overnight.
The interest rate on these loans is known as the fed funds rate. Most fed funds transactions
are settled through Fedwire Funds Services (Fedwire), a large-value real-time gross settlement
system operated by the Federal Reserve Banks. Fedwire operates 21.5 hours each business day,
from 9:00 pm eastern standard time (EST) on the preceding calendar day to 6:30 pm EST.
Participants include commercial banks, thrift institutions, agencies and branches of foreign
banks in the United States, government securities dealers, government agencies such as federal
or state governments, and GSEs (e.g., Freddie Mac, Fannie Mae, and Federal Home Loan
Banks). The market for fed funds is an over-the-counter market: in order to trade, a financial
institution must first find a willing counterparty and then bilaterally negotiate the size and rate
of the loan.
2

There is by now a growing search-theoretic literature on financial markets that includes Afonso (2011),
Duffie, GaÌ‚rleanu, and Pedersen (2007), GaÌ‚rleanu (2009), Lagos and Rocheteau (2007), Lagos, Rocheteau, and
Weill (2011), Miao (2006), Rust and Hall (2003), Spulber (1996), Vayanos and Wang (2007), Vayanos and Weill
(2008), and Weill (2007, 2008), to name a few. See Ashcraft and Duffie (2007) for more on the over-the-counter
nature of the fed funds market.
3
In contrast, the tractability of the model of Lagos and Rocheteau (2009) (the only other tractable formulation
of a search-based over-the-counter market with unrestricted asset holdings) relies on the assumption that all trade
among investors is intermediated by dealers who have continuous access to a competitive interdealer market.
While there are several examples of such pure dealer markets, the market for federal funds is not one of them.

4

3

The model

There is a large population of agents that we refer to as banks, each represented by a point in
the interval [0, 1]. Banks hold integer amounts of an asset that we interpret as reserve balances
and can negotiate these balances during a trading session set in continuous time that starts at
time 0 and ends at time T . Let Ï„ denote the time remaining until the end of the trading session,
so Ï„ = T âˆ’ t if the current time is t âˆˆ [0, T ]. The reserve balance that a bank holds (e.g., at
its Federal Reserve account) at time T âˆ’ Ï„ is denoted by k (Ï„ ) âˆˆ K, with K = {0, 1, ..., K},
where K âˆˆ Z and 1 â‰¤ K. The measure of banks with balance k at time T âˆ’ Ï„ is denoted
nk (Ï„ ). A bank starts the trading session with some balance k (T ) âˆˆ K. The initial distribution
of balances, {nk (T )}kâˆˆK , is given. Let uk âˆˆ R denote the flow payoff to a bank from holding k
balances during the trading session, and let Uk âˆˆ R be the payoff from holding k balances at
the end of the trading session. All banks discount payoffs at rate r.
Banks can trade balances with each other in an over-the-counter market where trading
opportunities are bilateral and random and represented by a Poisson process with arrival rate
Î±. We model these bilateral transactions as loans of reserve balances. Once two banks have
made contact, they bargain over the size of the loan and the quantity of reserve balances to be
repaid by the borrower. After the terms of the transaction have been agreed upon, the banks
part ways. We assume that (signed) loan sizes are elements of the set KÌ„ = K âˆª {âˆ’K, ..., âˆ’1}
and that every loan gets repaid at time T + âˆ† in the following trading day, where âˆ† âˆˆ R+ . Let
x âˆˆ R denote the net credit position (of reserves due at T + âˆ†) that has resulted from some
history of trades. We assume that the payoff to a bank with a net credit position x that makes
a new loan at time T âˆ’ Ï„ with repayment R at time T + âˆ† is equal to the post-transaction
discounted net credit position, eâˆ’r(Ï„ +âˆ†) (x + R).
Discussion.

We use a search-based model to capture the over-the-counter nature of the fed

funds market. In practice there are two ways of trading federal funds. Two participants can
contact each other directly and negotiate the terms of a loan, or they can be matched by a fed
funds broker. Since nonbrokered transactions represent the bulk of the volume, we abstract
from brokers in our baseline model. Notice that search entails two layers of uncertainty in
this environment. First, the time it takes a bank to contact a counterparty is an exponentially distributed random variable with mean 1/Î±. Second, conditional on having contacted
a counterparty at time T âˆ’ Ï„ , the reserve balance k of the counterparty is a random variable
5

with probability distribution {nk (Ï„ )}kâˆˆK . So even if a bank were able to contact counterparties fairly quickly, the fact that search is random with respect to the counterpartiesâ€™ reserve
holdings implies that the bank will typically have to engage in several trades with different
counterparties in order to achieve a desired holding of reserve balances.
Fed funds activity is concentrated in the last two hours of the operating day. Until late
afternoon, transfers of reserves across banks are mostly due to their primary business activities.
For example, a profit center at Bank A may draw down reserve balances in order to pay for an
asset purchase from Bank B, or a client at Bank C may issue a payment to a client at Bank D,
resulting in a transfer of reserves from Bank C to Bank D. By around 4:00 pm, the fed funds
trading desk at each bank has a good estimate of the send and receive transactions pending until
the end of the day and begins actively trading fed funds to push the bankâ€™s reserve balance
in the desired direction. From this point on, the dynamics of the reserve balance is mostly
controlled by the fed funds traders, who expect other profit centers at the bank to avoid large
unscheduled transactions near the end of the day.4 Thus, in the theory, we think of t = 0 as
standing in for 4:00 pm and use the initial condition {nk (T )}kâˆˆK to represent the distribution
of actual reserve balances given to the banksâ€™ fed funds trading desks at this time.
The motives for trading fed funds may vary across participants and their specific circumstances on any given day, but there are two main reasons in general. First, some institutions
such as commercial banks use the fed funds market to offset the effects on their reserve balances of transactions (initiated either by their clients or by profit centers within the banks
themselves) that would otherwise leave them with a reserve position that does not meet Federal Reserve regulations. Also, some participants regard fed funds as an investment vehicleâ€”an
interest-yielding asset that can be used to â€œdepositâ€ balances overnight. In our model, all
payoff-relevant policy and regulatory considerations are captured by the intraday and end-ofday payoffs, {uk , Uk }kâˆˆK .5
4

Ashcraft and Duffie (2007) and Duffie (2012) document this kind of institutional knowledge obtained from
fed funds traders. In line with these observations, Bartolini et al. (2005) attribute the late afternoon rise in fed
funds trading activity to the clustering of institutional deadlines, e.g., the settlement of securities transactions
ends at 3:00 pm, causing some institutions to defer much of their money market trading until after that time, once
their security-related balance sheet position becomes certain. Uncertainty about client transactions and other
payment flows diminishes in the hour or two before Fedwire closes, which also contributes to the concentration
of fed funds trading activity late in the day.
5
For example, if the Federal Reserve pays no interest on intraday holdings of reserves and interest rate if on
all reserves held at the end of the trading session, then uk = 0 and Uk = (1 + if ) k for all k âˆˆ K. As another
example, see (15) in Section 6.3. In Section 6.1 we will adopt a general specification that captures the essential
institutional arrangements currently in place in the United States.

6

4

Equilibrium

Let the function Vk (Ï„ ) : K Ã— [0, T ] â†’ R denote the maximum attainable payoff that a bank can
obtain from k âˆˆ K units of reserve balances when the time until the end of the trading session
is Ï„ âˆˆ [0, T ]. Whenever two banks meet during the trading session, they bargain over the size of
the loan and the size of the repayment. Consider a bank with k balances that contacts a bank
with k 0 balances. For any pair of pre-trade reserve balances of the two banks, k, k 0 âˆˆ K, the set
Î  (k, k 0 ) = {(q, q 0 ) âˆˆ K Ã— K : q + q 0 = k + k 0 } contains all feasible pairs of post-trade balances
that could result from the bilateral negotiation. This set embeds the restriction that an increase
in one bankâ€™s balance must correspond to an equal decrease in the other bankâ€™s balance and
that no bank can transfer more balances than it currently holds. For every pair of banks that
hold pre-trade balances (k, k 0 ) âˆˆ K Ã— K, the set Î  (k, k 0 ) induces the set of all feasible (signed)

loan sizes, Î“ (k, k 0 ) = b âˆˆ KÌ„ : (k âˆ’ b, k 0 + b) âˆˆ Î  (k, k 0 ) . Notice that Î  (k, k 0 ) = Î  (k 0 , k) and
Î“ (k, k 0 ) = âˆ’Î“ (k 0 , k) for all k, k 0 âˆˆ K. The pair (bkk0 (Ï„ ) , Rk0 k (Ï„ )) denotes the bilateral terms
of trade between a bank with balance k and a bank with balance k 0 when the remaining time
until the end of the trading session is Ï„ . That is, bkk0 (Ï„ ) is the amount of reserves that the
bank with balance k lends to the bank with balance k 0 , and Rk0 k (Ï„ ) is the amount of balances
that the latter commits to repay the former at time T + âˆ†. We take these terms of trade to be
the outcome corresponding to the symmetric Nash solution to the bilateral bargaining problem.
Then for any k, k 0 âˆˆ K and any Ï„ âˆˆ [0, T ], (bkk0 (Ï„ ) , Rk0 k (Ï„ )) is the solution to
max

bâˆˆÎ“(k,k0 ),RâˆˆR

h
ih
i
Vkâˆ’b (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R âˆ’ Vk (Ï„ ) Vk0 +b (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) R âˆ’ Vk0 (Ï„ ) .

Thus for any k âˆˆ K and any Ï„ âˆˆ [0, T ],
(Z
min(Ï„Î± ,Ï„ )

Vk (Ï„ ) = E
0

+ I{Ï„Î± â‰¤Ï„ } e

âˆ’rÏ„Î±

eâˆ’rz uk dz + I{Ï„Î± >Ï„ } eâˆ’rÏ„ Uk

X

h

nk0 (Ï„ âˆ’ Ï„Î± ) Vkâˆ’bkk0 (Ï„ âˆ’Ï„Î± ) (Ï„ âˆ’ Ï„Î± ) + e

(1)
âˆ’r(Ï„ +âˆ†âˆ’Ï„Î± )

Rk0 k (Ï„ âˆ’ Ï„Î± )

)
i

k0 âˆˆK

where
bkk0 (Ï„ ) âˆˆ arg max [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )]
bâˆˆÎ“(k,k0 )

eâˆ’r(Ï„ +âˆ†) Rk0 k (Ï„ ) =

 1

1
Vk0 +bkk0 (Ï„ ) (Ï„ ) âˆ’ Vk0 (Ï„ ) +
Vk (Ï„ ) âˆ’ Vkâˆ’bkk0 (Ï„ ) (Ï„ ) .
2
2
7

(2)
(3)

The expectation operator, E, in (1) is with respect to the exponentially distributed random
time until the next trading opportunity, Ï„Î± , and I{Ï„Î± â‰¤Ï„ } is an indicator function that equals 1 if
Ï„Î± â‰¤ Ï„ and 0 otherwise. The first term contains the flow payoff to the bank from holding balance
k until the next trade opportunity or the end of the session, whichever arrives first. The second
term says that in the event that the bank gets no trade opportunity before time T , it ends the
day with k balances and gets the end-of-day payoff Uk . The third term contains the expected
discounted payoff in the event that the bank gets a trade opportunity with another bank before
time T , i.e., at time T âˆ’ (Ï„ âˆ’ Ï„Î± ). In this event the counterparty is a random draw from the
distribution of balances at time T âˆ’ (Ï„ âˆ’ Ï„Î± ), namely, {nk0 (Ï„ âˆ’ Ï„Î± )}k0 âˆˆK , and the expression
inside the square bracket is the post-trade continuation payoff of the bank we are considering.6
Hereafter, we use V â‰¡ [V (Ï„ )]Ï„ âˆˆ[0,T ] , with V (Ï„ ) â‰¡ {Vk (Ï„ )}kâˆˆK , to denote the value function.
According to the bargaining solution (2) and (3), the loan size maximizes the joint gain from
trade, and the repayment implements a division of this gain between the borrower and the
lender that gives each a fraction equal to their bargaining power (i.e., one half). For example,
if a bank with i âˆˆ K balances and a bank with j âˆˆ K balances meet at time T âˆ’ Ï„ , they will
0 0

k s (Ï„ ) with
negotiate a loan of size bij (Ï„ ) = i âˆ’ k = s âˆ’ j, where (k, s) âˆˆ arg max(k0 ,s0 )âˆˆÎ (i,j) Sij
0 0

k s (Ï„ ) â‰¡ V 0 (Ï„ ) + V 0 (Ï„ ) âˆ’ V (Ï„ ) âˆ’ V (Ï„ ). The implied joint gain from trade corresponding to
Sij
i
j
k
s
ks (Ï„ ), and the individual gain from trade, e.g., of the bank with pre-trade
this transaction is Sij
ks (Ï„ ).
balance equal to i, is Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) Rji (Ï„ ) âˆ’ Vi (Ï„ ) = 21 Sij

Consider a bank with i balances that contacts a bank with j balances when the time
until the end of the trading session is Ï„ . Let Ï†ks
ij (Ï„ ) be the probability that the former and
the latter hold k and s balances after the meeting, respectively, i.e., Ï†ks
ij (Ï„ ) âˆˆ [0, 1], with
P P ks
ks
Ï†ij (Ï„ ) = 1. Feasibility requires that Ï†ij (Ï„ ) = 0 if (k, s) âˆˆ
/ Î  (i, j). Given any feasible
kâˆˆK sâˆˆK

path for the distribution of trading probabilities, Ï† (Ï„ ) = {Ï†ks
ij (Ï„ )}i,j,k,sâˆˆK , the distribution of
6

Notice that aside from the k units of reserves it is holding at time T âˆ’ Ï„ , a bank may also have a net credit
position x âˆˆ R resulting from trades that occurred earlier in the trading session (to be settled after the end of
the trading session, at time T + âˆ†). Thus the total payoff of a bank will typically depend on its total asset
position, s = (k, x) âˆˆ K Ã— R. In Appendix A (Section A.1) we present the bargaining problem and the Bellman
equation that must be satisfied by Jk (x, Ï„ ) : K Ã— R Ã— [0, T ] â†’ R, i.e., the value function of a bank that at time
T âˆ’ Ï„ holds k âˆˆ K units of reserve balances and whose net credit position is x âˆˆ R, and the bilateral terms
of trade (bss0 (Ï„ ) , Rs0 s (Ï„ )) that result in a meeting at time T âˆ’ Ï„ between a bank with total asset position
s = (k, x) âˆˆ K Ã— R and a bank with total asset position s0 = (k0 , x0 ) âˆˆ K Ã— R. We also show (Lemma 2) that
Jk (x, Ï„ ) = Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) x, which means that the Nash bargaining outcome is independent of the net credit
positions of the banks, x and x0 . This allows us to simplify the exposition by working with Vk (Ï„ ).

8

balances at time T âˆ’ Ï„ , i.e., n (Ï„ ) = {nk (Ï„ )}kâˆˆK , evolves according to
nÌ‡k (Ï„ ) = f [n (Ï„ ) , Ï† (Ï„ )]

for all k âˆˆ K,

(4)

where
f [n (Ï„ ) , Ï† (Ï„ )] â‰¡ Î±nk (Ï„ )

XXX

ni (Ï„ ) Ï†sj
ki (Ï„ )

iâˆˆK jâˆˆK sâˆˆK

âˆ’Î±

XXX

ni (Ï„ ) nj (Ï„ ) Ï†ks
ij (Ï„ ) .

(5)

iâˆˆK jâˆˆK sâˆˆK

The first term on the right side of (5) contains the total flow of banks that leave state k between
time t = T âˆ’ Ï„ and time t0 = T âˆ’ (Ï„ âˆ’ Îµ) for a small Îµ > 0. The second term contains the total
flow of banks into state k over the same interval of time.
The following proposition provides a sharper representation of the value function and the
distribution of trading probabilities characterized in (1), (2), and (3).
Proposition 1 The value function V satisfies (1), with (2) and (3), if and only if it satisfies
rVi (Ï„ ) + VÌ‡i (Ï„ ) = ui +

Î± XXX
nj (Ï„ ) Ï†ks
ij (Ï„ ) [Vk (Ï„ ) + Vs (Ï„ ) âˆ’ Vi (Ï„ ) âˆ’ Vj (Ï„ )]
2

(6)

jâˆˆK kâˆˆK sâˆˆK

for all (i, Ï„ ) âˆˆ K Ã— [0, T ], with
Vi (0) = Ui
and

for all i âˆˆ K,



â‰¥ 0 if (k, s) âˆˆ â„¦ij [V (Ï„ )]
= 0 if (k, s) âˆˆ
/ â„¦ij [V (Ï„ )] ,
P P ks
for all i, j, k, s âˆˆ K and all Ï„ âˆˆ [0, T ], with
Ï†ij (Ï„ ) = 1, where
Ï†ks
ij (Ï„ )

(7)

(8)

kâˆˆK sâˆˆK

â„¦ij [V (Ï„ )] â‰¡ arg

max

(k0 ,s0 )âˆˆÎ (i,j)

[Vk0 (Ï„ ) + Vs0 (Ï„ ) âˆ’ Vi (Ï„ ) âˆ’ Vj (Ï„ )] .

(9)

The set â„¦ij [V (Ï„ )] defined in (9) contains all the feasible pairs of post-trade balances that
maximize the joint gain from trade between a bank with i balances and a bank with j balances that is implied by the value function V (Ï„ ) at time T âˆ’ Ï„ . For any pair of banks with
balances i and j, Ï†ks
ij (Ï„ ) defined in (8) is a probability distribution over the feasible pairs of
post-trade balances that maximize the bilateral gain from trade. Thus together, (8) and (9)
9

describe the pairs of post-trade balances (or equivalently, loan sizes) that may result from the
bilateral bargaining. The Bellman equation described by (6) and (7) has a natural interpretation. The flow value of a bank that holds balance i at time T âˆ’ Ï„ , i.e., rVi (Ï„ ), consists of
the flow return from holding balance i, i.e., ui , minus the flow capital loss associated with the
reduction in the remaining time until the end of the trading session, i.e., VÌ‡i (Ï„ ), plus the rate at
which the bank meets counterparties, Î±, times the expected gain from trade to the bank, i.e.,
P P P
1 ks
nj (Ï„ ) Ï†ks
ij (Ï„ ) 2 Sij (Ï„ ).
jâˆˆK kâˆˆK sâˆˆK

Definition 1 An equilibrium is a path for the distribution of reserve balances, n (Ï„ ), a value
function, V , and a path for the distribution of trading probabilities, Ï† (Ï„ ), such that: (a)
given the value function and the distribution of trading probabilities, the distribution of balances evolves according to (4); and (b) given the path for the distribution of balances, the value
function satisfies (6) and (7), and the distribution of trading probabilities satisfies (8).
In quantitative implementations of the theory, one can try to compute equilibrium algorithmically, as follows. Guess a path of trading probabilities and use it to solve the system of
differential equations (4) with initial condition {nk (T )}kâˆˆK to obtain a path for the distribution of reserve balances. Then substitute the trading probabilities and distribution of reserves
implied by the guess, and solve the system of differential equations (6) and (7) for the implied
value function. Then use this value function and (8) to obtain a new guess for the path of
trading probabilities and continue iterating until the value function has converged. Instead of
following this route, here we make a curvature assumption on the vectors {uk }kâˆˆK and {Uk }kâˆˆK
that will allow us to provide an analytical characterization of equilibrium.
Assumption A. For any i, j âˆˆ K, the payoff functions satisfy
ud i+j e + ub i+j c â‰¥ ui + uj
2
2

(DMC)

Ud i+j e + Ub i+j c â‰¥ Ui + Uj , â€œ > â€ unless i =
2

2

l

i+j
2

m

and j =

j

i+j
2

k

,

(DMSC)

where bxc â‰¡ max {k âˆˆ Z : k â‰¤ x} and dxe â‰¡ min {k âˆˆ Z : x â‰¤ k} for any x âˆˆ R.
Conditions (DMC) and (DMSC) require that {uk }kâˆˆK and {Uk }kâˆˆK satisfy the discrete midpoint concavity property and the discrete midpoint strict concavity property, respectively. These
conditions are the natural discrete approximations to the notions of midpoint concavity and mid-

10

point strict concavity of ordinary functions defined on convex sets.7 Assumption A is reasonable
in the context of the fed funds market because central banks typically do not offer payment
schemes that are convex in reserve balances. The following result provides a full characterization
of equilibrium under this assumption.
Proposition 2 Let the payoff functions satisfy Assumption A. Then:
(i ) An equilibrium exists, and the equilibrium paths for the maximum attainable payoffs, V (Ï„ ),
and the distribution of reserve balances, n (Ï„ ), are uniquely determined.
(ii ) The equilibrium path for the distribution of trading probabilities, Ï† (Ï„ ) = {Ï†ks
ij (Ï„ )}i,j,k,sâˆˆK ,
is given by
â‰¥ 0 if (k, s) âˆˆ â„¦âˆ—ij
= 0 if (k, s) âˆˆ
/ â„¦âˆ—ij
P
Ï†ks
for all i, j, k, s âˆˆ K and all Ï„ âˆˆ [0, T ], with
ij (Ï„ ) = 1, and
Ï†ks
ij (Ï„ )



(10)

(k,s)âˆˆâ„¦âˆ—ij

ï£± n
o
i+j i+j
ï£²
,
if i + j is even
nj2 k2 l m l m j ko
â„¦âˆ—ij =
i+j
i+j
i+j
i+j
ï£³
, 2
,
, 2
if i + j is odd.
2
2

(11)

The equilibrium distribution of trading probabilities (10) can be described intuitively as follows.
If at any point during the trading session, a bank with balance i contacts a bank with balance
j k
l m
i+j
j, then the post-trade balance is i+j
for
one
of
the
banks
and
for the other. This
2
2
property, and the uniqueness of the equilibrium paths for the distribution of reserve balances
and maximum payoffs, hold under Assumption A. With the path for Ï† (Ï„ ) given by (10) in
closed form, the equilibrium value function, V , is the unique bounded real-valued function that
satisfies (6) and (7), and the path for the distribution of balances, n (Ï„ ), is given by (4) with
initial condition {nk (T )}kâˆˆK .

5

Positive implications

The fed funds market is a mechanism that reallocates reserves among banks. Its performance
is typically assessed with empirical measures of the volume of this reallocation and the corresponding interest rates. In this section we derive the theoretical counterparts to these empirical

â‰¥ g (x) + g (y)
Let X be a convex subset of Rn , then a function g : X â†’ R is midpoint concave if 2g x+y
2
for all x, y âˆˆ X. Clearly, if g is concave, it is midpoint concave. The converse is true provided g is continuous.
See Murota (2003) for more on the midpoint concavity property and the role that it plays in the modern theory
of discrete convex analysis.
7

11

measures and show that the theory is qualitatively consistent with the elementary features of
the actual fed funds market. We also identify the determinants of the fed funds rate, trade
volume, and trading delays, show that the equilibrium exhibits endogenous intermediation,
and propose theory-based measures of the importance of these bank-provided intermediation
services in the process of reallocation of reserves.

5.1

Trade volume and trading delays

RT
The total volume of fed funds traded during the session is Ï…Ì„ = 0 Ï…Ì„ (Ï„ ) dÏ„ , where
XXXX
Ï…Ì„ (Ï„ ) = Î±
ni (Ï„ ) nj (Ï„ ) Ï†ks
ij (Ï„ ) |k âˆ’ i| .
iâˆˆK jâˆˆK kâˆˆK sâˆˆK

Notice that the arrival rate of specific trading opportunities is endogenous, as it depends on the
equilibrium distribution of balances. For example, Î±nj (Ï„ ) Ï†ks
ij (Ï„ ) is the rate at which agents
with balance i trade a loan of size to k âˆ’ i with agents with balance j at time T âˆ’ Ï„ . Thus
even though the contact rate, Î±, is exogenous, the trading delays involved in attaining a certain
target balance of reserves are determined endogenously, e.g., by agentsâ€™ trading strategies and
the distribution of reserves.

5.2

Fed funds rate

Consider a transaction at time T âˆ’Ï„ between a bank with i balances and a bank with j balances
such that the former exits the trade with k balances and the latter with s = i + j âˆ’ k. In this
case the bank with j balances gives the bank with i balances a loan of size bji (Ï„ ) = k âˆ’i = j âˆ’s,
ks (Ï„ ) at time T + âˆ†. Define the (gross) interest rate on this loan as
and the latter repays Rij

1 + Ïks
ij (Ï„ ) =

ks (Ï„ )
Rij
.
jâˆ’s

(12)

Thus in the theory as in the actual fed funds market, there is no such thing as the fed funds rate;
rather there is a time-varying distribution of rates. In this context, it is natural to construct a
daily average,
1
ÏÌ„ =
T
where

ks (Ï„ )
Ï‰ij

Z
0

T

XXXX

ks
Ï‰ij
(Ï„ ) Ïks
ij (Ï„ ) dÏ„,

iâˆˆK jâˆˆK kâˆˆK sâˆˆK

ks (Ï„ ) â‰¥ 0 and
is a weighting function with Ï‰ij

P
i,j,k,sâˆˆK

ks (Ï„ ) = 1. For example,
Ï‰ij

ks (Ï„ ) = Ï… ks (Ï„ ) /Ï…Ì„ (Ï„ ), then ÏÌ„ is a value-weighted daily average fed funds rate akin to the
if Ï‰ij
ij

effective federal funds rate published daily by the Federal Reserve.
12

5.3

Intermediation and speculative trades

Consider a bank B that starts the day with a zero balance of reserves and has two trade
opportunities during the whole trading session: the first with bank A that holds 20 units
of reserves and the second with bank C that holds 0. Then according to Proposition 2, B
holds 10 units after trading with A and 5 units after trading with C. Notice that B buys
10 units from A early in the trading session and resells 5 of these 10 units to C later in the
day, i.e., B acted as an intermediary between A and C. The equilibrium exhibits endogenous
intermediation in the sense that banks act as dealers, buying and selling funds on their own
account and channeling them from banks with larger balances to banks with smaller balances.
From an applied standpoint, this kind of intermediation is an important feature of the fed
funds market.8 From a theoretical standpoint, it is interesting that intermediation emerges
as an equilibrium phenomenon even though all banks are fundamentally identical (i.e., they
have the same contact rate, the same payoffs, and the bargaining power). Intermediation is
a natural consequence of two elementary forces: random sequencing of meetings among banks
with different holdings and the tendency of banks to want to equate their marginal utilities
from reserve holdings formalized in Proposition 2.9
We propose a theory-based empirical measure of the importance of intermediation in the
process of reallocation of reserves among banks. Consider a bank that starts the day with
balance k0 and then gets N âˆˆ {0, 1, 2, . . .} trading opportunities during the whole trading
session. Let kn denote the bankâ€™s post-trade balance after the nth trade, for n = 1, ..., N . Define
P
the bankâ€™s accumulated volume of purchases Op = N
n=1 max {kn âˆ’ knâˆ’1 , 0}, the accumulated
PN
s
volume of sales, O = âˆ’ n=1 min {kn âˆ’ knâˆ’1 , 0}, and the (signed) net trade, Op âˆ’Os = kN âˆ’k0 .
Then min{Op , Os } measures the volume of funds intermediated by the bank. Alternatively,
Op + Os is the gross volume of funds traded by the bank, and |Op âˆ’ Os | is the size of the bankâ€™s
net daily trade, so X = Op +Os âˆ’|Op âˆ’ Os | is a bank-level measure of excess funds reallocation,
8

This result is consistent with a striking aspect of the fed funds market that was pointed out by Ashcraft and
Duffie (2007): â€œA significant number of loans in our data are made by lenders in the lower deciles by relative
balances. Many of these lenders are presumably themselves in relative need of funds but agree to lend at a
sufficiently high rate, planning to borrow later in the day at a lower rate. In any OTC market, the borrower
does not generally know the most attractive rates available from other counterparties, or which counterparties
are offering them, and may have an incentive to accept the rate offered by such a lender.â€
9
In contrast, existing models of financial OTC markets, e.g., Duffie et al. (2005) and Lagos and Rocheteau
(2009), feature intermediation by assuming that there are two types of agents: â€œinvestorsâ€ who get utility from
holding the asset and â€œdealersâ€ who have a superior (faster) trading technology and intermediate trade between
investors with different asset valuations.

13

i.e., the volume of funds traded over and above what is required to accommodate the daily net
trade.10 The statistic X is an index of simultaneous buying and selling at the individual bank
level that suggests X/(Op + Os ) as a natural measure of the proportion of the total volume of
funds traded by a bank that the bank intermediated during the trading session.

6

Quantitative analysis

In this section we calibrate and simulate the model and show that it captures the salient features
of the fed funds market in the United States. We then use the model as a laboratory to study
a key issue in contemporary central banking, namely, the effectiveness of policies that use the
interest rate on banksâ€™ reserves as a tool to manage the overnight interbank rate.

6.1

Calibration

The motives for trading fed funds and the payoffs from holding reserve balances are different
for different types of market participants. Since commercial banks normally account for the
bulk of the trade volume in the fed funds market, we focus on their trading motives and
payoffs. The Federal Reserve imposes a minimum level of reserves on commercial banks and
other depository institutions.11 End-of-day balances within a maintenance period may vary
but generally remain positive as overnight overdrafts are considered unauthorized extensions
of credit and penalized. On October 9, 2008, the Federal Reserve began remunerating banksâ€™
positive end-of-day balances. In the theory, all of these policy considerations are represented
by {Uk }kâˆˆK . The Fed has traditionally not paid interest on intraday reserve balances, but it
charges interest on uncollateralized daylight overdrafts. In the theory, the flow payoff to a bank
from holding intraday balances is captured by {uk }kâˆˆK .
For the quantitative work, we adopt the following formulation of banksâ€™ end-of-day payoffs:
Uk = eâˆ’râˆ†f (k âˆ’ kÌ„0 + Fk ),

(13)

where

 w

Fk = max
FÌ„ (k w ) âˆ’ iw
f k âˆ’ k âˆ’ kÌ„0
w
k âˆˆK

s.t. k âˆ’ kÌ„0 â‰¤ k w

10
Our measure of excess funds reallocation is reminiscent of the notion of excess job reallocation used in
empirical studies of job creation and destruction (e.g., Davis, Haltiwanger, and Schuh, 1996).
11
The reserve balance requirement applies to the average level of a bankâ€™s end-of-day balances during a twoweek maintenance period. For an explanation of how these required operating balances are calculated, see
Bennett and Hilton (1997) and Federal Reserve (2009, 2010b).

14

with


ï£± r
e
w
if kÌ„ â‰¤ k w
ï£² if kÌ„ + if k âˆ’ kÌ„
ir k w âˆ’ icf (kÌ„ âˆ’ k w ) if 0 â‰¤ k w < kÌ„
FÌ„ (k w ) =
ï£³ f c
âˆ’if kÌ„ + iof k w
if k w < 0.

This formulation captures the essential institutional arrangements currently in place in the
United States. The parameter âˆ†f âˆˆ R+ represents the length of the period between the end of
the trading session and the beginning of the following trading session, when the bankâ€™s reserves
held overnight at the Federal Reserve become available (in practice, this period consists of
the 2.5 hours between 6:30 pm and 9:00 pm). The parameter kÌ„0 âˆˆ {0, . . . , K âˆ’ 1} indexes
translations of the set K, which afford us a more flexible interpretation of the elements of K.
Intuitively, kÌ„0 can be thought of as the overdraft threshold, which allows us to interpret a bank
with k < kÌ„0 as having an overdraft in its Fed account.12 Thus according to (13), the end-of-day
payoff of a bank that holds net-of-overdraft-threshold balance k âˆ’ kÌ„0 at the end of the trading
session is the discounted value of this balance net of interest payments from or to the Fed,
denoted Fk . Specifically, Fk contemplates that in practice, at the end of the trading day banks
have the option to borrow from the Federal Reserve discount window an amount of reserves

k w âˆ’ (k âˆ’ kÌ„0 ) â‰¥ 0. The parameter kÌ„ âˆˆ 1, ..., K âˆ’ kÌ„0 represents the reserve requirement
imposed on each bank. The cost of overnight borrowing from the discount window is denoted
iw
f . The overnight interest rates that a bank earns on required and excess reserves are denoted
irf and ief , respectively, with ief < iw
f . The deficiency per-dollar cost of failing to meet the reserve
requirement is denoted icf , and iof is the overnight overdraft penalty rate. The flow payoff to a
bank from holding intraday balances is given by
 d
if 0 â‰¤ k âˆ’ kÌ„0
i+ (k âˆ’ kÌ„0 )1âˆ’
uk =
d
1+
âˆ’iâˆ’ (kÌ„0 âˆ’ k)
if k âˆ’ kÌ„0 < 0.

(14)

The interest rate that a bank earns from the Fed on positive intraday balances is id+ , and idâˆ’ is
the interest rate it pays the Fed on daylight overdraft. The curvature parameter  âˆˆ [0, 1) will
be set to a negligible positive value.13
12

For example, in a parametrization with kÌ„0 = 0, K can be interpreted as the set of reserve balances that can
be held by an individual bank. More generally, we can instead regard k âˆˆ K as an abstract index and interpret
0
k0 â‰¡ k âˆ’ kÌ„0 as a bankâ€™s actual reserve balance. Under this interpretation, reserve
 balances (i.e., k ) held by banks
are in the set K0 â‰¡ {k0 : k0 = k âˆ’ kÌ„0 for some k âˆˆ K}. Then since K0 = âˆ’kÌ„0 , ..., K âˆ’ kÌ„0 , this formulation
allows the payoff functions to accommodate the possibility of negative reserve balances. In line with this more
general interpretation, kÌ„ represents the reserve requirement imposed on reserve balances, k0 â‰¡ k âˆ’ kÌ„0 . (The
reserve requirement stated in terms of the index k would be kÌ„ + kÌ„0 .)
13
Together with idâˆ’ large enough relative to id+ , this will ensure that {uk }kâˆˆK satisfies the discrete midpoint

15

We measure time in days. The model is meant to capture trade dynamics in the last 2.5
hours of the daily trading session, so we set T = 2.5/24. The parametrization of the initial
distribution of reserve balances, {nk (T )}kâˆˆK , is guided by identifying nk (T ) in the theory with
the empirical proportion of commercial banks whose balances at 4:00 pm are k/kÌ„ times their
average daily reserve requirement over a typical two-week holding period in 2007. Specifically,
{nk (T )}kâˆˆK was estimated from data using the following procedure. First, we identified 134
commercial banks that traded fed funds at the end of the second quarter of 2007 (according to
their FR Y9-C regulatory filings), for which we have been able to obtain information on their
required operating balance, and that are not subject to special analysis (according to item 9425
Bank Type Analysis Code of their regulatory fillings).14 Second, we obtained the empirical
cross-sectional distribution of closing balances of these 134 banks for each day of a two-week
maintenance period in the same quarter. Third, for every day in the sample, we constructed
a measure of each bankâ€™s imputed reserve balance at 4:00 pm, as follows. Given each bankâ€™s
closing balance on a given day, we subtracted the bankâ€™s net payments activity from 4:00 pm
until Fedwire Funds Service closing time (typically 6:30 pm) as well as the discount window
activity for that day. Fourth, for each bank we calculated the average (over days in the two-week
maintenance period) imputed reserve balance at 4:00 pm and normalized it by dividing it by
the bankâ€™s daily average required operating balance over the same maintenance period.15 The
distribution of average imputed normalized reserve balances across this sample of 134 banks
had a mean equal to 3.24. For our baseline experiments we translated this distribution so
that the mean would match the empirical mean of the ratio of seasonally adjusted reserves to
required reserves of all depository institutions during the second quarter of 2007, i.e., 1.04 as
reported in the H.3 Federal Reserve Statistical Release. Let hi denote this average imputed
normalized translated reserve balance for bank i. Finally, we let K = {0, . . . , 250}, kÌ„0 = 100,
P249
1 P
and set nk (T ) = 134
i I{hi âˆˆ[kâˆ’kÌ„0 ,kâˆ’kÌ„0 +1)} for k = 0, ..., 249, and n250 (T ) = 1 âˆ’
k=0 nk (T ).
We normalize kÌ„ = 1, so k can be interpreted as a multiple of the reserve requirement.
Since the results are insensitive to small values of r, we set r = 0. Most transactions are
strict concavity property. In Appendix A (Section A.3, Corollary 2) we show that if instead of Assumption A
we assume that u satisfies discrete midpoint strict concavity and U satisfies discrete midpoint concavity, then the
existence and uniqueness results in Proposition 2 still hold.
14
Banks that require special analysis include but are not limited to bankers banks, entities primarily conducting
credit card activities, and standalone internet banks.
15
The information on reserve balances is from Daylight Overdraft Reporting and Pricing System (DORPS)
and two other internal Federal Reserve data sets: Discount window primary credit lending program and Required
operating balances.

16

settled through Fedwire, and Fedwire does not operate for 2.5 hours between 6:30 pm and 9:00
pm, so the settlement lags âˆ† and âˆ†f are set to âˆ† = âˆ†f = 2.5/24, which means that banks
regard all loans (to other banks or to the Fed) as being repaid at the beginning of the following
c
o
working day. The values of the policy rates idâˆ’ , id+ , irf , ief , iw
f , if , and if are chosen to mimic

policies in the United States during the second quarter of 2007. The interest rate charged
on daylight overdrafts, idâˆ’ , is set to 0.0036/360.16 The interest rate paid on positive intraday
balances, id+ , is set to 10âˆ’7 /360 (one-thousandth of a basis point, annualized).17 The Federal
Reserve did not pay interest on reserves prior to October 2008, so irf = ief = 0. The total
w
w
w
per-dollar cost of borrowing from the discount window is iw
f = i + P , where i is the window

discount rate and P w represents the pecuniary value of the additional costs associated with
discount window borrowing (such as administrative costs and stigma). The deficiency charge
for failing to meet the reserve requirement is icf = ic + P c , where ic is the overnight interest
rate charged on the shortfall and P c represents the pecuniary value of additional penalties that
the bank may suffer for failing to meet reserve requirements. The overnight overdraft penalty
rate is iof = io + P o , where io is the interest rate on the overdraft and P o represents additional
penalties resulting from the use of unauthorized overnight credit. The interest rate on discount
window loans under the Primary Credit Facility was 6.25 percent per annum in the second
quarter of 2007, so we set iw = 0.0625/360. The penalty rate charged for reserve deficiencies
is 100 basis points above the Primary Credit Facility discount window lending rate on the first
day of the calendar month in which the deficiency occurred, so we set ic = 0.0725/360. The
interest penalty on overnight overdrafts is 400 basis points above the effective fed funds rate.
The average daily effective fed funds rate during the second quarter of 2007 was 5.25 percent
per annum, so we set io = 0.0925/360. In the baseline we set P c = P o = P w .18 We calibrate
P w and Î±, so that the equilibrium of the model is consistent with the following two targets:
16
In practice, when an institution has insufficient funds in its Federal Reserve account to cover its settlement
obligations during the operating day, it can incur a daylight overdraft up to an individual maximum amount
known as net debit cap. (This cap is equal to zero for some institutions.) On March 24, 2011, the Federal Reserve
Board implemented major revisions to the Payment System Risk policy, which include a zero fee for collateralized
daylight overdrafts and an increased fee for uncollateralized daylight overdrafts to 50 basis points (annual rate)
from the prior level of 36 basis points that we use in our baseline (see Federal Reserve, 2010a).
17
The interest that a bank receives for holding positive intraday reserves has actually been zero in the United
States. We set id+ to a small positive number and  = 10âˆ’6 , a negligible positive number, only to ensure
that {uk }kâˆˆK satisfies the discrete midpoint strict concavity property, which significantly simplifies our solution
algorithm. A negligible id+ has only a negligible effect on the equilibrium rates.
18
Corollary 3 (in Appendix A, Section A.4) reports a simple closed-form expression for Uk for parametrizations
o
w
c
r
such as this one, which satisfy ief < iw
f â‰¤ if and if < if + if . None of the quantitative results are sensitive to
c
o
the specific values of P or P provided these inequalities are satisfied.

17

(a) the fed funds rate during the second quarter of 2007, which was 0.0525 per annum, and (b)
the standard deviation of the empirical end-of-day distribution of average normalized reserve
balances (for the two-week holding period used to estimate the initial distribution), which was
0.92. This calibration strategy implies P w = 0.0525/360 and Î± = 120.19

6.2

Simulation

With the parameter values reported in Section 6.1, we simulated the equilibrium paths of one
million banks. The simulated quantities and prices are presented in Figure 1. The left and
middle columns report several dimensions of trade volume. The top left panel uses box plots
every 15 minutes to describe the evolution of the distribution of loan sizes during the day. The
bottom left panel shows the daily distribution of loan sizes. The theory predicts that loan sizes
decline throughout the trading session and a high concentration of smaller loans. In the middle
column, the top panel shows the distribution of the number of counterparties per bank and the
bottom panel shows the distribution of the proportion of intermediated fundsâ€”the measure
of intermediation introduced in Section 5.3. The equilibrium exhibits a substantial amount of
endogenous intermediation. The right column describes the behavior of the (distribution of)
fed funds rate(s). The top right panel plots in chronological time, t = T âˆ’ Ï„ , at each minute
t during the trading session, the value-weighted average of the cross-sectional distribution of
P
ks (Ï„ ) Ïks (Ï„ ). The bottom right panel exhibits a box plot every 15 minutes of
rates,
Ï‰ij
ij
i,j,k,sâˆˆK

the spread between the theoretical rates on loans traded at minute t = T âˆ’ Ï„ , i.e., Ïks
ij (Ï„ ), and
the value-weighted average of the cross-sectional distribution of rates on all transactions traded
in that minute. The value-weighted fed funds rate remains relatively stable during the trading
session, while the dispersion of spreads increases over time.
Figure 2 describes the evolution of the distribution of reserves. The left panel describes
the intraday evolution of the distribution of reserves by depicting box plots at 15-minute intervals throughout the trading session of the distribution of normalized reserves generated by
the calibrated model and the distribution of average imputed normalized translated reserves
from the data. In order to assess the model fit, notice that during the last 2.5 hours of the
19

With these values the equilibrium value-weighted daily average fed funds rate implied by the model (ÏÌ„ as
defined in Section 5.2) is 0.052 per annum, and the standard deviation of the end-of-day distribution of balances
implied by the model is 0.85. The value Î± = 120 implies that banks have an average of about 12.5 meetings
during the trading session, i.e., a trading opportunity every 12 minutes, on average. The implied equilibrium
mean and median numbers of trading partners per bank during the session are 7.3 and 7, respectively. The
implied equilibrium proportion of intermediated funds in the theory (i.e., as defined in Section 5.3) is 0.67.

18

typical trading day, the theoretical distribution of banksâ€™ reserves follows a clear pattern of
convergence that replicates quite well the pattern of convergnece of the empirical distribution.
The right panel of Figure 2 shows that the standard deviation of the cross-sectional distribution of reserves, both in the model and in the data, falls over timeâ€”another indication that
the market is continuously reallocating reserves from banks with larger balances to banks with
smaller balances. The initial distribution and standard deviation of the end-of-day distribution
from the model match the data by construction (the initial distribution is estimated from data,
and Î± is calibrated so that the standard deviation of the end-of-day distribution in the model
matches its empirical counterpart). Figure 2 shows the degree to which the model is able to
track the whole intraday path of the empirical distribution of reserves, i.e., the degree to which
the theory can successfully capture the dynamics of the reallocation of reserves during the last
stretch of a typical trading day. The rate of convergence of reserve balances in the model is
uniform throughout the trading session, while in the data it appears to be faster in the last
hour of the trading session (it speeds up some time between 5:15 pm and 5:30 pm). A richer
model in which the contact rate is allowed to be time dependent (either exogenously or if banks
could choose search intensity) may have a better chance at capturing the acceleration in the
convergence of reserve balances that we see in the data.

6.3

Policy evaluation

During the five years prior to the onset of the 2008-2009 financial crisis, total reserve balances
held by depository institutions in the United States fluctuated between $38 billion and $56
billion, and required reserves stood between 80 percent and 99 percent of total reserves. Total
reserves increased dramatically from about $41.5 billion in the months prior to September 2008
to more than $900 billion in January 2009. Most of the increase was accounted for by a sharp
rise in excess reserves, which represented more than 93 percent of total reserves in January 2009
(up from less than 3 percent in the months prior to September 2008). This context of large
excess reserves still persists today, six years later. On the policy front, the Emergency Economic
Stabilization Act of 2008 authorized the Federal Reserve to pay interest on reserve balances
held by or on behalf of depository institutions beginning October 1, 2008. With this authority,
the Federal Reserve Board approved a rule to amend its Regulation D, and the Federal Reserve
Banks began paying interest on reserves on October 9, 2008.
The unprecedented scale of excess reserves and the new policy instruments at the disposal

19

of the Federal Reserve raise important questions regarding the Fedâ€™s ability to adjust its policy
stance. For example, how large an open market operation would be necessary to increase the
fed funds rate by 25 basis points in a context with excess reserves standing above $1 trillion?
Is it possible to uncouple the quantity of reserves from the implementation of the interest rate
target? And if so, what is the elasticity of the fed funds rate to changes in the interest on
reserves? These issues have been receiving much attention in policy circles.20 We perceive a
growing need for quantitative models that can be used to explore the effectiveness of the interest
rate on reserves as a tool to manage the fed funds rate. In this section we take steps toward
meeting this demand.
As in Section 6.1, we think of nk (T ) as the model counterpart of the empirical proportion
of commercial banks whose balances at the beginning of the trading session are k/kÌ„ times larger
than their average daily reserve requirement over a two-week holding period. In order to conduct
policy and counterfactual experiments, it is useful to work with a parametric distribution of
balances, so instead of working with the empirical frequency of balances as in Section 6.1, here
we estimate the initial distribution with 2011 data by maximum likelihood using a Gaussian
mixture model with 2 components.21 Let Î¦ denote the cumulative distribution function of
the Gaussian mixture with parameters Âµ1 = 3.65 and Âµ2 = 46.32 (the means), Ïƒ1 = 4.78 and
Ïƒ2 = 44.93 (the standard deviations), and p1 = 1 âˆ’ p2 = 0.67 (the probability of drawing from
the first component), which we use to represent the distribution of average imputed normalized
translated reserve balances at 4:00 pm during the first quarter of 2011. Notice that ÂµÌ„ â‰¡
p1 Âµ1 + p2 Âµ2 = 17.7, which is the empirical mean of the ratio of seasonally adjusted reserves to
required reserves of all depository institutions during the first quarter of 2011 reported in the
H.3 Federal Reserve Statistical Release.22 In order to feed this distribution into the model, we
20

See Ennis and Wolman (2010), Goodfriend (2002), and Keister et al. (2008) for policy discussions. Keister
et al. (2008) conclude, â€œWhile the floor system has received a fair amount of attention in policy circles recently,
there are important open questions about how well such a system will work in practice. Going forward, it will
be useful to develop theoretical models of the monetary policy implementation process that can address these
questions.â€ Ennis and Wolman (2010) stress, â€œIn contrast to the predictions of simple theories, the interest on
reserves (IOR) rate has not acted as a floor on the federal funds rate. It is now well-understood why certain
institutional features of the fed funds market and the IOR program should prevent the IOR rate from acting as
a floor, but the precise determination of the fed funds rate in this environment remains poorly understood.â€
21
See Appendix C (Section C.2) for a detailed description of our estimation procedure.
22
As was the case in Section 6.1 for 2007, our sample of banks for 2011 has an average ratio of reserve balances
to required operating balances that is somewhat higher than the ratio for all banks, so we translate the estimated
distribution so that its mean matches the empirical mean of the ratio of seasonally adjusted reserves to required
reserves of all depository institutions during the first quarter of 2011 as reported in the H.3 Federal Reserve
Statistical Release.

20

let kÌ„ = 1 (so k can be interpreted as a multiple of the reserve requirement), K = {0, . . . , 250},
kÌ„0 = 100, and nk (T ) = Î¦(k âˆ’ kÌ„0 + 1) âˆ’ Î¦(k âˆ’ kÌ„0 ) for k = 1, ..., 249, n0 (T ) = Î¦ (âˆ’100), and
P
n250 (T ) = 1 âˆ’ Î¦ (150). By construction, Q â‰¡ 250
k=0 (k âˆ’ kÌ„0 )nk (T ) â‰ˆ ÂµÌ„ = 17.7.
For the policy experiments that follow, we recalibrate the model so that the equilibrium is
in line with market conditions on a typical day in 2011.23 The values of the policy rates idâˆ’ ,
c
o
r
e
iw
f , if , if , if , and if are all chosen to mimic the policies in place in the United States during
c
w
the first quarter of 2011. Specifically, idâˆ’ = 0.0036/360, iw
f = 0.0075/360, if = if + 0.01/360,

and irf = ief â‰¡ if = 0.0025/360. The effective fed funds rate was about 15 basis points, and
the overnight overdraft rate, iof , was set at 400 basis points above the effective fed funds rate
during 2011, so iof = 0.0415/360.
We set P c = P o = P w = 0 and Î± = 1 so the equilibrium is consistent with: (a) an upper
band of the fed funds rate target of about 0.0025 per annum and (b) the standard deviation of
the empirical end-of-day distribution of average normalized reserve balances (for the two-week
holding period used to estimate the initial distribution), which was 35.3.24 All other parameter
values, i.e., r, T , âˆ†, âˆ†f , and id+ , are set as in the calibration of Section 6.1.
The policy experiments consist of varying either if or iw
f for different values of Q. In the
P250
theory, Q â‰¡
k=0 (k âˆ’ kÌ„0 )nk (T ) is the quantity of reserves held by the banking system as
a whole, while kÌ„ is the reserve requirement of the consolidated banking system. Hence Q/kÌ„
indicates whether total reserve balances are scarce or abundant relative to the total amount of
required reserves on a given day, and we can represent different market conditions by varying
Q.25 For example, a situation with Q/kÌ„ small may result from an open market sale at the onset
of the trading session. We conduct three types of policy experiments, and for each we consider
seven scenarios depending on the value of Q/kÌ„, namely, 0.1, 0.5, 1, 5, 10, 15, and 30.
The first experiment consists of increasing the interest paid on reserves, if , by 25 basis
23

Section D.1 in Appendix D reports the results of similar counterfactual policy experiments for 2007.
With this parametrization, the equilibrium of the model delivers a value-weighted daily average fed funds
rate of 0.0031 per annum and a standard deviation of the end-of-day distribution of balances equal to 32. While
P w = 0 allows the model to replicate the much lower fed funds rate prevailing in 2011 relative to 2007, a lower
value of P w for 2011 than for 2007 is also in line with recent efforts by the Federal Reserve to make the discount
window more accessible and less stigmatic. The small value of Î± allows the model to capture a context in which
there is little trade between banks, as has been the case since excess reserves sharply increased in 2009.
25
Since for a large enough grid, K, our procedure ensures Q â‰ˆ ÂµÌ„, we vary Q by varying ÂµÌ„. The desired value
of Q for each experiment is achieved by using a Gaussian mixture with parameters (Âµ1 (Q), Âµ2 (Q), Ïƒ1 , Ïƒ1 , p1 ),
where Âµi (Q) â‰¡ QÂµi /ÂµÌ„, and cumulative distribution function denoted by Î¦(Â·; Q), and then setting the initial
distribution of balances to nk (T ) = Î¦(k âˆ’ kÌ„0 + 1; Q) âˆ’ Î¦(k âˆ’ kÌ„0 ; Q) for k = 1, ..., 249, n0 (T ) = Î¦(âˆ’100; Q), and
n250 (T ) = 1 âˆ’ Î¦(150; Q).
24

21

points from 0 to 75 basis points while leaving the discount window rate, iw
f , fixed at its baseline
value (75 basis points). The second experiment consists of increasing iw
f by 25 basis points
from 25 to 150 basis points while leaving if at its baseline value (25 basis points). The implied
values of the equilibrium (value-weighted) daily average fed funds rate, ÏÌ„, for the first and
second experiments are summarized in Table 1 and Table 2, respectively. In both tables, the
first scenario, Q/kÌ„ = 0.1, represents a day in which reserves are very scarce in the sense that the
consolidated banking system holds balances that are only one-tenth of the required reserves. In
the seventh scenario, Q/kÌ„ = 30, the quantity of reserves in the system is very large relative to
the quantity of required reserves, similar to what is the case on a typical day nowadays. In this
case, the equilibrium fed funds rate essentially varies one-for-one with the interest on reserves,
if , and is insensitive to the discount window rate, iw
f . The fed funds rate is sensitive to both
policy rates when market conditions are less extreme (in terms of the size of the total reserves
relative to required reserves). For example, if the market is â€œbalanced,â€ e.g., if Q/kÌ„ = 1, then
an increase of 25 basis points in either policy rate increases the equilibrium fed funds rate
roughly by a half of 25 basis points. As we explain below, the â€œhalfâ€ results from the fact
that the bargaining power of all banks is equal to one-half in our baseline calibration. Other
intermediate market conditions give different intermediate results; for example, if Q/kÌ„ = 10,
then an increase of 25 basis points in the interest rate paid on reserves increases the fed funds
rate by about 20 basis points, while an increase of 25 basis points in the discount window rate
would increase the fed funds rate by about 5 basis points. The responsiveness of the equilibrium
fed funds rate with respect to if increases with Q/kÌ„, while the opposite is true for iw
f.
For a given policy, the equilibrium fed funds rate is decreasing in the overall quantity of
funds in the system, Q/kÌ„, as can be seen by following any of the rows in Table 1 or Table 2 from
left to right. Notice that the equilibrium fed funds rate typically lies in an interval [if +Îµ, iw
f +Îµ].
Such an interval is often referred to as a channel or corridor by central bankers.26 In Table
1 the corridor gets narrower as if increases, and in the limit when if â†’ iw
f = 0.0075 (the
26

The value of Îµ is slightly above half a basis point in our calculations. (It is not exactly zero, because in
the baseline calibration, banks have a small yet positive, concave intraday payoff from holding reserves.) Many
central banks, e.g., the European Central Bank and the central banks of Australia, Canada, and England, use
a channel or corridor system to implement monetary policy. The system consists of a lending facility that
resembles the discount window in the United States, from which banks are allowed to borrow freely (typically
against acceptable collateral) at an interest rate equal to the target rate plus a fixed number of basis points.
There is also a deposit facility that allows banks to earn overnight interest on reserves at a rate equal to the
target rate minus a fixed number of basis points. Hence interest rates at the two standing facilities form a channel
or corridor around the target rate.

22

last row), the interval collapses to a point: the equilibrium rate can only equal 0.0075 + Îµ and
therefore becomes insensitive to Q/kÌ„. Similarly, the equilibrium rate tends to remain equal to
0.0025 + Îµ for any value of Q/kÌ„ as iw
f â†’ if = 0.0025 (first row of Table 2).
For the third experiment we set iw
f = if + w, where w denotes a number of basis points
per annum, and increase if by 25 basis points from 0 to 100 basis points. The implied values
of ÏÌ„ for w = 0.0025/360 are reported in Table 3. The equilibrium fed funds rate is always
inside a corridor [if + Îµ, if + w + Îµ] (the value of Îµ is slightly above half a basis point). These
experiments amount to shifting the whole corridor, keeping its width, w, constant. As before,
the exact position of the equilibrium fed funds rate within this corridor depends on the amount
of reserves relative to required reserves, Q/kÌ„. For example, from the last column of Table 3,
it is clear that if reserves are very abundant, the equilibrium fed funds rate coincides with the
lower limit of the corridor, if +Îµ. As the market becomes more balanced, i.e., as Q/kÌ„ gets closer
to 1, the equilibrium fed funds rate approaches the middle of the corridor. Finally, notice that
shifting the whole corridor up by x basis points (keeping the corridor width, w, fixed) increases
the equilibrium fed funds rate by x basis points.
Figure 3 illustrates the equilibrium value-weighted daily average fed funds rate, ÏÌ„, as a function of the ratio of overall reserves to required reserves, Q/kÌ„. This figure was generated using
the parametrization corresponding to the third row of Table 2 (i.e., the baseline calibration
with the policy rates in place in the first quarter of 2011, if = 0.0025/360 and iw
f = 0.0075). If
one thinks of open-market operations as interventions that change the marketwide availability
of reserves relative to the reserve requirement, the curve displayed in Figure 3 shows the effect
thatâ€”all else equalâ€”open market sales or purchases of various sizes would have on the equilibrium fed funds rate when carried out against the background of different interest-on-reserves
or Discount-Window rates.27
Discussion

Tables 1 and 2 show that if excess reserves are abundant, then if is a powerful

tool for managing ÏÌ„ but iw
f is relatively ineffective, while the opposite is true if total reserves are
small relative to the aggregate reserve requirement. The experiments also show that if either if
or iw is increased by x basis points in a balanced market, then ÏÌ„ will increase by about one-half
of x. Table 3 shows that ÏÌ„ will be very close to if (the floor of the corridor) if excess reserves
are abundant, that it lies almost exactly in the middle of the corridor if the market is balanced,
27

Each panel in Figure 4 (in the online appendix) shows how ÏÌ„ changes with Q/kÌ„ for a different policy stance
defined by a pair of policy rates if and iw
f .

23

and that it tends to get closer to iw (the corridor ceiling) as reserves become scarce. This table
also shows that if both if and iw are increased by x basis points, then ÏÌ„ will increase by exactly
x basis points.
In order to explain these findings and to show explicitly what are the key determinants of
the equilibrium distribution of fed funds rates negotiated between banks throughout the day,
consider the special case of the theory with K = {0, 1, 2}. This case is simple because there can
only be mutually beneficial trade between a bank with i = 2 and a bank with j = 0 balances, so
the loan size must equal 1 in every trade. Hence, from (12), there is a single bilateral interest
rate, 1 + Ï (Ï„ ) = R (Ï„ ), at each point in time. In this context it is natural to refer to a bank
with i = 2 and a bank with j = 0 as the lender and borrower, respectively, and to let Î¸ âˆˆ [0, 1]
be the bargaining power of the borrower. If we let the end-of-day parameters satisfy kÌ„0 = 0,
r
c
kÌ„ = 1, âˆ†f = âˆ† and ief < iw
f < if + if (a condition on policy rates that is satisfied in our baseline

calibration), (13) reduces to
ï£±
âˆ’râˆ† (iw âˆ’ ir )
if k = 0
ï£² âˆ’e
f
f
âˆ’râˆ†
r
if k = 1
e
(1 + if )
Uk =
ï£³ âˆ’râˆ†
e
(2 + irf + ief ) if k = 2.

(15)

We can interpret a bank with k = 1 as being â€œon targetâ€ (holding the level of required reserves),
a bank with k = 2 as being â€œabove targetâ€ (holding excess reserves), and a bank with k = 0 as
being â€œbelow targetâ€ (unable to meet the reserve requirement). In this setting the quantity of
reserves in the market, Q, equals n1 (T ) + 2n2 (T ), so Q â‰¤ 1 if and only if n2 (T ) â‰¤ n0 (T ), i.e.,
since the total amount of required reserves is kÌ„ = 1, the consolidated banking system is short
of reserves if n2 (T ) â‰¤ n0 (T ) and holds excess reserves otherwise. If we set uk = 0 (which is
essentially true in our calibration) the equilibrium interest rate can be solved for explicitly:
Ï (Ï„ ) = Î˜ (Ï„ ) ief + [1 âˆ’ Î˜ (Ï„ )] iw
f,

(16)

where
Î˜ (Ï„ ) â‰¡

Î¸[n2 (T )âˆ’eâˆ’Î±[n2 (T )âˆ’n0 (T )](T âˆ’Ï„ ) n0 (T )]eâˆ’Î±Î¸[n2 (T )âˆ’n0 (T )]Ï„ +[1âˆ’eâˆ’Î±Î¸[n2 (T )âˆ’n0 (T )]Ï„ ]n2 (T )
.
n2 (T )âˆ’eâˆ’Î±[n2 (T )âˆ’n0 (T )]T n0 (T )

Notice that Î˜ (Ï„ ) âˆˆ [0, 1], with Î˜ (0) = Î¸, and âˆ‚Î˜ (Ï„ ) /âˆ‚Î¸ > 0 for all Ï„ . It is possible to show
that if n2 (T ) < n0 (T ), then 0 â‰¤ Î˜ (Ï„ ) â‰¤ Î¸ with Î˜0 (Ï„ ) < 0, and conversely, if n0 (T ) < n2 (T ),
then Î¸ â‰¤ Î˜ (Ï„ ) â‰¤ 1 with Î˜0 (Ï„ ) > 0. Thus Î˜ (Ï„ ) can be thought of as a borrowerâ€™s effective
bargaining power at time T âˆ’Ï„ , determined by the borrowerâ€™s fundamental bargaining power, Î¸,
24

as well as his ability to realize gains from trade in the time remaining until the end of the trading
session, which depends on the evolution of the endogenous distribution of balances across banks.
For example, if n0 (T ) < n2 (T ), it is relatively difficult for banks with excess balances to find
potential borrowers, and Î˜ (Ï„ ) is larger than Î¸ throughout the trading session. In this case the
lendersâ€™ effective bargaining power, 1 âˆ’ Î˜ (Ï„ ), increases toward their fundamental bargaining
power, 1 âˆ’ Î¸, as the trading session progresses, reflecting the fact that although borrowers face
a favorable distribution of potential trading partners throughout the session, their chances to
execute the desired trade diminish as the end of the session draws closer. In the special case
where the market is â€œbalanced,â€ i.e., if n0 (T ) = n2 (T ), we have Î˜ (Ï„ ) = Î¸ for all Ï„ .
According to (16), the fed funds rate is a time-varying weighted average of the lenderâ€™s
end-of-day return on the second unit of balances, ief , and the borrowerâ€™s end-of-day reservation
value for the first unit of balances, iw
f . The weight on the former at time T âˆ’ Ï„ is Î˜ (Ï„ ), i.e.,
the borrowerâ€™s effective bargaining power at time T âˆ’ Ï„ . Notice that a 1 percent increase in the
overnight interest rate that the central bank pays on excess reserves, ief , causes a Î˜ (Ï„ ) percent
increase in the fed funds rate at time T âˆ’ Ï„ . A 1 percent increase in the overnight cost of a
deficient balance, iw
f , causes a 1 âˆ’ Î˜ (Ï„ ) percent increase in the fed funds rate at time T âˆ’ Ï„ .
It is possible to show that if n2 (T ) is very large relative to n0 (T ) (i.e., if Q/kÌ„ is very large),
then Î˜ (Ï„ ) is very close to 1 for most of the trading session, which explains why ÏÌ„ is very close
to the floor of the corridor in the last column of Table 3 as well as why it moves basis point for
basis point with the floor of the corridor in the last column of Table 1. And clearly, if Q/kÌ„ = 1
and Î¸ = 1/2, then Ï (Ï„ ) = ÏÌ„ = (1/2) (ief + iw
f ), consistent with the experiments reported in
the middle columns of Tables 1, 2 and 3). Since policy discussion is often organized around
the competitive static model of Poole (1968), it is interesting to point out that the curves in
Figure 3 and in Figure 4 (in the online appendix) are reminiscent of those that would be traced
out by the equilibrium points resulting from progressively shifting the standard vertical supply
of reserves in the popular â€œPoole modelâ€ (see, e.g., Ennis and Keister, 2008 or Keister et al.,
2008).

7

Conclusion

The model we have developed is strikingly simple: banks randomly contact other banks over
time and bargain the terms of the loans. Given the wide range of theoretical and quantitative
results that the model delivers, we regard its simplicity as a virtue. We recognize, however, that
25

there are several aspects of the real-world market for federal funds that our theory abstracts
from, and we think that this opens up several interesting avenues for future work.
Available estimates suggest that the bulk of fed funds trade is direct trade between banks.
But there is a segment of the market intermediated by specialized brokers that are not themselves commercial banks, so it would be interesting to incorporate them into the model.
The model is well suited to describe the last 2.5 hours of the typical trading session, when
unexpected payment shocks are rare. In order to model trade dynamics throughout the whole
day, the theory could be extended to allow for random payment shocks that induce exogenous
reallocations of reserves among banks. Also, we have focused on trade dynamics within a typical
day, but the theory could be extended to encompass a sequence of trading sessions like the one
we have modeled.
The baseline model has banks that only differ in their initial holdings of reserves. Our
perusal of available data suggests that it would be a fruitful task to extend the quantitative
work to allow for heterogeneity among banks in terms of their relative bargaining strengths,
the rates at which they can contact potential trading partners, and the payoffs from holding
reserve balances.
We have assumed random search, which may be a reasonable assumption for settings in
which banks are completely uninformed about potential counterpartiesâ€™ balances before a contact takes place. However, in reality some banks may have some information about which
counterparties are more likely to be long or short on any given day, so for some questions it
may be useful to extend the model to incorporate some degree of directedness in search.
We have abstracted from default risk. This may be an interesting feature to add, e.g.,
to study interbank markets during times of financial stress. Other natural extensions involve
incorporating private information, e.g., regarding the reserve balances held by each bank or
about the likelihood that a counterparty may fail to repay at the stipulated time.

26

A

Proofs

A.1

Value function

Let the function Jk (x, Ï„ ) : K Ã— R Ã— [0, T ] â†’ R denote the maximum attainable payoff to a bank
that holds k âˆˆ K units of reserve balances and whose net credit position is x âˆˆ R when the
time until the end of the trading session is Ï„ âˆˆ [0, T ]. Let s = (k, x) âˆˆ K Ã— R denote the bankâ€™s
individual state. Then,
(Z

min(Ï„Î± ,Ï„ )

Jk (x, Ï„ ) = E
0
âˆ’rÏ„Î±

+ I{Ï„Î± â‰¤Ï„ } e

eâˆ’rz uk dz + I{Ï„Î± >Ï„ } eâˆ’rÏ„ Uk + eâˆ’râˆ† x



Z

(17)
0

Jkâˆ’bss0 (Ï„ âˆ’Ï„Î± ) (x + Rs0 s (Ï„ âˆ’ Ï„Î± ) , Ï„ âˆ’ Ï„Î± ) Âµ ds , Ï„ âˆ’ Ï„Î±




,

where E is an expectation operator over the exponentially distributed random time until the
next trading opportunity, Ï„Î± , and I{Ï„Î± â‰¤Ï„ } is an indicator function that equals 1 if Ï„Î± â‰¤ Ï„ and 0
otherwise. For each time Ï„ âˆˆ [0, T ] until the end of the trading session, Âµ (Â·, Ï„ ) is a probability
measure (on the Borel Ïƒ-field of the subsets of K Ã— R) that describes the heterogeneity of potential trading partners over individual states, s0 = (k 0 , x0 ). The pair (bss0 (Ï„ âˆ’ Ï„Î± ) , Rs0 s (Ï„ âˆ’ Ï„Î± ))
denotes the bilateral terms of trade between a bank with state s and a (randomly drawn) bank
with state s0 , when the remaining time is Ï„ âˆ’Ï„Î± . That is, bss0 (Ï„ âˆ’ Ï„Î± ) is the amount of balances
that the bank with state s lends to the bank with state s0 , and Rs0 s (Ï„ âˆ’ Ï„Î± ) is the amount of
balances that the latter commits to repay at time T + âˆ†.
For all Ï„ âˆˆ [0, T ] and any (s, s0 ) with s, s0 âˆˆ K Ã— R, we take (bss0 (Ï„ ) , Rs0 s (Ï„ )) to be the
outcome corresponding to the symmetric Nash solution to a bargaining problem.28 Thus the
bargaining outcome, (bss0 (Ï„ ) , Rs0 s (Ï„ )), is the pair (b, R) that solves
max

bâˆˆÎ“(k,k0 ),RâˆˆR


 1
1 
[Jkâˆ’b (x + R, Ï„ ) âˆ’ Jk (x, Ï„ )] 2 Jk0 +b x0 âˆ’ R, Ï„ âˆ’ Jk0 x0 , Ï„ 2 .

Below, in Lemma 2, we show that
Jk (x, Ï„ ) = Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) x
28

(18)

This axiomatic Nash solution can also be obtained from a strategic bargaining game in which, upon contact,
Nature selects one of the banks with probability one-half to make a take-it-or-leave-it offer, which the other bank
must either accept or reject on the spot. It is easy to verify that the expected equilibrium outcome of this game
coincides with the solution to the Nash bargaining problem, subject to the obvious reinterpretation of Rs0 s (Ï„ )
as an expected repayment, which is inconsequential. See Appendix C in Lagos and Rocheteau (2009).

27

satisfies (17), if and only if Vk (Ï„ ) : K Ã— [0, T ] â†’ R satisfies (1) for all (k, Ï„ ) âˆˆ K Ã— [0, T ], with (2)
and (3). Note that in (2) and (3) we use (bkk0 (Ï„ ) , Rk0 k (Ï„ )) (rather than (bss0 (Ï„ ) , Rs0 s (Ï„ ))) to
denote the bargaining outcome between a bank with individual state s âˆˆ KÃ—R and a bank with
individual state s0 âˆˆ K Ã— R, in order to stress that this outcome is independent of the banksâ€™
net credit positions, x and x0 . Before proving Lemma 2, we establish the following preliminary
result.
Lemma 1 For any (k, k 0 ) âˆˆ K Ã— K and any Ï„ âˆˆ [0, T ], consider the following problem:
h

max

bâˆˆÎ“(k,k0 ),RâˆˆR

Vkâˆ’b (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R

iÎ¸kk0 h

Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) R

i1âˆ’Î¸kk0

, (19)

where Î¸kk0 = 1 âˆ’ Î¸k0 k âˆˆ [0, 1], and Vk (Ï„ ) : K Ã— [0, T ] â†’ R is bounded. The correspondence
h
iÎ¸kk0

âˆ—
0
H k, k , Ï„ ; V = arg
max
Vkâˆ’b (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R
bâˆˆÎ“(k,k0 ),RâˆˆR
h
i1âˆ’Î¸kk0 
âˆ’r(Ï„ +âˆ†)
Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ e
R
is nonempty. Moreover, (bkk0 (Ï„ ) , Rk0 k (Ï„ )) âˆˆ H âˆ— (k, k 0 , Ï„ ; V ) if and only if
bkk0 (Ï„ ) âˆˆ arg max [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] , and

(20)





eâˆ’r(Ï„ +âˆ†) Rk0 k (Ï„ ) = Î¸kk0 Vk0 +bkk0 (Ï„ ) (Ï„ ) âˆ’ Vk0 (Ï„ ) + (1 âˆ’ Î¸kk0 ) Vk (Ï„ ) âˆ’ Vkâˆ’bkk0 (Ï„ ) (Ï„ ) .

(21)

bâˆˆÎ“(k,k0 )

Proof of Lemma 1. Define
R = er(Ï„ +âˆ†) max {Î¸kk0 [Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ )] + (1 âˆ’ Î¸kk0 ) [Vk (Ï„ ) âˆ’ Vkâˆ’b (Ï„ )]}

(22)

R = er(Ï„ +âˆ†)

(23)

bâˆˆÎ“(k,k0 )

min {Î¸kk0 [Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ )] + (1 âˆ’ Î¸kk0 ) [Vk (Ï„ ) âˆ’ Vkâˆ’b (Ï„ )]} ,

bâˆˆÎ“(k,k0 )

and consider
max

h

(b,R)âˆˆÎ“Ìƒ(k,k0 )

Vkâˆ’b (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R

iÎ¸kk0 h

Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) R

i1âˆ’Î¸kk0

, (24)




where Î“Ìƒ (k, k 0 ) = (b, R) âˆˆ Î“ (k, k 0 ) Ã— R, R . Since Vk (Ï„ ) is bounded, âˆ’âˆ < R â‰¤ R < âˆ, so
(24) has at least one solution. Let (bâˆ— , Râˆ— ) denote a solution to (24). If we ignore the constraints
R â‰¤ R â‰¤ R, then (bâˆ— , Râˆ— ) must satisfy the following first-order condition:
eâˆ’r(Ï„ +âˆ†) Râˆ— = Î¸kk0 [Vk0 +bâˆ— (Ï„ ) âˆ’ Vk0 (Ï„ )] + (1 âˆ’ Î¸kk0 ) [Vk (Ï„ ) âˆ’ Vkâˆ’bâˆ— (Ï„ )] .
28

(25)

But then (22) and (23) imply R â‰¤ Râˆ— â‰¤ R, and therefore (bâˆ— , Râˆ— ) solves (24) if and only if it
solves (19). Suppose that (bâˆ— , Râˆ— ) is a solution to (24) such that
bâˆ— âˆˆ
/ arg max [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] .
bâˆˆÎ“(k,k0 )

(26)

Condition (25) implies
Vkâˆ’bâˆ— (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) Râˆ— = Î¸kk0 [Vk0 +bâˆ— (Ï„ ) + Vkâˆ’bâˆ— (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )]
Vk0 +bâˆ— (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) Râˆ— = (1 âˆ’ Î¸kk0 ) [Vk0 +bâˆ— (Ï„ ) + Vkâˆ’bâˆ— (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] ,
so the value of (24) achieved by (bâˆ— , Râˆ— ) is
Î¸

Î¸kkkk0 (1 âˆ’ Î¸kk0 )1âˆ’Î¸kk0 [Vk0 +bâˆ— (Ï„ ) + Vkâˆ’bâˆ— (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] â‰¡ Î¾ âˆ— .
0

But (26) implies that there exists b0 âˆˆ Î“ (k, k 0 ) such that
Î¸

Î¾ âˆ— < Î¸kkkk0 (1 âˆ’ Î¸kk0 )1âˆ’Î¸kk0 [Vk0 +b0 (Ï„ ) + Vkâˆ’b0 (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] .
0

Then since


R0 = er(Ï„ +âˆ†) {Î¸kk0 [Vk0 +b0 (Ï„ ) âˆ’ Vk0 (Ï„ )] + (1 âˆ’ Î¸kk0 ) [Vk (Ï„ ) âˆ’ Vkâˆ’b0 (Ï„ )]} âˆˆ R, R ,
it follows that (b0 , R0 ) achieves a higher value than (bâˆ— , Râˆ— ), so (bâˆ— , Râˆ— ) is not a solution to (24),
a contradiction. Hence, a solution (bâˆ— , Râˆ— ) to (24), or equivalently to (19), must satisfy (25)
and
bâˆ— âˆˆ arg max [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] .
bâˆˆÎ“(k,k0 )

(27)

To conclude, we show that any (bâˆ— , Râˆ— ) that satisfies (25) and (27) is a solution to (19). To see
this, notice that for all (b, R) âˆˆ Î“ (k, k 0 ) Ã— R,
h
iÎ¸kk0 h
i1âˆ’Î¸kk0
Vkâˆ’b (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R
Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) R
h
iÎ¸kk0 h
i1âˆ’Î¸kk0
â‰¤ max Vkâˆ’b (Ï„ ) âˆ’ Vk (Ï„ ) + eâˆ’r(Ï„ +âˆ†) R
Vk0 +b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) R
=
â‰¤

RâˆˆR
Î¸ 0
Î¸kkkk0
Î¸ 0
Î¸kkkk0

(1 âˆ’ Î¸kk0 )1âˆ’Î¸kk0 [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )]
(1 âˆ’ Î¸kk0 )1âˆ’Î¸kk0 max [Vk0 +b (Ï„ ) + Vkâˆ’b (Ï„ ) âˆ’ Vk0 (Ï„ ) âˆ’ Vk (Ï„ )] = Î¾ âˆ— .
bâˆˆÎ“(k,k0 )

Lemma 2 The function Jk (x, Ï„ ) given in (18) satisfies (17) if and only if Vk (Ï„ ) satisfies (1),
with (2) and (3).
29

Proof of Lemma 2. Let B denote the space of bounded real-valued functions defined on
K Ã— [0, T ]. Let B 0 denote the space of functions obtained by adding eâˆ’r(Ï„ +âˆ†) x for some x âˆˆ R,
to each element of B. That is,
n
o
B 0 = g : S â†’ R | g (k, x, Ï„ ) = w (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) x for some w âˆˆ B ,
where S = K Ã— R Ã— [0, T ]. Let s = (k, x) and s0 = (k 0 , x0 ) denote two elements of K Ã— R. For
any g âˆˆ B 0 and any (s, s0 , Ï„ ) âˆˆ K Ã— R Ã— S, let
n

HÌƒ s, s0 , Ï„ ; g = arg
max
[g (k âˆ’ b, x + R, Ï„ ) âˆ’ g (k, x, Ï„ )]Î¸kk0
bâˆˆÎ“(k,k0 ),RâˆˆR
 0
1âˆ’Î¸kk0 o
g(k + b, x0 âˆ’ R, Ï„ ) âˆ’ g(k 0 , x0 , Ï„ )
,
where Î¸kk0 = 1 âˆ’ Î¸k0 k âˆˆ [0, 1] for any k, k 0 âˆˆ K. Since g âˆˆ B 0 , HÌƒ (s, s0 , Ï„ ; g) = H âˆ— (k, k 0 , Ï„ ; w),
where
H

âˆ—

h
iÎ¸kk0
w (k âˆ’ b, Ï„ ) âˆ’ w (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) R
k, k , Ï„ ; w = arg
max
bâˆˆÎ“(k,k0 ),RâˆˆR
h
i1âˆ’Î¸kk0 
0
0
âˆ’r(Ï„ +âˆ†)
w(k + b, Ï„ ) âˆ’ w(k , Ï„ ) âˆ’ e
R
0



for some w âˆˆ B, as defined in Lemma 1. By Lemma 1, H âˆ— (k, k 0 , Ï„ ; w) is nonempty, and
(b(k, k 0 , Ï„ ), R(k 0 , k, Ï„ )) âˆˆ H âˆ— (k, k 0 , Ï„ ; w) if and only if


b(k, k 0 , Ï„ ) âˆˆ arg max w(k 0 + b, Ï„ ) + w (k âˆ’ b, Ï„ ) âˆ’ w(k 0 , Ï„ ) âˆ’ w (k, Ï„ )
bâˆˆÎ“(k,k0 )

(28)

and
 

eâˆ’r(Ï„ +âˆ†) R(k 0 , k, Ï„ ) = Î¸kk0 w k 0 + b(k, k 0 , Ï„ ), Ï„ âˆ’ w(k 0 , Ï„ )



+ (1 âˆ’ Î¸kk0 ) w(k, Ï„ ) âˆ’ w k âˆ’ b(k, k 0 , Ï„ ), Ï„ .

(29)

The right side of (17) defines a mapping T on B 0 . That is, for any g âˆˆ B 0 and all (k, x, Ï„ ) âˆˆ S,
Z min(Ï„Î± ,Ï„ )

(T g) (k, x, Ï„ ) = E
eâˆ’rz uk dz + I{Ï„Î± >Ï„ } eâˆ’rÏ„ Uk + eâˆ’râˆ† x
0

Z



âˆ’rÏ„Î±
0
0
0
+ I{Ï„Î± â‰¤Ï„ } e
g k âˆ’ b(k, k , Ï„ âˆ’ Ï„Î± ), x + R(k , k, Ï„ âˆ’ Ï„Î± ), Ï„ âˆ’ Ï„Î± Âµ ds , Ï„ âˆ’ Ï„Î±
where b(k, k 0 , Ï„ ) satisfies (28) and R(k 0 , k, Ï„ ) satisfies (29) (for the special case Î¸kk0 = 1/2 for
all k, k 0 âˆˆ K), for w âˆˆ B defined by w (k, Ï„ ) = g (k, x, Ï„ ) âˆ’ eâˆ’r(Ï„ +âˆ†) x for all (k, Ï„ ) âˆˆ K Ã— [0, T ].
Substitute g (k, x, Ï„ ) = w (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) x on the right side of (T g) (k, x, Ï„ ) to obtain
(T g) (k, x, Ï„ ) = (Mw) (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) x,
30

(30)

where M is a mapping on B defined by
Z min(Ï„Î± ,Ï„ )
(Mw) (k, Ï„ ) = E
eâˆ’rz uk dz + I{Ï„Î± >Ï„ } eâˆ’rÏ„ Uk
0
Z



âˆ’rÏ„Î±
+ I{Ï„Î± â‰¤Ï„ } e
w k âˆ’ b(k, k 0 , Ï„ âˆ’ Ï„Î± ), Ï„ âˆ’ Ï„Î± Âµ ds0 , Ï„ âˆ’ Ï„Î±

Z

âˆ’r(Ï„ +âˆ†âˆ’Ï„Î± )
0
0
âˆ’rÏ„Î±
e
R(k , k, Ï„ âˆ’ Ï„Î± )Âµ ds , Ï„ âˆ’ Ï„Î± ,
+ I{Ï„Î± â‰¤Ï„ } e

(31)

for all (k, Ï„ ) âˆˆ K Ã— [0, T ]. Since the right side of (31) is independent of the net credit position
x, after recognizing that Âµ ({(k 0 , x) âˆˆ K Ã— R : k 0 = k} , Ï„ ) = nk (Ï„ ), (31) can be written as
"Z
#
min(Ï„Î± ,Ï„ )
(Mw) (k, Ï„ ) = E
eâˆ’rz uk dz + I{Ï„Î± >Ï„ } eâˆ’rÏ„ Uk
0


X


+ E I{Ï„Î± â‰¤Ï„ } eâˆ’rÏ„Î±
nk0 (Ï„ âˆ’ Ï„Î± ) w k âˆ’ b(k, k 0 , Ï„ âˆ’ Ï„Î± ), Ï„ âˆ’ Ï„Î±
k0 âˆˆK
âˆ’rÏ„Î±

+ I{Ï„Î± â‰¤Ï„ } e

X

nk0 (Ï„ âˆ’ Ï„Î± ) e

âˆ’r(Ï„ +âˆ†âˆ’Ï„Î± )


R(k , k, Ï„ âˆ’ Ï„Î± ) ,
0

(32)

k0 âˆˆK

for all (k, Ï„ ) âˆˆ KÃ—[0, T ]. From (32), it is clear that M is the mapping defined by the right side of
(1). Since w âˆˆ B, and (b(k, k 0 , Ï„ ), R(k 0 , k, Ï„ )) satisfy (28) and (29), it follows that M : B â†’ B,
and together with (30), this implies T : B 0 â†’ B 0 . Notice that g âˆ— = wâˆ— + eâˆ’r(Ï„ +âˆ†) x âˆˆ B 0 is a
fixed point of T if and only if wâˆ— âˆˆ B is a fixed point of M. In the statement of the lemma
and in the body of the paper, the fixed points g âˆ— (k, x, Ï„ ) and wâˆ— (k, Ï„ ) are denoted Jk (x, Ï„ )
and Vk (Ï„ ), respectively.

A.2

Proposition 1

Proof of Proposition 1. Start with the mapping (32), and notice that after writing out the
expectation explicitly and performing a change of variable, it becomes
Z Ï„ X
n 
o

(Mw) (k, Ï„ ) = vk (Ï„ )+Î±
nk0 (z) w k âˆ’ b(k, k 0 , z), z + eâˆ’r(z+âˆ†) R(k 0 , k, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
0 k0 âˆˆK

for all (k, Ï„ ) âˆˆ K Ã— [0, T ], where
"Z
vk (Ï„ ) â‰¡ E

min(Ï„Î± ,Ï„ )

#
âˆ’rz

e
0

uk dz + I{Ï„Î± >Ï„ } e

âˆ’rÏ„

Uk ,

which can be integrated to obtain
h
i u
k
+ eâˆ’(r+Î±)Ï„ Uk .
vk (Ï„ ) = 1 âˆ’ eâˆ’(r+Î±)Ï„
r+Î±
31

(33)

Since b(k, k 0 , Ï„ ) and R(k 0 , k, Ï„ ) satisfy (28) and (29), the previous expression for the mapping
M can be written as
Z

Ï„

(Mw) (k, Ï„ ) = vk (Ï„ ) + Î±
w (k, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
0
Z Ï„X




+Î±
nk0 (z) Î¸kk0 {w k 0 + b(k, k 0 , z), z + w k âˆ’ b(k, k 0 , z), z
0

k0 âˆˆK


âˆ’ w(k , z) âˆ’ w(k, z)} eâˆ’(r+Î±)(Ï„ âˆ’z) dz.
0

In turn, since




w k 0 + b(k, k 0 , z), z + w k âˆ’ b(k, k 0 , z), z âˆ’ w(k 0 , z) âˆ’ w(k, z)


= max w(k 0 + b, z) + w(k âˆ’ b, z) âˆ’ w(k 0 , z) âˆ’ w(k, z)
0
bâˆˆÎ“(k,k )


=
max
w(j, z) + w(i, z) âˆ’ w(k 0 , z) âˆ’ w(k, z) ,
(i,j)âˆˆÎ (k,k0 )

we have
Z Ï„
(Mw) (k, Ï„ ) = vk (Ï„ ) + Î±
w (k, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
Z Ï„ X 0


+Î±
nk0 (z) Î¸kk0
max
w(i, z) + w(j, z) âˆ’ w(k, z) âˆ’ w(k 0 , z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
(i,j)âˆˆÎ (k,k0 )

0 k0 âˆˆK

for all (k, Ï„ ) âˆˆ K Ã— [0, T ]. With relabeling, this mapping can be rewritten as
Z Ï„
(Mw) (i, Ï„ ) = vi (Ï„ ) + Î±
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
(34)
0
Z Ï„ XXX
âˆ’(r+Î±)(Ï„ âˆ’z)
+Î±
nj (z) Î¸ij Ï†ks
dz,
ij (z) [w(k, z) + w(s, z) âˆ’ w(i, z) âˆ’ w(j, z)] e
0 jâˆˆK kâˆˆK sâˆˆK

for all (i, Ï„ ) âˆˆ K Ã— [0, T ], with


â‰¥ 0 if (k, s) âˆˆ â„¦ij [w (Â·, z)]
= 0 if (k, s) âˆˆ
/ â„¦ij [w (Â·, z)] ,
P P ks
for all i, j, k, s âˆˆ K and all z âˆˆ [0, T ], where
Ï†ij (z) = 1, and
Ï†ks
ij (z)

kâˆˆK sâˆˆK

â„¦ij [w (Â·, z)] â‰¡ arg

max

(k0 ,s0 )âˆˆÎ (i,j)



w(k 0 , z) + w(s0 , z) âˆ’ w (i, z) âˆ’ w (j, z) .

From (34) (with Î¸kk0 = 1/2), it is clear that V = MV can be written as
Z Ï„
Vi (Ï„ ) = vi (Ï„ ) + Î±
Vi (z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
0
Z
Î± Ï„ XXX
âˆ’(r+Î±)(Ï„ âˆ’z)
+
nj (z) Ï†ks
dz,
ij (z) [Vk (z) + Vs (z) âˆ’ Vi (z) âˆ’ Vj (z)] e
2 0
jâˆˆK kâˆˆK sâˆˆK

32

(35)

for all (i, Ï„ ) âˆˆ K Ã— [0, T ]. Notice that (35) implies (7). Differentiate both sides of (35) with
respect to Ï„ , and rearrange terms to obtain
VÌ‡i (Ï„ )+rVi (Ï„ ) = vÌ‡i (Ï„ )+(r + Î±) vi (Ï„ )+

Î± XXX
nj (Ï„ ) Ï†ks
ij (Ï„ ) [Vk (Ï„ ) + Vs (Ï„ ) âˆ’ Vi (Ï„ ) âˆ’ Vj (Ï„ )] ,
2
jâˆˆK kâˆˆK sâˆˆK

which together with the fact that vÌ‡i (Ï„ ) = ui âˆ’ (r + Î±) vi (Ï„ ) implies (6).

A.3

Proposition 2

Lemma 3, Corollary 1, Lemma 4, and Lemma 5 are used in the proof of Proposition 2.
Lemma 3 Let g be a real-valued function on K. Then g satisfies
l m
j k
i+j
g i+j
+
g
â‰¥ g (k) + g (s)
2
2

(36)

for any i, j âˆˆ K and all (k, s) âˆˆ Î  (i, j) if and only if it satisfies the discrete midpoint concavity
property,
g

l

i+j
2

m

+g

j

i+j
2

k

â‰¥ g (i) + g (j)

(37)

for all i, j âˆˆ K.
Proof of Lemma 3. Suppose that g satisfies (36). Since the condition holds for all (k, s) âˆˆ
Î  (i, j), and we know that (i, j) âˆˆ Î  (i, j), it holds for the special case (k, s) = (i, j), so g
satisfies (37). To show the converse, notice that since (37) holds for all i, j âˆˆ K, it also holds
for all i, j âˆˆ K such that (i, j) âˆˆ Î  (k, s) for any k, s âˆˆ K. But for any such (i, j), we know that
i + j = k + s, so (37) implies
g

 k+s 
2

+g

 k+s 
2

â‰¥ g (i) + g (j)

for any k, s âˆˆ K and all (i, j) âˆˆ Î  (k, s), which is the same as (36) up to a relabeling.
Corollary 1 The payoff functions {uk }kâˆˆK and {Uk }kâˆˆK satisfy (DMC) and (DMSC) for all
i, j âˆˆ K if and only if they satisfy
ud i+j e + ub i+j c â‰¥ uk + us
2
2
Ud i+j e + Ub i+j c â‰¥ Uk + Us , â€œ > â€ unless k âˆˆ
2
2
for any i, j âˆˆ K and all (k, s) âˆˆ Î  (i, j).
33

nj

i+j
2

k l mo
, i+j
2

Lemma 4 For any given path n (Ï„ ), there exists a unique wâˆ— âˆˆ B that satisfies wâˆ— = Mwâˆ— ,
and a unique g âˆ— âˆˆ B 0 that satisfies g âˆ— = T g âˆ— , defined by g âˆ— (k, x, Ï„ ) = wâˆ— (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) x for
all (k, x, Ï„ ) âˆˆ S.
Proof of Lemma 4. Write the mapping M defined in the proof of Proposition 1 (with
Î¸kk0 = 1/2), as
Z Ï„
(Mw) (i, Ï„ ) = vi (Ï„ ) + Î±
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
0
Z
Î± Ï„X
+
nj (z) max [w(k, z) + w(s, z) âˆ’ w(i, z) âˆ’ w(j, z)] eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
2 0
(k,s)âˆˆÎ (i,j)
jâˆˆK

for all (i, Ï„ ) âˆˆ K Ã— [0, T ]. For any w, w0 âˆˆ B, define the metric D : B Ã— B â†’ R, by

D w, w0 =

sup

h

i
eâˆ’Î²Ï„ w (i, Ï„ ) âˆ’ w0 (i, Ï„ ) ,

(i,Ï„ )âˆˆKÃ—[0,T ]

where Î² âˆˆ R satisfies
max {0, 2Î± âˆ’ r} < Î² < âˆ.

(38)

For the case with Î² = 0, D reduces to the standard sup metric, dâˆ . The metric space (B, dâˆ )
is complete, and since (B, D) and (B, dâˆ ) are strongly equivalent, it follows that (B, D) is
also a complete metric space (see Ok, 2007, pp. 136 and 167). For any w, w0 âˆˆ B, and any
(i, Ï„ ) âˆˆ K Ã— [0, T ],
eâˆ’Î²Ï„ |(Mw) (i, Ï„ ) âˆ’ (Mw0 ) (i, Ï„ )| =
Z Ï„
Z Ï„
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz âˆ’ Î±
w0 (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
= eâˆ’Î²Ï„ Î±
0
0
Z
Î± Ï„X
nj (z) max [w (k, z) + w (s, z) âˆ’ w (i, z) âˆ’ w (j, z)] eâˆ’(r+Î±)(Ï„ âˆ’z) dz
+
2 0
(k,s)âˆˆÎ (i,j)
jâˆˆK
Z Ï„X
 0

Î±
âˆ’
nj (z) max
w (k, z) + w0 (s, z) âˆ’ w0 (i, z) âˆ’ w0 (j, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
2 0
(k,s)âˆˆÎ (i,j)
jâˆˆK
Z Ï„
w (i, z) âˆ’ w0 (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
â‰¤ Î±eâˆ’Î²Ï„
Z0
Î± âˆ’Î²Ï„ Ï„ X
+ e
nj (z)
max [w (k, z) + w (s, z) âˆ’ w (i, z) âˆ’ w (j, z)]
2
(k,s)âˆˆÎ (i,j)
0
jâˆˆK

âˆ’

max

(k,s)âˆˆÎ (i,j)

 0

w (k, z) + w0 (s, z) âˆ’ w0 (i, z) âˆ’ w0 (j, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz.

34

âˆ— (z) , sâˆ— (z)) to denote a solution to the maximization on the right side of Mw, that is,
Use (kij
ij


âˆ—
kij
(z) , sâˆ—ij (z) âˆˆ

max

(k,s)âˆˆÎ (i,j)

[w(k, z) + w(s, z) âˆ’ w(i, z) âˆ’ w(j, z)] .

A solution exists because w âˆˆ B, and Î  (i, j) is a finite set for all (i, j) âˆˆ K Ã— K. Then
eâˆ’Î²Ï„ |(Mw) (i, Ï„ ) âˆ’ (Mw0 ) (i, Ï„ )| â‰¤
Z Ï„
eâˆ’Î²z w (i, z) âˆ’ w0 (i, z) eâˆ’(r+Î±+Î²)(Ï„ âˆ’z) dz
â‰¤Î±

Z0




Î± Ï„X
âˆ—
âˆ—
nj (z) eâˆ’Î²z w kij
(z) , z âˆ’ w0 kij
(z) , z + eâˆ’Î²z w sâˆ—ij (z) , z âˆ’ w0 sâˆ—ij (z) , z
+
2 0
jâˆˆK

âˆ’Î²z
0
âˆ’Î²z
0
+e
w (i, z) âˆ’ w (i, z) + e
w (j, z) âˆ’ w (j, z) eâˆ’(r+Î±+Î²)(Ï„ âˆ’z) dz
h
i

3Î±
1 âˆ’ eâˆ’(r+Î±+Î²)Ï„ D w, w0
r+Î±+Î²

3Î±
D w, w0 .
â‰¤
r+Î±+Î²
â‰¤

Since this last inequality holds for all (i, Ï„ ) âˆˆ KÃ— [0, T ], and w and w0 are arbitrary,

D Mw, Mw0 â‰¤
Notice that (38) implies

3Î±
r+Î±+Î²


3Î±
D w, w0 ,
r+Î±+Î²

for all w, w0 âˆˆ B.

(39)

âˆˆ (0, 1), so M is a contraction mapping on the complete metric

space (B, D). By the Contraction Mapping Theorem (Theorem 3.2 in Stokey and Lucas,
1989), for any given path n (Ï„ ), there exists a unique wâˆ— âˆˆ B that satisfies wâˆ— = Mwâˆ— , and
therefore, by (30), there exists a unique g âˆ— âˆˆ B 0 that satisfies g âˆ— = T g âˆ— , and it is defined by
g âˆ— (k, x, Ï„ ) = wâˆ— (k, Ï„ ) + eâˆ’r(Ï„ +âˆ†) x for all (k, x, Ï„ ) âˆˆ S.
Lemma 5 Let i, j, q âˆˆ K, and (k, s) âˆˆ Î  (i, j).
(i ) If either i + j or s + q is even, then
l

k+q
2

m 
l m 

i+j
, s+q
,q
âˆˆ
Î 
2
2

and

j

k+q
2

k 
j k 

i+j
, s+q
,q .
âˆˆ
Î 
2
2

and

l

k+q
2

m 
j k 

i+j
, s+q
âˆˆ
Î 
,q .
2
2

(ii ) If i + j and s + q are odd, then
j

k+q
2

k 
l m 

i+j
, s+q
âˆˆ
Î 
,q
2
2

35

Proof of Lemma 5. Notice that for any i, j, q âˆˆ K,
Î  (i, j) = {(i + j âˆ’ y, y) âˆˆ K Ã— K : y âˆˆ {0, 1, . . . , i + j}} ,
so
 nl m

n
l m
oo
i+j
i+j
,q =
+
q
âˆ’
y,
y
âˆˆ
K
Ã—
K
:
y
âˆˆ
0,
1,
.
.
.
,
+
q
2
2
j k  nj k

n
j k
oo
i+j
i+j
Î  i+j
,
q
=
+
q
âˆ’
y,
y
âˆˆ
K
Ã—
K
:
y
âˆˆ
0,
1,
.
.
.
,
+
q
.
2
2
2

Î 

l

i+j
2

m

(40)
(41)

For any i, j, q âˆˆ K, define
o
m 

âˆˆ
K
Ã—
K
:
(k,
s)
âˆˆ
Î 
(i,
j)
, s+q
2
nj
k 

o
k+q
s+q 
Î Ì‚ (i, j, q) =
,
âˆˆ
K
Ã—
K
:
(k,
s)
âˆˆ
Î 
(i,
j)
,
2
2

Î Ìƒ (i, j, q) =

nl

k+q
2

and recall that (k, s) âˆˆ Î  (i, j) implies k + s = i + j.
(i ) Assume that either i + j or s + q is even. We first show that given any i, j, q âˆˆ K, (k, s) âˆˆ

l m 
l
m 
i+j
k+q
s+q 
âˆˆ
Î 
Î  (i, j) implies
,
, q . Notice that if either i + j or s + q is even, then
2
2
2


 
 

s+q
i+j
k+q
+
=
+ q.
2
2
2

(42)

With (42),
nl

m l m
l
m
o
k+q
, i+j
+
q
âˆ’
âˆˆ
K
Ã—
K
:
(k,
i
+
j
âˆ’
k)
âˆˆ
Î 
(i,
j)
2
2
n l m

n  l
m
l
moo
q+1
i+j
q
q+i+j
,
=
y, 2 + q âˆ’ y âˆˆ K Ã— K : y âˆˆ
,
.
.
.
,
2
2
2
l m 
i+j
e
â‰¡ Î Ìƒ
,q .
2

Î Ìƒ (i, j, q) =

k+q
2

(43)

l
m 

l m 
s+q 
i+j
k+q
e
âˆˆ
Î Ìƒ
By construction, given any i, j, q âˆˆ K,
,
, q for all (k, s) âˆˆ Î  (i, j).
2
2
2
l
m l m
l m 
q
Since 0 â‰¤ 2 , and q+i+j
â‰¤ i+j
+ q, it follows from (40) and (43) that Î Ìƒe i+j
,q âŠ†
2
2
2
l m 
l
m 

l m 
i+j
k+q
s+q 
i+j
Î 
, q for all i, j, q âˆˆ K, which implies
, 2
âˆˆÎ 
, q for all (k, s) âˆˆ
2
2
2
Î  (i, j), and any i, j, q âˆˆ K.
Next, we show that given any i, j, q âˆˆ K, (k, s) âˆˆ Î  (i, j) implies
j k 
Î  i+j
, q . Notice that if either i + j or s + q is even, then
2


 
 

k+q
s+q
i+j
+
=
+ q.
2
2
2
36

j

k+q
2

k 

, s+q
âˆˆ
2

(44)

With (44),
k j k
j
k
o
k+q
, i+j
+
q
âˆ’
âˆˆ
K
Ã—
K
:
(k,
i
+
j
âˆ’
k)
âˆˆ
Î 
(i,
j)
2
2

n  j
k
j
koo
n j k
q
q+1
q+i+j
i+j
,
,
.
.
.
,
=
y, 2 + q âˆ’ y âˆˆ K Ã— K : y âˆˆ
2
2
2
j k 
i+j
e
â‰¡ Î Ì‚
,q .
2

Î Ì‚ (i, j, q) =

nj

k+q
2

(45)

j
k 

j k 
k+q
s+q 
i+j
e
,
âˆˆ
Î Ì‚
, q for all (k, s) âˆˆ Î  (i, j).
By construction, given any i, j, q âˆˆ K,
2
2
2
j
k j k
j k 
q
Since 0 â‰¤ 2 , and q+i+j
â‰¤ i+j
+ q, it follows from (41) and (45) that Î Ì‚e i+j
,q âŠ†
2
2
2
j k 
j
k 

j k 
i+j
k+q
s+q 
i+j
Î 
, q for all i, j, q âˆˆ K, which implies
, 2
âˆˆÎ 
, q for all (k, s) âˆˆ
2
2
2
Î  (i, j), and any i, j, q âˆˆ K.
(ii) Suppose that i+j and s+q are odd. We first show that given any i, j, q âˆˆ K, (k, s) âˆˆ Î  (i, j)
j
k 

l m 
k+q
s+q 
i+j
implies
,
âˆˆ
Î 
, q . Notice that if i + j and s + q are odd, then
2
2
2


 
 

s+q
i+j
k+q
+
=
+ q.
2
2
2

(46)

With (46),
o
 s+q   s+q 
âˆˆ
K
Ã—
K
:
(k,
s)
âˆˆ
Î 
(i,
j)
,
2
2
nl m

n  l
m
l
moo
i+j
q
q+1
q+i+j
=
+
q
âˆ’
y,
y
âˆˆ
K
Ã—
K
:
y
âˆˆ
,
,
.
.
.
,
2
2
2
2
l m 
i+j
o
,q .
â‰¡ Î Ì‚
2

Î Ì‚ (i, j, q) =

nl

i+j
2

m

+qâˆ’

(47)

j

l m 
k 
k+q
s+q 
i+j
o
By construction, given any i, j, q âˆˆ K,
âˆˆ
Î Ì‚
,
, q for all (k, s) âˆˆ Î  (i, j).
2
2
2
l
m l m
l m 
q
i+j
i+j
o
Since 0 â‰¤ 2 , and q+i+j
â‰¤
+
q,
it
follows
from
(40)
and
(47)
that
Î Ì‚
,q âŠ†
2
2
2
j
k 

l m 
l m 

k+q
, q for all i, j, q âˆˆ K, which implies
, s+q
âˆˆ Î  i+j
, q for all (k, s) âˆˆ
Î  i+j
2
2
2
2
Î  (i, j), and any i, j, q âˆˆ K.
Finally, we show that given any i, j, q âˆˆ K, (k, s) âˆˆ Î  (i, j) implies
j k 
Î  i+j
, q . Notice that if i + j and s + q are odd, then
2


 
 

k+q
s+q
i+j
+
=
+ q.
2
2
2

37

l

k+q
2

m 

âˆˆ
, s+q
2

(48)

With (48),
o
 s+q   s+q 
,
âˆˆ
K
Ã—
K
:
(k,
s)
âˆˆ
Î 
(i,
j)
2
2

n  j
k
j
koo
nj k
q
q+1
q+i+j
i+j
+
q
âˆ’
y,
y
âˆˆ
K
Ã—
K
:
y
âˆˆ
,
,
.
.
.
,
=
2
2
2
2
j k 
i+j
o
â‰¡ Î Ìƒ
,q .
2

Î Ìƒ (i, j, q) =

nj

i+j
2

k

+qâˆ’

(49)

l
m 

j k 
k+q
s+q 
i+j
o
,
âˆˆ
Î Ìƒ
, q for all (k, s) âˆˆ Î  (i, j).
By construction, given any i, j, q âˆˆ K,
2
2
2
j
k j k
j k 
q
Since 0 â‰¤ 2 , and q+i+j
â‰¤ i+j
+ q, it follows from (41) and (49) that Î Ìƒo i+j
,q âŠ†
2
2
2
j k 
l
m 

j k 
i+j
k+q
s+q 
i+j
, q for all i, j, q âˆˆ K, which implies
, 2
âˆˆ Î 
, q for all (k, s) âˆˆ
2
2
2
Î  (i, j), and any i, j, q âˆˆ K.
Proof of Proposition 2. Consider the metric space (B, D) used in the proof of Lemma 4. A
function w âˆˆ B satisfies the bilateral-trade asset-holding Equalization Property (EP) if for all
(i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ],
max

(k,s)âˆˆÎ (i,j)

[w (k, Ï„ ) + w (s, Ï„ ) âˆ’ w (i, Ï„ ) âˆ’ w (j, Ï„ )]
j k 
l m 
i+j
,
Ï„
+
w
, Ï„ âˆ’ w (i, Ï„ ) âˆ’ w (j, Ï„ ) .
= w i+j
2
2

(EP)

A function w âˆˆ B satisfies the bilateral-trade asset-holding Strict Equalization Property (SEP)
if for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ],
arg

max

(k,s)âˆˆÎ (i,j)

[w (k, Ï„ ) + w (s, Ï„ ) âˆ’ w (i, Ï„ ) âˆ’ w (j, Ï„ )] = â„¦âˆ—ij ,

(SEP)

where â„¦âˆ—ij is defined in (11). Let
B 00 = {w âˆˆ B : w satisfies (EP)}
B 000 = {w âˆˆ B : w satisfies (SEP)} .
Clearly, B 000 âŠ† B 00 âŠ† B.
We first establish that B 00 is a closed subset of B. Let {wn }âˆ
n=0 be a sequence of functions
in B 00 , with limnâ†’âˆ wn = wÌ„. If wÌ„ âˆˆ
/ B 00 , then there exists some (k, s) âˆˆ Î  (i, j) and Ï‚ âˆˆ R such
that
h l m 
j k i
i+j
0 < Ï‚ = wÌ„ (k, Ï„ ) + wÌ„ (s, Ï„ ) âˆ’ wÌ„ i+j
,
Ï„
+
wÌ„
,Ï„ ,
2
2

38

for some (i, j, Ï„ ) âˆˆ K Ã— KÃ— [0, T ]. This implies
wn (k, Ï„ ) + wn (s, Ï„ ) = wn

l

i+j
2

m


j k 
, Ï„ + wn i+j
,Ï„ + Ï‚
2

âˆ’ {wÌ„ (k, Ï„ ) + wÌ„ (s, Ï„ ) âˆ’ [wn (k, Ï„ ) + wn (s, Ï„ )]}
j k  h l m 
j k i
l m 
i+j
i+j
i+j
,
Ï„
+
wÌ„
,
Ï„
âˆ’
w
,
Ï„
+
w
,Ï„ .
+ wÌ„ i+j
n
n
2
2
2
2
For this particular (i, j, Ï„ ) âˆˆ K Ã— KÃ— [0, T ], for all n large enough we can ensure that
|wÌ„ (k, Ï„ ) + wÌ„ (s, Ï„ ) âˆ’ [wn (k, Ï„ ) + wn (s, Ï„ )]| <
and
l

wÌ„

i+j
2

m

Ï‚
4


j k  h l m 
j k i
Ï‚
i+j
i+j
< ,
, Ï„ + wÌ„ i+j
,
Ï„
âˆ’
w
,
Ï„
+
w
,Ï„
n
n
2
2
2
4

but then
h l m 
j k i
i+j
0 < Ï‚/2 < wn (k, Ï„ ) + wn (s, Ï„ ) âˆ’ wn i+j
,
Ï„
+
w
,Ï„ ,
n
2
2
which contradicts the fact that wn âˆˆ B 00 . Thus, we conclude that wÌ„ âˆˆ B 00 , so B 00 is closed.
The second step is to show that the mapping M defined in (31) preserves property (EP),
i.e., that M (B 00 ) âŠ† B 00 . That is, we wish to show that for any w âˆˆ B 00 , w0 = Mw âˆˆ B 00 , or
equivalently, that
w

l

i+j
2

m


j k 
, Ï„ + w i+j
, Ï„ â‰¥ w (k, Ï„ ) + w (s, Ï„ ) for all (k, s) âˆˆ Î  (i, j) ,
2

for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ], implies that
w0

l

i+j
2

m

j k 

, Ï„ + w0 i+j
, Ï„ âˆ’ w0 (k, Ï„ ) âˆ’ w0 (s, Ï„ ) â‰¥ 0 for all (k, s) âˆˆ Î  (i, j) ,
2

(50)

for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ]. Since w âˆˆ B 00 , using (34) (with Î¸kk0 = 1/2 for all k, k 0 âˆˆ K),
Z Ï„
(Mw) (i, Ï„ ) = vi (Ï„ ) + Î±
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
0
Z
h l m 
j k 
i
Î± Ï„X
i+q
+
nq (z) w i+q
,
z
+
w
,
z
âˆ’
w
(i,
z)
âˆ’
w
(q,
z)
eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
2
2
2 0
qâˆˆK

39

for all (i, Ï„ ) âˆˆ K Ã— [0, T ]. For any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ] and (k, s) âˆˆ Î  (i, j), let G (i, j, k, s, Ï„ )
denote the left side of inequality (50). Then,
G (i, j, k, s, Ï„ ) = vd i+j e (Ï„ ) + vb i+j c (Ï„ ) âˆ’ vk (Ï„ ) âˆ’ vs (Ï„ )
Z 2Ï„ h l m2 
j k 
i
i+j
+Î±
w i+j
,
z
+
w
,
z
âˆ’
w
(k,
z)
âˆ’
w
(s,
z)
eâˆ’(r+Î±)(Ï„ âˆ’z) dz
2
2
0
ï£«ï£®   ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶
i+j
ï£¯ i+j +q ï£º

Z Ï„X
+q
ï£º
ï£¯ 2
Î±
2
ï£º
ï£¯
ï£¸
ï£» , zï£¸
ï£­
ï£­
,z + w ï£°
nq (z) w ï£¯
+
2
2
ï£º
2 0
ï£º
ï£¯
qâˆˆK

l m 
i+j
, z âˆ’ w (q, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
âˆ’w
2
ï£«ï£®   ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶
i+j
ï£¯ i+j +q ï£º

Z Ï„X
+q
ï£º
ï£¯ 2
Î±
2
ï£¯
ï£º
ï£­
ï£¸
ï£» , zï£¸
ï£­
+
nq (z) w ï£¯
,z + w ï£°
2
2
ï£º
2 0
ï£¯
ï£º
qâˆˆK

j k 
i+j
, z âˆ’ w (q, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
âˆ’w
2
Z
h l
m 
j
k 
i
Î± Ï„X
k+q
âˆ’
nq (z) w k+q
,
z
+
w
,
z
âˆ’
w
(k,
z)
âˆ’
w
(q,
z)
eâˆ’(r+Î±)(Ï„ âˆ’z) dz
2
2
2 0
qâˆˆK
Z
 
 

 

Î± Ï„X
nq (z) w s+q
âˆ’
, z + w s+q
, z âˆ’ w (s, z) âˆ’ w (q, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz.
2
2
2 0
qâˆˆK

With (33) and after deleting redundant terms, this expression can be rearranged to yield

1 âˆ’ eâˆ’(r+Î±)Ï„ 
ud i+j e + ub i+j c âˆ’ uk âˆ’ us
G (i, j, k, s, Ï„ ) =
2
2
r + Î±h
i
+ eâˆ’(r+Î±)Ï„ Ud i+j e + Ub i+j c âˆ’ Uk âˆ’ Us
2
2
Z
j k 
i
Î± Ï„ h l i+j m 
i+j
,
z
+
w
,
z
âˆ’
w
(k,
z)
âˆ’
w
(s,
z)
eâˆ’(r+Î±)(Ï„ âˆ’z) dz
w
+
2
2
2 0
ï£± ï£«ï£®   ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶
i+j
ï£¯ i+j +q ï£º
Z Ï„X
ï£²
+q
ï£¯ 2
ï£º
Î±
2
ï£¯
ï£º
ï£­
ï£¸
ï£­
ï£» , zï£¸
+
nq (z) w ï£¯
,z + w ï£°
2
2
ï£º
ï£³
2 0
ï£¯
ï£º
qâˆˆK
m 
l

 
âˆ’ w k+q
, z âˆ’ w s+q
,z
2
2
j
k 

 
âˆ’ w k+q
, z âˆ’ w s+q
,z
2
2
ï£«ï£®   ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶ï£¼
i+j
ï£¯ i+j +q ï£º
ï£½
ï£¯
ï£º
2 +q
ï£¯
ï£º
ï£¸ + w ï£­ï£° 2
ï£» , z ï£¸ eâˆ’(r+Î±)(Ï„ âˆ’z) dz.
+w ï£­ï£¯
,
z
2
2
ï£º
ï£¾
ï£¯
ï£º
What needs to be shown is that w âˆˆ B 00 implies that for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ],
G (i, j, k, s, Ï„ ) â‰¥ 0 for all (k, s) âˆˆ Î  (i, j). The fact that w âˆˆ B 00 immediately implies that
40

the first integral in the last expression is nonnegative. By Lemma 5, w âˆˆ B 00 also implies that
the second integral in the last expression is nonnegative. Together with Assumption A and
Corollary 1, these observations imply

h
i
1 âˆ’ eâˆ’(r+Î±)Ï„ 
ud i+j e + ub i+j c âˆ’ uk âˆ’ us + eâˆ’(r+Î±)Ï„ Ud i+j e + Ub i+j c âˆ’ Uk âˆ’ Us (51)
2
2
2
2
r+Î±
â‰¤ G (i, j, k, s, Ï„ ) ,

0<

so we conclude that M (B 00 ) âŠ† B 000 âŠ† B 00 .
The third step is to show that (10) is the equilibrium distribution of trading probabilities.
From Lemma 4, we know that M is a contraction mapping on the complete metric space (B, D),
so it has a unique fixed point wâˆ— (k, Ï„ ) â‰¡ Vk (Ï„ ) âˆˆ B. In addition, we have now established
that B 00 is a closed subset of B, and that M (B 00 ) âŠ† B 000 âŠ† B 00 . Therefore, by Corollary 1
in Stokey and Lucas (1989, p. 52), we conclude that Vk (Ï„ ) âˆˆ B 000 . This implies that the set
â„¦ij [V (Ï„ )] defined in (9) reduces to â„¦âˆ—ij for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ], and consequently, that
(8) reduces to (10) for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ]. This establishes part (ii ) in the statement
of the proposition.
We can now show that the paths n (Ï„ ) and V (Ï„ ) are uniquely determined. Since (by
Lemma 4) the fixed point Vk (Ï„ ) âˆˆ B 000 is unique given any path for the distribution of reserve
balances, n (Ï„ ), all that has to be shown is that given the initial condition {nk (T )}kâˆˆK , and
given that the path Ï† (Ï„ ) satisfies (10), the system of first-order ordinary differential equations,
nÌ‡ (Ï„ ) = f [n (Ï„ ) , Ï† (Ï„ )], has a unique solution. But since f is continuously differentiable,
this follows from Propositions 6.3 and 7.6 in Amann (1990). This establishes part (i ) in the
statement of the proposition.
Corollary 2 Assume that {Uk }kâˆˆK satisfies the discrete midpoint concavity property and {uk }kâˆˆK
satisfies the discrete midpoint strict concavity property. An equilibrium exists, and the equilibrium paths for the distribution of reserve balances, n (Ï„ ), and maximum attainable payoffs,
V (Ï„ ), are uniquely determined and identical to those in Proposition 2. The equilibrium distribution of trading probabilities is
Ï†ks
ij (Ï„ )


=

âˆ—
Ï†Ìƒks
ij (Ï„ ) if (k, s) âˆˆ â„¦ij (Ï„ )
0
if (k, s) âˆˆ
/ â„¦âˆ—ij (Ï„ )

for all i, j, k, s âˆˆ K and Ï„ âˆˆ [0, T ], with Ï†Ìƒks
ij (Ï„ ) â‰¥ 0 and

41

P
(k,s)âˆˆâ„¦âˆ—ij (Ï„ )

(52)
Ï†Ìƒks
ij (Ï„ ) = 1, and where

â„¦âˆ—ij (Ï„ ) = â„¦âˆ—ij , with â„¦âˆ—ij given by (11) for all Ï„ âˆˆ (0, T ], and â„¦âˆ—ij (0) = â„¦âˆ—ij âˆª â„¦0ij , where
o
n
â„¦0ij = (k, s) âˆˆ Î  (i, j) : Uk + Us = Ud i+j e + Ub i+j c .
2
2
Proof of Corollary 2. The proof proceeds exactly as the proof of Proposition 2 up to (51).
Notice that under Assumption A, (51) holds for all Ï„ âˆˆ [0, T ]. Instead, under the assumption
that {Uk }kâˆˆK satisfies discrete midpoint concavity and {uk }kâˆˆK satisfies discrete midpoint strict
concavity, the inequality in (51) holds as a strict inequality for all Ï„ âˆˆ (0, T ], but only as a weak
inequality for Ï„ = 0. As before, the unique fixed point Vk (Ï„ ) âˆˆ B 00 , but now Vk (Ï„ ) âˆˆ
/ B 000 , since
Vk (Ï„ ) satisfies (SEP) for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— (0, T ], rather than for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ].
000
However, it is clear from (51) that in this case MVk (Ï„ ) = Vk (Ï„ ) âˆˆ B 000
0 , where B 0 is the

subset of elements of B that satisfy (SEP) for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— (0, T ]. This implies that
the set â„¦ij [V (Ï„ )] defined in (9) now reduces to the set â„¦âˆ—ij (Ï„ ) defined in the statement of the
corollary for all Ï„ âˆˆ [0, T ], and consequently, that (8) reduces to (52) for all Ï„ âˆˆ [0, T ]. Notice
that despite the potential multiplicity of optimal post-trade portfolios in bilateral meetings at
Ï„ = 0 (which is the only difference between this case and the one treated in Proposition 2), as
can be seen from (34) and (52), the mapping M is unaffected by this multiplicity, and hence
so is its fixed point. Therefore, (by Lemma 2) the fixed point Vk (Ï„ ) âˆˆ B 000
0 is unique given any
path for n (Ï„ ). Finally, if we cast (4) in integral equation form,
Z
nk (Ï„ ) = nk (T ) âˆ’ Î±
Ï„

T

XXX

i
h
ks
(z)
âˆ’
n
(z)
Ï†
(z)
dz
ni (z) nk (z) Ï†sj
j
ij
ki

(53)

iâˆˆK jâˆˆK sâˆˆK

for all k âˆˆ K, then it becomes clear that for all k âˆˆ K and all Ï„ âˆˆ [0, T ], nk (Ï„ ) is independent
of Ï†ks
ij (0) (changing the integral at a single point leaves the right side of (53) unaffected).
Therefore, by the same arguments used in the final step of the proof of Proposition 2, there
exists a unique n (Ï„ ) that solves the system (53), and it is the same solution that obtains under
Assumption A.

A.4

End-of-day payoffs

The specification of end-of-day payoffs, (13), contemplates the fact that at the end of the trading
day banks have the option to borrow from the Federal Reserve discount window. The following
lemma characterizes the solution to this end-of-day problem.

42

o
Lemma 6 Assume ief < iw
f â‰¤ if . Consider a bank with end-of-day balance k that has the

option to borrow from the discount window right after the end of the trading session, and let
k w denote the bankâ€™s balance after having borrowed from the window.
(i) If kÌ„ â‰¤ k âˆ’ kÌ„0 , then k w = k âˆ’ kÌ„0 and the bankâ€™s maximum terminal payoff is given by (13)

with Fk = irf kÌ„ + ief k âˆ’ kÌ„0 âˆ’ kÌ„ .
(ii) If 0 â‰¤ k âˆ’ kÌ„0 < kÌ„, then
ï£±
c
r
if iw
ï£² = kÌ„
f < if + if

c
r
âˆˆ k âˆ’ kÌ„0 , kÌ„ âˆ© K if iw
kw
f = if + if
ï£³
c
r
w
= k âˆ’ kÌ„0
if if + if < if ,
and the bankâ€™s maximum terminal payoff is given by (13) with
 r
r
c
if iw
if kÌ„ âˆ’ iw
f â‰¤ if + if
f [kÌ„âˆ’ (k âˆ’ kÌ„0 )]
Fk =
w
c
r
r
c
if k âˆ’ kÌ„0 âˆ’ if [kÌ„ âˆ’ (k âˆ’ kÌ„0 )] if if + if < if .

(54)

(55)

(iii) If k âˆ’ kÌ„0 < 0, then
ï£±
r
c
if iw
ï£² = kÌ„ 
f < if + if
r
c
âˆˆ 0, kÌ„ âˆ© K if iw
kw
f = if + if
ï£³
w
r
c
=0
if if + if < if
and the bankâ€™s maximum terminal payoff is given by (13) with
 r
w
c
r
if kÌ„ âˆ’ iw
f [kÌ„ âˆ’ (k âˆ’ kÌ„0 )] if if < if + if
Fk =
c
if icf + iof â‰¤ iw
iw
f.
f (k âˆ’ kÌ„0 ) âˆ’ if kÌ„

(56)

(57)

Proof of Lemma 6. Notice that Fk can be written more compactly as



irf max 0, min k w , kÌ„ + ief max k w âˆ’ kÌ„, 0
kâˆ’kÌ„0 â‰¤kw


 w

âˆ’ icf max min(kÌ„ âˆ’ k w , kÌ„), 0 âˆ’ iof max (âˆ’k w , 0) âˆ’iw
.
f k âˆ’ (k âˆ’ kÌ„0 )

Fk =

max



(58)

A bank that ends the trading session with balance k chooses k w by solving (58).
(i) Given kÌ„ â‰¤ k âˆ’ kÌ„0 , (58) reduces to
Fk =

max

kâˆ’kÌ„0 â‰¤kw



e
w w
(irf âˆ’ ief )kÌ„ + iw
.
f (k âˆ’ kÌ„0 ) + (if âˆ’ if )k

w
The assumption ief < iw
f implies the solution is k = kâˆ’ kÌ„0 , and substituting it into the objective

function yields Fk = irf kÌ„ + ief k âˆ’ kÌ„0 âˆ’ kÌ„ .

43

(ii) Given 0 â‰¤ k âˆ’ kÌ„0 < kÌ„ and part (i), (58) reduces to
Fk =



max

kâˆ’kÌ„0 â‰¤kw â‰¤kÌ„

c
c
r
w w
iw
,
f (k âˆ’ kÌ„0 ) âˆ’ if kÌ„ + (if + if âˆ’ if )k

which implies that the solution is given by (54), and substituting this solution into the objective
function yields (55).
(iii) Given k âˆ’ kÌ„0 < 0 and part (i), (58) becomes
Fk = iw
f (k âˆ’ kÌ„0 ) +

r


w
if max (0, k w ) âˆ’ icf max min(kÌ„ âˆ’ k w , kÌ„), 0 âˆ’ iof max (âˆ’k w , 0) âˆ’ iw
fk
w
kâˆ’kÌ„0 â‰¤k â‰¤kÌ„


w
c
o
w w
c
r
w w
= if (k âˆ’ kÌ„0 ) âˆ’ if kÌ„ + max
max (if âˆ’ if )k , max (if + if âˆ’ if )k

=

iw
f (k

âˆ’ kÌ„0 ) âˆ’

max

icf kÌ„

+

kâˆ’kÌ„0 â‰¤kw â‰¤0
w
max (icf + irf âˆ’ iw
f )k ,
0â‰¤kw â‰¤kÌ„

0â‰¤kw â‰¤kÌ„

o
where the last equality follows from iw
f â‰¤ if . Thus the solution is given by (56), and this yields

the value given in (57).
o
w
c
r
Corollary 3 Assume ief < iw
f â‰¤ if and if < if + if . Then


Uk =

B


if kÌ„ â‰¤ k âˆ’ kÌ„0
eâˆ’râˆ†f [k âˆ’ kÌ„0 + irf kÌ„ + ief k âˆ’ kÌ„0 âˆ’ kÌ„ ]
w
r
âˆ’râˆ†
f
{k âˆ’ kÌ„0 + if kÌ„ âˆ’ if [kÌ„ âˆ’ (k âˆ’ kÌ„0 )]} if k âˆ’ kÌ„0 < kÌ„.
e

Efficiency

In this section we use our theory to characterize the optimal process of reallocation of reserve
balances in the fed funds market. The spirit of the exercise is to take as given the market
structure, including the contact rate Î± and the regulatory variables {uk , Uk }kâˆˆK , and to ask
whether decentralized trade in the over-the-counter market structure reallocates reserve balances efficiently, given these institutions. To this end, we study the problem of a social planner
who solves
"Z
max

[Ï‡(t)]T
t=0

0

T

#
X

âˆ’rt

mk (t) uk e

dt + e

kâˆˆK

âˆ’rT

X

mk (T ) Uk

kâˆˆK

s.t. mÌ‡k (t) = âˆ’f [m (t) , Ï‡ (t)] ,
ks
Ï‡ks
/ Î  (i, j) ,
ij (t) âˆˆ [0, 1] , with Ï‡ij (t) = 0 if (k, s) âˆˆ
XX
sk
Ï‡ks
Ï‡ks
ij (t) = Ï‡ji (t) , and
ij (t) = 1,
kâˆˆK sâˆˆK

44

(59)

for all t âˆˆ [0, T ], and all i, j, k, s âˆˆ K. We have formulated the plannerâ€™s problem in chronological
time, so mk (t) denotes the measure of banks with balance k at time t. Since Ï„ â‰¡ T âˆ’ t, we
have mk (t) = mk (T âˆ’ Ï„ ) â‰¡ nk (Ï„ ), and therefore mÌ‡k (t) = âˆ’nÌ‡k (Ï„ ). Hence the flow constraint
is the real-time law of motion for the distribution of balances implied by the bilateral stochastic
trading process. The control variable, Ï‡ (t) = {Ï‡ks
ij (t)}i,j,k,sâˆˆK , represents the plannerâ€™s choice
of reallocation of balances between any pair of banks that have contacted each other at time
t. The first, second, and fourth constraints on Ï‡ (t) ensure that {Ï‡ks
ij (t)}k,sâˆˆK is a probability
distribution for each i, j âˆˆ K, and that the planner only chooses among feasible reallocations of
balances between a pair of banks. We look for a solution that does not depend on the identities
sk
or â€œnamesâ€ of banks, so the third constraint on Ï‡ (t) recognizes the fact that Ï‡ks
ij (t) and Ï‡ji (t)
sk
represent the same decision for the planner. That is, Ï‡ks
ij (t) and Ï‡ji (t) both represent the

probability that a pair of banks with balances i and j who contact each other at time t exit the
meeting with balances k and s, respectively.
Proposition 3 A solution to the plannerâ€™s problem is a path for the distribution of balances,
n (Ï„ ), a path for the vector of co-states associated with the law of motion for the distribution of
balances, Î» (Ï„ ) = {Î»k (Ï„ )}kâˆˆK , and a path for the distribution of trading probabilities, Ïˆ (Ï„ ) =
ks (Ï„ )}
{Ïˆij
i,j,k,sâˆˆK . The necessary conditions for optimality are

rÎ»i (Ï„ ) + Î»Ì‡i (Ï„ ) = ui + Î±

XXX

ks
nj (Ï„ ) Ïˆij
(Ï„ ) [Î»k (Ï„ ) + Î»s (Ï„ ) âˆ’ Î»i (Ï„ ) âˆ’ Î»j (Ï„ )]

(60)

jâˆˆK kâˆˆK sâˆˆK

for all (i, Ï„ ) âˆˆ K Ã— [0, T ], with
Î»i (0) = Ui

for all i âˆˆ K,

(61)

with the path for n (Ï„ ) given by nÌ‡ (Ï„ ) = f [n (Ï„ ) , Ïˆ (Ï„ )], and with
 ks
ÏˆÌƒij (Ï„ ) if (k, s) âˆˆ â„¦ij [Î» (Ï„ )]
ks
Ïˆij (Ï„ ) =
0
if (k, s) âˆˆ
/ â„¦ij [Î» (Ï„ )] ,
ks (Ï„ ) â‰¥ 0 and
for all i, j, k, s âˆˆ K and all Ï„ âˆˆ [0, T ], where ÏˆÌƒij

P P
kâˆˆK sâˆˆK

(62)
ks (Ï„ ) = 1.
ÏˆÌƒij

Proof of Proposition 3. The plannerâ€™s current-value Hamiltonian can be written as
L=

X
kâˆˆK

mk (t) uk + Î±

XXXX

mi (t) mj (t) Ï‡ks
ij (t) [Âµk (t) âˆ’ Âµi (t)] ,

iâˆˆK jâˆˆK kâˆˆK sâˆˆK

45

where Âµ (t) = {Âµk (t)}kâˆˆK is the vector of co-states associated with the law of motion for the
distribution of banks across reserve balances. In an optimum, the co-states and the controls
must satisfy

âˆ‚L
âˆ‚mi (t)

= rÂµi (t) âˆ’ ÂµÌ‡i (t), and
ï£±
ï£´
ï£´
=1
if
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£²
ks
âˆˆ [0, 1] if
Ï‡ij (t)
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
ï£´
if
ï£´
ï£³ 0

âˆ‚L
âˆ‚Ï‡ks
ij (t)
âˆ‚L
âˆ‚Ï‡ks
ij (t)
âˆ‚L
âˆ‚Ï‡ks
ij (t)

>0
ks
Ï‡sk
ji (t)=Ï‡ij (t)

=0
ks
Ï‡sk
ji (t)=Ï‡ij (t)

< 0.
ks
Ï‡sk
ji (t)=Ï‡ij (t)

Notice that
âˆ‚L
âˆ‚Ï‡ks
ij (t)

= Î±mi (t) mj (t) [Âµk (t) + Âµs (t) âˆ’ Âµi (t) âˆ’ Âµj (t)] ,
ks
Ï‡sk
ji (t)=Ï‡ij (t)

ks
and that given Ï‡sk
ji (t) = Ï‡ij (t),

XXX
âˆ‚L
= ui + Î±
mj (t) Ï‡ks
ij (t) [Âµk (t) + Âµs (t) âˆ’ Âµi (t) âˆ’ Âµj (t)] .
âˆ‚mi
jâˆˆK kâˆˆK sâˆˆK

Thus the necessary conditions for optimality are
 ks
Ï‡Ìƒij (t) if (k, s) âˆˆ â„¦ij [Âµ (t)]
ks
Ï‡ij (t) =
(63)
0
if (k, s) âˆˆ
/ â„¦ij [Âµ (t)] ,
P P ks
for all i, j, k, s âˆˆ K and all t âˆˆ [0, T ], where Ï‡Ìƒks
Ï‡Ìƒij (t) = 1, the Euler
ij (t) â‰¥ 0 and
kâˆˆK sâˆˆK

equations,
rÂµi (t) âˆ’ ÂµÌ‡i (t) = ui + Î±

XXX

mj (t) Ï‡ks
ij (t) [Âµk (t) + Âµs (t) âˆ’ Âµi (t) âˆ’ Âµj (t)]

(64)

jâˆˆK kâˆˆK sâˆˆK

for all i âˆˆ K, with the path for m (t) given by (59), and
Âµi (T ) = Ui

for all i âˆˆ K.

(65)

In summary, the necessary conditions are (59), (63), (64), and (65). Next, we use the fact
ks
ks
that Ï„ â‰¡ T âˆ’ t to define mk (t) = mk (T âˆ’ Ï„ ) â‰¡ nk (Ï„ ), Ï‡ks
ij (t) = Ï‡ij (T âˆ’ Ï„ ) â‰¡ Ïˆij (Ï„ ),

and Âµi (t) = Âµi (T âˆ’ Ï„ ) â‰¡ Î»i (Ï„ ). With these new variables, (64) leads to (60), (59) leads to
nÌ‡ (Ï„ ) = f [n (Ï„ ) , Ïˆ (Ï„ )], (65) leads to (61), and (63) leads to (62).
The following result provides a full characterization of the solution to the plannerâ€™s problem
under Assumption A.
46

Proposition 4 Let the payoff functions satisfy Assumption A. Then:
ks (Ï„ )}
(i ) The optimal path for the distribution of trading probabilities, Ïˆ (Ï„ ) = {Ïˆij
i,j,k,sâˆˆK , is

given by
ks
Ïˆij
(Ï„ ) =



ks (Ï„ ) if (k, s) âˆˆ â„¦âˆ—
ÏˆÌƒij
ij
0
if (k, s) âˆˆ
/ â„¦âˆ—ij

ks (Ï„ ) â‰¥ 0 and
for all i, j, k, s âˆˆ K and all Ï„ âˆˆ [0, T ], where ÏˆÌƒij

(66)
P

(k,s)âˆˆâ„¦âˆ—ij

ks (Ï„ ) = 1.
ÏˆÌƒij

(ii ) Along the optimal path, the shadow value of a bank with i reserve balances is given by
(60) and (61), with the path for Ïˆ (t) given by (66), and the path for n (Ï„ ) given by
nÌ‡ (Ï„ ) = f [n (Ï„ ) , Ïˆ (Ï„ )].
Notice the similarity between the equilibrium conditions and the plannerâ€™s optimality conditions. First, from (8) and (62), we see that the equilibrium loan sizes are privately efficient.
That is, given the value function V , the equilibrium distribution of trading probabilities is the
one that would be chosen by the planner. Second, the path for the equilibrium values, V (Ï„ ),
satisfies (6) and (7), while the path for the plannerâ€™s shadow prices satisfies (60) and (61).
These pairs of conditions would be identical were it not for the fact that the planner imputes
to each agent gains from trade with frequency 2Î±, rather Î±, which is the frequency with which
the agent generates gains from trade for himself in the equilibrium. This reflects a composition
externality typical of random matching environments. The plannerâ€™s calculation of the value
of a marginal agent in state i includes not only the expected gains from trade to this agent,
but also the expected gains from trade that having this marginal agent in state i generates for
all other agents by increasing their contact rates with agents in state i. In the equilibrium, the
individual agent in state i internalizes the former, but not the latter.29
Under Assumption A, however, condition (10) is identical to (66), so the equilibrium paths
for the distribution of balances and trading probabilities coincide with the optimal paths. This
observation is summarized in the following proposition.
Proposition 5 Let the payoff functions satisfy Assumption A. Then, the equilibrium supports
an efficient allocation of reserve balances.
29

In a labor market context, a similar composition externality arises in the competitive matching equilibrium
of Kiyotaki and Lagos (2007).

47

Proof of Proposition 4. The function Î» â‰¡ [Î» (Ï„ )]Ï„ âˆˆ[0,T ] satisfies (60) and (61) if and only if
it satisfies
Z

Ï„

Î»i (z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
Î»i (Ï„ ) = vi (Ï„ ) + Î±
0
Z Ï„ XXX
ks
+Î±
nj (z) Ïˆij
(z) [Î»k (z) + Î»s (z) âˆ’ Î»i (z) âˆ’ Î»j (z)] eâˆ’(r+Î±)(Ï„ âˆ’z) dz.
0 jâˆˆK kâˆˆK sâˆˆK

The right side of this functional equation defines a mapping P : B â†’ B; that is, for any w âˆˆ B,
Z Ï„
(Pw) (i, Ï„ ) = vi (Ï„ ) + Î±
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
0
Z Ï„ XXX
ks
+Î±
nj (z) Ïˆij
(z) [w (k, z) + w (s, z) âˆ’ w (i, z) âˆ’ w (j, z)] eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
0 jâˆˆK kâˆˆK sâˆˆK

for all (i, Ï„ ) âˆˆ K Ã— [0, T ]. Hence a function Î» satisfies (60) and (61) if and only if it satisfies
Î» = PÎ». Rewrite the mapping P as
Z Ï„
(Pw) (i, Ï„ ) = vi (Ï„ ) + Î±
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
(67)
0
Z Ï„X
nj (z) max [w (k, z) + w (s, z) âˆ’ w (i, z) âˆ’ w (j, z)] eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
+Î±
0 jâˆˆK

(k,s)âˆˆÎ (i,j)

and for any w, w0 âˆˆ B, define the metric Dâˆ— : B Ã— B â†’ R by

Dâˆ— w, w0 =

sup

 âˆ’ÎºÏ„

e
w (i, Ï„ ) âˆ’ w0 (i, Ï„ ) ,

(i,Ï„ )âˆˆKÃ—[0,T ]

where Îº âˆˆ R satisfies
max {0, 5Î± âˆ’ r} < Îº < âˆ.

(68)

The metric space (B, Dâˆ— ) is complete (by the same argument used to argue that (B, D) is
complete, in the proof of Lemma 4). For any w, w0 âˆˆ B, and any (i, Ï„ ) âˆˆ K Ã— [0, T ], the same
steps that led to (39) now lead to

Dâˆ— Pw, Pw0 â‰¤
Notice that (68) implies
space

(B, Dâˆ— ).

5Î±
r+Î±+Îº


5Î±
Dâˆ— w, w0 ,
r+Î±+Îº

for all w, w0 âˆˆ B.

âˆˆ (0, 1), so P is a contraction mapping on the complete metric

By the Contraction Mapping Theorem (Theorem 3.2 in Stokey and Lucas,

1989), for any given path n (Ï„ ), there exists a unique Î» âˆˆ B that satisfies Î» = PÎ».
Consider the sets B 00 and B 000 defined in the proof of Proposition 2. By following the same
steps as in the first part of that proof, it can be shown that B 00 is closed under Dâˆ— . Next we
48

show that the mapping P defined in (67) preserves property (EP), i.e., that P (B 00 ) âŠ† B 00 .
That is, we wish to show that for any w âˆˆ B 00 , w0 = Pw âˆˆ B 00 , or equivalently, that
l m 
j k 
i+j
w i+j
,
Ï„
+
w
, Ï„ â‰¥ w (k, Ï„ ) + w (s, Ï„ ) for all (k, s) âˆˆ Î  (i, j) ,
2
2
for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ], implies that
l m 
j k 
i+j
0
w0 i+j
,
Ï„
+
w
, Ï„ âˆ’ w0 (k, Ï„ ) âˆ’ w0 (s, Ï„ ) â‰¥ 0 for all (k, s) âˆˆ Î  (i, j) ,
2
2

(69)

for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ]. Since w âˆˆ B 00 ,
Z Ï„
w (i, z) eâˆ’(r+Î±)(Ï„ âˆ’z) dz
(Pw) (i, Ï„ ) = vi (Ï„ ) + Î±
0
Z Ï„X
h l m 
j k 
i
i+q
+Î±
nq (z) w i+q
,
z
+
w
,
z
âˆ’
w
(i,
z)
âˆ’
w
(q,
z)
eâˆ’(r+Î±)(Ï„ âˆ’z) dz,
2
2
0 qâˆˆK

for any (i, Ï„ ) âˆˆ KÃ—[0, T ]. For any (i, j, Ï„ ) âˆˆ KÃ—KÃ—[0, T ] and (k, s) âˆˆ Î  (i, j), let G0 (i, j, k, s, Ï„ )
denote the left side of inequality (69). Then,
G0 (i, j, k, s, Ï„ ) =


1 âˆ’ eâˆ’(r+Î±)Ï„ 
ud i+j e + ub i+j c âˆ’ uk âˆ’ us
2
2
r + Î±h
i

+ eâˆ’(r+Î±)Ï„ Ud i+j e + Ub i+j c âˆ’ Uk âˆ’ Us
2
ï£± ï£«ï£®2  ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶
i+j
ï£¯ i+j +q ï£º
Z Ï„X
ï£²
+q
ï£º
ï£¯ 2
2
ï£¯
ï£º
ï£­
ï£¸
ï£­
ï£» , zï£¸
ï£°
nq (z) w ï£¯
+Î±
,
z
+
w
2
2
ï£º
ï£³
0 qâˆˆK
ï£¯
ï£º
m 
l

 
, z âˆ’ w s+q
,z
âˆ’ w k+q
2
2
j
k 

 
âˆ’ w k+q
, z âˆ’ w s+q
,z
2
2
ï£«ï£®   ï£¹ ï£¶
ï£«ï£¯   ï£º ï£¶ï£¼
i+j
ï£¯ i+j +q ï£º
ï£½
ï£¯
ï£º
2 +q
ï£º , z ï£¸ + w ï£­ï£° 2
ï£» , z ï£¸ eâˆ’(r+Î±)(Ï„ âˆ’z) dz.
+w ï£­ï£¯
2
2
ï£¯
ï£º
ï£¾
ï£¯
ï£º
What needs to be shown is that w âˆˆ B 00 implies that for any (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ],
G0 (i, j, k, s, Ï„ ) â‰¥ 0 for all (k, s) âˆˆ Î  (i, j). By Lemma 5, w âˆˆ B 00 implies that the integral
in the last expression is nonnegative. Together with Assumption A and Corollary 1, this implies

h
i
1 âˆ’ eâˆ’(r+Î±)Ï„ 
ud i+j e + ub i+j c âˆ’ uk âˆ’ us + eâˆ’(r+Î±)Ï„ Ud i+j e + Ub i+j c âˆ’ Uk âˆ’ Us
2
2
2
2
r+Î±
0
â‰¤ G (i, j, k, s, Ï„ ) ,

0<

49

so M (B 00 ) âŠ† B 000 âŠ† B 00 .
At this point, we have shown that P is a contraction mapping on the complete metric space
(B, Dâˆ— ), so it has a unique fixed point Î» âˆˆ B. We have also established that B 00 is a closed
subset of B and that M (B 00 ) âŠ† B 000 âŠ† B 00 . Therefore, by Corollary 1 in Stokey and Lucas
(1989, p. 52), Î» = PÎ» âˆˆ B 000 , that is, the unique fixed point Î» satisfies (SEP). This implies
that the set â„¦ij [Î» (Ï„ )] in (62) reduces to â„¦âˆ—ij (as defined in (11)) for all (i, j, Ï„ ) âˆˆ K Ã— K Ã— [0, T ],
and consequently, that (62) reduces to (66). This establishes part (i ) in the statement of the
proposition.
Given the initial condition {nk (T )}kâˆˆK , and given that the path Ïˆ (Ï„ ) satisfies (66), the
system of first-order ordinary differential equations, nÌ‡ (Ï„ ) = f [n (Ï„ ) , Ïˆ (Ï„ )] is identical to the
one in part (iii ) of Proposition 2 and therefore also has a unique solution. Given the resulting
path n (Ï„ ), according to Proposition 3, the path for the vector of co-states must satisfy the
necessary condition Î» = PÎ», or equivalently, (60) and (61), which establishes part (ii ) in the
statement of the proposition.

C
C.1

Data
Treatment of outliers

From the histogram of the variable of interest (i.e., the 4:00 pm imputed balances over required
operating balances, averaged over the two-week maintenance period), we looked for observations
that deviate markedly from the other members of the sample. There are no such observations in
the 2007 sample. In the 2011 sample the three largest observations deviate markedly from the
rest of the sample. We also implemented a modified version of Grubbsâ€™ test that assumes the
data can be fitted by a mixture of Gaussians and detects outliers with respect to the Gaussian
distribution with the largest variance. This procedure identifies no outliers in 2007 and the
same three outliers in 2011.

C.2

Estimation of initial distribution of balances

In Section 6.1 we described the procedure to estimate the initial distribution of balances that
we used in the 2007 calibration to run the baseline simulations presented in Section 6.2. This
procedure is straightforward: it essentially consists of using the data to construct the histogram
that we employ as the initial condition for the distribution of reserve balances in the model. In

50

order to conduct policy experiments such as those in Section 6.3 or counterfactual experiments
such as those in Appendix D, however, it is convenient to work with a parametric initial
distribution of balances rather than an empirical histogram, as this allows one to easily change
the mean or the standard deviation of the initial distribution of balances. For this reason, the
initial distributions used for the exercises in Section 6.3 and Appendix D were estimated using
the following procedure.
C.2.1

Estimation procedure for 2011 policy experiments

As mentioned in the body of the paper, we think of nk (T ) as the model counterpart of the
empirical proportion of commercial banks whose balances at the beginning of the trading session
are k/kÌ„ times larger than their average daily reserve requirement over a two-week holding period.
In order to conduct the policy experiments reported in Section 6.3, we estimate {nk (T )}kâˆˆK
from data using the following procedure.
First, we identified 135 commercial banks that traded fed funds during the first quarter of
2011 (according to their FR Y9-C regulatory filings), for which we have been able to obtain
information on their required operating balance, and that are not subject to special analysis
(according to item 9425 Bank Type Analysis Code of their regulatory fillings). Second, we
obtained the empirical cross-sectional distribution of closing balances of these 135 banks for
each day of a two-week maintenance period in the same quarter. Third, for every day in
the sample, we constructed a measure of each bankâ€™s imputed reserve balance at 4:00 pm,
as follows. Given each bankâ€™s closing balance on a given day, we subtracted the bankâ€™s net
payments activity from 4:00 pm until Fedwire Funds Service closing time (typically 6:30 pm)
as well as the discount window activity for that day. Fourth, for each bank we calculated the
average (over days in the two-week maintenance period) imputed reserve balance at 4:00 pm
and normalized it by dividing it by the bankâ€™s daily average required operating balance over
the same maintenance period. At this stage we detected three outliers (as described in Section
C.1) and removed them from the sample to obtain the final sample of 132 banks. We then
used this sample to compute maximum likelihood estimates of the parameters of a Gaussian
mixture model with two components. The estimated parameters are ÂµÌ‚1 = 4.51 and ÂµÌ‚2 = 57.19
(the means), Ïƒ1 = 4.78 and Ïƒ2 = 44.93 (the standard deviations), and p1 = 1 âˆ’ p2 = 0.67 (the
probability of drawing from the first component).30 We discuss the goodness of fit in Section
30

The corresponding standard errors (bootstrap, based on 10,000 iterations) for ÂµÌ‚1 , ÂµÌ‚2 , Ïƒ1 , Ïƒ2 , and p1 are 0.92,

51

C.2.3 below.
Notice that the mean of the estimated distribution of average normalized imputed reserve
balances for the 132 banks in the sample is p1 ÂµÌ‚1 +p2 ÂµÌ‚2 = 21.8. In order for the calibrated model
to capture typical overall market conditions during the first quarter of 2011, we translate the
estimated Gaussian mixture by choosing its mean to match the empirical mean of the ratio of
total seasonally adjusted reserves of depository institutions to total required reserves reported
in the H.3 Federal Reserve Statistical Release during the first quarter of 2011, which equals
17.68. This is done by considering a Gaussian mixture with the same p1 , p2 , Ïƒ1 , and Ïƒ2 that
were estimated from the sample of 132 banks, but replacing the estimated means, ÂµÌ‚1 and ÂµÌ‚2 ,
with Âµi = 0.81ÂµÌ‚i , for i = 1, 2, i.e., Âµ1 = 3.65 and Âµ2 = 46.32.31 This leads to the Gaussian
mixture, Î¦, with parameters Âµ1 = 3.65, Âµ2 = 46.32, Ïƒ1 = 4.78, Ïƒ2 = 44.93, and p1 = 0.67 used
in Section 6.3.
C.2.2

Estimation procedure for 2007 counterfactuals

In order to conduct the counterfactual policy experiments for 2007 reported in Appendix D
(Section D.1), we estimate {nk (T )}kâˆˆK from data using the same procedure used for the policy
experiments reported in Section 6.3. Below we describe the full procedure for completeness.
First, we identified 134 commercial banks that traded fed funds at the end of the second
quarter of 2007 (according to their FR Y9-C regulatory filings), for which we have been able
to obtain information on their required operating balance, and that are not subject to special
analysis (according to item 9425 Bank Type Analysis Code of their regulatory fillings). Second,
we obtained the empirical cross-sectional distribution of closing balances of these 134 banks
for each day of a two-week maintenance period in the same quarter. Third, for every day
in the sample, we constructed a measure of each bankâ€™s imputed reserve balance at 4:00 pm,
as follows. Given each bankâ€™s closing balance on a given day, we subtracted the bankâ€™s net
payments activity from 4:00 pm until Fedwire Funds Service closing time (typically 6:30 pm)
as well as the discount window activity for that day. Fourth, for each bank we calculated the
average (over days in the two-week maintenance period) imputed reserve balance at 4:00 pm and
normalized it by dividing it by the bankâ€™s daily average required operating balance over the same
9.43, 0.95, 4.46, and 0.055, respectively.
31
The standard deviation of the Gaussian mixture is a function of the means of the two components, so changes
in Âµ1 affect the variance of the mixture. As a robustness check, we have also conducted experiments changing
Ïƒ1 along with Âµ1 so as to keep the variance constant and found no significant difference in our results.

52

maintenance period. We then used this sample to compute maximum likelihood estimates of
the parameters of a Gaussian mixture model with two components. The estimated parameters
are ÂµÌ‚1 = 0.50 and ÂµÌ‚2 = 10.59 (the means), Ïƒ1 = 2.9 and Ïƒ2 = 31.1 (the standard deviations),
and p1 = 1 âˆ’ p2 = 0.73 (the probability of drawing from the first component).32 We discuss
the goodness of fit in Section C.2.3 below. The mean of the estimated distribution of average
normalized imputed reserve balances for the 134 banks in the sample is p1 ÂµÌ‚1 + p2 ÂµÌ‚2 = 3.22. In
order for the calibrated model to capture typical overall market conditions during the second
quarter of 2007, we translate the estimated Gaussian mixture by choosing its mean to match
the empirical mean of the ratio of total seasonally adjusted reserves of depository institutions
to total required reserves reported in the H.3 Federal Reserve Statistical Release during the
second quarter of 2007, which equals 1.04. This is done by considering a Gaussian mixture with
the same p1 , p2 , Ïƒ1 , and Ïƒ2 that were estimated from the sample of 134 banks, but replacing the
estimated means, ÂµÌ‚1 and ÂµÌ‚2 , with Âµi = 0.32ÂµÌ‚i , for i = 1, 2. This leads to the Gaussian mixture,
Î¦, with parameters (Âµ1 , Âµ2 , Ïƒ1 , Ïƒ2 , p1 ). In order to feed this distribution into the model we let
kÌ„ = 1 (so k can be interpreted as a multiple of the reserve requirement), K = {0, . . . , 250},
kÌ„0 = 100, and nk (T ) = Î¦(k âˆ’ kÌ„0 + 1) âˆ’ Î¦(k âˆ’ kÌ„0 ) for k = 1, ..., 249, n0 (T ) = Î¦ (âˆ’100), and
P
n250 (T ) = 1 âˆ’ Î¦ (150). By construction, Q â‰¡ 250
k=0 (k âˆ’ kÌ„0 )nk (T ) â‰ˆ 1.04.
C.2.3

Goodness of fit

As described above, for our policy experiments and counterfactual exercises, we use a Gaussian
mixture with parameters estimated by maximum likelihood. In this section we describe the
process that led us to choose a Gaussian mixture. We estimated four parametric distributions
as well as a mixture of two Gaussians to our initial distribution of balances and used several
methods to assess goodness of fit.
The 2007 initial distribution of balances The Kolmogorov-Smirnov goodness-of-fit test
does not reject the null hypothesis that the 2007 sample has been drawn from the Gaussian
mixture with two components at the 90 percent confidence level. We have also fit a Gaussian,
a Logistic, and a Generalized Extreme Value distribution, but the null hypothesis is rejected
by the Kolmogorov-Smirnov goodness-of-fit test at the 1 percent significance level. At the 90
32
The corresponding standard errors (boostrap, based on 10,000 iterations) for ÂµÌ‚1 , ÂµÌ‚2 , Ïƒ1 , Ïƒ2 , and p1 are: 0.37,
7.91, 0.84, 8.90, and 0.07 respectively.

53

percent confidence level, the test does not reject the null hypothesis that the data have been
drawn from a t-Location Scale distribution.
The Chi-square goodness-of-fit test does not reject the null hypothesis that the 2007 sample
has been drawn from a Gaussian mixture with two components at the 99 percent confidence
level. However, it rejects, at the 1 percent significance level, the null hypothesis that the data
have been drawn from a Gaussian, a Logistic, or a Generalized Extreme Value distribution. At
the 99 percent confidence level, the test does not reject the null hypothesis that the data have
been drawn from a t-Location Scale distribution.
We also contructed quantile-quantile plots of the sample quantiles of our distribution of
initial balances versus theoretical quantiles from a Gaussian, a Logistic, a Generalized Extreme
Value, a t-Location Scale distribution, and Gaussian mixture with two components. Visually,
the Q-Q plot of the Gaussian mixture with two components closely follows a linear trend line,
suggesting that the mixture of two Gaussians is a reasonably good fit to the data.
The 2011 initial distribution of balances The Kolmogorov-Smirnov goodness-of-fit test
does not reject the null hypothesis that the 2011 sample has been drawn from the Gaussian mixture with two components at the 90 percent confidence level. We have fit a Gaussian, a Logistic,
and a t-Location Scale distribution, but the null hypothesis is rejected by the KolmogorovSmirnov goodness-of-fit test at the 99 percent confidence level. The test does not reject the
null hypothesis that the data have been drawn from a Generalized Extreme Value distribution
at the significance level 0.1.
The Chi-square goodness-of-fit test rejects the null hypothesis that the data have been
drawn from the Gaussian mixture with two components, a Gaussian, a Logistic, a Generalized
Extreme Value, or a t-Location Scale distribution at the 99 percent confidence level.
The Q-Q plot of the Gaussian mixture with two components is relatively close to linear,
suggesting that the mixture of two Gaussians is a relatively good fit to the data.

D
D.1

Quantitative exercises
Policy counterfactual for 2007

In this section we use the model calibrated to mimic the salient features of a typical day in
2007 to conduct the types of policy experiments conducted in Section 6.3. Table 4 reports the
equilibrium values of ÏÌ„ that result from varying if from 0 to 6 percent in 1 percent increments
54

(as before, each column corresponds to a different value of Q/kÌ„). All other parameter values
are as in Section 6.1. Table 5 reports the equilibrium values of ÏÌ„ that result from varying iw
f
from 575 basis points to 700 basis points in 25 basis point increments, while keeping all other
parameter values as in Section 6.1.

D.2

Sensitivity analysis

In this section we carry out additional quantitative experiments to assess the sensitivity of the
model predictions to changes in the contact rate, Î±, and the standard deviation of the initial
distribution of reserve balances. These exercises show how the results of our policy experiments
vary with the values of the key calibrated parameters (notice that Tables 1-5 already show how
the equilibrium fed funds rate varies with the mean of the initial distribution of balances).
D.2.1

Changes in the contact rate

The top row of Figure 5 corresponds to the 2007 calibration with the initial distribution of
reserves estimated by a Gaussian mixture as described in Section C.2.2. The top left panel plots
the equilibrium value weighted fed funds rate, ÏÌ„, as a function of the aggregate normalized level
of reserves, Q/kÌ„, corresponding to five values of Î±. Notice that for any given level of Q/kÌ„, the
equilibrium rate ÏÌ„ increases with Î± if Q/kÌ„ < 1 and decreases with Î± if Q/kÌ„ > 1. The interest
rate is independent of Î± in the â€œbalanced marketâ€ with Q/kÌ„ = 1. The top right panel plots ÏÌ„
as a function of Î± keeping all other parameters (including Q/kÌ„) at their baseline values for the
2007 calibration. These results are in line with the discussion at the end of Section 6.3. The
bottom row of Figure 5 does the same exercise for the 2011 calibration.
D.2.2

Mean-preserving spreads of the initial distribution of balances

Consider a Gaussian mixture with parameters (Âµ1 , Âµ2 , Ïƒ1 , Ïƒ2 , p1 ). We parametrize a family of
mean-preserving spreads of this distribution as follows. For any ÏƒÌ„ âˆˆ R+ , define ÂµÌƒ1 = Âµ1 + Î´p2 ,
ÂµÌƒ2 = Âµ2 âˆ’ Î´p1 , and ÏƒÌƒi = ÏƒÌ„Ïƒi for i = 1, 2, with Î´ â‰¡ (1 âˆ’ ÏƒÌ„) (Âµ2 âˆ’ Âµ1 ). Then it is easy to see
that ÏƒÌ„ indexes a family of Gaussian mixtures with parameters (ÂµÌƒ1 , ÂµÌƒ2 , ÏƒÌƒ1 , ÏƒÌƒ2 , p1 ), where each
member of the family has the same mean, p1 Âµ1 + p2 Âµ2 , and a standard deviation proportional
to ÏƒÌ„. Thus by varying ÏƒÌ„ we can generate mean-preserving spreads of the original Gaussian
mixture. Clearly, the special case ÏƒÌ„ = 1 corresponds to the original distribution with parameters
(Âµ1 , Âµ2 , Ïƒ1 , Ïƒ2 , p1 ).
55

Figure 6 shows the effects of a mean-preserving spread of the initial distribution of balances.
The top row corresponds to the 2007 calibration, with the initial distribution of reserves given by
Gaussian mixture with parameters (Âµ1 , Âµ2 , Ïƒ1 , Ïƒ2 , p1 ) estimated as described in Section C.2.2.
The top left panel plots the equilibrium value weighted fed funds rate, ÏÌ„, as a function of
the aggregate normalized level of reserves, Q/kÌ„, corresponding to five values of ÏƒÌ„. Again, we
confirm that the distribution is neutral if the market is balanced, i.e., if Q/kÌ„ = 1 (notice that
ÏÌ„ is invariant to ÏƒÌ„ when Q/kÌ„ = 1). The top right panel plots ÏÌ„ as a function of ÏƒÌ„ keeping all
other parameters (including Q/kÌ„) at their baseline values for the 2007 calibration. The bottom
row of Figure 6 does the same exercise for the 2011 calibration.

56

References
[1] Afonso, Gara. 2011. â€œLiquidity and Congestion.â€ Journal of Financial Intermediation 20(3)
(July): 324â€“360.
[2] Afonso, Gara, Anna Kovner, and Antoinette Schoar. 2011. â€œStressed, Not Frozen: The
Federal Funds Market in the Financial Crisis.â€ Journal of Finance 66(4) (August): 1109â€“
1139.
[3] Afonso, Gara, and Ricardo Lagos. 2014. â€œAn Empirical Investigation of Trade Dynamics in
the Market for Federal Funds.â€ Working Paper 708, Federal Reserve Bank of Minneapolis.
[4] Amann, Herbert. 1990. Ordinary Differential Equations: An Introduction to Nonlinear
Analysis. New York: de Gruyter Studies in Mathematics.
[5] Ashcraft, Adam B., and Darrell Duffie. 2007. â€œSystemic Illiquidity in the Federal Funds
Market.â€ American Economic Review 97(2) (May): 221â€“225.
[6] Bartolini, Leonardo, Svenja Gudell, Spence Hilton, and Krista Schwarz. 2005. â€œIntraday
Trading in the Overnight Federal Funds Market.â€ Federal Reserve Bank of New York
Current Issues in Economics and Finance 11(11) (November): 1â€“7.
[7] Bech, Morten L., and Enghin Atalay. 2008. â€œThe Topology of the Federal Funds Market.â€
Federal Reserve Bank of New York Staff Report 354.
[8] Bech, Morten L., and Elizabeth Klee. 2011. â€œThe Mechanics of a Graceful Exit: Interest on
Reserves and Segmentation in the Federal Funds Market.â€ Journal of Monetary Economics
58(5) (July): 415â€“431.
[9] Bennett, Paul, and Spence Hilton. 1997. â€œFalling Reserve Balances and the Federal Funds
Rate.â€ Federal Reserve Bank of New York Current Issues in Economics and Finance 3(5)
(April): 1â€“6.
[10] Coleman, Wilbur John II, Christian Gilles, and Pamela A. Labadie. 1996. â€œA Model of the
Federal Funds Market.â€ Economic Theory 7(2) (February): 337â€“357.
[11] Davis, Steven J., John C. Haltiwanger, and Scott Schuh. 1996. Job Creation and Destruction. Cambridge: MIT Press.
57

[12] Duffie, Darrell. 2012. Dark Markets: Asset Pricing and Information Transmission in Overthe-Counter Markets. Princeton, NJ: Princeton University Press.
[13] Duffie, Darrell, Nicolae GaÌ‚rleanu, and Lasse Heje Pedersen. 2005. â€œOver-the-Counter Markets.â€ Econometrica 73(6) (November): 1815â€“1847.
[14] Duffie, Darrell, Nicolae GaÌ‚rleanu, and Lasse Heje Pedersen. 2007. â€œValuation in Over-theCounter Markets.â€ Review of Financial Studies 20(6) (November): 1865â€“1900.
[15] Ennis, Huberto M., and Todd Keister. 2008. â€œUnderstanding Monetary Policy Implementation.â€ Federal Reserve Bank of Richmond Economic Quarterly 94(3) (Summer): 235â€“263.
[16] Ennis, Huberto M., and John A. Weinberg. 2009. â€œOver-the-Counter Loans, Adverse Selection, and Stigma in the Interbank Market.â€ Federal Reserve Bank of Richmond Working
Paper 10-07.
[17] Ennis, Huberto M., and Alexander L. Wolman. 2010. â€œExcess Reserves and the New Challenges of Monetary Policy.â€ Federal Reserve Bank of Richmond Economic Brief (March).
[18] Federal Reserve. 2009. â€œInterest on Required Reserve Balances and Excess Balances.â€
http://www.frbservices.org/files/reserves/pdf/calculating required reserve balances
and excess balances.pdf
[19] Federal Reserve. 2010a. Press Release.
http://www.federalreserve.gov/newsevents/press/other/20100930a.htm
[20] Federal Reserve. 2010b. â€œReserve Maintenance Manual.â€
http://www.frbservices.org/files/regulations/pdf/rmm.pdf
[21] Furfine, Craig H. 1999. â€œThe Microstructure of the Federal Funds Market.â€ Financial
Markets, Institutions and Instruments 8(5) (December): 24â€“44.
[22] Furfine, Craig H. 2003. â€œStanding Facilities and Interbank Borrowing: Evidence from the
Federal Reserveâ€™s New Discount Window.â€ International Finance 6(3) (November): 329â€“
347.

58

[23] GaÌ‚rleanu, Nicolae. 2009. â€œPortfolio Choice and Pricing in Illiquid Markets.â€ Journal of
Economic Theory 144(2) (March): 532â€“564.
[24] Goodfriend, Marvin. 2002. â€œInterest on Reserves and Monetary Policy.â€ Federal Reserve
Bank of New York Economic Policy Review (May): 13â€“29.
[25] Hamilton, James D. 1996. â€œThe Daily Market for Federal Funds.â€ Journal of Political
Economy 104(1) (February): 26â€“56.
[26] Hamilton, James D., and OÌ€scar JordaÌ€. 2002. â€œA Model of the Federal Funds Target.â€
Journal of Political Economy 110(5) (October): 1135â€“1167.
[27] Ho, Thomas S. Y., and Anthony Saunders. 1985. â€œA Micro Model of the Federal Funds
Market.â€ Journal of Finance 40(3) (July): 977â€“988.
[28] Keister, Todd, Antoine Martin, and James McAndrews. 2008. â€œDivorcing Money from
Monetary Policy.â€ Federal Reserve Bank of New York Economic Policy Review (September): 41â€“56.
[29] Kiyotaki, Nobuhiro, and Ricardo Lagos. 2007. â€œA Model of Job and Worker Flows.â€ Journal
of Political Economy 115(5) (October): 770â€“819.
[30] Lagos, Ricardo. 2010a. â€œSome Results on the Optimality and Implementation of the Friedman Rule in the Search Theory of Money.â€ Journal of Economic Theory 145(4) (July):
1508â€“1524.
[31] Lagos, Ricardo. 2010b. â€œAsset Prices and Liquidity in an Exchange Economy.â€ Journal of
Monetary Economics 57(8) (November): 913â€“930.
[32] Lagos, Ricardo. 2011. â€œAsset Prices, Liquidity, and Monetary Policy in an Exchange Economy.â€ Journal of Money, Credit and Banking 43(s2) (October): 521â€“552.
[33] Lagos, Ricardo, and Guillaume Rocheteau. 2007. â€œSearch in Asset Markets: Market Structure, Liquidity, and Welfare.â€ American Economic Review 97(2) (May): 198â€“202.
[34] Lagos, Ricardo, and Guillaume Rocheteau. 2009. â€œLiquidity in Asset Markets with Search
Frictions.â€ Econometrica 77(2) (March): 403â€“426.

59

[35] Lagos, Ricardo, Guillaume Rocheteau, and Pierre-Olivier Weill. 2011. â€œCrashes and Recoveries in Illiquid Markets.â€ Journal of Economic Theory 146(6) (November): 2169â€“2205.
[36] Lagos, Ricardo, and Randall Wright. 2005. â€œA Unified Framework for Monetary Theory
and Policy Analysis.â€ Journal of Political Economy 113(3) (June): 463â€“484.
[37] Miao, Jianjun. 2006. â€œA Search Model of Centralized and Decentralized Trade.â€ Review of
Economic Dynamics 9(1) (January): 68â€“92.
[38] Murota, Kazuo. 2003. Discrete Convex Analysis. Philadelphia: SIAM Monographs on Discrete Mathematics and Application.
[39] Ok, Efe A. 2007. Real Analysis with Economic Applications. Princeton, NJ: Princeton
University Press.
[40] Poole, William. 1968. â€œCommercial Bank Reserve Management in a Stochastic Model:
Implications for Monetary Policy.â€ Journal of Finance 23(5) (December): 769â€“791.
[41] Rust, John, and George Hall. 2003. â€œMiddlemen versus Market Makers: A Theory of
Competitive Exchange.â€ Journal of Political Economy 111(2) (April): 353â€“403.
[42] Spulber, Daniel F. 1996. â€œMarket Making by Price-Setting Firms.â€ Review of Economic
Studies 63(4) (October): 559â€“580.
[43] Stokey, Nancy, and Robert E. Lucas. 1989. Recursive Methods in Economic Dynamics.
Cambridge: Harvard University Press.
[44] Vayanos, Dimitri, and Tan Wang. 2007. â€œSearch and Endogenous Concentration of Liquidity in Asset Markets.â€ Journal of Economic Theory 136(1) (September): 66â€“104.
[45] Vayanos, Dimitri, and Pierre-Olivier Weill. 2008. â€œA Search-Based Theory of the On-theRun Phenomenon.â€ Journal of Finance 63(3) (June): 1361â€“1398.
[46] Weill, Pierre-Olivier. 2007. â€œLeaning against the Wind.â€ Review of Economic Studies 74(4)
(October): 1329â€“1354.
[47] Weill, Pierre-Olivier. 2008. â€œLiquidity Premia in Dynamic Bargaining Markets.â€ Journal
of Economic Theory 140(1) (May): 66â€“96.

60

61

0.0040
0.0052
0.0064
0.0076

0

0.0025

0.0050

0.0075

0.0076

0.0064

0.0051

0.0039

Q/kÌ„ = 0.5

0.0076

0.0063

0.0051

0.0038

Q/kÌ„ = 1

0.0076

0.0060

0.0044

0.0028

Q/kÌ„ = 5

0.0075

0.0056

0.0037

0.0018

Q/kÌ„ = 10

0.0075

0.0054

0.0032

0.0011

Q/kÌ„ = 15

0.0026
0.0039
0.0052
0.0065
0.0078
0.0091

0.0025

0.0050

0.0075

0.0100

0.0125

0.0150

0.0089

0.0077

0.0064

0.0051

0.0039

0.0026

Q/kÌ„ = 0.5

0.0087

0.0075

0.0063

0.0051

0.0038

0.0026

Q/kÌ„ = 1

0.0072

0.0063

0.0053

0.0044

0.0035

0.0026

Q/kÌ„ = 5

0.0055

0.0049

0.0043

0.0037

0.0031

0.0025

Q/kÌ„ = 10

0.0043

0.0039

0.0036

0.0032

0.0029

0.0025

Q/kÌ„ = 15

Table 2: Effects of iw
f and Q/kÌ„ on the fed funds rate

Q/kÌ„ = 0.1

iw
f

Table 1: Effects of if and Q/kÌ„ on the fed funds rate

Q/kÌ„ = 0.1

if

0.0027

0.0027

0.0026

0.0026

0.0025

0.0025

Q/kÌ„ = 30

0.0075

0.0050

0.0026

0.0001

Q/kÌ„ = 30

62
0.0114

(0.0100, 0.0125)

0.0114

0.0089

0.0064

0.0039

0.0014

Q/kÌ„ = 0.5

0.0113

0.0088

0.0063

0.0038

0.0013

Q/kÌ„ = 1

0.0110

0.0085

0.0060

0.0035

0.0010

Q/kÌ„ = 5

0.0106

0.0081

0.0056

0.0031

0.0006

Q/kÌ„ = 10

0.0104

0.0079

0.0054

0.0029

0.0004

Q/kÌ„ = 15

0.0100

0.0075

0.0050

0.0025

0.0000

Q/kÌ„ = 30

Table 3: Determination of the fed funds rate under a 25-basis-point corridor system

0.0089

(0.0075, 0.0100)

0.0039

(0.0025, 0.0050)
0.0064

0.0014

(0.0000, 0.0025)

(0.0050, 0.0075)

Q/kÌ„ = 0.1

(if , iw
f)

63

16:00

1

16:15

11

16:30

17:00

17:15

21

41

51

Loan sizes

31

61

17:30

Eastern Time

16:45

71

17:45

81

18:00

91

18:15

0
0

0.02

0.04

0.06

0.08

0.1

0.12

0

0.02

0.04

0.06

0.08

0.1

0.12

0.14

0.16

2

4

6

8

0.4

0.6

0.8

1

10 12 14 16 18 20 22 24

Number of counterparties

Proportion of intermediated funds

0.2

0

âˆ’4.000

âˆ’2.000

0.000

2.000

4.000

6.000

3
16:00

3.5

4

4.5

5

5.5

6

6.5

7

16:45

Eastern Time

16:30

17:00

17:15

Eastern Time

16:00 16:15 16:30 16:45 17:00 17:15 17:30 17:45 18:00 18:15 18:30

16:15

Figure 1: Model calibrated to 2007. Box plot of loan sizes every 15 minutes during a trading session (left top). Histogram
of daily loan sizes (left bottom). Histogram of the number of counterparties banks trade with during a trading session
(center top). Histogram of the proportion of intermediated funds during a trading session (center bottom). Fed funds rate
(value weighted) at each minute of a trading session (right top). Box plot every 15 minutes of the spread between rates
on loans traded at time t and the value-weighted average of the rates on all transactions traded at t (right bottom). In a
histogram, the solid (green) vertical line indicates the mean, and the dashed (red) vertical line represents the median. In
a box plot, the (green) solid dot indicates the mean, and the (red) horizontal line represents the median.

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

2

4

6

8

10

12

14

16

18

20

Proportion of banks
Proportion of banks

Loan sizes

Proportion of loans

Fed funds rate (%)

Spreads to market rates (%)

64

âˆ’20

âˆ’15

âˆ’10

âˆ’5

0

5

10

15

16:00

16:15

16:30

17:00

17:15

17:30

Eastern Time

16:45

17:45

18:00

18:15

Data
Model

0
16:00

5

10

15

20

25

16:30

17:30

Eastern Time

17:00

18:00

18:30

Data
Calibrated model

Figure 2: Model calibrated to 2007. Empirical and theoretical box plots of balances every 15 minutes during a trading
session (left panel). Empirical and theoretical path for the standard deviation of the cross-sectional distribution of reserve
balances (right panel).

Balances

20

Standard deviation of balances

65
0

5

10

15

20

Q/ kÌ„

25

30

Fed funds rate (%)

35

40

45

50

if

iw
f

Figure 3: Equilibrium fed funds rate (ÏÌ„) as a function of the consolidated level of reserves (relative to required reserves)
in the banking sector

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

66

0.0856
0.0879
0.0901
0.0923
0.0945
0.0968
0.0990

0

0.01

0.02

0.03

0.04

0.05

0.06

0.0964

0.0936

0.0909

0.0881

0.0854

0.0826

0.0799

Q/kÌ„ = 0.25

0.0930

0.0896

0.0861

0.0827

0.0793

0.0759

0.0725

Q/kÌ„ = 0.5

0.0847

0.0797

0.0746

0.0695

0.0644

0.0594

0.0543

Q/kÌ„ = 1

0.0613

0.0515

0.0417

0.0320

0.0222

0.0125

0.0027

Q/kÌ„ = 5

0.0601

0.0502

0.0402

0.0302

0.0202

0.0103

0.0003

Q/kÌ„ = 10

0.0817
0.0837
0.0856
0.0876
0.0895
0.0915

0.0575

0.0600

0.0625

0.0650

0.0675

0.0700

0.0853

0.0835

0.0817

0.0799

0.0780

0.0762

Q/kÌ„ = 0.25

0.0774

0.0757

0.0741

0.0725

0.0708

0.0692

Q/kÌ„ = 0.5

0.0580

0.0568

0.0555

0.0543

0.0531

0.0518

Q/kÌ„ = 1

0.0029

0.0028

0.0028

0.0027

0.0027

0.0026

Q/kÌ„ = 5

0.0003

0.0003

0.0003

0.0003

0.0003

0.0003

Q/kÌ„ = 10

0.0001

0.0001

0.0001

0.0001

0.0001

0.0001

Q/kÌ„ = 15

Table 5: Effects of iw
f and Q/kÌ„ on the fed funds rate (2007 counterfactual)

Q/kÌ„ = 0.01

iw
f

0.0600

0.0500

0.0400

0.0300

0.0200

0.0101

0.0001

Q/kÌ„ = 15

Table 4: Effects of if and Q/kÌ„ on the fed funds rate (2007 counterfactual)

Q/kÌ„ = 0.01

if

67

0

5

5

10

15

20

25

30

35

40

45

50

5

10

15

20

25

30

35

40

45

50

5

iw
f

15

20

25

20

25

30

50

if

30

35

40

45

50

0

0

10

15

20

Q/ kÌ„

25

30

Fed funds rate (%)

Q/ kÌ„

35

40

45

50

if

iw
f

0

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

0

0

0.2

0

0

5

5

5

10

10

10

15

15

15

20

25

30

25

Q/ kÌ„

30

20

Q/ kÌ„

25

30

Fed funds rate (%)

20

35

35

35

40

40

40

45

45

45

50

50

50

if

iw
f

if

iw
f

f

i

iw
f

Figure 4: Equilibrium fed funds rate (ÏÌ„) as a function of the consolidated level of reserves (relative to required reserves)
in the banking sector for different policies (if ,iw
f)

Q/ kÌ„

0.2

0.2

0

0.4

0.4

0

0.6

0.6

10

1

1

0

1.2

1.2

if

1.4

1.4

0.8

1.6

1.6

iw
f

1.8

1.8

0.8

2

Fed funds rate (%)

Q/ kÌ„

0.2

2

0

if

0.4

0.2

0.8

1

0.6

1.2

1.4

1.6

1.8

2

0

0.2

0.4

45

50

0.6

40

45

0.4

35

40

0.6

15

35

1

10

30

0.8

5

25

0.8

0

20

1

1.2

1.2

1.6

1.8

1.4

0

iw
f

15

Fed funds rate (%)

10

Fed funds rate (%)
2

5

Fed funds rate (%)

1.4

1.6

1.8

2

0

0.4

0.6

0.8

1

1.2

1.4

Fed funds rate (%)

Q/ kÌ„

0

0

f

i

w
if

1.6

1.8

2

Q/ kÌ„

0.2

0.2

Fed funds rate (%)

Q/ kÌ„

0.4

0.6

f

0.6

0.4

0.8

0.8

i

1.2

1.2

1

1.4

1.4

f

1.6

1.6

iw

1.8

1.8

1

2

Fed funds rate (%)

2

68

5

5

10

10

15

Q/ kÌ„

15

Fed funds rate (%)

Q/ kÌ„

20

20

25

25

Î±=1
Î±=10
Î±=50
Î±=100
Î±=150

Î±=1
Î±=10
Î±=50
Î±=100
Î±=150

30

30

if

iw
+Pw
f

iw
+Pw
f

2011

2007

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0

0

0.8

0

2

4

6

8

10

12

10

500

20

30

1000

2000

40

Î±

50

60

Fed funds rate (%)

Î±

1500

Fed funds rate (%)

70

80

2500

90

100

if

iw
+Pw
f

3000

iw
+Pw
f

Figure 5: Sensitivity analysis with respect to the contact rate Î±. Equilibrium fed funds rate (ÏÌ„) as a function of the
consolidated level of reserves (relative to required reserves) for different values of Î± (top left for 2007, bottom left for
2011). Equilibrium fed funds rate (ÏÌ„) as a function of Î± (top right for 2007, bottom right for 2011).

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

0

1

0

2

4

6

8

10

12

Fed funds rate (%)

69

0

5

5

10

10

Q/ kÌ„

15

Fed funds rate (%)

15
Q/ kÌ„

20

20

25

25

ÏƒÌ„
ÏƒÌ„
ÏƒÌ„
ÏƒÌ„
ÏƒÌ„

=
=
=
=
=

ÏƒÌ„ = 2

ÏƒÌ„ = 1

30

if

iw
+Pw
f

30

0. 25
1
1. 5
2
4

ÏƒÌ„ = 0. 5

ÏƒÌ„ = 0. 25

ÏƒÌ„ = 0. 1

iw
+Pw
f

2011

2007

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0

0

0.8

0

2

4

6

8

10

12

0.5

0.5

1

1.5

1

ÏƒÌ„

2.5

3

ÏƒÌ„

1.5

Fed funds rate (%)

2

Fed funds rate (%)

2

3.5

4

2.5

4.5

3

5

w

if

iw
+Pw
f

w

if +P

Figure 6: Sensitivity analysis with respect to the standard deviation of the initial distribution of balances. Equilibrium
fed funds rate (ÏÌ„) as a function of the consolidated level of reserves (relative to required reserves) for different values of
ÏƒÌ„ (top left for 2007, bottom left for 2011). Equilibrium fed funds rate (ÏÌ„) as a function of ÏƒÌ„ (top right for 2007, bottom
right for 2011).

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0
0

2

4

6

8

10

12

Fed funds rate (%)

