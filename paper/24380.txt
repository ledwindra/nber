NBER WORKING PAPER SERIES

TRADE WITH CORRELATION
Nelson Lind
Natalia Ramondo
Working Paper 24380
http://www.nber.org/papers/w24380

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
March 2018, Revised October 2018

We thank our discussants Costas Arkolakis and Arnaud Costinot for their very helpful comments.
We benefit from comments from Roy Allen, Dave Donaldson, Jonathan Eaton, Stefania Garetto,
and Fernando Parro, as well as from participants at various seminars and conferences. All errors
are our own. The views expressed herein are those of the authors and do not necessarily reflect
the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
Â© 2018 by Nelson Lind and Natalia Ramondo. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including Â© notice, is given to the source.

Trade with Correlation
Nelson Lind and Natalia Ramondo
NBER Working Paper No. 24380
March 2018, Revised October 2018
JEL No. F1
ABSTRACT
We develop a trade model in which productivity presents an arbitrary pattern of correlation. The
model approximates the full class of factor demand systems consistent with Ricardian theory. In
particular, our framework formalizes Ricardoâ€™s insight that countries gain more from trade with
partners that have relatively dissimilar technology. Incorporating this insight entails a simple
correction to the sufficient-statistic approach used for macro counterfactuals, and enables a
general aggregation result that links macro demand systems to micro estimates. In our
quantitative application, we estimate a multi-sector trade model which captures the possibility
that nearby countries may share technology, and, hence, have correlated productivity draws. Our
estimates suggest that accounting for correlation is key to calculating the gains from trade.

Nelson Lind
Department of Economics
Emory University
1602 Fishburne Drive
Rich Bldg., 3rd Floor
Atlanta, GA 30322-2240
nlind@emory.edu
Natalia Ramondo
School of Int'l Relations and Pacific Studies
University of California at San Diego
9500 Gilman Drive, MC 0519
La Jolla, CA 92093
and NBER
nramondo@ucsd.edu

1

Introduction

Two hundred years ago, Ricardo (1817) proposed the idea that cross-country differences in production technologies can lead to gains from trade. Ricardoâ€™s work,
which extended Smith (1776)â€™s idea on specialization to international trade, led to
the following insight: Two countries gain more from trade when they have dissimilar production possibilities. Recent evidence suggests that similarity in technology relates to country characteristicsâ€”for instance, to the proximity of countries
(Keller, 2002; Bottazzi and Peri, 2003; Comin et al., 2013; Keller and Yeaple, 2013).
If so, correlation in productivity may lead to heterogeneity in the gains from trade.
The Ricardian trade model in Eaton and Kortum (2002, henceforth, EK)â€”which
gave rise to a rich theoretical and quantitative literatureâ€”does not account for
correlation. They assume that productivity is independently distributed FrÃ©chet
across countries. This assumption leads to tractability via a max-stability property: the maximum is also FrÃ©chet and its scale is the sum of the underlying scale
parameters,
"
P[max{A1 , . . . , AN } â‰¤ a] = exp âˆ’

N
X

!
To

#
aâˆ’Î¸ .

o=1

The symmetry of this additive structure, a consequence of independence, implies
that all trading partners are indistinguishable. As a result, the EK model cannot
capture how similarities across countries shape the gains from tradeâ€”which may
be important to understand why countries choose certain trading partners and not
others.
In this paper, we develop a Ricardian theory of trade that allows for arbitrary patterns of correlation in technology, yet preserves the max-stability property central
to the EK model. Specifically, we drop independence and assume a max-stable
multivariate FrÃ©chet distribution for productivity. The distribution of the maximum is then
h
i
P[max{A1 , . . . , AN } â‰¤ a] = exp âˆ’ G(T1 , . . . , TN )aâˆ’Î¸ ,
for some correlation function G.1 Countries can now have different weight on the
1

A correlation function, often referred as a tail dependence function or a extremal index function in
probability and statistics, gives a way of representing a max-stable copula.

1

scale of the maximum. In this way, our framework generalizes EK, maintains its
tractability, and allows us to extend the results of Arkolakis et al. (2012) (henceforth, ACR) to incorporate how similarity between countries influences the gains
from trade.
The assumption of a max-stable multivariate FrÃ©chet productivity distribution implies a factor demand system with expenditure shares that match choice probabilities in generalized extreme value (GEV) discrete choice models (McFadden, 1978).
As a result, any trade model that generates a GEV factor demand system is observationally equivalent to a model in our framework for some specification of
the correlation function. In fact, our framework captures general Ricardian theory due to an approximation result: The GEV class approximates any Ricardian
modelâ€”without the need to restrict to FrÃ©chet productivity distributions. Hence,
any factor demand system generated by the Ricardian trade model can be approximated using a multivariate FrÃ©chet distribution of productivity. Put simply, our
framework captures the full aggregate implications of Ricardian trade theory.2
Despite this generality, our theory leads to intuitive and tractable counterfactual
analysis. We show that within the class of GEV factor demand systems, we can
calculate the gains from trade as a simple adjustment to the case of a constantelasticity-of-substitution (CES) demand system. Specifically, we show that the results of ACR generalize, after a simple correction, to the class of models whose
demand systems fit into the GEV form. In the Ricardian context, this correction
adjusts a countryâ€™s self-trade share to account for correlation in technology with
the rest of the world, formalizing Ricardoâ€™s insight that more dissimilar countries
have higher gains from trade. Additionally, for any given pattern of correlation
across countries, the adjusted self-trade share is calculated using only data on expenditure shares across countries, preserving the simplicity of ACR.
We can also leverage the max-stability property to get closed-form aggregation,
and to get guidance on how to use micro data to discipline macro factor demand
systems. This result brings existing Ricardian models into a unifying framework.
Specifically, the GEV class accommodates many disaggregate Ricardian models of
trade, such as multi-sector models (Costinot et al., 2012; Costinot and RodrÃ¬guezClare, 2014; Caliendo and Parro, 2015; Ossa, 2015; Levchenko and Zhang, 2016;
French, 2016), multinational production models (Ramondo and RodrÃ­guez-Clare,
2

While in the body of the paper we assume that preferences are CES, in Online Appendix O.2.1,
we relax this assumption.

2

2013), global value chain models (AntrÃ s and de Gortari, 2017), and models of
trade with domestic geography (Fajgelbaum and Redding, 2014; Ramondo et al.,
2016; Redding, 2016). In Section 6, we show that all these models, once aggregated at the bilateral level, can be represented by a model in which productivity is
distributed multivariate FrÃ©chet with a correlation function appropriately chosen.
We next assess the empirical relevance of correlation. In our quantitative application, we estimate a multi-sector model of trade where correlation in productivity
can depend on the proximity of countries. This spatial correlation model captures
the possibility that nearby countries may share similar technologyâ€”and therefore
have correlated productivity drawsâ€”by allowing for distance-dependent elasticities of substitution across countries, within sectors.
Our estimates show that correlation follows a spatial pattern: Distant countries
have productivity draws with lower correlation. This empirical result has important implications for counterfactuals. Accounting for these spatial correlation patterns translates into gains from trade that can be much higherâ€”and much more
heterogenousâ€”than the gains calculated without accounting for correlation.
This paper relates to several strands of the literature. First, we naturally make contact with the large trade literature using the Ricardian-EK framework in its various
forms (see Eaton and Kortum, 2012, for a survey). More generally, our approach
can be applied to any environment that requires FrÃ©chet tools, with the potential
of changing some of their quantitative conclusions. In particular, it can be applied
to selection models used in the growth literature (such as Hsieh et al., 2013), and
the macro development literature (such as Lagakos and Waugh, 2013; Bryan and
Morten, 2018), as well as to recent trade models used in the urban literature (such
as Ahlfeldt et al., 2015; Monte et al., 2015; Caliendo et al., 2017), reviewed in Redding and Rossi-Hansberg (2017).
Second, we relate to papers in the international trade literature that use non-CES
factor demand systems.3
The early work by Wilson (1980) shows how the Ricardian model in Dornbusch
et al. (1977), extended to an arbitrary number of countries, can be reduced to analyzing the properties of an exchange economyâ€”-countries trade their labor with
3

A related trade literature departs from CES with the goal of analyzing endogenous markups
and their effects on the gains from trade. See DeLoecker et al. (2016), Feenstra and Weinstein (2017),
Bertoletti et al. (2017), and Arkolakis et al. (2017), among others.

3

each other. Under some restrictions on the properties of the factor demand system (i.e., gross substitutes and homotheticity), some comparative static results are
derived, such as the effect of increasing tariffs from zero uniformly across goods.
Results, however, are only local. Additionally, Scarf and Wilson (2005) present a
Ricardian model with a demand structure that satisfies the gross substitutability
property, and in which productivity follows an arbitrary probability distribution.
They show that, in this case, the competitive equilibrium exists and is unique.
We restrict our attention to the sub-class of GEV factor demand systemsâ€”which
includes models used extensively in the trade literatureâ€”and show that it can approximate any demand system generated by the Ricardian model.
Adao et al. (2017), building on the idea in Wilson (1980), show how to calculate
macro counterfactual exercises in neoclassical trade models with invertible factor
demand systems, and provide sufficient conditions for non-parametric identification using aggregate trade data. In our paper, we restrict to the GEV classâ€”a
subclass with the invertibility property. Given that restriction, our aggregation result allows us to relate various micro structures to the macro demand systems that
they study, and, as a result, to use variation in disaggregate data to identify macro
substitution patterns. All in all, our paper provides a bridge between the macro
results of Adao et al. (2017) and estimates, common in the trade literature, based
on micro data.4
In that regard, papers such as Caron et al. (2014), Lashkari and Mestieri (2016),
Brooks and Pujolas (2017), Feenstra et al. (2017), and Bas et al. (2017), among others, estimate non-CES demand systems using disaggregate data. Even though they
abandon the class of homothetic demand systems, which we do not, they aim, as
we do, at showing the consequences of abandoning the assumptions that lead to
linear gravity systems, and at incorporating more detailed micro data to estimate
key elasticities. They all notice the failure of aggregate theories to incorporate the
richness of the micro data (e.g., heterogeneous price and income elasticities across
traded goods), and "fix it" by assuming non-CES demand systems.5 By linking var4

Our paper shares a common theme with Redding and Weinstein (2017) as they develop a
framework to aggregate from micro trade transactions to macro trade and prices using the class of
nested invertible demand systems.
5
Caron et al. (2014) use a constant-relative-elasticity-of-income utility functions to link characteristics of goods in production to their characteristics in preferences, and in this way explain some
"puzzles" observed in the data on trade patterns. Lashkari and Mestieri (2016) use constant-relativeelasticity-of-income-and-substitution (CREIS) utility functions that allow for general relationships
between income and price elasticies. Brooks and Pujolas (2017) analyze the expression for gains

4

ious micro structures to common primitives of technology, our general framework
provides guidanceâ€”given by our aggregation resultâ€”on how to incorporate the
micro estimates in this literature into macro counterfactual exercises.
In contrast with this literature, from the supply-side point of view of our framework, substitution patterns come from the degree of technological similarityâ€”i.e.,
correlationâ€”between countries. As a result, we can incorporate destination-origin
elasticities without relying on demand-side factors and non-CES preferences.6
Finally, we relate to the literature on dynamic innovation and knowledge diffusion
processes that generate FrÃ©chet productivityâ€”as in Kortum (1997), Eaton and Kortum (1999), Eaton and Kortum (2001), and Buera and Oberfield (2016). We make
contact with this literature by introducing a global innovation representation for productivity. This representation characterizes multivariate FrÃ©chet productivity as
the consequence of technology adoption, and provides an economic justification
for any choice of the correlation function. In this representation, an (unbounded)
collection of innovations for the production of each good exists. The productivity of each innovation depends on a global componentâ€”common across countries and capturing the fundamental efficiency of the technologyâ€”and a spatial
applicability componentâ€”unique to each country pair and capturing bilateral factors influencing efficiency. For each good the global component follows a Poisson
process, while spatial applicability can have any distribution. We then apply the
spectral representation theorem for max-stable processes (De Haan, 1984; Penrose,
1992; Schlather, 2002) and establish that productivity has this global innovation
representation if and only if it is distributed max-stable multivariate FrÃ©chet. This
result not only provides economic primitives for productivity, but it also gives a
method to compute correlation functions from any underlying assumptions on the
applicability of technology across the globe.
from trade arising from models with unrestricted utility functions (typically non-homothetic) that
generate a non-constant trade elasticity. Feenstra et al. (2017) use a nested CES utility function to estimate micro and macro elasticities of substitution in a multi-sector model. Finally, Bas et al. (2017)
break the Pareto assumption in the Melitz model of trade to get country-pair specific aggregate
elasticities, which they estimate using sectoral-level trade data.
6
In Online Appendix O.2, we show extensions of our framework that include comparative advantage coming from demand-side factors as in the Armington model of trade (Anderson, 1979),
and from entry of heterogenous firms as in the Krugman-Melitz model of trade (Krugman, 1980;
Melitz, 2003). Similarly to ACR, these results make clear which assumptions on economic fundamentals lead to equivalence within a large and useful class of models.

5

2

Ricardian Model of Trade

Consider a global economy consisting of N countries that produce and trade in a
continuum of product varieties v âˆˆ [0, 1]. Consumers have identical CES preferR
 Ïƒ+1
Ïƒ
Ïƒ
1
.7 Given total
ences with elasticity of substitution Ïƒ > âˆ’1, Cd = 0 Cd (v) Ïƒ+1 dv
expenditure of Xd , expenditure on variety v is Xd (v) â‰¡ Pd (v)Cd (v) = (Pd (v)/Pd )âˆ’Ïƒ Xd
R
âˆ’ Ïƒ1
1
âˆ’Ïƒ
is the price level
where Pd (v) is the price of the variety, and Pd = 0 Pd (v) dv
in country d.
We assume that the production function for varieties presents constant returns to
scale in labor and depends on both the origin country o where the good gets produced and the destination market d where it gets delivered. For each v âˆˆ [0, 1],
output Yod (v) satisfies
Yod (v) = Aod (v)Lod (v),

(1)

where Lod (v) is the amount of labor used to produce variety v at origin o for delivery to d and Aod (v) is the marginal product of laborâ€”referred to as productivity.
This productivity variable captures both efficiency of production in the origin and
inefficiencies associated with delivery to the destination (i.e., trade costs).
The marginal cost to deliver a particular variety v to destination d from origin o is
cod (v) =

Wo
,
Aod (v)

(2)

where Wo is the nominal wage in country o. As in the original EK model, we assume perfect competition so that prices are equal to unit costs, Pod (v) = cod (v).
Good v is provided to country d by the cheapest supplier, so its price in the destination market is
Pd (v) = min

o=1,...,N

Wo
.
Aod (v)

(3)

As in EK, we capture heterogeneity in production possibilities by modeling productivity as a random draw. We focus on multivariate random variables which
satisfy a property known as max stability. The EK model, which is built on in7

The restriction to CES preferences is not necessary for our main results, which rely only on
expenditure shares matching import probabilities. In Online Appendix O.2.1, we show that if consumer preferences are homothetic and generate demand satisfying a law of large numbers on Borel
subsets of the continuum of varieties, expenditure shares equal import probabilities when productivity is multivariate Î¸-FrÃ©chet. We focus on CES preferences for comparability to the standard EK
framework.

6

dependent FrÃ©chet random variables, gets its tractability from this property. By
relaxing their independence assumption, we get a flexible, yet tractable, model of
trade that captures Ricardoâ€™s insight that the degree of technological similarity determines the gains from trade. Importantly, by assuming that random productivity
is country-pair specific, we are able to introduce purely Ricardian bilateral motives
for trade.

2.1

Max-Stable Multivariate FrÃ©chet Productivity

We start by providing a brief overview of max-stable multivariate Type II extreme
value (FrÃ©chet) random variables. We first define a multivariate Î¸-FrÃ©chet random
vector.
Definition 1 (Multivariate Î¸-FrÃ©chet). A random vector, (A1 , . . . , AK ), has a multivariate Î¸-FrÃ©chet distribution if for any Î±k â‰¥ 0 with k = 1, . . . , K the random variable maxk=1,...,K Î±k Ak has a FrÃ©chet distribution with shape parameter Î¸. In this case,
the marginal distributions are FrÃ©chet with (common) shape parameter Î¸ and, for each
k = 1, . . . , K, satisfy


P [Ak â‰¤ a] = exp âˆ’Tk aâˆ’Î¸ ,

(4)

for some scale parameter Tk .
This definition implies that a multivariate Î¸-FrÃ©chet distribution is max stableâ€”the
maximum has the same marginal distribution up to scaling. The multivariate Î¸FrÃ©chet distribution includes as special cases the independent multivariate FrÃ©chet
distribution in EK, and the symmetric multivariate FrÃ©chet distribution used in
Ramondo and RodrÃ­guez-Clare (2013). For both special cases, the max-stability
property holds and lends the models their tractability.
By working with the class of multivariate Î¸-FrÃ©chet random vectors, we can put
minimal restrictions on dependence and maintain the key property of max-stability.
Notice that the restriction to a common shape is necessary for max stability; general
multivariate FrÃ©chet distributions may have marginal distributions with different
shape parameters, in which case the maximum, even with independence, is not
distributed FrÃ©chet.
To make headway without the independence assumption, we characterize the joint
distribution of a multivariate Î¸-FrÃ©chet random vector by first defining the func7

tion that summarizes its correlation structure.
Definition 2 (Correlation Function). G : RK
+ â†’ R+ is a correlation function if:
1 (Normalization). G(0, . . . , 0, 1, 0, . . . , 0) = 1;
2 (Homogeneity). G is homogeneous of degree one;
3 (Unboundedness). G(x1 , . . . , xK ) â†’ âˆž as xk â†’ âˆž for any k = 1, . . . , K; and
4 (Differentiability). The mixed partial derivatives of G exist and are continuous up
to order K. The kâ€™th partial derivative of G with respect to k distinct arguments is
non-negative if k is odd and non-positive if k is even.
A correlation function is closely related to a max-stable copula and adds a normalization restriction to the definition of a social surplus function in GEV discrete choice models (McFadden, 1978).8 This normalization restriction provides
us with notation to distinguish between absolute advantageâ€”captured by scale
parametersâ€”and comparative advantageâ€”captured by a correlation function. Correlation functions reflect comparative advantage because they measure relative
productivity levels across varieties and across origin countries within the same
destination market.
Next, we characterize the joint distribution of any multivariate Î¸-FrÃ©chet random
vector in terms of the scale parameters of its marginal distributions and a correlation function.
Lemma 1 (Correlation Function Representation). The random vector (A1 , . . . , AK )
is multivariate Î¸-FrÃ©chet if and only if there exists scale parameters Tk for k = 1, . . . , K
and a correlation function G such that its joint distribution satisfies


âˆ’Î¸
.
P [Ak â‰¤ ak , k = 1, . . . , K] = exp âˆ’G T1 aâˆ’Î¸
1 , . . . , T K aK

(5)

Proof. The result follows closely Theorem 3.1 of Smith (1984). See Appendix B.
This standard result from probability theory allows us to parameterize joint distributions using scale parameters and correlation functions. The restrictions defining
A max-stable copula is a copula C : [0, 1]N â†’ [0, 1] satisfying C(u1 , . . . , uN )Î· = C(uÎ·1 , . . . , uÎ·N )
for Î· > 0. The map (u1 , . . . , uN ) 7â†’ eâˆ’G(âˆ’1/ ln u1 ,...,âˆ’1/ ln uN ) is the max-stable copula associated
with a correlation function G.
8

8

a correlation function ensure that (5) characterizes a valid multivariate Type II extreme value (FrÃ©chet) distribution.
Importantly, using the characterization in Lemma 1 and the homogeneity property
of the correlation function, we get the max-stability property. The maximum of a
multivariate Î¸-FrÃ©chet random vector is Î¸-FrÃ©chet,

P




max Ak â‰¤ a = exp âˆ’G (T1 , . . . , TK ) aâˆ’Î¸ ,

(6)

k=1,...,K

with scale parameter given by G (T1 , . . . , TK ) and shape parameter given by Î¸.
Evaluated at the scale parameters of the marginal distributions, the correlation
function acts as an aggregator that returns the scale parameter of the maximum.
Moreover, as in EK, the conditional and unconditional distributions of the maximum are identical,

P





max Ak0 â‰¤ a | Ak = 0 max Ak0 = P

k0 =1,...,K

k =1,...,N


max Ak0 â‰¤ a .

(7)

k0 =1,...,K

This result is crucial for tractability in EK because it ensures that expenditure
shares simply reflect the probability of importing from an origin country. Because
this property holds for general multivariate Î¸-FrÃ©chet random vectors, our model
inherits the same tractability. Appendix A formally presents this and other properties of FrÃ©chet random variables which we use throughout the paper.
To fix ideas, consider the special case of independent productivityâ€”used by EK.
Independence implies that the correlation function is additive,
P[A1d (v) â‰¤ a1 , . . . , Aod (v) â‰¤ aN ] =

Y

P[Aod (v) â‰¤ ao ] = exp âˆ’

N
X

!
Tod aâˆ’Î¸
o

.

o=1

o=1,...,N

The max-stability property holds since

P

"



max Aod (v) â‰¤ a = exp âˆ’

o=1,...,N

N
X

!
Tod

#
aâˆ’Î¸ .

o=1

An additive correlation function imposes a strong assumption, namely, that comparative advantages across countries are symmetric. Our framework relaxes independence while maintaining the max-stability property. By breaking this symmetry, our model accommodates heterogeneity in comparative advantage, and, as we
9

show in Section 4, allows us to formalize how similarity in technology matters for
the gains from trade.
The next section shows how a correlation function can be constructed from fundamentals, and hence, provides an economic justification for any choice of G.

2.2

Global Innovation Representation of Productivity

We present a structure for technology that is necessary and sufficient for productivity
to be distributed multivariate Î¸-FrÃ©chet. This structure can be interpreted as the result of adopting technologiesâ€”which are a product of global innovationsâ€”based
on a countryâ€™s ability to apply each innovation. Theorem 1 characterizes multivariate Î¸-FrÃ©chet distributions as precisely the productivity distributions arising from
global innovation.
The result is based on a technology structure that satisfies three assumptions.
Assumption 1 (Innovation Decomposition). There exists Î¸ > 0 and, for each v âˆˆ
[0, 1], a countable set of global innovations, i = 1, 2, . . . , with global productivity {Zi (v)}i=1,2,...
and spatial applicability {{Aiod (v)}N
o=1 }i=1,2,... satisfying
Aod (v) = max (Zi (v)Aiod (v))1/Î¸ .
i=1,2,...

(8)

Assumption 2 (Independence). {{Aiod (v)}N
o=1 }i=1,2,... is independent of {Zi (v)}i=1,2,...
and i.i.d. over i = 1, 2, . . . and v âˆˆ [0, 1] with EAiod (v) < âˆž.
Assumption 3 (Poisson Innovations). The collection {Zi (v)}i=1,2,... consists of the
points of a Poisson process with intensity measure z âˆ’2 dz, and is i.i.d. over v âˆˆ [0, 1].
First, Assumption 1 defines a structure for technology that can be interpreted as
arising from global innovation and technology adoption. For each good v, there is
a countable collection of technological innovations i = 1, 2, . . . that influence the
marginal product of labor. These innovations represent physical techniques (i.e.,
blueprints) for producing a good. For a given good v, each innovation i has a global
productivity component, Zi (v), and an origin-destination specific spatial applicability
component, Aiod (v). The global productivity component measures the fundamental efficiency of technique i. Accordingly, it is identical across all origins and destinations. In turn, the spatial applicability component captures origin-destination
10

specific factors that determine the efficiency of the technique when adopted at origin o to deliver goods to destination d.
Second, the key aspect of Assumption 2 is that it does not impose independence
of applicability across origin countries; instead, it allows for arbitrary patterns of
correlation. Moreover, the assumption does not impose any particular joint distribution for applicability; this distribution can belong to any family so long as
its first moments exists. In our examples, we use FrÃ©chet distributions for spatial
applicability only because they lead to closed-form solutions.
Finally, Assumption 3 states that the global productivity component, Zi (v), follows
a non-homogenous Poisson process over iâ€™s, for each v. This assumption implies
that the number of innovations whose global productivity satisfies a < Zi (v) â‰¤ b
is a Poisson random variable. It also implies that the distribution of Zi (v) over v,
1

conditional on i, is Pareto with shape parameter i and lower bound (i!)âˆ’ i .9 Loosely
speaking, better innovations (i.e., with higher global productivity) are less likely to
be observed, but conditional on being observed, later innovations (with higher i)
have a higher lower bound and thinner-tailed (lower-variance) Pareto distribution
across goods v.
One can interpret Assumption 3 as arising from some random discovery process
as in Eaton and Kortum (1999, 2010). In our static framework, we can interpret i as
indexing the collection of all innovations up until the present. Rather than assuming that innovations are country specific, innovationsâ€”which represent physical
methods to produce a goodâ€”are globally applicable. Origin countries differentially load on global productivity through their individual draw of spatial applicability, Aiod (v), and adopt whichever innovation is most efficient for them.
The following theorem is a consequence of the spectral representation theorem for
max-stable processes (De Haan, 1984; Penrose, 1992; Schlather, 2002).
Theorem 1 (Global Innovation Representation). Productivity, {Aod (v)}N
o=1 , is multivariate Î¸-FrÃ©chet if and only if it satisfies Assumptions 1, 2, and 3. In this case, we say
that productivity has a global innovation representation.
Let {Aiod (v)}N
o=1 denote an underlying spatial applicability process. Then, the joint proWe have that P[Zi (v) > z] = P[Zi (v)âˆ’1 < t] for t = z âˆ’1 . Then, since {Zi (v)}i=1,2,... are
the points of a non homogenous Poisson process with intensity measure z âˆ’2 dz, {Zi (v)âˆ’1 }i=1,2,...
Pâˆž j
i
âˆ’i
are the points of a homogenous Poisson process, and P[Zi (v)âˆ’1 < t] = j=i tj! eâˆ’t = ti! = zi! .

âˆ’i
z
Therefore, P[Zi (v) â‰¤ z] = 1 âˆ’ (i!)âˆ’1/i
.
9

11

ductivity distribution is


âˆ’Î¸
,
P [A1d (v) â‰¤ a1 , . . . , AN d (v) â‰¤ aN ] = exp âˆ’Gd T1d aâˆ’Î¸
1 , . . . , T N d aN

(9)

with scale Tod â‰¡ EAiod (v), for o = 1, . . . , N , and correlation function
Gd (x1 , . . . , xN ) â‰¡ E max

o=1,...,N

Aiod (v)
xo .
Tod

(10)

Proof. See Appendix C.
This characterization of productivity establishes primitive assumptions on global
technology that are necessary and sufficient for Î¸-FrÃ©chet-distributed productivity across origin countries.10 Î¸-FrÃ©chet productivity can always be interpreted as
arising from the spatial applicability of global technologies. Intuitively, both absolute advantage (the scale parameters) and comparative advantage (the correlation
function) depend on the ability of exporters to adopt innovations to technology.
This result also provides a method to compute scale parameters and correlation
functions: They are simply the moments of spatial applicability and the expected
value of the maximum of applicability after scaling. Put differently, Theorem 1
gives guidance on how to construct max-stable copulas.
Concretely, assume that the spatial applicability of individual technologies is independent across o and distributed FrÃ©chet with scale Î“(1 âˆ’ 1/Ï‘)âˆ’Ï‘ Sod , shape Ï‘ > 1,
and Î“ the gamma function. The constant on the scale ensures that productivity
remains finite as Ï‘ â†’ 1.
First, we compute the scale parameters of productivity. Theorem 1 establishes that
the scale parameters equal the first moments of spatial applicability. By Lemma A.1,
1/Ï‘

Tod = Sod .
Next, we derive the correlation functionâ€”i.e., the expectation in (10). From Lemma A.1,
(Aiod (v)/Tod )xo is Ï‘-FrÃ©chet with scale xÏ‘o . Due to independence and max-stability,
the maximum over o is also Ï‘-FrÃ©chet and its scale is the sum of the underlying
10

It is worth noting that, contrary to the insight first in Kortum (1997), in which the distribution
of the best idea belongs to the extreme value family in the limit, this result is exact.

12

scale parameters. Using Lemma A.1 to compute the expectation in (10) yields
Gd (x1 , . . . , xN ) =

N
X

1
1âˆ’Ï

!1âˆ’Ï

xo

o=1

,

1
where Ï â‰¡ 1 âˆ’ .
Ï‘

(11)

The implied joint distribution of productivity follows from (9) in Theorem 1.
The correlation function in (11) takes the form of a CES aggregator. The coefficient Ï measures the degree of correlation, which arises from dispersion in spatial
applicability, controlled by the shape parameter Ï‘. As Ï‘ â†’ 1, dispersion in applicability is high, and Ï â†’ 0. Intuitively, when applicability becomes very fat
tailed, it dominates the contribution of the common global component of productivity. In this limiting case, productivity is independent and the correlation function is additiveâ€”as in EKâ€”due to our assumption that applicability is independent across countries. In contrast, as Ï‘ â†’ âˆž, dispersion in applicability becomes
negligible and Ï â†’ 1. In this case, applicability becomes deterministic and heterogeneity in productivity is entirely determined by the global component, Zi (v). As
a result, productivity becomes perfectly correlated across countries.
This example provides intuition for how Theorem 1 generates varying degrees of
correlation in productivity from underlying assumptions on the applicability of
technology across the globe. High dispersion in spatial applicability dampens the
importance of the common global component of productivity and reduces correlation. This example is also a useful building block for generating richer correlation
functions when combined with our aggregation result in Section 5.
As another application of Theorem 1, we compute a cross-nested CES (CNCES)
correlation function. This example demonstrates how to build correlation functions from underlying microfoundations for technology adoption.
Consider a latent (within country) technology adoption decision where applicability comes from a choice of how to apply each innovation. In particular, firms select an application m across M alternatives so that Aiod (v) = maxm=1,...,M Aimod (v).
Assume that applicability is independent across m and for each m it is Ï‘-FrÃ©chet
across o with scale Î“(1 âˆ’ 1/Ï‘)âˆ’Ï‘ Tmod and a correlation function as in (11) with
Ïm âˆˆ [0, 1).
First, we compute the scale parameters of the productivity distribution. Due to
independence, the maximum of applicability over m is Ï‘-FrÃ©chet with scale Î“(1 âˆ’

13

1/Ï‘)âˆ’Ï‘

PM

m=1

P
1/Ï‘
Tmod . From Lemma A.1, productivity has scale Tod = ( M
.
m=1 Tmod )

(v)
Next, we compute the correlation function. By Lemma A.2, { Aimod
xo } N
o=1 is Ï‘Tod

FrÃ©chet with scale Tmod (xo /Tod )Ï‘ and CES correlation function with parameter Ïm .
Due to max-stability, the maximum over o is also Ï‘-FrÃ©chet and it has scale equal to
P
1
Ï‘ 1âˆ’Ïm 1âˆ’Ïm
)
. Due to independence, the scale of the maximum
( N
o=1 (Tmod (xo /Tod ) )
over m is simply the sum of these scale parameters. Using Lemma A.1 and focusP
ing on the limiting case of Ï‘ â†’ 1, we have Tod = M
m=1 Tmod and
d

G (x1 , . . . , xN ) =

M
X

N
X

m=1

o=1

!1âˆ’Ïm
(Ï‰mod xo )

1
1âˆ’Ïm

,

(12)

for Ï‰mod â‰¡ Tmod /Tod . The relative efficiency of application m for origin o when
delivering to destination d determines the weight of application m within the resulting CNCES correlation function. The implied productivity distribution follows
from (9) in Theorem 1.11
Summing up, Theorem 1 allows us to relate alternative specifications for the correlation function to underlying primitive assumptions on the nature of technological adoption. When developing models based on FrÃ©chet-distributed productivity, one can either use a particular specification for applicabilityâ€”possibly arising
from a model of innovationâ€”and derive the implied Gd using Theorem 1, or, alternatively, directly specify a correlation function satisfying the restrictions in Definition 2. The key contribution of Theorem 1 is to provide an economic justification
for any choice of the correlation function, and to provide a method for computing
correlation functions implied by models of technology adoption.

2.3

Prices and Trade Shares

We now characterize import price distributions and expenditure shares under the
assumption that productivity is multivariate Î¸-FrÃ©chet. The marginal cost to deliver a particular variety v to destination d from origin o is given by (2). The joint
distribution of potential import prices is shown in the next proposition.
Proposition 1 (Potential Import Price Distribution). If productivity has a multivariate Î¸-FrÃ©chet distribution, then the joint distribution of prices presented to destination
11

In a recent paper, Lashkaripour and Lugovskyy (2017) use a nested FrÃ©chetâ€”with latent factors representing firm-specific qualityâ€”to generalize EK. Their example fits into the productivity
representation in our Theorem 1.

14

market d is given by a multivariate Weibull distribution satisfying12


P[P1d (v) â‰¥ p1 , . . . , PN d (v) â‰¥ pN ] = exp âˆ’Gd T1d W1âˆ’Î¸ pÎ¸1 , . . . , TN d WNâˆ’Î¸ pÎ¸N .
Proof. See Appendix D.
The joint distribution of productivity determines the joint distribution of potential
import prices. For each origin o, the marginal distribution of prices, P[Pod (v) â‰¤


p] = 1 âˆ’ exp âˆ’Tod Woâˆ’Î¸ pÎ¸ , is a Weibull distribution with scale parameter Tod Woâˆ’Î¸
and shape parameter Î¸. The correlation function Gd determines the dependence
structure.
Define bilateral import price indices as Pod â‰¡

R

1
0

âˆ’Ïƒ

Pod (v)

dv

âˆ’ Ïƒ1

. Proposition 1 to-

gether with Lemma A.1 implies that
âˆ’1/Î¸

Pod = Î³Tod

(13)

Wo .

with Î³ > 0 defined in Proposition 2. Nominal import prices are proportional to the
exporter nominal wage, Wo , and decreasing in the bilateral productivity parameter, Tod . We can interpret the scale parameters of the productivity distribution as
bilateral cost shifters, and map them into into standard variables in the trade liter1/Î¸

ature: an origin country productivity index, Ao â‰¡ Too , and an iceberg trade cost index,
Ï„od â‰¡ (Too /Tod )1/Î¸ . The variable Ao measures a countryâ€™s ability to produce goods
in their domestic market, while Ï„od measures efficiency losses associated with delivering goods to market dâ€”the standard iceberg-type trade costs. Re-writing (13)
using these indices yields Pod = Î³Ï„od Wo /Ao .
Given the distribution of potential import prices, a country imports each variety
from the cheapest source. The max-stability property for the productivity distribution, together with the previous characterization of the potential import price
distribution, leads to closed-form results for trade shares and the price index.
Proposition 2 (Generalized EK). Suppose productivity has a multivariate Î¸-FrÃ©chet
distribution with Î¸ > Ïƒ. Then,
12

A random vector (B1 , . . . , BK ) is multivariate Weibull if its marginal distributions are Weibull:
Î¸
P[Bk â‰¤ b] = 1 âˆ’ eâˆ’Sk b k for some scale Sk > 0 and shape Î¸k > 0 across k = 1, . . . , K. Note that if
âˆ’1
(A1 , . . . , Ak ) is Î¸-FrÃ©chet, then the vector (Aâˆ’1
1 , . . . , AK ) is multivariate Weibull and its marginals
have common shape Î¸k = Î¸, for each k = 1, . . . , K.

15

1. The share of varieties that destination d imports from o is
Tod Woâˆ’Î¸ God
Ï€od = PN
,
âˆ’Î¸
o0 =1 To0 d Wo Go0 d

(14)

where
God â‰¡ Gdo T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸



and

Gdo (x1 , . . . , xN ) â‰¡

âˆ‚Gd (x1 , . . . , xN )
;
âˆ‚xo
(15)

2. The distribution of prices among goods imported into country d from o is identical
to the distribution of prices in d.
3. Total expenditure by country d on goods from country o is Xod = Ï€od Xd ; and
4. The price index in country d is
Pd = Î³Gd T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸
where Î³ â‰¡ Î“

 1
Î¸âˆ’Ïƒ âˆ’ Ïƒ
Î¸

âˆ’ Î¸1

,

(16)

and Î“(Â·) is the gamma function.

Proof. See Appendix E.
First, the formula for the expenditure share, Ï€od , takes the same form as choice
probabilities in GEV discrete choice models (McFadden, 1978), with the quantity
Tod Woâˆ’Î¸ taking the place of choice-specific utility, as we explain in Section 3. Note
that this quantity is monotonically related to the import price index in (13).
Second, using (14) and (16), correlation-adjusted expenditure sharesâ€”defined as
âˆ—
Ï€od
â‰¡ Ï€od /God â€”are CES,
âˆ—
Ï€od


âˆ’Î¸
Wo
= Tod Î³
.
Pd

(17)

Hence, they constitute a gravity system as defined by ACR. In fact, together (13)
and (17) imply that correlation-adjusted expenditure shares are sufficient statisâˆ—
tics for real import prices: Ï€od
= (Pod /Pd )âˆ’Î¸ . This interpretation will be particu-

larly useful when we examine counterfactual analysis and compute correlationadjusted expenditure shares in Section 4.2.
Third, as in EK, the distribution of prices among goods actually imported into market d is identical to the overall distribution of prices in d. As a result, expenditure

16

shares are equal to the share of varieties imported into d from o. This result follows
from the property that the conditional distribution of the maximum of a multivariate FrÃ©chet random vector is identical to its unconditional distribution, as shown
in Lemma A.3.
Finally, the price level in each destination market is determined by the correlation
function, Gd . In fact, due to (13) and (16), the price level is determined by aggregat1

âˆ’Î¸
ing import price indices using the correlation function: Pd = Gd (P1d
, . . . , PNâˆ’Î¸d )âˆ’ Î¸ .

In analogy to the discrete choice literature, welfare calculations depend crucially
on the specification of this function.

3

GEV Factor Demand Systems

What macro substitution patterns does this theory generate? To answer this question, we first establish, in Corollary 1, that the Ricardian model with multivariate Î¸-FrÃ©chet productivity implies expenditure shares that match choice probabilities in GEV discrete choice models (McFadden, 1978). We then establish in
Proposition 3 that the demand systems generated by the Ricardian model with Î¸FrÃ©chet-distributed productivity can approximate any demand system generated
by stochastic productivity. That is, our framework allows us to approximate any
factor demand systems consistent with Ricardian trade, under the assumptions of
constant returns to scale in production, competitive markets, and a single factor of
production in each country.13
First, we define a factor demand system for destination d as a collection of expenditure share functions {Ï€od }N
o=1 such that for each o = 1, . . . , N the function Ï€od :
RN
+ Ã— R+ â†’ [0, 1] is homogenous of degree zero and for any vector of wages
PN
W â‰¡ (W1 , . . . , WN ) âˆˆ RN
+ and level of expenditure Xd â‰¥ 0,
o=1 Ï€od (W, Xd ) = 1.
Next, we define the class of GEV factor demand systems.
Definition 3 (GEV Factor Demand System). A generalized extreme value (GEV) facGEV N
tor demand system for destination d is a factor demand system, {Ï€od
}o=1 , such that there
d
exists a shape parameter Î¸ > Ïƒ, scale parameters {Tod }N
o=1 , and a correlation function G

satisfying
GEV
Ï€od
(W, Xd ) = P
13

Tod Woâˆ’Î¸ Gdo (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )
,
âˆ’Î¸ d
âˆ’Î¸
âˆ’Î¸
0 d W 0 G 0 (T1d W
T
,
.
.
.
,
T
W
)
0
o
N
d
1
N
o
o
o

As mentioned in Footnote 2, CES preferences are not crucial for our results.

17

(18)

for all o = 1, . . . , N .
The GEV class is homothetic since expenditure shares do not depend on overall
expenditure. It is closely related, as mentioned above, to the functional form for
choice probabilities in GEV discrete choice models. It differs slightly, however,
because the correlation function is a restricted version of the social surplus function
in GEV models due to our normalization restriction in Definition 2.
An important class of models within the GEV class are CES factor demand systems, as in ACR. These models are generated by an additive correlation function,
implying expenditure shares of the form
CES
Ï€od
(W, Xd )

Tod Woâˆ’Î¸

= PN

o0 =1

To0 d Woâˆ’Î¸
0

(19)

.

The CES specification leads to a gravity system and includes most of the workhorse
models of trade, such as Armington, Melitz, and EK (Arkolakis et al., 2012).
The GEV class, however, is much larger than the CES class. For example, consider
the cross-nested CES correlation function derived in (12),
Gd (x1 , . . . , xN ) =

M
X

N
X

m=1

o=1

!1âˆ’Ïm
(Ï‰mod xo )1/(1âˆ’Ïm )

.

(20)

The factor demand system implied by this correlation function is
Î¸

CNCES
Ï€od
(W, Xd )

=

âˆ’ 1âˆ’Ï
M 
X
m
Pmod
m=1

Pmd

âˆ’Î¸
Pmd

PM

m0 =1

Pmâˆ’Î¸0 d

,

(21)

P
âˆ’1/Î¸
âˆ’Î¸/(1âˆ’Ïm ) âˆ’(1âˆ’Ïm )/Î¸
where Pmod â‰¡ Î³Tmod Wo , and Pmd â‰¡ ( N
)
. The first fraction
o=1 Pmod
on the right-hand side of (21) represents the probability of importing from country
o given that it chose application m. Due to the correlation in applicability across
countries, for a given m, this conditional probability has an elasticity of substitution of Î¸/(1 âˆ’ Ïm ) over the price index of origin o, relative to the destination market
price index, Pmd , for goods produced with application m. The second fraction on
the right-hand side of (21) represents the probability of importing m-goods into
d. Due to independence in applicability across mâ€™s, the elasticity of substitution
between them is simply Î¸.
It is clear from comparing (19) with (21) that the GEV class generates a richer pat18

tern of substitution across exporters than CES. In general, if we compare the elasticity of demand in the GEV and CES models, around any observed expenditure
shares, the difference comes from the correlation function,
GEV
CES
âˆ‚ ln Ï€od
âˆ‚ ln Ï€od
âˆ‚ ln God
=
+
,
âˆ‚ ln Wo0
âˆ‚ ln Wo0
âˆ‚ ln Wo0

with

CES
âˆ‚ ln Ï€od
âˆ‚ ln Wo0

= âˆ’Î¸ (1 âˆ’ Ï€o0 d ) since

âˆ‚ ln Pd
âˆ‚ ln Wo

(22)

= Ï€od .

Our next result states that the GEV factor demand system in (18) matches the expenditure shares of the Ricardian model with multivariate Î¸-FrÃ©chet productivity
in Proposition 2.
Corollary 1 (GEV Equivalence). A trade model generates a GEV factor demand system
if and only if the Ricardian model generates the same factor demand system for some maxstable multivariate FrÃ©chet distribution for productivity.
A direct implication of Corollary 1 is that the Ricardian model generates factor
demand systems matching many (non-CES) trade models. In particular, many existing models are in the GEV sub-class of cross-nested CES factor demand systems,
as we show in Section 6.14
We can push the result in Corollary 1 one step further by adapting results from
the discrete choice literature: GEV random utility models are dense in the space
of all random utility models (Dagsvik, 1995). This result for choice probabilities
does not directly apply to our model since we have CES demand at the variety
level. However, an analogous result holds: The set of factor demand systems
generated by any Ricardian modelâ€”without restricting to Î¸-FrÃ©chet productivity
distributionsâ€”can be approximated arbitrarily well by the class of GEV factor demand systems.
Proposition 3 (GEV Approximation). Let {Aod (v)}N
o=1 have any multivariate distribution whose marginals have finite moment of order Ïƒ. Denote the factor demand system
implied by the Ricardian model when productivity is distributed the same as {Aod (v)}N
o=1
N +1
and any  > 0, there exists a GEV factor
by {Ï€od }N
o=1 . Then for any compact K âŠ‚ R+
GEV N
demand system, {Ï€od
}o=1 , such that

sup

GEV
Ï€od (W, Xd ) âˆ’ Ï€od
(W, Xd ) <  âˆ€o = 1, . . . , N.

(W,Xd )âˆˆK
14

It is worth noting that this subclass can approximate any GEV factor demand system (Fosgerau
et al., 2013) and, by extension, any GEV Ricardian model.

19

Proof. The proof constructs an approximating GEV factor demand system that converges uniformly to the true demand system. See Appendix F.
The key implication of Proposition 3 is that any factor demand system generated
by the Ricardian trade model can be approximated by a Ricardian trade model
where productivity has a multivariate Î¸-FrÃ©chet distribution. Put simply, through
this approximation result, our framework encompasses the full macroeconomic
implications of Ricardian trade theory.

4

Macro Counterfactuals

We next show that heterogeneity in correlation leads to heterogeneity in the gains
from trade and that this heterogeneity affects the calculation of any (counterfactual) departure from the current equilibrium. It turns out that calculations using
a GEV demand system are virtually identical, after a correction for correlation, to
the calculations in ACR for trade models with CES factor demand systems. Moreover, the correlation correction only requires data on expenditure shares across
countries, preserving the simplicity of the ACR calculation of the gains from trade.
From (14), the self-trade share is
Tdd Wdâˆ’Î¸ Gdd
Ï€dd = PN
.
âˆ’Î¸
o=1 Tod Wo God

(23)

Using the expression for the price index in (16), we can write the real wage in
country d as
1
1
Wd
âˆ— âˆ’Î¸
= Î³ âˆ’1 TddÎ¸ (Ï€dd
) ,
Pd

(24)

âˆ—
where Ï€dd
â‰¡ Ï€dd /Gdd is the correlation-adjusted self-trade share.

Let xÌ‚ â‰¡ x0 /x denote the change from x to x0 in an equilibrium outcome due to some
change in the modelâ€™s parameters. Using (24), it is straightforward to show that
the change in real wages between two equilibria is given by
WÌ‚d
PÌ‚d

â‰¡

1
Wd0 /Pd0
âˆ— âˆ’Î¸
) .
= (Ï€Ì‚dd
Wd /Pd

(25)

That is, in any trade model that implies a GEV factor demand system, a (log)
change in equilibrium real wagesâ€”triggered by some shock to the modelâ€™s parametersâ€”
20

is proportional to the (log) change in the correlation-adjusted self-trade share, with
the factor of proportionally given by the parameter, Î¸.15

4.1

Gains From Trade: Autarky

What are the consequences of correlation in technology for the gains from trade
relative to autarky? Intuitively, if two countries have identical idiosyncratic productivity draws across varieties (i.e., the case of perfect correlation), with their
average productivity determining labor costs, they will offer each other identical
prices across varieties, and there would be no scope for trade between them. Our
correlation structure is able to capture this possibility.
In autarky, country d purchases only its own goods so that Ï€dd = 1. Moreover, as
Ï„od â†’ âˆž, Tod â‰¡ (Ao /Ï„od )Î¸ â†’ 0 for o 6= d. As a result, Gdd = 1 (i.e., correlation with
other countries is irrelevant in autarky). Real wages in autarky are simply


Wd
Pd

Autarky

1

= Î³ âˆ’1 TddÎ¸ .

(26)

Dividing (24) by (26), the gains from trade relative to autarky are
GTd â‰¡

Wd /Pd
(Wd /Pd )Autarky


=

Ï€dd
Gdd

âˆ’ Î¸1
.

(27)

This expression generalizes the results of ACR to the class of models with GEV
demand systems. With a CES factor demand system, Gdd = 1 and the gains from
trade in (27) simplify to the ones in ACR where two countries with the same selftrade share have the same gains from trade relative to autarky.
The expression for gains in (27) admits the possibility that if two countries have
the same self trade share, but one country has very similar technology to all other
countriesâ€”i.e., high correlationâ€”their gains from trade will be smaller. In contrast, if that country has dissimilar technology to other countriesâ€”i.e., low correlationâ€”
their gains from trade will be larger. Our general framework captures Ricardoâ€™s
insight on the heterogeneity of gains from trade across countries.
15

In Online Appendix O.1, we define equilibrium formally and show how to apply exact hatalgebra methods to solve for a change from the current (observed) equilibrium to any counterfactual equilibrium.

21

Concretely, consider a three-country world with a correlation function given by

1âˆ’Ï
1/(1âˆ’Ï)
1/(1âˆ’Ï)
Gd (x1 , x2 , x3 ) = x1
+ x2
+ x3 ,
which implies that the joint distribution of productivity across countries is
 

1âˆ’Ï
1
1
âˆ’Î¸ 1âˆ’Ï
âˆ’Î¸ 1âˆ’Ï
âˆ’Î¸
+ (T2d a2 )
P[A1d (v) â‰¤ a1 , A2d (v) â‰¤ a2 , A3d (v) â‰¤ a3 ] = exp âˆ’ (T1d a1 )
+ T3d a3 .
Countries 1 and 2 are technological peers, with the parameter Ï measuring the
degree of correlation in their technology. Country 3â€™s productivity is uncorrelated
with productivity in countries 1 and 2. Then,
God = (T1d W1âˆ’Î¸ )1/(1âˆ’Ï) + (T2d W2âˆ’Î¸ )1/(1âˆ’Ï)

âˆ’Ï

(Tod Woâˆ’Î¸ )Ï/(1âˆ’Ï)

for

o = 1, 2 and

Given that Ï€od = Tod Woâˆ’Î¸ God /Gd (T1d W1âˆ’Î¸ , T2d W2âˆ’Î¸ , T3d W3âˆ’Î¸ ), we can take the ratio
G1d /G2d = (Ï€1d /Ï€2d )Ï , which implies that

God =

Ï€od
Ï€1d + Ï€2d

Ï
for o = 1, 2.

As a result, the gains from trade are
 1âˆ’Ï
âˆ’ 1
GTd = Ï€dd
(Ï€1d + Ï€2d )Ï Î¸

for

d = 1, 2 and

âˆ’1

GT3 = Ï€33Î¸ .

The gains from trade for countries 1 and 2 depend on the degree of correlation
in technology, while the gains from trade for country 3 are pinned down by the
countryâ€™s self-trade share. The corrected self-trade shares for country 1 and 2 end
up being a Cobb-Douglas combinationâ€”with weight given by Ïâ€”between each
countryâ€™s expenditure share on its own goods and on the aggregation of its own
goods with its peerâ€™s goodsâ€”the latter can be interpreted as the self-trade share
if countries 1 and 2 were combined into a single country. When correlation in
technology is zero (Ï = 0), a correlation correction is unnecessary; for positive
correlation, the correction increases effective self trade and implies lower gains
from trade; and for perfect correlation (Ï = 1), the two countries are effectively a
single country and the gains from trade depend on their combined self trade.

22

G3d = 1.

4.2

Calculating the Correlation Correction

To make the necessary adjustment for correlated technology, we need to know
the correlation structure across countries, which requires estimates of Gd . Given
the correlation function, we can then calculate the gains from trade directly from
expenditure data, generalizing the sufficient-statistic approach in ACR.
Because the demand system is CES after the correlation correction, correlationadjusted shares are sufficient statistics for underlying bilateral import prices. The
procedure to compute correlation-adjusted expenditure shares amounts to inverting the demand system, (14).
First, we use (13), (16), and the fact that Gdo is homogenous of degree zero, to rewrite (14) as

Ï€od =

Pod
Pd

âˆ’Î¸

Gdo

"

P1d
Pd

âˆ’Î¸


,...,

PN d
Pd

âˆ’Î¸ #
.

This equation expresses the demand system in terms of real import prices, rather
than bilateral productivity shifters, wages, and price levels.
In fact, due to (13) and (17), the quantities on the right-hand side are exactly equal
to correlation-adjusted expenditure shares.
âˆ—
âˆ—
âˆ—
Ï€od = Ï€od
Gdo (Ï€1d
, . . . , Ï€N
d)

for

o = 1, . . . , N.

(28)

Because correlation-adjusted expenditure shares are sufficient statistics for real import prices, the correlation correction amounts to inverting the demand system.
That is, given expenditure share data and the correlation function of a single destination, we have N equations in the N unknown correlation-adjusted expenditure
shares across origins.16 As a result, we only need expenditure share data to calculate the gains from trade.
16

N
Note that the correlation adjustment is well defined. The mapping from RN
+ to R+ , defined by
the right-hand side of the system in (28), satisfies strict gross substitutability and is homogenous
of degree one. As a result, it is injective (see, for instance, Berry et al., 2013) and there is a unique
âˆ— N
solution for {Ï€od
}o=1 , given {Ï€od }N
o=1 .

23

5

Aggregation

This section provides an aggregation result that links the aggregate trade model
we have studied so far to trade models with more disaggregated structuresâ€”such
as sectors and global value chains.
This aggregation result is important because it allows us to link the macro results
of Adao et al. (2017) and estimates, common in the trade literature, based on micro data. In their paper, they show how to estimate non-parametrically invertible
demand systems using only aggregate trade data. In practice, however, as they
recognize, they need to proceed parametrically (e.g., mixed CES) and they estimate an invertible factor demand system without taking a stance on any particular microfoundation. By being less general and restricting to the GEV class of
factor demand systemsâ€”a sub-class of invertible demand systems with the gross
substitute propertyâ€”our aggregation result enables us to identify macro substitution patterns using disaggregate data (e.g., sectoral data). We provide concrete
applications in the next section.
Our aggregation result follows directly from Definition 1: Max-linear combinations of multivariate Î¸-FrÃ©chet random vectors are multivariate Î¸-FrÃ©chet. This
property implies that we can aggregate models built on optimizing behavior and
FrÃ©chet productivity to get equivalent macro models where productivity is also
FrÃ©chet. Put differently, one can always think of macro-level scale parameters and
macro-level correlation functions as the result of the underlying micro structure.
The following proposition formalizes this result.
Proposition 4 (Aggregation of the Productivity Process). Consider a model with Mo
N
o
micro factors within each origin country o = 1, . . . , N . Let productivity {{Amod (v)}M
m=1 }o=1

be distributed multivariate Î¸-FrÃ©chet with Î¸ > Ïƒ. Denote the associated scale parameters
MN
M1
N
d
o
by {{Tmod }M
â†’ R+ .
m=1 }o=1 and correlation function by F : R+ Ã— Â· Â· Â· Ã— R+

Then, aggregate productivity Aod (v) = maxm=1,...,Mo Amod (v) is also distributed multivariate Î¸-FrÃ©chet. The aggregate scale parameters are, for each o = 1, . . . , N , given by
Tod = F d (01 , . . . , 0oâˆ’1 , Tod , 0o+1 , . . . , 0N ) â‰¡ F od (Tod ),

(29)

where 0o is the zero vector of length Mo , and Tod â‰¡ (T1od , . . . , TMo od ). The aggregate

24

correlation function is given by
Gd (x1 , . . . , xN ) = F d (â„¦1d x1 , . . . , â„¦N d xN ),

(30)

where, for each o = 1, . . . , N , â„¦od â‰¡ (Ï‰1od , . . . , Ï‰Mo od ) is a vector of aggregation weights
with elements Ï‰mod â‰¡ Tmod /Tod for m = 1, . . . , Mo .
Proof. This result follows from the max-stability property. See Appendix G.
Proposition 4 states that we can relate a given macro model with multivariate Î¸FrÃ©chet productivity to an underlying disaggregate model in which productivity
also has a multivariate Î¸-FrÃ©chet distribution. The link between the micro and
macro levels comes from maximizing productivity across mâ€™s within an origin
country.
This aggregation result also produces aggregate expenditure shares belonging to
the GEV class.
Corollary 2 (Aggregation of Expenditure Shares). Suppose that the hypotheses and
notation of Proposition 4 hold. Micro expenditure shares are
Ï€mod

d
Tmod Woâˆ’Î¸ Fmo
T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸

=
F d T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸


for m = 1, . . . , Mo

d
where Tod â‰¡ (T1od , . . . , TMo od ), and Fmo
(X1 , . . . , XN ) â‰¡

and

o = 1, . . . , N,

âˆ‚
F d (X1 , . . . , XN ).
âˆ‚xmo

Then, aggregate expenditure shares are
Ï€od â‰¡

Mo
X
m=1

Ï€mod

Tod Woâˆ’Î¸ Gdo (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )
=
Gd (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )

for o = 1, . . . , N,

where Tod and Gd are given, respectively, by (29) and (30) in Proposition 4.
This result allows us to pass seamlessly between the micro and macro levels. Its
natural consequence is that we can use disaggregate data (e.g., sectoral data) to
estimate the micro correlation function and infer micro scale parameters. We can
then apply Proposition 4 to derive the macro correlation function and macro scale
parameters, and perform macro counterfactual analysis using the results in Section 4. This aggregation result enables us to connect (Ricardian) micro foundations
to macro substitution patternsâ€”as our applications in the next section show.
25

Aggregation weights are key for the aggregation procedure. Because correlationadjusted expenditure is proportional to the scale parameters of both the micro
and macro models, these weights can be recovered by first computing correlationadjusted expenditure from disaggregate expenditure shares.
The logic for computing correlation-adjusted trade shares at the micro level follows
the derivations in Section 4.2. Gravity holds after correcting for correlation at the
micro level,


âˆ’Î¸
Ï€mod
Wo
â‰¡
= Tmod Î³
,
(31)
Fmod
Pd

T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ . We can then recover micro correlationâˆ—
Ï€mod

d
where Fmod â‰¡ Fmo

d
âˆ—
(Î âˆ—1d , . . . , Î âˆ—N d ) where Î âˆ—od â‰¡
Fmo
adjusted expenditure by inverting Ï€mod = Ï€mod
âˆ—
âˆ—
(Ï€1od
, . . . , Ï€M
). Because correlation-adjusted shares are sufficient statistics for lao od

tent prices, this step amounts to inverting the demand system.
From these quantities, we can then compute correlation-adjusted expenditure in
the implied macro model. Using (17), (29), the homogeneity of F od , and (31) we
get
âˆ—
Ï€od
= F od (Î âˆ—od ),

and

Ï‰mod =

âˆ—
Ï€mod
.
âˆ—
Ï€od

(32)

Aggregation weights equal the ratio of micro and macro correlation-adjusted expenditure shares. In addition to being sufficient statistics for real import prices,
these quantities are sufficient statistics for the aggregation weights.

6

Applications

We now present applications in the literature that extend the Ricardian model of
trade in EK to multiple sectors (Caliendo and Parro, 2015), multinational production (Ramondo and RodrÃ­guez-Clare, 2013), domestic geography (Ramondo et al.,
2016), global value chains (AntrÃ s and de Gortari, 2017), and intermediate inputs
(Eaton and Kortum, 2002; Alvarez and Lucas, 2007). All of these models deliver
a GEV factor demand system and illustrate the aggregation result of the previous
section. These applications, by belonging to the GEV class, fall into the class of
factor demand systems with the gross substitutes property; as such, complementarities are precluded.17
17

A notable exceptionâ€”with strong complementaritiesâ€”is Fally and Sayre (2018). They build a
model of trade in scarce and spatially concentrated commodities which implies an import demand

26

6.1

Multiple Sectors

Assume that each country is composed of multiple sectors, s = 1, . . . , S. Caliendo
and Parro (2015) assume that consumers in destination d have Cobb-Douglas preferences with sectoral shares Âµsd , and that productivity within each sector across
eso . Given trade
origins is distributed independent FrÃ©chet with shape Î¸s and scale A
costs Ï„sod , the share of dâ€™s total expenditure on goods in sector s from origin o is
âˆ’Î¸s
Ï„sod AWsoo
=P
âˆ’Î¸s Âµsd ,

Wo0
N
o0 =1 Ï„so0 d A 0


Ï€sod

(33)

so

e1/Î¸
where Aso â‰¡ A
so . Due to the Cobb-Douglas assumption, sectoral expenditure
shares are exogenous.
By assuming that productivity is correlated within each sector, we can generate a
similar demand system, but with endogenous sectoral shares. Suppose that productivity Asod (v) for good v in sector s is a random vector drawn from a multivariate Î¸-FrÃ©chet distribution with scale parameter Tsod and cross-nested CES (CNCES)
correlation function,

F (X1 , . . . , XN ) =

S
N
X
X
s=1

!1âˆ’Ïs
s)
x1/(1âˆ’Ï
so

,

(34)

o=1

with Xo â‰¡ (x1o , . . . , xSo ). The parameter Ïs measures the degree of correlation
across origin countries in each sector s.
Expenditure shares at the sector level constitute a gravity system given by

Ï€sod =

Psod
Psd

âˆ’Î¸/(1âˆ’Ïs ) 

Psd
Pd

âˆ’Î¸
,

P
1/Î¸
âˆ’Î¸/(1âˆ’Ïs ) âˆ’ 1âˆ’Ïs
where Psod â‰¡ Î³Tsod Wo , Psd â‰¡ ( N
) Î¸ , and Pd is the aggregate price
o=1 Psod
P âˆ’Î¸ âˆ’1/Î¸
index in country d, Pd =
.
s Psd
This demand system matches (33) for Î¸/(1 âˆ’ Ïs ) = Î¸s , Psod /Î³ = Ï„sod Wo /Aso , and
Âµsd = (Psd /Pd )âˆ’Î¸ . Sectoral shares now depend on real sectoral prices with elasticity
of substitution Î¸. As the parameter Î¸ goes to zero, this sectoral CNCES model
system with very low elasticities of substitution. They estimate gains from trade that are much
larger than ACR.

27

converges to match the Cobb-Douglas case in Caliendo and Parro (2015).18,19
We can get an equivalent macro model by applying Proposition 4. Aggregate productivity Aod (v) is distributed multivariate Î¸-FrÃ©chet with scale parameters given
P
by Tod = Ss=1 Tsod and the following CNCES correlation function, as derived in
(12),
Gd (x1 , Â· Â· Â· , xN ) =

S
N
X
X
s=1

!1âˆ’Ïs
(Ï‰sod xo )1/(1âˆ’Ïs )

(35)

,

o=1

with Ï‰sod = Tsod /Tod .20 The inner sum indicates that latent sectors induce correlation across origins. The parameter Ï‰sod measures the extent to which sector s
matters for trade flows from o to dâ€”i.e., it reflects sectoral trade costs and comparative advantage.
In turn, aggregate expenditure shares constitute a GEV factor demand system, as
in (21),

Ï€od â‰¡

X

Ï€sod =

Ï‰sod Tod Woâˆ’Î¸

X

s

s

P

o0

1
 1âˆ’Ï

Ï‰so0 d To0 d Woâˆ’Î¸
0

s

hP

Ï‰so0 d To0 d Woâˆ’Î¸
0

o0

1
 1âˆ’Ï
P hP
s

s0

o0

1 i1âˆ’Ïs
 1âˆ’Ï

Ï‰s0 o0 d To0 d Woâˆ’Î¸
0

s

 1âˆ’Ï1 i1âˆ’Ïs0 .
s0

(36)
The aggregate model with a CNCES correlation function has the same aggregate
implications as the multi-sector model with correlation across origin countries
within each sector.

6.2

Multinational Production

Assume that productivity depends on the home country j of a firm. The micro correlation function is CNCES as in (34), and the implied macro correlation function
is as in (35) with s replaced by j for both functions. The parameter Ïj measures
correlation across production locations for firms with home country j.
18

The Cobb-Douglas restriction, however, entails that key cross-price elasticities characterizing
the macro demand system are not identified from between-sector variation, as pointed out by Adao
et al. (2017). With CNCES, both Î¸ and Ïs can be identified from between- and within-sector variation, respectively.
19
French (2016) uses CES expenditure shares across sectors, but he restricts the elasticities of
substitution for each sector to be the same, Ïs = Ï.
20
As the number of underlying micro factorsâ€”the M dimension in (12) and the S dimension
hereâ€”gets large, the CNCES specification can arbitrarily approximate the mixed-CES factor demand system used in Adao et al. (2017). In this way, their empirical application can be interpreted
as arising from some latent disaggregate Ricardian model.

28

The expenditure share on goods produced in o for d by firms from j is

Ï€jod =

Pjod
Pjd

âˆ’Î¸/(1âˆ’Ïj ) 
âˆ’Î¸
Pjd
Î³
,
Pd

P
âˆ’Î¸/(1âˆ’Ïj ) âˆ’ 1âˆ’Ïj
âˆ’1/Î¸
where Pjod â‰¡ Tjod Wo , and Pjd â‰¡ ( N
P
) Î¸ . The expenditure share
o=1 jod
on goods produced in o for d follows (36) with j replacing s.
This factor demand system matches the one in Ramondo and RodrÃ­guez-Clare
1/Î¸

(2013) for Ïj = Ï and Tjod = hjo Aj . That is, if we assume that the distribution
of productivity Aod (v) has a correlation function given by (35) with j replacing s,
our Ricardian trade model matches, at the bilateral level, a Ricardian trade model
with multinational production.

6.3

Multiple Regions

Assume that each country o is composed of multiple regions, given by the set Ro .
Denote productivity in region r by Arod (v). Productivity across regions and countries is multivariate Î¸-FrÃ©chet with scale parameter Trod and correlation function
!1âˆ’Ïo
F d (X1 , . . . , XN ) =

X

X

o

râˆˆRo

o)
x1/(1âˆ’Ï
ro

(37)

,

with Xo â‰¡ (x1o , . . . , xRo o ). The expression in (37) indicates that productivity draws
are independent across countries and correlated within a country, across regions,
with the degree of correlation given by the parameter Ïo .
Workers are mobile across regions within a country and the country wage is Wo .
âˆ’1/Î¸

For import price index Prod = Î³Trod Wo , the trade share from region r âˆˆ Ro into
country d is

Ï€rod =

Prod
Pod

Î¸
âˆ’ 1âˆ’Ï

o

âˆ’Î¸
Pod
P
âˆ’Î¸
o0 P o0 d

with Pod =

X
r0 âˆˆR

âˆ’ Î¸
Pr0 od1âˆ’Ïo

o
!âˆ’ 1âˆ’Ï
Î¸

.

(38)

o

The first fraction on the right-hand side of (38) is the probability of importing from
region r in country o conditional on importing from some region in country o,
while the second fraction is the probability of importing from country o into d.
P
1âˆ’Ïo
1/(1âˆ’Ïo )
Aggregate productivity is multivariate Î¸-FrÃ©chet with scale Tod =
,
râˆˆRo Trod
29

and with an additive correlation function. As a result, the factor demand system is
CES,
Ï€od =

Tod Woâˆ’Î¸
Ï€rod = P
.
âˆ’Î¸
0 To 0 d W o 0
o
râˆˆRo
X

By assuming that Ïo = 0, for all o = 1, . . . , N , this case matches the one in Ramondo
et al. (2016) .

6.4

Global Value Chains

We now show that the model of global value chains in AntrÃ s and de Gortari (2017)
is equivalent to a model without global value chains, but in which productivity follows a multivariate FrÃ©chet distribution with an appropriately chosen correlation
function.
Assume that production is carried out in K stages, k = 1, . . . , K, where k = K is the
final stage of production (e.g., assembly), takes the Cobb-Douglas form, and labor
is the only factor of production. Let ` = [`(1), . . . , `(K)] index a path of locations
across production stages.
The unit cost of the input bundle used for goods produced following the production path ` is given by

c` (W) = W`(K)

kâˆ’1
Y
k=1

with Î±k > 0 and

PKâˆ’1
k=1

W`(k)
W`(K)

Î±` (k)
,

Î±k < 1. The unit cost of good v is c` (W)/A`d (v). The variable

A`d (v) denotes the marginal product of the input bundle when good v is produced
along ` and delivered to d. This variable is distributed Î¸-FrÃ©chet i.i.d. across ` with
scale T`d . The likelihood of a particular production path ` destined to country d is
given by
T`d c` (W)âˆ’Î¸
.
âˆ’Î¸
`0 T`0 d c`0 (W)

Ï€`d = P

(39)

This factor
demand share matches the one in AntrÃ s and de Gortari (2017) for T`d =
P
1âˆ’ Kâˆ’1
Î± Q
âˆ’Î¸
âˆ’Î¸Î±k Î±k
Ï„`(K),d T`(K) k=1 k Kâˆ’1
T`(k) where Ï„ij is an iceberg cost of transportk=1 (Ï„`(k),`(k+1) )
ing goods from country i to country j, and Ti is a productivity index for country
i. Aggregate trade shares from country o to d are obtained by summing Ï€`d over
production paths with `(K) = oâ€”i.e., with last production stage in country o.

30

A macro model where productivity is multivariate Î¸-FrÃ©chet with scale T`d and
correlation function given by
X

d

G (x1 , Â· Â· Â· , xN ) =

x`(K)

`

Kâˆ’1
Y
k=1

x`(k)
x`(K)

Î±` (k)
,

implies a factor demand system equivalent to the the one from the model with
global value chains.

6.5

Intermediate Inputs

Suppose that each variety is used to produce an aggregate intermediate input. In
turn, firms produce varieties using a Cobb-Douglas production function in labor
and this good. Hence, the unit cost of the input bundle in country o is
co (W) = BWoÎ² Po1âˆ’Î² ,
where 0 < Î² â‰¤ 1 is the share of labor in production, B is a positive constant,
W â‰¡ [W1 , . . . , WN ], and Po is the price level in o. If productivity is independent
FrÃ©chet with scale Ao and given trade costs of Ï„od , expenditure shares are
âˆ’Î¸
Ao Ï„od
co (W)âˆ’Î¸
.
âˆ’Î¸
âˆ’Î¸
o0 Ao0 Ï„o0 d co0 (W)

(40)

Ï€od = P

The price index in country d is defined implicitly by
!âˆ’1/Î¸
Pd = Î³B

X

âˆ’Î¸
(WoÎ² Po1âˆ’Î² )âˆ’Î¸
Ao Ï„od

.

o

It is easy to see that a model without this input-output loop, but with a multivariate
Î¸-FrÃ©chet distribution of productivity with scale Tod â‰¡ (Ao /Ï„od )Î¸/Î² and correlation
functions for each country implicitly defined by the system
d

G (x1 , . . . , xN ) =

N
X

xÎ²o Go (x1 , . . . , xN )1âˆ’Î² ,

o=1

generates the same factor demand system as the model with intermediate inputs.

31

7

Quantitative analysis

This section quantifies the gains from trade when productivity is correlated across
space. Our framework, by allowing for origin-destination specific correlation in
productivity, enables us to introduce bilateral heterogeneity into the estimation
of trade elasticities. These substitution patterns are obtained because we do not
impose iceberg trade costs; rather, we allow for the distribution of productivity to
depend on the destination market where goods get delivered.
We consider a sectoral extension of our model. Based exclusively on supply factorsâ€”
i.e., productivityâ€”this sectoral model allows for bilateral heterogeneity in trade
elasticities.21
The choice of the multi-sector Ricardian model of trade not only allows us to assess
the importance of correlation in the calculation of the gains from trade and other
counterfactuals, but it also allows us to highlight the importance of using disaggregate data to estimate elasticities that are key for macro counterfactuals. Finally,
we choose this model because it includes two benchmark models used throughout
the existing trade literature as special cases: the CES sectoral model, and the crossnested CES (CNCES) sectoral model. These cases arise when bilateral factors do
not influence correlation.

7.1

Specification

Denote each sector by s = 1, . . . , S. We assume that sector-level productivity is
multivariate Î¸-FrÃ©chet with scale Tsod and correlation function given by
d

F (X1 , Â· Â· Â· , XN ) =

S
X

H sd (xs1 , Â· Â· Â· , xsN ).

(41)

s=1
21

As we show in Online Appendix O.2.1, one can allow for complementarity or substitutability across sectors which comes from preferences. In fact, the sectoral model we present below is isomorphic to a model in which preferences across sectors are CES, u(C1d , . . . , CSd ) =
+1
P
 

S
+1
, with Csd an aggregate of sectoral products, and with the parameter  > âˆ’1
C
s=1 sd
the expenditure elasticity of substitution between sectors. Sectoral goods are substitutes as long as
 > 0 so that  takes exactly the role of Î¸ below. Sectoral goods are complements if  < 0, a possibility only allowed if the model has a preferences interpretation. Our estimates suggest substitution,
not complementarity, across sectorsâ€”that is, our estimates of the parameter Î¸ are positive.

32

In turn, the function H sd is a correlation function capturing correlation within sector s and destination market d, across origin countries. Following Hanoch (1975)
and Sato (1977), this function is defined implicitly by
1=

N 
X
o=1

xso
sd
H (xs1 , . . . , xsN )

 1âˆ’Ï1

sod

(42)

.

The parameter Ïsod measures correlation across origins within sector s and destination d. The resulting sectoral expenditure shares are iso-elastic,
Ïƒsod
Ï€sod = P
N

o0 =1

where Ïƒsod â‰¡

Î¸
1âˆ’Ïsod



Psod
Psd

Ïƒso0 d



âˆ’Ïƒsod

Pso0 d
Psd

(43)

âˆ’Ïƒso0 d Âµsd ,

is the expenditure elasticity of substitution induced by bilateral

correlation, Âµsd is the share of expenditure by country d on sector s goods, Âµsd =
(Psd /Pd )âˆ’Î¸ , and the sectoral price index Psd is defined implicitly as
1=

X  Psod âˆ’Ïƒsod
Psd

o

(44)

,

âˆ’1/Î¸

with Psod â‰¡ Î³Tsod Wo . When Ïsod = 0, so that productivity is independent across
sectors and origins, we get the CES sectoral model since Ïƒsod = Î¸. In this case,
there is a single trade elasticity common to all trade flows. When Ïsod = Ïs , for all
o, d, we get the sectoral CNCES model without bilateral spatial correlation (as in
Section 6).
Next, we compute correlation-adjusted sectoral expenditure shares and the gains
from trade in closed form. As we explain in Section 5, because correlation-adjusted
shares are sufficient statistics for real sectoral import prices, we can calculate the
correlation correction by inverting the demand system. We first solve for withinsector relative prices. Dividing (43) by Ïƒsod , summing over origins, and using (44)
gives (Psod /Psd )âˆ’Ïƒsod . Correlation-adjusted expenditure is related to to real sectoral
import prices, so we can use sectoral shares, Âµsd , to get
Ï€sod /Ïƒsod

âˆ—
Ï€sod
=

PN

o0 =1

|

Ï€so0 d /Ïƒso0 d
{z

(Psod /Psd )âˆ’Î¸

33

!Î¸/Ïƒsod
Ã—
}

Âµsd
|{z}

(Psd /Pd )âˆ’Î¸

.

(45)

Applying our aggregation result, we can use (27) and (32) to compute the gains
âˆ—
from trade. Due to independence across sectors, the function F od is additive, Ï€od
=
P âˆ—
s Ï€sod , and
!âˆ’1/Î¸
X
âˆ—
GTd =
Ï€sod
.
(46)
s

Using sectoral expenditure data, we can compute the gains from autarky once we
have estimates of Ïƒsod and Î¸.

7.2

Estimation

We estimate this multi-sector model using two sequential gravity regressions. The
first step regression uses variation in trade flows and tariffs across origin countries
within each sector to identify geographic correlation in productivity. The second
step regression uses variation across sectors and destination markets to identify Î¸.
Letting t index years, we impose additional assumptions on the structure of trade
costs and spatial correlation patterns.
First, trade costs depend on gravity covariates, Geood , and on tariffs, tsodt ,
ln Ï„sodt = Î´s0 Geood + ln(1 + tsodt ) + Îµ1sdt + Îµ2sodt .
We include in Geood variables such as distance and time differences between trading partners, and dummies indicating whether the two countries share a border,
language, and legal origins. We further allow for sector specific coefficients, Î´s .
The variable Îµ1sdt captures unobserved sector-destination-year components of trade
costs, while Îµ2sodt captures additional unobserved components of trade costs across
origin countries.
Second, we assume that the sectoral elasticity is additively separable into a sector
effect and a spatial effect which we proxy by a non-linear function of geographic
distance between country pairs,
Ïƒsod = ÏƒÌ„s + ÏƒÌƒ1 Distod + ÏƒÌƒ2 Dist2od .

(47)

This assumption is motivated by literature that documents how technology diffusion follows a spatial pattern.22
22

Keller (2002) estimates that a 1,200-kilometer increase in distance leads to a 50 percent drop in

34

Using (43), we get our first-step within-sector gravity equation,
ln Ï€sodt = Ssot + Dsdt + Bsod âˆ’ ÏƒÌ„s ln(1 + tsodt ) + (Î±sot + Î²sdt âˆ’ ln(1 + tsodt )) (ÏƒÌƒ1 Distod + ÏƒÌƒ2 Dist2od ) + usodt ,
(48)

where Ssot â‰¡ ÏƒÌ„s Î±sot , Dsdt â‰¡ ÏƒÌ„s Î²sdt âˆ’ ÏƒÌ„s Îµ1sdt âˆ’ ln

P

o0

Ïƒso0 d (Pso0 dt /Psdt )âˆ’Ïƒso0 d , Bsod â‰¡

ln Ïƒsod âˆ’ Ïƒsod Î´s0 Geood , Î±sot â‰¡ ln Wot /Asot , Î²sdt â‰¡ ln Psdt /Î³, and usodt = âˆ’Ïƒsod Îµ2sodt .
The coefficients from the interaction of distance and distance squared with tariffs
allow us to estimate distance-dependent elasticities of substitution across origindestination pairs. Identification follows from including sector-origin-time, sectordestination-time, and sector-origin-destination effects, as well as both sector-origintime and sector-destination-time specific coefficients for bilateral distance. The exclusion restriction for identification is that variation in tariffs across origin countries is exogenous conditional on these covariates.
To estimate the between-sector elasticity, we use a second step regression that relies
on variation across sectors and a control for inferred within-sector relative prices
from the first step regression. This second step regression comes from the condition for destination dâ€™s expenditure on sector-s goods, Âµsd = (Psd /Pd )âˆ’Î¸ . First, note
that
ln

Psd
Psd
Psod
Psod
Wo
= ln
+ ln
= âˆ’ ln
+ ln
âˆ’ ln Pd + ln Ï„sod .
Pd
Psod
Pd
Psd
Aso

To construct an estimating equation from this result, we need estimates of Psod /Psd
from the first step regression. Specifically, given estimates of Ïƒsod , we can combine
(48) with the definition of the sectoral price index in (44) to calculate
Pd
sodt
=
Psdt

Ï€sodt /ÏƒÌ‚sod
PN

o0 =1

!âˆ’ ÏƒÌ‚ 1

Ï€so0 dt /ÏƒÌ‚so0 d

sod

,

where ÏƒÌ‚sod is our estimate for Ïƒsod from the first step.
We estimate the parameter Î¸ from the coefficient on ln(1 + tsodt ) in the following
second step regression:
\
ln Âµsdt = asot + bdt + Î¸ ln (Psodt
/Psdt ) âˆ’ Î¸Î´s0 Geood âˆ’ Î¸ ln(1 + tsodt ) + vsodt ,

(49)

technology diffusion. Similarly, Bottazzi and Peri (2003) find a strong geographic decay in technology diffusion between European regions. Comin et al. (2013) document that the lower the spatial
distance to another countryâ€™s technology, the higher the rate of adoption. Relatedly, Keller and
Yeaple (2013) link the gravity patterns observed in flows of firms across countries (Foreign Direct
Investment) to multinational firms transferring knowledge from their parent firm to their affiliates
abroadâ€”with this transfer being easier to nearby locations.

35

where asot â‰¡ Î¸ ln(Asot /Wot ), bdt â‰¡ Î¸ ln Pdt , and vsodt â‰¡ âˆ’Î¸(Îµ1sdt + Îµ2sodt ). Identification
in this regression comes from controlling for within-sector relative prices using our
first step estimates. The identification assumption is that the unobserved component of trade costs is orthogonal to tariffs conditional on the other covariates.
We estimate (48) and (49) by Ordinary Least Squares (OLS). We use sectoral tariff
data constructed by aggregating underlying 4 digit SITC tariff data, and sectoral
trade flow data from the World Input-Output Database (WIOD). Appendix H describes the data construction and sample restrictions in detail.
We consider three models. First, we estimate the CES model where productivity is
independent across sectors and origin countries (Ïsod = 0). Because Ïƒsod = Î¸, estimation of the first step gives us an estimate of Î¸. Second, we estimate the CNCES
model where correlation is not bilateral, but, rather, symmetric across origin and
destination countries within each sectorâ€”that is, Ïsod is common across o and d
within s, so that Ïƒsod = ÏƒÌ„s . Finally, we allow for bilateral spatial correlation and estimate our full model with Ïƒsod as in (47). Note that the CES model is nested within
the CNCES model and the CNCES model is nested within the spatial model.
Appendix Figure I.1 presents OLS estimates of the elasticity of substitution, Ïƒsod ,
as a function of geographical distance, while allowing for sectoral heterogeneity.
The spatial pattern that emerges is clear: Substitutability decreases with distance,
indicating that productivity is less correlated between countries that are further
away from each other.23
Appendix Table I.1 presents our OLS estimates of Î¸. Column 1 shows an estimate
of Î¸ = 5.523 from the CES model based on our first step regression; this value is
in line with values in the literature (see Simonovska and Waugh, 2013). Column
2 shows that Î¸ = 0.607 after we account for symmetric correlation across space
within each sector (CNCES). Finally, column 3 presents the estimate of Î¸ = 0.489
from our second step regression when we allow for distance-dependent sectoral
elasticities.
We next use the estimates of the correlation function and the parameter Î¸ to perform various counterfactual exercises.
23

Appendix Figure I.2 shows estimates from our first step regression for the within-sector elasticity of substitution in the CNCES model, Ïƒsod = ÏƒÌ„s .

36

Figure 1: Gains from Trade and Self-Trade Share, 2007.
.6

HUN
SVK

.4

MEX CAN
MLT
MLT
BEL

LUX
LUX

.2

BEL

ESTAUT CZE SWE
IRL
DEU
HUN
LTU
CYP
LVA
GBR
FRA
DNK
FIN
SVKSVNNLD
BGR
POL
PRT
GRC
ESTAUT
CYP
LVA CZE IRL
SVN
LTU DNK
NLD
BGR SWEMEX
GBR
CAN
DEU
POL
PRT
GRC
FRA
FIN

RUS
ESP

USA
AUS
IND
IDN

ITA
TUR

KOR

CHN
BRA
JPN

ESP

0

ITA AUS
TUR
USARUS
KOR
IND
IDNJPN
CHN
BRA

.2

.4

.6
Selfâˆ’Trade Share

.8

1

Notes: Black data: GTdspatial . Blue data: GTdCN CES . Red line: GTdCES .

7.3

The Gains from Trade

Figure 1 shows the gains from trade calculated using the model with no correlation (CES), with within-sector symmetric correlation (cross-nested CES, CNCES),
and with bilateral spatial correlation, respectively.24 The figure shows not only
that differences in (log) levels are large across the three models for all countries,
but, also and more importantly, differences are large across countries with similar
self-trade shares. For instance, Mexico, Germany, and Poland have a similar selftrade share of around 60 percent. However, once we account for either symmetric
spatial correlation or bilateral spatial correlation, their gains are significantly different. In contrast, the CES model would predict equal gains from trade for these
three countries. In turn, the CNCES model delivers gains from trade that are more
heterogeneous than the ones from CES, but much less heterogenous than the ones
coming from the spatial model.
Perhaps not surprisingly, Figure 2 shows that countries that are on average further away from their trading partners have higher gains from trade in the spatial model, while the CNCES modelâ€”with sectoral elasticities that are constant
over spaceâ€”fails to do that. Through the lens of our spatial model, countries fur24

Results for years prior to 2007 are relegated to the Online Appendix.

37

Figure 2: Gains from Trade and Distance, 2007. Percent differences from CES.
(a) Spatial
.6
.5

.5

.6

(b) CNCES

.2
.1

.4
.3

USA
AUS

.2

.4
.3

RUS
SWE
DEU
IRL
CZE
GBR
FRA EST
FIN
ESP
LTU
LVADNK POL
PRT
BGR
IND MLTCYP
NLD
GRC BEL
ITA
TUR CHN IDN
KOR
SVN
BRA
JPN
AUT

CANMEX

HUN
MLT
SVK

.1

HUN
SVK

IRL
AUT CZE
EST
LVADNK
GBR
SWE
RUS
POL
FIN BELBGR
PFRA
RTGRC
DEU
ESP
KOR
LUX
SVN LTU
CHN IDNIND
NLD
TUR
ITA
JPN

0

CYP
BRA

CANMEX
AUS
USA

âˆ’.1

âˆ’.1

0

LUX

500

1000
2000
Tradeâˆ’Weighted Average Distance (Kilometers)

4000

500

1000
2000
Tradeâˆ’Weighted Average Distance (Kilometers)

4000

Notes: (2a) Black data: 100 Ã— (GTdCN CES âˆ’ GTdCES )/GTdCES . (2b): Black data: 100 Ã— (GTdspatial âˆ’
GTdCES )/GTdCES . Blue line: log-linear fit. Grey band: 95% point-wise confidence interval.

ther away from each other have more dissimilar technologiesâ€”i.e., lower sectoral
elasticitiesâ€”and, hence, higher gains from trade. This result captures the idea that
more dissimilar countries have higher gains from trade, as proposed by Ricardo.

7.4

NAFTA, the Rise of Chinese Imports, and U.S. Protectionism

Next, we consider the implications of our spatial model regarding various counterfactual scenarios, and compare them with the implications from the CNCES model.
We use the procedure outlined in Section 4.
We first consider a scenario in which the United States increases trade costs with
Mexico and Canada simultaneously by x percent, with x âˆˆ [5, 50]. Figure 3 shows
the implications for real wages for the spatial model and the CNCES model. The
difference between the two models shows the effect of accounting for bilateral correlation in addition to within-sector correlation. Differences in the predicted real
wages can be large, particularly for large changes in trade costs.
Why does correlation matter, and even more for large changes in trade costs? The
gains from trade come from two potentially offsetting effects: a price effect and
a wage effect. The price effect is direct. Increasing trade costs on Mexican goods
increases prices for U.S. consumers. The size of this effect is just the elasticity of
the price in the United States to the price of imports from Mexico, which equals

38

the expenditure share,
1

âˆ’Î¸
âˆ’Î¸
âˆ’Î¸
âˆ’Î¸
âˆ‚ ln GU SA (P1,U
PM
âˆ‚ ln PU SA
SA , . . . , PN,U SA )
EX,U SA GM EX,U SA
=
=
= Ï€M EX,U SA .
âˆ‚ ln Ï„M EX,U SA
âˆ‚ ln PM EX,U SA
PUâˆ’Î¸SA

In contrast, the wage effect is indirect and operates through general equilibrium
effects. The market clearing condition for the United States is
WU SA LU SA =

N
âˆ’Î¸
X
PUâˆ’Î¸SA,d GdU SA (P1d
, . . . , PNâˆ’Î¸d )
d=1

âˆ’Î¸
Gd (P1d
, . . . , PNâˆ’Î¸d )

Xd .

If the change in trade costs with Mexico induces U.S. consumers to substitute expenditure away from Mexican goods and towards U.S. goods, the right-hand side
of this conditionâ€”that captures labor demandâ€”would increase and U.S. wages
would increase. How rapidly expenditure shifts away from Mexican goods and
towards U.S. goods depends on the correlation in technology. If the United States
and Mexico were very close neighbors (i.e., high correlation), then U.S. and Mexican goods would be substitutable and labor demand in the United States would
be sensitive to trade costs for imports from Mexico. In this case, the wage effect
would be large and would offset the losses coming from increasing prices in the
United States. In contrast, if trade between most parts of Mexico and the United
States occurs over long distances, accounting for spatial correlation would reduce
the substitutability of their goods. As a result, the offsetting wage effect would be
smaller in the spatial model. As we see in Figure 3, accounting for spatial correlation in technology leads to an increase in the losses from increasing U.S. trade costs
with NAFTA partners. Notice, also, that the gap between the models depends on
the size of the increase in trade costs. For small changes in trade costs, the gap
is small because general equilibrium effects on wages are small, while the direct
price effectâ€”with an elasticity equal to the expenditure shareâ€”does not change
between the CNCES and spatial models.
Second, we consider the implications of the rise of Chinese manufacturing imports
for the real wage in the United States. To proceed, we compute the change in the
U.S. real wage in each year between the observed outcome (i.e., the real wage implied by each model given the data) and a scenario in which we fix Chinaâ€™s trade
costs at the level of 2003 for the sector "Machinery, Equipment, and Manufacturing
n.e.c.". We choose this sector because expenditure by the United States on manu39

Figure 3: Effects of NAFTA Reversal on Real Wages.
(a) Cross-nested CES (CNCES) Model
0
âˆ’1
Percent Change in Real Wage
âˆ’6
âˆ’5
âˆ’4
âˆ’3
âˆ’2

Percent Change in Real Wage
âˆ’6
âˆ’5
âˆ’4
âˆ’3
âˆ’2

âˆ’1

0

(b) Spatial Model

0

10

20
30
Percent Increase In Trade Costs

âˆ’7

United States
Mexico
Canada

âˆ’8

âˆ’8

âˆ’7

United States
Mexico
Canada
40

50

0

10

20
30
Percent Increase In Trade Costs

40

50

Notes: Effects of an unilateral increase in trade costs for goods from Canada and Mexico into the United
States.

facturing goods from China increased threefold between 2003 and 2007 (Appendix
Figure I.3). Additionally, this sectorâ€™s implied trade costs decrease sharply in the
spatial model, but they are relatively stable for the CNCES model, as shown in Figure 4a. For the remaining sectors, the implied trade costs between the two models
are similar (not shown).25 Figure 4b shows the difference in real wages between
the actual and counterfactual scenario: The sharp decrease in trade costs implied
by the spatial model from 2003 on translates into large increases in the U.S. real
wage. The CNCES model fails to capture both the collapse in trade costs within
this sector, and, as a consequence, suggests lower gains for the United States from
the rise of manufacturing imports from China.
Finally, we consider a series of trade protection exercises where the United States
unilaterally increases trade costs by five percent, one trading partner at the time.
We compute the counterfactual change in real wages for both the case of the spatial
model where we account for bilateral correlation in technology and the case of the
CNCES model. The presence of bilateral correlation changes the rankings of the
countries that provoke the largest change in U.S. real wages. While the CNCES
model implies that real wages in the United States would decrease the most with
increases in trade costs from Canada, the spatial model predicts that China would
âˆ—
âˆ—
Trade costs are calculated using the ratio (Ï€sodt
/Ï€soot
)âˆ’1/Î¸ = Ï„sodt Pot /Pdt , for each s and t.
Since we can only uncover within-destination relative prices from our expenditure data, we use
GDP deflators from the Penn World Tables (9.0) to adjust this quantity by country price levels and
recover sectoral trade costs.
25

40

Figure 4: The Rise of Chinese Manufacturing Imports.
(a) Implied trade costs Ï„CHN,U SA , S10

Spatial
CNCES

Percent Change in Real Wage
1
2
3
4

Log Inferred Trade Costs
5
10
15

5

20

(b) Implied change in U.S. real wage

0

0

Spatial
CNCES

1995

1997

1999

2001
Year

2003

2005

2007

2003

2004

2005
Year

2006

2007

Notes: S10 refers to the sector "Machinery, Equipment, and Manufacturing n.e.c.". (4a) shows trade costs
in S10, implied by the spatial and CNCES model, respectivelyâ€”dash lines show the counterfactual levels
of trade costs. (4b) shows the percent changes in the U.S. real wage, implied by the spatial and CNCES
model, respectively.

have the largest impact. Another example of a ranking reversal between the two
models occurs with Korea and Great Britain: While the spatial model puts Korea
in seventh place and Great Britain in eighth place, the CNCES model predicts the
opposite. The intuition for these unilateral protectionism exercises is similar to the
other counterfactuals: the direct price effect is measured by observed expenditure
shares, which are constant across models, while the indirect wage effect depends
on substitutability of goods across trading partners and, therefore, depends on
patterns of spatial correlation.
All these counterfactual exercises illustrate that the welfare implications of changes
in trade costs can change substantially once we account for spatial correlation in
productivity. These results reflect Ricardoâ€™s insight that differences in technological similarity across trade partners matter for the gains from trade.

8

Conclusions

This paper is motivated by the old Ricardian idea that a country gains from trading
with those countries who are technologically dissimilar. We develop a Ricardian
theory of trade that allows for arbitrary patterns of correlation in technology between countries. We start from technology primitives that generate multivariate
41

FrÃ©chet productivity with a general correlation structure. Even so, we retain all the
tractability of EK-type tools. Importantly, our structure generates the class of GEV
factor demand systems and, as such, approximates any Ricardian modelâ€”not only
the one with FrÃ©chet-distributed productivity.
The gains from trade coming from a GEV factor demand system can be written as
a simple correction to self-trade shares. Moreover, the theory, by relating macro
substitutability patterns to underlying micro structures, provides guidance on incorporating standard micro estimates into macro counterfactual exercises.
Our quantitative application to a multi-sector model of trade reveals that accounting for correlation matters: Gains are much more heterogeneous across countries
than the case of independent productivity. These results suggest that our framework has the potential to change quantitative conclusions in any literature applying FrÃ©chet tools.

42

References
Adao, R., A. Costinot, and D. Donaldson (2017). Nonparametric counterfactual
predictions in neoclassical models of international trade. The American Economic
Review 107(3), 633â€“689.
Ahlfeldt, G., S. Redding, D. Sturm, and N. Wolf (2015). The economics of density:
Evidence from the berlin wall. Econometrica 83(6), 2127â€“2189.
Alvarez, F. and R. E. Lucas (2007). General equilibrium analysis of the eatonkortum model of international trade. Journal of Monetary Economics 54(6), 1726â€“
1768.
Anderson, J. E. (1979). A theoretical foundation for the gravity equation. The
American Economic Review 69(1), 106â€“116.
AntrÃ s, P. and A. de Gortari (2017). On the geography of global value chains.
Mimeo, Harvard University.
Arkolakis, C., A. Costinot, D. Donaldson, and A. Rodriguez-Clare (2017). The
elusive pro-competitive effects of trade. Review of Economic Studies, forthcoming.
Arkolakis, C., A. Costinot, and A. RodrÃ­guez-clare (2012). New trade models, same
old gains? The American Economic Review, 94â€“130.
Bas, M., T. Mayer, and M. Thoenig (2017). From micro to macro: Demand, supply,
and heterogeneity in the trade elasticity. Journal of International Economics 108,
1â€“21.
Berry, S., A. Gandhi, and P. Haile (2013). Connected substitutes and invertibility of
demand. Econometrica 81(5), 2087â€“2111.
Bertoletti, P., F. Etro, and I. Simonovska (2017). International trade with indirect
additivity. American Economic Journal: Microeconomics, forthcoming.
Bottazzi, L. and G. Peri (2003). Innovation, demand, and knowledge spillovers:
Evidence from european patent data. European Economic Review 47, 687â€“710.
Brooks, W. and P. Pujolas (2017). Non linear gravity. Mimeo, Notre-Dame University.
Bryan, G. and M. Morten (2018). The aggregate productivity effects of internal
migration: Evidence from indonesia. Journal of Political Economy, forthcoming.
Buera, F. J. and E. Oberfield (2016). The global diffusion of ideas. NBER Working
Paper Series (21844).
Caliendo, L., F. P. annd Esteban Rossi-Hansberg, and P.-D. Sarte (2017). The impact
of regional and sectoral productivity changes on the u.s. economy. Review of
Economic Studies, forthcoming.

43

Caliendo, L. and F. Parro (2015). Estimates of the trade and welfare effects of nafta.
The Review of Economic Studies 82(1), 1â€“44.
Caron, J., T. Fally, and J. Markusen (2014). International trade puzzles: a solution
linking production factors and demand. The Quarterly Journal of Economics 129(3),
1501â€“1552.
Comin, D., M. Dmitriev, and E. Rossi-Hansberg (2013). The spatial diffusion of
technology. Unpublished.
Costinot, A., D. Donaldson, and I. Komunjer (2012). What goods do countries
trade? a quantitative exploration of ricardoâ€™s ideas. Review of Economic Studies 79,
581â€“608.
Costinot, A. and A. RodrÃ¬guez-Clare (2014). Trade theory with numbers: Quantifying the consequences of globalization. Technical Report 4.
Dagsvik, J. K. (1995). How large is the class of generalized extreme value random
utility models? Journal of Mathematical Psychology 39(1), 90â€“98.
De Haan, L. (1984). A spectral representation for max-stable processes. The Annals
of Probability 12(4), 1194â€“1204.
DeLoecker, J., P. Goldberg, A. Khandelwal, and N. Pavcnik (2016). Prices, markups
and trade reform. Econometrica 84(2), 445Ã510.
Dornbusch, R., S. Fisher, and P. Samuelson (1977). Comparative advantage, trade
and payments in a ricardian model with a continuum of goods. American Economic Review 67, 823â€“839.
Eaton, J. and S. Kortum (1999). International technology diffusion: Theory and
measurement. International Economic Review 40(3), 537â€“570.
Eaton, J. and S. Kortum (2001). Technology, trade, and growth: A unified framework. European Economic Review 45, 742â€“755.
Eaton, J. and S. Kortum (2002). Technology, geography, and trade. Econometrica,
1741â€“1779.
Eaton, J. and S. Kortum (2010). Technology in the global economy: A framework
for quantitative analysis. Unpublished manuscript.
Eaton, J. and S. Kortum (2012). Putting ricardo to work. Journal of Economic Perspectives 26(2), 65â€“90.
Fajgelbaum, P. and S. Redding (2014). External integration, structural transformation and economic development: Evidence from argentina 1870-1914. NBER
Working Paper 20217.
Fally, T. and J. Sayre (2018). Commodity trade matters. Mimeo UC Berkeley.

44

Feenstra, R. C., P. Luck, M. Obstfeld, and K. N. Russ (2017). In search of the armington elasticity. The Review of Economics and Statistics 0(0), null.
Feenstra, R. C. and D. E. Weinstein (2017). Globalization, markups, and the U.S.
price level. Journal of Political Economy 125(4), 1040â€“1074.
Fosgerau, M., D. McFadden, and M. Bierlaire (2013). Choice probability generating
functions. Journal of Choice Modeling 8, 1â€“18.
French, S. (2016). The composition of trade flows and the aggregate effects of trade
barriers. Journal of International Economics 98, 114â€“137.
Hanoch, G. (1975). Production and demand models with direct or indirect implicit
additivity. Econometrica: Journal of the Econometric Society, 395â€“419.
Hsieh, C.-T., E. Hurst, C. I. Jones, and P. J. Klenow (2013). The allocation of talent and u.s. economic growth. Technical report, National Bureau of Economic
Research.
Keller, W. (2002). Geographic localization of international technology diffusion.
American Economic Review 92, 120â€“42.
Keller, W. and S. R. Yeaple (2013). The gravity of knowledge. American Economic
Review 103(4), 1414.
Kortum, S. (1997). Research, patenting, and technological change. Econometrica 65(6).
Krugman, P. (1980). Scale economies, product differentiation, and the pattern of
trade. The American Economic Review 70(5), 950â€“959.
Lagakos, D. and M. E. Waugh (2013). Selection, agriculture, and cross-country
productivity differences. The American Economic Review 103(2), 948â€“980.
Lashkari, D. and M. Mestieri (2016). Gains from trade with heterogeneous income
and price elasticities. Mimeo, Harvard University.
Lashkaripour, A. and V. Lugovskyy (2017). Industry-level scale economies: from
micro-estimation to macro-implications. Mimeo, Indiana University.
Levchenko, A. and J. Zhang (2016). The evolution of comparative advantage: Measurement and welfare implications. Journal of Monetary Economics 78, 96â€“111.
McFadden, D. (1978). Modeling the choice of residential location. Transportation
Research Record (673).
Melitz, M. J. (2003). The impact of trade on intra-industry reallocations and aggregate industry productivity. Econometrica 71(6), 1695â€“1725.
Monte, F., S. Redding, and E. Rossi-Hansberg (2015). Commuting, migration and
local employment elasticities. NBER Working Paper 21706.
45

Ossa, R. (2015). Why trade matters after all. Journal of International Economics 97(2),
266â€“277.
Penrose, M. D. (1992). Semi-min-stable processes. The Annals of Probability 20(3),
1450â€“1463.
Ramondo, N. and A. RodrÃ­guez-Clare (2013). Trade, multinational production, and
the gains from openness. Journal of Political Economy 121(2), 273â€“322.
Ramondo, N., A. RodrÃ­guez-Clare, and M. SaborÃ­o-RodrÃ­guez (2016). Trade, domestic frictions, and scale effects. American Economic Review 106(10), 3159â€“84.
Redding, S. (2016). Goods trade, factor mobility and welfare. Journal of International
Economics 101, 148â€“167.
Redding, S. and E. Rossi-Hansberg (2017). Quantitative spatial economics. Annual
Review of Economics 9, 21â€“58.
Redding, S. J. and D. E. Weinstein (2017). Aggregating from micro to macro patterns of trade. Mimeo, Princeton University.
Ricardo, D. (1817). On the Principles of Political Economy and Taxation (1 ed.). John
Murray, London.
Rudin, W. et al. (1964). Principles of mathematical analysis, Volume 3. McGraw-hill
New York.
Sato, R. (1977). Homothetic and non-homothetic CES production functions. The
American Economic Review 67(4), 559â€“569.
Scarf, H. and C. A. Wilson (2005). Uniqueness of equilibrium in the multi-country
ricardo model. in Frontiers in Applied General Equilibrium Modeling, ed. T. J. Kehoe,
T. N. Srinivasan, and J. Whalley, 24â€“44.
Schlather, M. (2002). Models for stationary max-stable random fields. Extremes 5(1),
33â€“44.
Simonovska, I. and M. Waugh (2013). The elasticity of trade: Estimates and evidence. Journal of International Economics 92, 34â€“50.
Smith, A. (1776). An Inquiry into the Nature and Causes of the Wealth of Nations (1
ed.). W. Strahan, London.
Smith, T. E. (1984). A choice probability characterization of generalized extreme
value models. Applied Mathematics and Computation 14(1), 35â€“62.
Wilson, C. A. (1980). On the general structure of ricardian models with a continuum of goods: Applications to growth, tariff theory, and technical change.
Econometrica 48(7), 1675â€“1702.

46

A

Properties of FrÃ©chet Random Variables

Lemma A.1. Let X be distributed FrÃ©chet with location T > 0 and shape Î± > 0. Then
if Î± > 1, E[X] = Î“(1 âˆ’ 1/Î±)T 1/Î± . Also, for any S > 0 and Î² > 0, (S 1/Î± X)Î² is FrÃ©chet
with location ST and shape Î±/Î².
Proof.
Z

âˆž

E[X] =
Z0 âˆž

âˆ‚
z P [X â‰¤ z] dz =
âˆ‚z
ze

=

âˆ’T z âˆ’Î±

Î±T z

âˆ’Î±âˆ’1

0

Z

âˆž

z
0

Z

âˆ‚ âˆ’T zâˆ’Î±
e
dz
âˆ‚z

âˆž

dz =

tâˆ’1/Î± eâˆ’t dtT 1/Î± = Î“(1 âˆ’ 1/Î±)T 1/Î± ,

0

and
P[(S 1/Î± X)Î² â‰¤ z] = P[X â‰¤ S âˆ’1/Î± z 1/Î² ] = eâˆ’T (S

âˆ’1/Î± z 1/Î² )âˆ’Î±

= eâˆ’ST z

âˆ’Î±/Î²

.

Lemma A.2. Let {Xi }i=1,...,N be Î±-FrÃ©chet with scale parameters {Ti }N
i=1 and correlation
function G : RN
+ â†’ R+ . Then, for any Si â‰¥ 0 i = 1, . . . , N and Î² > 0, the random vec1/Î±

tor {(Si

N
Xi ) Î² } N
i=1 is Î±/Î²-FrÃ©chet with location parameters of {Si Ti }i=1 and correlation

function G.
Proof.
1/Î±

P[(Si

1/Î²

Xi )Î² â‰¤ yi , i = 1, . . . , N ] = P[Xi â‰¤ SiÎ± yi , i = 1, . . . , N ]
h
i
âˆ’Î±/Î²
âˆ’Î±/Î²
= exp âˆ’G(T1 S1 y1
, . . . , T N S N xN ) .

Lemma A.3. Let {Xi }i=1,...,N be Î¸-FrÃ©chet with scale parameters {Ti }N
i=1 and correlation
function G : RN
+ â†’ R+ . Then, the random variable maxi=1,...,N Xi is Î¸-FrÃ©chet with
location G(T1 , . . . , TN ). Moreover, let {Ij }M
j=1 be any partition of {1, . . . , N } and define
the random variable {Y1 , . . . , YM } as
Yj = max Xi .
iâˆˆIj

47

Let j : {1, . . . , N } â†’ {1, . . . , M } be the unique mapping such that j = j(i) if and only if
i âˆˆ Ij . Define TÌƒj = G(T1 1{1 âˆˆ Ij }, . . . , TN 1{N âˆˆ Ij }) and Ï‰i =

Ti
1{i
TÌƒj

âˆˆ Ij }. Then,

1. {Y1 , . . . , YM } is Î¸-FrÃ©chet with correlation function H : RM
+ â†’ R+ satisfying
H(z1 , . . . , zM ) = G(Ï‰1 zj(1) , . . . , Ï‰N zj(N ) );
2.
h

P

i

P Yj = max Xi =

iâˆˆIj

i

Ti Gi (T1 , . . . , TN )

G(T1 , . . . , TN )

,

where Gi (x1 , . . . , xN ) â‰¡ âˆ‚G(x1 , . . . , xN )/âˆ‚xi ;
3. For any j = 1, . . . , M , the distribution of Yj conditional on the event Yj = maxi=1,...,N Xi
is identical to the distribution of maxi=1,...,N Xi ,


i
h
âˆ’G(T1 ,...,TN )y âˆ’Î¸
P Yj â‰¤ y | Yj = max Xi = e
= P max Xi â‰¤ y .
i

i=1,...,N

Proof. We first prove part (1). Let {Ij }M
j=1 be a partition of {1, . . . , N } and define
Yj = maxiâˆˆIj Xi . Let the function j : {1, . . . , N } â†’ {1, . . . , M } satisfy i âˆˆ Ij(i) for
all i = 1, . . . , N . Note that there is a unique function satisfying this condition since
{Ij }M
j=1 is a partition of {1, . . . , N }. Then,
P [Yj â‰¤ yj , âˆ€j = 1, . . . , M ] = P [Xi â‰¤ yj , âˆ€i âˆˆ Ij , âˆ€j = 1, . . . , M ]
âˆ’Î¸

âˆ’Î¸

= eâˆ’G(T1 yj(1) ,...,TN yj(N ) ) .
Therefore {Y1 , . . . , YM } is Î¸-FrÃ©chet. Its scale parameters are
lim

yk â†’âˆž,k6=j

âˆ’Î¸
âˆ’Î¸
G(T1 yj(1)
, . . . , TN yj(N
) ) = G(T1 1{1 âˆˆ Ij }, . . . , TN 1{N âˆˆ Ij }) = TÌƒj ,

and its correlation function must then be
G(T1 /TÌƒj(1) zj(1) , . . . , TN /TÌƒj(N ) zj(N ) ) = G(Ï‰1 zj(1) , . . . , Ï‰N zj(N ) ) = H(z1 , . . . , zM ).
Note that if we take M = 1 so that I1 = {1, . . . , N } we get

P


max Xi â‰¤ y = P [Y1 â‰¤ y] = P [Yj â‰¤ y, âˆ€j = 1, . . . , M ]

i=1,...,N

= eâˆ’G(T1 y

âˆ’Î¸ ,...,T

48

Ny

âˆ’Î¸ )

âˆ’Î¸

= eâˆ’G(T1 ,...,TN )y .

That is, maxi=1,...,N Xi is a Î¸-FrÃ©chet random variable with location G(T1 , . . . , TN )
and shape Î¸.
Next we prove part (2). We have
h
i
h
i
P max Xi â‰¤ y and Yj = max Xi = P Yj â‰¤ y and Yj = max Xi
i

i

i

= P [Yj â‰¤ y and Xi â‰¤ Yj , âˆ€i = 1, . . . , N ] = P [Yj â‰¤ y and Xi â‰¤ Yj , âˆ€i âˆˆ
/ Ij ]
Z y
âˆ‚
P [Xi â‰¤ t, âˆ€i âˆˆ
/ Ij | Yj = t] P[Yj â‰¤ t]dt
=
âˆ‚t
Z0 y
âˆ‚
=
P [Xi â‰¤ z, âˆ€i âˆˆ
/ Ij , and Xi â‰¤ t, âˆ€i âˆˆ Ij ]|z=t dt
0 âˆ‚t
Z yX
âˆ‚ âˆ’G(T1 y1âˆ’Î¸ ,...,TN yNâˆ’Î¸ )
dt
=
e
yi =t,âˆ€i=1,...,N
0 iâˆˆI âˆ‚yi
j
Z yX
âˆ’Î¸
âˆ’Î¸
âˆ’Î¸
=
eâˆ’G(T1 y1 ,...,TN yN ) Gi (T1 y1âˆ’Î¸ , . . . , TN yN
)Ti Î¸yiâˆ’Î¸âˆ’1
dt
0

Z

y

=

âˆ’Î¸

eâˆ’G(T1 ,...,TN )t

0

P
=
P
=

yi =t,âˆ€i=1,...,N

iâˆˆIj

X

Ti Gi (T1 , . . . , TN )Î¸tâˆ’Î¸âˆ’1 dt

iâˆˆIj
iâˆˆIj

Ti Gi (T1 , . . . , TN ) Z

G(T1 , . . . , TN )
iâˆˆIj Ti Gi (T1 , . . . , TN )
G(T1 , . . . , TN )

y

âˆ’Î¸

eâˆ’G(T1 ,...,TN )t G(T1 , . . . , TN )Î¸tâˆ’Î¸âˆ’1 dt

0
âˆ’Î¸

eâˆ’G(T1 ,...,TN )y ,

where Gi (x1 , . . . , xN ) = âˆ‚G(x1 , . . . , xN )/âˆ‚xi . Let y â†’ âˆž to get
i
h
P Yj = max Xi =

P

iâˆˆIj

Ti Gi (T1 , . . . , TN )

G(T1 , . . . , TN )

i

.

Finally, we can prove part (3) using the previous results:
h
i P [max X â‰¤ y and Y = max X ]
i
i
j
i
i
P max Xi â‰¤ y | Yj = max Xi =
i
i
P [Yj = maxi Xi ]
P

=

Ti Gi (T1 ,...,TN )

âˆ’Î¸
eâˆ’G(T1 ,...,TN )z
G(T1 ,...,TN )
P
iâˆˆI Ti Gi (T1 ,...,TN )

iâˆˆIj

j

G(T1 ,...,TN )
âˆ’Î¸

= eâˆ’G(T1 ,...,TN )z
h
i
= P max Xi â‰¤ y .
i

49

B

Proof of Lemma 1

Proof. First, we show that if productivity is Î¸-FrÃ©chet, then there must exist a correlation function Gd : RN
+ â†’ R+ such that (5) is the joint distribution of productivity
across origins.
1/Î¸

Consider any (x1 , . . . , xN ) âˆˆ RN
+ . Then xo

â‰¥ 0 for each o. From the definition of a
1/Î¸

multivariate Î¸-FrÃ©chet random variable, the random variable maxo=1,...,N xo Aod (v)
must be distributed as a Î¸-FrÃ©chet random variable. That is, there exists some
T > 0 such that


P

max

o=1,...,N

x1/Î¸
o Aod (v)



âˆ’Î¸

â‰¤ a = eâˆ’T a .

Let T d : RN
+ â†’ R+ be the map (x1 , . . . , xN ) 7â†’ T . We then have that for any
(x1 , . . . , xN ) âˆˆ RN
+

P

max

o=1,...,N

x1/Î¸
o Aod (v)





â‰¤ a = exp âˆ’T d (x1 , . . . , xN )aâˆ’Î¸ .

Note that the joint distribution of productivity can be written as
P[A1d (v) â‰¤ a1 , . . . , AN d (v) â‰¤ aN ] = P[A1d (v)/a1 â‰¤ 1, . . . , AN d (v)/aN â‰¤ 1]


= P max Aod (v)/ao â‰¤ 1 .
o=1,...,N

d
Choosing xo = aâˆ’Î¸
o and a = 1 we can use the properties of our function T and get


P




âˆ’Î¸
max Aod (v)/ao â‰¤ 1 = exp âˆ’T d (aâˆ’Î¸
1 , . . . , aN ) .

o=1,...,N

Therefore, the joint distribution of productivity satisfies
P[A1d (v) â‰¤ a1 , . . . , AN d (v) â‰¤ aN ] = eâˆ’G

d (T

âˆ’Î¸
âˆ’Î¸
1d a1 ,...,TN d aN )

,

d
for the function Gd : RN
+ â†’ R+ defined by (x1 , . . . , xN ) 7â†’ T (x1 /T1d , . . . , xN /TN d ).

We now show that this Gd is a correlation function. First we show that it must be

50

homogenous. Fix (x1 , . . . , xN ) âˆˆ RN
+ and let Î» > 0. We have


exp âˆ’Gd (Î»x1 , . . . , Î»xN ) = P[T1d A1d (v)âˆ’Î¸ â‰¥ Î»x1 , . . . , TN d AN d (v)âˆ’Î¸ â‰¥ Î»xN ]
= P[(x1 /T1d )1/Î¸ A1d (v) â‰¤ Î»âˆ’1/Î¸ , . . . , (xN /TN d )âˆ’1/Î¸ AN d (v) â‰¤ Î»âˆ’1/Î¸ ]
= P[ max (xo /Tod )âˆ’1/Î¸ Aod (v) â‰¤ Î»âˆ’1/Î¸ ]
o=1,...,N


= exp âˆ’T d (x1 /T1d , . . . , xN /TN d )Î»


= exp âˆ’Î»Gd (x1 , . . . , xN ) ,
so that Gd (Î»x1 , . . . , Î»xN ) = Î»Gd (x1 , . . . , xN ) as desired.
Now consider the normalization restriction. Fix o. The distribution of Aod (v) is
âˆ’Î¸

exp âˆ’Tod a




= P[Aod (v) â‰¤ a] = P

max

n=1,...,N

x1/Î¸
n And (v)


â‰¤a ,

for the choice of xn = 0 for n 6= o and xo = 1. But then,



exp âˆ’Tod aâˆ’Î¸ = exp âˆ’T d (x1 , . . . , xN )aâˆ’Î¸


= exp âˆ’T d (0, . . . , 0, 1, 0, . . . , 0)aâˆ’Î¸


= exp âˆ’Gd (0, . . . , 0, Tod , 0, . . . , 0)aâˆ’Î¸


= exp âˆ’Gd (0, . . . , 0, 1, 0, . . . , 0)Tod aâˆ’Î¸ ,
where the last equality comes from the homogeneity of Gd . We therefore must
have Gd (0, . . . , 0, 1, 0, . . . , 0) = 1 as desired.
The unboundedness restriction follows from the limiting properties of joint distributions. Fix o. Then,
lim eâˆ’G

xo â†’âˆž

d (x ,...,x )
1
N

= lim P[T1d A1d (v)âˆ’Î¸ â‰¥ x1 , . . . , AN d (v) â‰¥ xN ]
xo â†’âˆž

âˆ’1/Î¸

= lim P[T1d
xo â†’âˆž

âˆ’1/Î¸

A1d (v) â‰¤ x1 , . . . , TN d AN d (v) â‰¤ xN ] = 0.

Therefore, limxo â†’âˆž Gd (x1 , . . . , xN ) = âˆž as desired.
Finally, the differentiability restrictions are necessary because the productivity distribution is continuous and therefore has a joint density function. Smith (1984)
shows that the differentiability condition is necessary for this joint density to exist.
Therefore, the function Gd must be a correlation function, and we have proven that

51

if productivity is Î¸-FrÃ©chet then there exists a correlation function Gd : RN
+ â†’ R+
such that (5) holds.
We now prove the converse. Let Tod > 0 for each o = 1, . . . , N , and let Gd : RN
+ â†’
R+ be a correlation function. Suppose that {Aod (v)}N
o=1 satisfies


âˆ’Î¸
P[A1d (v) â‰¤ a1 , . . . , AN d (v) â‰¤ aN ] = exp âˆ’Gd (Tod aâˆ’Î¸
1 , . . . , T N d aN ) .
N
We want to show that {Aod (v)}N
o=1 is Î¸-FrÃ©chet. Let (x1 , . . . , xN ) âˆˆ R+ and consider

the distribution of maxo=1,...,N xo Aod (v),
P[ max xo Aod (v) â‰¤ a] = P[x1 A1d (v) â‰¤ a, . . . , xN AN d (v) â‰¤ a]
o=1,...,N

= P[A1d (v) â‰¤ a/x1 , . . . , AN d (v) â‰¤ a/xN ]


= exp âˆ’Gd (Tod xÎ¸1 aâˆ’Î¸ , . . . , TN d xÎ¸N aâˆ’Î¸ )


= exp âˆ’Gd (Tod xÎ¸1 , . . . , TN d xÎ¸N )aâˆ’Î¸ ,
where the last equality uses the homogeneity of Gd . Therefore, maxo=1,...,N xo Aod (v)
is a Î¸-FrÃ©chet random variable with location parameter Gd (Tod xÎ¸1 , . . . , TN d xÎ¸N ). As a
result, we conclude that {Aod (v)}N
o=1 is Î¸-FrÃ©chet.

C

Proof of Theorem 1

Proof. The proof follows Theorem 2 of De Haan (1984) and Theorem 3 of Penrose
(1992). First, we prove sufficiency. Using Assumption 1,

P [Aod (v) â‰¤ ao

âˆ€o = 1, . . . , N ] = P

max (Zi (v)Aiod (v))

i=1,2,...


=P

1/Î¸


â‰¤ ao

max Zi (v)Aiod (v) â‰¤ aÎ¸o

i=1,2,...


= P Zi (v) â‰¤ min

o=1,...,N

52

aÎ¸o
Aiod (v)

âˆ€o = 1, . . . , N

âˆ€o = 1, . . . , N

âˆ€i = 1, 2, . . .

Using Assumption 2 and 3, the last expression is equal to


Z

âˆž
âˆ’2



z dz
= exp âˆ’E
mino aÎ¸o /Aiod (v)




âˆ’Î¸
âˆ’Î¸
= exp âˆ’E max Aiod (v)ao â‰¡ exp âˆ’Gd (T1d aâˆ’Î¸
1 , . . . , T N d aN ) .
o=1,...,N

(?)

Necessity is proved by showing that for any Gd , {Tod }N
o=1 , and Î¸ there exists Aiod (v)
with Tod = EAiod (v) such that (?) holds for some independent Poisson point process
{Zi (v)}i=1,2,... on [0, âˆž) with intensity measure z âˆ’2 dz. Theorem 2 of De Haan (1984)
implies that if AÌƒod (v) is multi-variate 1-FrÃ©chet with unit scale parameters and correlation function Gd , then there exists a random variable AÌƒiod (v) with EAÌƒiod (v) < âˆž
and an independent Poisson process {ZÌƒi (v)}i=1,2,... on [0, âˆž) with intensity measure
z âˆ’2 dz such that

P





âˆ’1
max ZÌƒi (v)AÌƒiod (v) â‰¤ aÌƒo = exp Gd (aÌƒâˆ’1
1 , . . . , aÌƒN

i=1,2,...

Moreover, we must have EAÌƒiod (v) = 1. As a result, (?) holds after a change of
1/Î¸

variables to Aiod (v) = Tod AÌƒiod (v), and ao = aÌƒo .

D

Proof of Proposition 1

Proof. Perfect competition implies that potential import prices are
Pod (v) =

Wo
.
Aod (v)

Then,
P[P1d (v) â‰¥ p1 , . . . , PN d (v) â‰¥ pN ] = P[P1d (v)/W1 â‰¥ p1 /W1 , . . . , PN d (v)/WN â‰¥ pN /WN ]
= P[1/A1d (v) â‰¥ p1 /W1 , . . . , 1/AN d (v) â‰¥ pN /WN ]
= P[A1d (v) â‰¤ W1 /p1 , . . . , AN d (v) â‰¤ WN /pN ]


= exp âˆ’Gd (T1d W1âˆ’Î¸ pÎ¸1 , . . . , TN d WNâˆ’Î¸ pÎ¸n ) .

53

E

Proof of Proposition 2

Proof. The proof follows directly from the properties of Î¸-FrÃ©chet random variables. The probability that variety v is imported by destination d from origin o
is
Ï€od â‰¡ P[Pod (v) â‰¥ Po0 d (v) âˆ€o0 6= o] =

Tod Woâˆ’Î¸ Gdo (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )
,
Gd (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )

by Proposition 1 and Lemma A.3. The distribution of prices among goods imported by destination d from country o satisfies





âˆ’Î¸
âˆ’Î¸ Î¸
P Pod (v) â‰¥ p | Pod (v) = 0 min Po0 d (v) = P 0 min Po0 d (v) â‰¥ p = eâˆ’G(T1d W1 ,...,TN d WN )p ,
o =1,...,N

o =1,...,N

by Proposition 1 and Lemma A.3. The price index in destination d is then
Z
Pd =

âˆ’ Ïƒ1

1

min Pod (v)

0 o=1,...,N

where Î³ = Î“

 1
Î¸âˆ’Ïƒ âˆ’ Ïƒ
,
Î¸

âˆ’Ïƒ

dv

 
âˆ’ Ïƒ1
âˆ’ 1
âˆ’Ïƒ
= Î³Gd T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ Î¸ ,
= E
min Pod (v)
o=1,...,N

Î“(Â·) is the gamma function, and the last equality follows

from the fact that mino=1,...,N Pod (v)âˆ’Ïƒ = (maxo=1,...,N 1/Pod (v))Ïƒ is a FrÃ©chet random

variable with location Gd T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ and shape Î¸/Ïƒ > 1 due to the
assumption that Î¸ > Ïƒ and due to Lemma A.1.

F

Proof of Proposition 3

Proof. First, the set of varieties from o imported to d is {v âˆˆ [0, 1] | Wo /Aod (v) =
mino0 Wo0 /Ao0 d (v)} and for any variety in this set, expenditure is

Xd (v) =

Wo /Aod (v)
Pd

âˆ’Ïƒ
Xd .

Any v not in this set must get imported from a different origin. The price index is
Z
Pd =
0

1



min
Wo0 /Ao0 d (v)
0
o

54

âˆ’Ïƒ

âˆ’ Ïƒ1
dv

,

so that we can write the expenditure share as
1

Z
Ï€od (W, Xd ) â‰¡

R01

o
Xd (v) n
1 Wo /Aod (v) = min
Wo0 /Ao0 d (v) dv
o0
Xd

(Wo /Aod (v))âˆ’Ïƒ 1 {Wo /Aod (v) = mino0 Wo0 /Ao0 d (v)} dv
=
R1
(mino0 Wo0 /Ao0 d (v))âˆ’Ïƒ dv
0
E [(Wo /Aod (v))âˆ’Ïƒ 1 {Wo /Aod (v) = mino0 Wo0 /Ao0 d (v)}]


.
=
E (mino0 Wo0 /Ao0 d (v))âˆ’Ïƒ
0

We need to show that there exists a correlation function that approximates this
factor demand system. The proof is similar to the proof of Theorem 1 in Dagsvik
(1995), differing in the functional form of the demand system to be approximated.
We start by constructing an approximating GEV factor demand system using the
following correlation function, for some Î¸ > Ïƒ,
! ÏƒÎ¸ ï£¹ ÏƒÎ¸

ï£®
Gd (x1 , . . . , xN ) = ï£°E

X

Aod (v)Î¸ xo /Tod

ï£» .

o

This choice of Gd will give the result because it implies a price level,

Pd = Î“

Î¸âˆ’Ïƒ
Î¸



1

Gd (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )âˆ’ Î¸ ,

that approximates the true price level. In particular,

Pd = Î“

Î¸âˆ’Ïƒ
Î¸



! ÏƒÎ¸ ï£¹âˆ’ Ïƒ1

ï£®
ï£°E

X

(Aod (v)/Wo )Î¸

ï£»

o

âˆ’Ïƒ âˆ’ Ïƒ1
h 
Ïƒ iâˆ’ Ïƒ1  
â†’ E max Aod (v)/Wo
= E min Wo /Aod (v)
.

Î¸â†’âˆž

o

o

That is, the price level implied by this correlation function converges pointwise to
the price level associated with the true productivity distribution.

55

The implied GEV factor demand system is
Tod Woâˆ’Î¸ Gdo (T1d W1âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )
Gd (T W âˆ’Î¸ , . . . , TN d WNâˆ’Î¸ )
h P 1d 1
i
Ïƒ
Î¸ Î¸ âˆ’1
Î¸
0
0
E
(A
(v)/W
)
(A
(v)/W
)
od
o
od
o
o0
=
Ïƒ
P
E ( o0 (Ao0 d (v)/Wo0 )Î¸ ) Î¸
âˆ’Ïƒ
1 {Wo /Aod (v) = mino0 Wo0 /Ao0 d (v)}]
Î¸â†’âˆž E [(Wo /Aod (v))


â†’
= Ï€od (W, Xd ).
E (mino0 Wo0 /Ao0 d (v))âˆ’Ïƒ

GEV
(W, Xd ; Î¸) =
Ï€od

That is, the implied GEV factor demand system converges pointwise to the true
demand system. To establish uniform convergence across (W, Xd ) âˆˆ K, for K âŠ‚
+1
GEV
(W, Xd ; Î¸j )}âˆž
RN
compact, note that if the sequence {Ï€od
+
j=1 is convergent, there
GEV
(W, Xd ; Î¸k )}âˆž
exists a positive sequence {Î¸k }âˆž
k=1
k=1 that diverges such that {Ï€od

is monotone and converges. Then, since Ï€od (W, Xd ) is continuous, we can apply
Theorem 7.13 in Rudin et al. (1964) to establish uniform convergence.

G

Proof of Proposition 4

Proof. Micro productivity is distributed multivariate Î¸-FrÃ©chet, with scale Tmod and
micro correlation function F d (X1 , . . . , XN ). Aggregate productivity is Aod (v) â‰¡
maxm=1,...,Mo Amod (v). Using Lemma A.2 and Lemma A.3, Aod (v) is distributed as a
multivariate Î¸-FrÃ©chet with scale parameters
Tod = F d (01 , . . . , 0oâˆ’1 , Tod , 0o+1 , . . . , 0N ) â‰¡ F od (Tod ) ,
for Tod â‰¡ (T1od , . . . , TMo od ), and correlation function
Gd (x1 , . . . , xN ) â‰¡ F d (â„¦1d x1 , . . . , â„¦N d xN ),
for Ï‰mod â‰¡ Tmod /Tod and â„¦od â‰¡ (Ï‰1od , . . . , Ï‰Mo od ).

56

H

Data Construction

For our quantitative analysis, we use trade flow data from the World Input-Output
Database (WIOD), tariff data from the United Nations Comtrade Database, and
gravity covariates from Centre Dâ€™Ã‰tudes Prospectives et dâ€™Informations Internationales (CEPII). When calculating the trade costs implied by this data, we use
GDP deflator data from the Penn World Tables (PWT), version 9.0.

H.1

Map from SITC Codes to WIOD Sectors

The WIOD data allows us to compute the total value of trade between a sample of
40 countries across 25 sectors from 1995 through 2011. The sector classification in
this data set comes from aggregating underlying data classified according to the
third revision of the International Standard Industrial Classification (ISIC). The
Comtrade tariff data is classified according to the second revision of the Standard
International Trade Classification (SITC). In order to merge these data sources, we
construct a mapping that assigns SITC codes to WIOD sectors.
First, we match ISIC and SITC definitions using existing correspondences of each
standard to Harmonized System (HS) product definitions. These correspondences
come from the World Bankâ€™s World Integrated Trade Solution (WITS).26 This merge
matches on 5,701 products out of 5,705 total HS products. We drop the four unmatched products. This creates a HS product dataset with 764 SITC codes and 35
ISIC codes. Note that there are 925 SITC codes in the tariff data to be classified into
WIOD sectors.
Next, we map the ISIC definitions in this merge to the 25 WIOD sectors using the
relation between ISIC codes and the WIOD sectors. This leaves products in the
ISIC code 99 ("Goods not elsewhere classified") without a WIOD sector definition.
At this point, there are two issues we must address: (1) classifying SITC codes that
have products in multiple WIOD sectors; and (2) classifying the SITC codes in the
tariff data that were either matched to ISIC code 99 or were not matched to any
ISIC code. We use a most-common-sector rule and manual classification based on
SITC codes to resolve these two issues and arrive at a mapping from SITC codes to
WIOD sectors.
26

They are available at https://wits.worldbank.org/product_concordance.html.

57

We proceed as follows. First, we determine the most common WIOD sector classification (including "unclassified") at the HS product level of each 4-digit SITC
code within the merge. We re-classify all products within an 4-digit SITC sector as
belonging to the most common WIOD sector, and break ties manually. This step
resolves issue (1) and leaves us with 764 4-digit SITC codes mapped to a unique
WIOD sector, and 161 4-digit SITC codes left unclassified.
Second, we resolve issue (2) by refining the map by using the most common classification of HS products within each 3-digit SITC code, again breaking ties manually. In this step, we only use the most-common classification at the 3 digit level
to classify previously unclassified 4-digit SITC codes, filling in the map. This step
mostly resolves issue (2), leaving only 12 4-digit SITC codes unclassified. We complete the map by manually classifying ten of these remaining codes, while choosing to leave codes 9110 ("Postal packages not classified according to kind") and
9310 ("Special transactions, commodity not classified according to class") unclassified.

H.2

Construction of Sectoral Trade Flow and Tariff Data

With this mapping from (all but two) 4-digit SITC codes to WIOD sectors, we next
aggregate the Comtrade tariff data to the WIOD sector level. First, we compute
the average applied tariff and total value of trade within the Comtrade data by
SITC code, exporter, importer, and year. We then compute the average tariff and
total trade value by WIOD sector, exporter, importer, and year, using the value of
total trade in each SITC code and year as weights when calculating averages, and
dropping codes 9110 and 9310.
Next, we merge these data with the WIOD data. The WIOD data give us the
amount of imports by each sector and country across sectors of all other countries.
We first aggregate this input-output data to get total expenditure by each importer
across the sectors of each exporting country. This aggregation gives a balanced bilateral dataset of trade flows across 25 sectors for each exporter-importer pair from
1995 to 2011. The data contains 40 countries and a rest-of-world aggregate (1,681
pairs per sector, including self trade).
We merge this data with our tariff data at the WIOD sector, exporter, importer, and
year level. The two dataset intersect from 1995 through 2007. For each year, we

58

drop any observations in the tariff data that are not in the WIOD data. This eliminates countries without WIOD bilateral data. We set tariffs for self trade to zero.
Additionally, we have no tariff data for the rest-of-world aggregate and Romania,
and limited data for Taiwan. We drop these three entities leaving us with a sample
of bilateral trade flows and tariffs between 38 countries. Finally, we do not have
tariff data for sectors 15 through 25 (non-traded sectors), so we also drop them
from the data.
The resulting dataset has many trade zeros and missing tariff observations. To address this potential issue, we aggregate together WIOD sectors to get the final ten
sector definitions we use in our quantitative analysis. Specifically, we combine the
"Coke, Refined Petroleum and Nuclear Fuel" and "Chemicals, Rubber, and Plastics"
WIOD sectors to form our "Fuel, Chemicals, Rubber, and Plastics" sector. Also, we
combine the "Machinery, n.e.c.," "Electrical and Optical Equipment," "Transport
Equipment," and "Manufacturing, Nec; Recycling" sectors to get our "Machinery,
Equipment, and Manufacturing n.e.c." sector. We compute the aggregate value of
trade within each of our sectors across bilateral pairs and years, and compute average tariffs for each of our sectors across bilateral pairs and years using total global
trade in each WIOD sector and year as weights.
This aggregation results in a balanced dataset of trade flows and tariffs across 10
sectors and 38 countries (1,444 exporter-importer pairs) from 1995 to 2007. The
share of trade zeros is 1.3 percent, and the share of missing tariff observations is
8.92 percent. Conditional on zero trade, the probability of tariffs being missing is
42.9 percent and conditional on a missing tariff, the probability of a trade zero is
6.3 percent. We finally merge in the CEPII data on geography and other standard
gravity covariates.

I

Additional Tables and Figures

59

Table I.1: Estimates of the trade elasticity Î¸, OLS.

Dep variable

ln(1 + tsodt )

CES
ln Ï€sodt

Cross-nested
CES
P
ln o Ï€sodt

Spatial
P
ln o Ï€sodt

(1)

(2)

(3)

5.523

(0.020)âˆ—âˆ—âˆ—

xÌ‚cnces
sodt

0.607

(0.025)âˆ—âˆ—âˆ—

X

xÌ‚spatial
sodt
Sector-Covariate Interactions
Sector-Origin-Year Effects
Sector-Destination-Year Effects
Destination-Year Effects
Observations
R-squared
F-statistic

0.489

(0.024)âˆ—âˆ—âˆ—

X
X
X
X
174,201
0.82
759.2

X
X

X
X

X

X

174,201
0.74
1,485.4

174,201
0.73
427.8

Notes: Results in column (1) are from estimating (48) by OLS, assuming that Ïsod = 0 so that Ïƒsod =
\
Î¸. Results in columns (2) and (3) are from estimating (49) by OLS, with xÌ‚lsodt = ln (Psod
/Psd ), l =
spatial, cnces, from the first-stage gravity equation in (48). In column (2), (47) collapses to Ïƒsod = ÏƒÌ„s
so that Ïsod = Ïs , for all o, d. Robust standard errors in parenthesis with levels of significance denoted
by *** p < 0.01, and ** p < 0.05 and * p<0.1.

60

12.5

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

12800

30
0

5

10

15

20

25

30
25
20
15
10
5
0

0

5

10

15

20

25

30

Figure I.1: Elasticities of Substitution and Distance, by sector.

12.5

95% C.I.

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)

12800

95% C.I.

25

30

Food, beverages, and tobacco

30

Mining and quarrying

20

0

0

0

5

5

5

10

10

15

15

20

20
15
10

12.5

Bilateral Elasticity Estimate

25

25

30

Agriculture, hunting, forestry, and fishing

12800

95% C.I.

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

12800

12.5

95% C.I.

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

30

25

25

20
15

15

10

10

5

5
12800

95% C.I.

0
12.5

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

25
20
15
10
5
0
12.5

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

95% C.I.

Other non-metallic mineral products

30

Fuel, chemicals, rubber, and plastics

12800

95% C.I.

Pulp, paper, publishing and printing

0
50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

20

25
20
15
10
5
0
12.5

12.5

Wood and products of wood and cork

30

Textiles and leather

12800

95% C.I.

30

12.5

12800

95% C.I.

Machinery, equipment, and manufacturing n.e.c.

Notes: Results from estimating (48) by OLS.

61

12800

12.5

50
200
800
3200
Populationâˆ’Weighted Distance (Kilometers)
Bilateral Elasticity Estimate

12800

95% C.I.

Basic metals and fabricated metal products

0

.02

Share of Expenditure
.04
.06
.08

.1

1995

1997

1999

2001
Year

Notes: Data from WIOD.

62

2003

2005

and

ring

s

l

.

n.e.c

Meta

ral

Mine

cated

Fabri

nufa
ctu

nt, a
nd M
a

ipme

, Equ

Mach
inery

Meta
ls

Othe
r Non
âˆ’Me
tallic

lastic

Publi
shing

nd P

ber,
a

, Rub

icals

Chem

Basic

Fuel,

and

Leath
er

nd C
ork

od a

of W
o

er, P
rintin
g

Pulp
, Pap

ducts

d an
d Pro

Woo

o

g

bacc

arryin

d To

s and

Texti
le

es an

erag

, Bev

Food

d Qu

ishin
g

nd F

stry a

Fore

Minin
g an

, Hun
ting,

ulture

Agric

0

Sectoral Elasticity
5
10 15 20

Figure I.2: Elasticity of substitution, by sector. Cross-nested CES estimation.

Sector

Notes: Results from estimating (48) by OLS assuming that Ïƒsod = ÏƒÌ„s .

Figure I.3: U.S. imports from China in "Machinery, Equipment, & Manuf n.e.c.".

2007

