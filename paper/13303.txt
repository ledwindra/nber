NBER WORKING PAPER SERIES

CLASS SIZE AND SORTING IN MARKET EQUILIBRIUM:
THEORY AND EVIDENCE
Miguel Urquiola
Eric Verhoogen
Working Paper 13303
http://www.nber.org/papers/w13303
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2007

We thank Kensuke Teshima for excellent research assistance. For useful comments we thank (without
implicating) Josh Angrist, Jere Behrman, David Card, Ken Chay, Pierre-Andre Chiappori, Gregory
Elacqua, Helios Herrera, Kate Ho, Larry Katz, David Lee, Robert Moffitt, Richard Romano, Bernard
Salanie, and many seminar participants. We especially thank Patrick McEwan, who was involved
in the early stages of the project. The views expressed herein are those of the author(s) and do not
necessarily reflect the views of the National Bureau of Economic Research.
¬© 2007 by Miguel Urquiola and Eric Verhoogen. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
¬© notice, is given to the source.

Class Size and Sorting in Market Equilibrium: Theory and Evidence
Miguel Urquiola and Eric Verhoogen
NBER Working Paper No. 13303
August 2007
JEL No. C2,I2,L1,O1
ABSTRACT
This paper examines how schools choose class size and how households sort in response to those choices.
Focusing on the highly liberalized Chilean education market, we develop a model in which schools
are heterogeneous in an underlying productivity parameter, class size is a component of school quality,
households are heterogeneous in income and hence willingness to pay for school quality, and schools
are subject to a class-size cap. The model offers an explanation for two distinct empirical patterns
observed among private schools that accept government vouchers: (i) There is an inverted-U relationship
between class size and household income in equilibrium, which will tend to bias cross-sectional estimates
of the effect of class size on student performance. (ii) Some schools at the class size cap adjust prices
(or enrollments) to avoid adding another classroom, which produces stacking at enrollments that are
multiples of the class size cap. This generates discontinuities in the relationship between enrollment
and household characteristics at those points, violating the assumptions underlying regression-discontinuity
(RD) research designs. This result suggests that caution is warranted in applying the RD approach
in settings in which parents have substantial school choice and schools are free to set prices and influence
their enrollments.
Miguel Urquiola
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York, NY 10027
and NBER
msu2101@columbia.edu
Eric Verhoogen
Columbia University
SIPA and Economics Department
1022 IAB, MC 3308
420 West 118th Street
New York NY 10027
eric.verhoogen@columbia.edu

1

Introduction

There has been a long and heated debate on whether class-size reductions improve educational
performance. Hanushek (1995, 2003) reviews an extensive literature and concludes that class
size has no systematic eÔ¨Äect on student achievement in either developed or developing countries.
Krueger (2003), Kremer (1995) and others have countered that this conclusion is based largely
on cross-sectional evidence and subject to multiple potential sources of bias, including the endogenous sorting of students into classes of diÔ¨Äerent sizes, and have called for further analyses
using experimental and quasi-experimental designs. In the latter category, an inÔ¨Çuential approach
has been the regression-discontinuity (RD) design of Angrist and Lavy (1999), which exploits the
discontinuous relationship between enrollment and class size that results from class-size caps.1
Despite a general awareness of the possible endogeneity of class size, relatively little attention
has been paid to how schools choose class size or to how households sort in response to those
choices. In this paper, we develop a model of class-size choices by heterogeneous schools and of
school choices by heterogeneous households, show that two central predictions are borne out in
data on Chilean schools, and argue that these Ô¨Åndings have important implications for attempts
to estimate the eÔ¨Äect of class size on student outcomes. Chile‚Äôs educational market is well-suited
to such an investigation in part because private schools account for approximately half of the
market, and a majority of them are operated on a for-proÔ¨Åt basis. This makes it straightforward
to specify schools‚Äô objective functions‚Äîan otherwise diÔ¨Écult task in many public-sector contexts.
In the model, schools are assumed to be monopolistically competitive, to be heterogeneous in
an underlying productivity parameter, and to oÔ¨Äer quality-diÔ¨Äerentiated ‚Äúproducts,‚Äù where class
size is a component of school quality. Households are assumed to be heterogeneous in income
and hence in willingness to pay for quality. Schools face three constraints, corresponding to real
restrictions faced by private schools that accept vouchers in Chile: (1) a class size cap at 45
students; (2) an integer constraint on the number of classrooms; and (3) the restriction that
enrollment (a choice variable of schools) cannot exceed demand.
The model delivers two main empirical predictions, both of which Ô¨Ånd support in the data.
First, there is an inverted-U relationship between class size and household income in cross-section.
1

The RD approach has also been used to study the eÔ¨Äects of class size by Hoxby (2000) in the U.S., Dobbelsteen, Levin, and Oosterbeek (2002) in Holland, Browning and Heinesen (2003) in Denmark, Asadullah (2005) in
Bangladesh, Jakubowski and Sakowski (2005) in Poland, Bressoux, Kramarz, and Prost (2005) and Piketty and
Valdenaire (2006) in France, WoÃàssmann (2005) in ten European countries, and Urquiola (2006) in Bolivia.

1

The model predicts that higher-income households sort into higher-productivity, higher-quality
schools, as one might expect. The inverted U arises from the interaction of two eÔ¨Äects: higher
productivity enables schools to Ô¨Åll up their existing classrooms, and it also leads them to add
classrooms and reduce class size to appeal to higher-income households. The former tends to
dominate at lower levels of productivity, and the latter at higher levels. The inverted-U relation
between class size and income will tend to confound attempts to estimate the eÔ¨Äect of class size
in cross-sectional regressions.
Second, in the presence of the class-size cap and the integer constraint on the number of
classrooms, schools at the cap adjust price (or enrollment) to avoid having to add an additional classroom. This results in stacking at enrollment levels that are multiples of 45. Because
higher-income households sort into higher-productivity schools, the stacking implies discontinuous changes in average family income and hence in other correlates of income, such as mothers‚Äô
schooling, at these multiples. The resulting discontinuities violate the assumptions underlying the
RD designs that have been used to estimate the eÔ¨Äect of class size. Our results thus provide a
concrete illustration of how endogenous sorting around discontinuities may invalidate RD designs
(Lee, forthcoming; McCrary, forthcoming). We view these results as a cautionary note regarding
the application of such designs in contexts where schools are able to set prices and inÔ¨Çuence their
enrollments, and parents have substantial school choice. As we discuss below, we have no reason
to believe that this conclusion generalizes to the public-school settings typically studied, in which
students are required to attend local schools and in which schools cannot control their enrollments
but rather react mechanically to them.
In addition to the papers cited above, this paper is related to a growing body of theoretical
and empirical work on sorting in education markets, including Manski (1992), Epple and Romano
(1998), Clotfelter (1999), Epple, Figlio, and Romano (2002), Epple and Romano (2002), Nesheim
(2002), Caucutt (2002), Nechyba (2003), Bayer, McMillan, and Rueben (2004), Altonji, Huang,
and Taber (2005), Urquiola (2005), Epple, Romano, and Sieg (2006), Hsieh and Urquiola (2006),
Rothstein (2006), and Ferreyra (2007). Much of this work is focused on the impact of greater
school choice‚Äîeither through greater school district availability or through vouchers‚Äîon sorting
outcomes. The distinctive aspect of this paper is our focus on the role of institutional constraints‚Äî
the class-size cap and the integer constraint‚Äîin a market that is already largely liberalized.
One caveat is that this paper does not consider the role of peer eÔ¨Äects, which play a central role
2

in much of the previous theoretical work on sorting in educational markets (Epple and Romano,
1998, 2002; Epple, Figlio, and Romano, 2002). In many of these models, schools are essentially
passive ‚Äúclubs‚Äù whose main attribute is the average ability and income of their students. In our
model, as in Epple, Romano, and Sieg (2006), schools actively choose the level of educational
quality to supply. It is diÔ¨Écult to integrate both the peer-eÔ¨Äects and the quality-choice elements
in an analytically tractable model. Epple, Romano, and Sieg (2006) maintain both elements, but
must rely on numerical methods to compute equilibria. Our approach is to abstract from peer
eÔ¨Äects in order to arrive at analytical results. In the long run it would clearly be desirable to
develop an analytically tractable model that combines both elements.
This paper is also related to work on quality choice by Ô¨Årms (Mussa and Rosen, 1978; Gabszewicz and Thisse, 1979; Shaked and Sutton, 1982; Anderson and de Palma, 2001). The structure
of the theoretical model has many elements in common with the framework of Verhoogen (2007),
which models quality choice by heterogeneous Mexican Ô¨Årms facing heterogeneous consumers in
the domestic and export markets.
Finally, in seeking to understand the mechanisms behind the determination of class size, we
view our work as complementary to Lazear (2001), which focuses on how schools allocate students
with heterogeneous levels of self-discipline into classes of diÔ¨Äerent sizes. We abstract from sorting
within schools and instead focus on sorting between schools with diÔ¨Äerent average class sizes.
The remainder of the paper is organized as follows. Section 2 provides institutional background, and section 3 sets out the model. Section 4 describes the data. Section 5 discusses
testable implications and presents the results. Section 6 concludes.

2

Chile‚Äôs School System

There are three main types of schools in Chile:
1. Public or municipal schools are run by roughly 300 municipalities which receive a perstudent ‚Äúvoucher‚Äù payment from the central government. These schools cannot turn away
students unless oversubscribed, and are limited to a maximum class size of 45.2 In most
municipalities, they are the suppliers of last resort.
2

In some instances schools are temporarily authorized to have classes of 46 or 47, but they receive no payments
for the students above 45.

3

2. Private subsidized or voucher schools are independent, and since 1981 have received exactly
the same per student subsidy as municipal schools.3 They are also constrained to a maximum
class size of 45, but, unlike public schools, have wide latitude regarding student selection.
3. Private unsubsidized schools are independent, do not accept vouchers and receive no other
explicit subsidies, and are not bound by the class-size cap.
Parents can use the per-student voucher in any public or private voucher school that is willing
to accept their children. In 2003, private schools (both voucher and unsubsidized) accounted for
about 45 percent of all schools, and voucher schools alone accounted for about 36 percent. In
urban areas, these shares were 62 and 48 percent, respectively. Private schools can be explicitly
for-proÔ¨Åt, and using their tax status to classify them, Elacqua (2005) calculates that about 70
percent of them are indeed operated as such. Further, even non-proÔ¨Åt schools can legally distribute
dividends to principals or board members. A handful of private schools are run by privately or
publicly held corporations that control chains of schools, but the modal one is owned and managed
by a single principal/entrepreneur.
Public primary schools are not allowed to charge ‚Äúadd on‚Äù tuition supplemental to the voucher
subsidy.4 While initially voucher private schools were subject to the same constraint, this restriction was eased beginning in 1994. At present, they can charge tuition as high as approximately
1.7 times the voucher payment. In practice, this constraint appears not to be important for most
voucher schools; in 2006, for instance, fewer than 4 percent of them had per-student revenues
within 25 percent of the tuition cap.5 The resources these institutions raise through tuition are
equal to about 20 percent of their state funding.
Rather than attempt to analyze the entire Chilean educational sector, we narrow our focus in
four important ways. First, we restrict attention to primary (K-8) schools because class size, a
central variable in our analysis, is more clearly deÔ¨Åned at the primary than at the secondary level.
Second, we focus on private schools since, as mentioned above, we can plausibly assume that they
are proÔ¨Åt-maximizing. Third, we focus on urban areas because we want to consider settings where
enrollment and class size are determined by schools‚Äô and households‚Äô choices, and not constrained
3

The payment varies somewhat by location, but within an area voucher and municipal schools receive equal
payments. For further details on the creation of the voucher system, see Hsieh and Urquiola (2006).
4
Public secondary schools can charge add-ons, but in practice very few do.
5
The administrative data this Ô¨Ågure is based on contain information on average revenue and not posted prices.
The former can be lower than posted tuition if some students receive discounts.

4

by the size of the market, as could happen in rural areas.6 Fourth, we focus on voucher schools,
the private schools subject to the class-size cap, and not on unsubsidized schools. We do so in
part because we are primarily interested in how the class-size cap aÔ¨Äects sorting outcomes, and in
part because the unsubsidized schools serve a very distinct, elite population,7 and are governed
by considerations that would be diÔ¨Écult to incorporate tractably into our theoretical framework.8
A Ô¨Ånal relevant fact is that as elsewhere, primary schools in Chile are not large; 95 percent
of urban ones have fewer than 135 students in the 4th grade.9 As Figure 1 illustrates, they run
relatively few classes per grade. In 2002, for instance, 53 percent of urban private schools had
only one 4th grade class, while 86 and 95 percent had two or fewer or three or fewer, respectively.
Public schools run a slightly higher average number of classes, but 91 percent of them still operate
three or fewer 4th grades. While in theory schools could combine students from more than one
grade into a single classroom, in practice very few do, especially in the urban areas we focus on.
In 2002, for instance, 4.3 percent of urban voucher schools reported they combined more than one
grade into a class.10 These facts motivate the integer constraint in our model.

3

The Model

This section develops a model of quality diÔ¨Äerentiation and sorting in the Chilean school market.
We model parents‚Äô demand for education in a standard discrete-choice framework with quality
diÔ¨Äerentiation (McFadden, 1974; Anderson, de Palma, and Thisse, 1992). We solve the optimization problem of proÔ¨Åt-maximizing voucher schools under realistic constraints. To simplify the
model, we take the set of voucher schools as given and abstract from entry decisions. This is a
strong assumption, but our view is that including a detailed analysis of entry would add more
6

The qualitative conclusions of our empirical analyses turn out not to be much aÔ¨Äected by this restriction.
The summary statistics in Table 1, discussed in more detail below, indicate that the students attending private
unsubsidized schools are from markedly richer households than those in voucher or public schools; for instance, the
average household income at the 10th percentile of the income distribution in unsubsidized schools is greater than
the average household income at the 90th percentile of the income distribution in voucher schools.
8
Indeed, in the context of our model, it is a puzzle that many unsubsidized schools refuse to accept vouchers.
Essentially all these schools have class sizes below 45, and while we do not have reliable data on their tuition,
it appears that many of them also charge average fees well below the maximum allowed for voucher schools.
Anecdotally, it appears that an important reason for why these schools do not accept vouchers is that exclusivity is
part of their appeal. This appears to be related to peer eÔ¨Äects and considerations of social status that are diÔ¨Écult
to model tractably.
9
As discussed below, we focus primarily on 4th grade observations because our testing data are at that grade
level. The results for other grades, however, are quite similar.
10
The administrative data do not allow us to discern how often this happened speciÔ¨Åcally at the 4th grade level,
the one we focus on below. They simply report that the school did this for some combination of grades.
7

5

tedious complication than real insight. Under the assumption that each school thinks of itself
as small relative to the market as a whole, the extent of entry would not aÔ¨Äect the optimizing
decisions of particular schools, and our two main implications would continue to hold. It is worth
emphasizing that our two main implications do not hold for all possible parameter values in our
model. Rather, we show that there exists a set of parameter values for which the implications do
hold and in Section 4 we examine whether there is empirical support for them.

3.1

Demand

There is a continuum of households of mass M , heterogeneous in income. Each is assumed to
have one child and to enroll the child in a school. The parameter Œª, discussed in more detail
below, indexes schools. Let x(Œª), n(Œª) and p(Œª) represent the enrollment, number of classrooms
and tuition of school Œª. We assume that school quality is observed by households and depends
on enrollment, the number of classrooms, and Œª in a manner to be made clear below. Households
are assumed to have the following indirect utility function:


 


U p(Œª), q x(Œª), n(Œª), Œª ; Œ∏ = Œ∏q x(Œª), n(Œª), Œª ‚àí p(Œª) + Œµ

(1)



where q x(Œª), n(Œª), Œª is school quality and Œµ is a random term capturing the utility of a particular
household-school match. This speciÔ¨Åcation follows from a direct utility function in which households have identical utility functions and diÔ¨Äer only in income.11 The parameter Œ∏ represents
households‚Äô willingness to pay for quality, and is a monotonically increasing function of household
income. We assume that Œ∏ has a distribution g(Œ∏) with positive support over (Œ∏, Œ∏) where Œ∏, Œ∏ > 0;
this distribution reÔ¨Çects the underlying distribution of income among households. We assume
the random-utility term Œµ is i.i.d. across households with a double-exponential distribution with



c.d.f. F (Œµ) = exp ‚àí exp ‚àí ¬µŒµ + œá ,12 where ¬µ is a positive constant that captures the degree of
11

Suppose:

e (z, q) = u(z) + q + Œµe
U

where z is a non-diÔ¨Äerentiated numeraire good, q is the quality of education, Œµe is a mean-zero random term, and
the sub-utility function u(¬∑) has u (¬∑) > 0 and u (¬∑) < 0. If households are on their budget constraint, then indirect
utility is:
e (p, q ; y) = u (y ‚àí p) + q + Œµe
U
Taking a Ô¨Årst-order approximation of u(¬∑) around y, and setting Œ∏ ‚â° 1/u (y) , U ‚â°
u(y)
u (y)

e
U
u (y)

‚àí

u(y)
,
u (y)

and Œµ ‚â°

Œµ
e
,
u (y)

we

term is constant across schools and does not aÔ¨Äect the household‚Äôs choice probabilities.
have (1). Note that the
12
We assume œá = 0.5772 (Euler‚Äôs constant), ensuring that the expectation of Œµ is zero.

6

diÔ¨Äerentiation between schools.13
A standard derivation yields the probability that a household chooses school Œª, conditional
on having willingness to pay for quality Œ∏ and on the qualities and prices of all schools:14


s Œª| Œ∏, q(¬∑), p(¬∑) =

where
‚Ñ¶(Œ∏) ‚â°



Œª

exp
Œª

1
exp
‚Ñ¶(Œ∏)






Œ∏q x(Œª), n(Œª), Œª ‚àí p(Œª)
¬µ

(2)




Œ∏q x(ŒªÃÉ), n(ŒªÃÉ), ŒªÃÉ ‚àí p(ŒªÃÉ)
f (ŒªÃÉ) dŒªÃÉ
¬µ

We assume that schools cannot discriminate among households, and hence that price and quality
are equal for all households in a given school. As is common in monopolistic-competition models,
we will treat individual schools as small relative to the market as a whole, and assume that they
ignore their eÔ¨Äect on the aggregate ‚Ñ¶(Œ∏).
The expected market share of school Œª, integrating over all households, is:
 


s q x(Œª), n(Œª), Œª , p(Œª) =

Œ∏





s Œª|Œ∏, q x(Œª), n(Œª), Œª , p(Œª) g(Œ∏)dŒ∏

(3)

Œ∏

Expected demand for school Œª is then:
 

 



d q x(Œª), n(Œª), Œª , p(Œª) = M s q x(Œª), n(Œª), Œª , p(Œª)

(4)

The key implications of this demand speciÔ¨Åcation are that demand for school Œª is declining in
price and increasing in quality, and that higher-Œ∏ households are more sensitive to quality for
a given price. Note that the speciÔ¨Åcation combines horizontal diÔ¨Äerentiation, in the sense that
if all schools‚Äô tuitions are equal each will face positive demand with positive probability, with
vertical diÔ¨Äerentiation, in the sense that if tuitions are equal, higher-quality schools will face
higher demand. Throughout we will assume schools are risk-neutral, and ignore the fact that the
expression for d(¬∑) represents an expectation.
It will be convenient to deÔ¨Åne the expected willingness to pay of households that send their
13

As ¬µ ‚Üí 0, the distribution of household-school-speciÔ¨Åc utility terms collapses to a point, and the model
approaches perfect competition.
14
See for example Anderson, de Palma, and Thisse (1992, theorem 2.2, p. 39).

7

children to school Œª:
 






Œò q x(Œª), n(Œª); Œª , p(Œª)
‚â° E Œ∏ q x(Œª), n(Œª); Œª , p(Œª)

‚é° 
‚é§


Œ∏
s Œª| Œ∏, q x(Œª), n(Œª), Œª , p(Œª) g(Œ∏)
‚é¶ dŒ∏
 

Œ∏ ‚é£
=

Œ∏
s q x(Œª), n(Œª), Œª , p(Œª)

(5)

where by Bayes‚Äô rule the term in brackets represents the probability density of Œ∏ conditional on
households sending their children to school Œª.

3.2

Production

We now think of Œª as an exogenously Ô¨Åxed productivity parameter in which schools are heterogeneous. It can be interpreted as the ability of the school principal/entrepreneur.15 We assume
that there is a continuum of schools with continuous density f (Œª) over the interval [Œª, Œª). Each
school is uniquely identiÔ¨Åed by its value of Œª, which justiÔ¨Åes our use of Œª as an index above.
Each school is constrained to oÔ¨Äer just one ‚Äúproduct,‚Äù and is assumed to produce quality with
a technology:


q(x, n; Œª) = Œª ln

T
x/n


(6)

where x is enrollment, n is the number of classrooms, the denominator is class size, and T is a
constant that represents the technological maximum of class size. The term in parentheses is by
assumption always greater than or equal to one. This speciÔ¨Åcation captures the idea that the
larger is class size the less teacher attention is available for each individual student.16 Note that
a given reduction in class size raises quality more at higher-Œª schools. This complementarity will
be crucial in what follows.
In order to guarantee an interior solution for the school‚Äôs optimization problem we must impose
a lower bound on the degree of diÔ¨Äerentiation between schools. The condition:
¬µ > ŒªŒ∏
15

(7)

In a more complex, dynamic model, one might think of Œª as reputation. The important point is that it aÔ¨Äects
households‚Äô perceptions of quality and is unaÔ¨Äected by schools‚Äô decisions in the short run.
16
An interesting extension might be to include an endogenous term in the numerator representing teacher quality,
an additional choice variable for schools. We leave this task for future work, in part because we do not have data
on teacher salaries or other teacher characteristics.

8

will be suÔ¨Écient. Intuitively, this limits the extent to which demand for a school increases with
a given class-size reduction.
We suppose that there is a Ô¨Åxed cost Fs of running a school, a Ô¨Åxed cost Fc of operating a
classroom, and a constant variable cost c for each student. Recall that p is tuition, and let œÑ be
the per-student subsidy that schools receive from the government. ProÔ¨Åt is then:
œÄ(p, n, x; Œª) = (p + œÑ ‚àí c) x ‚àí nFc ‚àí Fs

(8)

There is assumed to be no cost of diÔ¨Äerentiation; hence every school diÔ¨Äerentiates its ‚Äúproduct‚Äù
and has a monopoly over the product it oÔ¨Äers.

3.3

Schools‚Äô Optimization Problem

The problem facing schools is to maximize proÔ¨Åt over the choice of tuition, enrollment, and the
number of classrooms:
max œÄ(p, x, n; Œª)
p,x,n

(9)

This optimization is subject to three constraints:
1. The number of classrooms must be a positive integer
n‚àà
where



(10)

 is the set of natural numbers {1, 2, 3, ...}.

2. Class size cannot exceed the class-size cap:
x
‚â§ 45
n

(11)

x ‚â§ d(q(x, n; Œª), p)

(12)

3. Enrollment cannot exceed demand:

where q(¬∑) is given by (6) and d(¬∑) by (4).

9

Although the Ô¨Årst two constraints are designed to mimic the institutional environment in Chile,
they are likely to apply more generally. It is common in many countries for primary schools to
have a relatively small number of classrooms per grade and to be subject to class-size caps. The
third constraint clearly applies to all schools.17

3.4

Characterization of Equilibrium

The integer restriction complicates the solution of schools‚Äô optimization problems, since we cannot
simply solve a set of Ô¨Årst-order conditions. A common approach to such problems is to Ô¨Årst relax
this constraint, then compare solutions with and without the relaxation. This is how we proceed
below. In the main text, we report key results; derivations of those results appear in Appendix
A, with section numbers corresponding to the cases.
Case 1: Divisible Classrooms
If the integer constraint (10) is relaxed, it turns out that in equilibrium there is a critical value of
the entrepreneurial-ability parameter, call it Œ±, to the right of which the class-size cap does not
bind and to the left of which it does bind. Consider each of these sub-cases in turn.
Sub-Case 1.1: Class-Size Cap Non-Binding
If Œª > Œ± and the cap does not bind, then in equilibrium schools‚Äô optimal choices are deÔ¨Åned
implicitly by the following:
 


p‚àó (Œª) = ¬µ + c ‚àí œÑ + ŒªŒò q x‚àó (Œª), n‚àó (Œª); Œª , p‚àó (Œª)
 


x‚àó (Œª) = d q x‚àó (Œª), n‚àó (Œª); Œª , p‚àó (Œª)
 


1
Œªx‚àó (Œª)Œò q x‚àó (Œª), n‚àó (Œª); Œª , p‚àó (Œª)
n‚àó (Œª) =
Fc

(13a)
(13b)
(13c)

where Œò(¬∑) is given by (5), d(¬∑) is given by (4), and the asterisks indicate equilibrium values. In
order for the second-order conditions for a maximum to be satisÔ¨Åed, it must be the case that:
 ŒªœÉ 2
 

Œ∏|Œª
>0
Œ® ‚â° Œò q x‚àó (Œª), n‚àó (Œª); Œª , p‚àó (Œª) ‚àí
¬µ
17

(14)

The third constraint ends up binding in every case we present here, and we could treat it as an equality
constraint or substitute d(¬∑) for x in (8) and (9). But there exist realistic cases in which it would not bind‚Äîi.e. if
there were a tuition constraint. For conceptual clarity, we leave the constraint as an inequality.

10

2 is the variance of Œ∏ among households with children attending school Œª in equilibrium.18
where œÉŒ∏|Œª

Assumption (7) guarantees that this condition holds. (See Appendix A.1.1.) Unfortunately,
there is no explicit analytical solution to (13a)-(13c). Nonetheless, using the implicit function
theorem, we can sign the relationship between the various endogenous variables and the underlying
productivity parameter, Œª. In particular:
‚àÇp‚àó
>0
‚àÇŒª
‚àÇx‚àó
>0
‚àÇŒª
‚àÇn‚àó
>0
‚àÇŒª
‚àÇŒò‚àó
>0
‚àÇŒª 
‚àÇ x‚àó
<0
‚àÇŒª n‚àó

(16a)
(16b)
(16c)
(16d)
(16e)

where Œò‚àó is shorthand for the equilibrium value of Œò(¬∑) for a given Œª. In equilibrium, higher-Œª
schools charge higher tuition, have larger enrollments, operate more classrooms, have smaller class
sizes, and attract students whose families are on average wealthier and have higher willingness to
pay for quality. All of these relationships are monotonic in Œª.
In Figure 2, which plots class size vs. Œª in the divisible-classrooms case, this sub-case corresponds to the declining portion of the curve, to the right of the critical value Œ±. Intuitively, the
fact that class size is declining in Œª is a consequence of the fact that Œª and class-size reductions
are complementary in the quality production function (6).
Sub-Case 1.2: Class-Size Cap Binding
If Œª ‚â§ Œ± and the class-size cap binds, then in equilibrium schools‚Äô optimal choices are deÔ¨Åned
18

That is, deÔ¨Åne:
2
‚â°
œÉŒ∏|Œª

Z

Œ∏
Œ∏

‚Äù
3
2 ‚Äú
`
¬¥
‚Äû
‚Äú `
‚Äù¬´2 s Œª| Œ∏, q x‚àó (Œª), n‚àó (Œª), Œª , p‚àó (Œª) g(Œ∏)
¬¥
‚àó
‚àó
‚àó
5 dŒ∏
4
‚Äú `
‚Äù
Œ∏ ‚àí Œò q x (Œª), n (Œª); Œª , p (Œª)
¬¥
s q x‚àó (Œª), n‚àó (Œª), Œª , p‚àó (Œª)

11

(15)

implicitly by:
Fc
p‚àó (Œª) = c ‚àí œÑ + ¬µ +
45
 


‚àó
‚àó
x (Œª) = d q x (Œª), n‚àó (Œª); Œª , p‚àó (Œª)
n‚àó (Œª) =

x‚àó (Œª)

(17a)
(17b)
(17c)

45

The slopes with respect to Œª in this sub-case are:
‚àÇp‚àó
=0
‚àÇŒª
‚àó
‚àÇx
>0
‚àÇŒª
‚àÇn‚àó
>0
‚àÇŒª
‚àÇŒò‚àó
>0
‚àÇŒª 
‚àÇ x‚àó
=0
‚àÇŒª n‚àó

(18a)
(18b)
(18c)
(18d)
(18e)

Although class size and price are constant, enrollment, the number of classrooms, and average
household income are increasing in the productivity parameter. Average household income is
increasing in Œª because Œª raises quality conditional on class size. It is notable that proÔ¨Åts are also
increasing in Œª, even though price is constant, because enrollment is increasing in Œª and schools
charge a mark-up over costs. In Figure 2, this sub-case corresponds to the portion of the curve
to the left of Œ± where class size is Ô¨Çat at 45.
The critical value Œ± is deÔ¨Åned implicitly by the equation
 F
 

c
Œ±Œò q x‚àó (Œ±), n‚àó (Œ±); Œ± , p‚àó (Œ±) =
45
This is the value of Œª at which

x
n

(19)

= 45 in the Ô¨Årst sub-case above. Note that there is no guarantee

that Œ± ‚àà (Œª, Œª), i.e. that the class-size cap will be binding on any schools in the market. At the
critical value, the optimal choices p‚àó , x‚àó , and n‚àó are equal in the two sub-cases (cap binding, cap
non binding). Hence over the entire range of Œª we have that p‚àó , x‚àó , n‚àó and Œò‚àó are continuous; p‚àó
is weakly monotonically increasing; x‚àó , n‚àó and Œò‚àó are strictly monotonically increasing; and
is weakly monotonically decreasing.

12

x‚àó
n‚àó

Case 2: Indivisible Classrooms
Now add the restriction that the number of classrooms must be an integer (10). Our strategy
for dealing with the integer constraint is Ô¨Årst to characterize the optimal choices of schools for a
given number of classrooms, and then to characterize the sets of schools that choose each integer
number of classrooms.
Fixed Number of Classrooms
To begin, suppose that n is Ô¨Åxed and think of it as a parameter. It will turn out that for a given
n there is a single critical value of Œª, call it Œ≤(n), below which the class-size cap does not bind
and above which it binds. Again consider the two sub-cases in turn.
Sub-Case 2.1: Class-Size Cap Non-Binding
If Œª ‚â§ Œ≤(n) and the class-size cap does not bind, then schools‚Äô optimal choices are implicitly
deÔ¨Åned by:
 


p‚àó (n, Œª) = ¬µ + c ‚àí œÑ + ŒªŒò q x‚àó (n, Œª); n, Œª , p‚àó (n, Œª)
 


x‚àó (n, Œª) = d q x‚àó (n, Œª); n, Œª , p‚àó (n, Œª)

(20a)
(20b)

Price and average willingness to pay (i.e. average household income) are unambiguously increasing
in Œª:
‚àÇp‚àó
>0
‚àÇŒª
‚àÇŒò‚àó
>0
‚àÇŒª

(21a)
(21b)

There is a subtlety in the relationship between enrollment and Œª. On one hand, there is a
direct eÔ¨Äect of a higher Œª on demand: for a given class size, households prefer higher-Œª schools.
On the other hand, there is an indirect eÔ¨Äect: from (6), at higher values of Œª a given increase
in enrollment has a larger negative eÔ¨Äect on quality and hence on demand. It is theoretically
possible in this case that the latter eÔ¨Äect dominates, making it optimal for higher-Œª schools to
raise prices such that enrollment, conditional on a given number of classrooms, is decreasing in Œª.
In that case, our testable implications (discussed in the introduction and in more detail below)
13

do not hold. We focus instead on the case where enrollment is increasing in Œª. A necessary and
suÔ¨Écient condition for this, which we assume hereafter, is:19

ln

nT
x‚àó (n, Œª)

 


Œò q x‚àó (n, Œª); n, Œª , p‚àó (n, Œª)


>

(22)

Œ®

where Œ® is deÔ¨Åned as in (14). Under this assumption, we have
‚àÇx‚àó
>0
‚àÇŒª
Since n is Ô¨Åxed, (23) implies that

‚àÇ
‚àÇŒª

 x‚àó 
n

(23)

> 0; for a given number of classrooms, class size is

increasing in Œª. That is, conditional on n, higher-Œª schools are better able to Ô¨Åll their classrooms.
Sub-Case 2.2: Class-Size Cap Binding
If Œª > Œ≤(n) and the class-size cap binds, then we have two endogenous variables and two binding
constraints. The constraints pin down the values of p and x:
p‚àó (n, Œª) = ¬µ ln Œ£ ‚àí ¬µ ln(45n)

(24a)

x‚àó (n, Œª) = 45n

(24b)

where
Œ£‚â°

Œ∏
Œ∏

1
‚Ñ¶(Œ∏)



T
45

 Œ∏Œª
¬µ

g(Œ∏)dŒ∏

(25)

The slopes with respect to Œª are:
‚àÇp‚àó
‚àÇŒª
‚àÇx‚àó
‚àÇŒª
‚àÇŒò‚àó
‚àÇŒª
19

> 0
=

‚àÇ
‚àÇŒª



(26a)


x‚àó
=0
n

(26b)

> 0

(26c)

If we replace the production function for quality (6) by a general function q(x, n; Œª), then the condition is:
!
2
œÉŒ∏|Œª
1 ‚àÇq
‚àÇq
‚àÇ2q
<
+
‚àí
‚àÇx‚àÇŒª
¬µŒò‚àó ‚àÇx
x ‚àÇŒª

which makes it clear that the indirect eÔ¨Äect of higher Œª described above (represented by
‚àÇq
).
magnitude relative to the direct eÔ¨Äect (represented by ‚àÇŒª

14

‚àÇ2q
)
‚àÇx‚àÇŒª

must be small in

The critical value Œ≤(n) for a given n is deÔ¨Åned implicitly by the equation:
 


Œ≤(n) Œò q x‚àó (Œ≤(n)); n, Œ≤(n) , p‚àó (Œ≤(n)) = ¬µ ln Œ£ ‚àí ¬µ ln(45n) ‚àí c + œÑ ‚àí ¬µ

(27)

The critical value of Œª is the point at which class size reaches 45 in sub-case 2.1. At this value,
the optimal choices p‚àó and x‚àó are the same in the two sub-cases. Hence for a given n, p‚àó , x‚àó , and
Œò‚àó are continuous at Œ≤(n), p‚àó and Œò‚àó are strictly monotonically increasing in Œª, and x‚àó and

x‚àó
n

are weakly monotonically increasing in Œª.
Optimal Choice of Number of Classrooms
Now consider the issue of which integer number of classrooms schools choose. Let
œÄÃÉ(n, Œª) ‚â° œÄ(p‚àó (n, Œª), x‚àó (n, Œª); n, Œª)

(28)

be school Œª‚Äôs optimal proÔ¨Åt when the number of classrooms is Ô¨Åxed at n, where p‚àó (n, Œª) and
x‚àó (n, Œª) are given by (20a)-(20b) for Œª ‚â§ Œ≤(n) and (24a)-(24b) for Œª > Œ≤(n). DeÔ¨Åne Œõk to be the
set of all schools for which a given integer k is the optimal number of classrooms:
Œõk = {Œª : œÄÃÉ(k, Œª) ‚â• œÄÃÉ(j, Œª) ‚àÄ j = k, j ‚àà

}

(29)

The following lemma characterizes the sets Œõk :
Lemma 1. There exist unique positive integers k and k and a unique set of critical values
ŒΩk , ŒΩk+1 , ...ŒΩk‚àí1 , ŒΩk such that:
Œõk = {Œª : ŒΩk‚àí1 ‚â§ Œª < ŒΩk } for k = k, k + 1, ..., k
where Œª = ŒΩk‚àí1 < ŒΩk < ... < ŒΩk‚àí1 < ŒΩk = Œª.
The proof is in Appendix A.2.3. The lemma indicates that the set of schools can be partitioned
into a set of intervals, [ŒΩk‚àí1 , ŒΩk ), [ŒΩk , ŒΩk+1 ), [ŒΩk+1 , ŒΩk+2 ) etc., where the optimal integer number of
classrooms is k in the Ô¨Årst interval, k + 1 in the next, k + 2 in the next, and so on. Within each
of the subsets Œõk the above results for Ô¨Åxed n hold.

15

Appendix A.2.4 shows that at the critical values ŒΩk , ŒΩk+1 , ..., ŒΩk‚àí1 , enrollment is strictly increasing, class size is weakly decreasing, and average willingness to pay is strictly increasing in
Œª.20 The fact that average willingness to pay is strictly increasing at the critical values, and
that it is strictly increasing between the critical values (refer to (21b) and (26c)), means that in
equilibrium average willingness to pay Œò‚àó is monotonically increasing in Œª for all Œª.
Note that there is no guarantee that the value of Œª at which the class-size cap starts to bind
for a given integer k, Œ≤(k), is to the left of the value of Œª at which it becomes optimal to add an
additional classroom, ŒΩk . In the empirical part of the paper, we present evidence consistent with
the hypothesis that Œ≤(k) < ŒΩk for low values of k.
Figure 3 plots class size against Œª for the case where Œ≤(k) < ŒΩk for k = 1 and k = 2 but not
thereafter. The curve roughly resembles the curve for the divisible-classrooms case (Figure 2),
but with an overlaid saw-tooth pattern generated by the integer constraint. The Ô¨Ågure exhibits
an approximately inverted-U relationship between class size and Œª. It results from the interaction
of two eÔ¨Äects: (1) conditional on a value of n, class size is increasing in Œª, since greater values of Œª
make schools better able to Ô¨Åll their classrooms; and (2) across values of n, class size is declining
in Œª, since greater Œª leads schools to increase the number of classrooms, reducing class size.
The inverted-U relationship between class size and Œª is not itself testable, because Œª is unobserved. But since Œò‚àó is strictly increasing in Œª for all Œª, we would also expect an inverted-U
relationship in equilibrium between class size and Œò‚àó . This gives us our Ô¨Årst testable implication:
Testable Implication 1 In equilibrium, there is an approximately inverted-U relationship between class size and average household income.
Figure 3 also illustrates that schools between Œ≤(1) and ŒΩ1 have enrollment 45 and schools
between Œ≤(2) and ŒΩ2 have enrollment 90. Intuitively, in these regions schools raise tuition rather
than incur the Ô¨Åxed cost of starting a new classroom.21 Although we do not model the possibility
explicitly, one can easily imagine that in the presence of stochasticity in demand and menu costs of
changing tuition, schools might turn away potential students for the same reason.22 Since average
‚àÇp
The direction of the change in price at each critical value is ambiguous in this case. The slope ‚àÇŒª
is greater when
the class-size cap binds than when it does not bind, since higher Œª leads schools to raise prices to keep class-size
pegged at 45. Consequently, price may be greater to the left of ŒΩk than to the right.
21
Appendix A.2.2 shows that for a given number of classrooms, tuition (p) is more steeply sloped in Œª in the
region where the class-size cap binds than in the region where the cap does not bind.
22
In Chile, private schools have wide latitude regarding student selection, and can turn away students for reasons
ranging from the desire to maintain a given class size, to the desire to maintain religious uniformity.
20

16

household income is monotonically increasing in Œª, the stacking implies discontinuous changes in
average household income with respect to enrollment at enrollments of 45, 90, and so on.23 More
generally, we have our second testable implication:
Testable Implication 2 In equilibrium, schools may stack at enrollments that are multiples of
45, implying discontinuous changes in average household income with respect to enrollment
at those points.
It is worth considering brieÔ¨Çy what our model predicts for private unsubsidized schools, the
elite private schools that do not accept vouchers and are not subject to the class-size cap. In the
context of the model, the results for unsubsidized schools would be similar to those for voucher
schools in the sub-cases where the class-size cap is not binding. That is, if we were to set the
value of the voucher to zero and suppose that Œ≤(k) > ŒΩk for all k, then the results in sub-cases
1.1 and 2.1 would carry over to unsubsidized schools. In this case, the Ô¨Ågure analogous to Figure
3 would not have the Ô¨Çat regions between Œ≤(1) and ŒΩ1 and between Œ≤(2) and ŒΩ2 .

4

Data

To examine our model‚Äôs implications, we draw on two sources of information. The Ô¨Årst is schoollevel administrative information on grade-speciÔ¨Åc enrollments and the number of classrooms from
the Chilean Ministry of Education; we use these data to calculate average class sizes in each grade.
The second source of information is the SIMCE testing system,24 which tracks schools‚Äô math and
language performance. SIMCE data are available at the school level since 1988. Since 1997, they
also exist at the individual level and include information on students‚Äô household income, parental
schooling, and other characteristics from a parental questionnaire sent home with students.
Depending on the year, the SIMCE tests 4th , 8th , or 10th graders. We focus on the 4th grade
because as indicated above, class size is best-deÔ¨Åned in early primary grades. We focus on the
2002 cross section because it is the most recent 4th grade testing round for which we have data.
23

Technically speaking, as long as the class-size cap is not binding to the right of the critical value, ŒΩk , the
model predicts a discontinuity in Œò‚àó even in the absence of stacking. Average willingness to pay in equilibrium
is a smooth, monotonically increasing function of class size. (See the discussions leading up to (58c) and (63) in
Appendix A.2.4.) Class size jumps discontinuously at the critical values ŒΩk . Hence Œò‚àó must also jump at ŒΩk . Our
view, however, is that the discontinuity due to stacking is the more empirically important one.
24
SIMCE, which stands for Sistema de MedicioÃÅn de la Calidad de la EducacioÃÅn (Educational Quality Measurement
System), is Chile‚Äôs standardized testing program.

17

We note, however, that the general conclusions we obtain emerge in other cross-sections we have
analyzed (for instance, the 1999 4th grade and the 2004 8th grade waves).
Table 1 presents descriptive statistics for public schools, private voucher schools and public
unsubsidized schools. As noted in Section 2, the table indicates that private unsubsidized schools
serve a very diÔ¨Äerent demographic group than either the voucher or the public schools. Household
income and parents‚Äô schooling are markedly higher in the unsubsidized schools. Students‚Äô test
scores, unsurprisingly, are highly correlated with these measures of socioeconomic status.

5

Results

We now take our two testable implications to the data. We review each implication, discuss how
it relates to the existing literature, and present the empirical results.

5.1

Class Size and Income in Cross-Section: The Inverted U

The Ô¨Årst testable prediction is an inverted-U relationship between class size and average household
income. The upward-sloping portion reÔ¨Çects the fact that low-Œª schools may have trouble Ô¨Ålling
their existing classrooms to achieve the desired class size. The downward-sloping portion reÔ¨Çects
the fact that higher-Œª schools Ô¨Ånd it proÔ¨Åtable to restrict class size to appeal to richer households.
These mechanisms are consistent with anecdotal evidence from Chile, where there is a widespread
perception that many lower-quality voucher schools are small ‚Äúmom and pop‚Äù operations that
struggle to Ô¨Åll their classrooms. In contrast, voucher schools run by larger Ô¨Årms have suÔ¨Écient
demand to operate multiple classrooms, and are generally perceived to be of higher quality.
Panel A in Figure 4 plots class size against log average household income among urban voucher
schools. The central line plots Ô¨Åtted values of a locally weighted regression of class size on
log income, and the outer lines plot point-wise conÔ¨Ådence intervals generated by a bootstrap
procedure.25 A clear inverted-U pattern is evident. Panel B produces a similar conclusion, using
mothers‚Äô schooling rather than income on the x-axis. Average class size rises with mothers‚Äô
schooling up to about the point where the average mother is a high school graduate, and declines
thereafter.
25

Using a parametric regression with a Ô¨Åfth-order polynomial produces very similar results, both for the conditional mean and the conÔ¨Ådence intervals.

18

A possible concern with these Ô¨Ågures is that the inverted-U pattern may reÔ¨Çect the aggregation
of schools across regions, rather than cross-sectional patterns within markets. To examine this
possibility, Table 2 reports simple regressions of class size on polynomials in log income (Panel A)
and mother‚Äôs schooling (Panel B) among urban voucher schools. To facilitate interpretation, we
use second-order polynomials. Column 1 reports results without region dummies, and Columns 2
and 3 include dummies for 13 regions and 318 municipalities, respectively. The quadratic term is
uniformly negative and signiÔ¨Åcant, and not much aÔ¨Äected by the regional controls. That is, the
inverted-U pattern holds even within narrowly deÔ¨Åned urban markets.
The inverted-U Ô¨Ånding is relevant to the literature on the eÔ¨Äect of class size on student
achievement. In this literature, it is common to see cross-sectional estimates that are of the
‚Äúwrong‚Äù sign or essentially equal to zero. Since achievement tends to be strongly correlated with
household income and since income is often unobserved (or is observed with error), the invertedU pattern suggests that cross-sectional regressions are likely to understate the eÔ¨Äect of class size
reductions among lower-income voucher schools and to overstate it among higher-income ones.26
Previous work has revealed positive correlations between class size and enrollment and between
enrollment and household socioeconomic status among public schools in Israel (Angrist and Lavy,
1999) and Bolivia (Urquiola, 2006),27 but to our knowledge our paper is the Ô¨Årst to provide either
a theoretical rationale or empirical evidence for a non-linear relationship between class size and
household income. We conjecture that the inverted-U pattern is likely to arise among private
primary schools in other countries.

5.2

Stacking at Multiples of Class-Size Cap

Our second testable implication is related to regression discontinuity (RD) designs that exploit the
discontinuous relationship between enrollment and class size induced by class-size caps.28 Figure
5 shows that the Chilean setting appears to be a promising one for an RD-based evaluation of
the eÔ¨Äect of class size. The solid line plots the relation between class size and enrollment that
26

Consistent with Figure 4, for instance, we Ô¨Ånd that a cross-sectional bi-variate regression of test scores on class
size among all urban voucher schools results in an insigniÔ¨Åcant point estimate. If the sample is restricted to schools
with mean mothers‚Äô schooling below 12 years of age, however, the coeÔ¨Écient is positive and signiÔ¨Åcant. If it is
restricted to schools with a mean above 12, it is negative and signiÔ¨Åcant at the 10 percent level.
27
Mizala and Romaguera (2002) present evidence of a positive correlation between enrollment and household
socioeconomic status in Chile.
28
For overviews and history of the RD design, see Angrist and Krueger (1999), van der Klaauw (2002), and
Shadish, Cook, and Campbell (2002).

19

would be observed if schools mechanically expanded class size with enrollment until reaching the
class-size cap, i.e. if class size were determined by:
 x p
n

=

int

x
 x‚àí1 
45

(30)

+1

where the superscript p indicates this is the predicted level. This results in a ‚Äúsaw-tooth‚Äù pattern
in which class size increases one for one with enrollment until, at 46, a new class is added and
average class size falls to 23, with other discontinuities observed at 90, 135, etc. Using data for
urban voucher schools for 2002, the circles plot enrollment-cell means of class size. Aggregated to
the enrollment-cell level as in this Ô¨Ågure, a regression of actual on predicted class size produces
an R2 greater than 0.9‚Äîa clear ‚ÄúÔ¨Årst stage‚Äù.29
The idea behind RD designs, originally proposed by Thistlewaite and Campbell (1960), is that
discontinuities like those in Figure 5 can be used to identify the causal eÔ¨Äect of class size even if
enrollment is systematically related to factors that aÔ¨Äect students‚Äô outcomes. Intuitively, if enrollment is smoothly related to student characteristics and other factors that aÔ¨Äect achievement at
multiples of the class-size cap, then for example students in schools with enrollments of 45 provide
an adequate control group for those in schools with enrollments of 46. In such a case, diÔ¨Äerences
in students‚Äô performance can be attributed to the very diÔ¨Äerent class sizes they experience.
More formally, consider a standard RD model, assuming one class-size cut-oÔ¨Ä and a homogeneous eÔ¨Äect of class size on test scores (van der Klaauw, 2002):
T Si = Œ≥ E(CSi |Xi ) + f (Xi ) + ui
0 ) + k(Xi )
E(CSi |Xi ) = Œ∑ 1(Xi ‚â• X

(31a)
(31b)

where i indexes schools, T Si is the average 4th -grade test score in school i, CSi is average 4th 0 is the value of the class-size cut-oÔ¨Ä (i.e. 45), f (¬∑)
grade class size, Xi is 4th -grade enrollment, X
and k(¬∑) are Ô¨Çexible functions of enrollment, and E(Œµi |Xi ) = 0. In the present setting this model
corresponds to a ‚Äúfuzzy‚Äù (as opposed to ‚Äúsharp‚Äù) regression discontinuity design, since, as Figure
5 indicates, enrollment aÔ¨Äects but does not perfectly explain class size.
0 and the mean of class size
In the context of this model, if f (¬∑) and k(¬∑) are continuous at X
29

For visual clarity, Figure 5 excludes schools that declare 4th grade enrollments above 180 students (less than
two percent of all schools), thus focusing on only the Ô¨Årst three discontinuities in the enrollment/class size relation.

20

0 , then the class-size eÔ¨Äect, Œ≥, is nonconditional on enrollment, E(CSi |Xi ) is discontinuous at X
parametrically identiÔ¨Åed at the cut-oÔ¨Ä (Hahn, Todd, and van der Klaauw, 2001). Intuitively, in a
small enough neighborhood around the cut-oÔ¨Ä, f (¬∑) and k(¬∑) are constant and any discontinuity in
test scores can be attributed to the discontinuity in the conditional mean of class size. In practice,
one rarely has enough data in neighborhoods around the cut-oÔ¨Ä to estimate Œ≥ precisely. As Lee
and Card (forthcoming) point out, if Xi is discrete, as in our case, one cannot estimate the classsize eÔ¨Äect non-parametrically even with an inÔ¨Ånite amount of data, and one must therefore choose
parametric speciÔ¨Åcations for f (¬∑) and k(¬∑). If these are speciÔ¨Åed correctly then they capture all
dependence of class size and test scores on enrollment away from the cut-oÔ¨Ä and the instrumentalvariable (IV) procedure corresponding to (31a)-(31b) will consistently estimate Œ≥, eÔ¨Äectively using
only the discontinuity in E(CSi |Xi ). In our baseline speciÔ¨Åcations, we use four class-size cut-oÔ¨Äs,
rather than just one as in (31b), and piecewise linear splines (with ‚Äúkinks‚Äù at the values of the
cut-oÔ¨Äs) for f (¬∑) and k(¬∑).30
Table 3 reports the results of a standard RD analysis using school-level data from 2002.
Column (1) presents the Ô¨Årst-stage regression of class size on indicators for whether enrollment is
above the Ô¨Årst four cut-oÔ¨Äs, along with the piecewise linear spline for enrollment. The coeÔ¨Écients
on the cut-oÔ¨Ä indicators are estimates of the average decline in class size at those breaks.31
Consistent with the visual evidence in Figure 5, the Ô¨Årst one suggests that class size drops by
about 17 students at the Ô¨Årst threshold. The declines at the Ô¨Årst three of the four cut-oÔ¨Äs are
statistically signiÔ¨Åcant, but become progressively smaller.32 In this speciÔ¨Åcation, all standard
errors are clustered by enrollment levels, as Lee and Card (forthcoming) suggest is appropriate
when the assignment variable (here enrollment) is discrete.
There is prima-facie evidence that the standard RD strategy would generate signiÔ¨Åcant results. Figure 6 presents ‚Äúraw‚Äù enrollment-cell means of math and language test scores, along with
the Ô¨Åtted values of a locally weighted regression calculated within each enrollment segment. Particularly around the Ô¨Årst cut-oÔ¨Ä, which accounts for the greatest density of schools, the discrete
30
We return to the possibility of using higher order polynomials below. We note that the piecewise splines are
appropriate to the extent that equation (30) suggests that if the class size rule were strictly applied, the slope of
the relationship between class size and enrollment would be diÔ¨Äerent in each segment.
31
For the sake of space, Table 3 and all subsequent ones exclude the small number of schools that declare 4th
grade enrollments above 225 (less than one percent of all schools), thus focusing on only the Ô¨Årst four discontinuities
in the enrollment/class size relation.
32
Although we omit the results, adding controls for individuals‚Äô characteristics has essentially no eÔ¨Äect on the
key coeÔ¨Écients.

21

reduction in class size is accompanied by an increase in average test scores. This observation is
also borne out by the regression results. Columns 2-3 of Table 3 present reduced-form regressions
of average math and language scores, showing positive and signiÔ¨Åcant increases in scores at the
Ô¨Årst cut-oÔ¨Ä, and positive (although not signiÔ¨Åcant) increases at subsequent ones. Columns 4-5
report IV speciÔ¨Åcations, where dummy variables for the Ô¨Årst four cut-oÔ¨Äs are used as instruments
for class size. In both columns, class size appears to have a negative and signiÔ¨Åcant eÔ¨Äect on test
scores.
Focusing more narrowly around the discontinuities as in van der Klaauw (2002), Columns 1-3
of Table 4 present IV results for bands of 5 students (panels A and C for math and language,
respectively) and 3 students (panels B and D) around the Ô¨Årst three breaks, omitting the piecewise
spline in enrollment.33 These are equivalent to simple Wald estimates of the eÔ¨Äect of class size
within the bands around each cut-oÔ¨Ä.34 Column 4 produces similar estimates pooling all three
local samples.35 In these pooled samples, the point estimates of the eÔ¨Äect of class size on test
scores are uniformly negative, although not statistically signiÔ¨Åcant.36
One might be tempted to interpret Tables 3 and 4 as producing consistent estimates of the
causal eÔ¨Äect of class size on achievement. If the second testable implication of our model is correct,
however, then the smoothness conditions required for valid RD-based inference are likely to be
violated. Recall that the theoretical model predicts a non-negligible mass of schools stacking at
enrollments of 45; in Figure 3, for instance, all schools with productivity parameters between Œ≤(1)
and ŒΩ1 have enrollment 45, and all those between Œ≤(2) and ŒΩ2 have enrollment 90. Panel A of
Figure 7 presents a histogram of 4th grade enrollments among urban voucher schools, and the
evidence of such stacking is clear: more than 5 times as many schools report enrollments of 45 as
report enrollments of 46. The same happens at higher cut-oÔ¨Äs as well: more than 7 times as many
schools have 90 4th graders as have 91, for instance.37 Panel B shows that there is no evidence
of stacking among private unsubsidized schools, which are not subject to the class-size cap. It
appears that the stacking among voucher schools is not due to technological factors unrelated to
33

The somewhat erratic results in Column 2 are due to outliers close to the 90-student cut-oÔ¨Ä; when we replicate
the results using 1999 data, the point estimates and standard errors around the second cut-oÔ¨Ä are in line with those
around the other cut-oÔ¨Äs.
34
In other words, the point estimates could be replicated by dividing the diÔ¨Äerence in average test scores between
the schools above and below the cut-oÔ¨Ä within each band, by the diÔ¨Äerence in their respective average class sizes.
35
In this case dummies for whether enrollments are above the three cut-oÔ¨Äs, 1{x > 45}, 1{x > 90}, and 1{x >
135}, as well as three sample-speciÔ¨Åc intercepts serve as instruments; see van der Klaauw (2002).
36
Note that clustering by enrollment level, as suggested by Lee and Card (forthcoming), lowers signiÔ¨Åcance levels.
37
Similar stacking occurs if 1st or 8th grade data are used.

22

the cap. In short, Figure 7 provides a clear illustration of what McCrary (forthcoming) terms
manipulation of the running variable‚Äîenrollment in this case.
Recall also that the model predicts that higher-income households on average sort into higher-Œª
schools. If so, then the stacking will generate discontinuities in the relationship between enrollment
and student characteristics close to the cut-oÔ¨Ä points, violating the smoothness assumptions
underlying the RD approach. Again, Figure 3 illustrates the intuition: because of the stacking,
the average value of Œª among schools at the cap is strictly less than the average value just above the
cap; since average household income is strictly monotonically increasing in Œª (see the discussion
in Section 3.4 above), the stacking generates discontinuous changes in household income at the
class-size cut-oÔ¨Äs.

38

Panel A of Figure 8 presents enrollment cell means of household income, along with the Ô¨Åtted
values of a locally weighted regression calculated within each enrollment segment. There is visual
evidence that income changes discontinuously around the Ô¨Årst cut-oÔ¨Ä‚Äîschools just to the right
contain students who come from wealthier households. Panel B shows, not surprisingly, that they
also have students with higher average mothers‚Äô schooling‚Äîas much as a full year. While jumps
at the subsequent cut-oÔ¨Ä points are less evident, the clear discontinuities at the Ô¨Årst one (which
provides the bulk of observations, as shown in Figure 7) are suÔ¨Écient to cast doubt on the RD
approach in this context.
Columns 1-3 of Table 5 present regressions of household characteristics on the piecewise linear
spline in enrollment and indicator variables for the class-size cut-oÔ¨Äs. The results are consistent
with the visual evidence from Figure 8. In particular, they conÔ¨Årm that mothers‚Äô schooling,
fathers‚Äô schooling and income display substantial and statistically signiÔ¨Åcant jumps at the Ô¨Årst
enrollment cut-oÔ¨Ä; the coeÔ¨Écients for subsequent cut-oÔ¨Äs are positive but not signiÔ¨Åcant. This is
further evidence that the continuity assumption on the function f (Xi ) in (31a)‚Äîwhich is presumed
to capture the eÔ¨Äect of all variables that vary with enrollment except class size‚Äîis violated.
For another indication that something is amiss in the RD design, consider the sensitivity
of the estimates of the class-size eÔ¨Äect to the inclusion of socioeconomic controls. If the RD
approach were valid in this context, then including socioeconomic controls in (31a)-(31b) would
38

It is worth emphasizing that stacking alone may not violate the RD assumptions in our context. If student
performance depended only on class size and not directly on Œª, and there were no sorting, then the students on one
side of the class-size cut-oÔ¨Ä would still serve as a valid control group for those on the other side. The violation of
the RD assumptions arises from the interaction of the stacking and the endogenous sorting of households.

23

have little eÔ¨Äect on the estimate of Œ≥. If the conditional means of the controls with respect to
enrollment were continuous, then the component of each control that varied with enrollment would
be captured by k(Xi ) and f (Xi ), and the component that was orthogonal to enrollment would also
be orthogonal to the instrument. In fact, Columns 4-5 of Table 5 show that the IV estimates from
Columns 4-5 of Table 3 are sensitive to the inclusion of socioeconomic controls. The coeÔ¨Écient
on class size for the math-score speciÔ¨Åcation drops in magnitude from -0.7 and signiÔ¨Åcant (Table
3, Column 4) to -0.1 and insigniÔ¨Åcant (Table 5, Column 4) with the inclusion of the controls.
For the language-score speciÔ¨Åcation, the drop is from -0.6 to -0.1. The coeÔ¨Écients on mothers‚Äô
schooling and income are strongly signiÔ¨Åcant in the test-score regressions; fathers‚Äô schooling is
signiÔ¨Åcant at the 10 percent level in the math-score speciÔ¨Åcation.39 This is clear evidence that
the exclusion restriction required for the IV estimates in Table 3 is invalid: the cut-oÔ¨Ä dummies
used as instruments are correlated with household characteristics that are omitted from the Table
3 speciÔ¨Åcation, and those characteristics are in turn correlated with the test-score outcomes.
Finally, we explore to extent to which the observed discontinuities in the treatment and outcome variables, and in other covariates, are robust to more Ô¨Çexible speciÔ¨Åcations of k(Xi ) and
f (Xi ) in (31a)-(31b). While the literature has not produced a consensus on the correct speciÔ¨Åcation of these functions,40 two practical guidelines for credible RD estimation seem uncontroversial.
First, there should not be evidence of discontinuities in relevant co-variates at the cut-oÔ¨Äs using
the same speciÔ¨Åcation of f (Xi ) used in the outcome equation (31a), as for instance we found in
Columns 1-3 of Table 5. Second, it is worrisome if the results, either for the estimates of Œ≥ or
for the absence of discontinuities in other co-variates, are not robust to the choice of functional
form. To investigate this, Table 6 presents reduced-form regressions analogous to those in columns
1-3 of Tables 3 and 5, using higher order speciÔ¨Åcations of the piecewise control function, as in
van der Klaauw (2002).41 Note that the Ô¨Årst stage (Panel A) is not robust to the addition of
more Ô¨Çexible controls‚Äîthe estimated declines in class size become small or even positive at some
cut-oÔ¨Äs. This is somewhat surprising given the apparent strength of the Ô¨Årst stage observed in
39
These results are qualitatively similar if we use the predicted class size in equation (30) as an instrument for
class size in place of the piecewise linear spline. Additionally, although we omit the exercise for the sake of space,
we note that the simple within-band IV results in Table 4 are similarly sensitive to the addition of controls for
socioeconomic status (results available from the authors).
40
In their very useful review of practical issues in implementing RD designs, for instance, Imbens and Lemieux
(forthcoming) do not make a speciÔ¨Åc recommendation.
41
For the sake of space we only report the coeÔ¨Écients on the Ô¨Årst two cut-oÔ¨Ä indicators.

24

Figure 5.42 But more importantly for our story, note that the discontinuous jumps in test scores
and socioeconomic status (panels B-F) are robust and, if anything, grow stronger as one moves
to the right in the table. In short, Table 6 reaÔ¨Érms that sorting across the cut-oÔ¨Äs appears too
strong to allow for reliable implementation of an RD approach.
Lee and Card (forthcoming) propose an additional practical procedure to guide the choice of
polynomial for f (Xi ) in the outcome equation in a context such as ours in which the running
variable is discrete. The test is based on a goodness-of-Ô¨Åt statistic for a ‚Äúrestricted‚Äù low-order
polynomial speciÔ¨Åcation relative to an ‚Äúunrestricted‚Äù model with a dummy for each value of
the discrete running variable. This is not a deÔ¨Ånitive test‚ÄîLee and Card note that rejection of a
given polynomial does not necessarily imply that the corresponding estimate of Œ≥ is inconsistent‚Äî
but our conÔ¨Ådence in a chosen polynomial speciÔ¨Åcation increases if it cannot be rejected by this
Lee-Card test. For the outcome equation (31a) in our case, the test does not reject any of
the speciÔ¨Åcations in columns 1-4 of Table 6. This is consistent with the Ô¨Ånding that adding
higher-order polynomial terms does not eliminate the discontinuities in the outcome variables
and co-variates in Panels B-F of Table 6.
To summarize, our results provide a concrete illustration of Lee‚Äôs (forthcoming) observation
that ‚Äúeconomic behavior can corrupt the RD design.‚Äù It is worth emphasizing that our results
apply to settings in which for-proÔ¨Åt schools can set prices and directly inÔ¨Çuence their enrollments,
and in which households enjoy substantial freedom to sort between schools; we have no reason to
believe that they extend to public-school contexts typically studied. For instance, Angrist and
Lavy (1999) point out that in the Israeli public school context they analyze, pupils are required
to attend their neighborhood schools, and schools in turn must accept applicants.43 Further,
migration and immigration may render it diÔ¨Écult for schools to predict enrollments, and private
participation is limited to orthodox schools.44
42

We have veriÔ¨Åed that other years and grades of the administrative enrollment data produce similar results.
Similarly, in some exercises Urquiola (2006) considers Bolivian schools in rural towns in which school choice is
likely to be very limited.
44
The observation that Israeli institutions prevent strategic behavior of the kind we emphasize in this paper
is consistent with the Ô¨Ånding of Angrist and Lavy (1999) that, controlling for secular enrollment eÔ¨Äects, adding
controls for the proportion of students with low socioeconomic backgrounds does not aÔ¨Äect their key estimates. For
an alternative approach to checking for discontinuities in co-variates at discontinuities, see McEwan and Shapiro
(forthcoming).
43

25

6

Conclusion

The model developed in this paper oÔ¨Äers an explanation for two distinct empirical patterns observed in the Chilean data. First, there is an inverted-U cross-sectional relationship between class
size and household income, which is likely to bias non-experimental estimates of the eÔ¨Äect of
class size. Second, schools‚Äô enrollments tend to stack at multiples of the class-size cap, which, in
conjunction with the sorting of households into schools of diÔ¨Äerent quality, generates discontinuities in household characteristics at these points. These in turn violate the assumptions required
for regression-discontinuity analyses of class size. The fact that a single, relatively parsimonious
model can account for these two distinct phenomena suggests that it is a useful way to organize our
thinking about class size and sorting in liberalized education markets. Our Ô¨Åndings recommend
caution in interpreting cross-sectional and RD estimates of the eÔ¨Äect of class size in such settings,
and underline the value of randomized experiments to estimate class-size eÔ¨Äects in contexts where
schools are free to set prices and/or turn away students, and households are free to sort between
schools.45
Our results also recommend caution more broadly in the application and interpretation of RD
designs. It has become increasingly common to use discontinuities in the application of regulations
to estimate causal eÔ¨Äects of those regulations. But in contexts where economic agents interact
freely in markets, such discontinuities are likely to generate discontinuities along more than one
dimension, undermining the RD approach. This general observation has been made before, by
Lee (forthcoming) and others. This paper has sought to provide a concrete illustration of such
behavior, in a setting with heterogeneity and sorting on two sides of an important market.

References
Altonji, J. G., C. Huang, and C. R. Taber (2005): ‚ÄúEstimating the Cream Skimming EÔ¨Äect of
Private School Vouchers on Public School Students,‚Äù Unpub. paper, Northwestern University.
Anderson, S., and A. de Palma (2001): ‚ÄúProduct Diversity in Asymmetric Oligopoly: Is the Quality
of Consumer Goods Too Low?,‚Äù Journal of Industrial Economics, 49(2), 113‚Äì135.
Anderson, S., A. de Palma, and J.-F. Thisse (1992): Discrete-Choice Theory of Product DiÔ¨Äerentiation. MIT Press, Cambridge, MA.
45

Banerjee, Cole, DuÔ¨Ço, and Linden (forthcoming) present randomized evaluations of two programs to increase
teacher attention per student in India.

26

Angrist, J., and A. Krueger (1999): ‚ÄúEmpirical Strategies in Labor Economics,‚Äù in Handbook of Labor
Economics, ed. by O. Ashenfelter, and D. Card, vol. 3A. Elsevier Science.
Angrist, J. D., and V. Lavy (1999): ‚ÄúUsing Maimonides‚Äô Rule to Estimate the EÔ¨Äect of Class Size on
Scholastic Achievement,‚Äù Quarterly Journal of Economics, 114(2), 533‚Äì575.
Asadullah, M. N. (2005): ‚ÄúThe EÔ¨Äect of Class Size on Student Achievement:
Bangladesh,‚Äù Applied Economics Letters, 12(4), 217 ‚Äì 221.

Evidence from

Banerjee, A., S. Cole, E. Duflo, and L. Linden (forthcoming): ‚ÄúRemedying Education: Evidence
from Two Randomized Experiments in India,‚Äù Forthcoming in Quarterly Journal of Economics.
Bartle, R. G. (1976): The Elements of Real Analysis. John Wiley & Sons, New York, 2nd edition edn.
Bayer, P., R. McMillan, and K. Rueben (2004): ‚ÄúAn Equilibrium Model of Sorting in an Urban
Housing Market,‚Äù NBER Working Paper # 10865.
Bressoux, P., F. Kramarz, and C. Prost (2005): ‚ÄúTeachers‚Äô Training, Class Size and Students‚Äô
Outcomes: Evidence from Third Grade Classes in France,‚Äù Unpub. paper, CREST.
Browning, M., and E. Heinesen (2003): ‚ÄúClass Size, Teacher Hours and Educational Attainment,‚Äù
Centre for Applied Microeconometrics Working Paper 2003-15, Institute of Economics, University of
Copenhagen.
Caucutt, E. M. (2002): ‚ÄúEducational Vouchers When There are Peer Group EÔ¨Äects: Size Matters,‚Äù
International Economic Review, 43(1), 195 ‚Äì 222.
Clotfelter, C. T. (1999): ‚ÄúPublic School Segregation in Metropolitan Areas,‚Äù Land Economics, 75(4),
487‚Äì504.
Dixit, A. K. (1976): Optimization in Economic Theory. Oxford University Press, Oxford, UK.
Dobbelsteen, S., J. Levin, and H. Oosterbeek (2002): ‚ÄúThe Causal EÔ¨Äect of Class Size on Scholastic
Achievement: Distinguishing the Pure Class Size EÔ¨Äect from the EÔ¨Äect of Changes in Class Composition,‚Äù Oxford Bulletin of Economics and Statistics, 64(1), 17‚Äì38.
Elacqua, G. (2005): ‚ÄúHow Do For-ProÔ¨Åt Schools Respond to Voucher Funding? Evidence from Chile,‚Äù
Occasional Paper, National Center for Study of Privatization in Education, Teachers College, Columbia
University.
Epple, D., D. Figlio, and R. Romano (2002): ‚ÄúCompetition Between Private and Public Schools:
Testing StratiÔ¨Åcation and Pricing Predictions,‚Äù Unpub. paper, University of Florida.
Epple, D., and R. Romano (1998): ‚ÄúCompetition Between Private and Public Schools, Vouchers, and
Peer Group EÔ¨Äects,‚Äù American Economic Review, 88(1), 33‚Äì62.
(2002): ‚ÄúEducation Vouchers and Cream Skimming,‚Äù NBER Working Paper #9354.
Epple, D., R. Romano, and H. Sieg (2006): ‚ÄúAdmission, Tuition, and Financial Aid Policies in the
Market for Higher Education,‚Äù Econometrica, 74(4), 885 ‚Äì 928.
Ferreyra, M. M. (2007): ‚ÄúEstimating the EÔ¨Äects of Private School Vouchers in Multi-District
Economies,‚Äù American Economic Review, 97(3), 789‚Äì817.
Gabszewicz, J. J., and J.-F. Thisse (1979): ‚ÄúPrice Competition, Quality, and Income Disparities,‚Äù
Journal of Economic Theory, 20, 340‚Äì359.
Hahn, J., P. Todd, and W. van der Klaauw (2001): ‚ÄúIdentiÔ¨Åcation and Estimation of Treatment
EÔ¨Äects with a Regression-Discontinuity Design,‚Äù Econometrica, 69(1), 201‚Äì209.
Hanushek, E. A. (1995): ‚ÄúInterpreting Recent Research on Schooling in Developing Countries,‚Äù World
Bank Research Observer, 10, 227‚Äì246.
(2003): ‚ÄúThe Failure of Input-Based Schooling Policies,‚Äù Economic Journal, 113(485), F64‚ÄìF98.

27

Hoxby, C. M. (2000): ‚ÄúThe EÔ¨Äects of Class Size on Student Achievement: New Evidence from Population
Variation,‚Äù Quarterly Journal of Economics, 115(4), 1239‚Äì1285.
Hsieh, C.-T., and M. Urquiola (2006): ‚ÄúThe EÔ¨Äects of Generalized School Choice on Achievement
and StratiÔ¨Åcation: Evidence from Chile‚Äôs School Voucher Program,‚Äù Journal of Public Economics, 90,
1477‚Äì1503.
Imbens, G., and T. Lemieux (forthcoming): ‚ÄúRegression Discontinuity Designs: A Guide to Practice,‚Äù
Forthcoming in Journal of Econometrics.
Jakubowski, M., and P. Sakowski (2005): ‚ÄúQuasi-Experimental Estimates of Class Size EÔ¨Äect in
Primary Schools in Poland,‚Äù Unpub. paper, Warsaw University, Faculty of Economics.
Kremer, M. R. (1995): ‚ÄúResearch on Schooling: What We Know and What We Don‚Äôt: A Comment,‚Äù
World Bank Research Observer, 10(2), 247‚Äì254.
Krueger, A. B. (2003): ‚ÄúEconomic Considerations and Class Size,‚Äù Economic Journal, 113(485), F34‚Äì63.
Lazear, E. P. (2001): ‚ÄúEducational Production,‚Äù Quarterly Journal of Economics, 116(3), 777‚Äì803.
Lee, D. S. (forthcoming): ‚ÄúRandomized Experiments from Non-Random Selection in U.S. House Elections,‚Äù Forthcoming in Journal of Econometrics.
Lee, D. S., and D. Card (forthcoming): ‚ÄúRegression Discontinuity Inference with SpeciÔ¨Åcation Error,‚Äù
Forthcoming in Journal of Econometrics.
Manski, C. (1992): ‚ÄúEducational Choice (Vouchers) and Social Mobility,‚Äù Economics of Education Review,
11(4), 351‚Äì369.
McCrary, J. (forthcoming): ‚ÄúManipulation of the Running Variable in the Regression Discontinuity
Design: A Density Test,‚Äù Forthcoming in Journal of Econometrics.
McEwan, P., and J. Shapiro (forthcoming): ‚ÄúThe BeneÔ¨Åts of Delayed Primary School Enrollment:
Discontinuity Estimates Using Exact Birth Dates,‚Äù Forthcoming in Journal of Human Resources.
McFadden, D. (1974): ‚ÄúConditional Logit Analysis of Qualitative Choice Behavior,‚Äù in Frontiers in
Econometrics, ed. by P. Zarembka, pp. 105‚Äì142. Academic Press, New York.
Mizala, A., and P. Romaguera (2002): ‚ÄúEquity and Educational Performance,‚Äù Economƒ±ÃÅa, 2(2), 219‚Äì
262.
Mussa, M., and S. Rosen (1978): ‚ÄúMonopoly and Product Quality,‚Äù Journal of Economic Theory, 18,
301‚Äì317, a.
Nechyba, T. J. (2003): ‚ÄúCentralization, Fiscal Federalism, and Private School Attendance,‚Äù International
Economic Review, 44(1), 179‚Äì204.
Nesheim, L. (2002): ‚ÄúEquilibrium Sorting of Heterogeneous Consumers Across Locations: Theory and
Empirical Implications,‚Äù CEMMAP Working Paper CWP08/02, University College London.
Piketty, T., and M. Valdenaire (2006): ‚ÄúL‚ÄôImpact de la Taille des Classes sur la ReÃÅussite Scolaire
Dans les EÃÅcoles, ColleÃÄges et LyceÃÅes Fran cais [The Impact of Class Size on Student Success in French
Primary and Secondary Schools],‚Äù Les Dossiers, MinisteÃÄre de l‚ÄôEÃÅducation Nationale, no. 173.
Rothstein, J. (2006): ‚ÄúGood Principals or Good Peers? Parental Valuation of School Characteristics,
Tiebout Equilibrium, and the EÔ¨Äects of Inter-District Competition,‚Äù American Economic Review, 96(4),
1333‚Äì1350.
Shadish, W. R., T. D. Cook, and D. T. Campbell (2002): Experimental and Quasi-Experimental
Designs for Generalized Causal Inference. Boston.
Shaked, A., and J. Sutton (1982): ‚ÄúRelaxing Price Competition through Product DiÔ¨Äerentiation,‚Äù
Review of Economic Studies, 49, 3‚Äì13.
Thistlewaite, D., and D. Campbell (1960): ‚ÄúRegression Discontinuity Analysis: An Alternative to

28

the Ex-Post Facto Experiment,‚Äù Journal of Educational Psychology, 51, 309‚Äì317.
Urquiola, M. (2005): ‚ÄúDoes School Choice Lead to Sorting? Evidence from Tiebout Variation,‚Äù American Economic Review, 95(4), 1310‚Äì1326.
(2006): ‚ÄúIdentifying Class Size EÔ¨Äects in Developing Countries: Evidence from Rural Schools in
Bolivia,‚Äù Review of Economics and Statistics, 88(1).
van der Klaauw, W. (2002): ‚ÄúEstimating the EÔ¨Äect of Financial Aid OÔ¨Äers on College Enrollment: A
Regression Discontinuity Approach,‚Äù International Economic Review, 43(4), 1249‚Äì1287.
Verhoogen, E. A. (2007): ‚ÄúTrade, Quality Upgrading and Wage Inequality in the Mexican Manufacturing Sector,‚Äù CEPR discussion paper no. 6385, July.
WoÃàssmann, L. (2005): ‚ÄúEducational Production in Europe,‚Äù Economic Policy, (43), 445 ‚Äì 493.

29

A

Theory Appendix

In this appendix, to avoid clutter, we do not write explicitly the dependence of x, n and p on Œª,
of q(¬∑) on x, n and Œª, or of d(¬∑) and Œò(¬∑) on p and q, but this dependence should be understood.
As above, asterisks indicate equilibrium values.

A.1

Case 1: Divisible Classrooms

To solve the school‚Äôs optimization problem in this case, form the Lagrangian from (9), where the
constraints are (12) and (11):

x
‚àí 45
(32)
L(p, x, n; Œª) = (p ‚àí c + œÑ ) x ‚àí nFc ‚àí Fs ‚àí œÜ1 (x ‚àí d) ‚àí œÜ2
n
The Ô¨Årst-order conditions are:



d
‚àí
¬µ

‚àÇL
‚àÇp

= x + œÜ1

‚àÇL
‚àÇn

= ‚àíFc + œÜ1
=

‚àÇL
‚àÇx

=
=

‚àÇL
‚àÇœÜ1
‚àÇL
‚àÇœÜ2

‚â•
‚â•


=0

(33a)

x
‚àÇs(Œª|Œ∏, q, p)
M g(Œ∏) dŒ∏ + œÜ2
‚àÇn
n2
Œ∏


x
ŒªŒòd
+ œÜ2
=0
‚àíFc + œÜ1
¬µn
n2


 
Œ∏
‚àÇs(Œª|Œ∏, q, p)
1
p ‚àí c + œÑ ‚àí œÜ1 1 ‚àí
g(Œ∏) dŒ∏ ‚àí œÜ2
‚àÇx
n
Œ∏


 
ŒªŒòd
1
‚àí œÜ2
=0
p ‚àí c + œÑ ‚àí œÜ1 1 +
¬µx
n
‚àÇL
0, œÜ1 ‚â• 0, and œÜ1
=0
‚àÇœÜ1
‚àÇL
0, œÜ2 ‚â• 0, and œÜ2
=0
‚àÇœÜ2
Œ∏

(33b)

(33c)
(33d)
(33e)

where s(Œª|Œ∏, q, p) is given by (2). The interchanging of the partial derivatives and the integrals is
justiÔ¨Åed by a standard property of integrals (see e.g. Bartle (1976, Theorem 31.7, p. 245)) and
the continuity of s(Œª|Œ∏, q, p) and its partial derivatives.
‚àÇL
> 0, i.e. the demand constraint is not binding. Then (33a) implies
Suppose œÜ1 = 0 and ‚àÇœÜ
1
x = 0, and (33b) in turn implies Fc = 0, which is false. Hence if there is a solution it must be
‚àÇL
= 0 and the demand constraint is binding: x = d. It follows from (33a) that œÜ1 = ¬µ.
that ‚àÇœÜ
1
We then have two sub-cases.
A.1.1

Sub-Case 1.1: Class-Size Cap Non-Binding

‚àÇL
‚â• 0. By (33b),
In this sub-case, the class size cap is non-binding: œÜ2 = 0 and ‚àÇœÜ
2
‚àÇL
Fc
‚àÇœÜ2 ‚â• 0 implies ŒªŒò ‚â• 45 . Simple algebra then yields (13a)-(13c).

30

x
n

=

Fc
ŒªŒò

and

To check the second-order conditions, form the bordered Hessian:
‚éõ
‚éû
‚àÇh
‚àÇh
‚àÇh
0
‚àÇn
‚àÇx
‚éú ‚àÇh ‚àÇ‚àÇp
2
‚àÇ2L ‚éü
‚àÇ2L
‚éú ‚àÇp ‚àÇpL2 ‚àÇn‚àÇp
‚éü
‚àÇx‚àÇp ‚éü
H‚â°‚éú
‚àÇ2L
‚àÇ2L ‚éü
‚éú ‚àÇh ‚àÇ 2 L
‚éù ‚àÇn ‚àÇp‚àÇn ‚àÇn2 ‚àÇx‚àÇn ‚é†
‚àÇ2L
‚àÇp‚àÇx

‚àÇh
‚àÇx

‚àÇ2L
‚àÇn‚àÇx

‚àÇ2L
‚àÇx2

where h(p, n, x; Œª) ‚â° x ‚àí d. It is then straightforward (if tedious) to show that the last two leading
principal minors alternate in sign with the last one negative (and hence that the Hessian of L is
negative deÔ¨Ånite on the constraint set) if and only if (14) holds. Rewriting (14),


Œ∏

Œ∏
Œ∏

s(Œª| Œ∏, q ‚àó , p‚àó )g(Œ∏)
s(q ‚àó , p‚àó )



Œ∏

dŒ∏ >
Œ∏



ŒªŒ∏
¬µ




Œ∏

s(Œª| Œ∏, q ‚àó , p‚àó )g(Œ∏)
s(q ‚àó , p‚àó )


dŒ∏ ‚àí

ŒªŒò‚àó2
¬µ

Under assumption (7), ŒªŒ∏
¬µ < 1 for all values of Œª and Œ∏. Hence the left-hand-side term is greater
than the Ô¨Årst term on the right-hand side. Since the second term on the right-hand side is negative,
it follows that the solution to the Ô¨Årst-order conditions given is a local constrained maximum.
Moreover, the negative-deÔ¨Åniteness of L on the constraint set holds for all p, n and all x > 0,
hence the local maximum is a unique global maximum of the constrained optimization problem.
Rewrite (13a)-(13c), together with (5), noting that œÜ = ¬µ and x = d:
G1 = p‚àó ‚àí (¬µ + c ‚àí œÑ + ŒªŒò‚àó ) = 0
G2 = x‚àó ‚àí
G3
G4

Œ∏

s(Œª|Œ∏, q ‚àó , p‚àó )M g(Œ∏) dŒ∏ = 0

Œ∏
Œ∏



s(Œª|Œ∏, q ‚àó , p‚àó )g(Œ∏)
‚â° Œò ‚àí
Œ∏
s(q ‚àó , p‚àó )
Œ∏
ŒªŒò‚àó x‚àó
= ‚àíFc +
=0
n‚àó
‚àó

(34a)
(34b)


dŒ∏ = 0

(34c)
(34d)

‚àó

It is convenient to deÔ¨Åne z ‚àó = nx‚àó (class size) and analyze (34a)-(34d) as a set of four equations
with four endogenous variables, p‚àó , x‚àó , Œò, and z ‚àó , and one exogenous variable, Œª. Let J be the
Jacobian:
‚éõ ‚àÇG1 ‚àÇG1 ‚àÇG1 ‚àÇG1 ‚éû
‚éú
‚éú
J ‚â°‚éú
‚éù

‚àÇp‚àó
‚àÇG2
‚àÇp‚àó
‚àÇG3
‚àÇp‚àó
‚àÇG4
‚àÇp‚àó

‚àÇx‚àó
‚àÇG2
‚àÇx‚àó
‚àÇG3
‚àÇx‚àó
‚àÇG4
‚àÇx‚àó

‚àÇz ‚àó
‚àÇG2
‚àÇz ‚àó
‚àÇG3
‚àÇz ‚àó
‚àÇG4
‚àÇz ‚àó

‚àÇŒò‚àó
‚àÇG2
‚àÇŒò‚àó
‚àÇG3
‚àÇŒò‚àó
‚àÇG4
‚àÇŒò‚àó

‚éü
‚éü
‚éü
‚é†

By the implicit function theorem:
‚éõ
‚éú
‚éú
‚éù

‚àÇp‚àó
‚àÇŒª
‚àÇx‚àó
‚àÇŒª
‚àÇz ‚àó
‚àÇŒª
‚àÇŒò‚àó
‚àÇŒª

‚éû

‚éõ

‚éü
‚éú
‚éü = ‚àíJ ‚àí1 ‚éú
‚é†
‚éù

31

‚àÇG1
‚àÇŒª
‚àÇG2
‚àÇŒª
‚àÇG3
‚àÇŒª
‚àÇG4
‚àÇŒª

‚éû
‚éü
‚éü
‚é†

(35)

It is straightforward to show that:
det J = ‚àí

Œ®
<0
Œò‚àó

(36)

since Œ® > 0 (refer to (14)). Simplifying (35), we have:


‚éõ
 
Œò‚àó
‚àó + Œª ln T œÉ 2
‚éõ ‚àÇp‚àó ‚éû
Œò
‚àó
¬µ
 Tz  Œ∏|Œª
‚éú Œ®
‚àó Œò‚àó
‚àÇŒª‚àó
x
‚éú
ln
‚éú ‚àÇx ‚éü ‚éú
 ¬µ   z‚àó

‚éú ‚àÇŒª‚àó ‚éü = ‚éú
‚éù ‚àÇz ‚é† ‚éú ‚àí z ‚àó Œª ln T‚àó œÉ 2 + Œò‚àó
Œ∏|Œª
‚àÇŒª
z
‚éù ŒªŒ® ‚àó ¬µ2
‚àÇŒò‚àó

Œò œÉŒ∏|Œª   T 
‚àÇŒª
ln
+
1
‚àó
¬µŒ®
z

‚éû
‚éü
‚éü
‚éü
‚éü
‚éü
‚é†

(37)

at the optimum.
2
in (15), the fact that the double-exponential distribution yields a
In the deÔ¨Ånition of œÉŒ∏|Œª
non-zero probability that any given household will choose any given school implies that the term
in brackets is non-zero for all Œ∏. Hence as long as Œ∏ = Œò‚àó for some Œ∏, which follows from the
assumption that Œ∏ has positive support over (Œ∏, Œ∏), we have:
2
>0
œÉŒ∏|Œª

(38)

The results (16a), (16b), (16d) and (16e) follow from (14), (37) and (38). Finally, we have:
 
‚àÇ x‚àó
x‚àó ‚àÇz ‚àó
1 ‚àÇx‚àó
‚àÇn‚àó
=
‚àí
>0
=
‚àÇŒª
‚àÇŒª z ‚àó
z ‚àó ‚àÇŒª
z ‚àó 2 ‚àÇŒª
where the inequality follows from (16b) and (16e). This gives (16c).
A.1.2

Sub-Case 1.2: Class-Size Cap Binding

In this sub-case, the class-size cap is binding: œÜ2 ‚â• 0 and
œÜ2
n

= 0 (that is,

x
n

= 45). By (33b) and

F
=
‚àí ŒªŒò. The fact that œÜ2 ‚â• 0 implies ŒªŒò ‚â§ 45
.
the facts that x = d and œÜ1 = ¬µ, we have
Algebra yields (17a)-(17c).
To verify the second-order conditions, the bordered Hessian is:
‚éû
‚éõ
‚àÇh1
‚àÇh1
‚àÇh1
0
0
‚àÇp
‚àÇn
‚àÇx
‚éú 0
‚àÇh2
‚àÇh2 ‚éü
‚àÇh2
0
‚éú
‚àÇn
‚àÇx ‚éü
‚éú ‚àÇh1 ‚àÇh2 ‚àÇ‚àÇp
2L
2
2L ‚éü
‚àÇ
‚àÇ
L
‚éü
(39)
H‚â°‚éú
‚àÇp
‚àÇn‚àÇp
‚àÇx‚àÇp ‚éü
‚àÇp2
‚éú ‚àÇp
‚éú ‚àÇh1 ‚àÇh2 ‚àÇ 2 L
‚àÇ2L
‚àÇ2L ‚éü
‚éù ‚àÇn ‚àÇn ‚àÇp‚àÇn ‚àÇn2 ‚àÇx‚àÇn ‚é†
‚àÇh1
‚àÇx

‚àÇh2
‚àÇx

F
45

‚àÇL
‚àÇœÜ2

‚àÇ2L
‚àÇp‚àÇx

‚àÇ2L
‚àÇn‚àÇx

‚àÇ2L
‚àÇx2

where L is given in (32), h1 (p, n, x, Œª) ‚â° x ‚àí d and h2 (p, n, x, Œª) ‚â° nx ‚àí 45. It is straightforward to
x3
verify that det H = ‚àí ¬µn
4 < 0 at the optimum, and hence that the second-order conditions for a
maximum are satisÔ¨Åed.

32

To analyze the slopes with respect to Œª in this sub-case, rewrite (17a)-(17c) with (5) as:


Fc
‚àó
G1 = p ‚àí c ‚àí œÑ + ¬µ +
=0
(40a)
45
Œ∏

G2 = x‚àó ‚àí

Œ∏
Œ∏

‚àó

G3 ‚â° Œò ‚àí
G4 = n‚àó ‚àí

s(Œª|Œ∏, q ‚àó , p‚àó )M g(Œ∏) dŒ∏ = 0

Œ∏
x‚àó

45



s(Œª|Œ∏, q ‚àó , p‚àó )g(Œ∏)
Œ∏
s(q ‚àó , p‚àó )

(40b)


dŒ∏ = 0

(40c)

=0

(40d)

Applying the implicit function theorem (as in (35)) to (40a)-(40d), we have:
‚éõ
‚éú
‚éú
‚éù

‚àÇp‚àó
‚àÇŒª
‚àÇx‚àó
‚àÇŒª
‚àÇn‚àó
‚àÇŒª
‚àÇŒò‚àó
‚àÇŒª

‚éû
‚éü 1
‚éü = ln
‚é† ¬µ



T
45



‚éõ

‚éû
0
‚éú x‚àó Œò‚àó ‚éü
‚éú x ‚àó Œò‚àó ‚éü
‚éù
‚é†
45
2
œÉŒ∏|Œª

(41)

which in turn implies (18a)-(18e).
‚àó
‚àó
The fact that ‚àÇŒò
‚àÇŒª > 0 in both sub-cases implies that ŒªŒò is monotonically increasing in Œª and
guarantees that there is at most one critical value of Œª, call it Œ±, at which (19) holds. The results
for the Ô¨Årst sub-case apply for Œª ‚â• Œ± and the results for the second sub-case apply for Œª < Œ±.

A.2

Case 2: Indivisible Classrooms

The Lagrangian in this case is the same as (32), but n is now interpreted as a parameter:

x
‚àí 45
L(p, x; n, Œª) = (p ‚àí c + œÑ ) x ‚àí nFc ‚àí Fs ‚àí œÜ1 (x ‚àí d) ‚àí œÜ2
n

(42)

The Ô¨Årst-order conditions are:
‚àÇL
‚àÇp
‚àÇL
‚àÇx
‚àÇL
‚àÇœÜ1
‚àÇL
‚àÇœÜ2

 
d
= x ‚àí œÜ1
=0
¬µ


 
ŒªŒòd
1
= p ‚àí c + œÑ ‚àí œÜ1 1 +
‚àí œÜ2
=0
¬µx
n
‚àÇL
‚â• 0, œÜ1 ‚â• 0, and œÜ1
=0
‚àÇœÜ1
‚àÇL
‚â• 0, œÜ2 ‚â• 0, and œÜ2
=0
‚àÇœÜ2

(43a)
(43b)
(43c)
(43d)

We can quickly rule out the possibility that the demand constraint is not binding:
‚àÇL
‚â• 0, œÜ2 = 0
1. If neither the demand constraint nor the class-size cap is binding (œÜ1 = 0, ‚àÇœÜ
1
‚àÇL
and ‚àÇœÜ2 ‚â• 0) then by (43a), x = 0 and by (43b), p = c ‚àí œÑ . It is straightforward to verify
that the second-order conditions are not satisÔ¨Åed in this sub-case.

2. If the demand constraint is not binding but the class-size cap is binding (œÜ1 = 0,
33

‚àÇL
‚àÇœÜ1

‚â• 0,

‚àÇL
œÜ2 ‚â• 0 and ‚àÇœÜ
= 0) then by (43a), we have x = 0. This violates the class-size constraint
2
( nx = 45); hence there is no solution in this case.

There are then two sub-cases to be considered.
A.2.1

Sub-Case 2.1: Class-Size Cap Non-Binding

In this sub-case, the demand constraint is binding and the class-size cap is non-binding: œÜ1 ‚â• 0,
‚àÇL
‚àÇL
‚àÇœÜ1 = 0, œÜ2 = 0, ‚àÇœÜ2 ‚â• 0. Equations (20a)-(20b) follow immediately from (43a)-(43b).
The second-order conditions can be veriÔ¨Åed by evaluating the determinant of the bordered
Hessian (3x3 in this case). The determinant is positive, and the second-order conditions are
satisÔ¨Åed, if condition (14) is satisÔ¨Åed. This condition is guaranteed by (7). We again have that
the Hessian of the proÔ¨Åt function is negative deÔ¨Ånite on the constraint set, and hence that the
solution given by (20a)-(20b) is a global maximum.
Rewrite (20a)-(20b), together with (5):
G1 = p‚àó ‚àí [¬µ + c ‚àí œÑ + ŒªŒò‚àó ] = 0
G2 ‚â° x‚àó ‚àí

Œ∏
Œ∏
Œ∏

‚àó

G3 ‚â° Œò ‚àí

Œ∏

(44a)

s(Œª|Œ∏, q ‚àó , p‚àó )M g(Œ∏) dŒ∏ = 0


s(Œª|Œ∏, q ‚àó , p‚àó )g(Œ∏)
Œ∏
s(q ‚àó , p‚àó )

(44b)


dŒ∏ = 0

(44c)

Note that these are the same as (34a)-(34c). (The number of classrooms is now treated as a
parameter, and we no longer have (34d).) Inverting the Jacobian (3x3 in this case) and using the
implicit function theorem (as in (35)) applied to (44a)-(44c), we have:
‚éõ
  2 ‚éû
‚àó2
‚éõ ‚àÇp‚àó ‚éû
Œò‚àó + ŒªŒò¬µ + ¬µŒª ln nT
x‚àó œÉŒ∏|Œª
‚éü
‚éú




‚àó
‚àÇŒª‚àó
1
x
nT
‚àó
‚éü
‚éú
Œ®
ln
‚àí
Œò
‚éù ‚àÇx ‚é† =
‚àó
(45)
‚éü
‚éú
¬µ
x
‚àÇŒª‚àó
ŒªŒ® ‚éù


‚é†
2
1
+
‚àÇŒò
 nT 
œÉŒ∏|Œª ŒªŒò‚àó
¬µ
‚àÇŒª
¬µ
¬µ + ln x‚àó
The results (21a),(21b) and (23) follow from (14), (22), (38), and (45).
‚àÇL
‚â• 0 requires:
The condition ‚àÇœÜ
2
45n ‚â§

Œ∏
Œ∏

1
‚Ñ¶(Œ∏)



T
45

 Œ∏Œª
¬µ



c ‚àí œÑ + ¬µ + ŒªŒò‚àó
M g(Œ∏) dŒ∏
exp ‚àí
¬µ

Taking the exponential term out of the integral and solving for ŒªŒò‚àó , we have:
ŒªŒò‚àó ‚â§ ¬µ ln Œ£ ‚àí ¬µ ln(45n) ‚àí c + œÑ ‚àí ¬µ
where Œ£ is deÔ¨Åned as in (25). Setting this inequality to an equality yields (27), which implicitly
deÔ¨Ånes Œ≤(n), the value of Œª at which the class-size cap begins to bind.

34

A.2.2

Sub-Case 2.2: Class-Size Cap Binding

‚àÇL
= 0,
In this sub-case, both the demand constraint and class-size cap are binding: œÜ1 ‚â• 0, ‚àÇœÜ
1
‚àÇL
œÜ2 ‚â• 0 and ‚àÇœÜ2 = 0. The two constraints, x = d and x = 45n, pin down the values of p and x,
and the results (24a)-(24b) follow
immediately.

‚àÇx‚àó
‚àÇ
x
The fact that ‚àÇŒª = ‚àÇŒª n = 0 follows immediately. It is straightforward to show that
 
‚àÇp‚àó
T
= Œò‚àó ln
>0
(46a)
‚àÇŒª
45
 
1 2
T
‚àÇŒò‚àó
=
œÉŒ∏|Œª ln
>0
(46b)
‚àÇŒª
¬µ
45

It remains to establish the set of schools over which the condition œÜ2 ‚â• 0 is satisÔ¨Åed. The Ô¨Årst
order conditions imply:
œÜ2 = n {¬µ ln Œ£ ‚àí ¬µ ln(45n) ‚àí c + œÑ ‚àí ¬µ ‚àí ŒªŒò‚àó }

(47)

By the deÔ¨Ånition of Œ≤(n) above, if Œª = Œ≤(n) then œÜ2 = 0. Partially diÔ¨Äerentiating (47):


¬µ ‚àÇŒ£
‚àÇŒò‚àó
‚àÇœÜ2
‚àó
= n
‚àíŒª
‚àíŒò
‚àÇŒª
Œ£ ‚àÇŒª
‚àÇŒª


 
T
‚àó
‚àíŒò >0
= n Œ® ln
45
by assumption (22). Thus œÜ2 ‚â• 0 for Œª ‚â• Œ≤(n). The Ô¨Årst sub-case applies for Œª ‚â§ Œ≤(n) and the
second applies for Œª > Œ≤(n).
Finally, it follows from (45), (46a), and (22) that:
lim

Œª‚ÜíŒ≤(n)‚àí

‚àÇp‚àó
‚àÇp‚àó
< lim
‚àÇŒª
Œª‚ÜíŒ≤(n)+ ‚àÇŒª

That is, the slope of p‚àó with respect to Œª is steeper to the right of the critical value, in the region
where the class-size cap binds.
A.2.3

Proof of Lemma 1

Our strategy for proof is to begin with a preliminary partition of the set of schools and show
that within each subset there are two possible optimal integer choices, and that there is a critical
value below which the lower integer is optimal and above which the higher integer is optimal.
These new critical values become the basis for the new partition described in the statement of
the lemma.
1. For a given integer k, let Œ¥k be the value of Œª at which the optimal number of classrooms
in Case 1, the divisible-classrooms case, is k. That is, Œ¥k ‚â° n‚àó ‚àí1 (k) where n‚àó (Œª) is deÔ¨Åned
by (13c) for Œª ‚â• Œ± and by (17c) for Œª < Œ±. As noted above, n‚àó (Œª) is continuous and
monotonically increasing in Œª. This implies that Œ¥k > Œ¥k if k > k for any positive integers
k, k . The values Œ¥k thus form an ordered partition the set of schools.

35

2. We now show that within the interval Œª ‚àà [Œ¥k , Œ¥k+1 ), the optimal integer number of classrooms is either k or k + 1.
(a) DeÔ¨Åne functions for proÔ¨Åts under the counterfactual assumptions that the class-size
cap never binds and that it always binds. That is, let:
œÄ ‚àó (n, Œª) = œÄ(p‚àó (n, Œª), x‚àó (n, Œª), n, Œª)
where p‚àó (n, Œª) and x‚àó (n, Œª) are given by (20a) and (20a), the optimal choices when the
class-size cap does not bind. Let:
œÄ ‚àó‚àó (n, Œª) = œÄ(p‚àó (n, Œª), x‚àó (n, Œª), n, Œª)
where p‚àó (n, Œª) and x‚àó (n, Œª) are given by (24b) and (24a), the optimal choices when the
class-size cap binds. The deÔ¨Ånition of œÄÃÉ(¬∑) in (28) can then be restated:
 ‚àó
œÄ (n, Œª) if Œª ‚â§ Œ≤(n)
(48)
œÄ
(n, Œª) =
œÄ ‚àó‚àó (n, Œª) if Œª > Œ≤(n)
(n, Œª) are concave in n for any given
(b) We now show that œÄ ‚àó (n, Œª), œÄ ‚àó‚àó (n, Œª) and hence œÄ
Œª:
i. By the envelope theorem, we have:
‚àÇL
‚àÇœÄ ‚àó
=
‚àÇn
‚àÇn

(49)

‚àó

where L is given by (32) and ‚àÇœÄ
‚àÇn allows p and x to vary (holding Œª constant) but
‚àÇL
holds
p,
x
and
Œª
constant.
Then by (33b):
‚àÇn
‚àÇ
‚àÇ 2 œÄ‚àó
=
2
‚àÇn
‚àÇn



‚àÇL
‚àÇn





‚àÇ
ŒªŒò‚àó x‚àó
=
‚àíFc +
‚àÇn
n
‚àó
‚àó
‚àó
ŒªŒò ‚àÇx‚àó Œªx‚àó ‚àÇŒò‚àó
ŒªŒò x
+
+
= ‚àí
n2
n ‚àÇn
n ‚àÇn

(50)

Applying the implicit function theorem (as in (35)) to (44a)-(44c),
‚éõ
‚éù

Plugging into (50),

‚àÇp‚àó
‚àÇn
‚àÇx‚àó
‚àÇn
‚àÇŒò‚àó
‚àÇn

‚éû
‚é†=

‚éõ
‚éú
Œª
‚éú
¬µ + ŒªŒ® ‚éù

2
ŒªœÉŒ∏|Œª
n
x‚àó Œ®
n
2
œÉŒ∏|Œª
n

‚éû
‚éü
‚éü
‚é†

(51)

ŒªxŒ®
‚àÇ 2œÄ‚àó
 <0
=‚àí 
2
‚àÇn
n2 1 + ŒªŒ®
¬µ

Hence œÄ ‚àó (n, Œª) is globally concave in n for all Œª.
ii. Combining (8), (24a) and (24b), and diÔ¨Äerentiating twice with respect to n, we
2 ‚àó‚àó
‚àó‚àó
have that ‚àÇ‚àÇnœÄ2 = ‚àí 45¬µ
n < 0. Hence œÄ (n, Œª) is globally concave in n for all Œª as
well.
36

iii. Implicitly diÔ¨Äerentiating (27) with respect to n, we have:
‚àÇŒ≤(n)
¬µ
T 
 >0
= 
‚àÇn
n Œ® ln 45 ‚àí Œò

(52)

for all n, where the inequality follows from (22). Hence there is a one-to-one
mapping between Œ≤(n) and n for a given Œª. Œ≤ ‚àí1 (Œª) is then the value of n at
which the class-size cap starts to bind for a given Œª. Note that the cap binds for
n < Œ≤ ‚àí1 (Œª) and does not bind for n ‚â• Œ≤ ‚àí1 (Œª). The deÔ¨Ånition of œÄÃÉ(¬∑) in (48) can
then be rewritten:
 ‚àó
œÄ (n, Œª) if n ‚â• Œ≤ ‚àí1 (Œª)
(53)
œÄ
(n, Œª) =
œÄ ‚àó‚àó (n, Œª) if n < Œ≤ ‚àí1 (Œª)
The function œÄ ‚àó (n, Œª) gives the maximized proÔ¨Åt for a given n and Œª under one
equality constraint, namely x = d. The function œÄ ‚àó‚àó (n, Œª) gives the maximized
proÔ¨Åt for a given n and Œª under two equality constraints, namely x = d and
x
n = 45. For a given Œª, the two points coincide at the point where the optimal
class size is 45 even in the absence of the cap‚Äîthat is, where n = Œ≤ ‚àí1 (Œª)‚Äîand
for all other n the function œÄ ‚àó‚àó (n, Œª) lies under œÄ ‚àó (n, Œª). A standard result in
optimization theory is that (if both functions are continuously diÔ¨Äerentiable) the
two curves are tangent at that point (see e.g. Dixit (1976, Ch. 3)).
œÄ
Now consider the curvature of the œÄ
(n, Œª) function. For n < Œ≤ ‚àí1 (Œª), ‚àÇe
‚àÇn is decreasœÄ
ing in n by the concavity of œÄ ‚àó‚àó (n, Œª). For n ‚â• Œ≤ ‚àí1 (Œª), ‚àÇe
‚àÇn is decreasing in‚àó n by the
‚àÇœÄ ‚àó‚àó
concavity of œÄ ‚àó (n, Œª). At n = Œ≤ ‚àí1 (Œª) the two curves are tangent and ‚àÇœÄ
‚àÇn = ‚àÇn .
œÄ
(n, Œª) is globally
It follows that ‚àÇe
‚àÇn is decreasing in n for all n and all Œª. Hence œÄ
concave in n for all Œª.

(c) Recall the deÔ¨Ånition of n‚àó (Œª), the optimal number of classrooms in the divisibleclassroom case, from step 1 of this proof. Since n‚àó (Œª) is monotonically increasing
(n, Œª) it follows
in Œª, Œª ‚àà [Œ¥k , Œ¥k+1 ) implies n‚àó (Œª) ‚àà [k, k + 1). From the concavity of œÄ
that:
œÄ
(k, Œª) > œÄ
(k , Œª) ‚àÄ k < k




œÄ
(k + 1, Œª) > œÄ
(k , Œª) ‚àÄ k > k + 1

(54)
(55)

That is, within the interval Œª ‚àà [Œ¥k , Œ¥k+1 ) either k or k + 1 must be the optimal integer
number of classrooms.
3. We now show that in the interval Œª ‚àà [Œ¥k , Œ¥k+1 ) there is a critical value of Œª to the left of
which k is the optimal number of classrooms and to the right of which k + 1 is the optimal
number. For Œª ‚àà [Œ¥k , Œ¥k+1 ), deÔ¨Åne:

Œ†(Œª)
‚â°œÄ
(k + 1, Œª) ‚àí œÄ
(k, Œª)
Since k is the unique optimal choice of number of classrooms at Œ¥k in the divisible-classrooms
case,
 k) = œÄ
(k + 1, Œ¥k ) ‚àí œÄ
(k, Œ¥k ) < 0
Œ†(Œ¥
37

Similarly, since k + 1 is the unique optimal number of classrooms at Œ¥k+1 in the divisibleclassrooms case,
 k+1 ) = œÄ
(k + 1, Œ¥k+1 ) ‚àí œÄ
(k, Œ¥k+1 ) > 0
Œ†(Œ¥
From (52), we know that Œ≤(k) < Œ≤(k + 1); the class-size cap starts to bind at a higher value

of Œª for n = k + 1 than for n = k. Using (48), the deÔ¨Ånition of Œ†(Œª)
can be restated:
‚éß ‚àó
if Œª ‚â§ Œ≤(k)
‚é® œÄ (k + 1, Œª) ‚àí œÄ ‚àó (k, Œª)

œÄ ‚àó (k + 1, Œª) ‚àí œÄ ‚àó‚àó (k, Œª) if Œ≤(k) < Œª ‚â§ Œ≤(k + 1)
Œ†(Œª) =
‚é© ‚àó‚àó
œÄ (k + 1, Œª) ‚àí œÄ ‚àó‚àó (k, Œª) if Œ≤(k + 1) < Œª
Note that œÄ ‚àó (k, Œ≤(k)) = œÄ ‚àó‚àó (k, Œ≤(k)) and œÄ ‚àó (k + 1, Œ≤(k + 1)) = œÄ ‚àó‚àó (k + 1, Œ≤(k + 1)). Hence


Œ†(Œª)
is continuous. Now consider the slope of Œ†(Œª)
against Œª in each interval:
(a) Œª ‚â§ Œ≤(k). The class-size cap binds neither for n = k nor for n = k + 1.


 


‚àÇ 2 œÄ‚àó
‚àÇ ‚àÇœÄ ‚àó
‚àÇ ‚àÇL
‚àÇ
Œªx‚àó Œò‚àó
=
=
=
‚àíFc +
>0
‚àÇn‚àÇŒª
‚àÇŒª ‚àÇn
‚àÇŒª ‚àÇn
‚àÇŒª
n
where the second equality follows from (49), the third equality follows from (33b), and
the inequality follows from (21b) and (23). Hence:

‚àÇœÄ ‚àó (k + 1, Œª) ‚àÇœÄ ‚àó (k, Œª)
dŒ†
=
‚àí
>0
dŒª
‚àÇŒª
‚àÇŒª
(b) Œ≤(k) < Œª ‚â§ Œ≤(k + 1). The class-size cap binds for n = k but not for n = k + 1. Note
that


‚àÇL
nT
‚àÇœÄ ‚àó
‚àó ‚àó
=
= x Œò ln
(56)
‚àÇŒª
‚àÇŒª
x‚àó
where L is given by (42), and the Ô¨Årst equality follows by the envelope theorem. Similarly,
 
‚àÇL
T
‚àÇœÄ ‚àó‚àó
=
= 45nŒò‚àó ln
(57)
‚àÇŒª
‚àÇŒª
45
At n = k, the optimal enrollment if there were no class-size cap would be greater than
or equal to 45n; otherwise the cap would not be binding. Hence, comparing (56) and
(57),
‚àÇœÄ ‚àó‚àó (k, Œª)
‚àÇœÄ ‚àó (k, Œª)
‚â•
‚àÇŒª
‚àÇŒª
Using step 3a above,
‚àÇœÄ ‚àó (k, Œª)
‚àÇœÄ ‚àó‚àó (k, Œª)
‚àÇœÄ ‚àó (k + 1, Œª)
>
‚â•
‚àÇŒª
‚àÇŒª
‚àÇŒª
Hence:


‚àÇœÄ ‚àó (k + 1, Œª) ‚àÇœÄ ‚àó‚àó (k, Œª)
dŒ†
=
‚àí
>0
dŒª
‚àÇŒª
‚àÇŒª

(c) Œ≤(k + 1) < Œª. The class-size cap binds for both n = k and n = k + 1. Partially
38

diÔ¨Äerentiating (57) and using (51),


 

‚àÇ ‚àÇœÄ ‚àó‚àó
T
‚àÇŒò
= 45 ln
Œò+n
>0
‚àÇn
‚àÇŒª
45
‚àÇn
Hence


‚àÇœÄ ‚àó‚àó (k + 1, Œª) ‚àÇœÄ ‚àó‚àó (k, Œª)
dŒ†
=
‚àí
>0
dŒª
‚àÇŒª
‚àÇŒª


Thus Œ†(Œª)
is continuous and monotonically increasing in Œª for all Œª ‚àà [Œ¥k , Œ¥k+1 ). Together
with the fact that it is negative at Œ¥k and positive at Œ¥k+1 , this implies that there is exactly
 k ) = 0. For Œª ‚àà [Œ¥k , ŒΩk ), k is the optimal integer
one critical value, call it ŒΩk , at which Œ†(ŒΩ
number of classrooms; for Œª ‚àà [ŒΩk , Œ¥k+1 ), k + 1 is optimal.
4. It remains to consider the regions at the extremes of the support of Œª. Without loss of
generality, let j be the largest integer such that Œ¥j ‚â§ Œª,46 and let j be the smallest integer
such that Œª ‚â§ Œ¥j . Within each interval, [Œ¥j , Œ¥j+1 ), [Œ¥j+1 , Œ¥j+2 ), ..., [Œ¥j‚àí1 , Œ¥j ), the results from
steps 1-3 above hold. Truncate the interval (Œ¥j , Œ¥j ) at Œª below and Œª above. If ŒΩj ‚â§ Œª, then
let k = j + 1; else if Œª < ŒΩj then let k = j. If ŒΩj‚àí1 < Œª, then let k = j; else if Œª ‚â§ ŒΩj‚àí1 , then
let k = j ‚àí 1. Let ŒΩk‚àí1 = Œª and ŒΩk = Œª. Then
ŒΩk‚àí1 < ŒΩk < ... < ŒΩk
form a partition of the set of voucher schools, with the optimal integer number of classrooms
equal to k, k + 1, ..., k between consecutive values, and the lemma is proved.
A.2.4

Discontinuities at Critical Values

Consider a given ŒΩk from Lemma 1, where k < k < k. The fact that Œ≤(k + 1) > Œ≤(k) (from (52))
implies that it will never be the case that the class-size cap is non-binding to the left of the critical
value but binding to the right of it. There are then three cases to consider:
1. The class-size cap is binding neither to the left nor to the right of the critical value: ŒΩk ‚â§
Œ≤(k) < Œ≤(k + 1). In this case, limŒª‚ÜíŒΩ ‚àí p‚àó , limŒª‚ÜíŒΩ ‚àí x‚àó and limŒª‚ÜíŒΩ ‚àí Œò‚àó (the limits as Œª
k
k
k
approaches ŒΩk from the left) are given by (20a), (20b), and (5) with n = k. limŒª‚ÜíŒΩ + p‚àó ,
k
limŒª‚ÜíŒΩ + x‚àó and limŒª‚ÜíŒΩ + Œò‚àó are given by the same expressions with n = k+1. The diÔ¨Äerences
k
k
in the left and right limits then have the same signs as the partial derivatives of the variables
‚àó
‚àÇx‚àó
‚àÇŒò‚àó
with respect to n. By (51), we have immediately that ‚àÇp
‚àÇn > 0, ‚àÇn > 0, and ‚àÇn > 0. Hence:

46

lim p‚àó < lim p‚àó

(58a)

lim x‚àó < lim x‚àó

(58b)

lim Œò‚àó < lim Œò‚àó

(58c)

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

If Œª < Œ¥1 then let j = 0 and Œ¥0 = 0.

39

Moreover,
‚àÇ
‚àÇn



x‚àó
n



1 ‚àÇx‚àó
x‚àó
‚àí 2
n ‚àÇn
n


‚àó
x
ŒªŒ®
‚àí1 <0
n2 ¬µ + ŒªŒ®

=
=

and hence:
lim

Œª‚ÜíŒΩk‚àí

x‚àó
x‚àó
> lim
n
Œª‚ÜíŒΩk+ n

(59)

2. The class-size cap is binding to the left of the critical value but not to the right: Œ≤(k) <
ŒΩk < Œ≤(k + 1). It is immediate that,
lim

Œª‚ÜíŒΩk‚àí

x‚àó
x‚àó
= 45 > lim
n
Œª‚ÜíŒΩk+ n

(60)

Consider x‚àó and Œò‚àó in turn:
‚àó

(a) If there were no class-size cap, then for Œª ‚àà (Œ≤(k), ŒΩk ), we would have ‚àÇx
‚àÇŒª > 0. In the
‚àÇx‚àó
presence of the class-size cap, for Œª ‚àà (Œ≤(k), ŒΩk ) we have ‚àÇŒª = 0. Hence
lim x‚àó

Œª‚ÜíŒΩk‚àí

< lim x‚àó
Œª‚ÜíŒΩk‚àí

cap

no cap

If there were no class-size cap, then by (58b) we would have:
lim x‚àó

Œª‚ÜíŒΩk‚àí

< lim x‚àó
Œª‚ÜíŒΩk+

no cap

Hence:
lim x‚àó

Œª‚ÜíŒΩk‚àí

< lim x‚àó
Œª‚ÜíŒΩk+

cap

‚àó

(b) Let z ‚àó = xn . Recalling the assumption that schools cannot price discriminate, the price
term can be brought outside the integral in (5) and Œò‚àó can then be written:
!Œ∏
Œ∏

1
Œ∏ ‚Ñ¶(Œ∏)

Œò‚àó = !
Œ∏

1
Œ∏ ‚Ñ¶(Œ∏)

 T  Œ∏Œª
¬µ
z‚àó

 T  Œ∏Œª
¬µ
z‚àó

g(Œ∏)dŒ∏
(61)
g(Œ∏)dŒ∏

Note that Œò‚àó depends only on class size and Œª, not on price, or enrollment or the
number of classrooms separately. DiÔ¨Äerentiating,
Œª 2
‚àÇŒò‚àó
= ‚àí œÉŒ∏|Œª
<0
‚àÇz
¬µz

40

(62)

Hence (60) implies:

lim Œò‚àó < lim Œò‚àó

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

(63)

3. If the class-size cap is binding both to the left and to the right of the critical value: Œ≤(k) <
Œ≤(k + 1) ‚â§ ŒΩk . It is immediate that:
lim z ‚àó = lim z ‚àó = 45

Œª‚ÜíŒΩk‚àí

and:

Œª‚ÜíŒΩk+

(64)

lim x‚àó = 45k < 45(k + 1) = lim x‚àó

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

As (61) indicates, Œò‚àó depends only on class size and Œª. Hence (64) implies:
lim Œò‚àó = lim Œò‚àó

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

‚àó

‚àó
Since ‚àÇŒò
‚àÇŒª > 0 both to the left and to the right of ŒΩk (refer to (26c)), we have that Œò is
strictly increasing in Œª at ŒΩk .

In this case, p‚àó is given by (24a) both to the left and to the right of the critical value. Hence
the jump in number of classrooms from k to k + 1 implies:
lim p‚àó > lim p‚àó

Œª‚ÜíŒΩk‚àí

Œª‚ÜíŒΩk+

To summarize, at ŒΩk , class size is either decreasing or constant in Œª, and enrollment and average
willingness to pay are always increasing in Œª. We have no unambiguous result for how price
changes with Œª at ŒΩk .

41

Figure 1: Histograms of the number of 4th grades in urban schools, 2002
Panel B: Public schools

0

0

Nu mbe r of schools
500 1000 1500

Number of sch ools
20 0 40 0 60 0 80 0

Panel A: All schools

1

2

3
4
5
6
Num ber of 4 th grad es

7

8

1

3
4
5
6
Number of 4th grades

7

8

Panel D: Unsubsidiz ed priv ate schools

0

0

Nu mbe r of schools
200 400 600 800

Number of sch ools
50 10 0 15 0 20 0 25 0

Panel C: Voucher private schools

2

1

2

3
4
5
6
Num ber of 4 th grad es

7

8

1

2

3
4
5
6
Number of 4th grades

7

8

Note: Based on 2002 administrative data for urban schools with positive 4th grade enrollments. The figures cover
only schools Chile‚Äôs Ministry of Education classifies as urban. For voucher schools, panel C excludes about 0.2
percent of schools which report having more than eight 4th grade classes.

Figure 2: Case 1‚Äî Divisible classrooms
x/n

45

Œ±

Œª

Figure 3: Case 2 ‚Äî Indivisible classrooms
x/n

45

Œ≤(1)

ŒΩ1

Œ≤ (2)

ŒΩ2

ŒΩ3

ŒΩ4

ŒΩ5

Œª

Figure 4: Class size and income/mothers‚Äô schooling among urban private voucher schools, 2002

25

27

29

Class size
31
33

35

37

Panel A: Log income

11

11.5

12

12.5
Log income

13

13.5

25

27

29

Class size
31
33

35

37

Panel B: Mothers' schooling

8

10

12
Mothers' schooling

14

16

Note: Income and mothers‚Äô schooling come from 2002 individual-level SIMCE data aggregated to the school level. Class
size is based on 2002 administrative information. In each panel, the lines plot fitted values, along with point-wise confidence
intervals, of locally weighted regressions (using Stata‚Äôs lowess command and a bandwidth of 0.2) of class size on log income
(Panel A) and mothers‚Äô schooling (Panel B). The figures omit observations below and above the 1st and 99th percentile of
income or mothers‚Äô schooling. Standard errors are based on a bootstrap procedure with 1,000 replications. We note that the
results are very similar if derived using regressions of class size on a 5th-order polynomial of the independent variables.

0

10

4t h grade class size (x/n)
20
30
40

50

Figure 5: 4th grade enrollment and class size in urban private voucher schools, 2002

0

45

90
4th grade enrollment

135

Note: Based on administrative data for 2002. The solid line describes the relationship between enrollment and class
size that would exist if the class size rule (equation 30 in the text) were applied mechanically. The circles plot actual
enrollment cell means of 4th grade class size. Only data for schools with 4th grade enrollments below 180 are
plotted; this excludes less than two percent of all schools.

Figure 6: Test scores and enrollment in urban private voucher schools, 2002

Pan el B: La nguage

Math score
20 0 22 0 24 0 26 0 28 0 30 0

Language score
200 220 240 260 280 300

Pan el A: Ma th

45

90
135
4th-grade enrollment

45

90
135
4th-grade enrollment

Note: Test scores come from 2002 individual-level SIMCE information aggregated to the school level, and
enrollment is drawn from administrative data for the same year. The figures plot ‚Äúraw‚Äù enrollment-cell means of
test scores, along with the fitted values of a locally weighted regression calculated within each enrollment segment.

Figure 7: Histograms of 4th grade enrollment in urban private schools, 2002

0

20

Number of schools
40
60

80

Panel A: Voucher private

0

45

90
135
4th grade enrollment

180

225

180

225

0

5

Number of schools
10
15

20

Panel B: Unsubsidized private

0

45

90
135
4th grade enrollment

Note: Enrollment is drawn from administrative data for 2002. For visual clarity, only schools with 4th grade
enrollments below 225 are displayed. This excludes less than one percent of all schools.

Figure 8: Student characteristics and enrollment in urban private voucher schools, 2002

11.5

Household income
12
12.5

13

Panel A: Log income

45

90
4th-grade enrollment

135

9

10

Mothers' schooling
11
12
13

14

Panel B: Mothers' schooling

45

90
4th-grade enrollment

135

Note: Income and mothers‚Äô schooling come from 2002 individual-level SIMCE data aggregated to the school level.
Enrollment is drawn from administrative data for the same year. The figure presents ‚Äúraw‚Äù enrollment-cell means,
along with the fitted values of a locally weighted regression calculated within each enrollment segment. Only data
for schools with 4th grade enrollments below 180 are plotted; this excludes less than two percent of all schools.

Table 1: Descriptive statistics for urban schools, 2002
Sample/variable
Mean
Panel A: Full sample
Income
Mothers‚Äô schooling
Fathers‚Äô schooling
Math score
Language score
4th grade class size

S.D.

10th

Quantile
50th

25th

75th

90th

311.2
11.1
11.3
249.3
253.1

341.7
2.4
2.5
30
30.5

102.5
8.3
8.5
212.6
215.2

130
9.3
9.4
227.7
231.3

180
10.7
10.8
246.9
251.5

303.7
12.7
12.9
269.3
275.1

781.8
14.9
15.2
291.9
296

32.9

9.2

20

27

34

40.3

44.3

1.88

1.09

1

1

2

2

3

65

45.1

21

33

56

86

122

152.8
9.6
9.7
235.1
237.9
34.7

69.1
1.3
1.4
21.4
21.6
7.2

94.4
8.1
8.1
208.7
211.2
25

113.6
8.6
8.8
220.6
223.9
30

138.6
9.4
9.6
233.8
237.5
35.5

172.1
10.4
10.6
248.8
251.8
40.3

217
11.3
11.5
262.2
265.8
44

2.1

1

1

1

2

3

3

75.4
4 grade enrollment
Panel C: Voucher private schools
Income
250.8
11.5
Mothers‚Äô schooling
Fathers‚Äô schooling
11.5
Math score
252.2
Language score
256.9
th
34.2
4 grade class size

42

29

41.5

70

98

130

142.6
1.8
1.9
27.5
28.4
9.3

115.7
8.9
9
215.1
218.4
21

155.8
10.2
10.2
234.4
239.1
28

213.1
11.6
11.6
254.3
259.7
36

307.1
12.8
12.9
271.3
277.4
42

428.2
13.8
13.9
287.5
290.7
45

th

No. of 4 grade clases
th

4 grade enrollment
Panel B: Public schools
Income
Mothers‚Äô schooling
Fathers‚Äô schooling
Math score
Language score
4th grade class size
No. of 4th grade clases
th

No. of 4th grade clases
th

1.7

1.07

1

1

1

2

3

61.4

48.1

21

31

45

82.5

112

419.3
1.2
1.3
25.3
23.7
8.6

506.3
13.8
14
254.3
261.8
10

770.9
14.7
15
276
283
16.8

1003.6
15.4
15.9
292.9
297.5
23

1350
15.9
16.5
304.7
307
28.5

1673.5
16.3
16.9
314.1
315.1
34

1.7

1

1

1

1

2

3

41.7

33.2

10

17

31.5

57.5

85

4 grade enrollment
Panel D: Unsubsidized private schools
Income
1050.2
Mothers‚Äô schooling
15.1
Fathers‚Äô schooling
15.6
Math score
288.1
Language score
291.8
th
22.4
4 grade class size
No. of 4th grade clases
th

4 grade enrollment

Note: Data on monthly income, parental schooling, and test scores come from 2002 individual SIMCE information
aggregated to the school level. Income is in thousands of Chilean pesos (the average exchange rate for 2002 was about 700
pesos per U.S. dollar). Class size, the number of classes operated, and enrollment come from administrative data for the
same year. The table covers only urban schools. Panel A describes all 3,776 schools in the sample, panel B covers 1,652
public schools, panel C refers to 1,636 voucher private schools, and panel D refers to 488 private unsubsidized institutions.

Table 2: Class size and income and mothers‚Äô schooling among urban private voucher schools, 2002
Dependent var.: 4th grade class size
(1)
(2)
(3)
Panel A
120.3***
(15.2)

125.5***
(15.6)

135.3***
(16.7)

-4.9***
(0.6)
No
No

-5.1***
(0.6)
Yes
No

-5.5***
(0.7)
No
Yes

R2
N
Panel B

0.038
1,636

0.073
1,636

0.209
1,636

Mothers' schooling

8.5***
(1.2)

8.7***
(1.3)

9.8***
(1.4)

Mothers' schooling2
13 region dummies
318 commune dummies

-0.4***
(0.1)
No
No

-0.4***
(0.1)
Yes
No

-0.4***
(0.1)
No
Yes

R2
N

0.029
1,636

0.061
1,636

0.200
1,636

Log income
Log income2
13 region dummies
318 commune dummies

Note: Income and mothers‚Äô schooling are drawn from 2002 individual-level SIMCE data aggregated to the school level.
Class size comes from administrative data for the same year. *** indicates statistical significance at the 1% level.

Table 3: 1st stage, reduced form, and base IV specifications; urban private voucher schools, 2002
1st stage
Class
size
(1)

Reduced form
Math
score
(2)

Language
score
(3)

11.8***
(3.2)
0.0

9.9***
(3.3)
1.6

(4.0)
11.5

(4.0)
10.9

(13.6)
11.2
(10.6)
0.1
(0.1)
-0.1

(12.9)
11.5
(13.9)
0.2*
(0.1)
-0.2

(0.2)
0.0
(0.1)
-0.6
(0.4)
0.2
(0.5)
1,623
0.069

(0.2)
-0.1
(0.1)
-0.4
(0.4)
0.2
(0.6)
1,623
0.072

Class size
1{x ‚â•46}
1{x ‚â•91}
1{x ‚â•136}
1{x ‚â•181}
x
(x -46)*1{x ‚â•46}
(x -91)*1{x ‚â•91}
(x -136)*1{x ‚â•136}
(x -181)*1{x ‚â•181}
N
R2

-16.5***
(2.7)
-4.9**
(2.3)
-4.3**
(2.0)
-3.4
(3.0)
0.95***
(0.01)
-0.6***
(0.1)
-0.3**
(0.1)
0.0
(0.1)
-0.1
(0.1)
1,623
0.844

IV
Math
score
(4)
-0.7***
(0.3)

Language
score
(5)
-0.6**
(0.3)

0.8***
(0.2)
-0.6**
(0.3)
-0.2*
(0.1)
-0.2
(0.2)
0.1
(0.3)
1,623

0.8***
(0.3)
-0.6**
(0.3)
-0.3**
(0.1)
-0.1
(0.2)
0.1
(0.4)
1,623

Note: Test scores are based on 2002 SIMCE individual-level data, aggregated to the school level. Class size and
enrollment come from administrative information for the same year. *** indicates statistical significance at the 1%
level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels; see Lee and Card (forthcoming).
The table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that
report 4th grade enrollments in excess of 225 students.

Table 4: Within-enrollment band IV regressions; urban private voucher schools, 2002
st

1
(45
students)
(1)
Panel A: 5 student interval
Dep. var.: Math score
Class size
N
Panel B: 3 student interval
Dep. var.: Math score
Class size
N
Panel C: 5 student interval
Dep. var.: Language score
Class size
N
Panel D: 3 student interval
Dep. var.: Language score
Class size
N

Cutoff
2nd
(90
students)
(2)

rd

3
(135
students)
(3)

Pooled
cutoffs

(4)

-3.3
(2.5)
249

-32.6
(185.3)
186

-4.4
(7.3)
41

-3.4
(2.4)
476

-6.9

-55.2

-7.4

(6.7)
185

(197.9)
145

-13.9**
(4.4)
33

(6.1)
363

-3.1
(2.4)
249

-38.1
(216.0)
186

-4.0
(6.7)
41

-3.2
(2.3)
476

-7.0

59.7

-7.3

(6.6)
185

(213.3)
145

-13.0**
(3.7)
33

(5.9)
363

Notes: Test scores are from 2002 SIMCE individual-level data, aggregated to the school level. Class size and
enrollment come from administrative information for the same year. Columns present regressions within 5 (panels A
and C) and 3 (panels B and D) student enrollment bands around the first three cut-offs. Separate results around the
fourth cut-off are omitted for the sake of space; they account for less than 1 percent of observations. Columns 1-3 are
IV specifications using an indicator for whether schools‚Äô enrollment is above the respective cut-off as an instrument.
As van der Klaauw (2002) indicates, these are equivalent to simple Wald estimates of the effect of class size around
each discontinuity. Column 4 produces similar estimates pooling all three local samples and using the three cut-offs
(1{x>45}, 1{x>90}, and 1{x>135}) as instruments. All regressions are clustered around enrollment levels, see Lee
and Card (forthcoming).

Table 5: Behavior of selected variables around enrollment cut-offs and IV specifications;
urban private voucher schools, 2002
Mothers‚Äô
schooling
(1)

Fathers‚Äô
schooling
(2)

Household
income
(3)

Class size
1{x ‚â•46}
1{x ‚â•91}
1{x ‚â•136}
1{x ‚â•181}
x
(x -46)*1{x ‚â•46}
(x -91)*1{x ‚â•91}
(x -136)*1{x ‚â•136}
(x -181)*1{x ‚â•181}

0.93***
(0.2)
0.03
(0.2)
0.66

0.94***
(0.2)
0.03
(0.2)
0.86

(0.7)
0.66
(1.1)
-0.02*
(0.0)
0.02*
(0.0)
-0.01
(0.0)
-0.02
(0.0)
0.01

(0.8)
0.71
(1.1)
-0.02*
(0.0)
0.01
(0.0)
0.00
(0.0)
-0.03
(0.0)
0.02

66.6***
(14.1)
17.6
(17.3)
143.7*
(79.4)
53.1
(77.7)
-2.4***
(0.8)
2.3***
(0.8)
-0.7
(0.6)
-3.5
(2.3)
4

(0.0)

(0.0)

(3.4)

Mothers‚Äô schooling
Fathers‚Äô schooling
Household income
N
R2

1,623
0.034

1,623
0.032

1,623
0.029

IV
Math
Language
(4)
(5)
-0.1
0.1
(0.1)
(0.1)

0.4***
(0.1)
-0.4***
(0.1)
0.1
(0.1)
-0.2**
(0.1)
0.1

0.4***
(0.1)
-0.4***
(0.1)
0
(0.1)
-0.1
(0.1)
0.1

(0.1)
8.5***
(0.9)
1.6*
(0.9)
13.4**
(5.4)
1,623

(0.2)
9.5***
(1.0)
1.1
(0.9)
16.6***
(5.5)
1,623

Notes: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to
the school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. The
table focuses only on effects around the first four cut-offs, excluding the less than one percent of schools that report
4th grade enrollments in excess of 225.

Table 6: Reduced form regressions with piecewise control functions of higher order
Specification of the piecewise control function
1st
2nd
3rd
4th
order
order
order
order
(1)
(2)
(3)
(4)
Panel A-Dep. var.: Class size
1{x ‚â•46}
1{x ‚â•91}
Panel B-Dep. var.: Math score
1{x ‚â•46}
1{x ‚â•91}

0.6

1.5
(3.1)
3.3

(1.6)

(3.2)
4.9**
(2.2)

11.5***
(3.8)
6.6**
(3.3)

24.7***
(4.8)
15.5***
(2.8)

22.3***
(4.7)
19.8***
(4.0)

(4.0)

10.9***
(3.9)
7.4**
(3.2)

24.2***
(3.9)
19.6***
(2.9)

24.2***
(4.0)
18.6***
(3.4)

0.93***
(0.20)
0.03
(0.22)

0.91***
(0.22)
0.29
(0.26)

1.21***
(0.24)
0.55
(0.35)

1.11***
(0.24)
0.40
(0.40)

0.94***
(0.20)
0.03

0.93***
(0.24)
0.25

1.05***
(0.28)
0.47

(0.22)

(0.26)

1.14***
(0.29)
0.61*
(0.36)

66.6***
(14.1)
17.6
(17.3)
1,623

76.1***
(14.5)
29.6
(20.1)
1,623

69.5***
(17.4)
40.5
(27.6)
1,623

68.4***
(19.0)
22.3
(31.1)
1,623

-16.5***
(2.7)
-4.9**
(2.3)

-10.0**
(4.1)
-2.4

11.8***
(3.2)
-0.0
(4.0)

Panel C-Dep. var.: Language score
1{x ‚â•46}
1{x ‚â•91}
Panel D-Dep. var.: Mothers' schooling
1{x ‚â•46}
1{x ‚â•91}

9.9***
(3.3)
1.6

(2.1)

Panel E-Dep. var.: Fathers' schooling
1{x ‚â•46}
1{x ‚â•91}
Panel F-Dep. var.: Household income
1{x ‚â•46}
1{x ‚â•91}
N

(0.41)

Note: Test scores and socioeconomic status measures are from 2002 SIMCE individual-level data, aggregated to the
school level. Class size and enrollment come from administrative information for the same year. *** indicates
statistical significance at 1% level; ** at 5%, and * at 10%. All regressions are clustered by enrollment levels. This
table analyzes the robustness of reduced form results to the inclusion of higher order piecewise control functions
(Van der Klaauw, 2002). The results in column 1 (panels A-C) replicate those in Table 3 above (columns 1-3).
The results in column 1 (panels D-F) replicate those in Table 5 above (columns 1-3). The remaining columns then
explore how these results change as higher order piecewise control functions are added. For the sake of space, these
panels report only the coefficients on the first two cut-offs, which correspond to the majority of observations.

