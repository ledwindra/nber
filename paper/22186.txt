NBER WORKING PAPER SERIES

HOMOPHILY AND TRANSITIVITY IN DYNAMIC NETWORK FORMATION
Bryan S. Graham
Working Paper 22186
http://www.nber.org/papers/w22186

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2016

This work builds on comments prepared in response to Guido Imbens' Journal of Business and
Economic Statistics Annual Lecture delivered at the American Economic Association meetings in
Chicago (January 7th, 2012). I am grateful to Guido, and then JBES editors Kei Hirano and
Jonathan Wright, for providing the initial inspiration for this project. I am thankful to Michael
Leung for introducing me to the literature on random geometric graphs. I am also grateful to Peter
Bickel, Paul Goldsmith-Pinkham, Jim Heckman, Bo Honore, Noureddine El Karoui as well as to
participants at the Measuring and Interpreting Inequality (MIE) Inaugural Conference (February
18th, 2012), the CEME Conference on Inference in Nonstandard Problems (June 15th & 16th,
2012), the invited Social Interactions session of the ESEM (August 27 - 31, 2012), the CEMMAP
conference on Estimation of Complementarities in Matching and Social Networks (October 5 &
6, 2012), the 9th Invitational Choice Symposium (June 12 – 16, 2013), the Berkeley Statistics
Department's NSF reading group on networks, the Third European Meeting on Networks (June
18-19th, 2015) and the USC-INET Conference on Networks (November 20-21st, 2015) for
valuable comments. Financial support from NSF Grant SES #1357499 is gratefully
acknowledged. All the usual disclaimers apply. The views expressed herein are those of the
author and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2016 by Bryan S. Graham. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.

Homophily and Transitivity in Dynamic Network Formation
Bryan S. Graham
NBER Working Paper No. 22186
April 2016
JEL No. C1,C14,C23,C25,D85
ABSTRACT
In social and economic networks linked agents often share additional links in common. There are
two competing explanations for this phenomenon. First, agents may have a structural taste for
transitive links -- the returns to linking may be higher if two agents share links in common.
Second, agents may assortatively match on unobserved attributes, a process called homophily. I
study parameter identifiability in a simple model of dynamic network formation with both effects.
Agents form, maintain, and sever links over time in order to maximize utility. The return to
linking may be higher if agents share friends in common. A pair-specific utility component
allows for arbitrary homophily on time-invariant agent attributes. I derive conditions under which
it is possible to detect the presence of a taste for transitivity in the presence of assortative
matching on unobservables. I leave the joint distribution of the initial network and the pairspecific utility component, a very high dimensional object, unrestricted. The analysis is of the
`fixed effects' type. The identification result is constructive, suggesting an analog estimator,
whose single large network properties I characterize.

Bryan S. Graham
University of California - Berkeley
530 Evans Hall #3880
Berkeley, CA 94720-3880
and NBER
bgraham@econ.berkeley.edu

Let i, j and k index three independent random draws from some network of agents (i.e.,
a population of potentially connected sampling units). Together these agents constitute a
triad. Let Dij = 1 if agents i and j are connected and zero otherwise. Links are undirected,
such that Dij = Dji for all pairs ij, and self-ties are ruled out, so that Dii = 0 for all i.
A triad can be wired in one of four ways (see Figure 1). Consider the probability of the
observing the wiring where all three pairs, ij, ik and jk, are connected conditional on at
least two of the pairs being connected:
⇢CC = Pr ( Dij = 1| Dik = 1, Djk = 1)

(1)

The sample analog of (1) is called the transitivity index or global clustering coeﬃcient in
the networks literature (Graham, 2015). In real world social and economic networks ⇢CC
is generally higher than ⇢D = Pr (Dij = 1) , the unconditional frequency at which agents
link (Jackson, 2008). It is often substantially higher. Links are clustered. Networks exhibit
transitivity: agents are more likely to link if they share links in common (“the friend of my
friend is also my friend”).
Figure 1: Triad configurations in undirected networks

High levels of transitivity are found in friendship networks, industrial supply-chains, international trade flows, and alliances across firms and nations (Gulati and Gargiulo, 1999; Choi
and Wu, 2009; Maoz, 2012; Matous and Todo, 2016; Davis et al., 1971; Kossinets and Watts,
2009).1 In his classic paper on weak ties, Granovetter (1973), in honor of their supposed
infrequent occurrence, even calls the intransitive two-star a “forbidden triad” (see Figure 1).2
Transitivity in links may arise for two distinct reasons. First agents may have a structural taste for transitive ties. The returns to link formation between any two agents may
be increasing in the number of neighbors they share in common. Coleman (1990) argues
1

Jackson (2008) gives many other examples and references.
Davis et al. (1971), in another classic reference, claim that transitivity of social ties is the “central
proposition in structural sociometry” (p. 309).
2

1

that closed networks facilitate the formation of social and human capital.3 This might provide an impetus for agents to form transitive relationships. Jackson et al. (2012) provide
a game-theoretic foundation for transitivity, arguing that common friends, by monitoring
transactions between agents, help to sustain cooperation. More mundanely socializing may
be easier and more enjoyable when individuals share friends in common.
Second transitivity in social ties may reflect assortative matching on an unobserved attribute.
That is, the returns to linking may be greater across similar agents, leading to dense ties
among them. The tendency for individuals to assortatively match on gender, race, age
and other observed characteristics, called homophily by network researchers, is widely documented (McPherson et al., 2001).
Distinguishing between a structural taste for transitivity and homophily as drivers of clustering in networks is of considerable scientific interest and policy relevance. In the presence
of a structural taste for transitivity outside interventions can have long run eﬀects on network structure. If clustering primarily reflects assortative matching on unobserved agent
attributes, interventions are less likely to lead to durable changes in network structure.
Figure 2: The eﬀects of link deletion when agents prefer transitive ties

Notes: The vertical dashed lines partition nodes into three distinct communities. Agents may
only form ties with agents in their own and adjacent communities. The thick “Berkeley Blue”
lines correspond to edges that form regardless of network structure. The thinner “Lawrence”
colored lines correspond to edges that form only when the two agents share another link in
common. The thin “Rose Garden” colored edge its targeted for deletion by the policy-maker.
3

For example both parents and teachers interact with a student, but if parents and teachers also consult
with each other about the student, forming a triangle, the student’s rate of learning may increase.

2

Figure 2 provides one illustration of these claims. Agents are divided into three communities
according to the vertical dashed lines in the figure. Links can only arise between agents
in the same or adjacent communities (i.e., there exists locational homophily). There are
two types of links, “strong ties”, which are sustainable regardless of network structure (thick
darker edges) and “weak ties”, which require the support of a link in common (thin lighter
edges). The initial network structure is given in the upper-left-hand t = 0 graph. This
network consists of a single “giant component”.
Now consider a policy-maker who deletes the link between agents 2 and 3 (the thin “Rose
Garden” colored edge). The immediate eﬀect of this deletion is depicted in the t = 1 graph
in the upper-right-hand corner of the figure. Once this link is deleted pairs 1 and 3 and
3 and 4 no longer share a friend in common. Since these edges require a common link for
sustenance, they dissolve, leading to the t = 2 graph depicted in the lower-left-hand corner
of the figure. However, since now agents 4 and 5 no longer share a link in common, their
tie also dissolves leading to the t = 3 network configuration depicted in the lower-right-hand
corner of the figure. The architecture of the final graph is very diﬀerent from the initial one,
consisting of two separate components.
The presence of a structural taste for transitivity creates interdependencies in link formation,
whereby the surplus agents i and j get from linking may vary with the presence of absence of
edges elsewhere in the network. The presence of such interdependencies means that a local
manipulation may have global consequences for network structure. Removing or adding a
single link may initiate a cascade of edge removals and/or additions.
When interdependencies are absent, the eﬀect of deleting a link would be entirely local. In
the example, the final state of the network in such a case would be given by the t = 1 graph
in the upper-right-hand corner of Figure 2. This graph does not appreciably diﬀer from its
pre-policy t = 0 version.
In this paper I introduce an empirical model of dynamic network formation and formally
study its identifiability. I am particularly interested in circumstances under which it is possible to attribute clustering in ties, a central feature of real world networks, to a structural taste
for transitivity versus assortative matching on an unobserved attribute (i.e., homophily).
The motivation for my question is twofold. First, networks are ubiquitous and their structure
is evidently important for a variety of social and economic outcomes (Jackson et al., 2016).
Second, as argued using the example in Figure 2, the manipulability of network structure
hinges on the degree to which current (local) network structure influences future (global)
network structure. While the homophily versus transitivity identification problem has been
informally articulated in the networks literature (e.g., Gulati and Gargiulo, 1999; Goodreau
3

et al., 2009) it has not been systematically analyzed.
There is a useful analogy between my research problem, both in terms of scientific and
policy motivation and technical content, and that of discriminating between state dependence
and unobserved heterogeneity in single-agent dynamic binary choice analysis (Cox, 1958;
Heckman, 1978, 1981a,b,c; Chamberlain, 1985). The multi-agent aspect of my problem
makes it more challenging, nevertheless I will utilize intuitions and proof strategies from
this earlier research as well as from Manski’s semiparametric analysis of discrete choice
(Manski, 1975, 1985), especially as extended to static (Manski, 1987) and dynamic (Honoré
and Kyriazidou, 2000) panel data models .
Although network analysis has a rich empirical history in sociology and other disciplines,
there are, as yet, few empirical models of strategic network formation.4 In strategic models
agents form, maintain, or sever links with each other in order to maximize utility (Jackson
and Watts, 2002; Jackson and Wolinsky, 1996; Watts, 2001). This approach to econometrically modeling network formation follows that pioneered by McFadden (1974) for single
agent discrete choice problems.
The multi-agent nature of networks complicates structural model-building. At the risk of
some simplification and omission, recent work in econometrics has taken one of three diﬀerent, albeit complementary, approaches.5
The first approach ignores interdependencies in link formation, focusing instead, on the introduction of rich forms of correlated heterogeneity into dyadic models of link formation
(Dzemski, 2014; Graham, 2014; Krivitsky et al., 2009; van Duijn et al., 2004). This corresponds to the network analog of studying identification and estimation in single agent static
binary choice models (Chamberlain, 1980; Manski, 1987).
The second approach ignores heterogeneity, focusing instead, on interdependencies in link
formation. This approach borrows from earlier work on the econometrics of games, but
introduces new insights to handle the combinatoric complexity of the many player network
formation game (Christakis et al., 2010; Sheng, 2014; de Paula et al., 2015; Mele, 2015;
Menzel, 2015).
A third approach, and the one also adopted here, explores the identifying value of multiple
observations of network structure (Snijders, 2011; Goldsmith-Pinkham and Imbens, 2013;
Graham, 2013).
I assume that the econometrician observes a single network over multiple periods. In each
4

Graham (2015), de Paula (2016) and Chandrasekhar (2016) provide recent reviews of the econometric
literature on network formation. Goldenberg et al. (2010) is a recommended review of the statistics and
machine learning literature.
5
For example Chandrasekhar and Jackson (2015) does not fit easily into this typology.

4

period agents form, maintain, or sever links taking the structure of the network in the
preceding period as fixed. The systematic component of link utility varies with current
network structure. Agents are not forward-looking, rather they treat the current structure
of the network as fixed when deciding whether to maintain, sever or form a link. This is
analogous to the simple best-reply dynamic used to explore issues of existence and stability
in theoretical work (Jackson and Watts, 2002; Jackson and Wolinsky, 1996; Watts, 2001),
and also parallels the empirical approach taken in Christakis et al. (2010), Snijders (2011)
and Goldsmith-Pinkham and Imbens (2013).
My treatment of unobserved heterogeneity in this setting is innovative. I divide the unobserved component of link utility into a time-invariant pair-specific component and a timevarying ‘idiosyncratic’ component. The latter is independently and identically distributed
over time within pairs of agents and independently, although not necessarily identically, distributed across pairs. The distribution of the pair-specific component is left unrestricted. In
a network with N agents there will be a total of n = 21 N (N 1) pair-specific heterogeneity
terms. This is a high-dimensional latent variable. My set-up leaves its joint distribution
unrestricted. Furthermore I leave its relationship with the initial network condition unrestricted. Put diﬀerently, in contrast to all prior work of which I am aware, my identification
analysis is of the ‘fixed eﬀects’, as opposed to ‘random eﬀects’, type (cf., Chamberlain, 1985;
Honoré and Tamer, 2006).
The upshot of these innovations is the first empirical model of strategic network formation
that incorporates both interdependencies in link formation and rich forms of correlated
heterogeneity. This setting, in turn, allows for the first precise articulation of, and test for,
the homophily versus transitivity hypothesis.
The next section introduces a semiparametric model of dynamic network formation. Section
2 considers identifiability of the model’s parameters. Section 3 presents estimation results,
including large sample theory. Section 4 summarizes the results of some Monte Carlo experiments. Section 5 discusses possible extensions. Proofs and some supplemental results
are collected in Appendices A, and B. Replication code for the Monte Carlo experiments is
available in the supplementary materials.
Notation
In what follows various sets of agents and dyads will play a prominent role. In defining these
sets it is useful to recall that “_” denotes the non-exclusive “or”, “_” denotes the exclusive
“or”, “9!” denotes “there exists exactly one”.
Random variables are denoted by capital Roman letters, specific realizations by lower case
5

Roman letters and their support by blackboard bold Roman letters. That is Y , y and Y
respectively denote a generic random draw of, a specific value of, and the support of, Y . I
use ◆N to denote a N ⇥ 1 vector of ones, IN the N ⇥ N identity matrix, and A B denotes the
Hadamard (i.e., entry-wise) product of the conformable matrices A and B. A “0” subscript
on a parameter denotes its population value and may be omitted when doing so causes no
confusion.

1

A dynamic model of network formation

Consider a group of N , potentially connected individuals indexed by i. Individuals may be
equivalently referred to as agents, players, nodes or vertices depending on the context. We
observe all ties across members in each of t = 0, . . . , T periods. Recall that Dijt = 1 if agents
i and j are linked in period t and zero otherwise. Links may be equivalently referred to as
friendships, connections, edges or arcs depending on the context.
P
Let Rijt = N
k=1 Dikt Djkt equal the number of links i and j have in common in period t.
Individuals i and j form a link in period t = 1, . . . , T according to
Dijt = 1 ( 0 Dijt

1

+

0 Rijt 1

+ Aij

Uijt

(2)

0) ,

where 1 (•) is the indicator function, Aij is a pair-specific, time invariant, unobserved heterogeneity term, and Uijt a time-varying shock. Since links are undirected Aij = Aji and
similarly for Uijt . We can think of the term inside the indicator function as the net surplus
associated with an ij link. Rule (2) implicitly conceptualizes utility as being transferrable
across agents (cf., Graham, 2011). Goldsmith-Pinkham and Imbens (2013) specify a related
data generating process that assumes non-transferable utility.
Rule (2) implies a link between i and j is more likely if (i) they were linked in the previous
period (Dijt 1 = 1), (ii) they shared many links in common last period (Rijt 1 is large) or
(iii) there are unobserved pair attributes which generate large surplus from linking (i.e., Aij
is large).6
Let Dt be the N ⇥ N matrix with Dijt as its ij th element. Note that Dt is symmetric and has
a diagonal consisting of zeros. This matrix is called the period t network adjacency matrix.
Let A be the N ⇥ N matrix of pair heterogeneity terms (i.e., the matrix with ij th element
Aij ). Rule (2) only applies to periods 1 to T. I leave the joint distribution of (D0 , A), the
6

Here, as well as in what follows, I assume, for expository purposes, that both

6

and

are positive.

initial condition of the network sequence, unrestricted:
(3)

(D0 , A) ⇠ ⇧0 .
The density function evaluated at D0 = d0 , A = a is denoted by ⇡0 (d0 , a).

To close the model we assume that (i) Uijt is independently and identically distributed over
time and (ii) independently, although not necessarily identically, distributed across pairs7 :
F (U121 , . . . , U12T , . . . , UN

1N 1 , . . . , UN 1N T )

=

T
YY

FU,ij .

(4)

i<j t=1

Throughout I assume that FU (u) is strictly increasing on R1 . Here, and in what follows, I
Q
Q QN
P
PN PN
use the notation i<j to indicate N
i=1
j=i+1 and similarly
i<j to indicate
i=1
j=i+1 .

Rule (2) parsimoniously captures three forces hypothesized by researchers as important for
link formation (cf., Snijders, 2011, 2013). First, there is state dependence in links; all things
equal the returns to linking for i and j are higher in the current period if they were also
connected in the prior period. Second, there are returns to ‘triadic closure’; my utility is
higher if the “friends of my friends are also my friends”. Third, links may form because of
unobserved good ‘fundamentals’ (i.e., Aij is high).
One source of ‘good fundamentals’ is that the pair ij might be similar in some salient unobserved dimension. The tendency for individuals to assortatively match on various observed
characteristics is well documented (McPherson et al., 2001). Here Aij might reflect utility
from assortative matching on unobserved attributes. To make this idea concrete let ⇠i be
a vector of latent individual-specific characteristics and g (⇠i , ⇠j ) a measure of the distance
between i and j in ⇠ (i.e., g (•, •) is a distance function). If Aij = g (⇠i , ⇠j ), then rule (2)
implies that a link between i and j is more likely if they are similar in terms of ⇠. Note Aij
could reflect more than just homophily. For example setting
Aij = ⌫i + ⌫j

g (⇠i , ⇠j ) ,

(5)

allows for the possibility that certain individuals may generate high friendship surplus. Put
diﬀerently ⌫i , and hence Aij , might be high because individual i is a ‘good friend’. Eﬀects
of this type give rise to degree heterogeneity or variation in the number of links maintained
by diﬀerent individuals (cf., Krivitsky et al., 2009; Graham, 2014).
Both a structural taste for transitivity in relationships, here parameterized by , and ho7

In what follows I will generally suppress the potential dependence of FU on ij.

7

mophily on unobserved attributes, can generate high levels of clustering in networks.

Likelihood
Equations (2), (3) and (4) specify a dynamic model of network formation. The joint probability density of a specific sequence of network configurations DT0 = (D0 , D1 , . . . , DT ) and
realization of A is
p dT0 , a, ✓

= ⇡ (d0 , a)
⇥

T
YY

F ( dijt

1

+ rijt

1

+ aij )dijt

i<j t=1

⇥ [1

F ( dijt

1

+ rijt

1

+ aij )]1

dijt

(6)

Let ⇡ D0 |A ( d0 | a) = Pr ( D0 = d0 | A = a) denote the distribution of the initial network given
A = a. Let ⇡A (a) denote the marginal density function for A. The integrated likelihood for
the observed data is then
p

I

dT0 , ✓

=

´

...

ˆ Y
T Yn

FU ( dijt

1

+ rijt

1

+ aij )dijt

t=1 i<j

⇥ [1

FU ( dijt

1

+ rijt

1

+ aij )]1

dijt

⇥⇡ D0 |A ( d0 | a) ⇡A (a) da21 , . . . , daN N

o

1.

(7)

Even if FU (•) and ⇡A (•) are parametrically specified, using (7) as a basis for estimation
and inference is problematic. Three issues arise.
The first is familiar from prior work on dynamic discrete choice analysis: rule (2) provides
no guidance on how to specify ⇡ D0 |A ( d0 | a) (Heckman, 1981c; Honoré and Tamer, 2006). In
analogy I call this the initial network problem. Rule (2) does suggest that the probability of
the event D0 = d0 should vary with the realized value of A, but little else. One approach,
again inspired by single agent models, would involve assuming that ⇡ D0 |A ( d0 | a) coincides
with the steady state distribution implied by (2) (e.g., Heckman, 1981a; Card and Sullivan,
1988). Even if this is empirically plausible, operationalizing it would be non-trivial.
A second problem is that even if ⇡ D0 |A ( d0 | a) were correctly specified, evaluating (7) requires
computing a very high-dimensional integral. Since it seems reasonable, at the very minimum,
to choose a specification for ⇡A (a) which allows Aij and Aik to covary, there is no obvious way
to factor (7) to reduce the dimensionality of the required integration. Goldsmith-Pinkham
and Imbens (2013) assume that Aij = ↵⇠ |⇠i ⇠j | with ⇠i binary, independent of ⇠j , and
8

Pr (⇠i = 1) = p. Directly evaluating the integrated likelihood in this case involves a weighted
sum of the likelihood given A over its 2N possible realizations.8
A third problem, related to the second, and emphasized by Goldsmith-Pinkham and Imbens
(2013) , is that even if the maximum likelihood estimate
could
⇣
⌘ be computed, it would not be
ˆ
clear how to conduct large sample inference using M L , ˆM L ; at least with data drawn from
a single network. This motivates their recourse to Bayesian methods, which are attractive
for computational reasons and also for providing a principled approach to inference. The
approach to inference developed below, in contrast, is frequentist.

2

Fixed eﬀects identification

With FU (•) and ⇡ (•) (semi-) parametrically specified, an approach to estimation and inference based on the integrated likelihood (7), whether frequentist or Bayesian, is a so called
random eﬀects one. The discussion above indicates that the random eﬀects approach to network analysis involves delicate modeling issues as well as serious computational challenges.
In this section I explore the fixed eﬀects identifiability of ( , ). That is I explore what
can be learned about these two parameters when the joint distribution of (D0 , A) is left
completely unrestricted. The fixed eﬀects framework is a natural one in which to begin any
formal analysis of identification, since adding restrictions to the model, as the random eﬀects
approach does, can only improve identifiability.
Nevertheless one might question the fruitfulness of a fixed eﬀects analysis at the outset. The
random variable (D0 , A) is of very high dimension, consisting of N (N 1) components.
This suggests that leaving its joint distribution unspecified may lead to serious identification
problems. A key contribution of this paper is to show that a fixed eﬀect approach to dynamic
network analysis is feasible and fruitful.
In single agent models fixed eﬀects identification of true state dependence in the presence of
unobserved heterogeneity is based on the frequency of observing certain sequences of choices
relative to other sequences (e.g., Cox, 1958; Heckman, 1978; Chamberlain, 1985; Honoré and
Kyriazidou, 2000). For example, in the absence of state dependence the binary sequences
0101 and 0011 are equally likely. In the presence of state dependence, the relative frequency
of the latter sequence will be greater (under certain assumptions).
The approach to identification developed below is similar, being based on the relative frequency of certain ij friendship histories. However the analysis is more complicated than
8

van Duijn et al. (2004) introduce MCMC methods that also might be adapted in order to evaluate (7)
in special cases.

9

in the single agent case. This is because the eﬀect of the pair ij forming or terminating a
link in period t cascades through the period t + 1 portion of the likelihood. Such an eﬀect
was implicit in the discussion accompanying Figure 2 above. For example if ik are linked in
period t, then the addition of an ij link increases the probability of a jk link in period t + 1.
Local changes in the network can have widespread eﬀects on the structure of the network in
subsequent periods.
The high level of interdependence across diﬀerent pairs of agents’ link decisions makes the
mapping from the frequency of relative friendship histories to the model parameters less direct than in the single agent case. My approach is to consider pairs of agents that are embedded in a stable neighborhood (defined below). The relative frequencies of diﬀerent friendship
histories, when pairs are themselves embedded in diﬀerent types of stable neighborhoods,
provides information about the model parameters. Intuitively my approach involves making
comparisons ‘holding other features of the network fixed’. This is not straightforward to
do. The likelihood functions associated with two network histories, identical in all respects
except that the ij friendship history in one is a permutation of that in the other, may be
very diﬀerent due to the interdependent nature of linking in the model.

Stable neighborhoods
I consider the T = 3 case. This corresponds to four network observations, with the initial
network receiving a ‘0’ subscript (this is the minimal number of observations needed for
a positive result). As will become apparent shortly, the extension to the general case is
straightforward (cf., Charlier et al., 1995)
The period t neighbors of dyad ij are given by the index set
nt (ij) = {k | dik = 1 _ djk = 1} \ {i, j} .
Dyad ij’s neighborhood consists of all agents to which it is directly connected; excluding
each other.
Definition 1. (Neighborhood Stability) ij is embedded in a stable neighborhood if
(i) n1 (ij) = n2 (ij) = n3 (ij),
(ii) for all k 2 n1 (ij) and l = 1, . . . , N ; l 6= i, j we have dkl1 = dkl2 .
A stable neighborhood has two features. First, with the exception of possible link formation
and dissolution between themselves, the set of links maintained by agents i and j is constant
across periods 1, 2 and 3. Constancy in i and j’s links across periods 0 and 1 is not required.
10

To the contrary, some inter-period variation in these links is required for identification.
Second, the links maintained by neighbors of players i and j do not change between periods
1 and 2.
Neighborhood stability imposes some time constancy of links up to two degrees away from the
reference dyad. Examples of dyads embedded in stable neighborhoods are given in Figures
3 to 5 below.
Definition 2. (Stable Dyad) Dyad ij is stable if (i) it is embedded in a stable neighborhood
and (ii) i and j revise their link status between periods 1 and 2 such that dij1 6= dij2 .
A basic implication of Definition 2 is that two stable dyads are separated in a certain sense,
a fact that will prove helpful below.
Lemma 1. ( Separation) Let ij and kl denote two stable dyads, then the distance between
i and k (or equivalently i and l or j and k) is at least two degrees in periods 1 and 2.
Proof. Suppose i and k are distance one apart, then the second condition for neighborhood
stability in Definition 1 is violated for both ij and kl.
Appendix B outlines how to construct an indicator for dyad stability. A Python 2.7 function
for this purpose is included in the supplemental materials. This program makes extensive
use of the broadcasting rules embedded in the Numpy module. It can eﬃciently find all
stable dyads in networks consisting of tens of thousands of agents on a desktop computer.
In what follows the binary variable Zij will equal one if ij is a stable dyad and zero otherwise.
It is also helpful to have an index notation for dyads. Recall that i = 1, 2, . . . indexes the N
agents in the network. Let the boldface indices i = 1, 2, . . . index the n = N2 = 12 N (N 1)
dyads among them (in arbitrary order). In an abuse of notation, also let i denote the set
{i1 , i2 }, where i1 and i2 are the indices for the two agents which comprise dyad i. Using this
notation we have, for example, Zi = Zi1 i2 .
Finally the arguments presented below involve various partitions of the N agents and n
dyads in the network into diﬀerent sets. Let Ns = {i| 9! j , Zij = 1} denote the set of all
nodes that are part of a stable dyad. Let Nsc = N \ Ns denote the absolute complement of
Ns in N ; or the set of all nodes which are not part of a stable dyad. Let Ds = {i | Zi1 i2 = 1}
denote the set of all stable dyads, Dns = {i | i1 2 Ns _ i2 2 Ns } the set of all dyads that are
not stable, but include a node who is part of a stable dyad, and Dod = D \ (Ds [ Dns ) the
set of all dyads where both nodes are not part of Ns (i.e., “all other dyads”).
Finally, let D denote the set of all valid binary undirected adjacency matrices.
11

Main identification result
Consider the set of network sequences
Vs =

v03 = (v0 , v1 , v2 , v3 ) vt 2 D for t = 0, . . . , 3,
v0 = d0 , v1 + v2 = d1 + d2 , v3 = d3 ,
vij1 = dij1 & vij2 = dij2 if zij = 0, for i, j = 1, . . . , N } .

(8)

The set Vs contains all network sequences constructed by permutating the period 1 and 2
def
link decisions of the mN ⌘ |Ds | dyads embedded in stable neighborhoods. All other link
decisions are held fixed at their observed values. The set Vs therefore contains 2|Ds | = 2mN
elements. To restate, it consists of all network sequences generated by permutating the
observed of period 1 and 2 link decisions of dyads that (i) revise their linking behavior across
periods 1 and 2 and (ii) are embedded in stable neighborhoods. All other link decisions
coincide with the observed ones.
The main result is a conditional likelihood expression.
Theorem 1. ( Conditional Likelihood) Under the data generating process specified in
Section 1 the conditional likelihood of the event D03 = d30 given that d30 2 Vs ,
lc d30 , a, ✓ = P

equals
l

c

d30 , a, ✓

=

Y

i2Ds

1
01
1 + bi1 i2 (qij , aij , ✓)

p (d30 , a, ✓)
,
3
v2Vs p (v0 , a, ✓)

1(si1 i2 =1)

where Qij = (Dij0 , Dij3 , Rij0 , Rij1 )0 , Sij = Dij2
def

b01
ij (qij , aij , ✓) ⌘

def

b10
ij (qij , aij , ✓) ⌘

1

F
F(
F(
1 F



1
10
1 + bi1 i2 (qij , aij , ✓)

(9)

1 ( s i 1 i 2 = 1)

,

(10)

Dij1 and

( dij0 + rij0 + aij ) F ( dij3 + rij1 + aij )
dij0 + rij0 + aij ) 1 F ( dij3 + rij1 + aij )
dij0 + rij0 + aij ) 1 F ( dij3 + rij1 + aij )
.
( dij0 + rij0 + aij ) F ( dij3 + rij1 + aij )

Observe that the denominator in (9) is a summation over 2mN elements, where mN is the
number of stable dyads in the network. The remarkable feature of Theorem 1 is that this sum,
unlike in many other similar contexts (e.g., Blitzstein and Diaconis, 2011; Chatterjee and
Diaconis, 2013), is not intractable. Indeed the ratio (9) can be expressed as a simple product
12

of just mN terms. Given the interdependencies across dyads embedded in the (unconditional)
likelihood, that such a factorization is possible hinges critically on the choice of conditioning
set. The proof of this result, which is given below, requires careful bookkeeping and some
counting/permutation arguments.
Two corollaries follow from Theorem 1 directly. The first is a semiparametric maximum-score
type identification result.
Corollary 1. ( Semiparametric Identification) Under the data generating process
specified in Section 1
Pr ( Dij1 = 1, Dij2 = 0| Q = q, Zij = 1) Q 0

Pr ( Dij1 = 0, Dij2 = 1| Qij = q, Zij = 1)
according to whether
(d3

d0 ) + (r1

r0 ) Q 0.

Proof. Follows from Theorem 1 and Manski (1987) or Honoré and Kyriazidou (2000).
Because Rijt is integer-valued semiparametric point identification of ✓ = ( , )0 is not possible
(even after normalization). However if Rij1 Rij0 has a large number of support points, the
identified set will be quite small.
The second corollary to Theorem 1 shows that point identification (up to scale) is possible
under logistic errors.
Corollary 2. ( Logistic Identification) When, additionally, Uijt is standard logistic
Pr ( Dij1 = d1 , Dij2 = d2 | Qij = q, Zij = 1) =
with Xij = (Dij3

Dij0 , Rij1

✓

exp (x0 ✓)
1 + exp (x0 ✓)

◆1(s=1) ✓

exp (x0 ✓)
1 + exp (x0 ✓)

◆1(s=

1)

Rij0 )0 .

Proof. Follows from Theorem 1 and direct calculation.
As in the single agent dynamic binary choice case (e.g., Cox, 1958; Chamberlain, 1985;
Honoré and Kyriazidou, 2000), Theorem 1 follows from an implication of the model that is
invariant to the value of A. In the single agent case a comparison of the relative frequencies
of the link sequences dij0 01dij3 and dij0 10dij3 provides information about the strength of
state-dependence. Consequently all agents who revise their choice between periods t = 1
and t = 2 contribute.
In the present context, the relative frequencies of the link sequences dij0 01dij3 and dij0 10dij3
also provides information about the signs and magnitudes of 0 and 0 . However we must
13

confine analysis to dyads who, in addition to revising their linking decision between periods
t = 1 and t = 2, are also embedded in stable neighborhoods. We specifically learn about 0
versus 0 from the link histories of dyads embedded in stable neighborhoods with diﬀerent
types of network architecture. The need to condition on neighborhood stability arises because
of interdependencies in link decisions.
Consider two network sequences, identical every respect, except that in the first one dyad ij’s
link history is dij0 01dij3 , while in the second it is dij0 10dij3 . The second network sequence
can be derived by permuting the period t = 1 and t = 2 link decisions of just a single dyad. If
linking decisions were conditionally independent across dyads, then the likelihoods associated
with these two network sequences would diﬀer by only a single term (corresponding to the
direct likelihood contribution of the ij dyad). When linking decisions are interdependent,
however, these two likelihoods may have many terms diﬀerent, even though the two network
sequences are nearly identical. That two nearly identical network sequences may have very
diﬀerent likelihoods attached to them is a consequence of the interdependence in linking
decisions across dyads induced by a structural taste for transitivity.
To see this consider the eﬀect, on the form of the likelihood, of changing dij1 from zero to
one. The eﬀect of such a small change on the structure of the likelihood is complicated.
First, due to state dependence, this change alters the incentive for i and j to form a link in
period t = 2. Second, the period t = 2 incentives for other agents to link with either i or j
may change. This occurs if ril1 changes in value when dij1 does, as would occur if l and j
are linked in period t = 1. In that case the presence of a period t = 1 link between i and
j creates an opportunity for i and l to engineer triadic closure in period t = 2 by linking.
Introducing a ij link in period t = 1 therefore increases the incentives for certain links to
form in period t = 2. Finally, the change in dij1 does not aﬀect pairs that do not include
either i or j. This is because a change in dij1 does not alter rkl1 for such pairs.
The insight of Theorem 1 is that we can control these cascading eﬀects on the likelihood
by restricting how the neighborhood surrounding ij evolves. If ij is embedded in a stable
neighborhood then a permutation of dij1 and dij2 will leave the net contribution of all non
ij pairs to the likelihood unchanged. Specifically while many terms in the two likelihoods
will be nominally diﬀerent, it turns out that after permuting terms they can be shown to
be identical up to the contribution from ij alone. The balance of the argument then follows
from ideas introduced in the study of single agent discrete choice models (Chamberlain, 1985;
Manski, 1987; Honoré and Kyriazidou, 2000).

14

Figure 3: Identification: transitivity versus homophily

Notes: Number agents 1, 2 and 3 clockwise from the top in each network. The top and
bottom rows depict two network sequences. In the top one agents 1 and 2 link in period 2, but
not in period 1 (Rose Garden colored edge). In the bottom row they link in period 1, but not
in period 2. Observe (i) agents 1 and 2 constitute a stable dyad (since d131 = d132 = d133 = 1
and d231 = d232 = d233 = 1) and (ii) while they share a link in common in period t = 1, they
do not in period t = 0. Consequently forming a link has a higher return in period 2 than
in period 1. In period 2 the link generates utility from ensuring ‘triadic closure’, no such
utility gain is generated by a period 1 link. Therefore, the top network sequence arises more
frequently than the bottom in the presence of a structural taste for transitivity in links.

Examples of stable neighborhood
Before presenting the proof of Theorem 1 it is helpful to review a view examples illustrating
how Corollary 1 works in practice.
The two rows in Figure 3 depict two network sequences. Numbering agents 1, 2 and 3
clockwise from the top, we can see that agents 1 and 2 (the two Berkeley blue nodes)
constitute a stable dyad. Further observe that while these two agents share agent 3 (the
California gold node) as a common friend in period t = 1, they do not in period t = 0.
Therefore the returns to linking in period t = 2, where agents 1 and 2 reap the returns from
engineering triadic closure, are higher than the corresponding returns from linking in period
t = 1. In the presence of a structural taste for transitivity, > 0, we will observe the top
sequence more frequently than the bottom sequence.
Figure 4 develops an example of how the relative frequency of two diﬀerent network sequences
provides information about the state dependence parameter 0 . Here the intuition parallels
15

that familiar from the single agent binary choice case (e.g., Cox, 1958; Heckman, 1978;
Chamberlain, 1985).
Figure 4: Identification: state dependence versus heterogeneity

Notes: See the notes to Figure 3. In this example r120 = r121 , so agents 1 and 2 will accrue
returns from transitivity by linking in both periods 1 and 2. However, d123 = 1 and d120 = 0,
suggesting that, in the presence of state dependence ( 0 > 0), the top sequence will occur
more frequently than the bottom. The intuition in this case is very similar to that underlying
the results of Cox (1958), Heckman (1978) and Chamberlain (1985).
As a final example consider the two network sequences depicted in Figure 5. The two
Berkeley blue nodes constitute a stable dyad. Both blue nodes maintain the same links in
periods t = 1, 2, 3 (except with each other) and it is also the case that the links maintained
by their friends remain constant in periods t = 1, 2. Since the two blue nodes are neither
linked in the initial t = 0 period or the final t = 3 period, state dependence does not play
a role in their linking decisions. However, observe that the two agents share no links in
common in period t = 0, while sharing two in common in period t = 1. Consequently the
returns to the two agents linking in period t = 2 will be higher than those in available in
t = 1. Consequently we should observe the top sequence more frequently than the bottom
sequence in the presence of a structural taste for transitivity.

16

Figure 5: Identification: transitivity versus homophily in a more complex stable neighborhood

17
Notes: The two Berkeley blue nodes constitute a stable dyad in both the top and bottom sequences. Both blue nodes maintain
the same links in periods t = 1, 2, 3 (except with each other) and it is also the case that the links maintained by their friends
remain constant in periods t = 1, 2. See text for additional narrative.

Proof of Theorem 1
Readers uninterested in the proof of Theorem 1 can skip directly to Section 3, which discusses
estimation and inference.
The proof of Theorem 1 relies on the following Lemma.
Lemma 2. ( Permutation) Consider the network sequence formed by permuting the period
⇤
⇤
1 and 2 link decisions of any subset of the set of all stable dyads, Ds . Let (Ril1
, Ril2
) denote
c
the values of (Ril1 , Ril2 ) after such a permutation for i 2 Ns and l 2 Ns . Let ij be the stable
dyad to which i belongs. If ij’s link histories where changed as part of the permutation, then
⇤
⇤
⇤
⇤
(Ril1
, Ril2
) = (Ril2 , Ril1 ), otherwise (Ril1
, Ril2
) = (Ril1 , Ril2 ).
Proof. From the definition of Rilt we have, for all l = 1, . . . , N not equal to i or j,
Ril2

Ril1 =
=

"

N
X

Dik2 Dlk2

k=1
N
X

#

"

N
X

Dik1 Dlk1

k=1

#

Dik1 (Dlk2

Dlk1 ) + Dij2 Dlj2

Dik1 (Dlk2

Dlk1 ) + (Dij2

Dij1 Dlj1

k=1,k6=j

=

N
X

Dij1 ) Dlj1

k=1,k6=j

with the second equality coming from rearrangement and the stability of all of i’s links, other
than those with j, across periods 1 and 2 (which implies Dik1 = Dik2 for all k 6= j). The third
equality comes from the corresponding stability of j’s links (which implies Dlj2 = Dlj1 ).
P
Now observe that N
Dlk1 ), the first term to the right of the last equalk=1,k6=j Dik1 (Dlk2
ity above, equals zero since if Dik1 = 1, then k is a neighbor of i and the definition of
neighborhood stability then implies that Dlk1 = Dlk2 . Rearranging we have shown that
Ril2 = Ril1 + (Dij2

Dij1 ) Dlj1 .

(11)

⇤
Now consider Ril1
, the number of friends in common between agents i and l after permuting
ij’s period 1 and 2 link statuses:
⇤
Ril1
= Ril1 + Dij2 Dlj1

= Ril1 + (Dij2

Dij1 Dlj1

Dij1 ) Dlj1

⇤
which coincides with Ril2 by (11) above. A similar argument gives Ril2
= Ril1 .

18

To show the main result it is convenient to partition the likelihood (6) into four components:
p d30 , a, ✓

(12)

= ⇡ (d0 , a)
Y

3
Y

+ ai 1 i 2 ) d i 1 i 2 t

(13)

⇥ [1 F ( di1 i2 t 1 + ri1 i2 t 1 + ai1 i2 )]1 di1 i2 t
3
Y Y
⇥
F ( d i 1 i 2 t 1 + r i 1 i 2 t 1 + ai 1 i 2 ) d i 1 i 2 t

(14)

⇥

i2Dod

F ( d i1 i2 t

1

+ r i1 i2 t

1

t=1

i2Dns t=1

⇥ [1 F ( di1 i2 t 1 + ri1 i2 t 1 + ai1 i2 )]1 di1 i2 t
3
YY
⇥
F ( d i 1 i 2 t 1 + r i 1 i 2 t 1 + ai 1 i 2 ) d i 1 i 2 t

(15)

i2Ds t=1

⇥ [1

F ( d i1 i2 t

1

+ ri1 i2 t

1

+ ai1 i2 )]1

d i 1 i2 t

Line (12) contains the likelihood contribution corresponding to the joint density of the initial
network condition and pair-specific heterogeneity terms. Line (13) contains the contributions
of all dyads where neither agent is embedded in a stable neighborhood. Line (14) contains
the contribution from all dyads where one agent, but not the other, is embedded in a stable
neighborhood. Finally line (15) contains the contribution of dyads embedded in stable
neighborhoods.
We can use this partition of the likelihood to evaluate the conditional likelihood of observing
D30 = d30 conditional on the event that d30 2 Vs
lc d30 , a, ✓

= P

p (d30 , a, ✓)
.
3
v2Vs p (v0 , a, ✓)

(16)

In order to simplify (16) it is convenient to analyze its inverse , which consists of the sum of
2mN ratios of the form
p (v03 , a, ✓)
,
(17)
p (d30 , a, ✓)
for v03 2 Vs . We can use the likelihood decomposition given by (12) to (15) above to derive
an explicit expression for this ratio.
First, since the initial condition is held fixed across the two network sequences, the ⇡ (v0 , a)
and ⇡ (d0 , a) terms in, respectively, the numerator and denominator of (17) cancel. Second,
observe that any permutation of the period 1 and 2 link decisions of dyads in Ds leaves the
utility associated with links across dyads in Dod unchanged. Therefore the period t = 1, 2, 3
likelihood contributions associated with all dyads in Dod , the terms in line (13) above, also
19

cancel in (17).
⇤
⇤
⇤
Third, consider dyad il with i 2 Ns and l 2 Nsc . Let ril0
, ril1
and ril2
denote the number of
friends i and l have in common in periods t = 0, t = 1 and t = 2, respectively, under network
sequence v03 2 Vs . Since i is part of a stable dyad (and l is not), it must be the case that
vil1 = vil2 = vil3 = 1 or vil1 = vil2 = vil3 = 0 (by the first part of Definition 1). Note also
⇤
that, by the definition of Vs , ril0
= ril0 , vil0 = dil0 , vil1 = dil1 , vil2 = dil2 and vil3 = dil3 . First
assume that vil1 = vil2 = vil3 = 1. In this case the period t = 1, 2, 3 likelihood contributions
of the il dyad under v03 are
⇤
⇤
⇤
F ( vil0 + ril0
+ ail ) F ( + ril1
+ ail ) F ( + ril2
+ ail ) = F ( dil0 + ril0 + ail )

⇥F ( + ril2 + ail )
⇥F ( + ril1 + ail ) ,
⇤
⇤
where the equality follows from the fact that ril1
= ril2 and ril2
= ril1 by Lemma 2 above. Now
observe that the expression to the right of the equality, after re-ordering, is identical to the
t = 1, 2, 3 likelihood contributions of the il dyad under d30 . Using an analogous observation
for the vil0 = vil2 = vil3 = 0 case implies that the net period t = 1, 2, 3 contributions of dyad
il to the likelihoods of d30 and v03 are identical (up to a re-ordering of terms). This this leads
to a cancellation of the terms corresponding to lines (14) above. This is a key step of the
argument.

All that remains of (17) is the ratio of the mN components in line (15), one for each stable
dyad, under v versus d. If (vij1 , vij2 ) = (dij1 , dij2 ), then the contributions of dyad ij 2 Ds
to the numerator and denominator of (17) cancel. If (vij1 , vij2 ) = (dij2 , dij1 ) = (1, 0), then
dyad ij 2 Ds contributes the term
3
b10
ij v0 , ✓

=

F ( dij0 + rij0 + aij ) 1
1 F ( dij0 + rij0 + aij )
⇥

F ( rij2 + aij )dij3

[1

F ( + rij1 + aij )
F ( rij1 + aij )
F ( rij2 + aij )]1

dij3

F ( + rij2 + aij )dij3 [1 F ( + rij2 + aij )]1
F ( dij0 + rij0 + aij ) 1 F ( + rij1 + aij )
=
1 F ( dij0 + rij0 + aij )
F ( rij1 + aij )
⇥

F ( rij1 + aij )dij3
F ( + rij1 + aij )dij3 [1

[1

F ( rij1 + aij )]1

dij3

dij3

F ( + rij1 + aij )]1

dij3

,

to (17), which, following Honoré and Kyriazidou (2000), can be shown to equal
3
b10
ij v0 , ✓ =

F ( dij0 + rij0 + aij ) 1 F ( dij3 + rij1 + aij ) def 10
⌘ bij (qij , aij , ✓)
1 F ( dij0 + rij0 + aij ) F ( dij3 + rij1 + aij )
20

(18)

if dij3 = 1 and also if dij3 = 0. In the logit case
b10
ij (qij , aij , ✓) = exp (

(dij3

dij0 )

(rij1

rij0 )) ,

which is invariant to the value of aij . Recall that qij denotes the conditioning vector qij =
(dij0 , dij3 , rij0 , rij1 )0 and ✓ = ( , )0 the parameter vector of interest.
If (vij1 , vij2 ) = (dij2 , dij1 ) = (0, 1), then dyad ij 2 Ds contributes
3
b01
ij v0 , ✓

=

1

⇥

F ( dij0 + rij0 + aij )
F ( dij0 + rij0 + aij ) 1
F ( + rij2 + aij )dij3 [1

F ( + rij2 + aij )]1

F ( rij2 + aij )dij3
[1
1 F ( dij0 + rij0 + aij )
=
F ( dij0 + rij0 + aij ) 1
⇥

F ( + rij1 + aij )dij3 [1
F ( rij1 + aij )dij3

F ( rij1 + aij )
F ( + rij1 + aij )
F ( rij2 + aij )]1 dij3
F ( rij1 + aij )
F ( + rij1 + aij )
F ( + rij1 + aij )]1

[1

dij3

F ( rij1 + aij )]1

dij3

dij3

which, again follows following Honoré and Kyriazidou (2000), equals
3
b01
ij v0 , ✓ =

1

F ( dij0 + rij0 + aij ) F ( dij3 + rij1 + aij ) def 01
⌘ bij (qij , aij , ✓)
F ( dij0 + rij0 + aij ) 1 F ( dij3 + rij1 + aij )

(19)

if dij3 = 1 and also if dij3 = 0. In the logit case
b01
ij (qij , aij , ✓) = exp ( (dij3

dij0 ) + (rij1

rij0 )) .

For all v03 2 Vs we therefore have that the contributions of dyad ij 2 Ds to the numerator
and denominator of (17) either cancel or equal (18) or (19) according to whether (dij1 , dij2 ) =
(0, 1) or (dij1 , dij2 ) = (1, 0).
Let Sij = Dij2
P

Dij1 , using the above calculations, we can write,

Y⇥
⇤1(si1 i2 =1) ⇥
⇤ 1 ( si 1 i 2 = 1)
p (v03 , a, ✓)
01
10
=
1
+
b
(q
,
a
,
✓)
1
+
b
(q
,
a
,
✓)
.
ij
ij
ij
ij
i1 i2
i1 i2
p (d30 , a, ✓)
i2D

v2Vs

s

Note that the product to the right of the equality above evaluates to a sum of 2mN terms,
one for each element of Vs , as required. Inverting yields a simplification of (16) equal to (10)
as claimed.

21

In the logit case (10) simplifies further to
c

l (✓) =

Y

exp x0i1 i2 ✓
1 + exp x0i1 i2 ✓

i2Ds

recalling that Xij = (Dij3

3

Dij0 , Rij1

!1(si1 i2 =1)

exp x0i1 i2 ✓
1 + exp x0i1 i2 ✓

! 1 ( si1 i2 = 1)

,

(20)

Rij0 )0 .

Estimation and inference

In this section I introduce an estimator for ✓0 based on Corollary 2. This corresponds to the
case where the model described in Section 1 is augmented with the assumption that Uijt is a
standard logistic random variable. The estimator is simply the maximizer of the conditional
likelihood presented in Theorem 1 (evaluated under the logit assumption):
LN (✓) =

N
2

1

N X
X

lij (✓) .

(21)

i=1 j<i

where
lij (✓) = Zij Sij Xij0 ✓

⇥
⇤
ln 1 + exp Sij Xij0 ✓
.

(22)

The stable neighborhood logit (henceforth SN logit) estimate of ✓0 is given by9
✓ˆSN = arg max LN (✓)
✓2⇥

(24)

To derive the large sample properties of ✓ˆSN it is helpful to first formalize some conditional
independence properties embedded in the conditional likelihood (10). Order dyads, without
loss of generality, so that i = 1, . . . , mN indexes the mN = |Ds | dyads embedded in stable
neighborhoods.
Lemma 3. (Independence of Link Histories Among Stable Dyads) The events
S1 = s, . . . , SmN = s are conditionally independent given Z1 = · · · = ZmN = 1, D0 = d0 ,
D3 = d3 and A = a.
9

While I will not present formal results for it, a semiparametric maximum score estimator based on
Theorem 1 could be constructed by maximizing
N
✓:k✓ ✓k=1 2

max
0

1

N X
X

Zij (Dij2

0
Dij1 ) sgn Xij
✓ .

i=1 j<i

The set of maximizers of (23) would provide an estimate of the identified set.

22

(23)

Proof. The conditional likelihood (10) evaluated at ✓ = ✓0 gives the probability of all possible
permutations of period 1 and period 2 link histories between dyads embedded in stable
neighborhoods conditional on all other features of the network being held fixed. For any
i = 1, . . . , mN marginalizing gives
Pr ( Si = s| Z1 = · · · = Zm

✓

◆1(si =1)
1
= 1, d0 , d3 , a) =
1 + b01
i1 i2 (qij , aij , ✓0 )
✓
◆1(si =
1
⇥
1 + b10
i1 i2 (qij , aij , ✓0 )
= Pr ( Si = s| Zi = 1, qi , ai )

1)

(25)

the product of (25) for i = 1, . . . , mN gives (20).
Lemma 3 implies that the stable neighborhood logit criterion function (20) consists of mN =
|Ds | conditionally independent components. As long as mN ! 1 and N ! 1 consistency
and asymptotic normality of ✓ˆSN follows relatively directly. To state a formal result I require
some additional assumptions.
Assumption 1. (Sampling) The econometrician observes all agents and links between
them in t = 0, 1, 2, 3.
Developing results for other sampling schemes, as when the researcher collects a set of egocentered graphs, would be an interesting topic for future search.
Assumption 2. (Regularity)
(i) ✓0 2 int (⇥), with ⇥ a compact subset of R2 ,
(ii) for any two agents i and j, Rijt is a bounded for t = 0, 1
Part (i) of Assumption 2 is standard regularity condition. Given that most networks are
sparse, part (ii) is not especially restrictive. Specifically if each agent can maintain only a
finite number of links, then she can have at most a finite number of links in common with
any other agent. This assumption can also be relaxed by assuming that Rijt has, instead, a
suﬃcient number of finite moments.
Point identification further requires:
Assumption 3. (Identification)
(i) n↵N ! 1 with ↵N = Pr (Zij = 1)
⇥
⇤
(ii) E Xij Xij0 Zij = 1 is a finite non-singular matrix
23

Part (i) of Assumption 3 ensures that the number of stable dyads increases with the size of
the network. Although it allows the probability attached to the event “ij is a stable dyad”
to approach zero as the network grows, it does so at suﬃciently slow rate such that the total
number of stable dyads nevertheless grows large as N ! 1. One way to ensure that part (i)
holds is to impose restrictions on the sequence {Aij }1
j=i+1 . An example is implicitly provided
by the Monte Carlo design introduced below. The single agent binary choice analog of part
(i) of Assumption 3 is the requirement that the number of switchers or movers grows with
the sample size (Chamberlain, 1980).
Part (ii) of Assumption 3 is a standard identification condition for binary choice models,
albeit expressed conditionally on Zij = 1 (e.g., Amemiya, 1985).
⇥
⇤
exp(X 0 ✓ )
Let pij (✓) = 1+exp Xij0 ✓ with pij = pij (✓0 ) and ⇤0 = E pij (1 pij ) Xij Xij0 Zij = 1 . The
( ij )
large sample properties of ✓ˆSN are summarized in the following theorem.
Theorem 2. (Asymptotic Properties of ✓ˆSN ) Under the assumptions stated above
p
(i) ✓ˆSN ! ✓⇣0
⌘
p
D
ˆ
(ii) n↵N ✓SN ✓0 ! N 0, ⇤0 1

The proof of Theorem 2 can be found in Appendix A. It is relatively straightforward.
Recall that mN equals the number of conditionally independent components in the SN logit
criterion function. Therefore {mN } is a sequence of integer-valued random variables. Part
(i) of Assumption 3 implies that
mN p
! 1,
n↵N
with n↵N ! 1. Hence the number of components in the SN logit criterion function will
grow large with the network. This allows for the application of a central limit theorem for a
random number of summands. Theorem 1.9.4 of Serfling (1980) is suﬃcient for my purposes.
The upshot of Theorem 2 is that, in practice, estimation of, and inference on, ✓0 is very
straightforward. The main challenge is to quickly find all stable dyads in the network.
As mentioned above, a description of how to construct the Zij indicator can be found in
Appendix B and a Python function for finding stable dyads is included in the supplementary
materials.
Once all stable dyads have been located, estimation and inference can be conducted using a standard logit maximum likelihood program. Specifically let Yij = 1 (Sij = 1) =
1 (Dij1 = 0, Dij1 = 1) and recall that Xij = (Dij3 Dij0 , Rij1 Rij0 )0 . A standard logit fit
of Yij onto Xij across the subset of Zij = 1 stable dyads coincides with the SN logit estimator.
The conventional standard errors reported by the program will be asymptotically valid.10
10

A constant should not be included in the design matrix. Most logit programs include a constant by

24

4

Monte Carlo experiments

The Monte Carlo design uses a random geometric graph to construct an “opportunity graph”
for link formation. Specifically agents are scattered uniformly on the two-dimensional plane
h p i h p i
0, N ⇥ 0, N .

The initial network is then generated according to the rule
Dij0 = 1 (Aij

Uij0

0) ,

with Uij0 logistic and Aij0 taking one of two values. If the Euclidean distance between i and
j is less than or equal to r, then Aij0 = ln 1 0.75
, otherwise Aij0 equals negative infinity.
0.75
This calibration means that, in the initial period, agents that are less than r apart link with
probability 0.75, while those greater than r apart link with probability zero.
The expected degree of a randomly sampled agent in t = 0 is approximately 0.75⇡r2 (An
exact expression for average degree, which takes into account boundary eﬀects, can be calculated along the lines of Kostin (2010)). An implication of this set-up is that the initial
condition is sparse: average degree does not increase with network size. By varying the value
of r I can manipulate the average degree, and hence connectivity, of the initial condition. I
choose values of r such that in large networks average degree in period t = 0 is 2, 3 or 4.11
With an average degree of 2, the resulting initial condition consists of many small disconnected components. When average degree equals 3 a large giant component begins to form.
Finally when average degree equals 4 almost all agents are part of one giant component (see
Table 1). It is well-known that a phase-transition occurs at an average degree of 3 in random
geometric graphs (Penrose, 2003).
In period t = 1, 2, 3 links evolve according to rule (2) with = = 1.12 A key feature of this
design is that it generates homophilous link formation based on location (which is unobserved
by the econometrician). Although there are no network eﬀects in operation in period t = 0,
measured transitivity of the initial network is quite high, with the clustering coeﬃcient
exceeding 0.4 in all cases (see Table 1). In subsequent periods transitivity and average degree
increase as agents form additional links (on net) in response to state dependence and a taste
default, but also have an exclusion option.
11
As a point of reference McPherson et al. (2006) estimate the average size of adult Americans core
discussion networks (i.e., confidants with whom individuals discuss important matters) was about three in
1985 and two in 2004.
12
Since agents greater that r apart will never link, average degree in the network is bounded above by ⇡r2
in periods t = 1, 2, 3. This corresponds to maximum average degrees of (approximately) 2.67, 4 and 5.33
across the three designs.

25

for triadic closure. Link clustering in these design therefore arises from both homophily and
a taste for triadic closure, making them an appropriate test case for evaluating the small
sample relevance of Theorem 2.
A typical sequence of networks, with N = 200 and average degree in the initial network set
equal to 4, is depicted in Figure 6. The figure indicates that stable dyads come in diﬀerent
forms and can arise even in a strongly connected network. In the figure the larger Berkeley
blue nodes correspond to stable dyads, the California gold nodes are immediate neighbors,
while the Medalist colored nodes are indirect neighbors. Stable dyads arise in sparse regions
of the network, as might be expected, but also in relatively dense regions.
Table 1: Basic Properties of Simulated Network Sequences
Asymptotic Degree
2
3
Period
E [Dit ]
T
GC E [Dit ]
T
GC E [Dit ]
t=0
1.98 0.44 0.01 2.96 0.44 0.05 3.94
t=1
2.41 0.58 0.01 3.68 0.58 0.08 4.98
t=2
2.49 0.59 0.01 3.80 0.59 0.09 5.12
t=3
2.50 0.60 0.01 3.82 0.59 0.09 5.14

4
T
0.44
0.58
0.59
0.59

GC
0.58
0.83
0.84
0.85

Notes: The table reports period-specific network summary statistics across the B = 1, 000 Monte
Carlo simulations for each design (N = 5, 000). See main text for other design details. The E [Dit ]
column gives the average degree, T the global clustering coeﬃcient or transitivity index and GC
the fraction of agents that are part of the largest giant component.

Table 2 summarizes the sampling properties of ˆ and ˆ across the diﬀerent designs. In all
cases I set the number of agents equal to N = 5, 000 and complete B = 1, 000 Monte Carlo
replications. The network size was chosen through trial and error to ensure the presence of
a suﬃcient number of identifying stable dyads. With five thousand agents the number of
stable dyads averages between 100 and 250 for the designs considered here.
In all cases the SN logit estimator is approximately mean and median unbiased and the
associated Wald-based confidence intervals have actual coverage close to nominal 95 percent
coverage.
In empirical work it is common to fit simple dynamic logistic regression models to network
data. In this approach current linking decisions are modeled as a function of past network
structure (e.g., Gulati and Gargiulo, 1999; Kossinets and Watts, 2009; Almquist and Butts,
2013). In the Monte Carlo designs considered here, this approach resulted in highly biased
point estimates and nominal 95 percent confidence intervals with zero coverage in all cases
(results not reported).13
13
p With B = 1, 000 Monte Carlo replications the standard error of the coverage estimates are
0.95 (1 0.95) /1, 000 ⇡ 0.007. Hence the null of actual coverage equaling 0.95 is accepted in all cases.

26

Table 2: Sampling properties of ˆ and ˆ
Asymptotic Degree
2
3
N = 5, 000
Mean
1.0138 1.0458 1.0314 1.0421
Median
1.0018 1.0187 1.0061 1.0064
Std. Dev.
0.2661 0.2888 0.3575 0.2832
Mean Std. Err.
0.2593 0.2791 0.3375 0.2717
Coverage
0.9600 0.9530 0.9480 0.9600
Avg. # of Stable Dyads
237.5
162.9
# of cvg. failures
0
0

4
1.0438 1.0456
1.0410 1.0133
0.4575 0.2976
0.4493 0.2917
0.9620 0.9650
110.6
1

Notes: The table reports period-specific network summary statistics across the B = 1, 000 Monte
Carlo simulations for each design (N = 5, 000). See the main text for other design details. The
E [Dit ] column gives the average degree, T the clustering coeﬃcient or transitivity index and GC
the fraction of agents that are part of the largest giant component.

5

Conclusion

This paper has introduced a simple model of dynamic network formation which incorporates, for the first time, both a structural taste for transitivity and arbitrary homophily
on time-invariant agent attributes. Transitivity and homophily are the two most widely
posited reasons for link clustering in real world networks (e.g., Snijders, 2011, 2013). The
model introduced here provides a means to assess the roles played by these two forces in
practice. Taste transitivity induces a strong dependence in link formation trajectories across
agents. By focusing on link histories across dyads embedded in stable neighborhoods, these
dependencies can be controlled, and positive identification results derived. Estimation and
inference is surprisingly simple, requiring a routine to find stable dyads, and a standard logit
maximum likelihood program.
Several diﬀerent directions for future research suggest themselves. First, the application
of the methods proposed here to real world network data would be interesting. Second,
it is an open question whether the notion of neighborhood stability can be extended to
accommodate more complex surplus functions. In particular those with additional network
interdependencies beyond a taste for transitivity. Third, the fixed eﬀects results presented
here provide justification for the further exploration of random eﬀects approaches to dynamic
network analysis.

27

A

Proof of Theorem 2

This appendix presents a derivation of the large sample properties of the SN logit estimator
summarized in Theorem 2 of the main text. All notation is as defined in the main text
unless stated otherwise. The abbreviation TI refers to the Triangle Inequality, CSI to the
Cauchy-Schwartz Inequality, LLN to the Law of Large Numbers and CLT to the Central
Limit Theorem.
Consistency
To show part (i) of Theorem 2 consider the normalized SN logit criterion function
↵N1 LN (✓) = ↵N1

N
2

N X
X

1

(26)

lij (✓) .

i=1 j<i

A dominating function for the “kernel” of (26) can be constructed as follows
↵N1 lij (✓)

= ↵N1 Zij

ln 2 +

Sij Xij0

 ↵N1 Zij |ln 2| + ↵N1 Zij

exp Sij Xij0 ✓¯
1 + exp

Sij Xij0 ✓¯

1
1 + exp Sij Xij0 ✓¯

!

Sij Xij0

!

✓

Sij Xij0 ✓

 ↵N1 Zij |ln 2| + ↵N1 Zij Sij Xij0 ✓
= ↵N1 Zij |ln 2| + ↵N1 Zij Xij0 ✓

 ↵N1 Zij |ln 2| + ↵N1 Zij kXij k k✓k .

(27)

The first equality follows from a mean value expansion in ✓, the second inequality by the
TI, the third inequality by the fact that [1 + exp (v)] 1 lies between zero and one, the fourth
equality by the fact that |Sij | = 1 if Zij = 1 and zero otherwise, and the last inequality by
the CSI. By Assumption 2 the term to the right of the final inequality is bounded.
Taking expectations of both side of (27) therefore yields
⇥
⇤
E ↵N1 lij (✓)  |ln 2| + E [ kXij k| Zij = 1] k✓k = O (1) ,

which allows for an application of a law of large numbers for U-statistics with sample-size
p
dependent kernels (e.g., Lemma A.3 of Ahn and Powell (1993)). This gives ↵N1 LN (✓) !

28

Q (✓) for
⇥
⇤
Q (✓) = E ↵N1 lij (✓)
=
=

↵N1 Pr (Zij = 1) {E [ DKL ( pij k pij (✓))| Zij = 1] + E [ S (pij )| Zij = 1]}
E [ DKL ( pij k pij (✓))| Zij = 1] + E [ S (pij )| Zij = 1] .

Here DKL ( pij k pij (✓)) equals the Kullback-Liebler divergence of pij (✓) =

0 ✓
exp(Xij
)
0 ✓
1+exp(Xij
)

(28)
from

pij = pij (✓0 ) and S (pij ) is the binary entropy function. Clearly ✓0 is a maximizer of (28);
part (ii) of Assumption 3 implies that ✓0 is the unique maximizer. By concavity of LN (✓)
in ✓ the convergence of ↵N1 LN (✓) to Q (✓) is uniform in ✓ 2 ⇥. Since conditions A, B and
C of Theorem 4.1.1 of Amemiya (1985) hold, part (i) of the Theorem follows.
Asymptotic normality
To show part (ii) of Theorem 2 I begin with a mean value expansion of the first order condition
of the (normalized) SN logit criterion function (26). This gives, after some re-arrangement,
✓ˆ

"

✓0 =

1

↵N1 N2

"

N X
X
i=1 j<i

⇥ ↵N1

1

N
2

N X
X
i=1 j<i

r✓✓ lij ✓¯

#+

#

(29)

r✓ lij (✓0 ) ,

where ✓¯ lies “between” ✓ˆ and ✓0 , + denotes a Moore-Penrose generalized inverse and
r✓ lij (✓) = Zij
r✓✓ lij (✓) =

(

exp Xij0 ✓

1 (Sij = 1)

)

1 + exp Xij0 ✓
(
)
exp Xij0 ✓
0
Zij ⇥
⇤2 Xij Xij .
0
1 + exp Xij ✓

Xij



By Assumption 2 and part (ii) of Assumption 3 E sup kr✓✓ lij (✓)kmax < 1 and continuous
✓2⇥
1 PN P
¯ p
in ✓ 2 ⇥ so that, using part (i) of Assumption 3, ↵N1 N2
i=1
j<i r✓✓ lij ✓ ! ⇤0 with
⇤0 as defined immediately before the statement of Theorem 2 in the main text. The matrix
⇤0 is finite and non-singular by part (ii) of Assumption 3.
Asymptotic normality follows by demonstrating that the second term in (29), suitably nor-

29

malized, obeys a central limit theorem (CLT). To show this, start by calculating the variance
⇥
E [r✓ lij (✓0 ) r✓ lij (✓0 )] = Pr (Zij = 1) E qij (1

qij ) Xij Xij0 Zij = 1

= ↵ N ⇤0

⇤

= O (↵N ) .
Note also that E [r✓ lij (✓0 ) r✓ lik (✓0 )] identically equals zero for any j 6= k because each
agent can belong to at most one stable dyad (so that Zij Zik = 0). This observation, and a
Hoeﬀding (1948) decomposition, gives

V

↵N1 N2

1

N X
X
i=1 j<i

r✓ lij (✓0 )

!

=

↵N2 N2

2

2
X

N
2

2
s

N 2
2 s

s,N

s=0

=

⇤0
,
n↵N

for s,N the covariance between r✓ lij (✓0 ) and r✓ lkl (✓0 ) when s = 0, 1, 2 indices are in
common. The second equality follows from the fact that 0,N = 1,N = 0 and the variance
calculation above. This suggests that ✓ˆ converges in mean square to ✓0 at rate 1/n↵N .
Now, without loss of generality, let i = 1, . . . , mN index those dyads embedded in stable
neighborhoods. Here {mN } is a sequence of integer-valued random variables. Part (i) of
Assumption 3 implies that
mN p
! 1,
n↵N
N
with n↵N ! 1. By Lemma 3 {r✓ li (✓0 )}m
i=1 are i.i.d. with mean zero and finite variance
⇤0 (from the calculation above). A CLT for a random number of summands (e.g., Theorem
1.9.4 of Serfling (1980)) and Slutsky’s Theorem therefore give

N
1 XX
D
r✓ lij (✓0 ) ! N (0, ⇤0 ) ,
p
n↵N i=1 j<i

from which the result follows after another application of Slutsky’s Theorem.

30

B

Construction of a stable dyad indicator

It is helpful for computation to have an indicator for neighborhood stability. To construct
one first define the matrix
S = D1 D2 D3 + (◆◆0

D1 ) (◆◆0

D2 ) (◆◆0

D3 ) .

The ij th element of S equals 1 if the link status of dyad ij is the same across periods 1, 2
and 3 (i.e., either always linked or never linked) and zero otherwise. The diagonal elements
of S equal one by construction. Note that Sij , the ij th element of S, does not correspond to
Sij as defined in the main text and Appendix A.
To find dyads that (i) change link status across periods 1 and 2, but (ii) leave any remaining
links they may have unchanged in periods 1, 2 and 3 define the boolean matrix T with ij th
entry
(
P
P
1 if D1ij 6= D2ij & N
1& N
1
j=1 Sij = N
i=1 Sij = N
Tij =
.
0
otherwise
To identify agents who do not form or sever any links during periods 1 and 2 define the
boolean vector V with ith element
(
P
1 if N
D1ij ) (1 D2ij ) = N
j=1 D1ij D2ij + (1
Vi =
.
0
otherwise
Use T and V to construct an indicator for dyad stability:
Zij = Tij ⇥

"

Y

k6=i,j

(D1ik Vk + (1

#

D1ik )) ⇥

"

Y

k6=i,j

(D1kj Vk + (1

#

D1kj )) .

(30)

Q
Note that k6=i,j (D1ik Vk + (1 D1ik )) = 1 if for all k 6= i, j one of the following two conditions hold: (i) agent i is linked to agent k and all of k’s links are stable across periods 1 and 2
or (ii) agent i is not linked to k. Hence Tij equals one if the first condition for neighborhood
stability applies and i and j revise their link status across periods 1 and 2, while the two
terms in [•] equal one if the second condition for neighborhood stability holds holds.

References
Ahn, H. and Powell, J. L. (1993). Semiparametric estimation of censored selection models
with a nonparametric selection mechanism. Journal of Econometrics, 58(1-2):3 – 29.
31

Almquist, Z. W. and Butts, C. T. (2013). Dynamic network logistic regression: a logistic
choice analysis of inter- and intra-group blog citation dynamics in the 2004 us presidential
election. Political Analysis, 21(4):430 – 448.
Amemiya, T. (1985). Advanced Econometrics. Harvard University Press.
Blitzstein, J. and Diaconis, P. (2011). A sequential importance sampling algorithm for
generating random graphs with prescribed degrees. Internet Mathematics, 6(4):489 – 522.
Card, D. and Sullivan, D. (1988). Measuring the eﬀect of subsidized training programs on
movements in and out of employment. Econometrica, 56(3):497 – 530.
Chamberlain, G. (1980). Analysis of covariance with qualitative data. Review of Economic
Studies, 47(1):225 – 238.
Chamberlain, G. (1985). Longitudinal Analysis of Labor Market Data, chapter Heterogeneity,
omitted variable bias, and duration dependence, pages 3 – 38. Cambridge University Press.
Chandrasekhar, A. (2016). The Oxford Handbook of the Economics of Networks, chapter
Econometrics of network formation, pages 303 – 357. Oxford University Press.
Chandrasekhar, A. G. and Jackson, M. O. (2015). A network formation model based on
subgraphs. Technical report, Stanford University.
Charlier, E., Melenberg, B., and van Soest, A. H. O. (1995). A smoothed maximum score
estimator for the binary choice panel data model with an application to labour force
participation. Statistica Neerlandica, 49(3):324 – 342.
Chatterjee, S. and Diaconis, P. (2013). Estimating and understanding exponential random
graph models. Annals of Statistics, 41(5):2428 – 2461.
Choi, T. Y. and Wu, Z. (2009). Triads in supply networks: theorizing buyer-supplier-supplier
relationships. Journal of Supply Chain Management, 45(1):8 – 25.
Christakis, N. A., Fowler, J. H., Imbens, G. W., and Kalyanaraman, K. (2010). An empirical model for strategic network formation. Technical Report 16039, National Bureau of
Economic Research.
Coleman, J. S. (1990). Foundations of Social Theory. Harvard University Press.
Cox, D. R. (1958). The regression analysis of binary sequences. Journal of the Royal Statistical Society B, 20(2):215 – 241.
32

Davis, J. A., Holland, P., and Leinhardt, S. (1971). Comments on professor mazur’s hypothesis about interpersonal sentiments. American Sociological Review, 36(2):309 – 311.
de Paula, Á. (2016).
CEMMAP.

Econometrics of network models.

Technical Report CWP06/16,

de Paula, Á., Richards-Shubik, S., and Tamer, E. (2015). Identification of preferences in
network formation games. Technical Report CWP29/15, CEMMAP.
Dzemski, A. (2014). An empirical model of dyadic link formation in a network with unobserved heterogeneity”. Technical report, University of Gothenburg.
Goldenberg, A., Zheng, A. X., Fienberg, S. E., and Airoldi, E. M. (2010). A survey of
statistical network models. Foundations and Trends in Machine Learning, 2(2):129 – 233.
Goldsmith-Pinkham, P. and Imbens, G. W. (2013). Social networks and the identification
of peer eﬀects. Journal of Business and Economic Statistics, 31(3):253 – 264.
Goodreau, S. M., Kitts, J. A., and Morris (2009). Birds of a feather, or friend of a friend?
using exponential random graph models to investigate adolescent social networks,. Demography, 46(1):103 – 125.
Graham, B. S. (2011). Handbook of Social Economics, volume 1B, chapter Econometric
methods for the analysis of assignment problems in the presence of complementarity and
social spillovers„ pages 965 – 1052. North-Holland.
Graham, B. S. (2013). Comment on “social networks and the identification of peer eﬀects”
by paul goldsmith-pinkham and guido w. imbens. Journal of Business and Economic
Statistics, 31(3):266 – 270.
Graham, B. S. (2014). An econometric model of link formation with degree heterogeneity.
Technical Report 20341, National Bureau of Economic Research.
Graham, B. S. (2015). Methods of identification in social networks. Annual Review of
Economics, 7:465 – 485.
Granovetter, M. S. (1973). The strength of weak ties. American Journal of Sociology,
78(6):1360 – 1380.
Gulati, R. and Gargiulo, M. (1999). Where do interorganizational networks come from?
American Journal of Sociology, 104(5):1439 – 1493.
33

Heckman, J. J. (1978). Simple statistical models for discrete panel data developed and
applied to test the hypothesis of true state dependence against the hypothesis of spurious
state dependence. Annales de l’inséé, 30-31:227 – 270.
Heckman, J. J. (1981a). Structural Analysis of Discrete Data and Econometric Applications,
chapter Statistical models for discrete panel data„ pages 114 – 178. The MIT Press.
Heckman, J. J. (1981b). Structural Analysis of Discrete Data and Econometric Applications, chapter The incidental parameters problem and the problem of initial conditions
in estimating a discrete time-discrete data stochastic process, pages 179 – 195. The MIT
Press.
Heckman, J. J. (1981c). Studies in Labor Markets, chapter Heterogeneity and state dependence, pages 91 – 139. Chicago University Press.
Hoeﬀding, W. (1948). A class of statistics with asymptotically normal distribution. Annals
of Mathematical Statistics, 19(3):293 – 325.
Honoré, B. E. and Kyriazidou, E. (2000). Panel data discrete choice models with lagged
dependent variables. Econometrica, 68(4):839 – 874.
Honoré, B. E. and Tamer, E. (2006). Bounds on parameters in panel dynamic discrete choice
models. Econometrica, 74(3):611 – 629.
Jackson, M. O. (2008). Social and Economic Networks. Princeton University Press.
Jackson, M. O., Rodriguez-Barraquer, T., and Tan, X. (2012). Social capital and social
quilts: network patterns of favor exchange. American Economic Review, 102(5):1857 –18
97.
Jackson, M. O., Rogers, B. W., and Zenou, Y. (2016). The economic consequences of social
network structure. Technical report, Stanford University.
Jackson, M. O. and Watts, A. (2002). The evolution of social and economic networks. Journal
of Economic Theory, 106(2):265 – 295.
Jackson, M. O. and Wolinsky, A. (1996). A strategic model of social and economic networks.
Journal of Economic Theory, 71(1):44 – 74.
Kossinets, G. and Watts, D. J. (2009). Origins of homophily in an evolving social network.
American Journal of Sociology, 115(2):405 – 450.
34

Kostin, A. (2010). Probability distribution of distance between pairs of nearest stations in
wireless network. IEEE Electronic Letters, 46(18):1299 – 1300.
Krivitsky, P. N., Handcock, M. S., Raftery, A. E., and Hoﬀ, P. D. (2009). Representing degree
distributions, clustering, and homophily in social networks with latent cluster random
eﬀects models. Social Networks, 31(3):204 – 213.
Manski, C. F. (1975). Maximum score estimation of the stochastic utility model of choice.
Journal of Econometrics, 3(3):205 – 228.
Manski, C. F. (1985). Semiparametric analysis of discrete response: asymptotic properties
of the maximum score estimator. Journal of Econometrics, 27(3):313 – 333.
Manski, C. F. (1987). Semiparametric analysis of random eﬀects linear models from binary
panel data. Econometrica, 55(2):357 – 362.
Maoz, Z. (2012). Preferential attachment, homophily, and th structure of international
networks, 1816 - 2003. Conflict Management and Peace Science, 29(3):341 – 369.
Matous, P. and Todo, Y. (2016). Energy and resilience: the eﬀects of endogenous interdependencies on trade network formation across space among major japanese firms. Network
Science.
McFadden, D. (1974). Frontiers in Econometrics, chapter Conditional logit analysis of qualitative choice behavior, pages 105 – 142. Academic Press.
McPherson, M., Smith-Lovin, L., and Brashears, M. E. (2006). Social isolation in america:
changes in core discussion networks over two decades. American Sociological Review,
71(3):353 – 375.
McPherson, M., Smith-Lovin, L., and Cook, J. M. (2001). Birds of a feather: homophily in
social networks. Annual Review of Sociology, 27:415 – 444.
Mele, A. (2015). A structural model of segregation in social networks. Technical report,
John Hopkins University.
Menzel, K. (2015). Strategic network formation with many agents. Technical report, New
York University.
Penrose, M. (2003). Random geometric graphs, volume 5 of Oxford Studies in Probability.
Oxford.
35

Serfling, R. J. (1980). Approximation Theorems of Mathematical Statistics. John Wiley and
Sons.
Sheng, S. (2014). A structural econometric analysis of network formation games. Technical
report, UCLA.
Snijders, T. A. B. (2011). Statistical models for social networks. Annual Review of Sociology,
37:131 – 153.
Snijders, T. A. B. (2013). Network dynamics. In Rafael Wittek, T. S. . V. N., editor, The
Handbook of Rational Choice Social Research, pages 252 – 279. Stanford University Press.
van Duijn, M. A. J., Snijders, T. A. B., and Zijlstra, B. J. H. (2004). p2: a random eﬀects
model with covariates for directed graphs. Statistica Neerlandica, 58(2):234 – 254.
Watts, A. (2001). A dynamic model of network formation. Games and Economic Behavior,
34(2):331 – 341.

36

Figure 6: Illustrative network sequence for Monte Carlo Design

Notes: A typical sequence of networks for the case where N = 200 and average degree in the
initial network is 4.

37

