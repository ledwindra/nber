NBER WORKING PAPER SERIES

OPTIMAL TRADING STRATEGY AND
SUPPLY/DEMAND DYNAMICS
Anna Obizhaeva
Jiang Wang
Working Paper 11444
http://www.nber.org/papers/w11444
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2005

Obizhaeva is from MIT Sloan School of Management, tel: (617) 253-3919, email: obizhaeva@mit.edu, and
Wang is from MIT Sloan School of Management, CCFR, and NBER, tel: (617) 253-2632, email:
wangj@mit.edu. The authors thank participants at the NYSE seminar for helpful comments. The views
expressed herein are those of the author(s) and do not necessarily reflect the views of the National Bureau
of Economic Research.
©2005 by Anna Obizhaeva and Jiang Wang. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including © notice, is given
to the source.

Optimal Trading Strategy and Supply/Demand Dynamics
Anna Obizhaeva and Jiang Wang
NBER Working Paper No. 11444
June 2005
JEL No. G11, G12
ABSTRACT
The supply/demand of a security in the market is an intertemporal, not a static, object and its
dynamics is crucial in determining market participants' trading behavior. Previous studies on the
optimal trading strategy to execute a given order focuses mostly on the static properties of the
supply/demand. In this paper, we show that the dynamics of the supply/demand is of critical
importance to the optimal execution strategy, especially when trading times are endogenously
chosen. Using a limit-order-book market, we develop a simple framework to model the dynamics
of supply/demand and its impact on execution cost. We show that the optimal execution strategy
involves both discrete and continuous trades, not only continuous trades as previous work suggested.
The cost savings from the optimal strategy over the simple continuous strategy can be substantial.
We also show that the predictions about the optimal trading behavior can have interesting
implications on the observed behavior of intraday volume, volatility and prices.
Anna Obizhaeva
MIT, Sloan School of Management
E52-402
50 Memorial Drive
Cambridge, MA 02142
obizhaeva@mit.edu

Jiang Wang
MIT, E52-456
50 Memorial Drive
Cambridge, MA 02142-1347
and NBER
wangj@mit.edu

Contents
1 Introduction

1

2 Statement of the Problem

3

3 Limit Order Book and Supply/Demand Dynamics
3.1 Limit Order Book (LOB) . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Limit Order Book Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.3 Execution Cost . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4
4
7
9

4 Conventional Models As A Special Case
4.1 Conventional Setup . . . . . . . . . . . .
4.2 The Continuous-Time Limit . . . . . . .
4.3 Temporary Price Impact . . . . . . . . .
4.4 A Special Case of Our Framework . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

9
10
11
12
13

5 Discrete-Time Solution

14

6 Continuous-Time Solution

16

7 Optimal Execution Strategy and Cost
7.1 Properties of Optimal Execution Strategy . . . . . . . . . . . . . . . . . . .
7.2 Minimum Execution Cost . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.3 Empirical Implications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

18
18
21
23

8 Extensions
8.1 Time Varying LOB Resiliency . . . . . . . . . . . . . . . . . . . . . . . . . .
8.2 Diﬀerent Shapes for LOB . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8.3 Risk Aversion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

25
25
25
26

9 Conclusion

27

Appendix

29

References

36

1

Introduction

It has long being documented that the supply/demand of a security in the market is not
perfectly elastic.1 The limited elasticity of supply/demand or liquidity can signiﬁcantly aﬀect
how market participants trade, which in turn can aﬀect the supply/demand itself and the
prices. Thus, to understand how market participants trade is important to our understanding
of how the securities market functions and how security prices are determined. We can
approach this problem by ﬁrst looking at the optimal strategy to execute a given order, also
referred to as the optimal execution problem. Many empirical studies have shown that this
is a problem confronted by institutional investors who need to execute large orders and often
break up trades in order to manage the trading cost.2
Several authors have formulated the problem of optimal execution and provided solutions
to the optimal execution strategy. For example, Bertsimas and Lo (1998) propose a static
price impact function and solve for the optimal execution strategy to minimize the expected
cost of executing a given order. Almgren and Chriss (2000) include risk considerations in
a similar setting using a mean-variance objective function.3 The framework used in these
work has two main features. First, the price impact of a trade is described by a static
price impact function, which depends only on the size of the trade and does not reﬂect the
intertemporal properties of the security’s supply/demand. For example, the price impact
of two consecutive trades depends merely on their total size, not on their relative sizes and
the time between. Second, this framework adopts a discrete-time setting so that the times
to trade are ﬁxed at certain intervals. A discrete-time setting is clearly undesirable for
such a problem because the timing of trades is an important choice variable and should be
determined optimally. A natural way to address this issue would be to take a continuous-time
limit of the discrete-time formulation, but this leads to a degenerate situation in which the
execution cost becomes strategy independent. By introducing an additional cost penalizing
speedy trades, Huberman and Stanzl (2000) avoid this degeneracy in the continuous-time
limit (see also Almgren (2003)). However, imposing such a cost restricts the execution
strategy to continuous trades, which is in general sub-optimal.
We show in this paper that the inability of the conventional models to ﬁnd an optimal
execution strategy in a general class of feasible strategies arises from the use of a static
price-impact function to describe the execution cost. Such a price impact function fails to
1

See, for example, Holthausen, Leftwitch and Mayers (1987, 1990), Shleifer (1986), Scholes (1972). For the
more recent work, see also Greenwood (2004), Kaul, Mehrotra and Morck (2000), Wugler and Zhuravskaya
(2002).
2
See, for example, Chan and Lakonishok (1993, 1995, 1997), Keim and Madhavan (1995, 1997).
3
See also, Almgren (2003), Dubil (2002), Subramanian and Jarrow (2001), among others.

1

capture the intertemporal nature of supply/demand of a security in the market. For example,
when we consider the execution of a buy order X, the static price impact function describes
the current supply of X and its average price. It does not tell us what the supply will be
over time in response to a sequence of trades. In general, the supply at future times will
depend on the sequence of buy (and sell) orders executed so far, in particular, their timing
and sizes. Given that optimal execution is about how to allocate trades over time, the
intertemporal properties of the supply/demand are at the heart of the problem and essential
in analyzing the optimal execution strategy. Incorporated these properties in our framework,
we show that when the timing of trades is chosen optimally, the optimal execution strategy
diﬀers signiﬁcantly from those suggested in earlier work. It involves a mixture of discrete
and continuous trades. Moreover, the characteristics of the optimal execution strategy are
mostly determined by the dynamic properties of the supply/demand rather than its static
shape.
In order to describe the supply/demand dynamics, we consider a limit order book market
and construct a dynamic model of the limit order book. We then formulate the optimal
execution problem using this framework and solve for the optimal strategy. We show that
the optimal strategy typically involves a discrete trade at ﬁrst, which shifts the limit order
book away from its steady state. Such a deviation attracts new orders onto the book. The
initial trade size is chosen to draw enough new orders at desirable prices. A sequence of
continuous trades will then follow to pick oﬀ the new orders and keep the inﬂow. At the end
of the trading horizon, a discrete trade is executed to ﬁnish oﬀ any remaining order since
future demand/supply is no longer of concern. The combination of discrete and continuous
trades for the optimal execution strategy is in sharp contrast to the strategy obtained in
previous work, which involves only continuous trades. We also show that the saving from
the optimal strategy with respect to those in previous work is substantial. Moreover, we ﬁnd
that the optimal strategy depends primarily on the dynamic properties of the limit order
book and is not very sensitive to the static price-impact function, which is what previous
work focused on. In particular, the speed at which the limit order book rebuilds itself after
being hit by a trade, which is also referred to as the resilience of the book, plays a critical
role in determining the optimal execution strategy and the cost it saves.
Our predictions about optimal trading strategies lead to interesting implications about
the behavior of trading volume, liquidity and security prices. For example, it suggests
that the trading behavior of large institutional traders may contribute to the observed Ushaped patterns in intraday volume, volatility and bid-ask spread. It also suggests that
these patterns can be closely related to institutional ownership and the resilience of the
supply/demand of each security.
2

The paper is organized as follows. Section 2 states the optimal execution problem. Section
3 introduces the limit-order-book market and a model for the limit order book dynamics. In
Section 4, we show that the conventional setting in previous work can be viewed as a special
case of our limit-order-book framework. We also explain why the stringent assumptions in the
conventional setting lead to its undesirable properties. In Section 5, we solve the discretetime version of the problem within our framework. We also consider its continuous-time
limit and show that it is economically sensible and properly behaved. Section 6 provides
the solution of the optimal execution problem in the continuous-time setting. In Section
7, we analyze the properties of the optimal execution strategy and their dependence on
the dynamics of the limit order book. We also compare it with the strategy predicted by
the conventional setting. In addition, we examine the empirical implications of the optimal
execution strategy. Section 8 discusses possible extensions of the model. Section 9 concludes.
All proofs are given in the appendix.

2

Statement of the Problem

The problem we are interested in is how a trader optimally executes a large order. To ﬁx
ideas, let us assume that the trader has to buy X0 units of a security over a ﬁxed time
period [0, T ]. Suppose that the trader ought to complete the order in N + 1 trades at times
t0 , t1 , . . . , tN , where t0 = 0 and tN = T . Let xtn denote the trade size for the trade at tn . We
then have
N


xtn = X0 .

(1)

n=0

A strategy to execute the order is given by the number of trades, N +1, the set of times to
trade, {0 ≤ t0 , t1 , . . . , tN −1 , tN ≤ T } and trade sizes {xt0 , xt1 , . . . , xtN : xtn ≥ 0 ∀ n and (1)}.
Let ΘD denote the set of these strategies:

ΘD =

{xt0 , xt1 , . . . , xtN } : 0 ≤ t0 , t1 , . . . , tN ≤ T ; xtn ≥ 0 ∀ n;

N



xtn = X0

.

(2)

n=0

Here, we have assumed that the strategy set consists of execution strategies with ﬁnite number of trades at discrete times. This is done merely for easy comparison with previous work.
Later we will expand the strategy set to allow uncountable number of trades continuously
placed over time.
Let P̄n denote the average execution price for trade xtn . We assume that the trader

3

chooses his execution strategy to minimize the expected total cost of his purchase:
 N


min E0
P̄n xn .
x∈ΘD

(3)

n=0

For simplicity, we have assumed that the trader is risk-neutral and cares only about the
expected value not the uncertainty of the total cost. We will incorporate risk considerations
later.
The solution to the trader’s optimal execution strategy crucially depends on how his
trades impact the prices. It is important to recognize that the price impact of a trade has
two key dimensions. First, it changes the security’s current supply/demand. For example,
after a purchase of x units of the security at the current price of P̄ , the remaining supply of
the security at P̄ in general decreases. Second, a change in current supply/demand can lead
to evolutions in future supply/demand, which will aﬀect the costs for future trades. In other
words, the price impact is determined by the full dynamics of supply/demand in response
to a trade. Thus, in order to fully specify the optimal execution problem, we need to model
the supply/demand dynamics.

3

Limit Order Book and Supply/Demand Dynamics

The actual supply/demand of a security in the market place and its dynamics depend on
the actual trading process. From market to market, the trading process varies signiﬁcantly,
ranging from a specialist market or a dealer market to a centralized electronic market with a
limit order book. In this paper, we consider the limit-order-book market, which is arguably
the closest, at least in form, to the text-book deﬁnition of a centralized market.

3.1

Limit Order Book (LOB)

A limit order is a order to trade a certain amount of a security at a given price. In a
market operated through a limit-order-book, thereafter LOB for short, traders post their
supply/demand in the form of limit orders to a electronic trading system.4 A trade occurs
when an order, say a buy order, enters the system at the price of an opposite order on the
book, in this case a sell order, at the same price. The collection of all limit orders posted
can be viewed as the total demand and supply in the market.
4

The number of exchanges adopting an electronic trading system with posted orders has been increasing.
Examples include NYSE’s OpenBook program, Nasdaq’s SuperMontage, Toronto Stock Exchange, Vancouver Stock Exchange, Euronext (Paris, Amsterdam, Brussels), London Stock Exchange,Copenhagen Stock
Exchange, Deutsche Borse, and Electronic Communication Networks such as Island. For the ﬁxed income
market, there are, for example, eSpeed, Euro MTS, BondLink and BondNet. Examples for the derivatives
market include Eurex, Globex, and Matif.

4

Let qA (P ) be the density of limit orders to sell at price P and qB (P ) the density of limit
orders to buy at price P . The amount of sell orders in a small price interval [P, P +dP ) is
qA (P )(P +dP ). Typically, we have

+,
P ≥A
qA (P ) =
and
0,
P <A


qB (P ) =

0,

P >B

+,

P ≤B

where A ≥ B are the best ask and bid prices, respectively. We deﬁne
V = (A+B)/2,

s = A−B

(4)

where V is the mid-quote price and s is the bid-ask spread. Then, A = V + s/2 and
B = V −s/2. Because we are considering the execution of a large buy order, we will focus
on the upper half of the LOB and simply drop the subscript A.
In order to model the execution cost for a large order, we need to specify the initial LOB
and how it evolves after been hit by a series of buy trades. Let the LOB (the upper half of
it) at time t be q(P ; Ft ; Zt ; t), where Ft denotes the fundamental value of the security and
Zt represents the set of state variables that may aﬀect the LOB such as past trades. We
will consider a simple model for the LOB, to capture its dynamic nature and to illustrate
their importance in analyzing the optimal execution problem, and return to its extensions to
better ﬁt the empirical LOB dynamics later.5 In particular, we assume that the fundamental
value the security Ft follows a Brownian motion, reﬂecting the fact that in absence of any
trades, the mid-quote price may change due to news about the fundamental value of the
security. Thus, Vt = Ft in absence of any trades and the LOB maintains the same shape
except that the mid-point, Vt , is changing with Ft . In addition, we assume that the only
set of relevant state variables is the history of past trades, which we denote by x[0, t] , i.e.,
Zt = x[0, t] .
At time 0, we assume that the mid-quote is V0 = F0 and LOB has a simple block shape
q0 (P ) ≡ q(P ; F0 ; 0; 0) = q 1{P ≥A0 }
where and A0 = F0 +s/2 is the initial ask price and 1{z≥a} is an indicator function:

1,
z≥a
1{z≥a} =
0,
z<a
In other words, q0 is a step function of P with a jump from zero to q at the ask price
5

There is an extensive empirical literature on the dynamics of LOB. See, for example, Ahn, Bae and Chan
(2000) for the Hong Kong Stock Exchange, Biais, Hillion and Spatt (1995) for the Paris Bourse, Bloomﬁeld,
O’Hara and Saar (2004) for an experimental market setting, Chung, Van Ness and Van Ness (1999) for the
NYSE, Hasbrouck and Saar (2002) for the Island ECN, Hollﬁeld, Miller and Sandas (2003) for the Stockholm
Stock Exchange and Griﬃths, Smith, Turnbull and White (2000) for the Toronto Stock Exchange.

5

A0 = V0 +s/2 = F0 +s/2. The ﬁrst panel in Figure 1 shows the shape of the limit order book
at time 0.

P

P

q t(p)

P

P

qt(p)

A

P

qt (p)

qt (p)

qt(p)

t

At
vt +s/2

At

v t+s/2

q
t=t

0

A t=v t+s/2

v +s/2
t

At =vt+s/2
q

q

t=t 0+

t=t 1

q
t=t 2

q
t=t 3

Figure 1: The limit order book and its dynamics. This ﬁgure illustrates how the sell side of
limit order book evolves over time in response to a trade. Before the trade at time t0 = 0,
the limit order book is full at the ask price is A0 = V0 + s/2, which is shown in the ﬁrst
panel form the left. The trade of size x0 at t = 0 “eats oﬀ” the orders on the book with
lowest prices and pushes the ask price up to A0+ so that A0+ = (F0 +s/2) + x0 /q, which is
shown in the second panel. During the following periods, new orders will arrive at the ask
price At , which will ﬁll up the book and lower the ask price, until it converges to its new
steady state At = Ft + λx0 + s/2, which is shown in the last panel on the right. For clarity,
we assume that there are no fundamental shocks.

Now we consider a trade of size x0 at t = 0. The trade will “eat oﬀ” all the sell orders
with prices from F0 +s/2 up to A0+ , where A0+ is given by
 A0
+
qdP = x0
F0 +s/2

or A0+ = F0 +s/2+x0 /q. The average execution price is P̄ = F0 +s/2 + x0 /(2q), which is
linear in the size of the trade. Thus, the shape of the LOB we propose is consistent with
the linear price impact function assumed in previous work. This is also the main reason we
adopted it here.6
Right after the trade, the limit order book becomes:
q0+ (P ) ≡ q(P ; F0 ; Z0+ ; 0+ ) = q 1{P ≥A0+ } .
A0+ = F0 + s/2 + x0 /q is the new ask price. All the sell orders at prices below A0+ =
(F0 +s/2) + x0 /q have been executed. What is left on the LOB are the limit sell orders with
prices at and above A0+ . The second panel of Figure 1 plots the limit order book right after
the trade.
6

Huberman and Stanzl (2004) have suggested theoretical reasons for the linear price impact function,
relying on certain form of arbitrage arguments.

6

3.2

Limit Order Book Dynamics

What we have to specify next is how the LOB evolves over time after being hit by a trade.
Eﬀectively, this amounts to describing how the new sell orders arrive to ﬁll in the gap in
the LOB eaten away by the trade. First, we need to specify the impact of the trade on the
mid-quote price, which will determine the prices of the new orders. In general, the mid-quote
price will be shifted up by the trade. We assume that the shift in the mid-quote price will
be linear in the size of the total trade. That is,
V0+ = F0 + λx0
where 0 ≤ λ ≤ 1/q and λx0 gives the permanent price impact the trade x0 has. If there are
no more trades after the initial trade x0 at t = 0 and there are no shocks to the fundamental,
the limit order book will eventually converge to its new steady state
qt (P ) = q 1{P ≥At }
where t is suﬃciently large, At = Vt + s/2 and Vt = F0 + λx0 . Next we need to specify
how the limit order book converges to its steady-state. Note that right after the trade, the
ask price is A0+ = F0 +s/2+x0 /q, while in the steady-state it is A∞ = F0 +s/2+λx0 . The
diﬀerence between the two is A0+ − A∞ = x0 (1/q − λ). We assume that the limit order book
converges to its steady state exponentially:
qt (P ) = q 1{P ≥At }

(5)

where
At = Vt + s/2 + x0 κe−ρt ,

κ = 1/q−λ

(6)

and ρ ≥ 0 gives the convergence speed and Vt = V0+ in absence of new trades and changes
in Ft , which measures the “resilience” of the LOB.7 Equations (5) and (6) imply that after
a trade x0 , the new sell orders will start coming in at the new ask price At at the rate of
ρq(At −Vt −s/2). For convenience, we deﬁne
Dt = At − Vt − s/2

(7)

which stands for the deviation of current ask price At from its steady state level Vt +s/2.
We can easily extend the LOB dynamics described above for a single trade to include
multiple trades and news shocks to the fundamental value over time. Let n(t) denote the
7

A number of empirical studies documented the existence of the resiliency of LOB. After a large liquidity
shock when the spread is large, traders quickly place the orders within the best quotes to supply liquidity at
a relatively advantageous prices to obtain time priority. See, for example, Biais, Hillion and Spatt (1995),
Hamao and Hasbrouck (1995), Coppejans, Domowitz and Madhavan (2001), and Ranaldo (2004).

7

number of trades during interval [0, t), t1 , . . . , tn(t) the times for these trades, and xti their
sizes, respectively. Let Xt be the remaining order to be executed at time t, before trading
at t. We have
Xt = X0 −



xtn .

(8)

tn <t

with XT+ = 0. Let
Vt = Ft + λ(X0 − Xt ) = Ft + λ

n(t)


xti

(9)

i=0

where X0 −Xt is the total amount of purchase during [0, t). Then the ask price at any time
t is
At = Vt + s/2 +

n(t)


xti κe−ρ(t−ti )

(10)

i=0

and the limit order book at any time t is given by (5). Panels 2 to 5 in Figure 1 illustrates
the time evolution of the LOB after a trade. We can easily extend the above description to
include sell orders which may occur in the mean time and can shift the mid-quote Vt . If not
predictable, they are not important to our analysis. Thus, we omit them here.
Before we go ahead with the LOB dynamics and examines its implications on execution
strategy, several comments are in order. It should be pointed out that the simple LOB
dynamics described above is assumed to be given, without further economic justiﬁcation.
Presumably, it is driven by the optimizing behavior of those who submit the orders and
thus provide liquidity to the market. For example, a natural question to ask is why the new
orders were not submitted to the book before old orders are ﬁlled. Apparently, the trade-oﬀ
between putting orders on the book or keeping it hidden is what market participants have to
decide optimally.8 In addition, in equilibrium the LOB dynamics may be further aﬀected by
the strategic interactions among those participants whose trades can inﬂuence prices (see,
for example, Vayanos (1999, 2001)). To fully capture the detailed properties of the LOB
dynamics, we may well need to consider the interactions among all market participants in
an equilibrium framework. However, it should be emphasized that the goal of this paper
is to demonstrate the insuﬃciency of considering only static properties of supply/demand
8

Many authors have developed models for optimal order placement in a limit order market. See, for
example, Foucault (1999), Foucault, Kadan, and Kandel (2001), Glosten (1994), Goettler, Parlou and Rajan
(2003), Harris(1998), Parlour (1998), Parlour and Seppi(2003), Rock (1996), Rosu (2004), Sandas (2001),
and Seppi (1997). Huang and Wang (2005) consider in a more general setting the optimal decision to
participate in the market when it is costly. There is also ample recent work showing that traders do use
the rich information on the state of the books when deciding on their order submission strategies. See, for
example, Cao, Hansch, and Wang (2003), Harris and Panchapagesan (2005), Bloomﬁeld, O’Hara, and Saar
(2003), Ranaldo (2004), among others.

8

to solve for executing strategies and to emphasize qualitative importance of supply/demand
dynamics. The speciﬁc model merely helps us to make the point in a simple and revealing
way. Its partial equilibrium nature as well as its quantitative features are neither the focus
of this paper nor crucial to our main conclusions.

3.3

Execution Cost

Given the above description of the LOB dynamics, we can now describe the total cost of
an execution strategy for a given order X0 . Let xtn denote the trade at time tn and Atn
the ask price at tn prior to the trade. The evolution of ask price At as given in (10) is not
continuous. For clarity, At always denotes the left limit of At , At = lims→t− As , i.e., the ask
price before the trade at t. The same convention is followed for Vt . The cost for xtn is then
 x tn
Ptn (x)dx
(11)
c(xtn ) =
0

where Pt (x) is deﬁned by equation
 Pt (x)
qt (P )dP.
x=

(12)

At

For block-shaped LOB given in (5), we have
Pt (x) = At + x/q
and
(13)
c(xtn ) = [Atn + xtn /(2q)] xtn .

The total cost is N
n=0 c(xtn ). Thus, the the optimal execution problem, deﬁned in (3), now
reduces to
min E0

x∈ΘD



N



(14)

[Atn + xtn /(2q)] xtn

n=0

under our dynamics of the limit order book given in (9) and (10).

4

Conventional Models As A Special Case

Previous work on the optimal strategy for trading a large order uses a discrete-time setting
with a ﬁxed time interval and relies on a static price-impact function to describe the supply/demand (e.g., Bertsimas and Lo (1998) and Almgren and Chriss (2000)). What such a
setting does not address is how to determine the optimal time interval between trades. From
both a theoretical and a practical point of view, the timing of trades is an essential aspect

9

of the execution strategy. One possible approach to determine the optimal time interval between trades is to let the time interval go to zero in the discrete-time setting. However, in this
case, as shown in He and Mamaysky (2001) and Huberman and Stanzl (2000), the problem
becomes degenerate and all strategies become equally good. This is obviously unrealistic.
In this section, we brieﬂy describe the setting used in previous work and its limitations in
determining the optimal execution strategy. We then show that the conventional setting can
be viewed as a special case of our framework with speciﬁc restrictions on the LOB dynamics.
We further point out why these restrictions are unrealistic when the timing of trades is
determined optimally and why they give rise to the problems in the conventional setting.

4.1

Conventional Setup

We ﬁrst introduce the conventional setup proposed by Bertsimas and Lo (1998) and Almgren
and Chriss (2000), among others. We adopt a simple version of their framework which captures the basic features of the models commonly used in the previous work on this problem.9
In a discrete-time setting, the trader trades at ﬁxed time intervals, nτ , where τ = T /N
and n = 0, 1, . . . , N are given. Each trade will have an impact on the price, which will aﬀect
the total cost of the trade and future trades. Most models assume a linear price-impact
function of the following form:
P̄n = P̄n−1 + λxn + un = (Fn + s/2) + λ

n


xi

(15)

i=0

where the subscript n denotes the n-th trade at tn = nτ , P̄n is the average price at which
trade xn is executed with P̄0− = F0 +s/2, λ is the price impact coeﬃcient and un is i.i.d.
random variable, with a mean of zero and a variance of σ 2 τ .10 In the second equation, we

have set Fn = F0 + ni=0 ui . The trader who has to execute an order of size X0 solves the
following problem:
min

{x0 ,x1 ,...,xN }

E0



N



P̄n xn = (F0 +s/2)X0 + λ

n=0

N


Xn (Xn+1 −Xn ).

(16)

n=0

where P̄n is deﬁned in (15) and Xn is a number of shares left to be acquired at time tn
(before trade xtn ) with XN +1 = 0.
As shown in Bertsimas and Lo (1998) and Almgren and Chriss (2000), given that the
objective function is quadratic in xn , it will be optimal for the trader to split his order into
small trades of equal sizes and execute them at regular intervals over the ﬁxed period of
9

See also Almgren (2003), Dubil (2002), and Monch (2004).
Huberman and Stanzl (2004) have argued that in the absence of quasi-arbitrage, permanent price-impact
functions must be linear.
10

10

time:
xn =

X0
N +1

(17)

where n = 0, 1, . . . , N .11

4.2

The Continuous-Time Limit

Although the discrete-time setting with a linear price impact function gives a simple and
intuitive solution, it leaves a key question unanswered. That is, what determines the timeinterval between trades. An intuitive way to address this question is to take the continuoustime of the discrete-time solution, i.e., to let N goes to inﬁnity. However, as Huberman
and Stanzl (2000) point out, the solution to the discrete-time model (16) does not have a
well-deﬁned continuous-time limit. In fact, as N → ∞, the cost of the trades as given in
(16) approaches the following limit:
(F0 +s/2)X0 + (λ/2)X02
which is strategy-independent. Thus, for a risk-neutral trader, the execution cost with
continuous trading is a ﬁxed number and any continuous strategy is as good as another.
Therefore, the discrete-time model as described above does not have a well-behaved continuous time limit. For example, without increasing the cost the trader can choose to trade
intensely at the very beginning and complete the whole order in an arbitrarily small period.
If the trader becomes slightly risk-aversion, he will choose to ﬁnish all the trades right at the
beginning, irrespective of their price impact.12 Such a situation is clearly undesirable and
economically unreasonable.
This problem has led several authors to propose diﬀerent modiﬁcations to the conventional setting. He and Mamaysky (2001), for example, directly formulate the problem in
continuous-time and impose ﬁxed transaction costs to rule out any continuous trading strategies. Huberman and Stanzl (2000) propose to include a temporary price impact of a special
11

If the trader is risk averse, he will trade more aggressively at the beginning, trying to avoid the uncertainty
in execution cost in later periods.
12
As N → ∞, the objective function to be minimized for a risk-averse trader with a mean-variance
preference approaches the following limit




 T
T
T

1
C x[0, T ] = E
Pt dXt + 2 aVar
Pt dXt = (F0 +s/2)X0 + (λ/2)X02 + 12 aσ 2
Xt2 dt
0

0

0

where a > 0 is the risk-aversion coeﬃcient and σ is the price volatility of the security. The trader cares
not only about the expected execution cost but also its variance, which is given by the last term. Only the
variance of the execution cost depends on the strategy. It is easy to see that the optimal strategy is to choose
an L-shaped proﬁle for the trades, i.e., to trade with inﬁnite speed at the beginning, which leads to a value
of zero for the variance term in the cost function.

11

form, in addition to the permanent linear price-impact, to penalize high-intensity continuous
trading. As a result, they restrict themselves to a class of only continuous strategies. Both
of these modiﬁcations limit us to a subset of feasible strategies, which is in general suboptimal. Given its closeness to our paper, we now brieﬂy discuss the modiﬁcation suggested
by Huberman and Stanzl (2000).

4.3

Temporary Price Impact

In order to obtain a well-behaved solution to the optimal execution problem with a sensible
continuous-time limit, Huberman and Stanzl (2000) modify the price impact function and
introduce a temporary price impact of a trade. In particular, they specify the following
dynamics for the execution prices of trades:
P̂n = P̄n + G(xn /τ )

(18)

where P̄n is the same as given in (15), τ = T /N is the time between trades, and G(·) describes
a temporary price impact, which reﬂects temporary price deviations from “equilibrium”
caused by trading. With G(0) = 0 and G (·) > 0, the temporary price impact penalizes
high trading volume per unit of time, xn /τ . Using a linear form for G(·), G(z) = θz,
Huberman and Stanzl (2000) have shown that as N goes to inﬁnity the expected execution
cost approaches to
(F0 +s/2)X0 +

(λ/2)X02


+θ
0

T

dXt
dt

2

dt.

Clearly, with the temporary price impact, the optimal execution strategy has a sensible
continuous-time limit. In fact, it is very similar to its discrete-time counterpart: It is deterministic and the trade intensity, deﬁned by the limit of xn /τ , is constant over time.13
The temporary price impact introduced by Huberman and Stanzl reﬂects an important
aspect of the market, the diﬀerence between short-term and long-term supply/demand. If a
trader speeds up his buy trades, as he can do in the continuous-time limit, he will deplete
the short-term supply and increase the immediate cost for additional trades. As more time is
allowed between trades, supply will gradually recover. However, as a heuristic modiﬁcation,
the temporary price impact does not provide an accurate and complete description of the
supply/demand dynamics, which leads to several drawbacks. First, the temporary price
impact function in the form considered by Huberman and Stanzl rules out the possibility
of discrete trades. This is not only artiﬁcial but also undesirable. As we show later, in
general the optimal execution strategy does involve both discrete and continuous trades.
13

If the trader is risk-averse with a mean-variance preference, the optimal execution strategy has a decreasing trading intensity over time.

12

Moreover, introducing the temporary price impact does not capture the full dynamics of
supply/demand.14 Also, simply specifying a particular form for the temporary price impact
function says little about the underlying economic factors that determine it.

4.4

A Special Case of Our Framework

In the conventional setting, the supply/demand of a security is described by a static price
impact function. This is inadequate when we need to determine the timing of the execution
strategy optimally. As we have seen in Section 3, using a simple limit order book framework,
the supply/demand has to be viewed as an intertemporal object which exhibits rich dynamics.
The simple price impact function, even with the modiﬁcation proposed by Humberman and
Stanzl (2000), misses important intertemporal aspects of the supply/demand that are crucial
to the determination of optimal execution strategy.
We can see the limitations of the conventional model by considering it as a special case
of our general framework. Indeed, we can specify the parameters in the LOB framework so
that it will be equivalent to the conventional setting. First, we set the trading times at ﬁxed
intervals: tn = nτ , n = 0, 1, . . . , N . Next, we make the following assumptions on the LOB
dynamics as described in (5) and (9):
q = 1/(2λ),

λ = λ,

ρ=∞

(19)

where the second equation simply states that the price impact coeﬃcient in the LOB framework is set to be equal to its counterpart in the conventional setting. These restrictions
imply the following dynamics for the LOB. As it follows from (10), after the trade xn at tn
(tn = nτ ) the ask price Atn jumps from Vtn +s/2 to Vtn +s/2+2λxn . Over the next period,
it comes all the way down to the new steady state level of Vtn + s/2 + λxn (assuming no
fundamental shocks from tn to tn+1 ). Thus, the dynamics of ask price Atn is equivalent to
dynamics of P̄tn in (15).
For the parameters speciﬁed in (19), the cost for trade xtn , c(xtn ) = [Atn +xtn /(2q)] xtn ,
becomes
c(xtn ) = [Ftn +s/2 + λ(X0 −Xtn ) + λxtn ] xtn
which is the same as the trading cost in the conventional model (16). Thus, the conventional
model is a special case of LOB framework for parameters in (19).
The main restrictive assumption we have to make to obtain the conventional setup is that
ρ = ∞ and the limit order book always converges to its steady state before the next trading
14

For example, two sets of trades close to each other in time versus far apart will generate diﬀerent
supply/demand dynamics, while in Huberman and Stanzl (2000) they lead to the same dynamics.

13

time. This is not crucial if the time between trades is held ﬁxed. But if the time between
trades is allowed to shrink, this assumption becomes unrealistic. It takes time for the new
limit orders to come in to ﬁll up the book again. The shape of the limit order book after a
trade depends on the ﬂow of new orders as well as the time elapsed. As the time between
trades shrinks to zero, the assumption of inﬁnite recovery speed becomes less reasonable and
it gives rise to the problems in the continuous-time limit of the conventional model.

5

Discrete-Time Solution

We now return to our general framework and solve the model for the optimal execution
strategy when trading times are ﬁxed, as in the conventional model. We then show that
in contrast to the conventional setting, our framework is robust for studying convergence
behavior as time between trades goes to zero. Taking the continuous-time limit we examine the resulting optimal execution strategy which turns out to include both discrete and
continuous trading.
Suppose that trade times are ﬁxed at tn = nτ , where τ = T /N and n = 0, 1, . . . , N . We
consider the corresponding strategies x[0, T ] = {x0 , x1 , . . . , xn } within the strategy set ΘD
deﬁned in Section 2. The optimal execution problem, deﬁned in (3), now reduces to
 N


min
J0 =
E0
[Atn + xn /(2q)] xn
{x0 ,...,xN }

s.t.

(20)

n=0

Atn = Ftn + λ(X0 −Xtn ) + s/2 +

n−1


xi κe−ρτ (n−i)

i=0

where Ft follows a random walk. This problem can be solved using dynamic programming.
We have the following result:
Proposition 1 The solution to the optimal execution problem (20) is


xn = − 12 δn+1 Dtn 1−βn+1 e−ρτ +2κγn+1 e−2ρτ − Xtn λ+2αn+1 −βn+1 κe−ρτ

(21)

with xN = XN , where Dt = At − Vt − s/2. The expected cost for future trades under the
optimal strategy is
Jtn = (Ftn +s/2)Xtn + λX0 Xtn + αn Xt2n + βn Dtn Xtn + γn Dt2n

(22)

where the coeﬃcients αn+1 , βn+1 , γn+1 and δn+1 are determined recursively as follows
αn = αn+1 − 14 δn+1 (λ+2αn+1 −βn+1 κe−ρτ )2

(23a)

βn = βn+1 e−ρτ + 21 δn+1 (1−βn+1 e−ρτ +2κγn+1 e−2ρτ )(λ+2αn+1 −βn+1 κe−ρτ )

(23b)

γn = γn+1 e−2ρτ − 14 δn+1 (1−βn+1 e−ρτ +2γn+1 κe−2ρτ )2

(23c)

14

−1

with δn+1 = [1/(2q)+αn+1 −βn+1 κe−ρτ +γn+1 κ2 e−2ρτ ]
αN = 1/(2q) − λ,

βN = 1,

and terminal condition

γN = 0.

(24)

Proposition 1 gives the optimal execution strategy when we ﬁx the trade times at a
certain interval τ . But it is only optimal among strategies with the same ﬁxed trading
interval. In principle, we want to choose the trading interval to minimize the execution cost.
One way to allow diﬀerent trading intervals is to take the limit τ → 0, i.e., N → ∞, in
the problem (20). Figure 2 plots the optimal execution strategy {xn , n = 0, 1, . . . , N } for
N = 10, 25, 100, respectively. Clearly, it is very diﬀerent from the strategy given in (17)
and obtained previously when the dynamics of demand/supply is ignored. Moreover, as N
becomes large, the strategy splits into two parts, large trades at both ends of the horizon
(the beginning and the end) and small trades in between.
Trade Profiles for Different N
N=10
26317

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
N=25

24697

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
N=100

23899

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

Figure 2: Optimal execution strategy with ﬁxed discrete trading intervals. This ﬁgure plots
the optimal trades for N ﬁxed intervals, where N is 10, 25 and 100 for respectively the top,
middle and bottom panels. The initial order to trade is set at X0 = 100, 000 units, the time
horizon is set at T = 1 day, the market depth is set at q = 5, 000 units, the price-impact
coeﬃcient is set at λ = 1/(2q) = 10−4 and the resiliency coeﬃcient is set at ρ = 2.231.

The next proposition describes the limit of the optimal execution strategy and the expected cost:

15

Proposition 2 In the limit of N → ∞, the optimal execution strategy becomes
X0
N →∞
ρT +2
ρX0
, t ∈ (0, T )
lim xn /(T /N ) = Ẋt =
N →∞
ρT +2
X0
lim xN = xt=T =
N →∞
ρT +2
lim x0 = xt=0 =

(25a)
(25b)
(25c)

and the expected cost is
Jt = (F0 +s/2)Xt + λX0 Xt + αt Xt2 + βt Xt Dt + γt Dt2
where coeﬃcients αt , βt , γt are given by
κ
2
ρ(T −t)
λ
− , βt =
, γt = −
.
(26)
ρ(T −t)+2 2
ρ(T −t)+2
2κ[ρ(T −t)+2]
The optimal execution strategy given in Proposition 2 is diﬀerent from those obtained
αt =

in the conventional setting. In fact, it involves both discrete and continuous trades. This
clearly indicates that the timing of trades is a critical part of the optimal strategy. It also
shows that ruling out discrete or continuous trades ex ante is in general suboptimal. More
importantly, it demonstrates that both the static and dynamic properties of supply/demand,
which are captured by the LOB dynamics in our framework, are important in analyzing the
optimal execution strategy. We return in Section 7 to examine in more detail the properties
of the optimal execution strategy and their dependence on the LOB dynamics.

6

Continuous-Time Solution

The nature of the continuous-time limit of the discrete-time solution suggests that limiting
ourselves to discrete strategies can be suboptimal. We should in general formulate the
problem in continuous-time setting and allow both continuous and discrete trading strategies.
In this section, we present the continuous-time version of the LOB framework and derive the
optimal strategy.
The uncertainty in model is fully captured by fundamental value Ft . Let Ft = F0 + σZt
where Zt is a standard Brownian motion deﬁned on [0, T ]. Ft denotes the ﬁltration generated
by Zt . A general execution strategy can consist of two components, a set of discrete trades
at certain times and a ﬂow of continuous trades. A set of discrete trades is also called an
“impulse” trading policy.
Deﬁnition 1 Let N+ = {1, 2, . . .}. An impulse trading policy (τk , xk ) : k ∈ N+ is a sequence
of trading times τk and trade amounts xk such that: (1) 0 ≤ τk ≤ τk+1 for k ∈ N+ , (2) τk is
a stopping time with respect to Ft , and (3) xk is measurable with respect to Ftk .
16

The continuous trades can be deﬁned by a continuous trading policy described by the intensity of trades µ[0, t] , where µt is measurable with respect to Ft and µt dt gives the trades
during time interval [t, t + dt). Let us denote T̂ the set of impulse trading times. Then, the
set of admissible execution strategies for a buy order is
⎫
⎧
 T
⎬
⎨

ΘC = µ[0, T ] , x{t∈T̂ } : µt , xt ≥ 0,
µt dt +
xt = X0
⎭
⎩
0

(27)

t∈T̂

where µt is the rate of continuous buy trades at time t and xt is the discrete buy trade for
t ∈ T̂ . The dynamics of Xt , the number of shares to acquire at time t, is then given by the
following equation:
 t

Xt = X0 −
µs ds −
xs .
0

s∈T̂ , s<t

Now let us specify the dynamics of ask price At . Similar to the discrete-time setting, we
have A0 = F0 +s/2 and
 t
dVs − ρDs ds − κdXs
At = A0 +

(28)

0

where Vt = Ft + λ(X0 −Xt ) as in (9) and Dt = At −Vt −s/2 as in (7). The dynamics of At
captures the evolution of the limit order book, in particular the changes in Vt , the inﬂow of
new orders and the continuous execution of trades.
Next, we compute the execution cost, which consists of two parts: the costs from continuous trades and discrete trades, respectively. The execution cost from t to T is
 T

Ct =
As µs ds +
[As + xs /(2q)] xs .
t

(29)

s∈T̂ , t≤s≤T

Given the dynamics of the state variables in (9), (28), and cost function in (29), the
optimal execution problem now becomes
Jt ≡ J(Xt , At , Vt , t) =

min

{µ[0, T ] , {xt∈T̂ }}∈ΘC

Et [Ct ]

(30)

where Jt is the value function at t, the expected cost for future trades under the optimal
execution strategy. At time T , the trader is forced to buy all of the remaining order XT ,
which leads to the following boundary condition:
JT = [AT + 1/(2q)XT ] XT .
The next proposition gives the solution to the problem:

17

Proposition 3 The value function for the optimization problem (30) is
Jt = (Ft +s/2)Xt + λX0 Xt + αt Xt2 + βt Dt + γt Dt2
where Dt = At −Vt −s/2. The optimal execution strategy is
x0 = x T =

X0
,
ρT + 2

µt =

ρX0
∀ t ∈ (0, T )
ρT + 2

(31)

where the coeﬃcients αt , βt , and γt are the same as given in Proposition 2.
Obviously, the solution we obtained with the continuous-time setting is identical to the
continuous-time limit of the solution in the discrete-time setting. The optimal strategy
consists of both continuous and discrete trades.

7

Optimal Execution Strategy and Cost

In contrast with previous work, the optimal execution strategy includes discrete and continuous trading. We now analyze the properties of the optimal execution strategy in more
detail. Interestingly, while it does not depend on parameters λ and q, which determine static
supply/demand, it crucially depends on parameter ρ, which describes the LOB dynamics,
and the horizon for execution T . Further in this section we quantify the cost reduction which
the optimal execution strategy brings and discuss its empirical implications.

7.1

Properties of Optimal Execution Strategy

The ﬁrst thing to notice is that the execution strategy does not depend on λ and q. Coeﬃcient
λ captures the permanent price impact of a trade. Given the linear form, the permanent
price impact gives an execution cost of (F0 +s/2)X0 + (λ/2)X02 , which is independent of the
execution strategies. This is a rather striking result given that most of the previous work
focus on λ as the key parameter determining the execution strategy and cost. As we show
earlier, λ aﬀects the execution strategy when the times to trade are exogenously set at ﬁxed
intervals. When the times to trade are determined optimally, the impact of λ on execution
strategy disappears. Given the linear form of the price impact function, λ fully describes the
instantaneous supply/demand, or the static supply/demand. Our analysis clearly shows that
the static aspects of the supply/demand does not fully capture the factors that determining
the optimal execution strategy.
Coeﬃcient q captures the depth of the market. In the simple model for the limit order
book we have assumed, market depth is constant at all price levels above the ask price. In
this case, the actual value of the market depth does not aﬀect the optimal execution strategy.
18

For more general (and possibly more realistic) shapes of the limit order book, the optimal
execution strategy may well depend on the characteristics of the book.
The optimal execution strategy depends on two parameters, the resilience of the limit
order book ρ and the horizon for execution T . We consider these dependencies separately.
At

Xt

A T+
X0
AT

X 0+

A 0+

v t+s/2

XT
A0
XT+
0

T

t

(a)

0

T

t

(b)

Figure 3: Proﬁles of the optimal execution strategy and ask price. Panel (a) plots the
proﬁle of optimal execution policy as described by Xt . Panel (b) plots the proﬁle of realized
ask price At . After the initial discrete trade, continuous trades are executed as a constant
fraction of newly incoming sell orders to keep the deviation of the ask price At from its
steady state Vt + s/2, shown with grey line in panel (b), at a constant. A discrete trade
occurs at the last moment T to complete the order.
Panel (a) of Figure 3 plots the optimal execution strategy, or more precisely the time
path of the remaining order to be executed. Clearly, the nature of the optimal strategy is
diﬀerent from those proposed in the literature, which involve a smooth ﬂow of small trades.
When the timing of trades is determined optimally, the optimal execution strategy consists
of both large discrete trades and continuous trades. In particular, under the LOB dynamics
we consider here, the optimal execution involves a discrete trade at the beginning, followed
by a ﬂow of small trades and then a discrete terminal trade. Such a strategy seems intuitive
given the dynamics of the limit order book. The large initial trade pushes the limit order
book away from its stationary state so that new orders are lured in. The ﬂow of small
trades will “eat up” these new orders and thus keep them coming. At the end, a discrete
trade ﬁnishes the remaining part of the order. The ﬁnal discrete trade is determined by two
factors. First, the order has to be completed within the given horizon. Second, the evolution
of supply/demand afterwards no longer matters. In practice, both of these two factors can
take diﬀerent forms. For example, the trading horizon T can be endogenously determined
rather than exogenously given. We consider this extension in Section 8.
The size of the initial trade determines the prices and the intensity of the new orders. If
too large, the initial trade will raise the average prices of the new orders. If too small, an
initial trade will not lure in enough orders before the terminal time. The trade oﬀ between
19

these two factors largely determines the size of the initial trade.
The continuous trades after the initial trade are intended to maintain the ﬂow of new
orders at desirable prices. To see how this works, let us consider the path of the ask price
At under the optimal execution strategy. It is plotted in panel (b) of Figure 3. The initial
discrete trade pushes up the ask price from A0 = V0 +s/2 to A0+ = V0 +s/2+X0 /(ρT +2)/q.
Afterwards, the optimal execution strategy keeps Dt = At − Vt − s/2, the deviation of the
current ask price At from its steady state Vt + s/2, at a constant level of κX0 /(ρT + 2).
Consequently, the rate of new sell order ﬂow, which is given by ρDt , is also maintained at a
constant level. The ask price At goes up together with Vt +s/2, the steady-state “value” of
the security, which is shown with the grey line in Figure 3(b). As a result, from (28) with
dAt = dVt for 0 < t < T , we have ρDt = κµt or µt = (1/κ)ρDt . In other words, under the
optimal execution strategy a constant fraction of 1/κ of the new sell orders is executed to
maintain a constant order ﬂow.
Our discussion above shows that the dynamics of the limit order book, which is captured
by the resilience parameter ρ, is the key factor in determining optimal execution strategy.
In order to better understand this link, let us consider two extreme cases, when ρ = 0
and ∞. When ρ = 0, we have no recovery of the limit order book after a trade. In this
case, the cost of execution will be strategy independent and it does not matter when and
at what speed the trader eats up the limit order book. This result is also true in a discrete
setting with any N and in its continuous-time limit. When ρ = ∞, the limit order book
rebuilds itself immediately after a trade. As we discussed in Section 4, this corresponds to
the conventional setting. Again, the execution cost becomes strategy independent. It should
be pointed out that even though in the limit of ρ → 0 or ∞, the optimal execution strategy
given in Proposition 3 converges to a pure discrete strategy or a pure continuous strategy,
other strategies are equally good given the degeneracy in these two cases.
When 0 < ρ < ∞, the resiliency of the limit order book is ﬁnite, the optimal strategy
is a mixture of discrete and continuous trades. The fraction of the total order executed
T
through continuous trades is 0 µt dt/X0 = ρT /(ρT +2), which increases with ρ. In other
words, it is more eﬃcient to use small trades when the limit order book is more resilient.
This is intuitive because discrete trades do less in taking full advantage of new order ﬂows
than continuous trades.
Another important parameter in determining the optimal execution strategy is the timehorizon to complete the order T . From Proposition 3, we see that as T increases, the size of
the two discrete trades decreases. This result is intuitive. The more time we have to execute
the order, the more we can continuous trades to beneﬁt from the inﬂow of new orders and
to lower the total cost.
20

7.2

Minimum Execution Cost

So far, we have focused on the optimal execution strategy. We now examine how important
the optimal execution is, as measured by the execution cost it saves. For this purpose, we
use the strategy obtained in the conventional setting and its cost as the benchmark. The
total expected execution cost of a buy order of size X0 is equal to its fundamental value
(F0 +s/2)X0 , which is independent of the execution strategy, plus the extra cost from the
price impact of trading, which does depend on the execution strategy. Thus, we will only
consider the execution cost, net of the fundamental value, or the net execution cost.
As shown in Section 4, the strategy from the conventional setting is a constant ﬂow
of trades with intensity µ∞ = X0 /T , t ∈ [0, T ]. Under this simple strategy, we have
Vt = Ft + λ(t/T )X0 , Dt = [κX0 /(ρT )](1 − e−ρt ) and At = Vt +Dt +s/2. The expected net
execution cost for the strategy with constant rate of execution µ∞ is given by
 T

ρT − (1−e−ρT ) 2
CM
J˜0 = E0
(At −Ft −s/2)(X0 /T )dt = (λ/2)X02 + κ
X0
(ρT )2
0
where the superscript stands for the “Conventional Model”. From Proposition 3, the expected net cost under the optimal execution strategy is
κ
J˜0 = J0 − (F0 +s/2)X0 = (λ/2)X02 +
X2
ρT + 2 0
(note that at t = 0, D0 = 0). Thus, the improvement in expected execution cost by the
optimal strategy is J0CM − J0 , which is given by
2ρT −(ρT +2)(1−e
J˜0CM − J˜0 = κ
(ρT +2)(ρT )2

−ρT

)

X02

and is always non-negative. The relative gain can be deﬁned as ∆ = (J˜CM − J˜0 )/J˜CM .
In order to calibrate the magnitude of the cost reduction by the optimal execution strategy, we consider some numerical examples. Let the size of the order to be executed be
X0 = 100, 000 shares and the initial security price be A0 = F0 +s/2 = $100. We choose the
width of the limit order book, which gives the depth of the market, to be q = 5, 000. This
implies that if the order is executed at once, the ask price will move up by 20%. Without
losing generality, we consider the execution horizon to be one day, T = 1.15 The other
parameters, especially ρ, may well depend on the security under consideration. In absence
of an empirical calibration, we with consider a range of values for them.
Table 1 reports the numerical values of the optimal execution strategy for diﬀerent values
15

Chan and Lackonishok (1995) documented that for institutional trades T is usually between 1 to 4 days.
Keim and Madhavan (1995) found that the duration of trading is surprisingly short, with almost 57% of buy
and sell orders completed in the ﬁrst day. Keim and Madhavan (1997) reported that average execution time
is 1.8 days for a buy order and 1.65 days for a sell order.

21

of ρ. As discussed above, for small values of ρ, most of the order is executed through two
discrete trades, while for large values of ρ, most of the order is executed through a ﬂow of
continuous trades as in the conventional models. For intermediate ranges of ρ, a mixture of
discrete and continuous trades is used.
ρ

Half-life (log 2/ρ)

Trade x0

Trade over (0, T )

Trade xN

0.001
0.01
0.5
1
2
4
5
10
20
50
300
1000
10000

693.15 day
69.31 day
1.39 day
270.33 min
135.16 min
67.58 min
54.07 min
27.03 min
13.52 min
5.40 min
0.90 min
0.20 min
0.03 min

49,975
49,751
40,000
33,333
25,000
16,667
14,286
8,333
4,545
1,921
331
100
10

50
498
20,000
33,334
50,000
66,666
71,428
83,334
90,910
96,153
99,338
99,800
99,980

49,975
49,751
40,000
33,333
25,000
16,667
14,286
8,333
4,545
1,921
331
100
10

Table 1: Proﬁles of the optimal execution strategy for diﬀerent levels of LOB resiliency
ρ. The table reports values of optimal discrete trades x0 and xT at the beginning and the
end of the trading horizon and the intensity of continuous trades in between for an order
of X0 = 100, 000 for diﬀerent values of the LOB resilience parameter ρ or the half-life of
an LOB disturbance τ1/2 , which is deﬁned as exp{−ρ τ1/2 } = 1/2. The initial ask price is
$100, the market depth is set at q = 5, 000 units, the (permanent) price-impact coeﬃcient
is set at λ = 1/(2q) = 10−4 , and the trading horizon is set at T = 1 day, which is 6.5 hours
(390 minutes).

Table 2 reports the relative improvement in the expected net execution cost by the
optimal execution strategy over the simple strategy of the conventional setting. Let us ﬁrst
consider the extreme case in which the resilience of the LOB is very small, e.g., ρ = 0.001
and the half-life for the LOB to rebuild itself after being hit by a trade is 693.15 days. In
this case, even though the optimal execution strategy looks very diﬀerent from the simple
execution strategy, as shown in Figure 4, the improvement in execution cost is minuscule.
This is not surprising as we know the execution cost becomes strategy independent when
ρ = 0. For a modest value of ρ, e.g. ρ = 2 with a half life of 135 minutes (2 hours and 15
minutes), the improvement in execution cost ranges from 4.32% for λ = 1/(2q) to 11.92%
for λ = 0. When ρ becomes large and the LOB becomes very resilient, e.g., ρ = 300 and
the half-life of LOB deviation is 0.90 minute, the improvement in execution cost becomes
small again, with a maximum of 0.33% when λ = 0. This is again expected as we know that
22

ρ

Half-life

1
2q

0.001
0.01
0.5
1
2
4
5
10
20
50
300
1000
10000

693.15 day
69.31 day
1.39 day
270.33 min
135.16 min
67.58 min
54.07 min
27.03 min
13.52 min
5.40 min
0.90 min
0.20 min
0.03 min

0.00
0.08
2.82
3.98
4.32
3.19
2.64
1.13
0.37
0.07
0.00
0.00
0.00

λ

1
10q

1
50q

1
100q

0

0.01
0.15
5.42
8.16
9.97
9.00
8.07
4.58
1.98
0.49
0.02
0.00
0.00

0.02
0.16
5.99
9.14
11.51
11.05
10.21
6.65
3.54
1.24
0.08
0.01
0.00

0.02
0.16
6.06
9.26
11.71
11.35
10.53
7.01
3.89
1.50
0.13
0.02
0.00

0.02
0.17
6.13
9.39
11.92
11.65
10.86
7.41
4.31
1.88
0.33
0.10
0.09

Table 2: Cost savings by the optimal execution strategy from the simple trading strategy.

Relative improvement in expected net execution cost ∆ = (J˜CM − J˜0 )/J˜CM is reported for
diﬀerent values of LOB resiliency coeﬃcient ρ and the permanent price-impact coeﬃcient.
The order size is set at 100,000, the market depth is set at q = 5, 000 and the horizon for
execution is set at T = 1 day (equivalent of 390 minutes).

the simple strategy is close to the optimal strategy when ρ → ∞ (as in this limit, the cost
becomes strategy independent).
In order to see the diﬀerence between the optimal strategy and the simple strategy
obtained in conventional settings, we compare them in Figure 4. The solid line shows the
optimal execution strategy of the LOB framework and the dashed line shows the execution
strategy of the conventional setting. Obviously, the diﬀerence between the two strategies are
more signiﬁcant for smaller values of ρ.
Table 2 also reveals an interesting result. The relative savings in execution cost by the
optimal execution strategy is the highest when λ = 0, i.e., when the permanent price impact
is zero.16

7.3

Empirical Implications

Optimality of discrete trades at the beginning and the end of the trading period leads to
interesting empirical implications. It is well documented that there is a U-shaped pattern in
the intraday trading volume, price volatility and average bid-ask spread.17 Several authors
16

Of course, the magnitude of net execution cost becomes very small as λ goes to zero.
Intraday patterns in volume and prices in the U.S. markets have been documented by Jain and Joh(1988),
Gerety and Mulherin (1992), Chan, Christie, Schultz (1995), among others. They are also present in other
17

23

X t /X

X t /X 0
1

0

1

0

(a)

T=1

t

X t /X

0

1

0
(b)

T=1

t

0

T=1

t

(c)

Figure 4: Optimal execution strategy versus simple execution strategy from the conventional models. The ﬁgure plots the time paths of remaining order to be executed for the
optimal strategy (solid line) and the simple strategy obtained from the conventional models
(dashed line), respectively. The order size is set at X0 = 100, 000, the initial ask price
is set at $100, the market depth is set at q = 5, 000 units, the (permanent) price-impact
coeﬃcient is set at λ = 1/(2q) = 10−4 , and the trading horizon is set at T = 1 day, which
is assumed to be 6.5 hours (390 minutes). Panels (a), (b) and (c) plot the strategies for
ρ = 0.001, 2 and 1, 000, respectively.

have proposed theoretical models that can help to explain the intraday price and volume
patterns.18 Most of these models generate the intraday patterns from the time variation in
information asymmetry and/or trading opportunities associated with market closures.
Our model suggests an alternative source for such patterns. Namely, they can be generated by the optimal execution of block trades. It is well known that large-block transactions
have become a substantial fraction of the total trading volume for common stocks. According to Keim and Madhaven(1996), block trades represented almost 54% of New York
Stock Exchange share volume in 1993 while in 1965 the corresponding ﬁgure was merely 3%.
Thus, the execution strategies of institutional traders can inﬂuence the intraday variation
in volume and prices. It is often the case that institutional investors have daily horizons
to complete their orders, for example to accommodate the inﬂows and outﬂows in mutual
funds. For reasonable values of the LOB recovery speed ρ, our optimal execution strategy
implies large trades at the beginning and at the end of trading period. If execution horizon
of institutional traders coincides with a trading day, their trading can cause the increase in
trading volume and bid-ask spread at the beginning and the end of a trading day.
Our model predicts higher variation in the optimal trading proﬁle for stocks with lower
ρ. This implies that stocks with low resilience in its LOB (low ρ) and high institutional
holdings should exhibit more intraday volume variation. We leave the empirical tests of
these predictions for future research.
markets. See McInish and Wood(1991) for the Toronto Stock Exchange, Hamao and Hasbrouck (1995) for
the Tokyo Stock Exchange, Niemayer and Sandas (1993) for the Stockholm Stock Exchange, and Kleidon
and Werner (1996) for the London Stock Exchange.
18
See, for example, Admati and Pﬂeiderer (1988), Back and Baruch (2004), Brock and Kleidon (1992),
Foster and Viswanathan(1990, 1995), and Hong and Wang (2000).

24

8

Extensions

So far, we have used a parsimonious LOB model to analyze the impact of supply/dynamics
on optimal execution strategy. Obviously, the simple characteristics of the model does not
reﬂect the richness in the LOB dynamics we actually face in the market. However, the
framework we developed is quite ﬂexible to allow for extensions in various directions. In
this section, we brieﬂy discuss some of these extensions. First, we consider the case where
the resilience of the LOB is time-varying. Next, we discuss the possibility of allowing more
general shapes of the static limit order book. Finally, we include risk considerations in
optimization problem.

8.1

Time Varying LOB Resiliency

Our model can easily incorporate time-variation in LOB resiliency. It has been documented
that trading volume, order ﬂows and transaction costs all exhibit a U-shaped intraday pattern, high at the opening of the trading day, then falling to lower constant levels during the
day and ﬁnally rising again towards the close of trading day. This suggests that the liquidity
in the market may well vary over a trading day. Monch (2004) has attempted to incorporate
such a time-variation in implementing the conventional models.
We can easily allow time-variation in LOB and its dynamics in our model. In particular,
we can allow the resilience coeﬃcient to be time dependent, ρ = ρt for t ∈ [0, T ]. The results
T
T
in Proposition 1, 2, 3 still hold if we replace ρ by ρt , ρT by 0 ρt dt and ρ(T − t) by t ρt dt.

8.2

Diﬀerent Shapes for LOB

We have considered a simple shape for the LOB, which is a step function. As we showed
in Section 3, this form of the LOB is consistent with the static linear price impact function
widely used in the literature. Huberman and Stanzl (2000) have provided theoretical arguments in support of the linear price impact functions. However, empirical literature has
suggested that the shape of the LOB can be more complex (see, e.g., Hopman (2003)). We
can allow more general shapes of the LOB in our framework. This will also make the LOB
dynamics more complex. As a trade eats away the tip of the LOB, we have to specify how the
LOB converges to its steady state. With a complicated shape for the LOB, this convergence
process can take many forms which involves assumptions about the ﬂow or new orders at
a range of prices. For certain speciﬁcations of this convergence process, our model is still
tractable. For brevity, we do not present these cases here. But beyond certain point, closed
form solutions become hard to ﬁnd. Although the actual strategy can be quite complex

25

and depends on the speciﬁcs of the LOB shape and its dynamics, we expect its qualitative
features to be the same as that under the simple LOB dynamics we considered.

8.3

Risk Aversion

Let us consider the optimal execution problem for a risk-averse trader. For tractability, we
assume that he has a mean-variance objective function with a risk-aversion coeﬃcient of a.
The optimization problem (30) now becomes
Jt ≡ J(Xt , At , Vt , t) =

min

{µ[0, T ] , {xt∈T̂ }}∈ΘC

Et [Ct ] + 12 a Vart [Ct ]

(32)

with (9), (28), (29) and the same terminal condition JT = [AT + 1/(2q)XT ] XT . Since the
only source of uncertainty is Ft and only the trades executed in interval [t, t + dt) will be
subject to this uncertainty, we can rewrite (32) in a more convenient form:
 T
1
min
Jt =
Et [Ct ] + 2 a
σ 2 Xs2 ds.
{µ[0, T ] , {xt∈T̂ }}∈ΘC

(33)

t

At time T , the trader is forced to buy all of the remaining order XT . This leads to the
following boundary condition:
JT = [AT + 1/(2q)XT ] XT .
The next proposition gives the solution to the problem for a risk averse trader:
Proposition 4 The solution to the optimization problem (33) is
κf  (0) + aσ 2
κρf (0) + aσ 2
 (s)+ρ
ρg(t) − g  (t) − Ê0t κg
ds
1+κg(s)
e
µt = κx0
, ∀ t ∈ (0, T )
1 + κg(t)
 T
xT = X0 − x0 −
µs ds
x0 = X0

0

and the value function is
Jt = (Ft +s/2)Xt + λX0 Xt + αt Xt2 + βt Dt + γt Dt2
where Dt = At −Vt −s/2 and the coeﬃcients are given by
αt =

κf (t) − λ
f (t) − 1
, βt = f (t), γt =
2
2κ

26

and


2ρv
κρ
(T −t)
f (t) = (v − aσ )/(κρ) + − + e 2κρ+aσ2
2v

f (t) − ρf (t)
g(t) = − 
kf (t) + aσ 2

with v = a2 σ 4 + 2aσ 2 κρ.
2

κρ
κρ
−
2v v − aσ 2 − κρ

−1

It can be shown that as risk aversion coeﬃcient goes to 0 the coeﬃcients αt , βt , and γt
converge to the ones given in Proposition 2, which presents the results for the risk neutral
trader.
Xt
100000
80000

60000

a=0
a=0.05

40000

20000

a=0.5
a=1

0

T=1

t

Figure 5: Proﬁles of the optimal execution strategies for diﬀerent coeﬃcients of risk aversion. This ﬁgure shows the proﬁles of optimal execution policies Xt for the traders with
diﬀerent coeﬃcients of risk aversion a = 0 (solid line), a = 0.05 (dashed line), a = 0.5
(dashed-dotted line) and a = 1 (dotted line), respectively. Variable Xt indicates how much
shares still has to be executed before trading at time t. The order size is set at X0 = 100, 000,
the market depth is set at q = 5, 000 units, the permanent price-impact coeﬃcient is set at
λ = 0, and the trading horizon is set at T = 1, the resiliency coeﬃcient is set at ρ = 1.

The nature of the optimal strategy remains qualitatively the same under risk aversion:
discrete trades at the two ends of the trading horizon with continuous trades in the middle.
The eﬀect of trader’s risk aversion on his optimal trading proﬁle is shown in Figure 5.
The more risk averse is the trader, the larger the initial trade more trades he shifts to the
beginning.
So far, we have assumed the execution horizon, [0, T ], to be exogenously given, and
ignored any time preference for execution a trade. Risk aversion, however, introduces a
natural preference for such a preference: Trading sooner reduces uncertainty in execution
prices. Such a preference is clearly reﬂected in the optimal policy as shown in Figure 5. Such
a time preference provides a mechanism to endogenize the execution horizon. For example,
T is suﬃciently large, when the trader is risk-averse enough, he may optimally ﬁnish the
whole order soon before T .
27

9

Conclusion

In this paper, we analyze the optimal trading strategy to execute a large order. We show
that the static price impact function widely used in previous work fails to capture the intertemporal nature of a security’s supply/demand in the market. We construct a simple
dynamic model for a limit order book market to capture the intertemporal nature of supply/demand and solve for the optimal execution strategy. We show that when trading times
are chosen optimally, the dynamics of the supply/demand is the key factor in determining
the optimal execution strategy. Contrary to previous work, the optimal execution strategy
involves discrete trades as well as continuous trades, instead of merely continuous trades.
This trading behavior is consistent with the empirical intraday volume and price patterns.
Our results on the optimal execution strategy also suggest testable implications for these
intraday patterns and provide new insight into the demand of liquidity in the market.
The speciﬁc model we used for the LOB dynamics is very simple since our goal is mainly
to illustrate its importance. The actual LOB dynamics can be much more complex. However,
the framework we developed is fairly general to accommodate rich forms of LOB dynamics.
Moreover, with the current increase in the number of open electronic limit order books, our
LOB model can be easily calibrated and used to address real world problems.
It is important to note that our analysis is of a partial equilibrium nature. We take
the LOB dynamics as given and derive the optimal execution strategy for a large order.
In general, the order ﬂow that determines the LOB dynamics arises from the optimizing
behavior of other market participants. As discussed before, ideally we want to have the
order ﬂow process to be consistent with the optimal behavior of those who submit the
orders. In other words, the optimal execution should be consistent with an equilibrium of
the market. We leave such an analysis for future research.

28

Appendix
Proof of Proposition 1
From (7), we have
Dtn = Atn −Vtn −s/2 =

n−1


xti κe−ρτ (n−i)

(A.1)

i=0

From (A.1), the dynamics of Dt between trades will be
Dtn+1 = (Dtn + xtn κ) e−ρτ

(A.2)

with D0 = 0. We can then re-express the optimal execution problem (20) in terms of variables
Xt and Dt :
min E0

x∈ΘD

N


[(Ftn +s/2) + λ(X0 −Xtn )+Dtn +xtn /(2q)] xtn .

(A.3)

n=0

under dynamics of Dt given by (A.2).
First, by induction we prove that value function for (A.3) is quadratic in Xt and Dt and
has a form implied by (22):
J(Xtn , Dtn , Ftn , tn ) = (Ftn +s/2)Xtn + λX0 Xtn + αn Xt2n + βn Xtn Dtn + γn Dt2n .

(A.4)

At time t = tN = T , the trader has to ﬁnish the order and the cost is
J(XT , DT , FT , T ) = (FT +s/2)XT + [λ(X0 −XT )+DT +XT /(2q)]XT .
Hence, αN = 1/(2q) − λ, βN = 1, γN = 0. Recursively, the Bellman equation yields

Jtn−1 = min (Ftn−1 +s/2) + λ(X0 −Xtn−1 )+Dtn−1 +xn−1 /(2q) xn−1
xn−1

+ Etn−1 J Xtn−1 −xn−1 , (Dtn−1 +κxn−1 )e−ρτ , Ftn , tn .
Since Ftn follows Brownian motion and value function is linear in Ftn , it immediately follows
that the optimal xn−1 is a linear function of Xtn−1 and Dtn−1 and the value function is a
quadratic in Xtn−1 and Dtn−1 satisfying (A.4), which leads to the recursive equation (23) for
the coeﬃcients. Q.E.D.

Proof of Proposition 2
First, we prove the convergence of the value function. As τ = T /N → 0, the ﬁrst order
approximation of the system (23) in τ leads to the following restrictions on the coeﬃcients:
λ + 2αt − βt κ = 0

(A.5)

1 − βt + 2κγt = 0
29

and
α̇t = 14 κρβt2
β̇t = ρβt − 12 ρβt (βt − 4κγt )
γ̇t = 2ργt +

1
ρ(βt
4κ

(A.6)

− 4κγt )2 .

It is easy to verify that αt , βt and γt given in (26) are the solution of (A.6), satisfying (A.5)
and the terminal condition (24). Thus, as τ → 0 the coeﬃcients of the value function (23)
converge to (26).
Next, we prove the convergence result for the optimal execution policy {xt }. Substituting
αt , βt , γt into (21), we can show that as τ → 0, the execution policy converges to


1
1 + ρ(T −t)
− Dt
1 − 12 ρ2 (T −t)τ + 12 (ρ/κ)Dt τ + o(τ ) (A.7)
xt = Xt
ρ(T −t) + 2
κ[ρ(T −t) + 2]
where o(τ ) denotes terms to the higher order of τ . At t = 0, D0 = 0 and we have limτ →0 x0 =
X0
.
ρT +2

Moreover, after the initial discrete trade x0 all trades will be the continuous (except

possibly at T ) and equal to
xt = κ1 ρDt τ + o(τ ),

t = nτ,

n = 1, . . . , N − 1.

(A.8)

We prove this by induction. First, using (A.7), where Xτ = X0 − x0 and Dτ = kx0 (1 − ρτ ),
it is easy to check that (A.8) holds for xτ . Second, let us assume that (A.8) holds for some
xt , where t = nτ , then we can show that xt+τ will satisfy it as well. In fact, the dynamics of
Xt and Dt is deﬁned by
Xt+τ = Xt − xt ,

Dt+τ = (Dt + kxt )(1 − ρτ ),

n = 0, . . . , N − 1. (A.9)

t = nτ,

Substituting these into (A.7) and using the induction assumption, we get that
xt+τ = (ρ/κ)Dt+τ τ + o(τ ).
Thus, after the discrete trade x0 at time t = 0 all consequent trades will be the continuous.
Moreover, (A.8) implies the following form of Xt and Dt dynamics:
Xt+τ = Xt − κ1 ρDt τ + o(τ ),

Dt+τ = Dt + o(τ ).

(A.10)

Taking into account the initial condition right after the trade at time 0, we ﬁnd that
Dt = Dτ =

kX0
+ o(τ ).
ρT + 2

Thus, from (A.8) as τ → 0 for any t ∈ (0, T ) trade xt converges to
X0 should be acquired by time T , it is obvious that limτ →0 xT =

30

ρX0
τ.
ρT +2

X0
.
ρT +2

Since all shares

Q.E.D.

Proof of Propositions 3 and 4
We give the proof of Proposition 4 along with Proposition 3 as a special case. Let us ﬁrst
formulate problem (33) in terms of variables Xt and Dt = At − Vt − s/2 whose dynamics
similar to (A.2) is
dDt = −ρDt dt − κdXt

(A.11)

with D0 = 0. If we write the cost of continuous and discrete trading as following:
dCtc = (Ft +s/2)µt dt + λ(X0 −Xt )µt dt + Dt µt dt

(A.12)

∆Ctd = 1{t∈T̂ } (Ft +s/2)xt + λ(X0 −Xt )xt + Dt xt + x2t /(2q) .

(A.13)

then (33) is equivalent to

⎡



min

{µ[0, T ] , {xt∈T̂ }}∈ΘC

Et ⎣

0

t

dCtc

+



⎤
∆Ctd ⎦

t∈T̂



T

+ (a/2)
t

σ 2 Xs2 ds

(A.14)

with (A.11), (A.12) and (A.13).
This is the optimal control problem with a single control variable Xt . We can now apply
standard methods to ﬁnd its solution. In particular, the solution will be characterized by
three regions where it will be optimal to trade discretely, continuously and do not trade at
all. We can specify the necessary conditions for each region which any value function should
satisfy. In fact, under some regularity conditions on the value function we can use Ito’s
lemma together with dynamic programming principle to derive Bellman equation associated
with (A.14). For this problem, Bellman equation is a variational inequality involving ﬁrstorder partial diﬀerential equation with gradient constraints. Moreover, the value function
should also satisfy boundary conditions. Below we will heuristically derive the variational
inequalities and show the candidate function which satisﬁes them. To prove that this function
is a solution we have to check the suﬃcient conditions for optimality using veriﬁcation
principle.19
We proceed with the proof of Proposition 4 in three steps. First, we heuristically deﬁne
the variational inequalities (VI) and the boundary conditions for the optimization problem
(A.14). Second, we show that the solution to the VI exists and implies a candidate value
function and a candidate optimal strategy. Third, we verify that candidate value function
and optimal strategy are indeed solution to optimization problem. Finally, we will discuss
the properties of optimal strategies.
19

For detailed treatment of similar problems see Hindy, Huang and Zhu(1997), Shreve and Soner (1994),
Eastham and Hastings(1988).

31

A. Variational Inequalities
Let J(Xt , Dt , Ft , t) be a value function for our problem. Then, under some regularity conditions it has to satisfy the necessary conditions for optimality or Bellman equation associated
with (A.14). For this problem, Bellman equation is a variational inequality involving ﬁrstorder partial diﬀerential equation with gradient constraints, i.e.,


min Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 , (Ft +s/2) + λ(X0 −Xt ) + Dt − JX + κJD = 0.
Thus, the space can be divided into three regions. In the discrete trade (DT) region, the
value function J has to satisfy
Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 > 0,

(Ft+s/2) + λ(X0−Xt ) + Dt − JX + κJD = 0. (A.15)

In the no trade (NT) region, the value function J satisﬁes:
Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 = 0,

(Ft+s/2) + λ(X0−Xt ) + Dt − JX + κJD > 0. (A.16)

In the continuous trade (CT) region, the value function J has to satisfy:
Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 = 0,

(Ft+s/2) + λ(X0−Xt ) + Dt − JX + κJD = 0. (A.17)

In addition, we have the boundary condition at terminal point T :
J(XT , DT , FT , T ) = (FT +s/2)XT + λ(X0 −XT )XT + DT XT + XT2 /(2q).

(A.18)

Inequalities (A.15)-(A.18) are the so called variational inequalities (VI’s), which are the
necessary conditions for any solutions to the problem (A.14).
B. Candidate Value Function
Basing on our analysis of discrete-time case we can heuristically derive the candidate value
function which will satisfy variational inequalities (A.15)-(A.18). Thus, we will be searching
for the solution in a class of quadratic in Xt and Dt functions. Note that it is always optimal
to trade at time 0. Moreover, the nature of the problem implies that there should be no NT
region. In fact, if we assume that there exists a strategy with no trading at period (t1 , t2 ),
then it will be always suboptimal with respect to the similar strategy except that the trade
at t1 is reduced by suﬃciently small amount

and

trades are continuously executed over

period (t1 , t2 ). Thus, the candidate value function has to satisfy (A.17) in CT region and
(A.15) in any other region.
Since there is no NT region, (Ft+s/2)+λ(X0−Xt )+Dt −JX +κJD = 0 holds for any point

32

(Xt , Dt , Ft , t). This implies a particular form for the quadratic candidate value function:
J(Xt , Dt , Ft , t) = (Ft +s/2)Xt + λX0 Xt
+ [κf (t) − λ)]Xt2 /2 + f (t)Xt Dt + [f (t) − 1]Dt2 /(2κ)

(A.19)

where f (t) is a function which depends only on t. Substituting (A.19) into Jt − ρDt JD +
1 2
σ JF F
2

+ aσ 2 Xt2 ≥ 0 we have:

(κf  + aσ 2 )Xt2 /2 + (f  −ρf )Xt Dt + (f  +2ρ−2f )Dt2 /(2κ) ≥ 0

(A.20)

which holds with an equality for any point of the CT region.
Minimizing with respect to Xt , we show that the CT region is speciﬁed by:
Xt = −

f  −ρf
Dt .
κf  + aσ 2

(A.21)

For (Xt , Dt ) in the CT region (A.20) holds with the equality. Thus, function f (t) can be
found from the Riccati equation:
f  (t)(2ρκ + aσ 2 ) − κρ2 f 2 (t) − 2aσ 2 ρf (t) + 2aσ 2 ρ = 0.

(A.22)

This guarantees that Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 is equal to zero for any points in CT
region and greater then zero for any other points. Taking in account terminal condition
f (T ) = 1, we can solve for f (t). As a result, if the trader is risk neutral and a = 0, then
f (t) =

2
.
ρ(T −t)+2

Substituting the expression for f (t) into (A.19) we get the candidate value function of Proposition 3. If the trader is risk averse and a = 0, then

κρ
κρ
κρ
2
1
+
−
f (t) = κρ (v − aσ ) −
2
2v
v − aσ − κ 2v

e

2ρv
(T −t)
2ρκ+aσ 2

−1

where v is the constant deﬁned in Proposition 4. From (A.19) this results in the candidate
value function speciﬁed in Proposition 4.
C. Veriﬁcation Principle
Now we verify that the candidate value function J(X0 , D0 , F0 , 0) obtained above is greater
or equal to the value achieved by any other trading policy. Let X[0, T ] be an arbitrary feasible
policy from ΘC and V (Xt , Dt , Ft , t) be the corresponding value function. We have
 t

µt dt −
xs
X(t) = X(0) −
0

s∈T̂ , s<t

where µt ≥ 0 and xt ≥ 0 for t ∈ T̂ . For any τ and X0 , we consider a hybrid policy which
follows policy Xt on the interval [0, τ ] and the candidate optimal policy on the interval [τ, T ].
33

The value function for this policy is
 τ
[(Ft +s/2)+λ(X0 −Xt ) + Dt ] µt dt
Vτ (X0 , D0 , F0 , 0) = E0
+



0

(Fti +s/2)xti +λ(X0 −Xti )xti + Dti xti +

x2ti /(2q)


+ J(Xτ , Dτ , Fτ , τ ) .

ti <τ, ti ∈T̂

(A.23)
For any function, e.g., J(Xt , Dt , Ft , t) and any (Xt , Dt , Ft , t), we have
 t
 t
 t
Js ds +
JX dX +
JD dD
J(Xt , Dt , Ft , t) =J(X0 , D0 , F0 , 0) +
0
0
0
 t
 t
 t

2
2
2
1
+
JF dF +
J
(dF
)
+
aσ
X
ds
+
s
2 FF
0

0

0

∆J.

(A.24)

ti <t, ti ∈T̂

Use dDt = −ρDt dt − κdXt and substitute (A.24) for J(Xτ , Dτ , Fτ , τ ) into (A.23), we have
Vτ (X0 , D0 , F0 , 0) = J(X0 , D0 , F0 , 0)
 τ
!
s
Ft + + λ(X0 −Xt ) + Dt − JX + κJD µt dt
+ E0
2
0 τ

+ E0
Jt − ρDt JD + 12 σ 2 JF F + aσ 2 Xt2 dt
0
"
# !

s
∆J + Ft + + λ(X0 −Xt ) + Dt + xti /(2q) xti
+ E0
2
ti <t, ti ∈T̂

= J(X0 , D0 , F0 , 0) + I1 + I2 + I3

(A.25)

Now we are ready to show that for any arbitrary strategy Xt and for any moment τ it is
true that
Vτ (X0 , D0 , F0 , 0) ≥ J(X0 , D0 , F0 , 0).

(A.26)

It is clear that VI (A.15)-(A.17) implies non-negativity of I1 and I2 in (A.25). Moreover,
it implies that I3 ≥ 0. It is easy to be shown if you rewrite ∆J(Xti , Dti , Fti , ti ) as J(Xti −
xti , Dti + κxti , Fti + σZti , ti ) − J(Xti , Dti , Fti , ti ). This complete the proof of (A.26).
Use it for τ = 0 to see that J(X0 , D0 , F0 , 0) ≤ V (X0 , D0 , F0 , 0). Moreover there is an
equality if our candidate optimal strategy is used. This complete the proof of Proposition 3.
D. Properties of the Optimal Execution Policy
We now analyze the properties of optimal execution strategies. First, let us consider the risk
neutral trader with a = 0. Substituting the established expression for f (t) into (A.21), we
ﬁnd that the CT region is given by
Xt =

ρ(T −t)+1
Dt .
κ
34

This implies that after the initial trade x0 =

X0
ρT +2

which pushes the system from its initial

state X0 and D0 = 0 into CT region, the trader trades continuously at the rate µt =
staying in CT region and executes the rest xT =

X0
ρT +2

ρX0
ρT +2

at the end of trading horizon. In fact,

this is the same solution as we had for continuous time limit of solution of problem (20).
If the trader is risk averse then the CT region is given by
Xt = g(t)Dt ,

where

g(t) = −

f  (t) − ρf (t)
.
f  (t)κ + aσ 2


2

κf (0)+aσ
This implies that after discrete trade x0 = X0 ρκf
at the beginning which pushes the
(0)+aσ 2

system from its initial state into CT region, the trader will trade continuously at the rate
µt = κx0

 (s)+ρ
ρg(t) − g  (t) − Ê0t κg
ds
1+κg(s)
.
e
1 + κg(t)

This can be shown taking in account the dynamics of Dt given in (A.2) and speciﬁcation of
CT region. At the end the trader ﬁnishes the order. Q.E.D.

35

References
Admati, Anat R., and Paul C. Pﬂeiderer, 1988, A theory of intraday patterns: Volume and
price variability, Review of Financial Studies 1, 3-40.
Ahn, Hee-Joon, Kee-Hong Bae and Kalok Chan, 2001, Limit orders, depth, and volatility,
Journal of Finance, 56, 767–788.
Almgren, Robert, and Neil Chriss, 1999, Value under liquidation, Risk, 12.
Almgren, Robert, and Neil Chriss, 2000, Optimal execution of portfolio transactions, Journal of Risk, 3, 5–39.
Almgren, Robert, and Neil Chriss, 2003, Bidding principles, Risk, 16.
Almgren, Robert, 2003, Optimal execution with nonlinear impact functions and tradingenhanced risk, Applied Mathematical Finance 10, 1–18.
Back, Kerry, and Shmuel Baruch, 2004, Information in securities markets: Kyle meets
Glosten and Milgrom, Econometrica, 72, 433–465.
Bertsimas, Dimitris, and Andrew W. Lo, 1998, Optimal control of execution costs, Journal
of Financial Markets, 1, 1–50.
Biais, Bruno, Pierre Hillion, and Chester S. Spatt, 1995, An empirical analysis of the limit
order book and order ﬂow in Paris Bourse, Journal of Finance 50, 1655–1689.
Biais, Bruno, Christophe Bisiere, and Chester S. Spatt, 2003, Imperfect competition in
ﬁnancial markets, Carnegie Mellon Working Paper.
Bloomﬁeld, Robert, Maureen O’Hara, and Gideon Saar, 2004, The ”Make or Take” decision
in an electronic market: Evidence on the evolution of liquidity, Journal of Financial
Economics, forthcoming.
Brock, William A., and Allan W. Kleidon, 1992, Periodic market closure and trading volume: A model of intraday bids and asks, Journal of Economic Dynamics and Control,
16, 451–489.
Cao, Charles, Oliver Hansch and Xiaoxin Wang, 2003,The informational content of an open
limit order book, EFA 2004 Maastricht Meetings Paper No. 4311.
Chan, Kakeung, Wiliam Christie, and Paul Schultz, 1995, Market structure and the intraday
pattern of bid-ask spreads for Nasdaq securities, Journal of Business, 68(1), 35—60.
Chan, Louis K., and Josef Lakonishok, 1993, Institutional trades and intraday stock price
behavior, Journal of Financial Economics, 33, 173-199.
Chan, Louis K., and Josef Lakonishok, 1995, The behavior of stock prices around institutional trades, Journal of Finance, Vol.50, No.4, 1147–1174.
36

Chan, Louis K., and Josef Lakonishok, 1997, Institutional equity trading costs: NYSE
versus Nasdaq, Journal of Finance, Vol.52, No.2, 713–735.
Chung, Kee H., Bonny Van Ness, and Robert Van Ness, 1999, Limit orders and the bid-ask
spread, Journal of Financial Economics, Vol. 53, No 2, 255–287.
Coppejans, Mark T., Ian H. Domowitz, and Anath Madhavan, 2001, Liquidity in an automated auction, AFA 2002 Atlanta Meetings.
Dubil, Robert, 2002, Optimal liquidation of large security holdings in thin markets, Research in International Entrepreneurial Finance and Business Ventures at the Turn of
the Third Millennium, Editor: Yochanan Shachmurove, Academy of Entrepreneurial
Finance.
Easley, David, and Maureen O’Hara, 1992, Time and process of security price adjustment,
Journal of Finance, 47, 577–605.
Eastham, Jerome, and Kevin J. Hastings, 1988, Optimal impulse control of portfolios,
Mathematics of Operations Research, 13(4), 588–605.
Foster, Douglas, and S. Viswanathan, 1990, A theory of the interday variations in volume,
varience, and trading costs in securities markets, Review of Financial Studies, 3, 592–
624.
Foster, Douglas, and S. Viswanathan, 1995, Can speculative trading explain the volumevolatility relation?, Journal of Business and Economic Statistics, 13, 379–396.
Foucault, Thierry, 1999, Order ﬂow composition and trading costs in a dynamic limit order
market, Journal of Financial Markets, 2, 99–134.
Foucault, Thierry, Ohad Kadan, Eugene Kandel, 2001, Limit order book as a market for
liquidity, Review of Financial Studies, forthcoming.
Gerety, Mason, and Harold Mulherin, 1992, Trading halts and market activity: an analysis
of volume at the open and the close, Journal of Finance, 47, 1765–1784.
Glosten, Lawrence R., 1994, Is the electronic open limit order book inevitable?, Journal of
Finance, Vol.49, No.4, 1127–1161.
Goettler, Ron, Christine Parlour, Uday Rajan, 2004, Equilibrium in a dynamic limit order
market, Journal of Finance, forthcoming.
Greenwood, Robin, 2004, Short– and long–term demand curves for stock: theory and evidence on the dynamics of arbitrage, Journal of Financial Economics, forthcoming.
Griﬃths, Mark, Brian Smith, Alasdair Turnbull and Robert W. White, 2000, The Cost and
determinants of order aggressiveness, Journal of Financial Economics 56, 65–88.

37

Hamao, Yasushi, and Joel Hasbrouck, 1995, Securities trading in the absence of dealers:
Trades and quotes on the Tokyo Stock Exchange, The Review of Financial Studies,
Vol. 8, No. 3, 849–878.
Handa, Puneet, and Robert Schwartz, 1996, Limit order trading, Journal of Finance, 51,
1835–1861.
Harris, Lawrence, 1986, A transactions data study of weekly and intradaily patterns in
stock prices, Journal of Financial Economics, 16, 99–117.
Harris, Lawrence, 1990, Liquidity, trading rules and electronic trading systems, NYU Salomon Center Series in Finance and Economics, Monograph 1990–4.
Harris, Lawrence, 1998, Optimal dynamic order submission strategies in some stylized
trading problems, Financial Markets, Institutions and Instruments, 7, 1–76.
Harris, Lawrence, and Venkatesh Panchapagesan, 2005, The information-content of the
limit order book: Evidence from NYSE specialist trading decisions, Journal of Financial Markets, 8, forthcoming.
Hasbrouck, Joel, 1996, Order characteristics and stock price evolution: An application to
program trading, Journal of Financial Economics, 41(1), 129–149.
Hasbrouck, Joel, and Duane J. Seppi, 2001, Common factors in prices, order ﬂows, and
liquidity, Journal of Financial Economics, 59, 383–411.
Hasbrouck, Joel and Gideon Saar, 2002, Limit orders and volatility in a hybrid market: the
Island ECN, Working paper.
He, Hua, and Harry Mamaysky, 2001, Dynamic trading policies with price impact, Yale
ICF Working Paper No. 00–64.
Hindy, Ayman, Chi-fu Huang, and Steven Zhu, 1997, Optimal consumption and portfolio
rules with durability and habit formation, Journal of Economic Dynamics and Control
21.
Holliﬁeld, Burton, Robert A. Miller, and Patrik Sandas, 2004, Empirical analysis of limit
order markets, Review of Economic Studies, forthcoming.
Holthausen, Robert W., Richard W. Leftwich, and David Mayers, 1987, The eﬀect of large
block transactions on security prices: a cross-sectional analysis, Journal of Financial
Economics, 19, 237–267.
Holthausen, Robert W., Richard W. Leftwitch, and David Mayers, 1990, Large block transactions, the speed of response of temporary and permanent stock-price eﬀect, Review
of Financial Studies, 9, 71–95.
Hong, Harrison and Jiang Wang, Trading and returns under periodic market closures, 2000,
Journal of Finance, 55, 297–354.
38

Huang, Jennifer, and Jiang Wang, Market Liquidity and Asset Prices Under Costly Participation, 2005, MIT Working Paper.
Huberman, Gur, and Werner Stanzl, 2000, Optimal liquidity trading, EFA 2001 Barcelona
Meetings; Yale ICF Working Paper No. 00-21; Yale SOM Working Paper No. ICF 00–21.
Huberman, Gur, and Werner Stanzl, 2004, Arbitrage-free price update and price-impact
functions, Econometrica, 72, No 4, 1247–1275.
Irvine, Paul J., George J. Benston, and Eugene Kandel, 2000, Liquidity beyond the inside
spread: measuring and using information in the limit order book, Working Paper.
Jain, Prem, and Gun-Ho Joh, 1992, The dependence between hourly prices and trading
volume, Journal of Financial and Quantitative Analysis 23, 269–284.
Kaul, Aditya, Vikas Mehrotra, and Randall Morck, 2000, Demand curves for stocks do
slope down: new evidence from an index weights adjustment, Journal of Finance 55
(2), 893-912.
Keim, Donald B., and Ananth Madhavan, 1995, Anatomy of the trading process: Empirical
evidence on the behavior of institutional traders, Journal of Financial Economics 37,
371- 398.
Keim, Donald B. and Ananth Madhavan, 1996, The upstairs market for large-block transactions, Review of Financial Studies 9, 1–36.
Keim, Donald B., and Ananth Madhavan, 1997, Transactions costs and investment style:
An inter-exchange analysis of institutional equity trades, Journal of Financial Economics 46, 265-292.
Kleidon, Allan, and Ingrid Werner, 1996, UK and US trading of British cross-listed stocks:
An intraday analysis of market integration, Review of Financial Studies, 9, 619–664.
Koski, Jennifer, and Roni Michaely, 2000, Prices, liquidity, and the information content of
trades, Review of Financial Studies, 13, 659–696.
McInish, Thomas, and Robert Wood, 1991, Hourly returns, volume, trade size and number
of trades, Journal of Financial Research, 14(4), 303–315.
Monch, Burkart, 2004, Optimal liquidation strategies, Working Paper.
Parlour, Christine, 1998, Price dynamics in limit order markets, Review of Financial Studies, 11, 789–816.
Parlour, Christine, and Duane Seppi, 2003, Liquidity-based competition for order ﬂow,
Review of Financial Studies, 16, 301–303.

39

Perold, Andre, 1988, The implementation shortfall: Paper versus reality, Journal of Portfolio Management, 14, 4-9.
O’Hara, Maureen, 1995, Market microstructure theory, Blackwell Publishers, Cambridge,
Mass.
O’Hara, Maureen, 2003, Liquidity and price discovery, Journal of Finance, 58, 1335–1354.
Ranaldo, Angelo, 2004, Order aggressiveness in limit order book markets, Journal of Financial Markets, 7, 53–74.
Rock, Kevin, 1996, The specialists order book and price anomalies, Review of Financial
Studies.
Rosu, Ioanid, 2004, A dynamic model of the limit order book, MIT Ph.D. Thesis.
Sandas, Patrick, 2001, Adverse selection and competitive market making: evidence from a
pure limit order book, Review of Financial Studies, 14, 705–734.
Scholes, Myron, 1972, The market for securities: substitution versus price pressure and the
eﬀects of information on share price, Journal of Business, 45, 179–211.
Seppi, Duane, 1997, Liquidity provision with limit orders and a strategic specialist, Review
of Financial Studies, 10, 103–150.
Shleifer, Andrei, 1986, Do demand curves for stocks slope down?, Journal of Finance, 41,
579–590.
Shreve, Steven, and Halil Soner, 1994, Optimal investment and consumption with transaction costs, Annals of Applied Probability, No.4, 609–692.
Subramanian, Ajai, and Robert A. Jarrow, 2001, The liquidity discount, Mathematical
Finance, 11(4), 447–474.
Vayanos, Dimitri, 1999, Strategic Trading and Welfare in a Dynamic Market, Review of
Economic Studies, 66, 219–254.
Vayanos, Dimitri, 2001, Strategic Trading in a Dynamic Noisy Market, Journal of Finance,
56, 131–171.
Wurgler, Jeﬀrey, and Ekatherina Zhuravskaya, 2002, Does arbitrage ﬂatten demand curves
for stock?, Journal of Business, vol. 7, 583–608.

40

