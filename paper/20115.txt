NBER WORKING PAPER SERIES

ESTIMATION OF AFFINE TERM STRUCTURE MODELS WITH SPANNED OR
UNSPANNED STOCHASTIC VOLATILITY
Drew D. Creal
Jing Cynthia Wu
Working Paper 20115
http://www.nber.org/papers/w20115
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2014

We thank Yacine Ait-Sahalia, Boragan Aruoba, Michael Bauer, Alan Bester, John Cochrane, Frank
Diebold, Rob Engle, Jim Hamilton, Chris Hansen, Guido Kuersteiner, Ken Singleton, two anonymous
referees, and seminar and conference participants at Chicago Booth, NYU Stern, NBER Summer Institute,
Maryland, Bank of Canada, Kansas, UMass, and Chicago Booth Junior Finance Symposium for helpful
comments. Drew Creal thanks the William Ladany Faculty Scholar Fund at the University of Chicago
Booth School of Business for financial support. Cynthia Wu also gratefully acknowledges financial
support from the IBM Faculty Research Fund at the University of Chicago Booth School of Business.
This paper was formerly titled "Estimation of non-Gaussian affine term structure models." The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
¬© 2014 by Drew D. Creal and Jing Cynthia Wu. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including ¬© notice,
is given to the source.

Estimation of Affine Term Structure Models with Spanned or Unspanned Stochastic Volatility
Drew D. Creal and Jing Cynthia Wu
NBER Working Paper No. 20115
May 2014, Revised October 2014
JEL No. C13,E43,G12
ABSTRACT
We develop new procedures for maximum likelihood estimation of affine term structure models with
spanned or unspanned stochastic volatility. Our approach uses linear regression to reduce the dimension
of the numerical optimization problem yet it produces the same estimator as maximizing the likelihood.
It improves the numerical behavior of estimation by eliminating parameters from the objective function
that cause problems for conventional methods. We find that spanned models capture the cross-section
of yields well but not volatility while unspanned models fit volatility at the expense of fitting the crosssection.
Drew D. Creal
University of Chicago
Booth School of Business
5807 South Woodlawn Ave
Chicago, IL 60637
dcreal@chicagobooth.edu
Jing Cynthia Wu
University of Chicago
Booth School of Business
5807 South Woodlawn Avenue
Chicago, IL 60637
and NBER
cynthia.wu@chicagobooth.edu

1

Introduction

We propose new estimation procedures for affine term structure models (ATSMs) with
spanned or unspanned stochastic volatility that use linear regression to simplify and stabilize
estimation. For spanned models, our procedure recovers the maximum likelihood estimator
but only requires numerically optimizing over a lower dimensional parameter space. The
stability of our method makes it possible for us to study local maxima, explain why they
exist, and their economic implications. We show how our insights from spanned models can
be extended to estimate unspanned stochastic volatility (USV) models despite the fact that
for USV models the likelihood function is not known in closed-form. Estimating a range of
popular models, we find that models with spanned volatility fit the cross section of the yield
curve better, while those with unspanned volatility fit the volatility better.
ATSMs are popular among policy makers, practitioners, and academic researchers for
studying bond prices, monetary policy, and the macroeconomic determinants of discount
rates; for overviews, see Piazzesi(2010), Duffee(2012), GuÃàrkaynak and Wright(2012), and
Diebold and Rudebusch(2013). As the literature on ATSMs has developed over the last
decade, there is a consensus that estimation can be challenging; see, e.g. Duffee(2002), Ang
and Piazzesi(2003), Kim and Orphanides(2005), and Hamilton and Wu(2012). New procedures for Gaussian ATSMs have made them easier to estimate, further increasing their popularity; see, Joslin, Singleton, and Zhu(2011), Christensen, Diebold, and Rudebusch(2011),
Hamilton and Wu(2012), Adrian, Crump, and Moench(2012) and Diez de Los Rios(2013).
However, these procedures do not address models with stochastic volatility. Moreover, in
USV models as proposed by Collin-Dufresne and Goldstein(2002) and Collin-Dufresne, Goldstein, and Jones(2009), the likelihood function is not known in closed-form. Potential solutions to this problem are the closed-form expansions of the likelihood for continuous-time
models developed by Aƒ±Ãàt-Sahalia(2008) and Aƒ±Ãàt-Sahalia and Kimmel(2010) and the expectation maximization (EM) algorithm. Combining our approach with these could potentially
improve estimation; we demonstrate this for the EM algorithm explicitly.
2

Our main contribution are new procedures for estimating ATSMs with spanned or unspanned stochastic volatility. For models with spanned factors where volatility factors price
bonds, we propose to maximize a concentrated likelihood that when optimized gives exactly
the same estimator as maximizing the original likelihood function. However, it only requires numerically optimizing over a subset of the parameters. The concentrated likelihood
function is simple to construct from linear regressions. Using this approach, estimation of
spanned models only takes a fraction of a second to several minutes compared to hours when
optimizing the original likelihood.
For USV models where the volatility factors do not price bonds, the log-likelihood function is not known in closed-form adding another layer of difficulty. Nevertheless, we show
how the intuition behind the concentrated likelihood for spanned models can be extended to
estimate USV models using the EM algorithm of Dempster, Laird, and Rubin(1977). The
maximization step of the EM algorithm solves a similar problem as optimizing the likelihood function of a spanned Gaussian ATSM. Consequently, we can construct a concentrated
objective function for the EM algorithm using linear regressions just as we did for spanned
models.
Our method outperforms conventional approaches both in terms of stability of convergence and speed. A study for a 3-factor model with one spanned volatility factor shows that
our method guarantees convergence as long as it is locally identified, and it converges to
a number of local maxima repeatedly. Aside from being able to find the global maximum,
our method helps us to locate and understand the economic implications of different local
maxima. Conversely, the conventional method of directly maximizing the original likelihood
never converges fully to any of the local maxima, nor does it converge to the same point
twice in repeated trials even when it is initialized under the same local mode. This makes it
difficult for researchers to differentiate between points near a well-behaved local maximum
having the same economic meaning and locations corresponding to local maxima that are
economically different. The median time it takes for our new procedure is less than 2 minutes

3

for this model, whereas the conventional approach takes over 2 hours.
Using our method, we shed light on how local maxima with different economic implications are created in non-Gaussian spanned models. In Gaussian models, different rotations
of the factors (such as re-ordering of the factors) result in equivalent global maxima, with
identical economic implications. In non-Gaussian models with spanned factors, rotations
can have substantial economic impacts. The non-Gaussian state variables must be positive
and enter the conditional variance. This creates an asymmetry between the Gaussian and
non-Gaussian factors resulting in local maxima that are not economically equivalent.
Another contribution of this paper is to develop a family of discrete-time non-Gaussian
ATSMs that encompasses continuous-time models, including both spanned models as in
Duffie and Kan(1996), Duffee(2002), Cheridito, Filipovic, and Kimmel(2007), and Aƒ±ÃàtSahalia and Kimmel(2010) as well as USV models as proposed by Collin-Dufresne and Goldstein(2002). GourieÃÅroux, Monfort, and Polimenis(2002) proposed a one factor discrete-time
non-Gaussian model and Le, Singleton, and Dai(2010) generalized it to have multiple factors. Our model encompasses any admissible rotation of a multivariate discrete-time Cox,
Ingersoll, and Ross(1985) process, allowing the factors to be correlated. The model nests the
risk-neutral dynamics of other discrete-time ATSMs.1 In our model, the physical and risk
neutral dynamics follow the same stochastic process but with different parameters. The market prices of risk have the extended affine form of Cheridito, Filipovic, and Kimmel(2007),
which is different than Le, Singleton, and Dai(2010). Finally, we also provide the restrictions
needed to generate USV in discrete-time versions of the continuous-time models studied by
Collin-Dufresne, Goldstein, and Jones(2009) and Joslin(2010).
We apply our estimation method to a range of popular spanned and unspanned models
with three and four factors. Judging by the estimated likelihood, a model with three spanned
non-Gaussian factors has the highest likelihood followed by one of the USV models. Gaussian
and non-Gaussian models with spanned factors fit the cross-section of yields equally well.
1

In this paper, we do not consider the class of non-Gaussian ATSMs built from the non-central Wishart
process of GourieÃÅroux, Jasiak, and Sufana(2009).

4

However, spanned models do not capture the volatility well at any maturity, even for the
best fitting model. This is because the non-Gaussian state variables must simultaneously
fit the conditional mean and variance. Maximum likelihood places more weight on the first
moment. In order to guarantee unspanned volatility factors, USV models place restrictions
on the bond loadings. This causes USV models to sacrifice some cross-sectional fit; their
pricing errors are larger than spanned models. On the other hand, USV models fit the
dynamics of yield curve volatility well. The USV restrictions are not unique and we show
that the choice of which USV restrictions are imposed is not inconsequential.
This paper continues as follows. In Section 2, we specify a general class of discrete-time,
non-Gaussian affine term structure models. In Section 3, we describe our new approach
to estimation for both spanned and unspanned models. Section 4 describes the data and
parameter restrictions of the models. Section 5 studies a three factor spanned model in
depth. In Section 6, we study eight three and four factor spanned and unspanned models.
In Section 7, we discuss directions for future research and conclude.

2

Model

In this section, we describe a class of discrete-time ATSMs with stochastic volatility that
encompass both spanned models, as in Duffie and Kan(1996), Dai and Singleton(2000),
Cheridito, Filipovic, and Kimmel(2007); and unspanned models, as proposed by CollinDufresne and Goldstein(2002).

2.1

Bond prices

The model has a G √ó 1 vector of conditionally Gaussian state variables gt , whose volatilities
are captured by an H √ó 1 vector of positive state variables ht . Under the risk-neutral
measure Q, the Gaussian state variables follow a vector autoregression with conditional

5

heteroskedasticity

Q
0
ŒµQ
g,t+1 ‚àº N 0, Œ£g,t Œ£g,t ,

Q
Q
Q
Q
gt+1 = ¬µQ
g + Œ¶g gt + Œ¶gh ht + Œ£gh Œµh,t+1 + Œµg,t+1 ,

Œ£g,t Œ£0g,t

=

Œ£0,g Œ£00,g

+

H
X

(1)

Œ£i,g Œ£0i,g hit ,

i=1

ŒµQ
h,t+1

Q

= ht+1 ‚àí E (ht+1 |It )

where It captures agents‚Äô information set at time t.
The volatility factors ht are an affine transformation of the exact discrete-time equivalent
of a multivariate Cox, Ingersoll, and Ross(1985) process

ht+1 = ¬µh + Œ£h wt+1


Q
Q
wi,t+1 ‚àº Gamma ŒΩh,i
+ zi,t+1
,1 ,


Q
0 ‚àí1 Q
zi,t+1 ‚àº Poisson ei Œ£h Œ¶h Œ£h wt ,

(2)
i = 1, . . . , H

(3)

i = 1, . . . , H

(4)

where ei denotes the i-th column of the identity matrix IH . We discuss the admissibility
restrictions and interpretation of the parameters of the model in Section 2.2.
The price of a zero-coupon bond with maturity n at time t is the expected price of the
same asset at time t + 1 discounted by the short rate rt under the risk neutral measure


n‚àí1
Ptn = EQ
t exp (‚àírt ) Pt+1 .

The short rate is a linear function of the state vector

0
0
rt = Œ¥0 + Œ¥1,h
ht + Œ¥1,g
gt .

Given the dynamics of gt and ht under Q, bond prices are an exponentially affine function

6

of the state variables


Ptn = exp aÃÑn + bÃÑ0n,h ht + bÃÑ0n,g gt .

The loadings aÃÑn , bÃÑn,h and bÃÑn,g can be expressed recursively in matrix notation as
h
i0
1
Q
Q
aÃÑn = ‚àíŒ¥0 + aÃÑn‚àí1 + ¬µQ0
bÃÑ
+
¬µ
‚àí
Œ¶
¬µ
+
Œ£
ŒΩ
bÃÑn‚àí1,h + bÃÑ0n‚àí1,g Œ£0,g Œ£00,g bÃÑn‚àí1,g
h
h h
g n‚àí1,g
h h
2




‚àí1
‚àí10
+¬µ0h Œ¶Q0
IH ‚àí diag ŒπH ‚àí Œ£0h bÃÑn‚àí1,gh
Œ£0h bÃÑn‚àí1,gh
h Œ£h



(5)
‚àíŒΩhQ0 log ŒπH ‚àí Œ£0h bÃÑn‚àí1,gh + Œ£0h bÃÑn‚àí1,gh


1
Q0
bÃÑn,h = ‚àíŒ¥1,h + Œ¶Q0
IH ‚äó bÃÑ0n‚àí1,g Œ£g Œ£0g ŒπH ‚äó bÃÑn‚àí1,g
gh bÃÑn‚àí1,g + Œ¶h bÃÑn‚àí1,h +
2


‚àí1  0
‚àí10
0
‚àíŒ¶Q0
Œ£
I
‚àí
diag
Œπ
‚àí
Œ£
bÃÑ
Œ£h bÃÑn‚àí1,gh
(6)
H
H
h n‚àí1,gh
h
h
bÃÑn,g = ‚àíŒ¥1,g + Œ¶Q0
g bÃÑn‚àí1,g

(7)

with initial values aÃÑ1 = ‚àíŒ¥0 , bÃÑ1,g = ‚àíŒ¥1,g and bÃÑ1,h = ‚àíŒ¥1,h , see Appendix B for a derivation.
The matrix Œ£g Œ£0g is a GH √óGH block diagonal matrix with elements Œ£i,g Œ£0i,g for i = 1, . . . , H
and bÃÑn‚àí1,gh = Œ£0gh bÃÑn‚àí1,g + bÃÑn‚àí1,h . The loadings must satisfy the restriction that the i-th
component of Œ£0h bÃÑn‚àí1,gh < 1 for i = 1, . . . , H.
Bond yields ytn ‚â° ‚àí n1 log (Ptn ) are linear in the factors
ytn = an + b0n,h ht + b0n,g gt

(8)

with an = ‚àí n1 aÃÑn , bn,h = ‚àí n1 bÃÑn,h and bn,g = ‚àí n1 bÃÑn,g .
GourieÃÅroux and Jasiak(2006) built the univariate version of the non-Gaussian process
(2)-(4) and GourieÃÅroux, Monfort, and Polimenis(2002) used it to construct a one factor
ATSM. Le, Singleton, and Dai(2010) extended the process to allow for multiple factors;
their specification under Q is (2)-(4) but with ¬µh = 0 and Œ£h diagonal.

7

2.1.1

Unspanned stochastic volatility models

USV models (see Collin-Dufresne and Goldstein(2002)) impose restrictions on the parameters
under Q guaranteeing that the bond loadings for the volatility factors bn,h in (8) are zero for
all maturities. Yields consequently only depend on the Gaussian factors ytn = an + b0n,g gt .
The bond loadings (5)-(7) simplify to
1 0
0
aÃÑn = ‚àíŒ¥0 + aÃÑn‚àí1 + ¬µQ0
g bÃÑn‚àí1,g + bÃÑn‚àí1,g Œ£0,g Œ£0,g bÃÑn‚àí1,g
2
bÃÑn,g = ‚àíŒ¥1,g + Œ¶Q0
g bÃÑn‚àí1,g

(9)
(10)

which are the same as Gaussian ATSMs. Unlike Gaussian ATSMs, however, USV models
constrain some of the Q parameters (i.e. elements of Œ¶Q
g ) in order to set the non-Gaussian
loadings to zero. In Section 4.2.2, we provide conditions under which discrete-time ATSMs
exhibit USV as in Collin-Dufresne, Goldstein, and Jones(2009).

2.2

Physical dynamics

Analogous to the popular class of Gaussian ATSMs, we specify the dynamics of gt and ht
under P to have the same dynamics as under Q. The Gaussian state variables follow a vector
autoregression with conditional heteroskedasticity

gt+1 = ¬µg + Œ¶g gt + Œ¶gh ht + Œ£gh Œµh,t+1 + Œµg,t+1 ,
Œ£g,t Œ£0g,t

=

Œ£0,g Œ£00,g

+

H
X


Œµg,t+1 ‚àº N 0, Œ£g,t Œ£0g,t , (11)

Œ£i,g Œ£0i,g hit ,

i=1

Œµh,t+1 = ht+1 ‚àí E (ht+1 |It ) .

The Gaussian state variables are a function of the non-Gaussian state variables through both
the autoregressive term Œ¶gh ht and the covariance term Œ£gh Œµh,t+1 . The parameters controlling
the conditional mean are different under P and Q measures, while the scale parameters Œ£gh
and Œ£i,g for i = 0, . . . , H are the same.
8

The model for ht+1 under the physical measure P is

ht+1 = ¬µh + Œ£h wt+1

(12)

wi,t+1 ‚àº Gamma (ŒΩh,i + zi,t+1 , 1) ,

zi,t+1 ‚àº Poisson e0i Œ£‚àí1
Œ¶
Œ£
w
,
h
h
t
h

i = 1, . . . , H

(13)

i = 1, . . . , H

(14)

where ŒΩh = (ŒΩh,1 , . . . , ŒΩh,H ) are shape parameters, Œ¶h is a matrix controlling the autocorrelation of ht+1 , Œ£h is a scale matrix, and ¬µh is a vector determining the lower bound of ht+1 .
Sufficient conditions for non-negativity of ht are that elements of ¬µh , Œ£h , and Œ£‚àí1
h Œ¶h Œ£h are
non-negative. The discrete-time equivalent of the Feller condition ŒΩh,i > 1 ensures that the
process does not attain its lower bound. A similar set of restrictions must be satisfied under
Q. The scale parameters Œ£h are the same under both probability measures and so is the
parameter ¬µh . The latter restriction is required for no-arbitrage.
The conditional mean of the volatility factors ht+1 can be written in matrix form as

E (ht+1 |It ) = (IH ‚àí Œ¶h ) ¬µh + Œ£h ŒΩh + Œ¶h ht .

It is a linear function of its own lag ht , similar to a vector autoregression. The conditional
variance is also an affine function of ht
 0
‚àí1
0
V (ht+1 |It ) = Œ£h diag(ŒΩh ‚àí 2Œ£‚àí1
h Œ¶h ¬µh )Œ£h + Œ£h diag 2Œ£h Œ¶h ht Œ£h .

In Appendix A.2, we provide the transition density of ht+1 for any admissible rotation.
A nice property of the model (11)-(14) for the vector (h0t , gt0 )0 is that any admissible affine
transformation remains within the same family of distributions.
Proposition 1 Let gt and ht follow the process of (11)-(14) with parameters Œ∏. Consider

9

an admissible affine transformation of the form
Ô£´

Ô£∂

Ô£´

Ô£∂

Ô£´

Ô£∂Ô£´

Ô£∂

Ô£¨ hÃÉt Ô£∑ Ô£¨ ch Ô£∑ Ô£¨ Chh Chg Ô£∑ Ô£¨ ht Ô£∑
Ô£≠
Ô£∏=Ô£≠
Ô£∏+Ô£≠
Ô£∏Ô£≠
Ô£∏.
gÃÉt
cg
Cgh Cgg
gt
The new process gÃÉt and hÃÉt remains in the same family of distributions under updated parameters Œ∏ÃÉ. The parameters ŒΩh and Œ£‚àí1
h Œ¶h Œ£h are invariant to rotation.
Proof: See Appendix C.1.
The admissibility restrictions and the relationship between the new and old parameterizations can be found in Appendix C.1. This proposition helps to understand identification
in Section 4.2.1. The admissibility constraints ensure that the non-Gaussian state variables
0

always remain positive after applying a transformation from (h0t , gt0 )0 to hÃÉ0t , hÃÉ0t and that
there exists another admissible rotation to get back to the original factors.

2.3

Stochastic discount factor

In this section, we demonstrate how an agent gets compensated for risk exposure when
holding a zero-coupon bond under stochastic volatility. Given the dynamics of the state
vector under P and Q measures, the market prices of risk have the extended affine form of
Cheridito, Filipovic, and Kimmel(2007). The full expression is in Appendix D. To provide
intuition, the log of the stochastic discount factor (SDF) can be decomposed up to a first order
approximation into the risk free rate plus three components describing risk compensation
1
mt+1 = ‚àírt ‚àí Œª0gt Œªgt ‚àí Œª0gt g,t+1 ‚àí Œª0wt w,t+1 ‚àí Œª0zt z,t+1
2

(15)

where i,t+1 are standardized shocks with mean zero and identity covariance matrix, and Œªit
is the price of risk i for each of the three types of shocks in the model.2 In addition to the
risk-free rt , the agent gets compensated for being exposed to the Gaussian shock g,t+1 in
2

This approximation is not used during estimation.

10

(11), the gamma shock w,t+1 in (13), and the Poisson shock z,t+1 in (14). The prices of
these risks are defined as



Œªgt = V(gt+1 |It , ht+1 , zt+1 )‚àí1/2 E (gt+1 |It , ht+1 , zt+1 ) ‚àí EQ (gt+1 |It , ht+1 , zt+1 )


Œªwt = V(wt+1 |It , zt+1 )‚àí1/2 E(wt+1 |It , zt+1 ) ‚àí EQ (wt+1 |It , zt+1 ) ,


Œªzt = V(zt+1 |It )‚àí1/2 E(zt+1 |It ) ‚àí EQ (zt |It ) .

The market prices of risk have an intuitive form as the Sharpe ratio measuring per unit
risk compensation. Specifically, they are the difference in the conditional means of each
shock under P and Q standardized by a conditional standard deviation. The time-varying
quantities of risk are a feature of non-Gaussian models that are not available in Gaussian
models.

USV models In USV models, the components of the SDF associated with the Gaussian
factors (the first three terms in (15)) are the only parts that are directly observable from
bond yields. The risk premium for non-Gaussian factors can only be estimated jointly by
also observing derivatives because the Q parameters of the volatility process do not enter
the likelihood and are unidentified by observing only yields.

2.4

State space representation

Define xt as the vector of spanned factors; i.e., xt = (gt0 , h0t )0 in spanned models and xt = gt in
USV models. Stacking ytn in order for N different maturities n1 , n2 , ..., nN gives Yt = A+Bxt
where A = (an1 , . . . , anN )0 , B = (b0n1 , ..., b0nN )0 . If more yields are observed than the number of
spanned factors (N > N1 ), not all yields can be priced exactly. Following the literature, we
(1)

= SY1 Yt are priced without error and

(2)

= SY2 Yt are observed with Gaussian

assume that N1 linear combinations of the yields Yt

the remaining N2 = N ‚àí N1 linear combinations Yt

11

measurement errors. Given this assumption, the observation equations are
(1)

=

A1 + B1 xt

(2)

=

A2 + B2 xt + Œ∑t

Yt
Yt

(16)
Œ∑t ‚àº N (0, ‚Ñ¶)

(17)

where A1 ‚â° SY1 A, A2 ‚â° SY2 A, B1 ‚â° SY1 B, and B2 ‚â° SY2 B. The state space representation
of the model is completed using the dynamics of the state variables (11)-(14).

3

Estimation methodology

In this section, we introduce new estimation procedures for spanned and unspanned models,
both of which use least square regressions to simplify and stabilize estimation. Our approach
is based on the following observations: (i) The parameter vector Œ∏ can be separated into those
parameters that enter the bond loadings and those that do not (e.g. ¬µg , Œ¶g , Œ¶gh ); (ii) Given
the parameters that enter the loadings, we can calculate the bond loadings and solve for the


(1)
spanned factors xt = B1‚àí1 Yt ‚àí A1 using (16); (iii) The P parameters (e.g. ¬µg , Œ¶g , Œ¶gh )
of the Gaussian VAR for the factors gt plus ‚Ñ¶ enter the objective function as a quadratic
form. The first order conditions for these parameters (¬µg , Œ¶g , Œ¶gh , ‚Ñ¶) are linear and can be
solved by running (generalized) least squares regressions of (11). Using this basic insight,
we show how to eliminate these parameters from the numerical optimization problem.

3.1

Spanned models

Given the parameters of the model Œ∏, the likelihood function is

p (Y1:T ; Œ∏) = p



(2)
(1)
Y1:T |Y1:T ; Œ∏

 

(1)
p Y1:T ; Œ∏

T
T
T Y
H


Y
Y
Y
(2)
(1)
‚àíT
=
p Yt |Yt ; Œ∏ |J (Œ∏)|
p (gt |ht , It‚àí1 ; Œ∏)
p (hit |It‚àí1 ; Œ∏) (18)
t=1

t=1

12

t=1 i=1

(1)

where J (Œ∏) is the Jacobian of the transformation from xt = (gt0 , h0t )0 to Yt , see Appendix
E for the log-likelihood ` (Œ∏) = log p (Y1:T ; Œ∏).3 Direct maximization of the log-likelihood is
however extremely challenging as interest rates are close to non-stationary, the bond loadings
are non-linear functions of the models‚Äô parameters, and the maximization must impose the
condition that ht > 0.
Our approach to spanned models is a result of the following proposition:
Proposition 2 If the model is given by equations (11)-(14) and (16)-(17) with all spanned
factors, then the maximum likelihood estimator Œ∏ÃÇ = argmax ` (Œ∏) can be solved by maximizing
Œ∏


the concentrated likelihood max ` Œ∏ÃÇc (Œ∏m ) , Œ∏m , where Œ∏c = (¬µg , Œ¶g , Œ¶gh , ‚Ñ¶) and Œ∏m are the
Œ∏m

remaining parameters of the model. The function Œ∏ÃÇc (Œ∏m ) is obtained by solving max ` (Œ∏m , Œ∏c )
Œ∏c

using the GLS estimates for the P dynamics (11) and the OLS estimates for the variancecovariance matrix ‚Ñ¶ in (17).
Proof: See Appendix F.1.
The proposition raises two points. First, optimizing the concentrated likelihood gives
exactly the same solution as maximizing the original likelihood function in (18). However,
it only requires numerically optimizing over Œ∏m instead of both Œ∏m and Œ∏c . Second, the
concentrated likelihood function can be constructed from linear regressions. The method we
propose is an immediate result of Proposition 2.


Procedure 1 Maximize the concentrated log-likelihood function max ` Œ∏ÃÇc (Œ∏m ) , Œ∏m . For
Œ∏m

a given value of Œ∏m , the concentrated likelihood can be constructed as follows:
(i.) Given Œ∏m , calculate the bond loadings A and B and the state variables gt and ht from


(1)
xt = B1‚àí1 Yt ‚àí A1 .
3

The stationary distribution is only known for special sub-classes of the affine family of models. In this
paper, we assume a diffuse initial condition and start from t = 2. This provides an analytical solution for
the first order conditions of the likelihood. If a researcher wants to include the stationary distribution as
the initial condition, we recommend using our procedure first, and then using these estimates as starting
values to optimize the likelihood with the initial condition. While including the initial conditions enforces
stationarity, it can also introduce a downward bias in estimates of the autoregressive parameters; see, e.g.
Bauer, Rudebusch, and Wu(2012).

13

(ii.) Given gt and ht , calculate Œµh,t+1 and Œ£g,t . Run a GLS regression

gt+1 ‚àí Œ£gh Œµh,t+1 = ¬µg + Œ¶g gt + Œ¶gh ht + Œ£g,t Œµg,t+1

(19)

to calculate ¬µÃÇg (Œ∏m ) , Œ¶ÃÇg (Œ∏m ) , Œ¶ÃÇgh (Œ∏m ).
(iii.) Calculate the covariance matrix
T


0
1 X  (2)
(2)
‚Ñ¶ÃÇ (Œ∏m ) =
Yt ‚àí A2 ‚àí B2 xt Yt ‚àí A2 ‚àí B2 xt
T ‚àí 1 t=2


(20)



(iv.) Substitute Œ∏ÃÇc (Œ∏m ) = ¬µÃÇg (Œ∏m ) , Œ¶ÃÇg (Œ∏m ) , Œ¶ÃÇgh (Œ∏m ) , ‚Ñ¶ÃÇ (Œ∏m ) back into the original likelihood to form the concentrated likelihood.

In Appendix F, we also derive the analytical gradients of the concentrated log-likelihood.
Our derivation is based on the following proposition. It decomposes the gradient into pieces
according to whether a parameter enters the bond loadings, the P dynamics, or both.




Proposition 3 The gradient of the concentrated log-likelihood ` Œ∏ÃÇc (Œ∏m ) , Œ∏m can be decomposed into three terms:





d` Œ∏ÃÇc (Œ∏m ) , Œ∏m , A (Œ∏m ) , B (Œ∏m )
0
dŒ∏m

‚àÇ` Œ∏ÃÇc , Œ∏m , A, B

=







‚àÇ` Œ∏ÃÇc , Œ∏m , A, B ‚àÇA (Œ∏ )
m
+
0
0
0
‚àÇŒ∏
‚àÇA
‚àÇŒ∏m
 m


‚àÇ` Œ∏ÃÇc , Œ∏m , A, B ‚àÇvec B (Œ∏m )0
+
.
0
‚àÇŒ∏m
‚àÇvec (B 0 )0

The first term is the partial derivative of the P dynamics and Jacobian with respect to Œ∏m .
This measures the effect parameters have on the log-likelihood through the time series of the
factors. The second and third terms measure the effect parameters have on the log-likelihood
through the bond loadings A and B.
Proof: See Appendix F.2
14

The expressions for the gradient can be used for other affine models such as models for
defaultable bonds and credit default swaps.

3.2

Unspanned models

In a USV model, the pricing equation (16) can be inverted to calculate the Gaussian factors
gt conditional on the parameters that enter the bond loadings. However, the volatility
factors ht cannot be observed by inverting the pricing formula. The likelihood of the model

 

(2)
(1)
(1)
p (Y1:T ; Œ∏) = p Y1:T |Y1:T ; Œ∏ p Y1:T ; Œ∏ is no longer known in closed-form. The first term




(2)
(1)
(1)
p Y1:T |Y1:T ; Œ∏ remains the same as in (18). The second term p Y1:T ; Œ∏ is associated with
the P dynamics of the factors and is an integral over the path of the latent volatility

p



(1)
Y1:T ; Œ∏



‚àíT

= |J (Œ∏)|

Z

Z
...

p (g1:T |h0:T ‚àí1 ; Œ∏) p (h0:T ‚àí1 ; Œ∏) dh0 . . . dhT ‚àí1
(1)

where J (Œ∏) is the Jacobian from gt to Yt . This integral does not have a closed-form
solution. We use the Monte Carlo Expectation Maximization (MCEM) algorithm to estimate
the model, see Wei and Tanner(1990).
The EM algorithm consists of two steps: the expectation and maximization steps, which
are iterated back and forth until convergence of the algorithm to a stationary point of the
likelihood. The first step calculates the expected value of the complete data log-likelihood
"
Q Œ∏|Œ∏

(i)



= E
+

T
X

T


X
(2)
log p Yt |gt ; Œ∏ ‚àí T log |J (Œ∏)| +
log p (gt |gt‚àí1 , ht‚àí1 ; Œ∏)
t=1

t=1
T
‚àí1
X

#

log p (ht |ht‚àí1 ; Œ∏) + p (h0 ; Œ∏) .

(21)

t=1


This expectation is taken with respect to the posterior distribution p h0:T ‚àí1 |Y1:T ; Œ∏(i) , which

depends on the parameters Œ∏(i) from the previous iteration. The function Q Œ∏|Œ∏(i) is known
as the intermediate quantity of the EM algorithm and it is a function of Œ∏. In the second

step of the EM algorithm, the intermediate quantity is maximized Œ∏(i+1) = argmax Q Œ∏|Œ∏(i)
Œ∏

15

to determine the parameters for the next iteration.
For USV models, the intermediate quantity has the same form as the log-likelihood
for spanned Gaussian models. This means that maximization of the intermediate quantity
at each iteration of the EM algorithm is (essentially) equivalent to estimating a Gaussian
ATSM. This is why we can construct a concentrated version of the intermediate quantity
from the output of linear regressions. For USV models, we separate the parameters into
three groups: Œ∏c = (¬µg , Œ¶g , ‚Ñ¶) are the parameters that can be concentrated out, Œ∏m,h =
(ŒΩh , Œ¶h , Œ£h ) are the parameters that govern the dynamics of the volatility, and Œ∏m,b are
the parameters that enter the bond loadings. We only need to optimize numerically over
Œ∏m,h and Œ∏m,b , as the parameters in Œ∏c can be determined analytically as a function of Œ∏m,b .

Moreover, the intermediate quantity can be additively separated into two pieces Q Œ∏|Œ∏(i) =


Q1 Œ∏m,b , Œ∏c |Œ∏(i) + Q2 Œ∏m,h |Œ∏(i) . The first component corresponds to the first three terms in
(21), and depends only on the parameters Œ∏m,b and Œ∏c . The remaining terms in (21) are the

second component Q2 Œ∏m,h |Œ∏(i) , which depend only on the volatility parameters Œ∏m,h .
Our procedure can be implemented as follows:
Procedure 2 The maximum likelihood estimator for USV models can be obtained by iterating over the following two steps:

(a.) E-step: compute the expectations in the intermediate quantity Q Œ∏|Œ∏(i) from (21).

(b.) M-step: maximize Q Œ∏|Œ∏(i) over Œ∏ to determine Œ∏(i+1) . This can be separated into two
sub-steps.

(i+1)
(b1.) Maximize Q1 Œ∏m,b , Œ∏c |Œ∏(i) with respect to Œ∏m,b and Œ∏c to determine Œ∏m,b and


(i+1)
Œ∏c . This can be solved equivalently by maximizing Q1 Œ∏m,b , Œ∏ÃÇc (Œ∏m,b )|Œ∏(i) with
respect to Œ∏m,b , where the concentrated objective function can be constructed as
follows:
(i.) Given Œ∏m,b , calculate the bond loadings A and B and the state variables gt


(1)
from xt = B1‚àí1 Yt ‚àí A1 .
16

(ii.) Given gt , run a GLS regression
1

gt+1 = ¬µg + Œ¶g gt + SÃÑt2 Œµg,t+1

(22)

to calculate ¬µÃÇg (Œ∏m,b ) , Œ¶ÃÇg (Œ∏m,b ).
(iii.) Calculate the covariance matrix ‚Ñ¶ÃÇ (Œ∏m,b ) as in (20).


(iv.) Substitute Œ∏ÃÇc (Œ∏m,b ) = ¬µÃÇg (Œ∏m,b ) , Œ¶ÃÇg (Œ∏m,b ) , ‚Ñ¶ÃÇ (Œ∏m,b ) back into the intermediate quantity.

(i+1)
(b2.) Maximize Q2 Œ∏m,h |Œ∏(i) with respect to Œ∏m,h to determine Œ∏m,h .
Appendix H contains details of our implementation. This procedure for USV models has
many similarities with our earlier procedure for spanned models.4 The difference between
the GLS regression in (19) of Procedure 1 and the regression in (22) of Procedure 2 is
their covariance matrices. The EM algorithm imputes the latent values of ht by taking
their expectations. Finally, we note that with only a few minor modifications, the analytical
gradients for the likelihood of the spanned model from Proposition 3 can be used to calculate
the gradients of the intermediate quantity in (21).
In our experience, it takes only a few iterations of the EM algorithm to approach the
maximum when estimating the USV models of Section 4.2.2. The rate of convergence of the
EM algorithm near the maximum is known to be slow. Once the EM algorithm approaches
the maximum, a researcher can switch to alternative estimation procedures for non-Gaussian
state space models.5
For USV models, the expectation in Step 1 cannot be calculated in closed-form, requiring
a Monte Carlo version of the EM algorithm. We calculate the expectations using sequential
4
There are several versions of the EM algorithm all of which lead to the MLE; see Meng and Rubin(1993).
These authors discuss issues such as concentrating the intermediate quantity as well as sequentially maximizing the intermediate quantity over subsets of Œ∏.
5
USV models are an example of a non-linear, non-Gaussian state space model. General approaches for
estimating non-Gaussian state space models include importance sampling (Durbin and Koopman(2012) and
Richard and Zhang(2007)), particle filters (see Malik and Pitt(2011)), and MCMC (see Jacquier, Johannes,
and Polson(2007)).

17

Monte Carlo methods or particle filters; see Creal(2012) for a survey. In particular, we use
the particle filtering algorithm of Godsill, Doucet, and West(2004) to draw paths of h0:T ‚àí1
from the joint posterior distribution p (h0:T ‚àí1 |Y1:T ; Œ∏); see Appendix H.2 for details. The
particle filter also allows us to calculate filtered (one-sided) estimates of the volatility as well
as an estimate of the likelihood function p (Y1:T ; Œ∏).

3.3

Discussion

We discuss how our approach can be applied to a wide range of ATSMs.
Example #1: observable macroeconomic variables
Our approach can estimate models with observable macroeconomic variables and with
homoskedastic or heteroskedastic shocks; examples with homoskedasticity are Ang and Piazzesi(2003) and Hamilton and Wu(2012). Our procedure works the same as before except
the state vector xt now contains the yield factors as well as the observed macroeconomic
factors. For step (i.) of Procedure 1 or 2, we back out the latent component of xt conditional
(1)

on a subset of the parameters, the yields Yt , and the macro variables. Given xt , we can
concentrate a large number of parameters out of the objective function including many of
the parameters introduced by adding the macroeconomic variables.
Example #2: Hidden factors
Recently, Duffee(2011) argued that more than three factors are needed to explain the
time-series dynamics of yields and risk premia, where these additional factors are ‚Äúhidden‚Äù
from the cross-section of yields because the factors are not priced. For simplicity, we illustrate
the basic ideas here for Gaussian models. Extensions to spanned or unspanned non-Gaussian
models are straightforward.
0
0
The Gaussian state vector can be separated into sub-vectors gt = g1,t
, g2,t

18

0

whose di-

mensions are G1 √ó 1 and G2 √ó 1, respectively. The dynamics under the P measure are

g1,t+1 = ¬µg,1 + Œ¶g,11 g1t + Œ¶g,12 g2t + Œµ1,t+1

Œµ1,t+1 ‚àº N 0, Œ£0,g Œ£00,g

g2,t+1 = ¬µg,2 + Œ¶g,21 g1t + Œ¶g,22 g2t + Œµ2,t+1

Œµ2,t+1 ‚àº N (0, IG2 )



(23)
(24)

The dynamics of g1,t are the same under the Q measure but with the restrictions that
Œ¶Q
g,12 = 0 and the last G2 entries of Œ¥1g are zero. These restrictions imply that only g1,t
directly impacts yields as the bond loadings on g2,t are zero by construction.
Given the parameters that enter the bond loadings, the factors that price bonds are


(1)
conditionally observable g1,t = B1‚àí1 Yt ‚àí A1 just as in step (i.) of Procedure 1. We
can treat g1,t as the observed data and (23) is the new observation equation for a linear,
Gaussian state space model. The remaining state variables g2t have transition equation
(24) and are serially correlated shocks to the factors g1t that price bonds. We can use the
Kalman filter to estimate this model, which is equivalent to a GLS regression where the
errors are serially correlated. To concentrate the parameters (¬µg,1 , ¬µg,2 , Œ¶g,11 , Œ¶g,21 ) out of
the likelihood as in step (ii) of Procedure 1, we can either place these parameters in the state
vector or use the augmented Kalman filter of de Jong(1991), see also Chapter 5 of Durbin
and Koopman(2012).
Example #3: parameter constraints
In our approach, a researcher can impose constraints ‚Äì such as in Ang and Piazzesi(2003),
Kim and Wright(2005), Cochrane and Piazzesi(2008) and Bauer(2014) ‚Äì and still concentrate
out parameters by linear regression. We denote the penalized or constrained log-likelihood
function `p (Œ∏) as

`p (Œ∏)

= log p (Y1:T ; Œ∏) + p(Œ∏),

where p(Œ∏) is the penalty term. If the constraints are only on the Q parameters, a researcher
19

can directly apply our Procedures 1 and 2. If the goal is to constrain either the P parameters or the relationship between the P and Q parameters, the penalty term is a vector of
Lagrange multipliers times the constraints. Step (ii.) of Procedure 1 or 2 can be replaced
by constrained GLS. If the constraints are linear in ¬µg , Œ¶g , Œ¶gh , there is a unique solution.
Popular restrictions in the literature are all in this category. If the penalty term p(Œ∏) is a
quadratic function of ¬µg , Œ¶g , Œ¶gh , step (ii.) of Procedures 1 or 2 reduces to ridge regression
and the parameters can be shrunk to a pre-specified value similar to a Bayesian VAR. A
researcher may want to shrink the P parameters toward the Q parameters, which are often
measured more precisely.
Example #4: serially correlated measurement errors
Although often assumed to be i.i.d. normal in the literature, several authors have found
the measurement errors Œ∑t in (17) to be serially correlated; see, e.g. Hamilton and Wu(2014).
Procedures 1 and 2 can be extended to cover models with serially correlated errors without increasing the dimension of the numerical optimization. For example, if Œ∑t has VAR(1) dynamics Œ∑t = Œ¶Œ∑ Œ∑t‚àí1 + Œ∫t with Œ∫t ‚àº N (0, ‚Ñ¶), then we can concentrate out Œ∏c = (¬µg , Œ¶g , Œ¶gh , ‚Ñ¶, Œ¶Œ∑ )
by least squares. Conditional on Œ∏m , we calculate the bond loadings A and B and factors xt
and, from these, the values of Œ∑t and Œ∑t‚àí1 which are implicitly a function of Œ∏m . To concentrate Œ¶Œ∑ and ‚Ñ¶ out of the objective function, we compute their least squares estimates from
the regression Œ∑t = Œ¶Œ∑ Œ∑t‚àí1 + Œ∫t and plug these values back into the log-likelihood.
Relation to Joslin, Singleton, and Zhu(2011) and Hamilton and Wu(2012)
Both Joslin, Singleton, and Zhu(2011) and Hamilton and Wu(2012) use linear regression
to estimate some parameters of Gaussian models.6 In the special case of Gaussian models
with observable factors (A1 = 0 and B1 = I), our method is identical to the ML estimator
of Joslin, Singleton, and Zhu(2011). Like the procedure in this paper, the approach of
6
The work by Adrian, Crump, and Moench(2012) and Diez de Los Rios(2013) are also similar in spirit
to these methods. They focus only on Gaussian models. Our discussion here applies to these papers as well.

20

Hamilton and Wu(2012) works for a wider range of Gaussian models. Their minimum chisquare estimator is asymptotically equivalent to the ML estimator in this paper.
The critical difference is that our procedures are designed for non-Gaussian models.
Leveraging the analytical solution for linear regressions has not been explored in this area.
For spanned models with both Gaussian and non-Gaussian factors, being able to rotate the
factors is important. If a researcher takes an arbitrary basis of yields (such as principal
components) and assumes that they can be separated a priori into observable Gaussian and
non-Gaussian factors, it will restrict the likelihood. Our approach lets the data decide what
linear combination of yields are the factors.

4
4.1

Data and parameter restrictions
Data

We use the Fama and Bliss(1987) zero coupon bond data available from the Center for
Research in Securities Prices (CRSP). The data is monthly and spans from June 1952 through
June 2012 for a total of T = 721 observations with maturities of (1, 3, 12, 24, 36, 48, 60)
(1)

months. For three factor models, the yields measured without error Yt
(1)

12, 60) month maturities. In models with four spanned factors, Yt

include the (1,

are the (1, 12, 24, 60)

month maturities.

4.2
4.2.1

Parameter restrictions
Identifying restrictions for spanned models

We impose the following restrictions for identification. For the Gaussian part, these are: (i)
Q
7
¬µQ
g = 0; (ii) Œ¶g in ordered Jordan form; (iii) Œ¥1g = Œπ is a column vector of ones; and (iv)

Œ£i,g is lower triangular. For the non-Gaussian part, (i) ¬µh = 0. (ii) Œ¶Q
gh = 0. (iii) Elements
7
For the case where Œ¶Q
g has real distinct eigenvalues, it is a diagonal matrix with diagonal elements in
descending order.

21

of the vector Œ¥1h = ¬±1 can take either sign8 , which unlike Gaussian-only models will lead to
inequivalent maxima as we explain in Section 5.2; (iv) Œ£h is diagonal.
To guarantee non-negativity and admissibility of the factors, we also impose the discreteQ
time equivalent of the Feller condition ŒΩh,i > 1 and ŒΩh,i
> 1 for i = 1, . . . , H. The matrices
‚àí1 Q
Œ£h , Œ£‚àí1
h Œ¶h Œ£h and Œ£h Œ¶h Œ£h must also be non-negative.

4.2.2

USV restrictions

We focus on discrete-time USV models similar to the continuous-time models presented
in Collin-Dufresne, Goldstein, and Jones(2009) and Joslin(2010).9 We label these models
U1 (4) because they have one unspanned volatility factor and three Gaussian factors. USV
restrictions are not unique. We present several models whose restrictions under Q result in
non-Gaussian loadings where bn,h = 0 for all maturities.
The first model, labeled U1 (4)(œÜ, œÜ2 , œà), has the following set of restrictions: (1) Œ¥1,h =
2
0 and Œ£gh = 0. (2) Œ¶Q
g is a diagonal matrix with eigenvalues œÜ, œÜ , œà. (3) All entries
Q
of Œ£1,g Œ£01,g are zero but the (1, 1) element. This entry is Œ£21,g,11 . (4) Œ¶Q
gh,3 = 0; Œ¶gh,1 =
2
(1‚àíœÜ2 )Œ¥1,g,1
Œ¥1,g,1 2
Œ£
; Œ¶Q
Œ£21,g,11 . In this model, only the Gaussian factor associated
gh,2 = ‚àí 2(1‚àíœÜ)2 Œ¥
(1‚àíœÜ) 1,g,11
1,g,2

with the eigenvalue œÜ has stochastic volatility as the remaining entries of Œ£1,g Œ£01,g are zero
for all the other Gaussian factors. The USV restrictions force two of the eigenvalues of Œ¶Q
g to
be related as œÜ and œÜ2 . These restrictions summarize three different USV models depending
on the relative size of œÜ and œà. We label the models U1 (4)(œÜ > œÜ2 > œà), U1 (4)(œÜ > œà > œÜ2 ),
U1 (4)(œà > œÜ > œÜ2 ). Each one of them is identified after imposing an ordering on the
eigenvalues.10
8
In theory, Œ¥1h = 0 is also admissible and creates additional local maxima. We would like to thank an
anonymous referee for pointing this out. Unlike a Gaussian model, the Jensen‚Äôs inequality term prevents
bn,h from being zero for maturities n ‚â• 2 even when Œ¥1h = 0. In practice, this model is not well identified, as
the factor loadings coming from the Jensen‚Äôs inequality term are extremely small and close to 0. We found
that the likelihood values under this restriction are significantly smaller in such models.
9
Papers that document the potential existence of USV factors include Heidari and Wu(2003), Li and
Zhao(2006), Trolle and Schwartz(2009), and Andersen and Benzoni(2010).
10
We do not consider the case where the eigenvalues may be identical and we restrict our attention to
eigenvalues that are less than one.

22

A second model, labeled U1 (4)(œÜ, œÜ2 , œÜ4 ), allows two out of the three Gaussian factors to
share a common stochastic volatility factor. The restrictions for this model are (1) Œ¥1,h = 0
2
4
and Œ£gh = 0. (2) Œ¶Q
g is a diagonal matrix with eigenvalues œÜ, œÜ , œÜ . (3) All entries of

Œ£1,g Œ£01,g are zero but the (1, 1) and (2, 2) elements. These entries are Œ£21,g,11 and Œ£21,g,22 .
2
2
(1‚àíœÜ2 )Œ¥1,g,1
(1‚àíœÜ4 )Œ¥1,g,2
Œ¥1,g,1 2
Œ¥1,g,2
Q
2
(4) Œ¶Q
Œ£21,g,22 .
Œ£21,g,11 ; Œ¶Q
gh,1 = 1‚àíœÜ Œ£1,g,11 ; Œ¶gh,2 = (1‚àíœÜ2 ) Œ£1,g,22 ‚àí 2(1‚àíœÜ)2 Œ¥
gh,3 = ‚àí 2(1‚àíœÜ2 )2 Œ¥
1,g,2

In this model, two diagonal entries in the covariance matrix

1,g,3

Œ£1,g Œ£01,g

are non-zero. The

additional flexibility in Œ£1,g Œ£01,g comes at the expense of another restriction on the diagonal
2
4
components of Œ¶Q
g . This model is unique because œÜ > œÜ > œÜ .

These restrictions lead to the following proposition
Proposition 4 If the model has risk neutral dynamics (1)-(4) and satisfies the restrictions
of U1 (4)(œÜ, œÜ2 , œà) or U1 (4)(œÜ, œÜ2 , œÜ4 ), then the model exhibits USV where bn,h = 0 ‚àÄ n.
Proof: see Appendix G.
Intuitively, USV models free up the volatility factors to fit the heteroskedasticity of yields
because they still enter the covariance matrix of the Gaussian factors in their P dynamics. The cost of adding USV factors comes from the constraints they place on Œ¶Q
g . These
constraints can sacrifice the cross-sectional fit of the model.
We impose the identifying restrictions of Section 4.2.1 for the Gaussian factors. For the
non-Gaussian portion of the model, we need an additional restriction on the scale parameters
Œ£1,g or Œ£h , as they enter the likelihood in the same way. We set Œ£h = 0.01.

5

A three factor model

In this section, we use a three factor model with one spanned volatility factor A1 (3) (in
the Dai and Singleton(2000) notation) to demonstrate the performance of our method and
to discuss the local maxima that arise in spanned non-Gaussian models. This model has
been the preferred model by many researchers in the literature.11 For an A1 (3) model, the
11

This model has been widely considered as the benchmark non-Gaussian ATSM, see Dai and Singleton(2000), Cheridito, Filipovic, and Kimmel(2007), Collin-Dufresne, Goldstein, and Jones(2008), and Aƒ±Ãàt-

23

concentrated likelihood drops the number of parameters by one-third from 24 parameters to
16 parameters.

5.1

Performance comparison

To illustrate the mileage we gain from using our method, we compare our approach to the
conventional method that does not concentrate out (¬µg , Œ¶g , Œ¶gh ) or use analytical gradients.
We perform an experiment where we estimate the A1 (3) model on the CRSP dataset 100
times from 100 different starting values using both methods.12 We compare our method and
the direct approach along two dimensions: convergence and speed. To measure the former,
we use the likelihood ratio (two times the difference in log-likelihoods).
The global solution found by our method has a log-likelihood of 36647.69 (estimates and
quasi-maximum likelihood standard errors can be found on the right hand side of Table 2).
We achieve an identical value for all 17 random starting values whenever the parameters were
initialized in this region or mode of the parameter space.13 Seventeen equals the number
of times (one-sixth) that it started in this region. Conversely, the conventional method
does not find this log-likelihood once nor does the method reproduce the same (incorrect)
estimates for each of these 17 starting values. The highest log-likelihood value found by
the standard approach is 36645.29. The differences between the two methods is significant
across these 17 starting values. The conventional method yields log-likelihood values ranging
between 36645.29 to 36636.82, and it only achieves the former for one starting value. With
our method producing the same number repeatedly, we can conclude that it is a maximum.
An immediate benefit of the stable behavior of our method is that we are able to find that
the A1 (3) model has 6 local modes with three well-behaved local maxima and three regions
of the log-likelihood that appear to be locally unidentified. The three well-behaved local
Sahalia and Kimmel(2010) for examples.
12
To make the comparison as parallel as we can, we write the likelihood function the same way, impose
the same identifying restrictions, and use the same scaling and initial values for the parameters except that
the conventional method has additional parameters entering the numerical optimizer.
13
We consider two log-likelihoods to be numerically identical if they agree up to 2 decimal points. In
practice, the log likelihood values are identical up to 8 decimal points.

24

maxima are listed in Table 1 and we will discuss the properties of the model that create these
local modes in Section 5.2. Our method converges 17/100 times to Local 1, 14/100 times to
Local 2, and 17/100 times to Local 3. The median likelihood ratio between our procedure and
the un-concentrated log-likelihood with no analytical gradient is 29.5 indicating a substantial
difference between the two procedures. The conventional method, even if it gets close to a
local maximum, always stops before it fully converges. This makes it difficult for researchers
to differentiate between points that are near a well-behaved local maximum that have the
same economic meaning and locations corresponding to local maxima that are economically
different.
Estimation time is another important dimension along which we compare our approach
to the conventional method. The median estimation time for our procedure to estimate from
a random starting value is less than 2 minutes, whereas the conventional approach of directly
maximizing the log-likelihood function takes more than 2 hours. To perform our study with
100 starting values, it takes our method about 4 hours, whereas it takes roughly 9 days to
complete the same exercise with the conventional method.
In summary, our method addresses all of the following problems with the conventional
method. The conventional method is painfully slow. It does not achieve the global maximum.
And, it is extremely hard to assess convergence behavior and the number of local maxima
because conventional approaches do not repeatedly find the same local maximum even when
started in that region of the parameter space.

5.2

Local maxima

Using our approach simplifies estimation and helps uncover some features of the log-likelihood
surface that may be obscured by directly maximizing the log-likelihood. In this section,
we discuss the characteristics of the model that create local maxima and their economic
consequences.
In Gaussian models, a change in the sign of Œ¥1g rotates the factors from gt to ‚àígt .
25

Table 1: Local maxima in the A1 (3) model
Local 1
Local 2
Local 3
ht
level
slope curvature
0.9961
0.9528
0.5812
Œ¶Q
h
Q
Œ¶g
0.9514
1.0001
0.9983
0.5358
0.5881
0.9389
1
1
-1
Œ¥1,h
LLF 36647.69 36482.56 36530.19
Q
Estimates of Œ¶Q
h and Œ¶g from the A1 (3) model with corresponding log-likelihood. Each value is a different
local maximum depending on the sign of Œ¥1,h and whether the non-Gaussian factor is the level, slope, or
curvature.

This rotation is economically irrelevant because the estimated model switches between two
global maximums. Unlike Gaussian models, fixing the sign of Œ¥1h in spanned models is not
inconsequential, because the state variable ht is positive by definition. Changing the sign
of Œ¥1h does not rotate ht to ‚àíht . Therefore, there can exist inequivalent local maxima for
each combination of different signs of Œ¥1h . For each of the local maxima, the estimated
latent factor ht is different, which changes the conditional variance of gt and consequently
the log-likelihood.
Reordering the eigenvalues in Œ¶Q has completely different implications for spanned nonGaussian models than for Gaussian models.14 If the eigenvalues are reordered in a multifactor Gaussian model, it implies equivalent global maxima with the same economic implication. However, with non-Gaussian spanned factors, they can yield inequivalent local
maxima. Using the A1 (3) model as an example, the factors are labeled as level, slope and
Q
curvature. Reordering the eigenvalues across Œ¶Q
g and Œ¶h does not generally change the shape

of the factors but it does change whether ht is the level, slope, or curvature. Any change
in ht from one type of factor (level) to another (slope/curvature) implies a different conditional variance for gt making the likelihood no longer equivalent. Changing the order of the
14

We collect the autoregressive parameters together in matrices as

Œ¶ =

Œ¶h
Œ¶gh

0
Œ¶g



Q

Œ¶

26

=

Œ¶Q
h
Œ¶Q
gh

0
Œ¶Q
g

!

Q
eigenvalues within Œ¶Q
g and/or Œ¶h results in an equivalent global maximum. The intuition is

the same as re-ordering of the factors gt within a Gaussian ATSM.
In an ATSM with spanned non-Gaussian factors, it is not clear a priori which local
maximum created by these characteristics of the model will be the global maximum. One
must intentionally search each region that potentially has a local maximum and compare
their likelihood values. To illustrate this idea, we present different local maxima for the A1 (3)
model corresponding to different signs of Œ¥1,h and different orderings of the eigenvalues. We
report Œ¶Q , Œ¥1,h , and log-likelihood values in Table 1. In the first column, ht is the level factor
and Œ¥1,h is positive. This is the global maximum in this case. In our sample, volatility is
high during episodes where interest rates are high, so the level factor tends to explain the
volatility best and Œ¥1,h is positive. The next two columns present what happens when ht is
the slope or curvature factor. Due to the nature of the data we are using, the likelihood
function drops significantly from the global maximum to these alternative local maxima. In
theory, there are six potentially different local maxima for each combination of eigenvalues
and sign of Œ¥1,h but in practice there are only three well-behaved local maxima. For the rest,
we observe parameters hitting a boundary or eigenvalues of the autoregressive parameters
being numerically 1. Each of these local maxima correspond to models where volatility
declines in the 1970‚Äôs, which contradicts the data. Those points can be locally unidentified,
meaning that there exists a region of the parameter space where a subset of the parameters
are unidentified. For models with unspanned volatility factors, the issues of multiple modes
do not appear, because the likelihood surface of USV models is similar to spanned Gaussian
models.

6

Model comparison

In this section, we use our methodology to estimate a collection of popular and prominent
ATSMs. The models that we estimate include three factor spanned models AH (3) with

27

Table 2: Maximum likelihood estimates for the A0 (3) and A1 (3) models.
G = 3, H = 0
¬µg
6.97e-05
(4.92e-05)
Œ¶g
1.0074
(0.0084)
-0.0115
(0.0184)
-0.0366
(0.0111)

LLF =

37080.94

-4.85e-05
(1.12e-04)

-3.37e-04
(7.06e-05)

0.0475
(0.0137)

0.0665
(0.0316)

0.9375
(0.0309)
-0.0585
(0.0183)

0.0192
(0.0607)
0.6306
(0.0535)

G = 2, H = 1

LLF =

36647.69

Œ£h ŒΩh
3.00e-05
‚Äî
Œ¶h
0.9943
(0.0061)
Œ¶gh
0.0077
(0.0132)
-0.0405
(0.0077)

¬µg
-1.34e-05
(5.14e-05)

3.32e-05
(2.78e-05)

Œ¶g
0.9854
(0.0224)
-0.0729
(0.0152)

0.0657
(0.0462)
0.6434
(0.0426)

Œ£h ŒΩhQ
4.09e-05
‚Äî
Œ¶Q
h
0.9961
(0.0006)

¬µQ
g
0
‚Äî
Œ¶Q
g
0.9514
(0.0029)

0.5358
(0.0293)

Œ£0,g
3.61e-11
(1.11e-11)
-1.89e-11
(8.52e-12)

0
‚Äî
-5.80e-12
(1.30e-12)

¬µQ
g
0
‚Äî
Œ¶Q
g
0.9950
(0.0007)

0
‚Äî

0
‚Äî

0.9538
(0.0031)

0.5299
(0.0295)

Œ£0,g
3.99e-04
(2.62e-05)

0
‚Äî

0
‚Äî

-3.09e-04
(4.54e-05)
-4.50e-06
(2.23e-05)

5.09e-04
(3.66e-05)
-2.52e-04
(2.82e-05)

0
‚Äî
3.78e-04
(2.37e-05)

Œ£h
1.55e-05
(1.68e-06)
Œ£gh
-0.8932
(0.0587)
0.0538
(0.0397)

Œ¥1,g
1
‚Äî

1
‚Äî

1
‚Äî

Œ¥1,h
1
‚Äî

Œ¥1,g
1
‚Äî

1
‚Äî

3 yr
0.1235

p
diag (‚Ñ¶) √ó 1200
3m
0.2245

2 yr
0.1248

3 yr
0.1236

p
diag (‚Ñ¶) √ó 1200
3m
0.2243

2 yr
0.1251

Œ¥0
0.0083
(0.0005)

4 yr
0.1077

0
‚Äî

ŒΩh
1.9332
(2.0989)

Œ¥0
-0.0011
(0.0002)

ŒΩhQ
2.6371
(0.2879)

Œ£1,g
0.0063
(0.0004)
-0.0035
(0.0003)

0
‚Äî
0.0046
(0.0003)

4 yr
0.1078

Maximum likelihood estimates with quasi-maximum likelihood standard errors. Left: Gaussian A0 (3) model.
Right: non-Gaussian A1 (3) model. The identifying restrictions ¬µQ
g = 0, Œ¥1,g = Œπ, and Œ¥1,h = 1 are imposed
during estimation.

H = 0, 1, 2, 3 volatility factors and four factor spanned models AH (4) with H = 0, 1. We
also estimate four USV models from Section 4.2.2: three versions of U1 (4)(œÜ, œÜ2 , œà) as well
as the U1 (4)(œÜ, œÜ2 , œÜ4 ) model. We report the estimates as well as quasi-maximum likelihood
standard errors as in White(1982) for eight models that have better empirical performance,
leaving out the estimates for models with lower likelihoods for brevity.

28

Figure 1: Bond loadings for six different three factor models.
A1(3) model

A0(3) model

A3(3) model

1

1

18

0.9

0.9

0.7

16
0.996
0.951
0.536

0.8

0.995
0.954
0.530

0.8

0.7

12

0.6

0.6

10

0.5

0.5

8

0.4

0.4

6

0.3

0.3

4

0.2

0.2

2

0.1

0.1

0

0

0

‚àí2

0

10

20

30

40

50

60

0

10

A3(3) diagonal model

20

30

40

50

0.997
0.954
0.535

14

60

0

1
0.997
0.954
0.535

0.8

0.8

0.8

0.7

0.7

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1
10

20

30

40

50

60

0

40

50

60

0.9

0.6

0

30

1
0.987
0.974
0.495

0.9

0.7

20

USV1(4)(œà,œÜ,œÜ2) model

1

0.9

0

10

USV1(4)(œÜ,œÜ2,œà) model

0.997
0.907
0.823

0.1
0
0

10

20

30

40

50

60

0

10

20

30

40

50

60

Bond loadings B as a function of maturity n. Top row from left to right: A0 (3) model, A1 (3) model, A3 (3)
2
2
model. Second row: A3 (3) model with diagonal Œ¶Q
h , U1 (4)(œÜ > œÜ > œà) model, U1 (4)(œà > œÜ > œÜ ) model.
Reported in each graph are the eigenvalues of the risk-neutral feedback matrix Œ¶Q . To make the restricted
A3 (3) model easily comparable, we report the absolute value of the loadings for this model.

6.1

Estimates and model fit

Three factor spanned models Estimates with standard errors for the A0 (3) and A1 (3)
models are included in Table 2. These two models have historically drawn most of the
attention in the term structure literature. For the A0 (3) model, the concentrated likelihood
drops the number of parameters entering the numerical optimizer from 22 to 10 (excluding
‚Ñ¶), while this number drops from 24 to 16 for the A1 (3) model. The likelihood for the A0 (3)
model at 37080.94 is significantly higher than the A1 (3) model at 36647.69.
Surprisingly, among the models that we estimated, the A3 (3) model has the highest
likelihood with a value of 37385.28, substantially higher than the A0 (3) model. We report
estimates for this model on the right panel of Table 3. In order to satisfy the admissibility

29

Q
‚àí1
15
We also
restrictions, all values in Œ£h , Œ£‚àí1
h Œ¶h Œ£h and Œ£h Œ¶h Œ£h must be non-negative.
Q
impose the discrete-time equivalent of the Feller condition, i.e. ŒΩh,i > 1 and ŒΩh,i
> 1 for

i = 1, . . . , H.16 In the A3 (3) model, we found that some of these parameters were near
their boundaries. We fix them at the boundary when calculating the standard errors. For
comparison purposes, we also report on the left panel of Table 3 estimates of an A3 (3)
model where the matrices Œ¶h and Œ¶Q
h are restricted to be diagonal in which case the estimated
parameters are not close to the boundaries. Finally, we note that the A2 (3) model (estimates
not reported for brevity) had the lowest likelihood among the models we estimated with a
value of 36120.34.
The bond loadings for the A0 (3), A1 (3), and diagonal A3 (3) models are almost the same,
see Figure 1. This happens for two reasons. First, the functional form of the bond loading
recursions are the same up to Jensen‚Äôs inequality. Second, the size of the measurement errors
in the cross-section of yields are small relative to the magnitude of the time series shocks
causing an efficient estimator (like maximum likelihood) to emphasize the fit of the cross
section. The estimated factors of these models have high correlations (ranging from 0.95
to 1). Interestingly, the bond loadings for the unrestricted A3 (3) model appear to be nonstationary, even though the eigenvalues of Œ¶Q
h for this model are inside the unit circle and are
nearly identical to the other models.17 The average pricing errors are similar in these models,
with the more restricted diagonal A3 (3) model having larger values. The measurement errors
are about 22 basis points for 3 months, 12 for 2 years, 12 for 3 years and 11 for 4 years.
These errors have the same magnitude as those reported in Ang and Piazzesi(2003).
Differences between these models are largely driven by their ability to fit the time series
15

Multiple non-Gaussian factors tend to make the inversion problem more complicated. We solve this with
randomized starting values, and use several iterations of ‚Äúfminsearch‚Äù in MATLAB for each starting value
to get an initial value that does not produce negative volatility. It takes roughly 20 trials (within a minute)
to locate a starting value for the A3 (3) model.
16
No arbitrage requires that the stochastic discount factor Mt+1 is strictly positive which is guaranteed
by the Feller condition, see Appendix D for details.
17
Unlike Gaussian models, the bond loading recursions bÃÑn,h for multi-factor non-Gaussian models in (6)
are non-linear difference equations. The stability conditions for these equations appear to be determined by
more than the eigenvalues of Œ¶Q
h . We leave the conditions for stability of bÃÑn,h for future research.

30

component of the likelihood. For example, in the A1 (3) model, the conditional mean under P
is more restricted than the A0 (3) model as the Gaussian factors cannot enter the conditional
mean of the non-Gaussian factors. The economic implication of this restriction for the A1 (3)
model is that the level factor does not depend on the past values of slope and curvature
factors. This is apparently counterintuitive. If the slope is high in the last period, i.e., the
long rate is much higher than the short rate (more than explained by compensating for risk),
then it means the market expects the short rate will increase in the future. On average, the
next periods‚Äô short rate or level will increase.
Four factor USV models The two best fitting USV models are the U1 (4)(œÜ > œÜ2 > œà)
and U1 (4)(œà > œÜ > œÜ2 ) models, whose estimates are in Table 4. See Section 4.2.2 for the
definition of the models. We calculate the likelihood for USV models by the particle filter,
see Creal(2012). The likelihood for the best fitting U1 (4)(œÜ > œÜ2 > œà) model is 37331.25,
which is lower than the unrestricted A3 (3) model but substantially higher than other spanned
models.
The bond loadings for USV models are not as flexible compared to spanned models due
to the USV restrictions explained in Section 4.2.2. The first USV model constrains the two
largest eigenvalues of Œ¶Q for the level and slope factors to be related as œÜ and œÜ2 . Without any
restrictions on the eigenvalues of Œ¶Q as in the A0 (3) and A1 (3) models, these are estimated
to be 0.995 and 0.954. In the U1 (4)(œÜ > œÜ2 > œà) model, if the level factor has œÜ = 0.995,
the USV restriction would require the slope factor to be more persistent œÜ2 = 0.990 than
it would be without the restriction (0.954). Conversely, if the model tried to fit the slope
factor first, the USV restriction would not allow the level factor to be persistent enough.
As a compromise, the two eigenvalues in the U1 (4)(œÜ > œÜ2 > œà) model are closer to each
other than what the data would like with estimated values œÜ = 0.9868 and œÜ2 = 0.9738.
Consequently, the loadings on the level and slope factors in this model lie in between the
loadings for spanned models, see Figure 1. Due to the more restrictive loadings, it is not

31

Table 3: Maximum likelihood estimates for two A3 (3) models.
diagonal
Œ£h ŒΩh
5.48e-05
‚Äî
ŒΩh
7.2325
(5.2324)
Œ¶h
0.9918
(0.0056)
0
‚Äî
0
‚Äî
Œ£h ŒΩhQ
2.01e-05
‚Äî
ŒΩhQ
2.6464
(0.7721)
Œ¶Q
h
0.9996
(0.0005)
0
‚Äî
0
‚Äî

LLF =

36949.94

2.75e-04
‚Äî

3.27e-04
‚Äî

10.7472
(4.9148)

5.3456
(1.2905)

0
‚Äî
0.9511
(0.0136)
0
‚Äî

0
‚Äî
0
‚Äî
0.8133
(0.0298)

flexible
Œ£h ŒΩh
5.35e-07
‚Äî
ŒΩh
1
‚Äî
Œ¶h
0.9587
(0.0102)
0.3109
(0.2807)
0

LLF =

37385.28

4.45e-05
‚Äî

9.35e-06
‚Äî

3.1176
(2.7588)

1
‚Äî

0.0010
(0.0003)
0.9133
(0.0259)
0.0226
(0.0018)

0
‚Äî
0.5975
(0.1841)
0.7876
(0.0408)

1.43e-05
‚Äî

9.35e-06
‚Äî

3.10e-04
‚Äî

6.63e-04
‚Äî

12.0937
(5.2723)

10.8396
(1.9412)

0
‚Äî
0.9479
(0.0018)
0
‚Äî

0
‚Äî
0
‚Äî
0.4837
(0.0239)

Œ£h ŒΩhQ
8.10e-07
‚Äî
ŒΩhQ
1.5151
(1.7822)
Œ¶Q
h
0.9890
(0.0014)
0
‚Äî
0.4968
(0.0964)

Œ£h
7.58e-06
(1.27e-06)
0
‚Äî
0
‚Äî

0
‚Äî
2.56e-05
(6.60e-06)
0
‚Äî

0
‚Äî
0
‚Äî
6.12e-05
(5.95e-06)

Œ£h
5.35e-07
(5.84e-08)
0
‚Äî
0
‚Äî

0
‚Äî
1.43e-05
(3.05e-06)
0
‚Äî

0
‚Äî
0
‚Äî
9.35e-06
(2.43e-06)

Œ¥1,h
1
‚Äî

1
‚Äî

-1
‚Äî

Œ¥1,h
1
‚Äî

1
‚Äî

-1
‚Äî

3 yr
0.1286

p
diag (‚Ñ¶) √ó 1200
3m
0.2230

2 yr
0.1274

3 yr
0.1236

p
diag (‚Ñ¶) √ó 1200
3m
0.2247

2 yr
0.1324

Œ¥0
-0.0070
(0.0016)

4 yr
0.1112

1
‚Äî

1
‚Äî

0.0002
(0.0000)
0.8850
(0.0333)
0.0206
(0.0047)

0
‚Äî
1.3287
(0.2776)
0.6122
(0.0490)

Œ¥0
-9.12e-04
(4.82e-04)

4 yr
0.1077

Maximum likelihood estimates with asymptotic quasi-maximum likelihood standard errors. Left: A3 (3) model
with diagonal matrices Œ¶Q
h and Œ¶h . Right: A3 (3) model. The identifying restrictions ¬µh = 0, and Œ¥1,h =
(1, 1, ‚àí1) are imposed during estimation.

surprising that the average pricing errors for this model are larger than for spanned models.
Moreover, the Gaussian factors whose eigenvalues share the relationship œÜ and œÜ2 are highly
correlated with a correlation of -0.928. This number is 0.43 in absolute value for the A0 (3)
and A1 (3) models for example.
2
Estimation of an A0 (3) that includes the same restrictions on Œ¶Q
g as the U1 (4)(œÜ > œÜ >

œà) model but no stochastic volatility has a likelihood of 37040.5. This indicates that this

32

Table 4: Maximum likelihood estimates for two U1 (4)(œÜ, œÜ2 , œà) models.
G = 3, H = 1
¬µg
2.11e-04
(5.04e-07)
Œ¶g
1.0724
(0.0020)
-0.0788
(0.0008)
-0.0321
(0.0000)
¬µQ
g
0
‚Äî
Œ¶Q
g
0.9868
(0.0004)

LLF =

37331.25

-1.88e-04
(3.66e-07)

-2.37e-04
(2.39e-06)

0.1181
(0.0008)
0.8736
(0.0015)
-0.0372
(0.0001)

0.1107
(0.0009)
-0.0555
(0.0005)
0.6347
(0.0070)

G = 3, H = 1
¬µg
7.42e-04
(8.80e-05)
Œ¶g
1.1316
(0.0427)
-0.2881
(0.0213)
0.0348
(0.0162)
¬µQ
g
0
‚Äî
Œ¶Q
g
0.9073
(0.0045)

Œ¥0
0.0061
(0.0000)

LLF =

37241.05

-1.17e-03
(8.42e-05)

8.49e-06
(5.76e-06)

0.3251
(0.1009)
0.4463
(0.0715)
0.0349
(0.0233)

0.0520
(0.0161)
-0.0923
(0.0149)
0.9995
(0.0029)

0
‚Äî

0
‚Äî

0.8231
‚Äî

0.9967
(0.0004)

0
‚Äî
2.13e-05
(4.40e-05)
7.05e-05
(1.43e-04)

0
‚Äî
0
‚Äî
3.31e-04
(9.73e-05)

0
‚Äî
0
‚Äî
0
‚Äî

0
‚Äî
0
‚Äî
0
‚Äî

0
‚Äî

0
‚Äî

0.9738
‚Äî

0.4931
(0.0019)

0
‚Äî
2.44e-04
(1.14e-07)
-4.27e-04
(2.10e-06)

0
‚Äî
0
‚Äî
1.66e-10
(3.90e-13)

0
‚Äî
0
‚Äî
0
‚Äî

0
‚Äî
0
‚Äî
0
‚Äî

Œ£0,g
1.21e-03
(7.24e-05)
-1.30e-03
(4.63e-06)
-3.67e-04
(1.06e-04)
Œ£1,g
8.35e-04
(4.03e-05)
0
‚Äî
0
‚Äî

ŒΩh
1
‚Äî

Œ¶h
0.9598
(0.0086)

Œ£h
0.0100
‚Äî

ŒΩh
1.0658
(0.0319)

Œ¶h
0.9539
(0.0101)

Œ£h
0.0100
‚Äî

Œ¥1,g
1
‚Äî

1
‚Äî

1
‚Äî

Œ¥1,g
1
‚Äî

1
‚Äî

1
‚Äî

2 yr
0.1298

3 yr
0.1316

Œ£0,g
1.16e-03
(2.41e-06)
-1.23e-03
(2.83e-06)
5.04e-05
(9.23e-08)
Œ£1,g
7.05e-04
(1.44e-06)
0
‚Äî
0
‚Äî

p
diag (‚Ñ¶) √ó 1200
3m
0.2266

p
2 yr
0.1298

3 yr
0.1316

4 yr
0.1101

diag (‚Ñ¶) √ó 1200
3m
0.2266

Œ¥0
0.0115
(0.0007)

4 yr
0.1101

Maximum likelihood estimates with quasi-maximum likelihood standard errors for two unspanned models.
Left: U1 (4)(œÜ > œÜ2 > œà) model. Right: U1 (4)(œà > œÜ > œÜ2 ) model. The USV and the identifying restrictions
Œ£h = 0.01, ¬µQ
g = 0, and Œ¥1,g = (1, 1, 1) are imposed during estimation.

single USV restriction is rejected relative to the benchmark Gaussian A0 (3) model of Table 2
by a likelihood ratio test. On the other hand, the addition of unspanned stochastic volatility
factors increases the likelihood by 37331.25 - 37040.5 = 290.75. The primary source is a
significantly better fit of the dynamics of volatility, as we discuss further below.
When the USV restriction is imposed on the second and third largest eigenvalues as in
the U1 (4)(œà > œÜ > œÜ2 ) model of Table 4, it constrains the bond loadings of the slope and
33

curvature factors because the eigenvalues in Œ¶Q
g associated with these factors now share the
relationship œÜ and œÜ2 . This restriction causes them to be closer than they would otherwise
have been if left unrestricted. The U1 (4)(œÜ, œÜ2 , œÜ4 ) model imposes even stronger restrictions
on Œ¶Q
g because it only has a single free parameter. It has likelihood 36889.44 (parameter
estimates not reported), which is well below the benchmark A0 (3) model.
Four factor spanned models Finally, we consider two four factor spanned models: the
Gaussian A0 (4) model and the non-Gaussian A1 (4) model. There are a total of 35 parameters
in the A0 (4) model and only 20 of these parameters enter the numerical optimizer, while there
are 39 parameters in the A1 (4) model and 15 of these can be concentrated out. Parameter
estimates and standard errors for both models are in Table 5. While adding another Gaussian
factor increases the likelihood relative to the A0 (3) model to 37194.34 for the A0 (4), the
additional factor is not as important as adding an USV factor.

Repeated eigenvalues When we estimated the A1 (4) model, we found that it had repeated eigenvalues and our estimates in Table 5 have imposed them using the Jordan decomposition. If we use a diagonal matrix for Œ¶Q , the matrix B1 will be singular and one
element in Œ¶Q is unidentified.18 To illustrate this point, Table 6 reports different sets of
parameter values all with the same likelihood. Across the four local maxima, the values of
Q
Œ¶Q
h , the last eigenvalue of Œ¶g , and the log-likelihood function are almost identical but the

first two eigenvalues of Œ¶Q
g vary across different optima. The last column of Table 6 shows
the results when we impose repeated eigenvalues (from the model reported in Table 2). The
Q
estimates of Œ¶Q
h , the last eigenvalue of Œ¶g and the likelihood function have the same values

as before. However, the first two eigenvalues of Œ¶Q
g are identical by definition and are equal
to the average of the first two eigenvalues in those local maxima. The log-likelihood value
also does not change.
18

For a matrix with repeated eigenvalues, the Jordan decomposition imposes the additional restrictions
necessary to obtain identification. With two repeated eigenvalues in Œ¶Q
g , the Jordan decomposition is
0
vec Œ¶Q
=
(Œª
1
0
;
0
Œª
0
;
0
0
Œª
)
where
Œª
and
Œª
are
the
unique
eigenvalues.
1
1
2
1
2
g

34

Table 5: Maximum likelihood estimates for the A0 (4) and A1 (4) models.

G = 4, H = 0
¬µg
3.89e-04
(1.73e-04)
Œ¶g
1.0336
(0.0352)
-0.0783
(0.0626)
0.0889
(0.0766)
-0.0851
(0.0528)

LLF =

37195.84

-9.73e-04
(2.11e-04)

1.28e-03
(3.07e-04)

-8.19e-04
(3.68e-04)

0.0874
(0.0536)

-0.0142
(0.0475)

0.0908
(0.0646)

0.8338
(0.0893)
0.1541
(0.1312)
-0.1405
(0.0901)

0.2044
(0.1298)
0.6935
(0.1731)
-0.0398
(0.0924)

-0.0788
(0.1734)
0.1926
(0.2259)
0.5456
(0.1377)

¬µQ
g
0
‚Äî
Œ¶Q
g
0.9922
(0.0024)

0
‚Äî

0
‚Äî

0
‚Äî

0.9604
(0.0116)

0.8764
(0.0303)

0.6964
(0.0504)

Œ£0,g
6.94e-04
(2.33e-04)

0
‚Äî

0
‚Äî

0
‚Äî

-1.47e-03
(2.80e-04)
1.66e-03
(1.96e-04)
-8.06e-04
(3.69e-04)

9.77e-04
(3.98e-04)
-1.39e-03
(4.33e-04)
5.65e-04
(2.68e-04)

0
‚Äî
8.74e-04
(3.21e-04)
-7.18e-04
(3.59e-04)

0
‚Äî
0
‚Äî
4.04e-04
(2.68e-05)

Œ¥0
3.92e-03
(6.45e-04)
Œ¥1,g
1
‚Äî
p
diag (‚Ñ¶) √ó 1200
3m
0.2390

1
‚Äî
3 yr
0.1013

1
‚Äî
4 yr
0.0982

G = 3, H = 1

LLF =

36729.22

Œ£h ŒΩh
5.64e-05
‚Äî
Œ¶h
0.9901
(0.0073)
Œ¶gh
0.0037
(0.0260)
0.0016
(0.0031)
-0.0352
(0.0257)

¬µg
3.07e-04
(1.76e-04)

-3.76e-05
(1.84e-05)

-3.10e-04
(1.79e-04)

Œ¶g
0.8668
(0.0644)
0.0153
(0.0062)
-0.0095
(0.0555)

1.1695
(0.4487)
0.8156
(0.0456)
-0.1235
(0.4361)

0.0911
(0.0974)
0.0028
(0.0097)
0.6508
(0.0974)

Œ£h ŒΩhQ
2.71E-05
‚Äî
Œ¶Q
h
0.9952
(0.0011)

¬µQ
g
0
‚Äî
Œ¶Q
g
0.9121
(0.0075)

Œ£h
2.11e-05
(3.75e-06)
Œ£gh
0.9248
(0.4737)
-0.2171
(0.0333)
-1.5635
(0.4198)

Œ£0,g
8.37e-04
(2.90e-04)
-9.03e-05
(2.69e-05)
-7.96e-04
(2.72e-04)
Œ£1,g
1.04e-02
(2.48e-03)
-6.75e-04
(2.75e-04)
-9.01e-03
(2.69e-03)

0
‚Äî

0
‚Äî

‚Äî
‚Äî

0.7021
(0.0324)

0
‚Äî
7.43e-13
(4.22e-12)
9.41e-11
(1.75e-11)

0
‚Äî
0
‚Äî
4.03e-10
(6.48e-11)

0
‚Äî
8.15e-04
(7.96e-05)
1.12e-03
(4.10e-04)

0
‚Äî
0
‚Äî
4.68e-03
(3.04e-04)

1
‚Äî

Œ¥0
-4.44e-04
(3.67e-04)
Œ¥1,h
1
‚Äî

Œ¥1,g
1
‚Äî

1
‚Äî

p
diag (‚Ñ¶) √ó 1200
3m
0.2408

3 yr
0.1005

4 yr
0.0981

1
‚Äî

ŒΩh
2.6780
(1.8951)

ŒΩhQ
1.2839
(0.3516)

Maximum likelihood estimates with quasi-maximum likelihood standard errors. Left: Gaussian A0 (4) model.
Right: non-Gaussian A1 (4) model. The identifying restrictions ¬µQ
g = 0, Œ¥1,g = Œπ, and Œ¥1,h = 1 are imposed
during estimation.

35

Figure 2: Estimated conditional volatility of yields from four different affine models.
x 10
A1(3) model
GAS model
A (3) model
0

2

1 year maturity

‚àí4

1 month maturity

‚àí3

x 10

1.5

1

16

GAS model
A (3) model
0

14

5 year maturity

‚àí4

x 10
A (3) model

A1(3) model

9

GAS model
A (3) model
0

8

12

7

10

6
5

8
1

4

6

3
4

0.5

2
2
1
1960

1970

1980

1990

2000

1960

2010

x 10

GAS model
A0(3) model

1980

1990

2000

2010

1970

1980

1990

2000

2010

5 year maturity

‚àí4

x 10

16

A3(3) model

9

A3(3) model

14

GAS model
A0(3) model

8

GAS model
A0(3) model

7

12
1.5

1960

1 year maturity

x 10
A3(3) model

2

1970

‚àí4

1 month maturity

‚àí3

6

10

5

8
1

4
6
3
4

0.5

2
2
1
1960

1970

1980

1990

2000

1960

2010

1 month maturity

‚àí3

x 10

GAS model
A0(3) model

1980

1990

2000

1960

2010

1 year maturity

‚àí4

x 10
U1(4)(œÜ,œÜ2,œà) model

2

1970

1970

1980

1990

2000

2010

5 year maturity

‚àí4

x 10

16

U1(4)(œÜ,œÜ2,œà) model

9

U1(4)(œÜ,œÜ2,œà) model

14

GAS model
A0(3) model

8

GAS model
A0(3) model

7

12
1.5

6

10

5

8
1

4
6
3
4

0.5

2
2
1
1960

1970

1980

1990

2000

2010

1960

1 month maturity

‚àí3

x 10

GAS model
A0(3) model

1980

1990

2000

1970

1980

1990

2000

2010

5 year maturity

‚àí4

x 10

16

U1(4)(œà,œÜ,œÜ2) model

9

U1(4)(œà,œÜ,œÜ2) model

14

GAS model
A0(3) model

8

GAS model
A0(3) model

7

12
1.5

1960

2010

1 year maturity

x 10
U1(4)(œà,œÜ,œÜ2) model

2

1970

‚àí4

6

10

5

8
1

4
6
3
4

0.5

2
2
1
1960

1970

1980

1990

2000

2010

1960

1970

1980

1990

2000

2010

1960

1970

1980

1990

2000

2010

Estimated conditional volatility of yields from different affine models compared to the multivariate generalized
autoregressive score model and the A0 (3) with constant volatility. Across the columns are the one month,
one year, and 5 year maturities. Top row: A1 (3) model. Second row: A3 (3) model. Third row: U1 (4)(œÜ >
œÜ2 > œà) model. Bottom row: U1 (4)(œà > œÜ > œÜ2 ) model.

36

Œ¶Q
h
Œ¶Q
g

LLF

Table 6: Repeated Eigenvalues
Local 1
Local 2
Local 3 Repeated
0.9952
0.9952
0.9952
0.9952
0.9130
0.9164
0.9126
0.9121
0.9112
0.9075
0.9115
‚Äì
0.7021
0.7025
0.7021
0.7021
36729.22 36729.20 36729.22 36729.22

Estimates from the A1 (4) model when repeated eigenvalues are not imposed compared to when they are. The
table illustrates how this can create identification problems in affine models.

6.2

Volatility

The blue lines in Figure 2 are the conditional volatilities from four different models; across
the rows are the A1 (3), A3 (3), U1 (4)(œÜ > œÜ2 > œà) and U1 (4)(œà > œÜ > œà 2 ) models.19 The
three columns represent maturities of 1 month, 1 year, and 5 years. The volatilities for
the USV models are the filtered (one-sided) estimates calculated from the particle filter.
To provide a point of comparison, we also plot in these graphs the unconditional volatility
from the A0 (3) model in green and in red estimates of the conditional volatilities from the
multivariate generalized autoregressive score model of Creal, Koopman, and Lucas(2011)
and Creal, Koopman, and Lucas(2013).20
The estimated volatilities from spanned models (first two rows) are much less volatile
than GAS volatility. A similar observation was made by Collin-Dufresne, Goldstein, and
Jones(2009). With only a single volatility factor, the A1 (3) model does not fit yield volatility at any maturity. The A3 (3) model adds flexibility with two more factors, which improves
the fit for volatility at shorter horizons, especially for the recent episode of low volatility.
At longer horizons, the fit to volatility appears to be the same as the A1 (3) model. This
is because the estimated level (volatility) factor is similar across both the A1 (3) and A3 (3)
models, and the long term volatility loads mostly on it. Ultimately, spanned models lack
19

The volatilities from the remaining models have the same qualitative features and are not shown.
The generalized autoregressive score model with time-varying covariance matrix is similar to a multivariate GARCH model. To make the volatilities of yields comparable across models, we use a VAR(1) for
(1)
the conditional mean of yields Yt and allow the errors to have time-varying volatilities and correlations.
20

37

flexibility because the non-Gaussian state variables ht serve a dual role: they must simultaneously fit the conditional mean and variance. The maximum likelihood estimator chooses the
parameter vector Œ∏ to fit the conditional mean first before fitting the conditional variance.
USV models are designed to fit volatility by separating the role of Gaussian and nonGaussian factors. The U1 (4)(œÜ > œÜ2 > œà) model performs much better than spanned models
at fitting the volatility across different maturities, although it only has a single stochastic
volatility factor. It does a particularly good job for short and medium maturities. At longer
maturities, it fits the high volatility periods of the early 1980‚Äôs well, although misses the
period of low volatility early in the sample.
Our results suggest, however, that not all USV models fit yield volatility equally well
and researchers must be careful when choosing USV restrictions. We demonstrate this
point by comparing the performance of the two best USV models U1 (4)(œÜ > œÜ2 > œà)
and U1 (4)(œà > œÜ > œÜ2 ). Instead of having stochastic volatility on the level factor, the
U1 (4)(œà > œÜ > œÜ2 ) model has stochastic volatility on the slope factor. It fits the volatility
at shorter maturities equally well but, at longer maturities, it exhibits almost no stochastic
volatility. This is because the eigenvalue associated with the slope factor that has stochastic
volatility is œÜ = 0.9073 as opposed to œÜ = 0.9868 in the first USV model. The bond loadings
on this factor decay rapidly as maturity increases, meaning that long maturities have no
stochastic volatility. To summarize, although USV models are designed to fit the volatility,
the restrictions needed to impose USV are not unique and the choice of which restriction to
impose is not innocuous.

7

Conclusion

We provide new estimation procedures for non-Gaussian affine term structure models with
spanned or unspanned stochastic volatility. The new estimation approach for spanned models leverages the fact that many of the parameters can be concentrated out of the likelihood

38

function. By optimizing the concentrated likelihood, it provides exactly the same solution as
maximizing the original likelihood. But, it improves the estimation dramatically by reducing the number of parameters that need to be maximized numerically. We demonstrate the
improvement in performance with our method. Using our procedure, we show what characteristics of spanned non-Gaussian models cause local maxima to exist and how alternative
local maxima may have dramatically different economic implications. We apply a similar
idea to the concentrated likelihood to estimate unspanned models.
Estimating a wide range of popular models, we find that models with spanned volatility
have similar cross sectional fit for yields. They fit better than the USV models, because the
latter impose restrictions on the cross section in order to introduce USV factors. Models with
USV fit the volatility better by design. The choice of how to impose USV restrictions is not
innocuous as some USV models can severely limit yield volatility at particular maturities.
USV models make an effort to fit the volatility of yields. Future work on term structure models aiming to fit both the conditional mean and volatility of yields simultaneously
will likely require (1) multiple unspanned volatility factors, and (2) the ability to relax the
restrictions that USV impose on the cross section.

References
Abramowitz, Milton, and Irene A. Stegun (1964) Handbook of Mathematical Functions
Dover Publications Inc, New York, NY.
Adrian, Tobias, Richard K. Crump, and Emanuel Moench (2012) ‚ÄúPricing the term
structure with linear regressions.‚Äù Journal of Financial Economics 110, 110‚Äì138.
Aƒ±Ãàt-Sahalia, Yacine (2008) ‚ÄúClosed-form likelihood expansions for multivariate diffusions.‚Äù The Annals of Statistics 36, 906‚Äì937.
Aƒ±Ãàt-Sahalia, Yacine, and Robert L. Kimmel (2010) ‚ÄúEstimating affine multifactor term
structure models using closed-form likelihood expansions.‚Äù Journal of Financial Eco39

nomics 98, 113‚Äì144.
Andersen, Torben, and Luca Benzoni (2010) ‚ÄúDo bonds span volatility risk in the U.S.
treasury market? A specification test for affine term structure models.‚Äù The Journal
of Finance 65, 603‚Äì653.
Ang, Andrew, and Monika Piazzesi (2003) ‚ÄúA no-arbitrage vector autoregression of term
structure dynamics with macroeconomic and latent variables‚Äù Journal of Monetary
Economics 50, 745‚Äì787.
Bauer, Michael D. (2014) ‚ÄúBayesian Estimation of Dynamic Term Structure Models
under Restrictions on Risk Pricing‚Äù Federal Reserve Bank of San Francisco Working
Paper.
Bauer, Michael D., Glenn D. Rudebusch, and Jing Cynthia Wu (2012) ‚ÄúCorrecting estimation bias in dynamic term structure models.‚Äù Journal of Business and Economic
Statistics 30, 454‚Äì467.
Cheridito, Patrick, Damir Filipovic, and Robert L. Kimmel (2007) ‚ÄúMarket price of
risk specifications for affine models: theory and evidence‚Äù Journal of Financial Economics 84, 123‚Äì170.
Christensen, Jens H.E., Francis X. Diebold, and Glenn D. Rudebusch (2011) ‚ÄúThe affine
arbitrage-free class of Nelson-Siegel term structure models.‚Äù Journal of Econometrics
164, 4‚Äì20.
Cochrane, John H., and Monika Piazzesi (2008) ‚ÄúDecomposing the yield curve‚Äù Unpublished manuscript, Booth School of Business, University of Chicago.
Collin-Dufresne, Pierre, and Robert S. Goldstein (2002) ‚ÄúDo bonds span the fixed income markets? Theory and evidence for unspanned stochastic volatility.‚Äù The Journal of Finance 57, 1685‚Äì1730.
Collin-Dufresne, Pierre, Robert S. Goldstein, and Charles Jones (2008) ‚ÄúIdentification
of maximal affine term structure models.‚Äù The Journal of Finance 63, 743‚Äì795.
40

Collin-Dufresne, Pierre, Robert S. Goldstein, and Charles Jones (2009) ‚ÄúCan the volatility of interest rates be extracted from the cross section of bond yields? An investigation of unspanned stochastic volatility.‚Äù Journal of Financial Economics 94, 47‚Äì66.
Cox, John C., Jonathan E. Ingersoll, and Stephen A. Ross (1985) ‚ÄúA theory of the term
structure of interest rates‚Äù Econometrica 53, 385‚Äì407.
Creal, Drew D. (2012) ‚ÄúA survey of sequential Monte Carlo methods for economics and
finance.‚Äù Econometric Reviews 31, 245‚Äì296.
Creal, Drew D., Siem Jan Koopman, and AndreÃÅ Lucas (2011) ‚ÄúA dynamic multivariate
heavy-tailed model for time-varying volatilities and correlations.‚Äù Journal of Business and Economic Statistics 29, 552‚Äì563.
Creal, Drew D., Siem Jan Koopman, and AndreÃÅ Lucas (2013) ‚ÄúGeneralized autoregressive score models with applications.‚Äù Journal of Applied Econometrics 28, 777‚Äì795.
Dai, Qiang, and Kenneth J. Singleton (2000) ‚ÄúSpecification analysis of affine term structure models.‚Äù The Journal of Finance 55, 1943‚Äì1978.
de Jong, Piet (1991) ‚ÄúThe diffuse Kalman filter‚Äù The Annals of Statistics 19, 1073‚Äì83.
Dempster, Arthur P., Nan M. Laird, and Donald B. Rubin (1977) ‚ÄúMaximum likelihood
from incomplete data via the EM algorithm‚Äù Journal of the Royal Statistical Society,
Series B 39, 1‚Äì38.
Diebold, Francis X., and Glenn D. Rudebusch (2013) Yield Curve Modeling and Forecasting. Princeton University Press, Princeton, NJ.
Diez de Los Rios, Antonio (2013) ‚ÄúA new linear estimator for Gaussian dynamic term
structure models.‚Äù Unpublished manuscript, Bank of Canada.
Duffee, Gregory R. (2002) ‚ÄúTerm premia and interest rate forecasts in affine models‚Äù
The Journal of Finance 57, 405‚Äì443.

41

Duffee, Gregory R. (2011) ‚ÄúInformation in (and not in) the term structure‚Äù The Review
of Financial Studies 24, 2895‚Äì2934.
Duffee, Gregory R. (2012) ‚ÄúBond pricing and the macroeconomy‚Äù Working paper, Johns
Hopkins University.
Duffie, Darrell, and Rui Kan (1996) ‚ÄúA yield factor model of interest rates‚Äù Mathematical Finance 6, 379‚Äì406.
Durbin, James, and Siem Jan Koopman (2012) Time Series Analysis by State Space
Methods Oxford University Press, Oxford, UK 2 edition.
Fama, Eugene F., and Robert R. Bliss (1987) ‚ÄúThe information in long maturity forward
rates‚Äù American Economic Review 77, 680‚Äì692.
Godsill, Simon J., Arnaud Doucet, and Michael West (2004) ‚ÄúMonte Carlo smoothing
for nonlinear time series.‚Äù Journal of the American Statistical Association 99, 156‚Äì
168.
GourieÃÅroux, Christian, and Joann Jasiak (2006) ‚ÄúAutoregressive gamma processes.‚Äù
Journal of Forecasting 25, 129‚Äì152.
GourieÃÅroux, Christian, Joann Jasiak, and Razvan Sufana (2009) ‚ÄúThe Wishart autoregressive process of multivariate stochastic volatility.‚Äù Journal of Econometrics 150,
167‚Äì181.
GourieÃÅroux, Christian, Alain Monfort, and Vassilis Polimenis (2002) ‚ÄúAffine term structure models.‚Äù Institut National de La Statistique et des Etudes Economiques.
GuÃàrkaynak, Refet S., and Jonathan H. Wright (2012) ‚ÄúMacroeconomics and the term
structure‚Äù Journal of Economic Literature 50, 331‚Äì367.
Hamilton, James D., and Jing Cynthia Wu (2012) ‚ÄúIdentification and estimation of
Gaussian affine term structure models.‚Äù Journal of Econometrics 168, 315‚Äì331.

42

Hamilton, James D., and Jing Cynthia Wu (2014) ‚ÄúTestable implications of affine term
structure models.‚Äù Journal of Econometrics 178, 231‚Äì242.
Heidari, Massoud, and Liuren Wu (2003) ‚ÄúAre interest rate derivatives spanned by the
term structure of interest rates?‚Äù The Journal of Fixed Income 13, 75‚Äì86.
Jacquier, Eric, Michael Johannes, and Nicholas G. Polson (2007) ‚ÄúMCMC maximum
likelihood for latent state models‚Äù Journal of Econometrics 137, 615‚Äì640.
Joslin, Scott (2010) ‚ÄúCan unspanned stochastic volatility models explain the cross section of bond volatilities?‚Äù Working paper, University of Southern California, Marshall School of Business.
Joslin, Scott, Kenneth J. Singleton, and Haoxiang Zhu (2011) ‚ÄúA new perspective on
Gaussian affine term structure models‚Äù The Review of Financial Studies 27, 926‚Äì
970.
Kim, Don H., and Athanasios Orphanides (2005) ‚ÄúTerm structure estimation with survey data on interest rate forecasts.‚Äù Federal Reserve Board, Finance and Economics
Discussion Series 2005-48.
Kim, Don H., and Jonathan H. Wright (2005) ‚ÄúAn arbitrage-free three-factor term
structure model and the recent behavior of long-term yields and distant-horizon
forward rates.‚Äù Federal Reserve Board, Finance and Economics Discussion Series
2005-33.
Le, Anh, Kenneth J. Singleton, and Qiang Dai (2010) ‚ÄúDiscrete-time affine term structure models with generalized market prices of risk.‚Äù The Review of Financial Studies
23, 2184‚Äì2227.
Li, Haitao, and Feng Zhao (2006) ‚ÄúUnspanned stochastic volatility: evidence from hedging interest rate derivatives.‚Äù The Journal of Finance 61, 341‚Äì378.
Malik, Sheheryar, and Michael K. Pitt (2011) ‚ÄúParticle filters for continuous likelihood
evaluation and maximisation.‚Äù Journal of Econometrics 165, 190‚Äì209.
43

Meng, Xiao-Li, and Donald B. Rubin (1993) ‚ÄúMaximum likelihood estimation via the
ECM algorithm: A general framework.‚Äù Biometrika 80, 267‚Äì278.
Piazzesi, Monika (2010) ‚ÄúAffine term structure models‚Äù in Handbook of Financial Econometrics, edited by Y. Ait-Sahalia and L. P. Hansen Elsevier, New York pages 691‚Äì
766.
Richard, Jean Francois, and Wei Zhang (2007) ‚ÄúEfficient high-dimensional importance
sampling‚Äù Journal of Econometrics 141, 1385‚Äì1411.
Trolle, Anders B., and Eduardo S. Schwartz (2009) ‚ÄúA general stochastic volatility
model for the pricing of interest rate derivatives.‚Äù The Review of Financial Studies
22, 2007‚Äì2057.
Wei, Greg C. G., and Martin A. Tanner (1990) ‚ÄúA Monte Carlo implementation of the
EM algorithm and the poor man‚Äôs data augmentation algorithms.‚Äù Journal of the
American Statistical Association 85, 699‚Äì704.
White, Halbert L. (1982) ‚ÄúMaximum likelihood estimation of misspecified models.‚Äù
Econometrica 50, 1‚Äì25.

44

Appendix A

Distributions

We define the distributions found in the paper. The notation for them is local to the appendix.

Appendix A.1

Gamma and multivariate gamma distributions

ŒΩh ‚àí1 ‚àíŒΩh
1
exp ‚àí wt+1
and E (wt+1 )
Œì(ŒΩh ) wt+1 Œ∫
Œ∫

ŒΩh
1
E [exp (uwt+1 )] = 1‚àíŒ∫u
, which exists only if Œ∫u <

A gamma r.v. wt+1 ‚àº Gamma (ŒΩh , Œ∫) has p.d.f p (wt+1 |ŒΩh , Œ∫) =

=

ŒΩh Œ∫ and V (wt+1 ) = ŒΩh Œ∫2 . The Laplace transform is

1.

A multivariate gamma random vector ht+1 ‚àº Mult. Gamma (ŒΩh , Œ£h , ¬µh ) can be obtained by shifting and
rotating a vector of uncorrelated gamma r.v.‚Äôs. Let ht+1 = ¬µh + Œ£h wt+1 where wt+1 is an H √ó 1 vector with
elements wi,t+1 ‚àº Gamma (ŒΩh,i , 1) for i = 1, . . . , H. The H √ó 1 vector of (non-negative) location parameters
is ¬µh , Œ£h is a full rank H √ó H matrix of (non-negative) scale parameters, and ŒΩh > 0 is a H √ó 1 vector of
shape parameters. The p.d.f of ht+1 can be determined by a standard change-of-variables

p (ht+1 |ŒΩh , Œ£h , ¬µh )

= |Œ£‚àí1
h |

H
Y

ŒΩh,i ‚àí1

1
e0i Œ£‚àí1
exp ‚àíe0i Œ£‚àí1
h [ht+1 ‚àí ¬µh ]
h [ht+1 ‚àí ¬µh ]
Œì (ŒΩh,i )
i=1

where ei is an H √ó 1 unit vector. The mean and variance are E [ht+1 ] = ¬µh + Œ£h ŒΩh and V [ht+1 ] =
Œ£h diag (ŒΩh ) Œ£0h . The Laplace transform is
E [exp (u0 ht+1 )]

Z
=

‚àû

exp (u0 ht+1 ) p (ht+1 |ŒΩh , Œ£h , ¬µh ) dht+1

0

=

exp (u0 ¬µh )

Z

‚àû

exp (u0 Œ£h wt+1 )

0

=

0

exp (u ¬µh )

H 
Y
i=1

1
1 ‚àí e0i Œ£0h u

H
Y

1
ŒΩh,i ‚àí1
wi,t+1
exp (‚àíwt+1 ) dwt+1
Œì
(ŒΩ
)
h,i
i=1

ŒΩh,i

0

= exp u ¬µh ‚àí

H
X

!
ŒΩh,i log [1 ‚àí

e0i Œ£0h u]

i=1

The Laplace transform exists only if e0i Œ£0h u < 1 for i = 1, . . . , H.

Appendix A.2

Multivariate non-central gamma distributions

A H √ó 1 non-central gamma (NCG) random vector ht+1 ‚àº Mult.-N.C.G. (ŒΩh , Œ¶h ht , Œ£h , ¬µh ) is a Poisson
mixture of multivariate gamma r.v.‚Äôs as in (12)-(14). The process ht remains positive and well-defined as
long as ¬µh ‚â• 0, Œ£‚àí1
h Œ¶h Œ£h ‚â• 0, ŒΩh > 1, and elements of Œ£h cannot be negative. A standard multivariate NCG
random variable (the discrete-time CIR process) is obtained by setting ¬µh = 0 and letting Œ£h be a diagonal
matrix. Further properties of the univariate NCG process are described in GourieÃÅroux and Jasiak(2006).

45

As long as Œ£h has full rank, the p.d.f. can be found by integrating out the Poisson r.v.‚Äôs

p (ht+1 |ŒΩh , Œ¶h ht , Œ£h , ¬µh )

=

|Œ£‚àí1
h | exp

‚àí

H
X

!
e0i Œ£‚àí1
h

[ht+1 ‚àí ¬µh ] +

e0i Œ£‚àí1
h Œ¶h

[ht ‚àí ¬µh ]

i=1
H
Y

ŒΩh,i ‚àí1
e0i Œ£‚àí1
h [ht+1 ‚àí ¬µh ]

i=1
‚àû
X
zi,t+1


zi,t+1
1  0 ‚àí1
1
ei Œ£h [ht+1 ‚àí ¬µh ] e0i Œ£‚àí1
h Œ¶h [ht ‚àí ¬µh ]
Œì (ŒΩh,i + zi,t+1 ) zi,t+1 !
=0

Using the definition of the modified Bessel function of the first kind21 , the p.d.f. can be expressed as

p (ht+1 |ŒΩh , Œ¶h ht , Œ£h , ¬µh )

|Œ£‚àí1
h | exp

=

‚àí

H
X

!
e0i Œ£‚àí1
h

[ht+1 ‚àí ¬µh ] +

e0i Œ£‚àí1
h Œ¶h

[ht ‚àí ¬µh ]

i=1
H
Y

e0i Œ£‚àí1
h [ht+1 ‚àí ¬µh ]

 ŒΩh,i2 ‚àí1

‚àí ŒΩh,i2 ‚àí1
e0i Œ£‚àí1
Œ¶
[h
‚àí
¬µ
]
h
t
h
h

i=1


 q
 0 ‚àí1

‚àí1
0
IŒΩh,i ‚àí1 2 ei Œ£h [ht+1 ‚àí ¬µh ] ei Œ£h Œ¶h [ht ‚àí ¬µh ] .

The Laplace transform can be derived from the law of iterated expectations

0

E [exp (u ht+1 )]

= Ez

0


Eh|z [exp (u ht+1 )] = Ez

0

exp (u ¬µh )

H 
Y
i=1

=

exp (u0 ¬µh )

H 
Y
i=1

=

0

exp (u ¬µh )

H 
Y
i=1

=

exp u0 ¬µh +

1
1 ‚àí e0i Œ£0h u

ŒΩh,i

1
1 ‚àí e0i Œ£0h u

ŒΩh,i Y
H

H
X
i=1

Ez

H 
Y
i=1

i=1

exp

1
1 ‚àí e0i Œ£0h u
zi !

ŒΩh,i +zi !

1
1 ‚àí e0i Œ£0h u

 0 0 !
e0i Œ£‚àí1
h Œ¶h [ht ‚àí ¬µh ] ei Œ£h u
1 ‚àí e0i Œ£0h u

!
H
X
e0i Œ£0h u 0 ‚àí1
e Œ£ Œ¶h (ht ‚àí ¬µh ) ‚àí
ŒΩh,i log (1 ‚àí e0i Œ£0h u)
1 ‚àí e0i Œ£0h u i h
i=1

where e0i Œ£0h u denotes the i-th element of the H √ó1 vector Œ£0h u. The Laplace transform exists only if e0i Œ£0h u < 1
for i = 1, . . . , H.

Appendix A.3

Mixture of Gaussian and mult. NCG distributions


From standard results in statistics, the multivariate (G √ó 1) Gaussian r.v. gt+1 ‚àº N gt+1 |¬µg , Œ£g Œ£0g has

Laplace transform E [exp (u0 gt+1 )] = exp ¬µ0g u + 21 u0 Œ£g Œ£0g u for any real (G √ó 1) vector u. Consider
0
a (G + H) √ó 1 vector xt+1 = (h0t+1 , gt+1
)0 where ht+1 is an H √ó 1 vector having a multivariate NCG
21

This is defined as IŒª (x) =


x Œª
2

P‚àû

1
z=0 Œì(Œª+z+1)z!



x2
4

46

z

, see Abramowitz and Stegun(1964).

distribution p (ht+1 |ŒΩh , Œ¶h ht , Œ£h , ¬µh ) and gt+1 is a G √ó 1 vector of conditionally Gaussian r.v. gt+1 ‚àº

N ¬µg + Œ£gh ht+1 , Œ£g Œ£0g . Let u = (u0h , u0g )0 where uh and ug are H √ó 1 and G √ó 1 vectors, respectively. Using
the law of iterated expectations, the Laplace transform is

E [exp (u0 xt+1 )]








= E exp u0g gt+1 exp (u0h ht+1 ) = Eh Eg|h exp u0g gt+1 exp (u0h ht+1 )




1
= Eh exp (¬µg + Œ£gh ht+1 )0 ug + u0g Œ£g Œ£0g ug exp (u0h ht+1 )
2






1
= exp u0g ¬µg + u0g Œ£g Œ£0g ug Eh exp u0g Œ£gh + u0h ht+1
2
=

H
X
1
exp u0g ¬µg + u0g Œ£g Œ£0g ug + u0gh ¬µh ‚àí
ŒΩh,i log (1 ‚àí e0i Œ£0h ugh )
2
i=1
!
H
0 0
X
ei Œ£h ugh 0 ‚àí1
e Œ£ Œ¶h (ht ‚àí ¬µh )
+
1 ‚àí e0i Œ£0h ugh i h
i=1

where ugh = Œ£0gh ug +uh is an H √ó1 vector. The Laplace transform exists only if e0i Œ£0h ugh < 1 for i = 1, . . . , H.
This is the key expression for solving for closed-form zero-coupon bond prices.

Appendix B

Bond pricing



Bond prices can be solved by induction. Guess that bond prices are Ptn = exp aÃÑn + bÃÑ0n,h ht + bÃÑ0n,g gt for
0
some coefficients aÃÑn , bÃÑn,h , and bÃÑn,g . At maturity n = 1 when the payoff is Pt+1
= 1, we find

Pt1

=




0
0
0
EQ
= exp ‚àíŒ¥0 ‚àí Œ¥1,h
ht ‚àí Œ¥1,g
gt
t exp (‚àírt ) Pt+1

such that aÃÑ1 = ‚àíŒ¥0 , bÃÑ1,g = ‚àíŒ¥1,g and bÃÑ1,h = ‚àíŒ¥1,h . Next, consider an n-period bond whose price in the next
n‚àí1
period is Pt+1
. We find

Ptn






n‚àí1
0
0
0
0
EQ
= EQ
t exp (‚àírt ) Pt+1
t exp ‚àíŒ¥0 ‚àí Œ¥1,h ht ‚àí Œ¥1,g gt exp aÃÑn‚àí1 + bÃÑn‚àí1,h ht+1 + bÃÑn‚àí1,g gt+1



0
0
0
0
= exp ‚àíŒ¥0 ‚àí Œ¥1,h
ht ‚àí Œ¥1,g
gt + aÃÑn‚àí1 EQ
t exp bÃÑn‚àí1,h ht+1 + bÃÑn‚àí1,g gt+1

=

0
where the expectation is taken with respect to the distribution of the random vector xt+1 = h0t+1 , gt+1

ht+1
gt+1



Q
Q
‚àº Mult-NCG ŒΩh,i
, Œ¶Q
h ht , Œ£h , ¬µh

h

i

Q
Q
Q
Q
Q
Q
0
‚àº N ¬µQ
+
Œ¶
g
+
Œ¶
h
+
Œ£
h
‚àí
(I
‚àí
Œ¶
)¬µ
+
Œ£
ŒΩ
+
Œ¶
h
,
Œ£
Œ£
gh
t+1
H
h
h h
g,t g,t
g
g t
gh t
h
h t

47

0

This expectation has the same form as the Laplace transform provided in Appendix A. We find

Ptn



=

1
0
0
exp ‚àíŒ¥0 ‚àí Œ¥1,g
gt ‚àí Œ¥1,h
ht + aÃÑn‚àí1 + b0n‚àí1,g Œ£g,t Œ£0g,t bÃÑn‚àí1,g
2
h

i0
Q
Q
Q
Q
Q
+ ¬µQ
+
Œ¶
g
+
Œ¶
h
‚àí
Œ£
(I
‚àí
Œ¶
)¬µ
+
Œ£
ŒΩ
+
Œ¶
h
bÃÑn‚àí1,g
gh
H
h
h h
g
g t
gh t
h
h t
!
H
X

e0i Œ£0h bÃÑn‚àí1,gh 0 ‚àí1 Q
Q
0 0
e Œ£ Œ¶ [ht ‚àí ¬µh ] ‚àí
ŒΩh,i log 1 ‚àí ei Œ£h bÃÑn‚àí1,gh
1 ‚àí e0i Œ£0h bÃÑn‚àí1,gh i h h
i=1
i=1

h
i
Q0 0
Q0 0 0
0
exp ‚àíŒ¥0 + aÃÑn‚àí1 + ¬µQ0
g bÃÑn‚àí1,g + ¬µh bn‚àí1,h + Œ¶h Œ£gh bÃÑn‚àí1,g ‚àí ŒΩh Œ£h Œ£gh bÃÑn‚àí1,g
H
X

0
+ Œ£0gh bÃÑn‚àí1,g + bn‚àí1,h ¬µh +

=

H
H
X
 X
1 0
e0i Œ£0h bÃÑn‚àí1,gh 0 ‚àí1 Q
Q
0
0 0
e Œ£ Œ¶ ¬µh
+ bn‚àí1,g Œ£0,g Œ£0,g bÃÑn‚àí1,g ‚àí
ŒΩh,i log 1 ‚àí ei Œ£h bÃÑn‚àí1,gh ‚àí
2
1 ‚àí e0i Œ£0h bÃÑn‚àí1,gh i h h
i=1
i=1


0
+ bÃÑ0n‚àí1,g Œ¶Q
g ‚àí Œ¥1,g gt
"H


X e0 Œ£0 bÃÑn‚àí1,gh
Q
Q
Q
i h
0
0
e0i Œ£‚àí1
+
h Œ¶h + bÃÑn‚àí1,g Œ¶gh ‚àí Œ£gh Œ¶h ‚àí Œ¥1,h
0
0
1
‚àí
e
Œ£
bÃÑ
i h n‚àí1,gh
i=1
 
0

1
+ IH ‚äó bÃÑn‚àí1,g Œ£g Œ£0g ŒπH ‚äó bÃÑn‚àí1,g ht
2

where Œ£g Œ£0g is a GH √óGH matrix with diagonal elements Œ£i,g Œ£0i,g for i = 1, . . . , H and bÃÑn‚àí1,gh = Œ£0gh bÃÑn‚àí1,g +
bÃÑn‚àí1,h . The Laplace transform exists only if e0i Œ£0h bÃÑn‚àí1,gh < 1 for i = 1, . . . , H.

Appendix C

Factor rotations

Appendix C.1

Proof of Proposition 1

The admissibility restrictions needed to keep ht positive are: (1.) Chg = 0; (2.) Chh is such that all elements
Chh Œ£h are non-negative; (3.) ch is such that ch + Chh ¬µh is non-negative; (4.) Chh and Cgg are full rank.
For some values of Œ∏, these restrictions may allow ch and Chh to be negative.

0
0
Under these restrictions, the process hÃÉ0t , gÃÉt0 is a member of the same family of distributions as (h0t , gt0 )
only under a new parameters Œ∏ÃÉ. The proof is immediate by comparing the Laplace transform of these random
variables before and after rotating them. The mapping between the parameters Œ∏ÃÉ and Œ∏ is

¬µÃÉh = ch + Chh ¬µh

‚àí1
Œ¶ÃÉh = Chh Œ¶h Chh

Œ£ÃÉh = Chh Œ£h

‚àí1
Œ¶ÃÉg = Cgg Œ¶g Cgg

 ‚àí1
‚àí1
‚àí1
¬µÃÉg = cg + Cgg ¬µg ‚àí Cgg Œ¶g Cgg
cg + Cgh ([IH ‚àí Œ¶h ] ¬µh + Œ£h ŒΩh ) ‚àí Cgh Œ¶h ‚àí Cgg Œ¶g Cgg
Cgh + Cgg Œ¶gh Chh
ch
Œ¶ÃÉgh =

 ‚àí1
‚àí1
Cgh Œ¶h ‚àí Cgg Œ¶g Cgg
Cgh + Cgg Œ¶gh Chh

48

‚àí1
Œ£ÃÉgh = (Cgh + Cgg Œ£gh ) Chh

0
Œ£ÃÉ0,g Œ£ÃÉ00,g = Cgg Œ£0,g Œ£00,g Cgg
‚àí

H
X

0 0 ‚àí1
Cgg Œ£i,g Œ£0i,g Cgg
ei Chh ch

Œ£ÃÉi,g Œ£ÃÉ0i,g =

i=1

H
X

0 0 ‚àí1
Cgg Œ£j,g Œ£0j,g Cgg
ej Chh ei

j=1



Appendix D

Stochastic discount factor

We define the stochastic discount factor as

Mt+1

exp (‚àírt ) p (gt+1 |It , ht+1 , zt+1 ; Œ∏, Q) p (ht+1 |It , zt+1 ; Œ∏, Q) p (zt+1 |It ; Œ∏, Q)
p (gt+1 |It , ht+1 , zt+1 ; Œ∏, P) p (ht+1 |It , zt+1 ; Œ∏, P) p (zt+1 |It ; Œ∏, P)

=

where the distributions are Gaussian, gamma, and Poisson. The exact SDF is

Mt+1



PH 0 ‚àí1 Q
Q
exp ‚àírt ‚àí 21 ŒµQ0
g,t+1 Œµg,t+1 ‚àí
i=1 ei Œ£h Œ¶h [ht ‚àí ¬µh ]


=
PH
exp ‚àí 12 Œµ0g,t+1 Œµg,t+1 ‚àí i=1 e0i Œ£‚àí1
h Œ¶h [ht ‚àí ¬µh ]
!zi,t+1
H
Q
Q
Y
e0i Œ£‚àí1
Œ¶
[h
‚àí
¬µ
]
ŒΩh,i
‚àíŒΩh,i Œì (ŒΩh,i + zi,t+1 )
t
h
h
h


wi,t+1
0 Œ£‚àí1 Œ¶ [h ‚àí ¬µ ]
Q
e
h
t
h
Œì
ŒΩ
+
z
i
h
i=1
i,t+1
h,i

‚àí1
where Œµg,t+1 = Œ£‚àí1
g,t (gt+1 ‚àí ¬µg ‚àí Œ¶g gt ‚àí Œ¶gh ht ‚àí Œ£gh Œµh,t+1 ) and wt+1 = Œ£h [ht+1 ‚àí ¬µh ]. No arbitrage

requires that Mt+1 > 0 which implies that wt+1 > 0. The Feller conditions ŒΩh > 1 and ŒΩhQ > 1 guarantee
that wt+1 > 0 under both probability measures.
For intuition, break the log-SDF mt+1 = log (Mt+1 ) into three terms; one for each of the shocks

mt+1

= ‚àírt + mg,t+1 + mh,t+1 + mz,t+1

Q
Q
Q
where mi,t+1 is the compensation for risk i. Let Œªg = ¬µg ‚àí ¬µQ
g , Œªh = ŒΩh ‚àí ŒΩh , Œõg = Œ¶g ‚àí Œ¶g , Œõh = Œ¶h ‚àí Œ¶h ,

and Œõgh = Œ¶gh ‚àí Œ¶Q
gh .
For the Gaussian part, we find mg,t+1 = ‚àí 21 Œª0gt Œªgt ‚àí Œª0gt g,t+1 where g,t+1 = Œ£‚àí1
g,t Œµg,t+1 is a standard,
zero mean Gaussian shock. The price of Gaussian risk is

Œªgt

=

Œ£‚àí1
g,t {(Œªg + Œõg gt + Œõgh ht ) ‚àí Œ£gh [Œ£h Œªh + Œõh (ht ‚àí ¬µh )]}

This generalizes the expression for Gaussian ATSMs, with a time-varying quantity of risk Œ£g,t .

49

Recall that wt+1 = Œ£‚àí1
h (ht+1 ‚àí ¬µh ). We will write risk compensation in terms of wt+1 .

mh,t+1

=

H
X


 


Q
Q
0 ‚àí1
‚àí log Œì ŒΩh,i
+ zi,t+1 + ŒΩh,i
+ zi,t+1 ‚àí 1 log e0i Œ£‚àí1
h (ht+1 ‚àí ¬µh ) ‚àí ei Œ£h (ht+1 ‚àí ¬µh )

i=1
H
X


0 ‚àí1
log Œì (ŒΩh,i + zi,t+1 ) ‚àí (ŒΩh,i + zi,t+1 ‚àí 1) log e0i Œ£‚àí1
h (ht+1 ‚àí ¬µh ) + ei Œ£h (ht+1 ‚àí ¬µh )

i=1

=

‚âà

Ô£∂

Ô£´

H
X



Œì (ŒΩh,i + zi,t+1 ) Ô£∏ 
Q
 ‚àí ŒΩh,i ‚àí ŒΩh,i
log e0i Œ£‚àí1
(ht+1 ‚àí ¬µh )
log Ô£≠ 
h
Q
Œì ŒΩh,i
+ zi,t+1
i=1

H
X

H


X
ŒΩ ‚àíŒΩ Q
log [ŒΩh,i + zi,t+1 ] h,i h,i ‚àí Œªh,i log (wi,t+1 ) =
‚àíŒªh,i [log (wi,t+1 ) ‚àí log (ŒΩh,i + zi,t+1 )]

i=1

=

i=1


 
H
X
Œªh,i
wi,t+1 ‚àí ŒΩh,i ‚àí zi,t+1
wi,t+1 ‚àí ŒΩh,i ‚àí zi,t+1
‚âà
‚àí‚àö
‚àíŒªh,i log 1 +
‚àö
ŒΩ
+
z
ŒΩ
+
z
ŒΩh,i + zi,t+1
h,i
i,t+1
h,i
i,t+1
i=1
i=1

H
X

The compensation for gamma risks is approximately mh,t+1 ‚âà ‚àíŒª0wt w,t+1 where w,t+1,i =

wi,t+1 ‚àíŒΩh,i ‚àízi,t+1
‚àö
ŒΩi +zi,t+1

is a gamma r.v. standardized to have mean 0 and variance 1.22 The market price of risk is Œªwt,i =
Œªh,i
.
ŒΩh,i +zi,t+1

‚àö

We note that V (wit |zt ) = ŒΩh,i + zi,t .

Consider the non-Gaussian part due to the Poisson distribution

mz,t+1

=

H
X



Q
Q
zi,t+1 log e0i Œ£‚àí1
Œ¶
(h
‚àí
¬µ
)
‚àí log (zi,t+1 !) ‚àí e0i Œ£‚àí1
t
h
h
h
h Œ¶h (ht ‚àí ¬µh )

i=1


0 ‚àí1
‚àízi,t+1 log e0i Œ£‚àí1
h Œ¶h (ht ‚àí ¬µh ) + log (zi,t+1 !) + ei Œ£h Œ¶h (ht ‚àí ¬µh )


H
X
e0i Œ£‚àí1
h Œõh Œ£h wt
+ e0i Œ£‚àí1
=
zi,t+1 log 1 ‚àí 0 ‚àí1
h Œõh Œ£h wt
e
Œ£
Œ¶
Œ£
w
h
h
t
i
h
i=1
H
X

e0i Œ£‚àí1
h Œõh Œ£h wt
+ e0i Œ£‚àí1
h Œõh Œ£h wt
0 Œ£‚àí1 Œ¶ Œ£ w
e
h h t
i h
i=1


H
H
X
X
e0i Œ£‚àí1
zi,t+1 ‚àí e0i Œ£‚àí1
h Œõh Œ£h wt
h Œ¶h Œ£h wt
q
=
‚àí
z,t+1,i
=
‚àíe0i Œ£‚àí1
Œõ
Œ£
w
h
h
t
h
‚àí1
0
ei Œ£h Œ¶h Œ£h wt
e0 Œ£‚àí1 Œ¶ Œ£ w
i=1
i=1

‚âà

‚àízi,t+1

i

The log SDF is mz,t+1 ‚âà ‚àíŒª0zt z,t+1 where z,t+1 =
e0i Œ£‚àí1
h Œõh Œ£h wt
e0i Œ£‚àí1
h Œ¶h Œ£h wt

mean 0 and variance 1 and Œªzt,i = ‚àö
22

Our derivation uses the approximation that
that log(1 + x) = x for small x.

zi,t+1 ‚àíe0i Œ£‚àí1
h Œ¶h Œ£h wt

‚àö

e0i Œ£‚àí1
h Œ¶h Œ£h wt

h

h

h

t

is Poisson r.v. standardized to have

.

Œì(a+x)
Œì(b+x)

50

‚àù xa‚àíb 1 + O

1
x



for large x. We also use the fact

Appendix E

Log-likelihood for spanned models

Dropping the initial condition, the conditional log-likelihood for the general affine model is given by
T

`(Œ∏)

CONST ‚àí (T ‚àí 1) log |B1 | ‚àí

=

T

 1X
T ‚àí1
1X
log |‚Ñ¶| ‚àí
tr ‚Ñ¶‚àí1 Œ∑t Œ∑t0 ‚àí
log Œ£g,t‚àí1 Œ£0g,t‚àí1
2
2 t=2
2 t=2

T


‚àí1
1X 
‚àí
tr Œ£g,t‚àí1 Œ£0g,t‚àí1
Œµgt Œµ0gt
2 t=2
‚àí(T ‚àí 1) log|Œ£h | ‚àí

T X
H
X

e0i Œ£‚àí1
h (ht ‚àí ¬µh ) ‚àí

t=2 i=1

T X
H
X

e0i Œ£‚àí1
h Œ¶h (ht‚àí1 ‚àí ¬µh )

t=2 i=1
T X
H
X

T X
H
X



(ŒΩh,i ‚àí 1)
(ŒΩh,i ‚àí 1)
log e0i Œ£‚àí1
log e0i Œ£‚àí1
h [ht ‚àí ¬µh ] ‚àí
h Œ¶h [ht‚àí1 ‚àí ¬µh ]
2
2
t=2 i=1
t=2 i=1


H
T X
q
X
 0 ‚àí1

‚àí1
0
log IŒΩh,i ‚àí1 2 ei Œ£h [ht ‚àí ¬µh ] ei Œ£h Œ¶h [ht‚àí1 ‚àí ¬µh ]
+
+

t=2 i=1

where IŒª (x) is the modified Bessel function of the first kind and ei is the H √ó 1 unit vector.

Appendix F

Proofs and Analytical Derivatives

In this appendix, we prove the propositions in the paper. We begin with a preliminary lemma.
Lemma 1 The derivative of the concentrated log-likelihood function can be computed as the partial derivative
‚àÇ`(Œ∏ÃÇc ,Œ∏m )
d`(Œ∏ÃÇc (Œ∏m ),Œ∏m )
= ‚àÇŒ∏0
, where Œ∏ÃÇc (Œ∏m ) = arg max ` (Œ∏c , Œ∏m )
of the log-likelihood function:
dŒ∏ 0
m

Proof:

d`(Œ∏ÃÇc (Œ∏m ),Œ∏m )
0
dŒ∏m

=

‚àÇ`(Œ∏ÃÇc ,Œ∏m )
0
‚àÇŒ∏m

+

m

Œ∏c

‚àÇ`(Œ∏c ,Œ∏m )
c (Œ∏m )
|Œ∏c =Œ∏ÃÇc dŒ∏ÃÇdŒ∏
0
‚àÇŒ∏c0
m

=

‚àÇ`(Œ∏ÃÇc ,Œ∏m )
,
0
‚àÇŒ∏m

where

‚àÇ`(Œ∏c ,Œ∏m )
|Œ∏c =Œ∏ÃÇc
‚àÇŒ∏c0

= 0 by the

definition of Œ∏ÃÇc . 

Appendix F.1

Proof of Proposition 2

Proof First, we show that optimizing the original likelihood and optimizing the concentrated likelihood
c ,Œ∏m )
lead to equivalent solutions. Solving max ` (Œ∏) requires ‚àÇ`(Œ∏
= 0 and ‚àÇ`(Œ∏‚àÇŒ∏m0,Œ∏c ) = 0. The solution
0
‚àÇŒ∏m
c
Œ∏


d`(Œ∏ÃÇc (Œ∏m ),Œ∏m )
‚àÇ`(Œ∏ÃÇc ,Œ∏m )
to max ` Œ∏ÃÇc (Œ∏m ) , Œ∏m has the property
= 0. By Lemma 1,
= 0. This with
dŒ∏ 0
‚àÇŒ∏ 0

Œ∏m
‚àÇ`(Œ∏c ,Œ∏m )
|Œ∏c =Œ∏ÃÇc
‚àÇŒ∏c0

m

m

= 0 by the definition of Œ∏ÃÇc constitute the two F.O.C.‚Äôs for the original problem.

Second, showing Œ∏ÃÇc can be solved by least squares given Œ∏m is straightforward. A value for Œ∏m maps
into a value for the loadings A and B though (9)-(10), and therefore xt by (16). Given the factors, equation

51

(11) is a linear regression with heteroskedasticity, hence GLS. Given yields, factors and bond loadings, ‚Ñ¶ in
equation (17) is the variance-covariance matrix in a linear regression with homoskedasticity, hence OLS. 

Appendix F.2

Proof of Proposition 3

We use the result in Lemma 1 to derive the gradients for the concentrated log likelihood based on the original
log-likelihood, which makes the derivation easier.
d` Œ∏ÃÇ (Œ∏ ),Œ∏ ,A(Œ∏ ),B(Œ∏m ))
Proof A direct result of Lemma 1 is ( c m mdŒ∏m0 m
=

‚àÇ`(Œ∏ÃÇc ,Œ∏m ,A(Œ∏m ),B(Œ∏m ))
.
0
‚àÇŒ∏m

Applying the chain

rule,


‚àÇ` Œ∏ÃÇc , Œ∏m , A (Œ∏m ) , B (Œ∏m )
0
‚àÇŒ∏m



‚àÇ` Œ∏ÃÇc , Œ∏m , A, B



‚àÇ` Œ∏ÃÇc , Œ∏m , A, B ‚àÇA (Œ∏ )
m
=
+
0
0
‚àÇŒ∏m
‚àÇA0
‚àÇŒ∏m



‚àÇ` Œ∏ÃÇc , Œ∏m , A, B ‚àÇvec B (Œ∏m )0
+
.
0
0
‚àÇŒ∏m
‚àÇvec (B 0 )



Appendix F.3

Gradients

We now provide the analytical gradient. Note that Œ∏ÃÇc = (¬µÃÇg , Œ¶ÃÇg , Œ¶ÃÇgh , ‚Ñ¶ÃÇ) are optimized by Œ∏ÃÇc = argmax ` (Œ∏c , Œ∏m )
Œ∏c
q
 0 ‚àí1

‚àí1
‚àí1
0
detailed in Proposition 2. Let hÃÉit = 2 ei Œ£h [ht ‚àí ¬µh ] ei Œ£h Œ¶h [ht‚àí1 ‚àí ¬µh ] , hÃÇt = Œ£h (ht ‚àí ¬µh ), and
ÀÜ
hÃÇt‚àí1 = Œ£‚àí1
h Œ¶h (ht‚àí1 ‚àí ¬µh ). The matrices Sg and Sh extract the Gaussian gt = Sg xt and non-Gaussian
factors ht = Sh xt from xt .
‚àÇ`
‚àÇŒΩh,i

= ‚àí

‚àÇ`
0
‚àÇvec (Œ¶h )

= ‚àí

T
X

Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1

t=2
T
X

‚àí1

T

1X
Œ£gh Œ£h ei +
log
2 t=2

e0i hÃÇt
ÀÜ
e0i hÃÇt‚àí1

!
+

T
X

1

 
‚àÇIŒΩh,i ‚àí1 hÃÉit

t=2

 
IŒΩh,i ‚àí1 hÃÉit

‚àÇŒΩh,i


0
‚àí1
vec Œ£0gh Œ£g,t‚àí1 Œ£0g,t‚àí1
Œµgt h0t‚àí1

t=2
T X
H

0 X

0
(ŒΩh,i ‚àí 1)
‚àí1
‚àí1
0
0
vec (Œ£0h ) ei (ht‚àí1 ‚àí ¬µh ) ‚àí
vec (Œ£0h ) ei (ht‚àí1 ‚àí ¬µh )
0ÀÜ
t=2 i=1
t=2 i=1 2ei hÃÇt‚àí1
  Ô£π
Ô£Æ
T X
H

0
IŒΩh,i hÃÉit
X
2e0 hÃÇ
Ô£∞ (ŒΩh,i ‚àí 1) +
  Ô£ª i t vec (Œ£0h )‚àí1 ei (ht‚àí1 ‚àí ¬µh )0
+
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1

‚àí

T X
H
X

where we have used

‚àÇIŒª (x)
‚àÇx

=

Œª
x IŒª (x)

+ IŒª+1 (x), see, Abramowitz and Stegun(1964). The derivative

‚àÇIŒª (x)
‚àÇŒª

is a complicated expression that is easier to compute numerically. The derivatives for parameters entering

52

the loadings are calculated by the chain rule. Take derivatives of ` w.r.t. the loadings A1 , A2 , B1 and B2 .
Then, take derivatives of the loadings w.r.t. the parameters.
‚àÇvec (B 0 )
‚àÇ` ‚àÇA
‚àÇ`
‚àÇ`
=
+
0
0
0
0
0
‚àÇŒ¥1,g
‚àÇA ‚àÇŒ¥1,g ‚àÇvec (B 0 ) ‚àÇŒ¥1,g

‚àÇ`
‚àÇ` ‚àÇA
=
‚àÇŒ¥0
‚àÇA0 ‚àÇŒ¥0
‚àÇ`
‚àÇŒΩhQ0

=

‚àÇ` ‚àÇA
‚àÇA0 ‚àÇŒΩhQ0

‚àÇ`
‚àÇ¬µQ0
g

=

‚àÇvec (B 0 )
‚àÇ`
‚àÇ` ‚àÇA
‚àÇ`
=
+
0
0
0
0
0
‚àÇŒ¥1,h
‚àÇA ‚àÇŒ¥1,h ‚àÇvec (B 0 ) ‚àÇŒ¥1,h

‚àÇ`
‚àÇ`
‚àÇvec (B 0 )
‚àÇ`
‚àÇA
 0 =
 0 +
 0
0
0
0
‚àÇA ‚àÇvec Œ¶Q
‚àÇvec (B ) ‚àÇvec Œ¶Q
‚àÇvec Œ¶Q
g
g
g

‚àÇ` ‚àÇA
‚àÇA0 ‚àÇ¬µQ0
g

‚àÇ`
‚àÇA
‚àÇvec (B 0 )
‚àÇ`
‚àÇ`
+

0 =



0
0
‚àÇA0 ‚àÇvec Œ¶Q 0
‚àÇvec (B 0 ) ‚àÇvec Œ¶Q
‚àÇvec Œ¶Q
gh
gh
gh
‚àÇA
‚àÇvec (B 0 )
‚àÇ`
‚àÇ`
‚àÇ`
+
 0 =

 0

0
‚àÇA0 ‚àÇvec Œ¶Q 0
‚àÇvec (B 0 ) ‚àÇvec Œ¶Q
‚àÇvec Œ¶Q
h
h
h
The derivatives of the remaining parameters that enter both the loadings and the P dynamics are
‚àÇ`
‚àÇ` ‚àÇA
d`
=
+
0
0
d¬µh
‚àÇ¬µh
‚àÇA0 ‚àÇ¬µ0h

d`
0
dvec (Œ£h )
d`
0
dvec (Œ£gh )
d`
0
dvech (Œ£i,g )

‚àÇ`
0
‚àÇvec (Œ£h )

= ‚àí

T
X

=
=
=

d`
‚àÇ`
‚àÇ`
‚àÇA
0 =
0 +
0
‚àÇA ‚àÇvech (Œ£0,g )0
dvech (Œ£0,g )
‚àÇvech (Œ£0,g )

‚àÇ`
‚àÇ`
‚àÇ`
‚àÇvec (B 0 )
‚àÇA
+
0 +
0
0
0
‚àÇA0 ‚àÇvec (Œ£h )
‚àÇvec (Œ£h )
‚àÇvec (B 0 ) ‚àÇvec (Œ£h )
‚àÇ`
‚àÇ`
‚àÇA
‚àÇ`
‚àÇvec (B 0 )
+
+
0
0
0
‚àÇA0 ‚àÇvec (Œ£gh )0
‚àÇvec (Œ£gh )
‚àÇvec (B 0 ) ‚àÇvec (Œ£gh )
‚àÇ`
‚àÇ`
d`
‚àÇvec (B 0 )
‚àÇA
+
+
0
0
0
‚àÇA0 ‚àÇvech (Œ£i,g )0
‚àÇvech (Œ£i,g )
‚àÇvec (B 0 ) ‚àÇvech (Œ£i,g )


0

‚àí1
0 0
vec Œ£0gh Œ£g,t‚àí1 Œ£0g,t‚àí1
Œµgt ŒΩh0 ‚àí (T ‚àí 1)vec Œ£‚àí1
h

t=2

+

T X
H
X

vec



T X
H
0 X

0
 0 ÀÜ 0 0
Œ£‚àí1
ei hÃÇ0t +
vec Œ£‚àí1
ei hÃÇt‚àí1
h
h

t=2 i=1
T X
H
X
(ŒΩh,i ‚àí 1)

t=2 i=1

T X
H
0 X

0
0 ÀÜ 0 0
(ŒΩh,i ‚àí 1)
0
vec Œ£‚àí1
e
hÃÇ
+
vec Œ£‚àí1
ei hÃÇt‚àí1
‚àí
i t
h
h
0ÀÜ
2e0i hÃÇt
t=2 i=1
t=2 i=1 2ei hÃÇt‚àí1
  Ô£π
Ô£Æ
T X
H

hÃÉit
I
X
ŒΩ
0 ÀÜ 0 0
h,i
2e0 hÃÇ
Ô£∞ (ŒΩh,i ‚àí 1) +
  Ô£ª i t vec Œ£‚àí1
‚àí
ei hÃÇt‚àí1
h
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1
  Ô£π
Ô£Æ
T X
H
ÀÜ

0
IŒΩh,i hÃÉit
X
0
2e0 hÃÇ
(ŒΩ
‚àí
1)
0
Ô£∞ h,i
  Ô£ª i t‚àí1 vec Œ£‚àí1
‚àí
+
e
hÃÇ
i
t
h
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1



53

‚àÇ`
0
‚àÇvec (Œ£gh )

T
X

=

vec



Œ£g,t‚àí1 Œ£0g,t‚àí1

‚àí1

Œµgt Œµ0ht

0

t=2

T
h
i
0
X
‚àí1
‚àí1
‚àÇ`
0
0
0
L
=
vec
Œµ
Œµ
‚àí
I
Œ£
Œ£
Œ£
Œ£
Œ£
DG
gt
G
0,g
g,t‚àí1
g,t‚àí1
gt
g,t‚àí1
g,t‚àí1
0
‚àÇvech (Œ£0,g )
t=2
T
0
h
i
X
‚àí1
‚àí1
‚àÇ`
0
0
0
L
=
Œµ
Œµ
Œ£
h
DG
vec
Œ£
Œ£
‚àí
I
Œ£
Œ£
gt gt
i,g i,t‚àí1
g,t‚àí1 g,t‚àí1
G
g,t‚àí1 g,t‚àí1
0
‚àÇvech (Œ£i,g )
t=2

‚àÇ`
‚àÇ¬µ0h

= ‚àí

T
X

Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1

‚àí1

Œ£gh (IH ‚àí Œ¶h ) +

T X
H
X

t=2

‚àí

e0i Œ£‚àí1
h +

t=2 i=1

T X
H
X
(ŒΩh,i ‚àí 1)

2e0i hÃÇt

t=2 i=1

e0i Œ£‚àí1
h +

T X
H
X
(ŒΩh,i ‚àí 1)

ÀÜ
2e0i hÃÇt‚àí1

t=2 i=1

T X
H
X

e0i Œ£‚àí1
h Œ¶h

t=2 i=1

e0i Œ£‚àí1
h Œ¶h

  Ô£π
T X
H
i
I
hÃÉit
X
ŒΩ
h,i
2 h 0 0 ‚àí1
ÀÜ
Ô£∞ (ŒΩh,i ‚àí 1) +
 Ô£ª
ei hÃÇt ei Œ£h Œ¶h + e0i hÃÇt‚àí1 e0i Œ£‚àí1
‚àí
h
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1
Ô£Æ

T
X
‚àÇ`
Œ∑t0 ‚Ñ¶‚àí1
=
‚àÇA02
t=2

‚àÇ`
‚àÇA01

=

T h
X

T
X

‚àÇ`
0 ‚àí1 0
vec
x
Œ∑
‚Ñ¶
=
t
t
0
‚àÇvec (B20 )
t=2

‚àíŒ∑t0 ‚Ñ¶‚àí1 B2 B1‚àí1 + Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1

‚àí1

[(IG ‚àí Œ¶g ) Sg ‚àí (Œ¶gh + Œ£gh ‚àí Œ£gh Œ¶h ) Sh ] B1‚àí1

t=2
H


‚àí1 h
‚àí1 i0 X

1
IG ‚àí Œµgt Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1
vec Œ£i,g Œ£0i,g Shi B1‚àí1
+ vec Œ£g,t‚àí1 Œ£0g,t‚àí1
2
i=1
+

T X
H
X

‚àí1
e0i Œ£‚àí1
h Sh B1 ‚àí

t=2 i=1

+

T X
H
X

T X
H
X
(ŒΩh,i ‚àí 1)
t=2 i=1

‚àí1
e0i Œ£‚àí1
h Œ¶h Sh B1 +

t=2 i=1

2e0i hÃÇt

‚àí1
e0i Œ£‚àí1
h Sh B1

T X
H
X
(ŒΩh,i ‚àí 1)
t=2 i=1

ÀÜ
2e0i hÃÇt‚àí1

‚àí1
e0i Œ£‚àí1
h Œ¶h Sh B1

  Ô£π
T X
H
ÀÜ
IŒΩh,i hÃÉit
X
(ŒΩ
‚àí
1)
2e0 hÃÇ
‚àí1
Ô£∞ h,i
  Ô£ª i t‚àí1 e0i Œ£‚àí1
‚àí
+
h Sh B1
hÃÉ
hÃÉ
it
it
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1
  Ô£π
Ô£Æ
T X
H
I
X
ŒΩh,i hÃÉit
2e0 hÃÇ
‚àí1
Ô£∞ (ŒΩh,i ‚àí 1) +
  Ô£ª i t e0i Œ£‚àí1
‚àí
h Œ¶h Sh B1
hÃÉ
hÃÉ
it
it
I
hÃÉ
t=2 i=1
ŒΩh,i ‚àí1
it
Ô£Æ

54

‚àÇ`
0
‚àÇvec (B10 )

= ‚àí(T ‚àí 1)vec B1‚àí1

0

+

T h
X

‚àívec xt Œ∑t0 ‚Ñ¶‚àí1 B2 B1‚àí1

0

t=2

+vec



xt Œµ0gt

‚àí1
Œ£g,t‚àí1 Œ£0g,t‚àí1

(Sg ‚àí Œ£gh Sh ) B1‚àí1

0

0

‚àí1
(Œ¶g Sg + [Œ¶gh ‚àí Œ£gh Œ¶h ] Sh ) B1‚àí1
‚àívec xt‚àí1 Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1
H


‚àí1 i0 X

‚àí1 h

1
IG ‚àí Œµgt Œµ0gt Œ£g,t‚àí1 Œ£0g,t‚àí1
vec Œ£i,g Œ£0i,g Shi B1‚àí1 ‚äó x0t‚àí1
+ vec Œ£g,t‚àí1 Œ£0g,t‚àí1
2
i=1
+

T X
H
X

‚àí1
vec xt e0i Œ£‚àí1
h Sh B1

0

‚àí

t=2 i=1

+

T X
H
X
(ŒΩh,i ‚àí 1)
t=2 i=1

T X
H
X

‚àí1
vec xt‚àí1 e0i Œ£‚àí1
h Œ¶h Sh B1

0

+

t=2 i=1

2e0i hÃÇt

T X
H
X
(ŒΩh,i ‚àí 1)
t=2 i=1



Ô£Æ

‚àí1
vec xt e0i Œ£‚àí1
h Sh B1

ÀÜ
2e0i hÃÇt‚àí1

0

‚àí1
vec xt‚àí1 e0i Œ£‚àí1
h Œ¶h Sh B1

0

 Ô£π

T X
H
ÀÜ
IŒΩh,i hÃÉit
X

2e0 hÃÇ
‚àí1 0
Ô£∞ (ŒΩh,i ‚àí 1) +
  Ô£ª i t‚àí1 vec xt e0i Œ£‚àí1
h S h B1
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1
  Ô£π
Ô£Æ
T X
H
IŒΩh,i hÃÉit
X

2e0 hÃÇ
‚àí1 0
Ô£∞ (ŒΩh,i ‚àí 1) +
  Ô£ª i t vec xt‚àí1 e0i Œ£‚àí1
‚àí
h Œ¶h Sh B1
hÃÉit
hÃÉit
IŒΩh,i ‚àí1 hÃÉit
t=2 i=1

‚àí

The derivatives of A and B w.r.t. the parameters can be computed recursively as a function of maturity
along with aÃÑn , bÃÑn,g and bÃÑn,h . The derivatives of Bg and Bh have separate recursions. Let bÃÑn,g,œà denote
the derivatives of the Gaussian loadings bÃÑn,g at maturity n w.r.t. a parameter œà. All recursions are written
assuming that œà is a full vector/matrix of parameters with no restrictions. If the matrix has fewer parameters
than entries, the user will have to multiply the respective recursion by a selection matrix. Let d¬Øn‚àí1 =



Q0 Q0 ‚àí10 ¬Ø‚àí2
0
diag ŒπH ‚àí Œ£0h bÃÑn‚àí1,gh be a diagonal H √ó H matrix. Let cÃÑ0n‚àí1 = ŒΩ Q0 d¬Ø‚àí1
n‚àí1 ‚àí ¬µh Œ¶h Œ£h dn‚àí1 Œ£h be an
1 √ó H vector.

aÃÑ0n,¬µQ
g

= aÃÑ0n‚àí1,¬µQ + bÃÑ0n‚àí1,g
g

1√óG

aÃÑ0n,¬µh

0
¬Ø‚àí1 ‚àí1 Q
= aÃÑ0n‚àí1,¬µh + bÃÑ0n‚àí1,h + bÃÑ0n‚àí1,g Œ£gh Œ¶Q
h ‚àí bÃÑn‚àí1,gh Œ£h dn‚àí1 Œ£h Œ¶h

1√óH
aÃÑ0n,ŒΩ Q
h
1√óH


= aÃÑ0n‚àí1,ŒΩ Q ‚àí log Œπ0H ‚àí bÃÑ0n‚àí1,gh Œ£h ‚àí bÃÑ0n‚àí1,g Œ£gh Œ£h

aÃÑ0n,Œ£0,g

h

0 L
= aÃÑ0n‚àí1,Œ£0,g + vec bÃÑn‚àí1,g bÃÑ0n‚àí1,g Œ£0,g DG

1√óG(G+1)/2

aÃÑ0n,Œ¥1h

= aÃÑ0n‚àí1,Œ¥1h + ¬µ0h bÃÑn‚àí1,h,Œ¥1h + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ¥1h

1√óH

55

aÃÑ0n,Œ¶Q

gh

= aÃÑ0n‚àí1,Œ¶Q + ¬µ0h bÃÑn‚àí1,h,Œ¶Q + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ¶Q
gh

gh

gh

1√óGH

aÃÑ0n,Œ£i,g
1√óG(G+1)/2
aÃÑ0n,Œ¶Q

h
1√óH 2

= aÃÑ0n‚àí1,Œ£i,g + ¬µ0h bÃÑn‚àí1,h,Œ£i,g + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ£i,g

i = 1, . . . , H

= aÃÑ0n‚àí1,Œ¶Q + ¬µ0h bÃÑn‚àí1,h,Œ¶Q + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ¶Q
h

h

h

 0 0
¬Ø‚àí1 0
Œ£0gh bÃÑn‚àí1,g ‚àí Œ£‚àí10
h dn‚àí1 Œ£h bÃÑn‚àí1,gh ¬µh

+vec
aÃÑ0n,Œ£gh

i0
h

Q0 0
0
= aÃÑ0n‚àí1,Œ£gh + ¬µ0h bÃÑn‚àí1,h,Œ£gh + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ£gh + vec bÃÑn‚àí1,g ¬µ0h Œ¶Q0
‚àí
ŒΩ
Œ£
+
cÃÑ
h
n‚àí1
h
h

1√óGH
aÃÑ0n,Œ¥1g
1√óG

= aÃÑ0n‚àí1,Œ¥1g + ¬µ0h bÃÑn‚àí1,h,Œ¥1g + cÃÑ0n‚àí1 bÃÑn‚àí1,gh,Œ¥1g


Q0 0 0
0
0
0 Q0 0
+ ¬µQ0
g + ¬µh Œ¶h Œ£gh ‚àí ŒΩh Œ£h Œ£gh bÃÑn‚àí1,g,Œ¥1g + bÃÑn‚àí1,g Œ£0,g Œ£0,g bÃÑn‚àí1,g,Œ¥1g

aÃÑ0n,Œ¶Q
g
1√óG2

= aÃÑ0n‚àí1,Œ¶Q + ¬µ0h bÃÑn‚àí1,h,Œ¶Qg + cÃÑ0n‚àí1 dbÃÑn‚àí1,gh,Œ¶Qg
g



Q0 0 0
0 Q0 0
+ ¬µQ0
+ bÃÑ0n‚àí1,g Œ£0,g Œ£00,g bÃÑn‚àí1,g,Œ¶Qg
g + ¬µh Œ¶h Œ£gh ‚àí ŒΩh Œ£h Œ£gh bÃÑn‚àí1,g,Œ¶Q
g

0
0 Q0 ‚àí10
¬Ø‚àí1 0
= aÃÑ0n‚àí1,Œ£h + ¬µ0h bÃÑn‚àí1,h,Œ£h + cÃÑ0n‚àí1 bÃÑn‚àí1,h,Œ£h + vec Œ£‚àí10
h dn‚àí1 Œ£h bÃÑn‚àí1,gh ¬µh Œ¶h Œ£h

aÃÑ0n,Œ£h
1√óH(H+1)/2

‚àívec Œ£0gh bÃÑn‚àí1,g ŒΩh0

and

‚àÇvec(A)
‚àÇŒ¥0

0

+ vec bÃÑn‚àí1,gh cÃÑ0n‚àí1 Œ£‚àí10
h

0

= ŒπN and with bÃÑ1,g,Œ¥1g = ‚àíIG , bÃÑ1,h,Œ¥1h = ‚àíIH . All other initial conditions start at zero.

bÃÑn,g,Œ¥1g

=

Œ¶Q0
g bÃÑn‚àí1,g,Œ¥1g ‚àí IG

=

Œ¶Q0
+ IG ‚äó bÃÑ0n‚àí1,g
g bÃÑn‚àí1,g,Œ¶Q
g

=

‚àí10 ¬Ø‚àí2
0
Œ¶Q0
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ¥1h ‚àí IH

=

‚àí10 ¬Ø‚àí2
0
0
Œ¶Q0
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ¶Q + IH ‚äó bÃÑn‚àí1,g

G√óG

bÃÑn,g,Œ¶Qg



G√óG2

bÃÑn,h,Œ¥1h
H√óH

bÃÑn,h,Œ¶Q

gh

gh

H√óGH

=

0 L
‚àí10 ¬Ø‚àí2
0
0
Œ¶Q0
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ£gi + ei vec bÃÑn‚àí1,g bÃÑn‚àí1,g Œ£i,g DG

bÃÑn,h,Œ¶Q

=

‚àí10 ¬Ø‚àí2
0
0
0
¬Ø‚àí1 ‚àí1
Œ¶Q0
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ¶Q ‚àí IH ‚äó bÃÑn‚àí1,g Œ£gh + IH ‚äó bÃÑn‚àí1,gh Œ£h dn‚àí1 Œ£h

bÃÑn,h,Œ£gh

=

 0
Q0 ‚àí10
‚àí10 ¬Ø‚àí2
0
0
Œ¶Q0
IH ‚àí d¬Ø‚àí2
n‚àí1 Œ£h ‚äó bÃÑn‚àí1,g
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ£gh ‚àí Œ¶h Œ£h

=


0
Q
Q
‚àí10 ¬Ø‚àí2
0
Œ¶Q0
bÃÑn‚àí1,g,Œ¥1g
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,gh,Œ¥1g + Œ¶gh ‚àí Œ£gh Œ¶h

bÃÑn,h,Œ£i,g

i = 1, . . . , H

H√óG(G+1)/2
h
H√óH 2

h

H√óGH

bÃÑn,h,Œ¥1g
H√óG

bÃÑn,h,Œ¶Qg



+ IH ‚äó bÃÑ0n‚àí1,g Œ£g Œ£0g ŒπH ‚äó bÃÑn‚àí1,g,Œ¥1g

0
Q
Q
‚àí10 ¬Ø‚àí2
0
+
Œ¶
‚àí
Œ£
Œ¶
bÃÑn‚àí1,g,Œ¶Qg
= Œ¶Q0
gh
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,gh,Œ¶Q
gh
h
g

H√óG2

bÃÑn,h,Œ£h
H√óH(H+1)/2




+ IH ‚äó bÃÑ0n‚àí1,g Œ£g Œ£0g ŒπH ‚äó bÃÑn‚àí1,g,Œ¶Qg
 


Q0 ‚àí10
‚àí10 ¬Ø‚àí2
‚àí1
‚àí10 ¬Ø‚àí2
0
0
= Œ¶Q0
‚äó bÃÑ0n‚àí1,gh Œ£h d¬Ø‚àí1
+ Œ¶Q0
n‚àí1 Œ£h
h Œ£h dn‚àí1 ‚äó bÃÑn‚àí1,gh
h Œ£h dn‚àí1 Œ£h bÃÑn‚àí1,h,Œ£h ‚àí Œ¶h Œ£h

56

where we also need to account for the derivatives of bÃÑn,gh = Œ£0gh bÃÑn,g + bÃÑn,h as
bÃÑn‚àí1,gh,Œ¥1g = Œ£0gh bÃÑn‚àí1,g,Œ¥1g + bÃÑn‚àí1,h,Œ¥1g

bÃÑn‚àí1,gh,Œ¶Qg = Œ£0gh bÃÑn‚àí1,g,Œ¶Qg + bÃÑn‚àí1,h,Œ¶Qg

H√óG

H√óG2

Many of the derivatives of the loadings are zero for all maturities including bÃÑn,g,¬µh , bÃÑn,h,¬µQg ,bÃÑn,g,Œ¥1h , bÃÑn,g,Œ¶Q ,
G√óH

G√óH

H√óG

h

G√óH 2

bÃÑn,g,Œ£h , bÃÑn,g,Œ£0,g ,
G√óH 2

bÃÑn,h,Œ£0,g , bÃÑn,g,Œ¶Q , bÃÑn,g,Œ£i,g , bÃÑn,g,Œ£gh , bÃÑn,g,ŒΩ Q , bÃÑn,h,ŒΩ Q .
gh
h
h
G√óG(G+1)/2 H√óG(G+1)/2 G√óGH H√óG(G+1)/2 G√óGH
G√óH
H√óH

Appendix G

USV restrictions

Appendix G.1

Proof of Proposition 4

We provide proofs for the U1 (4)(œÜ, œÜ2 , œà) and U1 (4)(œÜ, œÜ2 , œÜ4 ) models.

Proof for U1 (4)(œÜ, œÜ2 , œà): Showing bn,h = 0 is equivalent to bÃÑn,h = 0. We prove bÃÑn,h = 0 by induction
over n. At n = 1, we have bÃÑ1,h = ‚àíŒ¥1,h = 0. Next, suppose bÃÑn,h = 0, then under the restriction that Œ£gh = 0,
we find that bÃÑn,gh = 0. Imposing the restrictions on Œ£1,g Œ£01,g and from (6), the loading recursion reduces to
1 2
Q
Q
2
bÃÑn+1,h = Œ¶Q
gh,1 bÃÑn,g,1 + Œ¶gh,2 bÃÑn,g,2 + Œ¶gh,3 bÃÑn,g,3 + bÃÑn,g,1 Œ£1,g,11
2
n

1‚àíœÜ
The restrictions on Œ¶Q
g together with (7) implies the solution for bÃÑn,g : bÃÑn,g,1 = ‚àí 1‚àíœÜ Œ¥1,g,1 , bÃÑn,g,2 =
2n

n

1‚àíœà
‚àí 1‚àíœÜ
1‚àíœÜ2 Œ¥1,g,2 , bÃÑn,g,3 = ‚àí 1‚àíœà Œ¥1,g,3 . Substituting these above gives

bÃÑn+1,h

= ‚àíŒ¶Q
gh,1

1 ‚àí œÜ2n
1 ‚àí œàn
1 ‚àí œÜn
Œ¥1,g,1 ‚àí Œ¶Q
Œ¥1,g,2 ‚àí Œ¶Q
Œ¥1,g,3
gh,2
gh,3
2
1‚àíœÜ
1‚àíœÜ
1‚àíœà
2

+

0

1 (1 ‚àí œÜn ) 2
Œ¥
Œ£2
2 (1 ‚àí œÜ)2 1,g,1 1,g,11
1

2

Collect terms related to (œÜn ) , (œÜn ) , (œÜn ) , œà n , we get the following three equations

bÃÑn+1,h

! 

2
Œ¥1,g,2
Œ¥1,g,3
1 Œ¥1,g,1
Œ¥1,g,3
Q
Q
2
=
‚àí
‚àí Œ¶gh,3
+
Œ£
+ Œ¶gh,3
œàn
1‚àíœÜ
1 ‚àí œÜ2
1 ‚àí œà 2 (1 ‚àí œÜ)2 1,g,11
1‚àíœà
!
!
2
2
Œ¥1,g,1
1 Œ¥1,g,1
Œ¥1,g,1
Œ¥1,g,2
Q
Q
2
n
2
+ Œ¶gh,1
‚àí
Œ£
œÜ + Œ¶gh,2
Œ£
œÜ2n
+
1 ‚àí œÜ (1 ‚àí œÜ)2 1,g,11
1 ‚àí œÜ2
2 (1 ‚àí œÜ)2 1,g,11
Œ¥1,g,1
‚àíŒ¶Q
gh,1

Œ¶Q
gh,2

0

1

2

n
n
n
n
The restrictions on Œ¶Q
gh guarantee that the coefficients in front of (œÜ ) , (œÜ ) , (œÜ ) , œà are all zero. Hence,

bÃÑn+1,h = 0. 

57

Proof for U1 (4)(œÜ, œÜ2 , œÜ4 ): We prove bÃÑn,h = 0 by induction. First, at maturity n = 1, we have
bÃÑ1,h = ‚àíŒ¥1,h = 0. Next, suppose bÃÑn,h = 0, then bÃÑn,gh = 0 because Œ£gh = 0 under the USV restrictions. From
(6), the non-Gaussian loading simplifies to
1 0
0
bÃÑn+1,h = Œ¶Q0
gh bÃÑn,g + bÃÑn,g Œ£1,g Œ£1,g bÃÑn,g
2

(G.1)

Substituting the parameter restrictions on Œ£1,g Œ£01,g into the equation, we find
1 2
1 2
Q
Q
2
2
bÃÑn+1,h = Œ¶Q
gh,1 bÃÑn,g,1 + Œ¶gh,2 bÃÑn,g,2 + Œ¶gh,3 bÃÑn,g,3 + bÃÑn,g,1 Œ£1,g,11 + bÃÑn,g,2 Œ£1,g,22
2
2
n

1‚àíœÜ
The parameter restrictions on Œ¶Q
g together with (7) implies the solution for bÃÑn,g : bÃÑn,g,1 = ‚àí 1‚àíœÜ Œ¥1,g,1 , bÃÑn,g,2 =
4n

2n

1‚àíœÜ
‚àí 1‚àíœÜ
1‚àíœÜ2 Œ¥1,g,2 , bÃÑn,g,3 = ‚àí 1‚àíœÜ4 Œ¥1,g,3 . Substituting these in, we find

bÃÑn+1,h

1 ‚àí œÜn
1 ‚àí œÜ2n
1 ‚àí œÜ4n
Q
Œ¥1,g,1 ‚àí Œ¶Q
Œ¥
‚àí
Œ¶
Œ¥1,g,3
1,g,2
gh,2
gh,3
1‚àíœÜ
1 ‚àí œÜ2
1 ‚àí œÜ4

2
2
1 (1 ‚àí œÜn ) 2
1 1 ‚àí œÜ2n
2
+
Œ¥
Œ£
+
Œ¥ 2 Œ£2
2 (1 ‚àí œÜ)2 1,g,1 1,g,11 2 (1 ‚àí œÜ2 )2 1,g,2 1,g,22

= ‚àíŒ¶Q
gh,1

0

1

2

4

Collect terms related to (œÜn ) , (œÜn ) , (œÜn ) , (œÜn )

bÃÑn+1,h

=

Œ¥1,g,1
‚àíŒ¶Q
gh,1

1‚àíœÜ

+ Œ¶Q
gh,1

‚àí

Œ¶Q
gh,2

2
2
Œ¥1,g,2
Œ¥1,g,3
1 Œ¥1,g,1
1 Œ¥1,g,2
Q
2
‚àí
Œ¶
+
Œ£
+
Œ£2
gh,3
1 ‚àí œÜ2
1 ‚àí œÜ4
2 (1 ‚àí œÜ)2 1,g,11 2 (1 ‚àí œÜ2 )2 1,g,22
!

2
Œ¥1,g,1
Œ¥1,g,1
Œ£2
‚àí
1 ‚àí œÜ (1 ‚àí œÜ)2 1,g,11

!

œÜn

2
2
Œ¥1,g,2
Œ¥1,g,2
1 Œ¥1,g,1
2
+
+
Œ£
‚àí
Œ£2
1 ‚àí œÜ2
2 (1 ‚àí œÜ)2 1,g,11 (1 ‚àí œÜ2 )2 1,g,22
!
2
Œ¥1,g,3
1 Œ¥1,g,2
Q
Œ£2
œÜ4n
+ Œ¶gh,3
+
1 ‚àí œÜ4
2 (1 ‚àí œÜ2 )2 1,g,22

Œ¶Q
gh,2

!
œÜ2n

0

1

2

4

n
n
n
n
The restrictions on Œ¶Q
gh guarantee that the coefficients in front of (œÜ ) , (œÜ ) , (œÜ ) , (œÜ ) are all zero.

Therefore, bÃÑn+1,h = 0. 

58

Appendix H
Appendix H.1

EM algorithm
Intermediate quantity

Given the identifying restriction ¬µh = 0, we drop this parameter for convenience. The two components of



the intermediate quantity Q Œ∏|Œ∏(i) = Q1 Œ∏m,b , Œ∏c |Œ∏(i) + Q2 Œ∏m,h |Œ∏(i) are
T



1X
T ‚àí1
log |‚Ñ¶| ‚àí
tr ‚Ñ¶‚àí1 Œ∑t Œ∑t0
= ‚àí (T ‚àí 1) log |B1 | ‚àí
Q1 Œ∏m,b , Œ∏c |Œ∏(i)
2
2 t=2

‚àí

T
T

 h
 1X
‚àí1 i
1X 
E log Œ£g,t‚àí1 Œ£0g,t‚àí1 ‚àí
tr E Œ£g,t‚àí1 Œ£0g,t‚àí1
Œµgt Œµ0gt
2 t=2
2 t=2

and


Q2 Œ∏m,h |Œ∏(i)

= ‚àí(T ‚àí 1) log|Œ£h | ‚àí

H
T
‚àí1 X
X

e0i Œ£‚àí1
h E [ht ] ‚àí

H
T
‚àí1 X
X

e0i Œ£‚àí1
h Œ¶h E [ht‚àí1 ]

t=1 i=1

t=1 i=1
H
T
‚àí1 X
X

H
T
‚àí1 X
X



(ŒΩh,i ‚àí 1) 
(ŒΩh,i ‚àí 1) 
E log e0i Œ£‚àí1
E log e0i Œ£‚àí1
‚àí
h ht
h Œ¶h ht‚àí1
2
2
t=1 i=1
t=1 i=1

 q

H
T
‚àí1 X
X


0 Œ£‚àí1 Œ¶ h
h
e
E log IŒΩh,i ‚àí1 2 e0i Œ£‚àí1
+
t
h t‚àí1
i h
h
+

t=1 i=1



Maximizing Q1 Œ∏m,b , Œ∏c |Œ∏(i) is similar to estimation of a Gaussian ATSM. When maximizing Q1 Œ∏m,b , Œ∏c |Œ∏(i) ,
the analytical gradient of the intermediate quantity can be derived from the gradients in Appendix E.

There are several options for maximizing Q2 Œ∏m,h |Œ∏(i) , all of which lead to different types of EM
algorithms. Each EM algorithm leads to the same maximum but they converge at different rates.

‚Ä¢ Option #1: Maximize the intermediate quantity Q2 Œ∏m,h |Œ∏(i) numerically over Œ∏m,h as above.
‚Ä¢ Option #2: From the definition of ht+1 in (2)-(4), there is also the variable zt . When calculating

Q2 Œ∏m,h |Œ∏(i) , take the expectations of zt and ht . By introducing zt , the maximization of Œ¶h is
analytical.

‚Ä¢ Option #3: Instead of optimizing over Q2 Œ∏m,h |Œ∏(i) at each iteration, a valid EM algorithm can
optimize the log-likelihood over Œ∏m,h . When H = 1, we can use the particle filter of Malik and


(1)
Pitt(2011) to maximize the log-likelihood log p Y1:T ; Œ∏ over Œ∏m,h .
For the results in the paper, we used the third option.

59

Appendix H.2

Particle filter



(m)
We implement a basic particle filter for the E-step in (a.). Let q ht |ht‚àí1 , gt+1 , gt , Œ∏ be an importance
density whose tails are heavier than the target distribution.

For t = 1, . . . , T , run:
(m)

‚Ä¢ For m = 1, . . . , M , draw from a proposal distribution: ht

(m)
wt

‚Ä¢ For m = 1, . . . , M , calculate the importance weight:
(m)

‚Ä¢ For m = 1, . . . , M , normalize the weights: wÃÇt

PM

m=1

n
oM
(m)
‚Ä¢ If ESSt < 0.5M resample ht

m=1


 

(m)
(m)
(m)
(m) p gt+1 |gt ,ht ,Œ∏ p ht |ht‚àí1 ,Œ∏


wÃÇt‚àí1
(m)
(m)
q ht |ht‚àí1 ,gt+1 ,gt ,Œ∏

‚àù

(m)

=

w
PM t

(m)

wt

m=1

‚Ä¢ Calculate the effective sample size: ESSt =



(m)
‚àº q ht |ht‚àí1 , gt+1 , gt , Œ∏ .

.

1

(m) 2
wÃÇt

n
oM
(m)
with probabilities wÃÇt

m=1

and set wÃÇt = 1/M .

At time t = 1, q (h1 ; Œ∏) does not depend on any previous particles. Simple proposal distributions are to draw
from the transition density p (ht+1 |ht ; Œ∏) of the model (2)-(4).

To calculate the expectations within Q Œ∏|Œ∏(i) , we use the algorithm of Godsill, Doucet, and West(2004)
n
oM
(m)
(m)
that draws samples from the posterior. Store wÃÇt , ht
for t = 1, . . . , T during the particle filter.
(m)

On a backwards pass, sample hÃÉT = hT

m=1
(m)

with probability wÃÇT
(m)

‚Ä¢ For m = 1, . . . , M , calculate backwards weights wt+1|t
(m)

‚Ä¢ For m = 1, . . . , M , normalize the weights: wÃÇt+1|t =
(m)

‚Ä¢ Sample hÃÉt = ht

and then for t = T ‚àí 1, . . . , 1


(m)
(m)
‚àù wt p hÃÉt+1 |ht ; Œ∏ .
(m)

wt+1|t
PM
(m) .
m=1 wt+1|t

(m)

with probability wÃÇt+1|t


To calculate the expectations Q Œ∏|Œ∏(i) , we repeat this backwards pass a large number of times.
For the final climb after the EM algorithm, we optimize over all Œ∏ using the algorithm from Malik and
Pitt(2011). To implement this particle filter, we resample at every time period and use the resampling
algorithm described in their appendix.

60

