                                NBER WORKING PAPER SERIES




 SECOND-ORDER APPROXIMATION OF DYNAMIC MODELS WITH TIME-VARYING
                              RISK

                                          Gianluca Benigno
                                          Pierpaolo Benigno
                                           Salvatore NisticÃ²

                                        Working Paper 16633
                                http://www.nber.org/papers/w16633


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    December 2010




Financial support from and ERC Starting Independent Grant is gratefully acknowledged. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

Â© 2010 by Gianluca Benigno, Pierpaolo Benigno, and Salvatore NisticÃ². All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including Â© notice, is given to the source.
Second-Order Approximation of Dynamic Models with Time-Varying Risk
Gianluca Benigno, Pierpaolo Benigno, and Salvatore NisticÃ²
NBER Working Paper No. 16633
December 2010
JEL No. C63

                                                ABSTRACT

This paper provides first and second-order approximation methods for the solution of non-linear dynamic
stochastic models in which the exogenous state variables follow conditionally-linear stochastic processes
displaying time-varying risk. The first-order approximation is consistent with a conditionally-linear
model in which risk is still time-varying but has no distinct role -- separated from the primitive stochastic
disturbances -- in influencing the endogenous variables. The second-order approximation of the solution,
instead, is sufficient to get this role. Moreover, risk premia, evaluated using only a first-order approximation
of the solution, will be also time varying.


Gianluca Benigno                                        Salvatore NisticÃ²
London School of Economics                              Universita' di Roma Tor Vergata
Department of Economics                                 Dipartimento di Diritto e Procedura Civile
Houghton Street                                         and LUISS Guido Carli
London WC2A 2AE ENGLAND                                 Dipartimento di Scienze
g.benigno@lse.ac.uk                                     Economiche e Aziendali
                                                        Viale Romania 32
Pierpaolo Benigno                                       00197 Rome - Italy
Dipartimento di Scienze                                 snistico@luiss.it
 Economiche e Aziendali
Luiss Guido Carli
Viale Romania 32
00197 RomeITALY
and NBER
pbenigno@luiss.it
1         Introduction
In the last decade, there has been an increasing interest among researchers and policymak-
ers in developing dynamic general equilibrium models to study business cycle properties of
macroeconomic variables and to conduct policy analysis. This research agenda has been
accompanied by parallel developments in solution methods and estimation techniques
aimed at handling different challenges that richer models pose to economists. For exam-
ple, second-order approximation techniques have been proposed by Schmitt-GroheÌ and
Uribe (2004) and Benigno and Woodford (2008) to address welfare comparisons across
policy regimes while Bayesian analysis has been developed for estimating dynamic general
equilibrium models (An and Schorfeide, 2007).
        In this work, we propose a solution method for non-linear dynamic stochastic models
in which the exogenous stochastic processes display time-varying risk. While the use of
models with time-varying risk is quite popular in finance, only recently there has been
considerable attention on the role and the effects that risk or uncertainty and their vari-
ations over time have on macroeconomic variables.1 Our solution method is based on
appropriately-defined first and second-order approximations of the solution which can be
effective in studying how time-variation in the exogenous risk influences the equilibrium al-
location in standard macroeconomic models. This is in contrast with other solution meth-
ods, recently proposed, relying on third-order approximations as in Fernandez-Villaverde
et al. (2009).2
        We consider a class of non-linear dynamic stochastic models in which the exogenous
state variables follow conditionally-linear stochastic processes where either variances or
standard deviations of the primitive shocks are modelled through stochastic linear pro-
cesses. We show that a first-order approximation of the solution can be consistent with
a conditionally-linear model in which the process for the exogenous state variables is not
approximated and still displays time-varying volatility. Indeed, whether the exogenous
state process is approximated or not does not affect the other coefficients of the linear
    1
     Bloom (2009) examines the effects of an increase in uncertainty on investment and hiring decisions
by firms, Bloom, Floetotto and Jaimovich (2009) extend a canonical real business cycle model to study
the impact of change in the variance to productivity innovation on economic activity while Fernandez-
Villaverde, Guerron-Quintana, Rubio-Ramirez and Uribe (2009) show how changes in the volatility of the
foreign real interest rate are an important mechanism in explaining the behavior of output, consumption
and investment in emerging market economies.
   2
     Bloom et al. (2009), following Krussell and Smith (1998), use instead a value function iteration ap-
proach which is more computationally demanding and difficult to implement even in small scale dynamic
general equilibrium models.



                                                   1
approximation nor the dimension of the relevant endogenous state variables.3
       There are three clear advantages of following a conditionally-linear approximation in-
stead of a fully-linear approximation. First, the approximated linear solution would still
display a role for time-varying risk in affecting the evolution of the endogenous variables
of the model.4 However, this is not a â€œdistinct and directâ€ role, as risk and primitive
shocks are not disjoint arguments: if shocks are zero, risk does not influence directly the
endogenous variables. Second, the fact that stochastic volatility enters the first-order ap-
proximation, although not disjointly, has important implications also for higher-order ap-
proximations. In particular, we show that a second-order approximation of the policy rules
is sufficient to imply a â€œdistinct and directâ€ role for time-varying volatility in affecting the
endogenous variables, whereas with other approaches a more computationally-demanding
third-order approximation is needed. Third, a conditionally-linear approximation, where
volatility is still time-varying, can be sufficient to characterize time variation in covari-
ances and therefore in risk premia, whereas a standard linear approximation would only
deliver constant risk premia.
       Our paper is related to Justiniano and Primiceri (2008) since their partially-nonlinear
approximation, as a first-order approximation of the solution, agrees with our proposed
conditionally-linear approximation when the exogenous state variables follow conditionally-
linear processes. We also provide a second-order approximation of the solution to charac-
terize a distinct role for exogenous risk in affecting the endogenous variables. In particular
we consider two models of time-varying volatility, one with a stochastic linear process for
the standard deviation of the primitive shocks, as in Justiniano and Primiceri (2008), and
another with a linear process for the variance.5 The latter model is indeed also more
parsimonious in the second-order approximation.
       Our contribution can also be read as a generalization of the second-order approxima-
tion methods of Schmitt-GroheÌ and Uribe (2004), Kim et al. (2008) and Gomme and
Klein (2008) to the case in which the exogenous state variables follow heteroskedastic
processes. Recent works by Fernandez-Villaverde et al. (2009, 2010) have provided ap-
proximation methods for exactly the same model as ours in which the standard-deviation
   3
      We follow here the insights of Justiniano and Primiceri (2008) which indeed define a partially-
nonlinear approximation.
    4
      This role has been particular relevant for Justiniano and Primiceri (2008) to deliver a model that
can be estimated parsimoniously in order to investigate which sources of risk have contributed the most
to the fall in macroeconomic volatility associated with the US Great Moderation.
    5
      Justiniano and Primiceri (2008), however, model the log of the standard deviation as a stochastic
linear process.



                                                   2
of the primitive shocks is time-varying. However, they consider a fully-linear approx-
imation in which even the process for the exogenous state variable is linearized.6 By
doing this, time-varying volatility is lost in the first-order approximation and, to get a
distinct role for risk in affecting the endogenous variables, a third-order approximation
is needed. Amisano and Tristani (2009) analyze models where volatility is subject to
discrete switching-regime changes and show that the time-varying volatility can affect the
second-order approximation. Finally, there are other contributions which have been inter-
ested in characterizing how time-varying risk affects endogenous variables. But in these
cases, as in Rudebush and Swanson (2008), exogenous state variables follow homoskedas-
tic processes as in Schmitt-GroheÌ and Uribe (2004) and time-varying endogenous (not
exogenous) risk affects the endogenous variables only in a third-order approximation.
        The structure of this work is the following. Section 2 presents first and second-order
approximations in a model in which the exogenous state variables have time-varying
linear process for the conditional standard deviation. Section 3 considers the case in
which time-varying risk is modelled using a linear process for the conditional variance of
the primitive shocks. Section 4 applies our methods to the benchmark neoclassical growth
model. Section 5 concludes.


2         A model with time-varying standard deviations
We consider the following general model which encompasses a wide variety of dynamic
stochastic models:
                                   Et {f (yt+1 , xt+1 , yt , xt )} = 0,                              (1)

where Et {Â·} denotes the mathematical expectations operator conditional on the informa-
tion available at date t and f (Â·) is a vector, of size n, of functions. The vector yt , of
non-predetermined variables, is of size ny Ã— 1 while the vector xt of state variables is of
size nx Ã— 1, with ny + nx = n. In particular, the vector xt can be partitioned into a vector
of endogenous state variables kt and a vector of exogenous predetermined variables zt of
size nz Ã— 1, as follows:                            "        #
                                                        kt
                                             xt =                .
                                                        zt
    6
    This is because they do not necessarily assume a conditionally-linear process for the exogenous state
variables.




                                                    3
The vector zt follows the exogenous stochastic process given by

                                          zt+1 = Î›z zt + ZÎ¾t+1                                           (2)

where Z and Î›z are matrices of order nz Ã— nz . The vector Î¾t+1 is also of dimension nz Ã— 1
and is given by
                                             Î¾t+1 = Ut Îµz,t+1                                            (3)

where Îµz,t+1 is a nz Ã— 1 vector of innovations, which are assumed to have a bounded
support and to be independently and identically distributed with mean zero and vari-
ance/covariance matrix Iz , where Iz is an identity matrix of dimension nz Ã— nz ; Ut is a
diagonal matrix of dimension nz Ã— nz whose elements on the diagonal are collected into
vector ut , of dimension nz Ã— 1. In particular ut follows the exogenous stochastic linear
process given by
                              ut+1 = Ïƒz (Iz âˆ’ Î›u )uÌ„ + Î›u ut + Ïƒv V Îµv,t+1                               (4)

where V and Î›u are matrices of order nz Ã— nz , Îµv,t+1 is a nz Ã— 1 vector of innovations
which are assumed to have a bounded support and to be independently and identically
distributed with mean zero and variance/covariance matrix Iz ; uÌ„ is a vector of dimension
nz Ã— 1 while Ïƒz and Ïƒv are scalars with Ïƒz ,Ïƒv â‰¥ 0.7 We also assume that the initial
condition on the process for ut is such that ut0 âˆ’1 = Ïƒz uÌ„.8
       Given equations (3) and (4), the model generalizes the framework of Schmitt-GroheÌ
and Uribe (2004) to a case in which the volatility is time varying and stochastic. In
particular, the process for the exogenous state variable (2) is conditionally linear where
each element of the vector ut captures the conditional standard deviation of each element
of the stochastic disturbance Î¾t+1 ; such standard deviations are allowed to vary over
time in a stochastic way following the autoregressive process described by equation (4).
The model boils down to the framework of Schmitt-GroheÌ and Uribe (2004) under the
assumptions Ïƒv = 0 and uÌ„i = 1 for all i = 1, ..., nz , since in this case

                                             Î¾t+1 = Ïƒz Îµz,t+1 .
   7
      Fernandez-Villaverde et al. (2009, 2010) and Justiniano and Primiceri (2008) model a linear process
for the log of the standard deviations to assure that variances remain always positive. This is not necessary
in our case since we are assuming a bounded support for the shock Îµv,t which is needed anyway, for the
goodness of the approximation.
    8
      Notice that in (3), there is no need to add another scalar of the type ÏƒÎ¾ as a perturbation parameter
since the variables on the diagonal matrix Ut are already subject themselves to perturbation. Indeed,
this is why we add the perturbation parameters Ïƒz and Ïƒv in (4) and assume an initial condition for ut
of the form ut0 âˆ’1 = Ïƒz uÌ„.



                                                     4
We make three important remarks on the above structure which are important to define
the class of models which we are interested in. First, equation (4) is not part of the
equilibrium conditions (1). Second, the vector ut is not a distinct argument of the set
of equilibrium conditions with respect to what is already captured by the state vector
xt . Third, the vector of exogenous state variables zt follows a conditionally-linear process
given by (2). We are not interested in characterizing approximations of more general
models in which the exogenous state variables follow instead non-linear models.


2.1    Solution
Given the above defined model and structure of the stochastic processes, a solution of (1)
takes the form
                                     yt = g(xt , ut , Ïƒz , Ïƒv )                          (5)

                              xt+1 = h(xt , ut , Ïƒz , Ïƒv ) + hÌ„Î¾ Î¾t+1                    (6)

for generic functions g(Â·) and h(Â·) where hÌ„Î¾ is a known nx Ã— nz matrix of the form
                                             "     #
                                                0
                                       hÌ„Î¾ â‰¡         .
                                                Z

   We are interested in a second-order approximation of (5) and (6) around a deterministic
steady state in which Ïƒz = Ïƒv = 0 and ut = Ïƒz uÌ„ = 0. In this deterministic steady state
xt = xÌ„ and yt = yÌ„ satisfy

                                      yÌ„ = g(xÌ„, 0, 0, 0)
                                      xÌ„ = h(xÌ„, 0, 0, 0)

or, equivalently
                                       f (yÌ„, xÌ„, yÌ„, xÌ„) = 0.


2.2    First-order approximation
First, we characterize a first-order approximation of (5) and (6). We guess and verify that
this approximation takes the form
                                            yÌƒt = gÌ„x xÌƒt                                (7)

                                    xÌƒt+1 = hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1                           (8)



                                                 5
where yÌƒt â‰¡ yt âˆ’ yÌ„, xÌƒt â‰¡ xt âˆ’ xÌ„ and gÌ„x and hÌ„x are the Jacobian matrices of the functions g(Â·)
and h(Â·) with respect to x, of size ny Ã— nx and nx Ã— nx , respectively, and evaluated at the
steady state. To verify this guess, we take a first-order approximation of (1), obtaining

                    DfÂ¯yÌ‚ Â· Et yÌƒt+1 + DfÂ¯xÌ‚ Â· Et xÌƒt+1 + DfÂ¯y Â· yÌƒt + DfÂ¯x Â· xÌƒt = 0         (9)

where DfÂ¯yÌ‚ , DfÂ¯xÌ‚ , DfÂ¯y , and DfÂ¯x are matrices containing the respective gradients of the
vector of functions f (Â·) taken with respect to the arguments of the function and evaluated
at the above-defined steady state. In particular hats denote the gradient with respect to
time t + 1 vectors, yÌ‚ stands for yt+1 and xÌ‚ for xt+1 .
   To verify our guess, we plug (7) and (8) into (9) noting that Et Î¾t+1 = 0. It follows
that the matrices gÌ„x and hÌ„x have to satisfy the following set of n Ã— nx conditions.

                            DfÂ¯yÌ‚ gÌ„x hÌ„x + DfÂ¯y gÌ„x + DfÂ¯xÌ‚ hÌ„x + DfÂ¯x = 0.                 (10)

The above set of conditions can be solved using standard algorithms. Indeed, it corre-
sponds to that of Schmitt-GroheÌ and Uribe (2004) in the case in which the volatility is
non stochastic: the matrices gÌ„x and hÌ„x are the same as in their framework. However,
the overall solution given by (7) and (8) does not correspond to their solution since the
driving stochastic disturbance is still a non-linear process, which is described by (3). In
particular, (7), (8) together with (3) and (4) represent the best conditionally-linear so-
lution of (9) given that the exogenous state variables follow (2)-(4) and given that the
vector ut does not enter the set of equations (1) nor their arguments. Notice first that
(9) just imposes restrictions on the linear approximations of the functions g(Â·) and h(Â·)
of (5) and (6). Since Et Î¾t+1 = 0, the approximations (7) and (8) are conditionally linear.
Moreover since hÌ„Î¾ is known, the best approximation of the term hÌ„Î¾ Î¾t+1 , in equation (6),
is just the term itself which is what appears in (8).
   Fernandez-Villaverde et al. (2009, 2010) assume that

                                        Î¾t+1 = â„¦t+1 Ïƒz Îµz,t+1                                (11)

where â„¦t+1 is a diagonal matrix whose diagonal contains the vector of standard deviations
Ï‰t+1 ; the log of the standard deviations follow

                           log Ï‰t+1 = log Ï‰Ì„ + Î›Ï‰ log Ï‰t + ÏƒÏ‰ VÏ‰ ÎµÏ‰,t+1                      (12)

given appropriately defined matrices Î›Ï‰ and VÏ‰ , given the vector log Ï‰Ì„ and stochastic
disturbances ÎµÏ‰,t+1 where ÏƒÏ‰ and Ïƒz are scalars with ÏƒÏ‰ , Ïƒz â‰¥ 0. If ÎµÏ‰,t+1 and Îµz,t+1 are

                                                   6
statistically independent, the process for the exogenous state variables is also conditionally
linear.9 In this framework, Fernandez-Villaverde et al. (2009, 2010) look for a fully
linear approximation in which (11) is also linearized. However, an appropriate linear
approximation of (11) â€“ also with respect to the scalar Ïƒz â€“ would be zero and therefore the
overall first-order approximation of the solution would no longer be stochastic. However,
an alternative linear approximation would be to approximate Î¾t+1 as a linear function of
Ïƒz Îµz,t+1 in a way that also (8) becomes linear in the stochastic disturbances Ïƒz Îµz,t+1 . In
their case a linear approximation of the exogenous state variables takes the form

                                     xÌƒt+1 = hÌ„x xÌƒt + hÌ„Î¾ â„¦Ì„Ïƒz Îµz,t+1 ,                             (13)

in which â„¦Ì„ is the diagonal matrix containing the vector Ï‰Ì„ on its diagonal. Applying this
approximation to our context requires to set Ïƒv = 0 in (4) to obtain a linear approximation
of the exogenous state variables of the form

                                     xÌƒt+1 = hÌ„x xÌƒt + hÌ„Î¾ UÌ„ Ïƒz Îµz,t+1 ,                            (14)

in which UÌ„ is the diagonal matrix containing the vector uÌ„ on its diagonal. Solution (14)
is now in the form of a linear multivariate autoregressive process, but it is not the best
conditionally-linear approximation of (6). In our approximation (7) and (8) together with
(3) and the linear process (4) are all that is needed to characterize the conditionally-linear
approximation. In Fernandez-Villaverde et al. (2009, 2010), it suffices instead to consider
(7), (8) and (14) where time-varying volatility ceases to play a role. However, there is no
restriction in our and their approximation methods that should require to linearize also
Î¾t+1 . This is not even a requirement for analytical tractability since conditionally linear
heteroskedastic models are commonly used and most recently in macro models.10
       Indeed, we will show that there are actually several advantages of our conditionally-
linear approximation. A first one is that in our case, first-order approximations will
retain a role for stochastic volatility, as in Justiniano and Primiceri (2008), although not
a distinct role, since risk enters only jointly with the structural shock. In Fernandez-
Villaverde et al. (2009, 2010), on the contrary, first-order approximations will lose any
role for time-varying risk. Such difference between our and their linear approximations
will also be importantly reflected in the second-order approximation and especially in
   9
     Fernandez-Villaverde et al. (2009, 2010) do not assume explicitly conditional linearity and, perhaps,
they are looking at the broader class of non-linear processes for the exogenous state variables.
  10
     See Justiniano and Primiceri (2008) for further arguments to justify what they call a â€œpartially
nonlinearâ€ approximation in the same model of Fernandez-Villaverde et al. (2009, 2010). This would be
a conditionally-linear approximation when ÎµÏ‰,t+1 and Îµz,t+1 are statistically independent.


                                                      7
the role that time-varying volatility plays in it. A further advantage of our approach,
indeed, is that time-varying volatility will play a â€œdistinct and directâ€ role already in a
second-order approximation whereas in Fernandez-Villaverde et al. (2009, 2010) at least
a third-order approximation is needed. With â€œdistinct and directâ€ role, we mean that
the impulse response functions of the variables of interest with respect to the primitive
volatility shock Îµv,t+1 can be in general different from zero.11 As a consequence, a very
appealing implication of our method is that risk premia evaluated using first-order ap-
proximations will be time-varying, in contrast to the constant risk premia implied by
the framework of Fernandez-Villaverde et al. (2009, 2010). In their context, indeed,
higher-order approximations will be needed to characterize time-varying risk premia.
       We conclude this section by noting that a complete linear approximation to (5) and
(6) can be represented as

                                      yÌƒt = gÌ„x xÌƒt + gÌ„u ut + gÌ„z Ïƒz + gÌ„v Ïƒv

                              xÌƒt+1 = hÌ„x xÌƒt + hÌ„u ut + hÌ„z Ïƒz + hÌ„v Ïƒv + hÌ„Î¾ Î¾t+1 .

However, plugging the above equations into (9) shows that gÌ„u , gÌ„z , gÌ„v , hÌ„u , hÌ„z , hÌ„v are all
zero matrices.


2.3       Second-order approximation
In this section, we characterize a second-order approximation of the solutions (5) and (6).
We guess and verify that it takes the form
                       1                      1                    1          1
        yÌƒt = gÌ„x xÌƒt + (Iy âŠ— xÌƒ0t )gÌ„xx xÌƒt + (Iy âŠ— u0t )gÌ„uu ut + gÌ„vv Ïƒv2 + gÌ„zz Ïƒz2 + gÌ„zu Ïƒz ut    (15)
                       2                      2                    2          2
                  1                      1                   1          1
 xÌƒt+1 = hÌ„x xÌƒt + (Ix âŠ— xÌƒ0t )hÌ„xx xÌƒt + (Ix âŠ—u0t )hÌ„uu ut + hÌ„vv Ïƒv2 + hÌ„zz Ïƒz2 + hÌ„zu Ïƒz ut + hÌ„Î¾ Î¾t+1 (16)
                  2                      2                   2          2
where Iy and Ix are identity matrices of order ny Ã— ny and nx Ã— nx , respectively, âŠ— denotes
the Kronecker product and gÌ„xx , gÌ„uu , gÌ„zz , gÌ„vv , gÌ„zu , hÌ„xx , hÌ„uu , hÌ„zz , hÌ„vv , hÌ„zu are conformable
matrices, corresponding to the Magnus-Neudecker Hessian matrices of functions gÌ„ and hÌ„
with respect to the arguments in the indexes.12 Specifically, gÌ„xx is defined as
                                  âˆ‚ 2 g(x, u, Ïƒz , Ïƒv )         h                   0 i
                         gÌ„xx =                         = Dx vec  D x g(xÌ„, 0, 0, 0)    ,
                                        âˆ‚xâˆ‚x0
  11
     Accordingly, since in our first-order approximation there is no distinct role for volatility in affecting
the endogenous variables, the impulse response of any variable with respect to a volatility shock is always
zero.
  12
     See Magnus and Neudecker (1999).


                                                         8
evaluated at the steady state, and consists of ny vertically stacked symmetric nx Ã— nx ma-
trices (gÌ„xx is therefore of size ny Â· nx Ã— nx ). All remaining matrices are defined analogously.
   To evaluate this guess, we take a second-order approximation of (1), to get
          
   0 = Et DfÂ¯i Â· yÌƒt+1 + DfÂ¯i Â· xÌƒt+1 + DfÂ¯i Â· yÌƒt + DfÂ¯i Â· xÌƒt
                   yÌ‚             xÌ‚               y            x

                  1 0
                + yÌƒt+1    Â· DfÂ¯yÌ‚iyÌ‚ Â· yÌƒt+1 + xÌƒ0t+1 Â· DfÂ¯yÌ‚xÌ‚
                                                             i
                                                                 Â· yÌƒt+1 + yÌƒt0 Â· DfÂ¯yÌ‚y
                                                                                      i
                                                                                          Â· yÌƒt+1
                  2
                                             1
                + xÌƒ0t Â· DfÂ¯yÌ‚x
                             i
                                Â· yÌƒt+1 + xÌƒ0t+1 Â· DfÂ¯xÌ‚xÌ‚i
                                                              Â· xÌƒt+1 + yÌƒt0 Â· DfÂ¯xÌ‚y
                                                                                   i
                                                                                       Â· xÌƒt+1
                                             2                                                      
                                             1                                            1
                + xÌƒt Â· DfÂ¯xÌ‚x Â· xÌƒt+1 + yÌƒt Â· DfÂ¯yy Â· yÌƒt + xÌƒt Â· DfÂ¯yx Â· yÌƒt + xÌƒt Â· DfÂ¯xx Â· xÌƒt ,
                    0        i                 0        i             0      i                 0  i
                                                                                                         (17)
                                             2                                            2

for each i = 1, ..., n and where f i denotes the i-component of the vector f .
   The second-order approximation of (1) can be cast in a more compact form as
                     ï£±     ï£®        ï£¹     ï£®             ï£¹0    ï£®        ï£¹ï£¼
                     ï£´
                     ï£´
                     ï£´       yÌƒ t+1         In âŠ— yÌƒ t+1         yÌƒ t+1
                                                                        ï£´
                                                                        ï£´
                                                                        ï£´
                     ï£´
                     ï£´     ï£¯        ï£º     ï£¯             ï£º     ï£¯        ï£ºï£´
                                                                        ï£´
                     ï£²     ï£¯ xÌƒt+1 ï£º 1 ï£¯ In âŠ— xÌƒt+1 ï£º         ï£¯ xÌƒt+1 ï£ºï£½
              0 = Et Df ï£¯Â¯                                  Â¯
                                    ï£º + 2 ï£¯ I âŠ— yÌƒ      ï£º H f ï£¯ yÌƒ ï£ºï£´ ,                                  (18)
                           ï£¯        ï£º     ï£¯             ï£º     ï£¯        ï£º
                     ï£´
                     ï£´
                     ï£´     ï£°   yÌƒ t ï£»     ï£°  n      t   ï£»     ï£° t ï£»ï£´    ï£´
                     ï£´                                                  ï£´
                               xÌƒt          In âŠ— xÌƒt              xÌƒt
                     ï£´
                     ï£³                                                  ï£´
                                                                        ï£¾

where DfÂ¯ â‰¡ DfÂ¯yÌ‚ DfÂ¯xÌ‚ DfÂ¯y DfÂ¯x denotes the n Ã— 2n Jacobian matrix of function f ,
                                   

and H fÂ¯ the corresponding 2n2 Ã— 2n Magnusâ€“Neudecker Hessian matrix, evaluated at the
steady state:
                                          H fÂ¯ = Dvec (DfÂ¯)0 .
                                                           

   We use equations (7) and (8) into (18) to evaluate the second-order terms and (15)
and (16) to evaluate the first-order terms, taking into account the restrictions (10).
  Making use of Et Î¾t+1 = 0, we obtain:
             
   1        Â¯
0 = Et DfyÌ‚ (gÌ„x âŠ— xÌƒ0t ) hÌ„xx xÌƒt + (gÌ„x âŠ— u0t ) hÌ„uu ut + gÌ„x hÌ„zz Ïƒz2 + gÌ„x hÌ„vv Ïƒv2 + 2gÌ„x hÌ„zu Ïƒz ut
   2
   + Iy âŠ— u0t+1 gÌ„uu ut+1 + Iy âŠ— (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 )0 gÌ„xx (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 ) + gÌ„zz Ïƒz2 + gÌ„vv Ïƒv2
                                                          
                                                                                                        
                         Â¯             0                      0                     2          2
   + 2gÌ„zu Ïƒz ut+1 + DfxÌ‚ (Ix âŠ— xÌƒt ) hÌ„xx xt + (Ix âŠ— ut ) hÌ„uu ut + hÌ„zz Ïƒz + hÌ„vv Ïƒv + 2hÌ„zu Ïƒz ut
                                                                                         
        Â¯           0                     0                  2           2
   + Dfy (Iy âŠ— xÌƒt ) gÌ„xx xt + (Iy âŠ— ut ) gÌ„uu ut + gÌ„zz Ïƒz + gÌ„vv Ïƒv + 2gÌ„zu Ïƒz ut

     + In âŠ— (gÌ„x hÌ„x xÌƒt + gÌ„x hÌ„Î¾ Î¾t+1 )0 H fÂ¯yÌ‚ Â· wÌƒt+1 + In âŠ— (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 )0 H fÂ¯xÌ‚ Â· wÌƒt+1
                                                                                    
                                                               
               0 0       Â¯                        0     Â¯
     + (In âŠ— xÌƒt gÌ„x ) H fy Â· wÌƒt+1 + (In âŠ— xÌƒt ) H fx Â· wÌƒt+1 ,                                         (19)


                                                       9
                 0
where wÌƒt+1 â‰¡ [yÌƒt+1        xÌƒ0t+1       yÌƒt0   xÌƒ0t ]0 is a 2n Ã— 1 vector and H fÂ¯yÌ‚ , H fÂ¯xÌ‚ , H fÂ¯y , and H fÂ¯x are
the Magnus-Neudecker Hessian matrices of the vector of functions f (Â·) taken with respect
to the arguments of the function and evaluated at the above-defined steady state, such
that                                                           ï£®
                                                                H fÂ¯yÌ‚
                                                                       ï£¹

                                                              ï£¯ H fÂ¯xÌ‚ ï£º
                                                              ï£¯        ï£º
                                                          Â¯
                                                         Hf = ï£¯
                                                              ï£¯        ï£º.
                                                                   Â¯
                                                              ï£° H fy ï£»
                                                                       ï£º

                                                                H fÂ¯x
Specifically, H fÂ¯yÌ‚ is defined as

                                                     H fÂ¯yÌ‚ = Dvec (DfÂ¯yÌ‚ )0 ,
                                                                           


and analogously for the other terms. Moreover, equations (7) and (8) imply

                                                    wÌƒt+1 = MÌ„x xÌƒt + MÌ„Î¾ Î¾t+1 ,                                (20)

where Mx and MÎ¾ are matrices of order 2n Ã— nx and 2n Ã— nz , respectively, defined by
                                     ï£®               ï£¹                           ï£®             ï£¹
                                          gÌ„x hÌ„x                                    gÌ„x hÌ„Î¾
                                ï£¯                    ï£º                        ï£¯                ï£º
                                ï£¯ hÌ„x                ï£º                        ï£¯    hÌ„Î¾         ï£º
                          MÌ„x â‰¡ ï£¯
                                ï£¯ gÌ„
                                                     ï£º
                                                     ï£º                  MÌ„Î¾ â‰¡ ï£¯
                                                                              ï£¯ 0
                                                                                               ï£º.
                                                                                               ï£º                (21)
                                ï£° x                  ï£»                        ï£° (ny Ã—nz )      ï£»
                                  Ix                                            0(nx Ã—nz )

    From equation (19), and using (20), we can collect the quadratic terms in the vector
xÌƒt , to obtain
            
     1
                  DfÂ¯yÌ‚ Â· gÌ„x âŠ— xÌƒ0t hÌ„xx xÌƒt + DfÂ¯yÌ‚ âŠ— xÌƒ0t hÌ„0x gÌ„xx hÌ„x xÌƒt + DfÂ¯xÌ‚ âŠ— xÌƒ0t hÌ„xx xt
                                                                                           
  0 = Et
     2
         + DfÂ¯y âŠ— xÌƒ0t gÌ„xx xt + In âŠ— xÌƒ0t hÌ„0x gÌ„x0 H fÂ¯yÌ‚ Â· MÌ„x xÌƒt + In âŠ— xÌƒ0t hÌ„0x H fÂ¯xÌ‚ Â· MÌ„x xÌƒt
                                                                                    
                                                                                                      
                                  + (In âŠ— xÌƒt gÌ„x ) H fÂ¯y Â· MÌ„x xÌƒt + (In âŠ— xÌƒt ) H fÂ¯x Â· MÌ„x xÌƒt . (22)
                                                    0 0                             0



Following Gomme and Klein (2008), given a generic n Â· m Ã— m matrix A consisting of
n square matrices Ai stacked vertically, with i = 1, ..., n, we define trm(A) as the n Ã— 1
vector of traces of the n matrices Ai :

                                trm(A) = [tr(A1 ) tr(A2 ) ... tr(An )]0 .




                                                                10
We can use the above operator to show that moment condition (22) implies the following
set of n Â· nx Ã— nx equations:

  0 = DfÂ¯yÌ‚ Â· gÌ„x âŠ— Ix hÌ„xx + DfÂ¯yÌ‚ âŠ— hÌ„0x gÌ„xx hÌ„x + DfÂ¯xÌ‚ âŠ— Ix hÌ„xx
                                                              

              + DfÂ¯y âŠ— Ix gÌ„xx + In âŠ— hÌ„0x gÌ„x0 H fÂ¯yÌ‚ Â· MÌ„x + In âŠ— hÌ„0x H fÂ¯xÌ‚ Â· MÌ„x
                                                                      

                                                          + (In âŠ— gÌ„x0 ) H fÂ¯y Â· MÌ„x + H fÂ¯x Â· MÌ„x , (23)

which can be solved for the unknown matrices gÌ„xx and hÌ„xx , given hÌ„x , gÌ„x , DfÂ¯ and H fÂ¯.
   We can then collect the remaining terms and obtain
            
     1    Â¯
  0 = Et DfyÌ‚ (gÌ„x âŠ— u0t ) hÌ„uu ut + gÌ„x hÌ„zz Ïƒz2 + gÌ„x hÌ„vv Ïƒv2 + 2gÌ„x hÌ„zu Ïƒz ut + Iy âŠ— u0t+1 gÌ„uu ut+1
                                                                                               
     2
                                                                                       
                          0      0                         2         2
                                   
              + Iy âŠ— Î¾t+1 hÌ„Î¾ gÌ„xx hÌ„Î¾ Î¾t+1 + gÌ„zz Ïƒz + gÌ„vv Ïƒv + 2gÌ„zu Ïƒz ut+1
                                                                                    
                + DfÂ¯xÌ‚ (Ix âŠ— ut ) hÌ„uu ut + hÌ„zz Ïƒz + hÌ„vv Ïƒv + 2hÌ„zu Ïƒz ut
                                     0                    2         2

                                                                                    
                 + DfÂ¯y (Iy âŠ— ut ) gÌ„uu ut + gÌ„zz Ïƒz + gÌ„vv Ïƒv + 2gÌ„zu Ïƒz ut
                                      0                   2         2

                                                                                                 
                  + In âŠ— Î¾t+1 hÌ„Î¾ gÌ„x H fÂ¯yÌ‚ Â· MÌ„Î¾ Î¾t+1 + In âŠ— Î¾t+1 hÌ„Î¾ H fÂ¯xÌ‚ Â· MÌ„Î¾ Î¾t+1 . (24)
                                0    0 0                                   0     0
                                                                                  


   Given a generic square matrix A, of order m, we define diagm(A) as the diagonal
matrix whose main diagonal is that of matrix A. Moreover, given a generic n Â· m Ã— m
matrix B consisting of n square matrices Bi stacked vertically, with i = 1, ..., n, we define
dgm(B) as the n Â· m Ã— m matrix that stacks vertically the m Ã— m diagonal matrices
diagm(Bi ):
                     dgm(B) = [diagm(B1 ) diagm(B2 ) ... diagm(Bn )]0 .

We can use the above operator to show, for generic and conformable matrices A and B:

                0
                    A0 BAÎ¾t+1 = Et trm I âŠ— Î¾t+10
                                                 A0 BAÎ¾t+1 =
                                                       
  Et       I âŠ— Î¾t+1
                               trm (I âŠ— A0 ) BAEt Î¾t+1 Î¾t+1
                                                        0
                                                              = trm [(I âŠ— A0 ) BAUt Ut0 ] ,
                                                          


where â€œtrmâ€ is the matrix trace operator defined earlier, and in the last equality we used
          0
Et (Î¾t+1 Î¾t+1 ) = Ut Ut0 , as implied by equation (3). Moreover, since Ut is a diagonal matrix
whose vector on the main diagonal is ut , the following also holds:

                    trm [(I âŠ— A0 ) BAUt Ut0 ] = trm {dgm [(I âŠ— A0 ) BA] Â· ut u0t } ,


                                                  11
from which we can conclude:
                       0
                         A0 BAÎ¾t+1 = trm {dgm [(I âŠ— A0 ) BA] Â· ut u0t } .
                           
             Et I âŠ— Î¾t+1                                                                            (25)

    Recall the definition of the process for the standard deviations:

                             ut+1 = Ïƒz (Iz âˆ’ Î›u )uÌ„ + Î›u ut + Ïƒv V Îµv,t+1 .

We can use the above definition to write the quadratic term in ut+1 in equation (24) as:
   n                      o         n 
 Et DfyÌ‚ âŠ— ut+1 gÌ„uu ut+1 = Et Ïƒz2 DfÂ¯yÌ‚ âŠ— uÌ„0 (Iz âˆ’ Î›u )0 gÌ„uu (Iz âˆ’ Î›u )uÌ„
        Â¯     0
                                                                

                + DfÂ¯yÌ‚ âŠ— u0t Î›0u gÌ„uu Î›u ut + Ïƒv2 DfÂ¯yÌ‚ âŠ— Îµ0v,t+1 V 0 gÌ„uu V Îµv,t+1
                                                                     
                                                                                       o
                                                             Â¯       0            0
                                                                                   
                                                  + 2Ïƒz DfyÌ‚ âŠ— uÌ„ (Iz âˆ’ Î›u ) gÌ„uu Î›u ut . (26)

    Using the above to collect all second-order terms in ut from equation (24), considering
equation (25) and exploiting the operators â€œtrmâ€ and â€œdgmâ€, we obtain the following
system of n Â· nz Ã— nz equations

  0 = DfÂ¯yÌ‚ Â· gÌ„x âŠ— Iz hÌ„uu + DfÂ¯yÌ‚ âŠ— Î›0u gÌ„uu Î›u + DfÂ¯xÌ‚ âŠ— Iz hÌ„uu + DfÂ¯y âŠ— Iz gÌ„uu
                                                                                    
                   h                                                                         i
           + dgm DfÂ¯yÌ‚ âŠ— hÌ„0Î¾ gÌ„xx hÌ„Î¾ + In âŠ— hÌ„0Î¾ gÌ„x0 H fÂ¯yÌ‚ Â· MÌ„Î¾ + In âŠ— hÌ„0Î¾ H fÂ¯xÌ‚ Â· MÌ„Î¾ , (27)
                                                                              


which can be solved for matrices gÌ„uu and hÌ„uu , given hÌ„x , gÌ„x , hÌ„xx , gÌ„xx , DfÂ¯ and H fÂ¯. Notice
that hÌ„uu and gÌ„uu will therefore consist of nx and ny , respectively, vertically stacked matrices
of dimensions nz Ã— nz which will be diagonal matrices.
    We can further collect terms in Ïƒz ut from equation (24), considering equation (26) and
using the trm operator, to obtain a set of n Ã— nz equations:

  0 = (DfÂ¯yÌ‚ Â· gÌ„x + DfÂ¯xÌ‚ )hÌ„zu + DfÂ¯yÌ‚ Â· gÌ„zu Î›u + DfÂ¯y Â· gÌ„zu + DfÂ¯yÌ‚ âŠ— uÌ„0 (Iz âˆ’ Î›u )0 gÌ„uu Î›u , (28)
                                                                                         


which can be solved for the unknown matrices gÌ„zu and hÌ„zu , given gÌ„x , gÌ„uu , and DfÂ¯.
    Similarly, we can collect the terms in Ïƒz2 obtaining a set of n Ã— 1 equations

  0 = (DfÂ¯yÌ‚ Â· gÌ„x + DfÂ¯xÌ‚ )hÌ„zz + (DfÂ¯yÌ‚ + DfÂ¯y )gÌ„zz
                          + 2DfÂ¯yÌ‚ Â· gÌ„zu (Iz âˆ’ Î›u )uÌ„ + DfÂ¯yÌ‚ âŠ— uÌ„0 (Iz âˆ’ Î›u )0 gÌ„uu (Iz âˆ’ Î›u )uÌ„, (29)
                                                                               


which can be solved for gÌ„zz and hÌ„zz , given gÌ„x , gÌ„zu , gÌ„uu , and DfÂ¯.
    Finally, we can collect the terms in Ïƒv2 obtaining a set of n Ã— 1 equations
                                                                     h                    i
           0 = (DfÂ¯yÌ‚ Â· gÌ„x + DfÂ¯xÌ‚ )hÌ„vv + (DfÂ¯yÌ‚ + DfÂ¯y )gÌ„vv + trm (DfÂ¯yÌ‚ âŠ— V 0 )gÌ„uu V ,        (30)

which deliver gÌ„vv and hÌ„vv , given gÌ„x , gÌ„uu , and DfÂ¯.

                                                    12
3        A model with time-varying variances
In this section we discuss a more parsimonious model with time-varying volatility in
which the volatility is modeled through an autoregressive linear process for conditional
variances rather than for conditional standard deviations, as in the previous section. The
only difference with respect to the previous model is in equation (4) which we now replace
with
                              u2t+1 = Ïƒz2 (Iz âˆ’ Î›u uÌ„2 ) + Î›u u2t + Ïƒv2 V Îµv,t+1 .                (31)

Each element of u2t is the corresponding squared value of each element of ut , which still
corresponds to the diagonal of matrix Ut as in (3); uÌ„ is a vector of dimension nz Ã—1 with uÌ„2
being a vector of the same dimension whose elements are each the square of the respective
element of uÌ„; V and Î›u are matrices of order nz Ã— nz , Îµv,t+1 is a vector of innovation of
dimension nz Ã— 1 which are assumed to have a bounded support and to be independently
and identically distributed with mean zero and variance/covariance matrix Iz ; Ïƒv and Ïƒz
are scalars with Ïƒv , Ïƒz â‰¥ 0.
       Differently from the previous model, it is now the conditional variance of each element
of the stochastic disturbances Î¾t+1 which is modeled as a linear process, (31). As a
consequence, the scale factors Ïƒz and Ïƒv have been appropriately squared.
       It is straightforward to show that a first-order approximation of this alternative model
is identical to that of the previous section except that now (4) replaces (31).
       Instead, a second order approximation will be of the form
                                          1                      1          1
                           yÌƒt = gÌ„x xÌƒt + (Iy âŠ— xÌƒ0t )gÌ„xx xÌƒt + gÌ„uu u2t + gÌ„zz Ïƒz2 ,           (32)
                                          2                      2          2
                                1                        1              1
               xÌƒt+1 = hÌ„x xÌƒt + (Ix âŠ— xÌƒ0t )hÌ„xx xÌƒt + hÌ„uu u2t + hÌ„zz Ïƒz2 + hÌ„Î¾ Î¾t+1 ,           (33)
                                2                        2              2
where the sizes of matrices gÌ„x , gÌ„xx , gÌ„zz , and hÌ„x , hÌ„xx , hÌ„zz , are the same as in the previous
section. Instead gÌ„uu and hÌ„uu are matrices of order ny Ã— nz and nx Ã— nz , respectively.13
       We now evaluate the second-order expansion (18), using equations (7) and (8) for the
second-order terms, taking into account (31), and the second-order guess solutions (32)
and (33) for the first-order terms, taking into account the restrictions implied by (10).
  13
       Notice that the expansion with respect to Ïƒv2 is zero up to second-order terms.




                                                       13
   We obtain:
             
     1
  0 = Et DfÂ¯yÌ‚ (gÌ„x âŠ— xÌƒ0t ) hÌ„xx xÌƒt + gÌ„x hÌ„uu u2t + gÌ„x hÌ„zz Ïƒz2 + gÌ„zz Ïƒz2
     2
                                                                                                 
                                  0                                 2              2           2
                                   
     + Iy âŠ— (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 ) gÌ„xx (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 ) + Ïƒz gÌ„uu (Iz âˆ’ Î›u )uÌ„ + gÌ„uu Î›u ut
                                                                                                  
          Â¯          0                     2          2           Â¯            0           2
     + DfxÌ‚ (Ix âŠ— xÌƒt ) hÌ„xx xt + hÌ„uu ut + hÌ„zz Ïƒz + Dfy (Iy âŠ— xÌƒt ) gÌ„xx xt + gÌ„uu ut + gÌ„zz Ïƒz  2



          + In âŠ— (gÌ„x hÌ„x xÌƒt + gÌ„x hÌ„Î¾ Î¾t+1 )0 H fÂ¯yÌ‚ Â· wÌƒt+1 + In âŠ— (hÌ„x xÌƒt + hÌ„Î¾ Î¾t+1 )0 H fÂ¯xÌ‚ Â· wÌƒt+1
                                                                                         
                                                                    
                    0 0       Â¯                        0     Â¯
          + (In âŠ— xÌƒt gÌ„x ) H fy Â· wÌƒt+1 + (In âŠ— xÌƒt ) H fx Â· wÌƒt+1 ,                                       (34)

From the above equations it is clear that matrices gÌ„xx and hÌ„xx are equivalent to those of
the previous model and satisfy equation (23).
  We can collect the remaining terms:
           
          Â¯                                                 0
 0 = Et DfyÌ‚ gÌ„x hÌ„uu u2t + gÌ„x hÌ„zz Ïƒz2 + gÌ„zz Ïƒz2 + Iy âŠ— Î¾t+1 hÌ„0Î¾ gÌ„xx hÌ„Î¾ Î¾t+1
                                                                    

                                                                                   
                     2                    2            2       Â¯           2
                + Ïƒz gÌ„uu (Iz âˆ’ Î›u )uÌ„ + gÌ„uu Î›u ut + DfxÌ‚ hÌ„uu ut + hÌ„zz Ïƒz       2

                                                                                                                      
                                      0
                                          hÌ„0Î¾ gÌ„x0       H fÂ¯yÌ‚ Â· MÌ„Î¾ Î¾t+1 + In âŠ—    0
                                                                                          hÌ„0Î¾       H fÂ¯xÌ‚ Â· MÌ„Î¾ Î¾t+1 . (35)
                                                                                                
                          + In âŠ—     Î¾t+1                                            Î¾t+1

   Given a generic nÂ·mÃ—m matrix A consisting of n square matrices Ai stacked vertically,
with i = 1, ..., n, we define dgv(A) as the m Ã— n matrix that stacks horizontally the main
diagonals of each of the m Ã— m matrices Ai :

                         dgv(A) = [diagv(A1 ) diagv(A2 ) ... diagv(An )],

where diagv(Ai ) is an m Ã— 1 vector collecting the elements on the main diagonal of Ai .
We can use the above operator, together with the matrix trace operator defined in the
previous section, to show, for generic and conformable matrices A and B:

                0
                    A0 BAÎ¾t+1 = Et trm I âŠ— Î¾t+1  0
                                                   A0 BAÎ¾t+1 =
                                                          
 Et        I âŠ— Î¾t+1
                                                                                         0
          trm (I âŠ— A0 ) BAEt Î¾t+1 Î¾t+1
                                   0
                                         = trm [(I âŠ— A0 ) BAUt Ut0 ] = dgv [(I âŠ— A0 ) BA] u2t .
                                     


   Using the above to express the quadratic terms in Î¾t+1 in equation (35) in terms of u2t ,
we collect the latter to obtain the following system of n Ã— nz conditions:

 0 = DfÂ¯yÌ‚ Â· gÌ„x + DfÂ¯xÌ‚ hÌ„uu + DfÂ¯yÌ‚ Â· gÌ„uu Î›u + DfÂ¯y Â· gÌ„uu
                        
                  h                                                                  i0
                       Â¯      0                    0 0      Â¯           0   Â¯
                                                                        
          + dgv DfyÌ‚ âŠ— hÌ„Î¾ gÌ„xx hÌ„Î¾ + In âŠ— hÌ„Î¾ gÌ„x H fyÌ‚ Â· MÌ„Î¾ + In âŠ— hÌ„Î¾ H fxÌ‚ Â· MÌ„Î¾ , (36)


                                                               14
which can be solved for matrices hÌ„uu and gÌ„uu .
    Finally, we can collect the terms in Ïƒz2 from equation (35), to show that matrices hÌ„zz
and gÌ„zz solve the following system of n Ã— 1 equations:

            0 = DfÂ¯yÌ‚ gÌ„x + DfÂ¯xÌ‚ hÌ„zz + DfÂ¯yÌ‚ + DfÂ¯y gÌ„zz + DfÂ¯yÌ‚ gÌ„uu (Iz âˆ’ Î›u ) uÌ„2 .
                                                    
                                                                                           (37)


4     Application: the neoclassical growth model
To apply our method to a simple example, we consider the standard neoclassical growth
model as it is also done in Schmitt-GroheÌ and Uribe (2004). We denote with Ct consump-
tion and with Kt the capital stock at the beginning of period t. The parameters Î², Î´, Î³ and
Î± represent (respectively) the subjective discount factor, the depreciation rate of capital,
relative risk aversion and the return to scale of capital in the production function. The
equilibrium conditions of the model are given by:


                         Kt+1 âˆ’ eat KtÎ± âˆ’ (1 âˆ’ Î´)Kt + Ct = 0                               (38)
                      (                                )
                                               Ct+1 âˆ’Î³
                                                
                         at+1 Î±âˆ’1
                    Et Î² Î±e Kt+1 + (1 âˆ’ Î´)                  âˆ’1=0                           (39)
                                                  Ct
                                      at+1 = Ïat + ut Îµa,t+1                               (40)

âˆ€t â‰¥ 0, given K0 and a0 = 0; where at denotes the log of the productivity shock. In
particular, the innovation Îµa,t+1 to the log-productivity process (40) is identically and
independently distributed process with mean zero and unitary variance; ut captures the
time-varying conditional standard deviation of at+1 and Ï is a parameter, with 0 â‰¤ Ï < 1.
We model the square of ut , i.e. the conditional variance of at+1 , as an exogenous stochastic
linear process
                             u2t+1 = (1 âˆ’ Î»)Ïƒa2 uÌ„2 + Î»u2t + Ïƒv2 Îµv,t+1                    (41)

with initial condition u20 = Ïƒa2 uÌ„2 where Î» is a coefficient such that 0 â‰¤ Î» < 1, while Ïƒa
and Ïƒv are non-negative scalars; uÌ„ is a positive parameter and the innovation Îµa,t+1 is
identically and independently distributed process with mean zero and unitary variance.
Notice that since Et (ut Îµa,t+1 ) = 0, the log-productivity process (40) is a conditionally
linear stochastic process.
    We can cast this model in the general notation of Section 2. Defining ct â‰¡ ln Ct ,




                                                15
kt â‰¡ ln Kt , we can write yt = [ct ] and xt = [kt , at ] and therefore
                                      ï£®                                                ï£¹
                                        Î² Î±eat+1 +(Î±âˆ’1)kt+1 + (1 âˆ’ Î´) eâˆ’Î³ct+1 âˆ’ eâˆ’Î³ct
                                                                     
                                      ï£¯                                                 ï£º
 Et {f (yt+1 , yt , xt+1 , xt )} = Et ï£¯
                                      ï£°     ekt+1 âˆ’ eat +Î±kt âˆ’ (1 âˆ’ Î´)ekt + ect         ï£º = 0. (42)
                                                                                        ï£»
                                                          at+1 âˆ’ Ïat

According to (5) and (6), a solution to (42) takes the form

                                     ct = g(kt , at , ut , Ïƒa , Ïƒv )                           (43)
                                    kt+1 = h(kt , at , ut, Ïƒa , Ïƒv )                           (44)
                                        at+1 = Ïat + Î¾t+1

with Î¾t+1 â‰¡ ut Îµa,t+1 and where the square of ut follows (41).
   In the non-stochastic steady-state, in which Ïƒa = Ïƒv = 0 and f (yÌ„, yÌ„, xÌ„, xÌ„) = 0, the
following system is used to solve for KÌ„ and CÌ„

                                       Î´ KÌ„ âˆ’ KÌ„ Î± âˆ’ CÌ„ = 0,

                                   Î² Î±KÌ„ Î±âˆ’1 + (1 âˆ’ Î´) = 1.
                                                     

Using the calibration of Schmitt-GroheÌ and Uribe (2004), i.e. Î² = 0.95, Î´ = 1, Î± = 0.3,
Ï = 0, Î³ = 2, we obtain:

                              KÌ„ = 0.1664,                 CÌ„ = 0.4175.

According to (7) and (8), a first-order approximation of (43) and (44) takes the form

                                         cÌƒt = gk kÌƒt + ga at                                  (45)

                                       kÌƒt+1 = hk kÌƒt + ha at                                  (46)

where we have defined cÌƒt â‰¡ ln Ct âˆ’ ln CÌ„, kÌƒ â‰¡ ln Kt âˆ’ ln KÌ„ and the coefficients gk , ga , hk
and ha coincide with those of Schmitt-GroheÌ and Uribe (2004):

                                  gk = 0.2525, ga = 0.8417
                                 hk = 0.4191, ha = 1.3970.

   However, there is an important difference between our approximation and that of
Schmitt-GroheÌ and Uribe (2004). In our case, at follows the conditionally-linear and
heteroskedastic process (40), in which the conditional variance is modelled as in (41). In

                                                  16
their framework, instead, shocks are homoskedastic and at follows the following linear
process:
                                      at+1 = Ïat + Ïƒa uÌ„Îµa,t+1 .                              (47)

In Fernandez-Villaverde et al. (2009, 2010) the original stochastic process for the exoge-
nous state variables is heteroskedastic as in (11) and (12), but a linear approximation of
this process would be consistent with (47) in which risk is no longer time-varying. Instead,
in our first-order approximation stochastic volatility still matters and will be particularly
relevant when estimating the model, as it is done in Justiniano and Primiceri (2008).
   However, as mentioned in section 2.2, in our first-order approximation risk does not
play a â€œdistinct and directâ€ role. To see this point, we discuss the impulse response
functions. Defining the impulse response of a generic variable xt at time t + j with respect
to the shock Îµt as
                                       âˆ‚(Et xt+j âˆ’ Etâˆ’1 xt+j )
                              I(xt+j |Îµt ) =                   ,
                                                 âˆ‚Îµt
we obtain that the impulse response with respect to the shock Îµa,t is given by

                          I(cÌƒt+j |Îµa,t ) = gk I(kÌƒt+j |Îµa,t ) + ga I(at+j |Îµa,t )

                        I(kÌƒt+j+1 |Îµa,t ) = hk I(kÌƒt+j |Îµa,t ) + ha I(at+j |Îµa,t )

for each j > 0 with I(kÌƒt |Îµa,t ) = 0 where

                                   I(at+j+1 |Îµa,t ) = ÏI(at+j |Îµa,t )

for each j > 0 and
                                           I(at |Îµa,t ) = Ïƒa uÌ„.

The impulse response with respect to the shock Îµa,t will not be affected by the fact that
shocks are heteroskedastic or not and therefore will coincide with those of Schmitt-GroheÌ
and Uribe (2004). However, even if we compute the impulse response with respect to
risk, i.e. with respect to the shock Îµv,t , this will be zero at all times: I(cÌƒt+j |Îµv,t ) = 0 and
I(kÌƒt+j |Îµv,t ) = 0 for each j > 0. Therefore risk will not play a distinct and separate role in
affecting the variables of interest even in our first-order approximation. To get this role,
we need to go to a second-order approximation.
   Following (32) and (33), the second-order approximation will be of the form
                                   1         1          1                      1
             cÌƒt = gk kÌƒt + ga at + guu u2t + gkk kÌƒt2 + gaa a2t + gka at kÌƒt + gÏƒÏƒ Ïƒa2
                                   2         2          2                      2
                                   1         1          1                      1
           kÌƒt+1 = hk kÌƒt + ha at + huu u2t + hkk kÌƒt2 + haa a2t + hka at kÌƒt + hÏƒÏƒ Ïƒa2
                                   2         2          2                      2
                                                    17
where again at follows (40) and u2t follows (41). To compute the numerical values for
the remaining coefficients, we consider the calibration adopted by Schmitt-GroheÌ and
Uribe (2004) for the structural parameters, and Ïƒa = Ïƒv = uÌ„ = 1 and Î» = 0.5 for the
parameters entering equation (41) and governing the dynamics of stochastic volatility.
This calibration implies:

 guu = âˆ’0.1444,           gkk = âˆ’0.0051,         gaa = âˆ’0.0569,           gka = âˆ’0.0171,    gÏƒÏƒ = âˆ’0.0478,
 huu = 0.3622,          hkk = âˆ’0.0070,         haa = âˆ’0.0778,            hka = âˆ’0.0233,     hÏƒÏƒ = 0.1199.

It is also clear that second-order-approximation impulse response function with respect to
the shock Îµa,t will not be affected by the fact that shocks are heteroskedastic or not and
therefore will correspond to those of Schmitt-GroheÌ and Uribe (2004). Instead, now there
is a distinct role for risk to affect the variables of interest. Indeed, the impulse responses
with respect to the shock Îµv,t will be of the form

                              I(cÌƒt+j |Îµv,t ) = gk I(kÌƒt+j |Îµv,t ) + guu I(u2t+j |Îµv,t )

                             I(kÌƒt+j+1 |Îµv,t ) = hk I(kÌƒt+j |Îµv,t ) + huu I(u2t+j |Îµv,t )

for each j > 0 with I(kÌƒt |Îµv,t ) = 0 where

                                        I(u2t+1+j |Îµv,t ) = Î»I(u2t+j |Îµv,t )

for each j > 0 and
                                                 I(u2t |Îµv,t ) = Ïƒv2 .

Obviously, in Schmitt-GroheÌ and Uribe (2004) there is no role at all for time-varying
volatility while in Fernandez-Villaverde et al. (2009, 2010) there will not be a distinct
role and therefore impulse responses with respect to Îµv,t will be zero. To get this role,
they have to go to higher-order approximations.
       In Figure 1 we show the impulse response of consumption and capital to 1% change in
risk to productivity shock. The impact response of consumption and investment depends
on the relative strength of two opposite forces. On the one hand, higher volatility tends
to increase the supply of saving for future production and therefore for precautionary
reasons.14 On the other hand, higher volatility increases the expected excess return on
capital reducing its appeal as an asset to accumulate. Under our parametrization, in par-
ticular with Î´ = 1, the precautionary-saving effect dominates and on impact consumption
  14
       This channel is stronger when the depreciation is larger, and is clearly dominant with full depreciation.


                                                         18
 0.25                                                       1
                                  consumption                                  variance of prod. shocks
                                  capital
                                                          0.9
  0.2

                                                          0.8


 0.15
                                                          0.7


                                                          0.6
  0.1

                                                          0.5

 0.05
                                                          0.4


                                                          0.3
       0


                                                          0.2

Ã¯0.05
                                                          0.1


 Ã¯0.1                                                       0
           0   2     4        6         8       10              0     2        4          6     8         10




Figure 1: Dynamic response of consumption and capital to a 1% innovation to the variance of produc-
tivity shocks. Percentage points.


decreases while investment rises.15 In the following periods because of capital accumu-
lation, production and consumption increase above their steady state levels as long as
agents still accumulate capital above steady state.
       As we have already discussed, another important advantage of our approach with
respect to Schmitt-GroheÌ and Uribe (2004) and Fernandez-Villaverde et al. (2009, 2010)
is that risk-premia evaluated using first-order approximation will be time-varying. To see
this, let rt+1 be the risk-free real rate, and define rk,t+1 as the return on capital from
period t to period t + 1:

                                  rk,t+1 = Î±eat+1 +(Î±âˆ’1)kt+1 + (1 âˆ’ Î´).

Using the above, we can show that in a second-order approximation the expected excess
return of capital is given by
                                           1
                    Et (rÌƒk,t+1 âˆ’ rÌƒt+1 ) + vart (rÌƒk,t+1 ) = Î³covt (rÌƒk,t+1 , âˆ†cÌƒt+1 )
                                           2
where rÌƒk,t+1 and rÌƒt+1 denote the log deviation from steady state of the real return on capital
and the risk-free rate, respectively. The right-hand side measures the risk premium and
  15
     When Î³ = Î´ = 1, saving is always a constant fraction of income and therefore risk does not have a
distinct role.




                                                     19
this will be time-varying because

covt (rÌƒk,t+1 , âˆ†cÌƒt+1 ) = Ï†covt (at+1 + (Î± âˆ’ 1)kÌƒt+1 , gk kÌƒt+1 + ga at+1 )
                             h                                                         i
                                      2                                             2
                         = Ï† Et ga at+1 + ((Î± âˆ’ 1)ga + gk )kÌƒt+1 at+1 + (Î± âˆ’ 1)gk kÌƒt+1
                                               h                   i h                    i
                                            âˆ’Et at+1 + (Î± âˆ’ 1)kÌƒt+1 Et gk kÌƒt+1 + ga at+1

                     = Ï†ga u2t

which will indeed depend on the time-variation of the variance u2t , where Ï† â‰¡ 1 âˆ’ Î²(1 âˆ’ Î´).
In Schmitt-GroheÌ and Uribe (2004) and Fernandez-Villaverde et al. (2009, 2010), this
risk premium, computed using a first-order approximation, will be constant.


5     Conclusion
Recent models used in macroeconomics examine the role of stochastic volatility for the
equilibrium allocation. To solve these models, researchers have appealed to global solu-
tions or high-order approximation techniques. Global-solution techniques suffer from the
â€˜curse of dimensionalityâ€™, since the number of state variables limits their computational
efficiency. Commonly used approximation techniques require third-order expansion of the
equilibrium conditions in order to display a distinct role for stochastic volatility.
    Here we propose a first and second-order approximation method to study the role
of time-varying exogenous risk in discrete-time dynamic stochastic models which en-
compass standard dynamic general equilibrium models with rational expectations. In
our framework, an important assumption is that the exogenous state variables follow a
conditionally-linear stochastic process in which either the variance or the standard devi-
ation of the primitive shocks are modelled through a stochastic linear process. In this
way, we generalize the framework and the method developed by Schmitt-GroheÌ and Uribe
(2004), Kim et al. (2008) and Gomme and Klein (2008) to the case in which the exogenous
state variables follow an heteroskedastic process.
    The main contribution of our paper is to show that first and second-order approxi-
mations of the solution are sufficient to capture most of the relevant elements needed to
study the impact of uncertainty in standard macroeconomic models. There are three main
advantages following our method. First, a first-order approximation falls in the broader
class of conditionally-linear approximations displaying a role for time-varying volatility,
although not a distinct one. Second, given that a first-order approximation retains a role

                                              20
for stochastic volatility, the second-order approximation of the solution implies that the
time-varying volatility of primitive shocks can directly affect the endogenous variables.
Third, it follows from the previous results that risk-premia evaluated using first-order
approximations will be time-varying. All these advantages translate into a more parsimo-
nious model, more easily tractable for estimation purposes.
      In addition to characterizing the second-order approximation of the solution when
shocks are conditionally linear, the paper offers a set of MATLAB codes designed to
compute the coefficients of the first and second-order approximations and provides a
simple example to illustrate the applicability of the method.16 In general, indeed, our
method can be applied easily to several macroeconomic models ranging from real business
cycle models, to monetary models and also to asset-pricing or finance models. In Benigno
et al. (2010), we employ this method to analyze how risk and monetary policy interact to
determine prices, exchange rates and asset prices in an open-economy model.




 16
      The set of codes is available under the webpage of the authors.


                                                    21
References
 [1] Amisano, Gianni. and Oreste Tristani (2009), â€œA DSGE Model of the Term Structure
    with Regime Shifts,â€ mimeo, European Central Bank.

 [2] An, Sungbae and Frank Schorfheide (2007),. â€œBayesian Analysis of DSGE Models,â€
    Econometric Reviews, vol. 26(2-4), pages 113-172.

 [3] Benigno, Gianluca, Pierpaolo Benigno, Salvatore NisticoÌ€ (2010), â€œRisk, Monetary
    Policy and the Exchange Rate,â€ in preparation for the NBER Macroeconomic Annual
    2011.

 [4] Benigno, Pierpaolo and Michael Woodford (2008), â€œLinear-Quadratic Approxima-
    tion of Optimal Policy Problemsâ€ Discussion Papers 0809-01, Columbia University,
    Department of Economics.

 [5] Bloom, Nicholas (2009). â€œThe Impact of Uncertainty Shocks,â€ Econometrica, vol.
    77(3), pages 623-685.

 [6] Bloom, Nicholas, Nair Jaimovich and M. Floetotto (2009), â€œReally Uncertain Busi-
    ness Cycles,â€ unpublished manuscript.

 [7] van Binsbergen, Jules, Jesus Fernandez-Villaverde, S.J. Koijen and Juan F. Rubio-
    Ramirez (2010), â€œThe Terms Structure of Interest Rates in a DSGE Model with
    Recursive Preferences,â€ unpublished manuscript.

 [8] Fernandez-Villaverde, Jesus, Pablo Guerron-Quintana, Juan F. Rubio-Ramirez and
    Martin Uribe (2009), â€œRisk Matters: The Real Effects of Volatility Shocks,â€ NBER
    Working Paper No. 14875.

 [9] Fernandez-Villaverde, Jesus, Pablo Guerron-Quintana and Juan F. Rubio-Ramirez
    (2010), â€œFortune or Virtue: Time-Varian Volatilities Versus Parameter Drifting in
    U.S. Data,â€ unpublished manuscript.

[10] Gomme, Paul and Paul Klein (2008), â€œSecond-order approximation of dynamic mod-
    els without the use of tensors,â€ forthcoming Journal of Economic Dynamics and
    Control

[11] Justiniano Alejandro and Giorgio Primiceri (2008), â€œThe Time Varying Volatility of
    Macroeconomics Fluctuations,â€ American Economic Review 98, 604-641.

                                            22
[12] Kim Jinill, Sunghyun Kim, Ernst Schaumburg, Christopher A. Sims (2008), â€œCalcu-
    lating and Using Second-Order Accurate Solutions of Discrete Time Dynamic Equi-
    librium Models,â€ Journal of Economic Dynamics and Control, Volume 32, Issue 11,
    pp. 3397-3414.

[13] Krusell, Per and Anthony A. Smith & Jr. (1998), â€œIncome and Wealth Heterogeneity
    in the Macroeconomy,â€ Journal of Political Economy, vol. 106(5), pages 867-896.

[14] Magnus, Jan and Heinz Neudecker (1999). Matrix Differential Calculus With Appli-
    cations in Statistics and Econometrics, John Wiley and Sons.

[15] Rudebusch, Glenn D. and Eric T. Swanson (2008), â€œThe Bond Premium in a DSGE
    Model with Long-Run Real and Nominal Risks,â€ unpublished manuscript, Federal
    Reserve Bank of San Francisco.

[16] Schmitt-GroheÌ Stephanie and Martin Uribe (2004), â€œSolving Dynamic General Equi-
    librium Models using a Second-Order Approximation to the Policy Function,â€ Jour-
    nal of Economic Dynamics and Control 28, pp. 755-775.




                                         23
