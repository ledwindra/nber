NBER WORKING PAPER SERIES

ESTIMATION OF RANDOM COEFFICIENT DEMAND MODELS:
CHALLENGES, DIFFICULTIES AND WARNINGS
Christopher R. Knittel
Konstantinos Metaxoglou
Working Paper 14080
http://www.nber.org/papers/w14080

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2008

We have benefited greatly from conversations with Steve Berry, Severin Borenstein, Michael Greenstone,
Phil Haile, Aviv Nevo, Hal White, Frank Wolak, Catherine Wolfram, and seminar participants at the
University of Calgary, University of California at Berkeley, the University of California Energy Institute,
and the 2008 NBER Winter IO meeting. Metaxoglou acknowledges financial support from Bates White,
LLC. We are also grateful to Bates White, LLC for making their computing resources available. All
remaining errors are ours. The views expressed herein are those of the author(s) and do not necessarily
reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2008 by Christopher R. Knittel and Konstantinos Metaxoglou. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including © notice, is given to the source.

Estimation of Random Coefficient Demand Models: Challenges, Difficulties and Warnings
Christopher R. Knittel and Konstantinos Metaxoglou
NBER Working Paper No. 14080
June 2008
JEL No. C1,C61,C81,L1,L4
ABSTRACT
Empirical exercises in economics frequently involve estimation of highly nonlinear models. The criterion
function may not be globally concave or convex and exhibit many local extrema. Choosing among
these local extrema is non-trivial for a variety of reasons. In this paper, we analyze the sensitivity of
parameter estimates, and most importantly of economic variables of interest, to both starting values
and the type of non-linear optimization algorithm employed. We focus on a class of demand models
for differentiated products that have been used extensively in industrial organization, and more recently
in public and labor. We find that convergence may occur at a number of local extrema, at saddles and
in regions of the objective function where the first-order conditions are not satisfied. We find ownand cross-price elasticities that differ by a factor of over 100 depending on the set of candidate parameter
estimates. In an attempt to evaluate the welfare effects of a change in an industry's structure, we undertake
a hypothetical merger exercise. Our calculations indicate consumer welfare effects can vary between
positive values to negative seventy billion dollars depending on the set of parameter estimates used.

Christopher R. Knittel
University of California, Davis
Department of Economics
One Shields Ave
Davis, CA 95616
and NBER
crknittel@ucdavis.edu
Konstantinos Metaxoglou
Bates White LLC
kmetaxoglou@ucdavis.edu

1

1

Introduction

1.1

What this paper is about

Empirical research in economics often requires estimating highly nonlinear models, where the
objective function may not be globally concave or convex. Obtaining parameter estimates in
these cases requires a nonlinear search algorithm along with sets of starting values and stopping
rules. For a common class of demand models used in industrial organization, and more recently
in labor and public economics, we …nd that termination of many popular nonlinear search algorithms may occur at local extrema, saddles points, as well as in regions of the objective function
where the …rst-order conditions for optimality fail. Furthermore, parameter estimates and measures of market performance, such as price elasticities, exhibit notable variation depending on
the combination of the algorithm and starting values in the optimization exercise at hand.
Our …ndings highlight the importance of verifying both the …rst- and second-order conditions for a local optimum, and emphasize that researchers often face the dilemma of choosing
among local extrema— a non-trivial task for several reasons.1 First, if the true parameter vector achieves the global extremum, then proofs of consistency require the researcher to …nd the
global extremum associated with the sample. Unfortunately, there is no guarantee that one
of the local extrema is the global one. Second, there are cases where the global extremum
may not be consistent and there is little or no statistical guidance as to which of the local
extrema is the consistent one.2 Additionally, consistency proofs are local in nature; they may
say little about the behavior of the objective function outside of the neighborhood where the
true parameter vector lies. Finally, even in cases where the global extremum is the consistent
root and the econometrician is convinced she has uncovered it for her sample, this root may not
remain the global extremum as the sample changes or grows. The possibility of such a “horse
race” implies that reported standard errors may misrepresent the true uncertainty regarding
parameter estimates if they ignore issues of multiple extrema.
According to our results, the design of the optimization exercise undertaken by an empirical
economist may have large e¤ects on the economic variables of interest. The di¢ culties of
1

For a compact discussion of consistency theorems regarding extremum estimators, see Section 5.3 in Cameron
and Trivedi (2005). Amemiya (1985) using a mixture of normals provides an example of an inconsistent global
MLE. In the same example, a root of the likelihood equation may be consistent (example 4.2.2, pg. 119).
McFadden and Newey (1994) provide an in-depth discussion of the large-sample properties for popular clasess
of extremum estimators, such as MLE, NLS and GMM.
2
Amemiya (1985) mentions two ways for gaining con…dence that a local extremum is a consistent root: (1)
if the solution gives a reasonable value from an economic-theoretic viewpoint and (2) if the iteration by which
the local extremum was obtained started from a consistent estimator.

2
uncovering the global extremum of a nonlinear objective function are widely known and even
discussed in …rst-year econometrics courses. However, to our knowledge, these di¢ culties have
not been publicized to the extent that they should, at least, among empirical economists. We
rarely discuss the details of our optimization exercises. In most cases, we fail to show how
the conclusions of our work change under alternative sets of parameters. Gradient norms and
Hessian eigenvalues are almost never reported. The purpose of this paper is to convey that a
thorough optimization exercise and a clear documentation of its design are as important to the
conclusion of an empirical study as the identi…cation strategy.
We draw our examples from a speci…c class of discrete-choice demand models for di¤erentiated products which have been particularly popular since the seminal work by Berry, Levinsohn
and Pakes (1995), henceforth, BLP. The BLP-type random coe¢ cient logit model allows for
more realistic substitution patterns across products compared to the simple or nested logit.
Consumer heterogeneity exists not only through a mean-zero logit term, but also through variation in willingness to pay for particular attributes of the products under consideration, due to
the inherent horizontal di¤erentiation of products. Faced with a change in one of the characteristics of their most preferred product, consumers are more likely to switch to products with
similar attributes.
Answers to a variety of important economic questions have been provided using BLP-type
models. Estimation of market power, merger analysis, examining the e¤ects of international
trade policies and new product valuation, to name a few, have extensively drawn their conclusions based on BLP-type demand systems.3 More recently, the analysis of dynamic purchase
decisions, such as those associated with durable goods or inventories, rely on BLP-type of models as their starting point.4 Finally, researchers modeling school and housing choices have used
BLP-type models.5
Estimation of a BLP-type model is a non-trivial optimization problem, even in a lowdimension parameter space. This is primarily due to the highly nonlinear nature of the structural error term inferred by equating observed to estimated market shares of the products under
consideration, which requires an empirical approximation. To highlight these di¢ culties, we
3

For example: new good valuation (Petrin [2004]); trade policies (BLP [1999]); mergers (Nevo [2000b]);
construction of price indices that account for quality changes and product introductions (Nevo [2003]). Brenkers
and Verboven (2006) extend the individual-level logit of BLP to nested logit to examine the e¤ects of the car
industry restructuring in the EU.
4
For dynamic extensions of the BLP model see, for example, Hendel and Nevo (2006), Gowrisankaran and
Rysman (2008).
5
For school choice, see Hastings, Kane and Staiger (2007). For housing choices, see Bayer and McMillan
(2005) and Bayer, McMillan and Rueben (2005).

3
use two di¤erent publicly data sets. The …rst data set is from BLP. The second is the one used
by Nevo (2000a). For each data set, we engage in a thorough estimation exercise employing 10
di¤erent optimization algorithms using 50 di¤erent starting values for each algorithm; that is,
we estimate the same model 500 times for each data set.
All algorithms are prone to uncover local minima, saddles and to terminate at regions
with non-zero gradients. The parameter estimates across the local minima and termination
points vary greatly both within and across algorithms; more importantly, the variation in
parameter values is also economically important. Price elasticities can vary by two orders of
magnitude across the sets of estimates implied by di¤erent algorithm-starting values pairs.
The interquartile ranges of a given product’s own-price elasticity often do not overlap across
the di¤erent algorithms. Even when we focus on the set of starting values yielding the lowest
objective function value within each algorithm across the 50 sets of starting values, the estimated
own-price elasticities may vary by an order of magnitude. We …nd even greater variation for
estimated cross-price elasticities.
The variation across algorithms that exists when we employ 50 starting values makes it clear
that a “multi-start”approach to estimation (see, Andrews [1997]), where the researcher uses a
single algorithm but many starting values, may not be su¢ cient. Depending on the termination
criteria used, we …nd that one algorithms does not …nd our “global”minimum across both data
sets; algorithms that perform well for one data set, may perform very poorly in another.
To further highlight the importance of these issues, we analyze the welfare consequences
of two hypothetical mergers. The di¤erences in parameter estimates can have equally large
e¤ects on the implied consumer welfare consequences of a merger; in short, we …nd anything
is possible, from nearly no e¤ect on consumers to large welfare consequences. Much of this
variation remains even when we estimate the model 50 times for each algorithm and select the
parameter estimates that correspond to the set of starting values that give rise to the smallest
value of the objective function within the same algorithm.
Multiple extrema and saddles are the by-product of the nonlinear nature of the model; if
the objective function is not globally concave (convex), by de…nition, multiple extrema and/or
saddles will exist. We stress that our results are not due to weak identi…cation. Weak identi…cation leads to the objective function being relative ‡at at the consistent root (Stock and Wright
[2000]). This may lead to algorithms stopping at multiple places around a local extremum,
which will generate some of the variation that we observe. However, we are unaware of any
research showing that weak identi…cation causes multiple extrema or saddles; we clearly …nd

4
both in the data. For this to be true, strong identi…cation would somehow have to lead the
objective functions of nonlinear models to be globally concave/convex, as in a linear model.
We also stress that the variation we uncover due to multiple extrema is not captured in
typical standard error calculations. Reported standard errors are a function of the curvature of
the objective function at the local extremum and do not account for the presence of multiple
extrema. If consistent estimation requires …nding the global extremum and multiple extrema
exist, the small sample global minimum may change as the sample changes. While this is
beyond the scope of the paper, we speculate that this may generate con…dence intervals that
are potentially disjoint; at the very least, they would be functions of these other local minima.
Our work is also related to a literature analyzing nonlinearities in econometric objective
functions. The spirit of our paper is closest to McCullough and Vinod (2003), which illustrates
the potential problems associated with …nding the solution to a maximum likelihood estimator.
The authors have four recommendations for researchers: examine the gradient, the solution
path, the eigensystem and the accuracy of the quadratic approximation. While we do not
focus on standard error calculations, hence do not emphasize the fourth, we illustrate that
verifying the …rst- and second- order conditions are paramount. McCullough and Vinod also
call for a more thorough analysis of the eigensystem, focusing on the condition number, the
ratio of the largest to smallest Hessian eigenvalue. A large condition number may indicate an
ill-conditioned Hessian, suggesting inaccurate results. Although, Shachar and Nalebu¤ (2004)
and Drukker and Wiggins (2004) ultimately showed that some of the claims regarding the
speci…c empirical application from McCullough and Vinod were unwarranted, their general
point remains. Applied researchers should more thoroughly analyze their proposed solutions
and report this analysis. In our view this advice has been largely ignored. Unlike McCullough
and Vinod, our goal is not to address the accuracy of speci…c published results; our paper is
not a replication or validation exercise. Our hope is that this work will move the profession
in the direction of discussing some of the issues and di¢ culties related to estimating nonlinear
models. We focus on one class of models, but believe a number of our messages apply to
nonlinear models in general.
Finally, the paper is related to a literature chronicling some negative properties of GMM
estimators; although we do not work out the econometric theory behind our empirical results.
A number of studies have documented that GMM estimators in over-identi…ed models may
exhibit substantial biases.6 In addition, when instruments are either weak or many, the criterion
6

See, for example, Hansen, Heaton and Yaron (1996), Altonji and Segal (1996), Burnside and Eichenbaum
(1996) and Pagan and Robertson (1997).

5
function may exhibit plateaus or ridges. This is consistent with some of our results since, in
practice, nonlinear search algorithms may “get stuck” at di¤erent points on these plateaus.7
Finally, because over-identi…ed models require an estimate of the moment weighting matrix,
researchers often rely on a two-step estimator for the weighting matrix. The weighting matrix in
the …rst step is some positive de…nite matrix, which yields consistent but ine¢ cient parameter
estimates. The second-step weighting matrix uses the consistent estimates from the …rst step to
form the …nal weighting matrix. Given that the initial weighting matrix is somewhat arbitrary,
results may di¤er across researchers.

1.2

What this paper is not about

There are a lot of important topics that this paper does not address. First, this paper does not
improve upon or teach existing nonlinear search methods. Our goal is simply to use existing
techniques and apply them to a common class of models in industrial organization. Second,
while we believe the topic to be of upmost importance, we say nothing about inference in
the context of multiple extrema. When drawing inferences, the existing literature assumes
away multiple extrema. Standard errors are calculated using only information about the local
extremum. As noted above, we conjecture that consistent inference will, at least in part, be
a function of the multiple extrema. The closer the objective function values are across the
extrema, the more relevant these issues become.
Finally, our goal is not to discourage the use of structural econometric models that very often
go at hand with nonlinear optimization methods. We want to encourage the use of thorough
optimization designs, as well as the documentation of alternative sets of parameters meeting the
conditions of local extrema. It would be unfortunate for our work to be viewed as a campaign
against a structural approach in empirical analyses, that is invaluable addressing certain types
of economic questions, such as those surrounding the welfare implications of market structures.
7

See, for example, Angrist and Kreuger (1991), Bekker (1994), Bound, Jaeger and Baker (1995), Staiger and
Stock (1997), Stock and Wright (2000) and Stock, Wright and Yogo (2002).

6

2

The Model and Estimation

The starting point of a BLP-type demand model is an indirect utility function. A consumer i
derives utility from a product j in market t:
uijt = xjt

i pjt

i

+

jt

+ "ijt ;

where pjt is the product’s price, xjt is a vector of non-price product characteristics, and

(1)

jt

includes the unobserved to the econometrician features of the product, such as after-sale services
and image. The logit error term "ijt captures unobserved consumer heterogeneity.8 Consumer
heterogeneity is also captured by the individual-speci…c coe¢ cients associated with price and
other observed product characteristics, which may be written as:
"

i
i

#

=

"

#

+ Di + vi ; Di v PD (D) ; vi v Pv (v) ;

(2)

where Di is a vector of demographic variables, vi is a random variable capturing other nonobservable characteristics of the consumer and
elements of

and

are matrices of parameters. The

measure the importance of the demographic variables in shaping preferences,

“observed variation”, while

captures “unobserved” variation in preferences. Demographics

were introduced in Nevo’s work (e.g., Nevo [2001]); BLP captured heterogeneity only through
the vs. Following Nevo (2000a), we decompose the expression in (1) into a component that is
common across all consumers and a component that highlights their heterogeneity:
uijt = xjt
|

XK
XK
pjt + jt +
Dik k +
vik k + "ijt = Vijt + "ijt :
k=1
{z
} | k=1
{z
}
jt (xjt ; jt ; 1 )
ijt (xjt ;vi ; 2 )

The …rst term with associated parameters

1

while the second, with associated parameters

(3)

enters linearly in the GMM objective function,
2

enters in a nonlinear fashion. Consumers

purchase the product that yields the highest utility among the products available. The purchase
decisions are limited to a single product. The set of consumers that purchase product j is given
by:
Ajt (xjt ;

jt ; 2 )

= f(vi ; "i0t ; :::; "iJt ) juijt

uilt ; 8l 6= jg :

(4)

Therefore, the market share for product j is the probability that Ajt obtains, which under
8

This speci…cation ignores income e¤ects, which may be important depending on the application.

7
appropriate independence assumptions may be expressed as:
sjt (xjt ;

jt ; 2 )

=

Z

dP (D; v; ") ;

Ajt

=

Z

dP ("jD; v) dP (vjD) dPD (D) =

Z

dP" (") dPv (v) dPD (D) : (5)

Ajt

Ajt

For the purpose of estimation, distributional assumptions for "; v and D are necessary. The
vast majority of the literature assume extreme value and standard normal distributions for "
and v; respectively. Nevo draws demographics from the empirical distribution of the Current
Population Survey as opposed to a parametric distribution.
Estimation follows Berry (1994). For a given

2,

there is a vector of mean utilities, ,

that equates predicted market with observed market shares. We can then decompose this
vector of s into the mean level of observed utility, x

p, and unobserved quality, . The

vector of unobserved product quality becomes a “GMM-like” structural error term and the
econometrician can readily handle endogenous characteristics. Endogeneity of at least a subset
of characteristics is an issue because unobserved quality is known to the …rms and consumers.
Therefore, we would expect any product characteristic that is easily adapted, such as price, to
be correlated with .9
Formally, if we de…ne

= ( 1;

2 ),

the structural error term is a function of . Given an

appropriate set of instruments, Z, parameter estimation is a nonlinear GMM problem, with the
parameter vector

solving:
^ = arg min ( )0 Z

where

is a consistent estimate of E [Z 0

0

1

Z0 ( ) ;

(6)

Z]. Integrating out the logit error ", and assuming

simulation of purchase decisions for ns individuals implies:
1 X
sjt (xjt ; jt ; Pns ; 2 ) =
sijt ;
(7)
ns i=1
h
i
P
k
k
exp jt + K
x
v
+
D
+
:::
+
D
k
k1
i1
kd
id
i
k=1 jt
h
i:
sijt (xjt ; jt ; Pns ; 2 ) =
PJ
PK k
1 + m=1 exp mt + k=1 xmt k vik + k1 Di1 + ::: + kd Did
ns

The individual market shares sijt are functions of
2,
9

there is a

jt

jt

and

2

only. More precisely, for a given

that equates observed market shares with predicted market shares for all j

In principle, if the terms are serially correlated we might worry about other characteristics to also be
endogenous. For example, if Ford vehicles have a history of being unreliable, Ford may endogenously change
their engine characteristics.

8
and t. The di¤erence

jt

xjt de…nes the structural error term:
jt

=

jt

(St ;

2)

(8)

xjt :

As opposed to the simple and nested logit and the Generalized Extreme Value models, where
analytical expressions for are readily available, the random coe¢ cient logit employs a contraction mapping that solves for the vector of mean utilities

that equates observed to predicted

market shares with a kth iterate given by:

(k+1)
:t

=

(k)
:t

+ ln S:t

ln S (x:t ;

(9)

:t ; Pns ; 2 ) :

The empirical solution to the …xed point iteration in (9) yields an empirical approximation to
the nonlinear market share functions used for estimation. Estimation requires a nonlinear search
to …nd

1

and

2

that minimize the GMM objective function in (6). Because the structural

error term is linear in

1,

concentrating out

1

and searching only over

and

2

alleviates some

of the computational burden associated with the nonlinear search. In more detail: a new iterate
of

2

gives rise to a new vector of mean utilities , which implies a new iterate for

iterate for

3

1

1:

The new

is derived using linear IVs.

Computer Code and Search Algorithms

For our optimization exercises, we adapted the code used by Nevo (2000a), written in the
Matlab matrix language developed by Mathworks.10 For a given set of starting values, a few
lines of the main body of the code used by Nevo had to be altered to accommodate the setup of
the search algorithms used. The bulk of the changes automate loops through 50 starting values
and ten algorithms. Given an algorithm, we require a set of starting values and stopping rules.
The starting values for the mean utility vector

are the …tted values of a simple logit after

adding draws from a zero-mean normal distribution with a standard deviation equal to the
standard error of the logit regression; therefore, the variation in the starting values represents
regression error plausibly obtained by across researchers. For the vector of coe¢ cients

2

of

variables entering the nonlinear part of the utility function in (3), we use draws from a standard
normal distribution; this represents the fact that little is known about the magnitude of
priori.
10

Available at http://www.econ.ucdavis.edu/faculty/knittel/

2

a

9
We employ ten search algorithms that are either derivative-based or direct search routines.
The former utilize some information about the steepness and the curvature of the objective
function, without necessarily keeping track information associated with the Hessian. The latter
are based on function evaluations and are divided into deterministic and stochastic depending
on whether or not they include a random component in their searches. Four of our algorithms
are derivative based; three are deterministic direct-search methods; and, three are stochastic
direct-search algorithms. All the algorithms are coded in Matlab. The codes for …ve of the
algorithms are part of the Mathworks Optimization and Genetic Algorithm and Direct Search
(GADS) toolboxes. The codes for the remaining algorithms are publicly available from their
authors.
Two of our derivative-based algorithms are quasi-Newton, the third is a conjugate gradient, while the fourth comes from the constrained optimization literature taking into account
constraints with the method of exact penalization. Judd (1998) and Miranda and Fackler
(2002) discuss extensively quasi-Newton methods; Judd and Venkataraman (2002) outline the
ingredients of a conjugate gradient algorithm in a very informative way. The codes for the
two quasi-Newton algorithms are available in the Mathworks Optimization Toolbox and on the
website maintained by Hans Bruun Nielsen.11 The code for the conjugate-gradient algorithm is
also available on the website maintained by Hans Bruun Nielsen. Alexei Kuntsevich and Franz
Kappel provide code for the fourth routine based on Shor’s r-algorithm.12 Burke et al. (2007)
provide a compact self-contained discussion of Shor’s r-algorithm (see Kappel and Kuntsevich
[2000] for additional details).
The three deterministic direct-search algorithms are all part of the Mathworks Optimization
and GADS toolbox. They include an application of the Nelder-Mead simplex, the Generalized
Pattern Search (GPS), and the Mesh Adaptive Direct Search (MADS). We refer the reader to
Lagarias et al. (1998) for the mechanics of the Nelder-Mead simplex. Torczon (1997) provides
a detailed description of the GPS. Material related to MADS, a generalization of the GPS
algorithm, is available in Audet and Dennis (2006).
The stochastic direct-search routines include genetic algorithms and a simulated annealing
algorithm. The codes for our two genetic algorithms are provided in the GADS toolbox and on
the website maintained by Michael Gordy.13 Our simulated annealing code is our translation of
the code originally developed for the Gauss matrix language by E.G. Tsionas available at the
11

Available at http://www2.imm.dtu.dk/~hbn/Software/
Available at: http://www.uni-graz.at/imawww/
13
Available at: https://www.federalreserve.gov/research/sta¤/gordymichaelx.htm
12

10
Gauss archive of the American University.14 We refer to Dorsey and Meyer (1995) and Go¤e
et al. (1994) for a compact discussion of the genetic and simulated annealing algorithms in the
context of econometrics, respectively. In the results section of the paper, we refer to the ten
algorithm we used following the sequence that they were described above as: Quasi-Newton
1 (Mathworks), Quasi-Newton 2 (Nielsen), Conjugate Gradient, Simplex, GPS, MADS, GA
Matlab, GA JBES, Simulated Annealing and SolvOpt.
We experimented with a number of stopping rules for the various optimization algorithms we
employed. For the majority of the algorithms, but not all, convergence is dictated by the change
in the objective function and the parameter vector (in some norm) between two consecutive
iterations of an algorithm on the basis of a speci…ed tolerance. We used a tolerance of 1E-3 for
changes in both the parameter vector and the objective function.
We limited the number of function evaluations to 4,000. Imposing an upper bound on the
number of function evaluations was largely dictated by the use of the direct-search algorithms,
notably the Nelder-Mead simplex, which repeatedly appeared to “stall”: The algorithm continued to move in a small neighborhood of the parameter space, without appreciable changes in the
objective function. As an example, for the …rst set of starting values used with the automobile
data set of BLP, the algorithm did not improve upon the value of the objective function at the
third decimal point after the …rst 94 iterations that required 152 function evaluations for the
next 7,848 function evaluations.15 However, because the simplex method uses stopping rules
that di¤er from most algorithms, convergence is never achieved.
In what follows, we assume that the simplex algorithm has converged if the objective function remains unchanged to the third decimal point for at least 200 iterations, which typically
correspond to over 800 function evaluations. This admittedly arbitrary convergence assumption should only a¤ects the results for the automobile data. The bulk of our reported results
are broken up by algorithm, so the reader can see that this assumption does not a¤ect our
conclusions.16 For the remaining algorithms, we focus only on those sets of starting values that
meet our convergence criteria and omit those results associated with termination implied by
the constraint on the number of function evaluations.
14
Available at: http://www.american.edu/academic.depts/cas/econ/gaussres/optimize/optimize.htm. The
Matlab code is available from the authors upon request. Recently, Mathworks has included simulated annealing
in its GADS toolbox.
15
We imposed an upper bound of 8,000 to the number of function evaluations for this example.
16
This is why some have recommended that researchers begin with a Simplex method and then switch to a
quasi-Newton method when the simplex method has “stalled.”If we were to adopt this strategy, we are con…dent
that each of the reported Simplex results would then converge after switching to the quasi-Newton algorithm.

11
Finally, we use the variable tolerance for the contraction mapping in Nevo (2000a).17 The
tolerance for the contraction mapping begins at 1E-8, it is reduced by a decimal point every 50
iterations of the contraction mapping and reset for every iteration of the nonlinear search. In
section 7, we investigate the robustness of our results to the contraction mapping tolerance.

4

Results

In this section, we summarize our demand estimation results using the ten optimization algorithms described above for two data sets. The …rst consists of the data on automobile sales
used in BLP. The second is the cereal data used in Nevo (2000a). Much of our motivation for
the use of these data was due to the fact that they are publicly available.
In the case of the cereal data, our speci…cation of the demand equation is the one used by
Nevo. Speci…cally, the speci…cation includes: brand dummies which subsume brand characteristics other than prices; random coe¢ cients associated with a constant term, price, sugar content,
and whether the cereal gets “mushy”; interaction terms between income and the constant term,
income and price, income and sugar content, income and the mushy dummy variable; an interaction term between income squared and prices; interaction terms between age and the constant
term, age and sugar content, and age and the mushy dummy variable; and, an interaction terms
between whether the consumer has a child and price. We use the instruments included in the
data set.
In the case of the automobile data, our speci…cation is slightly di¤erent from the one used
by BLP; for example, we have no interaction between price and income and a smaller number
of automobile characteristics with random coe¢ cients. Recall that we do not attempt any
sort of replication or validation of the optimization approaches followed by any of the authors.
Our speci…c model includes a constant term, price, HP/weight, a dummy variable for whether
the car has air conditioning, MPG and size as linear characteristics. The random coe¢ cients
are associated with: the constant, price, HP/weight, the dummy variable for whether the car
has air conditioning and miles/gallon. Our instruments consist of the non-price automobile
characteristics, their sums across other automobiles produced by the same …rm, as well as their
sums across automobiles produced by the rival …rms.
We present results with respect to the value of the GMM objective function, parameter estimates, own- and cross-price elasticities. We also check how the variation in parameter estimates
17

As in Nevo (2000a), we also draw 50 individuals. We increased the number of individuals to 500 and our
conclusions remain.

12
a¤ects our conclusions regarding the welfare e¤ects of two hypothetical merger exercises: one
for each data set. We focus only on the sets of starting values for which the various algorithms
converged. Within each of the ten search algorithm, we de…ne the “best”set of parameters as
the set that converges and minimizes the GMM objective function across the 50 sets of starting
values. We de…ne the “best of the best”set of parameters as the set that minimizes the GMM
objective function across all 500 combinations of starting values and optimization algorithms.
Our de…nition of best is admittedly somewhat arbitrary because consistency proofs may be
local in nature.
We start by analyzing the range of the GMM objective function values implied by the sets
of starting values for the parameters that allowed the algorithms considered to converge; we
spend little time on these since they are di¢ cult to interpret. Figures 1 and 2 are whisker plots
of the GMM values across parameter starting values and algorithms.18 We truncate the GMM
values at their 90th and 75th percentiles for the automobile and cereal data sets, respectively.
The GMM values ‡uctuate substantially across starting values even within an algorithm. Such
a …nding is not surprising. In fact, many researchers often try more than one starting value.
However, the GMM values also vary widely across algorithms, even when we focus only on
those GMM values implied by the best set of parameters. For both data sets, the JBES GA
never converged and led to extremely unstable results; therefore, we omit these results in our
discussion.
For the automobile data, the GMM objective function values for each of the ten algorithms
lies between 125.5 and over 100,000 for those starting values of the parameters that allowed the
algorithms to converge. The number of parameter staring values that led to convergence is 379.
The range of GMM values implied by the best sets of parameters is between 125.5 and 215.6.
Only the simulated annealing algorithm gave rise to a GMM value equal to 125.5 even after
using 50 starting values for each algorithm. Figure 2 plots a histogram of the GMM objective
values uncovered; again, the …gure truncates the upper 10% of values. We see that algorithms
often converge in a region where the objective value is 215 and above; rarely does the process
converge in regions with objective values below 200. For the cereal data, the GMM values
lie between 4.56 and 50.99, if we focus only on the best set of parameters for each algorithm.
Once we consider the entire set of parameter staring values that implied convergence, the range
18

The box represents the 25th and 75th percentiles with a median line. Whiskers extend from the box to the
upper and lower adjacent values and are capped with an adjacent line. The upper adjacent value is the largest
data value that is less than or equal to the third quartile plus 1:5 IQR and the lower adjacent value is the
smallest data value that is greater than or equal to the …rst quartile minus 1:5
IQR. Dots represent values
outside these “adjacent values”.

13
of the GMM values is between 4.56 and 2,241.51. Convergence was achieved for 299 of the
sets of parameter starting values. Figure 4 plots a histogram of the resulting GMM objective
values. Unlike the automobile data, convergence is often achieved near the minimum of the
distribution; although this is true for only two of the ten algorithms.
Focusing only on the value of the GMM objective function may be misleading. If the objective function is steep around the true parameter values, a local minimum may yield parameter
values that are close to the true values, but have an objective function value that is very di¤erent. Therefore, we focus on the economic meaning of the variation in parameter estimates in
our discussion below.
One interesting …nding in our extensive optimization exercise is that di¤erent algorithms
uncover the best of the best set of results across the two data sets. For the cereal data,
SolvOpt …nds the global minimum across all 50 starting values, which we believe to be above the
typical number of parameter starting values employed in the majority of the empirical exercises
in economics. For the automobile data, SolvOpt is dominated by the simulated annealing
algorithm; in other speci…cations MADS and GPS have uncovered the best sets of results for
the automobile data. This suggests that it is not enough for researchers to use multiple starting
values and one algorithm, even when they use as many as 50 starting values. For an exhaustive
nonlinear search, researchers will need to use multiple starting values, at least 50, and multiple
algorithms. As we will show below, even 20 di¤erent sets of starting values and 10 algorithms
may not be enough.
Tables 1 and 2 report the best set of parameter value across algorithms for the automobile
and cereal data, respectively. The variation in parameter values across the di¤erent algorithms
suggests economically meaningful di¤erences. For example, for the automobile data, the absolute value of the coe¢ cient associated with the log of price ranges between 0.22 and 0.55;
sometimes the mean marginal utility for horsepower is positive, while other times it is negative.
Table 1b reports “naive”estimates of standard errors, in the sense that they ignore multiple extrema. These standard errors suggest that formal tests of the parameters would reject equality
across algorithms. In the cereal data, the coe¢ cient associated with price lies between 30.2 and
114.1 (in absolute value), although the presence of interaction terms may make this variation
somewhat misleading. The parameter values associated with the interaction term of price and
income vary between -0.79 and 588.56.
We note that all of the parameter values seem “reasonable.” This is important because if
only the parameter values associated with one of the sets of results seemed reasonable, the
researcher may continue to search until he or she found this minimum. For example, if all but

14
one of the sets of parameters yielded upward sloping demand curves, this would provide an
economic justi…cation for choosing among the candidate set of results or lead a researcher to
continue her search until she has found this point in the parameter space.
Taken alone, even the parameter values can be di¢ cult to interpret because monotonic transformations of a particular set of parameters may yield similar behavior and price/demographic
interactions make interpretation di¢ cult.19 To gauge the economic signi…cance of the di¤erent parameter values, we construct a variety of often-used functions of these parameters. We
focus on three measures: own- and cross-price elasticities, as well as welfare calculations from
hypothetical mergers. Analyzing implied price-cost margins we drew largely similar conclusions.

4.1

Own-Price Elasticities

The number of elasticities that we estimate is rather immense. Each data set has over 2,000
product and market combinations. Every combination of parameter starting values and optimization algorithm yields an elasticity matrix for each market. In the case of the cereal data,
there are 94 market with 24 products in each market leading to 2,256 market and product
combinations. Each of the 500 pairs of parameter starting values and algorithms implies an
elasticity matrix of dimension 24

24 for each of the 94 markets. In the case of the automobile

data, there are 20 markets, which may have as many as 150 products, for a total of 2,217
product and market combinations.
To keep the discussion of the own-price elasticity estimates manageable, we begin by focusing
on four products for each of the data sets. These four products have a market share that
corresponds to the …rst, second, third and fourth (maximum) quartiles of the distribution of
market shares. For the purpose of the discussion below, we refer to these products, as products
1 (1st quartile), 2, 3 and 4 (max), respectively. Subsequently, we provide kernel density plots
of the own-price elasticity estimates for all products.
When we discuss elasticity estimates for the four products, we present results for all starting values that allowed convergence, as well as for the best set of parameter values for each
algorithm. When we present elasticity estimates for all products, we focus only on the best set
of parameter values for each algorithm. Recall that we de…ne, as best, the set of parameter
that give rise to the minimum GMM values for the algorithm under consideration. Holding
the algorithm …xed, but looking across starting values, illustrates the importance of trying
19

While …xing the variance of the logit error term allows us to identify the parameters, proportional increases
in the remaining parameters are likely to yield similar substitution patterns.

15
multiple starting values. Variation across the best set of results for each algorithm stresses the
importance of trying multiple starting values in combination with multiple algorithms.
In the presence of a globally convex objective function the elasticity estimates for a speci…c
product would be the same across all sets of starting parameter values that implied convergence.
Furthermore, if the nonlinear search problems were mild enough such that trying many starting
values would su¢ ce to overcome them, the distribution of the estimated elasticities would
be identical across the ten best sets of estimates. The amount of variation in the estimated
elasticities gauges our concerns for the optimization method employed in our demand estimation
exercise.

4.1.1

Automobile Data

Table 3 lists the own-price elasticity estimates for the products with market shares that correspond to products 1 through 4, as de…ned in the previous section, across all algorithms; we
omit those results corresponding to GMM objective values in the upper decile of all results that
led to convergence. For each algorithm, we report the range of own elasticities associated with
those starting values that permitted convergence. The table also includes elasticities implied by
the best set of parameters for each algorithm. Recall that SolvOpt achieved the lowest GMM
value. Because the JBES genetic algorithm never converges, we omit it from our discussion of
the implied elasticities.
The variation in the estimates of the utility parameters signi…cantly a¤ects the own-price
elasticity estimates for each of the four products. If we focus on parameter staring values that
implied convergence, the own-price elasticity for product 1 varies between -40.47 and -0.79.20
The GPS algorithm …nds the extremes of this range. The other three products exhibit greater
variation. The elasticity estimates for product 2 lie between -49.43 and 0.06. Moving to products
3 and 4, the corresponding ranges are -91.43 to -0.53, and -87.04 to 1.84, respectively.
To get a feel for whether these extremes are outliers, Figure 5 plots the histogram of elasticities for the 379 parameter starting values that permitted convergence. The …gure also reports
the “true”elasticity, where the truth is de…ned as the elasticity associated with those parameter values that yield the lowest value for the GMM objective function across all 500 estimation
exercises. For all four products, a signi…cant amount of the distribution falls outside what
would appear to be reasonable variation in the estimates; it is not uncommon to see variation
20

We omit those sets of results that lead to an objective value above the 75th percentile of the results leading
to convergence. This corresponds to an objective value of roughly 277.

16
exceeding 200 percent. We admit that given these di¤erences do not represent sampling variation, one could argue that reasonable variation is no variation. For the …rst two products the
true elasticity falls outside of the bulk of the distribution and is estimated to be more elastic
than other estimates. For the …nal two products, the truth lies roughly in the middle of the
distributions and in between two modes for the product with the largest market share.
Another way to summarize our …ndings is to calculate the standard deviation of the ownprice elasticity for each product-market combination for each of the 379 sets of parameter
starting values that allowed convergence. Ideally the distribution of these standard deviations
should be degenerate with a mass at zero; it is not. The mean of this standard deviation is
16.8; its median is 11.12. To put these numbers in context, the mean elasticity is -6.63.
Next, we focus on the best set of parameter starting values for each algorithm. This mimics
cases where ten researchers opt for a particular algorithm and use 50 di¤erent starting values.
The variation remains substantial. Table 3 shows that for product 1, elasticities vary by a factor
of two, from -3.72 to -1.57. The other three products exhibit larger variation: -3.76 to -1.01
(product 2), -5.00 to -0.53 (product 3), -3.42 to 1.08 (product 4). The mean within-productmarket standard deviation among the best set of parameter starting values is 8.42, while its
median is 6.05; therefore, the standard deviation in the elasticity estimate for the product with
the median level of variation is greater than the average elasticity.
Finally, we turn to summaries of the entire set of own-price elasticities. Figure 6 plots kernel
density estimates for the best set of parameters for each of the ten algorithms. Again, absent
nonlinear search problems, we would expect the lines associated with the kernel densities to lie
on top of each other; they do not. We should also note that these densities are likely to mask
meaningful variation in the elasticities across algorithms because it is possible to change the
elasticity of speci…c products without changing the distribution. The densities exhibit large
‡uctuations, with the true density appearing on one extreme. The JBES genetic algorithm
never converges, so we do not place much weight on this algorithm, but the remaining nine
algorithms that do converge, do so at di¤erent points in the parameter space.
Much of our discussion above is consistent with a hypothetical setup of ten researchers
using 50 di¤erent sets of starting values, but a single algorithm, to solve the same optimization
problem. We speculate that many researchers do not try 50 distinct sets of starting values most
of the time. We have often heard researchers arguing that their estimation process can take
weeks to converge. An estimation exercise that requires computation time worth of a week,
using a single computer would imply almost an entire year to try 50 di¤erent sets of starting
values, in the absence of parallel processing. Furthermore, it seems to be the case that the

17
more complex the model, the larger the number of starting values that the researcher should
employ. This, of course, is unfortunate because computation time and complexity are positively
correlated, implying the more complex the model the more starting values a research should
try.
To understand the importance of trying many starting values, we replicate the own-elasticity
density plots for all products assuming a researcher using only the …rst 20 of our starting
values. These results are plotted in Figure 7. The “truth” is never found. The place in the
parameter space leading to an objective value of 125.47 was uncovered only once and on the
29th set of starting values. Ironically, the variation across algorithms, with the exception of
the simulated annealing, is smaller using only 20 starting values. This smaller variation is
somewhat misleading because the GMM objective function can only be improved by trying
additional starting values, suggesting fewer starting values may give researchers a false sense of
security.

4.1.2

Cereal Data

In general, our …ndings regarding own-price elasticities for the four speci…c products within
the cereal data are more robust, although the variation is still notable. Across all products,
we notice similar variation to that found in the automobile data. Table 4 reports the range
of possible own-price elasticity estimates for four products. We maintain the nomenclature
for product identi…cation that we developed in the previous sections discussing the results for
automobiles. For product 1, the range of elasticities across all sets of parameter associated with
convergence is between -47.15 and 8.65. For product 2, the range is -2.41 to -0.09. The range for
products 3 and 4 is -11.22 to 0.24, and -1.47 to -0.11, respectively. Assuming a researcher tries
50 starting values, a single algorithm and reports the results from the best set of parameters,
the range remains wide: -45.35 to -12.55, -1.92 to -1.55, -6.72 to -2.34 and -1.46 to -0.75 for
products 1, 2, 3 and 4, respectively.
The mean standard deviation of the elasticity estimates for a given product-market combination, is 7.50 among estimates associated with convergence, while the mean elasticity is -9.93.
Using a normal approximation, this suggests that 34 percent of the time the own-price elasticity will vary by over 80 percent. Interestingly, although the four speci…c products exhibit less
variation compared to their counterparts in the automobile data, their within product-market
combination standard deviations are similar.
Histograms of own-price elasticities are provided in Figure 8. Largely because of two algo-

18
rithms, the truth always lies in the modal bin. As noted above, SolvOpt …nds the truth for each
of the 50 sets of starting values and Quasi-Newton 2 does so for 32 of 50 sets of starting values.
To isolate the e¤ects of SolvOpt and Quasi-Newton 2, we also provide histograms using the
remaining six algorithms that exhibited convergence and had GMM objective values below the
upper quartile. Omitting SolvOpt and Quasi-Newton 2 changes the shape of the histograms
considerably. The remaining algorithms rarely …nd elasticities near the “true”elasticity.
The kernel densities of own-price elasticities across all products for each of the best set of
parameters are plotted in Figure 10. We see large shifts in the distribution of elasticities across
algorithms, although not as dramatic as with the automobile data set, especially among those
algorithms that converged. Given that the results from the individual product estimates and
the standard deviations suggest that for a given product the variation can be considerable, these
densities are likely hiding meaningful variation. This is corroborated by the within productmarket standard deviations discussed above.

4.2

Cross-Price Elasticities

In some respects, analyzing cross-price elasticities is more important than own-price elasticities
because the random coe¢ cient logit is designed to provide more appealing substitution patterns than the simple and nested logit models. The number of cross elasticities is even more
immense when compared to the number of own elasticities. As with our analysis of own-price
elasticities, we …rst focus on four speci…c product and then include densities for a larger number
of elasticities for the cereal data. For the product-speci…c analysis, the choice of a substitute
is necessary; we opt for the closest one. Our measure of closest substitutability is the largest
average cross-price elasticity across all sets of results that led to convergence.21
Although our density plots can include all of the estimated cross elasticities, we have found
that the density plots of the entire set of cross-price elasticities hide meaningful variation in
the estimated elasticities, as the following example illustrates. Suppose we are interested in
the cross elasticities of products a; b; c and d: Additionally denote the elasticity of quantity
demanded for good i with respect to the price of good j by

ij :

Furthermore, assume that one

combination of starting values and optimization algorithms implies
while a second combination implies

cd

= 0:05 and

ab

ab

= 0:05 and

cd

= 0:15;

= 0:15: The density plots will not reveal

the meaningful variation in these cross elasticities due to the di¤erent combinations of starting
values and algorithms. To alleviate similar problems, we plot the cross-price elasticities of a
21

We again omit results associated with GMM objective values in the upper quartile.

19
single product chosen independent of the results. Because only the cereal data have products
that repeat across markets, we show only density plots for the cereal data.

4.2.1

Automobile Data

The variation in cross-price elasticities is larger than that of own-price elasticities; cross-price
elasticities can di¤er by two orders of magnitude across the sets of parameters associated with
convergence, sometimes three (Table 5). For product 1, the cross-price elasticity with its closest
substitute ranges from 0.006 to 2.74 (the entries in Table 5 have been multiplied by 10). If
we restrict ourselves to the best set of parameters for each algorithm, the elasticity ranges by
a factor of four: 0.10 to 0.31. For product 2, the range across all parameters associated with
convergence is 0.006 to 1.71; for the best set of parameters the range is 0.036 to 0.15. Products
3 and 4 exhibit even more variation. With the set of parameters associated with convergence,
the range in the cross-price elasticity for Product 3 is -0.05 to 4.61. If we move to the best
set of parameters, the range becomes -0.04 to 0.19. Product 4 ranges from -0.027 to 3.93 and
-0.015 to 0.09 across all sets of parameters associated with convergence and the best sets of
parameters, respectively.
While Table 5 points to substantial variation, it is still possible that the true elasticity is
found most of the time. Figure 11 plots the histogram of possible cross-price elasticities for
each of the four products. For visual ease, we truncate the horizontal axes of the graphs at the
90th percentile. In some ways, the results for cross-price elasticities are even more dramatic
compared to own-price elasticities. For Products 2, 3 and 4, the truth is outside the mass (thick
portion) of the distribution. Furthermore, the range of this thick portion of the distribution is
large; it is from almost zero to just under 0.10.
Finally, we calculate the within product-market standard deviation in the cross-price elasticities. We calculate the standard deviation separately across all routines that converged and
across the best sets of parameters for each algorithm (ignoring those algorithms that never
converge). The median cross-price elasticity across the over 230,000 elasticities and those routines that converged is 0.02. The average within product-market standard deviation in these
estimates is 0.23, while the median is 0.04. Therefore, it is not uncommon for estimates to vary
by plus or minus 200 percent within a given product. The variation is reduced for the best sets
of parameter values because four of the nine routines …nd points in the parameter space in the
same area (leading to a GMM objective value of 215). The mean standard deviation is 0.02,
the median is 0.003, and the median cross-price elasticity is .01.

20
4.2.2

Cereal Data

The cereal data also exhibit large variation in their cross-price elasticities. As Table 6 illustrates,
for each of the products 1 through 4, it is possible to estimate a zero cross-price elasticity, or
an elasticity that, in some cases, exceeds 8 (the entries in Table 5 are multiplied by 10). This is
true even when we choose the best set of parameters implied by all 50 starting values. Product
1 exhibits the most variation among the four products: 0.48 to 8.11. The elasticities for product
2 lie between 0.25 and 0.37. For product 3, the range of elasticities is 0.015 to 0.38. Finally,
product 4 has cross elasticities that range from 0.012 to 0.18. This variation seems to be larger
than that of the automobile data.
Figure 12 shows the histogram of estimates for each of the four speci…c products. The …gure
illustrates that, despite 82 of 299 sets of results converge at the same location of the parameter
space, a signi…cant amount of variation remains. Similar to the own-price elasticities, the spike
at the truth is driven by two of the ten algorithms. When we omit these algorithms from the
histograms, we see that we are more likely to estimate elasticities signi…cantly far from the
truth, than the truth itself (see Figure 13).
Figure 14 plots densities of cross-price elasticities across the 10 best sets of parameter values.
Speci…cally, let

AB

= % QA =% pB , Figure 14 plots the cross-price elasticities associated with

product B that has the highest average elasticity across all markets, using all sets of parameters
that lead to convergence. We truncate the elasticities below by zero and above by the 75th
percentile. When we plot the distribution of a large number of cross-price elasticities, the
cereal data appear to exhibit large variation across the best set of results for each algorithm.
This …nding may not be surprising given the variation in the nonlinear parameters reported in
Table 2. For example, the standard deviation of the random coe¢ cient term associated with
price varies from 0.67 (Conjgrad) to 3.31 (SolvOpt). The price-income interaction term varies
between -0.56 (Quasi-Newton 1) and 588.2 (SolvOpt). Similarly, the nonlinear parameters
associated with other characteristics also vary by over 100 percent. For example, the mushyincome interaction term ranges from 0.75 to 2.22. Figures 15 and 16 focus on di¤erent ranges
of the cross elasticities. Focusing on a smaller range of elasticities magni…es the di¤erences.
The within product-market standard deviation in the cross-price elasticities show similar
patterns to the automobile data. The median cross-price elasticity across the over 50,000
elasticities and among those routines that converged, is 0.10. The average within productmarket standard deviation for these estimates is 0.67, while the median is 0.10. These ranges
are similar even among the best outcomes for each algorithm (also ignoring those best outcomes

21
that did not converge). The mean within product-market standard deviation is 0.44, with 0.07
as the median. Therefore, even if researchers try 50 starting values, but using one algorithm, a
signi…cant amount of variation persists.

4.3

Merger Simulations

With demand estimates available, the construction of a matrix of price derivatives emerging
from the …rst-order conditions implied by pro…t maximization is straightforward. Combined
with information on the ownership structure of the market and a conduct mode, inferring
marginal cost is possible. For example, under static Bertrand and constant marginal costs, the
…rst-order conditions associated with the …rms’pro…t-maximization problems imply:
p

mc =

(p)

1

s (p) ;

(10)

where p is the price vector, s( ) is the vector of market shares and mc denotes the corresponding
marginal costs. The dimension of these vectors is equal to the number of the products available
in the market, say J. The

matrix is the Hadamard product of the (transpose) of the matrix of

the share price derivatives and an ownership structure matrix. The ownership structure matrix
is of dimension J

J; with its (i; j) element equal to 1 if products i and j are produced by the

same …rm and zero, otherwise. Because prices are observed and demand estimation allows us
to retrieve the elements of

; marginal costs are directly obtained using (10).

A simple change of 1s and 0s in the ownership structure matrix along a series of additional
assumptions (see Nevo [2001]) allows the simulation of a change in the industry’s structure, as
the one implied by mergers among competitors, as well as the evaluation of its welfare e¤ects.22
In what follows, we analyze the range of values for a measure of consumer welfare on the basis of
post-merger equilibrium prices. For the automobile data, we assume GM and Chrysler merge.
In the case of the cereal data set, we assume Kellogg’s and General Mills merge. The vector of
post-merger prices p is the solution to the following system of nonlinear equations:
p

mc
c = ^ post (p )

1

s^ (p ) :

(11)

The elements of ^ post re‡ect changes in the ownership structure implied by the hypothetical
merger. To solve for the post-merger prices, we keep the share price derivatives and shares at
22

Exercises for evaluating the welfare e¤ects associated with the introduction of new goods are performed in
a very similar manner (e.g., Petrin 2002).

22
their use pre-merger levels instead of solving the above system of nonlinear equations in (11).23
Thus, we avoid dealing with issues related to the numerical instabilities of Newton routines
used in the solution of nonlinear equations, as well as with issues related to potentially multiple
equilibria. Although we agree that the discussion of both issues is important, it is beyond the
scope of our discussion here.
With the post-merger prices in hand, we can estimate expected consumer welfare changes
due to the mergers under consideration. A consumer’s expected change in utility due to a
merger may be evaluated as the change in her logit inclusive value (McFadden [1981], Small
and Rosen [1981]). Therefore, the compensating variation for individual i is the change in her
logit inclusive value divided by the marginal utility of income. When prices enter the utility
function linearly, which holds in our case, the compensating variation is given by:

ln
CVi =

hP

j=J
j=0

exp Vijpost

i

ln
i

hP

j=J
j=0

exp Vijpre

i

;

(12)

where Vijpre and Vijpost are de…ned in (3) using the pre- and post-merger prices. Integrating over
the density of consumers yields the average change in consumer welfare from the merger.

4.3.1

Automobile Data

The automobile data set is a repeated cross-section of virtually all cars sold annually in the
US between 1971 and 1990. We assume that the GM and Chrysler merger takes place in the
middle of our sample, namely in 1981. Therefore, we have an annual estimate of the merger’s
impact on prices. We report the average of the price impact from 1981 to 1990.
The average price change across all optimization routines that achieved convergence is
$1,660, with a median of $0. The average within-product standard deviation in this estimated
price change is $15,128 across all sets of parameters associated with convergence. Truncating
at the 90th percentile gives rise to an average standard deviation of $10,641, still very large.
The median of the standard deviations is zero given the large number of zero predicted price
changes and the value of their 75th percentile is $1,446. Therefore, it is not uncommon to see
variation in the estimated price changes that as large as their mean.
Having discussed our …nding for price changes, in what follows, we focus on changes in
consumer welfare. Figure 17 plots the histogram of annual welfare changes assuming there
23

This approximation is also discussed in Nevo (1997)

23
are 265 million consumers calculated over the second half of our available sample. The …gure
truncates the lower 1% of values and also positive values. Even when we ignore uncertainty due
to sample variation, among the best sets of results for each algorithm, the predicted consumer
e¤ects range from positive to negative $52.76 billion. Across all sets of results that led to
convergences, we see large masses near zero and between negative $10 billion. The parameters
that yield the lowest objective function value lead to a welfare estimate a the lower end of this
mass with a value of negative $9.45 billion.

4.3.2

Cereal Data

In the cereal data, the average price change across all routines achieving convergence is 2.66
cents per serving, with a median of 2.07 cents per serving. The average within-product standard
deviation in this estimated price change is 748.7 cents across all sets of parameters associated
with convergence. Once again, outliers drive some of this, but the median is still large— 326.3
cents. Across the best set of parameters, the average price change is 2.77 cents. The median
price change is lower (2.07 cents), while the mean and median within-product standard deviation
are 492 and 187 cents, respectively.
The merger counterfactual results with the cereal data are more robust. We do, however,
observe large di¤erences in the estimated welfare e¤ects, especially when we omit the two
algorithms that clearly outperform the others. Figure 18 plots the histogram of welfare changes
assuming there are 265 million consumers for all algorithms. Figure 19 omits the algorithms 3
and 5. While there is considerable variation, the results are not as striking as in the automobile
data.

5

Gradients and Eigenvalues

Any discussion of the …rst- and second-order conditions for a minimum has been carefully
postponed to this point. We should have probably begun our analysis with this discussion
because it would allow us to rule out certain candidate sets of parameter estimates. Our timing
of the presentation has been deliberate for a number of reasons. To the best of our knowledge,
…rst- and second-order conditions are rarely discussed by empirical economists in their work.
Additionally, we want to stress the point that optimization algorithms may stop at points in
the parameter space where these conditions are not satis…ed. Finally, and most importantly,

24
for both the cereal and the automobile data sets the “global” minimum found and discussed
above does not meet these conditions.24

5.1

Automobile Data

Among the 500 combinations of starting values and optimization algorithms, 379 achieved
convergence. Among these 379 combinations, 192 have gradients for which the 1
below 30, 173 have gradients with 1

norm below 20 and 128 have gradients with 1

norm is
norm

below 10.25 We realize that these are fairly lenient standards for a zero gradient, but any
1

norm gradient cut-o¤ will illustrate our message.
Using 30 as the 1 norm gradient cut-o¤, we …nd that only 60 of the 500 sets of parameters

corresponds to points that meet both the …rst- and second-order conditions. Most interestingly,

these results do not include the “global” minimum, implying that this point is not a minimum;
this point in the parameter space does not meet the …rst order conditions. The GMM objective
value ranges from 215.0 to 252.46 across these points in the parameter space. Despite trying
500 di¤erent starting value and algorithm combinations and having 379 of them “converge”, we
know that we have not found the global minimum. We also note that we are restricting ourselves
to a fairly small neighborhood of starting values; there are probably other local minima to be
uncovered if we expand this neighborhood. Across the 379 sets of converged results, nine yield
GMM objective function below 215.0 and do not meet the …rst- and second-order conditions.26
From the GMM objective and parameter values it is di¢ cult to determine the unique set of
minima; the GMM objective values suggest that there are a number of local minima represented
and not one plateau. We plot the own-price elasticities for all sets of parameters in Figure 20.
While various sets of parameters appears to correspond to the same local minimum, a signi…cant
amount of variation exists. It appears that the variation across these sets of results is even larger
compared to the variation when focusing on the best set of results for each algorithm. Figure 21
is a histogram of consumer welfare changes from the hypothetical merger between Chrysler and
GM discussed above. Again the variation is large; the consumer welfare e¤ects vary between
-$3.83 billion and -$6.02 billion; this range signi…cantly di¤ers from the welfare e¤ects implied
24

To analyze the …rst- and second-order conditions, we calculate numerical gradients and hessians using the
Matlab routines fminunc.m and eig.m, respectively. Although fminunc is an optimization routine it provides
gradients and Hessians as by-products.
25
Among the entire set of 500 starting value and algorithm combinations, 216, 193 and 141 have gradient
1 norm below 30, 20 and 10, respectively.
26
The objective function values for these nine points are 125.47, 178.06, 178.15, 187.17, 188.5, 196.7, 204.47,
207.49 and 213.27.

25
by the best set of results. Therefore, even if the a researcher was diligent and checked her …rstand second-order conditions, it is conceivable that she could converge on any one of the sets of
parameters. Of course, we stress that if the consistent route is the global minimum, none of
these correspond to the consistent set of parameters.

5.2

Cereal Data

Among the 299 combinations of parameter starting values and algorithms that implied convergence, 140 have gradients with 1 norm below 30, 126 have gradients with 1 norm below 20
and 110 have gradients with 1
with a gradient 1

norm below 10.27 Only 23 starting value and algorithm pairs

norm below 30 meet the second-order conditions. As with the automobile

data, our “global” minimum does not meet the …rst- and second-order conditions; all of the
converged sets of result sin the neighborhood of 4.56 have at least one negative eigenvalue.
It is di¢ cult to point out the number of distinct local minima from the parameter estimates,
so we plot the kernel densities associated with the implied own- and cross-price elasticities.
The kernel density plots of the own elasticities are suggestive of three distinct local minima
(Figure 22). The welfare e¤ect of the hypothetical merger between Kellogg’s and General Mills
evaluated at the 26 sets of parameters corresponding to local minima do not exhibit the degree
of variation we experienced with the automobile data. Figure 23 shows that the welfare e¤ects
vary by 50 percent, as opposed to over 100 percent for the automobile data set.

5.3

Discussion of Gradients and Eigenvalues

Given our fairly lenient standards for zero gradient norms, an obvious concern regarding our
Hessian eigenvalue calculations is that while locally a given eigenvalue may be negative, perhaps
small movements around the point under consideration would yield a positive eigenvalue. If
this were the case, for example, the lowest point for the cereal data may indeed be a minimum.
In support of this argument, parameter estimates associated with values of the GMM objective
function in the neighborhood of 14.9 can sometimes have all of their Hessian eigenvalues positive,
but other times not. Against the same argument, none of the 82 starting value and algorithm
pairs that implied values for the objective function around 4.56, the lowest value of the objective
function we uncovered, have all of their Hessian eigenvalues positive. The sensitivity of the
27

Across all 500 pairs, 152 have gradients below 30, 134 have gradient 1
gradient 1 norm below 10.

norm below 20 and 115 have

26
Hessian eigenvalues to very small movements around the proposed minimum is more worrisome,
we would argue. This sensitivity may also imply that certain points with a near-zero gradient
norm may have all positive Hessian eigenvalues in only a small neighborhood. Therefore, a
researchers may wrongly stop at a point that isn’t truly a minimum because her tolerance for
a zero gradient is too large.

6

Contraction Mapping Tolerance

Unlike many other nonlinear models, the BLP-type error term is not additively separable in
the objective function.28 It is instead retrieved by means of a contraction mapping adding a
layer of computational burden, given the linear rate of convergence of the implied …xed-point
iterations. As with each iterative procedure, this contraction mapping requires a tolerance level
to declare convergence. In the results reported to this point, we adopted a variable contraction
mapping tolerance similar to that in Nevo (2000a).29;30
To assess the sensitivity of our …ndings to the contraction mapping tolerance, we …x the
tolerance associated with the automobile and cereal data to 1E-16 and 1E-12, respectively.
Using a tolerance of 1E-16 with the cereal data proved to be extremely time consuming, with
some sets of starting values taking over 24 hours to converge. Because our goal is to replicate how practitioners employ nonlinear search methods, and our results suggest that many
algorithm/starting-value pairs are required for an exhaustive search, we reduced the tolerance
to 1E-12 for the cereal data.
For the automobile data, 373 sets of starting values led to convergence. The objective function values lie between 178.1 and over 96,000. The range in objective values among the best
sets of results for each algorithm is from 178.1 to 238.66 (restricting to those results that converged). Five of the algorithms converge a point near 178.1; their parameter estimates are
extremely similar suggesting this is indeed one local minima. Interestingly, the previous best
point, yielding a GMM objective value of 125.5 is no longer uncovered. If we expand to all
28

Assume a simple NLS example, where y = f ( ; X)+"; for a nonlinear function f ( ) of the parameter vector
and explanatory variables X for a dependent variable y:The error term may be written as " = y f ( ; X) :With
a potential abuse of notation, a BLP-type model may be written as y = f (X; ; ") ; hence a non-additive error
term emerges.
29
The code in Nevo (2000a) increases the tolerance (thus, making it more lenient) as the number of iterations
in the contraction mapping increase. The contraction mapping takes less time during early iterations when the
mean utilities exhibit larger changes.
30

For comparison, BLP (1999) use 1E-4:

27
of the estimates, including those that did not achieve convergence, the Simulated Annealing
routine locates a point in the parameter space with an objective value of 133.8. It …nds this
region of the parameter space only once; no other algorithm …nds a GMM objective value under
178 even when we do not restrict ourselves to sets of results that converged.
Many more of the converged sets of results met the …rst-and second-order condition; 265
have an 1

norm below 30 with all of their Hessian eigenvalues being positive. Again, the

range in objective values (178.1 to 260.6) suggest multiple extrema, not a plateau.
For the cereal data, 257 sets of starting values converged with GMM objective values ranging
from 4.56 to over 69,000. The objective value ranges from 4.56 to 327.7 among the best sets
of results. Of these converged sets of results, 41 meet the …rst- and second-order conditions
with objective function values ranging from 17.5 to over 11,000. Once again, the region of
the parameter space corresponding to an objective function value of 4.56 does not meet the
second-order conditions; this is despite the fact that 79 sets of starting values converge in and
around this area.31
We reproduced all of the tables and …gures constructed with variable tolerance level using
…xed ones. The results are strikingly similar. To provide an idea to the reader regarding our
…ndings, Figures 24 through 27 repeat the information in Figures 2, 4, 5 and 8, using …xed
as opposed to variable tolerance levels. Increasing the contraction mapping tolerance does not
change the conclusions; the …gures are remarkably similar. Algorithms are still likely to converge
at multiple places in the parameter space and the variation in elasticities remains large, both
for the four speci…c products and across all products. The summary measures focusing on sets
of results that meet the …rst- and second-order conditions show more variation because of the
increase in the number of parameter estimates that satisfy these conditions, as the discussion
below illustrates.
For the automobile data, the mean standard deviation of the elasticity estimates across
converged sets of results is 11.9; the median is 8.88. For comparison, using variable tolerance, the
mean and median are 15.13 and 9.65, respectively. For the cereal data, the average and median
within-product-market standard deviation in the estimated elasticities across all converged
results are 7.78 and 3.37, respectively. They are almost identical to the mean and median of
7.58 and 3.24, respectively, using variable tolerance.
Using the automobile data, we do …nd, however, that the truth has changed. More importantly, the elasticity estimates change dramatically. For product 1, the elasticity associated
31

As before only SolvOpt and Quasi-Newton 2 reach this region.

28
with the lowest objective value changes from -3.00 to -1.81. Similar changes occur for the other
products.

7

Conclusions

Empirical industrial organization has been increasingly relying on highly nonlinear structural
models. Researchers are often concerned about econometric issues, such as endogeneity and
the variation in the data that can, in principle, identify the parameters of interest. However,
the actual process of …nding the extremum of the underlying objective function involved in the
empirical exercise undertaken is rarely discussed, and if it is, often relegated to a terse footnote.
In this paper, we show that an econometrician’s search for the extremum can have large
consequences on the conclusions drawn for variables of interest in economic analysis. We believe
that these issues deserve as much attention as the identi…cation strategy. For a common class
of demand models for di¤erentiated products, we show that depending on the search algorithm
of the researcher, a wide range of policy implications exist. Furthermore, parameter estimates
of “converged”routines may not satisfy the …rst- and second-order conditions for an extremum.

29

References
[1] Altonji, Joseph G., and Lewis M. Segal. 1996. “Small-Sample Bias in GMM estimation of
Covariance Structures.”Journal of Business and Economic Statistics, 14(3):353-366.
[2] Amemiya, Takeshi. 1985. Advanced Econometrics. Cambridge: Harvard University Press.
[3] Andrews, Donald W.K. 1997. “A Stopping Rule for the Computation of Generalized Methods of Moments Estimators,”Econometrica, 65(4): 913:931.
[4] Angrist, Joshua D., and Alan.B. Krueger. 1991. “Does Compulsory School Attendance
A¤ect Schooling and Earnings?.”Quarterly Journal of Economics, 106(4):979-1014.
[5] Audet, Charles, and J.E. Dennis JR. 2006. “Mesh Adaptive Direct Search Algorithms for
Constrained Optimization.”Siam Journal of Optimization, 17(1): 188-217
[6] Bayer, Patrick and Robert McMillan. 2006. “Racial Sorting and Neighborhood Quality.”
NBER Working Paper #11813.
[7] Bayer, Patrick, Robert McMillan and Kim Rueben. 2004. “An Equilibrium Model of Sorting in an Urban Housing Marke.”NBER Working Paper #10865.
[8] Bekker, Paul A. 1994. “Alternative Approximations to the Distributions of Instrumental
Variable Estimators.”Econometrica, 62(3): 657-681.
[9] Berry, Steven. 1994. “Estimating Discrete-Choice Models of Product Di¤erentiation.”
RAND Journal of Economics, 25(2): 242-262.
[10] Berry, Steven, James Levinsohn, and Ariel Pakes. 1995. “Automobile Prices in Market
Equilibrium.”Econometrica, 63(4): 841-890.
[11] Berry, Steven, James Levinsohn, and Ariel Pakes. 1999. “Voluntary Export Restraints on
Automobiles. Evaluating a Trade Policy.”American Economic Review, 89(3): 400-430.
[12] Bound, John, David A. Jaeger, and Regina M. Baker. 1995. “Problems with Instrumental
Variable Estimation When the Correlation Between the Instruments and the Endogenous
Explanatory Variable is Weak.” Journal of the American Statistical Association, 90(430):
443-450.
[13] Brenkers, Randy, and Frank Verboven. 2006. “Liberalizing a distribution system: The
European Car Market.”Journal of the European Economic Association, 4(1): 216-251.

30
[14] Burke, James V., Adrian S. Lewis, and Michael L. Overton. 2007. “The Speed of Shor’s
R-algoritm”. Manuscript.
[15] Burnside, Craig, and Martin Eichenbaum. 1994. “Small Sample Properties of Generalized
Method of Moments based Wald Tests.”National Bureau of Economic Research Technical
Working Paper 155.
[16] Cameron, A. Colin., and Pravin K. Trivedi. 2005. Microeconometrics: Methods and Applications. Cambridge: Cambridge University Press.
[17] Dorsey, Robert E., and Walter J. Mayer, (1995). “Genetic Algorithms for Estimation Problems with Multiple Optima, Nondi¤erentiability, and Other Irregular Features.” Journal
of Business and Economic Statistics, 13(1): 53-66.
[18] Drukker, David M., and Vince Wiggins. 2004. “Verifying the Solution from a Nonlinear
Solver: A Case Study: Comment.”American Economic Review, 94(1): 397-399.
[19] Go¤e, William L., Gary D. Ferrier, and John Rogers. 1994. “Global optimization of statistical functions with simulated annealing.”Journal of Econometrics, 60(1-2): 65-99.
[20] Hansen, Lars P., John Heaton, and Amir Yaron. 1996. “Finite-Sample Properties of Some
Alternative GMM estimators.” Journal of Business and Economic Statistics, 14(3): 262280.
[21] Hansen, Lars P. 1982. “Large Sample Properties of Generalized Method of Moments Estimators.”Econometrica, 50(4):1029-1054.
[22] Hendel, Igal and Aviv Nevo. 2006. “Measuring the Implications of Sales and Consumer
Inventory Behavior.”Econometrica, 74(6): 1637-1673.
[23] Gowrisankaran, Gautam and Marc Rysman. 2007. “Dynamics of Consumer Demand for
New Durable Goods.”mimeo.
[24] Hasting, Justine, Thomas Kane, and Douglas Staiger. 2007. “Parental Preferences and
School Competition: Evidence from a Public School Choice Program.” NBER Working
Paper #11805.
[25] Judd, Kenneth L. 1998. Numerical Methods in Economics. Cambridge: MIT Press.
[26] Kappel, Franz, and Alexei Kuntsevich. 2000. “An Implementation of Shor’s r-Algorithm.”
Computational Optimization and Applications, 15(2): 193-205.

31
[27] Lagarias, Je¤rey C., James E. Reeds, Margaret H. Wright, and Paul E. Wright. 1998.
“Convergence properties of the Nelder-Mead Simplex Method in Low Dimensions.” Siam
Journal of Optimization, 9(1): 112-147.
[28] McCullough, B.D., and H.D. Vinod. 2003. “Verifying the Solution from a Nonlinear Solver:
A Case Study: Reply.”American Economic Review. 93(3): 873-892.
[29] McFadden, Daniel L. 1981. “Econometric Models of Probabilistic Choice.” In Structural
Analysis of Discrete Data, ed. C.F Manski and D.L. McFadden, 198-272. Cambridge, MIT
Press.
[30] McFadden, Daniel L., and Whitney K. Newey. 1994. “Large Sample Estimation and Hypothesis Testing.” In Handbook of Econometrics, ed. R.F Engle and D.L. McFadden,
2113-2245.
[31] Miranda, Mario J., and Paul L. Fackler. 2002. Applied Computational Economics and
Finance. Cambridge: MIT press.
[32] Nevo, Aviv. 1997. “Mergers with Di¤erentiated Products: The Case of the Ready-to-Eat
Cereal Industry.” University of California, Berkeley Competition Policy Center Working
Paper no. CPC 99-02.
[33] Nevo, Aviv. 2000a. “A Practitioner’s Guide to Estimation of Random Coe¢ cients Logit
Models of Demand.”Journal of Economics & Management Strategy, 9(4): 513-548.
[34] Nevo, Aviv. 2000b. “Mergers with Di¤erentiated Products: The Case of the Ready-to-Eat
Cereal Industry.”RAND Journal of Economics, 31(3): 395-421.
[35] Nevo, Aviv. 2001. “Measuring Market Power in the Ready-to-Eat Cereal Industry.”Econometrica, 69(2): 307-342.
[36] Nevo, Aviv. 2003. “New Products, Quality Changes, and Welfare Measures from Estimated
Demand Systems.”Review of Economics and Statistics, 85(2): 266-275.
[37] Pagan, Adrian R., and J.C. Robertson. “GMM and its Problems.” Manuscript, Australia
National University.
[38] Petrin, Amil. 2002. “Quantifying the Bene…ts of New Products: The Case of the Minivan.”
Journal of Political Economy, 110(4): 705-729.

32
[39] Shachar, Ron, and Barry Nalebu¤. 2004. “Verifying the Solution from a Nonlinear Solver:
A Case Study: Comment.”American Economic Review, 94(1): 382-390.
[40] Small, Keneth, A., and Harvey S. Rosen. 1981. “Applied Welfare Economics with Discrete
Choice Models.”Econometrica. 49(1): 105-130.
[41] Staiger, Douglas, and James H. Stock. 1997. “Instrumental Variables Regression with Weak
Instruments.”Econometrica, 65(3), 557-586.
[42] Stock, James H., and Jonathan H. Wright. 2000. “GMM with Weak Identi…cation.”Econometrica, 68(5): 1055-1096.
[43] Stock, James H., Jonathan H. Wright and Motohiro Yogo. 2002. “A Survey of Weak Instruments and Weak Identi…cation in Generalized Method of Moments.” Journal of Business
and Economic Statistics. 20(4): 518-529.
[44] Torczon, Virginia. 1997. “On the Convergence of Pattern Search Algorithms.”Siam Journal of Optimization, 7(1): 1-25.
[45] Venkataraman, P. 2002. Applied Optimization with Matlab Programming. New York: Willey.
[46] Yang, Won Young, Wenwu Cao, Tae-Sang Chung, and John Morris. 2005. Applied Numerical Methods using Matlab. New York: Willey

34

A Figures

1
2
3
4
5
7
8
9
10
100

200
300
GMM Objective Function Value

400

Figure 1: GMM objective values for converged algorithms using the automobile
data. This truncates the upper 10% of the converged GMM objective values.
Algorithm 6 (JBES Genetic Algorithm) never converges.
The box represents the 25th and 75th percentiles with a median line. Whiskers
extend from the box to the upper and lower adjacent values and are capped with
an adjacent line. The upper adjacent value is the largest data value that is less
than or equal to the third quartile plus 1.5 X IQR and the lower adjacent value
is the smallest data value that is greater than or equal to the first quartile minus
1.5 X IQR. Dots represent values outside these “adjacent values”.

0

20

40

60

80

35

100

200
300
GMM Objective Values

Figure 2: A histogram of GMM objective values for converged algorithms using
the automobile data. This truncates the upper 10% of the converged GMM
objective values.

400

36

1
2
3
4
5
9
10
0

100
200
GMM Objective Function Value

300

Figure 3: GMM objective values for converged algorithms using the cereal data
This truncates the upper 25% of the converged GMM objective values.
Algorithms 6 (JBES Genetic Algorithm) and 7 (Simulated Annealing) never
converge. Algorithm 8 (MADS) converges twice, but at objective values above
the 75th percentile. A large fraction of the GMM objective values associated with
non-converged sets of parameters for algorithms 7 and 8 lie below 300, but are
omitted.
The box represents the 25th and 75th percentiles with a median line. Whiskers
extend from the box to the upper and lower adjacent values and are capped with
an adjacent line. The upper adjacent value is the largest data value that is less
than or equal to the third quartile plus 1.5 X IQR and the lower adjacent value
is the smallest data value that is greater than or equal to the first quartile minus
1.5 X IQR. Dots represent values outside these “adjacent values”.

0

20

40

60

80

37

0

100
200
GMM Objective Values

300

Figure 4: A histogram of GMM objective values for converged algorithms using
the cereal data. This truncates the upper 25% of the converged GMM objective
values.

38

150

50th Percentile

100

Frequency

-3.63
The “truth”

The “truth”

0

0

50

100

-3.00

50

150

25th Percentile

-5.00

-4.00
-3.00
-2.00
Own-Price Elasticity

-1.00

-6.00

-4.00
-2.00
Own-Price Elasticity

-3.33
100
0

50

40
20
0

The “truth”

Frequency

-3.40
The “truth”

60

80

150

Maximum

100

75th Percentile

0.00

-10.00

-8.00
-6.00
-4.00
-2.00
Own-Price Elasticity

0.00

-10.00

-8.00
-6.00
-4.00
-2.00
Own-Price Elasticity

0.00

Figure 5: Histogram of candidate set of own-price elasticities for four products
for the automobile data. The truth is defined as the set of parameter estimates
that lead to the lowest GMM objective value.
The graphs omit all sets of results that converged but had GMM objective values
in the upper decile. The graphs also truncate above at zero and below the 10 th
percentile.
The average within-product-market standard deviation in the estimated
elasticities across all converged results is 15.13; the median is 9.65. The average
own-price elasticity is -6.12. Among the ``best’’ sets of parameter values,
the mean standard deviation is 1.75, the median is 1.19, and the mean
own-price elasticity is -2.92.

.4

.6

.8

1

39

0

.2

The “Truth”

-5

-4

-3
-2
Own-Price Elasticity

Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

-1
Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 6: Density estimates of the own-price elasticities across all products in
the automobile data, using the “best” set of parameters for each algorithm.
These densities truncate the lower 10% among converged sets of results.

0

.6

40

0

.2

.4

The “Truth” is not found. Minimum GMM obj function is 204.5, compared to 125.5

-25

-20

-15
-10
Own-Price Elasticity

Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

-5
Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 7: Density estimates of the own-price elasticities across all products in
the automobile data, using the “best” set of parameters for each algorithm.
This assumes the research tries 20 starting values, instead of 50.
These densities truncate the lower 10% among converged sets of results using
the first 20 sets of starting values.

0

41

50th Percentile
80

80

100

25th Percentile

60
40

Frequency

0

20

20
0

-1.29
The “truth”

The “truth”

40

60

-45.3

-50.000 -40.000 -30.000 -20.000 -10.000
Own-Price Elasticity

0.000

-2.000

0.000

Maximum
60
40
0

20

40
0

20

-1.46
The “truth”

The “truth”

Frequency

-2.34

60

80

80

100

75th Percentile

-1.500
-1.000
-0.500
Own-Price Elasticity

-6.000

-4.000
-2.000
Own-Price Elasticity

0.000

-1.500

-1.000
-0.500
Own-Price Elasticity

0.000

Figure 8: Histogram of candidate set of own-price elasticities for four products
for the cereal data. The truth is defined as the set of parameter estimates
that lead to the lowest GMM objective value.
The graphs omit all sets of results that converged but had GMM objective values
in the upper decile. The graphs also truncate above at zero and below the 10 th
percentile.
The average within-product-market standard deviation in the estimated
elasticities across all converged results is 7.50; the median is 3.24. The average
own-price elasticity is -9.93. Among the ``best’’ sets of parameter values,
the mean standard deviation is 4.92, the median is 1.87, and the mean
own-price elasticity is -9.96.

42

30
20

Frequency

10
0

30
20

-40.000

-1.29
The “truth”

10

-45.3
The “truth”

0

40

50th Percentile

40

25th Percentile

-30.000 -20.000 -10.000
Own-Price Elasticity

0.000

-2.000

50
30

40

-1.46

0

0

10

20

The “truth”

The “truth”

Frequency

20

-2.34

10

0.000

Maximum

30

75th Percentile

-1.500
-1.000
-0.500
Own-Price Elasticity

-6.000

-4.000
-2.000
Own-Price Elasticity

0.000

-1.200 -1.000 -0.800 -0.600 -0.400 -0.200
Own-Price Elasticity

Figure 9: Histogram of candidate set of own-price elasticities for four products
for the cereal data without using algorithms 3 and 5. The truth is defined as the
set of parameter estimates that lead to the lowest GMM objective value.
The average within-product-market standard deviation in the estimated
elasticities across all converged results is 7.50; the median is 3.24. The average
own-price elasticity is -9.93. Among the ``best’’ sets of parameter values,
the mean standard deviation is 4.92, the median is 1.87, and the mean
own-price elasticity is -9.96.

.2

43

0

.05

.1

.15

The “Truth”

-10

-8

-6
-4
Own-Price Elasticity

Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

-2

0

Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 10: Density estimates of the own-price elasticities across all products in
the cereal data, using the “best” set of parameters for each algorithm.
For the JBES GA and Simulated Annealing algorithms, the best set of parameters
do not meet the convergence criteria.
These densities truncate the lower 10% among converged sets of results.

44

50th Percentile
80

0.13

60
40
0

0

20

Frequency

100

0.15

The “truth”

The “truth”

50

100

150

25th Percentile

0.000 0.100 0.200 0.300 0.400 0.500
Cross-Price Elasticity for Closest Substitute

0.000
0.100
0.200
0.300
Cross-Price Elasticity Closest for Substitute

100
80
60
40

0.024

20

Frequency

60

0.0006

0

0

20

40

Maximum
The “truth”

The “truth”

80

100

75th Percentile

0.000
0.100
0.200
0.300
Cross-Price Elasticity for Closest Substitute

0.000
0.050
0.100
0.150
0.200
0.250
Cross-Price Elasticity for Closest Substitute

Figure 11: Histogram of candidate set of cross-price elasticities for four products
in the automobile data. The cross product is chosen as the product that is the
closest substitute across all sets of results that led to convergence. The truth is
defined as the set of parameter estimates that lead to the lowest GMM objective
value. All graphs truncate the upper 10% of values and below zero.

45

60
40

Maximum

0.11

40

60

80
0

0

20

0.68
Frequency

80
60

20

75th Percentile
100

0.000
0.100
0.200
0.300
0.400
Cross-Price Elasticity Closest for Substitute

The “truth”

40

0

0

20

40

The “truth”

0.000
2.000
4.000
6.000
8.000
Cross-Price Elasticity for Closest Substitute

The “truth”

20

0.25
The “truth”

Frequency

80

8.10

60

80

100

50th Percentile

100

25th Percentile

0.000
0.500
1.000
1.500
Cross-Price Elasticity for Closest Substitute

0.000
0.050
0.100
0.150
Cross-Price Elasticity for Closest Substitute

Figure 12: Histogram of candidate set of cross-price elasticities for four products
in the cereal data. The cross product is chosen as the product that is the
closest substitute. The truth is defined as the set of parameter estimates that
lead to the lowest GMM objective value.
These graphs truncate the largest 5 percent of elasticities and the worst 10% of
results in terms of the GMM objective function.

46

50th Percentile

10
0

40
20

The “truth”

The “truth”

0

20

0.25
Frequency

8.10

60

80

30

100

25th Percentile

0.000
2.000
4.000
6.000
8.000
Cross-Price Elasticity for Closest Substitute

0.000
0.100
0.200
0.300
0.400
Cross-Price Elasticity Closest for Substitute

Maximum
50
40
30
20
10
0

10
5
0

0.11
The “truth”

The “truth”

Frequency

0.68

15

20

25

75th Percentile

0.000
0.500
1.000
1.500
Cross-Price Elasticity for Closest Substitute

0.000
0.050
0.100
0.150
Cross-Price Elasticity for Closest Substitute

Figure 13: Histogram of candidate set of cross-price elasticities for four products
in the cereal data without using algorithms 3 and 5. The cross product is chosen
as the product that is the closest substitute. The truth is defined as the set of
parameter estimates that lead to the lowest GMM objective value.
These graphs truncate the largest 5 percent of elasticities and the worst 10% of
results in terms of the GMM objective function.

2

3

47

0

1

The “Truth”

0
.2
.4
.6
.8
Cross-Price Elaticities for Product with Highest Average Cross-Price Elasticity
Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 14: Density estimates of the cross-price elasticities across all products in
the cereal data for the product that has the highest average cross-price
elasticity. These results use the “best” set of parameters for each algorithm and
truncate at zero and above the 75th percentile.

4

48

0

1

2

3

The “Truth”

0
.1
.2
.3
.4
Cross-Price Elaticities for Product with Highest Average Cross-Price Elasticity
Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 15: Density estimates of the cross-price elasticities across all products in
the cereal data for the product that has the highest average cross-price
elasticity focusing on the elasticities ranging from 0 to one half of the 75 th percentile.
These results use the “best” set of parameters for each algorithm.

4

49

0

1

2

3

The “Truth”

.4
.5
.6
.7
.8
Cross-Price Elaticities for Product with Highest Average Cross-Price Elasticity
Quasi-Newton 1
SolvOpt
Quasi-Newton 2
Simulated Annealing
GPS

Simplex
Conjugate Gradient
JBES GA
MADS
Matlab GA

Figure 16: Density estimates of the cross-price elasticities across all products in
the cereal data for the product that has the highest average cross-price
elasticity focusing on the elasticities ranging from one half of the 75 th percentile to
the 75th percentile. These results use the “best” set of parameters for each algorithm.

150

50

50

100

-9.45

0

The “truth”

-40

-30
-20
-10
Change in Consumer Welfare (billions of dollars)

0

Figure 17: Histogram of estimated change in total welfare from hypothetical
merger using the automobile data. This truncates below at the lower 1% and
above at 0. The range across eight “best” estimates is -52.76 to +7.05, the upper
and lower range among the best estimates are truncated.

80

51

0

The “truth”

20

40

60

-17.2

-25

-20
-15
-10
-5
Change in Consumer Welfare (millions of dollars)

Figure 18: Histogram of estimated change in total welfare from hypothetical
merger using the cereal data. The range across nine “best” estimates is -8.66
to -17.2.

0

25

52

10

15

20

-17.2

0

5

The “truth”

-25

-20
-15
-10
-5
Change in Consumer Welfare (millions of dollars)

Figure 19: Histogram of estimated change in total welfare from hypothetical
merger using the cereal data when algorithms 3 and 5 are not used. The range
across eight “best” estimates is -8.66 to -17.2.

0

0

.2

.4

.6

.8

53

-4

-3

-2
Own-Price Elasticity

-1

Figure 20: Density estimates of the estimated own-price elasticities for the 60
local minima for the automobile data. This does not include the set of
parameters leading to the lowest GMM objective function uncovered in our
exercise.
These densities truncate the lower 10% of elasticities and omit minima with
objective values above 300.

0

0

5

10

15

54

-6

-5.5
-5
-4.5
Change in Consumer Welfare (billions of dollars)

-4

Figure 21: Histogram of estimated change in total welfare from hypothetical
merger using the automobile data for the 60 local minima. The range is from
-$3.83 billion to -$6.01 billion. This does not include the set of parameters
leading to the lowest GMM objective function uncovered in our exercise.
The set of parameters leading to lowest GMM objective function resulted in a
welfare change of -$9.45 billion.

0

.1

.2

.3

.4

.5

55

-10

-8

-6
-4
Own-Price Elasticity

-2

Figure 22: Density estimates of the estimated own-price elasticities for the 26
local minima for the cereal data. These are truncated at -10.

0

0

.5

1

1.5

2

56

-10

-9
-8
-7
Change in Consumer Welfare (millions of dollars)

-6

Figure 23: Histogram of estimated change in total welfare from hypothetical
merger using the cereal data for the 26 local minima. These results truncate
above 0.

57

200

50th Percentile
150
0

50

100
0

50

-3.11
The “truth”

The “truth”

Frequency

150

-1.81

100

200

25th Percentile

-5.000

-4.000
-3.000
-2.000
Own-Price Elasticity

-1.000

-6.000

-4.000
-2.000
Own-Price Elasticity

200

Maximum
150
0

50

Frequency

0

50

-2.99
The “truth”

The “truth”

100

150

-2.43

100

200

75th Percentile

0.000

-8.000

-6.000
-4.000
-2.000
Own-Price Elasticity

0.000

-10.000 -8.000 -6.000 -4.000 -2.000
Own-Price Elasticity

0.000

Figure 24: Histogram of candidate set of own-price elasticities for four products
for the automobile data using a contraction mapping tolerance of 10 -16. The truth
is defined as the set of parameter estimates that lead to the lowest GMM
objective value.
These use roughly the same bin width and horizontal scale as in Figure 5.
The average within-product-market standard deviation in the estimated
elasticities across all converged results is 11.9; the median is 8.88. For comparison
using 10-08 as the tolerance, the mean and median are 15.13 and 9.65,
respectively.
The true elasticities using 10-08 as the tolerance are -3.00, -3.63, -3.33, and -3.40
for products 1, 2, 3 and 4, respectively.

0

50

100

150

200

58

150

200

250
GMM Objective Values

300

Figure 25: A histogram of GMM objective values for converged algorithms using
the automobile data using a contraction mapping tolerance of 10 -16. This
truncates the upper 10% of the converged GMM objective values. The
parameters that lead to the lowest objective value uncovered (133.8) did not
achieve convergence; therefore, this objective value is not reflected in the
histogram.

59

50th Percentile

40

Frequency

0

20

20
0

-1.29
The “truth”

The “truth”

40

60

-45.3

60

80

80

100

25th Percentile

-50.000 -40.000 -30.000 -20.000 -10.000
Own-Price Elasticity

0.000

-2.000

Truncates at -50.

-1.500
-1.000
-0.500
Own-Price Elasticity

0.000

Truncates at -2.

Maximum
60
40
0

20

40
20
0

-1.46
The “truth”

The “truth”

Frequency

-2.34

60

80

80

100

75th Percentile

-6.000

-4.000
-2.000
Own-Price Elasticity

Truncates at -6.

0.000

-1.500

-1.000
-0.500
Own-Price Elasticity

0.000

Truncates at -2.

Figure 26: Histogram of candidate set of own-price elasticities for four products
for the cereal data. The truth is defined as the set of parameter estimates
that lead to the lowest GMM objective value.
These use roughly the same bin width and horizontal scale as in Figure 6.
The average within-product-market standard deviation in the estimated
elasticities across all converged results is 7.78; the median is 3.37. For comparison
using 10-08 as the tolerance, the mean and median are 7.58 and 3.24, respectively.

0

20

40

60

80

60

0

500
GMM Objective Values

1000

Figure 27: A histogram of GMM objective values for converged algorithms using
the cereal data using a contraction mapping tolerance of 10 -12. This truncates the
upper 25% of the converged GMM objective values.

B Tables

61

Reported
--7.061
2.883
1.521
-0.122
3.46
-3.612
4.628
1.818
1.05

SEs
-0.941
2.019
0.891
0.32
0.61
-1.485
1.885
1.695
0.272

Table 1: Parameter estimates and GMM objective values for the 9 “best” set of results. The JBES GA
results are omitted since they were unreliable. While the results for the automobile data are not
directly comparable original paper, below we include the results from BLP for comparison. Our model
differs in two key respects: 1. We do not include supply side moments. 2. Our functional form for
demand is slightly different.
Price
Constant
HP/Weight
Air Conditioning
Mile/$
Size
Sigma_price
Sigma_C
Sigma_HP/Weight
Sigma_AC
Sigma_Mile/$
GMM Obj

62

Table 1b: Parameter estimates and GMM objective values for the 9 “best” set of results with standard
errors. The JBES GA results are omitted since they were unreliable. The standard errors are calculated
ignoring multiple extrema.

63

Table 2: Parameter estimates and GMM objective values for the 9 “best” set of results. The JBES GA
results are omitted since they were unreliable. We include the results from Nevo (2000) for comparison;
here the models are identical.

We present the MADS results that lead to the lowest GMM objective function. However, the algorithm
did not converge at this point.

64

Table 2b: Parameter estimates and GMM objective values for the 9 “best” set of results with standard
errors. The JBES GA results are omitted since they were unreliable. The standard errors are
calculated ignoring multiple extrema.

65

Table 3: Own-price elasticities for the automobile data. These results report the minimum and
maximum estimated elasticity obtained across converged parameter values for each algorithm. The
“best” is defined as the set of parameters that achieves the lowest GMM objective value. The products
are chosen based on their market shares, with the 25th representing the product with the market
share equal to the 25th percentile, etc.

These results truncate the worst 10% of the sets of results, in terms of the GMM objective value. The
JBES GA never converges, so its results are omitted.

The average within-product-market standard deviation in the estimated elasticities across all
converged results is 16.83; the median is 11.12. The average own-price elasticity is -6.63. Among the
``best’’ sets of parameter values, the mean standard deviation is 8.42, the median is 6.05, and the
mean own-price elasticity is -5.96.

66

Table 4: Own-price elasticities for the cereal data. These results report the minimum and maximum
estimated elasticity obtained across converged parameter values for each algorithm. The “best” is
defined as the set of parameters that achieves the lowest GMM objective value. The JBES GA and
Simulated Annealing algorithms never converge, so their results are omitted. MADS converges, but
only at points where the GMM objective function value is above the 75 th percentile.

The products are chosen based on their market shares, with the 25th representing the product with the
market share equal to the 25th percentile, etc.

67

Table 5: Cross-price elasticities for the automobile data. These results report the minimum and
maximum estimated elasticity obtained across converged parameter values for each algorithm. The
cross-product is the closest substitute for the particular product. The “best” is defined as the set of
parameters that achieves the lowest GMM objective value. The products are chosen based on their
market shares, with the 25th representing the product with the market share equal to the 25th
percentile, etc.

These results truncate the worst 10% of the sets of results, in terms of the GMM objective value. The
JBES GA never converges, so its results are omitted.

The average within-product-market standard deviation in the estimated elasticities across all converged
results is 0.23; the median is 0.04. The average cross-price elasticity is 0.01. Among the ``best’’ sets of
parameter values, the mean standard deviation is 0.02, the median is 0.003, and the mean cross-price
elasticity is 0.01.

68

Table 6: Cross-price elasticities for the cereal data. These results report the minimum and maximum
estimated elasticity obtained across converged parameter values for each algorithm. The cross-product is
the closest substitute for the particular product. The “best” is defined as the set of parameters that
achieves the lowest GMM objective value. The products are chosen based on their market shares, with
the 25th representing the product with the market share equal to the 25th percentile, etc.

The JBES GA and Simulated Annealing algorithms never converge, so their results are omitted. MADS
converges, but only at points where the GMM objective function value is above the 75 th percentile.

