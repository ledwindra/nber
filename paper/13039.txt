NBER WORKING PAPER SERIES

REGRESSION DISCONTINUITY DESIGNS:
A GUIDE TO PRACTICE
Guido Imbens
Thomas Lemieux
Working Paper 13039
http://www.nber.org/papers/w13039

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2007

This paper was prepared as an introduction to a special issue of the Journal of Econometrics on regression
discontinuity designs. We are grateful for discussions with David Card and Wilbert van der Klaauw.
Financial support for this research was generously provided through NSF grant SES 0452590 and
the SSHRC of Canada. The views expressed herein are those of the author(s) and do not necessarily
reflect the views of the National Bureau of Economic Research.
© 2007 by Guido Imbens and Thomas Lemieux. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.

Regression Discontinuity Designs: A Guide to Practice
Guido Imbens and Thomas Lemieux
NBER Working Paper No. 13039
April 2007
JEL No. C14,C21
ABSTRACT
In Regression Discontinuity (RD) designs for evaluating causal effects of interventions, assignment
to a treatment is determined at least partly by the value of an observed covariate lying on either side
of a fixed threshold. These designs were first introduced in the evaluation literature by Thistlewaite
and Campbell (1960). With the exception of a few unpublished theoretical papers, these methods did
not attract much attention in the economics literature until recently. Starting in the late 1990s, there
has been a large number of studies in economics applying and extending RD methods. In this paper
we review some of the practical and theoretical issues involved in the implementation of RD methods.
Guido Imbens
Department of Economics
Littauer Center
Harvard University
1805 Cambridge Street
Cambridge, MA 02138
and NBER
imbens@fas.harvard.edu
Thomas Lemieux
Department of Economics
University of British Columbia
#997-1873 East Mall
Vancouver, BC V6T 1Z1
Canada
and NBER
tlemieux@interchange.ubc.ca

1

Introduction

Since the late 1990s there has been a large number of studies in economics applying and
extending RD methods, including Van der Klaauw (2002), Black (1999), Angrist and
Lavy (1999), Lee (this volume), Chay and Greenstone (2005), DiNardo and Lee (2004),
Chay, McEwan, and Urquiola (2005), McEwan and Shapiro (2007), and Card, Mas and
Rothstein (2006). Key theoretical and conceptual contributions include the interpretation
of estimates for fuzzy regression discontinuity designs allowing for general heterogeneity
of treatment e¤ects (Hahn, Todd and Van der Klaauw, 2001, HTV from hereon), adaptive
estimation methods (Sun, 2005), speci…c methods for choosing bandwidths (Ludwig and
Miller, 2005), and various tests for discontinuities in means and distributions of nona¤ected variables (Lee, this volume; McCrary, this volume).
In this paper, we review some of the practical issues in implementation of RD methods.
There is relatively little novel in this discussion. Our general goal is instead to address
practical issues in implementing RD designs and review some of the new theoretical
developments.
After reviewing some basic concepts in Section 2, the paper focuses on …ve speci…c
issues in the implementation of RD designs. In Section 3 we stress graphical analyses
as powerful methods for illustrating the design. In Section 4 we discuss estimation and
suggest using local linear regression methods using only the observations close to the
discontinuity point. In Section 5 we propose choosing the bandwidth using cross validation. In Section 6 we provide a simple plug-in estimator for the asymptotic variance and
a second estimator that exploits the link with instrumental variables methods derived
by HTV. In Section 7 we discuss a number of speci…cation tests and sensitivity analyses
based on tests for (a) discontinuities in the average values for covariates, (b) discontinuities in the conditional density of the forcing variable, as suggested by McCrary, and (c)
discontinuities in the average outcome at other values of the forcing variable.

[1]

2

Sharp and Fuzzy Regression Discontinuity Designs

2.1

Basics

Our discussion will frame the RD design in the context of the modern literature on causal
e¤ects and treatment e¤ects, using the Rubin Causal Model (RCM) set up with potential
outcomes (Rubin, 1974; Holland, 1986; Imbens and Rubin, 2007), rather than the regression framework that was originally used in this literature. For a general discussion of the
RCM and its use in the economic literature, see the survey by Imbens and Wooldridge
(2007).
In the basic setting for the RCM (and for the RD design), researchers are interested in
the causal e¤ect of a binary intervention or treatment. Units, which may be individuals,
…rms, countries, or other entities, are either exposed or not exposed to a treatment.
The e¤ect of the treatment is potentially heterogenous across units. Let Yi (0) and Yi (1)
denote the pair of potential outcomes for unit i: Yi (0) is the outcome without exposure
to the treatment, and Yi (1) is the outcome given exposure to the treatment. Interest is in
some comparison of Yi (0) and Yi (1). Typically, including in this discussion, we focus on
di¤erences Yi (1)

Yi (0). The fundamental problem of causal inference is that we never

observe the pair Yi (0) and Yi (1) together. We therefore typically focus on average e¤ects
of the treatment, that is, averages of Yi (1)

Yi (0) over (sub-)populations, rather than

on unit-level e¤ects. For unit i we observe the outcome corresponding to the treatment
received. Let Wi 2 f0; 1g denote the treatment received, with Wi = 0 if unit i was not

exposed to the treatment, and Wi = 1 otherwise. The outcome observed can then be
written as
Yi = (1

Wi ) Yi (0) + Wi Yi (1) =

Yi (0)
Yi (1)

if Wi = 0;
if Wi = 1:

In addition to the assignment Wi and the outcome Yi , we may observe a vector of covariates or pretreatment variables denoted by (Xi ; Zi ), where Xi is a scalar and Zi is an
M -vector. A key characteristic of Xi and Zi is that they are known not to have been
a¤ected by the treatment. Both Xi and Zi are covariates, with a special role played by
Xi in the RD design. For each unit we observe the quadruple (Yi ; Wi ; Xi ; Zi ). We assume
that we observe this quadruple for a random sample from some well-de…ned population.
The basic idea behind the RD design is that assignment to the treatment is deter[2]

mined, either completely or partly, by the value of a predictor (the covariate Xi ) being
on either side of a …xed threshold. This predictor may itself be associated with the potential outcomes, but this association is assumed to be smooth, and so any discontinuity
of the conditional distribution (or of a feature of this conditional distribution such as the
conditional expectation) of the outcome as a function of this covariate at the cuto¤ value
is interpreted as evidence of a causal e¤ect of the treatment.
The design often arises from administrative decisions, where the incentives for units to
participate in a program are partly limited for reasons of resource constraints, and clear
transparent rules rather than discretion by administrators are used for the allocation of
these incentives. Examples of such settings abound. For example, Hahn, Todd and Van
der Klaauw (1999) study the e¤ect of an anti-discrimination law that only applies to
…rms with at least 15 employees. In another example, Matsudaira (this volume) studies
the e¤ect of a remedial summer school program that is mandatory for students who score
less than some cuto¤ level on a test (see also Jacob and Lefgren, 2004). Access to public
goods such as libraries or museums is often eased by lower prices for individuals depending
on an age cuto¤ value (senior citizen discounts, and discounts for children under some
age limit). Similarly, eligibility for medical services through medicare is restricted by age
(Card, Dobkin and Maestas, 2006).

2.2

The Sharp Regression Discontinuity Design

It is useful to distinguish between two general settings, the Sharp and the Fuzzy Regression Discontinuity (SRD and FRD from hereon) designs (e.g., Trochim, 1984, 2001;
HTV). In the SRD design the assignment Wi is a deterministic function of one of the
covariates, the forcing (or treatment-determining) variable X:1
Wi = 1fXi

cg:

All units with a covariate value of at least c are assigned to the treatment group (and
participation is mandatory for these individuals), and all units with a covariate value
1

Here we take Xi to be a scalar. More generally, the assignment can be a function of a vector of
covariates. Formally, we can write this as the treatment indicator being an indicator for the vector Xi
being an element of a subset of the covariate space, or
Wi = 1fXi 2 X1 g;
where X1

X, and X is the covariate space.

[3]

less than c are assigned to the control group (members of this group are not eligible
for the treatment). In the SRD design we look at the discontinuity in the conditional
expectation of the outcome given the covariate to uncover an average causal e¤ect of the
treatment:
lim E[Yi jXi = x]

lim E[Yi jXi = x];

x#c

x"c

which is interpreted as the average causal e¤ect of the treatment at the discontinuity
point:
SRD

= E[Yi (1)

(2.1)

Yi (0)jXi = c]:

Figures 1 and 2 illustrate the identi…cation strategy in the SRD set up. Based on
arti…cial population values, we present in Figure 1 the conditional probability of receiving
the treatment, Pr(W = 1jX = x) against the covariate x. At x = 6 the probability jumps
from zero to one. In Figure 2, three conditional expectations are plotted. The two dashed
lines in the …gure are the conditional expectations of the two potential outcomes given the
covariate,

w (x)

= E[Y (w)jX = x], for w = 0; 1. These two conditional expectations are

continuous functions of the covariate. Note that we can only estimate
and

1 (x)

for x

0 (x)

for x < c,

c. In addition we plot the conditional expectation of the observed

outcome,
E[Y jX = x] =
E[Y jW = 0; X = x] Pr(W = 0jX = x)+E[Y jW = 1; X = x] Pr(W = 1jX = x)
in Figure 2, indicated by a solid line. Although the two conditional expectations of the
potential outcomes

w (x)

are continuous, the conditional expectation of the observed

outcome jumps at x = c = 6.
Now let us discuss the interpretation of limx#c E[Yi jXi = x]

limx"c E[Yi jXi = x] as an

average causal e¤ect in more detail. In the SRD design, the widely used unconfoundedness
assumption (e.g., Rosenbaum and Rubin, 1983, Imbens, 2004) underlying most matchingtype estimators still holds:
Yi (0); Yi (1) ?
? Wi

Xi :
[4]

This assumption holds in a trivial manner, because conditional on the covariates there
is no variation in the treatment. However, this assumption cannot be exploited directly.
The problem is that the second assumption that is typically used for matching-type
approaches, the overlap assumption which requires that for all values of the covariates
there are both treated and control units, or
0 < Pr(Wi = 1jXi = x) < 1;
is fundamentally violated. In fact, for all values of x the probability of assignment is
either zero or one, rather than always between zero and one as required by the overlap
assumption. As a result, there are no values of x with overlap.
This implies there is a unavoidable need for extrapolation. However, in large samples
the amount of extrapolation required to make inferences is arbitrarily small, as we only
need to infer the conditional expectation of Y (w) given the covariates " away from where
it can be estimated. To avoid non-trivial extrapolation we focus on the average treatment
e¤ect at X = c,
SRD

= E [Y (1)

Y (0)jX = c] = E [Y (1)jX = c]

E [Y (0)jX = c] :

(2.2)

By design, there are no units with Xi = c for whom we observe Yi (0). We therefore will
exploit the fact that we observe units with covariate values arbitrarily close to c.2 In order
to justify this averaging we make a smoothness assumption. Typically this assumption
is formulated in terms of conditional expectations:
Assumption 2.1 (Continuity of Conditional Regression Functions)
E[Y (0)jX = x]

and E[Y (1)jX = x];

are continuous in x.
More generally, one might want to assume that the conditional distribution function is
smooth in the covariate. Let FY (w)jX (yjx) = Pr(Y (w)

yjX = x) denote the conditional

distribution function of Y (w) given X. Then the general version of the assumption is:
2

Although in principle the …rst term in the di¤erence in (2.2) would be straightforward to estimate if
we actually observed individuals with Xi = x, with continuous covariates we also need to estimate this
term by averaging over units with covariate values close to c.

[5]

Assumption 2.2 (Continuity of Conditional Distribution Functions)
FY (0)jX (yjx)

and FY (1)jX (yjx);

are continuous in x for all y.
Both these assumptions are stronger than required, as we will only use continuity
at x = c, but it is rare that it is reasonable to assume continuity for one value of the
covariate, but not at other values of the covariate. We therefore make the stronger
assumption.
Under either assumption,
E[Y (0)jX = c] = lim E[Y (0)jX = x] = lim E[Y (0)jW = 0; X = x] = lim E[Y jX = x];
x"c

x"c

x"c

and similarly
E[Y (1)jX = c] = lim E[Y jX = x]:
x#c

Thus, the average treatment e¤ect at c,
SRD

= lim E[Y jX = x]
x#c

SRD ,

satis…es

lim E[Y jX = x]:
x"c

The estimand is the di¤erence of two regression functions at a point. Hence, if we try to
estimate this object without parametric assumptions on the two regression functions, we
do not obtain root N consistent estimators. Instead we get consistent estimators that
converge to their limits at a slower, nonparametric rates.
As an example of a SRD design, consider the study of the e¤ect of party a¢ liation
of a congressman on congressional voting outcomes by Lee (this volume). See also Lee,
Moretti and Butler (2004). The key idea is that electoral districts where the share of the
vote for a Democrat in a particular election was just under 50% are on average similar in
many relevant respects to districts where the share of the Democratic vote was just over
50%, but the small di¤erence in votes leads to an immediate and big di¤erence in the
party a¢ liation of the elected representative. In this case, the party a¢ liation always
jumps at 50%, making this is a SRD design. Lee looks at the incumbency e¤ect. He is
interested in the probability of Democrats winning the subsequent election, comparing
districts where the Democrats won the previous election with just over 50% of the popular
vote with districts where the Democrats lost the previous election with just under 50%
of the vote.
[6]

2.3

The Fuzzy Regression Discontinuity Design

In the Fuzzy Regression Discontinuity (FRD) design, the probability of receiving the
treatment needs not change from zero to one at the threshold. Instead, the design allows
for a smaller jump in the probability of assignment to the treatment at the threshold:
lim Pr(Wi = 1jXi = x) 6= lim Pr(Wi = 1jXi = x);
x#c

x"c

without requiring the jump to equal 1. Such a situation can arise if incentives to participate in a program change discontinuously at a threshold, without these incentives being
powerful enough to move all units from nonparticipation to participation. In this design
we interpret the ratio of the jump in the regression of the outcome on the covariate to the
jump in the regression of the treatment indicator on the covariate as an average causal
e¤ect of the treatment. Formally, the estimand is
FRD

=

limx#c E[Y jX = x]
limx#c E[W jX = x]

limx"c E[Y jX = x]
:
limx"c E[W jX = x]

Let us …rst consider the interpretation of this ratio. HTV, in arguably the most
important theoretical paper in the recent RD literature, exploit the instrumental variables
connection to interpret the fuzzy regression discontinuity design when the e¤ect of the
treatment varies by unit, as in Imbens and Angrist (1994).3 Let Wi (x) be potential
treatment status given cuto¤ point x, for x in some small neighborhood around c. Wi (x)
is equal to one if unit i would take or receive the treatment if the cuto¤ point was equal
to x. This requires that the cuto¤ point is at least in principle manipulable. For example,
if X is age, one could imagine changing the age that makes an individual eligible for the
treatment from c to c + . Then it is useful to assume monotonicity (see HTV):
Assumption 2.3 Wi (x) is non-increasing in x at x = c.
Next, de…ne compliance status. This concept is similar to the one used in instrumental
variables settings (e.g., Angrist, Imbens and Rubin, 1996). A complier is a unit such that
lim Wi (x) = 0;

x#Xi

and lim Wi (x) = 1:
x"Xi

3

The close connection between FRD and instrumental variables models led researchers in a number of
cases to interpret RD designs as instrumental variables settings. See, for example, Angrist and Krueger
(1991) and Imbens and Van der Klaauw (1995). The main advantage of thinking of these designs as RD
designs is that it suggests the speci…cation analyses from Section 7.

[7]

Compliers are units that would get the treatment if the cuto¤ were at Xi or below,
but that would not get the treatment if the cuto¤ were higher than Xi . To be speci…c,
consider an example where individuals with a test score less than c are encouraged for
a remedial teaching program (Matsudaira, this issue). Interest is in the e¤ect of the
program on subsequent test scores. Compliers are individuals who would participate
if encouraged (if the test score is below the cuto¤ for encouragement), but not if not
encouraged (if test score is above the cuto¤ for encouragement). Nevertakers are units
with
lim Wi (x) = 0;

x#Xi

and lim Wi (x) = 0;
x"Xi

and alwaystakers are units with
lim Wi (x) = 1;

x#Xi

and lim Wi (x) = 1:
x"Xi

Then
FRD

=

limx#c E[Y jX = x]
limx#c E[W jX = x]
= E[Yi (1)

limx"c E[Y jX = x]
limx"c E[W jX = x]

Yi (0)junit i is a complier and Xi = c]:

The estimand is an average e¤ect of the treatment, but only averaged for units with
Xi = c (by regression discontinuity), and only for compliers (people who are a¤ected by
the threshold).
In Figure 3 we plot the conditional probability of receiving the treatment for an FRD
design. As in the SRD design, this probability still jumps at x = 6, but now by an
amount less than one. Figure 4 presents the expectation of the potential outcomes given
the covariate and the treatment, E[Y (w)jW = w; X = x], represented by the dashed
lines, as well as the conditional expectation of the observed outcome given the covariate
(solid line):
E[Y jX = x]
= E[Y (0)jW = 0; X = x] Pr(W = 0jX = x)+E[Y (1)jW = 1; X = x] Pr(W = 1jX = x):
Note that it is no longer necessarily the case here that E[Y (w)jW = w; X = x] =
E[Y (w)jX = x]. Under some assumptions (unconfoundedness) this will be true, but this
is not necessary for inference regarding causal e¤ects in the FRD setting.
[8]

As an example of a FRD design, consider the study of the e¤ect of …nancial aid on
college attendance by Van der Klaauw (2002). Van der Klaauw looks at the e¤ect of
…nancial aid on acceptance on college admissions. Here Xi is a numerical score assigned
to college applicants based on the objective part of the application information (SAT
scores, grades) used to streamline the process of assigning …nancial aid o¤ers. During the
initial stages of the admission process, the applicants are divided into L groups based on
discretized values of these scores. Let
8
>
1
if 0 Xi < c1
>
>
< 2
if c1 Xi < c2
Gi =
..
>
.
>
>
: L
if cL 1 Xi

denote the …nancial aid group. For simplicity, let us focus on the case with L = 2, and
a single cuto¤ point c. Having a score of just over c will put an applicant in a higher
category and increase the chances of …nancial aid discontinuously compared to having a
score of just below c. The outcome of interest in the Van der Klaauw study is college
attendance. In this case, the simple association between attendance and the …nancial aid
o¤er is ambiguous. On the one hand, an aid o¤er makes the college more attractive to
the potential student. This is the causal e¤ect of interest. On the other hand, a student
who gets a generous …nancial aid o¤er is likely to have better outside opportunities in
the form of …nancial aid o¤ers from other colleges. College aid is emphatically not a
deterministic function of the …nancial aid categories, making this a fuzzy RD design.
Other components of the application that are not incorporated in the numerical score
(such as the essay and recommendation letters) undoubtedly play an important role.
Nevertheless, there is a clear discontinuity in the probability of receiving an o¤er of a
larger …nancial aid package.

2.4

The FRD Design and Unconfoundedness

In the FRD setting, it is useful to contrast the RD approach with estimation of average causal e¤ects under unconfoundedness. The unconfoundedness assumption (e.g.,
Rosenbaum and Rubin, 1983; Imbens, 2004) requires that
Y (0); Y (1) ?
? W

X:
[9]

If this assumption holds, then we can estimate the average e¤ect of the treatment at
X = c as
E[Y (1)

Y (0)jX = x] = E[Y jW = 1; X = c]

E[Y jW = 0; X = c]:

This approach does not exploit the jump in the probability of assignment at the discontinuity point. Instead it assumes that di¤erences between treated and control units with
Xi = c are interpretable as average causal e¤ects.
In contrast, the assumptions underlying a FRD analysis implies that comparing
treated and control units with Xi = c is likely to be the wrong approach. Treated units
with Xi = c include compliers and alwaystakers, and control units at Xi = c consist of
nevertakers. Comparing these di¤erent types of units has no causal interpretation under
the FRD assumptions. Although, in principle, one cannot test the unconfoundedness
assumption, one aspect of the problem makes this assumption fairly implausible. Unconfoundedness is fundamentally based on units being comparable if their covariates are
similar. This is not an attractive assumption in the current setting where the probability
of receiving the treatment is discontinuous in the covariate. Thus, units with similar
values of the forcing variable (but on di¤erent sides of the threshold) must be di¤erent in
some important way related to the receipt of treatment. Unless there is a substantive argument that this di¤erence is immaterial for the comparison of the outcomes of interest,
an analysis based on unconfoundedness is not attractive.

2.5

External Validity

One important aspect of both the SRD and FRD designs is that they, at best, provide
estimates of the average e¤ect for a subpopulation, namely the subpopulation with covariate value equal to Xi = c. The FRD design restricts the relevant subpopulation even
further to that of compliers at this value of the covariate. Without strong assumptions
justifying extrapolation to other subpopulations (e.g., homogeneity of the treatment effect), the designs never allow the researcher to estimate the overall average e¤ect of the
treatment. In that sense the design has fundamentally only a limited degree of external
validity, although the speci…c average e¤ect that is identi…ed may well be of special interest, for example in cases where the policy question concerns changing the location of the
threshold. The advantage of RD designs compared to other non-experimental analyses
[10]

that may have more external validity, such as those based on unconfoundedness, is that
RD designs may have a relatively high degree of internal validity (in settings where they
are applicable).

3

Graphical Analyses

3.1

Introduction

Graphical analyses should be an integral part of any RD analysis. The nature of RD
designs suggests that the e¤ect of the treatment of interest can be measured by the
value of the discontinuity in the expected value of the outcome at a particular point.
Inspecting the estimated version of this conditional expectation is a simple yet powerful
way to visualize the identi…cation strategy. Moreover, to assess the credibility of the RD
strategy, it is useful to inspect two additional graphs for covariates and the density of
the forcing variable. The estimators we discuss later use more sophisticated methods for
smoothing but these basic plots will convey much of the intuition. For strikingly clear
examples of such plots, see Lee, Moretti, and Butler (2004), Lalive (this volume), and
Lee (this volume). Note that, in practice, the visual clarity of the plots is often improved
by adding smoothed regression lines based on polynomial regressions (or other ‡exible
methods) estimated separately on the two sides of the cuto¤ point.

3.2

Outcomes by Forcing Variable

The …rst plot is a histogram-type estimate of the average value of the outcome for di¤erent
values of the forcing variable, the estimated counterpart to the solid line in Figures 2 and
4. For some binwidth h, and for some number of bins K0 and K1 to the left and right
of the cuto¤ value, respectively, construct bins (bk ; bk+1 ], for k = 1; : : : ; K = K0 + K1 ,
where
bk = c

(K0

k + 1) h:

Then calculate the number of observations in each bin:
Nk =

N
X
i=1

1fbk < Xi

bk+1 g;

[11]

and the average outcome in the bin:
Yk =

N
1 X
Yi 1fbk < Xi
Nk i=1

bk+1 g:

The …rst plot of interest is that of the Y k , for k = 1; : : : ; K against the mid point of
the bins, ~bk = (bk + bk+1 )=2. The question is whether around the threshold c there is
any evidence of a jump in the conditional mean of the outcome. The formal statistical
analyses discussed below are essentially just sophisticated versions of this, and if the basic
plot does not show any evidence of a discontinuity, there is relatively little chance that the
more sophisticated analyses will lead to robust and credible estimates with statistically
and substantially signi…cant magnitudes. In addition to inspecting whether there is a
jump at this value of the covariate, one should inspect the graph to see whether there
are any other jumps in the conditional expectation of Y given X that are comparable to,
or larger than, the discontinuity at the cuto¤ value. If so, and if one cannot explain such
jumps on substantive grounds, it would call into question the interpretation of the jump
at the threshold as the causal e¤ect of the treatment. In order to optimize the visual
clarity it is important to calculate averages that are not smoothed over the cuto¤ point.

3.3

Covariates by Forcing Variable

The second set of plots compares average values of other covariates in the K bins. Specifically, let Zi be the M -vector of additional covariates, with m-th element Zim . Then
calculate
Z km

N
1 X
Zim 1fbk < Xi
=
Nk i=1

bk+1 g:

The second plot of interest is that of the Z km , for k = 1; : : : ; K against the mid point
of the bins, ~bk , for all m = 1; : : : ; M . In the case of FRD designs, it is also particularly
useful to plot the mean values of the treatment variable Wi to make sure there is indeed
a jump in the probability of treatment at the cuto¤ point (as in Figure 3). Plotting other
covariates is also useful for detecting possible speci…cation problems (see Section 7.1) in
the case of either SRD or FRD designs.

[12]

3.4

The Density of the Forcing Variable

In the third graph, one should plot the number of observations in each bin, Nk , against
the mid points ~bk . This plot can be used to inspect whether there is a discontinuity in the
distribution of the forcing variable X at the threshold. Such discontinuity would raise the
question of whether the value of this covariate was manipulated by the individual agent,
invalidating the design. For example, suppose that the forcing variable is a test score.
If individuals know the threshold and have the option of re-taking the test, individuals
with test scores just below the threshold may do so, and invalidate the design. Such a
situation would lead to a discontinuity of the conditional density of the test score at the
threshold, and thus be detectable in the kind of plots described here. See Section 7.2 for
more discussion of tests based on this idea.

4
4.1

Estimation: Local Linear Regression
Nonparametric Regression at the Boundary

The practical estimation of the treatment e¤ect

in both the SRD and FRD designs is

largely a standard nonparametric regression problem (e.g., Pagan and Ullah, 1999; Härdle, 1990; Li and Racine, 2007). However, there are two unusual features. In this case
we are interested in the regression function at a single point, and in addition that single
point is a boundary point. As a result, standard nonparametric kernel regression does
not work very well. At boundary points, such estimators have a slower rate of convergence than they do at interior points. Here we discuss a more attractive implementation
suggested by HTV, among others. First de…ne the conditional means
l (x)

= lim E[Y (0)jX = z];
z"x

and

r (x)

= lim E[Y (1)jX = z]:
z#x

The estimand in the SRD design is, in terms of these regression functions,
SRD

=

r (c)

l (c):

A natural approach is to use standard nonparametric regression methods for estimation of
R
K(u)du = 1. Then the regression
l (x) and r (x). Suppose we use a kernel K(u), with
functions at x can be estimated as
P
Xi x
i:Xi <c Yi K
h
^ l (x) = P
;
Xi x
i:Xi <c K
h

and ^ r (x) =
[13]

P

i:Xi c

P

Yi K

i:Xi c

K

Xi x
h
Xi x
h

;

where h is the bandwidth.
The estimator for the object of interest is then
P
Xi x
i:Xi >c Yi K
h
^SRD = ^ r (x) ^ l (x) = P
Xi x
K
i:Xi >c
h

P

i:Xi c

P

Yi K

i:Xi c

K

Xi x
h
Xi x
h

:

In order to see the nature of this estimator for the SRD case, it is useful to focus on a
special case. Suppose we use a rectangular kernel, e.g., K(u) = 1=2 for

1 < u < 1, and

zero elsewhere. Then the estimator can be written as
PN
PN
Xi c + hg
h Xi < cg
i=1 Yi 1fc
i=1 Yi 1fc
^SRD = PN
P
N
Xi c + hg
h Xi < cg
i=1 1fc
i=1 1fc
= Y hr

Y hl ;

the di¤erence between the average outcomes for observations within a distance h of the
cuto¤ point on the right and left of the cuto¤, respectively. Nhr and Nhl denote the
number of observations with Xi 2 [c; c + h] and Xi 2 [c

h; c), respectively. This

estimator can be interpreted as …rst discarding all observations with a value of Xi more
than h away from the discontinuity point c, and then simply di¤erencing the average
outcomes by treatment status in the remaining sample.
This simple nonparametric estimator is in general not very attractive, as pointed out
by HTV and Porter (2003). Let us look at the approximate bias of this estimator through
the probability limit of the estimator for …xed bandwidth. The probability limit of ^ r (c),
using the rectangular kernel, is
R c+h
(x)f (x)dx
=
plim [^ r (c)] = c R c+h
f
(x)dx
c

r (c)

+ lim
x#c

@
h
(x)
+ O h2 :
@x
2

Combined with the corresponding calculation for the control group, we obtain the bias
plim [^ r (c)

^ l (c)]

r (c)

l (c)

=

h
2

lim
x#c

@
@
(x) + lim
(x) + O h2 :
x"c @x
@x

Hence the bias is linear in the bandwidth h, whereas when we nonparametrically estimate
a regression function in the interior of the support we typically get a bias of order h2 .
Note that we typically do expect the regression function to have a non-zero derivative,
even in cases where the treatment has no e¤ect. In many applications the eligibility
criterion is based on a covariate that does have some correlation with the outcome, so
[14]

that, for example, those with poorest prospects in the absence of the program are in the
eligible group. Hence it is likely that the bias for the simple kernel estimator is relatively
high.
One practical solution to the high order of the bias is to use a local linear regression
(e.g., Fan and Gijbels, 1996). An alternative is to use series regression or sieve methods.
Such methods could be implemented in the current setting by adding higher order terms
to the regression function. For example, Lee, Moretti and Butler (2004) include fourth
order polynomials in the covariate to the regression function. The formal properties of
such methods are equally attractive to those of kernel type methods. The main concern
is that they are more sensitive to outcome values for observations far away from the
cuto¤ point. Kernel methods using kernels with compact support rule out any sensitivity
to such observations, and given the nature of RD designs this can be an attractive
feature. Certainly, it would be a concern if results depended in an important way on
using observations far away from the cuto¤ value. In addition, global methods put e¤ort
into estimating the regression functions in areas (far away from the discontinuity point)
that are of no interest in the current setting.

4.2

Local Linear Regression

Here we discuss local linear regression. See for a general discussion Fan and Gijbels
(1996). Instead of locally …tting a constant function, we can …t linear regression functions
to the observations within a distance h on either side of the discontinuity point:
N
X

min
l;

l

(Yi

l

(Yi

r

(Xi

l

c))2 ;

ijc h<Xi <c

and
min

r; r

N
X

r

(Xi

c))2 :

ijc Xi <c+h

The value of

l (c)

is then estimated as

[
^
l (c) = ^ l + l (c
and the value of

r (c)

c) = ^ l ;

is then estimated as

[
^
r (c) = ^ r + r (c

c) = ^ r ;
[15]

Given these estimates, the average treatment e¤ect is estimated as
^SRD = ^ r

^ l:

Alternatively one can estimate the average e¤ect directly in a single regression, by solving
min
; ; ;

N
X

1fc

h

Xi

c + hg (Yi

(Xi

c)

Wi

(Xi

c) Wi )2 ;

i=1

which will numerically yield the same estimate of

SRD .

An alternative is to impose the restriction that the slope coe¢ cients are the same
on both sides of the discontinuity point, or limx#c
be imposed by requiring that

l

=

r.

@
@x

(x) = limx"c

@
@x

(x). This can

Although it may be reasonable to expect the

slope coe¢ cients for the covariate to be similar on both sides of the discontinuity point,
this procedure also has some disadvantages. Speci…cally, by imposing this restriction
one allows for observations on Y (1) from the right of the discontinuity point to a¤ect
estimates of E[Y (0)jX = c] and, similarly, for observations on Y (0) from the left of
discontinuity point to a¤ect estimates of E[Y (1)jX = c]. In practice, one might wish
to have the estimates of E[Y (0)jX = c] based solely on observations on Y (0), and not
depend on observations on Y (1), and vice versa.
We can make the nonparametric regression more sophisticated by using weights that
decrease smoothly as the distance to the cuto¤ point increases, instead of the zero/one
weights based on the rectangular kernel. However, even in this simple case the asymptotic
bias can be shown to be of order h2 , and the more sophisticated kernels rarely make much
di¤erence. Furthermore, if using di¤erent weights from a more sophisticated kernel does
make a di¤erence, it likely suggests that the results are highly sensitive to the choice of
bandwidth. So the only case where more sophisticated kernels may make a di¤erence is
when the estimates are not very credible anyway because of too much sensitivity to the
choice of bandwidth. From a practical point of view, one may just want to focus on the
simple rectangular kernel, but verify the robustness of the results to di¤erent choices of
bandwidth.
For inference we can use standard least squares methods. Under appropriate conditions on the rate at which the bandwidth goes to zero as the sample size increases, the
resulting estimates will be asymptotically normally distributed, and the (robust) standard errors from least squares theory will be justi…ed. Using the results from HTV, the
[16]

optimal bandwidth is h / N

1=5

ing, by requiring that h / N

with 1=5 <

. Under this sequence of bandwidths the asymptotic

distribution of the estimator ^ will have a non-zero bias. If one does some undersmooth< 2=5, then the asymptotic bias disappears

and standard least squares variance estimators will lead to valid con…dence intervals. See
Section 6 for more details.

4.3

Covariates

Often there are additional covariates available in addition to the forcing covariate that
is the basis of the assignment mechanism. These covariates can be used to eliminate
small sample biases present in the basic speci…cation, and improve the precision. In
addition, they can be useful for evaluating the plausibility of the identi…cation strategy,
as discussed in Section 7.1. Let the additional vector of covariates be denoted by Zi . We
make three observations on the role of these additional covariates.
The …rst and most important point is that the presence of these covariates rarely
changes the identi…cation strategy. Typically, the conditional distribution of the covariates Z given X is continuous at x = c. In fact, as we discuss in Section 7, one may wish
to test for discontinuities at that value of x in order to assess the plausibility of the identi…cation strategy. If such discontinuities in other covariates are found, the justi…cation
of the identi…cation strategy may be questionable. If the conditional distribution of Z
given X is continuous at x = c, then including Z in the regression
min
; ; ;

N
X

1fc h

Xi

c+hg (Yi

(Xi

c)

Wi

(Xi

c) Wi

0

2

Zi ) ;

i=1

will have little e¤ect on the expected value of the estimator for , since conditional on
X being close to c, the additional covariates Z are independent of W .
The second point is that even though the presence of Z in the regression does not
a¤ect any bias when X is very close to c, in practice we often include observations with
values of X not too close to c. In that case, including additional covariates may eliminate
some bias that is the result of the inclusion of these additional observations.
Third, the presence of the covariates can improve precision if Z is correlated with the
potential outcomes. This is the standard argument, which also supports the inclusion
of covariates in analyses of randomized experiments. In practice the variance reduction
[17]

will be relatively small unless the contribution to the R2 from the additional regressors
is substantial.

4.4

Estimation for the Fuzzy Regression Discontinuity Design

In the FRD design, we need to estimate the ratio of two di¤erences. The estimation
issues we discussed earlier in the case of the SRD arise now for both di¤erences. In
particular, there are substantial biases if we do simple kernel regressions. Instead, it is
again likely to be better to use local linear regression. We use a uniform kernel, with
the same bandwidth for estimation of the discontinuity in the outcome and treatment
regressions.
First, consider local linear regression for the outcome, on both sides of the discontinuity point. Let
X

^ yl ; ^ yl = arg min
yl ;

yl

yl

(Xi

yl

c)

2

(4.3)

;

i:c h Xi <c

X

^ yr ; ^ yr = arg min
yr ;

Yi

yr

Yi

yr

yr

(Xi

c)

2

:

(4.4)

i:c Xi c+h

The magnitude of the discontinuity in the outcome regression is then estimated as
^y = ^ yr

^ yl :

Second, consider the two local linear regression for the treatment indicator:
X

^ wl ; ^ wl = arg min
wl ;

wl

(Wi

wl

wl

(Xi

c))2 ;

(4.5)

i:c h Xi <c

^ wr ; ^ wr = arg min

wr ; wr

X

(Yi

wr

wr

(Xi

c))2 :

(4.6)

i:c Xi c+h

The magnitude of the discontinuity in the treatment regression is then estimated as
^w = ^ wr

^ wl :

Finally, we estimate the e¤ect of interest as the ratio of the two discontinuities:
^FRD =

^y
^ yr
=
^w
^ wr

^ yl
:
^ wl

(4.7)

[18]

Because of the speci…c implementation we use here, with a uniform kernel, and the
same bandwidth for estimation of the denominator and the numerator, we can characterize the estimator for

as a Two-Stage-Least-Squares (TSLS) estimator. HTV were the

…rst to note this equality, in the setting with standard kernel regression and no additional
covariates. It is a simple extension to show that the equality still holds when we use local
linear regression and include additional regressors. De…ne
0
1
0
1
1
yl
Vi = @ 1fXi < cg (Xi c) A ;
and = @ yl A :
1fXi cg (Xi c)
yr

(4.8)

Then we can write
Yi = 0 Vi +

(4.9)

W i + "i :

Estimating

based on the regression function (4.9) by TSLS methods, with the indi-

cator 1fXi

cg as the excluded instrument and Vi as the set of exogenous variables is

numerically identical to ^FRD as given in (4.7).

5

Bandwidth Selection

An important issue in practice is the selection of the smoothing parameter, the binwidth
h. In general there are two approaches to choosing bandwidths. A …rst approach consists
of characterizing the optimal bandwidth in terms of the unknown joint distribution of
all variables. The relevant components of this distribution can then be estimated, and
plugged into the optimal bandwidth function. The second approach, on which we focus
here, is based on a cross-validation procedure. The speci…c methods discussed here are
similar to those developed by Ludwig and Miller (2005, 2007). In particular, their proposals, like ours, are aimed speci…cally at estimating the regression function at the boundary.
Initially we focus on the SRD case, and in Section 5.2 we extend the recommendations
to the FRD setting.
To set up the bandwidth choice problem we generalize the notation slightly. In the
SRD setting we are interested in
SRD

= lim (x)
x#c

lim (x):
x"c

[19]

We estimate the two terms as
\
lim
(x) = ^ r (c);
x#c

and
\
lim
(x) = ^ l (c);
x"c

where ^ l (x) and ^ l (x) solve
^ l (x); ^ l (x) = arg min
;

X

(Yj

(Xj

x))2 :

(5.10)

X

(Yj

(Xj

x))2 :

(5.11)

jjx h<Xj <x

and ^ r (x) and ^ r (x) solve
^ r (x); ^ r (x) = arg min
;

jjx<Xj <x+h

Let us focus …rst on estimating limx#c (x). For estimation of this limit we are interested
in the bandwidth h that minimizes
"
Qr (x; h) = E

lim (z)
z#x

2

^ r (x)

#

;

at x = c. In principle this could be di¤erent from the bandwidth that minimizes the
corresponding criterion on the lefthand side,
"
#
2

Ql (x; h) = E

lim (x)
x"c

^ l (c)

;

at x = c. However, we will focus on a single bandwidth for both sides of the threshold,
and therefore focus on minimizing
1
1
Q(c; h) = (Ql (c; h) + Qr (c; h)) =
2
2

E

"

2

lim (x)
x"c

^ l (c)

#

+E

We now discuss two methods for choosing the bandwidth.

5.1

Bandwidth Selection for the SRD Design

For a given binwidth h, let the estimated regression function at x be
8
if x < c;
< ^ l (x)
^ r (x)
if x c;
^ (x) =
:
[20]

"

2

lim (x)
x#c

^ r (c)

#!

:

where ^ l (x), ^ l (x), ^ r (x) and ^ r (x) solve (5.10) and (5.11). Note that in order to
mimic the fact that we are interested in estimation at the boundary, we only use the
observations on one side of x in order to estimate the regression function at x, rather
than the observations on both sides of x, that is, observations with x

h < Xj < x + h.

In addition, the strict inequality in the de…nition implies that ^ (x) evaluated at x = Xi
does not depend on Yi .
Now de…ne the cross-validation criterion as
N
1 X
CVY (h) =
(Yi
N i=1

^ (Xi ))2 ;

(5.12)

with the corresponding cross-validation choice for the binwidth
hopt
CV = arg min CVY (h):
h

The expected value of this cross-validation function is, ignoring the term that does not
R
involve h, equal to E[CVY (h)] = C + E[Q(X; h)] = C + Q(x; h)fX (dx). Although the

modi…cation to estimate the regression using one-sided kernels mimics more closely the
estimand of interest, this is still not quite what we are interested in. Ultimately, we are
solely interested in estimating the regression function in the neighborhood of a single
R
point, the threshold c, and thus in minimizing Q(c; h), rather than x Q(x; h)fX (x)dx. If

there are quite a few observations in the tails of the distribution, minimizing the criterion
in (5.12) may lead to larger bins than is optimal for estimating the regression function
around x = c, if c is in the center of the distribution. We may therefore wish to minimize
the cross-validation criterion after …rst discarding observations from the tails. Let qX;
be the
let qX;
Xi

;l

quantile of the empirical distribution of X for the subsample with Xi < c, and
;r

be the

quantile of the empirical distribution of X for the subsample with

c. Then, we may wish to use the criterion
X
1
CVY (h) =
(Yi ^ (Xi ))2 :
N i:q
X q
X; ;l

i

X;1

(5.13)

;r

The modi…ed cross-validation choice for the bandwidth is
;opt
hCV
= arg min CVY (h):

(5.14)

h

The modi…ed cross-validation function has expectation, again ignoring terms that do not
involve h, proportional to E[Q(X; h)jqX;

;l

< X < qX; ;r ]. Choosing a smaller value of
[21]

makes the expected value of the criterion closer to what we are ultimately interested in,
that is, Q(c; h), but has the disadvantage of leading to a noisier estimate of E[CVY (h)].
In practice, one may wish to choose

= 1=2, and discard 50% of the observations on

either side of the threshold, and afterwards assess the sensitivity of the bandwidth choice
to the choice of . Ludwig and Miller (2005) implement this by using only data within 5
percentage points of the threshold on either side.
Note that, in principle, we can use a di¤erent binwidth on either side of the cuto¤
value. However, it is likely that the density of the forcing variable x is similar on both
sides of the cuto¤ point. If, in addition, the curvature is similar on both sides close to
the cuto¤ point, then in large samples the optimal binwidth will be similar on both sides.
Hence, the bene…ts of having di¤erent binwidths on the two sides may not be su¢ cient
to balance the disadvantage of the additional noise in estimating the optimal value from
a smaller sample.

5.2

Bandwidth Selection for the FRD Design

In the FRD design, there are four regression functions that need to be estimated: the
expected outcome given the forcing variable, both on the left and right of the cuto¤ point,
and the expected value of the treatment variable, again on the left and right of the cuto¤
point. In principle, we can use di¤erent binwidths for each of the four nonparametric
regressions.
In the section on the SRD design, we argued in favor of using identical bandwidths
for the regressions on both sides of the cuto¤ point. The argument is not so clear for the
pairs of regression functions by outcome we have here. In principle, we have two optimal
bandwidths, one based on minimizing CVY (h), and one based on minimizing CVW (h),
de…ned correspondingly. It is likely that the conditional expectation of the treatment
variable is relatively ‡at compared to the conditional expectation of the outcome variable,
suggesting one should use a larger binwidth for estimating the former.4 Nevertheless, in
practice it is appealing to use the same binwidth for numerator and denominator. To
avoid asymptotic biases, one may wish to use the smallest bandwidth selected by the
4

In the extreme case of the SRD design where the conditional expectation of W given X is ‡at on
both sides of the threshold, the optimal bandwidth would be in…nity. Therefore, in practice it is likely
that the optimal bandwidth for estimating the jump in the conditional expectation of the treatment
would be larger than the bandwidth for estimating the conditional expectation of the outcome.

[22]

cross validation criterion applied separately to the outcome and treatment regression:
hopt
CV = min arg min CVY (h); arg min CVW (h) ;
h

h

where CVY (h) is as de…ned in (5.12), and CVW (h) is de…ned similarly. Again, a value of
= 1=2 is likely to lead to reasonable estimates in many settings.

6

Inference

We now discuss some asymptotic properties for the estimator for the FRD case given in
(4.7) or its alternative representation in (4.9).5 More general results are given in HTV.
We continue to make some simplifying assumptions. First, as in the previous sections, we
use a uniform kernel. Second, we use the same bandwidth for the estimator for the jump
in the conditional expectation of the outcome and treatment. Third, we undersmooth, so
that the square of the bias vanishes faster than the variance, and we can ignore the bias
in the construction of con…dence intervals. Fourth, we continue to use the local linear
estimator.
Under these assumptions we do two things. First, we give an explicit expression for
the asymptotic variance. Second, we present two estimators for the asymptotic variance.
The …rst estimator follows explicitly the analytic form for the asymptotic variance, and
substitutes estimates for the unknown quantities. The second estimator is the standard
robust variance for the Two-Stage-Least-Squares (TSLS) estimator, based on the sample
obtained by discarding observations when the forcing covariate is more than h away from
the cuto¤ point. The asymptotic variance and the corresponding estimators reported
here are robust to heteroskedasticity.

6.1

The Asymptotic Variance

To characterize the asymptotic variance we need a couple of additional pieces of notation.
De…ne the four variances
2
Yl

= lim Var(Y jX = x);
x"c

2
Yr

= lim Var(Y jX = x);
x#c

5

The results for the SRD design are a special case of those for the FRD design. In the SRD design,
only the …rst term of the asympotic variance in equation (6.18) is left since V w = C y ; w = 0, and the
variance can also be estimated using the standard robust variance for OLS instead of TSLS.

[23]

2
Wl

2
Wr

= lim Var(W jX = x);
x"c

= lim Var(W jX = x);
x#c

and the two covariances
CY W l = lim Cov(Y; W jX = x);

CY W r = lim Cov(Y; W jX = x):

x"c

x#c

2
Wl

Note that, because of the binary nature of W , it follows that
where

Wl

= limx"c Pr(W = 1jX = x), and similarly for

2
W r.

=

Wl

(1

W l ),

To discuss the asymptotic

variance of ^, it is useful to break it up in three pieces. The asymptotic variance of
p
N h(^y
y ) is
V

y

=

4
fX (c)

2
Yr

+

The asymptotic variance of
V

w

=

4
fX (c)

2
Wr

+

2
Yl

p

y; w

=

N h(^w

w)

is

2
Wl

The asymptotic covariance of
C

(6.15)

:

p

(6.16)
N h(^y

y)

p

and

N h(^w

w)

is

4
(CY W r + CY W l ) :
fX (c)

(6.17)

Finally, the asymptotic distribution has the form
p

d

) !N

N h (^

0;

1
2
w

V

y

+

2
y
4
w

V

w

2

y
3
w

C

y; w

(6.18)

:

This asymptotic distribution is a special case of that in HTV (page 208), using the
rectangular kernel, and with h / N

, for 1=5 <

< 2=5 (so that the asymptotic bias

can be ignored).

6.2

A Plug-in Estimator for the Asymptotic Variance

We now discuss two estimators for the asymptotic variance of ^. First, we can estimate
the asymptotic variance of ^ by estimating each of the components,
C

y; w

w,

y,

V w , V y , and

and substituting them into the expression for the variance in (6.18). In order to

do this we …rst estimate the residuals
^"i = Yi

^ y (Xi ) = Yi

1fXi < cg ^ yl
[24]

1fXi

cg ^ yr ;

^ i = Wi

^ w (Xi ) = Wi

1fXi < cg ^ wl

1fXi

cg ^ wr :

Then we estimate the variances and covariances consistently as
^ 2Y l =

^ 2W l =

1
Nhl
1
Nhl

X

^"2i ;

X

^2i ;

^ 2Y r =

ijc h Xi <c

^ 2W r =

ijc h Xi <c

1
C^Y W l =
Nhl

X

ijc h Xi <c

^"i ^i ;

1
Nhr

X

^"2i ;

ijc Xi c+h

1
Nhr

X

^2i ;

ijc Xi c+h

1
C^Y W r =
Nhr

X

^"i ^i :

ijc Xi c+h

Finally, we estimate the density consistently as
Nhl + Nhr
f^X (x) =
:
2 N h
Then we can plug in the estimated components of V y , V

W

, and C

Y

;

W

from (6.15)-

(6.17), and …nally substitute these into the variance expression in (6.18).

6.3

The TSLS Variance Estimator

The second estimator for the asymptotic variance of ^ exploits the interpretation of the
^ as a TSLS estimator, given in (4.9). The variance estimator is equal to the robust
variance for TSLS based on the subsample of observations with c
the indicator 1fXi

h

Xi

c + h, using

cg as the excluded instrument, the treatment Wi as the endogenous

regressor and the Vi de…ned in (4.8) as the exogenous covariates.

7

Speci…cation Testing

There are generally two main conceptual concerns in the application of RD designs, sharp
or fuzzy. A …rst concern about RD designs is the possibility of other changes at the same
cuto¤ value of the covariate. Such changes may a¤ect the outcome, and these e¤ects may
be attributed erroneously to the treatment of interest. For example, at age 65 individuals
become eligible for discounts at many cultural institutions. However, if one …nds that
there is a discontinuity in the number of hours worked by age at 65, this is unlikely to
be the result of these discounts. The more plausible explanation is that there are other
institutional changes that a¤ect incentives to work at age 65. The e¤ect of discounts on
[25]

attendance at these cultural institutions, which may well be present, may be di¢ cult to
detect due to the many other changes at age 65.
The second concern is that of manipulation of the forcing variable. Consider the Van
der Klaauw example where the value of an aggregate admission score a¤ected the likelihood of receiving …nancial aid. If a single admissions o¢ cer scores the entire application
packet of any one individual, and if this person is aware of the importance of this cuto¤
point, they may be more or less likely to score an individual just below the cuto¤ value.
Alternatively, if applicants know the scoring rule, they may attempt to change particular parts of their application in order to end up on the right side of the threshold, for
example by retaking tests. If it is costly to do so, the individuals retaking the test may
be a selected sample, invalidating the basic RD design.
We also address the issue of sensitivity to the bandwidth choice, and more generally
small sample concerns. We end the section by discussing how, in the FRD setting, one
can compare the RD estimates to those based on unconfoundedness.

7.1

Tests Involving Covariates

One category of tests involves testing the null hypothesis of a zero average e¤ect on
pseudo outcomes known not to be a¤ected by the treatment. Such variables includes
covariates that are, by de…nition, not a¤ected by the treatment. Such tests are familiar
from settings with identi…cation based on unconfoundedness assumptions (e.g., Heckman
and Hotz, 1989; Rosenbaum, 1987; Imbens, 2004). In the RD setting, they have been
applied by Lee, Moretti and Butler (2004) and others. In most cases, the reason for the
discontinuity in the probability of the treatment does not suggest a discontinuity in the
average value of covariates. If we …nd such a discontinuity, it typically casts doubt on
the assumptions underlying the RD design. In principle, it may be possible to make the
assumptions underlying the RD design conditional on covariates, and so a discontinuity in
the conditional expectation of the covariates does not necessarily invalidate the approach.
In practice, however, it is di¢ cult to rationalize such discontinuities with the rationale
underlying the RD approach.

[26]

7.2

Tests of Continuity of the Density

The second test is conceptually somewhat di¤erent, and unique to the RD setting. McCrary (this volume) suggests testing the null hypothesis of continuity of the density of
the covariate that underlies the assignment at the discontinuity point, against the alternative of a jump in the density function at that point. Again, in principle, one does not
need continuity of the density of X at c, but a discontinuity is suggestive of violations
of the no-manipulation assumption. If in fact individuals partly manage to manipulate
the value of X in order to be on one side of the cuto¤ rather than the other, one might
expect to see a discontinuity in this density at the cuto¤ point. For example, if the
variable underlying the assignment is age with a publicly known cuto¤ value c, and if
age is self-reported, one might see relatively few individuals with a reported age just
below c, and relatively many individuals with a reported age of just over c. Even if such
discontinuities are not conclusive evidence of violations of the RD assumptions, at the
very least, inspecting this density would be useful to assess whether it exhibits unusual
features that may shed light on the plausibility of the design.

7.3

Testing for Jumps at Non-discontinuity Points

A third set of tests involves estimating jumps at points where there should be no jumps.
As in the treatment e¤ect literature (e.g., Imbens, 2004), the approach used here consists
of testing for a zero e¤ect in settings where it is known that the e¤ect should be zero.
Here we suggest a speci…c way of implementing this idea by testing for jumps at the
median of the two subsamples on either side of the cuto¤ value. More generally, one may
wish to divide the sample up in di¤erent ways, or do more tests. As before, let qX;
qX;

;r

be the

and Xi

;l

and

quantiles of the empirical distribution of X in the subsample with Xi < c

c, respectively. Now take the subsample with Xi < c, and test for a jump at

the median of the forcing variable. Splitting this subsample at its median increases the
power of the test to …nd jumps. Also, by only using observations on the left of the cuto¤
value, we avoid estimating the regression function at a point where it is known to have
a discontinuity. To implement the test, use the same method for selecting the binwidth
as before, and estimate the jump in the regression function at qX;1=2;l . Also, estimate the
standard errors of the jump and use this to test the hypothesis of a zero jump. Repeat
[27]

this using the subsample to the right of the cuto¤ point with Xi

c. Now estimate the

jump in the regression function and at qX;1=2;r , and test whether it is equal to zero.

7.4

RD Designs with Misspeci…cation

Lee and Card (this volume) study the case where the forcing variable X is discrete. In
practice this is of course always the case. This implies that ultimately one relies for identi…cation on functional form assumptions for the regression function (x). Lee and Card
consider a parametric speci…cation for the regression function that does not fully saturate the model, that is, it has fewer free parameters than there are support points. They
then interpret the deviation between the true conditional expectation E[Y jX = x] and

the estimated regression function as random speci…cation error that introduces a group
structure on the standard errors. Lee and Card then show how to incorporate this group
structure into the standard errors for the estimated treatment e¤ect. This approach will
tend to widen the con…dence intervals for the estimated treatment e¤ect, sometimes considerably, and leads to more conservative and typically more credible inferences. Within
the local linear regression framework discussed in the current paper, one can calculate
the Lee-Card standard errors (possibly based on slightly coarsened covariate data if X
is close to continuous) and compare them to the conventional ones.

7.5

Sensitivity to the Choice of Bandwidth

All these tests are based on estimating jumps in nonparametric regression or density
functions. This brings us to the third concern, the sensitivity to the bandwidth choice.
Irrespective of the manner in which the bandwidth is chosen, one should always investigate the sensitivity of the inferences to this choice, for example, by including results
for bandwidths twice (or four times) and half (or a quarter of) the size of the originally
chosen bandwidth. Obviously, such bandwidth choices a¤ect both estimates and standard errors, but if the results are critically dependent on a particular bandwidth choice,
they are clearly less credible than if they are robust to such variation in bandwidths. See
Lee, Moretti, and Butler (2004) and Lemieux and Milligan (this volume) for examples of
papers where the sensitivity of the results to bandwidth choices is explored.

[28]

7.6

Comparisons to Estimates Based on Unconfoundedness in
the FRD Design

When we have a FRD design, we can also consider estimates based on unconfoundedness
(Battistin and Rettore, this volume). In fact, we may be able to estimate the average
e¤ect of the treatment conditional on any value of the covariate X under that assumption.
Inspecting such estimates and especially their variation over the range of the covariate
can be useful. If we …nd that, for a range of values of X, our estimate of the average e¤ect
of the treatment is relatively constant and similar to that based on the FRD approach,
one would be more con…dent in both sets of estimates.

8

Conclusion: A Summary Guide to Practice

In this paper, we reviewed the literature on RD designs and discussed the implications
for applied researchers interested in implementing these methods. We end the paper by
providing a summary guide of steps to be followed when implementing RD designs. We
start with the case of SRD, and then add a number of details speci…c to the case of FRD.
Case 1: Sharp Regression Discontinuity (SRD) Designs
1. Graph the data (Section 3) by computing the average value of the outcome variable
over a set of bins. The binwidth has to be large enough to have a su¢ cient amount
of precision so that the plots looks smooth on either side of the cuto¤ value, but at
the same time small enough to make the jump around the cuto¤ value clear.
2. Estimate the treatment e¤ect by running linear regressions on both sides of the
cuto¤ point. Since we propose to use a rectangular kernel, these are just standard
regression estimated within a bin of width h on both sides of the cuto¤ point. Note
that:
Standard errors can be computed using standard least square methods (robust
standard errors)
The optimal bandwidth can be chosen using cross-validation methods (Section
5)

[29]

3. The robustness of the results should be assessed by employing various speci…cation
tests.
Looking at possible jumps in the value of other covariates at the cuto¤ point
(Section 7.1)
Testing for possible discontinuities in the conditional density of the forcing
variable (Section 7.2).
Looking whether the average outcome is discontinuous at other values of the
forcing variable is (Section 7.3).
Using various values of the bandwidth (Section 7.5, with and without other
covariates that may be available.
Case 2: Fuzzy Regression Discontinuity (FRD) Designs
A number of issues arise in the case of FRD designs in addition to those mentioned
above.
1. Graph the average outcomes over a set of bins as in the case of SRD, but also graph
the probability of treatment.
2. Estimate the treatment e¤ect using TSLS, which is numerically equivalent to computing the ratio in the estimate of the jump (at the cuto¤ point) in the outcome
variable over the jump in the treatment variable.
Standard errors can be computed using the usual (robust) TSLS standard errors (Section 6.3), though a plug-in approach can also be used instead (Section
6.2).
The optimal bandwidth can again be chosen using a modi…ed cross-validation
procedure (Section 5)
3. The robustness of the results can be assessed using the various speci…cation tests
mentioned in the case of SRD designs. In addition, FRD estimates of the treatment
e¤ect can be compared to standard estimates based on unconfoundedness.

[30]

References
Angrist, J.D., G.W. Imbens, and D.B. Rubin, 1996, Identi…cation of Causal E¤ects Using
Instrumental Variables, Journal of the American Statistical Association 91, 444–472.
Angrist, J.D. and A.B. Krueger, 1991, Does Compulsory School Attendance A¤ect
Schooling and Earnings?, Quarterly Journal of Economics 106, 979-1014.
Angrist, J.D., and V. Lavy, 1999, Using Maimonides’Rule to Estimate the E¤ect of Class
Size on Scholastic Achievement”, Quarterly Journal of Economics 114, 533-575.
Battistin, E. and E. Rettore, 2007, Ineligibles and Eligible Non-Participants as a Double
Comparison Group in Regression-Discontinuity Designs, Journal of Econometrics, this
issue.
Black, S., 1999, Do Better Schools Matter? Parental Valuation of Elementary Education,
Quarterly Journal of Economics 114, 577-599.
Card, D., C. Dobkin and N. Maestas, 2004, The Impact of Nearly Universal Insurance
Coverage on Health Care Utilization and Health: Evidence from Medicare, NBER Working Paper No. 10365.
Card, D., A. Mas, and J. Rothstein, 2006, Tipping and the Dynamics of Segregation in
Neighborhoods and Schools, Unpublished Manuscript, Department of Economics, Princeton University.
Chay, K., and M. Greenstone, 2005, Does Air Quality Matter; Evidence from the Housing
Market, Journal of Political Economy 113, 376-424.
Chay, K., McEwan, P., and M. Urquiola, 2005, The Central Role of Noise in Evaluating
Interventions That Use Test Scores to Rank Schools, American Economic Review 95,
1237-1258.
DiNardo, J., and D.S. Lee, 2004, Economic Impacts of New Unionization on Private Sector
Employers: 1984-2001, Quarterly Journal of Economics 119, 1383-1441.
Fan, J. and I. Gijbels, 1996, Local Polynomial Modelling and Its Applications (Chapman
and Hall, London).

[31]

Hahn, J., P. Todd and W. Van der Klaauw, 1999, Evaluating the E¤ect of an Anti Discrimination Law Using a Regression-Discontinuity Design, NBER Working Paper 7131.
Hahn, J., P. Todd and W. Van der Klaauw, 2001, Identi…cation and Estimation of
Treatment E¤ects with a Regression Discontinuity Design, Econometrica 69, 201-209.
Härdle, W., 1990, Applied Nonparametric Regression (Cambridge University Press, New
York).
Heckman, J.J. and J. Hotz, 1989, Alternative Methods for Evaluating the Impact of
Training Programs (with discussion), Journal of the American Statistical Association
84, 862-874.
Holland, P., 1986, Statistics and Causal Inference (with discussion), Journal of the American
Statistical Association, 81, 945-970.
Imbens, G., 2004, Nonparametric Estimation of Average Treatment E¤ects under Exogeneity:
A Review, Review of Economics and Statistics 86, 4-30.
Imbens, G., and J. Angrist, 1994, Identi…cation and Estimation of Local Average Treatment E¤ects, Econometrica 61, 467-476.
Imbens, G. and D. Rubin, 2007, Causal Inference: Statistical Methods for Estimating Causal
E¤ ects in Biomedical, Social, and Behavioral Sciences, Cambridge University Press, forthcoming.
Imbens, G. and W. van der Klaauw, 1995, Evaluating the Cost of Conscription in The
Netherlands, Journal of Business and Economic Statistics 13, 72-80.
Imbens, G. and J. Wooldridge, 2007, Recent Developments in the Econometrics of Program Evaluation, Unpublished Manuscript, Department of Economics, Harvard University.
Jacob, B.A., and L. Lefgren, 2004, Remedial Education and Student Achievement: A
Regression-Discontinuity Analysis, Review of Economics and Statistics 68, 226-244.
Lalive, R., 2007, How do Extended Bene…ts a¤ect Unemployment Duration? A Regression
Discontinuity Approach, Journal of Econometrics, this issue.

[32]

Lee, D.S., 2007, Randomized Experiments from Non-random Selection in U.S. House Elections, Journal of Econometrics, this issue.
Lee, D.S. and D. Card, 2007, Regression Discontinuity Inference with Speci…cation Error,
Journal of Econometrics, this issue.
Lee, D.S., Moretti, E., and M. Butler, 2004, Do Voters A¤ect or Elect Policies? Evidence from the U.S. House, Quarterly Journal of Economics 119, 807-859.
Lemieux, T. and K. Milligan, 2007, Incentive E¤ects of Social Assistance: A Regression
Discontinuity Approach, Journal of Econometrics, this issue.
Li, Q., and J. Racine, 2007, Nonparametric Econometrics (Princeton University Press,
Princeton, New Jersey).
Ludwig, J., and D. Miller, 2005, Does Head Start Improve Children’s Life Chances?
Evidence from a Regression Discontinuity Design, NBER working paper 11702.
Ludwig, J., and D. Miller, 2007, Does Head Start Improve Children’s Life Chances? Evidence from a Regression Discontinuity Design, Quarterly Journal of Economics 122(1),
159-208.
Matsudaira, J., 2007, Mandatory Summer School and Student Achievement, Journal of
Econometrics, this issue.
McCrary, J., 2007, Testing for Manipulation of the Running Variable in the Regression
Discontinuity Design, Journal of Econometrics, this issue.
McEwan, P. and J. Shapiro, 2007, The bene…ts of delayed primary school enrollment: Discontinuity estimates using exact birth dates, Wellesley College and LSE working paper.
Pagan, A. and A. Ullah, 1999, Nonparametric Econometrics, Cambridge University Press,
New York.
Porter, J., 2003, Estimation in the Regression Discontinuity Model,”mimeo, Department of
Economics, University of Wisconsin, http://www.ssc.wisc.edu/ jporter/reg_discont_2003.pdf.

[33]

Rosenbaum, P., and D. Rubin, 1983, The Central Role of the Propensity Score in Observational Studies for Causal E¤ects, Biometrika 70, 41-55.
Rosenbaum, P., 1987, The role of a second control group in an observational study (with
discussion), Statistical Science 2, 292–316.
Rubin, D., 1974, Estimating Causal E¤ects of Treatments in Randomized and Non-randomized
Studies, Journal of Educational Psychology 66, 688-701.
Sun, Y., 2005, Adaptive Estimation of the Regression Discontinuity Model, Unpublished
Manuscript, Department of Economics, University of California at San Diego.
Thistlewaite, D., and D. Campbell, 1960, Regression-Discontinuity Analysis: An Alternative to the Ex-Post Facto Experiment, Journal of Educational Psychology 51, 309-317.
Trochim, W., 1984, Research Design for Program Evaluation; The Regression-discontinuity
Design (Sage Publications, Beverly Hills, CA).
Trochim, W., 2001, Regression-Discontinuity Design, in N.J. Smelser and P.B Baltes, eds.,
International Encyclopedia of the Social and Behavioral Sciences 19 (Elsevier NorthHolland, Amsterdam) 12940-12945.
Van Der Klaauw, W., 2002, Estimating the E¤ect of Financial Aid O¤ers on College
Enrollment: A Regression–discontinuity Approach, International Economic Review 43,
1249-1287.

[34]

Fig 1: Assignment Probabilities (Sharp RD)
1
0.8
0.6
0.4
0.2
0
0

1

2

3

4

5

6

7

8

9

10

8

9

10

8

9

10

9

10

Fig 2: Potential and Observed Outcome Regression Functions
5
4
3
2
1
0

0

1

2

3

4

5

6

7

Fig 3: Assignment Probabilities (Fuzzy RD)
1
0.8
0.6
0.4
0.2
0
0

1

2

3

4

5

6

7

Fig 4: Potential and Observed Outcome Regression (Fuzzy RD)
5
4
3
2
1
0

0

1

2

3

4

5

6

7

8

