NBER WORKING PAPER SERIES

SUB-NATIONAL DIFFERENTIATION AND THE ROLE OF THE FIRM IN OPTIMAL
INTERNATIONAL PRICING
Edward J. Balistreri
James R. Markusen
Working Paper 13130
http://www.nber.org/papers/w13130

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2007

This research was sponsored by the United States International Trade Commission. The research is
intended to inform current and future methodologies for policy evaluation. The research is not intended
to evaluate any specific policies. Any opinions or conclusions contained herein are those of the authors,
not the United States International Trade Commission or any of its individual Commissioners. We
received valuable comments and suggestions from Russell H. Hillberry, Robert Koopman, William
M. Powers, and participants of the 8th Annual Conference on Global Economic Analysis (GTAP conference).
We also thank Lauren Davis for valuable research assistance. The views expressed herein are those
of the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.
© 2007 by Edward J. Balistreri and James R. Markusen. All rights reserved. Short sections of text,
not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

Sub-national Differentiation and the Role of the Firm in Optimal International Pricing
Edward J. Balistreri and James R. Markusen
NBER Working Paper No. 13130
May 2007
JEL No. F1,F13
ABSTRACT
We illuminate the relationship between optimal firm pricing and optimal trade policy by exploring
a generalized model that accommodates product differentiation at both the national and sub-national
(firm) levels. We assume monopolistic competition in the differentiated products at the sub-national
level. When the national and sub-national substitution elasticities are similar we find little opportunity
for small countries to improve their terms of trade through trade distortions, because firms play an
important preemptive role in optimally pricing unique varieties. We contrast this with standard applications
of perfect-competition Armington models, which exhibit high optimal tariffs--even for relatively small
countries.
Edward J. Balistreri
Division of Economics and Business
Colorado School of Mines
Golden, CO 80401-1887
ebalistr@mines.edu
James R. Markusen
Department of Economics
University of Colorado
Boulder, CO 80309-0256
and NBER
james.markusen@colorado.edu

1

Introduction

A common feature in many trade-policy applications is the Armington (1969) assumption of
national product differentiation. Brown (1987) critiques these applications, questioning the
validity of simulated liberalizations that result in very large adverse terms-of-trade effects for
relatively small countries. We expand this critique by noting that at the calibration stage of
formulating most Armington models sub-national (firm-level) product differentiation is not
considered. The resulting marginal-cost pricing at the sub-national level implicitly allocates
market power over unique varieties away from optimizing firms and toward the whim of
the policy authority. Although pervasive in applications, this allocation of market power to
countries rather than firms is a troubling departure from traditional tenets.
This study contributes to the policy simulation literature in two important ways. First,
we use a generalized model of nested differentiation to illustrate the mutual consistency between traditional models of national differentiation and the large-group monopolistic competition models popular in new trade theory. Second, we identify a tension in calibration
assumptions between firm-level market power and national-level international-policy leverage. Market power is conceptually observable, and is show to be an important consideration
in applied welfare analysis. Assuming optimal firm-level pricing over a country’s varieties
can significantly reduce the implied optimal tariff.
In the past researchers have responded (at least in part) to the Brown (1987) critique
of the Armington formulation by either modifying parametric assumptions, or by modifying
structural assumptions. For example, McDaniel and Balistreri (2003) highlight the general
view that estimated Armington elasticities are too low, and that practitioners favor higher
elasticities, which imply lower optimal tariffs. Others [e.g., Brown et al. (1992)] adopt a
monopolistically-competitive structure that includes firm-level differentiation and industrywide scale effects. The approach adopted here is to develop a model that maintains the

1

possibility of both types of differentiation (national and sub-national). We show that the
Armington and monopolistic competition structures impose specific parametric restrictions
on our generalized model.1 We thus shift the focus away from alternative structures and
toward potentially measurable parameters.
Our application of the generalized model contributes to the policy debate on both the
theoretic and applied fronts. We show in a stylized theoretic model that increasing the degree
of firm differentiation, relative to national differentiation, acts to reduce the optimal tariff.
The optimal tariff remains positive when the degree of firm differentiation is less than the
degree of national differentiation.2 Positive optimal tariffs under monopolistic competition
are broadly consistent with the theoretic work of Flam and Helpman (1987) and Helpman
and Krugman (1989). Tariffs improve a country’s terms of trade regardless of whether
differentiation is at the firm or at the national level, and the terms-of-trade effects of tariffs
intensify when the degree of national differentiation is higher relative to the degree of firm
differentiation.
We also show, however, that negative optimal tariffs are possible when the degree of
firm-level differentiation is higher than the level of national differentiation.3 This result
is dependent on our assumption that firm markups are based on direct competition with
their domestic rivals. Although natural when firm-level differentiation is lower than national
differentiation, this assumption is more tenuous when domestic varieties are more closely
related to foreign varieties (relative to other domestic varieties). For example, it is natural to
think of a California winery competing more closely with other California wineries. California
1
In fact, the model is also general enough to accommodate the Heckscher-Ohlin-Vanek formulation. In
this case we would set the firm-level and national-level elasticities of substitution to infinity.
2
The relevant measure of the level of differentiation between products is the inverse of the elasticity of
substitution.
3
Markusen (1990) also finds that optimal tariffs might be negative when the degree of domestic differentiation in a monopolistic-competitive industry is low. That model is somewhat different from the one
employed here, however, because it characterizes the role of specialized inputs in a given industry and treats
all other goods as a homogeneous traded good.

2

wineries will largely base their markup on proximity, in product space, to other California
wines.
On the other hand, consider the production of aircraft. It is probably more reasonable
to suppose that Boeing products and Airbus products are less differentiated than Boeing
products and Lockheed Martin products (given that Lockheed Martin does not currently
produce commercial aircraft). The assumption that Boeing would markup its product based
on its degree of differentiation from Lockheed-Martin is logically problematic. For this reason
we place a caveat on our negative optimal tariff results. From an empirical perspective, once
we move to a model with multiple dimensions, commodities should probably be defined in
a way that eliminates the oddity of more domestic differentiation relative to international
differentiation within a given industry. For example, (Boeing) airliners should be considered
a different good than military airplanes and aerospace components (produced by LockheedMartin). As with almost any empirical exercise, aggregation is not innocuous in the context
of assuming markups based on the degree of domestic competition.
Another interesting result that falls out of our stylized theoretic model is that, in the
presence of firm-differentiation, the optimal tariff increases as the overall degree of preference
bias toward home varieties increases. This is important from the perspective of analyzing
how different sets of calibration assumptions alter the policy implications. There is a great
deal of missing trade in our actual observation of the trade equilibrium.4 In contrast to most
theoretic models and econometric applications, simulation models accommodate missing
trade via a preference bias toward home varieties.5 This bias has an effect on the optimal
tariff under firm-level differentiation because it alters the relative impacts of variety changes
(number of foreign versus domestic varieties) on welfare. This is an important consideration
4

Trefler (1995) identifies missing trade relative to what one would expect from the theory.
Hillberry et al. (2005) critique the over reliance calibrated models place on preference distribution parameters, and Balistreri and Hillberry (2004) illustrate the importance of home bias in a welfare analysis of
the US-Canada border effect in a calibrated gravity-model application.
5

3

in any policy simulation model that includes a love-of-variety formulation and calibrated
preferences over regional aggregates.
On the applied front we examine the implications, and sensitivity, of our generalized
demand system in a model calibrated to the Global Trade Analysis Project (GTAP) social
accounts [Dimaranan and McDougall (2005)]. We examine the optimal tariff relative to
global free trade for small and large countries. We generally find that optimal pricing by
firms producing differentiated sub-national products acts to reduce the implied optimal tariff.
We also use the model to simulate the recent U.S.-Australia Free Trade Agreement under
alternative assumptions about firm differentiation. We contrast our results with other studies
that examine the U.S.-Australia Free Trade Agreement.

2

Generalized Demand System

Figure 1 illustrates a generalized demand system for aggregating products differentiated at
both the firm and national levels. Within each country or region (indexed by r ∈ R) traded
goods are produced by monopolistic competitive firms. The composite traded good, Qr , is a
Dixit-Stiglitz aggregate of the Nr individual firm-specific varieties, qr . Although the varieties
produced are different, we assume symmetry across the firms. Algebraically we can represent
the sub-national aggregation of firm-level varieties by
1

Qr = [Nr (qr )αf ] αf , where σf =

1
.
1 − αf

(1)

Throughout our analysis we adopt some simplifying assumptions about the nature of the Qr
that are common in the literature. We assume each of the Nr firms is small and faces an
integrated world market. This indicates a simple markup over marginal cost equal to the
inverse of the elasticity of substitution between firm varieties, 1/σf . Integrated markets imply

4

Figure 1: Nested Demand System

independence between the markup and the region in which the firm’s output is ultimately
consumed.
The parameter σf can take on any value greater than one. The degree of firm-level
differentiation falls as σf increases. When σf takes on a value of infinity then markups are
zero and we have the special case of perfect competition.6 Notice that (1) simply becomes
the sum of the qr at σf equals infinity (αf approaches one as σf approaches infinity). When
σf is finite the free-entry assumption indicates adjustments in the number of varieties such
that operating profits exactly cover fixed cost payments. We also assume that all costs
6

We utilize GAMS software, which accommodates assigned parameter values of +inf. In compilation
GAMS automatically assigns the limits 1/+inf = 0 and (+inf− 1)/+inf = 1. So if we have σf = +inf then
αf takes on a value of 1 when the program is compiled.

5

(marginal and fixed) associated with production use inputs in the same proportion. The
constant-markup formulation indicates constant firm-level output and thus no firm-scale
effects. Changes in industry output are in the form of entry or exit of symmetric varieties.
The love of variety nature of the Dixit-Stiglitz aggregator, however, does indicate industrylevel scale effects. For a general discussion (and critique) of these implications of the largegroup monopolistic-competition assumptions see Markusen (2002), Chapter 6.
At the national level, the demand system in a given region, r, is composed of a CES aggregate of the imported Dixit-Stiglitz composites and the domestic Dixit-Stiglitz composite:
h

Ar = βrr (Qr )αdm + βrM (Mr )αdm




Mr = 

X

βsr Qαs n 

i

1
αdm

, where σdm =

1
αn

, where σn =

s6=r

1
; and
1 − αdm

1
.
1 − αn

(2)

(3)

The substitution elasticity between imported varieties is indicated by σn , and the substitution
elasticity between the imported composite and the domestic composite is indicated by σdm .
In the case that σn equals σdm equation (2) simply collapses to
"

Ar =

X
s

#

βsr Qαs n

1
αn

, where σdm = σn =

1
.
1 − αn

(4)

It is relatively straightforward to accommodate the predominant policy-simulation models
within the general demand system outlined in Figure 1. The special case of a simple constantreturns Armington formulation is accommodated by setting σf equal to infinity (marginalcost pricing by firms) and σn equal to σdm . Contemporary applications tend to adopt the
more complex case where σdm is some fraction—usually one half—of σn .7
7
For example, the default elasticities used in the widely applied Global Trade Analysis Project (GTAP)
model employ the “rule of two,” which assumes σn = 2σdm [Huff et al. (1997)]. We do not intend to
advocate, or perpetuate, the use of this arbitrary rule. We allow for it in our generalized system because
of its prevalence in application. That said, Liu et al. (2002) fail to reject the “rule of two” as a maintained
hypothesis.

6

Another special case often adopted in the policy simulation literature is the Dixit-Stiglitz
formulation of firm-level differentiation. Setting σf equal to σn equal to σdm collapses the
system such that only firm-level varieties are relevant. Thus by adjusting the elasticities
in relation to one another we can explore different assumptions about the general nature of
product differentiation at the firm and national levels. The demand system has the advantage
of accommodating (parametrically) a wide variety of favored structures that are relevant in
the policy forum.

3

Illustrative General-Equilibrium Simulation Model

The strategy for incorporating the generalized demand system in a relatively transparent
simulation environment involves formulating a stylized theoretic model. The general equilibrium is formulated as a Mixed Complementarity Problem (MCP), which is computed using
GAMS software.8 Following Rutherford (1999) the general equilibrium includes three sets
of variables which are associated with three corresponding sets of conditions:
1. transformation activities, which generate outputs or utility, are associated with an
optimality condition given the technologies;
2. prices of inputs, outputs, and composite varieties are associated with market clearance conditions; and
3. nominal income levels for each agent are associated with income balance—between
the value of endowments and the value of demand.
The GAMS code for the algebraic formulation of the nonlinear MCP is presented in Appendix
A. A tabular GAMS/MPSGE formulation is also available from the authors. This section is
divided into two subsections. The first introduces the algebraic formulation, and the second
presents the experimental controls.
8

GAMS Development Corporation: http://www.gams.com.

7

Table 1: Scope of the Stylized Theoretic Model
Equilibrium Condition

(equation)

1)Optimality
Unit-expenditure function = True cost-of-living index
Unit-cost of Ar = The composite price index, PAr
Unit-cost of Qr = the Dixit-Stiglitz price index Pr
Marginal cost = Marginal revenue
Profits = 0

(5)
(6)
(7)
(8)
(9)

Associated Variable

Dimensions

Wr (Hicksian welfare index)
Ar (Armington activity)
Qr (Dixit-Stiglitz Aggregate)
qr (Firm output index)
Nr (Number of firms index)

R
R
R
R
R

2)Market-Clearance
Labor endowment = Demand leisure + Demand for labor
Supply of qr = Demand for qr in Qr
Supply of Qr = Domestic demand + Export demand
Supply of Ar = Demand for Ar in Wr
Nominal value of welfare (Wr ṖWr ) = Nominal Expenditures

(10)
(11)
(12)
(13)
(14)

PLr (Wage index)
pr (Price of firm-level output)
Pr (Dixit-Stiglitz price index)
PAr (Armington price index)
PWr (True cost-of-living index)

R
R
R
R
R

3)Income balance
Nominal expenditure = Value of endowment + Tariff revenue

(15)

RAr (Nominal income)

R

Total Dimensions

3.1

11R

Algebraic formulation

The model incorporates many features designed to indicate how applied general equilibrium
models might react, but also abstracts from many complications that might obscure the
key effects. The model includes multiple regions/countries (indexed by r) that trade on
integrated world markets. This allows us to examine experiments that vary the relative size
of a region and discriminatory trade policies. Other than country size, all other aspects
of each region’s technology and preferences are assumed to be identical. Furthermore, we
assume that each region is endowed with only one factor of production, labor (Lr ), which
might be allocated to production or used directly as an input to welfare (leisure or nontraded sector).9 Thus a country’s size is controlled by changing its share of the total world
endowment of labor. Table 1 outlines the overall scope of the numeric model indicating the
equilibrium conditions and associated variables.
We proceed by specifying the conditions outlined in Table 1. For the first condition note
9
In the case with only national differentiation, the standard Armington formulation, the economy is fully
specialized, and any level of tariff cannot change domestic production. We introduce the labor-leisure choice
decision in order to avoid this complete specialization and inelasticity of traded output with respect to the
tariff.

8

that the unit-expenditure function indicates the marginal cost of a unit of welfare (under
optimal consumption), and the welfare level will satisfy marginal cost equals marginal benefit.
Let PAr equal the price of the composite commodity Ar [from equation (2)], and PLr represent
the price of labor, then assuming Cobb-Douglas utility, the equilibrium conditions associated
with a welfare maximizing mix of goods and leisure are given by
PA1−γ
PLγr − PWr = 0,
r

(5)

where PWr is the true-cost-of-living index (which is the marginal benefit of an additional unit
of welfare). The first term is the Cobb-Douglas unit-expenditure function. The parameter
γ indicates the value share of the non-tradable (labor) in welfare.
Associated with optimal activity levels of Ar , the activity which generates the composite
of the traded commodities, are similar conditions that equate marginal cost to marginal
benefit. Marginal benefit is simply represented by the price of the composite, PAr . The unit
cost of Ar is the dual representation of the technology in (2). The arguments in this cost
function include the domestic Dixit-Stiglitz composite price, given by Pr , and the gross-oftariff prices of the foreign Dixit-Stiglitz composites, (1 + tsr )Ps (where s ∈ R but s 6= r).
The condition is




 1−σdm

X

βrr P 1−σdm + β M 
βsr [(1 + tsr )Ps ]1−σn 
r
r


1−σn






1
1−σdm

− PAr = 0.

(6)

s6=r

Formulating monopolistically-competitive production of the Dixit-Stiglitz composite Qr
includes three separate conditions. First there is an industry-wide condition for the Qr
activity (where pr is the price charged by a representative firm);
h

f
Nr p1−σ
r

i

1
1−σf

9

− Pr = 0

(7)

Equation (7) is simply the dual of the Dixit-Stiglitz aggregation presented in (1). Second,
firm-level output, qr , is determined by the optimal pricing decision (where the demand
elasticity for a small firm is σf ). Marginal cost is simply the price of labor, PLr , and firms
maximize profits by pricing according to the familiar markup;

PLr − (1 − 1/σf )pr = 0

(8)

The third condition is associated with free entry. The number of firms, Nr , is determined by
the condition that entry will adjust such that profits are zero. Operating profits cover the
value of fixed costs (where we denote fr as the fixed cost in labor units);

PLr fr −

pr qr
= 0.
σf

(9)

Combining conditions (8) and (9) we can derive the familiar large-group-monopolistic-competition
result that firm-level output is invariant to industry scale. When σf is finite the number of
firms adjusts to ensure zero profits.10
With all of the technologies specified in conditions (5) through (9) we generate the market
equilibrium conditions for each price. Each market-clearance condition sets excess demand
for each commodity to zero. The market equilibrium condition for labor is given by the
exhaustion of the labor endowment, Lr , on direct demand for labor in utility and on demand
for labor in production. Let RAr indicate nominal income in region r then we have the
following market clearance condition:

Lr − γ

RAr
− Nr (fr + qr ) = 0.
PLr

10

(10)

As a matter of programming practicality, when σf = ∞ the index on the number of firms is fixed at one
(Nr = 1) and qr is allowed to vary. The level of fixed costs, fr , is calibrated based on σf and our assumption
of zero profits in the benchmark equilibrium. When σf = ∞ there is no markup, and fr = 0.

10

The price of firm output, pr , is determined by the firm-level market clearance condition;
Ã

qr − Qr

Pr
pr

! σf

= 0.

(11)

We must also have market clearance for the composite commodity, Qr ;
Qr − βrr Ar
−

P
s6=r

³

"

PAr
Pr

´σdm

βrs βsM As (PAs )σdm
([1+trs ]Pr )σn

hP
t6=s

1−σn

βts ([1 + tts ]Pt )

i σn −σdm
1−σn

#

(12)

= 0
Notice that the rather complex export-demand term (the last term) simplifies greatly when
the elasticity of substitution between national varieties equals the domestic-import elasticity
(i.e., σn = σdm ).
Associated with the price indexes on the Armington composites, PAr , are the market
equilibrium conditions
Ar − (1 − γ)

RAr
=0
PAr

(13)

The first term is total supply of the Armington composite and the second is Cobb-Douglas
demand. The final market clearance condition ensures that the nominal value of welfare
equals the nominal value of representative-agent expenditures, RAr ;

PWr Wr − RAr = 0

(14)

The variable associated with (14) is the true-cost-of-living index, PWr . Dividing (14) by
PWr yields the standard market balance condition in quantities. We complete the general

11

equilibrium by requiring balance between expenditures and incomes:
RAr = PLr Lr
+

P

"

s6=r

σ

βrM Ar PAr dm
tsr Ps βsr
([1+tsr ]Ps )σn

hP
t6=r

1−σn

βtr ([1 + ttr ]Pt )

i σn −σdm

#

1−σn

(15)

Income equals the value of the labor endowment, where Lr is the endowment quantity, plus
the value of tariff revenues.
Conditions (5) through (15) specify a complete multi-region general equilibrium that
incorporates the generalized demand system illustrated in Figure 1. Only relative prices are
determined, however, so we remove the market clearance condition for labor in the focus
region, H (Home), and declare the associated price as the numeraire (PLH = 1).

3.2

Experimental Parameters and Calibration

Our primary goal is to examine the effects of changing the relative elasticities, but we are
also concerned with examining the interaction of these effects with changes in the first-order
calibration. The first-order calibration is indicated by the CES distribution parameters (βrs )
and the endowment levels (Lr ).11 We introduce the parametric instrument θH to control
relative country sizes. The size of the focus country, indicated by the index H, is directly
controlled by θH as follows:
LH = θH LW ,

(16)

where LW = 100 is the (arbitrary) world endowment of labor. For simplicity we assume that
the remaining country’s endowment shares are symmetric (θr = θs , for all r and s 6= H),
11
The first-order calibration also depends on the value share of the nontraded sector, γ. We do not explore
the models sensitivity to this parameter in this paper. We simply make the assumption that γ = 0.2 in all
of the experiments that follow.

12

Table 2: Experimental Parameters for the Illustrative Model
Parameter Description
σf =
σn
σdm
θH
λ

1
1−αf

Range

Elasticity of substitution between firm-level varieties

1 < σf ≤ ∞

Elasticity of substitution between import varieties
Elasticity of substitution between domestic and import varieties
Benchmark share of the focus region, H, in world endowments
Home-bias parameter (proportional reduction in benchmark trade)

0 < σn < ∞
0 < σdm < ∞
0 < θH < 1
0<λ<1

such that the endowment of labor is given by
Lr6=H = LW

1 − θH
,
R−1

(17)

where R is the total number of regions.
We also introduce the parametric instrument λ to control the degree of home bias in
preferences. The index λ can vary from zero, indicating no bias toward home varieties, to
one. If λ = 1 then domestic agents only have a preference for home varieties and there
is no trade. This parameter is important because it captures a feature found in many
calibrated models. Normally, missing trade is accommodated (in calibrated models) by
introducing a home bias in the calibrated preferences. This stands in contrast to much of
the theoretic and empirical literature, which emphasizes unobserved trade or networking
costs as an important impediment to trade.12 Table 2 summarizes the parameters that are
utilized in our experiments.
Given the parameter values we calibrate the benchmark trade equilibrium by computing
the βrs that apply for a given experiment. We first determine units by normalizing on the
¯ r = 1, and PL
¯ r = 1) across all regions.
benchmark wage and Armington price indexes (PA
The bar notation indicates the level a variable takes on at the benchmark calibration. We
also normalize the benchmark level of firm output, q̄r = 1, so the number of firms and
12

Trefler (1995) highlights the observation of “missing trade” relative to what we might expect. Balistreri
and Hillberry (2004) point out, that most applied general equilibrium models adopt a first-order calibration
that implicitly skews preferences toward home varieties.

13

composite output are given by:
1−γ
Lr ; and
αf

N̄r =

Ã

Q̄r =

1−γ
Lr
αf

!

1
αf

(18)

.

(19)

Benchmark firm-level pricing is p̄r = 1/αf , and the price of the composite is given directly
from equation (7) above:
h

f
P̄r = N̄r p̄1−σ
r

i

1
1−σf

.

(20)

We finalize the calibration by calculating the CES weights considering the trade reduction
index (λ). For trade from r to s we have region r’s production share (which is the same as
the endowment share) scaled by the trade reduction index and the reference prices;

βrs =

Lr (1 − λ)
,
LW P¯r 1−σn

(21)

where r 6= s. The domestic weight is calculated to include the sum of reduced export weights;
Ã

βrr =

Lr +

P
s6=r
W
L

λLs

!

1

P¯r

1−σdm .

(22)

Finally the aggregate import weight is calculated as
βrM = ³
P

1 − βrr P̄r1−σdm
1−σn
s6=r βsr P̄s

´ 1−σdm ,

(23)

1−σn

¯ r = 1 is maintained in the case that σn 6= σdm . The actual computer code used
such that PA
to calibrate and solve the system is included as an appendix to this paper.

14

4

Results from the Illustrative Model

The first experiments that we examine explore the impact of firm-level differentiation on the
optimal tariff. Figure 2 shows the welfare curves as we vary the tariff imposed by region H
from -15% to 40% under two scenarios. First we adopt a set of relative elasticities not unlike
those typically adopted in standard Armington applied general equilibrium models. That is,
σf = +∞ and σn = σdm = 7. In the second case we include firm-level differentiation, which
is equal to the level of national differentiation (i.e., σf = σn = σdm = 7). In both scenarios
we set the first-order calibration at the central case, characterized by a relatively small focus
region size (θH = 0.001); no home bias in preferences (λ = 0); and a labor value share in
welfare of 20% (γ = 0.2).13
The curve under an assumption that σf = +∞ confirms the finding of Brown (1987)
that small-country tariffs are large under the typical Armington formulation. The optimal
tariff for this relatively small country is 17%. Because the country is a monopoly supplier of
its export variety the optimal tariff reflects the optimal markup over marginal cost, approximately 1/(σn − 1). In contrast when we make an assumption consistent with sub-national
differentiation, allocating the market power over exports to firms, the optimal tariff drops
dramatically to less than 1/2% (a finer search reveals the optimal tariff to be about 0.4%).
One significant contribution of our generalized demand system is that all of the intermediate cases are also available. Table 3 presents the computed optimal tariffs under different
assumptions about the level of firm differentiation and country size. As one might expect
the optimal tariff increases with both the level of substitution between firm varieties and
the relative country size. For small countries the optimal tariff is critically dependent on
the degree of firm differentiation assumed. For a country that has a relative size of 0.1%
13

We choose such a small focus region, because we know that in a perfectly competitive model with
homogeneous goods, the optimal tariff would be zero. Thus the tariff we calculate for the Armington
formulation with no sub-national differentiation (σf = +∞) is due entirely to national product differentiation
and not to country size in Figure 2

15

Figure 2: Welfare and tariffs with and without firm differentiation (σn = σdm = 7, θH = 0.1%,
λ = 0, and γ = 0.2)

Table 3: Computed optimal tariffs in percent (σn = σdm = 7, λ = 0, and γ = 0.2)
θH (relative country size)
σf
0.1% 1.6% 3.1% 6.3% 12.5% 25% 50%
3.5
-16
-11
-4
6
13
17
23
7
0
7
10
14
16
19
24
14
9
13
14
16
18
20
25
30
13
15
16
17
18
20
25
100
16
16
17
17
18
20
25
+∞
17
17
17
18
19
21
25

16

of the world economy the optimal tariff ranges from a -16% to a +17% depending on σf .
The negative optimal tariffs found for small countries with more firm differentiation than
national differentiation (σf < σn ) are consistent with Markusen (1990).
We can think of firms as setting export taxes with their markups. In the cell (7, 0.1%),
the optimal tariff is zero because the small firm’s markup is aligned with a social planner’s
optimal export tax (given that σf = σdm ).14 The firm’s market power is based on the
differentiation indicated by σf , and the (small-country’s) social planner’s market power is
based on the differentiation indicated by σdm . When the elasticities are aligned the social
planner is preempted by optimal firm pricing. In the cell (3.5, 0.1%), the export tax set
by each small firm is too high given that σdm = 7.0, and thus a negative optimal tariff is
required as an offsetting distortion. This is the intuition about the result that moving down
any column leads to an increase in the optimal tariff.
The intuition about moving across a row (in Table 3) follows from a more traditional
large-country argument for optimal tariffs. Large countries have market power based on the
collective size of their exporting industry on world markets. In the cell (7, 50%) home firms
are optimally exploiting differentiation, but are not accounting for the fact that collectively
they are one half of the world market.15 Essentially, within the industry there is an externality associated with marginal increases in firm pricing, the benefits of which accrue to all
competing firms. If some of these firms are in the home country then, from a home-country
social planner’s perspective, firm-level mark ups are too low. This effect intensifies as we
move across any given row of Table 3. As we move across the row more of the externality
accrues to home firms, and higher optimal tariffs are indicated.
Figure 3 and Table 4 show the same pattern of results when we double the elasticity of
14

In the general equilibrium export taxes are equivalent to import tariffs. This is commonly known as
Lerner Symmetry [Lerner (1936)].
15
This follows directly from our assumption that firms are small. The firm-level demand function [embedded in equation (11)] is based on each firm holding an approximately zero market share.

17

Figure 3: Welfare and tariffs with and without firm differentiation (σn = σdm = 14, θH = 0.1%,
λ = 0, and γ = 0.2)

substitution between national varieties. As mentioned in our introduction one might mitigate
large optimal tariffs in the Armington framework by increasing the Armington elasticity, σn .
We show this implication, as the optimal tariff for the small country drops from 17% to
8% when the national-level elasticity is set to 14 rather than 7. The key contribution that
our generalized demand system offers, however, is a decoupling of the optimal tariff from
the specific Armington elasticity. For small countries, allocating market power over distinct
varieties to firms rather than countries centers the welfare curves in Figures 2 and 3 over an
approximately zero tariff, regardless of the Armington elasticity. Armington elasticities are
thus free to be set in a way that best reflects trade responses, and not as a control on the
optimal tariff.
Another interesting result that emerges from our stylized theoretic model is that the
optimal tariff increases as the degree of home bias increases. In Table 5 we hold the size of
18

Table 4: Computed optimal tariffs in percent (σn = σdm = 14, λ = 0, and γ = 0.2)
θH (relative country size)
σf
0.1% 1.6% 3.1% 6.3% 12.5% 25% 50%
3.5
-23
-20
-17
-8
10
7
12
7
-7
-3
0
3
6
9
13
14
0
3
5
6
8
10
14
30
4
6
7
8
9
10
14
100
7
7
8
8
9
11
14
+∞
8
8
8
8
9
11
14

Table 5: Computed optimal tariffs in percent (σn = σdm = 7, θH = 0.1%, and γ = 0.2)
λ (trade reduction index)
Higher values indicate
more home bias

σf
3.5
7
14
30
100
+∞

0.0 0.1 0.2 0.3 0.4 0.5
-16
9 12 13 14 14
0 14 15 15 16 16
9 15 16 16 16 16
13 16 16 16 16 16
16 17 17 17 17 17
17 17 17 17 17 17

the country to be relatively small, at 0.1% of world income, but increase the value of λ from
zero to 0.5. The results in Table 5 show a dramatic increase in the optimal tariff as home
bias increases, even for a relatively small country and regardless of the degree of sub-national
differentiation assumed.
To explain the results in Table 5, consider beginning at a symmetric free-trade equilibrium
where domestic and imported varieties are priced the same. Suppose that an import tariff
leaves the total number of varieties unchanged, but leads to a substitution of domestic for
foreign varieties: dNH = −

P
r6=H

dNr > 0. If there is home bias, this change benefits the

domestic economy more than without, since the shifts are weighted by their utility value
and both varieties (locally) cost the same. Conversely, the rest of the world is hurt more by
this change than without home bias, because their loss of home varieties is valued more than
19

the increase in imported varieties. This generalizes to a case where dNH +

P
r6=H

dNr < 0

in the relative sense that the welfare increase is greater, or the loss less, when there is home
bias than when there is not. This process is of course bounded: as the tariff increases, each
foreign variety is valued domestically (the domestic demand prices) by more than the cost
of buying it (the pre-tax import prices) and so at some point the loss of a foreign variety is
more welfare-costly than the gain of a domestic variety.
The pattern of results presented in Table 5 is important to the contemporary debate
over unobserved trade costs. Hillberry et al. (2005) indicate that we might not need to
worry about whether a calibrated model accommodates missing trade through taste bias or
through unobserved trade frictions—as long as policy is independent of the unobserved trade
frictions.16 Our analysis suggests that this may hold in the case of perfect competition (the
optimal tariff varies little in the final row of Table 5), but when sub-national differentiation
is considered the degree that the model attributes missing trade to a taste bias affects the
optimal tariff.
In turn, this is an important consideration in applied welfare analysis. For example,
the second row of Table 5 shows an optimal tariff of zero if we assume no taste bias but
an optimal tariff of 14% for a modest amount of taste bias. When alternative methods of
calibration (taste bias versus unobserved trade frictions) influence the implied optimal tariff,
welfare analysis of policy will be affected.

5

Application of the generalized model

To give the generalized model an applied context it is useful to compare it to models that
appear in the literature. To explore the performance of the generalized model we calibrate
16

In fact, Hillberry et al. (2005) argue that the strong correlation between observed trade and trade frictions
and the taste-bias parameters is evidence that policy is not independent of unobserved trade frictions and,
therefore, we should be worried about calibrated taste bias.

20

a version of it to the Global Trade Analysis Project (GTAP) social accounts [Dimaranan
and McDougall (2005)] and conduct a number simulation experiments. The model is coded
in GAMS/MPSGE and is available upon request. Although somewhat muddled by the
complications of real trade patterns, the experiments tend to support our general findings
(from the relatively transparent model presented above). The incentive for small countries
that trade intensively (those with relatively less home bias in preferences) to unilaterally
impose high rates of protection are reduced when firm-level differentiation is considered.
The overall scope of the applied model includes the world general equilibrium in multiple
commodities and regions. Geographically we include four focus countries and the remainder
of the world is aggregated into four regions:
• Australia

• Rest of America

• Canada

• East Asia

• United States

• Europe

• Chile

• Rest of World

The commodities in the model include the following nine aggregates:
• Agriculture

• Metals and metal products

• Coal oil gas and other minerals

• Other manufactures

• Other processed food and tobacco products
• Services

• Textiles apparel and leather products
• Wood products

• Savings good

The model uses this level of aggregation to give an indication of how an applied model might
react, but also maintains a high degree of tractability. Given the methodological nature of
our exercise we simply accept the GTAP data as an accurate representation of the world
social accounts. Furthermore, we make no attempt at estimating actual trade elasticities.
We simply make the following assumptions across each commodity. We set the elasticity of
substitution between import varieties at seven (σn = 7). Consistent with many applications
21

we set the domestic-import elasticity at one half the import-variety elasticity (σdm = 3.5).
The key experimental control is to vary the firm-level elasticity between seven and infinity
(σf = 7 or σf = ∞).
We start the analysis by examining the unilateral incentives for countries to impose tariffs
under the alternative assumptions about firm-level differentiation. To setup the experiment
we utilize an updated baseline of global free trade. Once the model is calibrated we remove
all trade distortions to generate the benchmark equilibrium. This is important for looking
at unilateral incentives to protect, because the observed rates of protection include product
mix as well as country mix distortions.
With the free-trade benchmark established, we then identify the optimal rate of protection
for a given domestic country under a uniform tariff on all imports of all commodities from
all foreign countries. This will be a relatively efficient tax mechanism because it tends not to
distort across commodities or source countries. Given this setup one should not be surprised
to see relatively large optimal rates of protection. We warn the reader that these hypothetical
experiments are designed to illustrate our argument, and should not be interpreted as policy
prescriptions.
Actual tariffs on specific products (and possibly on specific products from specific countries) are inefficient relative to our experiment because they have an impact on relative prices
in addition to increasing the average price. The relative price changes cause demand substitutions that are highly distortionary. In contrast, the uniform tariff that we analyze has
relatively minor impacts on relative prices across commodities or on relative prices across
different source regions. The uniform tariff is, therefore, relatively efficient (compared to the
more common targeted protection observed in the data).
Figure 4 illustrates how Canada’s welfare changes with the tariff rate under the alternative
assumptions about firm-level differentiation. Relative to the global-free-trade benchmark a
typical Armington model indicates that Canada’s optimal uniform tariff would be 18% on all
22

Figure 4: Canadian welfare under a uniform tariff relative to global free trade

imports. In contrast, if we assume that firm varieties are also differentiated the optimal tariff
is cut in half. Unlike the theoretic model presented above, however, we do not see a (nearly)
complete elimination of the optimal tariff. We suggest that this is due to the presence of
a home bias in the calibrated model. Considering Table 5 we can see that inserting even
a modest amount of home bias in preferences escalates the optimal tariff (even when we
assume a high degree of firm differentiation). So, although muted, we find general support
for our hypothesis that firm differentiation is important when we examine Canada’s unilateral
incentives.
We find less evidence of a zero optimal tariff for Chile. Figure 5 plots the welfare curves
for Chile. Under no firm differentiation the optimal tariff for Chile is 16%, and this falls to
11% under firm differentiation that is equal to the level of national differentiation. Again,
this points to the larger issue of home bias. If there are large networking costs, or other

23

Figure 5: Chilean welfare under a uniform tariff relative to global free trade

unobserved costs which restrict trade, and simulation models accommodate the observed
trade flows by asserting a preference for the home variety, then the simulation models are
likely to exhibit sizable optimal tariffs even for small countries, and even when we consider
firm differentiation.
Given the results presented in Section 4 and knowledge of how simulation models accommodate the trade pattern, it is not surprising that the reduction of the optimal tariff is
larger for Canada than it is for Chile. Canada is relatively trade intensive and less remote
than Chile. Lessons from the gravity literature (in international trade) suggest that more
unobserved trade costs will be associated with more remote regions. The calibrated model
will systematically impose more home bias on average to those countries that are more remote. The results for Australia are similar to those for Chile, which generally support the
argument that home bias is important.

24

Figure 6: U.S. welfare under a uniform tariff relative to global free trade

It is also useful to examine the results for the U.S. The relative size of the U.S. economy
and the U.S. presence in world markets indicate that the optimal uniform tariff must be
relatively high. Figure 6 plots the welfare curves for the U.S. For the U.S. the optimal
rate of protection is relatively insensitive to our assumption about firm differentiation. This
is consistent with the analysis in Section 4 (Table 3), where we showed that traditional
large country effects dominate the firm differentiation effect at relatively modest shares of
world income. The optimal tariff for the U.S. falls from 20% under the standard Armington
formulation to 18% when we consider firm differentiation. This is roughly in the range of
the results presented in Table 3 for an economy the size of the U.S.
To summarize our unilateral policy experiments, we find consistently smaller optimal
tariffs when firm differentiation is included. This supports our overall hypothesis that firm
differentiation is important. We also find, however, that in the applied model the reduction in

25

optimal tariffs is not as dramatic as in our purely theoretic experiments. We suggest that this
is due to the tendency for simulation models to accommodate a lack of trade to home bias.
We find evidence that remoteness, which is correlated with home bias in calibrated models
[Hillberry et al. (2005)], tends to reduce the impact of adding firm-level differentiation.
One additional point deserves mentioning in the context of our unilateral experiments.
Notice that for each focus country that imposes a positive tariff over the relevant range,
the welfare curve under no differentiation lies everywhere above the welfare curve assuming
firm-level differentiation. This indicates that there is more to lose by reducing tariffs (below
the optimal) when we ignore firm-level differentiation. Again this strongly supports our
argument that traditional methods might understate the value of liberalization, if in fact
firm varieties are important.
In addition to looking at hypothetical unilateral experiments we utilize the calibrated
applied model to examine the removal of tariffs between the US and Australia. This allows
us to examine the model’s performance relative to applied applications that appear in the
literature. We compare our results to a number of studies that have examined the likely
impacts of the US-Australia Free Trade Agreement. Table 6 presents the results from four
different parameterizations of our calibrated model, and selected results from three studies
that appear in the literature.
The first scenario, ARM 7, is intended to give a close comparison of the pilot model
to the United States International Trade Commission (2004) analysis of the US-Australia
Free Trade Agreement. Aggregate results from the USITC study are reported under the
column heading USITC 9090 in Table 6. In the scenario ARM 7 the pilot model adopts
a national-level elasticity of substitution of 7 across all sectors and an infinite sub-national
elasticity (equivalent to sub-national perfect competition). This is roughly consistent with
the Armington formulation of the USITC’s 9090 model.17 Thus, the model gives roughly
17

There are a number of differences between the pilot calibration and simulations that we perform here

26

Table 6: Simulating the US-Australia Free Trade Agreement
Calibrated Pilot Model
ARM 7
MC 7 ARM 30 MC 30 Literature Estimates

Change in US
Welfare ($M)
Change in US
Total Imports
($M)
Change in US
Exports to
Australia ($M)
Change in US
Imports from
Australia ($M)

σf = +∞
σn = 7
σdm = 3.5

σf = 7
σn = 7
σdm = 3.5

σf = +∞
σn = 30
σdm = 15

σf = 30
σn = 30
σdm = 15

USITC
9090

CIE

BKS

885

629

972

1,549

491

1,231

19,400

1,852

1,777

21,482

24,630

1,161

NA

NA

2,959

3,005

29,790

31,724

2,539

NA

NA

2,769

2,954

32,017

44,356

1,759

NA

NA

consistent results. The change in US welfare and change in US imports from Australia are
lower in the 9090 study but this might be attributed to exceptions in the actual agreement
that are considered in the USITC analysis, but not in our scenario. We simply remove all
tariffs as measured in the GTAP data.
In the next scenario, MC 7, the model is parameterized with a national and subnational
(firm-level) elasticity of substitution of 7. Adding sub-national monopolistic competition
slightly reduces the US benefits from the FTA and slightly changes the aggregate trade
flows. The loss in US welfare might be attributed to a reduction in foreign varieties that is
and the model implemented by the United States International Trade Commission (2004). Most notably,
our model simply adopts a single national-level elasticity across sectors. A national level elasticity of 7 is
roughly consistent with the average of the commodity specific elasticities used by the USITC. Furthermore,
our model takes the GTAP data and benchmark distortions at face value, where as the USITC 9090 model
adds significant corrections and modifications. The data aggregations and scenario shocks also differ between
the pilot and USITC models. To facilitate rapid diagnostics our model is more aggregated. The scenario
examined in the pilot model is a complete liberalization of tariffs between the US and Australia. The USITC
scenario includes detailed exceptions that were a part of the actual agreement. The simplifications made to
the pilot model were made to facilitate a timely comparison and we would advise a more careful consideration
of the real world in any actual simulation. That said, we feel that the results from our model are sufficiently
close to the USITC’s results to make a legitimate and useful comparison.

27

not offset by increases in US or Australian varieties (in contrast Australian welfare impacts
increase in the MC 7 case relative to the ARM 7 case).
The next two scenarios, ARM 30 and MC 30, indicate how the pilot model responds when
the national elasticity of substitution is 30 and the sub-national elasticities are respectively
infinite and 30. These scenarios illustrate the problematic nature of mitigating high optimal
tariffs through elasticity increases. These scenarios have similar relative results, but larger
welfare benefits and extremely large trade responses. Depending on whether we look at
imports or exports, the ARM 7 and MC 7 scenarios generate bilateral trade responses in
the range of 19% to 26%. In contrast, moving these elasticities up to 30 generates trade
responses in the range of 188% to 390% of base flows—an order of magnitude higher.
In Table 6, we also include the aggregate welfare results used by the United States International Trade Commission (2004) to compare their model with other estimates. The column
titled CIE includes the welfare calculation made by the USITC based on the Berkelmans et
al. (2001) study for the Center for International Economics, and the column titled BKS is
the welfare estimate made by Brown et al. (2004). It is notable that although our model
adopts a monopolistic competition structure it does not come close to replicating the welfare
impacts reported by Brown et al. (2004). As noted in the USITC study, the Brown et al.
(2004) welfare results are substantial at 85% of their reported base trade volumes with the
US.18 One reason that the results of Brown et al. (2004) are larger is because they assume
substantial benchmark distortions in service sectors, which vanish as a result of the FTA.
We view our demonstration of the U.S.-Australia liberalization using our generalized
model as encouraging and useful. Our model generates results in the range of most standard
models, but accommodates monopolistic competition elements that may be important to the
measurement of potential gains from liberalization. The model offers a way of accommodat18

Trade volume is measured as the sum of US imports from Australia plus the sum of US exports to
Australia.

28

ing the gains associated with scale and variety effects without exaggerating trade responses.
The model is demonstrated to be tractable in a real policy context and allows the user the
flexibility to choose any level of national and sub-national differentiation.

6

Conclusion

Reconciling observed intra-industry trade with policy simulation models often involves adopting an assumption of product differentiation. Most applications assume national-level differentiation with perfect sub-national competition, or alternatively, firm-level monopolistic
competition and no distinction between national varieties. It is well known that these different structures produce different implied optimal tariffs. This, along with industry scale
effects, means that the different structures generate different simulated impacts from liberalization. Accurate policy simulation seems to dictate a careful examination of the actual
industrial organization. Ideally, with unlimited resources and time, one might develop the
right structure for each industry and product.
Unfortunately, policy relevance also dictates a timely response with relatively transparent
economy-wide results. Parsimony in modeling is the rule. Following the critique of Brown
(1987), we caution that assuming differentiated national products, although convenient, can
lead to significant implications for the welfare analysis of commercial policy. In particular,
we highlight the implicit allocation of market power over distinct varieties to policy makers
and away from firms. This is troubling in that, traditionally, economists assume that the
agents involved in the actual transactions (exporting firms in this case) extract the rents.
To show the importance of the implicit allocation of market power we develop a generalized model that parametrically accommodates both national and firm-level differentiation.
Firm-level differentiation is accommodated via a standard model of monopolistic competition. The model is parsimonious but controls the degree of market power allocated to

29

countries, versus firms, on a continuum. Our theoretic exploration of this new model is limited, but we have developed some interesting results, which are important for contemporary
research.
Most importantly we show that the optimal tariff falls when we make parametric assumptions that allocate market power to firms rather than countries. This is important because it indicates that many contemporary studies that adopt national differentiation, with
sub-national perfect competition, might understate the true benefits of liberalization. Furthermore, we show that accommodating the trade pattern by calibrating the CES preference
parameters can exacerbate the problem even when sub-national differentiation is considered. Home bias in preferences implicitly favors home varieties and, again, moves us towards
relatively higher optimal tariffs. As an alternative to preference biases, the theoretic and
econometric literatures emphasize unobserved trade costs in their explanation of the trade
pattern. Policy simulation models may, again, understate the true benefits of liberalization,
because they calibrate in a way that implicitly indicates high optimal tariffs.
In an empirical context we highlight that the optimal tariff is most sensitive to our
assumptions about firm-level differentiation for small countries and when there is relatively
little home bias in the pattern of trade. We also demonstrate the generalized demand system
in a pilot applied general equilibrium simulation of the US-Australia Free Trade Agreement.
Moving the research forward, the theoretic implications of our generalized demand system
deserve a closer examination. Through this examination we hope to highlight the important
role of the firm in optimally pricing varieties on international markets.

References
Armington, P.S. (1969) ‘A theory of demand for products distinguished by place of production.’ IMF Staff Papers 16(1), 159–176
Balistreri, E.J., and R.H. Hillberry (2004) ‘Estibration: an illustration of structural esti-

30

mation as calibration.’ mimeo, Colorado School of Mines, Division of Economics and
Business
Berkelmans, L., L. Davis, W. McKibbin, and A. Stoeckel (2001) ‘Economic impacts of an
Australia-United States free trade area.’ Center for International Economics, Canberra
and Sydney
Brown, D.K. (1987) ‘Tariffs, the terms of trade, and national product differentiation.’ Journal
of Policy Modeling 9(3), 503–526
Brown, D.K., A.V. Deardorff, and R.M. Stern (1992) ‘A North American free trade agreement: Analytical issues and a computational assessment.’ The World Economy 15, 11–29
Brown, D.K., K. Kiyota, and R. Stern (2004) ‘Computational analysis of the U.S. bilateral
free trade agreements with Central America, Australia, and Morocco’
Dimaranan, B.V., and R.A. McDougall (2005) Global Trade, Assistance, and Production:
The GTAP 6 Data Base Center for Global Trade Analysis (Purdue University)
Flam, H., and E. Helpman (1987) ‘Industrial policy under monopolistic competition.’ Journal
of International Economics 22, 79–102
Helpman, E., and P. Krugman (1989) Trade Policy and Market Structure (Cambridge: MIT
Press)
Hillberry, R.H., M.A. Anderson, E.J. Balistreri, and A.K. Fox (2005) ‘Taste parameters as
model residuals: Assessing the ’fit’ of an Armington trade model.’ Review of International
Economics
Huff, K.M., K. Hanslow, T.W. Hertel, and M.E. Tsigas (1997) ‘GTAP behavioral parameters.’ In Global Trade Analysis: Modeling and Applications, ed. T.W. Hertel (Cambridge:
Cambridge University Press) pp. 124–148
Lerner, Abba P. (1936) ‘The symmetry between import and export taxes.’ Economica 3, 306–
313
Liu, J., C. Arndt, and T.W. Hertel (2002) ‘Parameter estimation and measures of fit in a
global, general equilibrium model.’ Journal of Economic Integration 19(3), 626–649
Markusen, J.R. (1990) ‘Derationalizing tariffs with specialized intermediate inputs and differentiated final goods.’ Journal of International Economics pp. 375–383
(2002) Multinational Firms and the Theory of International Trade (Cambridge: MIT
Press)
McDaniel, C.A., and E.J. Balistreri (2003) ‘A review of Armington trade substitution elasticities.’ Integration and Trade 7(18), 161–173
31

Rutherford, Thomas F. (1999) ‘Applied general equilibrium modeling with MPSGE as a
GAMS subsystem: An overview of the modeling framework and syntax.’ Computational
Economics 14, 1–46
Trefler, D. (1995) ‘The case of the missing trade and other mysteries.’ American Economic
Review 85(5), 1029–1046
United States International Trade Commission (2004) ‘U.S.-Australia free trade agreement: Potential economywide and selected sectoral effects.’ Investigation No. TA-2104-11,
USITC Publication 3697

A
1

Appendix: Illustrative Model Code (GAMS software)

$title multi-region trade maquette with monopolistic competition

2

*
*
5 *

Edward J. Balistreri, Colorado School of Mines
James R. Markusen, University of Colorado--Boulder
April, 2007

3
4

6

$eolcom
*
9 $if not
10 $if not
11 $if not
12 $if not
13 $if not
14 $if not
15 $if not
7
8

!
Read in the command line inputs:
setglobal theta $setglobal theta 0.001
setglobal sig_n $setglobal sig_n 7
setglobal sig_dm $setglobal sig_dm 7
setglobal sig_f $setglobal sig_f 14
setglobal lam
$setglobal lam 0
setglobal gam
$setglobal gam 0.2
setglobal hg
$setglobal hg no

16
17
18
19
20
21

set r

regions
/
h ! home (focus) region
f1 ! foreign region 1
f2 ! foreign region 2
/;

22
23

alias (r,s,t,u)

24

parameters
theta
27
sig_n
28
sig_dm
29
sig_f
30
lam
31
gam
32
hg
33
e(r)
25
26

share of world endowment allocated to h,
elasticity of substitution between national varieties,
elasticity of substitution between domestic and imports,
elasticity of substitution between firm-level varieties
home bias parameter (proportional decrease in trade volume)
share of economy that is not x sector
switch for trade in homogeneous good
value of benchmark traded goods by region

32

34
35
36

h(r)
value of benchmark leisure by region
beta(s,r) benchmark CES distribution
vshr(r)
value share;

37

*
theta
40 sig_n
41 sig_dm
42 sig_f
43 lam
44 gam
45 hg
38
39

Assign values for the sensitivity parameters.
=
%theta%;
=
%sig_n%;
=
%sig_dm%;
=
%sig_f%;
=
%lam%;
=
%gam%;
=
%hg%;

46

*
Calculate e(r) based on the leisure to income
*
share and symmetric foreign countries. Nominal
49 *
world income is normalized to 100 at the benchmark.
50 e("h")
=100*(1-gam)*theta;
51 e(r)$(ord(r) gt 1)=100*(1-gam)*(1-theta)/(card(r)-1);
52 h(r)
=e(r)*(gam/(1-gam));
47
48

53

*
Declare the policy instrument
parameter
56
tar
home country tariff rate /0.0/;
54
55

57

*
Reference values
parameter
60
pf0
benchmark firm price
61
px0
benchmark price of the composite
62
x0
benchmark composite quantity
63
f0(r)
calibrated fixed cost
64
pa0
benchmark price of the composite
65
a0(r)
benchmark armington activity level
66
pw0(r)
benchmark cost of living index
67
w0(r)
benchmark utility
68
betaM(r) import weight in armington technology;
58
59

69

pf0(r) = sig_f/(sig_f-1);
f0(r)
= pf0(r)/sig_f;
72 px0(r)
=1;
73 px0(r)$(1/sig_f)
74
=(e(r)*(sig_f-1)/sig_f*(pf0(r))**(1-sig_f)
75
)**(1/(1-sig_f));
76 x0(r)
= e(r);
77 x0(r)$(1/sig_f)
78
=(e(r)*(sig_f-1)/sig_f)**(sig_f/(sig_f-1));
70
71

79

*
Calculate the CES distribution parameters (pa=1):
vshr(r)=e(r)/sum(t,e(t));
82 beta(r,s) = (1-lam)*vshr(r)/((px0(r))**(1-sig_n));
83 beta(r,r) = (vshr(r)+sum(s$(not sameas(s,r)),lam*vshr(s)))
84
/((px0(r))**(1-sig_dm));
80
81

33

85
86

betaM(r)=(1-beta(r,r)*px0(r)**(1-sig_dm))/
sum(s$(not sameas(s,r)),beta(s,r)*px0(s)**(1-sig_n))**((1-sig_dm)/(1-sig_n));

87

pa0(r) =(beta(r,r)*px0(r)**(1-sig_dm)+
betaM(r)*
90
(sum(s$(not sameas(s,r)),beta(s,r)*
91
(px0(s)*(1+tar$(ord(r) eq 1)))**(1-sig_n)
92
)**((1-sig_dm)/(1-sig_n)))
93
)**(1/(1-sig_dm));
88
89

94

a0(r) = e(r)/pa0(r);
pw0(r) = pa0(r)**(1-gam);
97 w0(r)
= (e(r)*(1/(1-gam)))/pw0(r);
95
96

98

positive variables
x(r)
quant index on dix-stig composite
101
xf(r)
quantity index on aggregate output from firms
102
n(r)
number of firms index
103
a(r)
armington activity
104
w(r)
welfare
99

100

105
106
107
108
109
110
111

px(r)
pf(r)
pa(r)
pw(r)
pl(r)
py

price index on dixit-stiglitz composite from r
price of a representative firm variety from r
price index on armington composite
true-cost-of-living index
price index on labor
price index on homogeneous factor

ra(r)

nominal income;

112
113
114

equations
prf_x(r)
117
prf_xf(r)
118
prf_n(r)
119
prf_a(r)
120
prf_w(r)
115
116

optimal dixit-stiglitz activity level
profit maximization (mc=mr)
free entry condition (tr=tc)
optimal armington activity level
optimal consumption

121
122
123
124
125
126
127

mkt_px(r)
mkt_pf(r)
mkt_pa(r)
mkt_pw(r)
mkt_pl(r)
mkt_py

mkt
mkt
mkt
mkt
mkt
mkt

clearance
clearance
clearance
clearance
clearance
clearance

for
for
for
for
for
for

bc_ra(r)

budget constraint;

dixit-stiglitz composite
firm output
armington aggregate
utils
labor
homogeneous factor

128
129
130

prf_x(r)..
((n(r)*pf(r)**(1-sig_f))**(1/(1-sig_f)))$(1/sig_f)
133
+ pf(r)$(not 1/sig_f)- px(r) =g= 0;
131
132

134
135

prf_xf(r)..

34

136

pl(r)$(not hg)+py$hg - pf(r)*(1-1/sig_f) =g= 0;

137

prf_n(r)..
(pl(r)$(not hg)+py$hg)*f0(r) - pf(r)*xf(r)/sig_f
140
+
141
(n(r)-x(r))$(not 1/sig_f)
142
=e= 0;
138
139

143

prf_a(r)..
(beta(r,r)*px(r)**(1-sig_dm)+
146
betaM(r)*
147
(sum(s$(not sameas(s,r)),beta(s,r)*
148
(px(s)*(1+tar$(ord(r) eq 1)))**(1-sig_n)
149
)**((1-sig_dm)/(1-sig_n)))
150
)**(1/(1-sig_dm))
151
-pa(r) =g= 0;
144
145

152

prf_w(r)..
pa(r)**(1-gam)*((pl(r)**gam)$(not hg)+(py**gam)$hg)
155
- pw(r) =g= 0;
153
154

156

mkt_px(r)..
x(r) -A(r)*beta(r,r)*(PA(r)/PX(r))**sig_dm
159
-sum(s$(not sameas(s,r)),
160
A(s)*
161
PA(s)**sig_dm *
162
betaM(s)*(sum(t$(not sameas(t,s)),
163
beta(t,s)*((1+tar$(ord(s) eq 1))*PX(t))**(1-sig_n))
164
**((sig_n-sig_dm)/(1-sig_n)))*
165
beta(r,s)*((1+tar$(ord(s) eq 1))*PX(r))**(-sig_n)
166
) =g= 0;
157
158

167
168
169

mkt_pa(r)..
a(r) - (1-gam)*ra(r)/pa(r) =g= 0;

170

mkt_pf(r)..
XF(r)-(X(r)*(PX(r)/PF(r))**sig_f)$(1/sig_f)
173
-(X(r)/N(r))$(not 1/sig_f) =g= 0;
171
172

174

mkt_pl(r)..
(e(r)*(1/(1-gam))
177
-gam*RA(r)/pl(r)-n(r)*(f0(r) + xf(r)))$(not hg)
178
+(-pl(r))$hg
=g= 0;
175
176

179

mkt_py..
sum(r,e(r)*(1/(1-gam))
182
-gam*RA(r)/py-n(r)*xf(r))$(hg)
183
+(-py)$(not hg)=g= 0;
180
181

184
185
186

mkt_pw(r)..
pw(r)*w(r)*w0(r) - ra(r) =g= 0;

35

187

bc_ra(r)..
ra(r)=e=
190
pl(r)*(e(r)+h(r))$(not hg)+py*(e(r)+h(r))$hg+
191
tar*sum(s$(not sameas (s,r)),
192
px(s)*
193
A(r)*
194
PA(r)**sig_dm *
195
betaM(r)*(sum(t$(not sameas(t,r)),
196
beta(t,r)*((1+tar)*PX(t))**(1-sig_n))
197
**((sig_n-sig_dm)/(1-sig_n)))*
198
beta(s,r)*((1+tar)*PX(s))**(-sig_n)
199
)$(ord(r) eq 1);
188
189

200

model mrtmc_mcp /
prf_x.x, prf_a.a, prf_w.w,prf_xf.xf,prf_n.n,
203
mkt_px.px, mkt_pa.pa, mkt_pf.pf, mkt_pl.pl,mkt_py.py,mkt_pw.pw,
204
bc_ra.ra
205
/;
201
202

206

*Set the benchmark levels:
x.l(r)=x0(r);xf.l(r)=1;n.l(r)$(not 1/sig_f)=e(r);
209 n.l(r)$(1/sig_f)=e(r)*(sig_f-1)/sig_f;a.l(r)=a0(r);w.l(r)=1;
207
208

210
211

pf.l(r)=pf0(r);px.l(r)=px0(r);pa.l(r)=pa0(r);pw.l(r)=pw0(r);

212
213
214

*
Set the numeraire depending on homogeneous traded good
pl.fx("h")$(not hg)=1;py.fx$hg=1;

215
216
217

*
Set the level values to zero for unused variables
py.l$(not hg)=0;pl.l(r)=1$(not hg);

218
219

ra.l(r)

=(e(r)*(1/(1-gam)));

220

*
Check the benchmark replication at (iterlim=0)
mrtmc_mcp.iterlim=0;
223 solve mrtmc_mcp using mcp;
221
222

224
225

abort$(mrtmc_mcp.objval > 1e-5) "mcp benchmark is not balanced";

36

