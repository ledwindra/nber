                                NBER WORKING PAPER SERIES




   IDENTIFICATION AND ESTIMATION OF 'IRREGULAR' CORRELATED RANDOM
                          COEFFICIENT MODELS

                                          Bryan S. Graham
                                           James Powell

                                        Working Paper 14469
                                http://www.nber.org/papers/w14469


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                    November 2008




We would like to thank seminar participants at UC - Berkeley, UCLA, USC, Harvard, Yale, NYU,
Princeton, Rutgers, Syracuse, Penn State, members of the Berkeley Econometrics Reading Group
and participants in the Conference in Economics and Statistics in honor of Theodore W. Andersonâ€™s
90th Birthday (Stanford University), the Copenhagen Microeconometrics Summer Workshop and
the JAE Conference on Distributional Dynamics (CEMFI, Madrid) for comments and feedback. Discussions
with Manuel Arellano, StÃ©phane Bonhomme, Gary Chamberlain, IvÃ¡n FernÃ¡ndez-Val, Jinyong Hahn,
Jerry Hausman, Bo HonorÃ©, Michael Jansson, Roger Klein, Arthur Lewbel, Ulrich MÃ¼ller, John Strauss,
and Edward Vytlacil were helpful in numerous ways. This revision has also benefited from the detailed
comments of a co-editor as well as three anonymous referees. Max Kasy and Alex Poirier provided
research assistance. Financial support from the National Science Foundation (SES #0921928) is gratefully
acknowledged. All the usual disclaimers apply. The views expressed herein are those of the author(s)
and do not necessarily reflect the views of the National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

Â© 2008 by Bryan S. Graham and James Powell. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice,
is given to the source.
Identification and Estimation of 'Irregular' Correlated Random Coefficient Models
Bryan S. Graham and James Powell
NBER Working Paper No. 14469
November 20085HYLVHG2FWREHU
JEL No. C14,C23,I1,O1,O15

                                              ABSTRACT

In this paper we study identification and estimation of a correlated random coefficients (CRC) panel
data model. The outcome of interest varies linearly with a vector of endogenous regressors. The coefficients
on these regressors are heterogenous across units and may covary with them. We consider the average
partial effect (APE) of a small change in the regressor vector on the outcome (cf., Chamberlain, 1984;
Wooldridge, 2005a). Chamberlain (1992) calculates the semiparametric efficiency bound for the APE
in our model and proposes a Â¥N consistent estimator. Nonsingularity of the APEâ€™s information bound,
and hence the appropriateness of Chamberlainâ€™s (1992) estimator, requires (i) the time dimension of
the panel (T) to strictly exceed the number of random coefficients (p) and (ii) strong conditions on
the time series properties of the regressor vector. We demonstrate irregular identification of the APE
when T = p and for more persistent regressor processes. Our approach exploits the different identifying
information in the subpopulations of â€˜stayersâ€™ â€” or units whose regressor values change little across
periods â€” and â€˜moversâ€™ â€” or units whose regressor values change substantially across periods. We
propose a feasible estimator based on our identification result and characterize its large sample properties.
While irregularity precludes our estimator from attaining parametric rates of convergence, it limiting
distribution is normal and inference is straightforward to conduct. Standard software may be used
to compute point estimates and standard errors. We use our methods to estimate the average elasticity
of calorie consumption with respect to total outlay for a sample of poor Nicaraguan households.


Bryan S. Graham
New York University
19 W 4th Street, 6FL
New York, NY 10012
and NBER
bsg1@nyu.edu

James Powell
UC, Berkeley
Department of Economics
508-1 Evans Hall #3880
Berkeley, CA 94720-3880
powell@econ.berkeley.edu
    That the availability of multiple observations of the same sampling unit (e.g., individual, firm,
etc.) over time can help to control for the presence of unobserved heterogeneity is both intuitive and
plausible. The inclusion of unit-specific intercepts in linear regression models is among the most
widespread methods of â€˜controlling forâ€™ omitted variables in empirical work (e.g., Card, 1996).
The appropriateness of this modelling strategy, however, hinges on any time-invariant correlated
heterogeneity entering the outcome equation additively. Unfortunately, additivity, while statisti-
cally convenient, is diï¬ƒcult to motivate economically (cf., Imbens, 2007).2 Browning and Carro
(2007) present a number of empirical panel data examples where non-additive forms of unobserved
heterogeneity appear to be empirically relevant.
    In this paper we study the use of panel data for identifying and estimating what is arguably the
simplest statistical model admitting nonseparable heterogeneity: the correlated random coeï¬ƒcients
(CRC) model. Let Y = (ï™1 ï€» ï€º ï€º ï€º ï€» ï™ï” )0 be a ï” Ã— 1 vector of outcomes and X = (X1 ï€» ï€º ï€º ï€º ï€» Xï” )0 a ï” Ã— ï°
matrix of regressors with Xï´ âˆˆ Xï´ âŠ‚ Rï° and X âˆˆ Xï” where Xï” = Ã—ï´âˆˆ{1ï€»ï€ºï€ºï€ºï€»ï” } Xï´ ï€º We assume that
Xï´ is strictly exogenous. This rules out feedback from the period ï´ outcome ï™ï´ to the period ï³ â‰¥ ï´
regressor Xï³ . One implication of this assumption is that lags of the dependent variable may not
be included in Xï´ . Our model is a static one.
    Available is a random sample {(Yï© ï€» Xï© )}ï  ï©=1 from a distribution ï†0 . The ï´
                                                                                  ï´ï¨ period outcome is

given by
                                            ï™ï´ = X0ï´ ï¢ï´ (ïï€» ï•ï´ ) ï€»                                     (1)

where ï is time-invariant unobserved unit-level heterogeneity and ï•ï´ a time-varying disturbance.
Both ï and ï•ï´ may be vector-valued. The ï°Ã—1 vector of functions ï¢ï´ (ïï€» ï•ï´ ), which we allow to vary
over time, map ï and ï•ï´ into unit-by-period-specific slope coeï¬ƒcients. By â€˜randomâ€™ coeï¬ƒcients we
mean that ï¢ï´ (ïï€» ï•ï´ ) varies across units. By â€˜correlatedâ€™, we mean that the entire path of regressor
values, X, may have predictive power for ï¢ï´ (ïï€» ï•ï´ ). This implies that an agentâ€™s incremental return
to an additional unit of Xï´ may vary with Xï´ . In this sense Xï´ may be endogenous.
    Equation (1) is structural in the sense that the unit-specific function

                                               ï™ï´ (xï´ ) = x0ï´ ï¢ï´ (ïï€» ï•ï´ )                                           (2)

traces out a unitâ€™s period ï´ potential outcome across diï¬€erent hypothetical values of xï´ âˆˆ Xï´ ï€º3
Let Xï´ = (1ï€» ï˜ï´0 )0 ; setting ï¢1ï´ (ïï€» ï•ï´ ) = ï‚¯ 1 + ï + ï•ï´ (with ï and ï•ï´ scalar and mean zero) and
ï¢ï«ï´ (ïï€» ï•ï´ ) = ï‚¯ ï« for ï« = 2ï€» ï€º ï€º ï€º ï€» ï° yields the textbook linear panel data model:

                                             ï™ï´ (xï´ ) = x0ï´ ï‚¯ + ï + ï•ï´ ï€º                                            (3)

Equation (2), while preserving linearity in Xï´ , is more flexible than (3) in that it allows for time-
   2
     Chamberlain (1984) presents several well-formulated economic models that do imply linear specifications with
unit-specific intercepts.
   3
     Throughout we use capital letters to denote random variables, lower case letters specific realizations of them, and
blackboard bold letters to denote their support (e.g., ï˜ï€» ï¸ and X)..



                                                           1
varying random coeï¬ƒcients on all of the regressors (not just the intercept). Furthermore these
coeï¬ƒcients may nonlinearly depend on ï and/or ï•ï´ ï€º
    Our goal is to characterize the eï¬€ect of an exogenous change in Xï´ on the probability distribution
of ï™ï´ ï€º By â€˜exogenous changeâ€™ we mean an external manipulation of Xï´ in the sense described by
Blundell and Powell (2003) or Imbens and Newey (2009). We begin by studying identification and
estimation of the average partial eï¬€ect (APE) of Xï´ on ï™ï´ (cf., Chamberlain, 1984; Blundell and
Powell, 2003; Wooldridge, 2005a). Under (1) the average partial eï¬€ect is given by
                                                âˆ™       Â¸
                                          ï¤ï¥ï¦ ï€ï™ï´ (xï´ )
                                    Î²0ï´   â‰¡ E             = E [ï¢ï´ (ïï€» ï•ï´ )] ï€º                                  (4)
                                                ï€xï´

    Identification and estimation of (4) is nontrivial because, in our setup, Xï´ may vary systemati-
cally with ï and/or ï•ï´ . To see the consequences of such dependence observe that the derivative of
the mean regression function of ï™ï´ given X does not identify a structural parameter. Diï¬€erentiating
through the integral we have

                      ï€E [ ï™ï´ | X = x]
                                       = Î²0ï´ (x) + E [ ï™ï´ (Xï´ ) Sï˜ï´ ( ïï€» ï•ï´ | X)| X = x] ï€»                     (5)
                            ï€xï´

with Î²0ï´ (x) = E [ ï¢ï´ (ïï€» ï•ï´ )| X = x] and Sï˜ï´ ( ïï€» ï•ï´ | X) = âˆ‡ï˜ï´ log ï¦ ( ïï€» ï•ï´ | X). The second term is
what Chamberlain (1982) calls heterogeneity bias. If the (log) density of the unobserved hetero-
geneity varies sharply with xï´ â€” corresponding to â€˜selection biasâ€™ or â€˜endogeneityâ€™ in a unitâ€™s choice
of xï´ â€” then the second term in (5) can be quite large.
    Chamberlain (1982) studies identification of Î²0 â‰¡ Î²00 using panel data (cf., Mundlak, 1961,
1978b). In a second paper, Chamberlain (1992, pp. 579 - 585) calculates the semiparametric vari-
ance bound for Î²0 and proposes an eï¬ƒcient method-of-moments estimator.4 His approach is based
on a generalized within-group transformation; naturally extending the idea that panel data allow
the research to control for time-invariant heterogeneity by â€˜diï¬€erencing it awayâ€™.5 Under regular-
ity conditions, which ensure nonsingularity of Î²0 â€™s information bound, Chamberlainâ€™s estimator
                              âˆš
converges at the standard ï rate.
    Nonsingularity of I (Î²0 ), the information for Î²0 , generally requires the time dimension of the
panel to exceed the number of random coeï¬ƒcients (ï” ï€¾ ï°). Depending on the time series properties
of the regressors, ï” may need to substantially exceed ï°. In extreme cases I (Î²0 ) may be zero
for all values of ï” . In such settings Chamberlainâ€™s method breaks down. We show that, under
mild conditions, Î² 0 nevertheless remains identified. Our method of identification is necessarily
                                                                        âˆš
â€˜irregularâ€™: the information bound is singular and hence no regular ï consistent estimator exists
(Chamberlain, 1986). We develop a feasible analog estimator for Î² 0 and characterize its large
sample properties. Although its rate of convergence is slower than the standard parametric one,
   4
     Despite its innovative nature, and contemporary relevance given the resurgence of interest in models with het-
erogenous marginal eï¬€ects, Chamberlainâ€™s work on the CRC model is not widely known. The CRC specification is
not discussed in Chamberlainâ€™s own Handbook of Econometrics chapter (Chamberlain, 1984), while the panel data
portion of Chamberlain (1992) is only briefly reviewed in the more recent survey by Arellano and HonorÃ© (2001).
   5
     Bonhomme (2010) further generalizes this idea, introducing a notion of â€˜functional diï¬€erencingâ€™.


                                                        2
its limiting distributions is normal. Inference is straightforward.
     Our work shares features with other studies of irregularly identified semiparametric models
(e.g., Chamberlain, 1986; Manski, 1987; Heckman, 1990; Horowitz, 1992; Abrevaya, 2000; Hon-
orÃ© and Kyriazidou, 1997; Kyriazidou, 1997; Andrews and Schafgans, 1998; Khan and Tamer,
2009). A general feature of irregular identification is its dependence on the special properties of
small subpopulations. These special properties are, in turn, generated by specific features of the
semiparametric model. Consequently these types of identification arguments tend to highlight the
importance, sometimes uncomfortably so, of maintained modelling assumptions (cf., Chamberlain,
1986, pp. 205 - 207; Khan and Tamer, 2009).
     Our approach exploits the diï¬€erent properties, borrowing a terminology introduced by Cham-
berlain (1982), of â€˜moversâ€™ and â€˜stayersâ€™. Loosely speaking these two subpopulations respectively
correspond to those units whose regressors values, Xï´ , change and do not change across periods
(a precise definition in terms of singularity of a unit-specific design matrix is given below). We
identify aggregate time eï¬€ects using the variation in ï™ï´ in the â€˜stayersâ€™ subpopulation. A common
trends assumption allows us to extrapolate these estimated eï¬€ects to the entire population. Hav-
ing identified the aggregate time eï¬€ects using stayers, we then identify the APE by the limit of a
trimmed mean of a particular unit-specific vector of regression coeï¬ƒcients.

Connection to other work on panel data In order to connect our work to the wider panel
data literature it is useful to consider the more general outcome response function:

                                      ï™ï´ (xï´ ) = ï­ (xï´ ï€» ïï€» ï•ï´ ) ï€º

Identification of the APE in the above model may be achieved by one of two main classes of
restrictions. The correlated random eï¬€ects approach invokes assumptions on the joint distribution
of (Uï€» ï)| X; with U = (ï•1 ï€» ï€º ï€º ï€º ï€» ï•ï” )0 ï€º Mundlak (1978a,b) and Chamberlain (1980, 1984) develop
this approach for the case where ï­ (Xï´ ï€» ïï€» ï•ï´ ) and ï† ( Uï€» ï| X) are parametrically specified. Newey
(1994a) considers a semiparametric specification for ï† ( Uï€» ï| X) (cf., Arellano and Carrasco, 2003).
Recently, Altonji and Matzkin (2005) and Bester and Hansen (2009) have extended this idea to the
case where ï­ (Xï´ ï€» ïï€» ï•ï´ ) is either semi- or non-parametric along with ï† ( Uï€» ï| X).
    The fixed eï¬€ects approach imposes restrictions on ï­ (Xï´ ï€» ïï€» ï•ï´ ) and ï† ( U| Xï€» ï), while leaving
ï† ( ï| X), the distribution of the time-invariant heterogeneity, the so-called â€˜fixed eï¬€ectsâ€™, unre-
stricted. Chamberlain (1980, 1984, 1992), Manski (1987), HonorÃ© (1992), Abrevaya (2000), and
Bonhomme (2010) are examples of this approach. Depending on the form of ï­ (Xï´ ï€» ïï€» ï•ï´ ), the fixed
eï¬€ect approach may not allow for a complete characterization of the eï¬€ect of exogenous changes in
Xï´ on the probability distribution of ï™ï´ . Instead only certain features of this relationship may be
identified (e.g., ratios of the average partial eï¬€ect of two regressors).
    Our methods are of the â€˜fixed eï¬€ectâ€™ variety. In addition to assuming the CRC structure for
ï™ï´ (xï´ ) we impose a marginal stationarity restriction on ï† ( ï•ï´ | Xï€» ï) ï€» a restriction also used by
Manski (1987), HonorÃ© (1992) and Abrevaya (2000), however, other than some weak smoothness


                                                   3
conditions, we leave ï† ( ï| X) unrestricted.
     Wooldridge (2005b) and Arellano and Bonhomme (2009) also analyze the CRC panel data
model. Wooldridge focuses on providing conditions under which the usual linear fixed eï¬€ects (FE)
estimator is consistent despite the presence of correlated random coeï¬ƒcients (cf., Chamberlain,
1982, p. 11). Arellano and Bonhomme (2009) study the identification and estimation of higher-order
moments of the distribution of the random coeï¬ƒcients. Unlike us, they maintain Chamberlainâ€™s
(1992) regularity conditions as well as impose additional assumptions.
     Chamberlain (1982) showed that when Xï´ is discretely valued the APE is generally not iden-
tified (p. 13). However, Chernozhukov, FernÃ¡ndez-Val, Hahn and Newey (2009), working with
more general forms for E [ ï™ï´ | Xï€» ï] ï€» show that when ï™ï´ has bounded support the APE is partially
identified and propose a method of estimating the identified set.6 In contrast, in our setup we show
that the APE is point identified when at least one component of Xï´ is continuously-valued.
     Section 1 presents our identification results. We begin by (i) briefly reviewing the approach
of Chamberlain (1992) and (ii) characterizing irregularity in the CRC model. We then present
our method of irregular identification. Section 2 outlines our estimator as well as its large sample
properties. Section 3 discusses various extensions of our basic approach.
     In Section 4 we use our methods to estimate the average elasticity of calorie demand with
respect to total household resources. Our sample is drawn from a population that participated in a
pilot of the Nicaraguan conditional cash transfer program Red de ProtecciÃ³n Social (RPS). Hunger
is widespread in the communities from which our sample is drawn; we estimate that immediately
prior to the start of the RPS program over half of households had less then the required number
of calories needed for all their members to engage in â€˜light activityâ€™ on a daily basis.7
     A stated goal of the RPS program is to reduce childhood malnutrition, and consequently increase
human capital, by directly augmenting household income. The eï¬ƒcacy of this approach to reducing
childhood malnutrition largely depends on the size of the average elasticity of calories demanded
with respect to income across poor households.8 While most estimates of the elasticity of calorie
demand are significantly positive, several recent estimates are small in value and/or imprecisely
estimated, casting doubt on the value of income-oriented anti-hunger programs (Behrman and
Deolalikar, 1987).9
   6
     They consider the probit and logit models with unit-specific intercepts (in the index) in detail. They show how to
construct bounds on the APE despite the incidental parameters problem and provide conditions on the distribution
of Xï´ such that these bounds shrink as ï” grows.
   7
     We use Food and Agricultural Organization (FAO, 2001) gender- and age-specific energy requirements for â€˜light
activityâ€™, as reported in Appendix 8 of Smith and Subandoro (2007), and our estimates of total calories available
at the household-level to calculate the fraction of households suï¬€ering from â€˜food insecurityâ€™. Worldwide, the FAO
estimates that 854 million people suï¬€ered from protein-energy malnutrition in 2001-03 (FAO, 2006). Halving this
number by 2015, in proportion to the worldâ€™s total population, is the first United Nations Millennium Development
Goal. Chronic malnutrition, particularly in early childhood, may adversely aï¬€ect cognitive ability and economic
productivity in the long-run (e.g., Dasgupta, 1993).
   8
     Another motivation for studying this elasticity has to do with its role in theoretical models of nutrition-based
poverty traps (see Dasgupta (1993) for a survey).
   9
     Wolfe and Behrman (1983), using data from Somoza-era Nicaragua, estimate a calorie elasticity of just 0.01.
Their estimate, if accurate, suggests that the income supplements provided by the RPS program should have little
eï¬€ect on caloric intake.


                                                          4
    Disagreement about the size of the elasticity of calorie demand has prompted a vigorous method-
ological debate in development economics. Much of this debate has centered, appropriately so, on
issues of measurement and measurement error (e.g., Bouis and Haddad, 1992; Bouis, 1994; Sub-
ramanian and Deaton, 1996). The implications of household-level correlated heterogeneity in the
underlying elasticity for estimating its average, in contrast, have not been examined. If, for example,
a householdsâ€™ food preferences, or preferences towards child welfare, co-vary with those governing
labor supply, then its elasticity will be correlated with total household resources. An estimation
approach which presumes the absence of such heterogeneity will generally be inconsistent for the
parameter of interest. Our statistical model and corresponding estimator provides an opportunity,
albeit in a specific setting, for assessing the relevance these types of heterogeneities.
    We compare our CRC estimates of the elasticity of calorie demand with those estimated using
standard panel data estimators (e.g., Behrman and Deolalikar, 1987; Bouis and Haddad, 1992),
as well as those derived from cross-sectional regression methods as in Strauss and Thomas (1990,
1995), Subramanian and Deaton (1996), and others. Our preferred CRC elasticity estimates are 10
to 20 percent smaller than their corresponding textbook linear â€˜fixed eï¬€ectsâ€™ estimates (FE-OLS).
Our results are consistent with the presence of modest â€˜correlated random coeï¬ƒcients biasâ€™.
    Section 5 summarizes and suggests areas for further research. Proofs are in the Appendix. The
                           ï„
notation 0ï” ï€» ï‚¶ï” ï€» ï‰ï” and = respectively denotes a ï” Ã— 1 vector of zeros, a ï” Ã— 1 vector of ones, the
ï” Ã— ï” identity matrix, and equality in distribution.


1    Identification
Our benchmark data generating process combines (1) with the following assumption.

Assumption 1.1 (Stationarity and Common Trends)
                                                                          0 ï€» ï• 0 )0
(i) ï¢ï´ (ïï€» ï•ï´ ) = ï¢âˆ— (ïï€» ï•ï´ ) + ï¤ï´ (ï•2ï´ ) for ï´ = 1ï€» ï€º ï€º ï€º ï€» ï” and ï•ï´ = (ï•1ï´   2ï´
                ï„
(ii) ï•ï´ | Xï€» ï = ï•ï³ | Xï€» ï for ï´ = 1ï€» ï€º ï€º ï€º ï€» ï” , ï´ 6= ï³
                  ï„
(iii) ï•2ï´ | Xï€» ï = ï•2ï´
(iv) E [ ï¢ï´ (ïï€» ï•ï´ )| X = x] exists for all ï´ = 1ï€» ï€º ï€º ï€º ï€» ï” and x âˆˆ Xï” .

     Part (i) of Assumption 1.1 implies that the random coeï¬ƒcient consists of a â€˜stationaryâ€™ and
â€˜nonstationaryâ€™ component. The stationary part, ï¢âˆ— (ïï€» ï•ï´ ), does not vary over time so that if
ï•ï´ = ï•ï³ we have ï¢âˆ— (ïï€» ï•ï´ ) = ï¢âˆ— (ïï€» ï•ï³ ). The non-stationary part, which is a function of the
subvector ï•2ï´ alone, may vary over time so that even if ï•2ï´ = ï•2ï³ we may have ï¤ï´ (ï•2ï´ ) 6= ï¤ï³ (ï•2ï³ ).
     Part (ii) imposes marginal stationarity of ï•ï´ given X and ï (cf., Manski, 1987). Marginal
stationarity, while allowing for serial dependence in ï•ï´ ï€» is restrictive. For example it rules out time-
varying heteroscedasticity. Part (iii) requires that ï•2ï´ is independent of both X and ï. Maintaining
(ii) and (iii) is weaker than assuming that ï•ï´ is i.i.d. over time and independent of X and ï as
is often done in nonlinear panel data research (e.g., Chamberlain, 1980). Part (iv) is a technical
condition. Note that Assumption 1.1 does not restrict the joint distribution of X and ï. Our
model is a â€˜fixed eï¬€ectsâ€™ one.

                                                         5
       Under Assumption 1.1 we have

                         E [ ï¢ï´ (ïï€» ï•ï´ )| X] = E [ ï¢âˆ— (ïï€» ï•ï´ )| X] + E [ ï¤ï´ (ï•2ï´ )| X]
                                              = E [ ï¢âˆ— (ïï€» ï•1 )| X] + E [ï¤ï´ (ï•21 )]
                                              = ï‚¯ 0 (X) + Î´ 0ï´ ï€»      ï´ = 1ï€» ï€º ï€º ï€º ï€» ï”ï€»                      (6)

where first equality uses part (i) of Assumption 1.1, the second parts (ii) and (iii), and the third
establishes the notation ï‚¯ 0 (X) = E [ ï¢âˆ— (ïï€» ï•1 )| X] and Î´ 0ï´ = E [ï¤ï´ (ï•2ï´ )]. In what follows we
normalize Î´01 = 0ï€º
    Equation (6) is a â€˜common trendsâ€™ assumption. To see this consider two subpopulations with
diï¬€erent regressor histories (X = x and X = x0 ). Restriction (6) implies that10
                                                           Â£               Â¤   Â£                Â¤
              E [ ï¢ï´ (ïï€» ï•ï´ )| x] âˆ’ E [ ï¢ï³ (ïï€» ï•ï³ )| x] = E ï¢ï´ (ïï€» ï•ï´ )| x0 âˆ’ E ï¢ï³ (ïï€» ï•ï³ )| x0
                                                       = Î´0ï´ âˆ’ Î´ 0ï³ ï€º

Now recall that a unitâ€™s period ï´ potential outcome function is ï™ï´ (xï´ ) = x0ï´ ï¢ï´ (ïï€» ï•ï´ ) ï€º Let Ï„ be any
point in the support of both Xï´ and Xï³ ï€» we have for all x âˆˆ Xï”

                    E [ ï™ï´ (Ï„ ) âˆ’ ï™ï³ (Ï„ )| X = x] = E [ï™ï´ (Ï„ ) âˆ’ ï™ï³ (Ï„ )] = Ï„ 0 (Î´ 0ï´ âˆ’ Î´ 0ï³ ) ï€º             (7)

Equation (7) implies that while the period ï´ (linear) potential outcome functions may vary arbitrar-
ily across subpopulations defined in terms of X = x, shifts in these functions over time are mean
independent of X. A variant of (7) is widely-employed in the program evaluation literature (e.g.,
Heckman, Ichimura, Smith and Todd, 1998; Angrist and Krueger, 1999). It is also satisfied by the
linear panel data model featured in Chamberlain (1984).11
                                                                            Â¡                  Â¢0
    Let the (ï” âˆ’ 1) ï°Ã—1 vector of aggregate shifts in the random coeï¬ƒcients Î´ 02 ï€» ï€º ï€º ï€º ï€» Î´ 0ï” be denoted
by Î´ with the corresponding ï” Ã— (ï” âˆ’ 1) ï° matrix of time shifters given by
                                                 â›                    â
                                              00ï°                 00ï°
                                            âœ 0                       âŸ
                                            âœ X2                  00ï° âŸ
                                          W=âœ
                                            âœ                ..
                                                                      âŸï€º
                                                                      âŸ                                      (8)
                                            â                   .     â 
                                              00ï°                 Xï”0


Under Assumption 1.1 we can write the conditional expectation of Y given X as:

                                         E [ Y| X] = WÎ´ 0 +XÎ² 0 (X) ï€º                                        (9)
  10
    We use the notation E [ ï™ | X = x] = E [ ï™ | x] ï€º
  11
    In an NBER working paper we show how to weaken (6) while still getting positive identification results. As we
do not use these additional results when considering estimation they are omitted.




                                                         6
    In some cases it will be convenient to impose a priori zero restrictions on Î´ 0 (which would
imply restrictions on how E [ï™ï´ (xï´ )] is allowed to vary over time). In order to accommodate such
situations (without introducing additional notation) we can simply redefine W and Î´ 0 accordingly.
For example a model which allows only the intercept of E [ï™ï´ (xï´ )] to shift over time is given by (9)
                    Â¡           Â¢0
above with W = 0ï” âˆ’1 ï€» ï‰ï” âˆ’1 and Î´0 equal to the ï” âˆ’1 vector of intercept shifts. To accommodate
a range of options we hereon assume that W is a known ï” Ã— ï± function of Xï€º
    Equation (9), which specifies a semiparametric mean regression function for Y given X, is the
fundamental building block of the results that follow. Our identification results are based solely on
diï¬€erent implications of (9). The role of equation (1) and Assumption 1.1 is to provide primitive
restrictions on ï†0 which imply (9). We emphasize that our results neither hinge on, nor necessarily
fully exploit, all of these assumptions. Rather they flow from just one of their implications.

1.1      Regular identification
The partially linear form of (9) suggests identifying Î´ 0 using the conditional variation in W given
X as in, for example, Engle, Granger, Rice and Weiss (1986).12 In our benchmark model, however,
W is a ï” Ã— ï± function of X and hence no such conditional variation is available. Nevertheless
Chamberlain (1992) has shown that Î´ 0 may be identified using the panel structure.
   Let Î¦ (X) be some function of X mapping into ï” Ã— ï” positive definite matrices (in practice
Î¦ (X) = ï‰ï” will often suï¬ƒce) and define the ï” Ã— ï” idempotent â€˜residual makerâ€™ matrix:
                                                Â£            Â¤âˆ’1 0 âˆ’1
                                 ïÎ¦ (X) = ï‰ï” âˆ’ X X0 Î¦âˆ’1 (X) X   X Î¦ (X) ï€º                                    (10)

Using the fact that ïÎ¦ (X) X = 0 Chamberlain (1992) derived, for ï” ï€¾ ï° and other regularity
conditions, the pair of moment restrictions
                             "                                                     #
                                       W0 Î¦âˆ’1 (X) ïÎ¦ (X) (Y âˆ’ WÎ´ 0 )
                         E       Â£ 0 âˆ’1      Â¤âˆ’1 0 âˆ’1                                  = 0ï€»
                                  X Î¦ (X) X     X Î¦ (X) (Y âˆ’ WÎ´ 0 ) âˆ’ Î²0

which identify Î´ 0 and Î²0 by
                                 h              iâˆ’1    h              i
                                    0                    0
                          Î´ 0 = E WÎ¦ Î¦âˆ’1 (X) WÎ¦     Ã— E WÎ¦ Î¦âˆ’1 (X) YÎ¦                                        (11)
                                 hÂ¡           Â¢âˆ’1 0 âˆ’1              i
                          Î²0 = E X0 Î¦âˆ’1 (X) X    X Î¦ (X) (Y âˆ’ WÎ´ 0 ) ï€»                                       (12)

where WÎ¦ = ïÎ¦ (X) W and YÎ¦ = ïÎ¦ (X) Yï€º
   Note that ïÎ¦ (X) may be viewed as a generalization of the within-group transform. To see this
                                                                                            ï¨      ï©âˆ’1   ï¨     ï©
 12                     ï¦ = W âˆ’ E [ W| X] has a covariance matrix of full rank, then ï‚± 0 = E W
      To be specific if W                                                                     ï¦ 0W
                                                                                                 ï¦     Ã—E Wï¦ 0Y .




                                                         7
note that premultiplying (9) by ïÎ¦ (X) yields
                             Â£   Â¯ Â¤
                            E YÎ¦ Â¯ X = WÎ¦ Î´ 0 + ïÎ¦ (X) XÎ²0 (X)
                                         = WÎ¦ Î´ 0 ï€»

so that ïÎ¦ (X) â€˜diï¬€erences awayâ€™ the unobserved correlated eï¬€ects, Î²0 (X). Equation (11) shows
that Î´ 0 is identified by the remaining â€˜within-groupâ€™ variation in Wï´ .
    With Î´ 0 asymptotically known, the APE is then identified by the (population) mean of the
unit-specific generalized least squares (GLS) fits
                             Â¡               Â¢
                        b ï© = X0 Î¦âˆ’1 (Xï© ) Xï© âˆ’1 X0 Î¦âˆ’1 (Xï© ) (Yï© âˆ’ Wï© Î´ 0 ) ï€º
                        Î²                                                                      (13)
                               ï©                  ï©


Chamberlain (1992) showed that setting Î¦ (X) = Î£ (X) = V ( Y| X) is optimal; resulting in esti-
mators with asymptotic sampling variances equal to the variance bounds:
                              h              iâˆ’1
                                  0
                I (Î´ 0 )âˆ’1 = E WÎ£ Î£âˆ’1 (X) WÎ£                                                   (14)
                                          hÂ¡            Â¢âˆ’1 i
                I (Î²0 )âˆ’1 = V (Î²0 (X)) + E X0 Î£âˆ’1 (X) X       + ï‹I (Î´ 0 )âˆ’1 ï‹ 0 ï€»              (15)
              hÂ¡            Â¢âˆ’1 0 âˆ’1    i
where ï‹ = E     X0 Î£âˆ’1 (X) X   X Î£ (X) W ï€º

1.2   Irregularity of the CRC panel data model
Chamberlainâ€™s approach requires nonsingularity of I (Î´ 0 ) and I (Î² 0 ) ï€º In this section we discuss
                                                                   âˆš
when this condition might not hold and, consequently, no regular ï consistent estimator exists.
We begin by noting that singularity I (Î´ 0 ) is generic if ï” = ï°ï€» our primary case. The following
proposition specializes Proposition 1 of Chamberlain (1992) to our problem.

Proposition 1.1 (Zero Information) Suppose that (i) (ï†0 ï€» Î´ 0 ï€» Î²0 (Â·)) satisfies (9), (ii) Î£ (x) is
                                          Â£            Â¤
positive definite for all x âˆˆ Xï” ï€» (iii) E W0 Î£âˆ’1 (X) W ï€¼ âˆ and (iv) ï” = ï°ï€» then I (Î´ 0 ) = 0ï€º

Proof. From Chamberlain (1992) the information bound for Î´ 0 is given by
                                               h              i
                                                 0
                                   I (Î´ 0 ) = E WÎ£ Î£âˆ’1 (X) WÎ£

so that ï‚®0 I (Î´ 0 ) ï‚® = 0 is equivalent to WÎ£ ï‚® = 0 with probability one. If ï” = ï°, then X is square
so that                           Â³                                        Â´
                                           Â£            Â¤âˆ’1 0 âˆ’1
                       WÎ£ = W ï‰ï” âˆ’ X X0 Î£âˆ’1 (X) X          X Î£ (X) (X) = 0

such that WÎ£ ï‚® = 0.
   An intuition for Proposition 1.1 is that when ï” = ï° Chamberlainâ€™s generalized within-group
transform of W eliminates all residual variation in Wï´ over time. This is because the ï° predictors
Xï´ perfectly (linearly) predict each element of Wï´ when ï” = ï°. Consequently the deviation of

                                                  8
Wï´ from its â€˜within-group meanâ€™ is identically equal to zero; any approach based on within-unit
variation will necessarily fail.
    As a simple example consider the one period (ï” = ï° = 1) â€˜panel dataâ€™ model where, suppressing
the ï´ subscript,
                                       ï™ = Î´ 0 +ï˜ï¢ (ïï€» ï• ) ï€»                                 (16)

with ï˜ scalar. Under Assumption 1.1 this gives (9) with W = 1 and X = ï˜. The generalized
                                                      Â³ 2 Â´âˆ’1
                                                        ï˜      ï˜
within-group operator for this model is ïï‰ (X) = 1 âˆ’ ï˜ Î¦(X)   Î¦(X) = 0ï€º Consequently Y ï‰ =
Wï‰ = 0 and (11) does not identify Î´ 0 . By Proposition 1.1 I (Î´ 0 ) = 0ï€º We show that Î´ 0 and Î² 0 are
irregularly identified in this model below.
                                                              âˆš
    We do not provide a general result on when regular ï estimation of Î²0 is possible. However
some insight into this question can be gleaned from a few examples. First, when ï” = ï°, it appears
as though Î²0 will not be regularly identifiable unless Î´ 0 is known. This can be conjectured by the
form of (15) which will generally be infinite if I (Î´ 0 )âˆ’1 is. Even if Î´ 0 is known regular identification
can be delicate. Consider the ï” = ï° = 1 model given above. In this model the right-hand-side of
(12) above specializes to E [(ï™ âˆ’ Î´ 0 ) ï€½ï˜], which will be undefined in ï˜ has positive density in the
neighborhood of zero.
    Less obviously, regular estimation may be impossible in heavily overidentified models (i.e., those
where ï” substantially exceeds ï°).13 To illustrate again consider (16) with Î´ 0 known, but with ï” â‰¥ 2.
Assume further that Î£ (X) = ï‰ï” and ï˜ï´ = ï“ Â· ïšï´ where

                                                                  ï©ï©ï¤
                                         ï“ âˆ¼ U [ï¡ï€» ï¢] ï€»   ïšï´ âˆ¼ N (0ï€» 1) ï€º

Variation in ï˜ï´ over time in this model is governed by ï“, which varies across units. For those units
with ï“ close to zero, ï˜ï´ will vary little across periods. The unit specific design matrix in this model
                             P
is given by X0 Î£âˆ’1 (X) X = ïšï´ 2 Â· ï“ âˆ¼ ïƒ‚2ï” Â· U [ï¡ï€» ï¢]. If 0 ï€¼ ï¡ ï€¼ ï¢ then
                                                              (
                               hÂ¡           Â¢âˆ’1 i                  ln(ï¢)âˆ’ln(ï¡)
                                                                                 ï” â‰¥3
                              E X0 Î£âˆ’1 (X) X      =                    ï” âˆ’2           ï€»
                                                                   âˆ             ï” ï€¼3

so the right-hand-side of (12) will be well-defined if ï” â‰¥ 3. If ï¡ â‰¤ 0, then it is undefined regardless
of the number of time periods. If ï¡ â‰¤ 0 the support of ï“ will contain zero, ensuring a positive
density of units whose values of Xï´ do not change over time. These â€˜stayersâ€™ will have singular
design matrices in (13), causing the variance bound for Î²0 to be infinite.
    To summarize regular identification of Î²0 requires suï¬ƒcient within-unit variation in Xï´ for
all units. This is a very strong condition. Many microeconometric applications are characterized
by a preponderance of stayers.14 While time series variation in Xï´ is essential for identification,
  13
     In contrast the variance bound for ï‚± 0 will be finite when ï” ï€¾ ï° as long as there is some variation in Xï´ over
time.
  14
     In Cardâ€™s (1996) analysis of the union wage premium, for example, less than 10 percent of workers switch between
collective bargaining coverage and non-coverage across periods (Table V, p. 971).



                                                          9
persistence in its process is common in practice. This persistence will often imply that the right-
hand-side of (12) is undefined.

1.3   Irregular identification
In this section we show that, under weak conditions, Î´ 0 and Î²0 are irregularly identified when
ï” = ï°ï€º We show how to extend our methods to the irregular ï” ï€¾ ï° (overidentified) case in Section
3 below. Let
                                        ï„ = det (X)

and
                                                  Xâˆ— = adj (X)
                                                                        1
respectively denote the determinant and adjoint of X such that Xâˆ’1 = ï„    Xâˆ— when the former
exists. In what follows we will often refer to units where ï„ = 0 as stayers. To motivate this
terminology consider the case where ï” = ï° = 2 with W and X in (9) equal to
                                          Ãƒ       !             Ãƒ             !
                                              0                     1 ï˜1
                                 W=                   ï€»    X=                     ï€»
                                              1                     1 ï˜2

with ï˜ï´ scalar. This corresponds to a model with (i) a random intercept and slope coeï¬ƒcient and
(ii) a common intercept shift between periods one and two. In this model

                                          ï„ = ï˜2 âˆ’ ï˜1 = âˆ†ï˜;

hence ï„ = 0 corresponds to âˆ†ï˜ = 0, or a unitâ€™s value of ï˜ï´ â€˜stayingâ€™ fixed across the two periods.
More generally ï„ = 0 if two or more rows of X coincide, which occurs if Xï´ does not change across
adjacent periods or reverts to an earlier value in a later period. Loosely-speaking, we may think of
stayers as units whose value of Xï´ changes little across periods.
    Let Yâˆ— = Xâˆ— Y and Wâˆ— = Xâˆ— W equal Y and W after premultiplication by the adjoint of X.
In the ï” = ï° = 2 example introduced above we have
                    Ãƒ             !                Ãƒ                      !                 Ãƒ         !
               âˆ—        ï˜2 âˆ’ï˜1                âˆ—           ï˜2 ï™1 âˆ’ ï˜1 ï™2                âˆ—        âˆ’ï˜1
             X =                      ï€»   Y =                                 ï€»       W =                 ï€º
                        âˆ’1  1                                  âˆ†ï™                                1

    In an abuse of notation let Î² 0 (ï¤) = E [ Î²0 (X)| ï„ = ï¤] ï€º Our identification result, in addition to
(9), requires the following assumption.

Assumption 1.2 (Smoothness and Continuity)
                                                                Z   ï¨
(i) For some ïµ0 ï€¾ 0ï€» ï„ = det (X) has Pr (|ï„| ï€¼ ï¨) =          ïƒ (ïµ) dïµ with ïƒ (ïµ) ï€¾ 0 for all ï¨ â‰¤ ïµ0 ;
       h       i                                         âˆ’ï¨
(ii) E kWâˆ— k2 ï€¼ âˆ and E [ Wâˆ—0 Wâˆ— | ï„ = 0] is nonsingular; and
(iii) the functions Î²0 (ïµ) ï€» ïƒ(ïµ), E [ Wâˆ— | ï„ = ïµ] ï€» and E [ Wâˆ—0 Wâˆ— | ï„ = ïµ] are continuous in ïµ for


                                                          10
âˆ’ïµ0 â‰¤ ïµ â‰¤ ïµ0 .

    Part (i) of Assumption 1.2 is essential as our approach involves conditioning on diï¬€erent values
of ï„. While the requirement that ï„ has positive density near zero is indispensable, the implication
that Pr (ï„ = 0) = 0 can be relaxed. In Section 3 we show how to deal with the case where the
distribution ï„ has a point mass at zero. This may occur if the distribution of Xï´ has mass points
at a finite set of values, while being continuously distributed elsewhere. If there is overlap in the
mass points of Xï´ and Xï³ (ï´ 6= ï³), then the distribution of ï„ will have a mass point at zero.
    Part (ii) of Assumption 1.2 is required for identification of Î´ 0 . It will typically hold in well-
specified models and is straightforward to verify. Part (iii) is a smoothness assumption which, in
conjunction with (i), allows us to trim without changing the estimand.

Identification of the aggregate time eï¬€ects, Î´ 0 : We begin by premultiplying (9) by Xâˆ— to
get
                              E [ Yâˆ— | X] = Wâˆ— Î´ 0 +ï„Î²0 (X) ï€»

where we use the fact that ï„ï‰ï” = Xâˆ— X. Conditioning on the subpopulation of â€˜stayersâ€™ yields

                                      E [ Yâˆ— | Xï€»ï„ = 0] = Wâˆ— Î´ 0 ï€º                                  (17)

Under Assumption 1.2 equation (17) implies that Î´ 0 is identified by the conditional linear predictor
(CLP)
                             Â£        Â¯       Â¤âˆ’1        Â£        Â¯       Â¤
                      Î´ 0 = E Wâˆ—0 Wâˆ— Â¯ ï„ = 0       Ã— E Wâˆ—0 Yâˆ— Â¯ ï„ = 0 ï€º                          (18)

Equation (18) shows that the subpopulation of stayers is used to tie down the aggregate time eï¬€ects,
Î´ 0 . Since stayerâ€™s correspond to units whose values of Xï´ change little over time, the evolution of
ï™ï´ among these units is driven by the aggregate time eï¬€ects. This approach to identifying Î´ 0 is
reminiscent of Chamberlainâ€™s (1986) â€˜identification at infinityâ€™ result for the intercept of the censored
regression model (p. 205). Both approaches use a small subpopulation to tie down a feature of
the entire population. An important diï¬€erence is that our result does not require Xï´ to have
unbounded support. Consequently, our identification result is not sensitive to the â€˜tail propertiesâ€™
of the distribution of Xï€º Our key requirement, that ï„ have positive density in a neighborhood
about zero, is straightforward to verify. We do this in the empirical application by plotting a kernel
density estimate of ïƒ (ï¤), the density of ï„.
      In the ï” = ï° = 2 example we have, conditional on ï„ = 0ï€» the equality Yâˆ— = Wâˆ— âˆ†ï™ so that
(18) simplifies to, recalling that ï„ = âˆ†ï˜,

                                        Î´ 0 = E [ âˆ†ï™ | âˆ†ï˜ = 0] ï€º                                    (19)

The common intercept shift is identified by the average change in ï™ï´ in the subpopulation of
stayers. Identification of Î´ 0 is irregular since Pr (ï„ = 0) = 0; Î´ 0 corresponds to the value of the
nonparametric mean regression of âˆ†ï™ given ï„ at ï„ = 0ï€º Note the importance of the (verifiable)

                                                   11
requirement that ïƒ0 ï€¾ 0 for this result.
   As a second example of (18) consider the one period â€˜panel dataâ€™ model introduced above. From
(16) we have
                                         E [ ï™ | ï˜ = 0] = Î´ 0 ,

or â€˜identification at zeroâ€™.

Identification of the average partial eï¬€ects, Î²0 : Treating Î´ 0 as known we identify Î²0 (x)
for all x such that ï¤ is non-zero by
                                            Â£               Â¯      Â¤
                                  Î²0 (x) = E Xâˆ’1 (Y âˆ’ WÎ´ 0 )Â¯ X = x ï€º                            (20)

It is instructive to consider the ï” = ï° = 2 case introduced above. In that model the second
component of the right-hand side of (20), corresponding to the slope coeï¬ƒcient on ï˜ï´ , evaluates to

                                           E [ âˆ†ï™ | X = x] âˆ’ Î´ 0
                               Î²20 (x) =                                                         (21)
                                                 ï¸2 âˆ’ ï¸1
                                           E [ âˆ†ï™ | X = x] âˆ’ E [ âˆ†ï™ | âˆ†ï˜ = 0]
                                      =
                                                        ï¸2 âˆ’ ï¸1

where the second, diï¬€erence-in-diï¬€erences, equality follows by substituting in (19) above. Equation
(21) indicates that the average slope coeï¬ƒcient, in a subpopulation homogenous in X = x, is equal
to the average â€˜riseâ€™ â€” E [ âˆ†ï™ | X = x] â€” over the common â€˜runâ€™ â€” ï¸2 âˆ’ ï¸1 . The evolution of ï™ï´
amongst stayers is used to eliminate the aggregate time eï¬€ect from the average rise (i.e., to control
for â€˜common trendsâ€™) in this computation.
    Using (21) we then might try, by appealing to the law of iterated expectations, to identify Î² 20
by                                          âˆ™           Â¸
                                              âˆ†ï™ âˆ’ Î´ 0
                                          E               ï€º                                      (22)
                                                âˆ†ï˜
An approach based on (22) was informally suggested by Mundlak (1961, p. 45). Chamberlain (1982)
considered (22) with Î´ 0 = 0, showing that it identifies Î²20 if E [|âˆ†ï™ ï€½âˆ†ï˜|] ï€¼ âˆ. However, if âˆ†ï˜ has
a positive, continuous density at zero â€” and if E[|âˆ†ï™ | | âˆ†ï˜ = ï¤]âˆ’Î´0 does not vanish at ï¤ = 0 â€” then
(22) will not be finite. For example, if âˆ†ï™ and âˆ†ï˜ are independently and identically distributed
according to the standard normal distribution, then âˆ†ï™ ï€½âˆ†ï˜ will be distributed according to the
Cauchy distribution, whose expectation does not exist.
   More generally the expectation
                                            Â£               Â¤
                                           E Xâˆ’1 (Y âˆ’ WÎ´ 0 )

will be undefined if the distribution of X is such that ï„ has a positive density in the neighborhood
of ï„ = 0 (i.e., there is a positive density of â€˜stayersâ€™)ï€º This will occur when, for example, at least
two rows of X â€˜nearlyâ€™ coincide for â€˜enoughâ€™ units (i.e., when part (i) of Assumption 1.2 holds).


                                                    12
   To deal with the small denominator eï¬€ects of stayers we trim. Under parts (i) and (iii) of
Assumption 1.2 we have the equalities (see equation (42) in the Appendix)

                           Î²0 = E [Î²0 (X)]
                               = lim E [Î²0 (X) Â· 1 (|ï„| ï€¾ ï¨)]
                                 ï¨â†“0
                                       Â£                            Â¤
                               = lim E Xâˆ’1 (Y âˆ’ WÎ´ 0 ) Â· 1 (|ï„| ï€¾ ï¨) ï€»                          (23)
                                   ï¨â†“0


so that Î²0 is identified by the limit of the trimmed mean of Xâˆ’1 (Y âˆ’ WÎ´ 0 ). Trimming elimi-
nates those units with near-singular design matrices (i.e., stayers); by taking limits and exploiting
continuity we avoid changing the estimand.
    Note that if there is a point mass of stayers such that Pr (ï„ = 0) = ï‚¼ 0 ï€¾ 0, then (23) does not
equal Î²0 , instead it equals
                                      Î²ï
                                       0 = E [ Î² 0 (X)| ï„ 6= 0] ï€»

or the movers average partial eï¬€ect (MAPE). Let Î²ï“0 = E [ Î²0 (X)| ï„ = 0] equal the corresponding
stayers average partial eï¬€ect (SAPE). In Section 3 we show how to extend our results to identify
the full average partial eï¬€ect Î²0 = ï‚¼ 0 Î² ï“0 + (1 âˆ’ ï‚¼ 0 ) Î²ï
                                                           0 in this case.
    The following proposition, which is proven in the Appendix as a by-product of the consistency
part of Theorem 2.1 below, summarizes our main identification result.

Proposition 1.2 (Irregular Identification) Suppose that (i) (ï†0 ï€» Î´0 ï€» Î²0 (Â·)) satisfies (9), (ii)
Î£ (x) is positive definite for all x âˆˆ Xï” ï€» (iii) ï” = ï°ï€» and (iv) Assumption 1.2 holds, then Î´ 0 and
Î²0 are identified by, respectively, (18) and (23).


2    Estimation
Our approach to estimation is to replace (18) and (23) with their sample analogs. We begin by
discussing our estimator for the common parameters Î´ 0 ï€º Let ï¨ï denote some bandwidth sequence
such that ï¨ï â†’ 0 as ï â†’ âˆ. We estimate Î´ 0 by the nonparametric conditional linear predictor
fit:
          âˆ™                                  Â¸âˆ’1 âˆ™                                Â¸
     b=         1 Xï                    âˆ—0 âˆ—         1 Xï                    âˆ—0 âˆ—
     Î´                 1 (|ï„ï© | â‰¤ ï¨ï ) Wï© Wï©    Ã—           1 (|ï„ï© | â‰¤ ï¨ï ) Wï© Yï© ï€º             (24)
              ï ï¨ï ï©=1                             ï ï¨ï ï©=1


This estimator has asymptotic properties similar to a standard (uniform) kernel regression fit for a
one-dimensional problem. In particular, in the proof to Lemma A.2 in the Appendix we show that
                                  Â³ Â´   Âµ      Â¶    Âµ Â¶
                                            1        1
                                 V b
                                   Î´ =ï          Ã€ï     ï€»
                                          ï ï¨ï       ï

so that its mean squared error (MSE) rate of convergence is slower than 1ï€½ï when ï¨ï â†’ 0. We
also show that the leading bias term in b
                                        Î´ is quadratic in the bandwidth so that the fastest rate of


                                                 13
               b to Î´ 0 will be achieved when the bandwidth sequence is of the form
convergence of Î´

                                                       ï¨âˆ—ï âˆ ï âˆ’1ï€½5 ï€º
                                                âˆš    Â³       Â´
To center the limiting distribution of                b âˆ’ Î´ 0 at zero we use a bandwidth sequence that
                                                 ï ï¨ï Î´
approaches zero faster than the MSE-optimal one. In particular we assume that (ï ï¨ï )1ï€½2 ï¨2ï â†’ 0
as as ï â†’ âˆ. We discuss our chosen bandwidth sequence in more detail below.
    With b
         Î´ in hand we then estimate Î²0 using the trimmed mean15
                                           Xï                             Â³           Â´
                                     1
                                                   1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1      Yï© âˆ’ Wï©
                                                                                    b
                                                                                    Î´
                                     ï                                 ï©
                               b=
                               Î²               ï©=1
                                                      Xï                                ï€º         (25)
                                                   1
                                                   ï         1 (|ï„ ï© |  ï€¾ ï¨ï )
                                                             ï©=1

                                       b we begin by considering those of the infeasible estimator
To derive the asymptotic properties of Î²
based on the true value of the time eï¬€ects, Î´ 0 :
                                           Xï
                                       1
                                       ï             1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1 ï© (Yï© âˆ’ Wï© Î´ 0 )
                              b =
                              Î²                ï©=1
                                                        Xï                                ï€º       (26)
                                ï‰
                                                     1
                                                     ï         1 (|ï„ ï© |  ï€¾ ï¨ï )
                                                             ï©=1

Like b
     Î´ the variance of Î²b is of order 1ï€½ï ï¨ï , however its asymptotic bias is linear, not quadratic,
                          ï‰
in ï¨ï . The fastest feasible rate of convergence of Î²  b to Î² is consequently slower than the that
                                                        ï‰      0
                                                                                    âˆš    Â³         Â´
   b to Î´ 0 (ï âˆ’2ï€½3 versus ï âˆ’4ï€½5 ). In order to center the limiting distribution of ï ï¨ï Î²
of Î´                                                                                       b âˆ’Î²
                                                                                            ï‰    0

at zero we assume that (ï ï¨ï )1ï€½2 ï¨ï â†’ 0 as as ï â†’ âˆï€º This is stronger than what is needed to
appropriately center the distribution of the aggregate time eï¬€ects. Â³        Â´
                                                            âˆš
    The value of studying the large sample properties of ï ï¨ï Î²       b âˆ’Î²     is that our feasible
                                                                       ï‰   0
                                     b and Î´:
estimator is a linear combination of Î²       b
                                                ï‰
                                                         Â³       Â´
                                               b=Î²
                                               Î² b +Îb ï
                                                          b
                                                          Î´ âˆ’ Î´ 0 ï€»                               (27)
                                                   ï‰


with
                                                     Xï
                                                1
                                                ï           1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1
                                                                             ï© Wï©
                                  bï
                                  Î        =               ï©=1
                                                           Xï                                     (28)
                                                       1
                                                       ï        1 (|ï„ï© | ï€¾ ï¨ï )
                                                                 ï©=1
                                                     Xï
                                                1
                                                ï           1 (|ï„ï© | ï€¾ ï¨ï ) ï„ï©âˆ’1 Wï©âˆ—
                                                           ï©=1
                                           =               Xï                        ï€º
                                                       1
                                                       ï         1 (|ï„ï© | ï€¾ ï¨ï )
                                                                 ï©=1

              b ï‰ and Î´
    Note that Î²       b are respectively computed using the |ï„ï© | ï€¾ ï¨ï and |ï„ï© | â‰¤ ï¨ï subsamples,
so they are conditionally independent given the {Xï© }. This independence exploits the fact that
 15
      The denominator in (25) could be replaced by 1.



                                                                 14
the same bandwidth sequence is used to estimate Î´ b and Î²;
                                                         b it also results from our choice of the
uniform kernel, which has bounded support. We proceed under these maintained assumption,
                                                            b to Î´ 0 is well below its optimal one.
acknowledging that it means that the rate of convergence of Î´
We view the gains from using the same bandwidth sequence for both Î´b and Î²b â€” in terms of simplicity
and transparency of asymptotic analysis â€” as worth the cost in generality.
    Lemma A.3 in the Appendix shows that

                               ï°           Â£                      Â¤
                            bï â†’
                            Î    Î0 â‰¡ lim E 1 (|ï„ï© | ï€¾ ï¨) ï„ï©âˆ’1 Wï©âˆ— ï€º
                                          ï¨â†“0


We therefore recover the limiting distribution of the feasible estimator Î²b from our results on Î² bï‰
    b using a delta method type argument based on (27).
and Î´
   To formalize the above discussion and provide a precise result we require the following additional
assumptions.

Assumption 2.1 (Random Sampling) {(Yï© ï€» Xï© )}ï
                                             ï©=1 are i.i.d. draws from a distribution ï†0
which satisfies condition (9) above.
                                     h                      i
Assumption 2.2 (Bounded Moments) E kXâˆ—ï© Yï© k4 + kXâˆ—ï© Wï© k4 ï€¼ âˆï€º

Assumption 2.3 (Smoothness) Î²0 (ïµ)ï€» ïƒ(ïµ), E [ Wâˆ— | ï„ = ïµ] ï€» E [ Wâˆ—0 Wâˆ— | ï„ = ïµ], E [ Xâˆ— Î£ (X) Xâˆ—0 | ï„ = ïµ] ï€»
and ï­ï² (ïµ) = E [ kXâˆ—ï© Yï© kï² + kXâˆ—ï© Wï© kï² | ï„ = ïµ] exist and are twice continuously diï¬€erentiable for ïµ
in a neighborhood of zero and 0 â‰¤ ï² â‰¤ 4.

Assumption 2.4 (Local Identification) E [ Xâˆ— Î£ (X) Xâˆ—0 | ï„ = 0] is positive definite.

Assumption 2.5 (Bandwidth) As ï â†’ âˆ we have ï¨ï â†’ 0 such that ï ï¨ï â†’ âˆ and
(ï ï¨ï )1ï€½2 ï¨ï â†’ 0.

    Assumption 2.1 is a standard random sampling assumption. Our methods could be extended
to consider other sampling schemes in the usual way. Assumptions 2.2 and 2.3 are regularity
conditions that allow for the application of Liapunovâ€™s central limit theorem for triangular
                                                                                          Â³ arraysÂ´
                                                                                   âˆš
(e.g., Serfling, 1980). Assumption 2.5 is a bandwidth condition which ensures that ï ï¨ï Î²  b âˆ’ Î²0
is asymptotically centered at zero with a finite variance as discussed below.
    The smoothness imposed by Assumption 2.3 can be restrictive. For example if ï” = ï° = 2 with
Xï´ = (1ï€» ï˜ï´ )0 and ï˜1 and ï˜2 independent exponential random variables with parameter 1ï€½ï‚¸, then
ï„ = âˆ†ï˜ will be a Laplace(0ï€» ï‚¸) random variable (the density of which is non-diï¬€erentiable at zero).
Non-diï¬€erentiablility of the density of ï„ at ï„ = 0 will prevent us from consistently estimating the
common time eï¬€ects, Î´ (and, consequently, also Î²0 ). To gauge the restrictiveness of Assumption 2.3
note that twice continuous diï¬€erentiability is required for nonparametric kernel estimation of, for
example, ïƒ(ïµ) and E [ Wâˆ— | ï„ = ïµ], and is, consequently, a standard assumption in the literature on
nonparametric density and conditional moment estimation (e.g., Pagan and Ullah, 1999; Chapters
2, 3).

                                                 15
Theorem 2.1 (Large Sample Distribution) Suppose that (i) (ï†0 ï€» Î´ 0 ï€» Î²0 (Â·)) satisfies (9), (ii)
Î£ (x) is positive definite for all x âˆˆ Xï” ï€» (iii) ï” = ï°ï€» and (iv) Assumptions 1.2 to 2.5 hold, then
b  ï°         bâ†’ ï°
Î´ â†’ Î´ 0 and Î²     Î²0 with the normal limiting distribution
                     Ãƒ            !                                Ãƒ                 Î›0 Î00
                                                                                                   !
             p           b âˆ’ Î´0
                         Î´            ï„
                                                                        Î›0
                                                                        2ïƒ0           2ïƒ0
              ïï¨ï                     â†’ N (0ï€» â„¦0 ) ï€»        â„¦0 =                          Î Î› Î0
                         b âˆ’ Î²0
                         Î²                                             Î0 Î›0
                                                                               2Î¥0 ïƒ0 + 02ïƒ0 0
                                                                        2ïƒ0                  0


   where
              Â£       Â¯      Â¤âˆ’1 Â£ âˆ—0 âˆ—               Â¯     Â¤ Â£     Â¯      Â¤âˆ’1
        Î›0 = E Wâˆ—0 Wâˆ— Â¯ ï„ = 0   E W X Î£ (X) Xâˆ—0 Wâˆ— Â¯ ï„ = 0 E Wâˆ—0 Wâˆ— Â¯ ï„ = 0
                                    Â£             Â¯      Â¤
                              Î¥0 = E Xâˆ— Î£ (X) Xâˆ—0 Â¯ ï„ = 0 ï€º

     We comment that, in contrast to the irregularly identified semiparametric models discussed in
Heckman (1990), Andrews and Schafgans (1998), and Khan and Tamer (2009), the rate of conver-
gence for our estimator does not depend on delicate â€˜relative tail conditionsâ€™. Our identification
approach is distinct from the type of â€˜identification and infinityâ€™ arguments introduced by Cham-
berlain (1986) and leads to a somewhat simpler asymptotic analysis.
     It is instructive to compare the asymptotic variances given in Theorem 2.1 with Chamberlainâ€™s
regular counterparts (given in (14) and (15) above). First consider the asymptotic variance of b        Î´.
In our setup Wâˆ— plays a role analogous to the generalized within-group transformation of W used
by Chamberlain (i.e., WÎ¦ = ïÎ¦ (X) W). Viewed in this light the form of Î›0 is similar to that of
I (Î´ 0 )âˆ’1 in the regular case. The key diï¬€erence is that (i) the expectations in Î›0 are conditional on
ï„ = 0 (i.e., averages over the subpopulation of stayers) and (ii) the variance of b     Î´ varies inversely
                                                                              b
with ïƒ0 . The greater the density of stayers, the easier it is to estimate Î´. We comment that we
could estimate b  Î´ more precisely if we replaced (24) with a weighted least squares estimator. We do
not pursue this idea here as it would require pilot estimation of Î£ (X), a high dimensional object,
and hence is unlikely to be useful in practice.
     The asymptotic                 b
                        variance of Î²                                    âˆ’1
                hÂ¡              Â¢   i also parallels the form of I (Î² 0 ) . The first term, 2Î¥0 ïƒ0 , plays
                                 âˆ’1
the role of E X0 Î£âˆ’1 (X) X            in (15). This term corresponds to the average of the conditional
sampling variances of the unit specific slope estimates. The â€˜betterâ€™ the typical unit-specific design
matrix, the greater the precision of the average Î².   b In the irregular case 2Î¥0 ïƒ captures a similar
                                                                                     0
eï¬€ect. There the average is conditional on ï„ = 0ï€º In contrast to the aggregate time eï¬€ects, the
first term in the variance of Î² b varies linearly with ïƒ ; suggesting that a small density of stayers is
                                                          0
better for estimation of Î²0 ï€º
     The second term in Î²â€™s  b variance is analogous to the ï‹I (Î´ 0 )âˆ’1 ï‹ 0 term in (15). This term
captures the eï¬€ect of sampling variation in Î´    b on that of Î².
                                                               b Note that ï‹ is equal to the average
of the ï° Ã— ï± matrix of coeï¬ƒcients associated with the unit-specific GLS fit of the ï± Ã— 1 vector Wï´
given the ï° Ã— 1 vector of regressors Xï´ . It is instructive to consider an example where there is
                                                                          Â¡          Â¢0
no asymptotic penalty associated with not knowing Î´ 0 ï€º Let W = 0ï” âˆ’1 ï€» ï‰ï” âˆ’1 and Xï´ = (1ï€» ï˜ï´ )0
with ï˜ï´ scalar such that ï° = 2 and Î´ 0 corresponds to a ï± = ï” âˆ’ 1 vector of time-specific intercept


                                                       16
shifts. If the distribution of ï˜ï´ is stationary over time, then realizations of ï˜ï´ cannot be used to
predict the time period dummies. In that case each column of ï‹ will consist of a vector of zeros
with the exception of the first element (which will equal 1ï€½ï” ) . The lower-right-hand element of
ï‹I (Î´ 0 )âˆ’1 ï‹ 0 will equal zero so that ignorance of Î´ 0 does not aï¬€ect the precision which which the
second component of Î²0 , corresponding to the average slope, may be estimated.16
    Now consider the irregular case where ï” = ï° = 2. We have
                                             "                      Ãƒ         !#
                                                           1            âˆ’ï˜1
                                  Î0 = lim E 1 (|âˆ†ï˜| ï€¾ ï¨)                           ï€»
                                       ï¨â†“0                âˆ†ï˜             1

so that the lower-right-hand element of Î0 Î›0 Î00 will equal zero if lim E [1 (|âˆ†ï˜| ï€¾ ï¨) ï€½âˆ†ï˜] = 0.
                                                                              ï¨â†“0
This condition will hold if, for example, ï˜1 and ï˜2 are exchangeable, so that âˆ†ï˜ is symmetrically
distributed about zero (at least for |âˆ†ï˜| in a neighborhood of zero). This will ensure the asymptotic
equivalence of the feasible estimator ï‚¯b and its infeasible counterpart ï‚¯
                                                                        bï‰ .
    Chamberlainâ€™s variance bound for Î²0 contains a third term the analog of which is not present
in the irregular case. This term, V (Î²0 (X)), captures the eï¬€ect of heterogeneity in the conditional
average of the random coeï¬ƒcients on the asymptotic variance of ï‚¯.    b In the irregular case a term
equal to V (Î² 0 (X)) ï€½ï also enters the expression for the sampling variance of ï‚¯  b (see the calcula-
tions immediately prior to Equation (45) in the Appendix). However this term is asymptotically
dominated by the two terms listed in Theorem 2.1 (which are of order 1ï€½ï ï¨ï ). The variance
estimator described in Theorem 2.2 below implicitly accounts for this asymptotically dominated
component.
    The conditions of Theorem 2.1 place only weak restrictions on the bandwidth sequence. As
is common in the semiparametric literature we deal with bias by undersmoothing. The appendix
shows that the fastest rate of convergence of Î²  b for Î² in mean square is achieved by bandwidth
                                                         0
sequences of the form,
                                           ï¨âˆ—ï = ïƒ0 ï âˆ’1ï€½3 ï€»

where the mean squared error minimizing choice of constant is
                         Âµ        Â¶1ï€½3 Â½h                        âˆ™               Â¸Â¾
                     1       1           Â¡      ï“
                                                  Â¢Â¡      Â¢ iâˆ’1
                                                        ï“ 0             Î0 Î›0 Î00 1ï€½3
                ïƒ0 =                      Î²0 âˆ’ Î²0 Î²0 âˆ’ Î²0       Ã— 2Î¥0 +               ï€»                      (29)
                     2       ïƒ0                                           2ïƒ20

and Î²ï“0 = E [ Î²0 (X)| ï„ = 0] equals the average of the random coeï¬ƒcients in the subpopulation
of stayers. While the bandwidth sequence ï¨âˆ—ï achieves the fastest rate of convergence for our
estimator, the corresponding asymptotic normal distribution for ï‚¯(ï¨b âˆ— ) will be centered at a bias
                                                                       ï
          Â¡        Â¢
term of 2 Î²0 âˆ’ Î²ï“0 ïƒ0 ï€º To eliminate this bias Assumption 2.5 requires that ï¨ï â†’ 0 fast enough
such that (ï ï¨ï )1ï€½2 ï¨ï â†’ 0 as ï â†’ âˆ, but slow enough such that (ï ï¨ï )1ï€½2 â†’ âˆ. A bandwidth
sequence which converges to zero slightly faster than ï¨âˆ—ï is suï¬ƒcient for this purpose. In particular
  16
   Sampling error in the estimated time eï¬€ects does aï¬€ect the precision with which the common intercept, the first
component of ï‚¯0 ï€» may be estimated



                                                       17
if
                                           ï¨ï = ï¯(ï âˆ’1ï€½3 )ï€»
     âˆš       Â³         Â´
then ïï¨ï Î²     b âˆ’ Î² will be asymptotically centered at zero.
                     0
    An alternative to undersmoothing would be to use a plug in bandwidth based on a consistent
                       b Such an approach is taken by Horowitz (1992) in the context of smoothed
estimate of (29), say ïƒ.
maximum score estimation. Denote the resulting estimate by Î²  b (PI for â€˜plug inâ€™). Let Î²b be the
                                                               PI
                                                         ï“
consistent undersmoothed estimate of Theorem 2.1 and Î²  b and ïƒ b estimates of Î²ï“ and ïƒ . The
                                                                  0               0       0
bias corrected estimate is then
                                          Â³      Â´
                                 b =Î²
                                 Î²    b âˆ’2 Î²   bï“ ïƒ
                                            b âˆ’Î²   b ïƒï
                                                      b âˆ’1ï€½3 ï€º
                                   BC  PI           0


Unlike undersmoothing, this does not slow down the rate of convergence of Î²    b
                                                                                 BC to Î² 0 . A dis-
advantage is that it is more computationally demanding. In the empirical application below we
experiment with a number of bandwidth values. A more systematic analysis of bandwidth selection,
while beyond the scope of this paper, would be an interesting topic for further research.

Computation and consistent variance estimation: The computation of b            Î´ and Î²b is facilitated
by observing that the solutions to (24) and (25) above coincide with those of the linear instrumental
variables fit                  âˆ™ X              Â¸âˆ’1 âˆ™ X                Â¸
                           b      1     ï    0          1     ï    0 âˆ—
                           Î¸=              Q Rï©     Ã—            QY ï€»
                                 ï      ï©=1 ï©           ï     ï©=1 ï© ï©
        Â¡       Â¢0
for Î¸ = Î´ 0 ï€» Î²0 and
            Âµ                                       Â¶
              âˆ’1                âˆ— 1 (|ï„ï© | ï€¾ ï¨ï )
       Qï© = ï¨ï 1 (|ï„ï© | â‰¤ ï¨ï ) Wï© ï€»               ï‰ï° ï€»         Rï© = (Wï©âˆ— ï€» 1 (|ï„ï© | ï€¾ ï¨ï ) ï„ï© ï‰ï° ) ï€»
     ï” Ã—ï±+ï°                            ï„ï©                     ï” Ã—ï±+ï°


where the dependence of Qï© and Rï© on ï¨ï is suppressed.
                                             b when the bandwidth is held fixed at ï¨; then, by
   Let Î¸ (ï¨) denote the probability limit of Î¸
standard GMM arguments,
                     âˆ™              Â¸âˆ’1 âˆ™ X               Â¸ âˆ™ X        Â¸âˆ’1
                         1 Xï            ï¨ ï   0 b + b +0    1 ï
          ï–b (ï¨) =              0
                               Q Rï©    Ã—      Q U Uï© Qï© Ã—          0
                                                                  Q Rï©                                 (30)
                         ï  ï©=1 ï©        ï ï©=1 ï© ï©           ï ï©=1 ï©

                                                           âˆš  Â³          Â´
is a consistent estimate of the asymptotic covariance of    ïï¨ Î¸b âˆ’ Î¸ (ï¨) with

                                                         b
                                          b + = Yï©âˆ— âˆ’ Rï© Î¸ï€º
                                          U ï©


Conveniently, this covariance estimator remains valid when, as is required by Theorem 2.1, the
bandwidth shrinks with ï .
                                                                      h                    i
Theorem 2.2 Suppose the hypotheses of Theorem 2.1 hold, and that E kXâˆ—ï© Yï© k8 + kXâˆ—ï© Wï© k8 ï€¼


                                                  18
                                                               ï°
âˆ and that Assumption 2.3 holds for ï² â‰¤ 8ï€º Then ï–bï â‰¡ ï–b (ï¨ï ) â†’ â„¦0 .

    Relative to a direct estimate of â„¦0 , (30) implicitly includes estimates of terms that, while asymp-
totically negligible, may be sizeable in small samples. Consequently confidence intervals constructed
using it may have superior properties (cf., Newey, 1994b; Graham, Imbens and Ridder, 2009).
    Operationally estimation and inference may proceed as follows. Let Yï©ï´     âˆ— ï€» R and Q denote the
                                                                                    ï©ï´      ï©ï´
 ï´ï¨
ï´ rows of their corresponding matrices. Using standard software compute the linear instrumental
                   âˆ— onto R using Q as the instrument (exclude the default constant term from
variables fit of Yï©ï´         ï©ï´         ï©ï´
this calculation). By Theorem 2.2 the â€˜robust/clusteredâ€™ (at the unit-level) standard errors reported
by the program will be asymptotically valid under the conditions of Theorem 2.1.


3         Extensions
In this section we briefly develop three direct extensions of our basic results. In Section 5 we discuss
other possible generalizations and avenues for future research.

3.1         Linear functions of Î²0 (X)
In some applications the elements of Xï´ may be functionally related. For example
                                                 Â³                           Â´0
                                             Xï´ = 1ï€» ï’ï´ ï€» ï’ï´2 ï€» ï€º ï€º ï€º ï€» ï’ï´ï°âˆ’1 ï€º                    (31)

In such settings Î²0 indexes the average structural function (ASF) of Blundell and Powell (2003).
To emphasize the functional dependence write Xï´ = xï´ (ï’ï´ ), then

                                               ï§ï´ (ï‚¿ ) = xï´ (ï‚¿ )0 (Î²0 + Î´ 0ï´ ) ï€»

gives the expected period ï´ outcome if (i) a unit is drawn at random from the (cross sectional)
population and (ii) she is exogenously assigned input level ï’ï´ = ï‚¿ . Similarly, diï¬€erences of the
form
                                           Â¡ Â¢
                                        ï§ï´ ï‚¿ 0 âˆ’ ï§ï´ (ï‚¿ ) ï€»

give the average period ï´ outcome diï¬€erence across two counterfactual policies: one where all units
are exogenously assigned input level ï’ï´ = ï‚¿ 0 and another where they are assigned ï’ï´ = ï‚¿ . Since it
is a linear function of Î²0 and Î´ 0ï´ Theorem 2.1 can be used to conduct inference on ï§ï´ (ï‚¿ ).
    In the presence of functional dependence across the elements of Xï´ the derivative of ï§ï´ (ï‚¿ ) with
respect to ï‚¿ does not correspond to an average partial eï¬€ect (APE).17 Instead such derivatives
characterize the local curvature of the ASF. In such settings the average eï¬€ect of a population-wide
    17
         We thank a referee for several helpful comments on this point.




                                                              19
unit increase in ï’ï´ (i.e., the APE) is instead given by
                                 âˆ™                   Â¸         âˆ™Âµ                Â¶0              Â¸
                       ï¤ï¥ï¦ ï€ï™ï´ (xï´ (ï²ï´ ))                            ï€xï´ (ï²ï´ )
                Î³ 0ï´   â‰¡ E                               = E                          ï¢ï´ (ïï€» ï•ï´ )                (32)
                                ï€ï²ï´                                    ï€ï²ï´
                                                               âˆ™Âµ                Â¶0                         Â¸
                                                                     ï€xï´ (ï²ï´ )
                                                         = E                          (Î²0 (xï´ (ï’ï´ )) + Î´0ï´ ) ï€»
                                                                       ï€ï²ï´

where the second equality follows from iterated expectations and Assumption 1.1. Because ï€xï´ (ï’ï´ ) ï€½ï€ï²ï´
may covary with Î² 0 (xï´ (ï’ï´ )) Theorem 2.1 cannot be directly applied to conduct inference on Î³ 0ï´ .
Fortunately it is straightforward to extend our methods to identify and consistently estimate pa-
rameters of the form

                                           Î³ 0ï´ = E [Î  (X) (Î²0 (X) + Î´ 0ï´ )]
                                                    = Î³ 0 + E [Î  (X)] Î´ 0ï´ ï€»

where Î  (x) is a known function of x and Î³ 0 = E [Î  (X) Î²0 (X)] ï€º If Xï´ is given by (31), for example,
then to estimate the APE we would choose

                                           ï€xï´ (ï²ï´ ) Â³                                      Â´
                             Î  (x) =                = 0ï€» 1ï€» 2ï²ï´ ï€» 3ï²ï´2 ï€º ï€º ï€º ï€» (ï° âˆ’ 1) ï²ï´ï°âˆ’2 ï€º
                                             ï€ï²ï´

   In order to estimate Î³ 0ï´ we proceed as follows. First, identification and estimation of Î´ 0 is
unaï¬€ected. Second, using (20) gives for any x with ï¤ =
                                                     6 0
                                                      Â£               Â¯      Â¤
                                     Î³ 0 (x) = Î  (x) E Xâˆ’1 (Y âˆ’ WÎ´ 0 )Â¯ X = x ï€»

so that
                                        Â£                                   Â¤
                             Î³ 0 = lim E Î  (X) Xâˆ’1 (Y âˆ’ WÎ´ 0 ) Â· 1 (|ï„| ï€¾ ï¨) ï€º
                                         ï¨â†“0

This suggests the analog estimator
                                         Xï                                      Â³          Â´
                                     1
                                                   1 (|ï„ï© | ï€¾ ï¨ï ) Î  (Xï© ) Xâˆ’1    Yï© âˆ’ Wï©
                                                                                          b
                                                                                          Î´
                                     ï         ï©=1                           ï©
                             b=
                             Î³                            Xï                                  ï€º
                                                       1
                                                       ï         1 (|ï„ï© | ï€¾ ï¨ ï )
                                                             ï©=1

   An argument essentially identical to that justifying Theorem 2.1 then gives
                             Ãƒ                 !         â› â›                                             ââ
                                                                                    Î›0 Î0Î ï€»0
               p                 b
                                 Î´ âˆ’ Î´0            ï„
                                                                     Î›0
                ï ï¨ï                               â†’ N â0ï€» â        2ïƒ0
                                                                   ÎÎ ï€»0 Î›0
                                                                                      2ïƒ0
                                                                                         ÎÎ ï€»0 Î›0 Î0Î ï€»0
                                                                                                         â â  ï€»    (33)
                                 b âˆ’ Î³0
                                 Î³                                           2Î¥Î ï€»0 ïƒ0 +
                                                                    2ïƒ0                      2ïƒ0


with
                                          Â£                         Â¯      Â¤
                                 Î¥Î ï€»0 = E Î  (X) Xâˆ— Î£ (X) Xâˆ—0 Î  (X)0 Â¯ ï„ = 0
                                             Â£                         Â¤
                                 ÎÎ ï€»0 = lim E 1 (|ï„| ï€¾ ï¨) Î  (X) Xâˆ’1 W ï€º
                                                   ï¨â†“0


                                                               20
   We can then estimate Î³ 0ï´ by
                                            bï´ = Î³
                                            Î³      bb
                                                 b+Î Î´ï€»

with Î b = Pï Î  (Xï© ) ï€½ï . To conduct inference on Î³ 0ï´ we use the delta method treating Î  b as
              ï©=1
known. We may ignore the eï¬€ects of sampling variability in Î b since its rate of convergence to
E [Î  (X)] is 1ï€½ïï€º

3.2   Density of ï„ has a point mass at ï„ = 0
                                                                                  ï¤ï¥ï¦
In some settings a positive fraction of the population may be stayers such that ï‚¼ 0 â‰¡ Pr (ï„ = 0) ï€¾ 0ï€º
This may occur even if all elements of ï˜ï´ are continuously-valued. If the only continuous component
of Xï´ is the logarithm of annual earnings, for example, a positive fraction of individuals may have
the same earnings level in each sampled period. This may be especially true if many workers are
salaried.
    A point mass at ï„ = 0 simplifies estimation of Î´ 0 and complicates that of Î² 0 . When ï‚¼ 0 ï€¾ 0
the estimator
                   âˆ™                           Â¸âˆ’1 âˆ™ X                     Â¸
              b=       1 Xï               âˆ—0 âˆ—      1 ï               âˆ—0 âˆ—
              Î´               1 (ï„ï© = 0) Wï© Wï©    Ã—       1 (ï„ï© = 0) Wï© Yï© ï€»
                       ï  ï©=1                       ï ï©=1

        âˆš
will be ï -consistent and asymptotically normal for Î´,b as would be the (asymptotically equivalent)
estimator described in Section 2 above.
    The large sample properties of the infeasible estimator Î²b ï‰ â€” see equation (26) â€” are unaï¬€ected
by the point mass at ï„ = 0 with two important exceptions. First its probability limit is no longer
Î²0 ï€» the (full population) average partial eï¬€ect, but Î²ï 0 = E [ Î² 0 (X)| ï„ 6= 0], the moversâ€™ APE
introduced in Section 1. Second, its asymptotic
                                         Â³         variance
                                                    Â´       Â³is scaled Â´up by 1 âˆ’ ï‚¼ 0 , the population
                                  âˆš                    ï„
                                           b
proportion of movers. This gives ï ï¨ï Î²ï‰ âˆ’ Î²0 â†’ N 0ï€» 2Î¥
                                                  ï                 0 ïƒ0
                                                                  1âˆ’ï‚¼ 0 ï€º
                                      b ï equal the feasible estimator defined by (25). Using
   Reflecting the change of plims let Î²
decomposition (27) we have
               p    Â³ ï     Â´   p     Â³          Â´     p     Â³        Â´
                     b âˆ’ Î²ï
                ï ï¨ï Î²        =  ï ï¨ï  Î²b ï‰ âˆ’ Î²ï + Î
                                                   b ï  ïï¨ ï
                                                              b
                                                              Î´ âˆ’ Î´ 0
                          0                    0
                                p     Â³          Â´       Â³p Â´
                              =  ï ï¨ï Î² b âˆ’ Î²ï + Î0 ïï°     ï¨ï
                                          ï‰    0
                                p     Â³          Â´
                              =  ï ï¨ï Î² b âˆ’ Î²ï + ï¯ï° (1) ï€»
                                          ï‰    0


                                   b ï are unaï¬€ected by those of b
so that the sampling properties of Î²                             Î´ï€º In particular, adapting the
argument used to show Theorem 2.1 yields

                              p    Â³ ï     Â´     Âµ          Â¶
                                    b âˆ’ Î²ï â†’ ï„       2Î¥0 ïƒ0
                               ï ï¨ï Î²    0     N  0ï€»          ï€º
                                                     1 âˆ’ ï‚¼0




                                                 21
      If a consistent estimator of the stayers eï¬€ect

                                                 Î²ï“0 â‰¡ E[ Î² 0 (X)| ï„ 6= 0]

can be constructed, a corresponding consistent estimator of the APE Î²0 = ï‚¼ 0 Î²ï“0 + (1 âˆ’ ï‚¼ 0 )Î²ï“0
would be
                                         bâ‰¡ï‚¼
                                         Î²     b ï“ + (1 âˆ’ ï‚¼
                                              bÎ²          b)Î²bï ï€»
           P                             âˆš
      bâ‰¡ ï
where ï‚¼        ï‚¶=1 1(|ï„ï© | â‰¤ ï¨ï )ï€½ï is a   ï -consistent estimator for ï‚¼ 0 ï€º
   Inspection of the equation immediately preceding (17) in Section 1 suggests one possible esti-
mator for Î²ï“0 ï€º We have
                                    E [ Yâˆ— | X] = Wâˆ— Î´ 0 +ï„Î²0 (X) ï€»

so that
                                                   E [ Yâˆ— | ï„ = ï¨] âˆ’ E [ Yâˆ— | ï„ = 0]
                                    Î²ï“0 = lim                                        ï€»
                                             ï¨â†“0                   ï¨
which suggests the estimator
            Ãƒ         !               ï
                 Î´                    X                    Â¡                 Â¢0 Â¡              Â¢
                  ï“       = arg min         1 (|ï„ï© | â‰¤ ï¨ï ) Yï©âˆ— âˆ’ Wï©âˆ— Î´âˆ’ï„ï© Î²ï“ Yï©âˆ— âˆ’ Wï©âˆ— Î´âˆ’ï„ï© Î²ï“ ï€»
                b
                Î²            ï‚±ï€»ï‚¯ï“     ï©=1

                       âˆš
with Î´ an alternative ï-consistent estimator for Î´0 . Since the rate of convergence of a nonpara-
metric estimator of the derivative of a regression function is lower than for its level, the rate of
convergence of the combined estimator Î²  b â‰¡ï‚¼  b ï“ + (1 âˆ’ ï‚¼
                                              bÎ²            b ï will coincide with that of Î²
                                                          b)Î²                               b ï“ ï€» and
the asymptotic distribution of the latter would dominate the asymptotic distribution of Î²  b in this
setting. We comment that part (iii) of assumption 1.2 may be less plausible in settings where
Pr (ï„ = 0) ï€¾ 0ï€º18 It such settings â€˜stayersâ€™ may be very diï¬€erent from â€˜near stayersâ€™ such that a
                                               b ï“ would be problematic.
local linear regression approach to estimating Î²

3.3      Overidentification (ï” ï€¾ ï°)
                                                           âˆš
When ï” ï€¾ ï° the vector of common parameters Î´ 0 may be ï consistently estimated, as first
suggested by Chamberlain (1992), by the sample counterpart of (11) above:
                                "ï
                                                         #âˆ’1      "ï
                                                                                   #
                            b  1 X 0       âˆ’1                    1 X 0
                            Î´=     WÎ¦ï© Î¦ï© WÎ¦ï©                  Ã—     WÎ¦ï© Î¦ï© (X) YÎ¦ï© ï€»
                               ï                                 ï
                                      ï©=1                             ï©=1

with Î¦ï© â‰¡ Î¦(Xï© ) positive definite with probability one.
    The discussion in Section 1, however, suggests that Chamberlainâ€™s (1992) proposed estimate of
Î²0 , the sample average of

                                      b ï© â‰¡ (X0 Î¦âˆ’1 Xï© )âˆ’1 X0 Î¦âˆ’1 (Yï© âˆ’ Wï© Î´)ï€»
                                      Î²                                    b
                                              ï© ï©           ï© ï©
 18
      We thank a referee for this observation.


                                                             22
         âˆš
    b a ï -consistent estimator of Î´ 0 , may behave poorly and will be formally inconsistent when
for Î´
I (Î² 0 ) = 0ï€º
    Adapting the trimming scheme introduced for the just identified ï” = ï° case, a natural modifi-
cation of Chamberlainâ€™s (1992) estimator is
                       Pï          0 âˆ’1                 0 âˆ’1     âˆ’1 0 âˆ’1
                        ï©=1 1(det(Xï© Î¦ï© Xï© ) ï€¾ ï¨ï ) Â· (Xï© Î¦ï© Xï© ) Xï© Î¦ï© (Yï©         âˆ’ Wï© b
                                                                                         Î´)
                Î²Ì‚ =                   Pï                                                     ï€º
                                                      0 âˆ’1
                                        ï©=1 1(det(Xï© Î¦ï© Xï© ) ï€¾ ï¨ï )

If                                        âˆ™               Â¸
                                                 1
                                        E                   ï€¼ âˆï€»                                       (34)
                                          det(X0ï© Î¦âˆ’1
                                                   ï© Xï© )

then the introduction of trimming is formally unnecessary but may still be helpful in practice. It
is straightforward to show asymptotic equivalence of the (infeasible) trimmed mean
                       Pï          0 âˆ’1                  0 âˆ’1    âˆ’1 0 âˆ’1
                        ï©=1 1(det(Xï© Î¦ï© Xï© ) ï€¾ ï¨ï ) Â· (Xï© Î¦ï© Xï© ) Xï© Î¦ï© (Yï©         âˆ’ Wï© Î´ 0 )
               Î²Ì‚ =                    Pï                                                        ï€»
                                                       0 âˆ’1
                                         ï©=1 1(det(Xï© Î¦ï© Xï© ) ï€¾ ï¨ï )

with Chamberlainâ€™s (1992) proposal when E[ Î²(X)| det(X0ï© Î¦âˆ’1  ï© Xï© ) â‰¤ ï¨] is smooth (Lipschitz-continuous)
                                               âˆš
in ï¨ï€» condition (34) holds, and ï¨ï = ï¯(1ï€½ ï )ï€º Since ï‚¯Ì‚ will still be consistent for ï‚¯ even when
(34) fails, a feasible version of the trimmed mean ï‚¯Ì‚ may be better behaved in finite samples if the
design matrix (X0ï© Î¦âˆ’1ï© Xï© ) is nearly singular for some observations.



4    Application
In this section we use our methods to estimate an elasticity of calorie demand. Our goal is to
provide a concrete illustration of our methods, to compare them with alternatives which presume
the absence of any nonseparable correlated heterogeneity, and to highlight the practical importance
of trimming.

Model specification: We assume that the logarithm of total household calorie availability per
capita in period ï´, ln (Calï´ ), varies according to

                              ln (Calï´ ) = ï¢1ï´ (ïï€» ï•ï´ ) + ï¢2ï´ (ïï€» ï•ï´ ) ln(Expï´ )ï€»                      (35)

where Expï´ denotes real household expenditure per capita in year ï´ and ï¢1ï´ (ïï€» ï•ï´ ) and ï¢2ï´ (ïï€» ï•ï´ ) are
random coeï¬ƒcients; the latter equals the household-by-period-specific elasticity of calorie demand.
Let ï¢ï´ (ïï€» ï•ï´ ) = (ï¢1ï´ (ïï€» ï•ï´ )ï€» ï¢2ï´ (ïï€» ï•ï´ ))0 ï€» Xï´ = (1ï€» ln(Expï´ ))0 ï€» and ï™ï´ = ln (Calï´ ) with X and Y as
defined above. We allow for common intercept and slope shifts over time (i.e., Assumption 1.1).
The 2000 to 2002 period coincided with a coï¬€ee crisis in Nicaragua, so there is some a priori reason
to believe that macro-shifts in the demand elasticity may be important.




                                                      23
       Defining W as in (8) gives a general semiparametric regression model of

                                         E[Y|Wï€» X] = WÎ´ + XÎ²(X)ï€»

with Î´ containing the common intercept and slope time shifts. The second element of Î²(x) equals
the average (base year) elasticity of calorie demand in the subpopulation of households with X = x
(i.e., a subpopulation with a common income/aggregate expenditure history).
     Relative to prior work, the distinguishing feature of our model is that it allows for the elasticity
of calorie demand to vary across households in a way that may co-vary with total outlay. This
allows household expenditures to co-vary with the unobserved determinants of calorie demand. For
example both expenditures and calorie consumption are likely to depend on labor supply decisions
(cf., Strauss and Thomas, 1990). Allowing the calorie demand curve to vary across households
also provides a â€˜nonparametricâ€™ way to control for diï¬€erences in household composition; a delicate
modelling decision in this context (e.g., Subramanian and Deaton, 1996).19

Data description: We use data collected in conjunction with an external evaluation of the
Nicaraguan conditional cash transfer program Red de ProtecciÃ³n Social (RPS) (see IFPRI, 2005).
The RPS evaluation sample is a panel of 1,581 households from 42 rural communities in the depart-
ments of Madriz and Matagalpa, located in the northern part of the Central Region of Nicaragua.
Each sampled household was first interviewed in August/September 2000 with follow-ups attempted
in October of both 2001 and 2002. Here we analyze a balanced panel of 1,358 households from all
three waves.20
    The survey was fielded using an abbreviated version of the 1998 Nicaraguan Living Standards
Measurement Survey (LSMS) instrument. As such it includes a detailed consumption module with
information on household expenditure, both actual and in kind, on 59 specific foods and several
dozen other common budget items (e.g., housing and utilities, health, education, and household
goods). The responses to these questions were combined to form an annualized consumption ag-
gregate, ïƒï©ï´ . In forming this variable we followed the algorithm outlined by Deaton and Zaidi
(2002).
    In addition to recording food expenditures, actual quantities of foods acquired are available.
Using conversion factors listed in the World Bank (2002) and Instituto Nacional de EstadÃ­sticas y
Censos (2005) (henceforth INEC) we converted all food quantities into grams. We then used the
caloric content and edible percent information in the Instituto de NutriciÃ³n de Centro AmÃ©rica y
  19
     A limitation of our model is its presumption of linearity at the household level. Strauss and Thomas (1990) argue
that the elasticity of demand should structurally decline with household income. As we have three periods of data we
can, in principal, include an additional function of Expï´ in the Xï´ vector. We briefly explore this possibility below.
  20
     A total of 1,359 households were successfully interviewed in all three waves. One of these households reports
zero food expenditures (and hence calorie availability) in one wave and is dropped from our sample. The prepa-
ration of our estimation sample from the raw public release data files involved some complex and laborious data-
processing. We outline the procedures used in this section. A sequence of heavily commented STATA do files, which
read in the IFPRI (2005) release of the data and output a text file of our estimation sample is available online at
https://files.nyu.edu/bsg1/public/



                                                         24
PanamÃ¡ (2000) (henceforth INCAP) food composition tables to construct a measure of daily total
calories available for each household.21 The logarithm of this measure divided by household size,
ï™ï©ï´ , serves as the dependent variable in our analysis.
     The combination of both expenditure and quantity information at the household-level also
allowed us to estimate unit prices for foods. These unit values were used to form a Paasche cost-
of-living index for the ï©ï´ï¨ household in year ï´ of
                             âˆ™ Â½X                     Â³          Â´Â¾                  Â¸âˆ’1
                                  ï†                     ï¢
                        ï‰ï©ï´ = ï“ï©ï´                ï—ï¦ï€»ï©ï´ ïï¦ ï€½ïï¦ï€»ï©ï´    + (1 âˆ’ ï“ï©ï´ ) ïŠï©ï´     ï€»                   (36)
                                          ï¦ =1


where ï“ï©ï´ is the fraction of household spending devoted to food, ï—ï¦ï€»ï©ï´ the share of overall food
spending devoted to the ï¦ ï´ï¨ specific food, ïï¦ï€»ï©ï´ the year ï´ unit price paid by the household for food
ï¦ , and ïï¦ï¢ its â€˜baseâ€™ price (equal to the relevant 2001 sample median price). We use 2001 as our base
year since it facilitates comparison with information from a nationwide LSMS survey fielded that
year. Following the suggestion of Deaton and Zaidi (2002) we replace household-level unit prices
with village medians in order to reduce noise in the price data. In the absence of price information
on nonfood goods we set ïŠï©ï´ equal to one in 2001 and to the national consumer price index (CPI)
in 2000 and 2002. Our independent variable of interest is real per capita consumption in thousands
of Cordobas: Expï©ï´ = ([ïƒï©ï´ ï€½ï‰ï©ï´ ])ï€½ïï©ï´ ; ïï©ï´ is total household size.
     Tables 1 and 2 summarize some key features of our estimation sample. Panel A of Table 1
gives the share of total food spending devoted to each of eleven broad food categories. Spending on
staples (cereals, roots and pulses) accounts for about half of the average householdâ€™s food budget
and over two thirds of its calories (Tables 1 and 2). Among the poorest quartile of households an
average of around 55 percent of budgets are devoted to, and over three quarters of calories available
derived from, staples. Spending on vegetables, fruit, and meat accounts for less than 15 percent of
the average householdâ€™s food budget and less than 3 percent of calories available. That such a large
fraction of calories are derived from staples, while not good dietary practice, is not uncommon in
poor households elsewhere in the developing world (cf., Smith and Subandoro, 2007).
     Panel B of the table lists real annual expenditure in Cordobas per adult equivalent and per
capita. Adult equivalents are defined in terms of age- and gender-specific FAO (2001) recommended
energy intakes for individuals engaging in â€˜light activityâ€™ relative to prime-aged males. As a point
of reference the 2001 average annual expenditure per capita across all of Nicaragua was a nominal
C$7,781, while amongst rural households it was C$5,038 (World Bank. 2003). The 42 communities
in our sample, consistent with their participation in an anti-poverty demonstration experiment, are
considerably poorer than the average Nicaraguan rural community.22
  21
     In forming our measure of calorie availability we followed the general recommendations of Smith and Subandoro
(2007).
  22
     In October of 2001 the Cordoba-to-US$ exchange rate was 13.65. Therefore per capita consumption levels in our
sample averaged less than US$ 300 per year.




                                                         25
           Panel A:                                                          Expenditure Shares (%)
                                                    All                           Lower 25%                            Upper 25%
                                        2000       2001       2002          2000     2001       2002         2000        2001       2002
           Cereals                        49ï€º1       36ï€º0       32ï€º7           53ï€º3      40ï€º9       35ï€º7       45ï€º7        31ï€º6       29ï€º4
           Roots                           1ï€º3        3ï€º1        2ï€º7            1ï€º3       2ï€º6        2ï€º0        1ï€º5         3ï€º6        3ï€º6
           Pulses                         11ï€º6       12ï€º5       13ï€º6           11ï€º2      13ï€º8       16ï€º5       10ï€º6        10ï€º7       11ï€º3
           Vegetables                      3ï€º2        4ï€º9        4ï€º5            2ï€º8       4ï€º3        3ï€º4        3ï€º8         5ï€º8        5ï€º3
           Fruit                           0ï€º6        0ï€º9        1ï€º1            0ï€º5       0ï€º7        0ï€º9        0ï€º8         1ï€º2        1ï€º2
           Meat                            3ï€º1        6ï€º9        7ï€º7            2ï€º2       4ï€º0        5ï€º1        5ï€º3         9ï€º9       10ï€º4
           Dairy                          11ï€º2       14ï€º7       17ï€º3            9ï€º0      12ï€º0       15ï€º0       13ï€º1        16ï€º8       19ï€º2
           Oil                             4ï€º0        5ï€º0        5ï€º0            3ï€º5       5ï€º2        5ï€º0        3ï€º9         4ï€º7        4ï€º7
           Other foods                    15ï€º8       16ï€º0       15ï€º4           16ï€º2      16ï€º7       16ï€º5       15ï€º4        15ï€º7       14ï€º9
           Staplesâ™¦                       62ï€º1       51ï€º6       49ï€º0           65ï€º8      57ï€º3       54ï€º1       57ï€º8        45ï€º9       44ï€º3
           Panel B:                                                     Total Real Expenditure & Calories
           Expenditure per  adultï›       5ï€» 506     4ï€» 679     4ï€» 510       2ï€» 503      2ï€» 397     2ï€» 200     9ï€» 481      7ï€» 578     7ï€» 460
           (Expenditure per capita)    (4ï€» 277)   (3ï€» 764)   (3ï€» 887)     (2ï€» 016)    (2ï€» 130)   (2ï€» 102)   (7ï€» 302)    (5ï€» 845)   (6ï€» 114)
           Food share                      71ï€º2       69ï€º2       68ï€º8         73ï€º8        69ï€º1       68ï€º6       67ï€º0        67ï€º9       67ï€º6
           Calories per adultï›           2ï€» 701     3ï€» 015     2ï€» 948       1ï€» 706      2ï€» 127     2ï€» 013     3ï€» 737      3ï€» 849     3ï€» 758
           (Calories per capita)       (2ï€» 086)   (2ï€» 435)   (2ï€» 529)     (1ï€» 351)    (1ï€» 854)   (1ï€» 873)   (2ï€» 842)    (2ï€» 962)   (3ï€» 041)
           Percent energy deficientïœ       51ï€º0       39ï€º3       39ï€º7         85ï€º0        69ï€º7       76ï€º2       19ï€º8        14ï€º5       13ï€º0

Table 1: Real expenditure food budget shares of RPS households from 2000 to 2002
NOTES: Authorsâ€™ calculations based on a balanced panel of 1,358 households from the RPS evaluation dataset (see IFPRI (2005)). Real
household expenditure equals total annualized nominal outlay divided by a Paasche cost-of-living index. Base prices for the price index
are 2001 sample medians. The nominal exchange rate in October of 2001 was 13.65 Cordobas per US dollar. Total calorie availability
is calculated using the RPS food quantity data and the calorie content and edible portion information contained in INCAP (2000).
Lower and upper 25 percent refers to the bottom and top quartiles of households based on the average of year 2000, 2001 and 2002 real
consumption per adult equivalent and thus contains the same set of households in all three years.
â™¦ Sum of cereal, roots and pulses.
ï› "Adults" correspond to adult equivalents based on FAO (2001) recommended energy requirements for light activity.
ïœ Percentage of households with estimated calorie availability less than FAO (2001) recommendations for light activity given household

demographics.



                                                                          26
                                                 Calorie Shares (%)
                                    All              Lower 25%           Upper 25%
                            2000   2001   2002   2000 2001 2002       2000 2001 2002
              Cereals       57ï€º7   60ï€º3   59ï€º9   60ï€º7   63ï€º9   62ï€º0   55ï€º5   57ï€º1   57ï€º4
              Roots          1ï€º5    1ï€º5    1ï€º6    1ï€º9    1ï€º5    1ï€º2    1ï€º6    1ï€º8    2ï€º1
              Pulses        13ï€º1   11ï€º3   12ï€º8   12ï€º1   11ï€º3   13ï€º3   13ï€º1   11ï€º0   12ï€º1
              Vegetables     0ï€º7    0ï€º7    0ï€º6    0ï€º6    0ï€º6    0ï€º4    0ï€º8    0ï€º9    0ï€º8
              Fruit          0ï€º3    0ï€º5    0ï€º4    0ï€º3    0ï€º3    0ï€º4    0ï€º5    0ï€º7    5ï€º8
              Meat           0ï€º7    1ï€º3    1ï€º3    0ï€º5    0ï€º7    0ï€º7    1ï€º3    1ï€º9    1ï€º9
              Dairy          4ï€º1    4ï€º3    4ï€º5    3ï€º4    3ï€º0    3ï€º4    4ï€º7    5ï€º2    5ï€º5
              Oil            6ï€º9    7ï€º6    7ï€º5    5ï€º8    6ï€º9    6ï€º7    7ï€º4    8ï€º1    8ï€º0
              Other foods   15ï€º0   12ï€º6   11ï€º4   14ï€º7   11ï€º9   11ï€º9   15ï€º2   13ï€º2   11ï€º5
              Staplesâ™¦      72ï€º3   73ï€º1   74ï€º3   74ï€º7   76ï€º7   76ï€º6   70ï€º2   69ï€º9   71ï€º7

Table 2: Calorie shares of RPS households from 2000 to 2002
NOTES: Authorsâ€™ calculations based on a balanced panel of 1,358 households from the RPS
evaluation dataset (see IFPRI (2005)). Total calorie availability is calculated using the RPS food
quantity data and the calorie content and edible portion information contained in INCAP (2000).
Lower and upper 25 percent refers to the bottom and top quartiles of households based on the
average of year 2000, 2001 and 2002 real consumption per adult equivalent and thus contains the
same set of households in all three years.
â™¦ Sum of cereal, roots and pulses.



    Using the FAO (2001) energy intake recommendations for â€˜light activityâ€™ we categorized each
household, on the basis of its demographic structure, as energy deficient or not. By this criterion
approximately 40 percent of households in our sample are energy deficient each period. Amongst
the poorest quartile this fraction rises to over 75 percent. These figures are reported in Panel B of
Table 1.

Results: Table 3 reports our point estimates. Our first estimate corresponds to the pooled
ordinary least squares (OLS) fit of ln (Calï´ ) onto ln (Expï´ ) using all three waves of the RPS data.
Aggregate shifts in the intercept and slope coeï¬ƒcient are included. Also included in the model,
to control for variation in food prices across markets, is a vector of 42 village-specific intercepts.
Variants of this specification are widely employed in empirical work (e.g, Subramanian and Deaton,
1996; Table 2). The pooled OLS calorie elasticities are reported in Column 1. The elasticity
approximately equals 0.7 in 2000 and 0.6 in both 2001 and 2002. All three elasticities are precisely
determined. The estimates are high relative to others in the literature, but realistic given the
extreme poverty of the households in our sample.
    Column 2 augments the first model by allowing the intercept to vary across households. This
â€˜fixed eï¬€ectsâ€™ estimator (FE-OLS) is also widely used in empirical work when panel data are avail-
able (e.g., Behrman and Deolalikar, 1987; Bouis and Haddad, 1992). Allowing for household-specific
intercepts increases the elasticity by about 10 percent in all three years. The standard errors almost
double in size.


                                                 27
                                       Panel A: Calorie Demand Elasticities                Panel B: Sensitivity to Trimming
                             (1)          (2)          (3)          (4)          (5)         (1)         (2)           (3)
                             OLS          FE         R-CRC         MDLK        I-CRC       I-CRC       I-CRC         I-CRC
                            0ï€º6837       0ï€º7550      0ï€º6617       âˆ’0ï€º0133      0ï€º7125     0ï€º6867       0ï€º6352        0ï€º6993
         2000 Elasticity
                           (0ï€º0305)     (0ï€º0441)    (0ï€º0424)      (0ï€º2571)    (0ï€º0763)   (0ï€º0906)     (0ï€º0639)      (0ï€º0522)
                            0ï€º6105       0ï€º6635      0ï€º5861
         2001 Elasticity                                               âˆ’         âˆ’           âˆ’            âˆ’            âˆ’
                           (0ï€º0383)     (0ï€º0608)    (0ï€º0565)
                            0ï€º5959       0ï€º6466      0ï€º5521                    0ï€º5062     0ï€º5299       0ï€º4690        0ï€º5368
         2002 Elasticity                                               âˆ’
                           (0ï€º0245)     (0ï€º0416)    (0ï€º0476)                  (0ï€º0791)   (0ï€º0928)     (0ï€º0583)      (0ï€º0421)
         Percent trimmed      âˆ’            âˆ’           âˆ’                0       6.5          5           10           20
         Time shifters?       Yes         Yes          Yes             No       Yes         Yes          Yes          Yes

Table 3: Estimates of the calorie Engel curve: linear case
NOTES: Estimates based on the balanced panel of 1,358 households described in the main text. "OLS" denotes least squares applied
to the pooled 2000, 2001, and 2002 samples, "FE-OLS" least squares with household-specific intercepts, "R-CRC" Chamberlainâ€™s (1992)
estimator with identity weight matrix, "MDLK" the Mundlak (1961)/Chamberlain (1982) estimator described in the main text, and
"I-CRC" our irregular correlated random coeï¬ƒcients estimator (using the 2000 and 2002 waves only). All models, with the exception of
"MDLK", include common intercept and slope shifts across periods. The standard errors are computed in a way that allows for arbitrary
within-village correlation in disturbances across households and time.




                                                                  28
    In Column 3 we use Chamberlainâ€™s (1992) regular correlated random coeï¬ƒcients (R-CRC)
estimator with an identity weight matrix. Since we have three years of data and only two random
coeï¬ƒcients his methods, at least in principle, apply. The top panel of Figure 1 plots a histogram of
det (X0 X), which shows a reasonable amount of density in the neighborhood of zero. This suggests
that the right-hand-side of (12) may be undefined in the population. In practice the R-CRC
estimator generates â€˜sensibleâ€™ point estimates with estimated standard errors approximately equal
to those of the corresponding FE-OLS estimates. The R-CRC point estimates are smaller than
both the OLS and FE-OLS ones.
    Columns 4 and 5 are based on only the 2000 and 2002 waves of data. By dropping the middle
wave of data we artificially impose that ï” = ï° = 2; this ensures irregularity (Proposition 1.1). The
lower panel of Figure 1 plots a histogram of ï„ = ln(Exp2002 ) âˆ’ ln(Exp2000 ); the figure indicates
a substantial amount of density in the neighborhood of zero. Column 4 reports the â€˜Mundlakâ€™
estimate of the demand elasticity

                                     ï
                                   1 X ln(Cal2002 ) âˆ’ ln(Cal2000 )
                                                                   ï€º
                                   ï   ln(Exp2002 ) âˆ’ ln(Exp2000 )
                                      ï©=1

This average, as expected, is poorly behaved. It implies a nonsensical elasticity estimate with
a very large standard error. Column 5 implements our estimator (I-CRC) with a bandwidth of
ï¨ï = ï£ï„ ï âˆ’1ï€½3 where ï£ï„ = min (ï³ï„ ï€» ï²ï„ ï€½1ï€º34) is a robust estimate of the sample standard deviation
of ï„ (ï³ï„ is the sample standard deviation and ï²ï„ the interquartile range). This implies that we
trim, or categorize as â€˜stayersâ€™, about 7 percent of our sample. The I-CRC point estimate is sensible
and well-determined. While the estimated year 2000 elasticity is close to its OLS counterpart, the
2002 elasticity is 20 percent lower in magnitude. Panel B of the table explores the sensitivity of our
point estimates to trimming. Overall we find that the Column 5 point estimates are insensitive to
modest variations in the bandwidth.

A nonlinear model: As we have three periods of data we can modify our model to allow the
calorie elasticity to vary non-linearly with income. Nonlinearity in the calorie demand curve has
been emphasized by Strauss and Thomas (1990, 1995) and Subramanian and Deaton (1996). We
consider the model

                   ln (Calï´ ) = ï¢1ï´ (ïï€» ï•ï´ ) + ï¢2ï´ (ïï€» ï•ï´ ) ln(Expï´ ) + ï¢3ï´ (ïï€» ï•ï´ )Expâˆ’1
                                                                                       ï´ ï€»


so that a householdâ€™s period-specific demand elasticity is given by ï¢2ï´ (ïï€» ï•ï´ ) âˆ’ ï¢3ï´ (ïï€» ï•ï´ )Expâˆ’1
                                                                                                  ï´ ï€º
We estimate the average of this elasticity in 2000, 2001 and 2002 using the approach outlined in
                                                            Â¡                 Â¢0
Section 3. Figure 2 plots the a histogram of ï„ with Xï´ = 1ï€» ln(Expï´ )ï€» Expâˆ’1
                                                                           ï´     ï€º Because ln(Expï´ )
         âˆ’1
and Expï´ are highly correlated within-units, the density of ï„ is substantial in the neighborhood
of zero.
    Table 4 reports average elasticity estimates based on the extended model. The average elastici-


                                                     29
Figure 1: Histogram of the distribution of det (X0 X) (top panel, ï” = 3ï€» ï° = 2) and ï„ (bottom
panel, ï” = ï° = 2)
Notes: The two vertical blue lines in the lower panel correspond to the portion of the sample that
is trimmed in our preferred estimates (Table 3, Column 5).




Figure 2: Histogram of the distribution of ï„ (ï” = ï° = 3)
Notes: The smallest and largest 10 percent of the ï„ï© â€™s are excluded from the histogram. The
two vertical blue lines correspond to the portion of the sample that is trimmed in our preferred
estimates (Table 4, Column 3).


                                               30
                                          Panel A: Calorie Demand Elasticities
                               (1)           (2)           (3)          (4)         (5)
                               OLS           FE          I-CRC        I-CRC       I-CRC
                              0ï€º6671       0ï€º7385        0ï€º2180       0ï€º1429      0ï€º2319
         2000 Elasticity
                             (0ï€º0262)     (0ï€º0370)      (0ï€º2846)     (0ï€º2872)    (0ï€º2900)
                              0ï€º5992       0ï€º6514        0ï€º8889       0ï€º6150      1ï€º1262
         2001 Elasticity
                             (0ï€º0380)     (0ï€º0584)      (0ï€º6342)     (1ï€º2170)    (0ï€º8696)
                              0ï€º5943       0ï€º6425        0ï€º5570       0ï€º6629      0ï€º4954
         2002 Elasticity
                             (0ï€º0238)     (0ï€º0396)      (0ï€º5739)     (0ï€º3741)    (0ï€º5162)
         Percent trimmed        âˆ’            âˆ’            18.8         15           25
         Time shifters?        Yes          Yes           Yes          Yes          Yes

Table 4: Estimates of the calorie Engel curve: nonlinear case
NOTES: Estimates based on the balanced panel of 1,358 households described in the main text.
"OLS" denotes least squares applied to the pooled 2000, 2001, and 2002 samples, "FE-OLS" least
squares with household-specific intercepts, and "I-CRC" our irregular correlated random coeï¬ƒcients
estimator (now using all three waves). All models include common intercept and slope shifts
across periods. The standard errors are computed in a way that allows for arbitrary within-village
correlation in disturbances across households and time. The average elasticity estimates in the
OLS and FE-OLS columns are computed using the delta method. Those in the I-CRC columns as
described in Section 3.

ties associated with the OLS and FE-OLS parameter estimates of the nonlinear model are virtually
identical to their linear model Table 3 counterparts. Although the coeï¬ƒcients on Expâˆ’1   ï´  and its
interactions with the 2001 and 2002 time dummies are jointly significant in both models (not re-
ported), the eï¬€ect of their inclusion on the average elasticity estimates is negligible. Column 3
reports I-CRC estimates with ï¨ï = ï£ï„ ï âˆ’1ï€½3 (which, given the large density in the neighborhood
of zero, results in the trimming of 20 percent of the sample). In contrast to the linear case, the
I-CRC estimates are imprecisely determined; they are also more sensitive to variations in the band-
width (Columns 3 and 4). We conclude that we are unable to reliably fit the nonlinear CRC model
with the data available.


5    Conclusion
In this paper we have outlined a new estimator for the correlated random coeï¬ƒcients panel data
model. Our estimator is designed for situations where the regularity conditions required for the
method-of-moments procedure of Chamberlain (1992) do not hold. We illustrate the use of our
methods in an exploration of the elasticity of demand for calories in a population of poor Nicaraguan
households. This application is highly irregular, with many â€˜near stayersâ€™ in the sample. This
implies that elasticity estimates based on the textbook FE-OLS estimator may be far from the
relevant population average. We find that our methods work well in this setting, generating point
estimates that are 10 to 20 percent smaller in magnitude that their FE-OLS counterparts (Table
3, Columns 5 versus 2).


                                                   31
    While our procedure is simple to implement, it does require choosing a smoothing parameter.
As in other areas of semiparametric econometrics, our theory places only weak restrictions on this
choice. Developing an automatic, data-based, method of bandwidth selection would be useful.
    Irregularity arises in other fixed eï¬€ects panel data models (e.g., Manski, 1987; HonorÃ© and
Kyriazidou, 1997; Kyriazidou, 1997; Chamberlain 2010). It is an open question as to whether
features of our approach could be extended to more complex nonlinear and/or dynamic panel
data models. In ongoing work we are studying how to extend our methods to estimate quantile
partial eï¬€ects (e.g., unconditional quantiles of the distribution of the random coeï¬ƒcients) and to
accommodate additional â€˜triangular endogeneityâ€™.




                                               32
                                                      Appendix

A      Proofs and derivations
A.1     Proof of Theorem 2.1
                                                                         ï¢ utilizes the decomposition
As noted in the main text our derivation of the limiting distribution of ï‚¯

                                                        ï‚³      ï‚´
                                                ï¢=ï‚¯
                                                ï‚¯ ï¢ +Î   ï¢ âˆ’ ï‚±0 ï€º
                                                      ï¢ï ï‚±                                                    (37)
                                                    ï‰



     ï¢ ,ï¢
with ï‚¯          ï¢
       ï‰ ï‚±, and Îï respectively equal to (26), (24), and (28) of the main text. The proof proceeds in three steps.
                                                                      ï¢ . Second that of the common parameters ï‚±ï€º
First we derive the limiting distribution of the infeasible estimator ï‚¯                                        ï¢
                                                                        ï‰

Third we show that Î                                                                       ï¢ then follows from the
                    ï¢ ï has a well-defined probability limit. The limiting distribution of ï‚¯

delta method and the independence of ï‚¯ï¢ and ï¢ ï‚±.
                                           ï‰


                           b ï‰ : We begin with the infeasible estimator (26) which treats ï‚±0 as known.
Large sample properties of Î²
Recentering (26) yields

                                           ï˜ï                       ï‚¡                         ï‚¢
                                       1
                                       ï
                                                     1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1
                                                                       ï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0
                           ï¢ âˆ’ï‚¯ =
                           ï‚¯                   ï©=1
                                                            ï˜ï                                  ï€º             (38)
                             ï‰ 0
                                                          1
                                                         ï         1 (|ï„ï© | ï€¾ ï¨ï )
                                                                 ï©=1


First consider the expected value of the term entering the summation in the denominator of (38):


                                      E [1 (|ï„ï© | ï€¾ ï¨)]      =     1 âˆ’ Pr{|ï„ï© | â‰¤ ï¨}
                                                                        ïš 1
                                                             =     1âˆ’ï¨      ïƒ (ïµï¨) dïµ
                                                                         âˆ’1
                                                             =     1 âˆ’ 2ï¨ïƒ0 + ï¯(ï¨)                            (39)

                                                             =     1 + ï¯(1)ï€»                                  (40)


where the third equality follows from Assumption 1.2 and the change of variables ïµ = ï´ï€½ï¨ (with Jacobian dï´ï€½dïµ = ï¨)ï€º
    Define ïšïï€»ï© to be the term entering the summation in the numerator of (38):

                                                       ï‚¡                       ï‚¢
                                   ïšïï€»ï© â‰¡ 1 (|ï„ï© | ï€¾ ï¨) Xâˆ’1
                                                         ï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0 ï€º                             (41)


Taking its expectation yields


                                   E [ïšïï€»ï© ]   =      E [1 (|ï„ï© | ï€¾ ï¨) Â· (ï‚¯0 (Xï© ) âˆ’ ï‚¯0 )]                    (42)

                                               =      E [1 (|ï„ï© | â‰¤ ï¨) (ï‚¯0 âˆ’ ï‚¯0 (ï„ï© ))]
                                                      ïš ï¨
                                               =          (ï‚¯0 âˆ’ ï‚¯0 (ï´))ïƒ (ï´) dï´
                                                       âˆ’ï¨
                                                       ï‚³           ï‚´
                                               =      2 ï‚¯0 âˆ’ ï‚¯ï“   0 ïƒ0 ï¨ + ï¯ (ï¨) ï€»



where ï‚¯ï“
       0 â‰¡ ï‚¯ 0 (0), again using Assumption 1.2.




                                                              33
     Turning to the variance of ïšïï€»ï© we use the ANOVA decomposition


                                             V (ïšïï€»ï© ) = V (E [ ïšïï€»ï© | ï„ï© ]) + E [V ( ïšïï€»ï© | ï„ï© )] ï€º                           (43)


The first term in (43) equals

                                                                   ï‚£                                ï‚¤
                                        V (E [ ïšïï€»ï© | ï„ï© ])   =   E 1 (|ï„ï© | â‰¤ ï¨) (ï‚¯0 (ï„ï© ) âˆ’ ï‚¯0 )2

                                                              =   V (ï‚¯0 (ï„ï© )) + ï¯ (1) ï€º


Now consider V ( ïšïï€»ï© | ï„ï© ); using (42) above and recalling the equality Xâˆ’1 =                  1
                                                                                                 ï„X
                                                                                                   âˆ—
                                                                                                       when |ï„| ï€¾ 0, we have

                                                                       ï‚©                                       ï‚ª
                          ïšïï€»ï© âˆ’ E [ ïšïï€»ï© | ï„ï© ]    =    1 (|ï„ï© | ï€¾ ï¨) Xâˆ’1ï© (Yï© âˆ’ Wï© ï‚±) âˆ’ ï‚¯âˆ’ (ï‚¯ 0 (ï„ï© ) âˆ’ ï‚¯ 0 )
                                                         1 (|ï„ï© | ï€¾ ï¨)
                                                    =                  {Yï©âˆ— âˆ’ Wï©âˆ— ï‚± âˆ’ ï„ï© ï‚¯0 (ï„ï© )}
                                                              ï„ï©
                                                         1 (|ï„ï© | ï€¾ ï¨) âˆ—
                                                    =                  Xï© (Yï© âˆ’ Wï© ï‚± âˆ’ Xï© ï‚¯0 (ï„ï© )) ï€º
                                                              ï„ï©

Again defining


                                     Uï©     â‰¡      Yï© âˆ’ Wï© ï‚± âˆ’ Xï© ï‚¯0 (Xï© )

                                            =      Yï© âˆ’ Wï© ï‚± âˆ’ Xï© ï‚¯0 (ï„ï© ) + Xï© (ï‚¯0 (Xï© ) âˆ’ ï‚¯0 (ï„ï© ))ï€»


it follows from iterated expectations that

                          1 (|ï„ï© | ï€¾ ï¨ï ) ï‚£ âˆ—                                                          ï‚¯ ï‚¤
V ( ïšïï€»ï© | ï„ï© )       =                  E Xï© (Yï© âˆ’ Wï© ï‚± âˆ’ Xï© ï‚¯0 (ï„ï© )) (Yï© âˆ’ Wï© ï‚± âˆ’ Xï© ï‚¯0 (ï„ï© ))0 Xâˆ—0 ï‚¯
                                                                                                      ï© ï„ï©
                                   2
                               ï„ï©
                          1 (|ï„ï© | ï€¾ ï¨ï ) ï‚£ âˆ—             ï‚¯ ï‚¤                   ï‚£                                           ï‚¯ ï‚¤
                      =                  E Xï© Î£ (Xï© ) Xâˆ—0 ï‚¯                                                                0ï‚¯
                                                       ï© ï„ï© + 1 (|ï„ï© | ï€¾ ï¨ï ) E (ï‚¯ (Xï© ) âˆ’ ï‚¯ 0 (ï„ï© )) (ï‚¯ (Xï© ) âˆ’ ï‚¯ 0 (ï„ï© )) ï„ï©
                                   2
                               ï„ï©
                          1 (|ï„ï© | ï€¾ ï¨ï ) ï‚£ âˆ—             ï‚¯ ï‚¤
                      =                  E Xï© Î£ (Xï© ) Xâˆ—0 ï‚¯
                                                       ï© ï„ï© + 1 (|ï„ï© | ï€¾ ï¨ï ) V ( ï‚¯ (Xï© )| ï„ï© ) ï€»
                               ï„ï©2

where Î£(Xï© ) â‰¡ V ( Uï© | Xï© ). Averaging the first term in V ( ïšïï€»ï© | ï„ï© ) over the distribution of ï„ï© gives

                  ï‚·                                      ï‚¸             ïš
                      1 (|ï„ï© | ï€¾ ï¨ï ) ï‚£ âˆ—             ï‚¯ ï‚¤                  âˆ’ï¨
                                                                             1 ï‚£ âˆ—                ï‚¯         ï‚¤
             E                       E Xï© Î£ (Xï© ) Xâˆ—0 ï‚¯
                                                   ï© ï„ï©           =             E Xï© Î£ (Xï© ) Xâˆ—0  ï‚¯
                                                                                                ï© ï„ï© = ï´ ïƒ (ï´) dï´              (44)
                               2                                              2
                           ï„ï©                                           âˆ’âˆ   ï´
                                                                        ïš âˆ
                                                                               1 ï‚£ âˆ—                ï‚¯         ï‚¤
                                                                       +          E Xï© Î£ (Xï© ) Xâˆ—0  ï‚¯
                                                                                                 ï© ï„ï© = ï´ ïƒ (ï´) dï´
                                                                                2
                                                                          ï¨ ï´
                                                                         ïš
                                                                       1 âˆ’1 1 ï‚£ âˆ—                      ï‚¯        ï‚¤
                                                                  =                E Xï© Î£ (Xï© ) Xâˆ—0    ï‚¯
                                                                                                   ï© ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                       ï¨ âˆ’âˆ ïµ2
                                                                           ïš
                                                                         1 âˆ 1 ï‚£ âˆ—                       ï‚¯        ï‚¤
                                                                       +            E Xï© Î£ (Xï© ) Xâˆ—0     ï‚¯
                                                                                                      ï© ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                         ï¨ 1 ïµ2
                                                                       2E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                                                                                         ï© | ï„ï© = 0] ïƒ0
                                                                  =                                        + ï (1)
                                                                                       ï¨
                                                                  =    ï(ï¨âˆ’1 )ï€»


where the third equality exploits Assumptions 1.2 and 2.3.




                                                                      34
    Averaging the second term over the distribution of ï„ï© yields


                                  E [1 (|ï„ï© | ï€¾ ï¨ï ) V ( ï‚¯ (Xï© )| ï„ï© )]     â‰¤   E [V ( ï‚¯ (Xï© )| ï„ï© )]

                                                                            =   V (ï‚¯ (Xï© ))

                                                                            =   ï (1) ï€º


Thus, combing terms,
                                                          2E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                                                                            ï© | ï„ï© = 0] ïƒ0
                                  E [V ( ïšïï€»ï© | ï„ï© )] =                                    + ï (1) ï€º
                                                                          ï¨
    Combing this result with the expression for V (E [ ïšïï€»ï© | ï„ï© ]) derived above yields a variance term of

                                                      2E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                                                                        ï© | ï„ï© = 0] ïƒ0
                                     V (ïšïï€»ï© )   =                                     + ï (1)                      (45)
                                                                      ï¨
                                                       ï‚¡ âˆ’1 ï‚¢
                                                 =    ï ï¨       ï€º


    Together (42), (45), and the independence generated by random sampling (Assumption 2.1) imply that
                        ï‚·              ï‚¸                          ï‚µ              ï‚¶     ï‚µ     ï‚¶
                            1 ï˜ï                                      1 ï˜ï                1
                    E              ïšïï€»ï© = ï¯ï° (1) ï€»            V              ïšïï€»ï© = ïï°         = ï¯ï° (1) ï€»           (46)
                            ï  ï©=1                                    ï  ï©=1             ïï¨ï

                                                                                  ï¢ for ï‚¯ (and indirectly
under the bandwidth assumption (Assumption 2.5). This implies weak consistency of ï‚¯ ï‰    0

Proposition 1.2).
    To show asymptotic normality we check the conditions for Liapunovâ€™s Central Limit Theorem (CLT) for triangular
arrays. Observe that

               ï‚£         ï‚¤             ï¨              ï‚°ï‚¡                         ï‚¢ï‚°3 ï©
              E kïšïï€»ï© k3         =    E 1 (|ï„ï© | ï€¾ ï¨) ï‚° Xâˆ’1
                                                          ï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0
                                                                                   ï‚°
                                       ï€¢              ï‚°                                                      ï‚°3 ï€£
                                                      ï‚° 1 âˆ—                                                  ï‚°
                                 =    E 1 (|ï„ï© | ï€¾ ï¨) ï‚°    X
                                                      ï‚° ï„ï© ï©  (Y ï© âˆ’ W  ï‚±
                                                                       ï© 0 ) âˆ’ ï‚¯ 0 (ï„  ï© ) âˆ’ (ï‚¯ 0 âˆ’ ï‚¯ 0 (ï„ ))
                                                                                                          ï© ï‚°
                                                                                                             ï‚° ï€º
                                       ï€¢              ï‚°                              ï‚°3 ï€£
                                                      ï‚° 1 âˆ—                          ï‚°
                                 =    E 1 (|ï„ï© | ï€¾ ï¨) ï‚°                              ï‚°
                                                      ï‚° ï„ï© Xï© Uï© + (ï‚¯0 (Xï© ) âˆ’ ï‚¯0 )ï‚° ï€º


Application of the triangle inequality and the fact that E [ Xâˆ— (Y âˆ’ Wï‚± 0 âˆ’ Xï‚¯0 )| ï„] = 0 yields
                                  ï€¢ï‚°                                                    ï‚°3 ï‚¯ï‚¯ ï€£
                                     ï‚° 1 âˆ—                                              ï‚° ï‚¯
                                E ï‚°                                                     ï‚°
                                     ï‚° ï„ï© Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯0 (ï„ï© ) âˆ’ (ï‚¯0 âˆ’ ï‚¯0 (ï„ï© ))ï‚° ï‚¯ï‚¯ ï„ï©
                                  ï€¢ ï‚µï‚°                                     ï‚°                    ï‚¶3 ï‚¯ï‚¯ ï€£
                                        ï‚° 1 âˆ—                              ï‚°                        ï‚¯
                                        ï‚°                                  ï‚°
                            â‰¤   E       ï‚° ï„ï© Xï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))ï‚° + kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k ï‚¯ï‚¯ ï„ï©
                                ï‚¯     ï‚¯                                      ï‚¯ ï©
                                ï‚¯ 1 ï‚¯ ï¨                                     3ï‚¯
                                ï‚¯     ï‚¯       âˆ—                                                       3
                            =   ï‚¯ ï„3 ï‚¯ E kXï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))k ï‚¯ ï„ï© + kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k
                                    ï©
                                       ï‚£                                   ï‚¯ ï‚¤
                                   3E kXâˆ—ï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))k2 ï‚¯ ï„ï©
                                +                                               kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k ï€º
                                                       ï„ï©2




                                                                      35
    Now note that

 ï¨                                  ï‚¯ ï©                ï‚£   ï‚¡                                                                ï‚¢ï‚¯ ï‚¤
                                   2ï‚¯                                                                                         ï‚¯ ï„ï©
E kXâˆ—ï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))k ï‚¯ ï„ï©        =    E ï” ï² Xâˆ—ï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© )) (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))0 Xâˆ—0
                                                                                                                         ï©
                                                         ï‚£ ï‚£ âˆ—                                                              ï‚¯    ï‚¤ï‚¤
                                                =    ï” ï² E Xï© (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© )) (Yï© âˆ’ Wï© ï‚± 0 âˆ’ Xï© ï‚¯0 (ï„ï© ))0 Xâˆ—0  ï‚¯
                                                                                                                         ï© ï„ï©
                                                         ï‚¡ ï‚£               ï‚¯ ï‚¤ï‚¢
                                                =    ï” ï² E Xâˆ—ï© Î£ (Xï© ) Xâˆ—0 ï‚¯
                                                                        ï© ï„ï©    ï€º


This gives
                          ï€¢ï‚°                                                      ï‚°3 ï‚¯ï‚¯ ï€£
                            ï‚° 1 âˆ—                                                 ï‚° ï‚¯
                        E ï‚°                                                       ï‚°
                            ï‚° ï„ï© Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯0 (ï„ï© ) âˆ’ (ï‚¯0 âˆ’ ï‚¯0 (ï„ï© ))ï‚° ï‚¯ï‚¯ ï„ï©
                        ï‚¯    ï‚¯
                        ï‚¯ 1 ï‚¯                               3ï” ï² (E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                                                                                    ï© | ï„ï© ])
                        ï‚¯    ï‚¯                          3
                    â‰¤   ï‚¯ ï„3 ï‚¯ ï­ (ï„ï© ) + kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k +                 ï„ï©2
                                                                                              kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k ï€»
                           ï©


with ï­ (ï„ï© ) as defined in Assumption 2.3. Using the above inequality yields

                         ïš                                   ïš
      ï‚£         ï‚¤            âˆ                                   ï¨
     E kïšïï€»ï© k3     â‰¤            kï‚¯0 âˆ’ ï‚¯0 (ï´)k3 ïƒ (ï´) dï´ âˆ’           kï‚¯0 âˆ’ ï‚¯0 (ï´)k3 ïƒ (ï´) dï´
                           âˆ’âˆ                                âˆ’ï¨
                           ïš âˆ’ï¨ ï‚µï‚¯ ï‚¯                                                          ï‚¶
                                  ï‚¯1ï‚¯                     âˆ—          âˆ—0
                         +        ï‚¯ ï‚¯ ï­ (ï´) + 3ï” ï² (E [ Xï© Î£ (Xï© ) Xï© | ï„ï© = ï´]) kï‚¯0 âˆ’ ï‚¯0 (ï´)k ïƒ (ï´) dï´
                                  ï‚¯ ï´3 ï‚¯                       ï´2
                             âˆ’âˆ
                          ïš âˆ ï‚µï‚¯ ï‚¯                                                           ï‚¶
                                 ï‚¯1ï‚¯                     âˆ—          âˆ—0
                         +       ï‚¯ ï‚¯ ï­ (ï´) + 3ï” ï² (E [ Xï© Î£ (Xï© ) Xï© | ï„ï© = ï´]) kï‚¯0 âˆ’ ï‚¯0 (ï´)k ïƒ (ï´) dï´
                                 ï‚¯ ï´3 ï‚¯                       ï´2
                             ï¨
                                               ïš 1
                           ï‚£              ï‚¤
                    =    E kï‚¯0 âˆ’ ï‚¯0 (ï´)k3 âˆ’ ï¨       kï‚¯0 âˆ’ ï‚¯0 (ïµï¨)k3 ïƒ (ïµï¨) dïµ
                                                     âˆ’1
                          ïš        ï‚µ   ï‚¯ ï‚¯                                                                            ï‚¶
                              âˆ’1       ï‚¯1ï‚¯
                                       1                              âˆ—            âˆ—0
                         +             ï‚¯ ï‚¯ ï­ (ïµï¨) + 3ï” ï² (E [ Xï© Î£ (Xï© ) Xï© | ï„ï© = ïµï¨]) kï‚¯0 âˆ’ ï‚¯0 (ïµï¨)k ïƒ (ïµï¨) dïµ
                                       ï‚¯ ïµ3 ï‚¯
                                       ï¨2                                   ïµ2 ï¨
                             âˆ’âˆ
                          ïš âˆï‚µ ï‚¯ ï‚¯                                                                                   ï‚¶
                                      ï‚¯
                                   1 ï‚¯1ï‚¯   ï‚¯            3ï” ï² (E [ Xï© Î£ (Xï© ) Xâˆ—0
                                                                     âˆ—
                                                                                  ï© | ï„ï© = ïµï¨])
                         +                   ï­  (ïµï¨) +                                             kï‚¯    âˆ’  ï‚¯   (ïµï¨)k  ïƒ (ïµï¨) dïµ
                             1     ï¨2 ï‚¯ ïµ3 ï‚¯                                ïµ2 ï¨                       0      0

                                                      ï‚°          ï‚°3                            ïš
                           ï‚£                    ï‚¤     ï‚°          ï‚°                         âˆ’2
                                                                                                  âˆ
                                                                                                     1
                    =    E kï‚¯0 âˆ’ ï‚¯0 (ï„ï© )k3 âˆ’ 2 ï‚°ï‚¯0 âˆ’ ï‚¯ï“       0 ï‚° ïƒ0 ï¨ + ï­ (0) ïƒ0 ï¨          2          dïµ
                                                                                                1   ïµ3
                           6ï” ï² (E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0             ï‚°             ï‚° ïš âˆ 1                ï‚¡     ï‚¢
                                                   ï© | ï„ï© = 0]) ï‚°            ï“ï‚°
                         +                                       ï‚°ï‚¯0 âˆ’ ï‚¯0 ï‚° ïƒ0              2
                                                                                              dïµ + ï¯ ï¨âˆ’2
                                              ï¨                                       1   ïµ
                                                ï‚¡ ï‚£                   ï‚¯          ï‚¤ï‚¢ ï‚°
                                                                                    ï‚°
                                                                                                ï‚°
                                                                                               ï“ï‚°
                    =    ï­ (0) ïƒ0 ï¨âˆ’2 + 6ï” ï² E Xâˆ—ï© Î£ (Xï© ) Xâˆ—0     ï©
                                                                      ï‚¯ ï„ ï© =   0   ï‚°ï‚¯  0 âˆ’ ï‚¯ 0 ï‚° ïƒ0 ï¨
                                                                                                       âˆ’1

                             ï‚¯          ï‚¯          ï‚£
                             ï‚¯          ï‚¯                               3ï‚¤
                         âˆ’2 ï‚¯ï‚¯0 âˆ’ ï‚¯ï“  0 ï‚¯ ïƒ0 ï¨ + E kï‚¯ 0 âˆ’ ï‚¯ 0 (ï„ï© )k
                           ï‚¡     ï‚¢
                    =    ï ï¨âˆ’2 ï€º

                                                                                        ï‚³        ï‚´
                                                                                            ï
    Using the above result we can verify the Liapunov condition. Let ï¡ï =                   ï¨ï
                                                                                                  , then

                                     1 ï˜ï                 ï‚£                ï‚¯
                                                                           ï‚¯
                                                                                ï‚¤
                                            V (ïšïï€»ï© ) â†’ 2E Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                                                                        ï© ï„ï© = 0 ïƒ0 ï€»
                                    ï¡ï  ï©=1




                                                                 36
and also
                              ï‚³ï˜ï         ï‚£                    ï‚¤ï‚´1ï€½3              ï‚³ ï˜ï  ï‚£         ï‚¤ï‚´1ï€½3
                                         E kïšïï€»ï© âˆ’ E [ïšïï€»ï© ]k3                     8   E kïšïï€»ï© k3
                                   ï©=1                                                  ï©=1
                                                                             â‰¤
                                              (ï¡ï )1ï€½2                                   (ï¡ï )1ï€½2
                                                                                     ïƒƒï‚¡     ï‚¢1ï€½3 ï€¡
                                                                                       ïï¨âˆ’2
                                                                             =   ï
                                                                                    (ïï¨âˆ’1 )1ï€½2
                                                                                  ï‚³         ï‚´
                                                                             =   ï (ïï¨)âˆ’1ï€½6

                                                                             =   ï¯ï° (1) ï€º


Application of the Liapunov CLT for triangular arrays, equation (39) above, and Slutskyâ€™s Theorem, then yields the
follow Lemma.


Lemma A.1 Suppose that (i) (ï†0 ï€» ï‚± 0 ï€» ï‚¯0 (Â·)) satisfies (9), (ii) Î£ (x) is positive definite for all x âˆˆ Xï” ï€» (iii) ï” = ï°ï€»
                                               ï°
                                           ï¢ â†’
and (iv) Assumptions 1.2 to 2.5 hold, then ï‚¯     ï‚¯0 with the normal limiting distribution
                                             ï‰


                                                âˆš   ï‚³       ï‚´
                                                 ïï¨ï ï‚¯ï¢ âˆ’ï‚¯ â†’  ï„
                                                                N (0ï€» 2Î¥0 ïƒ0 ) ï€»
                                                       ï‰  0



for Î¥0 = E [ Xâˆ—ï© Î£ (Xï© ) Xâˆ—0
                          ï© | ï„ï© = 0] ï€º


                           b : Recall that the non-random coeï¬ƒcients ï‚±0 are estimated by a uniform
Large sample properties of Î´
conditional linear predictor (CLP) estimator. Recentering (24) yields

                      ï‚·                                     ï‚¸âˆ’1        ï‚·                                                  ï‚¸
           ï¢ âˆ’ ï‚±0 =        1 ï˜ï                                             1 ï˜ï
           ï‚±                      1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 Wï©âˆ—           Ã—               1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 (ï„ï© ï‚¯0 (Xï© ) + Uâˆ—ï© ) ï€»   (47)
                          ïï¨  ï©=1                                          ïï¨  ï©=1


where


                                                Uâˆ—   =     Yâˆ— âˆ’ Wâˆ— ï‚± 0 âˆ’ï„ï‚¯0 (X)                                                (48)

                                                     =     Xâˆ— (Y âˆ’ Wï‚± 0 âˆ’ Xï‚¯0 (X))

                                                     =     Xâˆ— Uï€º


    First consider the expected value of the matrix being inverted in (47). Manipulations similar to those used to
        ï¢ above yield
analyze ï‚¯ ï‰


                               ï‚£                       ï‚¤             ï‚£               ï‚£        ï‚¯ ï‚¤ï‚¤
                              E 1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 Wï©âˆ—      =      E 1 (|ï„ï© | â‰¤ ï¨) E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï©
                                                                   ïš ï¨
                                                                         ï‚£         ï‚¯      ï‚¤
                                                            =          E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                                                                    âˆ’ï¨
                                                                    ïš 1
                                                                         ï‚£         ï‚¯         ï‚¤
                                                            =      ï¨    E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                     âˆ’1
                                                                     ï‚£         ï‚¯        ï‚¤
                                                            =      2E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 ïƒ0 ï¨ + ï¯ (ï¨) ï€»                         (49)




                                                                       37
while for any fixed ï±-dimensional vector ï‚¸ the variance of a quadratic form in that matrix satisfies
                ï‚·                               ï‚¸                                 ï¨              ï¨       ï‚¯ ï©ï©
                 1 ï˜ï                ï‚¡ 0 âˆ—0 âˆ— ï‚¢                             1                           4ï‚¯
              V         1 (|ï„ï© | â‰¤ ï¨) ï‚¸ Wï© Wï© ï‚¸                     â‰¤         2
                                                                                E 1 (|ï„ï© | â‰¤ ï¨) E kWï©âˆ— k ï‚¯ ï„ï© kï‚¸k4    (50)
                ïï¨  ï©=1                                                   ïï¨
                                                                              ï‚£       ï‚¯        ï‚¤            ï‚µ    ï‚¶
                                                                          2E kWï©âˆ— k4 ï‚¯ ï„ï© = 0 ïƒ0 kï‚¸k4          1
                                                                    =                                   +ï¯
                                                                                        ïï¨                    ïï¨
                                                                            ï‚µ      ï‚¶
                                                                                1
                                                                    =     ï
                                                                               ïï¨

under Assumptions 2.3 and 2.5 so that

                           1 ï˜ï                              ï‚£         ï‚¯       ï‚¤
                                  1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 Wï©âˆ— = 2E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 ïƒ0 + ï¯ï° (1) ï€º                         (51)
                          ïï¨  ï©=1


    Now redefine ïšïï€»ï© to equal the term entering the summation in the numerator of (47):


                                          ïšïï€»ï© â‰¡ 1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 (ï„ï© ï‚¯0 (Xï© ) + Uâˆ—ï© ) ï€º


Using the fact that E [ Wï©âˆ—0 Uâˆ—ï© | ï„ï© ] = E [ Wï©âˆ—0 Xâˆ— E [ U| X]| ï„ï© ] = 0 yields an expected value of ïšïï€»ï© equal to

                            ï‚£                                      ï‚¤
          E [ïšïï€»ï© ]   =   E 1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 (ï„ï© ï‚¯0 (Xï© ) + Uâˆ—ï© )
                            ï‚£                  ï‚£             ï‚¯ ï‚¤ï‚¤
                      =   E 1 (|ï„ï© | â‰¤ ï¨) ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©
                          ïš ï¨
                                ï‚£              ï‚¯       ï‚¤
                      =       ï´E Wï©âˆ—0 ï‚¯ 0 (Xï© )ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                           âˆ’ï¨
                           ïš 1
                                      ï‚£             ï‚¯        ï‚¤
                      =   ï¨        ïµï¨E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                              âˆ’1
                                                            ïš
                              ï‚£          ï‚¯       ï‚¤              1
                      =   E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨2             ïµdïµ
                                                             âˆ’1
                              ï‚½                                                         ï‚¾ ïš 1
                              ï€E [ Wï©âˆ—0 ï‚¯0 (Xï© )| ï„ï© = 0]       ï‚£ âˆ—0        ï‚¯       ï‚¤ 0                 ï‚¡ ï‚¢
                          +                                                 ï‚¯
                                                          ïƒ0 + E Wï© ï‚¯0 (Xï© ) ï„ï© = 0 ïƒ0 ï¨3      ïµ2 dïµ + ï¯ ï¨3
                                          ï€ï¤                                                âˆ’1
                            ï‚½                                                           ï‚¾
                          2 ï€E [ Wï©âˆ—0 ï‚¯0 (Xï© )| ï„ï© = 0]         ï‚£ âˆ—0        ï‚¯       ï‚¤ 0        ï‚¡ ï‚¢
                      =                                   ïƒ0 + E Wï© ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨ + ï¯ ï¨3 ï€»
                                                                                          3
                          3               ï€ï¤

where we use the following Taylor approximation and Assumption 1.2 and 2.3 in deriving the second to last equality
above:

 ï‚£             ï‚¯        ï‚¤                           ï‚£              ï‚¯        ï‚¤
E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ ïµï¨ïƒ (ïµï¨)          =   0 + E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ïµï¨
                                                 ï‚½                                                             ï‚¾
                                                   ï€E [ Wï©âˆ—0 ï‚¯0 (Xï© )| ï„ï© = 0]       ï‚£             ï‚¯       ï‚¤             ï‚¡ ï‚¢
                                               +                               ïƒ0 + E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ00 (ïµï¨)2 + ï¯ ï¨2 ï€º
                                                               ï€ï¤

    The numerator (47) therefore equals

                           1 ï˜ï
                                    1 (|ï„ï© | â‰¤ ï¨) Wï©âˆ—0 (ï„ï© ï‚¯ 0 (Xï© ) + Uâˆ—ï© )                                          (52)
                          ïï¨ï‚½
                                ï©=1
                                                                                        ï‚¾
                          2 ï€E [ Wï©âˆ—0 ï‚¯0 (Xï© )| ï„ï© = 0]         ï‚£            ï‚¯      ï‚¤           ï‚¡ ï‚¢
                      =                                 ïƒ0 + E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ00 ï¨2 + ï¯ï° ï¨2 ï€º
                          3             ï€ï¤




                                                                    38
                                                              ï¢ âˆ’ ï‚± 0 of
Using the ratio of (52) and (51) yields a bias expression for ï‚±
                                             ï‚½                                                                         ï‚¾
              ï‚£         ï‚¯       ï‚¤                ï€E [ Wï©âˆ—0 ï‚¯0 (Xï© )| ï„ï© = 0]    ï‚£             ï‚¯       ï‚¤ ïƒ0                        ï‚¡ ï‚¢
 ï¢ âˆ’ ï‚± 0 = 1 E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 âˆ’1 Ã—
 ï‚±                                                                           + E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 0                   ï¨2 + ï¯ï° ï¨2 ï€º (53)
           3                                                 ï€ï¤                                         ïƒ0

                                                                                 âˆš   ï‚³       ï‚´
This implies that we can center the asymptotic distribution of                        ï¢ âˆ’ ï‚± 0 at zero by choosing ï¨ï such that
                                                                                  ïï¨ï ï‚±
(ïï¨ï )1ï€½2 ï¨2ï â†’ 0 (Assumption 2.5).
      Now consider the variance of ïšïï€»ï© ï€º As before we proceed by evaluating the two terms in in the variance decom-
position (43) separately. The first of the two terms evaluates to

                                     ï‚¡                   ï‚£             ï‚¯ ï‚¤ï‚¢
        V (E [ ïšïï€»ï© | ï„ï© ])   =     V 1 (|ï„ï© | â‰¤ ï¨) ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©
                                     ï¨                   ï‚£             ï‚¯ ï‚¤ ï‚£               ï‚¯ ï‚¤0 ï©
                              =     E 1 (|ï„ï© | â‰¤ ï¨) ï„ï©2 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©
                                       ï‚£                   ï‚£             ï‚¯ ï‚¤ï‚¤ ï‚£                   ï‚£           ï‚¯ ï‚¤ï‚¤0
                                    âˆ’E 1 (|ï„ï© | â‰¤ ï¨) ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© E 1 (|ï„ï© | â‰¤ ï¨) ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© ï€º


      Evaluating the two expectations entering the above expressions yields
                                                                       ïš
                  ï‚£                  ï‚£             ï‚¯ ï‚¤ï‚¤                     ï¨     ï‚£             ï‚¯       ï‚¤
                 E 1 (|ï„ï© | â‰¤ ï¨) ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©         =               ï´E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                                                                        âˆ’ï¨
                                                                            ïš   1      ï‚£             ï‚¯        ï‚¤
                                                                =      ï¨2            ïµE Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                                âˆ’1
                                                                        ï‚¡ ï‚¢
                                                                =      ï¯ ï¨2 ï€»


and

                         ï¨                   ï‚£             ï‚¯ ï‚¤ ï‚£                ï‚¯ ï‚¤0 ï©
                        E 1 (|ï„ï© | â‰¤ ï¨) ï„ï©2 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©
                           ïš ï¨
                                   ï‚£             ï‚¯       ï‚¤ ï‚£              ï‚¯       ï‚¤0
                        =      ï´2 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ï´ E Wï©âˆ—0 ï‚¯ 0 (Xï© )ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                              âˆ’ï¨
                              ïš 1
                                           ï‚£             ï‚¯        ï‚¤ ï‚£             ï‚¯        ï‚¤0
                         =ï¨         (ïµï¨)2 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                               âˆ’1
                                                                                                ïš
                              ï‚£           ï‚¯       ï‚¤ ï‚£             ï‚¯       ï‚¤0                        1            ï‚¡ ï‚¢
                         = E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨3                        ïµ2 dïµ + ï¯ ï¨3
                                                                                                 âˆ’1
                          2 ï‚£             ï‚¯       ï‚¤ ï‚£             ï‚¯       ï‚¤0        ï‚¡ ï‚¢
                         = E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 E Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨3 + ï¯ ï¨3 ï€º
                          3
                                        ï‚¡ ï‚¢
We conclude that V (E [ ïšïï€»ï© | ï„ï© ]) = ï¯ ï¨3 .
      Now consider the second term in (43). The conditional variance, using the conditional moment restriction (9), is

                                                         ï‚¡                           ï‚¯ ï‚¢
                  V ( ïšïï€»ï© | ï„ï© )    =   1 (|ï„ï© | â‰¤ ï¨) V ï„ï© Wï©âˆ—0 ï‚¯0 (Xï© ) + Wï©âˆ—0 Uâˆ—ï© ï‚¯ ï„ï©
                                                            ï‚¡             ï‚¯ ï‚¢                   ï‚¡         ï‚¯ ï‚¢
                                     =   1 (|ï„ï© | â‰¤ ï¨) ï„ï©2 V Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© + 1 (|ï„ï© | â‰¤ ï¨) V Wï©âˆ—0 Uâˆ—ï© ï‚¯ ï„ï© ï€º


Using an ANOVA decomposition to evaluate V ( Wï©âˆ—0 Uâˆ—ï© | ï„ï© ) gives

                           ï‚¡         ï‚¯ ï‚¢             ï‚£ ï‚¡         ï‚¯ ï‚¢ï‚¯ ï‚¤         ï‚¡ ï‚£       ï‚¯ ï‚¤ï‚¯ ï‚¢
                          V Wï©âˆ—0 Uâˆ—ï© ï‚¯ ï„ï©      =    E V Wï©âˆ—0 Uâˆ—ï© ï‚¯ Xï© ï‚¯ ï„ï© + V E Wï©âˆ—0 Uâˆ—ï© ï‚¯ Xï© ï‚¯ ï„ï©
                                                     ï‚£                      ï‚¯ ï‚¤
                                               =    E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© + 0ï€»




                                                                  39
and hence
                                                                     ïš
         ï‚£               ï‚£                      ï‚¯ ï‚¤ï‚¤                     ï¨    ï‚£                      ï‚¯       ï‚¤
        E 1 (|ï„ï© | â‰¤ ï¨) E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï©         =               E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                                                                         âˆ’ï¨
                                                                         ïš 1
                                                                           ï‚£                      ï‚¯         ï‚¤
                                                             =       ï¨    E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                       âˆ’1
                                                                       ï‚£                      ï‚¯        ï‚¤
                                                             =       2E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 ïƒ0 ï¨ + ï¯ (ï¨) ï€º


Similarly
                                                                 ïš
             ï‚£                   ï‚¡             ï‚¯ ï‚¢ï‚¤                  ï¨       ï‚¡             ï‚¯       ï‚¢
            E 1 (|ï„ï© | â‰¤ ï¨) ï„ï©2 V Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï©      =               ï´2 V Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ï´ ïƒ (ï´) dï´
                                                                  âˆ’ï¨
                                                                  ïš 1
                                                                                    ï‚¡             ï‚¯        ï‚¢
                                                         =       ï¨           (ïµï¨)2 V Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = ïµï¨ ïƒ (ïµï¨) dïµ
                                                                     âˆ’1
                                                                                                     ïš
                                                                     ï‚¡          ï‚¯       ï‚¢                1            ï‚¡ ï‚¢
                                                         =       V Wï©âˆ—0 ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨3               ïµ2 dïµ + ï¯ ï¨3
                                                                                                      âˆ’1
                                                                 2 ï‚¡ âˆ—0         ï‚¯       ï‚¢         ï‚¡ ï‚¢
                                                         =         V Wï© ï‚¯0 (Xï© )ï‚¯ ï„ï© = 0 ïƒ0 ï¨3 + ï¯ ï¨3 ï€º
                                                                 3

    Collecting terms we conclude that

                                            ï‚£                      ï‚¯       ï‚¤
                              V (ïšïï€»ï© ) = 2E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 ïƒ0 ï¨ + ï¯ (ï¨) ï€º                                  (54)


Applying Liapunovâ€™s Central Limit Theorem for triangular arrays, we have

                            1  ï˜ï        ï„  ï‚¡     ï‚£                      ï‚¯       ï‚¤ ï‚¢
                          âˆš         ïšïï€»ï© â†’ N 0ï€» 2E Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 ïƒ0 ï€º
                           ïï¨ï  ï©=1


Slutskyâ€™s Theorem and (51) above then give the following Lemma.


Lemma A.2 Suppose that (i) (ï†0 ï€» ï‚± 0 ï€» ï‚¯0 (Â·)) satisfies (9), (ii) Î£ (x) is positive definite for all x âˆˆ Xï” ï€» (iii) ï” = ï°ï€»
                                               ï°
                                           ï¢â†’
and (iv) Assumptions 1.2 to 2.5 hold, then ï‚±     ï‚± 0 with the normal limiting distribution

                                                ï‚³      ï‚´                       ï‚µ       ï‚¶
                                            âˆš                                      Î›0
                                                 ï¢ âˆ’ ï‚±0 â†’
                                             ïï¨ï ï‚±
                                                         ï„
                                                           N                    0ï€»       ï€»
                                                                                   2ïƒ0

where
                     ï‚£         ï‚¯       ï‚¤âˆ’1 ï‚£ âˆ—0 âˆ—              ï‚¯       ï‚¤ ï‚£         ï‚¯       ï‚¤âˆ’1
               Î›0 = E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0   E Wï© X Î£ (X) Xâˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0 E Wï©âˆ—0 Wï©âˆ— ï‚¯ ï„ï© = 0    ï€º

                           b : The following lemma characterizes the probability limit of Î
Large sample properties of Î²                                                              ï¢ï ï€º

                                                                                          ï°
                                                                                       ï¢ï â†’
Lemma A.3 If (ï†0 ï€» ï‚± 0 ï€» ï‚¯0 (Â·)) satisfies (9) and Assumptions 1.2 to 2.5 hold we have Î    Î0 , where

                                                       ï‚£                     ï‚¤
                                       Î0    =    lim E 1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1
                                                                         ï© Wï© ï€º
                                                 ï¨ï â†“0

                                             â‰¡    lim Îï ï€º
                                                 ï â†’âˆ




                                                             40
    To verify this result, we must first establish that the defined limit exists. For ï¨ï suï¬ƒciently small, we can
decompose the expectation Îï as

                                      ï‚£                      ï‚¤     ï‚£                        ï‚¤
                           Îï    =   E 1 (|ï„ï© | â‰¥ ïµ0 ) Xâˆ’1                             âˆ’1
                                                        ï© Wï© + E 1 (ï¨ï ï€¼ |ï„ï© | ï€¼ ïµ0 ) Xï© Wï©
                                               ï‚£                            ï‚¤
                                 =   ï(1) + E 1 (ï¨ï ï€¼ |ï„ï© | ï€¼ ïµ0 ) ï„ï©âˆ’1 Wï©âˆ—
                                            ïš ïµ0 ï‚µ               ï‚¶
                                                    ï‚»(ïµ) âˆ’ ï‚»(âˆ’ïµ)
                                 =   ï(1) +                        ï¤ïµï€»
                                              ï¨ï          ïµ

where
                                                  ï‚»(ïµ) â‰¡ ïƒ(ïµ)E[ï—ï©âˆ— |ï„ï© = ïµ]

is twice continuously diï¬€erentiable for |ïµ| ï€¼ ïµ0 by Assumption 1.2. Using the Taylorâ€™s series expansion
                                                                    ï‚· 2                    ï‚¸ ï‚µ 2ï‚¶
                                                          ï¤ï‚»(0)      ï¤ ï‚»(ïµâˆ— )   ï¤2 ï‚»(âˆ’ïµâˆ— )    ïµ
                         ï‚»(ïµ) âˆ’ ï‚»(âˆ’ïµ) = ï‚»(0) âˆ’ ï‚»(0) + 2         Â·ïµ+           âˆ’             Â·     ï€»
                                                           ï¤ïµ          ï¤ïµ2          ï¤ïµ2        2

for ïµâˆ— some intermediate value between ï¨ï and ïµ0 ï€» it follows that
                    ï‚¯                  ï‚µ            ï‚¶ï‚¯             ï‚· ï‚°        ï‚°       ï‚° 2      ï‚°     ï‚¸
                    ï‚¯                                ï‚¯                ï‚°       ï‚°       ï‚°        ï‚°
                    ï‚¯1 (ï¨ï ï€¼ ïµ ï€¼ ïµ0 ) Â· ï‚»(ïµ) âˆ’ ï‚»(âˆ’ïµ) ï‚¯ â‰¤ 1(ïµ â‰¤ ïµ0 ) 2 ï‚° ï¤ï‚»(0) ï‚° + max ï‚° ï¤ ï‚»(ïµ) ï‚° Â· ïµ0 ï€»
                    ï‚¯                         ïµ      ï‚¯                ï‚° ï¤ïµ ï‚° |ïµ|â‰¤ïµ0 ï‚° ï¤ïµ2 ï‚°

and since the right-hand side is integrable, Îï â†’ Î0 by dominated convergence. Then, taking ï‚¸ to be an arbitrary
                                       ï°
                                    ï¢ï â†’
(fixed) ï±-vector, verification that Î    Î0 follows from the convergence of the covariance matrix of the numerator
   ï¢ ï ï‚¸ to zero:
of Î
ï‚° ï‚· ï˜                            ï‚¸ï‚°                ï‚° ï‚· ï˜                                     ï‚¸ï‚°
ï‚°                                 ï‚°                ï‚°                                           ï‚°
ï‚°V 1                                               ï‚°V 1
     ï                                                       ï
         1 (|ï„  | ï€¾ ï¨  ) Xâˆ’1
                             W  ï‚¸ ï‚°           =                  1  (|ï„  | ï€¾ ï¨  ) ï„ âˆ’1
                                                                                       W âˆ—
                                                                                           ï‚¸   ï‚°
ï‚°  ï ï©=1
              ï©      ï    ï©   ï©   ï‚°                ï‚°   ï     ï©=1
                                                                       ï©      ï    ï©     ï©     ï‚°
                                                   2 kï‚¸k2  ï¨                                 ï©
                                                                                           2
                                              â‰¤           E 1 (|ï„ï© | ï€¾ ï¨ï ) |ï„ï© |âˆ’2 kWï©âˆ— k
                                                     ï
                                                   2 kï‚¸k2 ï¨ ï¨                               2
                                                                                              ï©      ï¨
                                                                                                                                   2
                                                                                                                                     ï©ï©
                                              =            E 1 (|ï„ï© | â‰¥ ïµ0 ) |ï„ï© |âˆ’2 kWï©âˆ— k + E 1 (ï¨ï ï€¼ |ï„ï© | ï€¼ ïµ0 ) |ï„ï© |âˆ’2 kWï©âˆ— k
                                                     ï
                                                     ï‚µ ï‚¶              ïš     ï‚µ                 ï‚¶
                                                       1      2 kï‚¸k2 ïµ0 ï‚³(ïµ) + ï‚³(âˆ’ïµ)
                                              =    ï       +                                     ï¤ïµï€»
                                                       ï        ï       ï¨ï          ïµ2

where kWï©âˆ— k2 â‰¡ ï´ï² [Wâˆ—0 Wâˆ— ] and
                                                                       2
                                               ï‚³(ïµ) â‰¡ ïƒ(ïµ)E[kï—ï©âˆ— k |ï„ï© = ïµ]

is bounded for |ïµ| ï€¼ ïµ0 , so
           ï‚° ï‚· ï˜                            ï‚¸ï‚°                    ï‚µ       ï‚¶                ï‚µ             ï‚¶ïš        ï‚µ        ï‚¶
           ï‚°                                 ï‚°                                    4 kï‚¸k2                      ïµ0
           ï‚°V 1                                                       1                                                1
                ï
                    1 (|ï„  | ï€¾ ï¨  ) Xâˆ’1
                                        W  ï‚¸ ï‚°            â‰¤   ï               +                max kï‚³(ïµ)k                       ï¤ïµ
           ï‚°  ï ï©=1
                         ï©      ï    ï©   ï©   ï‚°                        ï             ï      |ïµ|â‰¤ïµ0                      ïµ2
                                                                                                          ï¨ï
                                                                  ï‚µ       ï‚¶                ï‚µ          ï‚¶ï‚·         ï‚¸
                                                                      1         4 kï‚¸k2                    1   1
                                                          =   ï               +             max kï‚³(ïµ)k      âˆ’
                                                                      ï           ï        |ïµ|â‰¤ïµ0        ï¨ï   ïµ0
                                                                  ï‚µ           ï‚¶
                                                                       1
                                                          =   ï
                                                                      ïï¨ï
                                                          =   ï¯(1)


under Assumption 2.5.
    Lemmas A.1, A.2, and A.3 as well as the decomposition (37) then give Theorem 2.1.



                                                              41
A.2     MSE-optimal bandwidth sequence:
The MSE-optimal bandwidth sequence given in equation (29) of the main text may be derived as follows. Using (42),
                                                              ï‚¡       ï‚¢
(53) and Lemma A.3 yields a leading asymptotic bias term of 2 ï‚¯0 âˆ’ ï‚¯ï“0 ïƒ0 ï¨ï€º The asymptotic variance is given in

the statement of Theorem 2.1. The asymptotic MSE of ï‚¯ ï¢ is thus

                                                                                Î Î› Î                          0
                                         ï‚³        ï‚´ï‚³          ï‚´0        2Î¥0 ïƒ0 + 02ïƒ0 0
                                        4 ï‚¯0 âˆ’ ï‚¯ï“
                                                0   ï‚¯ 0 âˆ’ ï‚¯ ï“
                                                            0    ïƒ2 2
                                                                   ï¨
                                                                  0 ï +             0
                                                                                        ï€º
                                                                             ïï¨ï

Minimizing this object with respect to ï¨ï gives the result in the main text.


A.3     Proof of Theorem 2.2:
Rewriting equation (30) we have

                             ï‚·                 ï‚¸âˆ’1 ï‚·                        ï‚¸ ï‚· ï˜          ï‚¸âˆ’1
                                 1 ï˜ï                ï¨ï ï˜ï       ï¢+ ï¢          1 ï
                      ï–ï¢ =              Q0ï© Rï©    Ã—          Q0ï© Uï© U +0
                                                                      ï©  Qï©  Ã—       Q0
                                                                                      ï© Rï©                                                  (55)
                                 ï  ï©=1              ï   ï©=1                   ï ï©=1


                                        ï¨       ï˜ï              ï©âˆ’1       ï¨       ï˜ï              ï©
for U+    âˆ—                 ï¢               1
                                                       Q0ï© Rï©                 1                                         0
                                                                                           Q0ï© Yï©âˆ— ï€» for ï‚µ = (ï‚± 0 ï€» ï‚¯0 ) and
     ï© = Yï© âˆ’ Rï© ï‚µ 0 ï€» with ï‚µ =             ï
                                                                      Ã—       ï
                                                 ï©=1                                 ï©=1

                          ï‚µ                                            ï‚¶
                                                 âˆ— 1 (|ï„ï© | ï€¾ ï¨ï )
              Qï©      =    ï¨âˆ’1
                            ï  1 (|ï„ï© | â‰¤ ï¨ï ) Wï© ï€»                ï‰ ï°   ï€»                      Rï©     = (Wï©âˆ— ï€» 1 (|ï„ï© | ï€¾ ï¨ï ) ï„ï© ï‰ï° ) ï€º
             ï” Ã—ï±+ï°                                     ï„ï©                                    ï” Ã—ï±+ï°


The dependence of Qï© and Rï© on ï¨ï is suppressed to simplify the notation.
                                                                                        ï¢ï ,
    Starting with the â€˜Jacobianâ€™ term in ï–ï¢ we get, by the definitions of Qï© , Rï© ï€» and Î
                                                      ï€°                                ï€±
            1 ï˜ï                            1 ï˜ï ï€ ï¨ï 1 (|ï„ï© | â‰¤ ï¨ï ) Wï© ï ï‚³                                         ï‚´
                                                            âˆ’1                      âˆ—0
                   Q0ï© Rï©           =                                                     Wï©âˆ— 1 (|ï„ï© | ï€¾ ï¨ï ) ï„ï© ï‰ï°
            ï  ï©=1                          ï     ï©=1           1(|ï„ ï© |ï€¾ï¨ ï )
                                                                               ï‰ï°
                                                                     ï„ï©
                                            ï€°       ï˜ï                                                              ï€±
                                                1
                                                             1 (|ï„ï© | â‰¤ ï¨ï ) Wï©âˆ—0 Wï©âˆ—            0ï‘ 00ï
                                    =       ï€ ï ï¨ ï
                                                   ï˜ïï©=1                                   ï˜ï                       ï
                                                1
                                                ï
                                                           1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1   ï© Wï©
                                                                                         1
                                                                                         ï
                                                                                                 1 (|ï„ï© | ï€¾ ï¨ï ) ï‰ï°
                                                       ï©=1                                   ï©=1
                                              ï€°                                        ï€±
                                                         âˆ—0    âˆ—
                                            ï°     2E [ Wï© Wï© | ï„ï© = 0] ïƒ0 0
                                            â†’ï€                                         ï
                                                              Î0                   ï‰ï°

                                                                      ï˜ï
by (51) and A.3. Decomposing the middle term ï¨ï                                       ï£ï© + U
                                                                                  Q0ï© U    ï¢ +0 Qï© ï€½ï, yields
                                                                                             ï©
                                                                          ï©=1

                       ï‚°                                                        ï‚°
                       ï‚° ï¨ï ï˜ï     0 ï¢ + ï¢ +0         ï¨ï ï˜ï                     ï‚°
                       ï‚°         Q  U    U    Q    âˆ’              Q0
                                                                     U+ +0
                                                                        U    Q  ï‚°                                                           (56)
                       ï‚°ï    ï©=1
                                   ï© ï©     ï©     ï©
                                                      ï      ï©=1
                                                                   ï© ï©     ï©   ï©ï‚°

                       2ï¨ï ï˜ï ï‚°        ï‚°          ï‚°        ï‚° ï¨ ï˜ï                  ï‚°         ï‚°2
                 â‰¤               ï‚°U+ ï©
                                       ï‚° kQï© k2 ï‚°          ï‚°
                                                  ï‚°ï‚µÌ‚ âˆ’ ï‚µ0 ï‚° +
                                                                 ï                 ï‚°
                                                                            kQï© k2 ï‚°ï‚µÌ‚ âˆ’ ï‚µ0 ï‚°
                                                                                             ï‚°
                         ï   ï©=1
                                  ïƒƒ                              ï     ï©=1
                                                                                              ï‚°     ï‚°ï€¡ï‚°          ï‚°
                          2 ï˜ï                                ï‚°
                                                          âˆ— 2 ï‚° +ï‚°
                                                                    ï‚°                    ï¨2ï ï‚°U+  ï©
                                                                                                    ï‚° ï‚°          ï‚°
                 =                  1 (|ï„ï© | â‰¤ ï¨ï ) kWï© k Uï© + 1 (|ï„ï© | ï€¾ ï¨ï )                         ï‚°ï‚µÌ‚ âˆ’ ï‚µ 0 ï‚°
                       ïï¨ï    ï©=1                                                           |ï„ï© |2
                                    ï‚µ                                                    ï‚¶ï‚°          ï‚°2
                           1 ï˜ï                                2                     ï¨2     ï‚°        ï‚°
                       +               1 (|ï„ï© | â‰¤ ï¨ï ) kWï©âˆ— k + 1 (|ï„ï© | ï€¾ ï¨ï ) ï 2 ï‚°ï‚µÌ‚ âˆ’ ï‚µ0 ï‚° ï€º
                         ïï¨ï    ï©=1                                                |ï„ï© |




                                                                              42
By a similar argument as for (50) above,

            ï¨                              ï‚°  ï‚¢ï©                    ï¨                      ï¨             ï‚°          ï©ï©
                                  âˆ— 2 ï‚¡ï‚°
                                       ï‚°U+ ï‚°+1                                                 âˆ— 2 ï‚¡ï‚°
                                                                                                    ï‚°U+
                                                                                                              ï‚¢
                                                                                                         ï‚° + 1 | ï„ï©
           E ï¨âˆ’1
              ï 1 (|ï„ï© | â‰¤ ï¨ï ) kWï© k    ï©                   =     E ï¨âˆ’1ï 1 (|ï„ï© | â‰¤ ï¨ï ) E kWï© k      ï©
                                                                      ï¨               ï‚°              ï©
                                                                              2 ï‚¡ï‚°         ï‚¢
                                                            â†’      2E kWï©âˆ— k ï‚°U+    ï©
                                                                                      ï‚° + 1 | ï„ï© = 0 ïƒ0 ï€»


and the same reasoning as (44) yields


     ï‚·                                          ï‚¸                  ï‚·                               ï¨                        ï©ï‚¸
                            2 ï‚¡ï‚°   ï‚°    ï‚¢ ï¨ï                                               ï¨ï          âˆ— 2 ï‚¡ï‚°
                                                                                                                ï‚°    ï‚¢
    E 1 (|ï„ï© | ï€¾ ï¨ï ) kWï©âˆ— k ï‚°U+ ï©
                                   ï‚° + 1                    =     E ï¨âˆ’1
                                                                      ï 1 (|ï„ ï© | ï€¾  ï¨ï )        E  kWï© k   ï‚°U+ï‚°
                                                                                                              ï©   + 1  | ï„ï©
                                         |ï„ï© |2                                           |ï„ï© |2
                                                                    ï¨         ï‚¡ï‚°      ï‚°     ï‚¢          ï©
                                                                  2E kWï©âˆ— k ï‚°U+       ï‚° + 1 | ï„ï© = 0 ïƒ0 ï€º
                                                                            2
                                                            â†’                       ï©



Thus, by Markovâ€™s inequality, (56) yields

                       ï¨ï ï˜ï                                    ï¨ï ï˜ï                      ï‚³ï‚°       ï‚°ï‚´
                                   ï¢+ ï¢ +0                                                  ï‚°       ï‚°
                               Q0ï© Uï© Uï© Qï©             =               Q0ï© U+  +0
                                                                             ï© Uï© Qï© + ïï° ï‚°ï‚µÌ‚ âˆ’ ï‚µ 0 ï‚°
                       ï   ï©=1                                  ï   ï©=1
                                                                ï¨ï ï˜ï
                                                        =               Q0ï© U+  +0
                                                                             ï© Uï© Qï© + ï¯ï° (1) ï€º
                                                                ï   ï©=1


Finally,

 ï¨ï ï˜ï
         Q0ï© U+  +0
              ï© Uï© Qï©       =
 ï   ï©=1
                                ï€°          ï˜ï
                                      1
                                                       1 (|ï„ï© | â‰¤ ï¨ï ) Wï©âˆ—0 (Yï©âˆ— âˆ’ Wï©âˆ— ï‚± 0 ) (Yï©âˆ— âˆ’ Wï©âˆ— ï‚± 0 )0 Wï©âˆ—
                                ï€   ï ï¨ï         ï©=1
                                                                           0ï 00ï‘
                                                                                                                                   ï€±
                                                                                 0ï‘ 00ï
                                  ï¨ï
                                       ï˜ï                       ï‚©                        ï‚ª ï‚© âˆ’1                    ï‚ª0 ï ï€º
                                  ï
                                                 1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1
                                                                  ï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0    Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯0
                                           ï©=1


    By the calculations yielding (54), the expected value of the first diagonal submatrix is

     ï‚£                                                   0 âˆ—ï‚¤    ï‚£ âˆ—0 âˆ—           ï‚¯
                                                                                 âˆ—ï‚¯     ï‚¤
    E ï¨âˆ’1                 âˆ—0  âˆ—    âˆ—         âˆ—    âˆ—                           âˆ—0
       ï 1 (|ï„ï© | â‰¤ ï¨ï ) Wï© (Yï© âˆ’ Wï© ï‚± 0 ) (Yï© âˆ’ Wï© ï‚± 0 ) Wï© = 2E Wï© X Î£ (X) X Wï© ï„ï© = 0 ïƒ0 + ï¯ (1) ï€»


                                                 ï‚¡        ï‚¢
while the variance of any term in the matrix is ï (ïï¨ï )âˆ’1 = ï¯(1) by Assumptions 2.3and 2.5 (with ï² â‰¤ 8).
Similarly, the expectation of the second diagonal submatrix is

 ï¨                  ï‚©                        ï‚ª ï‚© âˆ’1                    ï‚ª0 ï©                     ï‚£             ï‚¯      ï‚¤
E ï¨ï 1 (|ï„ï© | ï€¾ ï¨ï ) Xâˆ’1
                      ï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0    Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯0                    =   2E Xâˆ— Î£ (X) Xâˆ—0 ï‚¯ ï„ = 0 ïƒ0 + ï¯ (1)

                                                                                          =   2Î¥0 ïƒ0 + ï¯(1)ï€»


while similar calculations to those leading to (46) yield

    ï‚° ï¨                                                                                                              ï‚µ         ï‚¶
    ï‚°                    ï‚© âˆ’1                   ï‚ª ï‚© âˆ’1                  ï‚ª0 ï©ï‚°
                                                                            ï‚°                         4ï­8 (0)ïƒ0           1
    ï‚°V ï¨ï 1 (|ï„ï© | ï€¾ ï¨ï ) Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯0 Xï© (Yï© âˆ’ Wï© ï‚± 0 ) âˆ’ ï‚¯ 0 ï‚°                       â‰¤              +ï¯
                                                                                                         ïï¨ï®             ïï¨ï®
                                                                                                 =    ï¯(1)ï€»




                                                                   43
where ï­8 (ïµ) is defined in Assumption 2.3, Thus
                                            ï€°                                                             ï€±
               ï¨ï    ï˜ï                 ï°       2E [ Wï©âˆ—0 Xâˆ— Î£ (X) Xâˆ—0 Wï©âˆ— | ï„ï© = 0] ïƒ0      0ï‘ 00ï
                            Q0ï© U+  +0
                                 ï© Uï© Qï© â†’
                                           ï€                                                              ïï€»
               ï      ï©=1
                                                                 0ï 00ï‘                   2Î¥0 ïƒ0 + ï¯(1)

            ï°
ensuring ï–ï¢ â†’ ï–0 ï€º



References
 [1] Abrevaya, Jason. (2000). â€œRank estimation of a generalized fixed-eï¬€ects regression model,â€
     Journal of Econometrics 95 (1): 1 - 23.

 [2] Altonji, Joseph G. and Rosa L. Matzkin (2005). â€œCross section and panel data estimators for
     nonseparable models with endogenous regressors,â€ Econometrica 73 (4): 1053 - 1102.

 [3] Angrist, Joshua D. and Alan B. Krueger. (1999). â€œEmpirical strategies in labor economics,â€
     Handbook of Labor Economics 3 (1): 1277 - 1366 (O. C. Ashenfelter & D. Card, Eds.). Ams-
     terdam: North-Holland.

 [4] Andrews, Donald W. K. and Marcia M. A. Schafgans. (1998). â€œSemiparametric estimation of
     the intercept of a sample selection model,â€ Review of Economic Studies 65 (3): 497 - 517.

 [5] Arellano, Manuel and Stephanne Bonhomme. (2009). â€œIdentifying distributional characteristics
     in random coeï¬ƒcients panel data models,â€ Mimeo.

 [6] Arellano, Manuel and Raquel Carrasco. (2003). â€œBinary choice panel data models with prede-
     termined variables,â€ Journal of Econometrics 115 (1): 125 - 157.

 [7] Arellano, Manuel and Bo HonorÃ©. (2001). â€œPanel data models: some recent developments,â€
     Handbook of Econometrics 5: 3229 - 3298 (J. Heckman & E. Leamer, Eds.). Amsterdam:
     North-Holland.

 [8] Behrman, Jere R. and Anil B. Deolalikar. (1987).â€œWill developing country nutrition improve
     with income? A case study for rural south India,â€ Journal of Political Economy 95 (3): 492 -
     507.

 [9] Bester, C. Alan and Christian Hansen. (2009). â€œIdentification of Marginal Eï¬€ects in a Non-
     parametric Correlated Random Eï¬€ects Model,â€ Journal of Business and Economic Statistics
     27 (2): 235 - 250.

[10] Blundell, Richard W. and James L. Powell. (2003). â€œEndogeneity in nonparametric and semi-
     parametric regression models,â€ Advances in Economics and Econometrics: Theory and Ap-
     plications II : 312 - 357. (M. Dewatripont, L.P. Hansen, S. J. Turnovsky, Eds.). Cambridge:
     Cambridge University Press.


                                                            44
[11] Bonhomme, Stephane. (2010). â€œFunctional diï¬€erencing,â€ Mimeo.

[12] Bouis, Howarth E. (1994). â€œThe eï¬€ect of income on demand for food in poor countries: are our
     food consumption databases giving us reliable estimates? Journal of Development Economics
     44(1): 199-226.

[13] Bouis, Howarth E. and Lawrence J. Haddad. (1992).â€œAre estimates of calorie-income elasticities
     too high? A recalibration of the plausible range,â€ Journal of Development Economics 39 (2):
     333 - 364.

[14] Browning, Martin and Jesus Carro. (2007). â€œHeterogeneity and microeconometrics modelling,â€
     Advances in Economics and Econometrics: Theory and Applications III : 47 - 74. (R. Blundell,
     W. Newey & T. Persson, Eds.). Cambridge: Cambridge University Press.

[15] Card, David. (1996). â€œThe eï¬€ect of unions on the structure of wages: a longitudinal analysis,â€
     Econometrica 64 (4): 957 - 979.

[16] Chamberlain, Gary. (1980). â€œAnalysis of covariance with qualitative data,â€ Review of Economic
     Studies 47 (1): 225 - 238.

[17] Chamberlain, Gary. (1982). â€œMultivariate regression models for panel data,â€ Journal of Econo-
     metrics 18 (1): 5 - 46.

[18] Chamberlain, Gary. (1984). â€œPanel data,â€ Handbook of Econometrics 2: 1247 - 1318 (Z.
     Griliches & M.D. Intriligator, Eds.). Amsterdam: North-Holland.

[19] Chamberlain, Gary. (1986). â€œAsymptotic eï¬ƒciency in semi-parametric models with censoring,â€
     Journal of Econometrics 32 (2): 189 - 218.

[20] Chamberlain, Gary. (1992). â€œEï¬ƒciency bounds for semiparametric regression,â€ Econometrica
     60 (3): 567 - 596.

[21] Chamberlain, Gary. (2010). â€œBinary response models for panel data: identification and infor-
     mation,â€ Econometrica 78 (1): 159 - 168.

[22] Chernozhukov, Victor, IvÃ¡n FernÃ¡ndez-Val, Jinyong Hahn and Whitney Newey. (2008). â€œIdenti-
     fication and estimation of marginal eï¬€ects in nonlinear panel data models,â€ CEMMAP Working
     Paper CWP25/08.

[23] Dasgupta, Partha. (1993). An Inquiry into Well-Being and Destitution. Oxford: Oxford Uni-
     versity Press.

[24] Deaton, Angus and Salman Zaidi. (2002). â€œGuidelines for constructing consumption aggregates
     for welfare analysis,â€ LSMS Working Paper Number 135.




                                                45
[25] Engle, Robert F., C. W. J. Granger, John Rice, and Andrew Weiss. (1986). â€œSemiparametric
     estimates of the relation between weather and electricity sales,â€ Journal of the American
     Statistical Association 81 (394): 310 - 320.

[26] Food and Agricultural Organization (FAO). (2001).â€œHuman energy requirements: report of a
     joint FAO/WHO/UNU expert consultation,â€ FAO Food and Nutrition Technical Report Series
     1.

[27] Food and Agricultural Organization (FAO). (2006). The State of Food Insecurity in the World
     2006. Rome: Food and Agricultural Organization.

[28] Graham, Bryan S., Guido W. Imbens, Geert Ridder. (2009). â€œComplementarity and aggregate
     implications of assortative matching: a nonparametric analysis,â€ Mimeo.

[29] Heckman, James, Hidehiko Ichimura, Jeï¬€rey Smith and Petra Todd. (1998). â€œCharacterizing
     selection bias using experimental data,â€ Econometrica 66 (5): 1017 - 1098.

[30] Heckman, James J. (1990). â€œVarieties of selection bias,â€ American Economic Review 80 (2):
     313 - 18.

[31] HonorÃ©, Bo E. (1992). â€œTrimmed LAD and least squares estimation of truncated and censored
     regression models with fixed eï¬€ects,â€ Econometrica 60 (3): 533 - 565.

[32] HonorÃ©, Bo E. and Ekaterini Kyriazidou. (1997). â€œPanel data discrete choice models with
     lagged dependent variables,â€ Econometrica 68 (4): 839 - 874.

[33] Horowitz, Joel L. (1992). â€œA smoothed maximum score estimator for the binary response
     model,â€ Econometrica 60 (3): 505 - 531.

[34] Imbens, Guido W. (2007). â€œNonadditive models with endogenous regressors,â€ Advances in
     Economics and Econometrics: Theory and Applications III : 17 - 46. (R. Blundell, W. Newey
     & T. Persson, Eds.). Cambridge: Cambridge University Press.

[35] Imbens, Guido W. and Whitney K. Newey. (2009). â€œIdentification and estimation of triangular
     simultaneous equations models without additivity,â€ Econometrica 77 (5): 1481 - 1512.

[36] Instituto Nacional de EstadÃ­sticas y Censos (INEC). (2005). MetodologÃ­a de con-
     strucciÃ³n del agregado de consumo, de las lÃ­neas de pobreza y del agregado de
     ingreso en Nicaragua. Retrieved January 22, 2008, from the World Wide Web:
     http://www.inec.gob.ni/Pobreza/pubmetodol.htm.

[37] Instituto de NutriciÃ³n de Centro AmÃ©rica y PanamÃ¡ (INCAP) and Organi-
     zaciÃ³n Panamericana la Salud (OPS). (2000). Tabla de ComposiciÃ³n de Ali-
     mentos de CentroamÃ©rica. Retrieved January 2008, from the World Wide Web:
     http://www.tabladealimentos.net/tca/TablaAlimentos/inicio.html


                                              46
[38] International Food Policy Research Institute (IFPRI). (2005). Nicaraguan RPS evaluation
     data (2000-02): overview and description of data files (April 2005 Release). Washington D.C.:
     International Food Policy Research Institute.

[39] Khan, Shakeeb and Elie Tamer. (2009). â€œIrregular identification, support conditions, and in-
     verse weight estimation,â€ Mimeo.

[40] Kyriazidou, Ekaterini. (1997). â€œEstimation of a panel sample selection model,â€ Econometrica
     65 (6): 1335 - 1364.

[41] Manski, Charles F. (1987). â€œSemiparametric analysis of random eï¬€ects linear models from
     binary panel data,â€ Econometrica 55 (2): 357 - 362.

[42] Mundlak, Yair. (1961). â€œEmpirical production function free of management bias,â€ Journal of
     Farm Economics 43 (1): 44 - 56.

[43] Mundlak, Yair. (1978a). â€œOn the pooling of time series and cross section data,â€ Econometrica
     46 (1): 69 - 85.

[44] Mundlak, Yair. (1978b). â€œModels with variable coeï¬ƒcients: integration and extension,â€ An-
     nales de lâ€™Insee 30-31: 483 - 510.

[45] Newey, Whitney K. (1994a). â€œThe asymptotic variance of semiparametric estimators,â€ Econo-
     metrica 62 (6): 1349 - 1382.

[46] Newey, Whitney K. (1994b). â€œKernel estimation of partial means and a general variance esti-
     mator,â€ Econometric Theory 10 (2): 233 - 253.

[47] Pagan, Adrian and Aman Ullah. (1999). Nonparametric Econometrics. Cambridge: Cambridge
     University Press.

[48] Serfling, Robert J. (1980). Approximation Theorems of Mathematical Statistics. New York:
     John Wiley & Sons, Inc.

[49] Smith, Lisa C. and Ali Subandoro. (2007). Measuring food security using household expenditure
     surveys. Washington D.C.: International Food Policy Research Institute.

[50] Strauss, John and Duncan Thomas. (1990). â€œThe shape of the calorie-expenditure curve,â€ Yale
     University Economic Growth Center Discussion Paper No. 595.

[51] Strauss, John and Duncan Thomas. (1995). â€œHuman resources: empirical modeling of house-
     hold and family decisions,â€ Handbook of Development Economics 3 (1): 1883 - 2023. (J.
     Behrman & T.N. Srinivasan). Amsterdam: North-Holland.

[52] Subramanian, Shankar and Angus Deaton. (1996). â€œThe demand for food and calories,â€ Journal
     of Political Economy 104 (1): 133 - 162.

                                               47
[53] Wolfe, Barbara L. and Jere R. Behrman. (1983). â€œIs income overrated in determining adequate
     nutrition?â€ Economic Development and Cultural Change 31 (3): 525 - 549.

[54] Wooldridge, Jeï¬€rey M. (2005a). â€œUnobserved heterogeneity and estimation of average partial
     eï¬€ects,â€ Identification and Inference for Econometric Models: Essays in Honor of Thomas
     Rothenberg: 27 - 55 (D.W.K. Andrews & J.H. Stock, Eds.). Cambridge: Cambridge University
     Press.

[55] Wooldridge, Jeï¬€rey M. (2005b). â€œFixed-eï¬€ects and related estimators for correlated-random
     coeï¬ƒcient and treatment-eï¬€ect panel data models,â€ Review of Economics and Statistics 87
     (2): 385 - 390.

[56] World Bank. (2002). Basic information document: Nicaragua living standards measurement
     survey 1998. Washington D.C.: The World Bank.

[57] World Bank. (2003). Nicaragua Poverty Assessment: Raising Welfare and Reducing Vulnera-
     bility. Washington D.C.: The World Bank.




                                              48
