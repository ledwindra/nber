NBER WORKING PAPER SERIES

COMPARATIVE STATICS IN MARKETS FOR INDIVISIBLE GOODS
Andrew Caplin
John V. Leahy
Working Paper 16285
http://www.nber.org/papers/w16285

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2010

We thank Mamoru Kaneko, John Leahy Sr., Jeffrey Mensch, Victor Norman, Michael Reiter, and
Ennio Stacchetti, for helpful comments. Leahy thanks the NSF for financial support. The views expressed
herein are those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2010 by Andrew Caplin and John V. Leahy. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including © notice,
is given to the source.

Comparative Statics in Markets for Indivisible Goods
Andrew Caplin and John V. Leahy
NBER Working Paper No. 16285
August 2010
JEL No. C63,D40,E1,R31
ABSTRACT
We complete the study of comparative statics initiated in Caplin and Leahy [2010], which introduced
a new mathematical apparatus for understanding NTU allocation markets, as such covering the housing
market and other markets for large indivisible goods. We introduce homotopy methods to characterize
how equilibrium changes in response to arbitrary parameter changes. Generically, we show that there
can be five and only five qualitatively distinct forms of market transition: Graft; Prune and Plant; Prune
and Graft; Cycle and Reverse; and Shift and Replant. Our path-following methods identify new algorithms
for computing market equilibria.

Andrew Caplin
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
andrew.caplin@nyu.edu
John V. Leahy
Department of Economics
New York University
19 W. 4th Street, 6th Floor
New York, NY 10012
and NBER
john.leahy@nyu.edu

Comparative Statics in Markets for Indivisible Goods
Andrew Caplin and John Leahy
New York University and N.B.E.R.
August 2010

Abstract
This paper builds upon Caplin and Leahy [2010], which introduced a new mathematical
apparatus for understanding NTU allocation markets, as such covering the housing market
and other markets for large indivisible goods. In the current paper we complete the study
of comparative statics initiated therein. We introduce homotopy methods to characterize
how equilibrium changes in response to arbitrary parameter changes. Generically, we show
that there can be …ve and only …ve qualitatively distinct forms of market transition: Graft;
Prune and Plant; Prune and Graft; Cycle and Reverse; and Shift and Replant. Our pathfollowing methods identify new algorithms for computing market equilibria.

1. Introduction
Among the most signi…cant of all markets are those, such as the housing market, that allocate
large indivisible goods to households. These goods are best modeled as allocation markets with
non-transferable utility (NTU). Caplin and Leahy [2010] (henceforth CL) introduced a new
mathematical apparatus for understanding these markets. In the current paper we complete the
study of comparative statics initiated therein. We use homotopy methods to characterize how
the minimum price competitive equilibrium changes in response to arbitrary parameter changes.
Given an initial equilibrium, we follow a path through parameter space, building up the discrete
change in equilibrium from in…nitesimal ones. We show that along the generic path equilibria
evolve in a very controlled manner. There are …ve and only …ve qualitatively distinct forms of
We thank Mamoru Kaneko, John Leahy Sr., Je¤rey Mensch, Victor Norman, Michael Reiter, and Ennio
Stacchetti, for helpful comments. Leahy thanks the NSF for …nancial support.

market transition. The homotopy path decomposes all comparative statics into these …ve basic
operations.
In addition to identifying market transitions, we show that our path-following methods are
ideally suited to algorithmic use. They can be used in principle to compute minimum price
equilibria from a starting point with a trivial equilibrium. The resulting algorithms may help to
overcome computational barriers to application of the NTU allocation model.1 It is also not hard
to envision adopting our methods to studying the dynamic properties of markets for indivisible
goods by recasting the homotopy paths as sample paths which characterize the evolution of the
market over time.
Demange and Gale [1985] show that there exists a minimum price equilibrium in the class of
allocation markets that we consider, those in which each agent is either a buyer or a seller. CL
showed that these equilibria correspond to the solutions to a certain optimization problem. This
optimization is over a set of mathematical structures, called GA-structures, that combine an
allocation of goods to buyers along with a particular class of directed graphs that summarize key
indi¤erence relations among goods. CL show for small changes in parameter values the allocation
and the indi¤erence relations that characterize the minimum price competitive equilibrium are
unlikely to change. Given that “local” comparative statics involve a …xed GA-structure, they
are able to show that changes in model parameters that cause the price of a given good to change
impact only those goods that “follow”it in the corresponding directed graph.
In this paper we use GA-structures to characterize comparative statics in the large. We
study how the allocation of goods and the pattern of local interdependence changes when there
is a discrete shift in the character of the minimum price equilibrium. While there are examples
in which the most minor change in parameters cause the entire structure of the equilibrium to
change in arbitrary ways, we show such cases to be the exception rather than the rule. We
introduce a natural de…nition of regularity for comparative static paths and show generically
small parameter changes can induce …ve and only …ve distinct forms of market transitions. We
use GA-structures to illustrate the precise nature of each such transition. For reasons that will
be clear, the market transitions are labeled as: Grafting; Pruning; Prune and Graft; Cyclic
Reversal; and Shift and Re-plant.
Markets for indivisible goods are characterized by multiple equilibria. Due to the presence of
non-convexities, small changes in prices often do not alter the equilibrium allocation. We focus
1

The transferable utility case is well covered in this regard: the Hungarian algorithm of Kuhn [1955] and
Munkres [1957] can be used to compute the equilibrium allocation, while the ascending auction mechanism of
Demange, Gale and Sotomayor (1986) solves for the minimum price equilibrium in a discretized version of the
model.

2

on the minimum equilibrium price for a number of reasons. First, we learn about the entire range
of possible equilibria. The minimum and maximal equilibrium prices de…ne the boundaries of
all equilibria. The two prices have the same structure. The maximal equilibrium price is simply
the dual of the minimal, in which the roles of buyers and sellers are reversed. Moreover, CL
show that all equilibrium prices may be thought of as minimal equilibrium prices for some set of
parameter values. Finally, Demange and Gale [1985] show that the minimal equilibrium price
vector is not manipulable by buyers, making it a natural benchmark for multi-unit auctions.
Section 2 presents the general model and summarizes relevant results from CL. The additional
results in this paper rest in part on our ability to count the number of distinct GA-structures.
The key cardinality results are in section 3. They are derived by connecting the number of
GA-structures with the structure of market demand at minimum equilibrium prices. We show
that there is typically only one GA-structure, and that the most important points of market
transition involve two and only two such structures. Section 4 introduces the domain in which
we study comparative statics, which involves paths through a rich space of model parameters.
Section 5 identi…es the sense in which comparative static transitions are almost always “regular”,
in that the replacement for a given GA-structure is a unique second element that appears at a
point of transition. Section 6 identi…es the …ve generic forms of market adjustment. Section 7
shows how to use path-following methods to algorithmically identify the minimum equilibrium
price. Section 8 concludes. All proofs are in the Appendix.

2. Background
2.1. Model
There is a set of buyers xa 2 X, 1 a m, and a set of indivisible goods yi 2 Y , 1 i n with
n > m. The goods are initially held by the sellers. Buyers may purchase the indivisible goods
from sellers by making a transfer in terms of a homogeneous, perfectly divisible, numeraire good,
which may be thought of as money.
Buyers derive utility from at most one element of Y . The payo¤ for buyer xa is summarized
by the utility function Ua : Y R ! R, where Ua (yi ; pi ) is the utility to xa from the purchase
of yi with a transfer of pi of the numeraire good.
The supply side is trivial. Sellers choose only whether or not to sell. They do not purchase
the indivisible goods from other sellers. Each seller wishes only to obtain the highest possible
price above a reservation level. Let r 2 Rn+ denote the vector of seller reservation prices. Overall,

3

we can limit attention to a set
= p 2 Rn+ jp

in the search for competitive equilibria,
r and pn

a

= rn

a

= 0 all 0

a

m

1 :

Given any price vector p 2 , the (non-empty) demand correspondence Da (p) speci…es
members of Y that maximize utility the utility of buyer xa ,
Da (p) = fyi 2 Y jUa (yi ; pi )

Ua (yk ; pk ) for all yk 2 Ya g :

An allocation : X ! Y is a one-to-one mapping from buyers to goods. The set of all
allocations is M
A competitive equilibrium is a price vector and an allocation such that all buyers choose
optimally and all goods with prices above their reservation level are allocated.
De…nition A competitive equilibrium is a pair (p ;
1.

a

2. pi

) with p 2 Rn and

2 M such that:

2 Da (p ) for all xa 2 X.
ri for all yi 2 Y .

3. If yi 2 U (p ), then there exists xa 2 X such that

a

= yi .

The …rst condition is buyer optimality. The allocation must maximize the utility of each
buyer. The second condition is seller optimality. No seller will part for a good for less than
the reservation price. The third states that all goods with prices above reservation must be
allocated. This ensures that supply is equal to demand.
We make continuity and range assumptions that guarantee that the set of equilibria is a closed
lattice (see Demange and Gale [1985]). The …rst assumption is a straight forward regularity
assumption. The second assumption in combination with the …rst ensures that given any buyer,
any two goods, and a price for one of the goods, there is a price for the second that makes the
buyer indi¤erent between the two goods.
Assumption A For each buyer xa 2 X and good yi 2 Y ,
1. Ua (yi ; pi ) is continuously di¤erentiable in pi and strictly decreasing in pi .
2. limpi !1 Ua (yi ; pi ) =

1 and limpi !

1 Ua (yi ; pi )

4

= 1.

With Assumption A we know not only that there is a competitive equilibrium allocation, but
also that there is a minimum equilibrium price (henceforth MEP) p2 , which has the property
¯
that it is an equilibrium price and that, for any equilibrium price,
pi

p all yi 2 Y .
¯i

Note we have presented the model without explicit reference to buyers’endowment of the
numeraire good. We have implicitly assumed that buyers hold enough of the numeraire good
to buy the goods that they are assigned at the competitive equilibrium prices. An alternative
approach would have been to have expressed utility in terms of the endowment left over after purchase and to have included the additional assumption that each buyer preferred exit to
spending all of his endowment on a purchase. This condition would hold for any utility function that satis…ed the Inada conditions. This is the approach taken by Kaneko (1982) and is
equivalent to the current one.
2.2. GA-Structures
CL introduce GA-structures, which combine an allocation of goods with a particular class of
graph, to study the structure of equilibria in the allocation model. The graphs in question are
directed graphs on vertex set Y that: are forests of trees (i.e. contain no cycles); that are rooted,
in the sense that each component tree has a unique element that is speci…ed as its root, and in
which each edge is directed away from the root. We let F denote the class of directed rooted
forests on vertex set Y . Note the insistence that all goods that are at the “tail” of a directed
edge are allocated.
De…nition A graph-allocation structure (GA-structure) comprises:
1. A directed graph F = (Y; R; E) with vertex set Y , root set R
Y , and edge set
E 2 Y 2 in which F is a forest of trees, each component of F contains a unique
element of R and each edge (yi ; yk ) 2 E is directed away from the corresponding
element of R.
2. An allocation
(xa ) = yi .

2 M such that, if (yi ; yk ) 2 E, then there exists xa 2 X such that

We let G denote the set of all GA-structures.
5

CL construct a natural mapping from G into prices by …rst pricing root goods at reservation,
and then iteratively pricing successors by indi¤erence of the individual allocated to their unique
predecessor. Assumption A guarantees that this construction is well-de…ned.
De…nition The function q : G ! Rn ; the price generated by graph-allocation structure ( ; F ) 2
G is de…ned by setting qi ( ; F ) = ri for all yi 2 R(F )
A0 , with iterative pricing of
successor goods yk 2 S of As for s 1 based on the indi¤erence condition,
(2.1)

Ua (yi ; qi ( ; F )) = Ua (yk ; qk ( ; F )).
where

a

= yi , and (yi ; yk ) 2 E(F ), so that yi 2 As is the direct predecessor of yk 2 S.

2.3. The Min-Max Theorem
CL establish that with Assumption A, a solution to an optimization problem on these generated
prices identi…es the minimum equilibrium price. It also establishes that any allocation that forms
part of a minimum price equilibrium (MPE) must also be identi…able from this optimization
problem.
Theorem (CL): q( ; F ) is a minimum equilibrium price if and only if:
X

i2f1:::ng

qi ( ; F ) = min

max

2M F 2fF 2F j( ;F )2Gg

X

qi ( ; F ).

(2.2)

i2f1:::ng

Moreover, let ( ; F ) be an argument that solves (2.2), if qi ( ; F ) > ri for all yi 62 R(F )
then ( ; qi ( ; F )) is a MPE.
Comparative statics are particularly simple when there is one and only one element ( ; F ) 2
G that solves (2.2) for some range of parameters. In such cases, a continuous change in the
model’s parameters do not change in the allocation
or the graph F . Changes in sellers
reservation have a direct e¤ect on prices of root goods and changes in a buyer utility directly
a¤ects the prices of goods that are direct successors of the good that that buyer is allocated to.
These changes propagate through the graph structure a¤ecting the price of all successors in F .

3. Cardinality and the Demand Graph
The focus of this paper is on cases in which a change in parameters is large enough to force
a change in the equilibrium GA-structure. It turns out that this generally happens in a very
6

controlled manner. There is a sense in which it is rare to come across more than two solutions
to (2.2). For most parameter values there is only one solution. As one moves through the
parameter space, the generic path follows this single solution until at some point there a second
solution appears along with the …rst.2 The path then follows one of these two solutions for a
while. The current section formalizes these arguments using counting arguments.
3.1. The GAME set
We begin by stating exactly what we mean to count. It is the set of ( ; F ) 2 G which generate
the minimum equilibrium price and also have the property that allocates buyers not only to
the tails but to the heads of all edges in E(F ).3
De…nition: The graph allocation minimum price equilibrium (GAME) set is,
= f( ; F ) 2 Gj( ; q( ; F )) is a MPE and for all (yi ; yk ) 2 E(F ) =)

a

= yk some xa 2 Xg :

The condition that allocates a buyer to the head of each edge in E(F ) rules out some
uninteresting cases. Suppose, for example, that two goods y1 and y2 are both priced at reservation, and that there is only one buyer who is indi¤erent between them at these prices. In
this case, there are four elements of G that generate the minimum price competitive equilibrium
and hence “solve” the min-max problem. There are two potential allocations, and for each
allocation we may either price both goods at reservation or use the buyer’s indi¤erence to price
the unallocated good. The condition that allocates a buyer to the head of each edge in E(F )
rules out the use of indi¤erence to price the unallocated good. In this case, = 2.
Note that depends on the parameters of the model through the minimum price equilibrium.
We suppress this dependence, as we are considering a …xed set of parameters at this point.
3.2. Demand Graphs and Condition M
The cardinality of the GAME set
is basic in the work that follows. We derive conditions
under which is unique and under which it has two elements. We develop these cardinality
results using properties of demand at minimum equilibrium prices. We introduce the MPE
2

Throughout this paper we use the term generic in the topological sense. A property is generic if it holds on
a dense open set.
3
The de…nition of in this paper di¤ers from that in CL. In that paper we did not need the restriction that
the heads of all edges are allocated.

7

demand graph and a class of its subgraphs that turn out to be of particular importance in this
characterization.
De…nition: The MPE demand graph D(p) = (X; Y; E ) is a bipartite graph with partition X
¯
and Y , and an edge set de…ned by,
E = f(xa ; yj ) 2 X
De…nition: The edge set E
exists a partition fYlE j0

Y jyj 2 Da (p)g:
¯

E is said to satisfy Condition M, written E 2 M(p), if there
¯
l Lg of Y such that,

M1. Y0E is comprised of the elements of Y that isolated in the demand graph.
M2. For l 1, each element of YlE is connected to the other elements of YlE , but not to elements
of Y nYlE .
M3. For l 1, there is one and only one element, El 2 Y , of degree (valence) 1 in each partition
set YlE . All other elements of YlE have degree 2.
M4. For l

1, jXlE j = jYlE j where XlE = xa 2 Xj(xa ; yi ) 2 E some yi 2 YlE .

M5. pi > ri implies that the degree of yi is equal to two.
¯
Both the demand graph D and the set of subgraphs M depend on the price vector p which
¯
determines the set of goods in each buyer’s demand set. To save on notation, we suppress this
dependence in much of what follows as we are considering a …xed set of parameters at this point.
3.3. A Counting Lemma
The reason for introducing these particular graphs is that they will correspond in a precise
manner with elements of . M and are essentially equivalent. Given a MEP p, we introduce
¯
a bijection : M ! between and M that provides structure to counting arguments. The
proofs of all propositions are in the appendix.
Lemma 1: Let p be a minimum equilibrium price vector. There exists a bijection
¯
so that
j j = jMj

8

:M!

Given E 2 M, the graph (X; Y; E) is a bipartite graph with partition fX; Y g. Since it is a
selection from the demand graph at p, each buyer is matched only to goods that are optimal at
¯
these prices. With conditions M1-M4, (X; Y; E) is acyclic. Given one good in each component
with degree 1, a cycle would either lead to fewer buyers than sellers or require a good with
1 therefore corresponds to a
degree greater than two. Each partition element YlE for l
distinct tree. In each such tree, the root good has degree 1 and all others have degree 2. F
is constructed recursively, beginning with the valence one goods and then at each step adding
as direct successors all goods that are two edges distant in E. Finally, Y0E is added to the root
set. The equality between the number of goods and buyers in each such set generates a natural
mapping . The valence one goods are allocated to their neighbors in E. Removing these buyers
creates a new set of valence one goods, who are then allocated to their neighbors, and so on.
Note that the equality of buyers and sellers in M4 guarantees that all goods in YlE are allocated.
This implies that all non-root goods are allocated and that the heads and tails of all edges in
E(F ) are allocated. Finally, it is easy to show that the ( ; F ) generated in this way generates
p, so that ( ; F ) 2 .
¯
This bijection is illustrated in Figure 1 for a case in which there are …ve buyers and six
goods. Figure 1(a) illustrates E 2 M, with the partition fYlE j0
l
Lg. The sixth good is
E
E
unassigned, Y0 = y6 . The other two partition sets are Y1 = fy1 ; y2 ; y3 g and Y2E = fy4 ; y5 g. To
draw the corresponding allocation (E) we iterate from the goods of degree 1, so that i = yi
for 1 i 5. The forest is found by placing down the three root goods, y1 , y4 , and y6 (which is
unoccupied) and then drawing all edges corresponding to additional demands of their matched
buyers, x1 and x4 . Buyer x4 demands y5 in addition to y4 , while buyer x1 demands y2 and y3
in addition to y1 . Adding these as directed edges from the respective root good completes the
forest, as illustrated in Figure 1(b). The inverse mapping is also clear: if one starts from the
forest of directed rooted trees, all goods are demanded by the individual allocated to them, and
any individual allocated to a good at the origin of a directed edge demands all goods to which
such edges are directed.
3.4. Uniqueness
A characterization of demand graphs that give rise to uniqueness of the GAME set immediately
from Lemma 1. In the statement, d (yi ) is the degree of vertex yi associated with demand graph
D.
Corollary 1: E 2 M and d (yi ) = 2 =) pi > ri then j j = 1.
¯
9

Since E 2 M all goods have valence less than two. Any other E 2 M is a subgraph of
E , and therefore involves reducing the valence of some good. Reducing d (yi ) from two to one
violates M5 since d (yi ) = 2 =)pi > ri . Reducing d (yi ) from one to zero reduces the number
¯
of goods that are connected to buyers and violates M4.
We identify U M as the set of graphs satisfying the conditions of the uniqueness theorem.
This set is of particular value in enumerating elements of when there is more than one.
3.5. Cardinality Two
Corollary 1 implies that the existence of multiple equilibrium GA structures is associated either
with one or more “extra” indi¤erence relationships in the demand graph that can be removed
and have an edge structure that satis…es Condition M, or with some set of goods with valence
greater than one which have prices equal to their reservation values.
Our next result concerns circumstances in which j j = 2. This is the case whenever the
demand graph associated with the minimum price equilibrium has one and only one edge more
than some subgraph E~ E such that E~ 2 U.
While the theorem is proven in the appendix in standard analytic manner, certain of the
arguments are best understood in the …gures that follow.
Theorem 1: j j = 2 if and only if there exists (x; y) 2 E such that E =(x; y)

E~ 2 U.

The proof considers …ve cases. Each case is distinguished by the position of the good y and
the buyer x. We illustrate how beginning with E~ 2 U, the addition of an extra edge makes
possible the construction of a second element E 0 2 M.
~
Figure 2 illustrates a case in which y 2 Y0E . In this example, there are two buyers and three
goods. Figure 2(a) illustrates the edge set E~ 2 U:
E~ = f(x1 ; y1 ); (x1 ; y2 ); (x2 ; y2 )g;
The additional edge in E is (x2 ; y3 ) as illustrated in Figure 2(b). We obtain a second element
of E 0 2 M by removing the edge (x1 ; y1 ), as illustrated in …gure 2(c).
~
~
1. In this example,
Figure 3 illustrates a case in which y 2 YlE and x 2 XlE for some l
there are three buyers and three goods. We begin with the edge set E~ 2 U comprising,
E~ = f(x1 ; y1 ); (x1 ; y2 ); (x2 ; y2 ); (x1 ; y3 ); (x3 ; y3 )g;

10

This is illustrated in Figure 3(a). The additional edge in E is (x3 ; y2 ) as illustrated in Figure
3(b). E 0 2 M is obtained by removing edge (x1 ; y2 ), as illustrated in Figure 3(c).
~
~
Figure 4 illustrates a case with 2 YlE and y 2 YmE with m 2
= f0; lg, and with y of valence 2
~ Again there are three buyers and three goods. The edge set E~ 2 U comprises,
in E.
E~ = f(x1 ; y1 ); (x2 ; y2 ); (x2 ; y3 ); (x3 ; y3 )g;
as illustrated in Figure 4(a). The additional edge in E is (x1 ; y3 ) as illustrated in Figure 4(b).
E 0 2 M is obtained by removing (x2 ; y3 ), as illustrated in …gure 4(c).
~
~
In the …nal case, 2 YlE ; y 2 YmE with m 2
= f0; lg, and y has valence 1. This case is similar
~
to that in Figure 4, except that (x2 ; y3 ) 62 E.
It is important to note that there is something special about the addition of a single edge
to E~ 2 U that leads to one and only one additional element of . The addition of two edges
does not have a simple structure. It is easy to construct examples in which the addition of two
edges to E~ 2 U can lead to having three, four, or six elements depending on the position of
~
the additional goods and buyers in the graph (X; Y; E).

4. Regular Comparative Static Paths
We now consider a set of models indexed by a parameter vector 2 and consider comparative
statics with respect to . CL show that if the q ( ; F ; ) are smooth in a sense to be de…ned
below, the e¤ect of an in…nitesimal change in on the minimum equilibrium price can almost
always be analyzed using a …xed GA structure. In this case, the change in only a¤ects the
prices of goods directly in‡uenced by the change in and their successors in the relevant graph
F.
Discrete changes in are more complicated because they lead to shifts in the GA structure.
In this section, we use homotopy methods to characterize discrete comparative statics.4 Given
two points 0 and 1 in , we start with a known equilibrium at 0 and consider paths through
running from 0 to 1 . We let ( ) denote the dependence of the GAME set on . We
show that if the q ( ; F ; ) are smooth and if is large enough, then ( ) has the following two
properties along the generic path: (1) ( ) has at most two elements at every point along the
path; and (2) ( ) has two elements at a only …nite number of points so that it is single valued
almost everywhere. We call these paths regular comparative static paths.
4

See Judd (1999, p. 179) for an introduction to homotopy methods.

11

Comparative statics are conceptually simple along regular comparative static paths. One
follows the implications of a change in parameters for a single GA structure until at some point
a second solution to the min-max problem emerges. According to Theorem 1, this would happen
if some the demand set of some buyer expanded or if the price of some good fell to its reservation
value. At that point, one would choose the structure that solved the min-max problem along
the next segment of the path. The following sections formalize these arguments.
4.1. Model Types
We consider a set of models indexed by a parameter vector 2 Rmn+n . The …rst mn components
of are shifters ai of each buyer xa ’s utility for each good yi . We let Ua (yi ; pi ; ai ) be the utility
to xa from the purchase of yi at the price pi when the taste parameter is ai . The remaining n
components are the reservation prices of the sellers ri . We restrict to lie in a set
Rmn+n
in which all the Ua (yi ; pi ; ai ) are strictly monotonic in ai . This avoids “‡at spots” in which a
change in the parameters has no e¤ect on the prices. In addition, we assume that is non-empty,
open, bounded, and convex.5
We make the following smoothness assumption on the utility functions.6
Assumption B: The utility functions Ua (yi ; pi ; ai ) are analytic in pi and ai for all xa 2 X
and yi 2 Y . Moreover the Ua (yi ; pi ; ai ) are strictly monotonic in ai for all 2 .
Many of the objects that we have been considering become functions of . q( ; F; ) is the
price-induced by ( ; F ) in model 2 . p( ) is the minimum equilibrium price in model 2 .
¯
( ) is the GAME set. M( ) as the edge sets that satisfy condition M.
The next lemma follows from the properties of analytic functions and the Theorem of the
Maximum applied to the max-min problem (2.2).
Lemma 2: With Assumptions A and B, each qi ( ; F; ) is analytic at for all 2 ; ( )
is non-empty, compact-valued, and upper-hemicontinuous; and pi ( ) is continuous for all
¯
yi 2 Y .
5

Taking as open avoids the question of how to do comparative statics at the boundary of the parameter space.
Boundedness will imply that closed subsets are compact. Convexity implies connectedness, which is a natural
assumption when considering continuous paths. Convexity will also prove useful in constructing perturbations
of paths.
6
A function f (x) is analytic at a point x0 , if its Taylor series expansion converges on a neighborhood of x0 .
Almost all commonly used utilty functions are analytic almost everywhere in their domain.

12

Moreover, it follows from Lojasiewicz’s Structure Theorem for Real Varieties (Krantz and
Parks [2002], p. 168) that the GAME set is generically single valued. Let ^
f 2 j
j ( )j > 1g.
Theorem 2: With Assumptions A and B, ^ is open and dense in .
4.2. Paths
A typical comparative static exercise involves some well de…ned change in model parameters
from 0 to 1 . We will represent these changes with a path through starting from 0 and
ending at 1 . Technically, a path is a continuous mapping of the unit interval into parameter
space,
: [0; 1] ! , with (0) = 0 and (1) = 1 . Any path induces a correspondence
(z) : [0; 1] ! G which maps each z into the GAME set (z).
(z) = ( (z)).
Note that
valued.

inherits the properties of

. It is upper-hemicontinuous, non-empty and compact

4.3. Regular Paths
Even though is almost everywhere single valued, it will not be possible in general to …nd a
path between two sets of parameters that avoids points at which takes on multiple values.
We consider now what happens at such points.
A simple example shows that in general anything can happen. Suppose that at all buyers
have identical preferences and that the path passes through , then, in principle, one can
transition from any market situation to any other situation with the most minor of changes in
model parameters.
This example in which the equilibrium allocation can change in an arbitrary manner relies
on a seeming coincidence, with many individuals suddenly become indi¤erent to various goods
the same point along the path. The results of the last section suggest that cases in which there
is only one new indi¤erence at a time, or in which one and only one good falls to reservation
price at a given point in the parameter space, will be more ordered.
The simplest case is a path at which the number j j was no higher than 2 all the way along
the path. In fact the following cases are the easiest of all.
De…nition 4.1. A path (z) is regular if the induced mapping (z) has the following properties:
13

1. maxz2[0;1] j (z)j

2.

2. Z = fz 2 [0; z]jj (z)j > 1g is …nite.
Along a regular path, comparative statics is conceptually easy. One travels along a path,
working out the implications of a change in parameters for a given GA structure until at some
point a new element of arises. At this point, one chooses to continue with the structure that
solves the max-min problem beyond that point. There are a …nite number of such switches.
The cardinality results of the last section at least give some hope that there may be many
regular paths, given that particular transitions can be shown to ensure cardinality of no more
than 2. In the next section, we show in fact that regularity is a generic property of comparative
static paths.

5. The Generic Path is Regular
5.1. Analytic Shapes
Paths can take many forms and the set of possible paths is quite large. In order to keep the
analysis manageable, we consider a notion of genericity based on …xing the “shape”of a path and
varying the initial condition. We show that given the shape of the path, the initial conditions
associated with regular paths form a dense open set. In other words, the generic path is regular.
The shape is a continuous mapping S : [0; 1] ! Rmn+n such that S(0) = 0. The initial
condition is a point in parameter space 0 2 . The pair ( 0 ; S) de…ne a path (z; 0 ; S) =
0 + S(z), which begins at 0 and ends at 1 = 0 + S(1). A path is admissible if 0 + S(z) 2
for all z 2 [0; 1]. Let S denote the set of 0 for which 0 + S(z) is admissible.
For the remainder of the paper we …x the shape S and assume that S is a non-empty, open,
bounded, and convex subset of .
Assumption C: Each component of S(z) is analytic on (0,1).
5.2. Regularity is Generic
Let R = f 0 2 S j (z; 0 ; S) is regularg denote the set of 0 for which the path (z;
regular. Theorem 3 states the sense in which almost all paths are regular.
Theorem 3: With A-C,

R

is open and dense in

14

S.

0 ; S)

is

The proof of Theorem 3 involves a number of steps. The upper hemicontinuity of
can
be used to show that the set of non-regular paths is closed. To show that the R is dense
in S we …rst show that the set of points F = f 0 jZ = fz 2 [0; z]jj (z)j > 1g is …niteg is
dense in S . To see this, note that each point in Z is associated with an intersection of at
least two q( ; F; (z)). We show that Assumptions B and C imply that the qi ( ; F; (z)) are
analytic in z for all z 2 (0; 1); ( ; F ) 2 G, and yi 2 Y . Analytic functions whose intersections
have accumulation points must be equal everywhere. We show that whenever qi ( ; F; (z)) are
identical for two ( ; F ) we can …nd a perturbation of 0 such that they are di¤erent. This
establishes F is dense in S . To establish that the set R is dense in F we show that given
0 2 F , we can perturb 0 in such a way that we reduce the number of edges in E at points
in which j (z)j > 2.

6. The Five Market Transitions
According to Theorem 3, on a regular path there are only a …nite number of points at which
the GA structure changes and at each of these points of transition j (z)j = 2. According to
Theorem 1, points at which j (z)j = 2 are associated with an “extra”indi¤erence in the demand
graph. The extra indi¤erence could arise either with the expansion of the demand set of a single
buyer to a single new good or with a single price falling to ri , thereby making super‡uous the
demand of the buyer who heretofore had supported the good.
The implication is that along the generic path there are only a few ways in which the structure
of the market can change. In fact, there are …ve types of transition. Four are associated with an
expansion of a buyer’s demand set. They di¤er in the position of the good demanded, whether
it is (1) unallocated, (2) allocated and a root good in another component, (3) allocated and a
predecessor in the same component, or (4) none of the above. The last case is associated with
a contraction in the graph satisfying the conditions of the Corollary 1. This happens when the
price of a good falls to its reservation level. Below we discuss each case in terms of the impact
on the GA-structure, since it is this that illustrates most clearly how, if at all, the allocation
changes, and how the structure of market interdependence changes at critical transition points.
We present the cases in the order of complexity. In each case, we describe what happens at
a point of market transition z. There is some GA structure ( ; F ) which has characterized the
market prior to z. At z either some buyer x becomes indi¤erent to some good y or the price
of some good y falls to r. We describe the relationship between ( ; F ) and ( 0 ; F 0 ), the GA
structure that characterizes the market after z. It is useful to let denote the good assigned x
15

by .
6.1. Graft
Grafting occurs when x’s demand correspondence expands to include a good y that is the root
of another tree. The tree with y as its root is incorporated in x to create a single larger tree.
An example of grafting is illustrated in Figure 5. Figure 5(a) shows the initial GA structure
( ; F ). There are …ve goods. The only goods that are labeled are y, the root of the second
tree, and , the good in the …rst tree whose buyer becomes indi¤erent to y. This indi¤erence is
illustrated by the light directed edge from to y. It is clear that y can be priced in two ways:
it can be set at reservation or it can be priced using x’s indi¤erence. This latter GA structure
is illustrated in Figure 5(b). It involves solidifying the link from to y and the uprooting of y,
as illustrated by the circular as opposed to square node.
In general, grafting is characterized by the following rules. First, there is no change in the
equilibrium allocation, 0 = . Second, F 0 di¤ers from F in just two ways: the added edge from
to y, E(F 0 ) = E(F ) [ ( ; y), and the removal of y from the root set, R(F 0 ) = R(F )ny.
6.2. Prune and Plant
Pruning is the opposite of grafting. It involves the division of one tree into two separate trees.
It occurs when some good y that used to be above reservation price falls to this price, and at
that point becomes a root good. This occurrence is illustrated in Figure 6(a). The new GA
structure involves severing of the proximate link to the new root good, as illustrated in Figure
6(b). Again, there is no change in the allocation.
6.3. Prune and Graft
As its name indicates, prune and graft combines both pruning and grafting. This case involves
separating a branch from a tree and attaching it somewhere else. This is the “none of the above”
case described above, in which y is allocated, but not a root good or a predecessor to . As in
the cases of pruning and grafting there is no change in the allocation. As with pruning, the link
between y and its direct predecessor in F is cut. As with grafting, y is grafted onto the new
directed edge from to y.
Two di¤erent cases with this common structure are illustrated in …gures 7(a) and 7(b), with
the di¤erence being that in the …rst case and y are in di¤erent trees, which in the second case
they are in the same tree, with being a predecessor of y. It is clear in each case, the addition
16

of the edge ( ; y) creates two and only two ways to price good y, one corresponds to the initial
graph F , the other to F 0 .
Prune and Graft is characterized by the following rules: 0 = ; R(F 0 ) = R(F ); and E(F 0 ) =
fE(F )n(y 0 ; y)g [ ( ; y) where y 0 is the direct predecessor of y in F .
6.4. Cyclic Reversal
The two …nal cases both involve changes both in the allocation of goods, as well as the nature of
the interdependence. Cyclic Reversal occurs when both and y are elements of the same tree,
and y is a predecessor of .
A simple example with three goods and three buyers is illustrated in Figure 8(a). Initially,
each buyer is matched with the correspondingly numbered good: i = yi , and the GA structure
involves two directed edges: E(F ) = f (y1 ; y2 ); (y2 ; y3 )g. In this example, = y3 and y = y1 , as
illustrated by the corresponding light edge. Note that the addition of the directed edge, (y3 ; y1 )
creates a cycle in which each buyer is indi¤erent between his assigned good and its direct
successor. A cyclic permutation of the allocation therefore keeps each buyer in his demand set.
It is clear that we can generate the same price vector as follows. First, allocate x to y3 and
use his indi¤erence to price y3 . Next take the buyer allocated to y2 , shift him to y3 and use
his indi¤erence to price y2 . Finally, take the buyer allocated to y1 , shift him to y2 . This GA
structure is illustrated in …gure 8(b).
Formally, cyclic reversal involves the following steps. Add the edge ( ; y) to E(F ). This
creates a directed cycle C = fy1 ; y2 ; : : : ; yk ; yk+1 g with y1 = yk+1 = y; yk = , and (yi ; yi+1 ) 2
E(F ) [ ( ; y) for i 2 f1; : : : k 1g. The new allocation involves rotating all buyers allocated
to a good in C to its direct successor
0
a

=

(

if

a

yi+1 if

a

62 C
= yi 2 C
a

The new graph F 0 is derived from the old graph F in a series of steps by …rst reversing all of the
edges in the cycle C by replacing (yi ; yi+1 ) for all yi ; yi+1 2 C with (yi+1 ; yi ), then eliminating
(y2 ; y1 ) and …nally, replacing all (yi ; yj ) with yi 2 C and yj 62 C with (yi+1 ; yj ) so that all goods
not in P are priced by the same buyers in ( 0 ; F 0 ) as in ( ; F ).

17

6.5. Shift and Replant
Shift and Replant occurs when y is unallocated. It is similar to cyclic reversal except that
instead of relocating buyers around a cycle, we relocate them along a path.
Figure 9(a) provides an example. There are four goods. The …rst three are allocated to
like-numbered buyers. The forth good y is unallocated and hence a root good as indicated by
the rectangle to which no one is assigned. The initial GA structure ( ; F ) involves directed
edges (y1 ; y2 ) and (y2 ; y3 ). It is buyer x3 = x who then becomes indi¤erent with the unoccupied
good y. Note that we can support the same price vector, by …rst shifting the buyers along the
connected path between the two root goods, with x to y, x2 to y3 and x1 to y2 , and then using
x’s indi¤erence to price y3 , x2 ’s to price y2 . y1 is unallocated and hence priced at reservation.
This situation is illustrated in Figure 9(b).
Formally, shift and replant is characterized by the following operations. We …rst add the
edge ( ; y) and let P = fy1 ; y2 ; : : : ; ; yg denote the path in E(F )[( ; y) beginning at y1 2 R(F )
and ending with y. The change in the allocation involves shifting all buyers allocated to a
good in P to its direct successor:
0
a

=

(

if

a

yi+1 if

a

62 P
= yi 2 P
a

The new graph F 0 is derived from the old graph F . First, reverse all of the edges in the path P
by replacing (yi ; yi+1 ) for all yi ; yi+1 2 P with (yi+1 ; yi ). Then eliminate (y2 ; y1 ). Finally, replace
all (yi ; yj ) with yi 2 P and yj 62 P with (yi+1 ; yj ), so that all goods not in P are priced by the
same buyers in ( 0 ; F 0 ) as in ( ; F ).
6.6. The Fundamental Theorem of Calculus for Allocation Markets
The above results allow us to express discrete changes in prices as the integral of in…nitesimal
market changes. Consider a change for 0 to 1 along a regular path (z). Let Z^ = fz 2
[0; 1]j (z ") 6= (z + ")g denote the set of potential switch points, and label the elements
of Z^ = fz1 ; : : : zS g. Let ( s ; Fs ) denote the unique element of (z) over the interval (zs ; zs+1 ),
where it is understood that z0 = 0 and zS+1 = 1. Prior results imply that the change in the
price of good yi may be obtained by integrating the change in price over each subinterval and

18

summing over subintervals:
pi ( 1 )

pi ( 0 ) =

S Z
X
s=0

zs+1

zs

dpi
d (z)

(

s ;Fs )

d (z)
dz

!

dz

Here the derivative dpi =d (z) is taken with respect to the current GA structure ( s ; Fs ).

7. An Algorithm for Computing Competitive Equilibria
The maximization in problem (2.2) is over a very large set and may be di¢ cult to perform in
practice. A generalization of Cayley’s theorem states that for each allocation there are
m
X
k=1

m
k

!

kmm

1 k

di¤erent forests of rooted trees on the m allocated goods.7 On top of this there are n!=(n m!)
ways to allocate buyers to goods. If n = m = 10; we get more than 8:5 1015 di¤erent GAstructures. If n = m = 1000, we get more than 9 103609 .
We have shown how to use homotopy methods to move between any two competitive equilibria. This insight may be used to compute equilibria and avoid searching through such a large
set. We only need a simple equilibrium to start from. One convenient initial equilibrium is the
null equilibrium in which the preference parameters are such that each buyer prefers a di¤erent
good at reservation prices.
The algorithm works in the following way. Given any set of parameters, we initialize this
algorithm by raising the parameter a;a for each buyer xa high enough that each buyer xa prefers
ya to all other goods when prices are set at reservation levels. At this level of reservation utility,
the minimum price equilibrium has all prices at reservation level and all buyers allocated to their
preferred goods. There is a unique GA-structure corresponding to this equilibrium. It involves
the equilibrium allocation and a null graph in which all goods are root goods and there are no
edges. This equilibrium is our starting point. We can then lower the a;a to their original levels,
tracking GA-structures that correspond to the minimum price equilibrium. Note that lowering
the a;a has the e¤ect of raising prices monotonically to their …nal level.
This algorithm is related to the ascending auction mechanism of Demange, Gale and Sotomayor (1986). They consider minimum price equilibria in a model with transferable utility
7

See Aigner and Ziegler [2003, 3rd edition, p. 178].

19

and discrete prices. Their algorithm involves increasing the prices of all goods in minimal
overdemanded sets by one unit until supply and demand are brought into balance. The key
complication that non-transferable utility introduces is that the same price change a¤ects the
demands of di¤erent buyers di¤erently. The challenge is to …nd a way of raising prices that does
not completely alter the balance between supply and demand, while at the same time keeping
track of the resulting changes in the allocation. The GA structures provide such a mechanism.
There are several attractive features of this algorithm. First, it terminates by precisely
identifying the minimum equilibrium price. This is not the case with approximation methods
that are often employed in computing economic equilibria (e.g. Scarf (1973)).8 Second, the
algorithm is likely to be relatively fast in many practical applications. There is a sense in which
the algorithm is minimal: it searches only through the set of potential solutions for some set
of utility parameters and by-passes the mass of entirely unsuitable price vectors. This mirrors
the situation with the simplex method, in which one searches only through the set of extreme
points of the feasible set, all of which are optimal for some vector of resources.
7.1. From Continuous to Discrete
Practical implementation of the algorithm requires discretizing z. Figure 10 illustrates one
possibility. We begin with a known solution to to the model ( 1 ; F1 ) at z1 = 0. At each step in
the algorithm our current candidate solution ( 1 ; F1 ) which is known to generate the minimum
equilibrium price at some point z1 ; ( 1 ; F1 ) 2 (z1 ), and test whether it generates the minimum
equilibrium price at some further point z2 . Initially, we take z2 = 1.
If ( 1 ; F1 ) 2 (z2 ), this test succeeds and we reset z1 = z2 and z2 = 1. If z1 = 1, we are
…nished. Otherwise, we test ( 1 ; F1 ) at z2 = 1.
We will say that there is a “violation of competitive equilibrium”at z2 if, given q( 1 ; F1 ; (z2 )),
a buyer prefers a good to the one that he is allocated or if there is good whose price falls below
reservation. The test succeeds if there is no violations. If there is a single violation of competitive equilibrium when applying ( 1 ; F1 ) at z2 , meaning a single buyer who prefers a single good
or a single good whose price falls below reservation, then we construct ( 2 ; F2 ); which is the
alternative GA structure suggested by treating the violation as an indi¤erence and making the
appropriate market transition as in the last section, and test ( 2 ; F2 ) at z2 . If ( 2 ; F2 ) 2 (z2 ),
we update ( 1 ; F1 ) = ( 2 ; F2 ), as well as z1 = z2 , and z2 = 1 and proceed as before. If there
are multiple violations of competitive equilibrium at q( 1 ; F1 ; (z2 )) or if ( 2 ; F2 ) 62 (z2 ), then
8

Miyake (2003) also provides an algorithm with this property.

20

we stepped over multiple market transitions. We then try taking a smaller step: we update
z2 = (z1 + z2 ) =2 and try ( 1 ; F1 ) again.
Given Theorem 3, which states that there are a …nite number of points of transition on a
generic path, this algorithm converges. Eventually, the step size is reduced to the point that
(z1 ; z2 ) contains a single market transition and ( 2 ; F2 ) 2 (z2 )

8. Conclusion
In this paper and it companion, we have introduced a new mathematical apparatus for understanding allocation markets with nontransferable utility. We are currently extending the work
to a dynamic context and solving for the reallocation of objects over time. Our methods may
also apply in other areas.

21

References
[1] Caplin, Andrew, and John Leahy (2010), “A Graph Theoretic Approach to Allocation
Markets,”New York University working paper.
[2] Demange, Gabrielle, and David Gale (1985), “The Strategy Structure of Two-Sided Matching Markets,”Econometrica 53, 873-888.
[3] Demange, Gabrielle, and David Gale, and Marilda Sotomayor (1986), “Multi-Item Auctions,”The Journal of Political Economy 94, 863-873.
[4] Judd, Kenneth, (1999) Numerical Methods in Economics, Cambridge: MIT Press.
[5] Kaneko, Mamoru, (1982), “The Central Assignment Game and the Assignment Markets,
Journal of Mathematical Economics 10, 205–232.
[6] Krantz, Steven, and Harold Parks (2002), “A Primer of Real Analytic Functions,”Boston:
Birhauser.
[7] Kuhn, Harold (1955), “The Hungarian Method for the Assignment Problem,” Naval Research Logistics Quarterly 2, 83-97.
[8] Miyake, Mitsunobu (2003), “Precise Computation of a Competitive Equilibrium of the
Discrete Land Market Model,”Regional Science and Urban Economics 33, 721-743.
[9] Munkres, James (1957), “Algorithms for the Assignment and Transportation Problems,”
Journal of the Society of Industrial and Applied Mathematics 5, 32-38.
[10] Scarf, Herbert (1973), The Computation of Economic Equilibria, New Have: Yale University
Press.

9. Appendix: Proofs
Lemma 1: There exists a bijection

:M!

so that

j j = jMj
Proof: We identify a mapping : M ! and show it to be a bijection. Given E 2 M, we
identify (E) = ( (E); F (E)) starting with the allocation. We …rst match all goods of degree one.
22

If there are goods remaining in any set YlE after the removal of these goods and their matched
buyers, there is as least one of degree one, since at least one edge to the unmatched goods is
removed when the prior match is created, due to the connectedness of the components. This
process ends by uniquely specifying (E) 2 M in no more than max jYlE j steps. We construct
the graph F (E) = (Y; R; E) by …rst setting R equal to the union of Y0E and the valence 1 good
in each set YlE for l 1. We then de…ne E = f(yi ; yk )j(xa ; yi ); (xa ; yk ) 2 E and a = yi g. Since
each non-root good is allocated and has degree two, it has a unique predecessor in E. Since
each is connected to the root good by construction, each component is a tree. To establish that
: M ! , note by construction q( (E); F (E)) = p, that ( (E); F (E)) identi…es a minimum
¯
price equilibrium, and that all goods to which a directed edge points are allocated.
It remains to establish that : M ! is onto . Consider any (~ ; F~ ) 2 . We identify
~ = (~ ; F~ ) in stages. First, we generate a
the element (~ ; F~ ) = 1 (~ ; F~ ) 2 M such that (E)
bipartite graph on X [ Y with bipartition (X; Y ) by joining each buyer with the good to which
~ and then placing (xa ; yb ) 2 E~ if (~ a ; yb ) 2 F . To see
they are matched, placing (xa ; ~ a ) 2 E,
that (~ ; F~ ) 2 M; note …rst that q(~ ; F~ ) =p, hence this graph is a subset of E . To see that
¯
it satis…es the remaining aspects of condition M, look at each tree in the forest and note that
there every node of the tree has one and only one buyer due to the insistence that downstream
as well as upstream goods are allocated. Each such tree in the forest thereby is mapped to a
connected set (XlE ; YlE ) for 1 l L that is disconnected from all others, and in which the equal
cardinality condition M2 is satis…ed. The isolated set Y0E comprises all goods that are not in
demand by anyone. By construction, there is one and only one good of degree 1 in each partition
set YlE for l 1, and all others have degree 2. Moreover, by construction all goods of valence 1
are root goods for which qj = rj . By construction, goods of degree 0 also satisfy qj = rj . Hence
pi > ri implies that the degree of yi is 2. This con…rms that (~ ; F~ ) 2 M. Finally, it is direct
¯
~ = (~ ; F~ ), establishing that indeed : ! M is the inverse
from the construction that (E)
function of : M ! :
Corollary 1: E 2 M and d (yi ) = 2 =) pi > ri then j j = 1.
¯
Proof: Suppose that E 2 M and all yi with d (yi ) = 2 have pi > ri . We show that M has
¯
one element. Lemma 1 then implies j j = 1. That there is no second element follows from the
observation that since E 2 M all goods have degree less than or equal to two. Removing any
edge from the demand graph D reduces the degree of some good. If the degree falls from one to
zero, then the number of goods with degree greater than zero is less than the number of buyers
23

in contradiction of condition M4. If a good has degree two in D, then by assumption its price
is above reservation. Reducing the degree of such a good contradicts condition M5.
Theorem 1: j j = 2 if and only if there exists (x; y) 2 E such that E =(x; y) 2 U.
Proof: (If) Suppose that there exists (x; y) 2 E such that E =(x; y) 2 U. To establish
j j = 2, let E1 = E =(x; y). We consider a number of sub-cases and in each such case identify
E2 6= E1 with E2 2 M. We then show that there is no third member E3 2 M. The argument
depends on features of 2 Y , the good matched to x in the unique match associated with
E1 2 U.
1. If y 2 Y0E1 , let
2 Y be the root good in the set YlE1 such that x 2 XlE1 , and let
1
( ) 2 XlE1 be the buyer matched to that good. De…ne E2 = E =f 1 ( ); g. Note that
E2 2 U by construction, since the only change is the replacement of 2 YlE1 with the good
y 2 YlE2 , also of valence 1. Now suppose that there exists some third element E3 2 M,
with E3 2
= fE1 ; E2 g. Note that this set must contain both f 1 ( ); g and (x; y) given that
uniqueness holds with either element excluded. Hence some other edge from those joining
XlE1 and YlE1 must be removed, thereby reducing the degree of some element other than
or y either to 1 or to zero. This contradicts the fact that this good must have pi > ri ,
¯
which implies that its degree in E2 must be 2 by M4.
2. Suppose ( ; y)
YlE1 for some l
1. Note in this case that E itself has a cycle, since
E1
E1
it Xl [ Yl has as many edges as vertices in E : this cycle is unique, since all cycles
must contain fx; yg, so that if there were two of them, then there would have been one
prior to the addition of fx; yg (geometrically clear). Now de…ne fxC ; yg as the unique
edge other than (x; y) heading to y in this unique cycle in the graph (X [ Y; E ). De…ne
E2 = E =fxC ; yg. By construction, E2 6= E1 satis…es E2 2 U, since all goods have the same
valence in E2 and E1 , and the associated partitions are identical. Now suppose that there
exists some third element E3 2 M, with E3 2
= fE1 ; E2 g. This set must contain both fxC ; yg
and (x; y) given that uniqueness holds with either element excluded. Hence some other
edge in the unique cycle must be removed. In so doing, one reduces the degree of some
good other than y 2 YlE1 below 2. This again contradicts the fact that this good must
have p i > ri , which implies that its degree in E2 must be 2 by M4.
3. Suppose 2 YlE1 and y 2 YmE1 with m 2
= f0; lg. There are two sub-cases depending on the
valence of y.
24

1. If y is of valence 2 in E1 then de…ne E2 = E =fxN ; yg, where xN is the element in YlE
that is not matched to y in unique match (E1 ). Note that E2 2 U, since one now has
two sets with root goods of valence 1 at reservation and all others of valence 2, in line
with the uniqueness condition. Again any third element E3 2 M, with E3 2
= fE1 ; E2 g
N
must include both fx ; yg and (x; y), but exclude some other element of the edge set
E
corresponding to XlE [ Xm
; YlE [ YmE . However this happens, it calls for there to be
at least two elements of valence 1 since the resulting set is disconnected, but there is
by assumption only one good at reservation price in the set, a contradiction.
2. If y is of valence 1 in E, then E 2 M since the joint set YlE [ YmE has all but
one good of valence 1, which good is at reservation price. Now suppose that there
exists some third element E3 2 M, with E3 2
= fE1 ; E g. Since E =(x; y) satis…es the
uniqueness condition, this set must contain (x; y) and exclude something from the
E
; YlE [ YmE . As before, it will create some good
edge set corresponding to XlE [ Xm
with pi > ri yet with degree strictly, a contradiction.
¯
4. An adaptation of case 3(b) works in case 2, with E 2 M and existence of one and only
one yj 2 Y such that d (yj ) = 2 and pj = rj . Since E 2 M, there is a unique allocation
¯
(E ) consistent with E . Identify the unique element xN
j 2 X that is to linked yj but not
matched to it according to this allocation . Note that E =fxN
j ; yj g = E1 2 U, since yj has
valence 1 and is a root good with the removal of its second edge, with all of the matches
preserved. Now suppose that there exists some third element E3 2 M, with E3 2
= fE1 ; E g.
N
This set must contain fxj ; yj g given that uniqueness holds with it excluded, and it cannot
be the whole set, since this is E . Hence some other edge must be removed from the
partition element XlE [ YlE that contains yj . If this is of degree 1 , then there is one too
few good: if it is any of the degree 2 goods, then one reduces the degree of some good with
pi > ri below 2, a contradiction.
¯
(Only If) If j j = 2 then certainly E has some subset that satis…es the uniqueness condition
of corollary 1. It can have at most one more edge, since if it had two, then we know from above
proof how to create at least three members of M. If it has no more edges than E , then it must
contain at least one more good at reservation price than in that minimum, and we know that it
cannot contain more than that, since then the proof above shows can …nd at least one for each
additional good at reservation. This completes the proof.

25

Lemma 2: With Assumptions A and B, each qi ( ; F; ) is analytic in 2 ; ( ) is non-empty,
compact-valued, and upper-hemicontinuous; and each pi ( ) is continuous.
¯
Proof: We prove the qi ( ; F; (z)) are analytic by induction. Consider …rst yi 2 R(F ) A0 .
gi = ri which is trivially analytic in . Now suppose that for all yi 2 An , gi are analytic functions
of . Consider S, the set of direct successors to An . S = fyi 62 An j(yj ; yi ) 2 E(F ) for some
yj 2 An g. Let a = yj . Now qj is de…ned implicitly by the indi¤erence of xa :
Ua (yi ; qi ;

ai )

= Ua (yj ; qj ;

aj )

where according to Assumption B, Ua (yj ; qj ; ai ) and Ua (yi ; qi ; aj ) are analytic functions of their
second and third arguments and strictly monotonic in the third. Assumption A ensures that
Ua is strictly monotonic in the second. It follows from the Real Analytic Implicit Function
Theorem (Krantz and Parks, 2002, p. 35) that qi is an analytic function of . This completes
the induction step.
That ( ) is non-empty, compact-valued, and upper-hemicontinuous; and each pi ( ) is con¯
tinuous follows from Theorem 3 in CL.
The following Lemmas are used in the proof of Theorem 3. The proof of Theorem 3 is divided
between three propositions which together establish that R is open and dense in S .
Lemma 3: For each yi , qi ( ; F; (z)) is real analytic on z 2 (0; 1).
Proof: According to Lemma 2, Assumptions A and B imply that qi ( ; F; ) is real analytic
on 2 . Assumption C states that is real analytic on z 2 (0; 1). That the qi ( ; F; (z))
are analytic follows from the observation that compositions of analytic functions are analytic
(Kranz and Parks, p.19).
Lemma 4: Given any three GA structures, ( 1 ; F1 ), ( 2 ; F2 ), and ( 3 ; F3 ), let ~ denote the
set 0 such that j (z; 0 ; S) \ f( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )gj 2 for all z. ~ is open.
Proof: Consider 0 2 ~ and let B = f 2 jf( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )g 2 ( )g. The
upper hemicontinuity of implies then implies B is closed. Since B is bounded, it is compact.
Given ; 0 2 , let d( ; 0 ) denote the Euclidian distance between and 0 and let d(z) =
min 2 B d( (z; 0 ; S); ). B is compact so the minimum problem is well de…ned. d( ; 0 ) is
continuous in both arguments, so the Theorem of the Maximum states that d(z) is continuous.
26

Since z 2 [0; 1], d(z) has a minimal value. Let = min d(z). Since the path and the set B
are disjoint > 0. It follows that a ball around 0 with radius =2 is contained in ~ . This
establishes that ~ is open.

Lemma 5: Given 2 such that j ( )j > 2, there exists f( 1 ; F 1 ); ( 2 ; F 2 )( 3 ; F 3 )g
( )
mn+n
and l 2 R
with d(l; 0) = 1 such that given any > 0 and = l such that + 2 ,
f( 1 ; F 1 ); ( 2 ; F 2 )g
( + ) and ( 3 ; F 3 ) 62 ( + ).
Proof: Fix
2
and such j ( )j > 2. Let ( 1 ; F 1 ) 2 ( ). Since j ( )j > 2, the
arguments of Theorem 1 can be extended to show that there must be either to goods y1 and y2
such that yj 62 R(F 1 ) and qj ( 1 ; F 1 ; ) = rj ( ) for j = f1; 2g; or two sets of indi¤erence (xa ; y1 )
and (xa ; y2 ) such that f(xa ; y1 ); (xb ; y2 )g 2 E , y1 is not equal to 1a or any of its direct successors
in F 1 , y2 is not equal to 1b or any of its direct successors in F 1 ; or one of each.
(1) Construct ( 2 ; F 2 ) as equal to ( 1 ; F 1 ) except that y1 2 R(F 2 ). Similarly, ( 3 ; F 3 )
has y1 ; y2 2 R(F 2 ). Now let (yk ; y1 ) 2 E(F 1 ) and yk = 1 (xa ). Let be a vector of zeros
with a value ^ < 0 in the place associated with a1 . q( 2 ; F 2 ; + ) = q( 2 ; F 2 ; + ) =
q( 2 ; F 2 ; ). q1 ( 1 ; F 1 ; + ) < r1 ( 1 ; F 1 ; + ). It follows that ( 1 ; F 1 ) 62 ( + ). Need
f( 1 ; F 1 ); ( 3 ; F 3 )g 2 ( + ).
(2) Construct ( 2 ; F 2 ) as the other structure given (xa ; y1 ) 2 E . Similarly ( 3 ; F 3 ) as
the other structure given (xb ; y2 ) 2 E . Note that y2 is not equal to 2a or any of its direct
successors in F 2 . Let be a vector of zeros with a value ^ < 0 in the place associated with b2 .
( 3 ; F 3 ) 62 ( + ). q( 1 ; F 1 ; + ) = q( 2 ; F 2 ; + ) = q( 1 ; F 1 ; ).
(3) Construct ( 2 ; F 2 ) as equal to ( 1 ; F 1 ) except that y1 2 R(F 2 ), and construct ( 3 ; F 3 )
as the other structure given (xa ; y1 ) 2 E . Let be a vector of zeros with a value ^ < 0 in the
place associated with a1 . ( 3 ; F 3 ) 62 ( + ). q( 1 ; F 1 ; + ) = q( 2 ; F 2 ; + ) = q( 1 ; F 1 ; ).
The proof is completed by the observation that the only property of used in the proof is
its direction.

Proposition (Theorem 3, Part 1):

R

is open.

Proof: The proof is in two parts. We …rst prove that the set of initial conditions for which
j (z)j 2 is open. We then prove that the set of initial conditions for which Z is …nite is open.
The intersection of two open sets is open.
(1) The set of 0 for which j (z; 0 ; S)j 2 is open.
27

Given S, let 1 be the set of initial conditions 0 such that j (z; 0 ; S)j
2 for all z 2
[0; 1]. Let ~ [( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )] denote the set 0 such that there exists z such that
j (z; 0 ; S)j \ f( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )g
2. 1 = \ ~ [( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )] where the
intersection is over all triplets of GA structures. Each ~ [( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )] is open by
Lemma 4. Since …nite intersections of open sets are open, 1 is open.
(2) The set of 0 for which Z is …nite is open.
Given 0 , let Z = fz 2 [0; z]jj (z; 0 ; S)j > 1g. Given S, let 2 be the set of 0 such
that Z is …nite. Consider 0 2 2 . The proof is by contradiction. Given " > 0, let B" ( ) =
f 0 jd( ; 0 ) < "g. Suppose that for all " > 0; there exists 0 2 B" ( 0 ) such that Z( 0 ) is in…nite.
Consider a sequence f"n g converging to zero and consider a sequence n such that n 2 B" ( 0 )
and Z = fz 2 [0; z]jj (z; n ; S)j > 1g is in…nite. Given that there are a …nite number of GA
structures, there exists a subsequence f m g f n g and two GA structures, ( 1 ; F1 ) and ( 2 ; F2 ),
such that q( 1 ; F1 ; (z; m ; S)) = q( 2 ; F2 ; (z; m ; S)) at in…nitely many points z 2 (0; 1). By
Lemma 3, qi ( 1 ; F1 ; (z; m ; S)) and qi ( 2 ; F2 ; (z; m ; S)) are real analytic on z 2 (0; 1). Given
^
a < 0 and b > 1, let S(z)
: (a; b) ! Rmn+n be the (component by component) analytic
continuation of S. Given the continuity of S, we can choose a, b, and "m small enough that
^
^
for all z 2 (a; b). Let q^i ( ; F; z; m) = qi ( ; F; m + S(z)).
Standard
m + S(z) are contained in
arguments establish that and q^i ( ; F; z; m) is analytic and q^i ( ; F; z; m) = qi ( ; F; (z; m ; S))
on [0; 1]. It follows that q^i ( 1 ; F1 ; z; m) = q^i ( 2 ; F2 ; z; m) at an in…nite number of points in [0; 1].
Let U denote the set of intersections. It has an accumulation point in [0; 1] (a; b). Corollary
1.2.7 in Krantz and Parks implies that q^i ( 1 ; F1 ; z; m) = q^i ( 2 ; F2 ; z; m) for all z = (a; b). It
follows that q( 1 ; F1 ; (z; m ; S)) = q( 2 ; F2 ; (z; m ; S)) for z 2 [0; 1]. The continuity of the
q( ; F ) then implies that q( 1 ; F1 ; (z; 0 ; S)) = q( 2 ; F2 ; (z; 0 ; S)). But 0 2 2 . This
contradiction establishes that 2 is open.
R = 1 \ 2 each of which is open. This completes the proof.
Proposition (Theorem 3, Part 2) Let Z 1 ( 0 ) = fz 2 [0; z]jj (z)j > 1g and let
f 0 jZ( 0 ) is …niteg. With A-C, F is dense in S .

F

=

Proof: Given 0 , let Z = fz 2 [0; z]jj (z; 0 ; S)j > 1g. Let I 2 S denote the set of
I
, we can perturb 0 and obtain
0 2 S such that Z is in…nite. We show that given any 0 2
a path for which Z is …nite.
We …rst prove that for each yi , pi (z) is real analytic on (0; 1) except at a …nite number of
¯
points. The proof is by contradiction. Let A = fz 2 (0; 1)jpi ( (z)) is not analytic at zg. Suppose
¯
28

jAj = 1. Since jAj = 1, there exists an accumulation point z1 2 [0; 1].9 Consider an arbitrary
z1 2 A. There exists ( 1 ; F1 ) such that pi ( (z1 )) = qi ( 1 ; F1 ; (z1 )). Moreover, given any neigh¯
borhood of z1 , if pi ( (z)) = qi ( 1 ; F1 ; (z)) for all z 2 then pi is analytic at z. It follows
¯
¯
that there exists there a z2 2 such that pi ( (z2 )) 6= qi ( 1 ; F1 ; (z2 )). Given the continuity of
¯
the qi ( ; F; (z)), this implies that there are two GA structures, ( 1 ; F1 ) and ( 2 ; F2 ), such that
qi ( 1 ; F1 ; (z)) = qi ( 2 ; F2 ; (z)) at some point in . As z1 is arbitrary and A is …nite, there exist
an in…nite number of these intersections. Given that there are a …nite number of GA structures,
there are two GA structures, ( 3 ; F3 ) and ( 4 ; F4 ) such that qi ( 3 ; F3 ; (z)) = qi ( 4 ; F4 ; (z))
at in…nitely many points and qi ( 3 ; F3 ; (z)) 6= qi ( 4 ; F4 ; (z)) at in…nitely many points. Given
qi ( 3 ; F3 ; (z)) and qi ( 4 ; F4 ; (z)) are both analytic, qi ( 3 ; F3 ; (z)) = qi ( 4 ; F4 ; (z)) at in…nitely many points implies qi ( 3 ; F3 ; (z)) = qi ( 4 ; F4 ; (z)) at all z 2 (0; 1). This contradiction
establishes that A is …nite.
We return to the proof of the proposition. Suppose 0 2 I . Since p is piecewise analytic,
¯
we can divide [0; 1] into a …nite number of sub-intervals f[0; z1 ); (z1 ; z2 ); : : : (zT ; 1]g such that p
¯
is analytic on each subinterval.10 Note that on each interval (zi ; zi+1 ), (z) is constant except
at a …nite number of points, for if there is any GA structure ( 1 ; F1 ) such that pi ( (z)) =
¯
qi ( 1 ; F1 ; (z)) at an in…nite number of points in (z1 ; z2 ), then either (z) = f( 1 ; F1 )g or
( 2 ; F2 ) 2 (z) and qi ( 1 ; F1 ; (z)) = qi ( 2 ; F2 ; (z)) so that ( 1 ; F1 ) 2 (z) as well since both
are analytic on [0; 1].
Let ci denote the number of elements of (z) on interval (zi ; zi+1 ) except possibly at a …nite
number of points. Given an interval in which ci > 1, we show that we can perturb 0 and reduce
ci by one without raising any other cj . Given that there are …nitely many intervals with values
of ci > 1, a …nite number of such perturbations will reduce Z to a …nite set.
Suppose ci > 1. We consider two cases. First, suppose that qi ( 1 ; F1 ; (z)) > ri ( (z))
for yi 62 R(F1 ) and z 2 (zi ; zi+1 ). According to Corollary 1, j (z)j > 1 if and only if there
exists xb and y0 2 Db (q( 1 ; F1 ; ) such that y0 6= b and ( b ; y0 ) 62 E(F1 ). Consider a small
perturbation of 0 in which we reduce the element associated with b0 by "b0 for all such y0 .
Call this perturbation 00 and let 0 (z) denote the new path originating from 00 . We choose
the "b0 small enough that 00 2 S . It follows from Corollary 1, that ( 2 ; F2 ) 62 ( 1 (z)) for
z 2 (zi ; zi+1 ). Note that since qi ( 1 ; F1 ; (z)) = qi ( 2 ; F2 ; (z)) on [0; 1], ( 2 ; F2 ) 62 ( 1 (z)) for
all z. The perturbation does not raise (z) at any other point.
9

If z1 = f0; 1g we will need to extend all functions as in the previous proposition to (a; b) [0; 1] so that the
accumulation point lies in an open set.
10
Note that if needed we can imbed the closed interval in an open interval and extend all functions to the open
interval.

29

Second, suppose that qi ( 1 ; F1 ; (z)) = ri ( (z)) for some yi 62 R(F1 ). In this case we consider
a perturbation in which we increase the component of 0 associated with ri . Call this perturbation 00 and let 0 (z) denote the new path originating from 00 . It is clear that ( 1 ; F1 ) 62 ( (z))
for z 2 (zi ; zi+1 ). Similarly the perturbation does not raise at any other point.
This completes the proof of the proposition.
Proposition (Theorem 3, Part 3) With A-C,

R

is dense in

F.

Proof: Let (z; 0 ) denote the path beginning at 0 , let (z; 0 ) denote the GAME correspondence along this path, and let Z 2 ( 0 ) = fz 2 [0; 1]jj (z; 0 )j > 2g denote the set of points
along the path at which (z; 0 ) takes more than two values.
To show that R is dense in F we show that given an arbitrary 0 2 F such that Z 2 ( 0 )
0
0
is not empty, we can construct a perturbation of 0 , 0 2 F , such that Z 2 ( 0 ) is empty.
The construction is inductive. Let denote the set possible three pairs of
= ff( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )gjf( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )g 2 Gg
n

Since jGj is …nite, j j = N < 1. At each step we choose an initial condition 0 2 F and
a radius n > 0, such that (1) for some n not previously considered the set fz 2 [0; 1] j
n
n 1
n
(z; 0 )g is empty for all 0 2 B n ( 0 ); and (2) B n ( 0 ) B n 1 ( 0 ), where B ( 0 ) =
n
f jd( ; 0 ) < g. The second condition ensures that the sets fz 2 [0; 1] j i
(z; 0 )g is empty
n
n
for all 0 2 B n ( 0 ) and i < n. The iteration stops when Z 2 ( 0 ) is empty. This must happen
in fewer than N steps.
0
0
Initially, we choose 0 = 0 and 0 > 0 such that B 0 ( 0 )
S . This choice is possible given
0
0
0
that S is open. It will be useful below to choose
such that the closure of B 0 ( 0 ), B 0 ( 0 ),
0
is contained in S . Let X = f j = (z; 0 ) for some 0 2 B 0 ( 0 )g. X
is compact since
P
is bounded. It follows that the function f : X ! R such that f ( ; F; ) = i gi ( ; F; ),
being a continuous function from a compact metric space X to a metric space R, is uniformly
continuous on X.
n 1
n 1
n 2
The induction step begins with n 1 > 0, 0 2 F , such that B n ( 0 ) B n 1 ( 0 )
0
n 1
B 0 ( 0 ) and Z 2 ( 0 ) is not empty.
n 1
n 1
n
Given Z 2 ( 0 ) is not empty, there exists z1 such that j (z1 ; 0 )j > 2. Let ^ = (z1 ; 0 ).
It follows from Lemma 5 and the convexity of that there exists f( 1 ; F 1 ); ( 2 ; F 2 )( 3 ; F 3 )g
n
( ^ ) and l 2 Rmn+n such that d(l; 0) = 1 such that for 2 (0; n 1 ), f( 1 ; F 1 ); ( 2 ; F 2 )g
( ^ + l) and ( 3 ; F 3 ) 62 ( ^ + l). .
30

n 1
Any < n 1 ensures that ^ + l 2 B n 1 ( 0 ). We must be careful, however, that we
do not shift 0 so far that we create new points at which n
( (z; 0 ). To this end,
n 1
n 1
3
3
4
4
5
5
^
let Z = fzj( ; F ) 62 (z; 0 ) and there exist f( ; F ); ( ; F )g
(z; 0 )g and let
n 1
n 1
n 1
n 1
^" = minz2Z^ f ( 3 ; F 3 ; (z; 0 )) f ( 1 ; F 1 ; (z; 0 )) . 0 2 F implies Z 1 ( 0 ) is …nite.
n 1
Z^ Z 1 ( 0 ) implies Z^ is …nite. Z^ …nite implies that ^" > 0. Since f ( 3 ; F 3 ; ) is uniformly continuous on X, there exists 1 such that d( ; 0 ) < 1 implies d(f ( 3 ; F 3 ; ); f ( 3 ; F 3 ; 0 )) < ^"=2.
n 1
Since all paths (z; 0 ) have the same shape, d( ; 0 ) < 1 implies d(f ( 3 ; F 3 ; (z; 0 )); f ( 3 ; F 3 ; (z;
^"=2 for all z 2 [0; 1]. If we choose > 0 such that < minf n 1 ; 1 g, then fz 2 [0; 1] j
n 1
n
(z; 0 + l)g is empty. We …x 2 (0; minf n 1 ; 1 g).
Lemma 4 states that the set of 0 such that j (z; 0 ; S) \ f( 1 ; F1 ); ( 2 ; F2 ); ( 3 ; F3 )gj
2
n 1
for all z 2 [0; 1] is open. Hence there exists a neighborhood of 0 + l, , such that fz 2 [0; 1]
n 1
n 1
j n
(z; 0 + l)g is empty for all 0 2 and
B n 1 ( 0 ). Given Assumptions A-C,
the previous proposition states that F is dense in S and hence there exists 00 2 \ F . We
n
n
n 1
set 0 = 00 . We choose n such that B n ( 0 )
B n 1 ( 0 ). This complete the induction
step and the proof.

31

0 ))

<

y6
x5

y5

x4

y4

x3

y3

x2

y2

x1

y1

y5

y3

y2

Figure 1(a)

y4
y1

Figure 1(b)

y6

y3
x2
x1

y3

y3

y2

x2

y2

y2

y1

x1

y1

y1

Figure 2(a)

Figure 2(c)

Figure 2(b)

x3

y3

x3

y3

y3

x2

y2

x2

y2

y2

x1

y1

x1

y1

y1

Figure 3(c)

Figure 3(b)

Figure 3(a)

x3

y3

x3

y3

y3

x2

y2

x2

y2

y2

x1

y1

x1

y1

y1

Figure 4(a)

Figure 4(b)

Figure 4(c)

µ
µ

y

Figure 5(b)

Figure 5(a)

NEW ROOT

Figure 6 (a)

Figure 6(b)

y

µ

µ

y

y

Figure 7(a)

y
y

µ
µ

Figure 7(b)

(x3, µ)

(x2, µ)

(x2, y2)

(x1, y2)

(x1, y)

(x3, y)

Figure 8(b)

Figure 8(a)

(x2, y2)

(x2, y1)

(x3, µ)

(x1, µ)

y
(x1, y1)

Figure 9(a)

(x3, y)
y1

Figure 9(b)

Begin with
z1=0, z2=1, (µ1 ,F1) ε Φ(0)

Is q(µ1,F1 λ(z2)) a
competitive equilibrium?

z2=1?
yes

DONE
yes

no

no

Single violation of competitive equilibrium?
yes

no

Calculate
(µ2 ,F2)

Is q(µ2,F2 λ(z2)) a
competitive equilibrium?
no

Set z1=z1;
z2=( z1+z2)/2;
µ1 = µ1;
F1=F1.

Set z1=z2;
z2=1;
µ1 = µ1;
F1=F1.

yes

Set z1=z2;
z2=1;
µ1 = µ2;
F1=F2.

Figure 10: Flow Chart Describing Algorithm for Calculating Φ(1) from Φ(0)

