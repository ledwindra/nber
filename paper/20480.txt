NBER WORKING PAPER SERIES

ASSET MANAGEMENT CONTRACTS AND EQUILIBRIUM PRICES
Andrea M. Buffa
Dimitri Vayanos
Paul Woolley
Working Paper 20480
http://www.nber.org/papers/w20480

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
September 2014, Revised October 2019

We thank Ricardo Alonso, Daniel Andrei, Oliver Bought, Jennifer Carpenter, Sergey Chernenko,
Chris Darnell, Peter DeMarzo, Philip Edwards, Ken French, Willie Fuchs, Diego Garcia, Jeremy
Grantham, Zhiguo He, Apoorva Javadekar, Ron Kaniel, Ralph Koijen, Dong Lou, John Moore,
Dmitry Orlov, Marco Pagano, Anna Pavlova, Gabor Pinter, seminar participants at the Bank of
England, Banque de France, Bocconi, Boston University, CEU, Cheung Kong, Dartmouth, Duke,
EIEF, Glasgow, Indiana, Insead, Louvain, LSE, Maryland, Minnesota, MIT, Naples, NY Fed,
SMU, Stanford, Toulouse, UT Austin, Yale, Vienna and conference participants at AEA, ASAP,
BoE Macro-Finance, BIS, CEMFI, CRETE, ESSFM Gerzenzee, FCA, FIRS, FRIC, FTG, Inquire
UK, Jackson Hole, LSE PWC, NBER Asset Pricing, SFS Cavalcade, Utah, and WFA for helpful
comments. The views expressed herein are those of the authors and do not necessarily reflect the
views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
Â© 2014 by Andrea M. Buffa, Dimitri Vayanos, and Paul Woolley. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including Â© notice, is given to the source.

Asset Management Contracts and Equilibrium Prices
Andrea M. Buffa, Dimitri Vayanos, and Paul Woolley
NBER Working Paper No. 20480
September 2014, Revised October 2019
JEL No. D86,G12,G14,G18,G23
ABSTRACT
We derive equilibrium asset prices when fund managers deviate from benchmark indices to
exploit noise-trader induced distortions but fund investors constrain these deviations. Because
constraints force managers to buy assets that they underweight when these assets appreciate,
overvalued assets have high volatility, and the risk-return relationship becomes inverted. Noise
traders bias prices upward because constraints make it harder for managers to underweight
overvalued assets, which have high volatility, than to overweight undervalued ones. We
endogenize the constraints based on investors' uncertainty about managers' skill, and show that
asset-pricing implications can be significant even for moderate numbers of unskilled managers.

Andrea M. Buffa
Department of Finance
Boston University
595 Commonwealth Avenue
Boston, MA 02215
buffa@bu.edu
Dimitri Vayanos
Department of Finance, OLD 3.41
London School of Economics
Houghton Street
London WC2A 2AE
UNITED KINGDOM
and CEPR
and also NBER
d.vayanos@lse.ac.uk

Paul Woolley
Financial Markets Group
London School of Economics
London WC2A 2AE
UNITED KINGDOM
p.k.woolley@lse.ac.uk

1

Introduction

Financial markets have become highly institutionalized. For example, individual investors were
holding directly 47.9% of U.S. stocks in 1980, but only 21.5% in 2007, with most of the remainder held by financial institutions such as mutual funds and pension funds (French (2008)). The
portfolios of these institutions are chosen by professional asset managers.
The institutionalization of financial markets has stimulated research on the performance of
professional managers and their effects on equilibrium asset prices and market efficiency. A vast
literature examines whether actively-managed funds outperform passively-managed ones. A related
literature investigates whether the growth of passive funds has made markets less efficient, and
whether efficiency increases in the ratio of active to passive.1
Drawing a sharp distinction between passive funds constrained to hold specific portfolios, and
active funds investing without constraints, is in some ways misleading. This is because much of
active management is done around benchmark portfolios, with managers being constrained in how
much they can deviate from them. The constraints can bound a managerâ€™s tracking error (standard
deviation of the difference between the managerâ€™s portfolioâ€™s return and the return of a benchmark
portfolio), or the difference between the weight that the manager allocates to each asset class,
geographical area, or industry sector, and the corresponding benchmark weight.2 Viewing asset
management as a continuum between active and passive, depending on the tightness of managersâ€™
constraints, seems a better description of reality. In this paper we adopt that alternative view and
show that its implications for equilibrium asset prices and market efficiency differ significantly from
the conventional view.
A simple example helps motivate our analysis. Suppose that some asset managers must keep
their portfolio weight in each industry sector within 5% of the sectorâ€™s weight in a benchmark
portfolio. Suppose also that a sector that these managers view as overvalued has 10% weight in
the benchmark, while the managers give it 5% weight. If the sector doubles in value, reaching 20%
weight in the benchmark, then its weight in the managersâ€™ portfolio doubles to 10%, but must rise
1

See, for example, Elton and Gruber (2013) for a survey of the literature on mutual-fund performance, and
Franzoni, Ben-David, and Moussawi (2017) for a survey of exchange-traded funds (ETFs) and their effects on market
performance.
2
For a discussion of tracking-error constraints and their implications for financial markets, see the 2003 report by
the Committee on the Global Financial System (BIS (2003)). According to that report, bounds on tracking error
are on average 1% for actively-managed bond portfolios and between 2-6% for actively-managed stock portfolios
(p.20). The Norwegian Sovereign Wealth Fund (NBIM), one of the largest institutional investors globally, reports
the following regarding its tracking-error constraint: â€œThe Ministry of Finance has set limits for how much risk
NBIM may take in its active management of the fund. The most important limit is expressed as expected relative
volatility (tracking error) and puts a ceiling on how much the return on the fund may be expected to deviate
from the return on the benchmark portfolio. The expected tracking error limit is 125 basis points, or 1.25%.â€
(https://www.nbim.no/en/investments/investment-risk/)

1

further to 15% so that the constraint is met. Buying pressure by the managers amplifies the sectorâ€™s
appreciation, raising its volatility. Overvalued sectors thus have high volatility, in addition to their
low expected return, causing the risk-return relationship to become weak or inverted, consistent
with empirical evidence.3 Amplification does not arise when managers are constrained to hold the
benchmark portfolio, or when they are fully unconstrained. The example implies additionally that
overvaluation is harder to correct than undervaluation. Indeed, managers must stick closer to the
benchmark in overvalued sectors: a 5% difference in weight allows less leeway in relative terms when
the sectorâ€™s benchmark weight is large. The links between portfolio constraints of asset managers
and amplification or overvaluation have been recognized by policy-makers.4
In our modelâ€™s basic version, described in Section 2, investors can invest in a riskless and a risky
asset over an infinite horizon and continuous time. The riskless rate is constant, and the dividend
flow per share of the risky asset follows a square-root process. Investors maximize a mean-variance
objective over instantaneous changes in wealth. Some investors are unconstrained, while others
face a constraint limiting the volatility or the dollar value of the deviation between their risky-asset
position and a benchmark position. Investors may want to deviate from the benchmark position
to exploit price distortions caused by noise traders.
Section 3 derives the equilibrium price of the risky asset taking the constraint as exogenous
and not distinguishing between investors and the asset managers they employ. Two polar cases
are analyzed first: no constraint, in which case all investors are fully active; and an infinitely tight
constraint, in which case constrained investors must hold the benchmark position and hence are
fully passive. In both cases, we derive a novel closed-form solution for the price and show that it
is affine in the dividend flow. An increase in noise-trader demand raises the price and lowers the
assetâ€™s expected return. It does not affect, however, the assetâ€™s return volatility: the price becomes
more sensitive to the dividend flow, but the effect is proportional to the increase in the price level.
Moving from no constraint (all investors fully active) to an infinitely tight constraint (constrained
investors fully passive) exacerbates the price distortions created by noise traders. This is because
the constraint prevents constrained investors from absorbing noise-trader demand. The constraint
does not affect return volatility, however, because volatility is independent of demand.
Section 3 next analyzes the general case. The equilibrium involves a region where the constraint
3

References to the empirical literature are in Section 3.4.
For example, the BIS (2003) report notes: â€œOvervalued assets/stocks tend to find their way into major indices,
which are generally capitalization-weighted and therefore will more likely include overvalued securities than undervalued securities. Asset managers may therefore need to buy these assets even if they regard them as overvalued;
otherwise they risk violating agreed tracking errors.â€ (p.19). In a similar spirit, a 2015 IMF working paper (Jones
(2015)) notes: â€œAnother source of friction capable of amplifying bubbles stems from the captive buying of securities
in momentum-biased market capitalization-weighted financial benchmarks. Underlying constituents that rise most
in price will see their benchmark weights increase irrespective of fundamentals, inducing additional purchases from
fund managers seeking to minimize benchmark tracking error.â€
4

2

does not bind, and a region where it binds. The constraint binds for high values of the assetâ€™s dividend flow because the assetâ€™s price and volatility per share are high. The price in each region
is characterized by a second-order ordinary differential equation (ODE), with smooth-pasting between regions. While the solution to the ODE system is not linear and not closed-form, we show
analytically that it exists under general conditions and has a number of key properties.
One property of the price function is that it is convex in the dividend flow when noise-trader
demand is high, and concave when demand is low. The convexity reflects the amplification effect.
The concavity reflects the opposite dampening effect: since constrained investors give higher weight
to an undervalued sector relative to the sectorâ€™s benchmark weight, they need to sell the sector when
it appreciates, dampening the appreciation. Amplification and dampening generate an inverted
risk-return relationship, which we interpret as a cross-sectional one by extending our model to
multiple risky assets: assets with high noise-trader demand have high volatility and low expected
return, while assets with low demand have low volatility and high expected return. Moving from
no constraint (all investors fully active) to intermediate levels of the constraint raises the volatility
of high-demand assets and lowers that of low-demand assets. The same occurs when moving from
an infinitely tight constraint (constrained investors fully passive) to an intermediate one.
A second property of the price function is that it is convex in noise-trader demand: high demand
raises the price more than low demand lowers it. Intuitively, since high-demand assets have higher
volatility per share than low-demand assets, investors are less willing to trade against the former
assetsâ€™ overvaluation than against the latter assetsâ€™ undervaluation. The asymmetry arises even
without the constraint, but becomes significantly more pronounced with the constraint. Because
of the asymmetry, portfolios with more heterogeneous noise-trader demand across their component
assets earn lower expected returns than portfolios with less heterogeneity and same average demand.
Section 4 endogenizes the constraint in a contracting model and revisits the asset-pricing analysis. We interpret the unconstrained investors as observing noise-trader demand and the dividend
flow, and the constrained investors as being uninformed. Each uninformed investor can employ
an asset manager, who may be skilled and observe these variables, or unskilled and observe an
uninformative signal that she wrongly treats as informative. A contract consists of a fee that can
depend on the investorâ€™s wealth, and a set in which the managerâ€™s deviation from a benchmark
position must lie. We consider contracting over two periods, interpreting investors and managers
as overlapping generations, and take the limit when the time between periods becomes small.
The optimal fee aligns the managerâ€™s risk preferences with those of the investor. The investor
must guard, however, against the possibility that the manager is unskilled, and does so by restricting
the managerâ€™s deviation from the benchmark position. The optimal set in which the deviation must
lie is an interval ranging from zero to a positive bound. This yields the constraint assumed in Section
3

3. The optimal bound is infinite (no constraint) when the probability that the manager is skilled
is one, and converges to zero (infinitely tight constraint) when that probability goes to zero.
The asset-pricing analysis of Section 3 carries through to an endogenous constraint. Endogenizing the constraintâ€™s parameters imposes tighter structure and allows us to express the asset-pricing
effects in terms of more primitive quantities, such as the fraction of unskilled managers. In a numerical example, we find that the spread in expected return and volatility across assets with high
and low noise-trader demand can be significant even for a moderate fraction of unskilled managers.
An additional advantage of endogenizing the constraint is that we can determine effective capital. Suppose that ten trillion dollars are invested through asset managers, and the fraction of
unskilled managers is 20%. How much of the ten trillion if invested through skilled managers without any constraints would result in the same degree of market efficiency? That amount is lower
than eight trillion because the presence of unskilled managers imposes constraints on the skilled
ones. We find that the amount is about four trillion. Hence, abstracting away from managersâ€™
constraints can overstate significantly the available capital to correct price distortions.
Our paper relates to several strands of work on asset management and asset pricing. One literature concerns the performance of active versus passive funds, and their impact on market efficiency.
That literature builds on the seminal paper by Grossman and Stiglitz (1980), in which informed
and uninformed investors trade with noise traders, there is a cost to becoming informed, and price
informativeness increases in the fraction of the informed. In Subrahmanyam (1991), the introduction of index futures induces noise traders to trade the index rather than the component assets.
This lowers liquidity for the component assets, and has ambiguous effects on market efficiency.
Related mechanisms are at play in Cong and Xu (2016) and Bhattacharya and Oâ€™Hara (2018), who
study how ETFs affect market efficiency and liquidity, and Bond and Garcia (2019) who study the
effects of lowering the costs of passive investing. Pastor and Stambaugh (2012) and Stambaugh
(2014) explain the decline in active fundsâ€™ expected returns based on the increase in the assets they
manage and the decline in noise trading, respectively.5 In Garleanu and Pedersen (2018), active
fundsâ€™ expected returns decline when investors are better able to locate skilled managers. In these
papers, active funds invest without investor-imposed constraints, while constraints are central to
our analysis.
In emphasizing constraints, our paper is related to the literature on the limits of arbitrage
(see Gromb and Vayanos (2010) for a survey). In that literature, distortions are more pronounced
when arbitrageurs perform poorly and become more constrained. Moreover, poor performance is
generally associated with down markets (e.g., He and Krishnamurthy (2012, 2013), Brunnermeier
5

Berk and Green (2004) show that decreasing returns to scale at the level of individual funds can explain why
investors flow into funds with good past performance even though performance does not persist.

4

and Sannikov (2014)). By contrast, distortions in our model are more pronounced for overvalued
assets and during up markets.
Another related literature studies asset management contracts. Within its strand that takes
asset prices as given, our paper relates most closely to He and Xiong (2013), in which investors
constrain managersâ€™ choice of assets to better incentivize them to acquire information.6 Investors
in our model constrain managers to guard against the possibility that they are unskilled. Our
contracting analysis is in the spirit of the literature on optimal delegation (Alonso and Matouschek
(2008), Amador and Bagwell (2013)). We draw the connections to that literature in Section 4.
Within the strand of the asset-management-contracts literature that endogenizes prices, our
paper relates most closely to papers that examine the effects of compensating managers based on
their performance relative to a benchmark portfolio. A common theme in several papers is that
such compensation raises the price of the benchmark portfolio and of assets covarying highly with it.
Brennan (1993), Basak and Pavlova (2013) and Buffa and Hodor (2018) show this result in settings
where managers derive direct utility from relative performance. Kapur and Timmermann (2005)
and Cuoco and Kaniel (2011) show a similar result in settings where managers receive a linear fee.
The latter paper also finds that the result can reverse when the fee has option-like components.
Kashyap, Kovrijnykh, Li, and Pavlova (2018) explore the resultâ€™s implications for real investment.7
Tighter constraints in our model can instead lower the price of the benchmark portfolio.
An alternative explanation for risk-return inversion is based on leverage constraints (Black
(1972), Frazzini and Pedersen (2014)): investors prefer assets with high CAPM beta because they
provide leverage, which investors cannot replicate by investing in low-beta assets and borrowing.
Leverage constraints generate a negative relationship between CAPM beta and alpha, but a positive
one between beta and expected return. In our model both relationships can be negative.
An alternative explanation for why portfolios with more heterogeneous demand across their
component assets earn lower expected returns is based on short-sale constraints and disagreement
between agents (Harrison and Kreps (1978), Scheinkman and Xiong (2003), Hong and Stein (2007)):
short-sale constraints prevent the pessimistsâ€™ views from being incorporated into the price. Our
model generates a similar relationship without short-sale constraints. It also predicts that the
relationship is stronger when managersâ€™ constraints are tighter.
6

Other papers on managerial moral hazard in aquiring information include Stoughton (1993), Admati and Pfleiderer (1997), Li and Tiwari (2009), and Dybvig, Farnsworth, and Carpenter (2010). See also Bhattacharya and
Pfleiderer (1985), Starks (1987), Das and Sundaram (2002), Palomino and Prat (2003), Ou-Yang (2003) and Cadenillas, Cvitanic, and Zapatero (2007) for other contracting settings.
7
Other papers on the equilibrium effects of benchmarking include Qiu (2017) and Cvitanic and Xing (2018). See
also Garcia and Vanden (2009), Gorton, He, and Huang (2010), Kyle, Ou-Yang, and Wei (2011), Malamud and
Petrov (2014), Sato (2016), Huang (2018) and Sockin and Xiaolan (2018) for other models that determine jointly
asset management contracts and equilibrium prices.

5

2

Model

Time t is continuous and goes from zero to infinity. The riskless rate is exogenous and equal to
r > 0. A risky asset pays a dividend flow Dt per share and is in supply of Î¸ shares. The price St
per share of the risky asset is determined endogenously in equilibrium.
The risky assetâ€™s return per share in excess of the riskless rate is
dRtsh â‰¡ Dt dt + dSt âˆ’ rSt dt,

(2.1)

and its return per dollar in excess of the riskless rate is
dRt â‰¡

Dt dt + dSt
dRtsh
=
âˆ’ rdt.
St
St

(2.2)

We refer to dRtsh as share return, omitting that it is in excess of the riskless rate. We refer to dRt
as return, omitting that it is per dollar and in excess of the riskless rate.
The dividend flow Dt follows the square-root process
p

dDt = Îº DÌ„ âˆ’ Dt dt + Ïƒ Dt dBt ,

(2.3)

where (Îº, DÌ„, Ïƒ) are positive constants and Bt is a Brownian motion. The square-root specification
(2.3) allows for closed-form solutions, while also ensuring that dividends remain positive. A property
of the square-root specification that is key for our analysis is that the volatility (standard deviation)
of dividends per share Dt increases with the level of dividends. This property is realistic: if a firm
becomes larger and keeps the number of its shares constant, then its dividends per share become
more uncertain in absolute terms (but not necessarily as fraction of the firmâ€™s size).8
Investors form a continuum with measure one. They are of two types: unconstrained investors
who can invest in the riskless and the risky asset without any limitations, and constrained investors
who are limited in the risk they can take. Unconstrained investors are in measure 1 âˆ’ x âˆˆ (0, 1),
and constrained investors are in the complementary measure x. We denote by W1t and W2t the
wealth of an unconstrained and a constrained investor, respectively, and by z1t and z2t the number
of shares of the risky asset that they hold. In Section 3 we derive equilibrium asset prices taking
the constraint as exogenous. In Section 4 we endogenize the constraint in a contracting model,
8

Dividends are often assumed to follow a geometric Brownian motion (GBM). Under the GBM specification, the
volatility of dividends per share is proportional to the dividend level. Hence, the volatility of dividends per share
increases with the dividend level, exactly as under the square-root specification. The two specifications have different
implications for the volatility of dividends per share as fraction of the dividend level. Under the GBM specification
that quantity is independent of the dividend level, while under the square-root specification it decreases with the
dividend level. We adopt the square-root over the GBM specification because of tractability.

6

and revisit the equilibrium price properties. In the contracting model, constrained investors do not
observe the supply Î¸ of the risky asset, which determines the assetâ€™s expected return. They can
hire an asset manager, but are uncertain about the managerâ€™s skill. Their optimal response to that
uncertainty is to limit the managerâ€™s actions.
One interpretation of the assumption that constrained investors do not observe Î¸ is that Î¸
includes demand by noise traders, which is unobservable. That is, Î¸ is an observable number of
shares sold by the asset issuer minus an unobservable number of shares bought by noise traders.
We adopt this interpretation from now on. Under this interpretation, Î¸ can take both positive and
negative values. Negative values arise when the demand by noise traders exceeds the supply by the
asset issuer.
At time t, investors choose their position in the risky asset to maximize the mean-variance
objective
Ï
Et (dWit ) âˆ’ Vart (dWit ),
2

(2.4)

subject to the budget constraint
dWit = (Wit âˆ’ zit St ) rdt + zit (Dt dt + dSt ) = Wit rdt + zit dRtsh ,

(2.5)

where Ï is a risk-aversion coefficient common to all investors, i = 1 for unconstrained investors,
and i = 2 for constrained investors. The mean and variance in the objective (2.4) are computed
over the infinitesimal change in the investorsâ€™ wealth. That change is equal to the riskless rate paid
on wealth between t and t + dt, plus the capital gains from the risky asset in excess of the riskless
rate. The capital gains are equal to the number of shares zit times the share return dRtsh .
The constraint restricts the volatility of the constrained investorsâ€™ position z2t not to exceed a
bound L â‰¥ 0. We consider both the case where volatility is measured in absolute terms and the
case where volatility is measured relative to a benchmark position of Î· > 0 shares. We nest the
two cases in the constraint
1
âˆš
dt

q



Vart (z2t âˆ’ Î·)dRtsh â‰¤ L,

(2.6)

where Î· is non-negative and becomes zero when volatility is measured in absolute terms. In Appendix B we show that our main results remain the same under the alternative constraint
|z2t âˆ’ Î·|St â‰¤ L,

(2.7)

7

which restricts the dollar value of the constrained investorsâ€™ position z2t not to deviate from the
dollar value of the benchmark position Î· â‰¥ 0 by more than L. Equation (2.6) can be interpreted as
a tracking-error constraint that restricts the volatility of portfolio return relative to a benchmark.
Equation (2.7) can be interpreted as a constraint that restricts portfolio weights relative to a
benchmark. We develop these interpretations in Appendix B.
Constrained investors combine elements from active and passive investing. They are active in
the sense that they have some leeway when choosing their position in the risky asset. They are
passive in the sense that they cannot deviate much from their benchmark. In Section 3, where we
derive equilibrium asset prices with the constraint (2.6), we begin with the two polar cases where
constrained investors are either fully active or fully passive. In Section 3.1 we assume L = âˆ,
which implies that there is no constraint and that constrained investors are fully active. In Section
3.2 we instead assume L = 0, which implies that the constraint forces constrained investors to hold
Î· shares of the risky asset and to be fully passive. In Section 3.3 we turn to the general case where
L âˆˆ (0, âˆ), and show that there are important qualitative differences with the two polar cases.
Investors with the objective (2.4) can be interpreted as overlapping generations living over
infinitesimal periods. The generation born at time t is endowed with wealth W , invests in the
riskless and the risky asset from t to t + dt, consumes at t + dt and then dies. If preferences over
consumption are described by the Von Neumann-Morgenstern (VNM) utility function U , and if
all uncertainty is Brownian as is the case in equilibrium, utility maximization yields the objective
00

(W )
(2.4) with Wit = W and Ï = âˆ’ UU 0 (W
).

We endow investors with the mean-variance objective (2.4) rather than with expected utility over
an infinite stream of consumption because this simplifies the equilibrium analysis of the constraint
in the general case where L âˆˆ (0, âˆ). An additional advantage of the objective (2.4) is that it is
compatible with the contracting model of Section 4, which assumes two-period contracts between
overlapping generations of investors and managers, and takes the limit when the time between
periods becomes small. An earlier version of this paper (Buffa, Vayanos, and Woolley (2014))
derives the equilibrium when investors have negative exponential utility over an infinite stream of
consumption and are not subject to a constraint such as (2.6) or (2.7). In the polar cases studied in
Sections 3.1 and 3.2, the infinite-horizon objective yields near-identical closed-form solutions and
comparative statics as the mean-variance objective.

8

3

Equilibrium with Exogenous Constraint

3.1

No Constraint

We first derive the equilibrium when L = âˆ. Constrained investors face no constraint and are identical to unconstrained investors. In the contracting model of Section 4, no constraint corresponds
to constrained investors having access only to skilled managers.
The equilibrium price St is a function of the dividend flow Dt , which is the only state variable in the model. Denoting this function by S(Dt ) and assuming that it is twice continuously
differentiable, we can write the share return dRtsh as
dRtsh = Dt dt + dS(Dt ) âˆ’ rS(Dt )dt


p
1 2
00
0
= Dt + Îº(DÌ„ âˆ’ Dt )S (Dt ) + Ïƒ Dt S (Dt ) âˆ’ rS(Dt ) dt + Ïƒ Dt S 0 (Dt )dBt ,
2

(3.1)

where the second step follows from (2.3) and Itoâ€™s lemma.
Using the budget constraint (2.5), we can write the objective (2.4) as
Ï 2
zit Et (dRtsh ) âˆ’ zit
Vart (dRtsh ).
2
The first-order condition with respect to zit is
Et (dRtsh ) = Ïzit Vart (dRtsh ).

(3.2)

The expected share return Et (dRtsh ) is the drift term in (3.1), and the share return variance
Vart (dRtsh ) is the square of the diffusion term.
Since unconstrained and constrained investors are identical, the market-clearing condition
(1 âˆ’ x)z1t + xz2t = Î¸

(3.3)

implies z1t = z2t = Î¸. Each investorâ€™s position is thus equal to the asset supply Î¸, which coincides
with the supply per investor since investors form a continuum with mass one. Setting zit = Î¸ in
(3.2), we find the following ordinary differential equation (ODE) for the function S(Dt ):
1
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) + Ïƒ 2 Dt S 00 (Dt ) âˆ’ rS(Dt ) = ÏÎ¸Ïƒ 2 Dt S 0 (Dt )2 .
2

(3.4)

The ODE (3.4) is second-order and non-linear, and must be solved over (0, âˆ). We require that
its solution S(Dt ) has a derivative that converges to finite limits at zero and infinity. This yields
9

one boundary condition at zero and one at infinity.
We look for an affine solution to the ODE (3.4):
S(Dt ) = a0 + a1 Dt ,

(3.5)

where (a0 , a1 ) are constant coefficients. This function satisfies the boundary conditions since its
derivative is constant. Substituting this function into (3.4) and identifying terms, we can compute
(a0 , a1 ).
2

Proposition 3.1. Suppose L = âˆ and Î¸ > âˆ’ (r+Îº)
. An affine solution S(Dt ) = a0 + a1 Dt to
4ÏÏƒ 2
(3.4) exists, with
a0 =
a1 =

Îº
a1 DÌ„,
r

(3.6)
2

r+Îº+

p

(r + Îº)2 + 4ÏÎ¸Ïƒ 2

.

(3.7)

Both S(Dt ) and S 0 (Dt ) are decreasing and convex functions of the supply Î¸ of the risky asset.
The intuition for (3.6) and (3.7) is as follows. The coefficient a1 is the sensitivity S 0 (Dt ) of the
price to changes in the dividend flow Dt . Consider a unit increase in Dt . When the supply Î¸ of
the risky asset is equal to zero, (3.7) implies that the price St increases by a1 =

1
r+Îº .

This is the

present value of the increase in future expected dividends discounted at the riskless rate r. Indeed,
0

a unit increase in Dt raises the expected dividend flow Et (Dt0 ) at time t0 > t by eâˆ’Îº(t âˆ’t) . Hence,
the present value of future expected dividends increases by
Z

âˆ

0

0

eâˆ’Îº(t âˆ’t) eâˆ’r(t âˆ’t) dt0 =

t

1
.
r+Îº

When the supply Î¸ of the risky asset is positive, the price St increases by a1 <

1
r+Îº

in response

to a unit increase in Dt . This is because the increase in Dt not only raises expected dividends, but
also makes them riskier due to the square-root specification of Dt . Moreover, since investors hold
a long position, the increase in risk makes them more willing to unwind their position and sell the
asset. This results in a smaller price increase than when Î¸ = 0. When instead Î¸ < 0, the investors
hold a short position, and the increase in risk makes them more willing to buy the asset. This
results in a larger price increase than when Î¸ = 0, i.e., a1 >

1
r+Îº .

Equation (3.7) confirms that a1

decreases in Î¸.
The effect of Î¸ on a1 is stronger when Î¸ is small, implying that the price sensitivity S 0 (Dt ) is
convex in Î¸. Convexity is related to a1 being decreasing in Î¸ and bounded below by zero. Indeed,
10

these properties imply that the derivative of a1 with respect to Î¸ converges to zero when Î¸ becomes
large (while it is negative for smaller values of Î¸).
The coefficient a0 is equal to the price level when the dividend flow Dt is zero. If the meanreversion parameter Îº were equal to zero, and hence the dividend flow were to stay at zero forever,
then a0 would be equal to zero. Because, however, Îº is positive, and hence the dividend flow returns
with certainty to positive values, a0 is positive. Moreover, a0 inherits properties of a1 since the
larger a1 is, the more the price increases when the dividend flow becomes positive. In particular,
a0 is decreasing and convex in the supply Î¸ of the risky asset, and so is the price St = a0 + a1 Dt .
Corollary 3.1 examines how Î¸ affects the assetâ€™s expected return and the return volatility.
2

. An increase in the risky assetâ€™s supply Î¸
Corollary 3.1. Suppose L = âˆ and Î¸ > âˆ’ (r+Îº)
4ÏÏƒ 2
raises the assetâ€™s conditional expected return Et (dRt ) and leaves the returnâ€™s conditional volatility
p
Vart (dRt ) unaffected. The effects on the unconditional values E(dRt ) of expected return and
p
Var(dRt ) of volatility are the same as on the conditional values.
Recall from (2.2) that the return of the risky asset is
dRt =

Dt
dSt
dt +
âˆ’ rdt.
St
St

Return volatility is caused by the term

dSt
St ,

i.e., the capital gains per dollar invested. Since an

increase in Î¸ lowers the sensitivity a1 of the price St to changes in the dividend flow Dt , it makes the
capital gains dSt = a1 dDt per share less volatile. At the same time, the share price St = a0 + a1 Dt
t
also decreases. Because Î¸ has the same percentage effect on a0 and a1 , the capital gains dS
St per
p
dollar invested do not change, and neither does return volatility Vart (dRt ). On the other hand,

expected return E(dRt ) increases because of the term

Dt
St dt,

i.e., the dividends per dollar invested.

An increase in Î¸ does not affect the dividend flow Dt per share but lowers the share price St .

3.2

Infinitely Tight Constraint

We next derive the equilibrium when L = 0. The constraint is infinitely tight and forces constrained
investors to hold the benchmark position of Î· shares of the risky asset. In the contracting model
of Section 4, an infinitely tight constraint corresponds to constrained investors having access only
to unskilled managers. The benchmark position Î· corresponds to the position that constrained
investors require their manager to hold, and is related to their expectation of Î¸. Hence, comparative
statics with respect to Î¸ holding Î· constant, such as those performed in this section, should be
interpreted as changes in the unobservable component of Î¸, which reflects noise-trader demand.
11

Since the constrained investorsâ€™ position z2t is equal to the benchmark position Î·, the marketclearing condition (3.3) implies z1t =

Î¸âˆ’xÎ·
1âˆ’x .

Substituting z1t into (3.2) for i = 1, we find the

ODE
1
Ï(Î¸ âˆ’ xÎ·) 2
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) + Ïƒ 2 Dt S 00 (Dt ) âˆ’ rS(Dt ) =
Ïƒ Dt S 0 (Dt )2 .
2
1âˆ’x
The ODE (3.8) is identical to (3.4) except that supply Î¸ is replaced by

Î¸âˆ’xÎ·
1âˆ’x .

(3.8)

The solution S(Dt )

of the ODE can be derived from Proposition 3.1 with the same substitution.

Proposition 3.2. Suppose L = 0 and Î¸ > xÎ· âˆ’

(1âˆ’x)(r+Îº)2
.
4ÏÏƒ 2

An affine solution S(Dt ) = a0 + a1 Dt

to (3.8) exists, with a0 given by (3.6) and
2

a1 =
r+Îº+

q

(r + Îº)2 +

4Ï(Î¸âˆ’xÎ·) 2
1âˆ’x Ïƒ

.

(3.9)

Relative to the case L = âˆ:
â€¢ S(Dt ) is lower when Î¸ > Î·, and higher when Î¸ < Î·.
â€¢ S 0 (Dt ) is lower when Î¸ > Î·, and higher when Î¸ < Î·.
Under an infinitely tight constraint (L = 0), noise-trader demand has a larger effect on the
price than under no constraint (L = âˆ). Recall from Proposition 3.1 that when L = âˆ, the
price decreases in the supply Î¸ of the risky asset. In particular, the price is higher when Î¸ < Î·,
corresponding to high noise-trader demand, than when Î¸ > Î·, corresponding to low noise-trader
demand. When L = 0, the difference is exacerbated: the price is even higher when Î¸ < Î·, and is
even lower when Î¸ > Î·. Intuitively, the constraint exacerbates the effect that noise-trader demand
has on the price because it prevents constrained investors from absorbing that demand. Indeed, if
the constraint is imposed, constrained investors must change their position from Î¸ to Î·. Therefore,
they must buy the asset when Î¸ < Î·, which is when noise-trader demand is high, and must sell the
asset when Î¸ > Î·, which is when noise-trader demand is low.
The constraint exacerbates the effects of noise-trader demand not only on the price level but
also on the price sensitivity to changes in the dividend flow Dt . Recall from Proposition 3.1 that
when L = âˆ, the price is more sensitive to Dt (i.e., S 0 (Dt ) is larger) when Î¸ < Î· than when Î¸ > Î·.
When L = 0, the difference in sensitivities is exacerbated because Î¸ is replaced by
becomes more sensitive to Dt when Î¸ < Î· because
when Î¸ > Î· because

Î¸âˆ’xÎ·
1âˆ’x

> Î¸.

12

Î¸âˆ’xÎ·
1âˆ’x

Î¸âˆ’xÎ·
1âˆ’x :

the price

< Î¸, and it becomes less sensitive to Dt

While an infinitely tight constraint exacerbates the mispricing, it does not affect return volatility.
Indeed, since volatility is independent of Î¸, it does not change when Î¸ is replaced by

Î¸âˆ’xÎ·
1âˆ’x .

p
2
Corollary 3.2. Suppose L = 0 and Î¸ > xÎ· âˆ’ (1âˆ’x)(r+Îº)
.
The
conditional
volatility
Vart (dRt )
2
4ÏÏƒ
p
and the unconditional volatility Var(dRt ) of the risky assetâ€™s return are independent of the supply
Î¸ and are the same as when L = âˆ.

3.3

General Case

We next derive the equilibrium for L âˆˆ (0, âˆ). The equilibrium is described by an unconstrained
region, where the constraint does not bind, and a constrained region where it binds. Using (3.1)
and assuming that S(Dt ) increases in Dt (which we confirm is the case in equilibrium), we can
write the constraint (2.6) as
|z2t âˆ’ Î·|Ïƒ

Dt S 0 (Dt ) â‰¤ L.

p

(3.10)

In the unconstrained region all investors are identical. Therefore, their positions z1t and z2t are
equal to the supply Î¸, and the function S(Dt ) solves the same ODE (3.4) as when the constraint
never binds. Substituting z2t = Î¸ into (3.10), we find that the unconstrained region is defined by
|Î¸ âˆ’ Î·|Ïƒ

p
Dt S 0 (Dt ) â‰¤ L.

(3.11)

In the constrained region (3.10) holds as an equality. Using the market-clearing condition to
write z1t as function of z2t , and substituting into (3.2) for i = 1, we find
1
Î¸ âˆ’ xz2t 2
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) + Ïƒ 2 Dt S 00 (Dt ) âˆ’ rS(Dt ) = Ï
Ïƒ Dt S 0 (Dt )2 .
2
1âˆ’x

(3.12)

A binding constraint forces the position of constrained investors closer to Î· while keeping it on the
same side of Î· as for unconstrained investors. When, for example, Î¸ < Î·, unconstrained investors
hold a position z1t < Î·, and constrained investors hold a position z2t âˆˆ (z1t , Î·). Substituting z2t
from (3.10), which holds as an equality in the constrained region, into (3.12), and noting that z2t âˆ’Î·
has the same sign as Î¸ âˆ’ Î·, we find the ODE
Ï(Î¸ âˆ’ xÎ·) 2
Ï sgn(Î¸ âˆ’ Î·)xL p
1
Ïƒ Dt S 0 (Dt )2 âˆ’
Ïƒ Dt S 0 (Dt ),
Dt +Îº(DÌ„âˆ’Dt )S 0 (Dt )+ Ïƒ 2 Dt S 00 (Dt )âˆ’rS(Dt ) =
2
1âˆ’x
1âˆ’x
(3.13)
where sgn(Î¸ âˆ’ Î·) is the sign function, equal to one if Î¸ > Î· and to minus one if Î¸ < Î·. The
13

constrained region is defined by the opposite inequality to (3.11), i.e.,
|Î¸ âˆ’ Î·|Ïƒ

Dt S 0 (Dt ) > L.

p

(3.14)

The price function S(Dt ) solves the ODE (3.4) in the unconstrained region (3.11), and (3.13) in
the constrained region (3.14). The two ODEs are second-order and non-linear, and must be solved
as a system over (0, âˆ). As in Sections 3.1 and 3.2, we require that S 0 (Dt ) converges to finite limits
at zero and infinity.
Since S 0 (Dt ) converges to a finite limit at zero, values of Dt close to zero belong to the unconstrained region (3.11). Conversely, since S 0 (Dt ) converges to a finite limit at infinity, values of Dt
close to infinity belong to the constrained region (3.14). Hence, the unconstrained and constrained
regions are separated by at least one boundary point and more generally by an odd number of such
points. At a boundary point Dâˆ— , the values of S(Dâˆ— ) implied by the two ODEs must be equal, and
the same is true for the values of S 0 (Dâˆ— ). These are the smooth-pasting conditions, and they follow
from S(Dt ) being twice continuously differentiable. The boundary points must be solved together
with the ODEs. This makes the problem a free-boundary one.
The ODE (3.4) has the affine solution derived in Proposition 3.1. That solution, however, does
not satisfy the ODE (3.13), and is not the equilibrium price. While a closed-form solution to the
ODEs (3.4) and (3.13) for L âˆˆ (0, âˆ) is not available, we can prove existence of a solution and a
number of key properties.9

Theorem 3.1. Suppose L âˆˆ (0, âˆ), Î¸ > xÎ· âˆ’

(1âˆ’x)(r+Îº)2
4ÏÏƒ 2

and ÎºDÌ„ >

Ïƒ2
4 .

A solution S(Dt ) to

the system of ODEs (3.4) in the unconstrained region (3.11), and (3.13) in the constrained region
(3.14), with a derivative that converges to finite limits at zero and infinity, exists and has the
following properties:
â€¢ It is increasing in Dt .
â€¢ It lies between the affine solution derived for L = âˆ and that derived for L = 0.
9

A key difficulty in proving existence is that a solution must be found over the open interval (0, âˆ), with a
boundary condition at each end. To address this difficulty, we start with a compact interval [, M ] âŠ‚ (0, âˆ) and show
that there exists a unique solution to the ODEs with one boundary condition at  and one at M . The boundary
conditions are derived from the limits of S 0 (Dt ) at zero and infinity. In the case of M , for example, the requirement
that S 0 (Dt ) has a finite limit at infinity determines that limit uniquely, and we set S 0 (M ) equal to that value. To
construct the solution over [, M ], we use S 0 (M ) and an arbitrary value for S 00 (M ) as initial conditions for the ODEs
at M , and show that there exists a unique S 00 (M ) so that the boundary condition at  is satisfied. Showing uniqueness
uses continuity of solutions with respect to the initial conditions, as well as a monotonicity property with respect to
the initial conditions that follows from the structure of our ODEs. We next show that when  converges to zero and
M to infinity, the solution over [, M ] converges to a solution over (0, âˆ). The monotonicity property of solutions
with respect to the initial conditions is key to the convergence proof because it yields monotonicity of the solution
with respect to  and M .

14

â€¢ Its derivative S 0 (Dt ) lies between the derivative of the affine solution derived for L = âˆ and
that derived for L = 0.
â€¢ It is concave when Î¸ > Î·, and convex when Î¸ < Î·.
â€¢ The unconstrained and constrained regions are separated by only one boundary point Dâˆ— .

Theorem 3.1 confirms that an increase in the dividend flow Dt raises the price St . It also shows
that St lies between the values that it takes in the polar cases L = âˆ and L = 0. For given Dt ,
the difference in price between Î¸ < Î· and Î¸ > Î· is positive when there is no constraint (L = âˆ),
higher when there is a constraint (L âˆˆ (0, âˆ)), and even higher when the constraint is infinitely
tight (L = 0). The same comparisons hold for the difference in price sensitivity S 0 (Dt ) between
Î¸ < Î· and Î¸ > Î·.
A key difference with the polar cases L = âˆ and L = 0 is that the price is non-linear in Dt : it
is concave for Î¸ > Î· and convex for Î¸ < Î·, while it is affine in the polar cases. The non-linearities
are driven by the trading that the constraint induces, and in turn drive the risk-return inversion.
In the polar cases, there is no constraint-induced trading, either because the constraint never binds
(L = âˆ) or because constrained investors hold the benchmark position (L = 0).
The intuition for the non-linearities is as follows. Suppose that Î¸ > Î· and Dt is in the constrained
region. Following an increase in Dt , investorsâ€™ positions go up in value and their volatility rises.
To continue meeting the constraint, the constrained investors must bring their positions closer
to Î·. Since Î¸ > Î·, they must sell some shares of the risky asset to unconstrained investors. This
dampens the price rise. The dampening effect is weaker when Dt is smaller and in the unconstrained
region because it concerns not actual sales but an expectation that sales might occur in the future.
The price increase is thus larger for smaller Dt , resulting in concavity. Conversely, suppose that
Î¸ < Î· and Dt is in the constrained region. Following an increase in Dt , the constrained investors
must bring their positions closer to Î·. Since Î¸ < Î·, they must buy some shares of the asset from
unconstrained investors. This amplifies the price rise. The amplification effect is weaker when Dt
is smaller and in the unconstrained region, resulting in convexity.
To illustrate the results shown in this and subsequent sections, we use a numerical example. We
must choose values for eight parameters: the number of shares Î· corresponding to the benchmark
position; the supply Î¸ of the risky asset, for which we choose two values that are symmetric around
Î·; the risk-aversion coefficient Ï of investors; the parameters (Îº, DÌ„, Ïƒ) of the dividend process; the
fraction x of constrained investors; and the bound L in the constraint (3.10).
We set Ï = Î· = 1. The choice of Ï is a normalization since we can redefine the numeraire in
the units of which wealth is expressed. The choice of Î· is also a normalization provided that Î· > 0
15

since we can redefine one share of the risky asset by changing the dividend flow.
We set r = 0.03. This parameter has a small effect on our main numerical results. We set
(Îº, DÌ„, Ïƒ) = (0.05, 0.15, 0.4). We choose these values to generate plausible values for the expected
return and return volatility in the case Î¸ = Î·. That case can be viewed as an average of the two
cases Î¸ > Î· and Î¸ < Î· that we consider. The expected return (in excess of the riskless rate) is
5.5%, and the return volatility is 20%. These are plausible values if we interpret the risky asset
as a segment of the stock market, such as mid-cap value stocks. While we use three parameters
(Îº, DÌ„, Ïƒ) to produce two moments, the third degree of freedom has a small effect on our numerical
results.
We set x = 0.8, i.e., 80% of investors are constrained and 20% are unconstrained. We choose the
two values of Î¸ to be 0.8 and 1.2. Thus, if the asset issuer sells 1.2 shares, then noise traders hold
no shares when Î¸ = 1.2, and hold 0.4 shares, i.e., one-third of the issued quantity, when Î¸ = 0.8.
Our numerical results become stronger when x increases or when the spread âˆ†Î¸ between the high
and the low value of Î¸ increases. We finally set L = 0.05. In subsequent sections we examine the
effects of varying âˆ†Î¸ and L.
Figure 1 illustrates the results of Theorem 3.1 in our numerical example. The left panel plots the
price as function of Dt . The thick lines represent the price when there is a constraint (L âˆˆ (0, âˆ)).
The thin lines represent the price in the two polar cases where there is no constraint (L = âˆ) and
where the constraint is infinitely tight (L = 0), with the price in the latter case corresponding to
the more extreme values. In all three cases, the dashed red line is drawn for Î¸ = 0.8, corresponding
to high noise-trader demand, and the solid blue line is drawn for Î¸ = 1.2, corresponding to low
noise-trader demand. The area between the price in the two polar cases is shaded. Consistent with
Theorem 3.1, the thick lines lie inside the shaded area. The middle panel of Figure 1 plots the
position of constrained investors using the same conventions. The position when L = 0 coincides
with the horizontal line z2t = 1. The right panel of Figure 1 plots the unconditional distribution of
Dt . Besides confirming the properties shown in Theorem 3.1, Figure 1 shows that the constraint
has a larger effect on prices and positions when Î¸ = 0.8 than when Î¸ = 1.2. We return to this
asymmetry in subsequent sections.

3.4

Risk-Return Inversion

Unlike in the polar cases L = âˆ and L = 0, where supply Î¸ does not affect the assetâ€™s return
volatility, volatility is affected by Î¸ when L âˆˆ (0, âˆ). Volatility is higher when Î¸ < Î·, corresponding
to high noise-trader demand, than when Î¸ > Î·, corresponding to low noise-trader demand.

16

Figure 1: Effect of Constraint on Prices and Positions
1.2

3.5

10

3.0

8

1.1
2.5

6

2.0

1.0
4

1.5
0.9

2

1.0

0.5

0.8

0.0

0.1

0.2

0.3

0.4

0.0

0

0.1

0.2

0.3

0.4

0.0

0.1

0.2

0.3

0.4

Asset price St (left panel) and position z2t of constrained investors (middle panel) as functions of the dividend
flow Dt , and unconditional distribution of Dt (right panel). The thick lines in the left and middle panels
correspond to the case where there is a constraint (L âˆˆ (0, âˆ)). The thin lines correspond to the polar cases
where there is no constraint (L = âˆ) and where the constraint is infinitely tight (L = 0). The latter case
corresponds to the more extreme values in the left panel and to the horizontal line z2t = 1 in the middle
panel. In all three cases, the dashed red line is drawn for Î¸ = 0.8 and the solid blue line is drawn for Î¸ = 1.2.
Parameter values are: Î· = Ï = 1, r = 0.03, Îº = 0.05, DÌ„ = 0.15, Ïƒ = 0.4, x = 0.8, L = 0.05.

Proposition 3.3. Under the assumptions in Theorem 3.1, both the conditional volatility
p
and the unconditional volatility Var(dRt ) of the assetâ€™s return are:

p

Vart (dRt )

â€¢ Higher when Î¸ < Î· than when Î¸ > Î·.
â€¢ Higher than under the affine solutions derived for L = âˆ and for L = 0 when Î¸ < Î·, and
lower when Î¸ > Î·.

Proposition 3.3 is related to the convexity and concavity results of Theorem 3.1. The amplification effect that generates the convexity for Î¸ < Î· also generates the high volatility. The dampening
effect that generates the concavity for Î¸ > Î· also generates the low volatility.
Proposition 3.3 implies a negative relationship between volatility and expected return. When
Î¸ < Î·, expected return is low, so that investors are induced to hold small positions, and volatility
is high. When instead Î¸ > Î·, expected return is high, so that investors are induced to hold large
positions, and volatility is low. High volatility goes together with overvaluation (low expected
return) because they are both driven by high noise-trader demand. Indeed, to accommodate the
high demand, investors underweight the asset relative to the benchmark position Î·. When the
17

market goes up, the constraint forces them to underweight less, and hence to buy the asset. This
yields amplification and high volatility.
A negative relationship between volatility and expected return has been documented empirically,
and is known as the volatility anomaly because it is at odds with standard theories. Haugen and
Baker (1996) and Ang, Hodrick, Xing, and Zhang (2006) document the volatility anomaly in the
cross-section of U.S. stocks.
The volatility anomaly in our model holds as a comparative-statics rather than as a crosssectional result because there is only one risky asset. We can, however, extend our model to
multiple risky assets and derive a cross-sectional result. The simplest way to perform the extension
is to assume that dividend flows are independent across assets, and that the constraint applies
asset-by-asset rather than across an entire portfolio.
The multi-asset version of our model is as follows. There are N risky assets instead of one.
Asset n = 1, .., N pays a dividend flow Dnt per share and is in supply of Î¸n shares. The dividend
flow Dnt follows the square-root process
p

dDnt = Îºn DÌ„n âˆ’ Dnt dt + Ïƒn Dnt dBnt ,

(3.15)

which generalizes (2.3), and the Brownian motions {dBnt }n=1,..,N are independent. Investors can
invest in all N risky assets. Generalizing (3.10), we require that the volatility of the constrained
investorsâ€™ position z2nt in risky asset n does not exceed an upper bound
|z2nt âˆ’ Î·|Ïƒn

p
Dnt S 0 (Dnt ) â‰¤ L.

(3.16)

The multi-asset version of our model is a replica of the one-asset version: the price of asset n
is given by Proposition 3.1 when L = âˆ, by Proposition 3.2 when L = 0, and by Theorem 3.1
when L âˆˆ (0, âˆ). Proposition 3.3 holds as a cross-sectional comparison between assets (n, n0 ) with
Î¸n < Î·, Î¸n0 > Î· and identical other characteristics.
The negative relationship between volatility and expected return holds for assets that differ
in Î¸. One could alternatively compare, in the spirit of standard theories, assets that differ in
the dividend volatility coefficient Ïƒ. That comparison yields a positive relationship: assets with
high Ïƒ have higher volatility and expected return than assets with lower Ïƒ and identical other
characteristics. The positive relationship weakens when Î¸ varies, and becomes negative when
variation in Î¸ dominates variation in Ïƒ.
Figure 2 illustrates risk-return inversion in our numerical example. The left and middle panels
plot expected return and return volatility, respectively, as function of L. In both panels, the dashed

18

red line is drawn for an asset n with Î¸n = 0.8, corresponding to high noise-trader demand, and the
solid blue line is drawn for an asset n0 with Î¸n0 = 1.2, corresponding to low noise-trader demand.
Consistent with Propositions 3.1 and 3.2, the difference in expected returns between Î¸n = 0.8 and
Î¸n0 = 1.2 increases when the constraint tightens (L decreases). The increase is from approximately
2% when L exceeds 0.15 to 7% when L is close to zero, with the effect driven primarily by the
asset with high noise-trader demand (Î¸n = 0.8). Consistent with Proposition 3.3, the difference in
return volatilities between Î¸n = 0.8 and Î¸n0 = 1.2 is largest for intermediate values of L. When L
is close to zero or exceeds 0.15, volatility is approximately 20%, for both Î¸n = 0.8 and Î¸n0 = 1.2.
When instead L = 0.05, volatility rises to approximately 24% for Î¸n = 0.8, and drops to 19% for
Î¸n0 = 1.2. The difference in volatilities for intermediate values of L is thus driven primarily by the
amplification effect for the asset with high noise-trader demand (Î¸n = 0.8). This asymmetry, and
the corresponding one for expected return, parallel the asymmetry shown in Figure 1.
The right panel of Figure 2 plots expected return as function of return volatility for L = 0.05.
Each risky asset corresponds to one point. We include the asset pair corresponding to Î¸n = 0.8
and Î¸n0 = 1.2, as well as additional pairs obtained by varying the spread âˆ†Î¸ between the high and
the low value of Î¸n while holding the average of the two values equal to Î· = 1. The red triangles
correspond to assets with Î¸n < Î· = 1, the blue circles to assets with Î¸n > Î· = 1, and the black
square to an asset with Î¸n = 1. Consistent with Proposition 3.3, variation driven by Î¸n generates
a negative relationship between volatility and expected return.
An additional measure of risk that we can relate to expected return is CAPM beta. The CAPM
predicts a positive relationship between beta and expected return. Empirically, however, a flat
or negative relationship has been documented, and is known as the beta anomaly. Black (1972),
Black, Jensen, and Scholes (1972), and Frazzini and Pedersen (2014) document a flat relationship
in the cross-section of U.S. stocks. Baker, Bradley, and Wurgler (2011) find that the relationship
turns negative in recent decades.
The multi-asset version of our model yields a negative relationship between beta and expected
return. This is because with independent dividend flows, an assetâ€™s beta is proportional to the
assetâ€™s return variance times the assetâ€™s weight in the market portfolio. Assets with Î¸n < Î· have
high beta because they have both high return volatility (Proposition 3.3) and high market-portfolio
weight because of their high price (Theorem 3.1). Note that the negative relationship between beta
and expected return arises even in the polar cases L = âˆ and L = 0. In these cases, the return
volatility is independent of Î¸n (Corollaries 3.1 and 3.2), but the price is higher for low-Î¸n assets
(Propositions 3.1 and 3.2).

Proposition 3.4. In the multi-asset version of our model, suppose Î¸n > xÎ· âˆ’
19

(1âˆ’x)(r+Îºn )2
2
4ÏÏƒn

and

Figure 2: Risk-Return Inversion
â—‹
6.0

24
6

â—‹

â—‹

5.5

23

â–³

â—‹
â—‹
â–¡

â–¡

â–³
5.0

â–³

22

4

4.5

â–³

21
2

4.0

20

3.5

19

3.0

â–³

0
0.02

0.04

0.06

0.08

0.10

0.12

0.14

0.02

0.04

0.06

0.08

0.10

0.12

0.14

19

20

21

22

23

24

p
1
Expected return dt
E(dRt ) and return volatility âˆš1dt Var(dRt ) as functions of L (left and middle panels),
and expected return as function of return volatility for fixed L (right panel). Moments are unconditional.
In the left and middle panels, the dashed red line is drawn for an asset n with Î¸n = 0.8 and the solid blue
line is drawn for an asset n0 with Î¸n0 = 1.2. In the right panel, the black square corresponds to an asset
with Î¸n = 1, the red triangles to assets with Î¸n < Î· = 1 and the blue circles to assets with Î¸n > Î· = 1,
where Î¸n = 1 Â± âˆ†Î¸
2 and âˆ†Î¸ âˆˆ {0, 0.1, 0.2, 0.3, 0.4}. The remaining parameter values are as in Figure 1.

Îºn DÌ„n >

2
Ïƒn
4

for all n = 1, .., N , and consider assets (n, n0 ) with Î¸n < Î· < Î¸n0 and identical other

characteristics. Asset n has higher conditional and unconditional CAPM beta than asset n0 .

3.5

Overvaluation Bias

In this section we show that the effects of noise-trader demand do not cancel out when aggregating
assets into portfolios. We assume that the asset market consists of segments and that each segment
consists of sub-segments. For example, one segment could be mid-cap stocks, and its sub-segments
could be mid-cap value and mid-cap growth stocks. We identify the assets in our model with the
sub-segments, and assume that noise-trader demand differs across them.
Using Propositions 3.1 and 3.2, we can determine the effect of aggregation in the polar cases
L = âˆ and L = 0. The propositions show that the price is a convex function of Î¸. Hence, a
segment in which Î¸ varies across sub-segments trades at a higher price than a segment with no
such variation and same average Î¸. Noise-trader demand thus does not cancel out by aggregation,
but introduces an overvaluation bias. Proposition 3.5 shows overvaluation bias in the polar cases
L = âˆ and L = 0, assuming for simplicity that each segment consists of two assets.

20

Proposition 3.5. In the multi-asset version of our model, suppose L = âˆ or L = 0, and Î¸n >
xÎ· âˆ’

(1âˆ’x)(r+Îºn )2
2
4ÏÏƒn

for all n = 1, .., N . For a segment consisting of assets (n, n0 ) and a segment

consisting of assets (nÌ‚, nÌ‚0 ) with Î¸n < Î¸nÌ‚ â‰¤ Î¸nÌ‚0 < Î¸n0 ,

Î¸n +Î¸n0
2

=

Î¸nÌ‚ +Î¸nÌ‚0
2

â‰¡ Î¸Ì„, and other characteristics

being identical across assets,
O(Dt ) â‰¡ [Sn (Dt ) + Sn0 (Dt )] âˆ’ [SnÌ‚ (Dt ) + SnÌ‚0 (Dt )] > 0.

(3.17)

Moreover, O(Dt ) is larger when L = 0 than when L = âˆ under the sufficient condition Î¸Ì„ â‰¤ Î·.
Proposition 3.5 implies a negative relationship between the variability of noise-trader demand,
or equivalently of expected returns, within a segment, and the segmentâ€™s own expected return.
Intuitively, the negative relationship arises because the price sensitivity S 0 (Dt ) to the dividend
flow Dt decreases in Î¸ (Proposition 3.1). When Î¸ is large, volatility per share is low because price
sensitivity is low. Hence, an increase in the number of shares Î¸ causes a small price drop. When
instead Î¸ is small, volatility per share is high, and hence an equal decrease in Î¸ causes a large price
rise. Averaging across the two cases, a segment with more extreme values of Î¸ trades at a higher
price than a segment with less extreme values.
The negative relationship between within-segment variability of noise-trader demand and segment expected return arises even when there is no constraint (L = âˆ). Proposition 3.5 shows that
the relationship becomes stronger when the constraint tightens (from L = âˆ to L = 0). This is because the constraint prevents constrained investors from absorbing noise-trader demand, increasing
the demandâ€™s effective variability.
Figure 3 illustrates overvaluation bias in our numerical example. The left panel plots the
unconditional averages of the prices of two segments as function of L: the segment with (Î¸n , Î¸n0 ) =
(0.8, 1.2), represented by the thick line, and the segment with (Î¸nÌ‚ , Î¸nÌ‚0 ) = (1, 1), represented by the
thin line. Consistent with Proposition 3.5, the former segment trades at a higher price, and the
price difference increases when L decreases. Since the price of the latter segment does not depend
on L (the constraint does not bind for assets (nÌ‚, nÌ‚0 ) because Î¸nÌ‚ = Î¸nÌ‚0 = Î· = 1), the price of the
former segment increases when L decreases. This reflects the asymmetry shown in Figure 1: the
constraint raises the price of the asset with Î¸n = 0.8 more than it lowers the price of the asset with
Î¸n0 = 1.2.
The middle and right panels of Figure 3 plot expected return at the segment level as function of
the dispersion in expected returns within the segment. Each segment corresponds to one point. We
include the segment with (Î¸n , Î¸n0 ) = (0.8, 1.2), as well as additional segments obtained by varying
the spread âˆ†Î¸ between the high and the low value of Î¸ while holding the average of the two values

21

Figure 3: Overvaluation Bias
7.5

7.5

2.5

â—‹ â—‹

â—‹

â—‹

â—‹

7.0

â—‹

â—‹
â—‹

7.0

â—‹

2.0

6.5

6.5

6.0

6.0

1.5

1.0

â—‹

5.5
0.02

0.04

0.06

0.08

0.10

0.12

0.14

0.0

0.5

1.0

1.5

2.0

2.5

3.0

5.5

3.5

0.0

0.2

0.4

0.6

0.8

1.0

1.2

1.4

Segment
price 12 E (Snt + Sn0 t ) (left panel) as function of L, and segment expected return

(D
+D
nt
1
1
n0 t )dt+d(Snt +Sn0 t )
âˆ’ r as function of the dispersion in expected returns dt
(E(dRn0 t ) âˆ’ E(dRnt ))
dt E
Snt +S 0
n t

within the segment, for fixed L (middle and right panels). Prices and expected returns are unconditional.
âˆ†Î¸
0
Segments are asset pairs (n, n0 ) with Î¸n = 1 âˆ’ âˆ†Î¸
2 and Î¸n = 1 + 2 , where âˆ†Î¸ âˆˆ {0, 0.4} in the left panel
and âˆ†Î¸ âˆˆ {0, 0.1, 0.2, 0.3, 0.4} in the middle and right panels. The remaining parameter values are as in
Figure 1.

equal to Î· = 1. The middle panel is drawn for L = 0.05, and the right panel for L = 0.15. Both
panels show a negative relationship between within-segment dispersion in expected returns and
segment expected return. The slope of the relationship is steeper (more negative) when L = 0.05,
consistent with the comparison that Proposition 3.5 derives between L = âˆ and L = 0.

4

Equilibrium with Endogenous Constraint

4.1

Contracts

We begin with a two-period contracting model with exogenous asset returns. In Section 4.2 we
embed that model into the continuous-time equilibrium model of Section 3. There are two periods,
0 and 1. The riskless rate is exogenous and equal to r. A risky asset has return R in excess of the
riskless rate.
There are two agents, an investor (he) and an asset manager (she). The investor has a prior
distribution Î 0 for R. The manager is either skilled or unskilled. A skilled manager forms a
posterior distribution Î (s) for R based on an informative signal s that she observes. An unskilled

22

manager observes an uninformative signal but she wrongly treats it as informative. Her signal makes
her either optimistic, with posterior distribution Î O , or pessimistic, with posterior distribution Î P .
These two outcomes are equally likely. The probability that the manager is unskilled is Î» âˆˆ [0, 1).
The investor and the manager have negative exponential utility over consumption in period one,
with coefficient of absolute risk aversion equal to Ï for the investor and ÏÌ„ for the manager. Without
loss of generality, we set the investorâ€™s initial wealth to zero.
The investor offers the manager a contract in period 0. If the manager accepts the contract,
then she observes her private signal and chooses a portfolio for the investor. The portfolio consists
of z shares in the risky asset and âˆ’zS dollars in the riskless asset, where S is the risky assetâ€™s price
in period 0. The investorâ€™s wealth W in period 1 is W = zSR, equal to the dollars zS invested in
the risky asset times that assetâ€™s return R in excess of the riskless asset.
The signal s observed by the skilled manager is continuous and takes values in a set Î¦ with
probability density h(s). The posterior distribution Î (s) gives positive probability to positive and
to negative values of R. As a consequence, the position z0âˆ— in the risky asset that maximizes the
investorâ€™s unconditional expected utility, and the position z âˆ— (s) that maximizes his expected utility
conditional on s, are finite. We take the range of z âˆ— (s) to be the real line. This is without loss of
generality since we can introduce additional signals that have arbitrarily small probability and fill
any gaps in z âˆ— (s).
In contrast to the skilled manager, the unskilled manager gives positive probability only to
positive values of R under the optimistic posterior distribution Î O , and only to negative values
under the pessimistic distribution Î P . Thus, the unskilled manager either believes that the risky
asset has no downside or that it has no upside. Our analysis extends to more moderate beliefs by
the unskilled manager when parametric restrictions are imposed on the asset return distribution.10
The contract consists of a fee, which the investor pays to the manager out of his period 1 wealth
W , and of an investment restriction. The fee can be a general function f (W ), subject to a nonnegativity and a monotonicity constraint. The non-negativity constraint is f (W ) â‰¥ 0, and arises
because the manager has limited liability. The monotonicity constraint is that f (W ) is increasing,
and could arise from moral hazard in period 1. Indeed, a decreasing fee could incentivize the
manager to engage in wasteful activities that reduce W so to increase her fee. A non-decreasing
fee could also incentivize such activities if they yield an infinitesimally small private benefit to the
manager. An additional reason to assume an increasing fee is to rule out the implausible outcome
that the investor can induce the manager to choose any position Z just by offering her a constant fee
10
See, for example, Vayanos (2018), where the asset return can take two values, the skilled and the unskilled manager
give positive probability to each value, and the unskilled manager has more extreme beliefs than the skilled manager.
Beliefs are more extreme in the sense that the unskilled managerâ€™s probability of the high value either exceeds the
skilled managerâ€™s maximum probability across all realizations of s, or is lower than the minimum probability.

23

and exploiting her indifference. To ensure that an optimal fee exists, we formulate the monotonicity
constraint as a weak rather than a strict inequality: f 0 (W ) â‰¥ g 0 (W ) > 0 where  is a positive
constant and g(W ) is an increasing and bounded function defined over (âˆ’âˆ, âˆ). We derive the
optimal fee for each , and take the limit when  goes to zero.
The investment restriction concerns the position z chosen by the manager. In period 0, the
investor observes a statistic F (âˆ†, s) that depends on âˆ† â‰¡ |z âˆ’ Î·|S, the dollar deviation between
the managerâ€™s position z and a benchmark position Î·, and can also depend on the signal s. For
p
example, the investor could observe the deviation âˆ†, or the portfolio return volatility Vars [âˆ†R] =
p
âˆ† Vars (R) relative to the benchmark position. We assume that the statistic F (âˆ†, s) is nonnegative, is continuously differentiable in âˆ†, and satisfies F (0, s) = 0 and

âˆ‚F (âˆ†,s)
âˆ‚âˆ†

> 0, as is the

case in the above examples. The investor can choose the benchmark position Î· and can restrict the
statistic F (âˆ†, s) to lie in a closed set L.
A fee f (W ), benchmark position Î· and set L constitute a feasible contract. The investor chooses
such a contract to maximize his expected utility. He is subject to the incentive-compatibility (IC)
constraint on the managerâ€™s choice of position Z. He must also ensure that the fee satisfies nonnegativity and monotonicity. Non-negativity ensures that the managerâ€™s individual rationality (IR)
constraint is satisfied.
Our contracting model is in the spirit of the literature on optimal delegation (e.g., Alonso and
Matouschek (2008), Amador and Bagwell (2013)). A key result in that literature is that instead
of taking an action based on information sent by the agent, the principal can equivalently let the
agent take the action within a restricted delegation set. The delegation literature generally precludes
monetary transfers between the principal and the agent. We allow monetary transfers, but in the
spirit of the delegation literature, restrict the fee function f (W ) to not depend on information sent
by the agent. We also restrict the delegation set L to depend only on the statistic F (âˆ†, s) that the
principal observes. The restriction on L could be arising from investorsâ€™ limited ability to process
information. For example, investors could observe that their managers deviated significantly from a
benchmark, but might be unable to assess whether the benchmarkâ€™s volatility was high to warrant
such a deviation.
Proposition 4.1 determines the optimal fee f (W ), benchmark position Î· and delegation set L in
the limit when  goes to zero. The set L takes the form [0, L], with L > 0. We denote by zÌ„(s) and
z(s), respectively, the maximum and minimum value of z that meet the constraint F (âˆ†, s) â‰¤ L.
Â¯
These values are well-defined because F (âˆ†, s) is continuous and increasing in âˆ†. We denote by Î¦Ì„
the set of signals s such that the investorâ€™s optimal position z âˆ— (s) conditional on s exceeds zÌ„(s),
and by Î¦ the set of signals s such that z âˆ— (s) < z(s).
Â¯
Â¯

24

Proposition 4.1. In the limit when  goes to zero:
â€¢ The investor employs the manager.
â€¢ The optimal delegation set L has the form [0, L], with L > 0.
â€¢ The position zS (s) chosen by the skilled manager is z âˆ— (s) when s âˆˆ Î¦\(Î¦Ì„ âˆª Î¦), zÌ„(s) when
Â¯
s âˆˆ Î¦Ì„, and z(s) when s âˆˆ Î¦.
Â¯
Â¯
â€¢ The position zU (s) chosen by the unskilled manager is zÌ„(s) when her posterior is Î O , and
z(s) when her posterior is Î P .
Â¯
â€¢ The optimal benchmark position Î· and bound L solve


Z

max âˆ’(1 âˆ’ Î»)
Î·,L



âˆ’ÏzS (s)SR

Es e



Z
h(s)ds âˆ’ Î»

sâˆˆÎ¦



E0 e

âˆ’ÏzU (s)SR




h(s)ds .

(4.1)

sâˆˆÎ¦

â€¢ The optimal fee f (W ) converges to zero for all W .
The optimal delegation set has the same form as under the constraint in Section 2: the investor
restricts the statistic F (âˆ†, s) not to exceed a bound L. The investor does not exclude values in
the interior of [0, L] because they arise only from positions chosen by the skilled manager. Indeed,
since the fee is increasing, the unskilled manager always chooses extreme positions, which render
F (âˆ†, s) equal to L.
The optimal fee f (W ) aligns the managerâ€™s risk preferences with those of the investor. It
ensures, in particular, that the position maximizing the skilled managerâ€™s expected utility given
her signal s coincides with the investorâ€™s optimal position z âˆ— (s). The position z âˆ— (s) is chosen if
it gives rise to a value of F (âˆ†, s) that does not exceed L. If instead F (âˆ†, s) exceeds L, then the
chosen position is the one that renders F (âˆ†, s) equal to L and is closest to z âˆ— (s). Proposition 4.1
shows that a fee converging to zero when  goes to zero suffices to align risk preferences.
The optimal bound L trades off the cost of restricting the position chosen by the skilled manager
when her signal calls for a large position (i.e., z âˆ— (s) gives rise to a value of F (âˆ†, s) that exceeds L),
and the benefit of restricting the position chosen by the unskilled manager. These cost and benefit
correspond to the first and second term, respectively, in (4.1).
The investor always employs the manager despite the risk that she may be unskilled. Indeed,
when not employing the manager, the investor chooses z0âˆ— , his optimal position given the prior
distribution Î 0 . He can replicate that outcome by employing the manager and setting (Î·, L) =
(z0âˆ— , 0). He can also do strictly better by raising L slightly, giving the manager some discretion.
Indeed, deviations by the unskilled manager generate a second-order loss for the investor because
25

z0âˆ— is optimal. By contrast, deviations by the skilled manager generate a first-order gain because
they occur when z0âˆ— is not optimal and bring the investor closer to his optimal position z âˆ— (s). The
managerâ€™s fee is an additional cost for the investor, but it converges to zero when  goes to zero.

4.2

Equilibrium

We next embed the contracting model of Section 4.1 into the equilibrium model of Section 3.
We interpret investors as overlapping generations living over infinitesimal periods. A measure
1 âˆ’ x of investors of each generation observe the asset supply Î¸ and the dividend flow Dt . They
correspond to the unconstrained investors of Section 3. The complementary measure x of investors
do not observe (Î¸, Dt ) and can employ a manager. They correspond to the constrained investors.
Managers can be skilled or unskilled, as described in Section 4.1. Skilled managers observe (Î¸, Dt ).
We set s â‰¡ (Î¸, Dt ) and take the statistic F (âˆ†, s) to be the portfolio return volatility
1
1 p
Vars [(z2t âˆ’ Î·)St dRt ] = âˆš
F (âˆ†, s) = âˆš
dt
dt

q

p


Vars (z2t âˆ’ Î·)dRtsh = |z2t âˆ’ Î·|Ïƒ Dt S 0 (Dt ).

Solving for equilibrium with an endogenous constraint involves a fixed-point problem: asset
prices must clear the market given the constraint, and the constraint (i.e., the delegation set) must
be optimal given equilibrium prices. The determination of equilibrium prices given the constraint
is along the same lines as in Section 3. The only change is that the uninformed investors whose
manager turns out to be unskilled do not invest optimally subject to the constraint. Half of them
employ an optimistic manager, who invests the maximum value of z2t that meets the constraint.
The remaining half employ a pessimistic manager, who invests the minimum value. Since the
average of the maximum and the minimum value is Î·, and the measure of uninformed investors
employing an unskilled manager is Î»x, the market-clearing condition (3.3) is replaced by
(1 âˆ’ x)z1t + (1 âˆ’ Î»)xz2t + Î»xÎ· = Î¸.

(4.2)

The definition of the unconstrained and the constrained regions is modified similarly. Since in
the unconstrained region z1t = z2t , (4.2) implies z2t =

Î¸âˆ’Î»xÎ·
1âˆ’Î»x .

Substituting into the constraint

F (âˆ†, s) â‰¤ L, we find that the unconstrained region is defined by
|Î¸ âˆ’ Î·| p
Ïƒ Dt S 0 (Dt ) â‰¤ L,
1 âˆ’ Î»x

(4.3)

which replaces (3.11). The ODE system is modified similarly, as shown in the proof of Proposition
4.2, and the existence and characterization results of Theorem 3.1 hold.
The determination of the constraint given equilibrium prices follows Proposition 4.1. The
26

optimal values of (Î·, L) maximize the continuous-time limit of the objective (4.1). Proposition 4.2
characterizes the solution to this problem.

Proposition 4.2. Suppose that Î¸ takes values in a discrete set with probabilities Ï€(Î¸). The firstorder conditions with respect to Î· and L are
X
Î¸>Î·


 X


Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ zÌ„(s)]1{z âˆ— (s)>zÌ„(s)} Ïƒ 2 Dt S 0 (Dt )2 +
Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ z(s)]1{z âˆ— (s)<z(s)} Ïƒ 2 Dt S 0 (Dt )2
Â¯
Â¯
Î¸<Î·

Î»
Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ Î·]Ïƒ 2 Dt S 0 (Dt ) = 0,
(4.4)
1âˆ’Î»
Î¸
i X
i
h
h
X
p
p
Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ zÌ„(s)]1{z âˆ— (s)>zÌ„(s)} Ïƒ Dt S 0 (Dt ) âˆ’
Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ z(s)]1{z âˆ— (s)<z(s)} Ïƒ Dt S 0 (Dt )
Â¯
Â¯
+

X


2



Î¸>Î·

Î¸<Î·

Î»
âˆ’
L = 0,
1âˆ’Î»

(4.5)

respectively, where
L
zÌ„(s) = Î· + âˆš
,
Ïƒ Dt S 0 (Dt )
L
z(s) = Î· âˆ’ âˆš
,
Â¯
Ïƒ Dt S 0 (Dt )
ï£±
Î¸âˆ’Î»xÎ·
ï£´
ï£²
1âˆ’Î»x
z âˆ— (s) =
sgn(Î¸âˆ’Î·)(1âˆ’Î»)xL
âˆš
Î¸âˆ’xÎ·âˆ’
ï£´
Ïƒ Dt S 0 (Dt )
ï£³
1âˆ’x

if

|Î¸âˆ’Î·| âˆš
0
1âˆ’Î»x Ïƒ Dt S (Dt )

â‰¤ L,

if

|Î¸âˆ’Î·| âˆš
0
1âˆ’Î»x Ïƒ Dt S (Dt )

> L.

The optimal benchmark Î· and bound L have the following properties:
â€¢ When Î¸ can take only one value, Î· = Î¸ and L = 0.
â€¢ When Î¸ can take multiple values, Î· âˆˆ (Î¸min , Î¸max ), where Î¸min is the minimum and Î¸max
is the maximum value of Î¸. Moreover, L = âˆ when Î» = 0, L âˆˆ (0, âˆ) when Î» > 0, and
limÎ»â†’1 L = 0.
When Î¸ can take only one value, the uninformed investors set the benchmark position Î· equal
to that value. They also set the bound L in the constraint to zero, hence requiring the manager
to hold Î¸ shares of the risky asset. This is an optimal arrangement since Î¸ is the asset supply and
hence the position that each investor in the mass-one continuum should be holding in equilibrium.
When Î¸ can take multiple values, uninformed investors are generally unable to replicate the
above arrangement because they do not observe Î¸. The only case where replication is possible is
when all managers are skilled (Î» = 0). In that case, uninformed investors set L to infinity, knowing

27

that skilled managers will choose Î¸. When instead some managers are unskilled, investors set L to
a finite value. In the limit where all managers are unskilled, L goes to zero.
The optimal value of Î· is related to the uninformed investorsâ€™ expectation of Î¸. It is not equal
to that expectation, however, but to a weighted average in which smaller values of Î¸ receive larger
weight. Indeed, since volatility per share is higher for small Î¸, a constraint in which Î· is equal to
the expectation of Î¸ would restrict managers more tightly for small Î¸: it would bind more often for
a position smaller than Î·, than for a position that deviates from Î· by an equal number of shares
in the opposite direction. Moreover, the former deviation is more profitable than the latter, and
hence should be less restricted. Indeed, since high noise-trader demand raises the price more than
low demand lowers it (Section 3.5), price distortions are more pronounced for small Î¸.
Figures 1-3 illustrate the asymmetry that causes the optimal Î· to be smaller than the investorsâ€™
expectation of Î¸. Suppose that each of Î¸ = 0.8 and Î¸ = 1.2 has probability 0.5, in which case
the investorsâ€™ expectation of Î¸ is equal to one, the value of Î· assumed in the figures. The middle
panel of Figure 1 shows that the constraint binds for a larger set of values of Dt when Î¸ = 0.8 than
when Î¸ = 1.2. The left panel of Figure 2 shows, in addition, that noise-trader demand lowers the
expected return of an asset with Î¸n = 0.8 more than it raises that of an asset with Î¸n = 1.2. Hence,
uninformed investors should set Î· < 1.
The value Î· = 1 in Figures 1-3 is optimal in the special case where the probability that uninformed investors give to all values of Î¸ 6= 1 goes to zero. When instead that probability remains
positive, uninformed investors set Î· < 1, moving the set of allowable positions that managers can
take in the risky asset towards lower values. Hence, managers can hold smaller positions in assets
in high noise-trader demand, reducing those assetsâ€™ overvaluation, and weakening the amplification
effect that drives up their volatility. Figure 4 shows how the plots in Figures 2 and 3 are modified
when Î¸ = 1 has probability 0.6 and each of Î¸ = 1 Â±

âˆ†Î¸
2

for âˆ†Î¸ âˆˆ {0.1, 0.2, 0.3, 0.4} has probability

0.05. All parameter values except for (Î·, L), which are chosen optimally, are as in Figures 1-3. We
interpret different realizations of Î¸ as different risky assets, and the probability Ï€(Î¸) of each realization as reflecting the number of assets in supply Î¸. Thus, there is one asset in supply Î¸n = 1 Â±

âˆ†Î¸
2

for âˆ†Î¸ âˆˆ {0.1, 0.2, 0.3, 0.4}, and twelve assets in supply Î¸n = 1.
The top left and middle panels of Figure 4 plot expected return and return volatility of two
assets as function of the fraction Î» of unskilled managers: the asset with Î¸n = 0.8 (dashed red
line), and the asset with Î¸n0 = 1.2 (solid blue line). Consistent with Figure 2, the difference in
expected returns between the two assets increases when Î» increases because the constraint tightens.
Moreover, the difference in return volatilities is largest for intermediate values of Î», with most of
the effect coming from the Î¸n = 0.8 asset. The main difference with Figure 2 is that the difference
in volatilities is lower: it is approximately 3% when 20% of managers are unskilled, while the
28

maximum difference in Figure 2 is 6%. This reflects the weaker amplification effect.
The top right panel of Figure 4 plots expected return as function of return volatility for Î» = 20%.
The negative relationship derived in Section 3 and plotted in Figure 2 carries through.
The bottom left panel of Figure 4 plots the unconditional averages of the prices of two segments
as function of Î»: the segment with (Î¸n , Î¸n0 ) = (0.8, 1.2), represented by the thick line, and the
segment with (Î¸nÌ‚ , Î¸nÌ‚0 ) = (1, 1), represented by the thin line. Noise-trader demand is more variable
within the former segment. Consistent with Figure 3, that segment trades at a higher price, and
its price increases both in absolute terms and relative to the latter segment when Î» increases.
The bottom middle panel of Figure 4 plots expected return at the segment level as function
of the dispersion in expected returns within the segment for Î» = 20% and for the five segments
corresponding to âˆ†Î¸ âˆˆ {0, 0.1, 0.2, 0.3, 0.4}. The relationship is weaker than in Figure 4, and turns
slightly positive for the first three segments. It remains negative for the last three segments, and
is strongly negative for the last two.
The bottom right panel of Figure 4 plots the unconditional average of the price of a market
portfolio in which each asset is in supply of one share. That portfolio is a scaled version of the
benchmark portfolio, in which each asset is in supply of Î· shares. The price is inversely humpshaped in Î», decreasing slightly for small Î» and increasing slightly for larger Î». This result differs
from a common finding in previous papers (e.g., Brennan (1993), Kapur and Timmermann (2005),
Cuoco and Kaniel (2011), Basak and Pavlova (2013), Buffa and Hodor (2018)) that benchmarkbased compensation raises the price of the benchmark portfolio.11 The price of the benchmark
portfolio can drop when managers are more constrained to stay close to that portfolio because
of the investorsâ€™ endogenous response: investors realize that tighter constraints exacerbate price
distortions, and reduce their overall investment in the risky assets by lowering Î·. If we suppress
the investorsâ€™ endogenous response by keeping Î· independent of Î», then a tighter constraint would
raise the price of the benchmark portfolio as in the previous papers. Moreover, the cross-sectional
distortions in Figure 4 would become larger and of the same magnitude as those in Figures 2 and
3.

4.3

Effective Capital

Endogenizing the constraint allows us to determine a measure of effective capital. According to the
market-efficiency view, noise-trader induced distortions should be small because institutions such as
mutual funds and pension funds can deploy large pools of capital to trade against them. According
to the limits-of-arbitrage view, that capital can be ineffective because agency problems between the
11

The inverse hump shape in Figure 4 does not change if we multiply the price of the market portfolio by Î·.

29

Figure 4: Endogenous Constraint

6.5

21.5

7

â—‹

â—‹
â–³

â—‹
21.0

â–¡

6.0

â—‹

6
20.5

â—‹

5.5

â–¡
20.0

5

â–³
â–³

5.0
19.5

â–³

4

4.5
19.0

â–³
3

0.1

0.2

0.3

0.4

18.5

0.1

0.2

0.3

4.0
18.5

0.4

19.0

19.5

20.0

20.5

21.0

21.5

0.922

7.45

â—‹
â—‹
7.40

1.05

0.920

â—‹
7.35 â—‹

0.918

7.30

1.00

7.25
0.95

0.916

7.20
0.914

7.15

â—‹

0.90

7.10
0.1

0.2

0.3

0.4

0.0

0.5

1.0

1.5

2.0

2.5

0.912

0.1

0.2

0.3

0.4

Expected return and return volatility as functions of Î» (top left and middle panels), expected return as
function of return volatility for fixed Î» (top right panel), segment price and aggregate market price as
functions of Î» (bottom left and right panels), and segment expected return as function of the dispersion in
expected returns within the segment for fixed Î» (bottom middle panel). The definitions of these quantities
and the drawing conventions are described in the legend of Figure 2 for the top panels, and of Figure 3 for
the bottom left and middle panels. There is one asset in supply Î¸n = 1 Â± âˆ†Î¸
2 for âˆ†Î¸ âˆˆ {0.1, 0.2, 0.3, 0.4},
and twelve assets in supply Î¸n = 1. The aggregate market price is the unconditional average of the prices of
these assets. The values of (Î·, L) are chosen optimally, and the remaining parameter values are as in Figure 1.

managers in these institutions and the investors who own the capital limit the managersâ€™ ability
to take risk. The limits-of-arbitrage view emphasizes instead the capital owned by smart-money
investors, who are free of agency problems.
An exercise that can inform the debate between the two views is to compute effective capital.

30

Suppose that a given amount of capital is invested with asset managers. Would price distortions
be almost the same as if agency problems between managers and investors did not exist, as per
the market-efficiency view? Or would they be larger and comparable to the distortions that would
exist if the only capital available were that of smart-money investors, as per the limits-of-arbitrage
view? Our model can provide answers to these questions because it incorporates noise traders and
price distortions, as well as a constraint on managers that arises from an agency problem with their
investors.
To compute effective capital, we suppose that out of the uninformed investors in measure x,
only a subset in measure y can invest but do so with skilled managers to whom they (optimally)
impose no constraints. We compute the price distortions under that scenario, and determine the
value of y such that distortions are the same as under the equilibrium derived in Section 4.2. That
value of y is the â€œsmart-money equivalentâ€ of the x uninformed investors. We refer to y and x as
effective and total capital, respectively.
We compute effective capital y in the numerical example of Section 4.2. We measure price
distortions by the average difference between the price of assets in high noise-trader demand and the
price of assets in low demand. Computing that measure amounts to taking the difference between
the price of the asset in supply Î¸n = 1 âˆ’

âˆ†Î¸
2

and the price of the asset in supply Î¸n = 1 +

âˆ†Î¸
2 ,

and

averaging over âˆ†Î¸ âˆˆ {0.1, 0.2, 0.3, 0.4} and Dt .
An increase in the fraction Î» of unskilled managers lowers effective capital y through two effects.
The direct effect is that that there are fewer skilled managers. The indirect effect is that tighter
constraints are imposed on skilled managers. If the direct effect were the only one present, then
effective capital would be equal to (1 âˆ’ Î»)x, the measure of investors who employ skilled managers.
To compare the direct and indirect effects, we plot in Figure 5 the fraction

y
x

of effective to total

capital (solid line) and the fraction 1 âˆ’ Î» accounted by the direct effect only (dashed line), as
functions of Î».
Figure 5 shows that the indirect effect is larger than the direct effect. For example, when
Î» = 10%, effective capital is approximately 60% of total capital, while it should be 90% with only
the direct effect present. When Î» = 20%, effective capital drops to 40%, while under the direct
effect it should drop to only 80%. Thus, the constraints imposed on managers reduce significantly
the available capital to correct price distortions. At the same time, effective capital remains a
non-trivial fraction of total capital.

31

Figure 5: Effective Capital
100

80

60

40

20
0.1

0.2

0.3

0.4

Fraction xy of effective to total capital (solid line) and fraction 1 âˆ’ Î» accounted by the direct effect only
(dashed line) as functions of Î». The value of y equates the difference between the price of the asset in supply
âˆ†Î¸
Î¸n = 1 âˆ’ âˆ†Î¸
2 and the price of the asset in supply Î¸n = 1 + 2 , averaged over âˆ†Î¸ âˆˆ {0.1, 0.2, 0.3, 0.4} and
Dt , to its counterpart in the equilibrium derived in Section 4.2. The values of (Î·, L) are chosen optimally,
and the remaining parameter values are as in Figure 1.

5

Conclusion

We derive equilibrium asset prices when fund managers deviate from benchmark indices to exploit
noise-trader induced distortions but fund investors constrain these deviations. Fund managers in
our model are not passive, in the sense that they are not constrained to hold benchmark portfolios,
nor are they fully active, in the sense that their deviations from these portfolios must lie within
bounds. We argue that this view of asset management is more realistic than the conventional
active/passive dichotomy, and yields different asset-pricing implications. We develop an approach
to endogenize managersâ€™ constraints based on investorsâ€™ uncertainty about managersâ€™ skill, and
relate the asset-pricing implications to the fraction of unskilled managers.
Our analysis suggests that tracking-error constraints and other portfolio limitations of asset
managers can have important effects on portfolio policies and equilibrium asset prices. Empirical
research has begun to investigate these effects. For example, Christoffersen and Simutin (2017)
find that mutual-fund managers who manage pension-fund assets, and hence face greater pressure
to meet benchmarks, hold a larger fraction of their portfolios in high-beta stocks and achieve
lower alphas. This is consistent with our result that assets in high noise-trader demand have high
betas, and that more constrained managers hold more shares of these assets than less constrained

32

managers. Lines (2016) finds that mutual-fund managers shift their portfolio weights towards the
benchmark when volatility rises, putting downward price pressure on overweight stocks and upward
pressure on underweight stocks. This is consistent with the amplification effect that we derive.
Extending the empirical investigation by bringing in proxies for noise-trader demand could yield
sharper tests of the theoretical mechanisms. Such proxies could include flows into mutual funds,
or restricted mandates by institutional investors not to invest in some industry sectors. Empirical
studies have documented that high demand according to these proxies is associated with low future
returns.12 Our analysis implies additionally that high demand should be associated with high
volatility, and that the trading of managers with tighter constraints should be contributing to this.
A number of extensions are possible on the theoretical front as well. One extension is to make
the contracting model between investors and managers dynamic. In a dynamic model, managers
could build reputations or could be given incentives based on future termination.13 Reputations
could reduce agency problems. At the same time, they might exacerbate some of the asset-pricing
effects that we derive as managers could choose to stay close to their benchmarks to avoid damaging
their reputations.
Another extension concerns the normative and policy implications. While each investor in our
model seeks to limit the risk taken by his manager, the combined effect of these efforts is to raise the
volatility of assets in high noise-trader demand. Would a regulator or a social planner internalize
that effect and impose laxer constraints? More generally, how do privately optimal constraints and
contracts compare to socially optimal ones? Our setting can help address these questions because
it captures the two-way feedback between constraints/contracts and equilibrium asset prices.

12

Frazzini and Lamont (2008) argue that noise-trader demand (â€œdumb moneyâ€ in their terminology) can be proxied
by flows into mutual funds, as these predict low long-horizon returns for the stocks bought by the funds. In a similar
spirit, Coval and Stafford (2007) find that that stocks sold by mutual funds that experience extreme outflows earn
high long-horizon returns, while stocks bought by funds that experience extreme inflows earn low returns. Hong and
Kacperczyk (2009) find that stocks in â€œsin industriesâ€ (alcohol, gaming and tobacco) are less held by institutions,
presumably because of restricted mandates, and earn higher returns. An alternative proxy for noise-trader demand
could be holdings by controlling shareholders, e.g., in family firms.
13
Papers on fund managersâ€™ reputation concerns include Froot, Scharftstein, and Stein (1992), Dasgupta and Prat
(2008), Dasgupta, Prat, and Verardo (2011), and Guerrieri and Kondor (2012).

33

Appendix
A

Proofs

Proof of Proposition 3.1. Substituting the affine price function (3.5) into the ODE (3.4), we
find
Dt + Îº(DÌ„ âˆ’ Dt )a1 âˆ’ r(a0 + a1 Dt ) = ÏÎ¸Ïƒ 2 Dt a21 .

(A.1)

Equation (A.1) is affine in Dt . Identifying the terms that are linear in Dt yields the equation
ÏÎ¸Ïƒ 2 a21 + (r + Îº)a1 âˆ’ 1 = 0.

(A.2)

Equation (A.2) is quadratic in a1 . When Î¸ > 0, the left-hand side is increasing for positive values of
a1 , and (A.2) has a unique positive solution, given by (3.7). When Î¸ < 0, the left-hand side is humpshaped for positive values of a1 , and (A.2) has either two positive solutions, or one positive solution,
2

in Proposition 3.1 ensures that two positive solutions exist
or no solution. Condition Î¸ > âˆ’ (r+Îº)
4ÏÏƒ 2
when Î¸ < 0. Equation (3.7) gives the smaller of the two solutions, which is the continuous extension
of the unique positive solution when Î¸ > 0. Identifying the constant terms yields the equation
ÎºDÌ„a1 âˆ’ ra0 = 0,
whose solution is (3.6).
To show that S(Dt ) and S 0 (Dt ) are decreasing and convex in Î¸, we note that a1 takes the form
Î¨(Î¸) â‰¡

A+

âˆš

1
B + CÎ¸

for positive constants (A, B, C). The function Î¨(Î¸) is decreasing. It is also convex because its
derivative
C
1
Î¨0 (Î¸) = âˆ’ âˆš
âˆš

2 B + CÎ¸ A + B + CÎ¸ 2
is increasing. Hence, a1 is decreasing and convex in Î¸. These properties extend to a0 from (3.6),
and to S 0 (Dt ) = a1 and S(Dt ) = a0 + a1 Dt .
Proof of Corollary 3.1. Substituting the price from (3.5) into (3.1), we find that the assetâ€™s

34

share return is
p


dRtsh = Dt + Îº(DÌ„ âˆ’ Dt )a1 âˆ’ r(a0 + a1 Dt ) dt + Ïƒ Dt a1 dBt
p
= ÏÎ¸Ïƒ 2 Dt a21 dt + Ïƒ Dt a1 dBt ,

(A.3)

where the second step follows from (A.1). Substituting the share return from (A.3) and the price
from (3.5) into (2.2), we find that the assetâ€™s (dollar) return is
âˆš
ÏÎ¸Ïƒ 2 Dt a21 dt + Ïƒ Dt a1 dBt
a0 + a1 Dt
âˆš
2
ÏÎ¸Ïƒ Dt a1 dt + Ïƒ Dt dBt
=
Îº
r DÌ„ + Dt
âˆš
2
2ÏÎ¸Ïƒ
âˆš Dt dt
+ Ïƒ Dt dBt
r+Îº+ (r+Îº)2 +4ÏÎ¸Ïƒ 2
=
,
Îº
r DÌ„ + Dt

dRt =

(A.4)

where the second step follows from (3.6) and the third step follows from (3.7).
The conditional expected return is the drift coefficient in (A.4) times dt,
Et (dRt ) = 

2ÏÎ¸Ïƒ 2 Dt dt
r+Îº+

p

(r + Îº)2 + 4ÏÎ¸Ïƒ 2



Îº
r DÌ„

+ Dt

.

2

Dt dt
It takes the form Î¦(Î¸) 2ÏÏƒ
, where
Îº
DÌ„+D
r

Î¦(Î¸) â‰¡

A+

âˆš

t

Î¸
B + CÎ¸

for positive constants (A, B, C). The function Î¦(Î¸) is increasing, and hence the conditional expected
return is increasing in Î¸. (The derivative of Î¦(Î¸) has the same sign as
A+

âˆš

C
1
B + CÎ¸ âˆ’ âˆš
Î¸ =A+ âˆš
2 B + CÎ¸
B + CÎ¸



CÎ¸
B+
2


.

This expression is positive for B + CÎ¸ > 0, a condition which is required for the term in the square
root to be positive.) The unconditional expected return is the unconditional expectation of the
conditional expected return,
E(dRt ) = E (Et (dRt )) ,
because of the law of iterative expectations. Since Et (dRt ) is increasing in Î¸ for any given Dt ,
E(dRt ) is increasing in Î¸.

35

The returnâ€™s conditional volatility is the diffusion coefficient in (A.4) times
p

âˆš
Ïƒ Dt dt
.
Vart (dRt ) = Îº
r DÌ„ + Dt

âˆš

dt,
(A.5)

It is independent of Î¸. The returnâ€™s unconditional variance is the unconditional expectation of the
returnâ€™s conditional variance,
Var(dRt ) = E (Vart (dRt )) .

(A.6)

Since Vart (dRt ) is independent of Î¸ for any given Dt , Var(dRt ) is independent of Î¸, and so is the
p
returnâ€™s unconditional volatility Var(dRt ). Equation (A.6) is implied by the law of total variance
Var(dRt ) = E (Vart (dRt )) + Var (Et (dRt ))

(A.7)

and because in continuous time the second term in the right-hand side of (A.7) is negligible relative
to the first: the second term is of order dt2 while the first is of order dt.
Proof of Proposition 3.2. Since the ODE (3.8) is identical to (3.4) except that Î¸ is replaced
by

Î¸âˆ’xÎ·
1âˆ’x ,

(3.9) can be derived from (3.7) with the same substitution. The comparisons with the

case L = âˆ follow because the function Î¨(Î¸) defined in the proof of Proposition 3.1 is decreasing.
Since

Î¸âˆ’xÎ·
1âˆ’x

> Î¸ when Î¸ > Î·, (3.7) and (3.9) imply that a1 is smaller in the case L = 0 than in the

case L = âˆ. Conversely, since

Î¸âˆ’xÎ·
1âˆ’x

< Î¸ when Î¸ < Î·, (3.7) and (3.9) imply that a1 is larger in

the case L = 0 than in the case L = âˆ. These comparisons of a1 extend to a0 , S 0 (Dt ) = a1 and
S(Dt ) = a0 + a1 Dt .
Proof of Corollary 3.2. The price in the case L = 0 can be derived from the price in the case
L = âˆ by replacing Î¸ by

Î¸âˆ’xÎ·
1âˆ’x .

Since the conditional and unconditional volatility in the case L = âˆ

are independent of Î¸ (Corollary 3.2), they are also independent of Î¸ in the case L = 0, and they
are equal across the two cases.
Proof of Theorem 3.1. We prove the theorem through a series of lemmas. Lemma A.1 shows
existence of a solution to the ODE system in a compact interval and with initial conditions at the
one end of the interval.

Lemma A.1. [Existence in compact interval with conditions at one boundary] Consider  > 0 and M >  sufficiently large. A solution S(Dt ) to the system of ODEs (3.4) in the

36

unconstrained region (3.11), and (3.13) in the constrained region (3.14), with the initial conditions
S 0 (M ) =

2

,
2
r + Îº + (r + Îº)2 + 4Ï(Î¸âˆ’xÎ·)
Ïƒ
1âˆ’x


1 2
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
1
0
0
(ÎºDÌ„ + rM )S (M ) + Ïƒ M Î¦ +
Ïƒ M S (M ) ,
S(M ) =
r
2
1âˆ’x
q

(A.8)

(A.9)

exists, either in the entire interval [, M ], or in a maximal interval (Ë†
, M ] with Ë† â‰¥ . In the latter
case limDt â†’Ë† |S 0 (Dt )| = âˆ.
Proof of Lemma A.1. The ODEs (3.4) and (3.13) satisfy the conditions of the Cauchy-Lipschitz
theorem for any Dt > 0. To show this for the ODE (3.4), we write it as a system of two first-order
ODEs:
S 0 (Dt ) = T (Dt ),


2
ÏÎ¸
0
2
2
T (Dt ) = 2
Ïƒ Dt T (Dt ) âˆ’ Dt âˆ’ Îº(DÌ„ âˆ’ Dt )T (Dt ) + rS(Dt ) .
Ïƒ Dt 1 âˆ’ Î»x
The function
(Dt , S, T ) âˆ’â†’

!

T
2
Ïƒ 2 Dt



ÏÎ¸
2
2
1âˆ’Î»x Ïƒ Dt T

âˆ’ Dt âˆ’ Îº(DÌ„ âˆ’ Dt )T + rS



is continuously differentiable for (Dt , S, T ) âˆˆ (0, âˆ) Ã— (âˆ’âˆ, âˆ) Ã— (âˆ’âˆ, âˆ). Hence, it is locally
Lipschitz in that set, and the Cauchy-Lipschitz theorem implies that for any (Dt , S, T ) âˆˆ (0, âˆ) Ã—
(âˆ’âˆ, âˆ) Ã— (âˆ’âˆ, âˆ), the ODE (3.4) has a unique solution in a neighborhood of Dt with initial
conditions S(Dt ) = S and S 0 (Dt ) = T . The same argument establishes local existence of a solution
to the ODE (3.13).
Consider the solution to the ODE (3.13) with initial conditions (A.8) and (A.9). The value of
S(M ) in (A.9) is implied from the ODE (3.13) by setting S 00 (M ) = Î¦. Indeed, (A.9) is equivalent
to
1
S(M ) =
r



1 2
Ï(Î¸ âˆ’ xÎ·) 2
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
0
0
2
0
M + Îº(DÌ„ âˆ’ M )S (M ) + Ïƒ M Î¦ âˆ’
Ïƒ M S (M ) +
Ïƒ M S (M )
2
1âˆ’x
1âˆ’x
(A.10)

because the value of S 0 (M ) in (A.8) solves the equation
Ï(Î¸ âˆ’ xÎ·) 2 0
Ïƒ S (M )2 + (r + Îº)S 0 (M ) âˆ’ 1 = 0.
1âˆ’x

37

(A.11)

Equation (A.11) is quadratic in S 0 (M ). When Î¸ > xÎ·, the left-hand side is increasing for
positive values of S 0 (M ), and (A.11) has a unique positive solution, given by (A.8). When Î¸ < xÎ·,
the left-hand side is hump-shaped for positive values of S 0 (M ), and (A.11) has either two positive
solutions, or one positive solution, or no solution. Condition Î¸ > xÎ· âˆ’

(1âˆ’x)(r+Îº)2
4ÏÏƒ 2

in Theorem 3.1

ensures that two positive solutions exist when Î¸ < xÎ·. Equation (A.8) gives the smaller of the two
solutions, which is the continuous extension of the unique positive solution when Î¸ > xÎ·.
Since S 0 (M ) is independent of M , (3.14) is met for M sufficiently large. Continuity then implies
that the solution to the ODE (3.13) with initial conditions (A.8) and (A.9) lies in the constrained
region (3.14) in a neighborhood to the left of M . We extend the solution maximally to the left
of M , up to a point m1 where either the solution explodes (limDt â†’m1 |S 0 (Dt )| = âˆ) or condition
(3.14) that defines the constrained region is violated in a neighborhood to the left of m1 . In the
second case, we extend the solution to the left of m1 by using the ODE (3.4) instead of (3.13). If
âˆš
the first derivative of Dt S 0 (Dt ) at m1 is non-zero, then it has to be positive because (3.14) is
violated to the left of m1 , and the extended solution lies in the unconstrained region (3.11) in a
neighborhood to the left of m1 , by continuity. (Extending the solution to the left of m1 by using the
âˆš
ODE (3.4) instead of (3.13) yields the same first derivative of Dt S 0 (Dt ), i.e., the first derivatives
âˆš
of Dt S 0 (Dt ) from the left, using (3.4), and the right, using (3.13), coincide. The first derivatives
of S(Dt ) from the left and the right coincide because the first derivative from the right is used as
initial condition when extending the solution to the left. The second derivatives of S(Dt ) from the
left and the right coincide because the first derivatives coincide and (3.11) holds with equality at
âˆš
m1 . The result, used next in the proof, that higher-order derivatives of Dt S 0 (Dt ) from the left and
the right coincide if all lower-order derivatives are zero uses a similar argument and differentiation
âˆš
of (3.4) and (3.13).) If the first derivative of Dt S 0 (Dt ) at m1 is zero, then the second derivative
must also be zero because otherwise (3.14) would not be violated to the left of m1 . If the third
âˆš
derivative of Dt S 0 (Dt ) at m1 is non-zero, then it has to be positive because (3.14) is violated to
the left of m1 , and the extended solution lies in the unconstrained region (3.11) in a neighborhood
to the left of m1 , by continuity. Proceeding in this manner for higher-order derivatives, we conclude
that the extended solution (using the ODE (3.4) instead of (3.13) to the left of m1 ) may not lie in
the unconstrained region (3.11) in a neighborhood to the left of m1 only if all n-th order derivatives
âˆš
of Dt S 0 (Dt ) at m1 , for n â‰¥ 1, are zero. Writing, however, the ODE (3.13) in terms of the function
âˆš
U (Dt ) â‰¡ Dt S 0 (Dt ) taking the (n + 1)-th order derivative of the resulting equation at m1 , and

38

using U (m1 ) > 0 and

dn+1
dDtn+1

[U (Dt )]Dt =m1 = 0 for all n â‰¥ 0, we find




dn+1
U (Dt ) 1 2 p
1
0
Dt + Îº(DÌ„ âˆ’ Dt ) âˆš
U (Dt ) âˆ’ rS(M )
+ Ïƒ Dt U (Dt ) âˆ’
2
2Dt
Dt
dDtn+1
#


Z Dt
U (Dt0 ) 0
dn+1 Ï(Î¸ âˆ’ xÎ·) 2
Ï sgn(Î¸ âˆ’ Î·)xL
2
p
=
âˆ’r
Ïƒ U (Dt ) âˆ’
ÏƒU (Dt )
dDt
1âˆ’x
1âˆ’x
dDtn+1
Dt0
M
Dt =m1
Dt =m1




n
n+1
d
d
DÌ„ âˆ’ Dt 1 2 1
1
âˆš
âˆš
âˆ’r
=0
âˆ’ Ïƒ âˆš
â‡’
n
n+1 Îº
4
dDt
Dt
Dt Dt =m1
Dt Dt =m1
dDt
for all n â‰¥ 0, a contradiction. Hence, the extended solution lies in the unconstrained region (3.11)
in a neighborhood to the left of m1 . We extend that solution maximally to the left of m1 , up to
a point m2 where either the solution explodes (limDt â†’m2 |S 0 (Dt )| = âˆ) or where condition (3.11)
is violated in a neighborhood to the left of m2 . In the second case, we extend the solution to the
left of m1 by using the ODE (3.13) instead of (3.4). Repeating this process yields a solution to
the system of ODEs (3.4) in the unconstrained region (3.11), and (3.13) in the constrained region
(3.14), with initial conditions (A.8) and (A.9), which either is defined in [, M ] or explodes at an
Ë† â‰¥ .
Lemma A.2 shows that the solution derived in Lemma A.1 is either increasing in Dt or is
decreasing and then increasing.

Lemma A.2. [Monotonicity] For the solution derived in Lemma A.1, either S 0 (Dt ) > 0 for all
Dt , or there exists m < M such that S 0 (Dt ) > 0 for all Dt âˆˆ (m, M ], S 0 (Dt ) < 0 for all Dt < m,
and S(m) > 0.
Proof of Lemma A.2. Since S 0 (M ) > 0, S 0 (Dt ) > 0 for Dt smaller than and close to M . Suppose
that there exists Dt < M such that S 0 (Dt ) â‰¤ 0, and consider the supremum m within that set.
The definition of m implies S 0 (Dt ) > 0 for all Dt in the non-empty set (m, M ), S 0 (m) = 0, and
S 00 (m) â‰¥ 0. If S 00 (m) = 0, then differentiation of (3.4) and (3.13) at m yields S 000 (m) < 0, which
contradicts S 0 (Dt ) > S 0 (m) = 0 for Dt > m. Hence, S 00 (m) > 0, which in turn implies S 0 (Dt ) < 0
for Dt smaller than and close to M
Suppose next, by contradiction, that there exists Dt < m such that S 0 (Dt ) â‰¥ 0, and consider
the supremum m1 within that set. The definition of m1 implies that S 0 (Dt ) < 0 for all Dt in the
non-empty set (m1 , m), S 0 (m1 ) = 0, and S 00 (m1 ) â‰¤ 0.
Substituting S 0 (m) = 0 and S 00 (m) > 0 in (3.4) and (3.13), we find that in both cases
m âˆ’ rS(m) < 0.

(A.12)
39

Likewise, substituting S 0 (m1 ) = 0 and S 00 (m1 ) â‰¤ 0 in (3.4) and (3.13), we find
m1 âˆ’ rS(m1 ) â‰¥ 0.

(A.13)

Equations (A.12) and (A.13) imply
S(m) âˆ’ S(m1 ) >

m âˆ’ m1
> 0,
r

which contradicts S 0 (Dt ) < 0 for all Dt âˆˆ (m1 , m). Hence, either S 0 (Dt ) > 0 for all Dt , or there
exists m < M such that S 0 (Dt ) > 0 for all Dt âˆˆ (m, M ] and S 0 (Dt ) < 0 for all Dt < m. In the
latter case, (A.12) implies S(m) >

m
r

> 0.

Lemma A.3 shows a monotonicity property of the solution with respect to the initial conditions.
If a solution S1 (Dt ) lies below another solution S2 (Dt ) at M , and their first derivatives are equal
at M , then S1 (Dt ) lies below S2 (Dt ) for all Dt < M , while the comparison reverses for the first
derivatives.

Lemma A.3. [Monotonicity over initial conditions] Consider two solutions S1 (Dt ) and S2 (Dt )
derived in Lemma A.1 for Î¦1 and Î¦2 > Î¦1 , respectively. For all Dt < M , S1 (Dt ) < S2 (Dt ) and
S10 (Dt ) > S20 (Dt ).
Proof of Lemma A.3. Equation (A.8) implies S10 (M ) = S20 (M ). Equations (A.10) and Î¦1 < Î¦2
imply S1 (M ) < S2 (M ) and S100 (M ) < S200 (M ). Combining the latter inequality with S10 (M ) =
S20 (M ), we find S10 (Dt ) > S20 (Dt ) for Dt smaller than and close to M . Moreover, by continuity,
S1 (Dt ) < S2 (Dt ) for Dt smaller than and close to M . Suppose, by contradiction, that there exists
Dt < M such that S1 (Dt ) â‰¥ S2 (Dt ) or S10 (Dt ) â‰¤ S20 (Dt ), and consider the supremum m within that
set. The definition of m implies S1 (Dt ) < S2 (Dt ) and S10 (Dt ) > S20 (Dt ) for all Dt in the non-empty
set (m, M ), and S1 (m) = S2 (m) or S10 (m) = S20 (m).
Since S1 (M ) < S2 (M ) and S10 (Dt ) > S20 (Dt ) for all Dt âˆˆ (m, M ), S1 (m) < S2 (m). Hence,
S10 (m) = S20 (m). Equations (3.4) and (3.13) both imply, however, that since S1 (m) < S2 (m),
S100 (m) < S200 (m). Hence, S10 (Dt ) < S20 (Dt ) for Dt close to and larger than m, a contradiction.
Lemma A.4 derives properties of the solution for Î¦ = 0. For this and subsequent results, we
use the function Z(Dt ) defined by
Z(Dt ) â‰¡ (ÎºDÌ„ + rDt )S 0 (Dt ) âˆ’ rS(Dt ).

40

Lemma A.4. [Solution for Î¦ = 0] The solution S(Dt ) derived in Lemma A.1 has the following
properties for Î¦ = 0:
â€¢ When Î¸ > Î·, the solution satisfies Z() < 0 if it can be defined in [, M ], and satisfies
limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ and limDt â†’Ë† S(Dt ) > 0 if it explodes at Ë† â‰¥ .
â€¢ When Î¸ < Î·, the solution can be defined in [, M ], and satisfies Z() > 0.
Proof of Lemma A.4. We start with the case Î¸ > Î·. Suppose first that there exists Dt < M
such that S 0 (Dt ) â‰¤ 0. Lemma A.2 implies that there exists a unique m < M such that S 0 (Dt ) > 0
for all Dt âˆˆ (m, M ], S 0 (Dt ) < 0 for all Dt < m, and S(m) > 0. Hence, if the solution can be defined
in [, M ], it satisfies
(ÎºDÌ„ + r)S 0 () â‰¤ 0 < rS(m) â‰¤ rS(),
which implies Z() < 0. If instead the solution explodes at Ë† â‰¥ , it satisfies limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ
and limDt â†’Ë† S(Dt ) > S(m) > 0.
Suppose next that S 0 (Dt ) > 0 for all Dt â‰¤ M . We will show that the solution is convex, can be
defined in [, M ], and satisfies Z() < 0. We first show that S 000 (M ) < 0. We write the ODE (3.13)
as
Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL
1
rS(Dt ) âˆ’ ÎºDÌ„S 0 (Dt )
1 2 00
Ïƒ S (Dt ) =
Ïƒ S (Dt )2 âˆ’
Ïƒ âˆš S 0 (Dt )âˆ’1+
+ÎºS 0 (Dt ).
2
1âˆ’x
1âˆ’x
Dt
Dt
(A.14)
Differentiating both sides, we find
ï£«

ï£¶

Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL ï£­ 1
1
1 2 000
0
ï£¸
Ïƒ S (Dt ) =2
Ïƒ S (Dt )S 00 (Dt ) âˆ’
Ïƒ âˆš S 00 (Dt ) âˆ’
3 S (Dt )
2
1âˆ’x
1âˆ’x
Dt
2
2Dt
+

rS 0 (Dt ) âˆ’ ÎºDÌ„S 00 (Dt ) rS(Dt ) âˆ’ ÎºDÌ„S 0 (Dt )
âˆ’
+ ÎºS 00 (Dt ).
Dt
Dt2

(A.15)

Setting Dt = M in (A.15) and using S 00 (M ) = Î¦ = 0, we find
1 2 000
Ï sgn(Î¸ âˆ’ Î·)xL
1
rS 0 (M ) rS(M ) âˆ’ ÎºDÌ„S 0 (M )
0
Ïƒ S (M ) =
Ïƒ
âˆ’
3 S (M ) +
2
1âˆ’x
M
M2
2M 2
Ï sgn(Î¸ âˆ’ Î·)xL
1
0
=âˆ’
Ïƒ
3 S (M ) < 0,
1âˆ’x
2
2M

(A.16)

where the second step follows by substituting S(M ) from (A.9) and using again Î¦ = 0.
Since S 000 (M ) < 0 and S 00 (M ) = 0, S 00 (Dt ) > 0 for Dt smaller than and close to M . Suppose,
41

by contradiction, that there exists Dt < M such that S 00 (Dt ) â‰¤ 0, and consider the supremum
m within that set. The definition of m implies that S 00 (Dt ) > 0 for all Dt in the non-empty set
(m, M ), S 00 (m) = 0, and S 000 (m) â‰¥ 0.
Suppose that m lies in the constrained region. Setting Dt = m in (A.15), and using S 00 (m) = 0
and S 000 (m) â‰¥ 0, we find
rS 0 (m) rS(m) âˆ’ ÎºDÌ„S 0 (m)
1
Ï sgn(Î¸ âˆ’ Î·)xL
0
Ïƒ
âˆ’
â‰¥0
3 S (m) +
1âˆ’x
m
m2
2m 2


1 Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL
1
0
2
0
â‡”âˆ’
Ïƒ
Ïƒ S (m) + (r + Îº)S (m) âˆ’ 1 â‰¥ 0,
3 S (m) +
1âˆ’x
m
1âˆ’x
2m 2
(A.17)
where the second step follows by substituting S(m) from (3.13) and using again S 00 (m) = 0. The
contradiction follows because both terms in the left-hand side of (A.17) are negative. The first
term is negative because S 0 (m) > 0. The second term is negative because (i) S 00 (Dt ) > 0 for all
Dt âˆˆ (m, M ) implies S 0 (m) < S 0 (M ), and (ii) the latter inequality together with S 0 (m) > 0 imply
that the left-hand side of (A.11) becomes negative when S 0 (M ) is replaced by S 0 (m).
Suppose next that m lies in the unconstrained region. The ODE (3.4) yields the following
counterpart of (A.15):
rS 0 (Dt ) âˆ’ ÎºDÌ„S 00 (Dt ) rS(Dt ) âˆ’ ÎºDÌ„S 0 (Dt )
1 2 000
Ïƒ S (Dt ) = 2ÏÎ¸Ïƒ 2 S 0 (Dt )S 00 (Dt )+
âˆ’
+ÎºS 00 (Dt ). (A.18)
2
Dt
Dt2
Setting Dt = m in (A.18), and using S 00 (m) = 0, S 000 (m) â‰¥ 0, and (3.4), we find the following
counterpart of (A.17):

1
ÏÎ¸Ïƒ 2 S 0 (m)2 + (r + Îº)S 0 (m) âˆ’ 1 â‰¥ 0.
m

(A.19)

The contradiction follows because (i) S 00 (Dt ) > 0 for all Dt âˆˆ (m, M ) implies S 0 (m) < S 0 (M ),
(ii) the latter inequality together with S 0 (m) > 0 imply that the left-hand side of (A.11) becomes
negative when S 0 (M ) is replaced by S 0 (m), and (iii) the left-hand side of (A.11) being negative and
Î¸ > Î· imply that the left-hand side of (A.19) is negative. Since S 00 (Dt ) > 0 for all Dt < M , S(Dt )
is convex.
If the solution explodes at Ë† â‰¥ , then convexity implies limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ, contradicting

42

S 0 (Dt ) > 0 for all Dt . Hence, the solution can be defined in [, M ]. Moreover, convexity implies
rS() â‰¥ rS(M ) + r( âˆ’ M )S 0 (M )
= (ÎºDÌ„ + r)S 0 (M ) +

Ï sgn(Î¸ âˆ’ Î·)xL âˆš
Ïƒ M S 0 (M ),
1âˆ’x

(A.20)

where the second step follows by substituting S(M ) from (A.9) and using Î¦ = 0. Equation (A.20)
implies Z() < 0 because S 0 (M ) > 0 and S 0 (M ) > S 0 ().
We next consider the case Î¸ < Î·. We will show that the solution is concave, can be defined
in [, M ], and satisfies Z() > 0. Equation (A.16) implies S 000 (M ) > 0. Since S 000 (M ) > 0 and
S 00 (M ) = 0, S 00 (Dt ) < 0 for Dt smaller than and close to M . Suppose, by contradiction, that there
exists Dt < M such that S 00 (Dt ) â‰¥ 0, and consider the supremum m within that set. The definition
of m implies that S 00 (Dt ) < 0 for all Dt in the non-empty set (m, M ), S 00 (m) = 0, and S 000 (m) â‰¤ 0.
Suppose that m lies in the unconstrained region. Since S 00 (m) = 0 and S 000 (m) â‰¤ 0, (A.19)
holds as an inequality in the opposite direction, i.e.,

1
ÏÎ¸Ïƒ 2 S 0 (m)2 + (r + Îº)S 0 (m) âˆ’ 1 â‰¤ 0.
m

(A.21)

When Î· > Î¸ > xÎ·, (A.21) yields a contradiction because (i) S 00 (Dt ) < 0 for all Dt âˆˆ (m, M ) implies
S 0 (m) > S 0 (M ), (ii) the latter inequality implies that the left-hand side of (A.11) becomes positive
when S 0 (M ) is replaced by S 0 (m), and (iii) the left-hand side of (A.11) being positive and Î¸ < Î·
imply that the left-hand side of (A.21) is positive. When, however, xÎ· > Î¸, (A.21) does not yield
a contradiction because the left-hand side of (A.11) is hump-shaped for positive values of S 0 (M ),
rather than increasing. It increases until the mid-point between the two positive roots, and then
decreases to âˆ’âˆ.
To derive a contradiction when xÎ· > Î¸, we examine the behavior of Z(Dt ) in (m, M ). Since
Z 0 (Dt ) = (ÎºDÌ„ + rDt )S 00 (Dt ) < 0

(A.22)

for all Dt âˆˆ (m, M ), Z(Dt ) is decreasing in (m, M ). Moreover, (A.9) and Î¦ = 0 imply
Z(M ) = (ÎºDÌ„ + rM )S 0 (M ) âˆ’ rS(M ) = âˆ’

Ï sgn(Î¸ âˆ’ Î·)xL âˆš
Ïƒ M S 0 (M ),
1âˆ’x

(A.23)

and (3.4) and S 00 (m) = 0 imply

Z(m) = (ÎºDÌ„ + rm)S 0 (m) âˆ’ rS(m) = m ÏÎ¸Ïƒ 2 S 0 (m)2 + (r + Îº)S 0 (m) âˆ’ 1 .

43

(A.24)

Since Z(Dt ) is decreasing,
Z(m) > Z(M )

Ï sgn(Î¸ âˆ’ Î·)xL âˆš
â‡” m ÏÎ¸Ïƒ 2 S 0 (m)2 + (r + Îº)S 0 (m) âˆ’ 1 > âˆ’
Ïƒ M S 0 (M ) > 0,
1âˆ’x

(A.25)

where the second step follows from (A.23) and (A.24). Equation (A.25) contradicts (A.21).
Suppose next that m lies in the constrained region. Since S 00 (m) = 0 and S 000 (m) â‰¤ 0, (A.17)
holds as an inequality in the opposite direction, i.e.,
1
1
Ï sgn(Î¸ âˆ’ Î·)xL
0
Ïƒ
âˆ’
3 S (m) +
1âˆ’x
m
2m 2



Ï(Î¸ âˆ’ xÎ·) 2 0
Ïƒ S (m)2 + (r + Îº)S 0 (m) âˆ’ 1
1âˆ’x


â‰¤ 0.

(A.26)

When Î· > Î¸ > xÎ·, (A.26) yields a contradiction because both terms in the left-hand side are
positive. The first term is positive because S 0 (m) > 0. The second term is positive because (i)
S 00 (Dt ) < 0 for all Dt âˆˆ (m, M ) implies S 0 (m) > S 0 (M ), and (ii) the latter inequality implies
that the left-hand side of (A.11) becomes positive when S 0 (M ) is replaced by S 0 (m). To derive a
contradiction when xÎ· > Î¸, we examine the behavior of Z(Dt ) in (m, M ). Equations (3.13) and
S 00 (m) = 0 imply
Z(m) = (ÎºDÌ„ + rm)S 0 (m) âˆ’ rS(m)


Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
2
0
=m
Ïƒ S (m) + (r + Îº)S (m) âˆ’ 1 âˆ’
Ïƒ mS 0 (m).
1âˆ’x
1âˆ’x

(A.27)

Equation (A.22) implies
Z

M

(ÎºDÌ„ + rDt )S 00 (Dt )dDt
m
Z M
â‡’ Z(m) â‰¥ Z(M ) âˆ’
rmS 00 (Dt )dDt

Z(m) = Z(M ) âˆ’

m

â‡” Z(m) > Z(M ) + rm[S 0 (m) âˆ’ S 0 (M )]


Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
2
0
Ïƒ S (m) + (r + Îº)S (m) âˆ’ 1 âˆ’
Ïƒ mS 0 (m)
â‡”m
1âˆ’x
1âˆ’x
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
>âˆ’
Ïƒ M S 0 (M ) + rm[S 0 (m) âˆ’ S 0 (M )],
1âˆ’x

(A.28)

where the last step follows from (A.23) and (A.27). Combining (A.26) and (A.28), we find
âˆš
Ï sgn(Î¸ âˆ’ Î·)xL
m 0
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
Ïƒ
S (m) > âˆ’
Ïƒ M S 0 (M ) + rm[S 0 (m) âˆ’ S 0 (M )]
1âˆ’x
2
1âˆ’x
âˆš
ÏxL
m 0
ÏxL âˆš
â‡”
Ïƒ
S (m) âˆ’ rm[S 0 (m) âˆ’ S 0 (M )] >
Ïƒ M S 0 (M ).
(A.29)
1âˆ’x 2
1âˆ’x

âˆ’

44

The left-hand side of (A.29) is linear in S 0 (m). Since S 00 (Dt ) < 0 for all Dt âˆˆ (m, M ), S 0 (m) is
bounded below by S 0 (M ). To derive an upper bound for S 0 (m), we note that since S 0 (m) > S 0 (M ),
(A.28) implies
ÏxL
1
Ï(Î¸ âˆ’ xÎ·) 2 0
Ïƒ S (m)2 + (r + Îº)S 0 (m) âˆ’ 1 +
Ïƒ âˆš S 0 (m) > 0.
1âˆ’x
1âˆ’x
m
Hence, S 0 (m) is smaller than the larger positive root of the quadratic equation


ÏxL
1
Ï(Î¸ âˆ’ xÎ·) 2 0
2
S 0 (m) âˆ’ 1 = 0,
Ïƒ S (m) + r + Îº +
Ïƒâˆš
1âˆ’x
1âˆ’x
m
which is


r+Îº+

âˆ’

ÏxL âˆš1
1âˆ’x Ïƒ m



+

r

r+Îº+

2 Ï(Î¸âˆ’xÎ·)Ïƒ
1âˆ’x

ÏxL âˆš1
1âˆ’x Ïƒ m

2

+ 4 Ï(Î¸âˆ’xÎ·)Ïƒ
1âˆ’x

2

.

2

This root is, in turn, smaller than


r+Îº+

âˆ’

ÏxL âˆš1
1âˆ’x Ïƒ m





+ r+Îº+
2

ÏxL âˆš1
1âˆ’x Ïƒ m



r
1+

4

Ï(Î¸âˆ’xÎ·)Ïƒ 2
1âˆ’x
(r+Îº)2

Ï(Î¸âˆ’xÎ·)Ïƒ 2
1âˆ’x

B
= Sâˆ— + âˆš ,
m

where S âˆ— is the larger positive root of (A.11) and
r
Bâ‰¡âˆ’

ÏxL
1âˆ’x Ïƒ

+

ÏxL
1âˆ’x

1+

2 Ï(Î¸âˆ’xÎ·)Ïƒ
1âˆ’x

4

Ï(Î¸âˆ’xÎ·)Ïƒ 2
1âˆ’x
(r+Îº)2

2

> 0.

When S 0 (m) in (A.29) is set to S 0 (M ), the left-hand side is smaller than the right-hand side. When
S 0 (m) in (A.29) is set to the upper bound S âˆ— + âˆšBm , the left-hand side is a quadratic function
âˆš
âˆš
of m, with the coefficient of ( m)2 = m being âˆ’r[S âˆ— âˆ’ S 0 (M )] < 0. It is, therefore, bounded
above, and smaller than the right-hand side for sufficiently large M . Hence, (A.29) does not hold,
a contradiction. Since S 00 (Dt ) < 0 for all Dt < M , S(Dt ) is concave.
If the solution explodes at Ë† â‰¥ , then concavity implies limDt â†’Ë† S 0 (Dt ) = âˆ. The right-hand
side of (3.4) and (3.13) is of order S 0 (Dt )2 for Dt close to Ë†. The left-hand side, however, does not
exceed
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) âˆ’ rS(Dt )
â‰¤ Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) âˆ’ rS(M ) âˆ’ r(Dt âˆ’ M )S 0 (Dt ),

45

where both the first and the second steps follow from concavity. Hence, the left-hand side is
bounded by a term of order S 0 (Dt ), a contradiction. Therefore, the solution does not explode and
can be defined in [, M ]. Equation Z() > 0 holds because Z(Dt ) is decreasing and Z(M ) > 0 from
(A.23).
Lemma A.5 derives properties of the solution for |Î¦| large.

Lemma A.5. [Solution for large |Î¦|] The solution S(Dt ) derived in Lemma A.1 has the following
properties:
â€¢ When Î¸ > Î· and Î¦ is negative and large, the solution can be defined in [, M ], and satisfies
Z() > 0.
â€¢ When Î¸ < Î· and Î¦ is positive and large, the solution satisfies Z() < 0 if it can be defined in
[, M ], and satisfies limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ and limDt â†’Ë† S(Dt ) > 0 if it explodes at Ë† â‰¥ .
Proof of Lemma A.5. We start with the case Î¸ > Î·. Suppose that Î¦ is negative and sufficiently
large so that S(M ) defined by (A.9) is negative. We will show that S 0 (Dt ) > 0 and S 00 (Dt ) < 0
for all Dt . Both inequalities hold by continuity for Dt smaller than and close to M . Suppose, by
contradiction, that there exists Dt < M such that S 0 (Dt ) â‰¤ 0 or S 00 (Dt ) â‰¥ 0, and consider the
supremum m within that set. The definition of m implies S 0 (Dt ) > 0 and S 00 (Dt ) < 0 for all Dt in
the non-empty set (m, M ), and S 0 (m) = 0 or S 00 (m) = 0.
Since S 0 (M ) > 0 and S 00 (Dt ) < 0 for all Dt âˆˆ (m, M ), S 0 (m) > 0. Hence, S 00 (m) = 0. Since, in
addition, S(M ) < 0 and S 0 (Dt ) > 0 for all Dt âˆˆ (m, M ), S(m) < 0. Setting Dt = m in (A.15) and
(A.18), and using S(m) < 0, S 0 (m) > 0 and S 00 (m) = 0, we find S 000 (m) > 0. Hence, S 00 (Dt ) > 0
for Dt close to and larger than m, a contradiction. Therefore, S 0 (Dt ) > 0 and S 00 (Dt ) < 0 for all
Dt .
Since the solution is concave, we can use the same argument as in the proof of Lemma A.4 in
the case Î¸ < 0, to show that the solution does not explode at Ë† â‰¥ . Hence, the solution can be
defined in [, M ]. It satisfies Z() > 0 because S() < 0 and S 0 () > 0.
We next consider the case Î¸ < Î·. We will show, by contradiction, that there exists Dt < M
such that S 0 (Dt ) â‰¤ 0. Existence of such a Dt will imply, from Lemma A.2, existence of a unique
m < M such that S 0 (Dt ) > 0 for all Dt âˆˆ (m, M ], S 0 (Dt ) < 0 for all Dt < m, and S(m) > 0.
Hence, if the solution can be defined in [, M ], it satisfies
(ÎºDÌ„ + r)S 0 () â‰¤ 0 < rS(m) â‰¤ rS(),

46

which implies Z() < 0. If instead the solution explodes at Ë† â‰¥ , it satisfies limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ
and limDt â†’Ë† S(Dt ) > S(m) > 0.
To derive the contradiction, we assume that S 0 (Dt ) > 0 for all Dt â‰¤ M , and will show that
S 00 (Dt ) is bounded below by

Î¦
2.

Continuity yields the bound S 00 (Dt ) â‰¥

Î¦
2

for Dt smaller than

and close to M because S 0 (M ) = Î¦. Suppose, by contradiction, that there exists Dt such that
S 00 (Dt ) <

Î¦
2,

and consider the supremum within that set. The definition of m implies S 00 (m) >

for all Dt in the non-empty set (m, M ), and S 00 (m) =

Î¦
2

Î¦
2.

If m lies in the constrained region, (3.13) implies
Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL 1 0
1 2 00
rS(m) âˆ’ Îº(DÌ„ âˆ’ m)S 0 (m)
Ïƒ S (m) =
Ïƒ S (m)2 âˆ’
Ïƒ âˆš S (m) âˆ’ 1 +
2
1âˆ’x
1âˆ’x
m
m
0
0
Ï(Î¸ âˆ’ xÎ·) 2 0
rS(M ) + rS (M )(m âˆ’ M ) âˆ’ Îº(DÌ„ âˆ’ m)S (m)
â‰¥
Ïƒ S (m)2 âˆ’ 1 +
1âˆ’x
m
Ï(Î¸ âˆ’ xÎ·) 2 0
=
Ïƒ S (m)2 âˆ’ 1
1âˆ’x
Ï sgn(Î¸âˆ’Î·)xL âˆš
ÎºDÌ„(S 0 (M ) âˆ’ S 0 (m)) + 12 Ïƒ 2 M Î¦ +
Ïƒ M S 0 (M ) + rmS 0 (M ) + ÎºmS 0 (m)
1âˆ’x
+
m
âˆš
ÏxL
1 2
Ïƒ M Î¦ âˆ’ 1âˆ’x Ïƒ M S 0 (M )
Ï(Î¸ âˆ’ xÎ·) 2 0
>
Ïƒ S (M )2 âˆ’ 1 + 2
,
(A.30)
1âˆ’x
m
where the second step follows from S 0 (m) > 0 and because convexity implies
S(m) â‰¥ S(M ) + S 0 (M )(m âˆ’ M ),
the third step follows by substituting S(M ) from (A.9), and the fourth step follows because S 0 (M ) >
S 0 (m) > 0. Since for sufficiently large Î¦,
1 2
ÏxL âˆš
Ïƒ MÎ¦ âˆ’
Ïƒ M S 0 (M ) > 0,
2
1âˆ’x
the right-hand side of (A.30) is bounded below by
Ï(Î¸ âˆ’ xÎ·) 2 0
1
ÏxL
1
Ïƒ S (M )2 âˆ’ 1 + Ïƒ 2 Î¦ âˆ’
Ïƒ âˆš S 0 (M ),
1âˆ’x
2
1âˆ’x
M
which, in turn, is bounded below by 14 Ïƒ 2 Î¦ for sufficiently large Î¦. Hence, (A.30) implies that S 00 (m)
exceeds

Î¦
2,

a contradiction. If m lies in the unconstrained region, we can follow the same steps to

derive a counterpart of (A.30) using (3.4), and then derive a contradiction. Hence, S 00 (Dt ) â‰¥

Î¦
2

for

all Dt â‰¤ M .
If the solution explodes at Ë† â‰¥ , then convexity implies limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ. This is ruled
out, however, by S 0 (Dt ) > 0 for all Dt â‰¤ M . Hence, the solution can be defined in [, M ].
47

Since, however, S 00 (Dt ) is bounded below by

Î¦
2,

and S 0 (M ) is independent of Î¦, S 0 () is negative

for sufficiently large Î¦. This contradicts our assumption that S 0 (Dt ) > 0 for all Dt â‰¤ M , and
establishes that there exists Dt < M such that S 0 (Dt ) â‰¤ 0.
Taken together, Lemmas A.4 and A.5 show that for two extreme values of Î¦ (Î¦ = 0 and |Î¦|
large) the solution lies on two different â€œsidesâ€ of the equation Z() = 0, which we use as boundary
condition at . Lemma A.6 uses these results and a continuity argument to show that there exists
Î¦ such that Z() = 0 holds. It also uses the monotonicity property of the solution shown in Lemma
A.3 to establish that this Î¦ is unique.

Lemma A.6. [Existence in compact interval with conditions at both boundaries] Consider an interval [, M ], with  sufficiently small and M sufficiently large. A solution S(Dt ) to
the system of ODEs (3.4) in the unconstrained region (3.11), and (3.13) in the constrained region
(3.14), with the boundary conditions (A.8) and Z() = 0 exists in [, M ] and is unique. Moreover,
S 00 (M ) < 0 when Î¸ > Î·, and S 00 (M ) > 0 when Î¸ < Î·.
Proof of Lemma A.6. We denote by ZÎ¦ () the value of Z() for the solution S(Dt ) derived
in Lemma A.1. If limDt â†’Ë† S 0 (Dt ) = âˆ’âˆ for Ë† â‰¥ , in which case limDt â†’Ë† S(Dt ) > 0, we set
ZÎ¦ () = âˆ’âˆ. If limDt â†’Ë† S 0 (Dt ) = âˆ for Ë† â‰¥ , in which case limDt â†’Ë† S(Dt ) is finite or âˆ’âˆ, we
set ZÎ¦ () = âˆ.
Lemma A.3 implies that for Î¦1 < Î¦2 , ZÎ¦1 () > ZÎ¦2 () if ZÎ¦1 () and ZÎ¦2 are finite, ZÎ¦2 () = âˆ’âˆ
if ZÎ¦1 () = âˆ’âˆ, and ZÎ¦1 () = âˆ if ZÎ¦2 () = âˆ. Hence, ZÎ¦ () is equal to âˆ in an interval
(âˆ’âˆ, Î¦], is finite and decreasing in an interval (Î¦, Î¦Ì„), and is equal to âˆ’âˆ in the remaining interval
Â¯
Â¯
[Î¦Ì„, âˆ). Continuity of the solution with respect to the initial conditions implies that ZÎ¦ () is
continuous in Î¦ in (Î¦, Î¦Ì„). Moreover, if Î¦ is finite, then lim Î¦â†’Î¦Â¯ ZÎ¦ () = âˆ, and if Î¦Ì„ is finite, then
Â¯
Â¯
Î¦>Î¦
Â¯
lim Î¦â†’Î¦Ì„ ZÎ¦ () = âˆ’âˆ.
Î¦<Î¦Ì„

When Î¸ > Î·, Lemma A.4 implies that Z0 () is negative and possibly equal to âˆ’âˆ, and Lemma
A.5 implies that ZÎ¦ () is positive and finite for Î¦ negative and large. Hence, Î¦ = âˆ’âˆ. If Î¦Ì„ > 0,
Â¯
then continuity and monotonicity of ZÎ¦ () in (âˆ’âˆ, 0], limÎ¦â†’âˆ’âˆ ZÎ¦ () > 0, and Z0 () < 0 imply
that there exists a unique Î¦ âˆˆ (âˆ’âˆ, 0) such that ZÎ¦ () = 0. If Î¦Ì„ â‰¤ 0, then continuity and
monotonicity of ZÎ¦ () in (âˆ’âˆ, Î¦Ì„), limÎ¦â†’âˆ’âˆ ZÎ¦ () > 0, and lim Î¦â†’Î¦Ì„ ZÎ¦ () = âˆ’âˆ imply that there
Î¦<Î¦Ì„

exists a unique Î¦ âˆˆ (âˆ’âˆ, Î¦Ì„) such that ZÎ¦ () = 0. In both cases, there exists a unique Î¦ âˆˆ (âˆ’âˆ, 0)
such that ZÎ¦ () = 0. The solution S(Dt ) derived in Lemma A.1 for this Î¦ satisfies Z() = 0 and
S 00 (M ) = Î¦ < 0.
When Î¸ < Î·, Lemma A.4 implies that Z0 () is positive and finite, and Lemma A.5 implies that
ZÎ¦ () is negative and possibly equal to âˆ’âˆ for Î¦ positive and large. Hence, Î¦ < 0 and Î¦Ì„ > 0. If
Â¯
48

Î¦Ì„ < âˆ, then continuity and monotonicity of ZÎ¦ () in [0, Î¦Ì„), Z0 () > 0 and lim Î¦â†’Î¦Ì„ ZÎ¦ () = âˆ’âˆ
Î¦<Î¦Ì„

imply that there exists a unique Î¦ âˆˆ (0, Î¦Ì„) such that ZÎ¦ () = 0. If Î¦Ì„ = âˆ, then continuity
and monotonicity of ZÎ¦ () in [0, âˆ), Z0 () > 0 and limÎ¦â†’âˆ ZÎ¦ () < 0 imply that there exists a
unique Î¦ âˆˆ (0, âˆ) such that ZÎ¦ () = 0. In both cases, there exists a unique Î¦ âˆˆ (0, âˆ) such
that ZÎ¦ () = 0. The solution S(Dt ) derived in Lemma A.1 for this Î¦ satisfies Z() = 0 and
S 00 (M ) = Î¦ > 0.
Lemmas A.7-A.11 show properties of the solution derived in Lemma A.6. Lemma A.7 shows
that the solution is increasing in Dt .

Lemma A.7. [Monotonicity and Positivity] For the solution derived in Lemma A.6, S(Dt ) > 0
and S 0 (Dt ) > 0 for all Dt âˆˆ [, M ].
Proof of Lemma A.7. The solution derived in Lemma A.6 coincides with that derived in Lemma
A.1 for a specific value of Î¦. Hence, Lemma A.2 implies that either S 0 (Dt ) > 0 for all Dt , or there
exists m < M such that S 0 (Dt ) > 0 for all Dt âˆˆ (m, M ], S 0 (Dt ) < 0 for all Dt < m, and S(m) > 0.
In the second case, S 0 () â‰¤ 0 and S() > 0, contradicting Z() = 0.
Since S 0 () > 0, Z() = 0 implies S() > 0. Combining S() > 0 with S 0 (Dt ) > 0 for all Dt , we
find S(Dt ) > 0 for all Dt .
Lemma A.8 compares the solution derived in Lemma A.6 to the affine solution derived in
Proposition 3.1 for L = âˆ. It shows that the former solution lies below the latter when Î¸ > Î·, and
above it when Î¸ < Î·.

Lemma A.8. [Comparison with the affine solution for L = âˆ] Consider the solution derived
in Lemma A.6, and the affine solution a0 +a1 Dt derived in Proposition 3.1 for L = âˆ. When Î¸ > Î·,
S(Dt ) < a0 + a1 Dt for all Dt âˆˆ [, M ], and when Î¸ < Î·, S(Dt ) > a0 + a1 Dt for all Dt âˆˆ [, M ].
Proof of Lemma A.8. We start with the case Î¸ > Î·, and consider the problem of maximizing
V (Dt ) â‰¡ S(Dt ) âˆ’ (a0 + a1 Dt ),
over the compact set [, M ]. The result in the lemma will follow if we show that the maximum
value Vmax of V (Dt ) is negative. Using (3.6), we can write V (Dt ) as
V (Dt ) = S(Dt ) âˆ’

a1
(ÎºDÌ„ + rDt ).
r

49

Suppose first that V (Dt ) is maximized at Dt = M . Using (A.9), we can write V (M ) as
1
V (M ) =
r




1 2
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
0
(ÎºDÌ„ + rM )(S (M ) âˆ’ a1 ) + Ïƒ M Î¦ +
Ïƒ M S (M ) .
2
1âˆ’x
0

(A.31)

Equations (3.7) and (A.8) imply that a1 and S 0 (M ) are independent of M , and that S 0 (M ) < a1 .
Since, in addition Î¦ < 0, (A.31) implies that Vmax = V (M ) < 0 for M sufficiently large.
Suppose next that V (Dt ) is maximized at an interior point m âˆˆ (, M ) that lies in the constrained region. The first- and second-order conditions of the maximization problem are S 0 (m) = a1
and S 00 (m) â‰¤ 0. Setting Dt = m in (3.13) and using S 0 (m) = a1 and S 00 (m) â‰¤ 0, we find
Ï(Î¸ âˆ’ xÎ·) 2 2 Ï sgn(Î¸ âˆ’ Î·)xL âˆš
Ïƒ ma1 âˆ’
Ïƒ ma1
1âˆ’x
1âˆ’x
Ï(Î¸ âˆ’ xÎ·) 2 2 Ï(Î¸ âˆ’ Î·)x 2 2
â‡’ m + Îº(DÌ„ âˆ’ m)a1 âˆ’ rS(m) >
Ïƒ ma1 âˆ’
Ïƒ ma1
1âˆ’x
1âˆ’x

m + Îº(DÌ„ âˆ’ m)a1 âˆ’ rS(m) â‰¥

â‡” m + Îº(DÌ„ âˆ’ m)a1 âˆ’ rS(m) > ÏÎ¸Ïƒ 2 ma21
â‡” (ÎºDÌ„ + rm)a1 âˆ’ rS(m) > 0
â‡” Vmax = V (m) < 0,

(A.32)

where the second step follows from (3.14) and the fourth step follows from (A.2).
Suppose next that V (Dt ) is maximized at an interior point m âˆˆ (, M ) that lies in the unconstrained region. Setting Dt = m in (3.4) and using S 0 (m) = a1 and S 00 (m) â‰¤ 0, we find
m + Îº(DÌ„ âˆ’ m)a1 âˆ’ rS(m) â‰¥ ÏÎ¸Ïƒ 2 ma21
â‡” (ÎºDÌ„ + rm)a1 âˆ’ rS(m) â‰¥ 0
â‡” Vmax = V (m) â‰¤ 0,

(A.33)

To show that (A.33) holds as a strict inequality, we proceed by contradiction. If (A.33) holds as an
equality, then S(m) and S 0 (m) are the same as under the affine solution S(Dt ) =

a1
r (ÎºDÌ„

+ rDt ).

Hence, the solution derived in Lemma A.6 coincides with the affine solution in an interval in the
unconstrained region that includes m and that has a boundary with the constrained region at
an m1 â‰¥ m. Setting Dt = m1 in (A.15) and using S(m1 ) =

a1
r (ÎºDÌ„

+ rm1 ), S 0 (m1 ) = a1 and

S 00 (m1 ) = 0, we find that the third derivative of S(Dt ) from the right at m1 is
1 2 000
Ï sgn(Î¸ âˆ’ Î·)xL
1
Ïƒ S (m1 ) =
Ïƒ
3 a1 > 0.
2
1âˆ’x
2m 2

(A.34)

1

Since S 000 (m1 ) > 0, S 00 (Dt ) is positive in a neigborhood to the right of m1 , and hence S 0 (Dt ) exceeds
a1 . This means that V (Dt ), which is equal to zero for all Dt âˆˆ [m, m1 ] because S(Dt ) coincides
50

with the affine solution, increases to the right of m1 , a contradiction since V (Dt ) would then be
maximized in the constrained region.
If V (Dt ) is maximized at , then S 0 () â‰¤ a1 and hence,
Vmax = V () = S() âˆ’

1
a1
(ÎºDÌ„ + r) = (ÎºDÌ„ + r)(S 0 () âˆ’ a1 ) â‰¤ 0,
r
r

(A.35)

where the second step follows from Z() = 0. To show that (A.35) holds as a strict inequality, we
follow the same argument as in the case where V (Dt ) is maximized at an interior point m in the
unconstrained region.
The argument in the case Î¸ < Î· is symmetric. We consider the problem of minimizing V (Dt )
over [, M ], and show that the minimum value Vmin of V (Dt ) is positive.
Suppose first that V (Dt ) is minimized at Dt = M . Equations (3.7) and (A.8) imply that a1
and S 0 (M ) are independent of M , and that S 0 (M ) > a1 . Since, in addition, Î¦ > 0, (A.31) implies
that Vmin = V (M ) > 0 for M sufficiently large.
Suppose next that V (Dt ) is maximized at an interior point m âˆˆ (, M ) that lies in the constrained region. The first- and second-order conditions of the maximization problem are S 0 (m) = a1
and S 00 (m) â‰¥ 0. Setting Dt = m in (3.13), using S 0 (m) = a1 and S 00 (m) â‰¤ 0, and proceeding as in
the derivation of (A.32), we find Vmax = V (m) > 0.
Suppose next that V (Dt ) is maximized at an interior point m âˆˆ (, M ) that lies in the unconstrained region. Setting Dt = m in (3.4), using S 0 (m) = a1 and S 00 (m) â‰¥ 0, and proceeding as in
the derivation of (A.33), we find Vmax = V (m) â‰¥ 0. To show that (A.33) holds as a strict inequality,
we follow the same argument as in the case Î¸ > Î· and find that (A.34) implies S 000 (m1 ) < 0. This
implies that V (Dt ), which is equal to zero for all Dt âˆˆ [m, m1 ], decreases to the right of m1 , a
contradiction since V (Dt ) would then be minimized in the constrained region.
If V (Dt ) is maximized at , then S 0 () â‰¥ a1 , and hence (A.35) implies Vmin = V () â‰¥ 0. To
show that (A.35) holds as a strict inequality, we follow the same argument as in the case where
V (Dt ) is maximized at an interior point m in the unconstrained region.
Note that since Z() = 0 implies
S() âˆ’

a1
1
(ÎºDÌ„ + r) = (ÎºDÌ„ + r)(S 0 () âˆ’ a1 ),
r
r

Lemma A.8 implies that S 0 () < a1 when Î¸ > Î·, and S 0 () > a1 when Î¸ < Î·.
Lemma A.9 shows that the constrained and the unconstrained regions have a single boundary
and hence do not alternate. Proving this result requires condition ÎºDÌ„ >

51

Ïƒ2
4

of Theorem 3.1. This

condition is required in all subsequent lemmas as well because they build on Lemma A.9, but is
not used in all previous lemmas.

Lemma A.9. [Single boundary between unconstrained and constrained region] There
exists m âˆˆ [, M ] such that the unconstrained region is [, m] and the constrained region is (m, M ].
Proof of Lemma A.9. The constrained region includes a neighborhood to the left of M , for
sufficiently large M , as shown in Lemma A.1. The unconstrained region includes a neighborhood
to the right of , for sufficiently small . This is because S 0 () is bounded above uniformly for all
values of  sufficiently small. When Î¸ > Î·, the upper bound is a1 . When Î¸ < Î·, Lemma A.5 implies
that Î¦ is bounded above because otherwise Z() < 0. The upper bound on Î¦ implies one on S(M )
from (A.9), which in turn implies one on S() from Lemma A.7, which in turn implies one on S 0 ()
from Z() = 0.
Consider the non-empty set of m >  such that [, m] lies in the unconstrained region, and the
supremum m1 of that set. Consider the non-empty set of m > m1 such that (m1 , m) lies in the
constrained region, and the supremum m2 of that set. Suppose, by contradiction, that m2 < M ,
in which case the unconstrained region begins again at m2 . Consider, in that case, the non-empty
set of m >  such that [m2 , m] lies in the unconstrained region, and the supremum m3 of that set.
Since the constrained region includes a neighborhood to the left of M , m3 < M .
Since (3.11) holds as an equality at mi , i = 1, 2, 3,
âˆš

mi S 0 (mi ) =

L
â‰¡ LÌ‚.
|Î¸ âˆ’ Î·|Ïƒ

(A.36)

Since (3.11) holds to the left of mi , i = 1, 3, and (3.14) holds to the right of mi , the derivative of
âˆš
Dt S 0 (Dt ) is non-negative for Dt = mi , and hence
âˆš

1
S 0 (mi )
LÌ‚ 1
mS 00 (mi ) + âˆš S 0 (mi ) â‰¥ 0 â‡” mi S 00 (mi ) â‰¥ âˆ’
=âˆ’ âˆš
2 mi
2
2 mi

for i = 1, 3,

(A.37)

where the last step follows from (A.36). Conversely, since (3.14) holds to the left of m2 , and (3.11)
âˆš
holds to the right of m2 , the derivative of Dt S 0 (Dt ) is non-positive for Dt = m2 , and hence
m2 S 00 (m2 ) â‰¤ âˆ’

LÌ‚ 1
S 0 (m2 )
=âˆ’ âˆš .
2
2 m2

(A.38)

Since (3.14) holds in (m1 , m2 ),
Z

m2

S(m2 ) âˆ’ S(m1 ) =
m1

S 0 (Dt )dDt >

Z

m2

m1

âˆš
âˆš
L
1
âˆš dDt = 2LÌ‚( m2 âˆ’ m1 ).
|Î¸ âˆ’ Î·|Ïƒ Dt
52

(A.39)

Conversely, since (3.11) holds in (m2 , m3 ),
Z

m3

Z

0

m3

S (Dt )dDt â‰¤

S(m3 ) âˆ’ S(m2 ) =

m2

m2

âˆš
âˆš
L
1
âˆš dDt = 2LÌ‚( m3 âˆ’ m2 ).
|Î¸ âˆ’ Î·|Ïƒ Dt

(A.40)

The points mi , i = 1, 2, 3 satisfy (3.13) (as well as (3.4)). Setting Dt = mi in (3.13) and using
(A.36), we find
1
1
Ï(Î¸ âˆ’ xÎ·) 2 2 Ï sgn(Î¸ âˆ’ Î·)xL
mi + Îº(DÌ„ âˆ’ mi )LÌ‚ âˆš + Ïƒ 2 mi S 00 (mi ) âˆ’ rS(mi ) =
Ïƒ LÌ‚ âˆ’
Ïƒ LÌ‚. (A.41)
mi 2
1âˆ’x
1âˆ’x
Subtracting (A.41) for m2 from the same equation for m1 , we find


âˆš
âˆš
1
1
âˆ’âˆš
âˆ’ Îº( m1 âˆ’ m2 )
m1 âˆ’ m2 + LÌ‚ ÎºDÌ„ âˆš
m1
m2

1 
+ Ïƒ 2 m1 S 00 (m1 ) âˆ’ m2 S 00 (m2 ) âˆ’ r[S(m1 ) âˆ’ S(m2 )] = 0,
2


1
m2 âˆ’ m1
ÎºDÌ„ âˆš
+Îº
â‡’ m1 âˆ’ m2 + LÌ‚ âˆš
âˆš
m1 + m2
m1 m2


âˆš
âˆš
Ïƒ2
1
1
+ LÌ‚
âˆ’âˆš
+ 2LÌ‚r( m2 âˆ’ m1 ) < 0
âˆš
4
m2
m1
!
2
ÎºDÌ„ âˆ’ Ïƒ4
LÌ‚
â‡’âˆš
+ Îº + 2r âˆ’ 1 < 0,
âˆš
âˆš
m1 + m2
m1 m2




(A.42)

where the second step follows from (A.37), (A.38) and (A.39), and the third step follows by dividing
throughout by m2 âˆ’ m1 > 0. Subtracting (A.41) for m3 from the same equation for m2 , and using
(A.37), (A.38) and (A.39), we similarly find
LÌ‚
âˆš
âˆš
m2 + m3
Condition ÎºDÌ„ âˆ’

Ïƒ2
4

2

ÎºDÌ„ âˆ’ Ïƒ4
+ Îº + 2r
âˆš
m2 m3

!
âˆ’ 1 â‰¥ 0.

(A.43)

> 0 of Theorem 3.1 ensures that because m3 > m1 , the left-hand side of

(A.42) is larger than the left-hand side of (A.43). This is a contradiction because the former should
be negative and the latter non-negative. Therefore, m2 = M , and the lemma holds by setting
m = m1 .
Lemma A.10 shows that the solution is concave when Î¸ > Î·, and convex when Î¸ < Î·.

Lemma A.10. [Concavity/convexity] The solution derived in Lemma A.6 satisfies S 00 (Dt ) < 0
for all Dt âˆˆ [, M ] when Î¸ > Î·, and S 00 (Dt ) > 0 for all Dt âˆˆ [, M ] when Î¸ < Î·.
Proof of Lemma A.10. We start with the case Î¸ > Î·. Lemma A.6 shows that S 00 (M ) < 0.
53

Moreover, setting Dt =  in (3.4) and solving for S 00 (), we find
1 2 00
Ïƒ S () = ÏÎ¸Ïƒ 2 S 0 ()2 âˆ’ Îº(DÌ„ âˆ’ )S 0 () + rS() âˆ’ 
2
= ÏÎ¸Ïƒ 2 S 0 ()2 + (r + Îº)S 0 () âˆ’ 

=  ÏÎ¸Ïƒ 2 S 0 ()2 + (r + Îº)S 0 () âˆ’ 1 < 0,

(A.44)

where the second step follows from Z() = 0, and the last step because S 0 () < a1 .
Suppose, by contradiction, that there exists Dt âˆˆ (, M ) such that S 00 (Dt ) â‰¥ 0, and consider
the infimum m1 within that set. Since S 00 () < 0, m1 > . The definition of m1 implies S 00 (Dt ) < 0
for all Dt âˆˆ (, m1 ), S 00 (m1 ) = 0 and S 000 (m1 ) â‰¥ 0.
Suppose that m1 lies in the unconstrained region. Setting Dt = m1 in (A.18), and using
S 00 (m

1)

= 0, S 000 (m1 ) â‰¥ 0 and (3.4), we find (A.19), written for m1 instead of m. The contradiction

follows because (i) S 00 (Dt ) < 0 for all Dt âˆˆ (, m1 ) implies S 0 (m1 ) < S 0 () < a1 , (ii) the latter
inequality together with S 0 (m1 ) > 0 imply that the left-hand side of (A.2) becomes negative when
a1 is replaced by S 0 (m1 ).
Suppose next that m1 lies in the constrained region and that S 000 (m1 ) > 0. Since S 00 (m1 ) = 0,
S 000 (m1 ) > 0 implies that S 00 (Dt ) > 0 for Dt close to and larger than m1 . We denote by m2 the
supremum of the set of m such that S 00 (Dt ) > 0 for all Dt âˆˆ (m1 , m). Since S 00 (M ) < 0, m2 < M .
The definition of m2 implies S 00 (Dt ) > 0 for all Dt âˆˆ (m1 , m2 ), S 00 (m2 ) = 0 and S 000 (m2 ) â‰¤ 0.
Setting Dt = m1 in (A.15), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¥ 0 and (3.13), we find (A.17), written
for m1 instead of m. Multiplying both sides by
âˆ’

m1
S 0 (m1 )

> 0, we rewrite that equation as

Ï sgn(Î¸ âˆ’ Î·)xL
1
Ï(Î¸ âˆ’ xÎ·) 2 0
1
Ïƒ âˆš
+
Ïƒ S (m1 ) + r + Îº âˆ’ 0
â‰¥ 0.
1âˆ’x
2 m1
1âˆ’x
S (m1 )

(A.45)

Since m2 exceeds m1 , Lemma A.9 implies that it lies in the constrained region. Setting Dt = m2
in (A.15), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¤ 0 and (3.13), we find (A.26), written for m2 instead
of m. Multiplying both sides by
âˆ’

m2
S 0 (m2 )

> 0, we rewrite that equation as

Ï sgn(Î¸ âˆ’ Î·)xL
1
Ï(Î¸ âˆ’ xÎ·) 2 0
1
Ïƒ âˆš
+
Ïƒ S (m2 ) + r + Îº âˆ’ 0
â‰¤ 0.
1âˆ’x
2 m2
1âˆ’x
S (m2 )

(A.46)

Since m2 > m1 and S 0 (m2 ) > S 0 (m1 ), the left-hand side of (A.46) is larger than the left-hand
side of (A.45). This is a contradiction because the former should be non-positive and the latter
non-negative.
Suppose finally that m1 lies in the constrained region and that S 000 (m1 ) = 0. If there exists
Dt > m1 such that S 00 (Dt ) > 0, then the same argument as in the case where S 000 (m1 ) > 0 yields
54

a contradiction. If S 00 (Dt ) â‰¤ 0 for all Dt > m1 , then S 00 (m1 ) = S 000 (m1 ) = 0 implies S 0000 (m1 ) â‰¤ 0.
To derive a contradiction, we differentiate twice (3.13) at Dt = m1 . Using S 00 (m1 ) = S 000 (m1 ) = 0,
we find
Ï sgn(Î¸ âˆ’ Î·)xL
1
1 2
0
Ïƒ m1 S 0000 (m1 ) =
Ïƒ
3 S (m1 ) > 0.
2
1âˆ’x
2
4m

(A.47)

1

Hence, S 00 (Dt ) < 0 for all Dt âˆˆ [, M ].
We next consider the case Î¸ < Î·. Lemma A.6 shows that S 00 (M ) > 0. Moreover, setting Dt = 
in (3.4), solving for S 00 (), and using Z() = 0, we find the following counterpart of (A.44)

1 2 00
Ïƒ S () =  ÏÎ¸Ïƒ 2 S 0 ()2 + (r + Îº)S 0 () âˆ’ 1 .
2

(A.48)

When Î¸ > 0, (A.48) and S 0 () > a1 imply S 00 () > 0. We next show the same result when Î¸ < 0.
We rule out the cases S 0 () < 0 and S 0 () = 0 by contradiction arguments.
Suppose that S 00 () < 0. We denote by m1 the supremum of the set of m such that S 00 (Dt ) < 0
for all Dt âˆˆ [, m). Since S 00 (M ) > 0, m1 < M . The definition of m1 implies S 00 (Dt ) < 0 for all
Dt âˆˆ [, m1 ), S 00 (m1 ) = 0 and S 000 (m1 ) â‰¥ 0. Equations Z() = 0, (A.22) and S 00 (Dt ) < 0 for all
Dt âˆˆ [, m1 ) imply Z(m1 ) < 0.
If m1 lies in the unconstrained region, (3.4) and S 00 (m1 ) = 0 imply (A.24), written for m1
instead of m. Moreover, setting Dt = m1 in (A.18), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¥ 0 and
(3.4), we find (A.19), written for m1 instead of m. The two equations yield a contradiction when
combined with Z(m1 ) < 0.
If m1 lies in the constrained region, (3.13) and S 00 (m1 ) = 0 imply (A.27), written for m1 instead
of m. Moreover, setting Dt = m1 in (A.15), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¥ 0 and (3.13), we
find (A.17), written for m1 instead of m. The two equations yield a contradiction when combined
with Z(m1 ) < 0, as can be seen by multiplying the latter equation by âˆ’m21 and adding it to the
former equation.
Suppose next that S 00 () = 0. Since S 0 () > a1 , (A.48) implies that Î¸ < 0 and S 0 () is equal to
the larger positive root of (A.2), which we denote by aâˆ—1 . Hence, S 0 () is the same as under the affine
solution S(Dt ) =

aâˆ—1
r (ÎºDÌ„ + rDt ).

The same is true for S() because of Z() = 0. Hence, the solution

derived in Lemma A.6 coincides with the affine solution in an interval in the unconstrained region
that includes  and that has a boundary with the constrained region at an m1 â‰¥ m. Proceeding
as in the proof of Lemma A.8, we find that the third derivative of S(Dt ) from the right at m1 is
negative, and hence S 00 (Dt ) is negative in a neigborhood to the right of m1 . Since Z(m1 ) = 0, we
can then use the previous argument to derive a contradiction. This establishes that S 00 () > 0.
55

Suppose, by contradiction, that there exists Dt âˆˆ (, M ) such that S 00 (Dt ) â‰¤ 0, and consider
the infimum m1 within that set. Since S 00 () > 0, m1 > . The definition of m1 implies S 00 (Dt ) > 0
for all Dt âˆˆ (, m1 ), S 00 (m1 ) = 0 and S 000 (m1 ) â‰¤ 0. Equations Z() = 0, (A.22) and S 00 (Dt ) > 0 for
all Dt âˆˆ [, m1 ) imply Z(m1 ) > 0.
Suppose that m1 lies in the unconstrained region. Equations (3.4) and S 00 (m1 ) = 0 imply
(A.24), written for m1 instead of m. Moreover, setting Dt = m1 in (A.18), and using S 00 (m1 ) = 0,
S 000 (m1 ) â‰¤ 0 and (3.4), we find (A.21), written for m1 instead of m. The two equations yield a
contradiction when combined with Z(m1 ) > 0.
Suppose next that m1 lies in the constrained region and that S 000 (m1 ) < 0. Since S 00 (m1 ) = 0,
S 000 (m1 ) < 0 implies that S 00 (Dt ) < 0 for Dt close to and larger than m1 . We denote by m2 the
supremum of the set of m such that S 00 (Dt ) < 0 for all Dt âˆˆ (m1 , m). Since S 00 (M ) > 0, m2 < M .
The definition of m2 implies S 00 (Dt ) < 0 for all Dt âˆˆ (m1 , m2 ), S 00 (m2 ) = 0 and S 000 (m2 ) â‰¥ 0.
Setting Dt = m1 in (A.15), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¤ 0 and (3.13), we find (A.26), written
for m1 instead of m. Multiplying both sides by m21 , we rewrite that equation as


âˆš
m1 0
Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL
2
0
Ïƒ
S (m1 ) + m1
Ïƒ S (m1 ) + (r + Îº)S (m1 ) âˆ’ 1 â‰¤ 0. (A.49)
âˆ’
1âˆ’x
2
1âˆ’x
Since m2 exceeds m1 , Lemma A.9 implies that it lies in the constrained region. Setting Dt = m2
in (A.15), and using S 00 (m1 ) = 0, S 000 (m1 ) â‰¥ 0 and (3.13), we find (A.17), written for m2 instead
of m. Multiplying both sides by m22 , we rewrite that equation as


âˆš
m2 0
Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL
2
2 0
Ïƒ
S (m2 ) + m2
Ïƒ S (m2 ) + (r + Îº) S (m2 ) âˆ’ 1 â‰¥ 0. (A.50)
âˆ’
1âˆ’x
2
1âˆ’x
Since S 00 (Dt ) < 0 for all Dt âˆˆ (m1 , m2 ), Z(m2 ) < Z(m1 ) Using (A.27) to compute Z(m1 ) and
Z(m2 ), we find



Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
2
0
m1
Ïƒ S (m1 ) + (r + Îº)S (m1 ) âˆ’ 1 âˆ’
Ïƒ m1 S 0 (m1 )
1âˆ’x
1âˆ’x


Ï(Î¸ âˆ’ xÎ·) 2 0
Ï sgn(Î¸ âˆ’ Î·)xL âˆš
2
0
> m2
Ïƒ S (m2 ) + (r + Îº)S (m2 ) âˆ’ 1 âˆ’
Ïƒ m2 S 0 (m2 ).
1âˆ’x
1âˆ’x

(A.51)

Multiplying (A.49) by âˆ’1 and adding to the sum of (A.50) and (A.51), we find
âˆš
âˆš
m1 0
m2 0
Ï sgn(Î¸ âˆ’ Î·)xL
Ï sgn(Î¸ âˆ’ Î·)xL
âˆ’
Ïƒ
S (m1 ) > âˆ’
Ïƒ
S (m2 ),
1âˆ’x
2
1âˆ’x
2
âˆš
m2 S 0 (m2 ). Consider the value mÌ‚ that minimizes the function Dt S 0 (Dt )
âˆš
âˆš
over the compact set [m1 , M ]. Since m1 S 0 (m1 ) > m2 S 0 (m2 ), mÌ‚ > m1 . Since S 00 (M ) > 0, the
âˆš
function Dt S 0 (Dt ) is increasing for Dt close to and smaller than M , and hence mÌ‚ < M . Since
and hence

âˆš

m1 S 0 (m1 ) >

âˆš

56

mÌ‚ is an interior minimum and not all n-order derivatives of

âˆš

Dt S 0 (Dt ) are zero at mÌ‚ (proof of

Lemma A.1), the smallest n for which the n-order derivative is non-zero is even. Since mÌ‚ is in the
âˆš
L
. We can hence choose mÌ‚1 < mÌ‚2 < mÌ‚3 in the constrained
constrained region, mÌ‚S 0 (mÌ‚) â‰¥ |Î¸âˆ’Î·|Ïƒ
âˆš
âˆš
âˆš
L
region such that (i) mÌ‚2 < mÌ‚ < mÌ‚3 , (ii) mÌ‚1 S 0 (mÌ‚1 ) = mÌ‚2 S 0 (mÌ‚2 ) = mÌ‚3 S 0 (mÌ‚3 ) â‰¡ LÌ‚ > |Î¸âˆ’Î·|Ïƒ
,
âˆš
âˆš
(iii) Dt S 0 (Dt ) > LÌ‚ for all Dt âˆˆ (mÌ‚1 , mÌ‚2 ), and (iv) Dt S 0 (Dt ) < LÌ‚ for all Dt âˆˆ (mÌ‚2 , mÌ‚3 ). We can
then proceed as in the proof of Lemma A.9 to derive a contradiction. (In the proof of Lemma A.9,
LÌ‚ =

L
|Î¸âˆ’Î·|Ïƒ ,

but the proof works for any value of LÌ‚.)

Suppose finally that m1 lies in the constrained region and that S 000 (m1 ) = 0. If there exists
Dt > m1 such that S 00 (Dt ) < 0, then the same argument as in the case where S 000 (m1 ) < 0 yields
a contradiction. If S 00 (Dt ) â‰¥ 0 for all Dt > m1 , then S 00 (m1 ) = S 000 (m1 ) = 0 implies S 0000 (m1 ) â‰¥ 0.
To derive a contradiction, we differentiate twice (3.13) at Dt = m1 . Using S 00 (m1 ) = S 000 (m1 ) = 0,
we find
Ï sgn(Î¸ âˆ’ Î·)xL
1
1 2
0
Ïƒ m1 S 0000 (m1 ) =
Ïƒ
3 S (m1 ) < 0.
2
1âˆ’x
2
4m

(A.52)

1

Hence, S 00 (Dt ) > 0 for all Dt âˆˆ [, M ].
Lemma A.11 completes the comparison of the solution derived in Lemma A.6 to the affine
solution derived in Proposition 3.1 for L = âˆ. It shows that the derivative of the former solution
lies below the derivative of the latter when Î¸ > Î·, and above it when Î¸ < Î·.

Lemma A.11. [Comparison with the derivative of the affine solution] Consider the solution
derived in Lemma A.6, and the affine solution a0 + a1 Dt derived in Proposition 3.1 for L = âˆ.
When Î¸ > Î·, S 0 (Dt ) < a1 for all Dt âˆˆ [, M ], and when Î¸ < Î·, S 0 (Dt ) > a1 for all Dt âˆˆ [, M ].
Proof of Lemma A.11. When Î¸ > Î·, the result follows because the solution is concave and
S 0 () < a1 . When Î¸ < Î·, the result follows because the solution is convex and S 0 () > a1 .
Lemma A.12 shows that the comparisons in Lemmas A.8 and A.11 are reversed when they
concern the affine solution derived in Proposition 3.2 for L = 0.

Lemma A.12. [Comparison with the affine solution for L = 0] Consider the solution derived
in Lemma A.6, and the affine solution a0 + a1 Dt derived in Proposition 3.2 for L = 0. When Î¸ > Î·,
S(Dt ) > a0 + a1 Dt and S 0 (Dt ) > a1 for all Dt âˆˆ [, M ). When Î¸ < Î·, S(Dt ) < a0 + a1 Dt and
S 0 (Dt ) < a1 for all Dt âˆˆ [, M ).

57

Proof of Lemma A.12. When Î¸ > Î·, S 0 (M ) = a1 and concavity of S(Dt ) imply S 0 (Dt ) > a1 for
all Dt âˆˆ [, M ). Hence, the function
V (Dt ) â‰¡ S(Dt ) âˆ’ (a0 + a1 Dt )
is increasing. That function is also positive because
1
V () = S() âˆ’ (a0 + a1 ) = (ÎºDÌ„ + r)(S 0 () âˆ’ a1 ) > 0,
r
where the second step follows from Z() = 0 and (3.6). Therefore, S(Dt ) > a0 + a1 Dt for all
Dt âˆˆ [, M ].
When Î¸ < Î·, S 0 (M ) = a1 and convexity of S(Dt ) imply S 0 (Dt ) < a1 for all Dt âˆˆ [, M ). Hence,
the function V (Dt ) is decreasing. That function is also negative because
1
V () = (ÎºDÌ„ + r)(S 0 () âˆ’ a1 ) < 0.
r
Therefore, S(Dt ) < a0 + a1 Dt for all Dt âˆˆ [, M ].
Lemma A.13 shows that if a solution to the system of ODEs exists in (0, âˆ) and its derivative
converges to finite limits at zero and infinity, then these limits are almost uniquely determined.

Lemma A.13. [Limits at zero and infinity] Consider a solution S(Dt ) to the system of ODEs
(3.4) in the unconstrained region (3.11), and (3.13) in the constrained region (3.14), defined in
(0, âˆ). Suppose that S 0 (Dt ) converges to finite limits at zero and infinity, denoted by S 0 (0) and
S 0 (âˆ), respectively. Then S 0 (âˆ) is a root of (A.11), and S 0 (0) satisfies Z(0) â‰¡ ÎºDÌ„S 0 (0)âˆ’rS(0) = 0,
where S(0) denotes the limit of S(Dt ) at zero.
Proof of Lemma A.13. We start with the limit at zero. Since limDt â†’0 S 0 (Dt ) exists and is finite,
 
RD
the same is true for limDt â†’0 S(Dt ). (The latter limit is S(Dt ) âˆ’ 0 t S 0 DÌ‚t dDÌ‚t for any given Dt ).
Since limDt â†’0 S 0 (Dt ) exists and is finite, values of Dt close to zero lie in the unconstrained
region. Moreover, since limDt â†’0 S 0 (Dt ) and limDt â†’0 S(Dt ) exist and are finite, taking the limit
of both sides of the ODE (3.4) when Dt goes to zero implies that limDt â†’0 Dt S 00 (Dt ) exists and is
finite. If the latter limit differs from zero, then |S 00 (Dt )| â‰¥

`
Dt

for ` > 0 and for all Dt smaller than

a sufficiently small Î· > 0. Since, however, for Dt < Î·,
0

0

Z

Dt

00

0

0

Î·

`

Dt

DÌ‚t

Z

S (DÌ‚t )dDÌ‚t â‡’ |S (Dt ) âˆ’ S (Î·)| â‰¥

S (Dt ) = S (Î·) +
Î·

58


dDÌ‚t = ` log

Î·
Dt


,

limDt â†’0 S 0 (Dt ) is plus or minus infinity, a contradiction. Hence, limDt â†’0 Dt S 00 (Dt ) = 0. Taking
the limit of (3.4) when Dt goes to zero, and using limDt â†’0 S 0 (Dt ) = S 0 (0), limDt â†’0 S 0 (Dt ) = S(0),
limDt â†’0 Dt S 00 (Dt ) = 0, and the finiteness of S 0 (0) and S(0), we find Z(0) = 0.
We next consider the limit at infinity. Since limDt â†’âˆ S 0 (Dt ) exists and is finite, it is equal to
limDt â†’âˆ

S(Dt )
Dt .

S(Dt )
=
Dt

This follows by writing
S(0) +

R Dt
0

and noting that limDt â†’âˆ

S(Dt )
Dt

as

 
S 0 DÌ‚t dDÌ‚t

Dt
S(0)
Dt

,
R Dt

= 0 and limDt â†’âˆ

0

S 0 (DÌ‚t )dDÌ‚t
Dt

= limDt â†’âˆ S 0 (Dt ).

Since limDt â†’âˆ S 0 (Dt ) exists and is finite, large values of Dt lie in the constrained region.
Dividing both sides of the ODE (3.13) by Dt , taking the limit when Dt goes to infinity, and using
S(Dt )
00
Dt , we find that limDt â†’âˆ S (Dt )
then |S 00 (Dt )| â‰¥ ` > 0 for ` > 0 and for

the existence and finiteness of limDt â†’âˆ S 0 (Dt ) and limDt â†’âˆ
exists and is finite. If the latter limit differs from zero,

all Dt sufficiently large, implying that limDt â†’0 S 0 (Dt ) is plus or minus infinity, a contradiction.
Taking the limit of (3.13) divided by Dt when Dt goes to infinity, and using limDt â†’âˆ S 0 (Dt ) =
limDt â†’0

S(Dt )
Dt

= S 0 (âˆ), limDt â†’0 S 00 (Dt ) = 0, and the finiteness of S 0 (âˆ), we find that S 0 (âˆ) is a

root of (A.11).
Lemma A.14 shows that a solution to the system of ODEs with a derivative that converges to
finite limits at zero and infinity exists in (0, âˆ), and has the properties in Lemmas A.7-A.11.

Lemma A.14. [Existence in (0, âˆ)] A solution S(Dt ) to the system of ODEs (3.4) in the unconstrained region (3.11), and (3.13) in the constrained region (3.14), with a derivative that converges
to finite limits at zero and infinity exists in (0, âˆ), and has the properties in Lemmas A.7-A.12.
Proof of Lemma A.14. We will construct the solution in (0, âˆ) as the simple limit of solutions
in compact intervals [, M ]. We denote by S,M (Dt ) the solution derived in Lemma A.6, and by
Î¦,M and Z,M (Dt ) the corresponding values of Î¦ and Z(Dt ).
We start with the case Î¸ > Î·, and first derive the limit when  goes to zero, holding M constant.
Consider 1 > 2 > 0, and suppose, by contradiction, that Î¦2 ,M â‰¤ Î¦1 ,M . Lemma A.3 then implies
S2 ,M (1 ) â‰¤ S1 ,M (1 ) and S0 2 ,M (1 ) â‰¥ S0 1 ,M (1 ), which in turn imply Z2 ,M (1 ) â‰¥ Z1 ,M (1 ) = 0.
This is a contradiction because S002 ,M (Dt ) < 0 and Z2 ,M (2 ) = 0 imply Z2 ,M (1 ) < 0. Hence,
Î¦2 ,M > Î¦1 ,M , and Lemma A.3 implies S2 ,M (Dt ) > S1 ,M (Dt ) and S0 2 ,M (Dt ) < S0 1 ,M (Dt ) for all
Dt âˆˆ (1 , M ).
Since for given Dt âˆˆ (0, M ), the function  â†’ S,M (Dt ), defined for  < Dt , increases as
59

 decreases and is bounded above by the affine solution derived for L = âˆ (Lemma A.8), it
converges to a finite limit SM (Dt ) when  goes to zero. Likewise, since for given Dt , the function
0
 â†’ S,M
(Dt ), defined for  < Dt , decreases as  decreases and is bounded below by zero (Lemma

A.7), it converges to a finite limit SÌ‚M (Dt ) when  goes to zero.
The simple limit SM (Dt ) of S,M (Dt ) is differentiable, and its derivative is the simple limit
0
SÌ‚M (Dt ) of S,M
(Dt ). To show this result, we use the intermediate value theorem together with
00 (D ). The function S
a uniform bound on S,M
t
,M (Dt ) is bounded above by the affine solution
a1
r (ÎºDÌ„

0
+ rDt ) and below by zero (Lemma A.7). Likewise, the function S,M
(Dt ) is bounded above

by a1 (Lemma A.11) and below by zero. Hence, for any given Dt and neighborhood N around Dt ,
00 (m) that is uniform over m âˆˆ N ,  and M .
the ODEs (3.4) and (3.13) imply a bound Q on S,M

The intermediate value theorem implies that for m âˆˆ N ,
S,M (m) âˆ’ S,M (Dt )
00
0
0
0
(m00 ) |m0 âˆ’Dt | < Q|mâˆ’Dt |,
âˆ’ S,M
(Dt ) = S,M
(m0 ) âˆ’ S,M
(Dt ) = S,M
m âˆ’ Dt
where m0 is between m and Dt , and m00 is between m0 and Dt . Taking the limit when  goes to
zero, we find
SM (m) âˆ’ SM (Dt )
âˆ’ SÌ‚M (Dt ) â‰¤ Q|m âˆ’ Dt |,
m âˆ’ Dt
0 (D ) = SÌ‚ (D ). Since
which establishes that SM (Dt ) is differentiable at Dt and its derivative is SM
t
t
M
0
0
S,M
(Dt ) and S,M
(Dt ) have simple limits, we can use the ODEs (3.4) and (3.13) to construct
Ë†
00 (D ), which we denote by SÌ‚
a simple limit for S,M
t
M (Dt ). The same argument that establishes
Ë†
0 (D ) = SÌ‚ (D ) can be used to establish SÌ‚ (D ) = S 00 (D ), and hence that S (D ) solves
SM
t
t
t
t
t
M
M
M
M
0
(Dt ) is decreasing in Dt and is bounded below by zero,
the system of ODEs in (0, M ]. Since S,M
0 (D ) over  is non-increasing in D and has the same lower bound. Hence, S 0 (D )
its limit SM
t
t
t
M
0 (0) when D goes to zero. Using the same argument as in Lemma
converges to a finite limit SM
t
0 (0)âˆ’rS (0) = 0, where S (0) denotes the limit of S (D )
A.13, we can show that ZM (0) â‰¡ ÎºDÌ„SM
t
M
M
M

when Dt goes to zero.
0 (D ) and S 00 (D ) are the simple limits of S
0
00
Since SM (Dt ), SM
t
t
,M (Dt ), S,M (Dt ) and S,M (Dt ),
M

respectively, the properties in Lemmas A.7, A.8, A.10, A.11 and A.12 hold as weak inequalities for
all Dt âˆˆ (0, M ]. Following similar arguments as in these Lemmas and using ZM (0) = 0, we can
show that the inequalities are strict.
00 (D ) < 0
We next derive the limit when M goes to infinity. Consider M2 > M1 . Since SM
t
2
0 (M ) = S 0 (M ), S 0 (M ) > S 0 (M ). Suppose, by contradiction, that S
and SM
1
1
1
1
M2 (M1 ) â‰¤
M1
M2
M1
2
0 (M ) > S 0 (M ) imply S
SM1 (M1 ). Equations SM2 (M1 ) â‰¤ SM1 (M1 ) and SM
1
1
M2 (Dt ) < SM1 (Dt )
M1
2

60

for Dt smaller than and close to M1 . The same argument as in Lemma A.3 then implies SM2 (Dt ) <
0
0 (D ) > S 0 (D ) for all D âˆˆ (0, M ). Since S
SM1 (Dt ) and SM
t
t
t
1
M2 (M1 ) â‰¤ SM1 (M1 ) and SM2 (Dt ) >
M1
2
0 (D ) for all D âˆˆ (0, M ), S
0
SM
t
t
1
M2 (0) < SM1 (0). Combining the latter equation with SM2 (0) â‰¥
1
0 (0), which follows by taking the limit of S 0 (D ) > S 0 (D ) when D goes to zero, we find
SM
t
t
t
M2
M1
1

ZM2 (0) > ZM1 (0), a contradiction since ZM2 (0) = ZM1 (0) = 0. Hence, SM2 (M1 ) > SM1 (M1 ).
0 (D ) > S 0 (D ) hold by continuity for D
The inequalities SM2 (Dt ) > SM1 (Dt ) and SM
t
t
t
M1
2

smaller than and close to M1 . Suppose, by contradiction, that there exists Dt âˆˆ (0, M1 ) such
0 (D ) â‰¤ S 0 (D ), and consider the supremum m within that set.
that SM2 (Dt ) â‰¤ SM1 (Dt ) or SM
t
t
M1
2
0 (D ) > S 0 (D ) for all D âˆˆ (m, M ), and
The definition of m implies SM2 (Dt ) > SM1 (Dt ) and SM
t
t
t
1
M1
2
0 (m) = S 0 (m). Only one of the latter two equations holds since otherwise
SM2 (m) = SM1 (m) or SM
M1
2
0 (m) > S 0 (m),
the solutions SM1 (Dt ) and SM2 (Dt ) would coincide. If SM2 (m) = SM1 (m) and SM
M1
2
0 (D ) > S 0 (D ) for D smaller than and close to M . The
then SM2 (Dt ) < SM1 (Dt ) and SM
t
t
t
1
M1
2
0 (D ) > S 0 (D ) for all
same argument as in Lemma A.3 then implies SM2 (Dt ) < SM1 (Dt ) and SM
t
t
M1
2

Dt âˆˆ (0, m). This, in turn, implies ZM2 (0) > ZM1 (0), a contradiction. If instead SM2 (m) > SM1 (m)
0 (m) = S 0 (m), then the same argument as in Lemma A.3 implies S
and SM
M2 (Dt ) > SM1 (Dt ) and
M1
2
0 (D ) < S 0 (D ) for all D âˆˆ (0, m). This, in turn, implies Z
SM
t
t
t
M2 (0) < ZM1 (0), a contradiction.
M1
2
0 (D ) > S 0 (D ) for all D âˆˆ (0, M ).
Hence, SM2 (Dt ) > SM1 (Dt ) and SM
t
t
t
1
M1
2

Since for given Dt âˆˆ (0, âˆ), the function M â†’ SM (Dt ), defined for Dt < M , is increasing in
M and is bounded above by the affine solution derived for L = âˆ, it converges to a finite limit
0 (D ),
S(Dt ) when M goes to infinity. Likewise, since for given Dt âˆˆ (0, âˆ), the function M â†’ SM
t

defined for Dt < M , is increasing in M and is bounded above by a1 , it converges to a finite limit
SÌ‚(Dt ) when M goes to infinity. The same argument as when taking the limit over  establishes that
0 (D ) is decreasing
SÌ‚(Dt ) = S 0 (Dt ) and that S(Dt ) solves the system of ODEs in (0, âˆ). Since SM
t

in Dt and is bounded below by zero and above by a1 , its limit S 0 (Dt ) over M is non-increasing in
Dt and has the same bounds. Hence, S 0 (Dt ) converges to finite limits S 0 (0) when Dt goes to zero
and S 0 (âˆ) when Dt goes to infinity. Lemma A.13 implies that Z(0) â‰¡ ÎºDÌ„S 0 (0) âˆ’ rS(0) = 0, where
S(0) denotes the limit of S(Dt ) when Dt goes to zero. Lemma A.13 also implies that S 0 (âˆ) is a
0 (D ), which is positive and increasing in M ,
root of (A.11). Since S 0 (Dt ) is the simple limit of SM
t

it is positive. Hence, S 0 (âˆ) is non-negative and equal to the unique positive root of (A.11). The
same arguments as when taking the limit over  establish that the properties in Lemmas A.7, A.8,
A.10, A.11 and A.12 hold for all Dt âˆˆ (0, âˆ).
0
The argument in the case Î¸ < Î· is symmetric. The monotonicity of S,M (Dt ) and S,M
(Dt )
0 (D ) as functions of M , is the opposite relative to the
as functions of , and of SM (Dt ) and SM
t

case Î¸ > Î·. When Î¸ < xÎ·, the limit S 0 (âˆ) is equal to the smaller of the two positive roots of
(A.11) because S 0 (Dt ) is bounded above by that root. The upper bound on S 0 (Dt ) follows from
61

0 (D ): convexity implies that S 0 (D ) < S 0 (M ) for all D âˆˆ (0, M ),
the same upper bound on SM
t
t
t
M
M
0 (M ) is equal to the smaller positive root of (A.11).
and SM

Theorem 3.1 follows from Lemma A.14.
Proof of Proposition 3.3. Substituting the assetâ€™s share return from (3.1) into (2.2), and setting
St = S(Dt ), we find that the assetâ€™s dollar return is


âˆš
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) + 21 Ïƒ 2 Dt S 00 (Dt ) dt + Ïƒ Dt S 0 (Dt )dBt
âˆ’ rdt.
dRt =
S(Dt )
The returnâ€™s conditional volatility is the diffusion coefficient in (A.53) times
p

âˆš
âˆš
Ïƒ Dt S 0 (Dt ) dt
.
Vart (dRt ) =
S(Dt )

âˆš

(A.53)

dt:
(A.54)

The returnâ€™s conditional volatility under the affine solutions derived for L = 0 and L = âˆ is given
by (A.5). Comparing (A.5) and (A.54), we find that the returnâ€™s conditional volatility is higher
than under the affine solutions if
S 0 (Dt )(ÎºDÌ„ + rDt ) > rS(Dt ) â‡” Z(Dt ) > 0,
and is lower than under the affine solutions if Z(Dt ) < 0. When Î¸ > Î·, Z(0) = 0 and concavity
imply Z(Dt ) < 0, and hence conditional volatility is lower than under the affine solutions. When
instead Î¸ < Î·, Z(0) = 0 and convexity imply Z(Dt ) > 0, and hence conditional volatility is higher
than under the affine solutions. The comparison of conditional volatility across the cases Î¸ > Î· and
Î¸ < Î· follows from the comparison of each case with the affine solutions since volatility under the
affine solutions is independent of Î¸.
Since the returnâ€™s unconditional variance is the unconditional expectation of the returnâ€™s conditional variance, the comparisons derived for conditional volatility carry over to unconditional
volatility.
Proof of Proposition 3.4. The conditional beta of asset n is
Î²nt =

Covt (dRnt , dRM t )
,
Vart (dRM t )

(A.55)

where dRnt denotes the return of asset n and dRM t denotes the return of the market portfolio.

62

Assuming that the market portfolio includes Î¶m shares of asset m = 1, .., N , its return is

dRM t

PN
N
N
sh
sh
X
X
dRM
Î¶m Smt
m=1 Î¶m dRmt
t
= PN
=
dRmt =
=
Ï‰mt dRmt ,
PN
SM t
m=1 Î¶m Smt
m=1 Î¶m Smt
m=1

(A.56)

m=1

where SM t denotes the market portfolioâ€™s price and
Î¶m Smt
Ï‰mt â‰¡ PN
m=1 Î¶m Smt
denotes the weight of asset n in the market portfolio. Equation (A.55) implies that the conditional
beta of asset n exceeds that of asset n0 if
Covt (dRnt , dRM t ) > Covt (dRn0 t , dRM t )
â‡” Ï‰n Vart (dRnt ) > Ï‰n0 Vart (dRn0 t )
â‡” Î¶n Snt Vart (dRnt ) > Î¶n0 Sn0 t Vart (dRn0 t ),

(A.57)

where the second step follows from (A.56) and the independence of returns across assets.
Suppose next that Î¸n < Î· < Î¸n0 , and that other characteristics of assets n and n0 are identical
(Îºn = Îºn0 , DÌ„n = DÌ„n0 , Ïƒn = Ïƒn0 , Dnt = Dn0 t and Î¶n = Î¶n0 ). Since a1 decreases in Î¸ (Proposition 3.1),
the affine solution derived for L = âˆ is larger for Î¸n than for Î¸n0 . Since, in addition, Snt lies above
the affine solution for Î¸n , while Sn0 t lies below the affine solution for Î¸n0 (Theorem 3.1), Snt > Sn0 t .
Since, finally, Vart (dRnt ) > Vart (dRn0 t ) (Proposition 3.3), (A.57) implies Covt (dRnt , dRM t ) >
Covt (dRn0 t , dRM t ) and hence Î²nt > Î²n0 t .
The unconditional beta of asset n is
Î²nt =

Cov(dRnt , dRM t )
E (Covt (dRnt , dRM t ))
=
,
Var(dRM t )
E (Vart (dRM t ))

Since the conditional covariance of Covt (dRnt , dRM t ) is larger for asset n than for asset n0 , the
same is true for the unconditional covariance, and hence for the unconditional beta.
Proof of Proposition 3.5. Since (3.6) implies S(Dt ) = a1

Îº
r DÌ„


+ Dt , (3.17) is equivalent to

a1n + a1n0 âˆ’ (a1nÌ‚ + a1nÌ‚0 ) > 0.

(A.58)

When L = âˆ, Proposition 3.1 implies that (A.58) is equivalent to
Î¨(Î¸n ) + Î¨(Î¸n0 ) âˆ’ [Î¨(Î¸nÌ‚ ) + Î¨(Î¸nÌ‚0 )] > 0,

(A.59)

63

where the function Î¨(Î¸) is defined in the proof of Proposition 3.1. Setting ` â‰¡ Î¸Ì„ âˆ’ Î¸n = Î¸n0 âˆ’ Î¸Ì„ > 0
and `Ë† â‰¡ Î¸Ì„ âˆ’ Î¸nÌ‚ = Î¸nÌ‚0 âˆ’ Î¸Ì„ âˆˆ (0, `), we can write (A.59) as
h
i
Ë† + Î¨(Î¸Ì„ + `)
Ë† >0
Î¨(Î¸Ì„ âˆ’ `) + Î¨(Î¸Ì„ + `) âˆ’ Î¨(Î¸Ì„ âˆ’ `)
Z `
Z `
0
Î¨0 (Î¸Ì„ âˆ’ x)dx > 0
Î¨ (Î¸Ì„ + x)dx âˆ’
Ë†
Ë†
`
`

Z ` Z x
00
Î¨ (Î¸Ì„ + y)dy dx > 0.
â‡”
`Ë†

(A.60)

âˆ’x

Equation (A.60) holds because Î¨(Î¸) is convex. When L = 0, Proposition 3.2 implies that (A.58)
Î¸âˆ’xÎ·
is equivalent to (A.59) with the function Î¨( Î¸âˆ’xÎ·
1âˆ’x ) instead of Î¨(Î¸). Since Î¨( 1âˆ’x ) is convex, the

modified (A.59) holds.
Propositions 3.1 and 3.2 imply that the comparison between L = âˆ and L = 0 in the corollary
is equivalent to

Î¨

Î¸n âˆ’ xÎ·
1âˆ’x




+Î¨

Î¸n0 âˆ’ xÎ·
1âˆ’x



 



Î¸nÌ‚ âˆ’ xÎ·
Î¸nÌ‚0 âˆ’ xÎ·
âˆ’ Î¨
+Î¨
1âˆ’x
1âˆ’x

> Î¨(Î¸n ) + Î¨(Î¸n0 ) âˆ’ [Î¨(Î¸nÌ‚ ) + Î¨(Î¸nÌ‚0 )]
!



 "
Î¸Ì„ âˆ’ xÎ·
Î¸Ì„ âˆ’ xÎ·
Î¸Ì„ âˆ’ xÎ·
`
`
`Ë†
+Î¨
âˆ’ Î¨
â‡”Î¨
âˆ’
+
âˆ’
+Î¨
1âˆ’x
1âˆ’x
1âˆ’x
1âˆ’x
1âˆ’x
1âˆ’x
h
i
Ë† + Î¨(Î¸Ì„ + `)
Ë†
> Î¨(Î¸Ì„ âˆ’ `) + Î¨(Î¸Ì„ + `) âˆ’ Î¨(Î¸Ì„ âˆ’ `)


 
Z ` Z x
Z ` Z x
1âˆ’x
Î¸Ì„ âˆ’ xÎ·
Î¨00 (Î¸Ì„ + y)dy dx.
Î¨00
+ y dy dx >
â‡” Ë†
`
1âˆ’x
`Ë†
âˆ’x
âˆ’x

Î¸Ì„ âˆ’ xÎ·
`Ë†
+
1âˆ’x
1âˆ’x

(A.61)

1âˆ’x

Since Î¨(Î¸) is convex and x âˆˆ [0, 1),
Z

`
1âˆ’x

Z

`Ë†
1âˆ’x

x

00



Î¨
âˆ’x

 

 
Z `Ë† +`âˆ’`Ë† Z x
1âˆ’x
Î¸Ì„ âˆ’ xÎ·
00 Î¸Ì„ âˆ’ xÎ·
+ y dy dx > Ë†
Î¨
+ y dy dx
`
1âˆ’x
1âˆ’x
âˆ’x
1âˆ’x

 
Z ` Z x
Î¸Ì„ âˆ’ xÎ·
+ y dy dx.
>
Î¨00
1âˆ’x
`Ë†
âˆ’x

Since, in addition,
Î¨00 (Î¸) =

C2
4(B + CÎ¸)

3
2

A+

âˆš

1
B + CÎ¸

2 +

C2
1
âˆš

2(B + CÎ¸) A + B + CÎ¸ 3

is decreasing, (A.61) holds under the sufficient condition

Î¸Ì„âˆ’xÎ·
1âˆ’x

â‰¤ Î¸Ì„, which is equivalent to Î¸Ì„ â‰¤ Î·.

Proof of Proposition 4.1. We proceed in three steps. In a first step we show that for any  > 0,

64

!#

the investorâ€™s expected utility under any feasible contract does not exceed the utility (4.1), achieved
when the benchmark position Î·, the delegation set L and the managerâ€™s positions are as in the
proposition, and the fee f (W ) is zero. Moreover, the difference in utilities is bounded away from
zero when Î·, L or the managerâ€™s positions are not as in the proposition. In a second step we
show that the investorâ€™s expected utility under the feasible contract described in the proposition
converges to the maximum utility (4.1) when  goes to zero. In a third step we show that the
maximum in (4.1) is achieved for L > 0.
The first and second steps imply that (Î·, L) described in the proposition are part of an optimal
contract when  goes to zero, and that such a contract generates the managerâ€™s positions described
in the proposition. Indeed, if an optimal contract involved different Î·, L or managerâ€™s positions,
then it would yield a utility bounded away from (4.1), while the feasible contract described in the
proposition yields that utility when  goes to zero. Adding the third step implies that the investor
employs the manager. Indeed, not employing her is equivalent to setting (Î·, L, f (W )) = (z0âˆ— , {0}, 0),
but this generates a utility bounded away from (4.1) because L = {0} is not as in the proposition.
Step 1: Since the fee f (W ) is increasing and Î O gives positive probability only to positive
values of R, an unskilled manager with posterior Î O chooses the maximum value of z that meets
the constraint F (âˆ†, s) âˆˆ L. Conversely, since f (W ) is increasing and Î P gives positive probability
only to negative values of R, an unskilled manager with posterior Î P chooses the minimum value
of z such that F (âˆ†, s) âˆˆ L. We denote these maximum and minimum values by zÌ„(s) and z(s),
Â¯
respectively, using the same notation as in the case L = [0, L].
Consider a feasible contract (f (W ), L) that induces positions z(s) by the skilled manager (and
zÌ„(s) and z(s) by the unskilled manager). Since f (W ) is positive (because it is non-negative and
Â¯
increasing), the investorâ€™s expected utility is smaller than the utility achieved when the managerâ€™s
positions remain the same and the fee is zero. The latter utility is
Z
âˆ’(1 âˆ’ Î»)



Es e
sâˆˆÎ¦

âˆ’Ïz(s)SR



Î»
h(s)ds âˆ’
2

Z

h




i
E0 eâˆ’ÏzÌ„(s)SR + E0 eâˆ’ÏÂ¯z(s)SR h(s)ds. (A.62)

sâˆˆÎ¦


Since the investorâ€™s conditional expected utility âˆ’Es eâˆ’ÏzSR is concave in Z, it is increasing for
z < z âˆ— (s) and decreasing for z > z âˆ— (s). Therefore, when z âˆ— (s) > zÌ„(s), expected utility for z(s) is
smaller than for zÌ„(s) > z(s). Conversely, when z âˆ— (s) < z(s), expected utility for z(s) is smaller
Â¯
than for z(s) < z(s). Since, in addition, expected utility is maximum for z âˆ— (s), (A.62) does not
Â¯

65

exceed
"Z
âˆ’ (1 âˆ’ Î»)



Es e

Z



h(s)ds +

#

Z

âˆ’ÏzÌ„(s)SR

sâˆˆÎ¦\(Î¦Ì„âˆªÎ¦)
Â¯

sâˆˆÎ¦Ì„

Z
+



âˆ—
Es eâˆ’Ïz (s)SR h(s)ds



Î»
Es eâˆ’ÏÂ¯z(s)SR h(s)ds âˆ’
2
sâˆˆÎ¦
Â¯

h




i
E0 eâˆ’ÏzÌ„(s)SR + E0 eâˆ’ÏÂ¯z(s)SR h(s)ds,

(A.63)

sâˆˆÎ¦

where we denote by Î¦Ì„ the set of signals s such that z âˆ— (s) > zÌ„(s), and by Î¦ the set of signals s such
Â¯
that z âˆ— (s) < z(s). Equation (A.63) describes also the expected utility when the set L is replaced
Â¯
by [0, L] with L â‰¡ sup L, since (zÌ„(s), z(s)) are the same for both sets. Since replacing L by [0, L]
Â¯
yields the term in curly brackets in (4.1), and since (4.1) is the maximum of that term over (Î·, L),
it exceeds the utility under any feasible contract.
For (Î·, L) not maximizing the term in curly brackets in (4.1), (A.63) is smaller than (4.1).
For L differing from [0, L] by a positive-measure set, (A.62) is smaller than (A.63) and hence also
than (4.1). Indeed, since the range of z âˆ— (s) is the real line, z(s) differs from z âˆ— (s) in a positivemeasure set. For z(s) differing from the values in (A.63) in a positive-measure set (while meeting
the constraint F (âˆ†, s) âˆˆ L), (A.62) is smaller than (A.63) and hence also than (4.1). Since (4.1),
(A.62) and (A.63) are independent of , the difference between (4.1) and the utility under a feasible
contract in which Î·, L or the managerâ€™s positions are not as in the proposition is bounded away
from zero.
Step 2: Consider the contract (f (W ), Î·, L) with (Î·, L) described in the proposition and
 1

1
f (W ) = g(W ) +  2 âˆ’ 8 âˆ’ eâˆ’ÏW 1W > 1

8Ï

log() .

(A.64)

(The term 1W >W is the indicator function, equal to one if W > W and zero otherwise.) Since
Â¯
Â¯
1
1
the function âˆ’ 8 âˆ’ eâˆ’ÏW is positive and increasing for W > 8Ï
log(), the fee f (W ) satisfies the
non-negativity and monotonicity constraints. Since the function g(W ) is bounded over (âˆ’âˆ, âˆ)
1

and the function 1 âˆ’  8 eâˆ’ÏW is bounded over W >

1
8Ï

log(), f (W ) converges uniformly to zero

when  goes to zero.
Equation (A.64) implies that the managerâ€™s utility is
 1

1
âˆ’eâˆ’ÏÌ„f (W ) = âˆ’1 + ÏÌ„ 2 âˆ’ 8 âˆ’ eâˆ’ÏW 1W > 1

8Ï

3

log()

+  4 k(W ),

(A.65)

where the function k(W ) is uniformly bounded when  goes to zero. Since the dominant term in
(A.65) in the interval W >

1
4Ï

log() is an affine transformation of the investorâ€™s utility, the position

that maximizes the skilled managerâ€™s expected utility when  goes to zero converges to the position
that maximizes the investorâ€™s expected utility. Hence, when  goes to zero, the investorâ€™s expected
66

utility is given by the (4.1).
Step 3: Breaking the integrals, we can write the term in curly brackets in (4.1) as
"Z
âˆ’ (1 âˆ’ Î»)

Z


Es eâˆ’ÏzÌ„(s)SR h(s)ds +
sâˆˆÎ¦\(Î¦Ì„âˆªÎ¦)
Â¯

sâˆˆÎ¦Ì„

#

Z
+



âˆ—
Es eâˆ’Ïz (s)SR h(s)ds



Î»
Es eâˆ’ÏÂ¯z(s)SR h(s)ds âˆ’
2
sâˆˆÎ¦
Â¯

Z

h




i
E0 eâˆ’ÏzÌ„(s)SR + E0 eâˆ’ÏÂ¯z(s)SR h(s)ds.

(A.66)

sâˆˆÎ¦

The derivative of (A.66) with respect to L is
"Z

Z

 âˆ‚ z(s)
 âˆ‚ zÌ„(s)
Es eâˆ’ÏÂ¯z(s)SR R S Â¯ h(s)ds
(1 âˆ’ Î»)
Es e
R S
h(s)ds +
âˆ‚L
âˆ‚L
sâˆˆÎ¦
sâˆˆÎ¦Ì„
Â¯
 



Z
Î»
âˆ‚ zÌ„(s)
âˆ‚ z(s)
+
E0 eâˆ’ÏzÌ„(s)SR SR
+ E0 eâˆ’ÏÂ¯z(s)SR SR Â¯
h(s)ds.
2 sâˆˆÎ¦
âˆ‚L
âˆ‚L


#

âˆ’ÏzÌ„(s)SR

(A.67)

The definitions of (zÌ„(s), z(s)) imply
Â¯
âˆ‚ z(s)
âˆ‚ zÌ„(s)
=âˆ’ Â¯
> 0.
âˆ‚L
âˆ‚L

(A.68)


Together with the definitions of (Î¦Ì„, Î¦), they also imply Es eâˆ’ÏzÌ„(s)SR R > 0 for all s âˆˆ Î¦Ì„(L), and
Â¯

Es eâˆ’ÏÂ¯z(s)SR R < 0 for all s âˆˆ Î¦(L). Hence, the first of the two terms in square brackets in (A.67)
Â¯
is positive. The second term is zero for L = 0 because of (A.68) and zÌ„(s) = z(s) = Î·. Therefore,
Â¯
the derivative of (A.66) with respect to L is positive at L = 0, which means that the maximum in
(4.1) is achieved for L > 0.
Proof of Proposition 4.2. The maximum position zÌ„(s) and minimum position z(s) that meet
Â¯
the constraint
F (âˆ†, s) = |zt âˆ’ Î·|Ïƒ

p
Dt S 0 (Dt ) â‰¤ L

are
L
zÌ„(s) = Î· + âˆš
,
Ïƒ Dt S 0 (Dt )
L
z(s) = Î· âˆ’ âˆš
,
Â¯
Ïƒ Dt S 0 (Dt )

(A.69)
(A.70)

respectively. The position z âˆ— (s) that maximizes an investorâ€™s expected utility conditional on s is
the position that unconstrained investors hold in equilibrium. In the unconstrained region, defined

67

by (4.3), z âˆ— (s) can be derived by setting z1t = z2t in the market-clearing condition (4.2), and is
z1t = z âˆ— (s) =

Î¸ âˆ’ Î»xÎ·
.
1 âˆ’ Î»x

To derive z âˆ— (s) in the constrained region, defined by
|Î¸ âˆ’ Î·| p
Ïƒ Dt S 0 (Dt ) > L,
1 âˆ’ Î»x
we distinguish cases. When Î¸ > Î·, z âˆ— (s) can be derived by setting z2t = zÌ„(s) in (4.2), and is

âˆ—

z1t = z (s) =

Î¸ âˆ’ xÎ· âˆ’

(1âˆ’Î»)xL
âˆš
Ïƒ Dt S 0 (Dt )

1âˆ’x

.

When instead Î¸ < Î·, z âˆ— (s) can be derived by setting z2t = z(s) in (4.2), and is
Â¯
âˆ—

z1t = z (s) =

Î¸ âˆ’ xÎ· +

(1âˆ’Î»)xL
âˆš
Ïƒ Dt S 0 (Dt )

1âˆ’x

.

Hence, (zÌ„(s), z(s), z âˆ— (s)) are as in the propositionâ€™s statement. The ODEs in the unconstrained and
Â¯
constrained region can be derived from (3.2) by substituting Et (dRtsh ) by the drift term in (3.1),
Vart (dRtsh ) by the square of the diffusion term, and z1t by z âˆ— (s). This yields
Ï(Î¸ âˆ’ Î»xÎ·) 2
1
Ïƒ Dt S 0 (Dt )2
Dt + Îº(DÌ„ âˆ’ Dt )S 0 (Dt ) + Ïƒ 2 Dt S 00 (Dt ) âˆ’ rS(Dt ) =
2
1 âˆ’ Î»x

(A.71)

in the unconstrained region, and
1
Ï(Î¸ âˆ’ xÎ·) 2
Ï sgn(Î¸ âˆ’ Î·)(1 âˆ’ Î»)xL p
Dt +Îº(DÌ„âˆ’Dt )S 0 (Dt )+ Ïƒ 2 Dt S 00 (Dt )âˆ’rS(Dt ) =
Ïƒ Dt S 0 (Dt )2 âˆ’
Ïƒ Dt S 0 (Dt )
2
1âˆ’x
1âˆ’x
(A.72)
in the constrained region. When Î¸ > Î·, z âˆ— (s) âˆˆ (Î·, zÌ„(s)] in the unconstrained region, and z âˆ— (s) >
zÌ„(s) in the constrained region. When instead Î¸ < Î·, z âˆ— (s) âˆˆ [z(s), Î·) in the unconstrained region,
Â¯
and z âˆ— (s) < z(s) in the constrained region. Hence,
Â¯
|Î¸ âˆ’ Î·| p
Î¦Ì„ = {Î¸ > Î· and z âˆ— (s) > zÌ„(s)} = {Î¸ > Î· and
Ïƒ Dt S 0 (Dt ) > L},
(A.73)
1 âˆ’ Î»x
|Î¸ âˆ’ Î·| p
Î¦ = {Î¸ < Î· and z âˆ— (s) < zÌ„(s)} = {Î¸ < Î· and
Ïƒ Dt S 0 (Dt ) > L}.
(A.74)
Â¯
1 âˆ’ Î»x
The derivative of (A.66) with respect to L in the continuous-time limit can be derived from

68

(A.67) by replacing SR by dRtsh , and is
"Z

#
 âˆ‚ z(s)
Es e Â¯
dRtsh Â¯ h(s)ds
(1 âˆ’ Î»)
Es e
dRtsh
h(s)ds +
âˆ‚L
âˆ‚L
sâˆˆÎ¦
sâˆˆÎ¦Ì„
Â¯

 


Z
âˆ‚ zÌ„(s)
âˆ‚ z(s)
Î»
sh
sh
E0 eâˆ’ÏzÌ„(s)dRt dRtsh
+ E0 eâˆ’ÏÂ¯z(s)dRt dRtsh Â¯
h(s)ds.
(A.75)
+
2 sâˆˆÎ¦
âˆ‚L
âˆ‚L


âˆ’ÏzÌ„(s)dRtsh

Z

 âˆ‚ zÌ„(s)



âˆ’Ïz(s)dRtsh

The derivative of (A.66) with respect to Î· in the continuous-time limit is
"Z

#
 âˆ‚ z(s)
(1 âˆ’ Î»)
Es e
dRtsh
Es e Â¯
dRtsh Â¯ h(s)ds
h(s)ds +
âˆ‚Î·
âˆ‚Î·
sâˆˆÎ¦Ì„
sâˆˆÎ¦
Â¯

 


Z
âˆ‚ zÌ„(s)
âˆ‚ z(s)
Î»
sh
sh
E0 eâˆ’ÏzÌ„(s)dRt dRtsh
+ E0 eâˆ’ÏÂ¯z(s)dRt dRtsh Â¯
h(s)ds.
(A.76)
+
2 sâˆˆÎ¦
âˆ‚Î·
âˆ‚Î·


âˆ’ÏzÌ„(s)dRtsh

Z

 âˆ‚ zÌ„(s)



âˆ’Ïz(s)dRtsh

To simplify (A.75) and (A.76), we use




sh
Es eâˆ’Ïz(s)dRt dRtsh = Es (1 âˆ’ Ïz(s)dRtsh )dRtsh
= Es (dRtsh ) âˆ’ Ïz(s)Vars (dRtsh )
= Ï[z âˆ— (s) âˆ’ z(s)]Vars (dRtsh )
= Ï[z âˆ— (s) âˆ’ z(s)]Ïƒ 2 Dt S 0 (Dt )2 ,

(A.77)

where the third step follows because z âˆ— (s) is optimal and hence satisfies the first-order condition
(3.2);


h 
i
sh
sh
E0 eâˆ’Ïz(s)dRt dRtsh F (s) = E0 Es eâˆ’Ïz(s)dRt dRtsh F (s)


= ÏE0 Es [z âˆ— (s) âˆ’ z(s)]Ïƒ 2 Dt S 0 (Dt )2 F (s)


= ÏE0 [z âˆ— (s) âˆ’ z(s)]Ïƒ 2 Dt S 0 (Dt )2 F (s) ,

(A.78)

where the second step follows from (A.77); and
âˆ‚ zÌ„(s)
âˆ‚L
âˆ‚ z(s)
Â¯
âˆ‚L
âˆ‚ zÌ„(s)
âˆ‚Î·
âˆ‚ z(s)
Â¯
âˆ‚Î·

1
= âˆš
,
Ïƒ Dt S 0 (Dt )
1
=âˆ’ âˆš
,
Ïƒ Dt S 0 (Dt )

(A.79)
(A.80)

= 1,

(A.81)

= 1,

(A.82)

which follow by differentiating (A.69) and (A.70).

69

Using (A.73), (A.74) and (A.77)-(A.80), we can write (A.75) as
i X
i
h
p
p
0
0
âˆ—
âˆ—
Ï€(Î¸)EÎ¸ [z (s) âˆ’ zÌ„(s)]1
Ï€(Î¸)EÎ¸ [z (s) âˆ’ z(s)]1{z (s)<z(s)} Ïƒ Dt S (Dt )
Ïƒ Dt S (Dt ) âˆ’
Â¯
Â¯
Î¸>Î·
Î¸<Î·
i
h
X
p
Î»
+
(A.83)
Ï€(Î¸)EÎ¸ [z(s) âˆ’ zÌ„(s)]Ïƒ Dt S 0 (Dt ) .
Â¯
2(1 âˆ’ Î»)
h

X

âˆ—

{z âˆ— (s)>zÌ„(s)}

Î¸

Setting (A.83) to zero, and using (A.69) and (A.70) to simplify the third term, we find (4.5). Using
(A.73), (A.74), (A.77), (A.78), (A.81) and (A.82), we can write (A.76) as
X
Î¸>Î·

+


 X


Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ zÌ„(s)]1{z âˆ— (s)>zÌ„(s)} Ïƒ 2 Dt S 0 (Dt )2 +
Ï€(Î¸)EÎ¸ [z âˆ— (s) âˆ’ z(s)]1{z âˆ— (s)<z(s)} Ïƒ 2 Dt S 0 (Dt )2
Â¯
Â¯

Î»
2(1 âˆ’ Î»)

Î¸<Î·

X
Î¸



Ï€(Î¸)EÎ¸ [2z âˆ— (s) âˆ’ zÌ„(s) âˆ’ z(s)]Ïƒ 2 Dt S 0 (Dt )2 .
Â¯

(A.84)

Setting (A.84) to zero, and using (A.69) and (A.70) to simplify the third term, we find (4.4).
When Î· > Î¸max , the first term in the left-hand side of (4.4) is zero because the summation is
over an empty set of Î¸, the second term is negative because the summation is over a non-empty set
of Î¸ and the set of values of Dt such that z âˆ— (s) < z(s) has positive measure, and the third term
Â¯
is negative because z âˆ— (s) < Î· when Î¸ < Î·. Hence, the left-hand side of (4.4) is negative, which
means that the investor can raise his utility by lowering Î·. When instead Î· < Î¸min , the first term
is positive because the summation is over an non-empty set of Î¸ and the set of values of Dt such
that z âˆ— (s) > zÌ„(s) has positive measure, the second term is zero because the summation is over an
empty set of Î¸, and the third term is positive because z âˆ— (s) > Î· when Î¸ > Î·. Hence, the left-hand
side of (4.4) is positive, which means that the investor can raise his utility by raising Î·. Therefore,
Î· âˆˆ [Î¸min , Î¸max ].
When Î¸ can take only one value, Î¸min and Î¸max coincide with that value, and so does Î· âˆˆ
[Î¸min , Î¸max ]. Moreover, the first and second terms in the left-hand side of (4.5) are zero because
the summations are over empty sets of Î¸. Hence, L = 0.
When Î¸ can take multiple values, the argument showing that the left-hand side of (4.4) is
negative when Î· > Î¸max can be extended to Î· â‰¥ Î¸max because the set of Î¸ < Î· is non-empty.
Likewise, the argument showing that the left-hand side of (4.4) is positive when Î· < Î¸min can be
extended to Î· â‰¤ Î¸min because the set Î¸ > Î· is non-empty. Therefore, Î· âˆˆ (Î¸min , Î¸max ). Fixing
Î· âˆˆ (Î¸min , Î¸max ), the first and second terms in the left-hand side of (4.5) are positive and bounded
for L â‰¥ 0, and converge to zero when L goes to infinity. When Î» = 0, the third term is zero. Hence,
the left-hand side of (4.5) is positive, which means that the investor can raise his utility by raising
L to infinity. When Î» âˆˆ [0, 1), the third term is a linear and decreasing function of L. Hence, the

70

solution L to (4.5) is finite. When Î» goes to one, the third term converges to infinity for any finite
L. Hence, the solution L to (4.5) converges to zero.

B

Alternative Constraint

We first show that (2.7) resembles closely a constraint restricting the weights of a portfolio consisting
of one riskless and multiple risky assets. Suppose that there are N risky assets instead of one.
Denote by Snt the price of risky asset n = 1, .., N , by znt the number of shares of the asset that
an investor is holding, and by Î·n the number of shares of the asset in the benchmark portfolio.
Denote also by Î·0 the riskless asset investment in the benchmark portfolio. The weight of risky
asset n in the investorâ€™s portfolio is

znt Snt
Wt

and in the benchmark portfolio is

Î·0 +

Î·nt Snt
PN
,
n=1 Î·nt Snt

where

Wt is the investorâ€™s wealth. Restricting the two weights not to differ by more than L â‰¥ 0 yields
the constraint
znt Snt
Î·n Wt
Î·n Snt
â‰¤ L â‡” znt âˆ’
Snt â‰¤ LWt .
âˆ’
PN
PN
Wt
Î·0 + n=1 Î·n Snt
Î·0 + n=1 Î·n Snt
The constraint (2.7) is the same as (B.1) except that Î·n and L replace
respectively. The quantity

Î·0 +

Î·n W t
PN
n=1 Î·n Snt

(B.1)

Î· W
Pn t
Î·0 + N
n=1 Î·n Snt

and LWt ,

is the number of shares of asset n that the investor holds

when investing all his wealth Wt in the benchmark portfolio. The constraint (2.7) approximates
(B.1) well when the relative variation in

Î·0 +

Wt
PN

n=1

Î·n Snt

and Wt is small compared to that in Snt .

That condition is likely to hold when N is sufficiently large.
In a similar spirit, (2.6) resembles closely a constraint restricting the volatility of a portfolio
consisting of one riskless and multiple risky assets. Restricting the volatility of each component of
the portfolio separately yields the constraint
znt Snt
Î·n Snt
âˆ’
PN
Wt
Î·0 + n=1 Î·n Snt

r

s
Î·n Wt
Vart (Rnt )
â‰¤ L â‡” znt âˆ’
PN
dt
Î·0 + n=1 Î·n Snt

sh )
Vart (Rnt
â‰¤ LWt .
dt

(B.2)
The constraint (2.6) is the same as (B.2) except that Î·n and L replace

Î· W
Pn t
Î·0 + N
n=1 Î·n Snt

and LWt ,

respectively.
Under the alternative constraint (2.7), the system of ODEs consists of (3.4) in the unconstrained
region defined by
|Î¸ âˆ’ Î·|S(Dt ) â‰¤ L,

(B.3)

71

Figure 6: Alternative Constraint
1.2
3.0

2.5

1.1

2.0
1.0
1.5
0.9

1.0

0.5
0.0

0.8
0.1

0.2

0.3

0.4

0.0

0.1

0.2

0.3

0.4

Asset price St (left panel) and position z2t of constrained investors (right panel) as functions of the dividend
flow Dt , under the alternative constraint (2.7). The thick lines correspond to the case where there is a
constraint (L âˆˆ (0, âˆ)). The thin lines correspond to the polar cases where there is no constraint (L = âˆ)
and where the constraint is infinitely tight (L = 0). The latter case corresponds to the more extreme values
in the left panel and to the horizontal line z2t = 1 in the right panel. In all three cases, the dashed red line
is drawn for Î¸ = 0.8 and the solid blue line is drawn for Î¸ = 1.2. All parameter values are as in Figure 1
except for L which is equal to 0.2.

and
1
Ï(Î¸ âˆ’ xÎ·) 2
Ï sgn(Î¸ âˆ’ Î·)xL Ïƒ 2 Dt S 0 (Dt )2
Dt +Îº(DÌ„âˆ’Dt )S 0 (Dt )+ Ïƒ 2 Dt S 00 (Dt )âˆ’rS(Dt ) =
Ïƒ Dt S 0 (Dt )2 âˆ’
2
1âˆ’x
1âˆ’x
S(Dt )
(B.4)
in the constrained region defined by
|Î¸ âˆ’ Î·|S(Dt ) > L.

(B.5)

Figure 6 plots the solution of that system within the numerical example of Section 3. The left panel
plots the price and the right panel plots the position of constrained investors, both as function of
Dt . Consistent with Theorem 3.1, the price for L âˆˆ (0, âˆ) lies between the affine solution in
the polar cases where there is no constraint (L = âˆ) and where the constraint is infinitely tight
(L = 0). Moreover, the price is convex in Dt for Î¸ < Î· and concave for Î¸ > Î·.

72

References
Admati, Anat, and Paul Pfleiderer, 1997, Does it all add up? Benchmarks and the compensation
of active portfolio managers, Journal of Business 70, 323â€“350.
Alonso, Ricardo, and Niko Matouschek, 2008, Optimal delegation, Review of Economic Studies 75,
259â€“293.
Amador, Manuel, and Kyle Bagwell, 2013, The theory of optimal delegation with an application
to tariff caps, Econometrica 81, 1541â€“1599.
Ang, Andrew, Robert Hodrick, Yuhang Xing, and Xiaoyan Zhang, 2006, The cross-section of
volatility and expected returns, Journal of Finance 61, 259â€“299.
Baker, Malcolm, Brendan Bradley, and Jeffrey Wurgler, 2011, Benchmarks as limits to arbitrage:
Understanding the low-volatility anomaly, Financial Analysts Journal 67.
Basak, Suleyman, and Anna Pavlova, 2013, Asset prices and institutional investors, American
Economic Review 103, 1728â€“1758.
Berk, Jonathan, and Richard Green, 2004, Mutual fund flows and performance in rational markets,
Journal of Political Economy 112, 1269â€“1295.
Bhattacharya, Ayan, and Maureen Oâ€™Hara, 2018, Can ETFs increase market fragility? Effects of
information linkages in ETF markets, Working paper Cornell University.
Bhattacharya, Sudipto, and Paul Pfleiderer, 1985, Delegated portfolio management, Journal of
Economic Theory 36, 1â€“25.
BIS, 2003, Incentive structures in institutional asset management and their implications for financial
markets, Report of the Committee on the Global Financial System.
Black, Fischer, 1972, Capital market equilibrium with restricted borrowing, Journal of Business
45, 444â€“55.
, Michael Jensen, and Myron Scholes, 1972, The capital asset pricing model: Some empirical
tests, in Michael Jensen, ed.: Studies in the Theory of Capital Markets . pp. 79â€“121 (Praeger:
New York).
Bond, Philip, and Diego Garcia, 2019, The equilibrium consequences of indexing, Working paper
University of Washington.
Brennan, Michael, 1993, Agency and asset pricing, Working paper 1147, Anderson Graduate School
of Management, UCLA.
Brunnermeier, Markus, and Yuliy Sannikov, 2014, A macroeconomic model with a financial sector,
American Economic Review 104, 379â€“421.
Buffa, Andrea, and Idan Hodor, 2018, Institutional investors, heterogeneous benchmarks and the
comovement of asset prices, Working paper Boston University.
Buffa, Andrea, Dimitri Vayanos, and Paul Woolley, 2014, Asset management contracts and equilibrium prices, Working paper London School of Economics.

73

Cadenillas, Abel, Jaksa Cvitanic, and Fernando Zapatero, 2007, Optimal risk-sharing with effort
and project choice, Journal of Economic Theory 133, 403â€“440.
Christoffersen, Susan, and Mikhail Simutin, 2017, On the demand for high-beta stocks: Evidence
from mutual funds, Review of Financial Studies 30, 2596â€“2620.
Cong, William, and Douglas Xu, 2016, Rise of factor investing: Asset prices, informational efficiency
and security design, Working paper Cornell University.
Coval, Joshua, and Erik Stafford, 2007, Asset fire sales (and purchases) in equity markets, Journal
of Financial Economics 86, 475â€“512.
Cuoco, Domenico, and Ron Kaniel, 2011, Equilibrium prices in the presence of delegated portfolio
management, Journal of Financial Economics 101, 264â€“296.
Cvitanic, Jaksa, and Hao Xing, 2018, Asset pricing under optimal contracts, Journal of Economic
Theory 173, 142â€“180.
Das, Sanjiv, and Rangarajan Sundaram, 2002, Fee speech: Signaling, risk-sharing, and the impact
of fee structures on investor welfare, Review of Financial Studies 15, 1465â€“1497.
Dasgupta, Amil, and Andrea Prat, 2008, Information aggregation in financial markets with career
concerns, Journal of Economic Theory 143, 83â€“113.
, and Michela Verardo, 2011, The price impact of institutional herding, Review of Financial
Studies 24, 892â€“925.
Dybvig, Philip, Heber Farnsworth, and Jennifer Carpenter, 2010, Portfolio performance and agency,
Review of Financial Studies 23, 1â€“23.
Elton, Edwin, and Martin Gruber, 2013, Mutual funds, in Handbook of the Economics of Finance
. chap. 15, pp. 1011â€“1061 (Elsevier: London/New York).
Franzoni, Francesco, Itzhak Ben-David, and Rabih Moussawi, 2017, Exchange-traded funds, Annual
Review of Financial Economics 9, 169â€“189.
Frazzini, Andrea, and Owen Lamont, 2008, Dumb money: Mutual fund flows and the cross-section
of stock returns, Journal of Financial Economics 88, 299â€“322.
Frazzini, Andrea, and Lasse Heje Pedersen, 2014, Betting against beta, Journal of Financial Economics 111, 1â€“25.
French, Kenneth, 2008, Presidential address: The cost of active investing, Journal of Finance 63,
1537â€“1573.
Froot, Kenneth, David Scharftstein, and Jeremy Stein, 1992, Herd on the street: Informational
inefficiencies in a market with short-term speculation, Journal of Finance 47, 1461â€“84.
Garcia, Diego, and Joel Vanden, 2009, Information acquisition and mutual funds, Journal of Economic Theory 144, 1965â€“1995.
Garleanu, Nicolae, and Lasse Pedersen, 2018, Efficiently inefficient markets for assets and asset
management, Journal of Finance 73, 1663â€“1712.

74

Gorton, Gary, Ping He, and Lixin Huang, 2010, Security price informativeness with delegated
traders, American Economic Journal: Microeconomics 2, 137â€“170.
Gromb, Denis, and Dimitri Vayanos, 2010, Limits of arbitrage, Annual Review of Financial Economics 2, 251â€“275.
Grossman, Sanford, and Joseph Stiglitz, 1980, On the impossibility of informationnaly efficient
markets, American Economic Review 70, 393â€“408.
Guerrieri, Veronica, and Peter Kondor, 2012, Fund managers, career concerns, and asset price
volatility, American Economic Review 102, 1986â€“2017.
Harrison, Michael, and David Kreps, 1978, Speculative investor behavior in a stock market with
heterogeneous expectations, Quarterly Journal of Economics 92, 323â€“336.
Haugen, Robert, and Nardin Baker, 1996, Commonality in the determinant of expected stock
returns, Journal of Financial Economics 41, 401â€“439.
He, Zhiguo, and Arvind Krishnamurthy, 2012, A model of capital and crises, Review of Economic
Studies 79, 735â€“777.
, 2013, Intermediary asset pricing, American Economic Review 103, 1â€“43.
He, Zhiguo, and Wei Xiong, 2013, Delegated asset management, investment mandates, and capital
immobility, Journal of Financial Economics 107, 239â€“258.
Hong, Harrison, and Marcin Kacperczyk, 2009, The price of sin: The effects of social norms on
markets, Journal of Financial Economics 93, 15â€“36.
Hong, Harrison, and Jeremy Stein, 2007, Disagreement and the stock market, Journal of Economic
Perspectives 21, 109â€“128.
Huang, Shiyang, 2018, Delegated information acquisition and asset pricing, Working paper Hong
Kong University.
Jones, Bradley, 2015, Asset bubbles: Re-thinking policy for the age of asset management, Working
paper International Monetary Fund.
Kapur, Sandeep, and Allan Timmermann, 2005, Relative performance evaluation contracts and
asset market equilibrium, Economic Journal 115, 1077â€“1102.
Kashyap, Anil, Natalia Kovrijnykh, Jian Li, and Anna Pavlova, 2018, The benchmark inclusion
subsidy, Working paper University of Chicago.
Kyle, Albert, Hui Ou-Yang, and Bin Wei, 2011, A model of portfolio delegation and strategic
trading, Review of Financial Studies 24, 3778â€“3812.
Li, Wei, and Ashish Tiwari, 2009, Incentive contracts in delegated portfolio management, Review
of Financial Studies 22, 4681â€“4714.
Lines, Anton, 2016, Do institutional incentives distort asset prices?, Working paper Columbia
University.
Malamud, Semyon, and Evgeny Petrov, 2014, Portfolio delegation and market efficiency, Working
paper Swiss Finance Institute.
75

Ou-Yang, Hui, 2003, Optimal contracts in a continuous-time delegated portfolio management problem, Review of Financial Studies 16, 173â€“208.
Palomino, Frederic, and Andrea Prat, 2003, Risk taking and optimal contracts for money managers,
RAND Journal of Economics 34, 113â€“137.
Pastor, Lubos, and Robert Stambaugh, 2012, On the size of the active management industry,
Journal of Political Economy 120, 740â€“781.
Qiu, Zhigang, 2017, Equilibrium-informed trading with relative performance measurement, Journal
of Financial and Quantitative Analysis 52, 2083â€“2118.
Sato, Yuki, 2016, Delegated portfolio management, optimal fee contracts, and asset prices, Journal
of Economic Theory 165, 360â€“389.
Scheinkman, Jose, and Wei Xiong, 2003, Overconfidence and speculative bubbles, Journal of Political Economy 111, 1183â€“1219.
Sockin, Michael, and Mindy Zhang Xiaolan, 2018, Delegated learning in asset management, Working paper University of Texas at Austin.
Stambaugh, Robert, 2014, Presidential address: Investment noise and trends, Journal of Finance
69, 1415â€“1453.
Starks, Laura, 1987, Performance incentive fees: An agency theoretic approach, Journal of Financial and Quantitative Analysis 22, 17â€“32.
Stoughton, Neal, 1993, Moral hazard and the portfolio management problem, Journal of Finance
48, 2009â€“2028.
Subrahmanyam, Avanidhar, 1991, A theory of trading in stock index futures, Review of Financial
Studies 4, 17â€“51.
Vayanos, Dimitri, 2018, Risk limits as optimal contracts, Working paper London School of Economics.

76

