NBER WORKING PAPER SERIES

THE WELFARE EFFECTS OF TRANSPORTATION INFRASTRUCTURE IMPROVEMENTS
Treb Allen
Costas Arkolakis
Working Paper 25487
http://www.nber.org/papers/w25487

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2019

We thank David Atkin, Dave Donaldson, Pablo Fajgelbaum, Xiangliang Li, and Sam Kortum for
very helpful discussions and the National Science Foundation for funding. Narek Alexanian,
Lucas Conwell, Yujing (Amy) Hu, and Zijian He provided excellent research assistance. All
remaining errors are our own. The views expressed herein are those of the authors and do not
necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2019 by Treb Allen and Costas Arkolakis. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including © notice, is given to the source.

The Welfare Effects of Transportation Infrastructure Improvements
Treb Allen and Costas Arkolakis
NBER Working Paper No. 25487
January 2019
JEL No. H54,R12,R13,R41,R42
ABSTRACT
We develop a general equilibrium geographic framework to characterize the welfare effect of
transportation infrastructure investments. We tackle three distinct but conflating challenges: First,
we offer an analytical characterization of the routing problem and, in particular, how
infrastructure investment between any two connected locations decreases the total trade costs
between all pairs of locations. Second, we characterize how this cost reduction affects welfare
within a standard general equilibrium geography setup where market inefficiencies arise due to
agglomeration and dispersion spillovers. Finally, we show how our framework admits analytical
characterizations of traffic congestion, which creates a critical – albeit tractable – feedback loop
between trade costs and the general equilibrium economic system. We apply these results to
calculate the welfare effects of improving each of the thousands of segments of the U.S. national
highway network. We find large but heterogeneous welfare effects, with the largest gains
concentrated in metropolitan areas and along important trading corridors.

Treb Allen
Department of Economics
Dartmouth College
6106 Rockefeller Hall
Hanover, NH 03755
and NBER
treb@dartmouth.edu
Costas Arkolakis
Department of Economics
Yale University, 28 Hillhouse Avenue
P.O. Box 208268
New Haven, CT 06520-8268
and NBER
costas.arkolakis@yale.edu

1

Introduction

More than a trillion dollars is spent on investment in transportation infrastructure across
the world each year (Lefevre, Leipziger, and Raifman, 2014). Is this money being well spent?
This is a difficult question to answer, as evaluating the welfare effect of infrastructure improvements faces three paramount challenges: first, there is a “routing problem”: because
agents endogenously choose how to travel along through the infrastructure network, an improvement along one segment can change trade costs across the entire network. Second, there
is an “economic problem”: a change in trade costs impacts the distribution of economic activity (and hence welfare) in all locations through complex general equilibrium interactions,
made all the more complicated by market failures created by the presence of agglomeration
and dispersion spillovers. Finally, traffic congestion creates a critical feedback loop as infrastructure improvements change traffic patterns, affecting costs throughout the network,
thereby affecting trade flows, which in turn impacts traffic patterns. This myriad of complex
interactions makes evaluating the welfare impact of a particular infrastructure investment
difficult, let alone choosing where to best target infrastructure improvements.
In this paper, we develop and implement a new framework that overcomes each of the
aforementioned challenges, providing a tractable way of assessing the welfare impact of infrastructure improvements. In particular, this paper makes four contributions. First, we
solve the “routing problem” by deriving an analytical expression on how an infrastructure
investment between any two connected locations in an arbitrary infrastructure network decreases the cost of travel between all bilateral pairs. Second, we solve the “economic problem”
by analytically characterizing how equilibrium welfare changes in response to a reduction in
trade costs in the competitive equilibrium of a standard general equilibrium “gravity” spatial
economic framework with agglomeration and dispersion spillovers. Third, we combine the
routing framework with the general equilibrium spatial framework in the presence of traffic
congestion – which creates a crucial feedback between the routing problem and the economic
problem – to assess the welfare impact of infrastructure improvements. Finally, we apply
our framework to the U.S. highway network, estimating several crucial model parameters
using readily available data on observed traffic flows and calculating the welfare impact of
improving each of the thousands of existing highway segments.
To tackle the routing problem, we assume the economy is composed of many locations
arranged on a weighted graph. For each origin-destination pair, a continuum of heterogeneous
traders each chooses their own optimal cost-minimizing route. Combining convenient results
of extreme-value distributions popularized by Eaton and Kortum (2002) with results from
graph theory, we derive an analytical expression for the expected (iceberg) trade cost between

2

all pairs of locations as a function of the underlying infrastructure network. In the special
case when trader heterogeneity goes to zero, this expression is simply equal to the cost
incurred along the least-cost route (which can be calculated using the algorithm presented
in Dijkstra (1959), albeit without an analytical solution).
Our framework also allows us to derive two additional analytical expressions that exploit
the analytical characterization of the routing problem but are essential for implementing our
framework. First, we derive how any small change in the infrastructure network changes the
expected trade cost between all pairs of locations. The expression is intuitive – the more “out
of the way” a segment of the network, the smaller the impact on of its improvement on the
iceberg trade cost of a bilateral pair – and provides a straightforward link between the routing
problem and the economic framework to evaluate the welfare impact of an infrastructure
network change. Second, for any number of traders moving between location pairs, we
characterize the amount of traffic along all segments of the network. This result will prove
helpful in exploiting traffic data in two ways: first, it allows us to introduce a traffic congestion
into the framework (where the cost of traveling along an infrastructure segment depends on
the amount of traffic); second, it will prove helpful when estimating the model using observed
traffic flows.
To tackle the “economic problem”, we derive the elasticity of equilibrium welfare with
respect to a small change in trade costs in a standard general equilibrium spatial framework
with labor mobility as in Allen and Arkolakis (2014). In the absence of agglomeration and
dispersion spillovers, the competitive equilibrium is efficient and the elasticity of equilibrium welfare to a change in bilateral trade costs is simply equal to the fraction of world
trade between those locations.1 However, in the presence of agglomeration and/or dispersion spillovers, the competitive equilibrium is not efficient, and we show that the response of
welfare to trade costs carries a distortion term. The distortion term has a very interesting interpretation in itself: as the positive agglomeration spillovers become stronger the distortion
term is increasingly determined by higher-order relationships in the network of locations.
In particular, indirect connections obtain a higher weight in determining its value. Overall,
in the presence of inefficiencies the entire set of trading connections between locations is
necessary for the characterization of the effects of reducing transportation costs.
We then combine the routing and economic problems in the presence of traffic congestion (modeled as proposed by Vickrey (1967)). As more traffic travels along a segment of
the network, the cost of traveling along that segment increases, inducing some traders to
1

This argument can be shown to be extended in other spatial frameworks without labor mobility where
efficiency holds as in Anderson (1979); Anderson and Van Wincoop (2003); Allen, Arkolakis, and Takahashi
(2018).

3

opt to take alternative routes, impacting the cost of traveling along other segments in the
network. The extent to which costs increase along each segment depend on the number of
traders traveling from each origin to each destination (i.e. trade flows) which are in turn
impacted by changes in travel costs along the network, creating a feedback loop between the
“economic problem” and the “routing problem.” Despite these complex interactions, we are
able to provide analytical characterizations of how welfare changes in response to a small
improvement of any segment of the infrastructure network described in form of sufficient
statistics observed in the data and model parameters.
Finally, we apply our framework to analyze the welfare impact of improving each of the
nearly 7,000 segments of the U.S. National Highway System connecting nearly 900 cities.
Using the observed traffic flows and travel times along each segment, we estimate traders are
not very heterogeneous (i.e. most take a route that is close to optimal), but traffic congestion
spillovers are substantial. Reassuringly, model-predicted traffic flows are strongly correlated
with observed traffic flows and, as an out of sample test, the model implied bilateral trade
flows between U.S. cities, when aggregated, correlate well with observed state to state trade
flows.
Using our estimated parameters we find large and heterogeneous welfare impacts of improving the U.S. highway network. While the welfare gains of adding 10 additional lane-miles
range from $10 to $20 million for three quarters of the highway segments, we estimate substantially larger gains for segments within metropolitan areas and along important travel
corridors, with the returns exceeding $500 million for two highway segments in the New
York City metropolitan area. For every highway segment, these benefits exceed the costs
of construction and maintenance (estimated based on local topography), with the greatest
returns on investment for highways within the New York City and Los Angeles metropolitan
areas and in central Indiana (aptly nicknamed the “Crossroads of America”). Interestingly,
the presence of market failures due to agglomeration, dispersion spillovers and traffic congestion have important implications for which segment improvements have the greatest welfare
impact.
This paper is connected to different strands of the literature related to transportation
economics and infrastructure evaluation. First, there is long literature dating back to Fogel
(1962, 1964) that evaluates the economic impact of infrastructure improvements. Indeed,
we show that, in the absence of externalities, our finding that the welfare elasticity to a
change in bilateral trade costs is equal to the value of trade between those locations, the
general equilibrium equivalent of the celebrated “Social Savings” formula Fogel heuristically
derives.2 More recently, there is a burgeoning field evaluating the general equilibrium impacts
2

Crafts (2004) in a partial equilibrium setup where incomes are constant, formally shows that the Fogel

4

of infrastructure investment, e.g. Donaldson (2012), Allen and Arkolakis (2014), Donaldson
and Hornbeck (2016) in an inter-city context and the work of Ahlfeldt, Redding, Sturm,
and Wolf (2015) in an intra-city context; see Redding and Turner (2014) and Redding and
Rossi-Hansberg (2017) for excellent reviews. Relative to this literature, we offer a “routing”
framework that allows us to analytically solve for the impact of an improvement to the
transportation network in a gravity framework without having to rely on computational
methods (such as Dijkstra’s algoritm or the “Fast Marching Method” pioneered by Osher
and Sethian (1988)), which allows us to incorporate traffic congestion in a tractable manner.
Second, there is also a long theoretical literature in transportation economics examining
agent’s optimal routing decisions; these tools are comprehensively summarized in Galichon
(2016). However, the bulk of the existing empirical transportation economics literature is
focused on combining agent based (utility maximizing or rule-based) econometric approaches
that describe the demand for transportation needs with rule-based descriptions of the supply
of transportation and the associated traffic.3 While the details of these models vary, the
endogenous routing choice oftentimes limits their applicability to a few stylized examples.
In addition, the only interaction of agents decisions is through transportation demand and
supply; other prices are explicitly taken as given so that the literature altogether avoids the
general equilibrium modeling. Relative to this literature, we embed a routing problem into
a spatial general equilibrium framework.
Third, there is a small (but growing) literature studying spatial policy in general equilibrium.4 Ossa (2014) and Ossa (2015) follow a computational approach to characterize optimal
tariff and tax policies in spatial frameworks, while Allen, Arkolakis, and Takahashi (2018)
and Allen, Arkolakis, and Li (2015) derive first order necessary conditions for the characterizations of the optimal investment in infrastructure. Fajgelbaum and Gaubert (2018)
characterize the optimal transfers across locations in a general equilibrium framework in the
presence of market failures due to agglomeration and congestion forces with many types of
labor. Relative this literature, we derive the analytical relationship of how equilibrium welfare responds to changes in bilateral trade frictions in the presence of market failures due to
agglomeration and dispersion forces and traffic congestion and show these relationships can
be expressed as functions of observables (e.g. trade flows).
Most closely related to this paper are two recent working papers, each of which evaluformula provides an upper bound of consumer gains from price improvement.
3
See for example Chapter 10 on De Palma, Lindsey, Quinet, and Vickerman (2011) for a review and
De Palma, Kilani, and Lindsey (2005) and Eluru, Pinjari, Guo, Sener, Srinivasan, Copperman, and Bhat
(2008) for realistic large-scale micro-econometric models of urban systems with traffic.
4
There is also an expanding literature evaluating infrastructure investment using credible instrumental
variables variation, see for example Baum-Snow (2007), Michaels (2008), and Duranton and Turner (2011,
2012).

5

ates optimal infrastructure policy in general equilibrium with rich geographies. Alder et al.
(2014) use a general equilibrium spatial model similar to the one we employ and applies
a heuristic algorithm to derive an approximation to the global optimal transportation network. Fajgelbaum and Schaal (2016) consider a spatial equilibrium model with externalities
whereby they assume traffic congestion with associated optimal Pigouvian taxes that turn
the equilibrium to an efficient one and the optimization problem to a convex optimization
problem. We make two contributions relative to these papers: first, we derive an analytical
relationship between the infrastructure network and the resulting iceberg trade costs from
the optimal routing problem, resulting in a tractable method incorporating traffic congestion into a quantitative general equilibrium gravity framework; second, we derive analytical
expressions for how welfare responds to (small) infrastructure improvements in the competitive equilibrium in the presence of market failures. However, unlike both these papers, we
consider small improvements to existing infrastructure networks rather than solving for the
globally optimal transportation network.
The remainder of the paper proceeds as follows. The next section presents the routing
framework for the endogenous transportation costs and derives a number of key properties.
Section 3 embeds this routing framework into a spatial economic model and derives the
elasticity of aggregate welfare in the presence of agglomeration, dispersion, and congestion
externalities. Section 4 uses the framework to evaluate the welfare impact of improving each
segment of the U.S. highway network. Section 5 concludes.

2

Endogenous transportation costs

In this section, we describe how to calculate the transportation costs between any two locations, accounting for the fact that agents endogenously choose the least cost route between
locations.

2.1

Setup

Consider a world composed of a finite number of locations i ∈ {1, ..., N }. These locations are
organized on a weighted graph with an associated infrastructure matrix T = [tij ≥ 1], where
tij indicates the iceberg trade cost incurred from moving directly from i to j (if i and j are
not directly connected in the graph, then tij = ∞). The top left panel of Figure 1 provides
an example of such a network, where N = 25 and locations are arrayed in a two-dimensional
grid, with locations that are directly connected (i.e. tij is finite) if they are adjacent and not
connected (i.e. tij is infinite) otherwise.

6

Trade between i and j is undertaken by a continuum of traders ν ∈ [0, 1] who travel along
(endogenously chosen) paths to get from i to j. A path p between i and j is a sequence of
locations beginning with location i and ending with location j {i = p0 , p1 , ..., pK = j}, where
K is the length of path p.5 The aggregate trade cost from i to j on a path p of length K,
τ̃ij (p), is the product of the instantaneous trade costs along the path:
τ̃ij (p) =

K
Y

tpk−1 ,pk

(1)

k=1

Each trader also incurs a path-specific idiosyncratic trade cost shock εij (p, ν), so the total
cost to trader ν of traveling along path p between i and j is τ̃ij (p) εij (p, ν). Let τij (ν)
indicate the cost trader ν incurs optimally choosing the path between i and j to minimize
the iceberg trade costs incurred:
τij (ν) =

min

p∈PK ,K≥0

τ̃ij (p) εij (p, ν) .

The trade cost between locations i and j is expected trade cost τij from i to j across all
traders as:
τij ≡ Eν [τij (ν)] .
(2)
Notice that in the limit case of no heterogeneity all traders choose the route with the
minimum deterministic trade cost, a case that is typically solved in the routing choice literature with the use of the Dijkstra algorithm (see e.g. Donaldson (2012)). The introduction
of trader heterogeneity allows us to “convexify” the problem, which we will see – under appropriate assumptions on the idiosyncratic term – results in a tractable analytical solution.
Our baseline heterogeneous traders formulation instead departs from the tradition of the
deterministic routing choice algorithms and bears resemblance to stochastic path-assignment
methods used in transportation and computer science literature. As pointed out by Prato
(2009) a common characteristic of those stochastic methods is that all solutions are heuristic.
Even with heterogeneity most of those methods require the implementation of a minimum
cost algorithm in advance (a la Dijkstra) in order to a-priori exclude a number of possible
paths (e.g. by setting a cutoff of distance or maximum links away from the minimum cost
one).
While, of course, we could follow either of these traditions we instead choose to consider
all the possible paths and derive precise analytical formulas for the key routing choices,
5

Following the literature on graph theory, we assume that tii = ∞ to exclude paths that stay in the same
location; however, we allow traders shipping goods from i to i to choose the “null” path where they travel
nowhere and incur no trade costs (which is the only admissible path of length 0).

7

which substantially reduces the computational burden and at the same time allows to convexify the problem. 6 This choice of modeling of the routing problem, constitutes the first
computational advantage of our approach and it is twofold: First, it allows us to reduce a
problem of large computational complexity (at least polynomial as Dijkstra typically needs
to be implemented) to a problem where analytical solutions and immediate implementation
is admissible.7 Second, these analytical solutions can be exploited for the characterization
of the traffic problem as we discuss below.
Our first object of interest is the elasticity of the trade cost to changes in infrastructure
links in the graph. Given trader’s optimal route choice, an application of the envelope
theorem immediately results in the following proposition:
Proposition 1. The elasticity of trade costs between i and j to a change in the infrastructure
link kl is:
∂ ln τij
= πijkl ,
∂ ln tkl

(3)

where πijkl is the fraction of trade costs incurred from i to j on paths through link k,l.
Proof. See Appendix 6.1.
This expression implies that the elasticity of expected trade costs to investment in infrastructure is given by the share of trade costs spent in link k, l while traveling from i to
j. While intuitive, it gives little chance to empirically assess these elasticities as it requires
precise traffic flow measurements that document the precise path followed by each trip along
with the associated costs incurred along each segment. While access to traffic data is widely
available, these data typically reports the volume of traffic along a certain link without information on the origin and destination of each trip. Since our objective is to operationalize
traffic flows and other information on transportation infrastructure that will allow us to
measure the impact of infrastructure investment on trade costs, we proceed by parameterizing the distribution of path-specific idiosyncratic trade cost shock. We do so so that we
6

We should note that the concept of heterogeneous traders formulation has been utilized previously by
Allen and Atkin (2015). However, their formulation does not consider the optimal route taken, as the the
random trader shocks are realized on the expected cost matrix instead of the infrastructure matrix. The
work of Bell (1995) on the other hand is the closer in the routing literature to our approach in that it
considers all the paths to compute the minimum routing choice problem. This method is still heuristic, in
that distributional assumptions are not made, and thus an analytical characterization is not obtained.
7
In our case, by taking the logarithm of the above minimization problem, the program can be also expressed as a linear programming problem. This formulation allows the implementation of linear programming
path-finding algorithms, such as the widely used A* algorithm that focuses on likely paths. These algorithms
can reduce the number of computations but nevertheless use heuristics to guide the search while still requiring the implementation of the Dijkstra method, resulting in relatively small computational gains (see for
example Zeng and Church (2009)).

8

relate to a voluminous literature in spatial economics and also include the shortest path case
analyzed by a Dijkstra as a limit case. For this, we view our formulation as relaxing the
previous literature’s focus on the least cost route in order to better understand the impact
of changes in the investment matrix on realized trade costs.

2.2

Analytical Characterization of Optimal routes

To derive an empirically implementable measure of the elasticity of trade costs to infrastructure investment in what follows, we assume that εij (p, ν) is Frechet distributed with
shape parameter θ > 0. The extent to which traders differ in which path they choose is now
determined by the shape parameter θ. In a sense, the parameter θ can be considered as capturing the possibility of mistakes and randomness in the choice of routes, with higher values
indicating greater agreement across traders. In the limit case of no heterogeneity, θ → ∞,
all traders choose the route with the minimum aggregate trade cost. The previous literature
in economics has focused exclusively on this limiting case and relied upon computational
methods to calculate this least cost route (i.e. using the Dijkstra algorithm as in Donaldson
(2012) and Donaldson and Hornbeck (2016) or the Fast Marching Method as in Allen and
Arkolakis (2014)).
Let Pij,K denote the set of all paths of length K that go from i to j. In our formulation
we allow traders to choose any possible path to ship a good from i to j – including the most
meandering of routes.8 Using the familiar derivations discussed in Eaton and Kortum (2002)
we can express the expected trade cost τij from i to j across all traders as:

τij ≡ Eν [τij (ν)] = c

∞ X
X

!− θ1
τ̃ij (p)

−θ

,

(4)

K=0 p∈PK

where c ≡ Γ

θ−1
θ



. Substituting equation (1) into equation (4) yields:
τij−θ

=c

−θ

∞ X Y
K
X

t−θ
pk−1 ,pk .

K=0 p∈PK k=1



In what follows, it is useful to characterize the weighted adjacency matrix A = aij ≡ t−θ
ij .
Note that aij ∈ [0, 1], where 0 indicates there is no connection between i and j, aij = 1
indicates a cost-less connection, and aij ∈ (0, 1) indicates a costly connection. By summing
over all paths of length K, we can write the expected trade cost in a more convenient form
8

Reassuringly, in the estimation results below, we find that traders are quite homogeneous so that the
probability of taking any route that is not very close to optimal is exceedingly small.

9

by explicitly summing across all locations that are traveled to first, second, etc. as follows:
τij−θ = c−θ

∞
X



N X
N
X


K=0

k1 =1 k2 =1

...



N
X

ai,k1 × ak1 ,k2 × ... × akK−2 ,kK−1 × akK−1 ,j  ,

kK−1 =1

where kn is the sub-index for the nth location arrived at on a particular path. This portion of
the expression in the parentheses, however, is equivalent to the (i, j) element of the weighted
adjacency matrix to the power K, i.e.:
τij−θ

=c

∞
X

−θ

AK
ij ,

K=0

 
9
K
where AK = AK
ij , i.e. Aij is the (i, j) element of the matrix A to the matrix power K.
Furthermore, as long as the spectral radius of A is less than one, the geometric sum can
be expressed as:10
∞
X
AK = (I − A)−1 ≡ B,
K=0

where we call B = [bij ] the route cost matrix (which is simply the Leontief inverse of the
weighted adjacency matrix). Finally, the expected trade cost from i to j can be written as
a simple function of the route cost matrix:
−1

τij = cbij θ .

(5)

Equation (5) provides an analytical relationship between any given infrastructure network
and the resulting bilateral trade cost between all locations, accounting for traders choosing
the least cost route.

2.3

Properties of the routing problem solution

In this subsection, we characterize key properties of the endogenous trade cost framework.
We first characterize the elasticity of expected trade costs from location i to location j to an
improvement in link tkl :
9

Note that we could truncate the summation up to some finite K to restrict consideration to only paths
that are not “too” long. It turns out that by allowing for all possible K admits a more convenient analytical
solution. As we will see below, the inclusion of longer routes turns out not to be quantitatively important,
as all traders end up taking routes that are optimal or very nearly so.
P
10
A sufficient condition for the spectral radius being less than one is if j t−θ
ij < 1 for all i. This will
necessarily be the case if either trade costs between connected locations are sufficiently large, the adjacency
matrix is sufficiently sparse (i.e. many locations are not directly connected), or the heterogeneity across
traders is sufficiently small (i.e. θ is sufficiently large).

10

Proposition 2. Assume that trader shocks are Frechet distributed with parameter θ. Then
the elasticity of expected trade costs to an improvement in link kl can be expressed as:

bik akl blj
∂ ln τij
=
=
∂ ln tkl
bij
Moreover,

∂ ln τij
∂ ln tkl



τij
c
τik tkl τlj

θ
.

(6)

is also the probability a trader going from i to j uses link kl.

Proof. See Appendix 6.2.
Equation (6) is intuitive: the numerator on the right hand side is the expected trade cost
on the least cost route from i to j, whereas the denominator is the expected trade cost on
the least cost route from i to j through the transportation link kl. Hence, the more costly it
is to travel through the link kl relative to the unconstrained least cost route, the smaller the
effect an improvement in tkl has on the reduction of trade costs between i and j and the less
likely a trader is to use the link kl. Of course, because of proposition 1, both the elasticity
of expected trade costs to the transportation link kl and the probability of using link kl on
the way from i to j are equal to the fraction of costs incurred along the link, i.e.:
∂ ln τij
= πijkl .
∂ ln tkl

(7)

Hence, the more “out of the way” the transportation link kl is from the optimal path between
i and j, the less frequently that path is used, and the smaller the effect an improvement in
tkl has on the reduction of trade costs between i and j.
As an example, consider the network of locations presented in Figure 1. If we assume
that all connected locations have the same direct cost tij , then the top right panel depicts
the probability that an agent going from i = 1 (bottom left) to j = 25 (top left) travels
over each connection. As is evident, connections along the direct diagonal route are chosen
much more often than other routes, and connections near the diagonal route are chosen more
often than those further away. As an additional example, the bottom left panel depicts the
probability for agents going from i = 1 (bottom left) to j = 15 (top center). In this case,
there are four different paths that share the same least deterministic costs. As is evident,
traders are much more likely to use links on these routes than other links. However, there is
also heterogeneity in the probability traveled across these different links – for example, the
connection from 1 to 7 is traveled more often than the connection from 2 to 8. This occurs
because there are many more possible paths going from 1 to 15 that use the 1 to 7 link than

11

that use the 2 to 8 link, so each trader is more likely to get an idiosyncratic draw that causes
her to choose a path using the former link.

3

The welfare impact of transportation infrastructure
improvements

We now introduce an general equilibrium spatial economic framework with agglomeration
and dispersion economies. Using this framework we present a new characterization of how
a change in any bilateral trade cost affects the endogenous aggregate welfare. We then
combine this result with the optimal routing framework presented in Section 2 in order to
characterize the welfare effect of changing the transportation infrastructure. Finally, we show
how to extend the framework to allow for traffic congestion, which creates a feedback loop
between the optimal routing and economic frameworks.

3.1

A general equilibrium economic geography model

We assume that the world is inhabited by an exogenous measure L̄ of agents and by the
locations as described in the previous section. On the consumption side, agents have constant
elasticity of substitution (CES) with elasticity of substitution σ preferences over differentiated
varieties produced in each location. To purchase goods, workers are randomly matched with
traders and hence face trade costs equal to the expected trade costs τij above. With CES
preferences of consumers, the value of goods shipped from location i to location j can be
written as:
σ−1
Xij = p1−σ
Ej ,
(8)
ij Pj
P
where Pj = i p1−σ
is the ideal Dixit-Stiglitz price index and Ej is the total expenditure of
ij
agents in location j. The welfare of the agents is given by
W j = Cj × uj
where Cj is the CES aggregate consumption bundle in location j and uj is the amenity of
the location.
On the production side firms produce differentiated varieties in each location under perfect competition with a constant returns to scale technology that uses labor with productivity
Ai . The workers in location i are compensated with a wage wi . Given these assumptions,

12

the price for a unit of a good from i for a consumer in location j is
pij = τij

wi
.
Ai

Substituted in expression (8) and using the fact that the only income is labor income, we
obtain the standard gravity equation for bilateral flows,


wi 1−σ σ−1
Xij = τij
Pj wj Lj .
Ai

(9)

Finally, we assume, following a large literature in economic geography, that productivities
and amenities are subject to spillovers. In particular, following Allen and Arkolakis (2014),
we let Ai = Āi Lαi , and ui = ūi Lβi whereby Āi , ūi > 0. This specification allows for sufficient
flexibility in modeling the externalities in production and amenities, while representing a
broad range of explanations. Although not a specific requirement we will constraint ourselves
to intuitive parametric regions whereby the agglomeration forces are positive and dispersion
forces are negative, α ≥ 0 ≥ β and σ > 1.
To close the model we assume that the following equilibrium conditions hold:
1. Total income Yi is equal to total sales:
N
X

Yi =

Xij .

(10)

j=1

2. Total expenditure Ei is equal to total purchases:
Ei =

N
X

Xji .

(11)

j=1

3. Trade balance
w j L j = Y i = Ei .

(12)

Given trade balance, the welfare of a worker is given by Wi ≡ wPii ui . Using this expression
to substitute out for the price index and the third equilibrium to substitute for Ej , we can
rewrite equation (8) for the value of bilateral trade as follows:

Xij =

τij
Ai uj

1−σ

wi1−σ Wj1−σ wjσ Lj .

(13)

Substituting the gravity equation (13) and the equilibrium condition (12) into equilibrium
13

conditions (10) and (11) yields the following system of equilibrium conditions that along
P
with a normalization and the labor adding up constraint, i Li = L̄ determines wages and
population in all locations along with the aggregate welfare W .
In the economic geography framework, the imposition of welfare equalization results in
the following system of equilibrium equations:

X  τij 1−σ
wi Li = W
wi1−σ wjσ Lj
Ai uj
j
1−σ
N 
X
τji
1−σ
wj1−σ wiσ Li .
wi Li = W
A
u
j i
j=1
1−σ

(14)

(15)

which can be solved for the equilibrium distribution of wages and population, along with the
P
equilibrium welfare W . We normalize world income, Y W = j wj Lj = 1.
In what follows, we use the system of equilibrium conditions above to derive how changes
in transportation infrastructure affects the equilibrium welfare of agents. As an intermediate
step, we first derive the welfare effects of a changes in a particular (endogenous) trade cost.

3.2

Elasticity of welfare to changes in trade costs

We now examine how a change in bilateral trade costs affects the aggregate welfare. To do
so, we consider a perturbation of the trade costs around the initial equilibrium. To build
intuition we start with the baseline case of no externalities, α, β = 0. In the absence of such
externalities across markets, the equilibrium is efficient so an application of the envelope
theorem to the corresponding planner’s problem yields:
∂ ln W
= Xij .
∂ ln τij
Rearranging this formula and expressing it in differentials we obtain
∆W
pij Xij ∆τij
∆τij
=
=
Xij =⇒
W
W
τij Y
pij
τij
and thus

∆W
|W
{z }

social savings

=

∆τij
pij
× Xij /pij
| {z }
τij
| {z }
initial quantity

change in price

14

(16)

In our general equilibrium setup the result is intuitive as in the equilibrium more workers
and more economic activity accumulate in routes with more trade and trade costs reductions
proportionately apply to all of them.
This result implies that the impact of infrastructure investment can be summarized by
the percentage cost savings offered by the investment multiplied by the volumes of initial
trade. Notably, the formula for welfare gains is the same as the formula for the calculation
of ’Social Savings’ introduced by Fogel (1962, 1964) based on heuristic derivations.11
Nevertheless, the case of externalities, α, β 6= 0, is much more intricate. This is because
the competitive equilibrium is no longer efficient and so there is no corresponding planner’s
problem upon with the envelope theorem can be applied. Instead, we proceed by perturbing
the system (14) and (15).12 The following theorem characterize the welfare gains in the
general case:
Theorem 1. The welfare gains from an improvement in a link are given by
d ln W
= Xkl (1 + κk + νl )
d ln τkl

(17)

where κk ,νk for k = 1, .., N are given by

1 + κk = (β + α)

νk = (β + α)

σ−1
γ2

σ−1
γ2

X
i

X
i

Li
L̄

Li
L̄



(DG)−1
ik,22


(DG)−1
ik,12 +

σ
+
(DG)−1
y,ik,21
σ−1
σ
(DG)−1
ik,11
σ−1





1
Yk

(18)

1
,
Ek

(19)

we normalize νN = 0, and (DG)−1
ik,mn are the i, k elements of the m, n submatrix of the inverse
of
"
# "
#
σ(α+β)
1+α
I
µ
−
I
0
0
γ2
γ2
DG =
−
(σ−1)(α+β)
1−β
0
I
λ1N ... λN −1,N λN N + αβ 0
λ − γ2 I
γ2
h

Xij
Ej

i

where γ2 ≡ 1 + ασ + β (σ − 1), λ ≡
is the matrix of import shares and µ ≡
the matrix of export shares. Note that κk , νk → 0 as α, β → 0.
11

h

Xij
Yi

i

is

This formula can be derived as an upper bound of the equivalent variation for the gains from infrastructure improvement in partial equilibrium (see e.g. Crafts (2004)). As aggregate demand and aggregate supply
respond to prices, the full general equilibrium derivation in our context yields the original Fogel formula.
12
A perturbation of the system with α, β = 0 under symmetry, τij = τji , yields an one-equation linear
system. The perturbation of this system yields the formula 16, a familiar result in Matrix Perturbation
theory. Since our system is a multi-equation and highly non-linear an analytical derivation for the general
case was not previously available.

15

Proof. See Appendix 6.3.
This explicit characterization of welfare gains as a function of changes in expected trade
costs constitutes the second computational advantage of our approach. It allows us to measure the welfare benefits of transportation costs for small changes in trade costs, even in
the presence of externalities. With externalities, κk and νl are the economic distortions that
impact the welfare elasticity of trade costs. Notice that these distortions can be written
solely as a function of model parameters and the trade links across locations.What is the
interpretation of these distortions? To obtain intuition, consider the case of symmetric trade
costs, where there is a single distortion for each location, i.e. κk ∝ νk and we can write:
1 + κk = (ρ − 2)


N 
X
Li
i=1

L̄

(Dy G)−1
ik ,

2+α−β
, γ1 ≡ 1 − α (σ − 1) − σβ, andDy G = µ + (1 − ρ)I = µ − γγ12 I =
where ρ ≡ 1+(σ−1)β+ασ


γ1
I − γγ21 µ in the case of unique equilibrium α + β < 0. All in all, in we can express:
γ2

"
#
 2
 3
N
γ2
γ2
γ
σ − 1 X Li
2
(2)
(3)
1 + µik +
µik +
µik + ... ,
1 + κk = (β + α)
γ1 i=1 L̄
γ1
γ1
γ1
(n)

where µij is the i, j element of the nth power of the export matrix, which can be interpreted
as the impact of higher order network effects on the welfare distortion. If agglomeration forces
are equal to dispersion forces, i.e. α+β = 0, γ2 = γ1 and the weights of all ordered effects are
equalized. As net agglomeration forces (i.e. α+β) increase, however,γ2 /γ1 increases, meaning
that the market distortions depend more on higher order effects of spatial propagation.

3.3

Elasticity of welfare to transportation infrastructure improvements

In the absence of traffic congestion externalities, a simple application of the product rule
allows us to determine the elasticity of aggregate welfare to infrastructure improvements by
combining the elasticity of welfare to bilateral trade costs and the elasticity of bilateral trade
costs to infrastructure improvements:
N

N

X X d ln W
d ln τkl
d ln W
=
×
.
d ln tij
d
ln
τ
d
ln
t
kl
ij
k=1 l=1

16

(20)

Note that because traders are optimally choosing their routes, any change in the infrastructure link ij can potentially affect any bilateral trade flows kl, which is why we sum across
all kl pairs. From Proposition 1 and Theorem 1, this expression becomes:
N

N

XX
d ln W
ij
=
× (1 + κk + νl ) .
Xkl × πkl
d ln tij
k=1 l=1

(21)

There are two things to note about of equation (21). First, given model parameters, all
elements comprising the right hand size are in principle observable in the data, namely trade
flows, bilateral expenditures on each link, and populations. In the absence of spillovers (i.e.
P PN
ij
ln W
α, β = 0), we have κk = νl = 0 for all k and l, so that dd ln
= N
k=1
l=1 Xkl × πkl , i.e. the
tij
elasticity of aggregate welfare to an infrastructure improvement along link ij is equal simply
to the total value of goods being shipped over that link.
As an example, return to the two dimensional grid network considered in Figure 1 and
suppose all locations have identical productivities and amenities and labor is mobile. The
bottom right panel of Figure 1 depicts the elasticity of welfare to a change in each direct
connection. As is evident, reducing the cost of traveling over links in the center of the grid
have larger impacts on welfare than those in the periphery. Intuitively, this is for two reasons:
first, the connections in the center are more likely to be traveled than on the periphery (see
the bottom left panel of Figure 1) and hence will have larger effects on bilateral trade costs;
second, because they are more centrally located, locations in the center will have greater
populations and economic output, so that the trade flows flowing through the central links
will be larger on average. As a result, improvements to those links will have larger effects on
welfare.

3.4

Traffic and congestion

Up until this point, the optimal routing problem and the economic geography model could
be considered separately, as there is no interaction between the elasticity of trade costs to
infrastructure improvements and the elasticity of welfare to trade costs; this is why equation
(20) can be derived immediately from the product rule. In the presence of congestion,
however, this is no longer the case: if the amount of trade flowing over a link affects the cost
of trading along that link, then the impact of infrastructure improvements will depend in
part on how trade adjusts to the new infrastructure. For example, the “fundamental law of
road congestion” of Duranton and Turner (2011) suggests that infrastructure improvements
will result in negligible reductions in the cost of travel, as they will result in additional traffic

17

(trade) flowing on the network.13
It turns out that with several straightforward assumptions, the analytical framework
developed above can easily admit traffic congestion. As we will see, the introduction of
congestion creates a complex (but tractable) interplay between the optimal routing problem
and the general equilibrium economic framework. Moreover, incorporating congestion both
substantially improves the model’s ability to match observed traffic flows and has important
implications on which infrastructure improvements result in the greatest welfare gains.
To begin, as above we assume that trader shocks are Frechet distributed; under this
assumption, the value of goods flowing over each link has a convenient analytical solution.
Define the N × N traffic matrix Ξ whose ij th element is the value of the flow of goods over
P
PN
ij
link ij, i.e. Ξij = N
k=1
l=1 Xkl πkl . We then have the following Corollary:
Corollary 1. When trader shocks are Frechet distributed, the traffic matrix has the following
analytical representation:
Ξ = A B0 (X  B) B0 ,
(22)
where X is observed matrix of trade flows and the “ ” and “” indicate the Hadamard product
and division operators, respectively, i.e. element by element multiplication/division.
Note that this expression holds regardless of whether or not there is traffic congestion.
In addition to proving essential for incorporating congestion, it will also allow us to estimate
the parameters governing trade costs using readily observed traffic data when city-to-city
trade flows (and link specific expenditure shares) are unobserved.
Second, we assume that the trade cost incurred along the direct connection from i and j
is a function of the time it takes to travel from i to j, timeij :
tij = exp (κ × timeij ) ,

(23)

where c1 > 0 and timeij be the time (in hours) it takes to travel along link ij. The exponential
functional form has been used extensively in the economic geography literature, and has a
number of attractive properties including 1. traveling costs are always greater or equal to
one, i.e. tij ≥ 1; 2. Given expression (1), conditional on travel time, the number of locations
through which a trader passes does not affect the trade costs that trader incurs; and 3. the
effect of a reduction in travel time on the percentage change in welfare is proportional to the
ln W
∂ ln W
= κ ∂∂ ln
.
welfare elasticity to a change in the infrastructure cost, i.e. ∂time
tij
ij
13

Indeed, in the following framework it is possible to construct examples where an infrastructure improvement along one segment actually reduces aggregate welfare due to congestion externalities, reminiscent of
the famous Braess’ paradox, see e.g. Frank (1981).

18

Third, to incorporate congestion, we follow a popular specification suggested by Vickrey
(1967) by assuming that the time per unit distance (i.e. inverse speed) is related to the
traffic (per lane-mile) by the following function:
timeij
= δ0−1 + δ1
distij



Ξij
distij × lanesij

δ2
,

(24)

where δ0 is the unimpeded speed of traffic and δ1 and δ2 are parameters that govern the
strength of congestion; if δ1 > 0 and δ2 > 0, then it will take a greater amount of time to
travel a particular distance the greater the traffic Ξij . As we will see below, this functional
form fits the observed relationship between travel time and traffic remarkably well.
Combining these three assumptions with equation (5) yields the following expression for
the expected trade costs between any two locations:
"

τij1−σ

c1
= c I − exp − − c3
δ0



Ξij
distij × lanesij

δ2 !#!c2
,

(25)

, and c3 ≡ θ × κ × δ1 . Note that equation (25) implicitly defines
where c1 ≡ θ × κ, c2 ≡ σ−1
θ
the trade costs, as traffic Ξij depends in trade costs in all locations (see equation (22)).
Intuitively, traffic congestion creates a feedback loop, where greater traffic on one segment of
the infrastructure network increases the cost of traveling along that segment. The immediate
impact through the optimal routing problem is to divert traffic to other parts of the network,
thereby affecting costs elsewhere. However, the extent to which costs elsewhere are impacted
depends on the amount of traffic, which in turn depends on trade flows: this is the feedback
from the economic model to the routing model. However, by improving a portion of the
infrastructure network, the changes in costs will result in changes in equilibrium economic
activity and trade flows: this is the feedback from the routing model to the economic model.
Despite this feedback loop, we can still derive the welfare impact of an infrastructure
improvement. To do so, we apply the chain rule as follows:
N

N

N

N

X X X X d ln W
d ln τkl
d ln tij
d ln W
=
×
×
.
d ln lanesmn
d ln τkl
d ln tij
d ln lanesmn
i=1 j=1 k=1 l=1
An increase in the number of lanes on the infrastructure link between m and n will potentially
impact the congestion between i and j, thereby affecting the cost of traveling along the
link between i and j. However, once we have characterized these (complicated) congestion
spillovers, the rest of the calculation is reasonably straightforward: changes in costs along
links will impact expected trade costs between all locations, each of which will affect aggregate
19

welfare.
Applying the inverse function theorem to equation (24) yields the following expression
for the congestion externalities:

d ln tij
= A−1
d ln laneskl


ij,kl

× α2 c2 distkl

where A is an N 2 × N 2 matrix with elements:

Aij,kl = 1k=i,l=j − α2 c2 distij ×

Ξkl (t)
distkl × laneskl

Ξij (t)
distij × lanesij

α2

α2

d ln Ξij (t)
d ln tkl

and
N
N
ij
Xmn πmn
d ln Ξij (t) X X
=
PN PN
ij
d ln tkl
k=1
l=1 Xkl πkl
m=1 n=1

X d ln Xmn
k 0 l0

d ln τk0 l0

!

kl

kl
kl
πkkl0 l0 + θ πmn
− πmi
− πjn − θ × 1i=k,j=l

While complicated, note that the expression depends only on model parameters and observables (e.g. trade flows).14

4

The welfare effects of improving the U.S. National
Highway System

We now use our framework to evaluate the welfare impacts of improving the U.S. National
Highway System. The U.S. National Highway System is a network of strategic highways
within the United States, including the Interstate Highway System and other roads serving
major transport facilities and it constitutes the largest highway system in the world. The
main backbone of the National Highway System, the Interstate Highway System, is one
of the world’s largest infrastructure megaprojects in history (Kaszynski, 2000). It took
more than thirty five years to construct at an estimated cost $560 billion (in 2007 dollars),
and total annual maintenance costs are approximately $130 billion (CBO, 1982; FHA, 2008;
NSTIFC, 2009). However, little is known about the relative importance of different segments
of the highway system in terms of how each affects the welfare of the U.S. population. Such
knowledge is crucial for appropriately targeting future infrastructure investments.
14

We refer the interested reader to Allen, Arkolakis, and Takahashi (2018) for the analytical expression
Xmn
for dd ln
ln τk0 l0 , which itself depends only on observed trade flows, the trade elasticity, and the strength of
agglomeration and dispersion forces.

20

.

4.1

Data

Data on the length, location, number of lanes, and average annual daily traffic (AADT) of all
1,029,142 segments of the highway system in the continental United States comes from the
National Highway Planning Network data-set published by the Federal Highway Association
(FHA, 2015), which itself is a compilation of geo-coded datasets from each state’s department
of transportation. We combine this data set with the location, population, and medianincome of all U.S. cities located within 10 kilometers from the continental U.S. highway
network with a population of at least 50,000 people from Edwards (2017); these 893 cities
comprise 140 million people, slightly less than half of the total continental U.S. population.
The top panel of Figure 2 depicts the highway network and the location of all 893 cities,
where the size of the city indicates its population (larger dots indicate greater population)
and the color of the highway segment indicates the amount of traffic (blue indicates little
traffic, red indicates large amounts of traffic).
To construct the adjacency matrix of the highway network, we use the Network Analyst
Toolbox in ArcGIS to calculate the shortest route along the highway network from each
U.S. city to each of its 25 nearest neighbors; as long as that route does not pass through
the center of another city, we identify those two cities as adjacent.15 In total, we identify
6,924 links in the adjacency matrix. For each link, we calculate the average AADT, average
number of lanes, and total distance across all segments along the shortest route between the
cities. Note that this procedure does not impose symmetry and allows for the traffic and
number of lanes to differ depending on the direction traveled. The bottom panel of Figure 2
depicts the resulting adjacency matrix between all 893 cities, where color of the links indicate
the average amount of traffic over the link (blue indicates little traffic, red indicates large
amounts of traffic). For each link, we recover the time of travel from the HERE API using
the georoute Stata command by Weber and Péclat (2017).
Finally, to compare the benefits of improving each link of the U.S. highway system to
the cost of doing so, we estimate the cost of improving each link by its local topography.
In particular, we classify every point in the continental U.S. as belonging to one of four
categories: urban, rural-flat (with a slope of less than 5%), rural-rolling (with a slope between
5% and 15%), and rural-mountainous (with a slope greater than 15%). From Exhibit A-1 of
(FHA), the construction cost per lane-mile is $5.598 million in urban areas, $6.492 million in
rural-mountainous areas, $2.085 million in rural-rolling areas, and $1.923 million in rural flat15

The choice of 25 nearest neighbors was made to balance Type I and Type II error; ensuring that nearly
all nearby cities were connected without identifying as adjacent city pairs whose shortest route skirt around
cities in between. However, the discernible reader will note that the resulting adjacency matrix does not
perfectly reflect the actual U.S. highway network; such small errors are unavoidable in any easily replicable
process that constructs an adjacency matrix from a road network with many nodes and edges.

21

areas. For every link, we calculate the average per lane-mile cost by weighting each of these
four categories by the percentage of the link traveling over that category. Finally, assuming
a (linear) 20 year depreciation (as in Appendix C of Office of the State Auditor (2002)) and
a 5% cost of capital, the construction cost is also equal to the annualized construction plus
maintenance cost of constructing ten lane-miles along each link. Panel A of Figure 7 depicts
this estimated cost, overlaid against the raster identifying the classification of each point of
land; as is evident, construction costs are highest in urban segments and on longer stretches
near the Rocky Mountains.

4.2

Estimation

To estimate the welfare impact of improving the U.S. highway system, we need to have
values for the trader shape parameter θ, the parameter mapping travel time to trade cost
κ, the congestion parameters {δ0 , δ1 , δ2 }, the trade elasticity σ − 1, and the strength of
productivity and amenity externalities, α and β. While there exists a substantial trade
and economic geography literature estimating the trade elasticity and the productivity and
amenity externalities (upon which we will rely), we will estimate the remaining parameters.
One limitation of using such a detailed representation of the U.S. Highway network between all U.S. cities with more than 50,000 people is that bilateral trade flows between these
cities are unobserved. However, traffic flowing along each link of the highway is readily
observed. The basic idea of our estimation procedure is to find parameters such that the
model predicted value of trade flowing over each segment of the highway network most closely
matches the observed traffic on that segment. In order to do so, we assume that the observed
traffic over a particular link (measured in vehicles) is proportional to the underlying value
of trade on that link:
Ξij = λ × traf f icij ,
where λ > 0. This assumption – while strong – is perhaps weaker than it first appears.
For example, one might think that this assumption is violated if a greater fraction of traffic
within cities is due to commuting rather than the movement of goods. However, we can
interpret the act of commuting as a trade from the locations of a worker’s residence to her
workplace, as the model is silent about whether a worker trades her labor directly or just the
good she produced with her labor.16 Similarly, the act of an individual driving to a store to
go shopping can be interpreted as trade flowing from the location of the store to the worker’s
16
Adao, Costinot, and Donaldson (2017) discuss formally an equivalence of an exchange economy to a
Ricardian production economy. Our model features externalities and the formal equivalence of our exchange
economy with agglomeration and dispersion effects to a Ricardian production economy with externalities is
discussed in Adao, Arkolakis, and Esposito (2017).

22

residence. We verify below the validity of our assumption by comparing the predicted trade
flows of our model (estimated using traffic flows) to actual commodity trade flows from the
Commodity Flow Survey.
Given this assumption, we first estimate the congestion parameters using observed travel
times and traffic flows. Assume that unimpeded traffic can travel seventy miles per hour over
each link of the U.S. highway system, i.e. δ0 = 70. Rearranging equation (24) then yields:

log

1
timeij
−
distij
70


= ln δ1 λ

δ2




+ δ2 log

traf f icij
distij × lanesij


,

(26)

where traf f icij is the observed average annual daily traffic along each link. Figure 3 shows
that this log-linear relationship in equation (26) fits the observed relationship between speed
of travel and traffic exceedingly well: a local polynomial non-parametric regression is very
close to the assumed log-linear relationship, with an estimated δ2 = 0.4415 (and a t-statistic
of 119).
With an estimated δ2 , we now turn to estimating the three (composite) parameters :
, and c3 ≡ θ × κ × δ1 which, together with the traffic matrix Ξ, allow us
c1 ≡ θ × κ, c2 ≡ σ−1
θ

to estimate the bilateral trade costs τij1−σ using equation (25).
For intuition in how the procedure works, consider first the case where c3 = 0 so that
there is no congestion and equation (25) offers an explicit equation for bilateral trade costs
 1−σ

τij
. Given the observed income Yi in each city i ∈ {1, ..., N }, and a matrix for τij1−σ ,
it is straightforward to show using the results of Allen, Arkolakis, and Li (2014) there exists
a unique set of prices, pi = wi /Ai , (to-scale) in each location that ensures markets clear and
trade is balanced, i.e. equations (10), (11), and (12) hold, given (9). As a result, there exists
a unique set of trade flows {Xij } (normalized so that world income is equal to one) consistent
with observed incomes {Yi }, market clearing conditions, and the trader optimization. Finally,
from equation (22), this implies that there exists a unique traffic matrix of goods flows; write
this traffic matrix as Ξ ({c1 , c2 } ; {distkl } , {laneskl } , {Yk }). Note that Ξ does not depend
on the chosen values of the trade elasticity or the agglomeration forces α and β, as these
parameters do not affect the recovery of the bilateral trade flows given observed incomes and

the trade cost matrix τij1−σ . This discussion proves the following Proposition:
Proposition 3. Assume that c3 = 0. Then for any given pair {c1 , c2 } and for given observed
data on incomes {Yi }, distance {distkl }, and lanes {laneskl }, there is a unique traffic matrix
that rationalizes those observed data.
When there is congestion – i.e. c3 6= 0 – the same argument can be made above given
any initial guess for traffic Ξ(0) , i.e. there exists a unique traffic matrix that rationalizes the
23

observed data given that initial guess. This allows us to iterate on the procedure to find a
fixed point where the equilibrium traffic is consistent with the (implicit) function equation
(25), the equilibrium conditions, and observed income, distance, and lanes:


Ξ ({c1 , c2 , c3 } ; {distkl } , {laneskl } , {Yk }) = lim Ξ(k+1) {c1 , c2 , c3 } ; {distkl } , {laneskl } , {Yk } ; Ξ(k) ,
k→∞

where we refer to each element as Ξij ({c1 , c2 , c3 }) for brevity.17 We can then estimate c1 ,c2 ,
and c3 using our assumption that observed traffic flows are proportional to model predicted
value of trade traveling along a link by minimizing the difference between the observed and
predicted traffic, where both are logged and de-meaned to difference out the unknown scalar
λ:

2
X
∗ ∗ ∗
˜
{c1 , c2 , c3 } = arg min
ln Ξ̃ij ({c1 , c2 , c3 }) − ln traf f icij
,
c1 ,c2 ,c3

i,j

where the tildes indicate that each has been de-meaned by its sample means.
Figure 4 presents the results of the estimation procedure. In the top panel, we constrain
c3 = 0 (i.e. there is no congestion). Even without congestion, the model predicted traffic
flows correlate strongly with observed traffic flows (a correlation of 0.48). Our estimates
are c∗1 = 16.6 and c∗2 = 0.0394. With a trade elasticity of eight (i.e. σ = 9) as in (Allen
and Arkolakis, 2014), this implies θ = 203 and κ = 0.08, indicating very little heterogeneity
across traders (i.e. most traders take the shortest route when traveling). As an illustration,
Figure 6 depicts the probability a trader traveling from Seattle, WA to Manhattan borough
in New York, NY uses each link; as is evident, all links except for those on the shortest (or
nearly shortest) route have virtually zero probability of being used. A κ = 0.08 implies that
a one hour travel time incurs an ad-valorem equivalent trade cost of 8% (or a 4 hour trip
from New York, NY to Washington D.C. an ad valorem equivalent trade cost of 37%).
In the bottom panel of Figure 4, we allow for congestion. While the estimates of c∗1 and
c∗2 did not change much (c∗1 = 11.9 and c∗2 = 0.0455, implying θ = 175.8 and κ = 0.07 with a
trade elasticity of eight), the data strongly reject no congestion, with c∗3 = 103. Moreover, the
introduction of congestion substantially improves the fit of the model, reducing the distance
between observed and predicted trade flows by more than 30% and improving the correlation
between observed and predicted trade flows to 0.56. In what follows, we use the estimates
with congestion as our preferred estimates.
As mentioned above, an advantage of our estimation approach is that it relies on readily
available traffic data rather than difficult to obtain bilateral trade data between the 893
U.S. cities in our sample. Indeed, a by-product of our estimation procedure is the full
17

In practice, the fixed point is found after very few iterations.

24

matrix of estimated city-to-city level bilateral trade flows.18 As a final test of our estimation
procedure, we aggregate these city-to-city predicted trade flows up to the state-to-state level
and compare them to the publicly available 2012 Commodity Flow Survey (CFS) data (CFS,
2012). Note that these bilateral commodity trade flows were not used as inputs or otherwise
targeted in our estimation procedure. Figure 5 shows that the model’s predicted trade flows
match well with the flows reported in the CFS, with a correlation (in logs) of intra-state
trade flows 0.73 and a correlation (in logs) of inter-state trade flows of 0.47 (the correlations
in levels are even higher).19

4.3

The welfare effects of improving the U.S. National Highway
System

Finally, we estimate the welfare effects of improving the U.S. National Highway System. To
do so, for each link, we calculate the percentage increase in aggregate welfare from adding ten
additional lane-miles. We then convert this percentage welfare increase to a dollar amount
using a compensating variation approach, i.e. how much would the the annual U.S. real
GDP have to increase (in millions of chained 2012 U.S. dollars) holding prices constant to
achieve the same welfare increase we estimate.
Note that the direct impact of adding additional lane-miles is to speed up travel by
reducing congestion on a particular link (see equation (24)), thereby reducing trade costs on
that link (see equation (24)). This reduction in congestion will result in traders endogenously
altering which route they choose to get from an origin to a destination; moreover, by changing
prices, wages, and where people reside, the amount of trade between each pair of locations
will also change. The results that follow incorporates the entirety of this complex feedback
process.
The bottom panel of Figure 7 depicts the welfare gains of adding ten additional lane-miles
to each highway segment in the U.S., assuming an elasticity of substitution, σ, of nine, a
productivity spillover α = 0.1, and a amenity spillover β = −0.3. As is evident, the gains
are both large and heterogeneous. Adding 10 lane-miles to any of the bottom bottom half
of highway segments would result in welfare gains equivalent to $10.2 - $12.2 million a year.
Benefits for the third quartile range from $12.2 million to $19 million. However, the best
quartile of links, the estimated welfare impacts are much much larger, exceeding $500 million
18

This dataset is available for download on Allen’s website.
This strong correlation is not only driven by the predicted trade flows matching the observed city level
incomes: the partial R2 of a regression of observed (log) state-to-state trade flows from the CFS on the
model predicted (log) state-to-state trade flows with origin-state and destination-state fixed effects is 0.49,
indicating that the model captures roughly half of the residual variation in observed bilateral trade flows
even after conditioning on total exports from each origin and total imports from each destination.
19

25

annually in two cases in the New York City metropolitan area.20
For all highway links, the benefits of adding additional lane-miles substantially exceed
the annualized costs of construction, which we estimate are between $1.9 and $5.6 million
per year, depending on the local topography (see panel A). Where is the biggest bang for
the buck? Figure 9 depicts the estimated rate of return for each link, measured as the log
ratio of annualized benefit to annualized cost. Several patterns emerge. Given the large
estimated welfare impacts for within greater metropolitan areas, these links also have the
highest rates of return. For longer routes, however, the benefits are the largest if there are
not many alternative routes or if the link connects major economic centers; for example,
the gains of adding additional lanes to highway segments in Indiana are in the top decile of
rates of returns (therefore justifying its slogan “the cross roads of America”). Consistent with
these patterns, Table 1 list the ten highway segments with the greatest returns of investment:
seven of the top 10 are in the New York City area, one is in the Los Angeles area, and two
are in Indiana.
How does incorporating externalities and traffic congestion affect our estimates of how to
best improve existing infrastructure? The top panel of Figure 8 takes our estimated parameters without congestion and compares the welfare elasticities of infrastructure improvements
with and without externalities; the extremely high correlation indicates that including externalities without congestion does not substantially impact which highway links have the
greatest welfare impact. The bottom panel of Figure 8 compares the welfare impacts with
and without congestion (in both cases allowing for externalities). While there is a clear positive relationship in the estimates, there is also substantial disagreement on which links are
most important. Hence, incorporating congestion not only improves the model fit as we saw
above, it also has important implications on how to best target infrastructure improvements.

5

Conclusion

We have presented a tractable approach that combines elements of graph theory with general equilibrium spatial analysis to tackle three main challenges of evaluating infrastructure
investment: the characterization of the routing problem of how infrastructure investment
between any two locations affects the trade cost between all locations, the derivation of the
elasticity of equilibrium welfare with respect to changes in trade costs, and the analytical
characterizations of traffic congestion, which creates a critical – albeit tractable – feedback
loop between the routing problem and the general equilibrium economic system. Our ap20

North Hempstead to Queens on 495W ($719m annually) and White Plains to Greenburgh on 287W
($510m annually).

26

proach allows the quantitative analysis of infrastructure investments to scale: we evaluated
the welfare implications of changing thousands of links of the US National Highway System connecting hundreds of major US cities. Our approach has used a specific general
equilibrium framework and it was oriented towards applied policy but focused on small infrastructure changes. However, the tools we have developed can be used to derive the first
order necessary conditions of a global optimum in more generalized frameworks. We see it
as an extremely fruitful future research avenue to apply these results to characterize globally
optimal transportation networks in the presence of externalities.

27

References
Adao, R., C. Arkolakis, and F. Esposito (2017): “Spatial Linkages, Global Shocks,
and Local Labor Markets: Theory and Evidence,” mimeo.
Adao, R., A. Costinot, and D. Donaldson (2017): “Nonparametric counterfactual
predictions in neoclassical models of international trade,” American Economic Review,
107(3), 633–89.
Ahlfeldt, G. M., S. J. Redding, D. M. Sturm, and N. Wolf (2015): “The economics
of density: Evidence from the Berlin Wall,” Econometrica, 83(6), 2127–2189.
Alder, S., et al. (2014): “Chinese roads in India: The effect of transport infrastructure
on economic development,” Discussion paper, Working Paper.
Allen, T., and C. Arkolakis (2014): “Trade and the Topography of the Spatial Economy,” The Quarterly Journal of Economics.
Allen, T., C. Arkolakis, and X. Li (2014): “On the existence and uniqueness of trade
equilibria,” mimeo, Northwestern and Yale Universities.
(2015): “Optimal City Structure,” Yale University, mimeograph.
Allen, T., C. Arkolakis, and Y. Takahashi (2018): “Universal Gravity,” fortchoming
Journal of Political Economy.
Allen, T., and D. Atkin (2015): “Volatility, insurance, and the gains from trade,” Discussion paper, Working Paper.
Anderson, J. E. (1979): “A Theoretical Foundation for the Gravity Equation,” American
Economic Review, 69(1), 106–116.
Anderson, J. E., and E. Van Wincoop (2003): “Gravity with Gravitas: A Solution to
the Border Puzzle,” American Economic Review, 93(1), 170–192.
Baum-Snow, N. (2007): “Did highways cause suburbanization?,” The Quarterly Journal of
Economics, 122(2), 775–805.
Bell, M. G. (1995): “Alternatives to Dial’s logit assignment algorithm,” Transportation
Research Part B: Methodological, 29(4), 287–295.
CBO (1982): “The interstate highway system: Issues and options,” Congressional Budget
Office of the United States.
28

CFS (2012): “2012 Commodity Flow Survey Public Use Microdata,” Bureau of Transportation Statistics.
Crafts, N. (2004): “Social savings as a measure of the contribution of a new technology
to economic growth,” mimeo.
De Palma, A., M. Kilani, and R. Lindsey (2005): “Congestion pricing on a road network: A study using the dynamic equilibrium simulator METROPOLIS,” Transportation
Research Part A: Policy and Practice, 39(7-9), 588–611.
De Palma, A., R. Lindsey, E. Quinet, and R. Vickerman (2011): A handbook of
transport economics. Edward Elgar Publishing.
Dijkstra, E. W. (1959): “A note on two problems in connexion with graphs,” Numerische
mathematik, 1(1), 269–271.
Donaldson, D. (2012): “Railroads of the Raj: Estimating the Economic Impact of Transportation Infrastructure,” Manuscript, MIT.
Donaldson, D., and R. Hornbeck (2016): “Railroads and American economic growth:
A market access approach,” Discussion Paper 2.
Duranton, G., and M. A. Turner (2011): “The fundamental law of road congestion:
Evidence from US cities,” American Economic Review, 101(6), 2616–52.
(2012): “Urban growth and transportation,” The Review of Economic Studies,
79(4), 1407–1440.
Eaton, J., and S. Kortum (2002): “Technology, Geography and Trade,” Econometrica,
70(5), 1741–1779.
Edwards, A. (2017): “U.S. Cities List,” Discussion paper.
Eluru, N., A. Pinjari, J. Guo, I. Sener, S. Srinivasan, R. Copperman, and
C. Bhat (2008): “Population updating system structures and models embedded in the
comprehensive econometric microsimulator for urban systems,” Transportation Research
Record: Journal of the Transportation Research Board, (2076), 171–182.
Fajgelbaum, P., and C. Gaubert (2018): “Optimal spatial policies, geography and
sorting,” Discussion paper, Working Paper.
Fajgelbaum, P., and E. Schaal (2016): “Optimal Transport Networks,” Discussion paper, Working Paper.
29

FHA (2008): “2008 status of the nation’s highways, bridges, and transit: Conditions and
perfomance,” Federal Highway Administration and Federal Transit Administration.
(2015): “National Highway Planning Network, Version 14.05,” Discussion paper,
Federal Highway Administration, U.S. Department of Transportation.
(FHA), F. H. A., and F. T. A. (FTA) (2017): 2015 Status of the Nation’s Highways,
Bridges, and Transit Conditions & Performance Report to Congress. Government Printing
Office.
Fogel, R. (1962): “A Quantitative Approach to the Study of Railroads in American Economic Growth: a Report of Some Preliminary Findings,” Journal of Economic History,
22(2), 163–197.
Fogel, R. W. (1964): Railroads and American economic growth: essays in econometric
history, vol. 296. Johns Hopkins Press Baltimore.
Frank, M. (1981): “The braess paradox,” Mathematical Programming, 20(1), 283–302.
Galichon, A. (2016): Optimal transport methods in economics. Princeton University Press.
Kaszynski, W. (2000): The American Highway: The History and Culture of Roads in the
United States. McFarland.
Lefevre, B., D. Leipziger, and M. Raifman (2014): “The Trillion Dollar Question:
Tracking public and private investment in transport,” Washington, D. C: World Resources
Institute.
Michaels, G. (2008): “The effect of trade on the demand for skill: Evidence from the
interstate highway system,” The Review of Economics and Statistics, 90(4), 683–701.
NSTIFC (2009): “Paying our way: A new framework for transportation finance,” National
Surface Transportation Infrastructure Financing Commission.
Office of the State Auditor, D. o. T. A. (2002): Capitalization and Depreciation of
Infrastructure. Mississippi Association of Governmental Purchasing and Property Agents.
Osher, S., and J. Sethian (1988): “Fronts Propagating with Curvature-dependent Speed:
Algorithms based on Hamilton-Jacobi Formulations,” Journal of computational physics,
79(1), 12–49.
Ossa, R. (2014): “Trade Wars and Trade Talks with Data,” American Economic Review,
104(12), 4104–46.
30

(2015): “A Quantitative Analysis of Subsidy Competition in the US,” Discussion
paper, National Bureau of Economic Research.
Prato, C. G. (2009): “Route choice modeling: past, present and future research directions,”
Journal of choice modelling, 2(1), 65–100.
Redding, S. J., and E. Rossi-Hansberg (2017): “Quantitative spatial economics,” Annual Review of Economics, 9, 21–58.
Redding, S. J., and M. A. Turner (2014): “Transportation costs and the spatial organization of economic activity,” Discussion paper, National Bureau of Economic Research.
(US), F. H. A., and F. T. A. (US) (2017): 2015 Status of the Nation’s Highways, Bridges,
and Transit Conditions & Performance Report to Congress. Government Printing Office.
Vickrey, W. (1967): “Optimization of traffic and facilities,” Journal of Transport Economics and Policy, pp. 123–136.
Weber, H. J., and G. B. Arfken (2003): Essential Mathematical Methods for Physicists.
Academic Press.
Weber, S., and M. Péclat (2017): “GEOROUTE: Stata module to calculate travel
distance and travel time between two addresses or two geographical points,” .
Zeng, W., and R. L. Church (2009): “Finding shortest paths on real road networks: the
case for A*,” International Journal of Geographical Information Science, 23(4), 531–543.

31

Tables and Figures
Figure 1: An Example Geography
Example Graph

Probability of traveling across each link from i=1 to j=25
0.6

5

10

15

20

25

5

10

15

20

25

4

9

14

19

24

4

9

14

19

24

0.5

0.4

3

8

13

18

23

3

8

13

18

23

2

7

12

17

22

2

7

12

17

22

1

6

11

16

21

1

6

11

16

21

0.3

0.2

0.1

Probability of traveling across each link from i=1 to j=15

Welfare effect of improving a link
0.55

5

10

15

20

25

0.026
5

0.5

10

15

20

25

0.024
0.45
0.022
4

9

14

19

24

0.4

4

9

14

19

24

0.02
0.35
3

8

13

18

23

0.018

0.3

3

8

13

18

23

0.016

0.25

0.014

0.2
2

7

12

17

22

2

7

12

17

22

1

6

11

16

21

0.15
0.1
1

6

11

16

21

0.012
0.01

0.05

0.008

Notes: This figure provides an example geography. The top left frame depicts the graph of
the connections between each of the 25 locations, where all connections are assumed to incur
an equal cost. The top right depicts the probability of traveling along each connection when
beginning at location 1 (bottom left) and traveling to location 25 (top right). The bottom
left frame also depicts the probability of traveling along each connection when beginning at
location 1 (bottom left) but now traveling to location 15 (top center). Finally, the bottom
right figure depicts the elasticity of aggregate welfare to an improvement in each of the
connections.

32

Figure 2: The U.S. National Highway Network
Panel A: The Observed U.S. National Highway Network
(
!
(
!
(
!
(!
!
(
(!
(
!
(!
!
(
!
((
!!
(

!
(
!
(
(
!
(!

(
!

!
(!(

(
!

(
!

(
!
(
!

(
!

!
(

(
!

(
!

!!
(
(
!
(

(
!

!
(
!
(

!
(
!!
(
(
(
(!
!

(
!

(
!
(!

(
(!
!
(
!
(
(!
!
(
!
(
(
!
(
!
(!
!
(
!
(
!
(
!

(
!!
(

!
(!(

(
!

(
!

(!
!
(

(!
!
(

(
!

(
!

(
!
(
!

(
!

(
(!
!
(!

!
(!( !(
!
(
(
!

!
(
!
(
!
(

((
!
! !
(
(
!

!
(

!
(
!
(

U.S. city population

78427 - 114756
114757 - 162320

!
(

162321 - 233136

(
!

!
(

!
(
!
(!
!
(
(
!
!
(
!
(
(
!
(
!
!
(
!
(
(!
!
(
!
(
!(
!
(
((
!
(
!
!
(

!
(
!
( !(
(
!
(!
!
(
!
(

233137 - 361710

!
(

1600001 - 4000000

!
(

361711 - 595047

!
(

4000001 - 8500000

!
(

595048 - 1000000

!
(

!
(

(
!
!
(
(!
!
(

(
!

!
(

!
(

( !
!
(

!
(

(!
(
! !
(
(
!

(
!

!
(!(!(!(

!
(
(
!

(
!

!
(

!
(

!
(
(
!
(!

Traffic (AADT)

!
(

!
(

(
!

!
(!(

(
!
(!
!
(!
(!
(

!
(

!
(

(
!

!
(!(

!
(

(
!

!
(

(
!

!
(

(
!

(
!

0 - 7444
7445 - 15064

!
(
!
(

15065 - 24370

(
!

(
!

!
(
(
!

(
!

(
!

( !(
!
(!
!!
(
(

!
(

(
!
(
!

!
(

24371 - 35935

(
!

!
(

!
(
(
!

(
!

(
(
!
!
(
!
(!

!
(
!
(
!
(

(!(
(!
!

(
!

(
!

!
(
(
!

!
(

(
!

(
!

!
(

!
(

!
(
!
(!(

!
(

!
(

(
!

!
(!(!
( !
(!(!
(

(
!

!
(

(!
(
(!
(!
(
!
!
!
(
(!
(
!
(!
!
(
!
(
!
!
(
(
!
(

(
!

!
(

!
(

!
(!(

(
( !
!

!
(
(
!

!
(

(
!

(
!

!
(!
(!
(

!
(
(
!

1000001 - 1600000

!
(

!
(
(
!
!
(

!
(
(
!

(
!

(
!
(!

!
(

(
!

(!
!
!!
(
((!
(!
(

(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
!
( !
(!
!
!
!
(
(
(!
(

!
(
!
!
(!
((
!
!
(
(

!
(

!
(
!
(
!
(

(
!
(
! !
(
(
!
(
!

(
!

!
(!(
(
!

(
!

(
!

!
(

!
(

!
(

!
( !(

(
(!
!
(
(!
!
((
!
(!
!
!
(

(
!!
(

(!
!
(

!
(
(!
!
(
(!
(!
(
!
(
(!
!
(
!
(
!
(!
!
(
(!
(!
(
!
((!
(
!
(!
!
(!
(
!
(
(
!
(
(!
!
(!
!
(
!
(
!
(!
(
!
(
!
(
!
(
!
(
!
(
!
(!
(
!
(!
!
(
(!
!
(
!
(
( !
!
(
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(!
!
(
!
((
(
!
(
!
( !
!
(
!

(
!

(
!
!
(

(
!

(
!

!
(
!
(

(
!
(
!

(
!
!
(

(
!
(
!

!
(!(

(
!!
(
(
!
(!

(
!

!
(
(
!

(
!

(
!

!
(

!
(

!
(

!
(!(

(
!

(
(!
!
(!
!
(
!
(

!
(

!
(

(
!
(
!
!
(

(
!

(
(
!
(!

(
!

!
(

50073 - 78426

!
(

!
(
!
(
!
(!
(

(
!
(
(!
!

!
(

(!
(!
(
(!
!

!
(

(
!

(
!

(!
!
(

!
(

!
(

(
!

!
(!( !(

!
(

(
!

(
!

!
(

!
(

!
(

!
(

(
!
!
(
!
(
(
(!
(!
!
(!
(!
!
(
!
(!
(!
!
(
(
!
(
(
!

!!
(
(

(
!

(
!

!
(
(
!

(!
!
(
!
(
!
(
(!
(!
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(
(
!
(
!
!
(!(!

(
(
!
!!
(
(!

!
(

(
!
!
!
(!(!( (

(
!

!
(

(
( !
!

!
(

(
!
!
(

!
(
!
(!
(
(
!
(!
(
!
(!
(!
!
(
(!

!
(

(
!!
(
(
!

(
!

(
(!
!
(
!
(
!
(
!
( !(!
(
!
!
(
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
!
(
!
(!
!
(
!
(
!
(
(
(
(
!
(
!
!
(
(
(
!
(!
!
(
!
(
!
(
!
(
!
(
!
(
!
!
!
(
(
(
(
!
(
!
(!
!
!
(
!
(
!
!
(!
!
(
(
!
(
!
(
!
(
!
(
(
!
(
!
(
!
(
(
!
(
!
(
!
!
(
(
!
(
!
(
!
!
((
!
(!
!
!
(
(

(
!

(
!

!!
(
(!
(

!
(

(
!
!
(

(
!

(
!

!
(!(

(
!
(
!
!
(

!
(

(
!

!
(!(

(
!

(
!

(
!
(
(
!
(!
!
(!

!
(

(
!
(!

(
!

!
(
( !
(
((
!
(!
!
((!!(!
!!
(!
!
(!
(!
!
(
!
(
(
(!
!
(!
!
(
!
!
(
(
(
!
(!
!
(
(
!
(
(!
!
(
!
(
!
(
!
(
(
!
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(
!
(!
!
(
(
!
(
!
(
(
!
(
!
(
!
(
(
!
(!
!
(
!
!
(
!
(
!
(
!
!
(
(
!
(
(
!
(
!
(
!
!
(
(
(!
!
((
!
(
!
(
!
(!
!
!
(
(
!
( !
(
!
(!
!
(
!
!
(
!
(
(!(!(!
(
!
((
!

(
!

!!
(
(!
!
(
(
(
!
!
(
!
(
(
!
(
(!
!

(
!

!
(!(!(

!
(!
(!(

!
(

(
!

!
(
(!
!
(
(
!

!
(!(

(
!
(
!

(
!

(
!

(
!
!
!
(
(
(
!
(
!
(
!
(!
!
(
!
(

!
(!(

(
(!
!

(
!

(
!

(
!

(
!
(
!

!
(

(
!

(
(!
(!
!
(
!
(!
!
(!(!(!(!
!
(!
!
(!(
(
(
!
(
(!
!
(!
!
(
!
(!
!
(
!
(!(!
(
(
(!
!
(
(
(
(
!
(
!
(!
!
(
!
(!
!
!
(
(
(!
!
(!( !(
(!
(
!
(
!
(
(
!
(!
!
!
!
(
(

(
!
!
(

(
!

(
!

(
!

(
!

(
!

(
!

!
(

(
!

35936 - 51098

!
(

51099 - 71852

!
(
!
((
!
(
!
(
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(
!
(
!
(
(!
!
(
!

!
(!(!(

(
!

!
(!(

!
(
!
(
!
(
!
(
!
(

!
(

71853 - 98071
98072 - 133314
133315 - 186159
186160 - 279338

Panel B: A Graphical Representation of the U.S. National Highway Network
(
!
(
!
(
!
(!
!
(
(!
(
!
(!
!
(
!
((
!!
(

!
(
!
(
(
!
(!

(
!

!
(!(

(
!

(
!

(
!
(
!

(
!

!
(

(
!

(
!

!!
(
(
!
(

(
!

!
(
!
(

!
(
!!
(
(
(
(!
!

(
!

(
!
(!

(
(!
!
(
!
(
(!
!
(
!
(
(
!
(
!
(!
!
(
!
(
!
(
!

(
!!
(

!
(!(

(
!

(
!

(!
!
(

(!
!
(

(
!

(
!

(
!
(
!

(
!

!!
(
(!
!
(
(
(
!
!
(
!
(
(
!
(
(!
!

(
!

(
(!
!
(!

!
(!( !(
!
(
(
!

!
(
!
(
!
(

((
!
!
(
!
(
!

!
(

!
(
( !
(
((
!
(!
!
((!!(!
!!
(!
!
(!
(!
!
(
!
(
(
(!
!
(!
!
(
!
!
(
(
(
!
(!
!
(
(
!
(
(!
!
(
!
(
!
(
!
(
(
!
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(
!
(!
!
(
(
!
(
!
(
(
!
(
!
(
!
(
(
!
(!
!
(
!
!
(
!
(
!
(
!
!
(
(
!
(
(
!
(
!
(
!
!
(
(
(!
!
((
!
(
!
(
!
(!
!
!
(
(
!
( !
(
!
(!
!
(
!
!
(
!
(
(!(!(!
(
!
((
!

(
!
(
(
!
(!
!
(!

!
(
!
(

50073 - 78426

(
!

78427 - 114756

!
(

114757 - 162320

!
(

(
!

!
(
!
(
!
(!
(

!!
(
(!
(

(
(
!
(!

(
!

!
(

162321 - 233136

!
(

233137 - 361710

!
(

361711 - 595047

!
(

595048 - 1000000

!
(

!
(

!
(

(
!

!
(

!
(

!
(

!
!
(!
(
!
(
(
(!
(
(!
!
(!
(!
(
!
(!
(!

!
(

!
(

(
!

!
(
(
!

!
(
(
!
!
(

!
(

(
!

!
(
!
( !(
(
!
(!
!
(
!
(

!
(

(
!
!
(

!
(

1600001 - 4000000

(
( !
!

!
(!(

!
(

(
!
(
!
!
(
(!
!
(

(
!

( !
!
(

(!
(
! !
(
(
!

!
(
(
!

(
!

!
(!(

(
!
(!
!
(!
(!
(

(
!

!
(!(

(
!

(
!
( !

!
(
(
!

(
!

!
(

(
!

!
(

!
(

!
(

!
(

(
!

(!
!
(
!
(
!
(
(
!
(
!

!
(

(
!

Traffic (AADT)

25150 - 36740

!
(
(
!

(
!
(
!

!
(
(
!

!
(!(!(

(
!

!
(
!
(
!
(

(!(
(!
!

(
!

14970 - 25140

(
!

(
!

!
(
!
(
!
!
((

!
(

(
!

1658 - 14960

(
!

(
!

!
(

!
(
(
!
(!

(
!

!
(

!
(

!
(
(
!
(!
(!
!
!
(
(

(!
(
(!
(!
(
!
!
!
(
(!
(
!
(!
!
(
!
(
!
!
(
(
!
(

!
(

!
(

!
(!(

!
(

(!
!
!!
(
((!
(!
(

(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
!
( !
(!
!
!
!
(
(
(!
(

(
!

!
(

!
(

!
(

!
(

(
!

!
(!(!
( !
(!(!
(

(
!

!
(

!
(!(!(!(
!
(

!
(

!
(
(
!

!
(

!
(
(
!

(
!

!
(!
(!
(

!
(

(
!

(
!

!
(
!
(
!
(

(
!
(
! !
(
(
!
(
!

(
!

!
(!(
(
!

(
!

(!
!
(

!
(

!
(

!
(

!
( !(

(
!

!
(
(!
!
(
(!
(!
(
!
(
(!
!
(
!
(
!
(!
!
(
(!
(!
(
!
((!
(
!
(!
!
(!
(
!
(
(
!
(
(!
!
(!
!
(
!
(
!
(!
(
!
(
!
(
!
(
!
(
!
(
!
(!
(
!
(!
!
(
(!
!
(
!
(
( !
!
(
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(!
!
(
!
((
(
!
(
!
( !
!
(
!

(
!

(
!

!
(

!
(

!
(
!
(!
!
(
(
!
!
(
!
(
(
!
(
!
!
(
!
(
(!
!
(
!
(
!(
!
(
((
!
(
!
!
(

(
!
(
!

!
(!(

(
!!
(
(
!
(!

(
!
!
(

(
(!
!
(
(!
!
((
!
(!
!
!
(

(
!!
(

(
!
!
(
(
!

!
(
!
(

(
!
(
!

!
(

(
!

(
!

(
(!
!
(!
!
(
!
(

!
(

(!
(!
(
(!
!

(
!

(
!

!
(

!
(

(
!
!
(
!
(
(
(!
(!
!
(!
(!
!
(
!
(!
(!
!
(
(
!
(
(
!

!!
(
(

(
!

(
!

!
(
(
!

(!
!
(
!
(
!
(
(!
(!
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(
(
!
(
!
!
(!(!

(
(
!
!!
(
(!

!
(

(
!
!
!
(!(!( (

(
!

!
(

(
( !
!

!
(!( !(

(
!

(
!!
(

!
(

(
!!
(
(
!

(
!
(
(!
!
(
!
(
!
(
!
!!
(
(
(
!
(
!
(
!
(
!
(
!
(
!
(
!
(
!
(
!
(!
!
(
!
(
!
(
(
(
!
(
(
!
(!
!
(
!
(
!
(
!
(!
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(!
!
(
(
!
(!
!
(
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
((!
(!

!
(
(
!
(
!
!
(

(
!

1000001 - 1600000
4000001 - 8500000

!
(

(
!

!
(!(

!
(

(
!

!
(

!
(

!
(

!
(
!
(!
(
(
!
(!
(
!
(!
(!
!
(
(!

(
!

(!
!
(

!
(

(
!
(
!!
(

(
!
!
(

!
(

(
!
(
!

!
(

(
!
!
(

!
(
!
(

(
!

(
!

(
!

!
(!(

(
!
(
!
!
(

!
(

(
!

!
(!(

(
!

(
!

U.S. city population

(
!
(!

(
!

!
(!(!(

!
(!
(!(

!
(

(
!

!
(
(!
!
(
(
!

!
(!(

(
!
(
!

(
!

(
!

(
!
!
!
(
(
(
!
(
!
(
!
(!
!
(
!
(

!
(!(

(
(!
!

(
!

(
!

(
!

(
!
(
!

!
(

(
!

(
(!
(!
!
(
!
(!
!
(!(!(!(!
!
(!
!
(!(
(
(
!
(
(!
!
(!
!
(
!
(!
!
(
!
(!(!
(
(
(!
!
(
(
(
(
!
(
!
(!
!
(
!
(!
!
!
(
(
(!
!
(!( !(
(!
(
!
(
!
(
(
!
(!
!
!
!
(
(

(
!
!
(

(
!

(
!

(
!

(
!

(
!

(
!

!
(

(
!

(
!

36750 - 50710

!
(

!
(!(

50720 - 67970

(
!
(
!
(
!
(
!
!
(
!
(
(
!
(
!
(
!
(
!
!
(
!
(
(
!
(
!
!
(
(
!
(
(!
!
!
(

67980 - 87810

(
(
!
!!
(
(
!

!
(

(
!

87820 - 113300
113400 - 145600
145700 - 185100
185200 - 232200

Notes: This figure depicts the U.S. highway network. Panel A shows the observed National Highway Network along with all cities with populations greater than 50,000 within 10
kilometers from the highway network. Panel B depicts the graphical representation of the
constructed adjacency matrix between cities along the highway system. Two cities are considered connected if the fastest route between the locations along the highway system does
not pass through another city. The color of the links indicates the traffic between connected
cities, with blue indicating a less traffic and red indicating greater traffic. The size of the
city circle indicates its population, with larger sizes indicating greater population.

33

Log(inverse speed - 1/70)
(hours per mile more than no traffic)
-10
-8
-6
-4
-2

Figure 3: Traffic and Speed

0

2

4

6

Log traffic
(Vehicles per lane-mile)

Data
Log-linear relationship

8

10

Non-parametric regression

Notes: This figure plots the relationship between the (log) average traffic per lane-mile and
the observed (log) additional time it takes to travel an additional mile relative to the time
it would have taken going seventy miles per hour. The observed time of travel is calculated
using API. The traffic data by ( (US)). The green line is a log-linear regression fit over the
data and the red line is a local non-parametric regression with an Epanechnikov kernel and
a 0.25 bandwidth. The coefficient of the linear regression is 0.4415, with a t-statistic of 119.

34

Figure 4: Model Fit
No congestion
c 1 =16.6 c 2 =0.0394
Correlation:0.48; Distance (de-meaned):134

13

Observed traffic (log)

12
11
10
9
8
7
-16

-14

-12

-10

-8

-6

-4

-2

Predicted trade (log)
With congestion
c 1 =11.9 c 2 =0.0455 c3 =103
Correlation:0.559; Distance (de-meaned):91.6

13

Observed traffic (log)

12
11
10
9
8
7
-14

-13

-12

-11

-10

-9

-8

-7

-6

-5

Predicted trade (log)

Notes: This figure depicts the ability of the model to match the observed traffic data. The
top panel reports the relationship between the (log) predicted value of trade flowing on each
network link and the (log) observed traffic along each link when there is no traffic congestion.
The bottom panel shows how the same figure changes when there is congestion, i.e. the cost
of traveling along a link is allowed to endogenously increase in response to increased trade.
With congestion, the model fit (measured as the norm between the de-meaned log traffic and
log predicted trade flows) improves by more than 30% and the correlation between observed
traffic flows and predicted trade flows increases from 0.48 to 0.56.
35

-20

Observed trade from CFS (log)
-15
-10
-5

0

Figure 5: Predicted Versus Observed Trade Flows

-40

-30
-20
-10
Predicted trade based on traffic (log)

0

Inter-state trade (correlation:0.47)
Intra-state trade (correlation:0.73)

Notes: This figure shows the relationship between the predicted state-to-state bilateral trade
flows from the model (calculated by aggregating up from the predicted city-to-city bilateral
trade flow data) and the observed state-to-state bilateral trade flows from the 2012 Commodity Flow Survey (CFS). Note that the CFS data was not used in the estimation procedure
(the predicted trade flows were estimated by instead matching observed traffic flows.)

36

Figure 6: Probability of Using Different Highways from Seattle to Manhattan
!
(
!
(
!
(
!
(!
(
!
(
(!
!
(!
!
(
((
!!
(
!
(

(
!
!
(
(
(!
!

(!(
!

!
(

!
(

!
(
!
(

!
(

(
!

!
(

!
(

!
(!
!
(
(

!
(

(
!
(
!

(
!
!
(!
(
!
(
(!

!
(

(
(!
!

(
!
(!
!
(
(
!
(!
!
(
!
(
(
!
!
!
(
(!
(
!
(
!
(

(
!!
(

(!(
!

!
(

!
(

!
(!
(

!
(!
(

!
(

!
(
!
(

!
(

!
(
(
!
!
(
!
!
!
(
(
(
!
(!
(
(
!

!
(
!
((
!
(
(
!
(!
(!
!
(!
!
( !
!
!
(!
(
(
(
!
(
!
(
!
(!
!!
(
( !
!!
(!
(
(!
(
!
(( !
((!
(!
(
!
!
(!
(
(!
!
(!
(
(!
(
!
(
!
((
!
!
(
(!
(!

!!(
(
!
(

!!
(
(!(

(
(!
!

!
(

(
!

(!(
!
(!
!
(!
( !
((
(
!
(
!
(
!
(
!
(
!
!
( !
!
(

(!( !(
!
(
!
!
(
!
(

(
!
(
(
(!
!
(!
!

!
(
!
(

!
(

(
!
(
!
(!
!
(

!
(!
(!
(

(
!
!
(

Probability of using link

(
!
(
!
(!

!
(

!
(

!
(

(
!

(
!

(!
(!
!
(

(
!

(
!

!
(
!
(

!
(

0.5 - 0.6

(
!

(
!
(!
!
(!
(
!(
!
((!
!
(

!
!(
(

!
(

!
(

(
!
!
(
!
(

!
(
!
(

!!(
(

!
(

(
!

!
(

!
(
!
(

!
(

!
( !
(

(
!

(!
(
!
( !
!
(

(
(!
!
(
!
(!
(!(!
!
(
(
!

!
(
!
(!( !((!!
!
(!
(
!
(
(
!
( !
!
!
(
(!
(!
(!
(!
(!
(!
!
(
(!
!
((
!
!
((
(
(
!
( !

!
(
!
(

!
(

(
!
!
(
(
!

(!(
!
(!

!
(
!
(

!
(
(
(!
!

(
!
!
(

!
(

!
(

!
(!(

!
(
!
(!
(!
(!
(

(!(
!

!
(

(
!

(
!

(
!
!
(

!
(

(
!

!
(

(
!

!
(

(
!

!
(

(
!
!
(

!
(

(
(!
!
!!
(
(

(
!

!
(

!
(
!
(

!
(

(
!
!
(
(
(!
!

(
!

!
(

!
(

(
!

!
(!
!
(
((!
!
(!
(

!!(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
(
!
(!
(
!
(!
(

(
!

(
!

(!(
!

(
!

!
(
!
(
!
(
(!
(!
(!
(
!
!
(
(
!
(!
!
(
!
(!
!
(
(
(
!
(!
(!
!
(
!
(
!
!
(!
(
(!
(
!
(
!
(
(
!
!
(
(
!
!
(
!
(!
(!
(
!
( !(
!
!
(
(
!
(!
!
(
(
!
(
(
!
(!
(!
!
!
((
!
(
(!
!
(
(
!
(
!

!
(

(
!

(
!

(
!

(
!

!
(

!!(!
(
( !
(!(!
(

!
(
!
(
!
(
!
(!
!
(

!!((!(
(
(
!

(
!

!
(
(
!
(
!

!
(

(
!

(
!
!
(

!
(
!
(
! !
(
(
!
(

!
(

!
(

!
(

(
!

(
!

(
!

!
(!
(

!
(

!
(

!
(

!
(

!
(

!
(
(
!

(!(
!

!
(
(
!
( !

(!(
!

(
!
(!
!
(
(!

!
(
!
(

!
(

!
(

(
!

(
!
! !(
(
!
(
!
(!
!
(
(

0.3 - 0.4

0.9 - 1.0

(!
(
(!
!
(!

!
(
!
(
!
(

!
(

!
(
!
(
!
(!
!
!
(
(
!
(
!
!
(
(
(
!
(
!
!
(!
(
(
!
!(
(
!
!
((
!
(
(
!

(
!

0.0 - 0.2

0.7 - 0.8

(!(
!

!
(

!
(

!
(
(
!

!
(

(
!

!
(

(
!!
(

!
(

!
(

!
(
(
!

!
!
(
(

(
!

!
(
(
!
!
(
(!
(!
!!
(
!
(
!
(!
(
(
!
(
!
(
!
(
(
!
!
!
(
(
!
!
(
(

!
(

!
(

(
!

!
(

(
!

!
(

!
(!
(

!
(

!
(

!
(
!
(

!
!
!
(!
(
(
(!
(
!
(!
(
!
!
!
(
(
(
(
!
!
(
(
!
(
!
(!
(
(!
!
(
!!(!
(

(
!
!
(!
(
(!

!
(
!
(

!
(
(
!!(!( !
(

!
(

(
!

(
!
( !

(!( !(
!

(!(
!

(
!

(
!

(
!

!
!(
(
!
(

!
(

!
(

!
(

(
!

(
!

!
(
(!
!
(
(
!
(!
!
(
(!
!
(!
(
(!

!
(

!
(!
(

(
!

!
(
(
!
(!

(

!
(

(
!
!
(

!
(

(
!

(
( !
!
(
!
(!
!
(!
((!!
(!
(!
(!
!
!
!
!
(
(
(!
(
!
!
!
(!
!
(
!
(
(
!
(
(
!
(
!
!
(!
(
(!
(
(
!
!
(
(
(
(
!
!
(
(
!
(
!
!
(
(
!
(
!
(
!
(!
!
(
!
(!
(
(
!
!
!
(
!
(
!
!
!
(
(
(
(
(
(
!
!
(!
(
!
(
!
(
(
(
!
(
!
(
!
!
!
!
(
(
(
!
(
!
(
!
(!
(!
!
(
!
(
!
(
(
!
(
!
!
(
( !
!
(
!
!
(!
(
(
!
(
(!(!(!
!
!
(
!
((

!
(
!
(

(!(
!

(
!
(!
!
(
!
(
!
(
( !(!(!(!(!(!(!((
!
!
!
!
(
(
!
!
!
(
!
(
(!
!
(
(
!
!
(
!
(
(
(
!
(
!
!
(
(
(
!
!
!
!
!
(
(
(
(
!
(
!
(
(
!
(
!
(
!
!
!
(
(
!
!
!
(!
(
(
!
(!
(
(
!
!
(
!
(
!
!
(
!
(
(
!
!
(
!
!
(
!
(
(
(
(
(
!
(
!
(
(
!
!
!
(
!
(
(!
(!
(
!

!
(

(!(
!

(
!
(
!
(
!

!
(

(
!

(
!

!
(

!
(

!
(

!
(!
(

(
!

!
(

(
!
!
(!
(
(
!!
(
!
(!
!
!
(
(
(
(
!
(
!
!
!
(
!
((

(!
!

!
(
(!

!
(

!
(

!
(
!
(
!
(
!
(

!
(
!
(

(
!

!
(

!
(

!
(
!
(

!
(

!
(

!
(

!
(

!
(

!
(

(
!

!
(
!
(

(!(!(
!

!
(

(
!

!
(
!
(

!
(
!
(

(
!
!
(

!
(

(
!

!
(
!
!
!
(
((
!
(
!
!
(
(
!
(
!
(
!
(
(
!
(!
!
(
!
!
(
(
!
(
!
(
(!
!
(

(
!

(
!
(
!
(
!
!
(
(
!

Notes: This figure depicts the probability of a trader going from Seattle, WA to Manhattan
Borough in New York, NY using each particular connection of the National Highway Network
(without congestion). This is equivalent to the elasticity of trade costs from Seattle to
Manhattan to a change in the cost of traveling over each highway segment.

37

Figure 7: The Costs and Benefits of Transportation Infrastructure Improvements
(a) Estimated annualized cost of ten additional lane-miles ($m)
(
!
(
!
(
!
(!
!
(
(!
(
!
(!
!
(
!
((
!!
(

!
(
!
(
(
!
(!

(
!

!
(!(

(
!

(
!

(
!
(
!

(
!

!
(

(
!

(
!

!!
(
(
!
(

(
!

!
(
!
(

!
(
!!
(
(
(
(!
!

(
!

(
!
(!

(
(!
!
!
(
(
(!
!
(
(
!
(
!
(
!
(!
!
(
!
(
!
(
!

(
!!
(

!
(!(

(
!

(
!

(!
!
(

(!
!
(

(
!

(
!

(
!
(
!

(
!

(
!
!
!
(
(
(
!
(
!
(
!
(!
!
(
!
(

(
!

!
(!(
(
!

(
!

!
(!
(!(

(
(!
!
(!

(
!
(!

!
(!( !(
!
(
(
!

!
(
!
(
!
(

((
!
! !
(
(
!

(
!
!
(

(
!

(
!

!
(!(

!
(!(

(!
(!
(
(!
!

!
(
!
(

(
!

(
!

!
(
(
!
!
(

!
(
(
!

1.9

2.2

(
!

!
(

(
!

!
(!(

!
(!(

(
!
(!
!
(!
(!
(

!
(

!
(

(
!

!
(

(
!

!
(
(
!

!
(

(
!

!
(
(
!
!
(
(
!

(
!

(
!
(
!

(
!

!
(

(!
!
( !(
!
(

!
(
(
!

!
(

!
(
(
!
(
!

!
(!(

(
!

(
(
!
!
(
!
(!

(
(
!
(!
!
(
!
(
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(
!
(
!
(
(!
!
!
(

!
(!(!(

(
!

!
(

!
(
!
(
!
(
!
(
!
(

!
(

2.5 - 2.7

(
!

!
(
(
!
(!

!
(
(
!

!
(

(
!

!
(

2.3 - 2.4

!
(
!
(
!
(

(!(
!!
(

(
!

!
(

!
(

!
(!(

!
(

(
!

!
(

!
(

!
(

(
(
(
(!
!
(
!!
!
(!(!
(
(

(!
(
!
(!
!
(
(!
!
(
!
(
(
(!
!
(!
!
(!
!
(!
(!
(!
(
(!
!
((
!
(!
(
!
(
!
( (
!
(
!

(
!

!
(

!
(

!
(

2.1

(
!
!
(
(!
!
(

!
(

!
(

(!
(
! !
(
(
!

!
(!(

!
(

!
(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
(!
!
!
(
(!
(

(
!

!
(

(
!
( !
!
(

(
!

!
(!(!(!(

!
(
(
!

!
(
!
(
!
(

!
(!(!
( !
(!(!
(

(
!

!
(

!
(

(
!

!
(

!
(
(
!

(
!

(
!
!
(
(!
!
(
(!
!
(
(!
(
!
(
(!
!
(
!
(!
!
(
!
!
(
(
(!
(!
(
!
(
(!
!
!
(
!
(
(!
!
(
(
!
!
(!
(
!
(
!
(
!
!
(!
!
( !(
(!
!
(
(
!
!
(
(
!
(
!
!
((
!
(!
((
!
(
(!
!
!
!
(

(
!

(
!
!
(

2.0

!
(!(

(
( !
!

(
!
!
(
(
( !
!
(
!
(
!

!
(

(
!

(
!

!
(

(!
!
!!
(
((!
(!
(

(!
!
(

(
!

!
(

(
!

!
(!(

(
!

!
(!
(!
(
!
(
!
( !(
(
!
(!
!
(
!
(

(
!

(
!!
(

(
!

(
!

!
(
!
(

(
!

(
!

!
(

!
(!
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(

!
(!(

(
!!
(
(
!
(!

(
!
!
(

!
(

(
(!
!
(
(!
!
!(
(
(!
!
(
!

(
!

(
!

(
!
(
!
!
(

(
!

(!
!
(
!
(!
!
(
(
!
(
!!
(
(
(
(!
!

!
(

(
!!
(

!
(

!
(
!
(

!
(

(
!

!
(

!
(

!
(

!
(!( !(

(
!

(
!

(
!

(
!

(
!

(
!
!
(

(
!
(
!

!
(

(
!
!
(
(
(!
!
(!
!!
(
(
!
(!
!
(
(
(
!
(
!
!
(
!
(
(
!
(
!
(
!
(
!

!
(

(
!

(
(
!
(!

(
!
(
(!
!

($m per year)

!
(

(
!

(!
!
(

!
(

!
(
!
(
!
(!
(

!!
(
(!
(

!
(
!
(

Cost for an additional 10 lane-miles

!
(

!
(

(
!
(
!

(
!
(
(
!
(!
!
(!

!
(

!
(

(
!

!!
(
(

(
!

(
!

!
(
(
!

(!
!
(
!
(
!
(
(!
(!
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(
(
!
(
!
!
(!(!

(
(
!
!!
(
(!

!
(

(
!
(
!
(!(!( !

(
!

!
(

(
( !
!

!
(

(
!
!
(

!
(
!
(!
(
(
!
(!
(
!
(!
(!
!
(
(!

(
!

!
(

!
(
( !
(
((
!
(!
!
((!!
!!
(!
!
(!
(!
!
(
!
(
(
(!
!
(!
!
(
!
!
(
(
(
!
(!
!
(
(
!
(
(!
!
(
!
(
!
(
!
(
(
!
!
(
!
(
!
(
!
(
!
(
(!
!
(
!
(
!
(
!
(!
!
(
(
!
(
!
(
!
(
!
(
!
(
!
(
(
!
(
!
(
!
(
!
!
(
!
(
!
(
!
!
(
(
!
(
(
!
(
!
(
!
!
(
(
(!
!
((
!
(
!
(
!
(!
!
!
(
(
!
( !
(
!
(!
!
(
!
!
(
!
(
(!(!(!
(
!
((
!

(
!
!
(

(
!

(
!

(
!

!
(!(

!
(

!
(

!
(

(
!!
(
(
!

(
!

(
(!
!
(
!
(
!
(
!
!
(
!
(
!
( !(!(!(!(!(!(!(!
(
!
(
!
(
!
(
!
(
!
!
(
!
(!
!
(
!
(
!
(
(
(
!
!
!
(
(
(
!
(
!
(
!
(
!
(
!
(
!
!
!
(
(
(
(
!
(
!
(!
!
(
!
(
!
!
(!
!
(
(
!
(
!
(
!
(
(
!
(
!
(
!
(
(
!
(
!
(
!
(
!
(
(
(
!
(
!
(
!
!
(!
!
(!
!
!
(
(

(
!

!
(!(

(
!

!
(!(!(

(
(!
(!
!
(
!
(!
!
(!(!(!(!
!
(!
!
(!(
(
(
!
(
(!
!
(!
!
(
!
(!
!
(
!
(!(!
(
(
(!
!
(
(
(
(
!
(
!
(!
!
(
!
(!
!
!
(
(
(!
!
(!( !(
(!
(
!
(
!
(
(
!
(!
!
!
!
(
(

!
(

(
!

!
(
(!
!
(
(
!!
(
(!
!
(
!
(
(
!
!
(
!
(
(
!
(
(!
!

!
(
(
!
(
!

!
(!(

(
(!
!

(
!

(
!

(
!

(
!
(
!

!
(

(
!

(
!

(
!
!
(

(
!

(
!

(
!

(
!

(
!

(
!

!
(

(
!

2.8 - 3.1
3.2 - 3.8
3.9 - 4.9
5.0 - 5.6

(b) Estimated annualized benefit of ten additional lane-miles ($m)
!
(
!
(
!
(
!
(!
(
!
(
(!
!
(!
!
(
((
!!
(
!
(

(
!
(
!
(
(!
!

!!(
(

!
(

!
(

!
(
!
(

!
(

(
!

!
(

!
(

!
(!
!
(
(

!
(

(
!
(
!

(
!
!
(!
(
!
(
(!

!
(

(
(!
!

(
!
(!
!
(
(
!
(!
!
(
!
(
(
!
!
!
(
(!
(
!
(
!
(

(
!!
(

!!(
(

!
(

!
(

!
(!
(

!
(!
(

!
(

!
(

!
(
!
(

!
(

!
(
(
!
!
(
!
!
!
(
(
(
!
(!
(
(
!
!
(
!!
(
! !
(
(
(

!
(!
!
(!
!
(
(
(
(
!
(
!
!
!
(
!
((

(!(
!
!
(

!!
(
(!(

!
(
(!
(!

(
(!
!

!
(

(
!

(!
!
(!
(
!
(!(!(!!
!
(!
((!(
!
!
(!
(
!
(
(
(!
!
(!
(!
!
(
(!
(
!
(!(!
(
(
!
!
(!
(
!
(
(
(
!
(
!
!
(!
(
!
(!
(
!
(
!
(!
(!( !(
!
(!
(
(
(
!
!
(
!
(!
(
!
(
!

(!( !(
!
(
!
!
(

(
!

(
( !
!
(
!
(!
!
(!
((!!
(!
(!
(!
!
!
!
!
(
(
(!
(
!
!
!
(!
!
(
!
(
(
!
(
(
!
(
!
!
(!
(
(!
(
(
!
!
(
(
(
(
!
!
(
(
!
(
!
!
(
(
!
(
!
(
!
(!
!
(
!
(!
(
!
!
!
(
!
!
!
(
(
(
(
(
(
(
!
!
!
(!
(
(
!
(
!
(
(
(
!
(
!
(
!
!
!
!
(
(
(
!
(
!
(
!
(!
(!
!
(
!
(
!
(
(
!
(
!
!
(
( !
(
!
!
(!
(

(
!
(
(
(!
!
(!
!
(
!

(
!

!
(!
(
!
(
(
!
(
!
(!

(
!

(
!
!
(

!
(

(
!
(
!
(!
!
(

!
(!
(!
(

!
(

Gains from an additional 10 lane-miles
($m per year)

10.3 - 10.5
10.6 - 12.0
12.1 - 15.0

(
!
(
!
(!

!
(

!
(

(
!

100.1 - 719.5

(
!

!
(

(!(
!

(
!
! !(
(
!
(
!
(!
!
(
(

(
!

(
!

!
(

(
!

(
!

!
(

!
( !
(

(
!

(!
(
!
( !
!
(

!
(
!
(
!
(
!
(!
!
(

!!((!(
(
(
!

(
!

!!(!
(
( !
(!(!
(

!
(

!
(

!
(

!
(!(

!
(
!
(!
(!
(!
(

(
!

(
!
!
(
(
!

(!(
!
(!

!
(
!
(

!
(
(
(!
!

(
!

!
(

(!(
!

!
(

(
!

(
!

(
!
!
(

!
(

(
!

!
(

(
!

!
(

(
!

(
!
!
(
!
(
!
(

!
(

!
(
!
(

!
(!
(
(
!
!
(
!
(
!
(

!
(

!
(

(
!
!
(
(
(!
!

!
(

!
(

!
(

(
!

(
!
!
(!
!
((
!
(
(
!

(!
!
(
(!
(!
(
(
!
(
!
(
!
(!
!
!
(
!
(
(
!
!
(
(
!

(
!

(
!

(!(
!

(
!

(
!

!
(

(
!

(
!

(
!

(
!

!
(

!
(

!
(!
!
(
((!
!
(!
(

!!(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
( (
!
!
(!
(
!
(
!
(!
(

!
(

!
(
!
(

!
(

!!(
(

!
(
!
(

(
!

(
!
!
(

!
(
(
!
( !

!
(

!
(

!
(

!
(
!
(

(
!
(
!
!
(

!
(
! !
(
(
!
(
!
(

!
(

!
(

(
!

(
!

!
(

(
!
!
(
!
(
!
(

(
!

(!
(!
!
(

(
!
!
(

(
!
(!
!
(

!
!(
(

!
(!
(

!
(
!
(
(!
(!
(!
!
(
(
!
(!
!
!
(
(
!
(!
(
(!
(!
!
(
!
!
!(!
(
(!
((
!
(
!
(
(
!
!
!
(
!
(!
(
(!
!
!
(
(!
!
(
(
!
(
(
!
(
!
(
!
!
(
(
!
(
!
(
!
((
!
(!
(!
!
(
!
( !
!
!
(
(!
(!
(!
(!
(!
(!
!
(
!
(
(
(
!
(
!
!
((
(!
(
!
( !
!
(

!
(

!
(
!
(

!
(

!
(

!
(
(
!

!
!
(
(

(
!

(!(
!

(
!
(!
!
(
(!

(
!

!

(
(
!
(!
(
!
!
(!
(
!
(

!
(
!
(

!
!
(
(

(
!

!
(

!
(

!
(
!
(
!
(!
!
!
(
(
!
(
!
!
(
(
(
!
(
!
!
(!
(
(
!
!(
(
!
!
((
!
(
(
!

(
!

!
(
!
(
!
(
(
!
(!
(!
(!
!
(!
!
(
(!
!
(!
(
!
(
!
(
(

(!
(
(!
!
!
(
(
!

(!
(
(!
!
(!

!
(
!
(
!
(

!
(

(
!!
(

!
(

!
(!
(

!
(

!
(

!
(
!
(

!
!
!
(!
(
(
(!
(
!
(!
(
!
!
!
(
(
(
(
!
!
(
(
!
(
!
(!
(
(!
!
(
(!(!
!

(
!
!
(!
(
(!

!
(
!
(

(
!

!
(

!
(

20.1 - 30.0

50.1 - 100.0

(
!

!
(
(!
!
(
(
!
(!
!
(
(!
!
(!
(
(!

!!(
(

!
(!
(

15.1 - 20.0

30.1 - 50.0

(
!

!
(

(!(
!

(
!

!
(

(
!

!
(

!
(
!
(

(
!

(
!

!
(
(
!
(!

(

!
(
(
(!(!( !
!

!
(

(
!

(
!
( !

(!( !(
!

!
(

!
(

!
(

!
(
!
(

!
(

(!(
!

(
!
!
(
(
!

!
(

!
(

(!
!

(
!

(
!

(
!

!
!(
(
!
(

!
(

(
!
(!
!
(
!
(
!
(
( !(!(!(!(!(!(!((
!
!
!
!
(
(
!
!
!
(
!
(
(!
!
(
(
!
!
(
!
(
(
(
!
(
!
!
(
(
(
!
!
!
!
!
(
(
(
(
!
(
!
(
(
!
(
!
(
!
!
!
(
(
!
!
!
(!
(
(
!
(!
(
(
!
!
(
!
(
!
!
(
!
(
(
!
!
(
!
!
(
!
(
(
(
(
(
!
(
!
(
(
!
!
!
(
!
(
(!
(!
(
!

!
(

!
(

!
(

!
(!
(

(
!

!
(

(
!
!
(!
(
!
(

!
(

(!(
!

!
(
(!

!
(

!
(

!
(
!
(
!
(

!
(
!
(

(
!

!
(

!
(

!
(
!
(

!
(

!
(

!
(

!
(

!
(

!
(

(
!

!
(

(
!

!
(
!
(

!
(

(
!

(
!
!
(

!
(

(!(
!

!
!
!
(
((
!
(
!
!
(
(
!
(
!
(
!
(
(
!
(!
!
(
!
!
(
(
!
(
!
(
(!
!
(

(
!

(
!
(
!
(
!
!
(
(
!

Notes: Panel A reports the estimated annual cost (in millions of chained 2012 U.S. dollars)
of adding ten additional lane-miles to each segment of the highway system; the background
color indicates the cost of constructing a highway on each pixel. See the text for details of this
calculation). Panel B reports the estimated annual value (in millions of chained 2012 U.S.
dollars) of adding ten additional lane-miles to the highway system; this effect incorporates
the endogenous response to congestion across all links, the optimal routing of all traders, and
the general equilibrium response of wages and population in all cities. The color of a link
indicates its cost (top panel) or benefit (bottom panel), with red indicating a higher value
and blue indicating a lower value.
38

Figure 8: The Effect of Externalities and Congestion on the Welfare Impacts
of Infrastructure Improvements

0.02
0.018

0.014
0.012
0.01

kl

Externalities:
dlnW/dlnt ( =0.1, =-0.3)

0.016

0.008
0.006
0.004
0.002
0
0

0.005

0.01

0.015

0.02

0.025

0.02

0.025

Congestion & externalities:
Welfare increase from 10 additional lane-miles (million $ / year)

Efficient equilibrium:
dlnW/dlntkl (= value of trade flows on link)

800
700
600
500
400
300
200
100
0
0

0.005

0.01

0.015

Efficient equilibrium:
dlnW/dlntkl (= value of trade flows on link)

Notes: This top panel of this figure depicts the relationship between the imputed value of
trade traveling over each segment of the U.S. Highway System and the estimated welfare
elasticity in the presence of spillovers. Note that in the absence of spillovers, the welfare
elasticity should be exactly equal to the value of trade traveling over a segment; hence,
the only reason the correlation is not perfect is due to market inefficiencies caused by the
presence of spillovers. The bottom panel compares the imputed value of trade to the welfare gains (measured in millions of 2012 U.S. dollars) to adding ten additional lane-miles;
this correlation is not perfect due to market inefficiencies arising both from the presence of
spillovers and from congestion externalities.
39

Figure 9: The Rates of Return on Transportation Infrastructure Improvements
!
(
!
(
!
(
!
(!
(
!
(
(!
!
(!
!
(
((
!!
(
!
(

(
!
!
(
(
(!
!

(!(
!

!
(

!
(

!
(
!
(

!
(

(
!

!
(

!
(

!
(!
!
(
(

!
(

(
!
(
!

(
!
!
(!
(
!
(
(!

!
(

(
(!
!

(
!
(!
!
(
(
!
(!
!
(
!
(
(
!
!
!
(
(!
(
!
(
!
(

(
!!
(

(!(
!

!
(

!
(

!
(!
(

!
(!
(

!
(

!
(
!
(

!
(

!
(
(
!
!
(
!
!
!
(
(
(
!
(!
(
(
!

!
(
!
((
!
(
(
!
(!
(!
!
(!
!
( !
!
!
(!
(
(
(
!
(
!
(
!
(!
!!
(
( !
!!
(!
(
(!
(
!
(( !
((!
(!
(
!
!
(!
(
(!
!
(!
(
(!
(
!
(
!
((
!
!
(
(!
(!

!!(
(
!
(

!!
(
(!(

(
(!
!

!
(

(
!

(!(
!
(!
!
(!
( !
((
(
!
(
!
(
!
(
!
(
!
!
( !
!
(

(!( !(
!
(
!
!
(
!
(

(
!
(
(
(!
!
(!
!

!
(
!
(

(
!
!
(

!
(

(
!
(
!
(!
!
(

!
(!
(!
(

(
!
(
!
(!

!
(

Rates of return for an additional 10 lane-miles
Log(Annual benefit / Annual cost)
0.62 - 1.00
1.01 - 1.10
1.11 - 1.25

!
(

!
(

(
!

3.01 - 5.00

(
!

(!
(!
!
(

(
!

(
!

!
(
!
(

!
(

(
!

(
!
(!
!
(!
(
!(
!
((!
!
(

!
!(
(

!
(

!
(

(
!
!
(
!
(

!
(
!
(

!!(
(

!
(

(
!

!
(

!
(
!
(

!
(

!
( !
(

(
!

(!
(
!
( !
!
(

(
(!
!
(
!
(!
(!(!
!
(
(
!

!
(
!
(!( !((!!
!
(!
(
!
(
(
!
( !
!
!
(
(!
(!
(!
(!
(!
(!
!
(
(!
!
((
!
!
((
(
(
!
( !

!
(
!
(

!
(

(
!
!
(
(
!

(!(
!
(!

!
(
!
(

!
(
(
(!
!

(
!
!
(

!
(

!
(

!
(!(

!
(
!
(!
(!
(!
(

(!(
!

!
(

(
!

(
!

(
!
!
(

!
(

(
!

!
(

(
!

!
(

(
!

!
(

(
!
!
(

!
(

(
(!
!
!!
(
(

(
!

!
(

!
(
!
(

!
(

(
!
!
(
(
(!
!

(
!

!
(

!
(

(
!

!
(!
!
(
((!
!
(!
(

!!(!(!(!(!(!(!(!(!(!(!(!(!(!( !(
(
!
(!
(
!
(!
(

(
!

(
!

(!(
!

(
!

!
(
!
(
!
(
(!
(!
(!
(
!
!
(
(
!
(!
!
(
!
(!
!
(
(
(
!
(!
(!
!
(
!
(
!
!
(!
(
(!
(
!
(
!
(
(
!
!
(
(
!
!
(
!
(!
(!
(
!
( !(
!
!
(
(
!
(!
!
(
(
!
(
(
!
(!
(!
!
!
((
!
(
(!
!
(
(
!
(
!

!
(

(
!

(
!

(
!

(
!

!
(

!!(!
(
( !
(!(!
(

!
(
!
(
!
(
!
(!
!
(

!!((!(
(
(
!

(
!

!
(
(
!
(
!

!
(

(
!

(
!
!
(

!
(
!
(
! !
(
(
!
(

!
(

!
(

!
(

(
!

(
!

(
!

!
(!
(

!
(

!
(

!
(

!
(

!
(

!
(
(
!

(!(
!

!
(
(
!
( !

(!(
!

(
!
(!
!
(
(!

!
(
!
(

!
(

!
(

(
!

(
!
! !(
(
!
(
!
(!
!
(
(

1.51 - 1.75

2.01 - 3.00

(!
(
(!
!
(!

!
(
!
(
!
(

!
(

!
(
!
(
!
(!
!
!
(
(
!
(
!
!
(
(
(
!
(
!
!
(!
(
(
!
!(
(
!
!
((
!
(
(
!

(
!

1.26 - 1.50

1.76 - 2.00

(!(
!

!
(

!
(

!
(
(
!

!
(

(
!

!
(

(
!!
(

!
(

!
(

!
(
(
!

!
!
(
(

(
!

!
(
(
!
!
(
(!
(!
!!
(
!
(
!
(!
(
(
!
(
!
(
!
(
(
!
!
!
(
(
!
!
(
(

!
(

!
(

(
!

!
(

(
!

!
(

!
(!
(

!
(

!
(

!
(
!
(

!
!
!
(!
(
(
(!
(
!
(!
(
!
!
!
(
(
(
(
!
!
(
(
!
(
!
(!
(
(!
!
(
!!(!
(

(
!
!
(!
(
(!

!
(
!
(

!
(
(
!!(!( !
(

!
(

(
!

(
!
( !

(!( !(
!

(!(
!

(
!

(
!

(
!

!
!(
(
!
(

!
(

!
(

!
(

(
!

(
!

!
(
(!
!
(
(
!
(!
!
(
(!
!
(!
(
(!

!
(

!
(!
(

(
!

!
(
(
!
(!

(

!
(

(
!
!
(

!
(

(
!

(
( !
!
(
!
(!
!
(!
((!!
(!
(!
(!
!
!
!
!
(
(
(!
(
!
!
!
(!
!
(
!
(
(
!
(
(
!
(
!
!
(!
(
(!
(
(
!
!
(
(
(
(
!
!
(
(
!
(
!
!
(
(
!
(
!
(
!
(!
!
(
!
(!
(
(
!
!
!
(
!
(
!
!
!
(
(
(
(
(
(
!
!
(!
(
!
(
!
(
(
(
!
(
!
(
!
!
!
!
(
(
(
!
(
!
(
!
(!
(!
!
(
!
(
!
(
(
!
(
!
!
(
( !
!
(
!
!
(!
(
(
!
(
(!(!(!
!
!
(
!
((

!
(
!
(

(!(
!

(
!
(!
!
(
!
(
!
(
( !(!(!(!(!(!(!((
!
!
!
!
(
(
!
!
!
(
!
(
(!
!
(
(
!
!
(
!
(
(
(
!
(
!
!
(
(
(
!
!
!
!
!
(
(
(
(
!
(
!
(
(
!
(
!
(
!
!
!
(
(
!
!
!
(!
(
(
!
(!
(
(
!
!
(
!
(
!
!
(
!
(
(
!
!
(
!
!
(
!
(
(
(
(
(
!
(
!
(
(
!
!
!
(
!
(
(!
(!
(
!

!
(

(!(
!

(
!
(
!
(
!

!
(

(
!

(
!

!
(

!
(

!
(

!
(!
(

(
!

!
(

(
!
!
(!
(
(
!!
(
!
(!
!
!
(
(
(
(
!
(
!
!
!
(
!
((

(!
!

!
(
(!

!
(

!
(

!
(
!
(
!
(
!
(

!
(
!
(

(
!

!
(

!
(

!
(
!
(

!
(

!
(

!
(

!
(

!
(

!
(

(
!

!
(
!
(

(!(!(
!

!
(

(
!

!
(
!
(

!
(
!
(

(
!
!
(

!
(

(
!

!
(
!
!
!
(
((
!
(
!
!
(
(
!
(
!
(
!
(
(
!
(!
!
(
!
!
(
(
!
(
!
(
(!
!
(

(
!

(
!
(
!
(
!
!
(
(
!

Notes: This figure reports the rate of return (calculated as the log ratio of benefits to costs)
of improving each segment of the highway system. The color of each link indicates its rate
of return, with red indicating a higher value and blue indicating a lower value.

40

41

Origin City
White Plains
North Hempstead
Islip
Greenburgh
Center
Indianapolis
Bayonne
Hempstead (Town)
Hempstead (Town)
Costa Mesa

Origin State
New York
New York
New York
New York
Indiana
Indiana
New Jersey
New York
New York
California

Destination City
Greenburgh
Queens
Brookhaven
White Plains
Indianapolis
Center
Staten Island
Queens
Hempstead
Newport Beach

Destination State Cost ($m / yr) Benefit ($m / yr) Rate of return (log ratio)
New York
3.76
510.50
4.91
New York
5.35
719.46
4.90
New York
1.92
257.49
4.90
New York
3.76
479.62
4.85
Indiana
2.06
206.89
4.61
Indiana
2.06
194.91
4.55
New York
1.92
179.89
4.54
New York
5.11
475.31
4.53
New York
3.76
318.10
4.44
California
3.76
303.79
4.39

Notes: This table reports the ten highway links that have greatest benefit to cost ratio in
the United States.

Rank
1
2
3
4
5
6
7
8
9
10

Table 1: Top 10 Highways Segments

6
6.1

Appendix
Proof of Proposition 1

We have that
τij (ν) =

min

p∈PK ,K≥0

where we have defined
τ̃ij (p) =

τ̃ij (p) εij (p, ν) .

K
Y

tpk−1 ,pk .

k=1

Replacing in the formula we need to compute


Q

K
k=1 tpk−1 ,pk

d ln E minp∈PK ,K≥0
d ln τij
=
d ln tkl
d ln tkl



εij (p, ν)



Notice that we can split the set Pk into elements that include paths passing through kl
(indicated as PK∩kl ) and ones that do not (PKrkl ). Thus,
d ln τij
=
d ln tkl

Q
QK
d(E minp∈PK∩kl ,K≥0 ( K
k=1 tpk−1 ,pk )εij (p,ν)+E minp∈PKrkl ,K≥0 ( k=1 tpk−1 ,pk )εij (p,ν))
dtkl

tkl .

τij

By definition the derivative of the second term is zero, and thus,


Q

K
k=1 tpk−1 ,pk

Eε minp∈PK∩kl ,K≥0
d ln τij
=
d ln tkl
τij



εij (p, ν)


,

which is indeed the cost of the routes from i to j passing through kl versus the expected cost
of i to j.

6.2

Proof of Proposition 2

First note that this elasticity is equal to the elasticity of an element of the route cost matrix
to a change in the element of the weighted adjacency matrix A:
 1
−
∂
ln
cbij θ
∂ ln bij
∂ ln τij
 1 =
=
.
−
∂ ln tkl
∂ ln akl
∂ ln akl θ

42

To calculate this elasticity, we parameterize the weighted adjacency matrix as a function of
a variable t follows:

a
if k =
6 i or l 6= j
ij
,
Akl (t) =
t
if k = i and l = j
i.e. changing t just increases akl . By defining Ckl (t) ≡ I − Akl (t), we have:
"
#
∂ ln bij
dCkl (t)−1
akl
=
×
∂ ln akl
dt
bij

(27)

ij

Using the familiar expression for the derivative of an inverse of a parameterized matrix (see
e.g. Weber and Arfken (2003)), we have:
dCkl (t)−1
dCkl (t)
= −Ckl (t)−1
Ckl (t)−1 .
dt
dt
Note that

dCkl (t)
dt

=


0

if k 6= i or l 6= j

−1 if k = i and l = j

and Ckl (t)−1 = B so the derivative becomes:

dCkl (t)−1
= BEkl B,
dt
where Ekl is an N × N matrix equal to one at (k, l) and zeros everywhere else. The (i, j)
component of this inverse is hence:
"

dCkl (t)−1
dt

#

"
= [BEkl B]ij =

#
XX
n

ij

kl
bim Emn
bnj

m

= bik blj ,

(28)

ij
−1

θ
so combining equations (27) and (28) and using the relationships akl = t−θ
kl and τij = cbij
yields expression (7).
We now derive the probability of using link kl along the path from i to j. Given the
extreme value distribution, the probability of taking any particular path p of length K can
be written as:

τij (p)−θ
.
P
0 )−θ
τ
(p
0
ij
K=0
p ∈Pij,K

πij (p) = P∞

43

τij (p)−θ
⇐⇒
P
0 )−θ
τ
(p
0
ij
K=0
p ∈Pij,K

πij (p) = P∞

K
1 Y
πij (p) =
ap ,p ,
bij k=1 k−1 k

(29)

where the second line used the definition of τij (p) from equation (1) and the derivation for
equation (5). As a result, we can calculate the probability of using link tkl when traveling
from i to j by summing across all paths from i to j that use the link tkl :
πijkl

∞
K
1 X X Y
apk−1 ,pk ,
=
bij K=0
kl
k=1
p∈Pij,K

kl
is the set of all paths from k to l of length K that use link tij .
where Pij,K
kl
Note that for any p ∈ Pij,K
, there must exist some length B ∈ [1, 2, ..., K − 1] at which
the path arrives at link tkl so that this can be written as:




∞ K−1
B
X
X
X
Y
X
1

πijkl =
apk−1 ,pk  × akl × 
bij K=0 B=0 p∈P k=1
q∈P
ik,B

kj,K−B−1

K−B−1
Y


aqk−1 ,qk 

k=1

As above, we can then explicitly enumerate all possible paths from i to k of length B and
all possible paths from l to j of length K − B − 1:




N
N
∞ K−1
N
N
X
X
X
X
X
X
1

ai,k × . . . × akB−1, k ×akl ×
al,k1 × . . . × akK−B−1, j  ,
···
···
πijkl =
bij K=0 B=0 k =1 k =1 1
k =1
k
=1
1

1

B−1

K−B−1

which again can be expressed more simply as elements of matrix powers of A :
πijkl

∞ K−1
1 XX B
=
A × akl × AK−B−1
lj
bij K=0 B=0 ik

This is where it gets a little more difficult. Recall from matrix calculus that the derivative
of the power of a matrix can be written as:
DSK (A) C =

K−1
X
B=0

44

AB CAK−B−1 ,

(30)

where SK (A) = AK and C is an arbitrary matrix. Furthermore, recall from above that the
geometric series of a power of matrices can be written as:
∞
X

AK = (I − A)−1 .

K=0

Hence, we can right multiply both sides of equation (30) by C and differentiate to yield:
∞
X

DSK (A) C = DT (A) C,

K=0

where T (A) ≡ (I − A)−1 . Recall from matrix calculus (see e.g. Weber and Arfken (2003))
that DT (A) C = (I − A)−1 C (I − A)−1 so that we have:
∞ K−1
X
X

AB CAK−B−1 = (I − A)−1 C (I − A)−1 .

(31)

K=0 B=0

Define C to be an N × N matrix that takes the value of akl at row k and column l and zeros
everywhere else. Using equation (31) we obtain our result:
πijkl =

6.3

bik akl blj
.
bij

Proof of Theorem 1

Define the auxiliary variables

1−σ

xi = (W α(σ−1)+β(σ−1) Li )β(σ−1)+1 wiσ ,
1−σ

yi = (W α(σ−1)+β(σ−1) Li )α(σ−1) wi1−σ ,
so that

−1

α

β(σ−1)+1

wi = xiβ(σ−1)+1+ασ yiσ−1 β(σ−1)+1+ασ .
Also, define
ρ≡

2+α−β
1 + (σ − 1) β + ασ

45

for convenience. Given those definitions the two equation system given by equations (10)(11)can be transformed into
α+1
β(σ−1)+1+ασ

xi

(yi )

−β+1
β(σ−1)+1+ασ

=

N
X

Kij yi xj ,

j=1
α+1
β(σ−1)+1+ασ

xi

(yi )

−β+1
β(σ−1)+1+ασ

=

N
X

Kji xi yj .

j=1

We chose to impose normalization condition wN = 1, We now proceed to solve for the
comparative statics ddlnlnτxkli , ddlnlnτykli from the following system (Dln τkl G = 0: 2N equations,
2N unknown) by replacing the last equation with the linearized version of the normalization
condition
G11

= ln

N
X

K1j y1 xj −

j=1

−β + 1
α+1
ln x1 −
ln y1
β (σ − 1) + 1 + ασ
β (σ − 1) + 1 + ασ

......
G1N

= ln

N
X

KN j yN xj −

j=1

G21

= ln

N
X

Kj1 y1 xj −

j=1

α+1
−β + 1
ln xN −
ln yN
β (σ − 1) + 1 + ασ
β (σ − 1) + 1 + ασ

α+1
−β + 1
ln x1 −
ln y1
β (σ − 1) + 1 + ασ
β (σ − 1) + 1 + ασ

......
G2N −1

= ln

N
X

KjN −1 y1 xj −

j=1

G2N =

−β + 1
α+1
ln xN −1 −
ln yN −1
β (σ − 1) + 1 + ασ
β (σ − 1) + 1 + ασ

α
1
β (σ − 1) + 1
ln xN −
ln yN
β (σ − 1) + 1 + ασ
σ − 1 β (σ − 1) + 1 + ασ

The last row of DG matrix needs to be slightly modified.
"
DG =

σ(β+α)
I
β(σ−1)+1+ασ
1−β
λ0 − β(σ−1)+1+ασ I

α+1
I
β(σ−1)+1+ασ
(σ−1)(β+α)
I
β(σ−1)+1+ασ

µ−

#

"
−

λ1N

0
... λN −1,N λN N +

Taking total derivative of this system we can solve for the following

h
(σ − 1) (DG)−1

∂ ln yi
y,ik,1 µkl +
=
∂ ln τkl (σ − 1) (DG)−1 µ
y,ik,1 kl

46

(DG)−1
x,il,1

λkl

i

if l 6= N
if l = N

.

β
α

0
0

#
.

Similarly,

h
(σ − 1) (DG)−1

−1
y,ik,2 µkl + (DG)x,il,2 λkl

∂ ln xi
=
∂ ln τkl (σ − 1) (DG)−1 µ
y,ik,2 kl

i

if l 6= N

.

if l = N

We can expression the derivative of welfare in terms of these derivatives
d ln W
=−
d ln τkl



2−ρ
2σ − 1

X
i



Li d ln xi
σ d ln yi
+
,
L̄ d ln τkl σ − 1 d ln τkl

and substituting in:


− (2 − ρ)




σ−1
2σ−1

P



Li
i L̄



(DG)−1
y,ik,2

σ
σ−1

(DG)−1
y,ik,1



µkl
+
−

P


d ln W
−1
−1
Li
σ−1
σ
= (2 − ρ) 2σ−1
if l 6= N
λkl
i L̄ (DG)x,il,2 + σ−1 (DG)x,il,1
d ln τkl 





− (2 − ρ) σ−1  µ P Li (DG)−1 + σ (DG)−1
.
if l = N
kl
i L̄
y,ik,2
y,ik,1
2σ−1
σ−1
To proceed with further characterizing this expression we make the following definitions:
− (1 + κk ) = (2 − ρ) σ̃

X Li 
i



and

1 − σβ − α (σ − 1)
1 + (σ − 1) β + ασ



L̄

σ
(DG)−1
(DG)−1
y,ik,2 +
y,ik,1
σ−1

!

1
⇐⇒
Yk

!
X Li 
σ
1
(DG)−1
= 1 + κk ,
σ̃
(DG)−1
y,ik,1
y,ik,2 +
σ
−
1
Y
L̄
k
i

!
X Li 
σ
1
−1
−1
−νk = (2 − ρ) σ̃
(DG)x,ik,2 +
(DG)x,ik,1
⇐⇒
σ−1
Ek
L̄
i

!

X Li 
σ
1
1 − σβ − α (σ − 1)
σ̃
(DG)−1
= νk ,
(DG)−1
x,ik,2 +
x,ik,1
1 + (σ − 1) β + ασ
σ
−
1
E
L̄
k
i

which gives us expressions (18) and (19), where
"
DG =

σ(β+α)
I
β(σ−1)+1+ασ
1−β
λ0 − β(σ−1)+1+ασ I

α+1
I
β(σ−1)+1+ασ
(σ−1)(β+α)
I
β(σ−1)+1+ασ

µ−

#

"
−

λ1N

0
... λN −1,N λN N +

Thus, we finally arrive to the expression of the Theorem,

X (1 + κ + ν ) if l 6= N
d ln W
kl
k
l
,
=
d ln τkl Xkl (1 + κk )
if l = N
with the corresponding definitions of κk and νl .
47

β
α

0
0

#
.

