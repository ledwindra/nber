NBER WORKING PAPER SERIES

ILLIQUID ASSETS AND OPTIMAL PORTFOLIO CHOICE
Eduardo S. Schwartz
Claudio Tebaldi
Working Paper 12633
http://www.nber.org/papers/w12633

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
October 2006

The present paper has been started while the author was member of the faculty of Economics, Verona
University and visiting scholar at the Anderson School of Management, Faculty of Finance. We thank
J. Cvitanic for his helpful comments on an earlier version of the paper. C.T. gratefully acknowledges
the Anderson School, the Finance Faculty and in particular Prof. Schwartz for the kind invitation and
warm hospitality. C.T. would also like to thank Marina Di Giacinto for constant support and many
valuable comments, Martino Grasselli, the participants to the seminar at University of Torino, to the
workshop at Bocconi University, R. Gibson, F.Gozzi, F. Zapatero and the participants to the WFA
2007 meeting for several insights and helpful discussions. The views expressed herein are those of
the author(s) and do not necessarily reflect the views of the National Bureau of Economic Research.
Â© 2006 by Eduardo S. Schwartz and Claudio Tebaldi. All rights reserved. Short sections of text, not
to exceed two paragraphs, may be quoted without explicit permission provided that full credit, including
Â© notice, is given to the source.

Illiquid Assets and Optimal Portfolio Choice
Eduardo S. Schwartz and Claudio Tebaldi
NBER Working Paper No. 12633
October 20065HYLVHG1RYHPEHU
JEL No. G11
ABSTRACT
The presence of illiquid assets, such as human wealth or a family owned business, complicates the
problem of portfolio choice. This paper is concerned with the problem of optimal asset allocation and
consumption in a continuous time model when one asset cannot be traded. This illiquid asset, which
depends on an uninsurable source of risk, provides a liquid dividend. In the case of human capital
we can think about this dividend as labor income. The agent is endowed with a given amount of the
illiquid asset and with some liquid wealth which can be allocated in a market where there is a risky
and a riskless asset. The main point of the paper is that the optimal allocations to the two liquid assets
and consumption will critically depend on the endowment and characteristics of the illiquid asset,
in addition to the preferences and to the liquid holdings held by the agent. We provide what we believe
to be the first analytical solution to this problem when the agent has power utility of consumption and
terminal wealth. We also derive the value that the agent assigns to the illiquid asset. The risk adjusted
valuation procedure we develop can be used to value both liquid and illiquid assets, as well as contingent
claims on those assets.

Eduardo S. Schwartz
Anderson Graduate School of Management
UCLA
110 Westwood Plaza
Los Angeles, CA 90095
and NBER
eduardo.schwartz@anderson.ucla.edu
Claudio Tebaldi
Dipartimento di Scienze Economiche
Sezione Giardino Giusti
Via Giardino Giusti 2
37129 Verona , Italy
claudio.tebaldi@mail.univr.it

1

Introduction

The problem of optimal asset allocation is of great importance both in the
theory as well as in the practice of ï¬nance. Since the seminal work of
Markowitz (1952) scholars and practitioners have looked at the issue of how
much money should an investor optimally allocate to diï¬€erent assets or asset classes. The single period model of Markowitz (1952) was extended to
a multiperiod setting by Samuelson (1969) and then to continuous time by
Merton (1969, 1971). The traditional approach assumes that all assets can
be traded at all times. This paper is concerned with optimal asset allocation
in a continuous time model when one asset cannot be traded.
Typical examples of assets in which trading is problematic include human
wealth and a family owned business. When the asset allocation problem is
solved without taking into account the existence of these â€œilliquidâ€assets the
allocation is certainly suboptimal. Consider the following example.a Two
individuals with the same wealth, the same preferences and the same horizon would invest in the same portfolio using the traditional asset allocation
framework. However, if one of the individuals is a stock broker with his
human wealth highly correlated with the stock market, and the other is a
tenured university professor with his human wealth independent of the stock
market, it would be reasonable to expect that they would have diï¬€erent
allocations. This is the problem we address in this paper.
There are many deï¬nitions of illiquid assets. To make the problem
tractable, in this paper we assume that illiquidity prevents the trading of
the asset over the time horizon we consider (though this time horizon could
become inï¬nite). The illiquid asset, however, provides a liquid â€dividendâ€
that is related to the level of an observable state variable associated with
the illiquid asset. In the case of human wealth the dividend could be labor
income and in the case of a proprietorship it could be distributed proï¬ts from
the business. The uncertainty that drives the illiquid asset cannot be fully
diversiï¬ed in the market. Since the asset is not traded, the state variable
associated with the illiquid asset can not be interpreted as a price. In the
ï¬nite horizon case this state variable becomes the price of the asset only at
the terminal date.
We assume that the agent in endowed with a given amount of the illiquid
asset and with some liquid wealth which can be allocated in a market where
there are two liquid assets: a risky asset and a risk free asset. The main point
of this paper is that the allocations to the two liquid assets and consumption
will critically depend on the endowment and characteristics of the illiquid
asset, in addition to the preferences and liquid wealth of the agent.
a

This example was presented by Robert Merton in a talk in Verona, Italy in June 2003.

2

In the process of establishing the optimal allocation to the liquid assets
we also derive the value that the agent assigns to the illiquid asset. This
value depends not only on the level of the state variable associated with the
illiquid asset, but also on the preferences of the agent.
The problem of asset allocation in the presence of illiquid assets has been
the subject of intense research in the ï¬nance literature since the late 60â€™s.
Recognizing the complexity of the subject simplifying assumptions have been
introduced to make the problem tractable.
Among non tradable assets, human wealth is certainly the most relevant
source of risk in the individual allocation problem which is diï¬ƒcult to insure
or diversify. Bodie, Merton and Samuleson (1992) consider a long horizon investor with a riskless stream of labor income and show that an investor with
riskless non tradable human wealth should tilt his ï¬nancial portfolio toward
stocks relative to an investor who owns only tradable stock. Jagannathan
and Kocherlakota (1996) show that this advice is economically sound as long
as the human wealth is relatively uncorrelated with stock returns. Zeldes
(1989) performs a numerical study of a discrete time model of optimal consumption in the presence of stochastic income. Koo (1995) and Heaton and
Lucas (1997) introduce risky labor income and portfolio constraints in an
inï¬nite horizon portfolio choice problem and, using a numerical simulation,
focus on how the presence of background risks from sources such as labor,
inï¬‚uences consumption and portfolio choice. Both papers ï¬nd that investors
hold most of their ï¬nancial wealth in stocks. Koo (1995) shows numerically that an increase in the variance of permanent income shocks decreases
both the optimal portfolio allocation to stocks and the consumption labor
income ratio of power utility investors. In a discrete time framework Viceira
(2001) considers an approximate solution and ï¬nds that positive correlation
between labor income innovations and unexpected ï¬nancial returns reduces
the investorâ€™s willingness to hold liquid risky asset because of its poor properties as an hedge against unexpected declines in labor income. Consistently,
Heaton and Lucas (2000) ï¬nd that entrepreneurs have signiï¬cantly safer portfolios of ï¬nancial assets than other investors with similar wage and wealth.
Campbell and Viceira (2002) provide a comprehensive discussion of the empirical testing and of the economic implications of including human wealth
in the household portfolio choice problem. Dybvig and Liu (2004) consider
a lifetime consumption/investment model with endogenous retirement date.
Wang (2006) provides a complete discussion of the consumption choices of
an agent with human and liquid wealth under the assumption of exponential
utility function.
A related literature deals with portfolio choice in the presence of assets
which cannot be traded. To our knowledge the ï¬rst treatment is due to Myers

3

(1972, 1973) which solves the static version of the problem. In a dynamic context, the problem we solve can be seen as the limit of large transaction costs
of the Grossmann and Laroque (1990) model for illiquid durables. Svensson
and Werner (1993) provide a treatment with exponential preferences. Kahl
Liu and Longstaï¬€ (2003) formulate and provide a numerical solution to the
optimal dynamic allocation problem of an investor with power utility whose
portfolio includes a stock which cannot be sold. Among the possible sources
of background risk in household portfolios, housing is certainly one important asset class that is relatively illiquid and undiversiï¬ed. Analyzing risk
and return is however complicated because of the unobservable ï¬‚ow of consumption of housing services. Flavin and Yamashita (1998) consider housing
both as an asset and as a source of consumption, and obtain the optimal
portfolio allocations by simulation.
There is a large strand of the literature in stochastic optimization which
addresses the continuous time portfolio allocation problem in incomplete
markets both with the direct partial diï¬€erential equation approach and with
the martingale-measure duality approach. Duï¬ƒe, Fleming, Soner and Zariphopolou (1997) study an asset allocation problem for an investor which
maximizes HARA utility (with relative risk aversion coeï¬ƒcient smaller than
1) from consumption in a market composed by a risky and a riskless asset and
receives an income which cannot be replicated by other securities. This study
proves existence, uniqueness and regularity of the value function, while the
optimal consumption path and the allocation strategy are implicitly speciï¬ed
throughout a feedback expression. Koo (1998) analyzes the same problem in
the presence of constraints.
The stochastic optimization problem we discuss is strictly related to the
utility based pricing of contingent claims whose underlying assets are non
traded. Some of the important references are: Davis (1999), Detemple and
Sundaresan (1999), TeplaÌ€ (2000), Hobson and Henderson (2002), Henderson
(2002) and Musiela and Zariphopolou (2004a). However, the case of an agent
with power utility for consumption and terminal wealth, with dividends from
the illiquid asset has so far resisted analytical treatment.
Our results are based on the duality approach pioneered by Cox and
Huang (1989), He and Person (1991), and Karatzas et al. (1991). He and
Pages (1993) and El Karoui and Jeanblanc (1998) deal with a constrained version of the problem when labor income risk can be diversiï¬ed in the market.
When the agent receives an uninsurable random endowment the mathematical formulation of the stochastic control problem becomes diï¬ƒcult. Existence
results under very general conditions on the price processes and on the utility
function have been obtained by Cuoco (1997) attacking directly the primal
problem, while exact results on the duality approach have been established

4

by Cvitanic, Schachermayer and Wang (2001) in the case of maximization of
utility from terminal wealth and extended by Karatzas and Zitkovic (2003)
and Zitkovic (2005) to the problem with intertemporal consumption and
constraints. Our solution strategy is closely related to the dual veriï¬cation
approach of Mnif and Pham (2001) the solution to the primal problem is
characterized in terms of the solution to a dual singular control problem
which is solved by making use of the dynamic programming principle.
As far as we are aware, our paper contains the ï¬rst analytical solution to
this problem when the agent has power utility of consumption and terminal
wealth. The analytical solution obtained allows us to quantify the impact
of the assets characteristics and the agent preferences on optimal asset allocation and consumption. In particular, we show that the higher is the
correlation between the liquid and the illiquid asset, the lower will be the
allocation to the risky liquid asset. So, in the example given above the professor would optimally invest a higher proportion of his liquid wealth in the
risky liquid asset than the stock broker. Since the human wealth of the stock
broker is highly correlated with the stock market, and his human wealth is
non tradable, he will tend to invest a smaller fraction of his liquid wealth in
the market portfolio.
The analysis of the optimal consumption out of liquid assets shows that
the agent will make his consumption decision looking not only at his liquid
wealth but taking into account also his illiquid wealth. The computation
of the elasticity of consumption with respect to liquid and illiquid wealth
shows that for an agent with constant relative risk aversion the propensity to
consume out of liquid wealth will be always larger than out of illiquid wealth.
Moreover, the solution provides the expression for the stochastic discount
factor that the agent uses for his/her valuation of the illiquid asset. The
procedure reduces to risk neutral valuation for the liquid assets, while the
risk adjustment for valuing illiquid assets is found to be state dependent. The
optimal value function of the allocation/consumption problem determines the
analytical expression of the risk adjustment as a function of the liquidity state
variable, the preferences of the investor and the volatility of the non-traded
source of risk.
The paper is organized as follows. In Section 2 we introduce the economic
setting and its mathematical formulation, in Section 3 we provide the analytical solution to the Hamilton Jacobi Bellman equation. Section 4 provides a
discussion of the optimal consumption and allocation policies. Section 5 derives the stochastic discount factor that the agent will use in the valuation of
the illiquid asset. In Section 6 we analyze the sensitivity of the control policies to diï¬€erent parameters and Section 7 concludes. The Appendix contains
the proofs and some technical results.

5

2

Economic setting

Consider a continuous time economy where prices evolve stochastically in a
ï¬ltered probability space {â„¦, F, P} supporting a two dimensional Brownian
motion (Wt1 , Wt2 ) where F = {Ft }tâ‰¤T and Ft represents the augmented ï¬ltration generated by all the information reï¬‚ected in the market up to time t
and P is the objective probability measure. All the processes will be assumed
to be adapted to F. We ï¬x a ï¬nal time horizon T , the epoch at which the
non traded (illiquid) asset becomes tradable and can be consumed.
The market is composed of three assets:
â€¢ The risk free bond Bt , whose dynamics is:
dBt = rBt dt t â‰¤ T,
where r is the continuously compounded risk free interest rate which,
for simplicity, we assume to be constant.
â€¢ A traded liquid risky asset St , whose dynamics is:
dSt
= Î±dt + ÏƒdWt1
St

t â‰¤ T,

where Î± (> r)is the continuously compounded expected rate of return
on the risky liquid asset, and Ïƒ is the continuous standard deviation of
the rate of return.b
â€¢ An illiquid risky asset Ht (no trading is allowed until time T , when it
can be consumed), whose dynamics is:
(
)
âˆš
dHt
1
2
2
= (Âµ âˆ’ Î´)dt + Î· ÏdW + 1 âˆ’ Ï dW
Ht

t â‰¤ T,

(1)

where Âµ is the continuously compounded total expected rate of return
on the risky illiquid asset, Î´ > 0 is the liquid continuous rate of dividend
paid by the illiquid asset, Î· is the continuous standard deviation of the
rate of return, and Ï is the correlation coeï¬ƒcient between the dynamics
of the liquid and the illiquid risky asset.c
b

For simplicity we assume that the liquid risky asset pays no dividends, but the analysis
would be the same if the asset paid a continuous dividend
c
Since human wealth will enter in the state equation for liquid wealth equation only
through dividends, the dividend plays exactly the same role of a stochastic income for
the agent. For this reason, our allocation problem can be considered as the finite horizon
counterpart of an allocation problem in the presence of an uninsurable stochastic income.

6

Since the illiquid asset Ht cannot be traded at any time t < T , it represents the level of a state variable associated with the illiquid asset, i.e. the
process which generates the random cashï¬‚ows: Î´Ht at time t < T and HT
at time T . At time T , the state variable, HT , becomes equal to the price of
the illiquid asset.
We assume that the investor has time additive separable preferences and
maximizes a CRRA utility from consumption and ï¬nal wealth, with positive
relative risk aversion coeï¬ƒcient Î³ > 0 and diï¬€erent from 1. The intertemporal optimization problem of the agent is then given by:
sup
(Ï€,c)âˆˆA(l,h,t)

U

(t, c, WTÏ€,c )

:

=

EtP

[âˆ«

U (t, c, WTÏ€,c )
]

T

e

âˆ’Îº(uâˆ’t)

âˆ’Îº(T âˆ’t)

UÎ³ (cu ) du + Î²e

UÎ³ (WTÏ€,c )

t

with UÎ³ (x) =

x1âˆ’Î³
1âˆ’Î³

f or x â‰¥ 0,

UÎ³ (x) = âˆ’âˆ f or x < 0.

The set of admissible plans with initial liquid wealth l, and initial level of
the illiquid state variable h, A (l, h, t), is deï¬ned as the set of admissible
consumption-allocation plans (c, Ï€). The consumption stream, c â‰¡ (cÏ„ )tâ‰¤Ï„ â‰¤T ,
speciï¬es the agentâ€™s
(
)consumption rate of liquid assets, while the allocation
strategy Ï€ = Ï€ SÏ„ , Ï€ B
Ï„ tâ‰¤Ï„ â‰¤T denotes the dollar amounts invested in the risky
and riskless liquid assets at any time Ï„ between t and T . Assume that at time
t the agent holds an amount of liquid wealth l > 0, and a nominal amount of
illiquid asset Ht = h â‰¥ 0, then (c, Ï€) is admissible if there exists a strategy
Ï€ which ï¬nances a consumption stream c, i.e.
Lt = l,
LÏ„ = Ï€ SÏ„ + Ï€ B
t â‰¤ Ï„ < T,
Ï„ ,
S
B
LT = Ï€ T + Ï€ T + HT ,

(2)
(3)

and the dynamics of liquid wealth is:
(
dLÏ„ = (rLÏ„ + Î´HÏ„ âˆ’ cÏ„ ) dÏ„ +

Ï€ SÏ„

dSÏ„
âˆ’ rdÏ„
SÏ„

)
.

(4)

At the ï¬nal time T the investor will optimally consume his total liquid wealth,
WTÏ€,c = LT which includes the wealth obtained by liquid investment, LT âˆ’ =
limtâ†’T âˆ’ Lt , and the illiquid wealth, HT , i.e. LT = LT âˆ’ + HT . It is assumed
that the agent faces the solvency constraint that the ï¬nal liquid wealth must
be non negative, i.e. WTÏ€,c â‰¥ 0. If the illiquid asset is perfectly correlated with
the market the agent will eï¬€ectively borrow since he can perfectly hedge the
risk of both assets. Our discussion will focus to the more interesting situation
7

of an illiquid asset which is partially correlated with the market. It will be
assumed that âˆ’1 < Ï < 1 and Î³ > 0. Under these hypotheses, starting
with strictly positive liquid wealth, it will never be optimal to reach negative
liquid wealth at t < T . This is implied by the following argument: suppose on
the contrary that a negative position in liquid wealth is possible, then there
would be a small but non vanishing probability for the ï¬nal total wealth to
be negative but this is prevented by the fact that marginal utility at time T
is diverging at zero liquid wealth. Hence in order to have nonnegative liquid
wealth at time T the agent will never borrow and the solvency constraint
implies the stronger no-borrowing constraint: Lt â‰¥ 0 a.s. for any t â‰¤ T .
In order to ï¬nd an optimal solution process for wealth which does not
violate the no borrowing constraint, we are forced to enlarge the class of
admissible dynamic allocation policies including also singular consumption
and allocation policies, i.e. the consumption rate and the allocation can be
changed by a ï¬nite amount in an inï¬nitesimal time. These singular policies
will typically occur when the zero wealth boundary is hit and the liquidity
constraint becomes active.

3

Solution of the stochastic optimization
problem

We search for the value function deï¬ned by:
V (l, h, t) :=

sup
(Ï€,c)âˆˆA(l,h,t)

U (t, c, WTÏ€,c ) .

(5)

The Hamilton Jacobi Bellman (HJB) equation corresponding to the above
stochastic optimization problem when t < T can be written as:
1
0 = Vt (l, h, t) + ÎºVt (l, h, t) + Î· 2 h2 Vhh (l, h, t) + (rl + Î´h) Vl (l, h, t)
(6)
2
[ S]
+ (Âµ âˆ’ Î´) hVh (l, h, t) + max G Ï€ + max
H [câ€² ]
â€²
Ï€S

c â‰¥0

1 ( S )2 2
Ï€
Ïƒ Vll (l, h, t) + Ï€ S Î·ÏÏƒhVlh (l, h, t) + (Î± âˆ’ r) Ï€ S Vl (l, h, t)
G [Ï€] =
2
c1âˆ’Î³
,
H [c] = âˆ’cVl (l, h, t) +
1âˆ’Î³
when l, h â‰¥ 0. With terminal boundary condition:
(l + h) 1âˆ’Î³
lim V (l, h, t) = Î²
tâ†’T âˆ’
1âˆ’Î³
8

When l > 0 the optimal allocation and consumption strategies will be obtained in feedback form solving:
câˆ— (l, h, t) = arg max H (c)

(7)

= [Vl (l, h, t)]âˆ’1/Î³
( )
Ï€ Sâˆ— (l, h, t) = arg max G Ï€ S

(8)

câ‰¥0

Ï€S

= âˆ’

Î± âˆ’ r Vl (l, h, t)
Î·Ï Vlh (l, h, t)
âˆ’ h
2
Ïƒ Vll (l, h, t)
Ïƒ Vll (l, h, t)

At zero liquid wealth, l = 0, the optimal feedback policies are determined
by:
cB
âˆ— (0, h, t) = arg max H (c)
0â‰¤câ‰¤Î´h

Ï€ Sâˆ—

(0, h, t) = 0

(9)

in fact for any allocation to the risky asset diï¬€erent from zero there would
be a positive probability to violate the no-borrowing constraint.

3.1

Homogeneity transformation

In order to reduce the number of state variables in the HJB equation from
two to one we conjecture that the value function that solves eq. (6) when
l â‰¥ 0 and h Ì¸= 0 has the form:
V (l, h, t) = h1âˆ’Î³ V (z, t)
z = l/h,

(10)

and verify that we obtain a single variable HJB equation for the reduced
value function V (z, t). The value function for the problem h = 0 is given by
the solution to the standard Merton (1971) solution. Inserting the expression
(10) in (6) and performing the maximizations in (7,8) we obtain that V (z, t),
z > 0, t < T has to obey:d
0 = Vt (z, t) + K1 V (z, t) + K2 zVz (z, t) âˆ’ K3

(Vz (z, t))2
+
Vzz (z, t)

+K4 z 2 Vzz (z, t) + F (Vz (z, t)) ,
where:

d

{

c1âˆ’Î³
F (x) = max (âˆ’c + Î´) x +
câ‰¥0
1âˆ’Î³

}
if z > 0

The expressions for the derivatives are given in Appendix 8.9.

9

(11)

and the coeï¬ƒcients are given by:
1
(1 âˆ’ Î³) Î³Î· 2
2
(
)
Î·Ï
= âˆ’ (Âµ âˆ’ Î´) + r + (Î± âˆ’ r)
+ Î³Î· 2 1 âˆ’ Ï2
Ïƒ
)2
(
1 (Î± âˆ’ r)
=
âˆ’ Î·ÏÎ³
2
Ïƒ
)
1 2(
Î· 1 âˆ’ Ï2 .
=
2

K1 = âˆ’Îº + (Âµ âˆ’ Î´) (1 âˆ’ Î³) âˆ’
K2
K3
K4

When z = 0 the corresponding reduced HJB equation is given by:
0 = Vt (0, t) + K1 V (0, t) + F0 (Vz (0, t)) ,
{
}
c1âˆ’Î³
F0 (x) = max (âˆ’c + Î´) x +
0â‰¤câ‰¤Î´
1âˆ’Î³
The computation of the constrained maximization is detailed in the Appendix. The terminal boundary condition is given by:
(1 + z)1âˆ’Î³
V (z, T ) = Î²
,
1âˆ’Î³

z = l/h,

In a related framework, Duï¬ƒe et al. (1997) observe that the above reduced
HJB equation corresponds to a stochastic optimization problem for an agent
with HARA utility solving a consumption investment problem where the
state variable zt represents the liquid wealth of the agent at time t which
consumes c , câˆ— (z, 1, t), receives a constant liquid endowment with a rate Î´
for t â‰¤ T and a lump sum payment of 1 at time T and the allocation strategies
are restricted by the no borrowing constraint zt â‰¥ 0. A key diï¬€erence with
respect to the original problem is that the endowment received by the agent
is non stochastic, since the change of variables allows to factor the term
depending from Ht out of the value function. In the next section we use a
duality transformation to determine an explicit expression of the reduced
value function V (z, t) for z â‰¥ 0, 0 â‰¤ t â‰¤ T .

3.2

Duality Transformation

In order to solve the above HJB equation for V (z, t) we need to consider a
change of variables: we introduce the dual value function for the consumption
investment problem, Ve (y, t), which is related to V (z, t) by the transform:
Ve (y, t) := sup {V (z, t) âˆ’ zy}
zâ‰¥0

10

(12)

The new variable y can be interpreted as the marginal indirect utility level
rescaled by a factor hâˆ’Î³ . The time T terminal condition for the reduced dual
value function is given by:
b

y
Ve (y, T ) = y âˆ’ Î² 1/Î³
y âˆˆ DT , (0, Î²)
b
Î²
y âˆˆ DTc , [Î², +âˆ)
Ve (y, T ) =
1âˆ’Î³
1
b = 1âˆ’
Î³
The presence of the state constraint complicates the discussion of the dual
problem introducing a boundary in the domain of the dual variable y.
Under the hypothesis that Î´ > 0, the agent with zero liquid wealth can
still consume a fraction of the dividend rate and correspondingly the level of
the dual variable, the scaled marginal utility from optimal consumption at
the zero wealth boundary is ï¬nite, i.e.
yB (t) , lim+ Vz (z, t) < +âˆ
zâ†’0

thus at each time for t < T the domain of deï¬nition of the dual value function
can be split into two regions Dt and Dtc deï¬ned by
Dt , {y âˆˆ (0, +âˆ) | y < yB (t)}
and:
{
}
Dtc , {y âˆˆ (0, +âˆ) | y â‰¥ yB (t)} âˆ© y âˆˆ (0, +âˆ) | y âˆ’1/Î³ â‰¤ Î´
The deï¬nition of Dtc takes into account that at zero liquid wealth the agent
cannot consume more than the liquid dividend rate, hence the set of admissible values for the dual state variable y â‰¥ yB (t) is further restricted by the
control constraint c = y âˆ’1/Î³ â‰¤ Î´ which implies y â‰¥ Î´ âˆ’Î³ .
Two diï¬€erent domain conï¬gurations are possible : if yB (t) â‰¥ Î´ âˆ’Î³ , then
c
Dt = [yB (t) , +âˆ), the set Dt âˆª Dtc = (0, +yB (t)) âˆª [yB (t) , +âˆ) is connected
and yB (t) separates Dt from Dtc , i.e. Dt âˆ©Dtc = {yB (t)}. This situation will
be denoted as Regime I.
[ âˆ’Î³
)
âˆ’Î³
c
=
Î´
,
+âˆ
, the set Dt âˆª Dtc =
On the contrary,
if
y
(t)
<
Î´
then
D
B
t
[ âˆ’Î³
)
(0, +yB (t)) âˆª Î´ , +âˆ is not connected. This situation will be denoted as
Regime II. Its characterizing feature is the anomalous geometry of the state
space, which is formed by two regions not connected.

11

3.3

The dual value function in Dt

The reconstruction of the scaled primal value functions from the dual one
is straightforward in the domain Dt provided that the dual value function
veriï¬es the following assumption on regularity:
Condition A The reduced dual value function Ve (y, t) is a strictly convex,
continuous function with continuous derivatives w.r.t to y âˆˆ Dt up to third
e
order and continuous
[
]ï¬rst order derivatives w.r.t. t âˆˆ (0, T ). R (y, t) ,
e (y, t) â‰¤ K âˆˆ R, âˆ€y âˆˆ Dt and
âˆ’Vey (y, t) / y Veyy (y, t) is bounded, i.e. R
t âˆˆ [0, T ].
Strict concavity of the value function (implied by Condition A) implies
that Vz (z, t) is a decreasing function of z and it is possible to deï¬ne:
z (y, t) = inf {z : z > 0,

Vz (z, t) < y}

and the relation z (y, t) : Dt â†’ {z > 0} is one to one. As a consequence the
Fenchel Legendre transform can be inverted and the following parametric
representation of V (z, t) holds:
V (z, t) = Ve (z (y, t) , t) + z (y, t) y
z = z (y, t)

y âˆˆ Dt

Hence the determination of the convex dual function Ve (y, t) for y âˆˆ Dt
uniquely identiï¬es V (z, t) for z > 0.
In addition, in the domain Dt , diï¬€erentiation of the convex duality relation implies that the following relations between the derivatives of V (z, t)
and Ve (y, t) hold:
y = Vz (z, t) ,

Vey (y, t) = âˆ’z,

Vzz (z, t) = âˆ’

1
,
e
Vyy (y, t)

(13)

and the last equation is obtained from the ï¬rst two relations as follows:
Vzz (z, t) =

1
dy
dVz (z, t)
=âˆ’
.
=âˆ’
dz
dVey (y, t)
Veyy (y, t)

Direct substitution of these relations in the HJB equation (11) for V (z, t)
implies that Ve (y, t) in y âˆˆ Dt is determined by the (convex dual) HJB
diï¬€erential equation:
[
]
e
HJB V (y, t) , Vet (y, t) + K1 Ve (y, t) âˆ’ (K1 + K2 ) y Vey (y, t)
(
)2
e
Vy (y, t)
+K3 y 2 Veyy (y, t) âˆ’ K4
+ F (y) = 0
(14)
Veyy (y, t)
12

with terminal boundary condition:
(
)
b
1/Î³ y
e
lim V (y, t) = y âˆ’ Î²
tâ†’T âˆ’
b

y âˆˆ DT = (0, Î²)

A term by term derivation of eq.(14) with respect to y implies the following equation for z (y, t) = âˆ’Vey (y, t) in Dt :
âˆ‚
z (y, t) âˆ’ [K2 + 2K4 ] z (y, t) âˆ’ (K1 + K2 âˆ’ 2K3 ) yzy (y, t)
âˆ‚t(
)
1
z (y, t)2
+
2K3 + 2K4
y 2 zyy (y, t) âˆ’ y âˆ’1/Î³ + Î´ = 0 (15)
2
y 2 zy (y, t)2

Î› [z (y, t)] : =

3.4

The dual value function in Dt âˆª Dtc and the conditions at the boundary yB (t)

Consider now the domain Dc . In this region the non-increasing property of
Vz (z, t) implies that the constraint z â‰¥ 0 is binding. Recalling the relation
z = âˆ’Vey (y, t), it is immediate [to verify] that Dt corresponds to the region
where âˆ’Vey (y, t) > 0 and HJB Ve (y, t) = 0. Dc is a subset of the region
t

identiï¬ed by the condition, z (y, t) = 0. Extending the relation z = âˆ’Vey (y, t)
to Dtc and following a standard construction, the deï¬nition of the reduced
dual value function Ve (y, t) can be extended to the complete domain Dt âˆª Dtc
considering the variational inequality:
{
[
]
}
min HJB Ve (y, t) , âˆ’Vey (y, t) = 0
(16)
and Dtc is characterized by[ a constant
] dual value function, in fact z (y, t) =
e
e
âˆ’Vy (y, t) = 0 while HJB V (y, t) > 0. Repeating the same argument, the
optimal function z (y, t) solves:
min {Î› [z (y, t)] , z (y, t)} = 0

(17)

This equation implies that at optimality the optimal liquid wealth plus
the total consumption up to time t evolves like a martingale. To complete
the identiï¬cation of the dual value function which produces the solution to
the original optimization problem and state the corresponding Veriï¬cation
theorem, the variational equation (16) has to be completed with a set of
lateral boundary conditions to be veriï¬ed by Ve (y, t) in the limit y â†’ yB (t).
In the following we introduce the proper set of lateral conditions. First, the
13

regularity of Ve (y, t) postulated in Condition A and the deï¬nition of yB (t)
require
limâˆ’
âˆ’Vey (y, t) = 0
(18)
yâ†’yB (t) âˆˆDt

In Regime I the boundary point yB (t) is a point of separation of Dt
from Dtc , i.e. Dt âˆ©Dtc = {yB (t)}, hence continuity of the dual value function
imposes that the left limit of Ve (y, t) for y â†’ yB (t)âˆ’ âˆˆ Dt and the right limit
of Ve (y, t) for y â†’ yB (t)+ âˆˆ Dtc are equal:
lim

âˆ’

Ve (y, t) =

yâ†’yB (t)

lim

+

Ve (y, t)

âˆ€t âˆˆ [0, Ï„ âˆ— ]

yâ†’yB (t)

(19)

In Regime II Dtc is disconnected from Dt , thus the regions Dt and Dtc are
disjoint i.e. Dt âˆ©Dtc = âˆ…, hence condition (19) is not necessary.
Last but not least, the admissibility conditions impose that at zero wealth
the agent can invest a fraction of the liquid dividend only in the riskless asset,
or equivalently, that he\she sets the subjective price of risk is set at zero. The
condition that the price of insurable risk is zero determines the additional
requirement:
lim

yâ†’yB (t)âˆ’ âˆˆDt

Veyy (y, t) =

lim

yâ†’yB (t)âˆ’ âˆˆDt

âˆ’zy (y, t) = 0

(20)

while the condition that the price of the uninsurable risk component is vanishing implies the limiting condition for the nonlinear term in eq.(14):
limâˆ’

yâ†’yB (t) âˆˆDt

Vey (y, t)
=0
y Veyy (y, t)

(21)

The ï¬nancial implications of these conditions will be clariï¬ed by the analysis
of the (singular) optimal consumption and allocation policies at zero liquid
wealth.

3.5

A series expansion solution of the dual value function Ve (y, t)

The boundary value problem formed by eq. (16)) jointly with the conditions
(18), (19), (20) and (21) admits a formal series expansion solution of the
form:
{
}
âˆ
âˆ‘
n
1
y Î³ Bn (t)
(22)
Ve (y, t) = y 1âˆ’ Î³ B0 (t) +
n=1

It is easy to show that the ï¬rst term in the expansion corresponds exactly
to the Merton solution in complete markets. The series expansion solution
14

is thus speciï¬ed by the computation of the coeï¬ƒcients {Bn (t)}nâˆˆN . They
can be computed recursively inserting the formal expansion (22) in the HJB
equation (14) and requiring that the equivalent equation (for Veyy (y, t) Ì¸= 0 ):
[
]
0 = Vet (y, t) + K1 Ve (y, t) âˆ’ (K2 + K1 ) y Vey (y, t) + K3 y 2 Veyy (y, t) y 2 Veyy (y, t)
[
]2
2e
2 e
+F (y) y Vyy (y, t) âˆ’ K4 y Vy (y, t) ,
(23)
is valid. In the Appendix we show the result that after the insertion of the
expression (22) the HJB equation becomes equivalent to a system of linear
ODE with respect to time, which determine the coeï¬ƒcients {Bn (t)}nâˆˆN . The
numerical computation of the coeï¬ƒcients shows that the coeï¬ƒcients have
alternate signs and a fast decay to zero. The terminal boundary conditions
impose additional constraints on the coeï¬ƒcients {Bn (t)}nâˆˆN :
Î² 1/Î³
B0 (T ) = âˆ’
,
b
B1 (T ) = +1,
Bn (T ) = 0
n â‰¥ 2.
Note that the series expansion guessed in eq.(22) could provide only a local
approximation to the dual value function Ve (y, t) in the limit of y â†’ 0. On the
other hand the optimal solution is selected by the lateral boundary conditions
which require the convergence of the series expansion for y â†’ yB (t).
Hence further information on the convergence of the series expansion is
required. The analysis of the convergence properties turns to be easier for
the derived series which determines Vey (y, t). Recall that within the domain
of convergence of eq.(22) it is possible to exchange the derivative operator
with the summation and the expansion for Vey (y, t) is given by:
{
}
(
)
âˆ
âˆ‘
1
n
1 n
Vey (y, t) = y âˆ’ Î³ B0 (t) +
yÎ³ 1 âˆ’ +
Bn (t) .
(24)
Î³ Î³
n=1
The mathematical and economic interpretation of this expansion is clariï¬ed by making use of the relations z (y, t) = âˆ’Vey (y, t) and c , câˆ— (z, 1, t) =
y âˆ’1/Î³ which hold at the optimum. Then it is straightforward to state:
Proposition 1 The trial solution (22) is an asymptotic solution to the HJB
(14) for y â†’ 0 if and only if the function z (c, t) which determines scaled
liquid wealth z as a function of scaled optimal consumption c , câˆ— (z, 1, t)
has the following asymptotic expansion:
}
{
)
âˆ (
âˆ‘
1 n
câ†’+âˆ
Bn (t) câˆ’n
(25)
z (c, t) â‰ƒ âˆ’ B0 (t) c + B1 (t) +
1âˆ’ +
Î³
Î³
n=2
15

Assume that z (c, t) is an increasing analytic function (i.e. with a converging Taylor expansion) in c âˆˆ (cB (t) , +âˆ) where cB (t) , yB (t)âˆ’1/Î³ which
satisï¬es the (interpolation) conditions:
lim
z (c, t) = 0
âˆ’

câ†’cB (t)

lim
zc (c, t) = 0
âˆ’

câ†’cB (t)

czc (c, t)
=0
câ†’cB (t) z (c, t)
lim
âˆ’

(26)

then the dual reduced value function Ve (y, t) solving the optimization problem
is determined by:
( 1 )
1
Ve (y, t) = y 1âˆ’ Î³ G y âˆ’ Î³ , t
(27)
where

(
G y

âˆ’ Î³1

)

1
,t = âˆ’
y

âˆ«

y

( 1 )
z xâˆ’ Î³ , t dx.

0

In Theorem 5 it will be proved that the analytic property of z (c, t) is
implied by the optimal stochastic dynamics for consumption. It is worth
noticing that Calin, Chen, Cosimano and Himonas (2005) use an analytic
series expansion to solve equilibrium asset pricing models in complete markets. Our approach can be considered as an extension of their method to the
(partial equilibrium) incomplete markets case.

3.6

The main theorem.

The application of the traditional dynamic programming approach and the
above considerations lead us to state the following
Theorem 2 Assume Condition A and the following restrictions on parameters: Î´ > 0, |Ï| < 1, Î´ âˆ’Î³ > Î², (K1 + K2 âˆ’ 2K3 ) > 0. Then the following
assertions are true:
â€¢ The boundary curve (t, yB (t)), 0 â‰¤ t â‰¤ T , is given by:
yB (t) = Î² exp (âˆ’ (K1 + K2 âˆ’ 2K3 ) (T âˆ’ t))
â€¢ Let V> (z, t) : (0, +âˆ) Ã— [0, T ] â†’ R be deï¬ned by:
{
}
V> (z, t) =
inf
Ve (y, t) + zy ,

(28)

yâˆˆDt =(0,yB (t))

where Ve (y, t) , y âˆˆ (0, yB (t)), is the solution (27) to the boundary value
problem formed by eq. (16) jointly with the conditions (18), (19), (20)

16

and (21) and VeB (t) be the solution to the ODE:
d eB
V (t) = âˆ’K1 Ve B (t) + F0 (yB (t)) ,
dt
Î²
limâˆ’ Ve B (t) =
,
tâ†’T
1âˆ’Î³

(29)

then it is possible to deï¬ne a concave function
{
V> (z, t) z > 0
V (z, t) =
VeB (t) z = 0
and the function
V (l, h, t) = h1âˆ’Î³ V (z, t)
z = l/h
is the value function (5) which solves (6) in (l, h, t) âˆˆ [0, +âˆ) Ã—
(0, +âˆ) Ã— [0, T ].
â€¢ Let Ï„ âˆ— be deï¬ned as in eq.(46). Then Ï„ âˆ— separates two diï¬€erent regimes
depending on the time to liquidation of the illiquid asset:
Regime
Regime

I

yB (t)âˆ’1/Î³ â‰¥ Î´

0 â‰¤ t < Ï„âˆ—

II

yB (t)âˆ’1/Î³ < Î´

Ï„âˆ— â‰¤ t < T

In Regime I the reduced value function V (z, t) admits a continuous
extension to the domain: [0, +âˆ) Ã— [0, T ]. In Regime II the reduced
value function V (z, t) is discontinuous in the limit z â†’ 0+ for Ï„ âˆ— <
t < T:
lim V (z, t) Ì¸= V (0, t) = Ve B (t)
zâ†’0+

Proof The theorem is proved in the Appendix. End Proof
The value function is concave but possibly discontinuous in the domain
(t, z) âˆˆ (0, T ) Ã— [0, +âˆ). Lack of regularity of the solution complicates the
application of the dynamic programming veriï¬cation approach to the primal
problem. For this reason the proof makes use of the dual veriï¬cation approach
discussed in Mnif and Pham (2001) which extends to the incomplete market
case the duality method explored by He and PageÌ€s (1991) and El Karoui and
Jeanblanc (1997).

17

4

Stochastic evolution for the dual variable
yt

The feedback formula (7) implies that y has the economic interpretation of
a (scaled) shadow price for the individualâ€™s optimal consumption plans. In
the approach of He and PageÌ€s (1991) and El Karoui and Jeanblanc (1997),
the optimal stochastic dynamics for the dual variable y is determined as a
solution to a dual stochastic minimization problem. In our derivation the
singular diï¬€usion process for yt can be reconstructed from eq.s (16, 17) and
by the set of lateral boundary conditions. This is stated in the next:
Proposition 3 Let LyB (t) (yt ) the local time of the process yt at the boundary
yB (t). Then optimal stochastic dynamics for the shadow price of consumption yt âˆˆ (0, yB (t)) for 0 â‰¤ t â‰¤ Ï„ âˆ—B (Ï‰) is given by:
dyt
1 dLyB (t) (yt )
= âˆ’
+
yt
2 yB (t)
[
]
âˆš
âˆš
2
1
2
e (yt , t) dW I{yt <y (t)}
+ âˆ’ (K1 + K2 âˆ’ 2K3 ) dt + 2K3 dWt + 2K4 R
t
B
The initial condition y0 corresponding to z0 = l/h is uniquely determined by
the equation:
z0 = âˆ’Vey (y0 , 0)
By construction yt is reï¬‚ected at yB (t) at any boundary hitting time:
{
}
R
âˆ—
Ï„ t (Ï‰) = inf Ï„ â‰¥ t : t < Ï„ < Ï„ ,
limâˆ’ yÏ„ â€² (Ï‰) = yB (Ï„ )
â€²
Ï„ â†’Ï„

while at the killing time:
{
B
Ï„ (Ï‰) = inf Ï„ â‰¥ 0 :

âˆ—

Ï„ < Ï„ â‰¤ T,

}
limâˆ’ yÏ„ â€² (Ï‰) = yB (Ï„ )
â€²

Ï„ â†’Ï„

(30)

(with the convention that inf âˆ… = T ) the process collapses to the state yt =
Î´ âˆ’Î³ where it remains until liquidation.
Proof See the Appendix. End Proof
Straightforward application of Ito lemma to the relations c = y âˆ’1/Î³ and
z (y, t) = âˆ’Vey (y, t) determines the optimal evolution of consumption ct and
scaled liquid wealth zt .

18

4.1

The (singular) consumption and allocation policies
at zero liquid wealth

Having completed the analysis of the boundary behavior for the dual state
process yt , it is now possible to provide a complete description of the optimal
control policies at zero liquid wealth which can be summarized as follows:
â€¢ Regime I : 0 < t â‰¤ Ï„ âˆ— The agentsâ€™ savings produce a positive inï¬‚ow
of wealth that determine the instantaneous exit from the illiquid state
l = 0. When the zero wealth boundary is hit, the agent can consume
only out of the dividend rate. Since the constraint y > Î´ âˆ’Î³ is not
binding, the agentâ€™s optimal consumption level is strictly smaller than
the dividend rate:
cB
(31)
âˆ— (t) < Î´h
hence the agent saves a fraction of the dividend rate which is invested in
the riskless asset and instantaneously exits from the zero liquid wealth
state.
â€¢ Regime II : Ï„ âˆ— â‰¤ t â‰¤ T If the zero liquid wealth boundary is reached
after Ï„ âˆ— , the proximity of the liquidation time T raises the agentâ€™s willingness to consume beyond the dividend rate level Î´h. Since borrowing is not permitted, the maximum amount is limited to the available
liquid wealth which equals the dividend rate. This implies that the
no-borrowing constraint binds and the optimal consumption level must
be set equal to the dividend rate:
cB
âˆ— (t) = Î´h

(32)

until ï¬nal liquidation. The agent in this state does not save thus the
allocation to liquid risky and riskless assets is 0.

4.2

The regularity of the (scaled) wealth-consumption
function z (c, t)

In the original Merton model the lognormal property of optimal consumption implies a linear wealth-consumption function. A similar argument can
be used to characterize the regularity of the (scaled) wealth consumption
function in the illiquid market framework. The next theorem states the following important extension of the complete market setup: ï¬rst, the optimal
scaled consumption evolution is in the class of the time changed Bessel processes, a class of processes which includes also lognormal ones. Second, the
time changed Bessel property for optimal consumption dynamics implies that
19

the optimal (scaled) wealth-consumption function z (c, t) is analytic and is
monotonic increasing. These two regularity properties, which are necessary
in order to prove Prop.1 and Th.2, are proved by showing that the inverse
of z (c, t) belongs to a special class of functions which are deï¬ned in the
following:
Definition 4 (C. Loewner 1964) A function f : (0, +âˆ) which is (real)
analytic in (0, +âˆ) and can be analytically continued to a one-to-one map
of the upper half complex plane H into itself is said to be a â€conformal transformationâ€. Each conformal function f is a matrix monotone function of
arbitrary order e and is generated by the composition of inï¬nitesimal transformations with the same property.
To draw an analogy with familiar models, the class of conformal transformations in this framework plays the role which exponential aï¬ƒne functions play for traditional aï¬ƒne factor models. As the family of exponential
aï¬ƒne functions is mapped in itself by the aï¬ƒne factor dynamics, in the same
way the (time changed) Bessel dynamics maps the class of inverse conformal
transformations in itself. This connection has been recently discovered in
Bernard and Bauer (2002, 2003) in connection with the recent developments
in the analysis of Schramm Loewner evolutions, see Schramm Lawler Werner
(2003). Then we can state:
Theorem 5 Consider the following rescaling of variables:
[
]
(K1 + K2 âˆ’ 2K3 ) + Î³ (K2 + 2K4 )
e
Î´ 1 (T âˆ’ t) = Î´ exp
(T âˆ’ t)
Î³
[
]
(K1 + K2 âˆ’ 2K3 )
e
ct = ct exp
(T âˆ’ t)
Î³
ze (e
c, T âˆ’ t) = z (c, t) exp [(K2 + 2K4 ) (T âˆ’ t)]
(33)
then:
â€¢ Scaled consumption e
c evolves like a time changed Bessel process restricted to the state space e
c âˆˆ [1, +âˆ) and reï¬‚ected at the boundary
e

A function f is said matrix monotone of order n in (0, +âˆ) if for any value 0 < x1 <
y1 < ... < xm < ym , m â‰¤ n, the determinant of the matrix M (m) = [mi,j ]i,j=1,..m with
elements
m
f (xi ) âˆ’ f (yj )
mi,j =
xi âˆ’ yj
i,j=1
is positive, det M (m) â‰¥ 0, for a discussion of their properties see Donoghue (1974)

20

point for for t < Ï„ B (Ï‰), e
cB = 1:
1
dÏ†
eÏ† + 1 dL1 (e
(1 + Î³) t + dB
c)
t
2
e
c Ï†t
2 Ï†t
âˆ« t
Ï†t = 2
Î½ (e
cs , T âˆ’ s) ds t â‰¤ Ï„ B (Ï‰)
0
[
(
)2 ]
2
ze (e
c, T âˆ’ s)
e
c
Î½ (e
c, T âˆ’ s) = 2 2 K3 + K4
Î³
e
czeec (e
c, T âˆ’ s)
de
c Ï†t =

(34)

â€¢ Assume K3 Ì¸= 0, then the function ze (e
c, Ï„ ) is (the inverse of ) a conformal transformation, thus it is analytic and monotonic increasing and
by Eq.(33) determines a unique real analytic increasing function z (c, t).
â€¢ The analytic increasing function z (c, t) determines a unique convex
dual value function Ve (y, t) in y âˆˆ (0, yB (t)) by Proposition 1 eq. (27)
which satisï¬es all the assumptions in Condition A. Hence Theorem
2 can be applied and the solution to the original stochastic optimization
problem is uniquely determined.
Proof The Theorem is proved in the Appendix. End Proof
This regularity result is extremely useful to simplify the analysis of optimal allocation and consumption choice in incomplete markets. In fact it
makes available a broad spectrum of numerical techniques like interpolation
and rational approximation schemes for analytic and univalent functions. A
general introduction to these applied numerical methods is given in Henrici
(1991).
The solution approach presented in this paper provides a constructive
scheme to produce the numerical evaluation of the solution. In fact the
computation of the solution is reduced to the computation of the analytic
function z (c, t) as deï¬ned by a set of interpolation conditions like (25), (26).
Applied numerical analysis oï¬€ers a variety of methods to reproduce an analytic function with an arbitrary accuracy using a polynomial or a rational
function. In the numerical example we will practically exemplify the numerical determination of the solution. In particular it will be shown that the
solution can be approximated by:
(
)2
) )
(
(
1/Î³
1/Î³
y
y
Vey(N ) (y, t) = y âˆ’1/Î³ 1 âˆ’
P (N ) y 1/Î³ 1 âˆ’
,t
yB (t)1/Î³
yB (t)1/Î³
where P (N ) is a polynomial function of degree N âˆ’ 2 such that P (N ) (0) Ì¸= 0.
The presence of a double root corresponding to y 1/Î³ = yB (t)1/Î³ grants that
21

this class of functions satisï¬es the required boundary conditions at y = yB (t).
The exact expression of the polynomial function P (N ) is uniquely determined
(N )
by the condition that the expansion of Vey (y, t) as y â†’ 0 (c â†’ âˆ) coincides with the 2N -th order truncation of (24). Speciï¬c numerical issues
about the (fast) numerical convergence of this approximation are discussed
in Appendix.

5

Analysis of optimal consumption and allocation policies

Having solved for the value function it is easy to proceed to determine the
optimal consumption and asset allocation using feedback formulas. To provide for a better understanding of the solution obtained and to be able to
relate our results to those existing in the current literature, we introduce
a representation that allows us to get a better intuition of how the agent
â€valuesâ€ his illiquid wealth and how his decisions are related to it.

5.1

Marginal valuation of the illiquid asset

1.6
1.4

p(z,20)

1.2
1.0
0.8
0.6
0.4
0.2
0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 1: Marginal utility based price as a function of the ratio 1/z = h/l.
The marginal utility based value of the illiquid asset p is deï¬ned as the
liquid amount at which the investor would be willing to sell an inï¬nitesimal
22

amount Îµ of the illiquid asset at time t and is deï¬ned by:
( )
V (l, h + Îµ, t) â‰ˆ V (l + pÎµ, h, t) + O Îµ2
Vh (l, h, t) = pVl (l, h, t)
Vh (l, h, t)
p : =
.
Vl (l, h, t)
The homogeneous representation of the value function, eq.(10), jointly with
eqs.(66) in the Appendix show that p is a function of the state variable
z = l/h and its expression in terms of the reduced value function V (z, t) is
given by:
V (z, t)
p (z, t) = (1 âˆ’ Î³)
âˆ’ z.
Vz (z, t)
In the case that the illiquid asset is private equity, the marginal utility based
value of the illiquid asset p (z, t) corresponds to the minimum price the agent
would be willing to receive in order to sell an inï¬nitesimal amount of the
private equity.
For the purpose of comparing our analysis with the existing literature, in
particular with Merton (1971) it is useful to deï¬ne:
w (l, h, t) = l + p (z, t) h = h (z + p (z, t)) ,

(35)

w (l, h, t) is the equivalent total liquid wealth if the agent values his illiquid
holding at the marginal value p (z, t). Following Koo (1998) we refer to
w (l, h, t) as implicit total wealth. Using eqs.(66), it is immediate to verify
that:
Proposition 6 V (l, h, t) is concave in the variables (l, h) if and only if
V (z, t) is concave and pz (z, t) > 0 for z > 0.
Since limzâˆ’â†’0+ p (z, t) = 0, the increasing property of p (z, t) implies also
the positivity of the marginal price. Thus a direct numerical veriï¬cation of
concavity can be produced using the feed-back formula:
p (z (y, t) , t) =

+âˆ
âˆ‘

nBn (t) y

1âˆ’n
Î³

y âˆˆ (0, yB (t))

n=0

and checking the increasing property of pz (z, t).
To gain insight into the results obtained we illustrate our ï¬ndings through
a numerical example. Consider an investor with an horizon of 20 years, a
coeï¬ƒcient of risk aversion of Î³ = 3, and Î² = 1 who is allocating funds
to a liquid risky asset with an expected rate of return of Î± = 0.08 and
23

volatility Ïƒ = 0.15. In addition he holds an illiquid risky asset with a drift
Âµ = 0.08 and volatility Î· = 0.20. Even though the illiquid asset can not be
traded, it pays a liquid dividend yield of Î´ = 0.05. Finally, there is a liquid
riskless asset with a constant interest rate r = 0.03. Observe that within this
numerical example (K1 + K2 âˆ’ 2K3 ) = 0.093022, thus Ï„ âˆ— solves the equation
T âˆ’ Ï„ âˆ— = 96.613. Since we analyze an investment which is liquidated over
T = 20 < 96.613 years hence the constraint is always binding for any positive
time to liquidation. In the illustration we consider as liquidity state variable
h/l, the proportion of illiquid wealth per unit of liquid wealth within the
range of parameters where the nominal proportion of illiquid wealth varies
from 0 to 5 times the liquid holdings of the agent. In Table I we report the
parameters we used in the illustration.
Table I. Parameters of the illustrative example
T Î±
Ïƒ
Âµ
Î·
Ï
Î´
r
Îº
Î³
20 0.08 0.15 0.08 0.2 0.2 0.05 0.03 0.05 3

Î²
1

Figure 1 shows the marginal utility based value as a function of liquidity expressed as the proportion of illiquid wealth per unit of liquid wealth,
1/z = h/l, for the parameters given in Table I. When h â†’ 0, p converges to
a constant implying that the investor would be willing to sell at this price
his total illiquid wealth, which at this point becomes an inï¬nitesimal fraction of liquid one (in Section 5 we compute this price). Increasing h/l, p
decreases monotonically, hence the more illiquid the agent, the less valuable
is an inï¬nitesimal share of his illiquid wealth. When h/l â†’ âˆ, p converges
to 0.

5.2

Optimal consumption over wealth ratio

For purposes of comparison it is useful to deï¬ne the consumption over implicit
total wealth ratio as:
câˆ— (l, h, t)
q :=
,
w (l, h, t)
where câˆ— (l, h, t) = [Vl (l, h, t)]âˆ’1/Î³ is the expression for optimal consumption
obtained maximizing eqs.(7). An easy veriï¬cation shows that also q is independent of h and is a function of z and t only.
In the appendix we prove that the value function can be expressed in
terms of q (z, t) and w (l, h, t) as:
V (l, h, t) = q âˆ’Î³ (z, t)
24

w (l, h, t)1âˆ’Î³
.
1âˆ’Î³

(36)

1.4

c(l,h,t)*/w(l,h,t)

1.2
1.0
0.8
0.6
0.4
0.2
0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 2: Consumption over implicit total wealth ratio as a function of 1/z =
h/l
This representation shows that for a ï¬xed value of the state variable z the
value function assumes the standard Merton form, where w (l, h, t) is now the
implicit valuation of the agent total wealth. Similarly, a liquidity constrained
investor will consume a fraction q (z, t) of his implicit total wealth. In Figure 2
we show the value of q as a function of illiquidity 1/z = h/l for the parameters
given in Table I. The limit value of q (z, t) when h â†’ 0 is given by the optimal
consumption over wealth ratio when all wealth is liquid (Merton 1971) and
is given by:
(
)
( m(T âˆ’t)
)
1/Î³ m(T âˆ’t)
M ert
âˆ’1
q
(t) = m
e
âˆ’1 +Î² e
(37)
(
)
(
)2 (
)
1
1
Îº
1
1 Î±âˆ’r
m =
âˆ’r 1âˆ’
âˆ’
âˆ’ 2 .
Î³
Î³
2
Ïƒ
Î³ Î³
Notice that the value of q (z, t) remains ï¬nite (although not constant) as the
liquid wealth goes to zero, implying that the agent will consume a fraction
of its implicit total wealth, even if he can consume only the liquid asset.

5.3

Optimal allocation strategy

The optimal allocation is obtained by performing the maximization in (8).
Then, expressing the value function in terms of the reduced value function
25

8
7

PI_S(l,h,t)/l

6
5
4
3
2
1
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 3: Fractional allocation to the risky liquid asset as a function of
1/z = h/l.
V (z, t), the optimal allocation to the risky liquid asset can be written as:
[
(
)
(
)]
(Î± âˆ’ r)
1
Î³
Î·Ï
S
Ï€ =
âˆ’
âˆ’ 1 l,
(38)
Ïƒ2
R (z, t)
Ïƒ R (z, t)
where R (z, t) is deï¬ned as:
R (z, t) = âˆ’

zVzz (z, t)
.
Vz (z, t)

(39)

Figure 3 shows the fraction of liquid wealth allocated to the liquid risky asset.
When h/l = 1/z â†’ 0, R (z, t) converges to the risk aversion coeï¬ƒcient Î³,
hence the ï¬rst term in eq.(38) becomes Mertonâ€™s (1971), while the second
term, the intertemporal hedging component induced by the presence of the
illiquid asset, disappears. When h/l â†’ âˆ, R (z, t) â†’ 0 therefore when the
agent has a very small amount of liquid wealth, he will invest a large fraction
(the total amount in the limiting case of z â†’ 0) of his liquid holdings in the
risky asset in order to diversify the risk induced by the illiquid asset and to
maximize the probability to avoid the hitting of the zero wealth boundary.
If the boundary is hit, the risky allocation is instantaneously liquidated. In
Regime I the optimal allocation policy for an agent l = 0 would correspond
to a pure riskless asset allocation. Figure 4 shows the allocation to the liquid
risky asset per unit of illiquid wealth. The dollar allocation decreases and
converges to 0 when l â†’ 0, while it diverges when l â†’ âˆ.
26

10
9
8

PI_s(l,h,t)/h

7
6
5
4
3
2
1
0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 4: Allocation to the liquid risky asset per unit of illiquid wealth as a
function of the 1/z = h/l.

5.4

The individual valuation of illiquid assets and the
price of uninsurable risk

The dual approach that we take allowed us to compute the shadow prices
for consumption or equivalently the marginal rates of substitution which the
agent uses to price both market and the illiquid asset risk. In the region
where the borrowing constraint is not binding,
) conditions impose
( ï¬rst order
Ï€ âˆ— ,câˆ—
âˆ—
is proportional to
that the marginal utility of consumption Uc t, c , WT
the implicit Arrow Debreu prices which we denote by Î¾ t (Ï‰). Hence at the
optimum:
(
)
Ï€ âˆ— ,câˆ—
âˆ—
Uc t, c , WT
âˆ Î¾t
The diï¬€erential of the Stochastic Discount Factor which determines the
evolution of the marginal utility of consumption can be easily obtained applying Ito Lemma to the combination: Htâˆ’Î³ yt . Its variance is given by
[ ( âˆ’Î³ ) ] (
)2 (
[ ]
)2 (
)
d Ht y t
dÎ¾ t
(Î± âˆ’ r)
e (yÏ„ , Ï„ ) Î· 2 1 âˆ’ Ï2
= V ar
=
+
Î³
âˆ’
R
V ar
âˆ’Î³
Î¾t
Ïƒ
Ht y t
e (yt , t) is deï¬ned by the feedback formula:
where R
e
e (yt , t) = âˆ’ Vy (yt , t) .
R
y Veyy (yt , t)
27

Sigma_SDF(z,20)

3

2

1

0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 5: Risk adjustment over the non traded source of risk as a function
of 1/z = h/l
It is immediate to separate two contributions Ïƒ SDF
, (Î± âˆ’ r) /Ïƒ which cor1
responds to the market risk premium. The residual component:
(
) (
)
e (yt , t) Î· 1 âˆ’ Ï2 1/2
Ïƒ SDF
,
Î³
âˆ’
R
2
depends on the source of risk which cannot be diversiï¬ed by trading in the
liquid market. Any choice of Ïƒ SDF
will determine a diï¬€erent risk adjusted
2
processes for cash ï¬‚ows whose evolution depend on the risk source Wt2 and
therefore to diï¬€erent valuations of the asset which are illiquid and correlated
with the source Wt2 .
Observe that the expression obtained for Ïƒ SDF
corresponds to the one
2
discussed in TeplaÌ€ (2000) and in He and Pearson (1991, Th.7, pg.287) in the
context of the martingale duality approach to stochastic portfolio optimization in incomplete markets, then we can state:
is given
Corollary 7 The optimal subjective price of uninsurable risk Ïƒ SDF
2
by:
(
) (
)
e (y, t) Î· 1 âˆ’ Ï2 1/2 ,
(40)
(y,
t)
=
Î³
âˆ’
R
Ïƒ SDF
2
Proof The theorem is proved in the Appendix.

28

e (y, t) in terms of the primal state
Notice that writing the expression for R
variable z we get
e (y (z, t) , t) = âˆ’ zVzz (z, t) ,
R (z, t) = R
Vz (z, t)
which allows us to express the risk adjustment Ïƒ SDF
as a function of the liq2
uidity of the agent. In Figure 5 we plot the risk adjustment Ïƒ SDF
per unit of
2
1/2
2 1/2
unspanned volatility Î· (1 âˆ’ Ï ) . In fact unspanned volatility Î· (1 âˆ’ Ï2 )
can be considered as a measure of market incompleteness, the larger it is, the
more important the role of non-marketed risks. For a ï¬xed level of unspanned
volatility, we can immediately relate Ïƒ SDF
to the risk aversion of the agent.
2
When h/l â†’ 0, R (z, t) â†’ Î³, thus Ïƒ SDF
â†’
0 and the agent will value his
2
illiquid holdings ignoring the non-traded risk.f In the limit when Ïƒ SDF
=0
2
only market risks are valued and the corresponding (marginal) value of the
illiquid asset will be:
Ïƒ
b
ht 2

[
(
)]
= ht eâˆ’Î½(T âˆ’t) + Î´Î½ âˆ’1 1 âˆ’ eâˆ’Î½(T âˆ’t)
(
)
(Î± âˆ’ r)
Î½ = âˆ’ Âµ âˆ’ Î·Ï
âˆ’Î´âˆ’r .
Ïƒ

SDF =0

(41)

This point corresponds to the h/l = 0 limit in Figure 1.
When the agent liquid holdings become small and h/l â†’ âˆ then
1/2
R (z, t) â†’ 0, thus Ïƒ SDF
â†’ Î³Î· (1 âˆ’ Ï2 ) . This upper bound for Ïƒ SDF
is
2
2
reached when the agent only owns the illiquid asset and corresponds to the
risk adjustment on the unspanned source of risk required for the agent to
optimally hold only the illiquid asset (see Gerber and Shiu 2000).

6
6.1

Sensitivity analysis
Consumer choice

Figure 6 and Figure 7 analyze the consumption choices of the agent as a
function of his liquidity for diï¬€erent times to the ï¬nal horizon. If no illiquid
asset is held by the agent, h/l = 0, and the standard Merton consumption
over wealth ratio is recovered in both plots. Figure 6, which considers the
consumption per unit of liquid wealth as a function of h/l, shows that an
increase in the proportion of the illiquid asset held by the agent will increase
his consumption almost linearly.
f
Collin-Dufresne and Hugonnier (2006) show that this result holds in general semimartingale models.

29

4.0

3.5

3.0

c(l,h,t)*/l

2.5

2.0

1.5

1.0

0.5

0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 6: Consumption over liquid wealth ratio as a function of h/l = 1/z for
diï¬€erent times to the ï¬nal horizon. T âˆ’ t = 20 Dotted, T âˆ’ t = 10 Dashed,
T âˆ’ t = 5 Solid, T âˆ’ t = 1 Bold Dashed.
In Figure 7 we consider consumption per unit of total implicit wealth.
It shows that consumption over implicit total wealth ratio has little variation as h/l â†’ âˆ. Note that consumption increases as the ï¬nal horizon is
approached.
If we interpret the illiquid asset as human wealth (the discounted value
of future labor income) then our ï¬ndings can be related to the recent results
in the consumption literature (see e.g. Wang (2006) and references therein).
In particular, under the more realistic assumption of constant relative risk
aversion preferences for the agent, we can analyze and provide analytical
support for both the standard and generalized Friedman (1957) Permanent
Income Hypotheses (PIH) as deï¬ned in Wang (2006). Within this framework,
the state variable z determines the fraction of ï¬nancial wealth (cumulative
savings) to human wealth. Assume that the agent values his (implicit) total
wealth w (l, h, t) according to formula (35). Then according to PIH, the

30

4.0

3.5

c(l,h,t)*/w(l,h,t)

3.0

2.5

2.0

1.5

1.0

0.5

0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

4.5

5.0

1/z=h/l

Figure 7: Consumption over implicit total wealth ratio as a function of h/l =
1/z for diï¬€erent times to the ï¬nal horizon, T âˆ’ t = 20 Dotted, T âˆ’ t = 10
Dashed, T âˆ’ t = 5 Solid, T âˆ’ t = 1 Bold Dashed.
agent will consume a constant fraction of w (l, h, t). Our model supports this
prediction. In fact Figure 7 shows that the ratio of consumption to implicit
total wealth has little variation with respect to the liquidity state of the agent
for h/l suï¬ƒciently large.
Moreover, the diï¬€erence between the elasticity of consumption with respect to the liquid and to the illiquid wealth can be expressed in terms of
the function R (z, t):
l
h
R (z, t)
âˆ‚câˆ— (l, h, t)
âˆ‚câˆ— (l, h, t)
âˆ’
=
> 0,
âˆ—
âˆ—
c (l, h, t)
âˆ‚l
c (l, h, t)
âˆ‚h
Î³

(42)

which shows that the propensity to consume out of ï¬nancial wealth will be
always larger than out of â€œhuman wealthâ€. This is the generalized PIH as
discussed in Wang (2006). The diï¬€erence decreases from 1 to 0 as liquidity
decreases.
31

12

10

PIs(l,h,t)/l

8

6

4

2

0
0.2

0.4

0.6

0.8

1.0

1.2

1.4

1.6

1.8

2.0

2.2

2.4

1/z=h/l
âˆ’2

Figure 8: Fractional allocation to the risky liquid asset as a function of
z = l/h for diï¬€erent levels of correlation Ï, Ï = âˆ’0.1 Dashed, Ï = 0.2
Dotted, Ï = 0.6 Solid.

6.2

Allocation choice

Figure 8 analyzes the allocation to the risky liquid asset per unit of liquid
wealth as a function of liquidity, for diï¬€erent values of the correlation between
the liquid and the illiquid asset returns. Note that when we increase h the
total wealth of the investor increases also. From the ï¬gure we see that the
allocation to the liquid risky asset increases for negative correlation and also
for moderately positive correlation as well, while for high correlation this
allocation decreases. For suï¬ƒciently low correlation the diversiï¬cation eï¬€ect
of having the illiquid asset (even if it cannot be traded) increases the optimal
allocation to the liquid risky asset, even to the point of borrowing at the
risk free asset to invest in the liquid risky asset. Only when the correlation
is suï¬ƒciently high and the diversiï¬cation eï¬€ect of holding the illiquid risky
asset diminishes, does the optimal allocation to the liquid risky asset decrease
when h/l increases. This analysis indicates that the professor, with his labor
income having low correlation with the risky asset (stock market), should
invest more in the risky asset than the stock broker, who has a wage highly
correlated with the market.
Finally, Figure 9 compares the optimal allocation to the risky asset for
diï¬€erent levels of risk aversion. As can be seen from the ï¬gure risk aversion
has a signiï¬cant eï¬€ect on asset allocation: lower risk aversion implying higher
32

12

10

PIs(l,h,t)/l

8

6

4

2

0
0.0

0.2

0.4

0.6

0.8

1.0

1.2

1.4

1.6

1.8

2.0

2.2

2.4

1/z=h/l

Figure 9: Fractional allocation to the risky liquid asset as a function of
z = l/h for diï¬€erent levels of risk aversion Î³, Î³ = 3.5 Dashed, Î³ = 3 Solid,
Î³ = 2.5 Dotted, Î³ = 2 Bold Dashed.
allocations per unit of liquid wealth to the liquid risky asset. Also, the
sensitivity of the allocation to changes in the relative fraction of illiquid
wealth to liquid wealth decreases as risk aversion increases.

6.3

Optimal consumption when the no borrowing constraint is active at zero wealth

When the ï¬nal liquidation of the human capital is suï¬ƒciently close and t >
Ï„ âˆ— , the propensity to consume out of liquid wealth increases inducing the
agent to borrow. On the other hand, when the zero wealth boundary is hit
the consumption smoothing eï¬€ect disappears completely because liquidity
constraint binds and the optimal choice for the agent is c = Î´h, i.e. the
agent consumes all the available liquid dividend released from human capital
(the wage) without any precautionary saving. Once the zero wealth boundary
is hit, it becomes a trap for the agent which is constrained not to participate
in the liquid risky asset market and is unable to smooth the eï¬€ects of income
shocks on consumption.
It is remarkable that the introduction of uninsurable income as dividend
from illiquid human capital generates optimal consumption policies which are
more in line with the empirical ï¬ndings and a good starting point to interpret
33

household consumption choices even in absence of a proper model of credit
markets. In particular we observe that this liquidity constrained state is
virtually the same found in the analysis of saving and liqudity constraints by
Deaton (1991) where it was shown, in a simpler model of consumer choice,
that the combination of persistent income and binding liquidity constraints
precludes accumulation of assets.

6.4

The participation puzzle and the zero liquid wealth
trap

As previously discussed, market incompleteness induces an implicit borrowing constraint. This constraint is particularly important for an agent with
an high level of human capital and zero liquid wealth. According to our
analysis, the optimal policy for an agent expecting that the â€durationâ€ of
human capital is not too large (smaller than 96.613 years in our choice of
parameters) is not to save and not to participate to the ï¬nancial market,
waiting for the liquidation of the proceeds from human capital. This state
is a â€trapâ€ which can eventually be considered as a potential explanation of
the well known participation puzzle. It is quite remarkable that the higher
the relative size of human capital with respect to the liquid one, the stronger
the eï¬€ect.

7

Summary and conclusions

We study the problem of optimal asset allocation in the presence of an illiquid
asset. The illiquid asset cannot be traded, but it generates a liquid dividend
that can be consumed or invested in liquid assets. This liquid dividend has
many interpretations depending on the nature of the illiquid asset. An important application is when the illiquid asset is human wealth and the dividend
is labor income. There is a vast literature in economics and ï¬nance trying
to understand the eï¬€ect of stochastic labor income on optimal consumption
and asset allocation. We obtain closed form solution to this problem in the
case of time separable power utility of consumption and terminal wealth.
An important by-product of our analysis is that we derive a valuation
procedure for liquid and illiquid assets. In particular, we are able to compute
the value that the agent assigns to the illiquid asset, that is, the shadow price
of illiquidity. The framework allows, given the preferences of the investor,
to value any contingent claim on the illiquid asset or on both the liquid and
illiquid asset.
It would be interesting to investigate if the approach we have developed
can also be used to solve the optimal asset allocation problem in the presence
34

of borrowing and short selling constraints as discussed in general terms by
He and Pages (1993) and Cuoco (1997). In particular, it would be interesting
to study the eï¬€ect that these constraints have on the value that the agent
assigns to his illiquid asset.
Perhaps the most interesting extension of our analysis from the economic
point of view is market equilibrium. If the risky liquid asset is the market
portfolio, and the illiquid asset of each agent in the economy is its human
wealth, the aggregation problem involves heterogeneous valuations of human
wealth holdings of all the agents in the economy. The possibility of asymmetric information eï¬€ects raises the issue of the impact of moral hazard and
adverse selection on such market equilibrium. These extension pose challenging mathematical problems.

35

References
M. Bauer, D. Bernard (2003) SLE martingales and the Virasoro algebra
Phys. Lett. B 557, 309â€“316.
M. Bauer, D. Bernard (2002) SLE growth processes and conformal ï¬eld
theories Phys. Lett. B 543, 135-138.
Bodie, Z., Merton, R.C., and W.F. Samuelson, 1992, Labor supply
ï¬‚exibility and portfolio choice in a life cycle model, Journal of Economic
Dynamics and Control 16, 427â€“449.
Bouchard, B. and Touzi, N. 2009 Weak Dynamic Programming Principle for Viscosity Solutions, preprint.
Campbell, J.Y., A.W. Lo, and A.C. MacKinlay, 1997, The Econometrics of Financial Markets, Princeton University Press, Princeton.
Campbell, J.Y., and L.M. Viceira, 2002. Strategic Asset Allocation:
Portfolio Choice for Long Term Investors (Oxford University Press,
Oxford).
Calin O.L. , Y. Chen, T. Cosimano, A. A. Himonas, 2005, Solving
Asset Pricing Models when the Price-Dividend Function is Analytic,
Econometrica, Vol. 73, No. 3, 961â€“982.
Collin-Dufresne P. and J. Hugonnier, 2006, â€œOn the pricing and hedging
of contingent claims in the presence of extraneous risks,â€ Forthcoming
Stochastic Processes and Their Applications.
Cox, J. C., and C. F. Huang, 1989, Optimum Consumption and Portfolio Policies When Asset Prices Follow a Diï¬€usion Process, Journal of
Economic Theory 49, 33â€“83.
Cuoco, D., 1997, Optimal Consumption and Equilibrium Prices with
Portfolio Constraints and Stochastic Income, Journal of Economic Theory 72, 33â€“73.
Cvitanic J., Schachermayer W., and H. Wang, 2001, Utility Maximization in Incomplete Markets with Random Endowment, Finance
& Stochastics 5, 259â€“272.
Davis, M. H. A., 1999, Option valuation and hedging with basis risk,
in Djaferis, T. E., and Schuck, I. C., eds.: System Theory: Modeling,
Analysis and Control (Kluwer: Amsterdam).
36

Decamps, M., Goovaerts, M., and W. Schoutens, Asymmetric skew
Bessel processes and their applications to ï¬nance, Journal of Computational and Applied Mathematics, Volume 186, Issue 1, Jef Teugels, 1
February 2006, Pages 130-147
Detemple, J., and S. Sundaresan, 1999, Nontraded Asset Valuation
with Portfolio Constraints: A Binomial Approach, Review of Financial
Studies 12, 835â€“872.
Di Giacinto M., Federico, S. and F. Gozzi, 2010, Pension funds with
a minimum guarantee: a stochastic control approach forthcoming Finance and Stochastics Springer Berlin / Heidelberg.
W. Donoghue. Monotone matrix functions and analytic continuation.
Springer, Berlin, Heidelberg, New York, 1974
Dybvig, P., and C. Huang, 1988, Nonnegative Wealth, Absence of Arbitrage, and Feasible Consumption Plans, Review of Financial Studies,
vol. 1(4), pp. 377-401.
Dybvig P., and H. Liu, 2004, Lifetime Consumption and Investment:
Retirement and Constrained Borrowing, Working paper, AFA 2005 program.
Duï¬ƒe, D., Fleming, W., Soner, H.M., and T. Zariphopoulou, 1997,
Hedging in incomplete markets with HARA utility, Journal of Economic Dynamics and Control 21, 753â€“782.
El Karoui, N., and M. Jeanblanc, 1998, Optimization of consumption
with labor income, Finance & Stochastics 2, 409â€“440.
El Karoui, N., and R. Rouge, 2000, Pricing via utility maximization
and entropy, Mathematical Finance 10-2, 259-276.
Flavin, M., and T. Yamashita, 2002, Owner-occupied housing and the
composition of the household portfolio, The American Economic Review 92, 345â€“363.
Friedman, M.,1967, A Theory of the Consumption Function, Princeton
University Press, Princeton.
Gerber, H.U., and E.S.W. Shiu, 2000, Investing for Retirement: Optimal Capital Growth and Dynamic Asset Allocation, North American
Actuarial Journal 4, 42â€“62.

37

Grossman, S., and G. Laroque, 1990, Asset pricing and optimal portfolio choice in the presence of illiquid durable consumption goods, Econometrica 58, 25â€“52.
He, H., and H.F. PageÌ€s, 1993, Labor income, borrowing constraints,
and equilibrium asset prices, Journal of Economic Theory 3, 663â€“696.
He, H., and N.D. Pearson, 1991, Consumption and portfolio policies with incomplete markets and short-sale constraints: the inï¬nitedimensional case. Journal of Economic Theory 54, 259â€“304.
Henderson, V., and D. Hobson, 2002, Real Options with Constant Relative Risk Aversion, Journal of Economic Dynamics and Control 27,
329â€“355.
Henderson, V., 2002, Valuation of claims on nontraded assets using
utility maximization, Mathematical Finance 12, 351â€“373.
Heaton, J. , and D. Lucas, 1997, Market Frictions, Saving Behavior
and Portfolio Choice, Macroeconomic Dynamics 1, 76â€“101.
Heaton, J., and D. Lucas, 2000, Portfolio choice and asset prices the
importance of entrepreneurial risk, Journal of Finance 55, 1163â€“1198.
Henrici, P. Applied and Computational Complex Analysis Wiley
Hodges, S. D. and Neuberger, A., 1980, Optimal replication of contingent claims under transaction costs, Review of Future Markets 8,
222â€“239.
Hugonnier, J., and D. Kramkov, 2004, Optimal investment with random endowments in incomplete markets, Annals of Applied Probability
14, 845â€“864.
Jagganathan, R., and N. Kocherlakota, 1996, Why Should Older People
Invest Less in Stocks than Younger People?: An Economic Analysis
of Financial Plannersâ€™ Advice, Federal Reserve Bank of Minneapolis
Quarterly Review 20, 11â€“23.
Kahl, M., Liu, J., and F.A. Longstaï¬€, 2003, Paper millionaires how
valuable is stock to a stockholder who is restricted from selling it?,
Journal of Financial Economics 67, 385â€“410.
Karatzas, I., and G. Zitkovic, 2003, Optimal Consumption From Investment and Random Endowment in Incomplete Semimartingale Markets,
Annals of Probability 31, 1821â€“1858.
38

Koo, H.K., 1995, Consumption and portfolio selection with labor income I: evaluation of human capital, Preprint, Washington University.
Koo, H.K., 1998, Consumption and portfolio selection with labor income a continuous time approach, Mathematical Finance 8, 49â€“65.
Loewner, C., 1964, On semigroups in analysis and geometry. Bull.
Amer. Math. Soc. 70 1964 1â€“15.
Markowitz, H. M., 1952, Portfolio Selection, Journal of Finance 7, 77â€“
91.
Mayers, D., 1972, Nonmarketable assets and capital market equilibrium
under uncertainty, in M.C. Jensen, ed.: Studies in the theory of capital
markets (Preager Publishers, New York).
Mayers, D., 1973, Nonmarketable assets and the determination of capital asset prices in the absence of a riskless asset, Journal of Business
46, 258â€“276.
Merton, R.C., 1969, Lifetime portfolio selection under uncertainty: the
continuous-time case, Review of Economics and Statistics 51, 247â€“257.
Merton, R.C., 1971, Optimum consumption and portfolio rules in a
continuous time model, Journal of Economic Theory 3, 373â€“413.
Merton, R. C., 1992. Continuous-Time Finance (Blackwell).
Musiela, M., and T. Zariphopoulou, 2004, An example of indiï¬€erence
prices under exponential preferences. Finance & Stochastics 8, 229â€“
239.
Samuelson, P.A., 1969, Lifetime Portfolio Selection by Dynamic
Stochastic Programming, Review of Economics and Statistics 51, 239â€“
246.
Schramm, O., Lawler G., and W. Werner, 2003, Conformal Restriction:
The Chordal Case, Journal of the American Mathematical Society V.
16, N. 4, 917-955.
Svensson, L.E.O., and I.M. Werner, 1993, Nontraded assets in incomplete markets : Pricing and portfolio choice, European Economic Review 37, 1149â€“1168.

39

Stanley, H.E., 1999, Scaling, universality, and renormalization: Three
pillars of modern critical phenomena. Review of Model Physics 71,
S358â€“S366.
TeplaÌ€, L., 2000, Optimal Hedging and Valuation of Nontraded Asset,
European Finance Review 4, 231â€“251.
Viceira, L.M., 2001, Optimal portfolio choice for long-horizon investors
with nontradeable labor income, Journal of Finance 56, 433â€“470.
Wang, N., 2006, Generalizing the Permanent-Income Hypothesis: Revisiting Friedmanâ€™s Conjecture on Consumption, Journal of Monetary
Economics 53, 737â€“752.
Whittaker, E.T., and G.N. Watson, 1990. A Course in Modern Analysis, (4th ed., Cambridge University Press, England).
Zeldes, S., 1989, Optimal Consumption with Stochastic Income: Deviations from Certainty Equivalence, Quarterly Journal of Economics
104, 275â€“298.
Zitkovic, 2005, â€Utility Maximization with a Stochastic Clock and an
Unbounded Random Endowmentâ€, Annals of Applied Probability 15
No. 1B, pp 748â€“777

40

8

Technical Appendix to the paper â€Illiquid
Assets and Optimal Portfolio Choiceâ€ by
E. S. Schwartz and C. Tebaldi

8.1

The set of admissible strategies

An admissible strategy is determined by:
â€¢ a progressively Ft measurable positive consumption process e
c (t) â‰¥ 0,
0 â‰¤ t â‰¤ T such that
âˆ«
t

c (Ï„ ) dÏ„ < +âˆ.
0

â€¢ By
( B a Sset
) of progressively measurable adapted allocation strategies
Ï€ Ï„ , Ï€ Ï„ that verify the integrability conditions
âˆ« T
âˆ« T
âˆ« T
2
B
S
Ï€ rdt +
Ï€ Î±dt +
Ï€ S Ïƒ 2 dt < âˆ.
0

0

0

â€¢ The liquid wealth state variable is deï¬ned by:
Lt = l,
LÏ„ = Ï€ SÏ„ + Ï€ B
t â‰¤ Ï„ < T,
Ï„ ,
S
B
WT = Ï€ T + Ï€ T + HT ,

(43)
(44)

At the ï¬nal time T the investor will optimally leave for bequest his
total liquid wealth, WT which includes the wealth obtained by liquid
investment LT âˆ’ = limtâ†’T âˆ’ Lt , and the illiquid wealth, HT , i.e. WT =
LT âˆ’ + HT .
â€¢ The set of ï¬nanceable strategies A (l, h, 0)
( given the initial)wealth levels L0 = l, H0 = h is the set of pairs c (Ï„ )Ï„ âˆˆ[0,T ] , WTÏ€,c for which
)
(
S
there exists an admissible allocation Ï€ B
Ï„ , Ï€ Ï„ Ï„ âˆˆ[0,T ] granting that the
dynamic budget equation
)
(
dSÏ„
S
âˆ’ rdÏ„
Ï„ <T
(45)
dLÏ„ = (rLÏ„ + Î´HÏ„ âˆ’ cÏ„ ) dÏ„ + Ï€ Ï„
SÏ„
is veriï¬ed âˆ€Ï„ âˆˆ [0, T ] and the ï¬nal wealth is nonnegative WTÏ€,c â‰¥ 0 a.s.
When Ï Ì¸= Â±1 the solvability requirement WTÏ€,c â‰¥ 0 implies that any
admissible strategy must verify LÏ„ â‰¥ 0 a.s. otherwise, in the case of interest,
thereâ€™s a ï¬nite probability to end at time T with negative wealth WTÏ€,c < 0.
41

This fact implies that the solvability requirement induces a state constraint LÏ„ â‰¥ 0 a.s. âˆ€Ï„ âˆˆ [0, T ], in the stochastic optimization problem. In
the next section we analyze the boundary condition implied by this state
constraint. Dybvig and Huang (1988) prove that the presence of the nonnegativity constraint is suï¬ƒcient to grant that the set of admissible strategies is
free from arbitrage opportunities.

8.2

The boundary condition when h = 0.

Standard Merton model is recovered if h = 0. Since the illiquid wealth state
variable has a lognormal evolution, the state Ht = 0 is never reached if the
initial level h > 0.

8.3

The computation of the constrained maximum at
the boundary z = 0

In order to determine the constrained maximum problem for consumption at
z = 0:
[
]
c1âˆ’Î³
F0 (yB (t)) = max âˆ’ (c âˆ’ Î´) yB (t) +
Î´â‰¥câ‰¥0
1âˆ’Î³
let us introduce the Lagrangian:
L (p1 , p2 , c) = âˆ’ (c âˆ’ Î´) yB (t) +

c1âˆ’Î³
âˆ’ p1 (âˆ’c) âˆ’ p2 (c âˆ’ Î´)
1âˆ’Î³

the corresponding Kuhn Tucker conditions are:
câˆ’Î³ âˆ’ yB (t) + p1 âˆ’ p2
p1 c
c
p2 (Î´ âˆ’ c)
câˆ’Î´

=
=
â‰¥
=
â‰¤

and the possible solutions are:
â€¢ c > 0 and Î´ > c then p1 = 0 and p2 = 0;
â€¢ c = 0 and Î´ = c then p1 < 0 and p2 > 0;
â€¢ c > 0 and Î´ = c then p1 = 0 and p2 > 0;

42

0
0
0, p1 â‰¤ 0
0
0, p2 â‰¥ 0

The maximization at t â†’ T âˆ’
( )
yB T âˆ’ = Î²
hence the ï¬rst order conditions imply:
câˆ’Î³ = Î² âˆ’ p1 + p2
Since Î² > 0, p1 â‰¤ 0, p2 â‰¥ 0 then the optimal consumption solution c > 0 is
always strictly positive and thus the constraint c â‰¥ 0 is never binding and
p1 = 0.
If the constraint c â‰¤ Î´ is non-binding, then conditions câˆ’Î³ = Î² and c < Î´
are to be veriï¬ed, hence Î² > Î´ âˆ’Î³ .
On the contrary if
Î² â‰¤ Î´ âˆ’Î³
( )âˆ’Î³
holds, then the slack solution cf
= Î² implies cf = Î² âˆ’Î³ â‰¥ Î´ violating the
constraint c â‰¤ Î´. Hence when Î² â‰¤ Î´ âˆ’Î³ the constraint c â‰¤ Î´ is binding and
the solution is:

p2

(

c = Î´
)
T
= Î´ âˆ’Î³ âˆ’ Î² > 0
âˆ’

In our analysis it is assumed the condition Î² â‰¤ Î´ âˆ’Î³ (see Condition A). From
an economic point of view this condition is motivated by the assumption
that the utility form ï¬nal liquidation (bequest) is substantially larger than
the utility from current consumption.
The maximization for t < T
The analytical expression of the boundary yB (t) which is determined by
Theorem 2 (see next section) and Kuhn Tucker conditions select the following
solutions:
â€¢ the solution is internal if
yB (t) = Î² exp [(K1 + K2 âˆ’ 2K3 ) (T âˆ’ t)] > Î´ âˆ’Î³
then c = yB (t)âˆ’1/Î³ and yB (t)âˆ’1/Î³ < Î´.
â€¢ the constraint binds if

yB (t) â‰¤ Î´ âˆ’Î³

and the solution will be:
c = Î´
p2 (t) = Î´ âˆ’Î³ âˆ’ yB (t)âˆ’1/Î³ > 0
43

Assuming that (K1 + K2 âˆ’ 2K3 ) â‰¥ 0, Î² â‰¤ Î´ âˆ’Î³ (see Condition A), the
inequality yB (t) â‰¤ Î´ âˆ’Î³ will hold at any time t such that
( âˆ’Î³ )
Î´
1
(T âˆ’ t) â‰¤
log
(K1 + K2 âˆ’ 2K3 )
Î²
( âˆ’Î³ ) }
{
Î´
1
âˆ—
log
t > Ï„ , max T âˆ’
, 0 (46)
(K1 + K2 âˆ’ 2K3 )
Î²
For example in the numerical example is given by:
( âˆ’Î³ )
Î´
1
log
=
(K1 + K2 âˆ’ 2K3 )
Î²
(
)
0.05âˆ’3
1
log
= 96.613
0.09302222222
1
and, since T = 30, Ï„ âˆ— = max {0, 30 âˆ’ 96.613}.
The condition (K1 + K2 âˆ’ 2K3 ) > 0 imposes that the marginal utility
of scaled consumption at zero wealth is decreasing with respect to time.
This condition, jointly with Î² â‰¥ Î´ âˆ’Î³ , imply that the liquid value of the
illiquid asset grows with time.
In conclusion, on the basis of the above discussion, we can guess that
the optimal consumption policy at zt = 0 is given by:
{
yB (t)âˆ’1/Î³
t < Ï„âˆ—
cB (t) =
Î´
Ï„âˆ— â‰¤ t < T
and imposes to assume a reï¬‚ecting boundary condition for the state
variable zt if the zero wealth boundary is hit before time Ï„ âˆ— . In fact it
is optimal to consume less than the total dividend thus the agent will
save and exit from zt = 0 state will be instantaneous. On the contrary
if the zero boundary is hit after time Ï„ âˆ— , it is necessary to assume
a killing boundary since it is optimal to consume the whole dividend
ct = Î´ and wait the ï¬nal liquidation without saving riskfree asset and
without participating to the stock market.

8.4

Proof of Theorem 2

The ï¬rst step toward the statement of the veriï¬cation result is the determination of the explicit equation for the optimal boundary yB (t).
The ODE for the boundary yB (t)

44

From the reduced HJB equation for the primal problem we compute the
PDE which describes the evolution of y (z, t) = Vz (z, t) getting:
0 = Vzt (z, t) + (K1 + K2 âˆ’ 2K3 ) Vz (z, t) + (K2 + 2K4 ) zVzz (z, t) +
(
)
Vz (z, t)2
K3
z 2 Vzzz (z, t) + F â€² (Vz (z, t)) Vzz (z, t) , (47)
2 + K4
2
z Vzz (z, t)
On the other hand admissibility imposes zero investment in the risky asset at
the boundary z = 0, i.e. limzâ†’0+ Vz (z, t) /Vzz (z, t) = 0. Then the limiting
expression of the reduced HJB and of PDE (47) imply:
{
(
)
}
( âˆ’1/Î³
)
âˆ‚y (zt , t)
âˆ‚y (z, t)
+
y
(z, t) âˆ’ Î´ + (K1 + K2 âˆ’ 2K3 ) y (zt , t) dt
âˆ‚t
âˆ‚z
z=zt
{
(
)}
dzt + Î´ âˆ’ y âˆ’1/Î³ (z, t) dt
}
{
(
)
âˆ‚y (zt , t)
âˆ‚y (z, t)
dzt + (K1 + K2 âˆ’ 2K3 ) y (zt , t) dt
dt +
âˆ‚t
âˆ‚z
z=zt
{dy (zt , t) + (K1 + K2 âˆ’ 2K3 ) y (zt , t) dt}
Hence the unique deterministic evolution of the boundary point yB (t) =
limzâ†’0+ Vz (z, t) which can be obtained as a limiting expression of the reduced
HJB in the region Dt under the regularity Assumption A is deï¬ned by the
ODE:
d
yB (t) = âˆ’ (K1 + K2 âˆ’ 2K3 ) yB (t)
dt
Assumption of continuity w.r.t to time (see Condition A) of Vz (z, t) as t â†’
T âˆ’ determines the boundary condition:
yB (T ) = Î²
Observe that in the case y âˆ’1/Î³ (z, t) < Î´ the constraint on maximum scaled
consumption determined by the No Borrowing constraint is not active and
âˆ’1/Î³
cB (t) = yB (0, t), thus the optimal consumption feedback policy is right
âˆ’1/Î³
continuous in the limit z â†’ 0+ . Consider now the case yB (0, t) > Î´, then
at z = 0, the constraint on maximum consumption is active, and the optimal
scaled consumption feedback function is discontinuous, in fact:
âˆ’1/Î³

cB (t) = yB

(t) = lim+ Vzâˆ’1/Î³ (z, t) > Î´
zâ†’0

which implies that in correspondence to the hitting of the z = 0 barrier the
optimal level of consumption must drop discontinuously to Î´ and the diï¬€usion
process has to be killed collapsing onto the state zt = 0, c = Î´.
45

= 0
= 0
= 0
= 0

The verification that V (z, t) solves the reduced maximization
problem.
To prove that the function V (z, t) deï¬ned by eq.s (28, 29) is the solution
to the reduced primal maximization problem we apply the dual veriï¬cation
result stated in Theorem 5.1 in Pham and Mnif (2001) which extended to
the incomplete market setup the procedure of He and PageÌ€s (1991) and El
Karoui and Jeanblanc (1997).
The ï¬rst step of this procedure is the formulation and the solution of the
dual stochastic mixed regular/singular minimization problem. In the present
framework it turns possible to solve the dual minimization problem using a
standard dynamic programming veriï¬cation argument which shows that the
solution to the HJB variational inequality (16):
Ve (y, t) y âˆˆ Dt
Ve (yB (t) , t) , limyâ†’yB (t)âˆ’ Ve (y, t)
(
)
Ve Î´ âˆ’Î³ , t , V B (t) t âˆˆ [Ï„ âˆ— , T )

t âˆˆ [0, Ï„ âˆ— )

(48)

veriï¬es the dynamic programming principle:
[
Ve (y, t) =

(

P
inf E(t,y)
eâˆ’K1 (T âˆ’t) âˆ’Î²

b
1/Î³ (YT )

Y âˆˆY loc

b

y
Ve (y, T ) = y âˆ’ Î² 1/Î³
b

b

)
+ YT

âˆ«
+

T

]
esâˆ’K1 (sâˆ’t) Ys F (Ys ) ds

t

y âˆˆ DT , (0, Î²]

The general characterization of the dual domain Y loc granting existence of the
minimizer has been given in Karatzas and Zitkovic (2003) and proves that the
admissible state processes Yt are in the class of nonnegative supermartingale
processes. In the present Markovian framework it is not restrictive to assume
that the set of admissible dual controls is parametrized as follows:
dYt
dMt
=
+ Âµ (Yt , t) dt + Ïƒ SDF
(Yt , t) dWt1 + Ïƒ SDF
(Yt , t) dWt2
1
2
Yt
Mt
y0 = y âˆˆ (0, yB (0)) t âˆˆ [0, Î¶ âˆ§ T )
(y, t) are assumed to be
(y, t), Ïƒ SDF
where the coeï¬ƒcients Âµ (y, t) and Ïƒ SDF
2
1
f
bounded. The process Yt is factorized as Yt = Mt Yt , where Ytf is a regular
process and Mt is a singular process which is used to implement the reï¬‚ecting boundary conditions, while Î¶ (Ï‰) is an absorption stopping time for the
diï¬€usion at yB (t) and Î¶ âˆ§ T = min {Î¶, T }. The stopping time Î¶ (Ï‰) > 0
has to be considered as part of the control speciï¬cation and is necessary to
take into account the possible admissible strategies corresponding to a diffusion which exits from the state space (0, yB (t)) at Î¶ (Ï‰) and is absorbed
46

(49)

to the state y = Î´ âˆ’Î³ > yB (t) where it remains for the entire period [Î¶, T ):
limtâ†’Î¶ âˆ’ yt = yB (Î¶), and yt (Ï‰) = Î´ âˆ’Î³ , Î¶ (Ï‰) â‰¤ t < T .
The construction of the feedback expression of the optimal dual state
process, which is denoted with the small letter yt is detailed in Proposition
3.
Under the smoothness assumptions implied by Condition A, application
of the generalized Ito Lemma implies:
âˆ« T
Ve (yT , T ) +
eâˆ’K1 (sâˆ’t) ys F (ys ) ds
t
âˆ« T
âˆ« Ï„âˆ—
[
]
dLyt (yB (t))
e
e
= V (yt , t) +
HJB V (y, t) ds âˆ’
yt Vey (yt , t)
yB (t)
t
t
âˆ« T
âˆ« T âˆ§Ï„ B (Ï‰)
(âˆš
)
âˆš
e (yt , t) dW 2
+
eâˆ’K1 (sâˆ’t) ys F (ys ) ds +
yt Vey (yt , t)
2K3 dW 1 + 2K4 R
t

t

= Ve (yt , t) +

âˆ«

t

t

T

yt Vey (yt , t)

(âˆš
)
âˆš
1
2
e
2K3 dWt + 2K4 R (yt , t) dWt

t

and taking the conditional expectation it is proved that Ve (yt , t) solution to
the HJB variational inequality (16) veriï¬es eq.(49).
Having determined the solution to the dual problem, all the hypotheses
are veriï¬ed and the dual veriï¬cation result of Theorem 5.1 in Pham and Mnif
(2001) can be applied. This implies that the duality relations (12,28) hold,
hence V (z, t) is uniquely determined by the dual value function Ve (y, t) (48).
Given uniqueness of the solution V (z, t) to the reduced problem, then the
value function V (l, h, t) = h1âˆ’Î³ V (z, t) solves the original stochastic optimization problem.

8.5

Proof of Proposition 3

Complementary slackness condition at the saddle point imply that the unique
solution for Âµ (y, t) and Ïƒ SDF
(y, t) is given by:
1
Âµ (y, t) = âˆ’ (K1 + K2 âˆ’ 2K3 )
âˆš
(y,
t)
=
Ïƒ SDF
2K3
1

(50)

The optimal expression of the regular process Ytf requires the determination
(y, t). Following the argument of He and
of the volatility coeï¬ƒcient Ïƒ SDF
2
Pearson (1991) and the computation detailed in the proof of Corollary 6, it
is veriï¬ed that the term
(y, t) =
Ïƒ SDF
2

e
âˆš
âˆš
e (y, t) = 2K4 Vy (y, t)
2K4 R
y Veyy (y, t)
47

(51)

can be interpreted as the feedback expression obtained by the minimization of
the uninsurable component of risk that drives the shadow prices of consumption. The optimal expressions for the singular controls Mt and Î¶ are uniquely
selected by the condition that the system of optimal dual shadow prices is
compatible with the borrowing constraint in the primal problem. The dynamics and the optimal policies when the constraint is active can be derived
by constraining the state space of the diï¬€usion to the region (0, yB (t)). Then
the behavior of the diï¬€usion must be completed with a classiï¬cation of the
boundary behavior when the process approaches the boundaries yt â†’ 0 and
yt â†’ yB (t). This can be done through an application of the Feller classiï¬cation of one dimensional diï¬€usion boundaries.
Condition (20) and the limiting expression of the coeï¬ƒcients (50, 51)
imply:
Proposition 8 Assume Condition A and let condition (20) hold, then
starting from y âˆˆ (0, yB (t)) t â‰¤ T , the probability that yt reaches y = 0 is
zero, while thereâ€™s a ï¬nite probability to reach yB (t). Hence according to the
Feller classiï¬cation y = 0 is a â€natural boundaryâ€ while yB (t) is â€regularâ€.
Proof Straightforward application of Feller classiï¬cation criteria produces the result. End Proof
According to Feller theory, the speciï¬cation of boundary conditions is
required only for regular boundaries, hence the deï¬nition of the process yt
must be completed with the determination of the boundary conditions at
yB (t).
The type of boundary condition to be imposed as yt â†’ yB (t) are determined by the lateral conditions on the dual value function which were
assumed in the veriï¬cation theorem or, equivalently, by the analysis of the
admissible optimal allocation and consumption policies for an agent in the
limiting situation of z â†’ 0. The classiï¬cation goes as follows:
â€¢ Consider ï¬rst the Regime I, t < Ï„ âˆ— . The optimal control policy is
consistent with an instantaneously reï¬‚ecting boundary condition for
yt .
If K3 Ì¸= 0, then limyâ†’yâˆ’ (t) Ïƒ 2 (y, t) = 2K3 yB2 (t) Ì¸= 0 and a singular conB
trol action must be exerted to â€regulateâ€ the process yt and constrain
its evolution to stay within the admissible state space. Repeating the
considerations of He and PageÌ€s (1991) and extending their approach to
the incomplete market setup, the candidate optimal dynamics for the

48

shadow prices process when t < Ï„ âˆ— is given by:

âˆ«

âˆš
âˆš
dMtâˆ—
dyt
1
=
âˆ’
(K
+
K
âˆ’
2K
)
dt
+
2K
dW
+
2K4 dWt2
1
2
3
3
t
yt
Mtâˆ—
yt âˆˆ (0, yB (t)] t < Ï„ âˆ—
(52)
zt Ytf dMtâˆ— = 0 if

yt âˆˆ Dt = (0, yB (t))

The last equation speciï¬es that the process Mtâˆ— remains constant if
yt âˆˆ Dt , while it has a ï¬nite instantaneous variation when the critical
boundary yB (t) is hit. In fact the computation
of}the (generalized)
{
Ito diï¬€erential for the process yt = min yB (t) , ytf where ytf is the
unconstrained process produces:
yB (t)
dyt
(yt )
ft âˆ’ 1 dL
= Âµ (yt , t) I{yt <yB (t)} dt + Ïƒ (yt , t) I{yt <yB (t)} dW
yt
2 yB (t)

where I{yt <yB (t)} denotes the indicator function of the event
{yt < yB (t)}. The term Lyt (yB (t)) is the local time of the process
yt at the boundary yB (t). It is required to take into account that the
function g (x) = max {yB (t) , x} is not diï¬€erentiable at yB (t). Hence
drift and diï¬€usion coeï¬ƒcients describe the local evolution of the process
in yt âˆˆ Dt , while the additional contribution:
dMtâˆ—
1 dLyB (t) (yt )
=
âˆ’
Mtâˆ—
2 yB (t)
is the singular component granting that the process yt is reï¬‚ected at the
upper critical boundary yB (t). The possibility to ï¬nd a pair of processes
(Mt , yt ) which implement the reï¬‚ecting boundary condition or, in a
more mathematical terminology, which solve the Skorohod problem, is
granted by an application of the Th. 5.4 pg. 83 of Oksendal and Sulem
(2006).
As explained in He and PageÌ€s (1991) the process Mtâˆ— determines the
contribution to the shadow prices generated by the liquidity constraint.
If K3 = 0 then by condition (20) Ïƒ 2 (y, t) â†’ 0 as yt â†’ yB (t) then the
optimal shadow price process is given by:
âˆš
Vey (yt , t)
dyt
= âˆ’ (K1 + K2 ) dt + 2K4
dWt2
e
yt
yt Vyy (yt , t)
When the process yt reaches the barrier yB (t), it is instantaneously
reï¬‚ected back into the region y < yB (t) since the conditions on parameters grant that (K1 + K2 ) > 0. No singular control policy is required.
49

â€¢ Regime II, t â‰¥ Ï„ âˆ— . Let Ï„ t (Ï‰) be the ï¬rst time the process started at
time t hits the barrier yB (tâ€² ) after time Ï„ âˆ— , tâ€² > Ï„ âˆ— :
{
}
B
âˆ—
Ï„ (Ï‰) = inf Ï„ â‰¥ 0 : Ï„ < Ï„ â‰¤ T,
limâˆ’ yÏ„ â€² (Ï‰) = yB (Ï„ )
(53)
â€²
Ï„ â†’Ï„

with the convention that inf {âˆ…} = T . Then the diï¬€usion yt is still
determined by eq.(52) but it is stopped at Ï„ B (Ï‰). Hence the state
space of the diï¬€usion is given by
yt (Ï‰) âˆˆ (0, yB (t))

Ï„ âˆ— â‰¤ t < Ï„ B (Ï‰)

the process yt is killed when the boundary is hit and yt jumps to the
â€cemeteryâ€ state y = Î´ âˆ’Î³ where it remains until the ï¬nal liquidation
time T :
yt (Ï‰) = Î´ âˆ’Î³
yT (Ï‰) = Î²

Ï„ B (Ï‰) â‰¤ t < T

Hence in Regime II the {state} space for the process
of yt , {Ï„ âˆ— <}t < T
{
}
is given by the set Dt âˆª Î´ âˆ’Î³ = (0, yB (t)) âˆª Î´ âˆ’Î³ and Î´ âˆ’Î³ is an
isolated point since Î´ âˆ’Î³ > yB (t).

8.6

Proof of Theorem 5

The next Lemma proves the ï¬rst part of the Theorem.
Lemma 9 Consider the following rescaling of variables:
]
[
(K
+
K
âˆ’
2K
)
+
Î³
(K
+
2K
)
1
2
3
2
4
e
(T âˆ’ t)
Î´ 1 (T âˆ’ t) = Î´ exp
Î³
[
]
(K1 + K2 âˆ’ 2K3 )
(T âˆ’ t)
e
ct = ct exp
Î³
ze (e
c, T âˆ’ t) = z (c, t) exp [(K2 + 2K4 ) (T âˆ’ t)]
Then scaled consumption evolves like a time changed Bessel process with state
space [1, +âˆ) and boundary 1:
( )
1
dÏ†
eÏ† + 1 dL1 e
(1 + Î³) t + dB
Ï†t cÏ†t
t
2
e
cÏ†t
2
âˆ« t
Ï†t = 2
Î½ (e
cs , T âˆ’ s) ds t â‰¤ Ï„ B (Ï‰)
0
[
(
)2 ]
2
e
c
ze (e
c, T âˆ’ s)
Î½ (e
c, T âˆ’ s) = 2 K3 + K4
Î³
e
czeec (e
c, T âˆ’ s)
de
c Ï†t =

50

The time change does not change the classiï¬cation of boundaries, hence
the boundary 1 is reï¬‚ecting for 0 < t < Ï„ B (Ï‰) and killing at the ï¬rst
hitting[ time Ï„ B (Ï‰) > Ï„ âˆ—] when e
cÏ„ B (Ï‰) jumps to the â€cemetery stateâ€
Î´ exp âˆ’ (K1 +KÎ³2 âˆ’2K3 ) (T âˆ’ t) , Ï„ B (Ï‰) â‰¤ t < T .

Proof Recall that a stochastic time change is the transformation induced on a diï¬€usion process by changing the â€clockâ€, i.e. introducing a new
(stochastic) parametrization of time. We refer to standard probability textbooks for the rigorous deï¬nition of the time change transformation, see e.g.
Rogers and Williams (2000), and simply recall the basic property which is
relevant to state our result: consider a diï¬€usion process described by the
stochastic diï¬€erential equation
dXt = Âµ (Xt ) dt + Ïƒ (Xt ) dBt
then a stochastic time change is an increasing positive right continuous process t â†’ Î¦t . Assuming Î¦t to have an absolutely continuous density, say
n (Xt ), such that:
âˆ«
t

t â†’ Î¦t =

n (Xs ) ds
0

then a time change of the diï¬€usion process Xt is a new diï¬€usion process YÎ¦ ,
such that at any time t, Î¦t is a stopping time for YÎ¦ and
YÎ¦t = Xt
almost surely. Then, using the scaling property of the Brownian motion,
it is possible to prove that the stochastic diï¬€erential equation for the time
changed diï¬€usion process YÎ¦ is given by:
dYÎ¦ =

Âµ (YÎ¦ )
Ïƒ (YÎ¦ ) e
dÎ¦ + âˆš
dBÎ¦
n (YÎ¦ )
n (YÎ¦ )

eÎ¦ is a Brownian Motion with respect to the time parameter Î¦. Direct
where B
application of the above formula assuming Î¦t = Ï†t and n (e
ct ) = Î½ (e
ct , T âˆ’ t),
proves that the optimal consumption process can be time changed to a Bessel
process. The time changed process with state space limited to [1, +âˆ) can be
considered a skewed Bessel process. The formal construction and deï¬nition
of this process can be found in Decamps, Goovaerts and Schoutens (2004,
2006). End Proof
In order to prove the second part of the theorem, let us brieï¬‚y recall some
basic properties of conformal mappings:

51

Lemma 10 (Donoghue 1974) Let H = {Z = Re Z + i Im Z : Im Z > 0} a
conformal mappings Ï• : H â†’H, i.e. an analytic univalent mapping of the
upper half complex plane in itself has the following properties
1. the Pick integral representation:
âˆ«
Ï• (Z) = b0 + b1 Z +

R

1 + tZ
Î½ (dt)
tâˆ’Z

b0 = b0 , b1 â‰¥ 0 and Î½ is a ï¬nite nonnegative Borel measure on R;
2. its Laurent expansion at inï¬nity is given by:
Ï• (Z)

Zâ†’+âˆ

â‰ƒ

b0 + b1 Z +

+âˆ
âˆ‘

bn Z âˆ’n

(54)

n=1

with bn âˆˆ R. A simple transformation allows to introduce the so called
hydrodynamic normalization for the map Ï•. Each Ï• can be reduced to
the form:
+âˆ
âˆ‘
Zâ†’+âˆ
Ï• (Z) â‰ƒ Z +
bâ€²n Z âˆ’n
n=1

bâ€²n âˆˆ R.
3. Conformal functions forms a semigroup with respect to composition,
i.e. if Ï•1 , Ï•2 are conformal maps, then Ï•1 â—¦ Ï•2 is conformal.
Let Î¦H be the set of inverse conformal transformations. Also this set of
transformations forms a semigroup:
each pair of elements g1 , g2 âˆˆ Î¦H swe
( âˆ’1 âˆ’1to)âˆ’1
can associate the map g3 = g1 â—¦ g2
. Lagrange inversion formula proves
that also the element of g âˆˆ Î¦H has a Laurent expansion (54) which can be
hydrodynamically normalized.
Proof of the regularity result: ze (e
c, Ï„ ) âˆˆ Î¦H , âˆ€Ï„ âˆˆ [0, T ]
The proof of the second part of the theorem is easily obtained as an extension of an argument discussed in Bernard and Bauer (2002, 2003). These
authors prove that the Bessel process induces a stochastic ï¬‚ow in the space
of maps belonging to Î¦H and hydrodynamically normalized at âˆ. The argument is essentially the following: let F (c, T ) be a germ of an analytic
function with (real) analytic expansion as c â†’ âˆ
F (c) =

+âˆ
âˆ‘
n=0

52

fn c1âˆ’n

then for any g âˆˆ Î¦H , it is possible to deï¬ne an operator Î³ g acting on F
Î³ g F = F â—¦ g.
This set of operators forms a semigroup with a composition law Î³ g1 Â·Î³ g2 = Î³ g3
(
)âˆ’1
where g3 = g1âˆ’1 â—¦ g2âˆ’1 .
Consider the SDE for the Bessel process:
(
)
dt
1
+d
+ dBt c0 = c,
(55)
dct =
2
ct
the random stochastic ï¬‚ow ct (c, Ï‰) associated to the SDE is the application
which maps the initial condition c to the terminal one ct along path Ï‰.
The random stochastic ï¬‚ow deï¬ned by the Bessel SDE can be expanded
at c â†’ +âˆ:
+âˆ
âˆ‘
câ†’+âˆ
ct (c, Ï‰) â‰ƒ c + Î³ 0 (t) +
Î³ n (t) c1âˆ’n
(56)
n=2

where Î³ 0 (t) = Bt (Ï‰) and Î³ n (t) are random processes independent from c0 .
Their stochastic evolution is uniquely determined inserting (56) in the SDE
(55) imposing that the SDE holds independently from the value of c. Then
the following set of equations is obtained:
+âˆ
âˆ‘

dÎ³ n (t) c1âˆ’n
0

=

n=0

+âˆ
âˆ‘

pn ({Î³ n (t)}) c1âˆ’n
dt + dBt
0

n=0

where pn ({Î³ n (t)}) is a polynomial in Î³ n (t) deï¬ned by
câˆ’1
t

(c0 ) =

+âˆ
âˆ‘

pn ({Î³ n (t)}) c1âˆ’n
,
0

n=0
nâˆ’2
âˆ‘

pn ({Î³ n (t)}) = âˆ’

p1 = 0, p2 = 1,

Î³ i (t) pnâˆ’i ({Î³ n (t)})

i=1

The possibility to expand the stochastic ï¬‚ow of a Bessel process in such a
series has an algebraic motivation: in fact the Bessel generator
(
(
) 2)
1
1 âˆ‚
âˆ‚
+
A=
+d
c âˆ‚c
2
âˆ‚c2
can be written like an element of the Virasoro algebra. In fact A can be
written as:
( (
)
)
1
1 2
A= âˆ’
+ d L2 + L1
2
2
53

where Ln denote the generators of this algebra which are the family of differential operators
âˆ‚
Ln = âˆ’c1âˆ’n
nâ‰¥0
âˆ‚c
and are well known to be the inï¬nitesimal generators of the conformal transformations. Each generator Ln spans the subspace of conformal maps corresponding to the coeï¬ƒcient Î³ n (t) c1âˆ’n . The Virasoro Algebra generators are
known to correspond to the inï¬nitesimal generators for a semigroup of composition operators within the class of inverse conformal functions. Similarly,
application of Ito lemma implies:
dF (ct (c0 )) = AF (ct (c0 )) dt + F â€² (ct (c0 )) dBt
which can be rewritten in symbolic notation as:
{[ (
)
]
}
1
1 2
dÎ³ ct Â· F = Î³ ct
âˆ’
+ d L2 + L1 dt âˆ’ L2 dBt Â· F
2
2

(57)

and this formula shows that the stochastic ï¬‚ow Î³ ct generated by A is a one
parameter stochastic sub-semigroup acting on F by composition as follows:
Î³ cÏ„ Â· F = F (cÏ„ (c0 , Ï‰))
and the stochastic ï¬‚ow of a Bessel process can be interpreted as a one parameter sub-semigroup of the semigroup generated by the Virasoro Algebra
of inverse conformal mappings Î³ g , g âˆˆ Î¦H with an analytic expansion of the
form (54) and hydrodynamic normalization at âˆ.
The stochastic evolution of F (cÏ„ (c0 , Ï‰) , Ï„ ) can be rewritten as a stochastic evolution for the coeï¬ƒcients fn of its analytic expansion of F at âˆ.
Correspondingly the martingale condition:
âˆ‚
F (c, Ï„ ) + AF (c, Ï„ ) = 0
âˆ‚Ï„
determines a deterministic evolution equation in the manifold of inverse conformal functions. These functions are parametrized by the asymptotic coefcâ†’+âˆ âˆ‘
1âˆ’n
ï¬cients fn (Ï„ ) such that F (c, Ï„ ) â‰ƒ
. In addition, a group
n fn (Ï„ ) c
theoretical construction analyzed by Bauer and Bernard (2003) shows that
the equations which determine fn (Ï„ ) have a hierarchical triangular structure.
Hence, provided that F (c, 0) âˆˆ Î¦H , the solution to the boundary value problem generated by the martingale problem (57) can be reduced to an inï¬nite
hierarchy of ODE for the coeï¬ƒcients fn (Ï„ ) which parametrize a family of
inverse conformal mappings.
54

It will be proved that the same property holds for the non linear boundary
value problem (34).
First of all it is easy to show that (34) can be restated as a boundary value
problem in a space of inverse conformal maps hydrodynamically normalized
at e
c = +âˆ. In fact observe that without loss of generality, the change of
variables: e
câ†’e
câ€² = b0 (Ï„ )+b1 (Ï„ ) e
c maps the original problem to the following
simpliï¬ed version:
(
)
âˆ‚
(1 + Î³) 1
1
zec (e
c, Ï„ ) + zecc (e
c, Ï„ ) Î½ (e
âˆ’ ze (e
c, Ï„ ) +
c, Ï„ ) = 0
âˆ‚Ï„
2 e
c
2
[
(
)2 ]
ze (e
c, Ï„ )
e
c2
Î½ (e
c, Ï„ ) = 2 2 K3 + K4
(58)
Î³
e
czeec (e
c, Ï„ )
ze (e
c, 0) = e
c
lim
+

e
câ†’e
cB =e
câ€² (1)

ze (e
c, Ï„ ) = 0

lim
+

e
câ†’e
cB =e
câ€² (1)

zec (e
c, Ï„ ) = 0

ze (e
c, Ï„ )
=0
czec (e
c, Ï„ )
e
câ†’e
cB =e
câ€² (1) e
lim
+

Solutions to (58) can be assumed to be hydrodynamically normalized mappings in Î¦H . Direct substitution of the series expansion solution (25) for
ze (e
c, Ï„ ) in eq.s (58) shows that the solution family has an asymptotic expansion compatible with the property that the functions ze (e
c, Ï„ ) are inverse
conformal functions, i.e. ze (e
c, Ï„ ) âˆˆ Î¦H and suggests to interpret the boundary
value problem eq.(58) as a martingale problem with respect to time changed
Bessel process. In fact eq.s (58) and (57) are related by a simple change of
time scale. The martingale problem deï¬ned by eq.s (58) is given by:
âˆ« t
f
et = f (e
C
ct ) âˆ’ f (e
c0 ) âˆ’
Af (e
cs ) Î½ (e
cs , T âˆ’ s) ds Ft âˆ’ martingale (59)
0

and deï¬ning the increasing process:
âˆ« t
at =
Î½ âˆ’1 (e
cs , T âˆ’ s) ds,
0

then
Î±t = inf {u : au > t}
is a stopping time. The change of variables e
ct = ÎºÎ±t implies
âˆ« Î±t
Af (Îºs ) ds FÎ±t âˆ’ martingale
CÎ±f t = f (ÎºÎ±t ) âˆ’ f (Îº0 ) âˆ’

(60)

0

which is the martingale problem for a standard Bessel process.
Since the initial element of the solution family is an element of Î¦H ,
ze (e
c, 0) = e
c, provided the existence of a bounded stochastic time density
55

Î½ (e
c, Ï„ ) which maps (59) onto (60), it is possible to conclude that the functions which solve the martingale problem generated by eq.(58) are still inverse
conformal functions, i.e. belong to Î¦H .
The characterization of the time change is complicated by the fact that
the stochastic time density Î½ (e
c, Ï„ ) is determined by the solution ze (e
c, Ï„ ), i.e.
it is in feedback form. Thanks to the assumption K3 Ì¸= 0, the function Î½ (e
c, Ï„ )
is bounded and diï¬€erent from 0, if and only if Eze , (e
z (e
c, Ï„ ) /e
czeec (e
c, Ï„ )) is
bounded. Now we prove that Eze is bounded for any ze âˆˆ Î¦H which solves
(58). By deï¬nition Eze is positive, tends to 0 for e
c â†’ 0+ and converges to 1
as e
c â†’ +âˆ. In addition, if ze (e
c, Ï„ ) âˆˆ Î¦H , then its inverse function e
c (e
z , Ï„ ) is
a conformal function, hence matrix monotone of any order in (0, +âˆ). This
implies (see Donoghue 1974 pg.86) that the derivative function e
cz (e
z , t) is
dn
completely monotone, i.e. (âˆ’1)n dz
e
c
(e
z
,
Ï„
)
â‰¥
0,
âˆ€n
â‰¥
1,
hence
e
c
(e
z
,
Ï„) < 0
zz
n z
and e
cz is decreasing. The ratio ze/e
c (e
z , Ï„ ) is increasing when Eze < 1, decreasing when Eze > 1, in fact:
]âˆ’1
[
d e
c (e
z, Ï„ )
e
c (e
z, Ï„ )
zee
cz (e
z, Ï„ )
=
âˆ’ 1 = Eze âˆ’ 1
ze
ze
de
z ze
e
c (e
z, Ï„ )
In conclusion the coeï¬ƒcient Eze is positive, it is the product of an decreasing function multiplied by a function increasing in the region Eze < 1, and
decreasing in the region Eze > 1. Hence limecâ†’0+ Eze = 0+ , Eze is positive and
cannot increase beyond 1, then we can conclude that it is bounded.
Having proved that the time change density Î½ is bounded, we have shown
that the family ze (e
c, Ï„ ) solves a martingale problem for a time changed Bessel
process, with initial condition in Î¦H , and it is possible to conclude ze (e
c, Ï„ ) âˆˆ
Î¦H , âˆ€Ï„ âˆˆ [0, T ].
Verification of Condition A
Notice that ze (e
c, Ï„ ) âˆˆ Î¦H is the inverse of a conformal function which is
matrix monotone, hence it is monotonic increasing and inï¬nitely diï¬€erentiable with respect to e
c and ï¬rst order diï¬€erentiable with respect to time.
These properties imply that Ve (y, t) has all the regularity properties claimed
e (y, t) is bounded by Î³:
in Condition A. In addition the coeï¬ƒcient R
e
c, Ï„ )
e (y, t) , âˆ’Vy (y, t) = Î³ ze (e
R
<Î³
e
czeec (e
c, Ï„ )
y Veyy (y, t)
Given the above conclusions, Condition A is veriï¬ed and application
of Proposition 1 determines uniquely a convex Ve (y, t) and by duality
V (z, t) which is the unique solution to the reduced HJB. Then V (l, h, t) =
h1âˆ’Î³ V (z, t) solves the original stochastic optimization problem.

56

8.7

Numerical determination of the dual value function and of its domain.

We will show that after the insertion of eq.(22), the HJB equation (16) becomes equivalent to a system of linear ODE with respect to time.
8.7.1

The zero order term

Identifying
the terms proportional to y b in the HJB and observing that
(
)
âˆ‚
y âˆ‚y
y b = by b , we immediately obtain that (14) implies the following ODE
for B0 (t):
d
1
B0 (t) = âˆ’a0 B0 (t) +
dt
b
1/Î³
Î²
B0 (T ) = âˆ’
,
b
where
(
)
( 2
)
b2
a0 =
K1 âˆ’ (K2 + K1 ) b + K3 b âˆ’ b âˆ’ K4 2
b âˆ’b
(
(
)2 )
Îº âˆ’ r 1 (1 âˆ’ Î³) (Î± âˆ’ r)
=
r+
âˆ’
,
Î³
2 Î³2
Ïƒ
this term corresponds to the standard Merton solution which would be exact
in absence of the illiquid asset (see equation 37). This equation is a linear
non homogenous ODE and can be explicitly solved:
{
(
)
}( )
1
1
1
1/Î³
B0 (t) = exp [a0 (T âˆ’ t)] Î² +
âˆ’
âˆ’
.
a0
a0
b
8.7.2

First order term

Repeating the procedure for the terms proportional to y we get an ODE for
d
B1 (t) = âˆ’a1 B1 (t) âˆ’ Î´
dt
B1 (T ) = +1,
where (see equation 41):
a1 = (2Î³K4 âˆ’ K2 )
(
)
Î·Ï
= âˆ’ + (Î± âˆ’ r)
âˆ’ (Âµ âˆ’ Î´ âˆ’ r) ,
Ïƒ
and correspondingly the solution will be
(
)
Î´
Î´
B1 (t) = exp [a1 (T âˆ’ t)] 1 +
âˆ’ .
a1
a1
57

8.7.3

N-th order correction

In this section we derive from the dual HJB a hierarchy of ODE for the
coeï¬ƒcients Bn (t) which can be recursively solved. As a ï¬rst step we guess
that the dual value function can be written as:
(
)
Ve (y, t) = y b Ï• y 1/Î³ , t
âˆ
âˆ‘
Ï• (x, t) =
Bn (t) xn .
n=0

Now we derive the hierarchy of ODE equations for Ï• (x, t) obtained from the
âˆ‚
âˆ‚2
dual HJB. First of all we express the operators y âˆ‚y
and y 2 âˆ‚y
2 in terms of the
âˆ‚
1/Î³
number operator N := x âˆ‚x where x = y :
(
)
âˆ‚ b+n/Î³
n
y y
=
b+
y b+n/Î³ =
âˆ‚y
Î³
= y b [(b + xâˆ‚x ) xn ]|x=y1/Î³
CN
y2

âˆ‚ b+n/Î³
y
âˆ‚y 2

= y b [CN xn ]|x=y1/Î³ ,
: = b + N,
[(
)2 (
)]
n
n
=
b+
âˆ’ b+
y b+n/Î³
Î³
Î³

= y b [DN xn ]|x=y1/Î³ ,
(
)(
)
N
N
DN : = b +
b+
âˆ’1
Î³
Î³
(
)
Inserting the guess solution y b Ï• y 1/Î³ , t in the homogeneous version of the
dual HJB and factoring the term y 2b it is immediate to verify that the equation for Ï• (x, t) can be rewritten in terms of the number operator N as:
[Ï•t (x, t) + K1 Ï• (x, t) âˆ’ (K1 + K2 ) CN Ï• (x, t)] DN Ï• (x, t) +
(61)
[
]
1
+ K3 DN Ï• (x, t) âˆ’ + Î´x DN Ï• (x, t) âˆ’ K4 [CN Ï• (x, t)]2 = 0,
b
Then the ODE ï¬‚ow can now be uniquely determined by the PDE inserting
the series expansion:
+âˆ
âˆ‘
Ï• (x) =
Bn (t) xn ,
n=0

58

in eq.(61) and imposing that the coeï¬ƒcient of the monomial xm vanishes for
any m:
0 = âŸ¨xm , [Ï•t (x, t) + K1 Ï• (x, t) âˆ’ (K1 + K2 ) CN Ï• (x, t)] DN Ï• (x, t)âŸ© +
âŸ¨
[
]
âŸ©
1
2
m
+ x , K3 DN Ï• (x, t) âˆ’ + Î´x DN Ï• (x, t) âˆ’ K4 [CN Ï• (x, t)] .
b
Correspondingly the m âˆ’ th order equation will be:
m
âˆ‘

Hm =

Dmâˆ’n Bmâˆ’n (t) âˆ‚Bn (t) /âˆ‚t +

n=0

+

m
âˆ‘

Dmâˆ’n Bmâˆ’n (t) (K1 âˆ’ (f K2 + K1 ) Cn + K3 Dn ) Bn (t) +

n=0

[
]
1
+
Dmâˆ’n Bmâˆ’n (t) Î´âˆ†1,n âˆ’ âˆ†0,n +
b
n=0
m
âˆ‘

âˆ’K4

m
âˆ‘

Cmâˆ’n Bmâˆ’n (t) Cn Bn (t) ,

n=0

where âˆ†i,j denotes the Kronecker symbol, deï¬ned by: âˆ†i,j = 1 if i = j,
âˆ†i,j = 0 if i Ì¸= j. The inï¬nite hierarchy of ODE equations Hm = 0, m âˆˆ N,
can be put in normal form as stated in the following
Proposition 11 âˆ€N âˆˆ N, the system of ODE equations:
Hm = 0, m = 0, 1, 2, .., N,
is equivalent to the set of equations:
1
0 = dBn (t) /dt + (K1 âˆ’ (K2 + K1 ) Cn + K3 Dn ) Bn (t) + Î´âˆ†1,n âˆ’ âˆ†0,n
b
N
âˆ‘
(N )
(N ) (N )
âˆ’K4
Mn+1,m+1 Gmâˆ’k vk+1 n â‰¥ 0,
k,m=0

where:
M (N )
(N )

T pn+1,l+1
Tp

(N )
Gn+1,l+1
(N )
(N )

,G

(N )

vl+1

:

(
)âˆ’1
= T p(N )

:

= Dnâˆ’l Bnâˆ’l (t) , n â‰¥ l

T pn+1,l+1 = 0,

= Cnâˆ’l Bnâˆ’l (t) , n â‰¥ l

(N )
Gn+1,l+1

:

(N )

âˆˆ M (R)(N +1)Ã—(N +1)
:

= Cl Bl (t) ,

l = 0, ..., N.
59

= 0,

n < l,
n < l,

Proof Note that in matrix-vector notation the system of ODE equations
can be written like:
T p(N ) Â· w(N ) âˆ’ K4 G(N ) Â· v (N ) = 0,

(62)

where Â· denotes the matrix product and:
1
(N )
wn+1 = âˆ‚Bn (t) /âˆ‚t + (K1 âˆ’ (K2 + K1 ) Cn + K3 Dn ) Bn (t) + Î´âˆ†1,n âˆ’ âˆ†0,n
b
n = 0, .., N.
T p(N ) is an invertible matrix, in fact it is triangular and along the main
diagonal T Pi,i = D0 B0 (t) which is diï¬€erent from 0 for any t âˆˆ [0, T ]. Hence
(
)âˆ’1
left multiplying (62) by M (N ) = T p(N )
we get:
M (N ) Â· T p(N ) Â· w(N ) âˆ’ K4 M (N ) Â· G(N ) Â· v (N ) =
w(N ) âˆ’ K4 M (N ) Â· G(N ) Â· v (N ) = 0,
and the claim follows. 
Note that the equations for N = 0 and N = 1 correspond to those obtained in the previous sections. If we consider the equation for the coeï¬ƒcient
of order N â‰¥ 2, then the equation to be satisï¬ed by BN (t) is given by:
0 = [dBN (t) /dt + [K1 âˆ’ (K2 + K1 ) CN + K3 DN ] BN (t)]
âˆ’K4

N
âˆ‘

(N )

(N )

MN +1,m+1 Gm+1,l+1 Cl Bl ,

m,l=0

B0 (T ) = âˆ’1/b,

B1 (T ) = 1,

Bn (T ) = 0 2 â‰¤ n â‰¤ N.

This system of equations is highly non linear due to the last term.
A crucial property is that the set of ODE can be recursively solved. In
fact, consider the ODE equation to be satisï¬ed by the highest order coeï¬ƒcient
BN (t) given the coeï¬ƒcients {Bn (t)}n=0,...,N âˆ’1 : this is a linear equation in
BN (t) which does not involve higher order coeï¬ƒcients BN â€² (t), N â€² > N . In
fact at level N â‰¥ 2 the equation will be:
0 = [dBN (t) /dt + (K1 âˆ’ (K2 + K1 ) CN + K3 DN ) BN (t)]
N
âˆ‘
(N )
(N )
(N )
âˆ’K4
MN +1,m+1 Gm+1,l+1 vl+1 ,
m,l=0

60

and extracting from the last summation the terms which contain BN we get:
0 = dBN (t) /dt âˆ’ K4 f (N ) (t) +
[
(
)
(
)
]
2K4
K4
K1 âˆ’ K2 + K1 +
CN + K3 +
DN BN (t) ,
bâˆ’1
(b âˆ’ 1)2
N âˆ‘
N
âˆ‘
(N )âˆ—
(N )âˆ—
(N )âˆ—
(N )
MN +1,m+1 Gm+1,l+1 vl+1 ,
(63)
f (t) =
m=0 l=0

M

(N )âˆ—

=

(

T p(N )âˆ—

)âˆ’1

,

(N )âˆ—

)âˆ—
(T p)N +1,1 = 0, (T p)(N
m+1,n+1 = (T p)m+1,n+1
(N )âˆ—

(N )âˆ—

(N )

GN +1,1 = 0, Gm+1,n+1 = Gm+1,n+1
(N )âˆ—

(N )âˆ—

vN +1 = 0, vl+1 = Cl Bl

(m, n) Ì¸= (N, 0)

(m, n) Ì¸= (N, 0)

l Ì¸= N.

Then the linear ODE to be solved is:
âˆ‚BN (t) /âˆ‚t = âˆ’aN BN (t) + K4 f (N ) (t)
BN (T ) = 0,
where

)
(
)
]
[
(
K4
2K4
CN + K3 +
DN ,
a N = K1 âˆ’ K2 + K1 +
bâˆ’1
(b âˆ’ 1)2

and
f (N ) (t) =

N âˆ‘
N
âˆ‘

(N )âˆ—

(N )âˆ—

(N )âˆ—

MN +1,m+1 Gm+1,l+1 vl+1 .

(64)

(65)

m=0 l=0

The general solution to this equation will be:
âˆ« T
BN (t) = âˆ’K4
eaN (sâˆ’t) f (N ) (s) ds.
t

In order to identify the solution it is necessary to impose the boundary
conditions. This can be easily done imposing the condition that the Taylor
coeï¬ƒcients of the function z (c, t) expanded around cB (t) are zero.

8.8

Accuracy of the numerical determination of the
dual value function.

In the region of convergence the determination of Ve (y, 20) is largely independent from N for N > 10. The coeï¬ƒcients of the series converge to zero
exponentially fast. Within the numerical accuracy of double precision, the
value of the numerical determination is independent from the truncation order.
61

y
0

1

2

3

4

5

6

0
âˆ’2

Vtilda(y,t),D_yVtilda(y,t)

âˆ’4
âˆ’6
âˆ’8
âˆ’10
âˆ’12
âˆ’14
âˆ’16
âˆ’18
âˆ’20

Figure 10: Dual Value function and its derivative with respect to y (dotted
line)

8.9

Computation of partial derivatives

Vt (l, h, t)
V (l, h, t)
Vl (l, h, t)
Vll (l, h, t)
Vh (l, h, t)
Vhh (l, h, t)
Vlh (l, h, t)

8.10

=
=
=
=
=
=
=

âˆ’Îºh1âˆ’Î³ V (z, t) + h1âˆ’Î³ Vt (z, t) ,
(66)
1âˆ’Î³
h V (z, t) ,
hâˆ’Î³ Vz (z, t) ,
hâˆ’Î³âˆ’1 Vzz (z, t) ,
hâˆ’Î³ [(1 âˆ’ Î³) V (z, t) âˆ’ zVz (z, t)] ,
[
]
hâˆ’Î³âˆ’1 âˆ’Î³ (1 âˆ’ Î³) V (z, t) + 2Î³zVz (z, t) + z 2 Vzz (z, t) ,
âˆ’hâˆ’Î³âˆ’1 [Î³Vz (z, t) + zVzz (z, t)] .

Proof of equation (36)

If we deï¬ne q as:

[

(1 âˆ’ Î³) V (l, h, t)
q :=
h1âˆ’Î³ (z + p (z, t))1âˆ’Î³

62

]âˆ’1/Î³
,

10
9
8

6
5

y_B(t)

7

4
3
2
1
0
0

2

4

6

8

10

12

14

16

18

20

t

Figure 11: A numerical determination of yB (t) under the parametric conditions given in Table 1.
homogeneity of V implies that q is a function of z and t only, hence we can
represent V (l, h, t) and V (z, t) as:
âˆ’Î³

V (l, h, t) = q (z, t)

V (z, t) = q (z, t)âˆ’Î³

w (l, h, t)1âˆ’Î³
1âˆ’Î³
(z + p (z))1âˆ’Î³
.
1âˆ’Î³

By eq. (7) optimal consumption is given by:
câˆ— (l, h, t)âˆ’Î³ = Vl (l, h, t) = hâˆ’Î³ Vz (z, t) ,
and by the deï¬nition of p (z, t) :
Vz (z, t) = (1 âˆ’ Î³)

V (z, t)
= q (z, t)âˆ’Î³ (z + p (z))âˆ’Î³ ,
z + p (z)

hence the consumption over wealth ratio will be deï¬ned by:
(Vz (z, t))âˆ’1/Î³
câˆ— (l, h, t)
=
w (l, h, t)
z + p (z)
(
)âˆ’1/Î³
q (z, t)âˆ’Î³ (z + p (z))âˆ’Î³
=
z + p (z)
= q (z, t) .
63

8.11

Proof of equation (38)

The maximization in eqs.(8) yields the risky allocation formula:
âˆ’

Vl (l, h, t) Î± âˆ’ r hVlh (l, h, t) Î·Ï
âˆ’
,
Vll (l, h, t) Ïƒ 2
Vll (l, h, t) Ïƒ

and applying eqs.(66) we obtain:
[
(
)
]
Vz (z, t)
Î± âˆ’ r âˆ’ Î³Î·ÏÏƒ
Î·Ï
âˆ’
âˆ’ z h,
Ïƒ2
Vzz (z, t)
Ïƒ
and using the deï¬nition of R (z, t) we conclude.

8.12

Proof of Corollary 6

The proof is an immediate consequence of He and Pearson (1991) Th.7
and similar to Proposition 1 in TeplaÌ€ (2000). Th.7 states the following:
let l (Î», h, t) be the liquid wealth considered as a function of h, t and
Î» = Vl (l, h, t), the conjugate variable of l, then following feedback representation for the the volatility of the SDF, i.e. optimal risk adjustment on
Wt2 , Ïƒ
eSDF
, holds:
2
Ïƒ
eSDF
(Î», h, t) =
2

)1/2
hlh (Î», h, t) (
Î· 1 âˆ’ Ï2
.
Î»lÎ» (Î», h, t)

Since we apply duality to the reduced value function V (z, t), and to the
rescaled liquid wealth z = l/h, it is straightforward to prove that homogeneity
implies the relation: Î» = yhâˆ’Î³ . In terms of reduced variable y and h, the
feedback formula for Ïƒ
eSDF
will be:
2
[
]
(
)1/2
l (Î» (y, h) , h, t)
SDF
Ïƒ
e2 (Î» (y, h) , h, t) = Î³ âˆ’
Î· 1 âˆ’ Ï2
.
yly (Î» (y, h) , h, t)
Since l (Î» (y, h) , h, t) = hz (y, t) where z (y, t) = âˆ’Vey (y, t) then we can conclude that:
(
)
(
)1/2
Vey (y, t)
SDF
SDF
e2 (y, 1, t) = Î³ âˆ’
,
Ïƒ 2 (y, t) = Ïƒ
Î· 1 âˆ’ Ï2
y Veyy (y, t)
and (40) holds.

64

8.13

Proof of equation (42)

Optimal consumption is given by (7) hence: câˆ— (l, h, t) = [Vl (l, h, t)]âˆ’1/Î³ . In
terms of the state variables h, z and t we have:
l (h, z, t) = hz
câˆ— (l (z, h, t) , h, t) = hVz (z, t)âˆ’1/Î³ .
Then the elasticity of consumption w.r.t liquid wealth can be written as:
(
)
âˆ’1/Î³
âˆ‚ hVz (z, t)
l (z, h, t)
âˆ‚câˆ— ((z, h, t) , h, t)
zh
âˆ‚z
=
âˆ’1/Î³
âˆ—
c (l (z, h, t) , h, t)
âˆ‚l (z, h, t)
âˆ‚z
âˆ‚l (z, h, t)
hVz (z, t)
(
)
âˆ‚ hVz (z, t)âˆ’1/Î³
l
âˆ‚h
+
,
âˆ’1/Î³
âˆ‚h
âˆ‚l (z, h, t)
hVz (z, t)
which equals
âˆ‚câˆ— (l, h, t)
âˆ‚câˆ— (l, h, t)
1 zVzz (z, t)
h
l
=
âˆ’
+
,
câˆ— (l, h, t) âˆ‚l (l, h, t)
Î³ Vz (z, t)
câˆ— (l, h, t)
âˆ‚h
hence by eq.(39) we can conclude:
âˆ‚câˆ— (l, h, t)
h
âˆ‚câˆ— (l, h, t)
R (z)
l
âˆ’
=
.
âˆ—
âˆ—
c (l, h, t)
âˆ‚l
c (l, h, t)
âˆ‚h
Î³

65

