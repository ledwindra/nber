NBER WORKING PAPER SERIES

ON HECKITS, LATE, AND NUMERICAL EQUIVALENCE
Patrick M. Kline
Christopher R. Walters
Working Paper 24477
http://www.nber.org/papers/w24477

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
April 2018, Revised October 2018

We thank Josh Angrist, David Card, James Heckman, Magne Mogstad, Parag Pathak, Demian
Pouzo, Raffaele Saggio, and Andres Santos for helpful discussions. The views expressed herein
are those of the authors and do not necessarily reflect the views of the National Bureau of
Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
¬© 2018 by Patrick M. Kline and Christopher R. Walters. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full
credit, including ¬© notice, is given to the source.

On Heckits, LATE, and Numerical Equivalence
Patrick M. Kline and Christopher R. Walters
NBER Working Paper No. 24477
April 2018, Revised October 2018
JEL No. C01,C26,C31,C52
ABSTRACT
Structural econometric methods are often criticized for being sensitive to functional form
assumptions. We study parametric estimators of the local average treatment effect (LATE)
derived from a widely used class of latent threshold crossing models and show they yield LATE
estimates algebraically equivalent to the instrumental variables (IV) estimator. Our leading
example is Heckman‚Äôs (1979) two-step (‚ÄúHeckit‚Äù) control function estimator which, with twosided non-compliance, can be used to compute estimates of a variety of causal parameters.
Equivalence with IV is established for a semi-parametric family of control function estimators
and shown to hold at interior solutions for a class of maximum likelihood estimators. Our results
suggest differences between structural and IV estimates often stem from disagreements about the
target parameter rather than from functional form assumptions per se. In cases where equivalence
fails, reporting structural estimates of LATE alongside IV provides a simple means of assessing
the credibility of structural extrapolation exercises.

Patrick M. Kline
Department of Economics
University of California, Berkeley
530 Evans Hall #3880
Berkeley, CA 94720
and NBER
pkline@econ.berkeley.edu
Christopher R. Walters
Department of Economics
University of California, Berkeley
530 Evans Hall #3880
Berkeley, CA 94720-3880
and NBER
crwalters@econ.berkeley.edu

1

Introduction

In a seminal paper, Imbens and Angrist (1994) proposed an interpretation of the instrumental variables (IV)
estimand as a Local Average Treatment Effect (LATE) ‚Äì an average effect for a subpopulation of ‚Äúcompliers‚Äù
compelled to change treatment status by an external instrument. The plausibility and transparency of the
conditions underlying this interpretation are often cited as an argument for preferring IV estimators to nonlinear
estimators based on parametric models (Angrist and Pischke, 2009, 2010). On the other hand, LATE itself has
been criticized as difficult to interpret, lacking in policy relevance, and problematic for generalization (Heckman,
1997; Deaton, 2009; Heckman and Urzua, 2010). Adherents of this view favor estimators motivated by joint
models of treatment choice and outcomes with structural parameters defined independently of the instrument
at hand.
This note develops some connections between IV and structural estimators intended to clarify how the choice
of estimator affects the conclusions researchers obtain in practice. Our first result is that, in the familiar binary
instrument/binary treatment setting with imperfect compliance, a wide array of structural ‚Äúcontrol function‚Äù
estimators derived from parametric threshold-crossing models yield LATE estimates numerically identical to IV.
Notably, this equivalence applies to appropriately parameterized variants of Heckman‚Äôs (1976; 1979) classic twostep (‚ÄúHeckit‚Äù) estimator that are nominally predicated on bivariate normality. Differences between structural
and IV estimates therefore stem in canonical cases entirely from disagreements about the target parameter
rather than from functional form assumptions.
After considering how this result extends to settings with instruments taking multiple values, we probe
its limits by examining some estimation strategies where equivalence fails. First, we revisit a control function
estimator considered by LaLonde (1986) and show that it produces results identical to IV only under a symmetry
condition on the estimated probability of treatment. Next, we study an estimator motivated by a selection
model that violates the monotonicity condition of Imbens and Angrist (1994) and establish that it yields a LATE
estimate different from IV, despite fitting the same sample moments. Standard methods of introducing observed
covariates also break the equivalence of control function and IV estimators, but we discuss a reweighting
approach that ensures equivalence is restored. We then consider full information maximum likelihood (FIML)
estimation of some generalizations of the textbook bivariate probit model and show that this yields LATE
estimates that coincide with IV at interior solutions. However, FIML diverges from IV when the likelihood is
maximized on the boundary of the structural parameter space, which serves as the basis of recent proposals for
testing instrument validity in just-identified settings (Huber and Mellace, 2015; Kitagawa, 2015). Finally, we
discuss why estimation of over-identified models generally yields LATE estimates different from IV.
The equivalence results developed here provide a natural benchmark for assessing the credibility of structural
estimators, which typically employ a number of over-identifying restrictions in practice. As Angrist and Pischke
(2010) note: ‚ÄúA good structural model might tell us something about economic mechanisms as well as causal
effects. But if the information about mechanisms is to be worth anything, the structural estimates should line
up with those derived under weaker assumptions.‚Äù Comparing the model-based LATEs implied by structural

2

estimators with unrestricted IV estimates provides a transparent assessment of how conclusions regarding a
common set of behavioral parameters are influenced by the choice of estimator. A parsimonious structural
estimator that rationalizes a variety of IV estimates may reasonably be deemed to have survived a ‚Äútrial by
fire,‚Äù lending some credibility to its predictions.

2

Two views of LATE

We begin with a review of the LATE concept and its link to IV estimation. Let Yi represent an outcome of
interest for individual i, with potential values Yi (1) and Yi (0) indexed against a binary treatment Di . Similarly,
let Di (1) and Di (0) denote potential values of the treatment indexed against a binary instrument Zi . Realized
treatments and outcomes are linked to their potential values by the relations Di = Zi Di (1) + (1 ‚àí Zi ) Di (0)
and Yi = Di Yi (1) + (1 ‚àí Di ) Yi (0). Imbens and Angrist (1994) consider instrumental variables estimation under
the following assumptions:
IA.1 Independence/Exclusion: (Yi (1), Yi (0), Di (1), Di (0)) ‚ä•‚ä• Zi .
IA.2 First Stage: P r [Di = 1|Zi = 1] > P r [Di = 1|Zi = 0].
IA.3 Monotonicity: P r [Di (1) ‚â• Di (0)] = 1.
Assumption IA.1 requires the instrument to be as good as randomly assigned and to influence outcomes only
through its effect on Di . Assumption IA.2 requires the instrument to increase the probability of treatment,
and assumption IA.3 requires the instrument to weakly increase treatment for all individuals.
Imbens and Angrist (1994) define LATE as the average treatment effect for ‚Äúcompliers‚Äù induced into treatment by the instrument (for whom Di (1) > Di (0)). Assumptions IA.1-IA.3 imply that the population Wald
(1940) ratio identifies LATE:
E [Yi |Zi = 1] ‚àí E [Yi |Zi = 0]
= E [Yi (1) ‚àí Yi (0)|Di (1) > Di (0)] ‚â° LAT E.
E [Di |Zi = 1] ‚àí E [Di |Zi = 0]
n

Suppose we have access to an iid vector of sample realizations {Yi , Di , Zi }i=1 obeying the following condition:
Condition 1.

P1

i Zi

P

i

Zi Di >

1
i (1‚àíZi )

P

P

i (1

‚àí Zi )Di .

When IA.2 is satisfied the probability of Condition 1 being violated approaches zero at an exponential rate in
n. The analogy principle suggests estimating LATE
P with:
P
P1
P 1
IV
i Zi Yi ‚àí
i (1 ‚àí Zi )Yi
Zi
(1‚àíZi )
i
i
\E =
P
P
LAT
.
1
1
P
P
i Zi Di ‚àí
i (1 ‚àí Zi )Di
Zi
(1‚àíZi )
i

i

This IV estimator is well-defined under Condition 1, and is consistent for LAT E under assumptions IA.1-IA.3
and standard regularity conditions.

3

Threshold-crossing representation
Vytlacil (2002) showed that the LATE model can be written as a joint model of potential outcomes and selfselection in which treatment is determined by a latent index crossing a threshold. Suppose treatment status is
generated by the equation
Di = 1 {œà(Zi ) ‚â• Vi },
where the latent variable Vi is independently and identically distributed according to some continuous distribution with cumulative distribution function FV (.) : R ‚Üí [0, 1], and œà (.) : {0, 1} ‚Üí R defines instrumentdependent thresholds below which treatment ensues. Typically FV (.) is treated as a structural primitive
describing a stable distribution of latent costs and benefits influencing program participation that exists independently of a particular instrument, as in the classic selection models of Roy (1951) and Heckman (1974). We
follow Heckman and Vytlacil (2005) and work with the equivalent transformed model

Di = 1 {P (Zi ) ‚â• Ui } ,

(1)

where Ui ‚â° FV (Vi ) follows a uniform distribution and P (Zi ) ‚â° FV (œà(Zi )) is the propensity score. The
instrument Zi is presumed to increase the likelihood of treatment (P (1) > P (0)), and to be independent of Ui
and potential outcomes:
(Yi (1), Yi (0), Ui ) ‚ä•‚ä• Zi .

(2)

The selection model defined by (1) and (2) is equivalent to the treatment effects model described by assumptions IA.1-IA.3. Equation (1) merely translates the behavioral responses that are permitted in the LATE model
into a partition of the unit interval. In the terminology of Angrist et al. (1996), assumption IA.3 implies that the
population consists of compliers with Di (1) > Di (0), ‚Äúalways takers‚Äù with Di (1) = Di (0) = 1, and ‚Äúnever takers‚Äù
with Di (1) = Di (0) = 0. The latent variable Ui is defined such that always takers have Ui ‚àà [0, P (0)], compliers
have Ui ‚àà (P (0), P (1)], and never takers have Ui ‚àà (P (1), 1]. Condition (2) implies that potential outcomes and
treatment choices are independent of the instrument and imposes no further restrictions on the joint distribution
of these quantities. It follows that we can equivalently define LAT E = E [Yi (1) ‚àí Yi (0)|P (0) < Ui ‚â§ P (1)].
Though Vytlacil‚Äôs (2002) results establish equivalence between a non-parametric latent index model and
the LATE model, the fully non-parametric model is typically not used for estimation. Rather, to motivate
alternatives to IV estimation, it is conventional to make additional assumptions regarding the joint distribution
of the latent cost Ui and the potential outcomes (Yi (1), Yi (0)). The goal of this note is to investigate the
consequences of such assumptions for empirical work.

3

Control function estimation

We begin by considering estimators predicated on the existence of a parametric ‚Äúcontrol function‚Äù capturing
the endogeneity in the relationship between outcomes and treatment (Heckman and Robb, 1985; Blundell and

4

Matzkin, 2014; Wooldridge, 2015). The workhorse models in this literature obey the following semi-parametric
restriction:
E [Yi (d)|Ui = u] = Œ±d + Œ≥d √ó (J(u) ‚àí ¬µJ ) , d ‚àà {0, 1} , u ‚àà (0, 1),

(3)

where J(¬∑) : (0, 1) ‚Üí R is a strictly increasing continuous function and ¬µJ ‚â° E [J(Ui )]. Lee (1982) studied this
dependence structure in the context of classic ‚Äúone-sided‚Äù selection problems where outcomes are only observed
when Di = 1. Setting J(¬∑) equal to the inverse normal CDF yields the canonical Heckman (1976; 1979) sample
selection (‚ÄúHeckit‚Äù) model, while choosing J(u) = u yields the linear selection model studied by Olsen (1980),
and choosing the inverse logistic CDF for J (.) yields the logit selection model considered by Mroz (1987).
Subsequent work applies versions of (3) to policy evaluation by modeling program participation as a ‚Äútwosided‚Äù sample selection problem with coefficients indexed by the treatment state d. For example, Bjorklund
and Moffitt (1987) build on the Heckit framework by assuming J(¬∑) is the inverse normal CDF and allowing
Œ±1 6= Œ±0 , Œ≥1 6= Œ≥0 . Likewise, the linear estimator of Brinch et al. (2017) is a two-sided variant of Olsen‚Äôs
(1980) approach that imposes an identity J(¬∑) function with coefficients indexed by d. Interestingly, Dubin
and McFadden‚Äôs (1984) classic multinomial selection model collapses in the binary treatment effects case to a
two-sided version of Mroz‚Äôs (1987) logit model.
Assumption (3) nullifies Vytlacil‚Äôs (2002) equivalence result by imposing restrictions on the relationships
between mean potential outcomes of subgroups that respond differently to the instrument Zi . Let ¬µdg denote
the mean of Yi (d) for group g ‚àà {at, nt, c}, representing always takers, never takers and compliers. For any
strictly increasing J(¬∑), equation (3) implies sgn(¬µdat ‚àí ¬µdc ) = sgn(¬µdc ‚àí ¬µdnt ) for d ‚àà {0, 1}. In contrast, the
nonparametric model defined by assumptions IA.1-IA.3 is compatible with any arrangement of differences in
mean potential outcomes for the three subgroups. We next consider whether these additional restrictions are
consequential for estimation of LATE.

LATE
When non-compliance is ‚Äútwo-sided‚Äù so that 0 < P (0) < P (1) < 1, equation (3) implies that mean outcomes
conditional on treatment status are
E [Yi |Zi , Di = d] = Œ±d + Œ≥d Œªd (P (Zi )),
where Œª1 (¬∑) : (0, 1) ‚Üí R and Œª0 (¬∑) : (0, 1) ‚Üí R are control functions giving the means of (J (Ui ) ‚àí ¬µJ ) when Ui
is truncated from above and below at p ‚àà (0, 1):
Œª1 (p) = E [J(Ui ) ‚àí ¬µJ |Ui ‚â§ p] , Œª0 (p) = E [J(Ui ) ‚àí ¬µJ |Ui > p].
While attention in parametric selection models often focuses on the population average treatment effect
Œ±1 ‚àí Œ±0 (Garen, 1984; Heckman, 1990; Wooldridge, 2015), equation (3) can also be used to compute
treatment effects for other subgroups. The average effect on compliers can be written
LAT E = Œ±1 ‚àí Œ±0 + (Œ≥1 ‚àí Œ≥0 ) Œì (P (0), P (1)) ,

5

(4)

where Œì(p, p0 ) gives the mean of J(Ui ) ‚àí ¬µJ when Ui lies between p and p0 > p:
Œì(p, p0 ) = E [J(Ui ) ‚àí ¬µJ |p < Ui ‚â§ p0 ] =

p0 Œª1 (p0 ) ‚àí pŒª1 (p)
.
p0 ‚àí p

The last term in (4) adjusts the average treatment effect to account for non-random selection into compliance
with the instrument.

Estimation
To motivate control function estimation, suppose that the sample exhibits two-sided non-compliance as follows:
Condition 2. 0 <

P

i

1{Di = d}Zi <

P

i

1 {Di = d} for d ‚àà {0, 1}.

This condition requires at least one observation with every combination of Zi and Di . Condition 2 is satisfied
with probability approaching one at an exponential rate in n whenever 0 < P r[Zi = 1] < 1 and 0 < P (z) < 1
for z ‚àà {0, 1}.
Control function estimation typically proceeds in two steps, both for computational reasons and because of
the conceptual clarity of plug-in estimation strategies (Heckman, 1979; Smith and Blundell, 1986). Deferring
a discussion of one-step estimation approaches to later sections, we define the control function estimator as a
procedure which first fits the choice model in equation (1) by maximum likelihood, then builds estimates of
Œª1 (¬∑) and Œª0 (¬∑) to include in second-step ordinary least squares (OLS) regressions for each treatment category.
The first step estimates can be written



PÃÇ (0), PÃÇ (1) = arg

max
P (0),P (1)

X

Di log P (Zi ) +

i

X
(1 ‚àí Di ) log (1 ‚àí P (Zi )).

(5)

i

The second step OLS estimates are
(Œ±ÃÇd , Œ≥ÃÇd ) = arg min

Œ±d ,Œ≥d

X

h
i2
1 {Di = d} Yi ‚àí Œ±d ‚àí Œ≥d Œªd (PÃÇ (Zi )) , d ‚àà {0, 1}.

(6)

i

The analogy principle then suggests the following plug-in estimator of LATE:
\E
LAT

CF

= (Œ±ÃÇ1 ‚àí Œ±ÃÇ0 ) + (Œ≥ÃÇ1 ‚àí Œ≥ÃÇ0 ) Œì(PÃÇ (0), PÃÇ (1)).

Note that when non-compliance is ‚Äúone-sided‚Äù so that

P

i

Di (1‚àíZi ) = 0 or

P

i (1‚àíDi )Zi

= 0, the maximum

likelihood estimates in (5) are not well-defined. Condition 2 ensures that PÃÇ (0) and PÃÇ (1) exist, and that Œ±ÃÇd and
Œ≥ÃÇd can be computed for each value of d. Condition 1 additionally ensures that PÃÇ (0) < PÃÇ (1), guaranteeing that
\E
LAT

CF

exists.

6

4

Equivalence results

\E
Compared to LAT

IV

\E
, LAT

CF

would seem to be highly dependent upon the functional form assumed for

J(¬∑) and the linearity of equation (3). Our first result shows that this is not the case.
\E
Theorem 1. If Conditions 1 and 2 hold then LAT

CF

\E
= LAT

IV

.

Proof: The maximum likelihood procedure in (5) yields the empirical treatment rates PÃÇ (z) =

P
i 1{Zi =z}Di
P
i 1{Zi =z}

for z ‚àà {0, 1}. The second-step OLS regressions can be rewritten

h
i
h
i 2
P
(Œ±ÃÇd , Œ≥ÃÇd ) = arg min i 1 {Di = d} Yi ‚àí Œ±d + Œ≥d Œªd (PÃÇ (0)) ‚àí Œ≥d Œªd (PÃÇ (1)) ‚àí Œªd (PÃÇ (0)) Zi .
Œ±d ,Œ≥d

This is a least squares fit of Yi on an intercept and the indicator Zi in the subsample with Di = d. Such
regressions can be estimated as long as there is two-sided non-compliance with the instrument Zi , which
follows from Condition 2. Defining YÃÑdz ‚â°

P
i 1{Di =d}1{Zi =z}Yi
P
,
i 1{Di =d}1{Zi =z}

we have

h
i
YÃÑd0 = Œ±ÃÇd + Œ≥ÃÇd Œªd (PÃÇ (0)), YÃÑd1 ‚àí YÃÑd0 = Œ≥ÃÇd Œªd (PÃÇ (1)) ‚àí Œªd (PÃÇ (0)) .
Under Condition 1, we have Œªd (PÃÇ (1)) 6= Œªd (PÃÇ (0)), and this pair of equations can be solved for Œ≥ÃÇd and Œ±ÃÇd as
Œ≥ÃÇd =

YÃÑd1 ‚àíYÃÑd0
,
Œªd (PÃÇ (1))‚àíŒªd (PÃÇ (0))

Œ±ÃÇd =

Œªd (PÃÇ (1))YÃÑd0 ‚àíŒªd (PÃÇ (0))YÃÑd1
.
Œªd (PÃÇ (1))‚àíŒªd (PÃÇ (0))

We can therefore rewrite the control function estimate of LATE as
\E
LAT
+

h

CF

=

h

Œª1 (PÃÇ (1))YÃÑ10 ‚àíŒª1 (PÃÇ (0))YÃÑ11
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))

YÃÑ11 ‚àíYÃÑ10
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))

i

‚àí

h

i

YÃÑ01 ‚àíYÃÑ00
Œª0 (PÃÇ (1))‚àíŒª0 (PÃÇ (0))

Œª0 (PÃÇ (1))YÃÑ00 ‚àíŒª0 (PÃÇ (0))YÃÑ01
Œª0 (PÃÇ (1))‚àíŒª0 (PÃÇ (0))

‚àí

h

i

√ó



i

PÃÇ (1)Œª1 (PÃÇ (1))‚àíPÃÇ (0)Œª1 (PÃÇ (0))
PÃÇ (1)‚àíPÃÇ (0)


.

Using the fact that Œª0 (p) = ‚àíŒª1 (p)p/(1 ‚àí p), this simplifies to
h
i h
i
1
1
0
0
PÃÇ
(1)
YÃÑ
+
(1
‚àí
PÃÇ
(1))
YÃÑ
PÃÇ
(0)
YÃÑ
+
(1
‚àí
PÃÇ
(0))
YÃÑ
‚àí
CF
1
0
1
0
\E
LAT
=
,
PÃÇ (1) ‚àí PÃÇ (0)
\E
which is LAT

IV

. 

\E
Remark 1. An immediate consequence of Theorem 1 is that LAT

CF

is also equivalent to the coefficient on

Di associated with a least squares fit of Yi to Di and a first stage residual Di ‚àí PÃÇ (Zi ). Blundell and Matzkin
(2014) attribute the first proof of the equivalence between this estimator and IV to Telser (1964).
Remark 2. Theorem 1 extends the analysis of Brinch et al. (2017) who observe that linear control function
estimators produce LATE estimates numerically equivalent to IV. The above result implies that a wide class
of non-linear control function estimators share this property. With a binary treatment and instrument, an
instrumental variables estimate can always be viewed as the numerical output of a variety of parametric control
function estimators.

7

Potential outcome means
Corresponding equivalence results hold for estimators of other parameters identified in the LATE framework.
Imbens and Rubin (1997) and Abadie (2002) discuss identification and estimation of the treated outcome
distribution for always takers, the untreated distribution for never takers, and both marginal distributions for
compliers. Nonparametric estimators of the four identified marginal mean potential outcomes are given by
0
IV
1
¬µÃÇIV
1at = YÃÑ1 , ¬µÃÇ0nt = YÃÑ0 ,

¬µÃÇIV
1c =

PÃÇ (1)YÃÑ11 ‚àíPÃÇ (0)YÃÑ10
,
PÃÇ (1)‚àíPÃÇ (0)

¬µÃÇIV
0c =

(1‚àíPÃÇ (0))YÃÑ00 ‚àí(1‚àíPÃÇ (1))YÃÑ01
.
PÃÇ (1)‚àíPÃÇ (0)

The corresponding control function estimators are:
CF
¬µÃÇCF
1at = Œ±ÃÇ1 + Œ≥ÃÇ1 Œª1 (PÃÇ (0)), ¬µÃÇ0nt = Œ±ÃÇ0 + Œ≥ÃÇ0 Œª0 (PÃÇ (1)),

¬µÃÇCF
dc = Œ±ÃÇd + Œ≥ÃÇd Œì(PÃÇ (0), PÃÇ (1)), d ‚àà {0, 1}.
The following proposition shows that these two estimation strategies produce algebraically identical results.
Proposition 1. If Conditions 1 and 2 hold then
IV
¬µÃÇCF
dg = ¬µÃÇdg for (d, g) ‚àà {(1, at), (0, nt), (1, c), (0, c)}.

Proof: Using the formulas from the proof of Theorem 1, the control function estimate of ¬µ1at is
¬µÃÇCF
1at =

Œª1 (PÃÇ (1))YÃÑ10 ‚àíŒª1 (PÃÇ (0))YÃÑ11
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))



+



Œª0 (PÃÇ (1))YÃÑ00 ‚àíŒª0 (PÃÇ (0))YÃÑ11
Œª0 (PÃÇ (1))‚àíŒª0 (PÃÇ (0))



+





YÃÑ11 ‚àíYÃÑ10
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))



Œª1 (PÃÇ (0)) = YÃÑ10 ,



Œª0 (PÃÇ (1)) = YÃÑ01 ,

which is ¬µÃÇIV
1at . Likewise,
¬µÃÇCF
0nt =



YÃÑ01 ‚àíYÃÑ00
Œª0 (PÃÇ (1))‚àíŒª0 (PÃÇ (0))

which is ¬µÃÇIV
0nt . The treated complier mean estimate is
¬µÃÇCF
1c =



=

Œª1 (PÃÇ (1))YÃÑ10 ‚àíŒª1 (PÃÇ (0))YÃÑ11
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))



+



YÃÑ11 ‚àíYÃÑ10
Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0))



√ó



PÃÇ (1)Œª1 (PÃÇ (1))‚àíPÃÇ (0)Œª1 (PÃÇ (0))
PÃÇ (1)‚àíPÃÇ (0)

(Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0)))PÃÇ (1)YÃÑ11 ‚àí(Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0)))PÃÇ (0)YÃÑ10
=
(Œª1 (PÃÇ (1))‚àíŒª1 (PÃÇ (0)))(PÃÇ (1)‚àíPÃÇ (0))

\
which is ¬µÃÇIV
1c . Noting that LAT E

IV

IV
\
= ¬µÃÇIV
1c ‚àí ¬µÃÇ0c and LAT E

IV
that ¬µÃÇCF
0c = ¬µÃÇ0c . 

8

CF



PÃÇ (1)YÃÑ11 ‚àíPÃÇ (0)YÃÑ10
,
PÃÇ (1)‚àíPÃÇ (0)

CF
= ¬µÃÇCF
1c ‚àí ¬µÃÇ0c , it then follows by Theorem 1

5

Equivalence and extrapolation

Proposition 1 establishes that all control function estimators based on equation (3) produce identical estimates of
the potential outcome means that are nonparametrically identified in the LATE framework. Different functional
form assumptions generate different estimates of quantities that are under-identified, however. For example,
the choice of J(¬∑) in equation (3) determines the shapes of the curves that the model uses to extrapolate
from estimates of the four identified potential outcome means (¬µ1at , ¬µ0nt , ¬µ1c , ¬µ0c ) to the two under-identified
potential outcome means (¬µ0at , ¬µ1nt ).

Figure 1: "Heckit" extrapolation

5

M
N = (") = +$ [5. (1)|-. = "]
D$ (=)

8B= + :B= C

D$ (E)

; <= (")
6"
#$(1) ‚àí #$ (0)

D$ (E)

8B= + :B= C

E

;<= (")
6"
#$ (0)

=

;<= (")
8B E + :BE C
6"
$
D$ (=) 1 ‚àí # (1)

D$ (=)

8BE + :BE C

D$ (E)

; <= (")
6"
#$ (1) ‚àí #$(0)

Implied effect for
never takers

GÃÇ =K

A
>?@+

GÃÇ =LJ

GÃÇ EIJ
Implied effect for
always takers

M
N E (") = +$ [5. (0)|-. = "]
GÃÇ EK

#$ (0)
2

#$ (1) + #$(0)
2

#$ (0)

+$ [-. |01]

#$ (1)

+$ [-. |3]

1 + #$ (1)
2

1

"

+$ [-. |41]

‚ÄúHeckit‚Äù model: +[5. (6)|-. ] = 89 + :9 ; <= (-. )

Figures 1 and 2 illustrate this extrapolation in a hypothetical example. The horizontal axis plots values u of the unobserved treatment cost Ui , while the vertical axis plots mean potential outcomes md (u) =
E [Yi (d)|Ui = u] as functions of this cost. Estimates of these functions are denoted mÃÇd (u) = Œ±ÃÇd +Œ≥ÃÇd √ó(J(u)‚àí¬µJ )
and their difference mÃÇ1 (u) ‚àí mÃÇ0 (u) provides an estimate of the marginal treatment effect (Bjorklund and Moffitt, 1987; Heckman and Vytlacil, 2005; Heckman et al., 2006) for an individual with latent cost u.
Assumptions IA.1-IA3 ensure two averages of md (Ui ) are identified for each potential outcome: the treated

9

means for always takers and compliers, and the untreated means for never takers and compliers. The control
function estimator chooses Œ±ÃÇd and Œ≥ÃÇd so that averages of mÃÇd (Ui ) over the relevant ranges match the corresponding nonparametric estimates for each compliance group. The coefficient Œ≥ÃÇ1 parameterizes the difference in mean
treated outcomes between compliers and always takers, while Œ≥ÃÇ0 measures the difference in mean untreated
outcomes between compliers and never takers. Several tests of endogeneous treatment assignment (see, e.g.,
Angrist, 2004; Battistin and Rettore, 2008; Bertanha and Imbens, 2014; and Kowalski, 2016) amount to testing
whether (Œ≥ÃÇ0 , Œ≥ÃÇ1 ) are significantly different from zero.

Figure 2: Linear extrapolation

5

L
M B (") = +$ [5. (1)|-. = "]

8AB + :AB C

#$ (1) + #$ (0) ‚àí 1
D
2

8AB + :AB C

#$ (0) ‚àí 1
D
2

Implied effect for
never takers

FÃÇ BJ

@
=>?+

FÃÇ BKI

#$ (1)
D
8AE + :AE C
2

FÃÇ EHI

Implied effect for
always takers
L
M E (") = +$ [5. (0)|-. = "]

#$ (1) + #$ (0) ‚àí 1
D
8A E + :AE C
2

FÃÇ EJ

#$ (0)
2

#$ (1) + #$(0)
2

#$ (0)

+$ [-. |01]

#$ (1)

+$ [-. |3]

1 + #$ (1)
2

1

"

+$ [-. |41]

Linear selection model: +[5. (6)|-. ] = 89 + :9 (-. ‚àí 1/2)

Figure 1 depicts the results of parametric extrapolation based on the Heckit model, while Figure 2 shows
results for the linear control function model discussed by Brinch et al. (2017). Both models match the same four
estimated mean potential outcomes, thereby generating identical estimates of LATE. Note that by Jensen‚Äôs
inequality, the nonlinear mÃÇd (u) curves in Figure 1 do not pass directly through the group mean potential
outcomes. The two models yield different imputations for the missing potential outcomes of always takers and
never takers, and therefore also different estimates of the ATE, which averages over all three subpopulations.
This sensitivity to functional form is intuitive: treatment effects for always and never takers are fundamentally

10

under-identified, an insight that has led to consideration of bounds on these quantities (Manski, 1990; Balke
and Pearl, 1997; Mogstad et al., 2016).

6

Multi-valued instruments

Consider an instrument Zi taking values in {0, 1, .., K}, and suppose that 0 < PÃÇ (z ‚àí 1) < PÃÇ (z) < 1 for
z ‚àà {1, 2, ..., K}. Let Di (z) denote i‚Äôs treatment choice when Zi = z. If assumptions IA.1-IA.3 hold for
every pair of instrument values, Wald ratios of the form

E[Yi |Zi =z]‚àíE[Yi |Zi =z‚àí1]
E[Di |Zi =z]‚àíE[Di |Zi =z‚àí1]

identify the average treat-

ment effect among compliers indexed by a unit increment in the instrument, which we denote LAT Ez ‚â°
E [Yi (1) ‚àí Yi (0)|Di (z) > Di (z ‚àí 1)]. Analog estimators of LAT Ez are given by the following pairwise IV estimator:
IV
\E z
LAT

=

IV

\E z
From Theorem 1, LAT

1
i 1{Zi = z}Yi
1{Zi =z}
P
1
P
i 1{Zi = z}Di
i 1{Zi =z}

P

P

‚àí

i

1
1{Zi =z‚àí1}
1
P
i 1{Zi =z‚àí1}
P

i

‚àí

P

1{Zi = z ‚àí 1}Yi

P

1{Zi = z ‚àí 1}Di

i
i

.

is numerically equivalent to the corresponding pairwise control function estimator

of LAT Ez constructed from observations with Zi ‚àà {z ‚àí 1, z}. However, to improve precision, it is common to
impose additional restrictions on the LAT Ez .
Consider the following restriction on potential outcomes:

E [Yi (d)|Ui ] = Œ±d +

L
X

`

Œ≥d` √ó (J(Ui ) ‚àí ¬µJ ) , d ‚àà {0, 1}.

(7)

`=1

Polynomial models of this sort have been considered by, among others, Brinch et al. (2017) and Cornelissen




et al. (forthcoming). Letting Œª1` (p) = E (J(Ui ) ‚àí ¬µJ )` |Ui ‚â§ p and Œª0` (p) = E (J(Ui ) ‚àí ¬µJ )` |Ui > p , a
two-step control function estimator of the parameters of equation (7) is
h
i2
P
PL
(Œ±ÃÇd , Œ≥ÃÇd1 , ..., Œ≥ÃÇdL ) = arg
min
1
{D
=
d}
Y
‚àí
Œ±
‚àí
Œ≥
Œª
(
PÃÇ
(Z
))
.
i
i
d
d`
d`
i
i
`=1
Œ±d ,Œ≥d1 ,...,Œ≥dL

The resulting control function estimator of LAT Ez is then
CF

\E z
LAT

L
X
= (Œ±ÃÇ1 ‚àí Œ±ÃÇ0 ) +
(Œ≥ÃÇ1` ‚àí Œ≥ÃÇ0` )Œì` (PÃÇ (z ‚àí 1), PÃÇ (z)),

(8)

`=1

where Œì` (p, p0 ) = [p0 Œª1` (p0 ) ‚àí pŒª1` (p)]/[p0 ‚àí p]. The following proposition establishes that this estimator is
IV

\E z
identical to LAT

when L = K.

Proposition 2. If Conditions 1 and 2 hold for every pair of instrument values and the polynomial order L
CF

\E z
equals K then LAT

IV

\E z
= LAT

‚àÄz ‚àà {1, 2, ..., K}.

Proof: See the Appendix. 
Remark 3. Instrumenting Di with a scalar function g(Zi ) generates an IV estimate equal to a convex weighted
IV

\E z
average of the LAT

(Imbens and Angrist, 1994). From Proposition 2, applying these weights to the

11

CF

\E z
LAT

CF

\E z
when L = K will yield an identical result. By contrast, the set of LAT

imposing L < K need not correspond to weighted averages of the

IV
\E z
LAT

that result from

, but are likely to exhibit reduced

sampling variability.
Remark 4. When L < K ‚àí 1, the restriction in (7) can be used to motivate estimators of particular LATEs
that are convex combinations of IV estimators. In the case where K = 3 and L = 1, one can show that:
LAT E2 =



Œì(P (1),P (2))‚àíŒì(P (0),P (1))
Œì(P (2),P (3))‚àíŒì(P (0),P (1))



LAT E3 +



Œì(P (2),P (3))‚àíŒì(P (1),P (2))
Œì(P (2),P (3))‚àíŒì(P (0),P (1))



LAT E1 .

This representation suggests combination estimators of the form
IV

\E 2 + (1 ‚àí Œæ)
\E Œæ2 = Œæ LAT
LAT



Œì(PÃÇ (1),PÃÇ (2))‚àíŒì(PÃÇ (0),PÃÇ (1))
Œì(PÃÇ (2),PÃÇ (3))‚àíŒì(PÃÇ (0),PÃÇ (1))



IV

\E 3 +
LAT



Œì(PÃÇ (2),PÃÇ (3))‚àíŒì(PÃÇ (1),PÃÇ (2))
Œì(PÃÇ (2),PÃÇ (3))‚àíŒì(PÃÇ (0),PÃÇ (1))



IV

\E 1
LAT


,

for Œæ ‚àà (0, 1). To maximize precision, one can set Œæ = [vÃÇ2 ‚àí vÃÇ12 ]/[vÃÇ1 + vÃÇ2 ‚àí 2vÃÇ12 ] , where vÃÇ1 and vÃÇ2 are estimated
IV

\E 2
variances of LAT
\E Œæ2
LAT

and the term in brackets, respectively, and vÃÇ12 is their covariance. By construction,
IV

Œæ

\E 2 will tend to be less
\E 2 . Though LAT
provides an estimate of LAT E2 more precise than LAT
CF

\E 2
precise than LAT

Œæ

\E 2 retains an interpretation
when restriction (7) is true, the probability limit of LAT

as a weighted average of causal effects for complier subpopulations when (7) is violated, a robustness property
emphasized elsewhere by Angrist and Pischke (2009).

7

Equivalence failures

Though Theorem 1 establishes equivalence between IV and a wide class of control function estimates of LATE,
other control function estimators fail to match IV even with a single binary instrument. LaLonde (1986)
considered OLS estimation of the following model:

 ‚àí1
i
h

‚àí1
œÜ(Œ¶ (PÃÇ (Zi )))
(PÃÇ (Zi )))
+
(1
‚àí
D
)
√ó
+ i .
Yi = Œ± + Œ≤Di + Œ≥ Di √ó ‚àí œÜ(Œ¶ PÃÇ (Z
i
)
1‚àíPÃÇ (Z )
i

(9)

i

By imposing a common coefficient Œ≥ on the Mills ratio terms for the treatment and control groups, this
specification allows for selection on levels but rules out selection on treatment effects.
The term in brackets in equation (9) simplifies to (Di ‚àí PÃÇ (Zi )) √ó {‚àíœÜ(Œ¶‚àí1 (PÃÇ (Zi )))/[PÃÇ (Zi )(1 ‚àí PÃÇ (Zi ))]}.
When PÃÇ (1) = 1 ‚àí PÃÇ (0) this term is proportional to the first stage residual and least squares estimation of (9)
yields an estimate of Œ≤ numerically identical to IV. This is a finite sample analogue of Heckman and Vytlacil‚Äôs
(2000) observation (elaborated upon in Angrist, 2004) that LATE equals ATE when both the first stage and
the error distribution are symmetric. When PÃÇ (1) 6= 1 ‚àí PÃÇ (0), however, the control function in equation (9)
differs from the first stage residual and the estimate of Œ≤ will not match IV.
Remark 5. When PÃÇ (1) = 1 ‚àí PÃÇ (0), the ATE estimate Œ±ÃÇ1 ‚àí Œ±ÃÇ0 from a control function estimator of the form
given in (6) coincides with IV whenever J(Ui ) is presumed to follow a symmetric distribution.

12

Moments and monotonicity
Theorem 1 relied upon the fact that equation (3) includes enough free parameters to allow the control function
estimator to match the sample mean of Yi for every combination of Di and Zi . One might be tempted to
conclude that any structural estimator that fits these moments will produce a corresponding LATE estimate
equal to IV. We now show that this is not the case.
Suppose that treatment status is generated by a heterogeneous threshold crossing model:
Di = 1 {Œ∫ + Œ¥i Zi ‚â• Ui } ,

(10)

where Ui is uniformly distributed and the random coefficient Œ¥i is a mixture taking values in {‚àíŒ∑, Œ∑} for some
known positive constant Œ∑. Define œÖ ‚â° P r [Œ¥i = Œ∑], and suppose that Œ¥i is independent of (Yi (1), Yi (0), Ui , Zi ).
Note that this model does not admit a representation of the form of equation (1) as it allows Di (1) < Di (0).
Model (10) has two unknown parameters, Œ∫ and œÖ, and can therefore rationalize the two observed choice
probabilities by choosing Œ∫ÃÇ = PÃÇ (0) and œÖÃÇ = (Œ∑ + PÃÇ (1) ‚àí PÃÇ (0))/2Œ∑. Equations (3) and (10) imply
E [Yi |Di = d, Zi ] = Œ±d + Œ≥d √ó [œÖŒªd (Œ∫ + Œ∑Zi ) + (1 ‚àí œÖ)Œªd (Œ∫ ‚àí Œ∑Zi )].
As before, we can use Œ∫ÃÇ and œÖÃÇ to construct control functions to include in a second-step regression, producing
estimates Œ±ÃÇd and Œ≥ÃÇd that exactly fit YÃÑd1 and YÃÑd0 .
Though this estimator matches all choice probabilities and conditional mean outcomes, it produces an
estimate of LATE different from IV. The model‚Äôs implied LATE is
E [Yi (1) ‚àí Yi (0)|Di (1) > Di (0)] = (Œ±1 ‚àí Œ±0 ) + (Œ≥1 ‚àí Œ≥0 ) √ó E [J(Ui ) ‚àí ¬µJ |Œ¥i = Œ∑, Œ∫ < Ui ‚â§ Œ∫ + Œ∑].
The corresponding control function estimator of this quantity is
‚àó

\E = (Œ±ÃÇ1 ‚àí Œ±ÃÇ0 ) + (Œ≥ÃÇ1 ‚àí Œ≥ÃÇ0 ) √ó
LAT
‚àó



(Œ∫ÃÇ+Œ∑)Œª1 (Œ∫ÃÇ+Œ∑)‚àíŒ∫ÃÇŒª1 (Œ∫ÃÇ)
Œ∑

\E is not equal to LAT
\E
It is straightforward to verify that LAT

IV



.

(11)

. Equivalence fails here because the selection

model implies the presence of ‚Äúdefiers‚Äù with Di (1) < Di (0). IV does not identify LATE when there are defiers;
hence, the model suggests using a different function of the data to estimate the LATE.

Covariates
It is common to condition on a vector of covariates Xi either to account for possible violations of the exclusion
restriction or to increase precision. Theorem 1 implies that IV and control function estimates of LATE coincide
if computed separately for each value of the covariates, but this may be impractical or impossible when Xi can
take on many values.
A standard approach to introducing covariates is to enter them additively into the potential outcomes model
(see, e.g., Cornelissen et al., 2016; Kline and Walters, 2016; and Brinch et al., 2017). Suppose treatment choice

13

is given by Di = 1{P (Xi , Zi ) ‚â• Ui } with Ui independent of (Xi , Zi ), and assume
E [Yi (d)|Ui , Xi ] = Œ±d + Œ≥d √ó (J(Ui ) ‚àí ¬µJ ) + Xi0 œÑ, d ‚àà {0, 1}.

(12)

Letting PÃÇ (Xi , Zi ) denote an estimate of P r[Di = 1|Xi , Zi ], the control function estimates for this model are
(Œ±ÃÇ1 , Œ≥ÃÇ1 , Œ±ÃÇ0 , Œ≥ÃÇ0 , œÑÃÇ ) = arg

min

Œ±1 ,Œ≥1 ,Œ±0 ,Œ≥0 ,œÑ

X X
i

h
i2
1 {Di = d} Yi ‚àí Œ±d ‚àí Œ≥d Œªd (PÃÇ (Xi , Zi )) ‚àí Xi0 œÑ .

(13)

d‚àà{0,1}

To ease exposition, we will study the special case of a single binary covariate Xi ‚àà {0, 1}. Define LAT E(x) ‚â°
E[Yi (1) ‚àí Yi (0)|P (x, 0) < Ui ‚â§ P (x, 1), Xi = x] as the average treatment effect for compliers with Xi = x,
and let Œ±ÃÇd (x) and Œ≥ÃÇd (x) denote estimates from unrestricted control function estimation among the observations
with Xi = x. The additive separability restriction in (12) suggests the following two estimators of LAT E(1):
CF

\E x (1) = (Œ±ÃÇ1 (x) ‚àí Œ±ÃÇ0 (x)) + (Œ≥ÃÇ1 (x) ‚àí Œ≥ÃÇ0 (x)) Œì(PÃÇ (1, 0), PÃÇ (1, 1)), x ‚àà {0, 1}.
LAT
CF

CF

\E 1 (1) is a Wald estimate for the Xi = 1 sample. LAT
\E 0 (1) gives an estimated effect
By Theorem 1 LAT
for compliers with Xi = 1 based upon control function estimates for observations with Xi = 0. The following
proposition describes the relationship between these two estimators and the restricted estimator of LAT E (1)
based upon (13).
CF

\E r (1) =
Proposition 3. Suppose Conditions 1 and 2 hold for each value of Xi ‚àà {0, 1} and let LAT
(Œ±ÃÇ1 ‚àí Œ±ÃÇ0 ) + (Œ≥ÃÇ1 ‚àí Œ≥ÃÇ0 )Œì(PÃÇ (1, 0), PÃÇ (1, 1)) denote an estimate of LAT E(1) based on (13). Then
CF

CF

CF

\E r (1) = wLAT
\E 1 (1) + (1 ‚àí w)LAT
\E 0 (1) + b1 (Œ≥ÃÇ1 (1) ‚àí Œ≥ÃÇ1 (0)) + b0 (Œ≥ÃÇ0 (1) ‚àí Œ≥ÃÇ0 (0)).
LAT
The coefficients w, b1 , and b0 depend only on the joint empirical distribution of Di , Xi , and PÃÇ (Xi , Zi ).
Proof: See the Appendix. 
Remark 6. Proposition 3 demonstrates that control function estimation under additive separability gives a
linear combination of covariate-specific estimates plus terms that equal zero when the separability restrictions
hold exactly in the sample. One can show that the coefficient w need not lie between 0 and 1. By contrast,
two-stage least squares estimation of a linear model with an additive binary covariate using all interactions of
Xi and Zi as instruments generates a weighted average of covariate-specific IV estimates (Angrist and Pischke,
2009).
Remark 7. Consider the following extension of equation (12):
E [Yi (d)|Ui , Xi ] = Œ±d + Œ≥d √ó (J(Ui ) ‚àí ¬µJ ) + Xi0 œÑdc + 1{Ui ‚â§ P (Xi , 0)}Xi0 œÑat + 1{Ui > P (Xi , 1)}Xi0 œÑnt , d ‚àà {0, 1}.
This equation allows different coefficients on Xi for always takers, never takers, and compliers by interacting Xi
with indicators for thresholds of Ui , and also allows the complier coefficients to differ for treated and untreated
outcomes. When Xi includes a mutually exclusive and exhaustive set of indicator variables and PÃÇ (Xi , Zi ) equals

14

the sample mean of Di for each (Xi , Zi ), control function estimation of this model produces the same estimate of
E[Yi |Xi , Di , Di (1) > Di (0)] as the semi-parametric procedure of Abadie (2003). Otherwise the estimates may
differ even asymptotically as the control function estimator employs a different set of approximation weights
when the model is misspecified.
Remark 8. A convenient means of adjusting for covariates that maintains the numerical equivalence of IV
and control function estimates is to weight each observation by œâi = Zi /eÃÇ(Xi ) + (1 ‚àí Zi )/(1 ‚àí eÃÇ(Xi )) where
eÃÇ(x) ‚àà (0, 1) is a first step estimate of P r [Zi = 1|Xi = x]. It is straightforward to show that the œâi ‚àíweighted
IV and control function estimates of the unconditional LATE will be identical, regardless of the propensity score
estimator eÃÇ(Xi ) employed. See Hull (2016) for a recent application of this approach to covariate adjustment of
a selection model.

8

Maximum likelihood

A fully parametric alternative to two-step control function estimation is to specify a joint distribution for
the model‚Äôs unobservables and estimate the parameters in one step via full information maximum likelihood
(FIML). Consider a model that combines (1) and (2) with the distributional assumption
Yi (d)|Ui ‚àº FY |U (y|Ui ; Œ∏d ) ,

(14)

where FY |U (y|u; Œ∏) is a conditional CDF indexed by a finite dimensional parameter vector Œ∏. For example, a fully

parametric version of the Heckit model is Yi (d)|Ui ‚àº N Œ±d + Œ≥d Œ¶‚àí1 (Ui ), œÉd2 . Since the marginal distribution
of Ui is also known, this model provides a complete description of the joint distribution of (Yi (d), Ui ). FIML
exploits this distributional knowledge, estimating the model‚Äôs parameters as




PÃÇ (0)M L , PÃÇ (1)M L , Œ∏ÃÇ0M L , Œ∏ÃÇ1M L = arg

max

Z
X
Di log

(P (0),P (1),Œ∏0 ,Œ∏1 )

!

P (Zi )

fY |U (Yi |u; Œ∏1 ) du

0

i

Z
X
+
(1 ‚àí Di ) log

!

1

(15)

fY |U (Yi |u; Œ∏0 )du ,

P (Zi )

i

where fY |U (¬∑|u; Œ∏d ) ‚â° dFY |U (.|u; Œ∏d ) denotes the density (or probability mass function) of Yi (d) given Ui = u.
The corresponding FIML estimates of treated and untreated complier means are
R PÃÇ (1)M L R ‚àû
L
¬µÃÇM
dc

=

PÃÇ (0)M L

\E
and the FIML estimate of LATE is LAT

‚àí‚àû

yfY |U (y|u; Œ∏ÃÇdM L )dydu

PÃÇ (1)M L ‚àí PÃÇ (0)M L
ML

L
ML
= ¬µÃÇM
1c ‚àí ¬µÃÇ0c .

15

,

Binary outcomes
We illustrate the relationship between FIML and IV estimates of LATE with the special case of a binary Yi .
A parametric model for this setting is given by
Yi (d) =1 {Œ±d ‚â• id } ,

(16)

id |Ui ‚àº F|U (|Ui ; œÅd ) ,
where F|U (|u; œÅ) is a conditional CDF characterized by the single parameter œÅ. Equations (1) and (16)
include six parameters, which matches the number of observed linearly independent probabilities (two values
of P r [Di = 1|Zi ], and four values of P r [Yi = 1|Di , Zi ]). The model is therefore ‚Äúsaturated‚Äù in the sense that a
model with more parameters would be under-identified.
The following result establishes the conditions under which maximum likelihood estimates of complier means
(and therefore LATE) coincide with IV.
Proposition 4. Consider the model defined by (1), (2) and (16). Suppose that Conditions 1 and 2 hold, and
L
IV
that the maximum likelihood problem (15) has a unique solution. Then ¬µÃÇM
dc = ¬µÃÇdc for d ‚àà {0, 1} if and only

if ¬µÃÇIV
dc ‚àà [0, 1] for d ‚àà {0, 1}.
Proof: See the Appendix. 
Remark 9. The intuition for Proposition 4 is that the maximum likelihood estimation problem can be rewritten
in terms of the six identified parameters of the LATE model: (¬µ1at , ¬µ0nt , ¬µ1c , ¬µ0c , œÄat , œÄc ), where œÄg is the
population share of group g. Unlike the IV and control function estimators, the FIML estimator accounts for
the binary nature of Yi (d) by constraining all probabilities to lie in the unit interval. When these constraints
do not bind the FIML estimates coincide with nonparametric IV estimates, but the estimates differ when the
nonparametric approach produces complier mean potential outcomes outside the logically possible bounds.
Logical violations of this sort have been proposed elsewhere as a sign of failure of instrument validity (Balke
and Pearl, 1997; Imbens and Rubin, 1997; Huber and Mellace, 2015; Kitagawa, 2015).
Remark 10. A simple ‚Äúlimited information‚Äù approach to maximum likelihood estimation is to estimate P (0)
and P (1) in a first step and then maximize the plug-in conditional log-likelihood function
R
 X
R

X
1
PÃÇ (Z )
Di log 0 i fY |U (Yi |u; Œ∏1 ) du +
(1 ‚àí Di ) log PÃÇ (Zi ) fY |U (Yi |u; Œ∏0 )du
i

i

with respect to (Œ∏0 , Œ∏1 ) in a second stage. One can show that applying this less efficient estimator to a saturated
model will produce an estimate of LATE equivalent to IV under Conditions 1 and 2. This broader domain of
equivalence results from some cross-equation parameter restrictions being ignored by the two-step procedure.
For example, the FIML estimator may choose an estimate of œÄc other than PÃÇ (1) ‚àí PÃÇ (0) in order to enforce the
constraint that (¬µ1c , ¬µ0c ) ‚àà [0, 1]2 .

16

Overidentified models
Equivalence of FIML and IV estimates at interior solutions in our binary example follows from the fact that
the model satisfies monotonicity and includes enough parameters to match all observed choice probabilities.
Similar arguments apply to FIML estimators of sufficiently flexible models for multi-valued outcomes. When
the model includes fewer parameters than observed choice probabilities, overidentification ensues. For example,
the standard bivariate probit model is a special case of (16) that uses a normal distribution for F|U (¬∑) and
imposes i1 = i0 and therefore œÅ1 = œÅ0 (see Greene, 2007). Hence, only five parameters are available to
rationalize six linearly independent probabilities.
Maximum likelihood estimation of this more parsimonious model may yield an estimate of LATE that differs
from IV even at interior solutions. This divergence stems from the model‚Äôs overidentifying restrictions which,
if correct, may yield efficiency gains but if wrong can compromise consistency. Though maximum likelihood
estimation of misspecified models yields a global best approximation to the choice probabilities (White, 1982),
there is no guarantee that it will deliver a particularly good approximation to the LATE.

9

Model evaluation

In practice researchers often estimate selection models that impose additive separability assumptions on exogenous covariates, combine multiple instruments, and employ additional smoothness restrictions that break the
algebraic equivalence of structural LATE estimates with IV. The equivalence results developed above provide
a useful conceptual benchmark for assessing the performance of structural models in such applications. An
estimator derived from a properly specified model of treatment assignment and potential outcomes should come
close to matching a nonparametric IV estimate of the same parameter. Significant divergence between these
estimates would signal that the restrictions imposed by the structural model are violated.
Figure 3 shows an example of this approach to model assessment from Kline and Walters‚Äô (2016) reanalysis
of the Head Start Impact Study (HSIS) ‚Äì a randomized experiment with two-sided non-compliance (Puma
et al., 2012). On the vertical axis are non-parametric IV estimates of the LATE associated with participating
in the Head Start program relative to a next best alternative for various subgroups in the HSIS defined by
experimental sites and baseline child and parent characteristics. On the horizontal axis are two-step control
function estimates of the same parameters derived from a heavily over-identified selection model involving
multiple endogenous variables, baseline covariates, and excluded instruments. Had this model been saturated,
all of the points would lie on the 45 degree line. In fact, a Wald test indicates these deviations from the 45 degree
line cannot be distinguished from noise at conventional significance levels, suggesting that the approximating
model is not too far from the truth.

17

.6

.8

Figure 3: Model-based and IV estimates of LATE

0

.2

IV estimate
.4

œá2(20) = 23.6
p = 0.26

-.2

0

.2
.4
Model-predicted LATE

.6

.8

Notes: This figure reproduces Figure A.III from Kline and Walters (2016). The figure is constructed by
splitting the Head Start Impact Study sample into vingtiles of the predicted LATE based on the control
function estimates reported in Section VIII of the paper. The horizontal axis displays the average
predicted LATE in each group, and the vertical axis shows corresponding IV estimates. The dashed line
is the 45-degree line. The chi-squared statistic and p -value come from a bootstrap Wald test of the
hypothesis that the 45 degree line fits all points up to sampling error. See Appendix F of Kline and
Walters (2016) for more details.

Passing a specification test does not obviate the fundamental identification issues inherent in interpolation
and extrapolation exercises. As philosophers of science have long argued, however, models that survive empirical
scrutiny deserve greater consideration then those that do not (Popper, 1959; Lakatos, 1976). Demonstrating
that a tightly restricted model yields a good fit to IV estimates not only bolsters the credibility of the model‚Äôs
counterfactual predictions, but serves to clarify what the estimated structural parameters have to say about the
effects of a research design as implemented. Here the control function estimates reveal that Head Start had very
different effects on different sorts of complying households, a finding rationalized by estimated heterogeneity in
both patterns of selection into treatment and potential outcome distributions.

10

Conclusion

This paper shows that two-step control function estimators of LATE derived from a wide class of parametric
selection models coincide with the instrumental variables estimator. Control function and IV estimates of mean
potential outcomes for compliers, always takers, and never takers are also equivalent. While many parametric

18

estimators produce the same estimate of LATE, different parameterizations can produce dramatically different
estimates of population average treatment effects and other under-identified quantities. The sensitivity of
average treatment effect estimates to the choice of functional form may be the source of the folk wisdom that
structural estimators are less robust than instrumental variables estimators. Our results show that this view
confuses robustness for a given target parameter with the choice of target parameter.
Structural estimators that impose overidentifying restrictions may generate LATE estimates different from
IV. Reporting the LATEs implied by such estimators facilitates comparisons with unrestricted IV estimates and
is analogous to the standard practice of reporting average marginal effects in binary choice models (Wooldridge,
2001). Such comparisons provide a convenient tool for assessing the behavioral restrictions imposed by structural models. Model-based estimators that cannot rationalize unrestricted IV estimates of LATE are unlikely
to fare much better at extrapolating to fundamentally under-identified quantities. On the other hand, a tightly
constrained structural estimator that fits a collection of disparate IV estimates enjoys some degree of validation
that bolsters the credibility of its counterfactual predictions.

References
Abadie, A. (2002): ‚ÄúBootstrap tests for distributional treatment effects in instrumental variable models,‚Äù
Journal of the American Statistical Association, 97, 284‚Äì292.
‚Äî‚Äî‚Äî (2003): ‚ÄúSemiparametric instrumental variable estimation of treatment response models,‚Äù Journal of
Econometrics, 113, 231‚Äì263.
Angrist, J. D. (2004): ‚ÄúTreatment effect heterogeneity in theory and practice,‚Äù The Economic Journal, 114,
C52‚ÄìC83.
Angrist, J. D., G. W. Imbens, and D. B. Rubin (1996): ‚ÄúIdentification of causal effects using instrumental
variables,‚Äù Journal of the American Statistical Association, 91, 444‚Äì455.
Angrist, J. D. and J.-S. Pischke (2009): Mostly Harmless Econometrics: An Empiricist‚Äôs Companion,
Princeton University Press.
‚Äî‚Äî‚Äî (2010): ‚ÄúThe credibility revolution in empirical economics: how better research design is taking the con
out of econometrics,‚Äù Journal of Economic Perspectives, 24, 3‚Äì30.
Balke, A. and J. Pearl (1997): ‚ÄúBounds on treatment effects from studies with imperfect compliance,‚Äù
Journal of the American Statistical Association, 92, 1171‚Äì1176.
Battistin, E. and E. Rettore (2008): ‚ÄúIneligibles and eligible non-participants as a double comparison
group in regression-discontinuity designs,‚Äù Journal of Econometrics, 142, 715‚Äì730.
Bertanha, M. and G. W. Imbens (2014): ‚ÄúExternal validity in fuzzy regression discontinuity designs,‚Äù NBER
working paper no. 20773.

19

Bjorklund, A. and R. Moffitt (1987): ‚ÄúThe estimation of wage gains and welfare gains in self-selection
models,‚Äù Review of Economics and Statistics, 69, 42‚Äì49.
Blundell, R. and R. L. Matzkin (2014): ‚ÄúControl functions in nonseparable simultaneous equations models,‚Äù Quantitative Economics, 5, 271‚Äì295.
Brinch, C. N., M. Mogstad, and M. Wiswall (2017): ‚ÄúBeyond LATE with a discrete instrument,‚Äù Journal
of Political Economy, 125, 985‚Äì1039.
Cornelissen, T., C. Dustmann, A. Raute, and U. Sch√∂nberg (2016): ‚ÄúFrom LATE to MTE: alternative
methods for the evaluation of policy interventions,‚Äù Labour Economics, 41, 47‚Äì60.
‚Äî‚Äî‚Äî (forthcoming): ‚ÄúWho benefits from universal childcare? Estimating marginal returns to early childcare
attendance,‚Äù Journal of Political Economy.
Deaton, A. S. (2009): ‚ÄúInstruments of development: randomization in the tropics, and the search for the
elusive keys to economic development,‚Äù NBER working paper no. 14690.
Dubin, J. A. and D. L. McFadden (1984): ‚Äú"An econometric analysis of residential electric appliance
holdings and consumption,‚Äù Econometrica, 52, 345‚Äì362.
Garen, J. (1984): ‚ÄúThe returns to schooling: a selectivity bias approach with a continuous choice variable,‚Äù
Econometrica, 52, 1199‚Äì1218.
Greene, W. H. (2007): Econometric Analysis, Upper Saddle River, New Jersey: Prentice Hall, 7th ed.
Heckman, J. J. (1974): ‚ÄúShadow prices, market wages, and labor supply,‚Äù Econometrica, 42, 679‚Äì694.
‚Äî‚Äî‚Äî (1976): ‚ÄúThe common structure of statistical models of truncation, sample selection and limited dependent variables and a simple estimator for such models,‚Äù Annals of Economic and Social Measurement, 5,
475‚Äì492.
‚Äî‚Äî‚Äî (1979): ‚ÄúSample selection bias as a specification error,‚Äù Econometrica, 47, 153‚Äì161.
‚Äî‚Äî‚Äî (1990): ‚ÄúVarieties of selection bias,‚Äù American Economic Review: Papers & Proceedings, 80, 313‚Äì318.
‚Äî‚Äî‚Äî (1997): ‚ÄúInstrumental variables: a study of implicit behavioral assumptions used in making program
evaluations,‚Äù Journal of Human Resources, 32, 441‚Äì462.
Heckman, J. J. and R. Robb (1985): ‚ÄúAlternative methods for evaluating the impact of interventions: an
overview,‚Äù Journal of Applied Econometrics, 30, 239‚Äì267.
Heckman, J. J. and S. Urzua (2010): ‚ÄúComparing IV with structural models: what simple IV can and
cannot identify,‚Äù Journal of Econometrics, 156, 27‚Äì37.

20

Heckman, J. J., S. Urzua, and E. Vytlacil (2006): ‚ÄúUnderstanding instrumental variables estimates in
models with essential heterogeneity,‚Äù Review of Economics and Statistics, 88, 389‚Äì432.
Heckman, J. J. and E. Vytlacil (2000): ‚ÄúLocal instrumental variables,‚Äù NBER technical working paper
no. 252.
‚Äî‚Äî‚Äî (2005): ‚ÄúStructural equations, treatment effects, and econometric policy evaluation,‚Äù Econometrica, 73,
669‚Äì738.
Huber, M. and G. Mellace (2015): ‚ÄúTesting instrument validity for LATE identification based on inequality
moment constraints,‚Äù Review of Economics and Statistics, 97, 398‚Äì411.
Hull, P. D. (2016): ‚ÄúEstimating hospital quality with quasi-experimental data,‚Äù Working paper.
Imbens, G. W. and J. D. Angrist (1994): ‚ÄúIdentification and estimation of local average treatment effects,‚Äù
Econometrica, 62, 467‚Äì475.
Imbens, G. W. and D. B. Rubin (1997): ‚ÄúEstimating outcome distributions for compliers in instrumental
variables models,‚Äù Review of Economic Studies, 64, 555‚Äì574.
Kitagawa, T. (2015): ‚ÄúA test for instrument validity,‚Äù Econometrica, 83, 2043‚Äì2063.
Kline, P. and C. R. Walters (2016): ‚ÄúEvaluating public programs with close substitutes: the case of Head
Start,‚Äù Quarterly Journal of Economics, 131, 1795‚Äì1848.
Kowalski, A. (2016): ‚ÄúDoing more when you‚Äôre running LATE: applying marginal treatment effect methods
to examine treatment effect heterogeneity in experiments,‚Äù NBER working paper no. 22363.
Lakatos, I. (1976): ‚ÄúFalsification and the methodology of scientific research programs,‚Äù in Can Theories Be
Refuted?, ed. by S. G. Harding, Dordecht, Holland: D. Reidel Publishing Company.
LaLonde, R. J. (1986): ‚ÄúEvaluating the econometric evaluations of training programs with experimental
data,‚Äù American Economic Review, 76, 604‚Äì620.
Lee, L.-F. (1982): ‚ÄúSome approaches to the correction of selectivity bias,‚Äù Review of Economic Studies, 49,
355‚Äì372.
Manski, C. F. (1990): ‚ÄúNonparametric bounds on treatment effects,‚Äù American Economic Review: Papers &
Proceedings, 80, 319‚Äì323.
Mogstad, M., A. Santos, and A. Torgovitsky (2016): ‚ÄúUsing instrumental variables for inference about
policy relevant treatment parameters,‚Äù Working paper.
Mroz, T. A. (1987): ‚ÄúThe sensitivity of an empirical model of married women‚Äôs hours of work to economic
and statistical assumptions,‚Äù Econometrica, 55, 765‚Äì799.

21

Olsen, R. J. (1980): ‚ÄúA least squares correction for selectivity bias,‚Äù Econometrica, 48, 1815‚Äì1820.
Popper, K. (1959): The Logic of Scientific Discovery, London, UK: Hutchinson and Co.
Puma, M., S. Bell, R. Cook, and C. Heid (2012): ‚ÄúHead Start Impact Study: Final Report,‚Äù US Department of Health and Human Services, Administration for Children and Families.
Roy, A. (1951): ‚ÄúSome thoughts on the distribution of earnings,‚Äù Oxford Economic Papers, 3, 135‚Äì146.
Smith, R. J. and R. W. Blundell (1986): ‚ÄúAn exogeneity test for a simultaneous equations Tobit model
with an application to labor supply,‚Äù Econometrica, 54, 679‚Äì685.
Telser, L. G. (1964): ‚ÄúAdvertising and competition,‚Äù Journal of Political Economy, 72, 537‚Äì562.
Vytlacil, E. (2002): ‚ÄúIndependence, monotonicity, and latent index models: an equivalence result,‚Äù Econometrica, 70, 331‚Äì341.
Wald, A. (1940): ‚ÄúThe fitting of straight lines if both variables are subject to error,‚Äù The Annals of Mathematical Statistics, 11, 284‚Äì300.
White, H. (1982): ‚ÄúMaximum likelihood estimation of misspecified models,‚Äù Econometrica, 50, 1‚Äì25.
Wooldridge, J. M. (2001): Econometric Analysis of Cross-Section and Panel Data, MIT Press.
‚Äî‚Äî‚Äî (2015): ‚ÄúControl function methods in applied econometrics,‚Äù Journal of Human Resources, 50, 420‚Äì445.

22

Appendix
Proof of Proposition 2
We begin by rewriting the IV and control function estimates of LAT Ez in matrix form. The IV estimator is
given by
h
IV
\E z
LAT

=

i h
i
PÃÇ (z)YÃÑ1z + (1 ‚àí PÃÇ (z))YÃÑ0z ‚àí PÃÇ (z ‚àí 1)YÃÑ1z‚àí1 + (1 ‚àí PÃÇ (z ‚àí 1))YÃÑ0z‚àí1
PÃÇ (z) ‚àí PÃÇ (z ‚àí 1)
= Œ®z1 (PÃÇ )0 YÃÑ1 ‚àí Œ®z0 (PÃÇ )0 YÃÑ0 ,

where YÃÑd ‚â° (YÃÑd0 , YÃÑd1 , ...., YÃÑdK )0 is the (K + 1) √ó 1 vector of sample average outcomes for each value of z
conditional on Di = d and PÃÇ is the vector of propensity score estimates. The (K + 1) √ó 1 vector Œ®z1 (PÃÇ ) has
‚àíPÃÇ (z ‚àí 1)/[PÃÇ (z) ‚àí PÃÇ (z ‚àí 1)] at entry z ‚àí 1, PÃÇ (z)/[PÃÇ (z) ‚àí PÃÇ (z ‚àí 1)] at entry z, and zeros elsewhere, and the
(K + 1) √ó 1 vector Œ®z0 (PÃÇ ) has (1 ‚àí PÃÇ (z ‚àí 1))/[PÃÇ (z) ‚àí PÃÇ (z ‚àí 1)] at entry z ‚àí 1, ‚àí(1 ‚àí PÃÇ (z))/[PÃÇ (z) ‚àí PÃÇ (z ‚àí 1)]
at entry z, and zeros elsewhere:
0

PÃÇ (z)
‚àíPÃÇ (z‚àí1)
,
,
0,
...,
0
,
Œ®z1 (PÃÇ ) = 0, ..0, PÃÇ (z)‚àí
PÃÇ (z‚àí1) PÃÇ (z)‚àíPÃÇ (z‚àí1)

0
PÃÇ (z‚àí1))
Œ®z0 (PÃÇ ) = 0, ..0, PÃÇ(1‚àí
, ‚àí(1‚àíPÃÇ (z)) , 0, ..., 0 .
(z)‚àíPÃÇ (z‚àí1) PÃÇ (z)‚àíPÃÇ (z‚àí1)
The second-step control function estimates with L = K can be rewritten
(Œ±ÃÇd , Œ≥ÃÇd1 , ..., Œ≥ÃÇdK ) = arg

P

min

Œ±d ,Œ≥d1 ,...,Œ≥dK

h
i2
PK
1{D
=
d}
Y
‚àí
Œ±
‚àí
1{Z
=
z}Œ≥
Œª
(
PÃÇ
(z))
.
i
i
d
i
d` d`
i
`=1

This is a saturated OLS regression of Yi on Zi for each treatment category. The coefficient estimates satisfy
Œ±ÃÇd +

XK
`=1

Œ≥ÃÇd` Œªd` (PÃÇ (z)) = YÃÑdz , d ‚àà {0, 1}, z ‚àà {0, 1, ...K}.

ÀÜ d = (Œ±ÃÇd , Œ≥ÃÇd1 , ..., Œ≥ÃÇdK )0 denote the control function estimates for treatment value d, we can write this
Letting ‚àÜ
system in matrix form as
ÀÜ d = YÃÑd ,
Œõd (PÃÇ )‚àÜ
where the matrix Œõd (PÃÇ ) has ones in its first column and Œªdj‚àí1 (PÃÇ (k)) in row k and column j > 1:
Ô£Æ

1

Œªd1 (PÃÇ (1))

¬∑¬∑¬∑

ŒªdK (PÃÇ (1))

Ô£π

Ô£Ø
Ô£Ø
Ô£Ø
Œõd (PÃÇ ) = Ô£Ø
Ô£Ø
Ô£Ø
Ô£∞

1
..
.

Œªd1 (PÃÇ (2))
..
.

¬∑¬∑¬∑
..
.

ŒªdK (PÃÇ (2))
..
.

1 Œªd1 (PÃÇ (K)) ¬∑ ¬∑ ¬∑

Ô£∫
Ô£∫
Ô£∫
Ô£∫.
Ô£∫
Ô£∫
Ô£ª

ŒªdK (PÃÇ (K))

The control function estimates are therefore given by
ÀÜ d = Œõd (PÃÇ )‚àí1 YÃÑd .
‚àÜ

23

The values of Œªdk (PÃÇ (z)) are well-defined for all (k, z) whenever 0 < PÃÇ (z) < 1 ‚àÄz, and Œõd (PÃÇ ) is full rank if
PÃÇ (z) 6= PÃÇ (z 0 ) whenever z 6= z 0 . These requirements hold if Conditions 1 and 2 are true for every pair of
instrument values, so the matrix Œõd (PÃÇ ) is invertible under the conditions of Proposition 2 and the control
ÀÜ d exists.
function estimate ‚àÜ
In matrix form, the control function estimate of LAT Ez is given by
CF

\E z
LAT



ÀÜ1 ‚àí ‚àÜ
ÀÜ0 ,
= Œ•z (PÃÇ )0 ‚àÜ

where the (K + 1) √ó 1 vector Œ•z (PÃÇ ) has first entry equal to unity and kth entry Œìk‚àí1 (PÃÇ (z ‚àí 1), PÃÇ (z)) for k > 1:
0

PÃÇ (z‚àí1)Œª1K (PÃÇ (z‚àí1))
PÃÇ (z‚àí1)Œª11 (PÃÇ (z‚àí1))
, ..., PÃÇ (z)Œª1K (PÃÇ (z))‚àí
.
Œ•z (PÃÇ ) = 1, PÃÇ (z)Œª11 (PÃÇ (z))‚àí
PÃÇ (z)‚àíPÃÇ (z‚àí1)
PÃÇ (z)‚àíPÃÇ (z‚àí1)
ÀÜ 1 and ‚àÜ
ÀÜ 0 yields
Plugging in the formulas for ‚àÜ
CF

\E z
LAT

= Œ•z (PÃÇ )0 Œõ1 (PÃÇ )‚àí1 YÃÑ1 ‚àí Œ•z (PÃÇ )0 Œõ0 (PÃÇ )‚àí1 YÃÑ0 .

The IV and control functions are therefore identical if Œ®zd (PÃÇ )0 = Œ•z (PÃÇ )0 Œõd (PÃÇ )‚àí1 for d ‚àà {0, 1}, or equivalently,
if Œõd (PÃÇ )0 Œ®zd (PÃÇ ) = Œ•z (PÃÇ ) for d ‚àà {0, 1}.
For d = 1, we have
0

PÃÇ (z)Œª1K (PÃÇ (z))‚àíPÃÇ (z‚àí1)Œª1K (PÃÇ (z‚àí1))
PÃÇ (z‚àí1)Œª11 (PÃÇ (z‚àí1))
,
...,
Œõ1 (PÃÇ )0 Œ®z1 (PÃÇ ) = 1, PÃÇ (z)Œª11 (PÃÇ (z))‚àí
PÃÇ (z)‚àíPÃÇ (z‚àí1)
PÃÇ (z)‚àíPÃÇ (z‚àí1)
= Œ•z (PÃÇ ).

For d = 0, we have

0
(z‚àí1))‚àíŒª01 (PÃÇ (z))(1‚àíPÃÇ (z))
Œª01 (PÃÇ (z‚àí1))(1‚àíPÃÇ (z‚àí1))‚àíŒª01 (PÃÇ (z))(1‚àíPÃÇ (z))
Œõ0 (PÃÇ )0 Œ®z0 (PÃÇ ) = 1, Œª01 (PÃÇ (z‚àí1))(1‚àíPÃÇPÃÇ(z)‚àí
,
...,
PÃÇ (z‚àí1)
PÃÇ (z)‚àíPÃÇ (z‚àí1)
0

Œª1K (PÃÇ (z))PÃÇ (z)‚àíŒª1K (PÃÇ (z‚àí1))PÃÇ (z‚àí1)
11 (PÃÇ (z‚àí1))PÃÇ (z‚àí1)
,
...,
= 1, Œª11 (PÃÇ (z))PÃÇPÃÇ(z)‚àíŒª
(z)‚àíPÃÇ (z‚àí1)
PÃÇ (z)‚àíPÃÇ (z‚àí1)
= Œ•z (PÃÇ ),
where the second equality follows from the fact that p0 Œª1` (p0 ) ‚àí pŒª1` (p) = (1 ‚àí p)Œª0` (p) ‚àí (1 ‚àí p0 )Œª0` (p0 ) for any
IV

\E z
p, p0 and `. This implies that LAT

CF

\E z
and LAT

are equal to the same linear combination of YÃÑ1 and YÃÑ0 ,

so these estimates are identical for any z.

Proof of Proposition 3
The unrestricted control function estimates come from the regression
Yi = Œ±0 (0)(1 ‚àí Di )(1 ‚àí Xi ) + Œ≥0 (0)(1 ‚àí Di )(1 ‚àí Xi )Œª0 (PÃÇ (0, Zi ))
+Œ±0 (1)(1 ‚àí Di )Xi + Œ≥0 (1)(1 ‚àí Di )Xi Œª0 (PÃÇ (1, Zi ))
+Œ±1 (0)Di (1 ‚àí Xi ) + Œ≥1 (0)Di (1 ‚àí Xi )Œª1 (PÃÇ (0, Zi ))

24

+Œ±1 (1)Di Xi + Œ≥1 (1)Di Xi Œª1 (PÃÇ (1, Zi )) + i .
We can write this equation in matrix form as
Y = W ‚àÜ + ,
where W is the matrix of regressors and ‚àÜ = (Œ±0 (0), Œ≥0 (0), Œ±0 (1), Œ≥0 (1), Œ±1 (0), Œ≥1 (0), Œ±1 (1), Œ≥1 (1))0 collects the
control function coefficients. Under the conditions of Proposition 3, W 0 W has full rank and the unrestricted
control function estimates are
ÀÜ u = (W 0 W )‚àí1 W 0 Y .
‚àÜ
The estimator in equation (13) imposes three restrictions: Œ±1 (1) ‚àí Œ±1 (0) = Œ±0 (1) ‚àí Œ±0 (0), Œ≥1 (1) = Œ≥1 (0),
and Œ≥0 (1) = Œ≥0 (0). The resulting estimates can be written
ÀÜ r , %ÃÇ) = arg min (Y ‚àí W ‚àÜ)0 (Y ‚àí W ‚àÜ) ‚àí %C‚àÜ,
(‚àÜ
‚àÜ,%

where
Ô£Æ

‚àí1

Ô£Ø
Ô£Ø
C=Ô£Ø 0
Ô£∞
0

0

1

0

1

0

‚àí1

0

0

0

0 ‚àí1

0

‚àí1

0

1

0

0

0

0

Ô£π

Ô£∫
Ô£∫
1 Ô£∫
Ô£ª
0

and % is a Lagrange multiplier. Then
ÀÜr = ‚àÜ
ÀÜ u + (W 0 W )‚àí1 C 0 %ÃÇ,
‚àÜ
ÀÜ u.
%ÃÇ = ‚àí(C(W 0 W )‚àí1 C 0 )‚àí1 C ‚àÜ
ÀÜ with
ÀÜ the corresponding estimate of LATE for compliers with Xi = 1 is Œ•(PÃÇ )0 ‚àÜ,
For any estimate ‚àÜ,
Œ•(PÃÇ ) = (0, 0, ‚àí1, ‚àíŒì(PÃÇ (1, 0), PÃÇ (1, 1)), 0, 0, 1, Œì(PÃÇ (1, 0), PÃÇ (1, 1)))0 .

The restricted estimate of LAT E(1) is therefore


CF
ÀÜ u + (W 0 W )‚àí1 C 0 %ÃÇ
\E r (1) = Œ•(PÃÇ )0 ‚àÜ
LAT
CF

\E 1 (1) + Œ•(PÃÇ )0 (W 0 W )‚àí1 C 0 C(W 0 W )‚àí1 C 0
= LAT

‚àí1

Œ∂,

ÀÜ u is the constraint vector evaluated at the unrestricted estimates:
where Œ∂ = ‚àíC ‚àÜ
0

Œ∂ = ([Œ±ÃÇ0 (0) ‚àí Œ±ÃÇ0 (1)] ‚àí [Œ±ÃÇ1 (0) ‚àí Œ±ÃÇ1 (1)], Œ≥ÃÇ1 (0) ‚àí Œ≥ÃÇ1 (1), Œ≥ÃÇ0 (0) ‚àí Œ≥ÃÇ0 (1)) .
Write ‚Ñ¶ = (W 0 W )‚àí1 C 0 C(W 0 W )‚àí1 C 0

‚àí1

, and let ŒΩk denote the 3 √ó 1 vector equal to the transpose of the

kth row of ‚Ñ¶. Using the fact that a scalar is equal to its trace, we can then write the difference in restricted
and unrestricted LATE estimates as

25



CF
CF
\E r (1) ‚àí LAT
\E 1 (1) = tr Œ•(PÃÇ )0 ‚Ñ¶Œ∂
LAT


= tr ‚Ñ¶Œ∂Œ•(PÃÇ )0
= œï0 Œ∂,
where œï = ŒΩ7 ‚àí ŒΩ3 + Œì(PÃÇ (1, 0), PÃÇ (1, 1))(ŒΩ8 ‚àí ŒΩ4 ) ‚â° (œï1 , œï2 , œï3 )0 . Then
CF

CF

\E r (1) ‚àí LAT
\E 1 (1) = œï1 ([Œ±ÃÇ0 (0) ‚àí Œ±ÃÇ0 (1)] ‚àí [Œ±ÃÇ1 (0) ‚àí Œ±ÃÇ1 (1)]) + œï2 (Œ≥ÃÇ1 (0) ‚àí Œ≥ÃÇ1 (1)) + œï3 (Œ≥ÃÇ0 (0) ‚àí Œ≥ÃÇ0 (1))
LAT




CF
CF
\
\
= œï1 LAT E 1 (1) ‚àí LAT E 0 (1) + (Œ≥ÃÇ1 (0) ‚àí Œ≥ÃÇ1 (1)) œï2 + œï1 Œì(PÃÇ (1, 0), PÃÇ (1, 1))


+(Œ≥ÃÇ0 (0) ‚àí Œ≥ÃÇ0 (1)) œï3 ‚àí œï1 Œì(PÃÇ (1, 0), PÃÇ (1, 1)) .
This implies
CF

CF

CF

\E r (1) = wLAT
\E 1 (1) + (1 ‚àí w)LAT
\E 0 (1) + b1 (Œ≥ÃÇ1 (1) ‚àí Œ≥ÃÇ1 (0)) + b0 (Œ≥ÃÇ0 (1) ‚àí Œ≥ÃÇ0 (0)),
LAT
where w = 1 + œï1 , b1 = ‚àí(œï2 + œï1 Œì(PÃÇ (1, 0), PÃÇ (1, 1))), and b0 = œï1 Œì(PÃÇ (1, 0), PÃÇ (1, 1)) ‚àí œï3 . Furthermore, note
that the elements of œï only depend on sample moments of Di , Xi , and PÃÇ (Xi , Zi ), so the proposition follows.

Proof of Proposition 4
The log likelihood function for model (16) is
X

log L (P (0), P (1), Œ±0 , Œ±1 , œÅ0 , œÅ1 ) =

Di log

i

!


Yi F|U (Œ±1 |u; œÅ1 ) + (1 ‚àí Yi )(1 ‚àí F|U (Œ±1 |u; œÅ1 )) du

0

i

Z
X
+ (1 ‚àí Di ) log

P (Zi )

Z

!


Yi F|U (Œ±0 |u; œÅ0 ) + (1 ‚àí Yi )(1 ‚àí F|U (Œ±0 |u; œÅ0 )) du .

1

P (Zi )

We first rewrite this likelihood in terms of the six identified parameters of the LATE model, which are given
by
œÄat = P (0),
œÄc = P (1) ‚àí P (0),
R P (0)
¬µ1at =

0

R1
¬µ0nt =
R P (1)
¬µdc =

P (0)

P (1)

F|U (Œ±1 |u; œÅ1 )du
,
P (0)

F|U (Œ±0 |u; œÅ0 ) du
1 ‚àí P (1)

F|U (Œ±d |u; œÅd )du

P (1) ‚àí P (0)

26

,

, d ‚àà {0, 1}.

Note that since F|U (¬∑|u; œÅ) is a CDF, we have ¬µdg ‚àà [0, 1] ‚àÄ(d, g). Substituting these parameters into the
likelihood function yields

X
log L(œÄat , œÄc , ¬µ1at , ¬µ0nt , ¬µ1c , ¬µ0c ) =
Di Zi log (œÄat [Yi ¬µ1at + (1 ‚àí Yi )(1 ‚àí ¬µ1at )] + œÄc [Yi ¬µ1c + (1 ‚àí Yi )(1 ‚àí ¬µ1c )])
i

X
+
Di (1 ‚àí Zi ) log (œÄat [Yi ¬µ1at + (1 ‚àí Yi )(1 ‚àí ¬µ1at )])
i

X
+ (1 ‚àí Di )Zi log ((1 ‚àí œÄat ‚àí œÄc ) [Yi ¬µ0nt + (1 ‚àí Yi )(1 ‚àí ¬µ0nt )])
i

X
+ (1 ‚àí Di )(1 ‚àí Zi ) log ((1 ‚àí œÄat ‚àí œÄc ) [Yi ¬µ0nt + (1 ‚àí Yi )(1 ‚àí ¬µ0nt )] + œÄc [Yi ¬µ0c + (1 ‚àí Yi )(1 ‚àí ¬µ0c )]).
i

We first consider interior solutions. The first-order conditions are
X
Di (2Yi ‚àí1)Zi œÄat
[¬µ1at ] :
œÄat [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]+œÄc [Yi ¬µ1c +(1‚àíYi )(1‚àí¬µ1c )] +

Di (2Yi ‚àí1)(1‚àíZi )œÄat
œÄat [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]



= 0,

i

[¬µ0nt ] :

X

(1‚àíDi )(2Yi ‚àí1)Zi (1‚àíœÄat ‚àíœÄc )
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]

+

(1‚àíDi )(2Yi ‚àí1)(1‚àíZi )(1‚àíœÄat ‚àíœÄc )
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]+œÄc [Yi ¬µ0c +(1‚àíYi )(1‚àí¬µ0c )]



= 0,

i

[¬µ1c ] :

X

Di Zi (2Yi ‚àí1)œÄc
œÄat [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]+œÄc [Yi ¬µ1c +(1‚àíYi )(1‚àí¬µ1c )]

= 0,

i

X

[¬µ0c ] :

(1‚àíDi )(1‚àíZi )(2Yi ‚àí1)œÄc
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]+œÄc [Yi ¬µ0c +(1‚àíYi )(1‚àí¬µ0c )]

= 0,

i

[œÄat ] :

X

Di Zi [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]
œÄat [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]+œÄc [Yi ¬µ1c +(1‚àíYi )(1‚àí¬µ1c )]

i

+

XD

i (1‚àíZi )

œÄat
i

X (1‚àíD )Z [Y ¬µ +(1‚àíY )(1‚àí¬µ )]
X
(1‚àíDi )(1‚àíZi )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]
i
i i 0nt
i
0nt
‚àí
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )] ‚àí
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]+œÄc [Yi ¬µ0c +(1‚àíYi )(1‚àí¬µ0c )] = 0,
i

[œÄc ] :

i

X

Di Zi [Yi ¬µ1c +(1‚àíYi )(1‚àí¬µ1c )]
[œÄat [Yi ¬µ1at +(1‚àíYi )(1‚àí¬µ1at )]+œÄc [Yi ¬µ1c +(1‚àíYi )(1‚àí¬µ1c )]]

‚àí

X

(1‚àíDi )Zi [Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]

i

i

X
(1‚àíDi )(1‚àíZi )(2Yi ‚àí1)(¬µ0nt ‚àí¬µ0c )
‚àí
(1‚àíœÄat ‚àíœÄc )[Yi ¬µ0nt +(1‚àíYi )(1‚àí¬µ0nt )]+œÄc [Yi ¬µ0c +(1‚àíYi )(1‚àí¬µ0c )] = 0.
i
IV
IV
IV
IV
Under Conditions 1 and 2 we can compute ¬µÃÇIV
= PÃÇ (1) ‚àí PÃÇ (0) and
1at , ¬µÃÇ0nt , ¬µÃÇ1c , and ¬µÃÇ0c . Setting œÄÃÇc
IV
œÄÃÇat
= PÃÇ (0) and plugging the IV parameter estimates into the FIML first order conditions, we see that these

conditions are satisfied. Thus at interior solutions maximum likelihood and IV estimators of all parameters
L
IV
are equal, and it follows that ¬µÃÇM
dc = ¬µÃÇdc for d ‚àà {0, 1}.

Next, we consider corner solutions, which occur when at least one parameter lies outside [0,1] at the
IV
bIV
unconstrained solution to the first order conditions. Note that ¬µ
bIV
1at , ¬µ
0nt , and œÄÃÇat are sample means of binary

variables, so these estimates are always in the unit interval. œÄÃÇcIV is the difference in empirical treatment rates
between the two values of Zi ; without loss of generality we assume that Zi = 1 refers to the group with the
higher treatment rate, so œÄÃÇcIV ‚àà (0, 1). Thus a constraint binds if and only if ¬µÃÇIV
dc is outside [0,1] for d = 0,
d = 1, or both. In these cases at least one of the maximum likelihood complier means fails to match the
corresponding IV estimate because the IV estimate is outside the FIML parameter space. This establishes that
IV
the FIML and IV estimates match if and only if both ¬µÃÇIV
1c and ¬µÃÇ0c are in [0,1], which completes the proof.

27

