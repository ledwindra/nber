NBER WORKING PAPER SERIES

ON THE ESTIMATION OF TREATMENT EFFECTS WITH ENDOGENOUS MISREPORTING
Pierre Nguimkeu
Augustine Denteh
Rusty Tchernis
Working Paper 24117
http://www.nber.org/papers/w24117

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2017

We thank Jason Abrevaya, Victor Chernozhukov, Steven Durlauf, William Greene, Kei Hirano,
Arthur Lewbel, Nikolas Mittag, Robert Moffitt, Tom Mroz, Alistair O0Malley, Dale Poirier, Seth
Richards-Shubik, Gary Solon, Jeffrey Wooldridge, seminar participants at Bank of Canada,
Dalhousie University, University of Paris 10, University of California Berkeley, University of
Nevada-Las Vegas, Northwestern University, as well as conference participants at the Tinbergen
Institute, IZA, CERGE-EI, the Southern Economic Association, and the American Society of
Health Economists, for helpful comments. The views expressed herein are those of the authors
and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
¬© 2017 by Pierre Nguimkeu, Augustine Denteh, and Rusty Tchernis. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission
provided that full credit, including ¬© notice, is given to the source.

On the Estimation of Treatment Effects with Endogenous Misreporting
Pierre Nguimkeu, Augustine Denteh, and Rusty Tchernis
NBER Working Paper No. 24117
December 2017
JEL No. C35,C51,I28
ABSTRACT
Participation in social programs is often misreported in survey data, complicating the estimation
of the effects of those programs. In this paper, we propose a model to estimate treatment effects
under endogenous participation and endogenous misreporting. We show that failure to account
for endogenous misreporting can result in the estimate of the treatment effect having an opposite
sign from the true effect. We present an expression for the asymptotic bias of both OLS and IV
estimators and discuss the conditions under which sign reversal may occur. We provide a method
for eliminating this bias when researchers have access to information related to both participation
and misreporting. We establish the consistency and asymptotic normality of our estimator and
assess its small sample performance through Monte Carlo simulations. An empirical example is
given to illustrate the proposed method.
Pierre Nguimkeu
Georgia State Univerity
14 Marietta St. NW, Suite G-52 Atlanta,
GA 30303
nnguimkeu@gsu.edu
Augustine Denteh
Department of Economics
Andrew Young School of Policy Studies
P.O. Box 3992
Atlanta, GA 30302-3992
augidenteh@gmail.com

Rusty Tchernis
Department of Economics
Andrew Young School of Policy Studies
Georgia State University
P.O. Box 3992
Atlanta, GA 30302-3992
and NBER
rtchernis@gsu.edu

1

Introduction

This paper proposes a solution to the problem of identification and estimation
of treatment effects in parametric regressions when participation is endogenously
misreported. In particular, we provide a two-step estimation procedure that consistently estimates the conditional average treatment effect. Participation in social
programs is substantially misreported in survey data, sometimes with misreporting levels as high as 50% (Meyer, Mok & Sullivan 2009). When a binary regressor
is misreported (or misclassified), the measurement error is necessarily negatively
correlated with the underlying true value of the regressor, thus making the classical measurement error assumptions implausible.1 While earlier papers (Aigner
1973, Lewbel 2007) show that exogenous misreporting leads to attenuation bias,
we demonstrate that the effects of endogenous misreporting are much more severe.
To our knowledge, this paper is the first attempt to provide point estimates of
treatment effects in the context of endogenous misreporting of a binary treatment
variable.
Misreporting occurs when program participants report not receiving treatment
when they actually did (‚Äúfalse negatives‚Äù) or vice versa (‚Äúfalse positives‚Äù). Onesided misreporting (i.e., the occurrence of only one of the two types of misclassification errors) is pervasive in practice and in many empirical studies. For example,
Lynch, Marioni & TavareÃÅ (2007) and Meyer & Goerge (2011) report that validation studies always find high rates of false negatives in the Supplemental Nutrition
Assistance Program (SNAP) ranging from 20% to 50%, depending on the survey
1

For empirical papers that discuss non-classical measurement errors with continuous explanatory variables, see, e.g., Stephens & Unayama (2015), Haider & Solon (2006) and the references
therein.

1

and time period.2 While Meyer & Goerge (2011) finds up to 50% rate of false
negatives in SNAP participation in the CPS Annual Social and Economic Supplement, false positives are typically low with only less than 1.5% of non-recipients
reporting SNAP receipt.
One-sided misreporting is not confined to government programs. For example,
according to Bound (1991), there are a number of reasons to be suspicious of any
survey response to questions concerning self-evaluated health, not only because
respondents are being asked for subjective judgments, but also because responses
may be endogenous to the outcomes we may wish to use them to explain. Brachet (2008) argues that in health-related surveys, self-reported smoking status is
significantly misreported, with false negatives ranging from 3.4% in some studies to 73% in others. Other instances of one-sided misreporting can be found in
the development literature where a firm‚Äôs formality status is often misreported,
with informal firms more likely to falsely report their status (see Gandelman &
Rasteletti 2017), or the education literature where misclassification error is more
likely to arise from overreporting of qualifications (e.g. Battistin & Sianesi 2011).
Recognizing the documented evidence of misclassification errors, a related literature considers the consequences of measurement errors in a binary regressor in
Monte Carlo studies. For instance, in studying the worst-case bounds of regression
coefficients under arbitrary misclassification of a binary regressor, Kreider (2010)
finds that even with misclassification error rates of less than 2%, the confidence
intervals from the contaminated data that the researcher observes and the true,
error-free data do not overlap. Similarly, Millimet (2011) studies the performance
of several estimators employed in the causal inference literature while introducing
measurement error in the treatment (binary) regressor, outcome variable, and vec2

Misreporting has also been documented for other government programs; see, e.g., Marquis
& Moore (1990) for an earlier validation study discussing measurement error in the reports of
participation in eight government transfer programs in the 1984 Survey of Income and Program
Participation (SIPP).

2

tor of covariates, and cautions researchers to be conscious of the consequences of
not addressing measurement error.
The existing literature has focused on accounting for random (exogenous) misreporting when participation is exogenous. For instance, Aigner (1973) considers
misclassification in exogenous binary regressors, shows that OLS estimates are
biased downwards, and proposes a technique based on knowledge of the misclassification probabilities to consistently estimate the parameters of interest. More
recently, Lewbel (2007) examines the identification and estimation of the treatment
effect of a misclassified binary regressor in nonparametric and semiparametric regressions. Lewbel reaches the same attenuation-bias result that Aigner (1973)
finds and introduces assumptions that identify the conditional average treatment
effect of the misclassified binary regressor.

Related works by Bollinger (1996),

Black, Berger & Scott (2000) and van Hasselt & Bollinger (2012) provide partial
identification bounds in the linear regression model, while Chen, Hu & Lewbel
(2008a,b), provide identification in the nonparametric regression model.
Some attempts have been made to address exogenous misreporting when treatment selection (participation) is endogenous. In the education literature, Kane,
Rouse & Staiger (1999) address misreporting when estimating returns to schooling by proposing a generalized method of moments (GMM) estimator that relies on the existence of two categorical reports of educational attainment, and so
may have limited applicability. In estimating the effects of maternal smoking on
infant health, Brachet (2008) proposes a two-step GMM estimator, that essentially follows Hausman, Abrevaya & Scott-Morton (1998) and Kane et al. (1999).
An admitted weakness of Brachet‚Äôs approach is the assumption that misreporting probabilities are independent of covariates, conditional on treatment status.
Frazis & Loewenstein (2003) and Mahajan (2006) study identification with the
usual IV assumptions under homogenous and heterogenous treatment effects due

3

to observables, respectively. More recently, DiTraglia & Garcƒ±ÃÅa-Jimeno (2017) derive a sharp identified set under standard first-moment assumptions and propose
a Bonferroni-based procedure for identification robust inference. Also, Bollinger
& van Hasselt (2017) use a Bayesian approach while Ura (2017) allows for heterogeneous treatment effects due to unobeservables in these models.
Much less is known about the case in which the regressor and the measurement
error are both endogenous. Hu, Shiu & Woutersen (2015, 2016) provide identification results in a class of nonseparable index models with measurement error
and endogeneity. Kreider, Pepper, Gundersen & Jolliffe (2012) is the most closely
related to our work, in the sense that they allow for both treatment endogeneity
and endogenous measurement error in the case of binary treatment as we do in
this paper. In estimating the effect of SNAP on health outcomes, they use auxiliary administrative data on the size of SNAP caseloads to address misreporting by
bounding the average treatment effect under increasingly stronger assumptions.
While this partial identification approach identifies treatment effects with their
tightest bounds, it does not yield point estimates. As such its relevance for policy
making may not be widespread.
This paper has three salient contributions. First, we propose a parametric
model of endogenous misreporting and endogenous participation. We only analyze
the case of one-sided misreporting at this stage, which is the predominant case
of misreporting described in Meyer et al. (2009). Second, we show that when
misreporting is endogenous, OLS and IV estimators are inconsistent and OLS
estimates can be of opposite signs from the true effects (sign reversal), whether
participation is endogenous or not. We provide theoretical expressions for these
biases under the normality assumption as well as Monte Carlo simulation evidence.
Third, we propose an estimator that is root-n consistent and asymptotically normal
and show that it performs remarkably well in small samples.

4

We illustrate the use of our approach in an empirical application. Identification
in our framework relies on the existence of both an additional random variable that
is correlated with the unobserved true underlying treatment, but unrelated to the
outcome and the misclassification error (e.g., Frazis & Loewenstein 2003, Mahajan
2006), as well as a random variable that is correlated with the misclassification
error and needs not be excludable from the outcome. In addition, we assume that
the observed treatment probability is a joint (known) function of the treatment and
misclassification probability. This allows us to pin down the marginal distribution
of true participation and thus point-identify the treatment effect.
The rest of the paper is organized as follows. Section 2 presents the model
of endogenous misreporting and shows the inconsistency of OLS and IV estimators. Section 3 develops the proposed estimator. Section 4 provides Monte Carlo
simulations, Section 5 contains an empirical application and Section 6 concludes.
Proofs and other technical material are collected in the appendix.

2

Framework

This section describes the proposed model and associated framework, and presents
our estimation strategy.

2.1

Model with Endogenous Misreporting

Consider the following specification of the usual treatment effects model. The
outcome variable, yi , is related to the k‚Äìvector of correctly measured exogenous
covariates, xi , and the (true) participation indicator, Œ¥i‚àó , by
yi = x0i Œ≤ + Œ¥i‚àó Œ± + i ,

5

(1)

and we model participation as
Œ¥i‚àó = 1 (zi0 Œ∏ + vi ‚â• 0) ,

(2)

where Œ± is a scalar capturing the treatment effect of interest, Œ≤ and Œ∏ are parameter
vectors of sizes k √ó 1 and q √ó 1 respectively, zi is a q-vector of exogenous variables
that includes xi as well as additional instruments that are unrelated to i . In this
model, the (possible) endogeneity of participation is captured by the correlation
between the error terms i and vi .
However, the researcher does not observe the true participation indicator Œ¥i‚àó
but only a possibly misclassified surrogate, Œ¥i , contaminated by a misreporting
unobserved dummy variable, di , such that Œ¥i = Œ¥i‚àó di . In other words, an individual
correctly reports her treatment status only if di = 1 and reports not receiving
treatment otherwise. We assume that misreporting, di , is related to a p-vector of
observable covariates wi such that
di = 1 (wi0 Œ≥ + ui ‚â• 0) ,

(3)

where Œ≥ is a parameter vector of size p √ó 1 and ui is the error term. Hence, the
observed participation, Œ¥i , can be modeled by
Œ¥i = Œ¥i‚àó di = 1 (zi0 Œ∏ + vi ‚â• 0, wi0 Œ≥ + ui ‚â• 0) .

(4)

Our modeling of misreported participation is generally in the spirit of a wider class
of methods that have been developed for incomplete data scenarios and specifically similar to partial observability models studied in Poirier (1980). Partial
observability models such as Poirier‚Äôs have been widely applied in many fields of
study, including Feinstein‚Äôs examination of the problem of incomplete detection of

6

violations of laws and regulations (Feinstein 1990).
For the estimation, no further restrictions are imposed on xi . However, we
require the covariates zi and wi to be different but possibly overlapping and to
have sufficient variation (e.g., at least one covariate in z and in w is continuous) to
avoid the local identification problems discussed in Poirier (1980). We also make
the following basic assumptions, some of which are standard in the literature.
Assumption 1. The error term i is independent of the exogenous variables xi ,
zi , with variance œÉ 2 ; and the error terms (ui , vi ) are independent of all covariates
xi , zi , wi , and have unit variances. The correlations for the pairs (i , ui ), (i , vi )
and (ui , vi ) are denoted œïu , œïv and œÅ, respectively.
Assumption 2. The k √ó k matrix, E(xi x0i ), is nonsingular (and hence finite).
Assumption 3. The joint CDF of (‚àíui , ‚àívi ) is known, and is defined by
Fu,v (u, v, œÅ) = Pr[‚àíui ‚â§ u, ‚àívi ‚â§ v],

for any ‚àí ‚àû < u, v < +‚àû.

In particular, we assume that conditional on zi and wi , (‚àíui , ‚àívi ) follows a bivariate normal distribution.
Assumption 4. The error terms, (i , ui , vi ), follow a trivariate normal distribution, conditional on all covariates xi , zi , wi . That is,
Ô£´

(i , ui , vi )0 |xi , zi , wi ‚àº N (0, Œ£) ,

with

2

œÉ
œïu œÉ œï v œÉ
Ô£¨
Ô£¨
Œ£ = Ô£¨ œïu œÉ 1
œÅ
Ô£≠
œïv œÉ œÅ
1

Ô£∂
Ô£∑
Ô£∑
Ô£∑,
Ô£∏

(5)

Assumptions 1 and 2 are quite standard. However, it is important to notice
that unlike xi and zi , the exogeneity requirement does not apply to wi , the vector of covariates associated with misreporting in equation (3). This could be of
7

substantial interest in practice where exogenous covariates are often difficult to
find. Assumption 3 is critical to parametrically identify the probability of true
(unobserved) participation. While we assume joint normality of the disturbance
terms in the observed participation equation for simplicity (as in Poirier 1980),
normality is not needed and the following discussion would hold for other absolutely continuous distributions (e.g., the bivariate logistic distributions discussed
in Gumbel 1961). Assumption 4 is only needed to derive closed-form formulas for
the OLS bias (see Section 2.2) and for extensions to binary choice models and full
information maximum likelihood (see Appendix B); but it is not essential for the
rest of our main discussions.
Our estimation strategy relies on observing z and w. We recognize that exclusion restrictions for participation as well as relevant predictors for misreporting
may be difficult to obtain in practice and our suggestion is to rely on different
data sources. For instance, exclusion restrictions for participation may come from
qualification laws (eligibility requirements) for program participation. Relevant
predictors of misreporting, wi , could include peculiar features of the survey in
question and its administration such as survey date, length of survey, interview
mode, etc., and the proportion of questions to which the individual refused to
respond.

2.2

Bias due to Endogenous Misreporting

We first show that a naive OLS estimator of the treatment effect is biased and
may assume a sign opposite to the true effect. Since the true participation status
Œ¥i‚àó is unobserved and only Œ¥i is observed, the model with reported participation
status estimated by the researcher is given by
yi = x0i Œ≤ + Œ¥i Œ± + Œµi .
8

(6)

Given the true outcome equation defined by equation (1), equation (6) implies
that
Œµi = i + (Œ¥i‚àó ‚àí Œ¥i ) Œ±.

(7)

For a random sample of size n, equation (6) can be re-written in the matrix
form as follows:
y = XŒ≤ + Œ¥Œ± + Œµ,

(8)

where y = [y1 , . . . , yn ]0 , X = [x1 , . . . , xn ]0 , Œ¥ = [Œ¥1 , . . . , Œ¥n ]0 , and Œµ = [Œµ1 , . . . , Œµn ]0 .3

Denote by Œ±
bLS the OLS estimator obtained by naively estimating equation (6)
using reported participation Œ¥i . Then, we have the following result.

Theorem 1. Under Assumptions 1 - 4, the ordinary least squares estimator, Œ±
bLS ,
is biased and inconsistent, and the asymptotic bias is given by
plim(b
Œ±LS ‚àí Œ±) =

A ‚àí Œ±B
,
C

(9)

with

 0

 0

wi Œ≥ ‚àí œÅzi0 Œ∏
zi Œ∏ ‚àí œÅwi0 Œ≥
0
0
A = E œÉœïv œÜ (‚àízi Œ∏) Œ¶ p
+ œÉœïu œÜ (‚àíwi Œ≥) Œ¶ p
,
1 ‚àí œÅ2
1 ‚àí œÅ2
B = E(Œ¥i x0i )E(xi x0i )‚àí1 E[(Œ¥i‚àó ‚àí Œ¥i )xi ]

and

C = E(Œ¥i ) ‚àí E(Œ¥i x0i )E(xi x0i )‚àí1 E(Œ¥i xi ),

where œÜ(¬∑) and Œ¶(¬∑) are respectively the pdf and cdf of the standard normal.
Proof. See Appendix.
3

Re-writing the model in matrix notation is not necessary but makes the exposition (especially
the proofs) less cumbersome. The matrix form also gives alternative (simpler) expressions for
the various estimators considered.

9

Since the denominator in (9), C, is always positive by the Cauchy-Schwarz
Inequality (see, e.g., Tripathi 1999) the sign of the asymptotic bias only depends
on the numerator of the expression. For example, if B > 0, then plim(b
Œ±LS ) < Œ±
for all Œ± > A/B (i.e., there is an attenuation bias) and plim(b
Œ±LS ) > Œ± for all
Œ± < A/B (i.e., there is an expansion bias). Also there are many instances in
which plim(b
Œ±LS ) and Œ± will have opposite signs. For example, if B ‚àí C < 0, then
plim(b
Œ±LS ) and Œ± have opposite signs whenever Œ± lays between A/(B ‚àí C) and 0
(Figure 1 depicts the regions where bias and sign switching occur in this case).
Note that sign-switching can occur even when participation is exogenous. Without loss of generality, consider the case of exogenous participation (i.e œïv = 0).
The sign-switching result depicted in Figure 1 follows if (i) A > 0, (ii) B ‚àí C < 0,
and (iii) A/(B ‚àí C) < Œ± < 0. Condition (i) holds if misreporting is endogenous and the disturbance terms in equations (1) and (3) are positively correlated
(œïu > 0). Thus, the size of the sign-switching region depends on how large the
ratio A/(B ‚àí C) is in general. In particular, in our example, the size of the signswitching region increases with the rate of false negatives and the variance of the
error term in the outcome equation, and decreases with the rate of true participation, ceteris paribus. We provide evidence on the sign-switching region and these
relationships in our Monte Carlo study in Section 4.
The above discussion shows that the bias related to misreporting is not merely
an attenuation bias as found in many other studies (e.g., Aigner 1973, Black et al.
2000, Lewbel 2007). Under endogenous misreporting, the estimated treatment
effect can possibly assume an opposite sign, yielding misleading policy prescriptions. This sign reversal phenomenon would generally occur when misreporting
is significant and the direction of its correlation with the outcome is opposite to
the direction of the treatment effect. For example, in the SNAP participation
and obesity relationship, much empirical work have relied on self-reported SNAP

10

plim !LS

plim!LS>!

plim!LS<!

sign switching area
A/C

A/(B!C)

0

A/B

!

Figure 1: Illustration of the OLS bias
participation and have found a positive or no effect on obesity. But, if people who
are overweight are also more likely to correctly report SNAP participation (i.e., A
positive) and since, as mentioned above, misreporting in SNAP is very severe in
the data ( i.e., B ‚àí C is negative with a small magnitude) then we could observe a
positive relationship between SNAP participation and obesity (i.e. plimŒ±ÃÇLS > 0)
even if the true effect is negative (i.e. Œ± < 0).
In the next section, we provide an estimation strategy that allows consistent
estimation of the treatment effect, Œ±. But first, we examine how well an IV estimation strategy would perform in our framework.

2.3

IV Estimator under Endogenous Misreporting

The misreporting mechanism described above shows that in equation (6), the
regressor Œ¥i is correlated with the error term Œµi as implied by equation (7). Thus,
equation (1) can be seen as a regression with an endogenous
binary
regressor,
Student Version
of MATLAB
even if true participation is exogenous and only misreporting is endogenous. So it
may be tempting to suppose that if an instrument is present, then a standard IV
estimator will address the issue raised in our framework. Here, we show that this

11

is not the case.
Suppose we have access to a valid instrumental variable, zi , such that E[zi Œµi ] =
0 and Cov(zi , Œ¥i ) 6= 0, and assume, for simplicity, that zi is a scalar so that Œ± is
just identified. Then the (simple) instrumental variable estimator is given by
Œ±
bIV = (z 0 M Œ¥)‚àí1 z 0 M y,
where M = I ‚àí X(X 0 X)‚àí1 X 0 is the orthogonal projection matrix onto the null
space of X.
We can show using the same reasoning as above that,
E(zi Œ¥i‚àó ) ‚àí E(zi x0i )E(xi x0i )‚àí1 E(xi Œ¥i‚àó )
plim(b
Œ±IV ) =
Œ±.
E(zi Œ¥i ) ‚àí E(zi x0i )E(xi x0i )‚àí1 E[xi Œ¥i ]

(10)

Thus, the IV estimator of Œ± is inconsistent, and we cannot sign the bias in general. However, in the special case where misreporting is uncorrelated with true
participation and the other covariates, it can be shown that,
plim(b
Œ±IV ) =

Œ±
Œ±
=
,
E[di ]
Pr[di = 1]

so that

|plim(b
Œ±IV )| > |Œ±|.

Hence, in this specific scenario, the IV estimator is upwardly biased. This result
is similar to those obtained by Black et al. (2000), (see also Frazis & Loewenstein
2003, Brachet 2008). The finding that the IV estimator is inconsistent is not new,
given the results of the above authors and others. However, Black et al. (2000)
showed that the IV estimator yields an expansion bias, which corresponds to the
special case of exogenous measurement errors. By contrast, as suggested by equation (10), the sign of the IV bias is not obvious when misreporting is endogenous,
and our simulations show that the ensuing bias can take either direction (i.e.,
expansion or attenuation).

12

We now present an estimation procedure that delivers consistent and asymptotically normal estimates for the treatment effect, Œ±.

3

The Proposed Estimator

Recall that our objective is to estimate Œ± in the outcome equation (1), where true
(and possibly endogenous) participation status, Œ¥i‚àó , is unobserved, but only a possibly misreported (and possibly endogenous) participation status, Œ¥i , is observed.
The proposed estimation strategy proceeds in the following two steps.
Step 1: With the joint distribution of ui and vi given by Fu,v (u, v, œÅ), use the
partial observability probit model given by equation (4) to estimate the
parameter vectors Œ∏ and Œ≥. Then, compute the predicted probability for
person i‚Äôs true participation status as Œ¥ÃÇi‚àó = Œ¶(zi0 Œ∏ÃÇ).
Step 2: Estimate equation (1) by substituting Œ¥ÃÇi‚àó for Œ¥i‚àó . Assuming correct model
specification and distribution of the error terms, the resulting two-step
estimator of Œ± is consistent. Moreover, with standard regularity assumptions, this estimator is asymptotically normal.

3.1

First Step Estimation

Following Poirier (1980), the parameters Œ≥, Œ∏ and œÅ can be jointly estimated from
the joint distribution of the error terms using the binary choice model defined by
Pr[Œ¥i = 1|wi , zi ] = Pr [‚àíui ‚â§ wi0 Œ≥, ‚àí vi ‚â§ zi0 Œ∏] = Fu,v (wi0 Œ≥, zi0 Œ∏, œÅ) = Pi (Œ≥, Œ∏, œÅ).

13

The log-likelihood function of this model is given by

Ln (Œ≥, Œ∏, œÅ) =

n
X

Œ¥i ln Pi (Œ≥, Œ∏, œÅ) + (1 ‚àí Œ¥i ) ln (1 ‚àí Pi (Œ≥, Œ∏, œÅ)) .

i=1

Assuming correct distributions, the maximum likelihood estimator of the vector
of parameters (Œ≥, Œ∏, œÅ) is consistent and asymptotically normal, and the covariance
matrix consistently estimated with the inverse of the information matrix. In particular, for the parameter Œ∏, the MLE Œ∏ÃÇ is consistent and asymptotically normal,
i.e.,
p

Œ∏ÃÇ‚àí‚Üí Œ∏

‚àö
d
n(Œ∏ÃÇ ‚àí Œ∏)‚àí‚Üí N (0, VŒ∏ ) ,

and

where the asymptotic variance of Œ∏ÃÇ is obtained from the information matrix
equality as
 
VŒ∏ = E

1
‚àÇPi ‚àÇPi
Pi (1 ‚àí Pi ) ‚àÇŒ∏ ‚àÇŒ∏0

‚àí1
.

(11)

From this expression, a consistent estimator for the variance matrix can be obtained as
"

n

1X
1
‚àÇ Pbi ‚àÇ Pbi
VbŒ∏ =
n i=1 Pbi (1 ‚àí Pbi ) ‚àÇŒ∏ ‚àÇŒ∏0

#‚àí1
,

(12)



where Pbi = Pi (Œ≥ÃÇ, Œ∏ÃÇ, œÅÃÇ) = Fu,v wi0 Œ≥ÃÇ, zi0 Œ∏ÃÇ, œÅÃÇ . For the normal case, the gradient takes
a fairly simple form
‚àÇ Pbi
= œÜ(zi0 Œ∏ÃÇ)Œ¶
‚àÇŒ∏

wi0 Œ≥ÃÇ ‚àí œÅÃÇzi0 Œ∏ÃÇ
p
1 ‚àí œÅÃÇ2

!
zi .

Since this first-step is a maximum likelihood, parametric identification of (Œ∏, Œ≥, œÅ)
can be discussed in terms of non-singularity of the corresponding information matrix (Rothenberg 1971). This means perfect multicollinearity needs to be ruled
out, implying that both wi and zi should satisfy the standard rank conditions as
a basic requirement. In addition, as we explained earlier, a single exclusion restriction between wi and zi (i.e., at least one covariate in zi should not be relevant
14

in wi , or vice-versa) is sufficient to identify all the first step parameters locally
(Poirier 1980).4 Also, notice that only the (correct) specification of the marginal
distribution of v is necessary for the parametric identification and estimation of
the model in the second step. If the distribution of u or the joint distribution of
(u, v) are unknown, then one may still obtain a consistent estimator of Œ∏ in the
first step by using a semiparametric approach such as the series expansion of the
joint PDF of (u, v) proposed by Gallant & Nychka (1987) or the single equation
multiple index model described in Ichimura & Lee (1991).

3.2

Second Step Estimation

In the second step, we compute the predicted values of true unobserved participation Œ¥i‚àó , given by Œ¥ÃÇi‚àó = Œ¶(zi0 Œ∏ÃÇ), which are used in lieu of Œ¥i‚àó to estimate the
parameters of the new model given by

yi = x0i Œ≤ + Œ¥ÃÇi‚àó Œ± + Œ∑i .

(13)

Using the same approach as above, the second step estimator is obtained as
0

0

Œ±
b2S = (Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó )‚àí1 Œ¥ÃÇ ‚àó M y
Pn
Pn
Pn
Pn
0 ‚àí1
0
0
0
i=1 xi xi ]
i=1 xi yi
i=1 Œ¶(zi Œ∏ÃÇ)xi [
i=1 Œ¶(zi Œ∏ÃÇ)yi ‚àí
= Pn
P
P
P
n
n
n
0
0
0 ‚àí1
0
0 2
i=1 Œ¶(zi Œ∏ÃÇ)xi [
i=1 xi xi ]
i=1 xi Œ¶(zi Œ∏ÃÇ)
i=1 Œ¶(zi Œ∏ÃÇ) ‚àí

(14)

We have the following consistency result.
Theorem 2. Under Assumptions 1-3, the two-step estimator is consistent for Œ±,
p

that is, Œ±
b2S ‚àí‚Üí Œ±.
Proof. See Appendix.
4

Essentially, identification implies much stronger conditions than the standard rank condition
for linear IV, since it requires that participation and hence the (nonlinear) relationship between
true treatment and instruments be fully parameterized and correctly specified.

15

Notice that only the component Œ∏ÃÇ of the parameter vector is used at this second
stage to predict the true unobserved participation status. The other components,
Œ≥ÃÇ and œÅÃÇ are only used in the computation of the asymptotic variance estimator, as
described below. In this second step, exclusion restriction is not strictly needed for
identification as long as nonlinearity in the marginal distribution of vi is assumed.
We have the following asymptotic normality result.
Theorem 3. Under the model assumptions the two-step estimator is asymptotically normal, i.e.,
‚àö

d

n(b
Œ±2S ‚àí Œ±)‚àí‚Üí N (0, œÉŒ±2 )

with
œÉŒ±2 =

Œ±2 E[Œõi (Œ∏)œÜ(zi0 Œ∏)zi0 ]V (Œ∏ÃÇ)E[zi œÜ(zi0 Œ∏)Œõi (Œ∏)] Œ±2 E[Œõ2i (Œ∏)Œ¶(zi0 Œ∏)(1 ‚àí Œ¶(zi0 Œ∏))]
œÉ2
+
+
E[Œõ2i (Œ∏)]2
E[Œõ2i (Œ∏)]2
E[Œõ2i (Œ∏)]

where
Œõi (Œ∏) = Œ¶(zi0 Œ∏) ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 xi
Proof. See Appendix.
This result is an application of the central limit theorem in the context of twostep estimators, and is useful for our procedure to be readily usable for parametric
inference. An expression for the variance estimator œÉ
bŒ±2 of œÉŒ±2 is given in the Appendix. However, this variance is quite involved and can be difficult to estimate.
In practice, a simpler approach to evaluate the precision of Œ±
b2S and make inference
about the treatment effect Œ± is to use a bootstrap.

Summarizing, the outcome equation requires true participation status, Œ¥ ‚àó ,
which is unobserved to the econometrician. Given the observed participation, Œ¥,
the first step in our estimation procedure amounts to a partial observability probit
16

analysis on the indicator variable Œ¥ using both z and w, which are respectively
the instrumental variables driving true participation and the covariates related to
misreporting. The result of this analysis is an estimator, Œ∏ÃÇ, of Œ∏, the coefficient
of z, which allows constructing a proxy Œ¥ÃÇ ‚àó for truly being a participant. By construction, this proxy is purged from both endogeneity and misreporting, and is
then used in lieu of Œ¥ ‚àó in the outcome equation of interest to derive a consistent
treatment effect estimator. The estimate Œ∏ÃÇ obtained from the first step can then
be used along with the other model estimates to compute a consistent variance
estimator for the treatment effect estimator.

A natural alternative to our two-step procedure is to estimate our model equations jointly via maximum likelihood (ML). Under appropriate assumptions, the
ML procedures yield more efficient estimators and asymptotically correct estimates of standard errors. Unfortunately, in many situations, due to sample size
and other considerations, the ML estimation can be both computationally complex
and costly to implement, which may limit its use. For example, the correlations
between the outcome equation error and the participation and reporting equations
errors, œïu and œïv , might not be strongly identified, resulting in a likelihood function with ridges or multiple local maxima. In addition, in some applications, the
researcher may be reluctant to hypothesize a specific joint distribution between
the random errors of the observed participation and the outcome as is required by
maximum likelihood. In the Appendix, we briefly discuss the ML estimation of
this model under the assumption of joint (trivariate) normality of the errors. In
the same vein, we also briefly discuss how our method can be extended to the case
of binary outcomes.
While this framework focuses on one-sided misreporting (i.e., only false negatives or false positives) which may be more appealing in certain contexts (e.g.,

17

when studying scenarios of participation in risky behavior or activities associated
with stigma), a more general framework should account for misreporting in both
directions (i.e., both false negatives and false positives). In the following section,
we provide Monte Carlo simulations results on the performance of our estimator for both the one-sided case and the case where there is a small amount of
misclassification in the other direction.5

4

Monte Carlo Simulations

This section presents the results of Monte Carlo simulations comparing the proposed two-step estimator (2S) with OLS and IV estimators. Our goal is to consistently estimate Œ±, the (conditional) average treatment effect of participation,
Œ¥ ‚àó , on an outcome, y, given by equation (1). However, since true participation
is unobserved, our task reduces to use the proposed method to estimate Œ± from
equation (6) under the assumption that observed (misclassified) participation, Œ¥,
arises according to the process described by equation (4), which focuses on false
negatives. In the simulations, we also consider a slight departure from equation
(4) and allow for small amounts of false positives as described below.

4.1

Simulation setup

The baseline data generating process is simulated as follows. The true treatment
indicator, Œ¥i‚àó , is given by
Œ¥i‚àó = 1 (Œ∏0 + Œ∏1 zi + vi ‚â• 0) ,

where zi ‚àº N (0, 1),

5

Œ∏0 = 0.1,

Œ∏1 = 1.

Extending this framework to the two-sided endogenous misreporting case is not straightforward. It would require at least two sets of excluded covariates, that is, w1 and w2 , each
associated with one of the misreporting directions, and possibly other additional functional
form/distributional assumptions for identification.

18

The outcome equation yi is given by
yi = Œ≤0 + xi Œ≤1 + Œ¥i‚àó Œ± + i

where xi ‚àº N (0, 1) Œ≤0 = Œ≤1 = 1,

Œ± = ‚àí0.2.

Note that Œ± = ‚àí0.2 is the true population treatment effect we seek to estimate.
The econometrician only observes an error-ridden treatment indicator, Œ¥i , defined by
Œ¥i = Œ¥i‚àó 1 (Œ≥0 + Œ≥1 wi + ui ‚â• c) + (1 ‚àí Œ¥i‚àó )1 (Œ∂i < b) ,
where wi ‚àº N (0, 1), Œ≥0 = 0.01, Œ≥1 = 2, and b ‚àà [0, 1).
The parameter c is the threshold that determines the proportion of false negatives in the sample.6 The disturbance term, Œ∂i , is drawn from a uniform (0, 1)
distribution independently from zi and vi so that the parameter b corresponds to
the rate of false positives. For example, when b = 0 (baseline case), the observed
treatment indicator is given by Œ¥i = Œ¥i‚àó 1 (Œ≥0 + Œ≥1 wi + ui ‚â• c) which only allows
for false negatives as given by equation (4). However, when b > 0, the observed
treatment indicator allows for both false negatives and a (100 √ó b)% rate of false
positives.
The disturbances i , ui and vi are drawn from a trivariate distribution given
by
Ô£´

(i , ui , vi ) ‚àº IID (0, Œ£) ,

2

œÉ
œïu œÉ œï v œÉ
Ô£¨
Ô£¨
where Œ£ = Ô£¨ œïu œÉ 1
œÅ
Ô£≠
œïv œÉ œÅ
1

Ô£∂
Ô£∑
Ô£∑
Ô£∑,
Ô£∏

œÉ = 1.

The baseline results assume joint normality although we consider non-normal distributions as well. The values of the parameters œïv and œïu , which are the correlations of the outcome equation error term with participation and misreporting
6

By appropriately choosing the value of c, one can simulate varying rates of misreporting.

19

equation disturbance terms, respectively, are varied in the simulations to examine
how various degrees of the endogeneity of participation and misreporting with respect to the outcome impact the results. We also allow œÅ, the correlation between
participation and misreporting to vary. We estimate the treatment effect Œ± and
the associated bias using the naive OLS approach, Œ±ÃÇLS and the proposed two-step
approach, Œ±ÃÇ2S . We also estimate the instrumental variable estimators Œ±ÃÇIV 1 and
Œ±ÃÇIV 2 using z and [z, w] as instruments, respectively.

4.2

Simulation Results

We report simulation results averaged over 1000 replications each with sample
size 5000 for different levels of false negatives ‚Äì 0%, 5%, 10%, 20%, 40% ‚Äì for œÅ ‚àà
{0, 0.3}, œïu ‚àà {0, 0.2, 0.8} and œïv ‚àà {‚àí0.3, 0, 0.3}. These results are first
presented for b = 0 (i.e., 0% false positives) and, subsequently, also for b ‚àà
{0.01, 0.05, 0.1} (i.e., 1%, 5% and 10% false positives). Thus, no misreporting
corresponds to the case of 0% false negatives and false positives. The cases of
exogenous participation and exogenous misreporting correspond to œïu = œïv = 0.
Table 1 presents the results of the Monte Carlo simulations for OLS, IVs, and the
proposed two-step (2S) estimators when the errors are jointly normal, the false
positive rate is 0%, and œÅ = 0.3. We report both the OLS estimates using the true
treatment indicator, Œ¥i‚àó (OLS-T) and the observed treatment indicator Œ¥i (OLS-O).
Although Œ¥i‚àó is unobserved to the econometrician, the OLS-T estimates provide a
theoretical benchmark for the estimates obtained using the misclassified Œ¥i . We
also report both the IV estimates using z as an instrument (IV-1) and those using
[z, w] as instruments (IV-2). The proposed estimator is denoted (2S) in the tables.

The naive OLS estimates using Œ¥i (OLS-O) show that, not only is the OLS
estimator inconsistent as asserted in Theorem 1, but also yields the wrong (i.e.,
20

Table 1: Monte Carlo Simulations
False
Negatives

œïu

0

0%

0.2

0.8

0

5%

0.2

0.8

0

10%

0.2

0.8

0

20%

0.2

0.8

0

40%

0.2

0.8

œïv

OLS-T

OLS-O

-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.5
0
0.3
-0.3
0
0.3
-0.3
0
0.3
-0.3
0
0.3

-0.5523
-0.1997
0.1519
-0.5524
-0.2021
0.1508
-0.5507
-0.1994
0.1523
-0.5499
-0.1987
0.1504
-0.5513
-0.2008
0.1513
-0.5506
-0.1993
0.1516
-0.5515
-0.2013
0.1524
-0.5499
-0.1989
0.1518
-0.5513
-0.1986
0.1514
-0.5508
-0.1990
0.1501
-0.5518
-0.2004
0.1498
-0.5511
-0.2015
0.1512
-0.5502
-0.2008
0.1506
-0.5501
-0.2015
0.1507
-0.5509
-0.2005
0.1514

-0.5523
-0.1997
0.1519
-0.5524
-0.2021
0.1508
-0.5507
-0.1994
0.1523
-0.5066
-0.1834
0.1357
-0.4827
-0.1611
0.1615
-0.4072
-0.0844
0.2371
-0.4649
-0.1715
0.1250
-0.4203
-0.1266
0.1677
-0.2916
0.0053
0.2987
-0.4065
-0.1496
0.1050
-0.3421
-0.0858
0.1693
-0.1443
0.1097
0.3680
-0.3161
-0.1198
0.0783
-0.2181
-0.0230
0.1743
0.0675
0.2646
0.4607

IV-1
[x,z]
-0.2006
-0.2014
-0.1951
-0.2036
-0.2011
-0.1983
-0.1991
-0.2003
-0.1985
-0.2041
-0.2018
-0.2069
-0.2061
-0.2063
-0.2054
-0.2044
-0.2039
-0.2036
-0.1949
-0.1936
-0.1922
-0.1960
-0.1942
-0.1952
-0.1953
-0.1936
-0.1937
-0.1674
-0.1681
-0.1690
-0.1733
-0.1690
-0.1730
-0.1690
-0.1675
-0.1709
-0.1215
-0.1219
-0.1210
-0.1160
-0.1213
-0.1191
-0.1207
-0.1189
-0.1211

IV-2
[x,z,w]
-0.2003
-0.2013
-0.1954
-0.2033
-0.2012
-0.1986
-0.1988
-0.2003
-0.1987
-0.2152
-0.2127
-0.2188
-0.2166
-0.2168
-0.2167
-0.2158
-0.2160
-0.2146
-0.2345
-0.2319
-0.2323
-0.2350
-0.2305
-0.2339
-0.2340
-0.2331
-0.2350
-0.2668
-0.2666
-0.2681
-0.2728
-0.2665
-0.2743
-0.2679
-0.2668
-0.2728
-0.3740
-0.3814
-0.3746
-0.3687
-0.3852
-0.3788
-0.3757
-0.3789
-0.3783

2S
-0.1998
-0.2009
-0.1963
-0.2030
-0.1999
-0.1972
-0.1980
-0.1993
-0.1962
-0.1997
-0.1980
-0.2012
-0.2001
-0.2009
-0.2009
-0.2013
-0.2007
-0.2003
-0.2000
-0.1991
-0.1992
-0.2008
-0.1973
-0.1995
-0.1998
-0.1978
-0.2005
-0.1984
-0.1989
-0.2002
-0.2036
-0.1992
-0.2026
-0.1988
-0.1990
-0.2034
-0.1981
-0.2027
-0.1987
-0.1963
-0.2041
-0.2003
-0.1993
-0.2016
-0.2000

The true treatment effect is Œ± = ‚àí0.2. Each calibration in the Monte Carlo Design involved 1000 replications
each of size 5000. We report results for five false negative rates (0%, 5%, 10%, 20%, and 40%) ‚Äì the proportion of
true participants who misreport their status. œïv and œïu are correlations that indicate the extents of endogeneity
of participation and misreporting, respectively. The correlation between participation and misreporting is œÅ = 0.3.
Also, the error terms are jointly normally distributed and the false positive rate is 0%.

positive) sign, whether participation is exogenous or endogenous. Sign switching
is observed at all nonzero false negative rates i.e. 5%, 10%, 20% and 40% and is
21

more pronounced at higher values of œïu . These results persist even under the special case of exogenous misreporting (œïu = 0). The IV estimates (IV-1) and (IV-2)
show that the classic IV estimator is also inconsistent and sometimes worse than
the OLS, albeit keeping the correct (negative) sign.7 Interestingly, (IV-1) shows
expansion biases while (IV-2) shows attenuation biases. This confirms, as we explained in Section 2.3, that we cannot generally sign the bias in the IV estimator
when misreporting is endogenous.

In contrast, the proposed two-step estimator

(2S), presented in the last column of Table 1, yields consistent estimates of the
true treatment effect and by comparison, is superior to both the OLS and IV estimators under both endogenous and exogenous misreporting or participation. In
addition, the proposed estimator remains accurate and performs remarkably well,
even when the rate of false negatives is substantially high in the data. Moreover,
there is no cost in doing our procedure since the proposed estimator remains as
good as the OLS and the IV when there is 0% false negatives and participation is
exogenous (œïv = 0). This performance is not sensitive to the choice of parameters
such as the variance of the outcome equation error or the correlation between the
error terms in the participation and misreporting equations (see, e.g., the results
for œÅ = 0 in the ‚ÄòBaseline‚Äô column of Table 2).

To further assess the robustness of our proposed estimator, we investigate its
sensitivity to misspecification in a number of directions. First, we allow the reported participation to include both false negatives (as before) and a small amount
of false positives. We consider false positive rates of 1%, 5%, and 10%. Second,
we allow for the error terms to be non-normal. We consider both the trivariate
Gamma distribution and the trivariate Chi-squared distribution as alternatives
7

This is actually a better set of simulations for IV-2 because the covariate wi can be used as
an additional instrument to improve the IV. Additional simulations with wi being endogenous
yielded worse results for this IV while the proposed estimator (2S) remained consistent.

22

to allow more skewness and kurtosis in the distributions of error terms.8 Third,
we allow for the misreporting equation to be misspecified by considering the case
where the predictor is unavailable to the researcher (i.e., only x is included) or
by introducing a quadratic term in w in the data generating process but which
is omitted by the researcher in the estimation. Fourth, we introduce correlation
between the predictors of misreporting w and the error terms in both participation
and outcome equations.

Table 2 summarizes the results where œÅ and œïv are fixed to zero (exogenous
participation) and the focus is on the sensitivity to different degrees of endogeneity
of misreporting œïu and various rates of false negatives.9 These results show that at
any false positive rate the bias increases with false negative rates. Interestingly, for
small amounts of false positives, the proposed estimator still performs quite well,
although it gets worse with higher rates of false positives. Specifically, when false
positive rates range from 1% to 5%, the median value of the proposed estimator
(2S) ranges between ‚àí0.2042 and ‚àí0.2180 for all ranges of false negatives in our
setting. The proposed estimator is robust to non-normality of the error terms and
remains consistent when the true error distributions are Gamma or Chi-Squared in
this setting. When the misreporting equation is misspecified by including only the
covariates from the outcome equation (i.e., only x) or when this equation includes
a quadratic term in w that is omitted by the researcher in the estimation, the 2S
estimator still performs well. Finally, the 2S estimator is robust to introducing
correlations between the predictor w and both the outcome and misreporting equation errors. When w is correlated with the outcome equation or the misreporting
equation errors, the 2S estimator remains consistent. However, the 2S estimator
8

These multivariate distributions can be simulated using the Copulas method or the inverse
transformation method as decribed in Gentle (2002)
9
Results for other combinations of parameter values are similar and are available upon request.

23

Table 2: Sensitivity of the Proposed Estimator to Misspecification
Types of Misspecification of Baseline
False

œïu

Baseline

Negatives
0%

5%

10%

20%

40%

0
0.2
0.8
0
0.2
0.8
0
0.2
0.8
0
0.2
0.8
0
0.2
0.8

-0.2000
-0.1970
-0.1981
-0.2041
-0.1974
-0.1989
-0.1987
-0.2001
-0.1983
-0.2018
-0.1989
-0.2003
-0.1961
-0.2000
-0.2009

1%

False Positives
5%

10%

-0.2021
-0.2003
-0.2008
-0.2057
-0.2074
-0.2035
-0.2029
-0.2060
-0.2027
-0.2063
-0.2056
-0.2036
-0.2066
-0.2085
-0.2087

-0.2141
-0.2126
-0.2129
-0.2191
-0.2208
-0.2169
-0.2169
-0.2207
-0.2171
-0.2234
-0.2229
-0.2210
-0.2314
-0.2333
-0.2336

-0.2291
-0.2257
-0.2266
-0.2317
-0.2312
-0.2320
-0.2323
-0.2331
-0.2350
-0.2428
-0.2411
-0.2377
-0.2652
-0.2628
-0.2598

Endogeneity of Predictor
corr(w, )
corr(w, u)
corr(w, v)
= .5
= .5
= .5
0%

5%

10%

20%

40%

0
0.2
0.8
0
0.2
0.8
0
0.2
0.8
0
0.2
0.8
0
0.2
0.8

-0.2000
-0.1970
-0.1981
-0.2041
-0.1974
-0.1989
-0.1987
-0.2001
-0.1983
-0.2018
-0.1989
-0.2003
-0.1961
-0.2000
-0.2009

-0.1975
-0.2008
-0.1995
-0.1988
-0.2012
-0.1985
-0.2017
-0.1972
-0.1991
-0.1954
-0.2008
-0.1988
-0.2003
-0.1974
-0.2004

-0.1975
-0.2008
-0.1995
-0.1988
-0.2013
-0.1984
-0.2018
-0.1973
-0.1992
-0.1954
-0.2008
-0.1989
-0.2004
-0.1974
-0.2000

-0.1738
-0.1765
0.1754
-0.1752
-0.1773
-0.1743
-0.1776
-0.1741
-0.1759
-0.1712
-0.1763
-0.1742
-0.1732
-0.1705
-0.1732

Distribution of errors
Œì(3, 1)
œá2(1)
-0.2047
-0.1971
-0.1967
-0.2077
-0.1935
-0.1957
-0.1972
-0.2007
-0.1955
-0.2013
-0.1966
-0.1970
-0.1873
-0.1977
-0.2004

-0.2110
-0.2077
-0.2090
-0.2059
-0.2094
-0.2082
-0.2051
-0.2042
-0.2057
-0.2037
-0.2064
-0.2073
-0.2058
-0.2107
-0.2104

Omission of Predictor
omitted
omitted‚àó
w
w2
-0.1972
-0.2017
-0.1980
-0.1956
-0.1979
-0.1981
-0.1965
-0.2008
-0.2013
-0.2004
-0.1996
-0.2008
-0.2022
-0.1975
-0.1969

-0.2009
-0.1986
-0.1967
-0.2035
-0.2012
-0.1981
-0.2001
-0.1990
-0.2009
-0.1981
-0.1997
-0.1990
-0.2027
-0.2025
-0.2037

The true treatment effect is Œ± = ‚àí0.2. We fix œÅ = œïv = 0. Each calibration in the Monte Carlo Design involved
1000 replications each of size 5000. We report results for five false negatives rates (0%, 5%, 10%, 20%, and 40%)
and false positive rates of (0%, 1%, 5%, and 10%). The correlation œïu indicates the extent of endogeneity of
misreporting.
‚àó Here, the true misreporting equation includes both w and w 2 , but the estimation omits w 2 .

performs poorly, exhibiting an attenuation bias just like the IV-1, when w and the
participation equation error are correlated. Our recommendation is to access w
and z from different data sources to minimize the chances of having w endogenous
to true participation in practice.
There are a few additional facts that are worth mentioning. On the one hand,
it is not surprising that the OLS estimator only works well when there are 0%
24

false negatives and participation is exogenous (œïv = 0). On the other hand, the
IV estimator tends to work well for low levels of false negatives (0% - 5%) but
gets worse for higher false negative rates (10% and higher). As explained earlier,
the sign-reversal regions for the OLS depends on the quantity A/(B ‚àí C) (given
in Theorem 1), which varies with œïv , œïu , œÉ, and the extent of misclassification.
Even when participation is exogenous (i.e. œïv = 0), various degrees of endogeneity
of misreporting (e.g., œïu ‚àà {‚àí0.8, ‚àí0.2, 0, 0.2, 0.8, }), various sizes of the error
variance (e.g., œÉ ‚àà {1, 4}), and various rates of false negatives (e.g., 5%, 10%,
40%) yield different sign-switching regions for the OLS, as shown in Table 3.
Table 3: Intervals of Œ± yielding sign-switching in the OLS
False
Negatives

5%

10%

40%

Sign-switching region

œïu

œÉ=1
[0, 0.2307]
[0, 0.0577]
‚àÖ
[‚àí0.0577, 0]
[‚àí0.2307, 0]
[0, 0.4054]
[0, 0.1033]
‚àÖ
[-0.1033, 0]
[-0.4054, 0]
[0, 1.1347]
[0, 0.3399]
‚àÖ
[-0.3399, 0]
[-1.1347, 0]

-0.8
-0.2
0
0.2
0.8
-0.8
-0.2
0
0.2
0.8
-0.8
-0.2
0
0.2
0.8

œÉ=4
[0, 0.9227]
[0, 0.2309]
‚àÖ
[‚àí0.2309, 0]
[‚àí0.9227, 0]
[0, 1.6216]
[0, 0.8368]
‚àÖ
[-0.8368, 0]
[-1.6216, 0]
[0, 5.3786]
[0, 1.3597]
‚àÖ
[-1.3597, 0]
[-5.3786, 0]

Results are reported for three false negatives rates (5%, 10%, and 40%). The correlation
œïu indicates the extent of endogeneity of misreporting; œïv and œÅ are fixed to 0.

Table 3 shows the ranges of the true treatment effects Œ± for which the OLS
estimator Œ±ÃÇLS would yield the wrong (opposite) signs in our simulation design.
For example, negative correlations between misreporting and outcome errors yield
positive intervals of the treatment effect for which the OLS takes the wrong (negative) sign, while positive correlations between misreporting and outcome errors
yield negative intervals of the true treatment effect for which the OLS takes the
25

wrong (positive) sign. In all cases, higher levels of endogeneity of misreporting,
higher rates of false positives or greater error variance in the outcome equation
yield wider sign-reversal intervals. It is only when misreporting is also exogenous
(œïu = 0) that the OLS keeps the same sign as the true treatment effect (albeit
still biased), so that the sign-switching set is empty (see Table 3).
Finally, Lewbel (2007)‚Äôs estimator also worked well in our setting for the special
cases where both participation and misreporting where exogenous. However, Lewbel‚Äôs estimator displayed large biases and sign reversals under some endogeneity
cases, which is not surprising since this limitation is clearly emphasized in Lewbel
(2007). These additional results are available from the authors upon request.10

5

Empirical Example

We illustrate our proposed method with an empirical example examining the impact of SNAP on adult body mass index (BMI).11 A major difficulty in estimating
SNAP‚Äôs impacts is the high reporting error rates in national surveys, with false
negatives being more prevalent than false positives. For instance, using linked administrative and survey data, Meyer, Goerge & Mittag (2015) find that 23%, 35%,
and 50% of true recipients in the 2001 and 2005 panels of the Survey of Income
and Program Participation (SIPP), the 2001 American Community Survey (ACS),
and the 2002-2005 CPS Annual Social and Economic Supplement (March CPS)
did not report receipt, respectively. However, they find that the corresponding
false positive error rates are less than 1.5%.
We consider a simple treatment effects model relating BMI to a binary indicator
10

It is easy to slightly modify our set up to include the IV required by Lewbel‚Äôs identification
strategy. For that purpose, one can add a binary indicator in the true participation equation,
since, as explained by Lewbel (2007), only two points of support are needed for the instrument
to identify the treatment effect in the case of one-sided misreporting.
11
BMI is defined as weight in kilograms divided by height in meters squared.

26

of SNAP participation. Since SNAP participation is not randomly assigned and
possibly misreported, OLS and IV estimates are biased and inconsistent for the
average treatment effect.12 We present estimates of SNAP‚Äôs effect on BMI using
OLS, IV, and our proposed two-step (2S) estimators using the 1996-2004 waves of
female respondents of the restricted-use National Longitudinal Survey of Youth 1979 (NLSY79).13
As discussed in Section 3, estimation of our 2S estimator proceeds in two steps.
We first estimate a partial observability probit model described in equation (4) to
obtain the parameters of our true participation and misreporting equations. The
second step uses the predicted probabilities of true participation to estimate the
effect of SNAP on BMI from equation (13).
To implement the 2S estimator, two sets of covariates need to be distinguished:
instruments for participation (zi in equation (2)) and predictors of misreporting
(wi in equation (3)). Regarding zi , the excluded instruments for participation are
whether the respondent‚Äôs state uses a biometric identification technology (‚ÄúBiometric‚Äù) and the percentage of SNAP benefits issued by the state via Electronic
Benefit Cards (‚ÄúEBT Card‚Äù) (Meyerhoefer & Pylypchuk 2008). As for wi , we take
the set of regressors in the outcome equation augmented with both the biometric
identification technology mentioned above (‚ÄúBiometric‚Äù) as well as a binary indicator for whether the interview was conducted by telephone or in person (‚ÄúPhone
Interview‚Äù). Intuitively, the latter captures variations in interview mode while the
former could increase stigma, both of which might be correlated with misreport12

See Gundersen (2015) for a review of the literature on the SNAP-obesity relationship.
We restrict our analysis sample to females who are within 250% of the federal poverty line.
Determining true SNAP eligibility status is almost impossible with most national surveys due
to the lack of a comprehensible set of variables needed to determine each respondent‚Äôs true
eligibility. Thus, we follow the existing literature and use 250% of the federal poverty line to
determine our eligible sample. This type of sample restriction is common in the literature which
also favors thresholds higher than the gross-income eligibility threshold of 130% (Meyerhoefer &
Pylypchuk 2008, Mykerezi & Mills 2010, Almada, McCarthy & Tchernis 2016).
13

27

Table 4: Summary Statistics By SNAP Participation Status

Body Mass Index
Age
Hispanic
Black
Household (HH) Size
WIC
SSI
AFDC
Mother‚Äôs Education (High school or higher)
Number of children
Household with child <5
Gross Income SNAP Eligible HH (130% FPL)
Biometric
EBT card
Phone Interview
Net Family Income (2004 Thousand Dollars)
Observations

Non-SNAP
Mean
Std
28.11
(0.25)
38.96
(0.09)
0.08
(0.01)
0.21
(0.03)
3.45
(0.06)
0.06
(0.00)
0.06
(0.01)
0.02
(0.00)
0.52
(0.02)
1.81
(0.05)
0.14
(0.01)
0.39
(0.02)
0.16
(0.02)
0.62
(0.02)
0.36
(0.01)
22.04 (0.506)
4307

SNAP
Mean
Std
29.85
(0.52)
38.29
(0.21)
0.11
(0.02)
0.38
(0.04)
3.77
(0.09)
0.21
(0.02)
0.26
(0.02)
0.45
(0.03)
0.43
(0.04)
2.23
(0.08)
0.22
(0.02)
0.86
(0.01)
0.23
(0.04)
0.55
(0.03)
0.25
(0.02)
12.644 (0.364)
1163

Standard deviations in parentheses are adjusted for the complex survey design of the
NLSY79. Based on the 1996-2004 biennial waves of the NLSY79, restricted to females
with income lower than 250% of the federal poverty line.

ing, in addition to personal characteristics.14 Notice that the vectors zi and wi are
different albeit overlapping, as required by the theory.
The summary statistics in Table 4 by SNAP participation status suggest that
participants are largely negatively selected in the program. In Table 5, we report
two sets of regression estimates for the OLS, IV and 2S. The first set of results
uses five covariates (Age, Black, Hispanic, Household size, Family income) and only
Biometric as instrument. The second set uses eleven covariates (adding Number
of children, Mother‚Äôs education, participation in WIC, AFDC/TANF and SSI,
Household with child) and Biometric EBT Card as instruments. The estimates
from these methods yield different and sometimes opposite (in sign) results.
The OLS estimator suggests a positive and statistically significant effect of
14

We also include in wi a dummy for being eligible for SNAP based on the Gross Income test
(130% of the federal poverty level). We thank an anonymous referee for pointing these issues
out.

28

Table 5: The Impact of SNAP on BMI

Variable

Set of Covariates

Dependent Variable: BMI
OLS
IV
2S

First Set

0.929**
(0.379)

-10.62
(12.61)

-3.093*
(1.804)

Second Set

1.006**
(0.432)

-0.576
(7.849)

-3.187**
(1.538)

SNAP Participation

Standard errors in parenthesis and bootstrapped (500 replications) for the 2S estimator.
Results are based on the 1996-2004 biennial waves of the NLSY79, restricted to females
with income lower than 250% of the federal poverty line. For the First Set, regressors
not reported include respondents‚Äô age, race, household size, household income). For the
Second Set, additional regressors are number of children, mothers education, square of
income, time fixed effects, and indicators for receiving WIC benefits, AFDC/TANF, SSI
benefits, and having an infant living in home.
‚àóp < 0.10, ‚àó ‚àó p < 0.05, ‚àó ‚àó ‚àóp < 0.010.

SNAP participation on BMI of about 0.929 BMI units for the first set and 1.006
BMI units for the second set. The IV estimator which uses Biometric as instrument
suggests a 10.62 decrease in BMI units, while the one that uses Biometric and
EBT Card as instruments shows only a 0.576 decrease in BMI units, although not
statistically significant.15 In contrast, our proposed estimator yields a negative and
statistically significant effect of ‚àí3.093 for the First Set and ‚àí3.187 for the Second
Set scenarios. These results show that while the OLS and the 2S estimators are
stable, significant and of opposite signs, the IV estimator is unstable and varies
substantially with the instruments as our simulations suggested earlier.16 This
empirical illustration is undoubtedly limited and the results should be interpreted
with caution since they are only suggestive. For instance, even if our proposed
15

See Table C2 in Appendix C for the first stage IV results.
Table C1 in Appendix C presents the results of the first step of the 2S estimator. Panel A of
Table C1 shows both instruments have the expected signs but only ‚ÄúEBT Card‚Äù is statistically
significantly correlated with true participation. Also, Panel B of Table C1 suggests that being
interviewed by phone is negatively correlated with the the probability of truthful reporting of
participation.
16

29

method estimates Œ± consistently, it may not represent a causal effect of SNAP on
obesity due to possible confounding by omitted variables in this application.
Subject to these caveats, the empirical example corroborates the simulation
results obtained in Section 4: (i) there is a possible sign reversal between the OLS
and the 2S estimates; (ii) the IV and the 2S estimators have the same sign but the
IV has a smaller or a larger magnitude.17 In addition, the results obtained from
these methods could lead to radically different and possibly contradictory policy
advice.

6

Conclusion

This paper examines the identification and estimation of the conditional average
treatment effect of a binary regressor in the presence of endogenous misreporting and possibly endogenous participation. We derive and prove the consistency
and asymptotic normality of our proposed two-step estimator and show that OLS
and IV estimators are inconsistent and may yield wrong (opposite) signs from the
true effect. We also provide Monte Carlo simulations to this effect, and illustrate
our method with an empirical example examining the impact of SNAP participation on obesity. Previous studies on misclassified binary regressors are mostly
concerned with exogenous or random misreporting (Aigner 1973, Brachet 2008,
Lewbel 2007, Mahajan 2006, Frazis & Loewenstein 2003), where it is commonly
assumed that misclassification probabilities depend only on the true treatment
status and are thus, independent of measurement errors and other regressors. Our
two-step estimator relaxes this arguably strong assumption and shows that, when
the researcher has access to information related to why individuals misreport, the
17

Note that the sign reversal phenomenon obtained in this empirical illustration is neither a
general result nor does its nonoccurrence invalidate the results herein. See Section 2.2 for further
discussions.

30

treatment effect can be consistently estimated.
To our knowledge, this paper is the first attempt to provide point estimates of
treatment effect in the context of endogenous misreporting of a binary treatment
variable. This is important because of the prevalence of misreporting in public
programs and survey data (Meyer et al. 2009, Bollinger 1996, Kane & Rouse 1995,
Kane et al. 1999, Brachet 2008). While this paper focused on one-sided endogenous
misreporting when participation is possibly endogenous, future work should allow
for bidirectional misreporting (i.e., false negatives and false positives). It would
also be useful to show the level of dependence of our approach on distributional
and functional form assumptions by considering parametric or semi-parametric
estimation approaches.

Appendix A
A.1

Proofs

Proof of Theorem 1

Proof.
Biasedness: By the Frisch-Waugh-Lovell Theorem, see, e.g. Davidson & MacKinnon (2004, page 68), the regression
M y = M Œ¥Œ± + v
yields the same least squares estimate of Œ± as the regression equation of interest
(8). It follows that,
Œ±
bLS = (Œ¥ 0 M Œ¥)‚àí1 Œ¥ 0 M y.

(15)

This implies that Œ±
bLS ‚àí Œ± = (Œ¥ 0 M Œ¥)‚àí1 Œ¥ 0 M Œµ.
Hence, E[b
Œ±LS ‚àí Œ±|X, Œ¥] = (Œ¥ 0 M Œ¥)‚àí1 Œ¥ 0 M E[Œµ|X, Œ¥] 6= 0, since E[Œµ|Œ¥, X] 6= 0 by
the correlation of Œµ and Œ¥ through u and v.
31

Inconsistency: We can write
Œ¥0M Œ¥
n

‚àí1

Œ¥0M Œµ
Œ±
bLS ‚àí Œ± = (Œ¥ M Œ¥) Œ¥ M  =
n
‚àí1  0

 0
Œ¥ M  Œ¥ 0 M (Œ¥ ‚àó ‚àí Œ¥)Œ±
Œ¥ MŒ¥
+
=
n
n
n
0

‚àí1 0



by Equation (7) (16)

Notice that,
Œ¥0M Œ¥
Œ¥ 0 [I ‚àí X(X 0 X)‚àí1 X 0 ]Œ¥
Œ¥0Œ¥ Œ¥0X
=
=
‚àí
n
n
n
n



X 0X
n

‚àí1

X 0Œ¥
n

Hence, by the Weak Law of Large Numbers and the Slutsky‚Äôs lemma, we have
Œ¥0M Œ¥ p
‚àí‚Üí E(Œ¥i2 ) ‚àí E(Œ¥i x0i )E(xi x0i )‚àí1 E(Œ¥i xi )
n
By a matrix extension of the Cauchy-Schwarz inequality (see Tripathi 1999), we
know that E(Œ¥i2 )‚àíE(Œ¥i x0i )E(xi x0i )‚àí1 E(Œ¥i xi ) > 0. The Continuous Mapping Theorem
then implies that


Œ¥0M Œ¥
n

Likewise, the term

‚àí1

‚àí1
p 
‚àí‚Üí E(Œ¥i2 ) ‚àí E(Œ¥i x0i )E(xi x0i )‚àí1 E(Œ¥i xi )
.

Œ¥0M 
can also be decomposed as
n

Œ¥0M 
Œ¥ 0 [I ‚àí X(X 0 X)‚àí1 X 0 ]
Œ¥0 Œ¥0X
=
=
‚àí
n
n
n
n



X 0X
n

‚àí1

X 0
.
n

Then, using the same arguments as above we have
Œ¥0M  p
‚àí‚Üí E(Œ¥i i ) ‚àí E(Œ¥i x0i )E(xi x0i )‚àí1 E(xi i ) = E(Œ¥i i ),
n

32

(17)

where the last equality follows from Assumption 1.
Using the expression of Œ¥i given by Equation (4) and the trivariate normality
of (i , ui , vi ), it can be shown by integration that
E[Œ¥i i ] = E [i 1 (zi0 Œ∏ + vi ‚â• 0,

wi0 Œ≥ + ui ‚â• 0)]

= E [Pr[ui ‚â• ‚àíwi0 Œ≥, vi ‚â• ‚àízi0 Œ∏, œÅ]E [i |ui ‚â• ‚àíwi0 Œ≥, vi ‚â• ‚àízi0 Œ∏]]

 0

 0

zi Œ∏ ‚àí œÅwi0 Œ≥
wi Œ≥ ‚àí œÅzi0 Œ∏
0
0
= E œÉœïv œÜ (‚àízi Œ∏) Œ¶ p
+ œÉœïu œÜ (‚àíwi Œ≥) Œ¶ p
,
1 ‚àí œÅ2
1 ‚àí œÅ2
where Œ¶(¬∑) and œÜ(¬∑) are the CDF and PDF of the standard normal. It follows that

 0


 0
zi Œ∏ ‚àí œÅwi0 Œ≥
Œ¥0M  p
wi Œ≥ ‚àí œÅzi0 Œ∏
0
0
‚àí‚Üí E œÉœïv œÜ (‚àízi Œ∏) Œ¶ p
+ œÉœïu œÜ (‚àíwi Œ≥) Œ¶ p
. (18)
n
1 ‚àí œÅ2
1 ‚àí œÅ2
Finally, using the same reasoning as above for the term

Œ¥ 0 M (Œ¥ ‚àó ‚àí Œ¥)Œ±
, we have
n

Œ¥ 0 M (Œ¥ ‚àó ‚àí Œ¥)Œ± p
‚àí‚Üí ‚àí Œ±E(Œ¥i x0i )E(xi x0i )‚àí1 E[(Œ¥i‚àó ‚àí Œ¥i )xi ].
n

(19)

The desired result follows by taking (19), (18) and (17) to Equation (16).

A.2

Proof of Theorem 2

Proof. We can write
0

0

0

0

Œ±
b2S = (Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó )‚àí1 Œ¥ÃÇ ‚àó M Œ¥ ‚àó Œ± + (Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó )‚àí1 Œ¥ÃÇ ‚àó M 

(20)

By the exogeneity of X and Z given by Assumption 1, the consistency of Œ∏ÃÇ,

33

the continuity of Œ¶(¬∑) and the law of large numbers, we have
0

Œ¥ÃÇ ‚àó M  p
‚àí‚Üí E[Œ¶(zi0 Œ∏)i ] = E [Œ¶(zi0 Œ∏)E[i |zi ]] = 0,
n
so that the second term on the RHS of Equation (20) goes to zero. We also have,
by Assumption 2, the consistency of Œ∏ÃÇ, the continuity of Œ¶(¬∑) and the the law of
large numbers,
0



Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó p
‚àí‚Üí E Œ¶(zi0 Œ∏)2 ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 E [xi Œ¶(zi0 Œ∏)]
n
and
0

Œ¥ÃÇ ‚àó M Œ¥ ‚àó
p
‚àí‚Üí
n
=
=

E [Œ¶(zi0 Œ∏)Œ¥i‚àó ] ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 E [xi Œ¥i‚àó ]
E [Œ¶(zi0 Œ∏)E[Œ¥i‚àó |zi ]] ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 E [xi E[Œ¥i‚àó |zi ]]


E Œ¶(zi0 Œ∏)2 ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 E [xi Œ¶(zi0 Œ∏)]

where the last display follows from the fact that E[Œ¥i‚àó |zi ] = Œ¶(zi0 Œ∏), as implied by
Equation (2). Hence,
0

‚àó0

‚àó ‚àí1 ‚àó0

‚àó

(Œ¥ÃÇ M Œ¥ÃÇ ) Œ¥ÃÇ M Œ¥ =

Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó
n

so that
p

Œ±
b2S ‚àí‚Üí Œ±

34

!‚àí1

0

Œ¥ÃÇ ‚àó M Œ¥ ‚àó p
‚àí‚Üí 1
n

A.3

Proof of Theorem 3

Proof. We can write
‚àö

0

n(b
Œ±2S ‚àí Œ±) =

Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó
n
‚àó0

=

Œ¥ÃÇ M Œ¥ÃÇ
n

= qn‚àí1

‚àö

‚àó

!‚àí1

!‚àí1

nV1n Œ± +

0

Œ¥ÃÇ ‚àó M (Œ¥ ‚àó ‚àí Œ¥ÃÇ ‚àó )
‚àö
n
‚àó0

‚àó

‚àó

!

Œ¥ÃÇ M (Œ® ‚àí Œ¥ÃÇ )
‚àö
n
‚àö

nV2n

0

Œ±+
!

Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó
n
‚àó0

Œ±+

Œ¥ÃÇ M Œ¥ÃÇ
n

!‚àí1

Œ¥ÃÇ ‚àó M 
‚àö
n

!‚àí1

Œ¥ÃÇ ‚àó M (Œ±(Œ¥ ‚àó ‚àí Œ®‚àó ) + )
‚àö
n

‚àó

0

0



(21)

where
0

Œ¥ÃÇ ‚àó M Œ¥ÃÇ ‚àó
qn =
,
n

0

V1n

Œ¥ÃÇ ‚àó M (Œ®‚àó ‚àí Œ¥ÃÇ ‚àó )
=
,
n

0

and V2n

Œ¥ÃÇ ‚àó M (Œ±(Œ¥ ‚àó ‚àí Œ®‚àó ) + )
=
,
n

with Œ®‚àó = Œ®‚àó (Œ∏) = [Œ¶(z10 Œ∏), . . . , Œ¶(zn0 Œ∏)]0 .


‚àí1
1 Pn ‚àó 0
1 Pn
‚àó
0
Denote ŒõÃÇi = Œ¥ÃÇi ‚àí
Œ¥ÃÇ x
xi xi
xi and by Œõi = Œ¶(zi0 Œ∏) ‚àí
n i=1 i i
n i=1
1 Pn
2
E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 xi its probability limit. Notice that qn =
i=1 ŒõÃÇi . We
n
know, from the consistency results above that


p
qn ‚àí‚Üí q = E Œ¶(zi0 Œ∏)2 ‚àí E [Œ¶(zi0 Œ∏)x0i ] E[xi x0i ]‚àí1 E [Œ¶(zi0 Œ∏)xi ] = E[Œõ2i ].

(22)

Since Œ¥ÃÇ ‚àó = Œ®‚àó (Œ∏ÃÇ), then expanding Œ®‚àó (Œ∏) in a Taylor series about Œ∏ÃÇ, we have
a

Œ®‚àó ‚àí Œ¥ÃÇ ‚àó = œà ‚àó (Œ∏ÃÇ)(Œ∏ ‚àí Œ∏ÃÇ)
a

where ‚Äú=‚Äù denotes asymptotic equivalence in probability, and œà ‚àó (Œ∏) is the vector

35

of partial derivatives ‚àÇŒ®‚àó (Œ∏)/‚àÇŒ∏0 is given by
‚àÇŒ®‚àó (Œ∏)
= [œÜ(z10 Œ∏)z1 , . . . , œÜ(zn0 Œ∏)zn )]0 .
0
‚àÇŒ∏

œà ‚àó (Œ∏) =
Therefore
‚àö

n

0

a

nV1n =

‚àö
Œ¥ÃÇ ‚àó M œà ‚àó (Œ∏ÃÇ) ‚àö
1X
n(Œ∏ ‚àí Œ∏ÃÇ) =
ŒõÃÇi œÜ(zi0 Œ∏ÃÇ)zi0 n(Œ∏ ‚àí Œ∏ÃÇ).
n
n i=1

A direct application of the central limit theorem then gives,
‚àö

d

nV1n Œ±‚àí‚Üí N (0, Œ±2 ŒΩ12 ),

where

ŒΩ12 = E[Œõi œÜ(zi0 Œ∏)zi0 ]V (Œ∏ÃÇ)E[zi œÜ(zi0 Œ∏)Œõi ].

(23)

Likewise,
‚àö

n

0

nV2n

Œ¥ÃÇ ‚àó M (Œ±(Œ¥ ‚àó ‚àí Œ®‚àó ) + )
1 X
‚àö
=
=‚àö
ŒõÃÇi Œ∂i
n
n i=1

where Œ∂i = Œ±(Œ¥i‚àó ‚àí Œ¶(zi0 Œ∏)) + i , with E[Œ∂i |zi ] = 0 and Var[Œ∂i |zi ] = Œ±2 Œ¶(zi0 Œ∏)(1 ‚àí
Œ¶(zi0 Œ∏)) + œÉ 2 .
Hence, by the central limit theorem,
‚àö

d

nV2n ‚àí‚Üí N (0, œÉ22 ),

where


œÉ22 = E[Œõi Œ±2 Œ¶(zi0 Œ∏)(1 ‚àí Œ¶(zi0 Œ∏)) + œÉ 2 Œõi ]

(24)

= Œ±2 E[Œõ2i Œ¶(zi0 Œ∏)(1 ‚àí Œ¶(zi0 Œ∏))] + œÉ 2 E[Œõ2i ]
Finally, the asymptotic covariance term between the elements of

36

‚àö

nV1n Œ± and

‚àö

nV2n is
œÉ12 = E[Œõi œÜ(zi0 Œ∏)zi0 ]E[(Œ∏ ‚àí Œ∏ÃÇ) (Œ±(Œ¥i‚àó ‚àí Œ¶(zi0 Œ∏)) + i )]E[Œõi ]Œ±

(25)

= ‚àíE[Œõi œÜ(zi0 Œ∏)zi0 ]E[Œ∏ÃÇi ]E[Œõi ]Œ±
It then follows from Slutsky‚Äôs Lemma, (21), (22), (23), (24) and (25) that
‚àö
d
n(b
Œ±2S ‚àí Œ±)‚àí‚Üí N (0, œÉŒ±2 ),

where

Œ±2 ŒΩ12
œÉ12 œÉ22
+
2
+ 2
q2
q2
q
2
0
0
Œ±E[Œõi œÜ(zi0 Œ∏)zi0 ]E[Œ∏ÃÇi ]E[Œõi ]
Œ± E[Œõi œÜ(zi Œ∏)zi ]V (Œ∏ÃÇ)E[zi œÜ(zi0 Œ∏)Œõi ]
‚àí2
=
E[Œõ2i ]2
E[Œõ2i ]2
Œ±2 E[Œõ2i Œ¶(zi0 Œ∏)(1 ‚àí Œ¶(zi0 Œ∏))]
œÉ2
+
+
.
E[Œõ2i ]2
E[Œõ2i ]

œÉŒ±2 =

With Œ∏ÃÇ and i uncorrelated conditionally on zi and wi the covariance term is zero,
and the variance reduces to
œÉŒ±2 =

Œ±2 E[Œõi œÜ(zi0 Œ∏)zi0 ]V (Œ∏ÃÇ)E[zi œÜ(zi0 Œ∏)Œõi ] Œ±2 E[Œõ2i Œ¶(zi0 Œ∏)(1 ‚àí Œ¶(zi0 Œ∏))]
œÉ2
+
+
E[Œõ2i ]2
E[Œõ2i ]2
E[Œõ2i ]

A consistent estimator for this asymptotic variance can be defined by
œÉÃÇŒ±2 =
where
ŒΩÃÇ12 =

2
2
Œ±ÃÇ2S
ŒΩÃÇ12 Œ±ÃÇ2S
ŒΩÃÇ22 œÉÃÇ 2
+
+
qÃÇ 2
qÃÇ 2
qÃÇ

n
1 Xb
Œõi œÜ(zi0 Œ∏ÃÇ)zi0
n i=1

ŒΩÃÇ22

!
Vb (Œ∏ÃÇ)

n
1X
bi
zi œÜ(zi0 Œ∏ÃÇ)Œõ
n i=1

n


1X 2
=
ŒõÃÇi Œ¶(zi0 Œ∏ÃÇ) 1 ‚àí Œ¶(zi0 Œ∏ÃÇ) ,
n i=1

37

!
,


2


1X 
0
0
2
0
0
œÉÃÇ =
yi ‚àí xi Œ≤ÃÇ ‚àí Œ±ÃÇ2S Œ¶(zi Œ∏ÃÇ) ‚àí Œ±ÃÇ2S Œ¶(zi Œ∏ÃÇ) 1 ‚àí Œ¶(zi Œ∏ÃÇ) ,
n i
2

n

n

n

1X
1X
1X 2
Œ¶(zi0 Œ∏ÃÇ)2 ‚àí
Œ¶(zi0 Œ∏ÃÇ)x0i
ŒõÃÇi =
qÃÇ =
n i=1
n i=1
n i=1

!

n

1X
xi x0i
n i=1

!‚àí1

!
n
1X
xi Œ¶(zi0 Œ∏ÃÇ) ,
n i=1

and Œ±ÃÇ2S is our proposed estimator of Œ±.

Appendix B
B.1

Extensions

Maximum Likelihood Estimation

Let Assumptions 1-4 hold and assume that the covariance matrix of the joint
distribution of errors Œ£ defined in (5) is positive definite. Then our model can be
estimated jointly using full information maximum likelihood. The log-likelihood
function is built from the joint density of yi , Œ¥i‚àó and di , which we write as the
product of the conditional and the marginal densities
f (Œ¥i‚àó , di , yi ) = f (Œ¥i‚àó , di |yi )f (yi ).
To derive the conditional distributions, we use results for the trivariate normal,
and write
vi = œÅ1 i /œÉ + œÅ2 ui + Œ∑i ,

with Œ∑i |i , ui ‚àº N (0, Œ∫2 )

where œÅ1 , œÅ2 and Œ∫2 are defined in terms of the original parameters œïv , œïu and œÅ
by:18
œÅ1 =

œïv ‚àí œÅœïu
,
1 ‚àí œï2u

œÅ2 =

œÅ ‚àí œïv œïu
,
1 ‚àí œï2u

18

Œ∫2 = 1 ‚àí œÅ21 ‚àí œÅ22 ‚àí 2œÅ1 œÅ2 œïu

The fact that the covariance matrix of the joint distribution of errors is constrained to be
positive definite guarantees that these new parameters are well-defined, namely, 0 < œÅ1 < 1,
0 < œÅ2 < 1, and Œ∫2 > 0.

38

Denote Œò = (Œ∏0 , Œ≥ 0 , œÅ, œïu , œïv , Œ≤ 0 , Œ±, œÉ 2 )0 the vector of all the parameters of the
model. Then,
!
0
0
Œ≤)/œÉ
Œ∏
+
œÅ
(y
‚àí
Œ±
‚àí
x
z
œÅ
1
i
2
i
i
p
Œ•11i (Œò) = f (Œ¥i‚àó = 1, di = 1|yi ) = Œ¶2
, wi0 Œ≥, p 2
2
2
œÅ2 + Œ∫
œÅ2 + Œ∫2
!
zi0 Œ∏ + œÅ1 (yi ‚àí Œ± ‚àí x0i Œ≤)/œÉ
‚àó
p
‚àí Œ•11i (Œò)
Œ•10i (Œò) = f (Œ¥i = 1, di = 0|yi ) = Œ¶
œÅ22 + Œ∫2
!
0
0
z
Œ∏
+
œÅ
(y
‚àí
x
Œ≤)/œÉ
i
i
p1 i
Œ•0i (Œò) = f (Œ¥i‚àó = 0|yi ) = 1 ‚àí Œ¶
= 1 ‚àí Œ•11i (Œò) ‚àí Œ•10i (Œò)
2
2
œÅ2 + Œ∫
where Œ¶2 (¬∑, ¬∑, ¬∑) is the CDF of the standard bivariate normal distribution.
The full information log-likelihood function of the model is then defined by

l(Œò) =

n
X

li (Œò),

i=1

with



1
yi ‚àí Œ± ‚àí x0i Œ≤
li (Œò) = Œ¥i ln Œ•11i (Œò) œÜ
+
œÉ
œÉ




 (26)
yi ‚àí Œ± ‚àí x0i Œ≤
yi ‚àí x0i Œ≤
1
1
+ (1 ‚àí Œ¥i ) ln Œ•10i (Œò) œÜ
+ Œ•0i (Œò) œÜ
œÉ
œÉ
œÉ
œÉ
Maximizing this function with respect to Œò yields a consistent and asymptotically
efficient estimator of the model parameters.

B.2

Extension to Binary Outcomes

The method discussed in this paper can be extended to the case of binary outcomes. However, in this case we can not just do the plug-in method described
earlier, because a linear probability model would exhibit serious problems, especially the fact that it could produce a wrong sign for the treatment effect, even if

39

the treatment status is correctly classified (see, e.g., discussion provided by Lewbel, Dong & Yang 2012). A more reliable alternative in this case would be the
maximum likelihood estimation. We assume the binary outcome yi is related to
the exogenous covariates xi and to the true treatment indicator Œ¥i‚àó by
yi = 1 [x0i Œ≤ + Œ¥i‚àó Œ± + i > 0] .

(27)

True participation Œ¥i‚àó and misreporting di are defined, as before, by equations
(2) and (3), respectively. We maintain Assumptions 1-4 above, except that the
conditional variance of the error i is now normalized to 1 (as is usually the case
for identification in Probit models). Given the observed participation Œ¥i = Œ¥i‚àó di ,
and the outcome yi , the log-likelihood function of the binary choice model (BCM)
is built up from the joint probabilities Pr[yi , Œ¥i‚àó , di ] of these dichotomous variables
as follows.
lBCM (Œò) =

n
X

Œ¥i ln Pr[yi , Œ¥i‚àó = 1, di = 1]+
(28)

i=1

+ (1 ‚àí Œ¥i ) ln (Pr[yi , Œ¥i‚àó = 1, di = 0] + Pr[yi , Œ¥i‚àó = 0])
where
Pr[yi , Œ¥i‚àó = 1, di = 1] = Pr[yi = 1, Œ¥i‚àó = 1, di = 1]yi Pr[yi = 0, Œ¥i‚àó = 1, di = 1]1‚àíyi ,
Pr[yi , Œ¥i‚àó = 1, di = 0] = Pr[yi = 1, Œ¥i‚àó = 1, di = 0]yi Pr[yi = 0, Œ¥i‚àó = 1, di = 0]1‚àíyi ,
and

Pr[yi , Œ¥i‚àó = 0] = Pr[yi = 1, Œ¥i‚àó = 0]yi Pr[yi = 0, Œ¥i‚àó = 0]1‚àíyi

The probabilities in these equations can be obtained in terms of model parameters:
Pr[yi = 1, Œ¥i‚àó = 1, di = 1] = Œ¶3 (x0i Œ≤ + Œ±, zi0 Œ∏, wi0 Œ≥; œïv , œïu , œÅ)

40

Pr[yi = 0, Œ¥i‚àó = 1, di = 1] = Œ¶2 (zi0 Œ∏, wi0 Œ≥; œÅ) ‚àí Pr[yi = 1, Œ¥i‚àó = 1, di = 1]
Pr[yi = 1, Œ¥i‚àó = 1, di = 0] = Œ¶2 (x0i Œ≤ + Œ±, wi0 Œ≥; œïv ) ‚àí Pr[yi = 1, Œ¥i‚àó = 1, di = 1]
Pr[yi = 0, Œ¥i‚àó = 1, di = 0] = Œ¶ (zi0 Œ∏) ‚àí Œ¶2 (zi0 Œ∏, wi0 Œ≥; œÅ) ‚àí Pr[yi = 1, Œ¥i‚àó = 1, di = 0]
Pr[yi = 1, Œ¥i‚àó = 0] = Œ¶ (x0i Œ≤) ‚àí Œ¶2 (x0i Œ≤, zi0 Œ∏; œïv )
Pr[yi = 0, Œ¥i‚àó = 0] = 1 ‚àí Œ¶ (zi0 Œ∏) ‚àí Pr[yi = 1, Œ¥i‚àó = 0]
where Œ¶3 (¬∑, ¬∑, ¬∑) is the CDF of the standard trivariate normal distribution.

41

Appendix C

Additional Tables

Table C1: Partial Observability Probit Estimates (First Step of
Proposed Estimator)
SNAP Participation Dummy
First Set
Second Set
Coef.
S.E.
Coef.
S.E.
Panel A: Participation Equation
Biometric
EBT Card
Panel B: Misreporting Equation
Phone Interview
Biometric
N

0.509*

(0.305)

-0.078
0.242***

(0.217)
(0.086)

-0.270***

(0.066)

-0.092*
0.040
5470

(0.050)
(0.175)

5470

This table presents the first step maximum likelihood estimated coefficients of partial
observability model specified in equation (4). Standard errors in parentheses. Results
are based on the 1996-2004 biennial waves of the NLSY79, restricted to females with income lower than 250% of the federal poverty line. For First Set, regressors not reported
include respondentss age, race, household size, household income. For Second Set, additional regressors are number of children, mothers education, square of income, time
fixed effects, and indicators for receiving WIC benefits, AFDC/TANF, SSI benefits,
and having an infant living in home.
‚àóp < 0.10, ‚àó ‚àó p < 0.05, ‚àó ‚àó ‚àóp < 0.010

Table C2: First Stage IV

Biometric
EBT card
F-statistics
Hansen J-statistic
N

SNAP Participation Dummy
First Set
Second Set
Coef.
S.E
Coef.
S.E.
0.0456*
(0.026)
0.005
(0.014)
0.046***
(0.014)
3.19*
5.27***
0.147
5470
5470

This table reports the first stage estimates of the classic linear IV estimator.
Standard errors in parentheses. Results are based on the 1996-2004 biennial
waves of the NLSY79, restricted to females with income lower than 250% of
the federal poverty line. For First Set, regressors not reported include respondentss age, race, household size, household income. For Second Set, additional
regressors are number of children, mothers education, square of income, time
fixed effects, and indicators for receiving WIC benefits, AFDC/TANF, SSI
benefits, and having an infant living in home.
‚àóp < 0.10, ‚àó ‚àó p < 0.05, ‚àó ‚àó ‚àóp < 0.010

42

References
Aigner, D. J. (1973), ‚ÄòRegression with a binary independent variable subject to
errors of observation‚Äô, Journal of Econometrics 1(1), 49‚Äì59.
Almada, L., McCarthy, I. & Tchernis, R. (2016), ‚ÄòWhat can we learn about the
effects of food stamps on obesity in the presence of misreporting?‚Äô, American
Journal of Agricultural Economics .
Battistin, E. & Sianesi, B. (2011), ‚ÄòMisclassified treatment effects and treatment
status: An application to returns to education in the united kingdom‚Äô, The
Review of Economics and Statistics 93(2), 495‚Äì509.
Black, D. A., Berger, M. C. & Scott, F. A. (2000), ‚ÄòBounding parameter estimates with nonclassical measurement error‚Äô, Journal of the American Statistical
Association 95(451), 739‚Äì748.
Bollinger, C. R. (1996), ‚ÄòBounding mean regressions when a binary regressor is
mismeasured‚Äô, Journal of Econometrics 73(2), 387‚Äì399.
Bollinger, C. R. & van Hasselt, M. (2017), ‚ÄòBayesian moment-based inference
in a regression model with misclassification error‚Äô, Journal of Econometrics
200(2), 282‚Äì294.
Bound, J. (1991), ‚ÄòSelf-reported versus objective measures of health in retirement
models‚Äô, Journal of Human Resources 26(1), 106‚Äì138.
Brachet, T. (2008), ‚ÄòMaternal Smoking, Misclassification, and Infant Health‚Äô.
Available at SSRN: https://ssrn.com/abstract=1009781.
Chen, X., Hu, Y. & Lewbel, A. (2008a), ‚ÄòA note on the closed-form identification of regression models with a mismeasured binary regressor‚Äô, Statistics and
Probability Letters 78, 1473‚Äì1479.
43

Chen, X., Hu, Y. & Lewbel, A. (2008b), ‚ÄòNonparametric identification of regression
models containing a misclassified dichotomous regressor without instruments‚Äô,
Economics Letters 100, 381‚Äì384.
Davidson, R. & MacKinnon, J. G. (2004), Econometric theory and methods, Vol. 5,
Oxford University Press New York.
DiTraglia, F. J. & Garcƒ±ÃÅa-Jimeno, C. (2017), ‚ÄòMis-classified, binary, endogenous
regressors: Identification and inference‚Äô, NBER Working Papers 23814.
Feinstein, J. S. (1990), ‚ÄòDetection controlled estimation‚Äô, The Journal of Law and
Economics 33(1), 233‚Äì276.
Frazis, H. & Loewenstein, M. A. (2003), ‚ÄòEstimating linear regressions with
mismeasured, possibly endogenous, binary explanatory variables‚Äô, Journal of
Econometrics 117(1), 151‚Äì178.
Gallant, A. & Nychka, D. (1987), ‚ÄòSemi-nonparametric maximum likelihood estimation‚Äô, Econometrica 55, 363‚Äì390.
Gandelman, N. & Rasteletti, A. (2017), ‚ÄòCredit constraints, sector informality and
firm investments: Evidence from a panel of uruguayan firms‚Äô, Journal of Applied
Economics 20(2), 351‚Äì372.
Gentle, J. E. (2002), Random Number Generation and Monte Carlo methods, Vol.
Second Edition, Oxford University Press New York.
Gumbel, E. (1961), ‚ÄòBivariate logistic distributions‚Äô, Journal of the American Statistical Association 56(294), 335‚Äì349.
Gundersen, C. (2015), Snap and obesity, in J. Bartfeld, C. Gunderson, M. T.
Smeeting & P. J. Ziliak, eds, ‚ÄòSNAP Matters: How Food Stamps Affect Health
and Well Being‚Äô, Redwood City, CA: Stanford University Press.
44

Haider, S. & Solon, G. (2006), ‚ÄòLife-cycle variation in the association between
current and lifetime earnings‚Äô, American Economic Review 96(4), 1308‚Äì1320.
Hausman, J. A., Abrevaya, J. & Scott-Morton, F. M. (1998), ‚ÄòMisclassification of
the dependent variable in a discrete-response setting‚Äô, Journal of Econometrics
87(2), 239‚Äì269.
Hu, Y., Shiu, J.-L. & Woutersen, T. (2015), ‚ÄòIdentification and estimation of singleindex models with measurement error and endogeneity‚Äô, Econometrics Journal
18, 347‚Äì362.
Hu, Y., Shiu, J.-L. & Woutersen, T. (2016), ‚ÄòIdentification in nonseparable models
with measurement errors and endogeneity‚Äô, Economics Letters 144, 33‚Äì36.
Ichimura, H. & Lee, L.-F. (1991), ‚ÄòSemiparametric least squares estimators of
multiple index models‚Äô, Nonparametric and Semiparametric Methods in Econometrics pp. 3‚Äì49.
Kane, T. J. & Rouse, C. E. (1995), ‚ÄòLabor-market returns to two-and four-year
college‚Äô, The American Economic Review pp. 600‚Äì614.
Kane, T. J., Rouse, C. E. & Staiger, D. (1999), Estimating returns to schooling
when schooling is misreported, Technical report, National bureau of economic
research.
Kreider, B. (2010), ‚ÄòRegression coefficient identification decay in the presence
of infrequent classification errors‚Äô, The Review of Economics and Statistics
92(4), 1017‚Äì1023.
Kreider, B., Pepper, J. V., Gundersen, C. & Jolliffe, D. (2012), ‚ÄòIdentifying the
effects of snap (food stamps) on child health outcomes when participation is

45

endogenous and misreported‚Äô, Journal of the American Statistical Association
107(499), 958‚Äì975.
Lewbel, A. (2007), ‚ÄòEstimation of average treatment effects with misclassification‚Äô,
Econometrica 75(2), 537‚Äì551.
Lewbel, A., Dong, Y. & Yang, T. T. (2012), ‚ÄòComparing features of convenient estimators for binary choice models with endogenous regressors‚Äô, Canadian Journal
of Economics 45(3), 809‚Äì829.
Lynch, A. G., Marioni, J. C. & TavareÃÅ, S. (2007), ‚ÄòNumbers of copy-number variations and false-negative rates will be underestimated if we do not account for
the dependence between repeated experiments‚Äô, American journal of human genetics 81(2), 4‚Äì18.
Mahajan, A. (2006), ‚ÄòIdentification and estimation of regression models with misclassification‚Äô, Econometrica 74(3), 631‚Äì665.
Marquis, K. H. & Moore, J. C. (1990), Measurement errors in sipp program reports,
in ‚ÄòProceedings of the 1990 Annual Research Conference‚Äô, Washington, DC.:
U.S. Bureau of the Census, pp. 721‚Äì745.
Meyer, B. D. & Goerge, R. (2011), ‚ÄòErrors in survey reporting and imputation
and their effects on estimates of food stamp program participation‚Äô, US Census
Bureau Center for Economic Studies Paper No. CES-WP-11-14 .
Meyer, B. D., Goerge, R. & Mittag, N. (2015), ‚ÄòErrors in survey reporting and
imputation and their effects on estimates of food stamp program participation‚Äô,
Unpublished Manuscript .
Meyer, B. D., Mok, W. K. & Sullivan, J. X. (2009), ‚ÄòThe under-reporting of

46

transfers in household surveys: its nature and consequences‚Äô, National Bureau
of Economic Research .
Meyerhoefer, C. D. & Pylypchuk, Y. (2008), ‚ÄòDoes participation in the food stamp
program increase the prevalence of obesity and health care spending?‚Äô, American
Journal of Agricultural Economics 90(2), 287‚Äì305.
Millimet, D. L. (2011), The elephant in the corner: A cautionary tale about measurement error in treatment effects models, in ‚ÄòMissing Data Methods: Crosssectional Methods and Applications (Advances in Econometrics, Volume 27 Part
1)‚Äô, Emerald Group Publishing Limited, pp. 1‚Äì39.
Mykerezi, E. & Mills, B. (2010), ‚ÄòThe impact of food stamp program participation on household food insecurity‚Äô, American Journal of Agricultural Economics
92(5), 1379‚Äì1391.
Poirier, D. J. (1980), ‚ÄòPartial observability in bivariate probit models‚Äô, Journal of
Econometrics 12, 209‚Äì217.
Rothenberg, T. (1971), ‚ÄòIdentification in parametric models‚Äô, Econometrica
69(3), 577‚Äì591.
Stephens, M. & Unayama, T. (2015), ‚ÄòEstimating the impacts of program benefits: Using instrumental variables with underreported and imputed data‚Äô, NBER
Working Papers (21248).
Tripathi, G. (1999), ‚ÄòA matrix extension of the cauchy-schwarz inequality‚Äô, Economics Letters 63, 1‚Äì3.
Ura, T. (2017), ‚ÄòHeterogeneous treatment effects with mismeasured endogenous
treatment‚Äô, Unpublished Manuscript .

47

van Hasselt, M. & Bollinger, C. (2012), ‚ÄòBinary misclassification and identification
in regression models‚Äô, Economics Letters 115, 81‚Äì84.

48

