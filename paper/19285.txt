NBER WORKING PAPER SERIES

THE GRAVITY EQUATION IN INTERNATIONAL TRADE:
AN EXPLANATION
Thomas Chaney
Working Paper 19285
http://www.nber.org/papers/w19285

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2013

I want to thank Fernando Alvarez, Michal Fabinger, Xavier Gabaix, Sam Kortum, Bob Lucas, Jim
Tybout, Jon Vogel and seminar participants in Berkeley, Bilkent, Bocconi, Boston University, Chicago,
Erasmus, Hitotsubashi, LBS, Louvain-CORE, LSE, the NY Fed, Oxford, Princeton, Rochester, Sciences
Po, Toulouse, UBC Vancouver, Yale and Zurich for helpful discussions, and NSF grant SES-1061622
for financial support. I am indebted to Jong Hyun Chung, Stefano Mosso and Adriaan Ten Kate for
their research assistance. During the last year, I have received compensation for teaching activities
from the Toulouse School of Economics, as well a research grant from the National Science Foundation
(SES-1061622), in excess of $10,000. The views expressed herein are those of the author and do not
necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
© 2013 by Thomas Chaney. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.

The Gravity Equation in International Trade: An Explanation
Thomas Chaney
NBER Working Paper No. 19285
August 2013
JEL No. F1
ABSTRACT
The gravity equation in international trade is one of the most robust empirical finding in economics:
bilateral trade between two countries is proportional to size, measured by GDP, and inversely proportional
to the geographic distance between them. While the role of size is well understood, the role of distance
remains a mystery. I propose the first explanation for the gravity equation in international trade, based
on the emergence of a stable network of input-output linkages between firms. Over time, a firm acquires
more suppliers and customers, which tend to be further away. I show that if, as observed empirically,
(i) the distribution of firm sizes is well approximated by Zipf's law and (ii) larger firms export over
longer distances on average, then aggregate trade is inversely proportional to distance. Data on firm
level, sectoral, and aggregate trade support further predictions of the model.

Thomas Chaney
Department of Economics
University of Chicago
1126 East 59th Street
Chicago, IL 60637
and NBER
thomas.chaney@gmail.com

Introduction
Fifty years ago, Jan Tinbergen (1962) used an analogy with Newton’s universal law of gravitation
to describe the patterns of bilateral aggregate trade flows between two countries A and B as
“proportional to the gross national1 products of those countries and inversely proportional to the
distance between them,”

TA,B /

(GDPA )↵ (GDPB )
(DistAB )⇣

with ↵, , ⇣ ⇡ 1. The so called “gravity equation” in international trade has proven surprisingly

stable over time and across diﬀerent samples of countries and methodologies. It stands among the
most stable and robust empirical regularities in economics.
While the role of economic size (↵,

⇡ 1) is well understood in a variety of theoretical settings,

to this day no explanation for the role of distance (⇣ ⇡ 1) has been found. This paper oﬀers such
an explanation for the first time.

The empirical evidence for the gravity equation in international trade is strong. Both the
role of distance and economic size are remarkably stable over time, across diﬀerent countries,
and using various econometric methods. Disdier and Head (2008) use a meta-analysis of 1,467
estimates of the distance coeﬃcient ⇣ in gravity type equations in 103 papers. There is some
amount of dispersion in the estimated distance coeﬃcient, with a weighted mean eﬀect of 1.07
(the unweighted mean is 0.9), and 90% of the estimates lying between 0.28 and 1.55. Despite this
dispersion, the distance coeﬃcient ⇣ has been remarkably stable, hovering around 1 over more
than a century of data. If anything, Disdier and Head (2008) find a slight increase in the distance
coeﬃcient since 1950. The size coeﬃcients ↵ and

are also stable and close to 1. Anderson and

van Wincoop (2003) show how to estimate gravity equations in a manner that is consistent with
a simple Armington model, and how to deal especially with diﬀerences in country sizes.2 Silva
Santos and Tenreyro (2006), Helpman, Melitz and Rubinstein (2008) and Eaton, Kortum and
Sotelo (2011) show how to accommodate zeros in the matrix of bilateral trade flows to estimate
gravity equations.
1
Since then, the empirical trade literature has typically used GDP as a measure of size rather than GNP. As
the results are similar with both measures, I will use GDP throughout this paper.
2
McCallum (1995) measures a very large negative eﬀect of the US-Canada border. Anderson and van Wincoop
(2003) show that the large diﬀerence in the size of the US and Canada explains this seemingly implausible border
eﬀect.

2

Existing theoretical models can easily explain the role of economic size in shaping trade flows,
but none explains the role of distance. Krugman’s (1980) seminal contribution was motivated in
part by the empirical regularity of the gravity equation. His model explains how in the aggregate,
trade flows are proportional to country size, and adversely aﬀected by trade barriers. To the
extent that distance proxies for trade barriers, his model can also explain why distance has a
negative impact on trade flows in general, but it has nothing else to say about the precise role of
distance. Several others have shown that the same type of predictions as Krugman can be derived
in various other settings. Anderson (1979) derives a similar gravity equation under the Armington
assumption that goods are diﬀerentiated by country of origin. Eaton and Kortum (2002) derive a
similar gravity equation in a modern version of trade driven by Ricardian comparative advantages.
Chaney (2008) extends the Melitz (2003) model to derive a similar gravity equation in a model
with heterogeneous firms. Arkolakis, Costinot and Rodriguez-Clare (2012) show that the same
gravity equation can be derived in many settings with or without heterogeneous firms.
None of these models however can explain the precise role played by distance. The fact that
the distance elasticity of trade has remained stable around -1 over such a long time and over
such diverse countries is almost a direct rejection of these models. In all of these models, granted
that trade costs increase with distance in a log-linear way, the distance elasticity of trade is the
product of some deep parameters of the model3 with the distance elasticity of trade barriers. To
explain why the distance coeﬃcient is close to -1, those models need some mysterious alignment
of those deep parameters. Even if that magical alignment were to happen in a particular year, for
a particular sector and a particular country, it is hard to understand how it could survive beyond
that point for more than a century. The technology of transportation, the political impediments
to trade, the nature of the goods traded, as well as the relative importance of the countries trading
these goods all have undergone some tremendous changes over the course of the last century. In
other words, all the deep parameters identified by the various existing trade theories have been
evolving over time, while the empirical distance coeﬃcient in the gravity equation has remained
essentially constant.
This paper oﬀers the first explanation that is immune to this critique. I explain not only the
role of economic size, which is straightforward, but also the role of distance. This explanation is
based on the emergence of a stable network of importers and exporters. I assume that there are
3

The demand elasticity in the Krugman and Armington models, the dispersion of productivities across firms in
the Eaton and Kortum model, and a combination of both in the Melitz-Chaney model.

3

two ways for firms to circumvent the barriers associated with international trade. The first one is
to pay a direct cost for creating a foreign contact. This cost is in essence similar to the trade cost
assumed in all existing trade models. The second one is to “talk” with one’s existing contacts, and
learn about the contacts of one’s contacts. This second channel requires direct interaction. While
advances in the technology for transportation or communication will surely aﬀect the first type of
cost, and may even aﬀect the frequency of the second type of interaction, it does not change the
need for direct interaction. In my model, the geographic distribution of any one firm’s exports
does depend on how distance aﬀects the direct cost of creating contacts. But in the aggregate,
the details of this distance function vanish, and the gravity equation emerges. This is the main
contribution of this paper: even if technological, political or economic changes aﬀect the particular
shape of firm level exports, in the aggregate, the gravity equation remains essentially unaﬀected.
I derive those results in a stylized model of a dynamic network of input-output linkages between firms. This model is most closely related to Oberfield (2013). In Oberfield, firms decide
which supplier they want to purchase inputs from, but they only use inputs from a single supplier;
moreover, firms are exogenously assigned to a set of potential suppliers. In my model on the other
hand, firms decide endogenously how many suppliers they want to buy inputs from; moreover,
firms in my model use inputs from various suppliers at the same time. The key diﬀerence between
both models is that while Oberfield considers explicitly production chains made up of heterogeneous firms, I only characterize a much simpler case where all firms along a production chain are
symmetric. I allow firm heterogeneity between production chains, but not within. I also introduce
geographic space explicitly into my model, and analyze the patterns of trade, which are absent
from Oberfield. In that sense, both models are complementary.
Specifically, I oﬀer three main theoretical contributions.
The first contribution is to build a tractable model of vertical production chains. Firms combine
capital and labor with intermediate inputs supplied by upstream firms. I show how firms optimally
decide to enter a market, and subsequently, how they optimally invest into acquiring new upstream
suppliers. I characterize a balanced growth path in this model where growth is driven both by the
entry of new firms, and by the growth of existing firms. I derive explicit expressions for aggregate
production, productivity and welfare, as well as the size distribution of firm sizes and of shipment
sizes.
The second contribution is to characterize analytically how the geographic distributions of a

4

firm’s suppliers and customers evolve over time. Over time, a firm meets the suppliers (customers)
of its existing suppliers (customers). The locations of a firm’s initial suppliers are drawn from some
exogenous probability distribution. The location of a firm’s new suppliers depends in a complex
fashion on where the firm’s existing suppliers are located, but also on where the suppliers of its
suppliers are located... etc. Within a cohort of firms, all those geographic distributions evolve
jointly as a complex dynamic system. To characterize this dynamic system, I adopt a probabilistic
approach. I solve not for the geographic location of an individual firm’s suppliers and customers,
which is governed by the luck of the draw, but rather the probability distribution of those locations
within a large cohort. Using Fourier analysis, I solve for this dynamic system. Over time, as a firm
acquires more upstream suppliers and downstream customers, those suppliers and customers tend
to be located further and further away. So the imports and exports of larger firms are shipped
over longer distances on average.
The third contribution is to solve for the patterns of aggregate trade flows between countries in
this complex dynamic system. From the previous characterization of firm level shipments, I know
that as a firm’s network of suppliers and customers grows, its eﬃciency increases, it gets larger, it
trades more, and towards more distant trading partners. I show that this dynamic system reaches
a stable steady state for any initial condition that satisfies some weak conditions. Because larger
firms trade over longer distances, ultimately, whether a country exports little or a lot towards
distant places depends on whether there are relatively many or few large firms. In particular, I
show explicitly that if the stationary distribution of firm sizes is close to Zipf’s law, then aggregate
flows are inversely proportional to geographic distance. This result holds asymptotically for any
initial condition that govern where small firms export. The model also predicts that systematic
deviations away from Zipf’s law should be associated with deviations away from the -1 elasticity
of aggregate trade with respect to distance.
While the primary contribution of this model is to shed light on the structure of aggregate
trade and in particular the role of distance, it also oﬀers tools to address various questions in an
economy characterized by complex vertical production chains. For instance, I use this model to
quantify the aggregate eﬃciency loss from trade disruptions, both upon impact and over time.
The remainder of the paper is organized as follows. In section 1, I present a stylized dynamic
model of input-ouput linkages between firms. This model oﬀers useful tools for analyzing a dynamic
network of firm linkages. This is however not the main contribution of the paper, and the hasty

5

reader may skip this section so as to focus her attention on the next section. Section 2 contains the
main contribution of the paper, namely the characterization of the patterns of trade at the firm
level and in the aggregate. I derive general conditions under which the gravity equation holds, i.e.,
aggregate trade is proportional to country size and inversely proportional to geographic distance.
In section 3, I analyze the static and dynamic costs of trade disruptions in this model. In section 4,
I bring some of the main theoretical predictions of the model to the data. I relegate to Appendix
A all mathematical proofs, and to Appendix B the description of the data.

1

A model of input-output linkages between plants

In this section, I develop a simple model of the formation of a stable network of input-output
linkages between firms. The model is an extension of the Krugman (1980) model of international
trade in diﬀerentiated goods subject to matching frictions similar to the Chaney (2013) model of
trade networks.
This model is purposefully simple, and is meant to illustrate how the proposed dynamic model
of firm trade can be derived in a classical trade setting. I also use this model to shed new light on
the aggregate welfare gains from trade. The hasty reader may skip this section so as to focus her
attention on the formation of a stable network of exporters in the following section 2.

1.1

Set-up

There are two types of goods: final goods and intermediate inputs. Final goods are produced by
combining diﬀerentiated intermediate inputs available locally. Intermediate inputs are themselves
produced by combining diﬀerentiated inputs and labor, so that the economy features roundabout
production. Final goods are sold locally to consumers on a perfectly competitive market. Intermediate inputs are produced and distributed worldwide by monopolistically competitive firms.
Since only intermediate inputs are traded, I will focus most of my attention on the production
and trade of these intermediate goods. Due to matching frictions, intermediate input firms source
their inputs from, and sell their output to a subset of producers only.
Final goods.— Final goods are sold on a competitive market by atomistic firms that share the
same constant returns production function,
Qfinal =

✓ˆ

i2K

qfinal (i)

6

1

di

◆

1

(1)

where K is the set of intermediate goods available locally for final assembly, qfinal (i) is the quantity
of inputs sold by firm i for final assembly, and

> 1 is the elasticity of substitution between inputs.

Intermediate inputs.— Firm i buys intermediate inputs from a continuum of suppliers k 2 Ki

and sells its output to a continuum of customers j 2 Ji as well as to the final good producers on

a monopolistically competitive market. Both sets Ki and Ji will be endogenously determined dy-

namically below. Firm i combines Li units of labor with qi (k) units of diﬀerentiated intermediate

inputs from each supplier k to produce Qi units of output,
Qi =

✓ˆ

1

qi (k)

k2Ki

dk

◆↵

1

L1i

↵

(2)

with 0 < ↵ < 1 the share of intermediate inputs in production and

> 1 the elasticity of

substitution between any two intermediate inputs.
Free entry.— There is a perfectly elastic fringe of potential entrepreneurs ready to start an
intermediate input producing firms. Starting up a business entails a constant fixed entry cost of fE
units of labor. This free entry of new firms ensures that in equilibrium, all profits are dissipated.
Workers and consumers.— In every location, there is a competitive labor market with an
equilibrium wage w, and a measure Lt of consumers/workers at time t. Population grows at a
constant rate .

1.2

The static problem of the firm

Consider what happens within period t. For the moment, I drop the time t index.
Firm demand.— Each period, firm i faces the same iso-elastic demand from any customer,
whether they are another intermediate good producer of a final good producer, j 2 {Ji [ final},
pj (i) qj (i) = ´

pj (i)1
k2Kj

pj (k)1

dk

(3)

Xj

with pj (i) the price charged by i to customer j, and Xj the total spending on intermediate inputs
by j.
Firm pricing.— Given these iso-elastic demands, firm i charges all its customers the same
constant mark-up,

1,

over its marginal cost,
pj (i) = pi =

1

w

1 ↵

✓ˆ

k2Ki

with w the competitive wage rate.
7

pi (k)

1

dk

◆

↵
1

(4)

Symmetry assumption.— For simplicity, I will consider a symmetric equilibrium where all firms
within a cohort have the same number of suppliers and customers4 and therefore charge the same
price: denoting K = kKk the measure of set K, a symmetric equilibrium will be such that Kj = K
and pj (k) = p for any j, k 6= i.

This symmetry assumption is strong. It simplifies greatly the analysis of the optimal strategies

of firms, of the equilibrium, and of the patterns of firm level and aggregate trade flows. Relaxing
this assumption forces me to keep track of the joint distribution of suppliers and customers, in every
location, and renders the analysis complex. I show in the Appendix how to relax this assumption.
The most important propositions (2 and 3) of this paper are preserved, but at a great cost in
terms of analytical complexity. While the simplicity of the analysis it aﬀords is the primary
justification for this simplifying assumption, it is also a somewhat appropriate approximation
of reality: Atalay, Hortacsu, Roberts and Syverson (2011) show for the US a tendency towards
positive assortative matching, whereby firms with many suppliers tend to be connected to suppliers
with many suppliers themselves; Acemoglu, Carvalho, Ozdaglar and Tahbaz-Salehi (2012) show a
similar property at the level of industrial sectors.
Firm sales.— Given this symmetry assumption, the demand equation (3) and the pricing
equation (4), the total sales of firm i only depend on its number of suppliers and of customers,
ˆ
pi qj (i) dj + pi qfinal (i) = Ki↵ Di
(5)
pi Qi =
j2J i

where Di is a demand shifter that does not depend on i’s price.
It is clear from the previous Equation (5) that the number of suppliers and customers increases
output, sales, and ultimately profits which are a constant fraction 1/ of total sales. The mass of
suppliers, or “contacts,” Ki , plays a role equivalent to capital, or to a productivity shifter. I will
use the “capital” analogy, and denote by Ii the “investment” in acquiring “information” about new
contacts. The notion that the diversity of intermediate inputs plays a role similar to capital has
been explored since at least Romer (1990).5 The mass of customers, Ji , plays a role equivalent
to a proportional demand shifter. A firm is willing to pay for information about new upstream
and downstream contacts, as well as sell the information it has about its existing contacts. Before
analyzing this dynamic decision of the firm, I first describe the general equilibrium of this economy
4

In such a symmetric equilibrium, a lot the complexity of the input-output structure of the economy is assumed
away. See Carvalho, Acemoglu, Ozdaglar and Tahbaz-Saleh (2012), Atalay, Hortacsu, Roberts and Syverson (2011)
or Oberfield (2013) for models with a more complex structure.
5
See among many examples the theoretical model of di Giovanni and Levchenko (2010) or the empirical evidence
of Halpern, Koren and Szeidl (2011) for two recent applications of this notion in trade.

8

in each period.

1.3

The static general equilibrium

Having characterized the behavior of each firm individually, I can now solve for the general equilibrium of the model at each period.
Equilibrium firm price.— Each firm charges a price to any of its consumer that is constant
mark-up

1

over its marginal cost of production. The firm’s marginal cost itself depends on

the prices charged by its suppliers, which in turn depend on their marginal cost... etc. The
distribution of prices is therefore the solution to a potentially complex fixed point problem. Under
the symmetry assumption above, this fixed point problem is substantially simplified. A firm with
K suppliers only buys intermediate inputs from other firms with K suppliers. In this symmetric
equilibrium, that firm charges a price to its consumers that is the same as the price it pays to its
suppliers. Using the pricing expression in Equation (4), I can solve for the unit price pK of a firm
with K suppliers,
pK =

1

w1

↵

✓ˆ

K

p1K dk

◆

↵
1

where I have normalized the competitive wage w so that

) p1K
1w

= K1

1 ↵

↵
↵

(6)

= 1. A firm with K suppliers

sells its output to other intermediate input producers (each with K suppliers themselves), as well
as to the final good producer. When selling to an intermediate good producer, that firm competes
against K other intermediate good producers (each charging the same price for their own inputs).
When selling to the final good producer on the other hand, that firm competes against all local
intermediate input producers, some with more, some with fewer suppliers. The total sales of firm
i with K suppliers is then,
p i Qi =

p1i

ˆ

Ji

´

Xj
dj + p1i
1
dk
K j pk

y
P1

where Xj is the total spending on intermediate inputs by firm j, P is the ideal price index for
all intermediate goods purchased by the local final good producer, and y is the total spending on
intermediate inputs by this final good producer.6
Equilibrium aggregate prices.— Having solved for the price of any firm in Equation (6), if there
6

As the final goods market is competitive, the total spending on intermediate inputs by the final goods producer,
y, is equal to the income of the local consumers. Because of free entry, all profits are dissipated, and aggregate
income equals wL.

9

is a measure M of firms in each location, then the ideal price index is given by,
P =

✓ˆ

1

K0

p1K

M dF (K)

◆

1
1

h ↵ i⌘ 1
⇣
1
= M EF K 1 ↵

(7)

where M is the measure of firms and F is the cumulative distribution of firms with K suppliers
in the population. I derive an explicit solution for the distribution F and prove that it is time
invariant in Section 2. I solve endogenously for the measure of firms M in Section 1.5 where I
characterize the optimal entry decision of firms.
Several observations are in order. First, the aggregate price index decreases with the measure
of firms, as in any model with love for variety. Second, more eﬃcient firms (lower price firms)
contribute more to lowering the aggregate price index, as in any model with heterogeneous firms.
The novel aspect of this model is that those firms with lower prices are typically firms with
many suppliers, which are part of more complex production chains. More complex and longer
production chains contribute to more eﬃcient production, and a lower aggregate price index.
Those more complex production chains are more fragile in the sense that they involve a larger
number of firms; on the other hand, to the extent that intermediates are substitutable ( > 1),
firms in those complex production chains also have more options to substitute away from a failing
supplier.
Equilibrium sales and shipments.— Any firm j charges a constant mark-up

s 1

over marginal

cost, it spends a constant fraction ↵ on intermediates inputs, so its total spending on inputs is
a constant fraction of its total sales, Xj = ↵

1

pj Qj . Furthermore, given the symmetry of the

equilibrium, pi Qi = pj Qj , Ji = Kj = K and pi = pk = pK for any firm i, j or k with Ksuppliers.
I can then solve for the total sales of a firm with K suppliers,
Sales (K) = K

↵
1 ↵

wL/P 1
1 ↵

1

!

(8)

and for the value of the shipment of intermediate inputs from a firm with K suppliers to any one
of its customer,
Shipment (K) = K

1 2↵
1 ↵

wL/P 1
↵(

1)

1

!

(9)

Firms with more suppliers are more eﬃcient at producing, they sell to more other intermediate
input producers, they charge a lower price and are able to capture a larger market share of the final
demand. The higher is the share of intermediate inputs ↵, the stronger is the multiplier eﬀect
of having more suppliers on a firm’s productivity, and the larger the sales of firms with many
10

suppliers compared to firms with few. Whether a firm’s shipment of intermediate inputs increases
or decreases with its eﬃciency depends in a subtle way on the share of intermediate inputs in
production. A firm with K suppliers competes against other firms with K suppliers when selling
to any of its customers. Whether the eﬃciency of the one firm or that of its competitors dominates
in determining the market share of each depends on whether the share of intermediate inputs if
smaller of larger than that of labor.
In the special case where ↵ = 12 , the total sales of a firm with K suppliers (and K customers)
is simply proportional to K, and all shipments have the exact same value. This special case is
of course knife-edge, but it will prove a useful benchmark for the trade model I develop below.
Under this assumption, the total volume of trade between two countries, whether for one or for
many firms, is simply proportional to the number of shipments between the two countries. The
analysis below considers this special case where all trade volumes are only driven by the extensive
margin of shipments. Relaxing the simplifying assumption ↵ =

1
2

would introduce an intensive

margin of shipments.

1.4

The dynamic problem of the firm

Having characterized the static optimization of the firm, as well as solved for the static general
equilibrium the firm faces each period, I can now turn to the dynamic problem of the firm.
The market for information.— A firm is born with a mass K0 = J0 of suppliers and customers.
Once born, a firm expands its set of suppliers and customers. While a priori, firm i may buy and
sell information about both suppliers and customers, I assume that i actively buys information
about new suppliers from its existing suppliers, actively sells information about suppliers to its
existing customers, but passively waits to be contacted by downstream firms. In a symmetric
equilibrium, this simplification is innocuous since firms have as many suppliers as customers on
average: if i is a supplier to j then j is a customer of i. The sequence of contact formation is
depicted in Figure 1.
I assume that a firm who wants to buy information about a supplier always has the option of
directly searching for suppliers on its own. This outside option technology oﬀers new names at
a given constant marginal cost of pI units of labor. The seller of information makes a take-it-orleave-it oﬀer to any potential buyer of information. Facing the threat of this outside option, firm i
sets a constant price pI w to reveal the name of one of its suppliers to its existing customers. The
price pI w is set just low enough to prevent firm j 2 Ji to look for contact directly instead. Just as
11

Figure 1: Firms buy and sell information about suppliers and customers.
Notes: The straight solid arrows represent input-output linkages: e.g. firm k supplies intermediate inputs to firm i.
The curvy dotted lines represent information linkages: e.g. firm k sells to firm i information about a new supplier
k0 . After these information exchanges take place, firm i has a new supplier, k’, and a new customer, j’.

i sells information about its suppliers, it also buys at the same price pI w information about new
suppliers from its existing suppliers.
In addition to the direct cost pI w of buying information, firm i faces a convex adjustment cost
wC (Ii , Ki ) denominated in units of labor. The adjustment cost function is assumed increasing
and convex in I, CI , CII > 0, decreasing in K, CK < 0, and homogenous of degree one in I and
K. This convex adjustment cost function captures the idea that bringing a new supplier into a
firm’s production process entails some cost: those inputs have to be customized to fit into the
production process, and the production process itself has to be adapted to be combined with this
new source of inputs. It is analogous to the adjustment cost assumed in the classical theory of
investment, as in Lucas (1967) or Hayashi (1982). As in the investment literature, I assume that
the more suppliers a firm already has (Ki ), the more eﬃcient it is at acquiring new suppliers (Ii ),
in such a way that the adjustment cost C is proportional to Ki for a given investment share Ii /Ki .
As in Lucas (1967), this homogeneity assumption will warrantee that Gibrat’s law holds, in the
sense that the growth rate of a firm is independent of its size.
As in classical investment models, firm i has two reasons for accumulating more suppliers, i.e.,
“investing” in Ki : first, a higher Ki increases its productivity and profits; but it also lowers the
future cost of “investment” in acquiring new suppliers, Ii . However, while firm i sells information

12

about its suppliers to its customers, having more suppliers does not change firm i’s future prospect
for selling more information: the price firm i sets for selling information about suppliers, pI w, is
set by an arbitrage condition, and the number of requests for names firm i receives depends on the
decisions of its customers, j 2 Ji . At each point in time t, firm i receives I (t) requests for names,

where I (t) depends on the “investment” decision of downstream firms, which is beyond firm i’s
control.
Finally, I assume that firm i’s existing contacts are lost at some exogenous rate .
The dynamic problem of the firm.— Firm i solves the following dynamic optimization problem,
✓
◆
ˆ +1
↵ Di (t)
rt
pI w (t) Ii (t) + pI w (t) I (t) wC (Ii (t) , Ki (t)) dt
Ki (t)
e
max V (0) =
Ii (t)

0

s.t. K̇i = Ii

(10)

Ki

Firm i maximizes a discounted stream of profits, with a constant discount rate r. The first
term represents per period profits, net of spending on intermediate inputs and labor, but before
spending and receipts on information acquisition. It is a fraction 1/ of the aggregate sales derived
in Equation (5). In addition, firm i purchases information about Ii new suppliers at a price pI w
each, and it sells information about I suppliers at a price pI w each. Finally, firm i pays the convex
adjustment cost wC to integrate new suppliers into its production process.
The solution to this classical problem is such that the “investment” rate is independent of the
stock of “capital” (Gibrat’s law). In other words, firm i increases its number of suppliers Ki at a
rate that is independent of Ki ,
Ii (t) =
where the function

(pI , r, ; t) ⇥ Ki (t)

summarizes the contributions of the production function and the adjustment

cost function that are relevant for the optimal investment decision. I derive formally in Appendix
A the optimal investment policy function that solves (10), as well as explicit conditions under
which the investment rate is constant over time and across all types of firms.
Because all firms are charging the same price pI w per contact information, firm i has no
reason to direct its search for new suppliers to any particular k 2 Ki . To break this indeterminacy,
I assume that the Ii new names are randomly drawn (uniformly) from the set of all existing

suppliers Ki . This means that any one of the existing suppliers k 2 Ki reveals one of the names
13

of its suppliers, k 0 2 Kk , with a probability

dt over a small time interval dt. To break the

indeterminacy of which name k 0 2 Kk gets revealed by firm k, I simply assume that k draws k 0 at

random among all its existing Kk contacts.

1.5

Entry decision and balanced growth path

Finally, I solve for the entry choice of new firms. After entry, monopolistic firms are able to
extract a surplus from their consumers. This stream of profits attracts new entrants as long as its
discounted value exceeds the fixed entry cost.
In this model, as in any model where productivity growth is driven by the accumulation of
one factor of production (here the diversity of suppliers, K) combined with labor under constant
returns to scale, growth is ultimately driven by population growth, as in Solow (1956). I will now
characterize the entry decision of firms along a balanced growth path. Along this balanced growth
path, population growth induces a continuous entry of new firms.
Free entry condition.— Each period, the symmetric equilibrium described in Section 1.3 holds,
and all firms “invest” in acquiring new suppliers at the constant rate

as described in Section 1.4.

Consider a potential entrant that contemplates entering at time t. Its per period profits would
be a fraction 1/ of its sales, given in Equation (8). In a symmetric equilibrium, the firm would
spend each period exactly as much in acquiring information about new suppliers as it would earn
selling information about its consumers. The value of entry at time t, V (t), is the discounted sum
of those per period profits. Firms will enter in period t as long as it exceeds the cost of entry wfE .
The perfectly elastic supply of potential entrants implies that the value of entry must exactly
equal the cost of entry in every period,
V (t) ⌘

ˆ

+1

e

r(s t)

K (s) 1

t

↵
↵

wL (s) /P (s)1
↵(
1)

!

wC (I (s) , K (s)) ds = wfE , 8t

(11)

I will now use this series of free entry conditions to solve for the entry of firms along a balanced
growth path.
Balanced growth path equilibrium.— After a firm enters, its measure of suppliers grows at a
rate

, so that its measure of suppliers at age s

rate is constant, so that I (s) =

0 is K (s) = K0 e(

)s .

The “investment”

K (s). The homogeneity of the adjustment cost function C

implies that C (I (s) , K (s)) = K (s) C (I (s) /K (s) , 1) ⌘ K (s) c ( ).

so that L (s) = L0 e s . Along a balanced growth

The population grows at the exogenous rate

14

path, the measure of firms grows at some constant endogenous rate M . The ideal price index
h ↵ i
given in Equation (7) is therefore such that P (s)1 = M0 EF K 1 ↵ e M s .
Combining those elements with the free entry condition (11), the following condition must hold

each period,
ˆ

1
0

e

0

rs @

↵
1 ↵

K0
(

↵(

e

↵
(
1 ↵

)s

h

we

1)) M0 E K

(s+t)

↵
1 ↵

i

e

K0 e (

M (s+t)

For this equation to hold for all t, it is apparent that

M

=

)s

1

c ( )A ds = wfE , 8t

(12)

is necessary.7 In other words, the

measure of firms in every location grows at the same constant rate

as the population. Once this

condition is imposed, Equation (12) pins down M0 and the measure of firms each period. The
existence and uniqueness of a balanced growth path equilibrium is warranted.
Here is a recap of the conclusions from the above model. Firms are continuously born at a
rate . A firm is born with an initial mass K0 of suppliers. Subsequently, contacts are randomly
created at a rate

and lost at a rate , with each new contact coming from the suppliers of the

firm’s existing suppliers. In addition, and under the simplifying assumption that the share of
intermediate inputs is a half, a firm’s size is proportional to its number of suppliers, and shipment
sizes are the same for all firms.
The next section characterizes explicitly the dynamic evolution of firm level and aggregate
trade flows, i.e., trade between the suppliers and customers of this model.

2

Firm level and aggregate trade flows

This section contains the main contribution of this paper. It explains the stable role played by
geographic distance in shaping aggregate trade flows. The central results are given in Propositions
2 and 3. I introduce space explicitly in the model of input-output linkages of the previous section.
I first analyze the patterns of trade at the firm level in section 2.1, before characterizing aggregate
trade flows in section 2.2. I present some robustness checks in section 2.3.

2.1

The geography of firm level trade

In this section, I spell out a dynamic model of firm level trade flows that incorporates the key
results derived from the economic model in the previous section. All the parameters introduced in
7

The above free entry condition is of the form, constant +
only if M = .

15

e t
constant
e Mt

= constant. This can hold for any t

this section (K0 , , , ) are the same as the ones in the economic model above. I treat the arrival
rate of new firms, , and of new contacts, , as parameters, knowing from the model above that
they are the solutions to the dynamic optimization problem of the firm and the entry decision of
new firms. The contacts in this section are the customers of the above model. The key addition
of this section is the introduction of an explicit notion of geographic space.
Heuristically, the model is as follows.
New firms are continuously born. When a firm is born, it randomly contacts a geographically
biased mass of firms over the entire world. After this initial period, contacts are randomly lost
and created. Old contacts are lost to i.i.d. shocks. New contacts are created in the following way:
each period, with some probability, a firm receives names from the contact lists of its existing
contacts. In other words, a firm gradually meets the contacts of its contacts, who themselves
acquire contacts in a similar way, etc.
Formally, the model is as follows.
Space.— Firms are uniformly distributed over an infinite one-dimensional continuous space
represented by R. Each coordinate along that line can be thought of as representing a city, and
countries can be thought of as an arbitrary partition of that space, where a country is then a
collection of cities, or an interval of the real line.
Time.— Time is continuous. In every location, new firms are born continuously, with the
population of firms in each location growing at a constant rate , where
time t, there is the same density of firms e

t

stands for “growth”. At

in every location, where I normalize the population

at t = 0 to 1. As the model is perfectly symmetric, I will focus my attention on a firm located at
the origin.
Birth of a firm.— When a firm is born, it samples a mass K0 of contacts, distributed geographically according to the p.d.f. g0 (·). So the mass of contacts it acquires in the interval [a, b]
´b
is K0 a g0 (x) dx. I assume that g0 is symmetric and has a finite variance, but can take any

arbitrary shape otherwise. For simplicity, I assume that when a firm is born, it samples contacts

only among other firms of the same age: firms within each cohort gradually get connected to each
other. While this simplifying assumption is strong, it simplifies the analysis greatly. The main
set of predictions from the model still hold under the much weaker assumption that when a firm
is born, it samples its K0 new contacts among all existing firms, in such a way that those firms
are at a finite average (squared) distance between from their own contacts. While this relaxed
16

assumption is much weaker, it forces me to keep track of the entire system of connections between
all firms simultaneously. This renders the model analytically complex.8
Death of a firm.— I assume that firms are infinitely lived. This assumption is innocuous, and
all results would carry through if firms are hit by random Poisson death shocks. A positive death
rate for firms would simply be added to the death rate of contacts below.
Birth of contacts.— New contacts are continuously created as follows. At any point in time,
each existing contact may reveal one of its own contacts according to a Poisson process with arrival
rate , where

stands for “birth”.

Death of contacts.— Existing contacts are continuously lost according to a Poisson process
with arrival rate , where
I assume

>

stands for “death”.

> 0. While the second assumption

> 0 is not required to derive my

results, it would generate counter-factual predictions, such as an infinitely long tail of infinitesimally small firms and firm sizes shrinking on average. The first assumption,

>

is required

for a stable equilibrium to emerge, as it prevents older firms from becoming “too” large compared
to the rest of the economy.
I will now define two concepts: the function ft describes the geographic distribution of the
contacts of a firm of age t, and the variable Kt describes the total mass of contacts of this firm,
ˆ
+
ft : R ! R and Kt ⌘
ft (x) dx
(13)
R

ft (x) is the density of contacts a firm of age t has in location x. In other words, the mass of
´b
contacts a firm of age t has in the interval [a, b] is a ft (x) dx. The total mass of contacts a firm
of age t has worldwide is then Kt . Note that as ft does not sum up to 1, it is not a probability
density. The normalized ft /Kt on the other hand is a well defined p.d.f.
The distribution of contacts evolves recursively according to the following Partial Diﬀerential
Equation,
@ft (x)
=
@t

ˆ

R

ft (x y)
ft (y) dy
Kt

ft (x)

(14)

with the initial condition f0 (x) = K0 g0 (x).
I multiply both sides of the equation by dx for a rigorous interpretation. The left hand side
of Equation (14) corresponds to the net creation of new contacts in a neighborhood dx of x. It
8
The proof of the main proposition under the relaxed assumption is presented in the online appendix.
See https://sites.google.com/site/thomaschaney/Distance_Appendix.pdf.

17

is equal on the right hand side to the gross creation of new contacts minus the destruction of old
y)
contacts. The gross creation of contacts can be decomposed into four components: , ft (x
Kt dx,
´
ft (y) dy and the integral sign y2R . The first component, , corresponds to the Poisson arrival of

new information from a firm’s contacts. With a probability dt over a small time interval dt, any

one of a firm’s contact in location y will reveal the name of one of her own contacts. The second
component,

ft (x y)
Kt dx,

corresponds to the probability that conditional on a contact in location y

revealing the name of one of her contacts, this contact happens to be in a neighborhood dx of x.9
Note here that I impose the simplifying assumption that a firm of age t only meets other firms in
the same cohort, who themselves have the same distribution ft . I show in the online appendix how
this strong assumption can be substantially relaxed. The third component, ft (y) dy, corresponds
to the fact that a firm of age t has potentially several contacts in a neighborhood dy of y (exactly
ft (y) dy of them), each of whom can potentially release the name of one of its contacts in x. The
´
fourth component, y2R , corresponds to the fact that the information about new contacts in x can
potentially be intermediated via contacts in any location y 2 R. The second term with the minus
sign on the right hand side of Equation (14) corresponds to the destruction of old contacts. Any

one of the existing ft (x) dx contacts of a firm of age t in a neighborhood dx of x may be destroyed
with the same probability dt over a small time interval dt.
The Partial Diﬀerential Equation (14) admits an explicit analytical solution, which I relegate
to Appendix A in the interest of conciseness. While the mathematically less inclined reader may
skip the derivation of this solution, it contains a number of analytical tools that may prove useful
in a variety of economic settings. The analytical solution to the geographic distribution of contacts
ft allows me to derive closed-form solutions for the number of contacts of an individual firm, its
distribution within the population, and the geographic location of these contacts. Formal proofs
of all results are provided in Appendix A.
First, the model predicts that as a firm ages, the number (mass) of its contacts increases,
Kt = K0 e(

)t

(15)

The total number of a firm’s contacts grows at a constant rate equal to the net birth rate of
contacts (birth rate

minus death date ).

9

ft
Since the distribution ft sums up to Kt , the normalized Kt
is a well defined p.d.f. that sums up to one.
Moreover, the distribution of contacts for a firm located in y is the same as for a firm located in the origin (y = 0),
where all coordinates are simply shifted by the constant y: f0,t (x) = fy,t (x y).

18

Second, as both the number of a firm’s contacts and the number of firms grow exponentially,
the model predicts that the distribution of the number (mass) of contacts within the population
is Pareto distributed. The fraction F (K) of firms with K or fewer contacts is given by,
✓

F (K) = 1

K
K0

◆

for K

K0

(16)

From Equation (15), young firms have fewer contacts than old ones. The larger is the growth rate
of the population as a whole, , the more young firms relative to old ones, the fewer firms with a
large number of contacts, and the thinner the upper tail of the Pareto distribution of the number
of contacts. From Equation (15) also, the higher is the growth rate of a firm’s contacts, the larger
the mass of contacts of old firms relative to young ones. The larger is the net birth rate of new
contacts,

, the more firms with many contacts, and the fatter the upper tail of the Pareto

distribution of the number of contacts.
If, as is approximately verified in the data, the cross-sectional distribution of the sizes of
exporters is close to a Zipf’s law, then we should expect the Pareto shape parameter to be close to
⇡ 1+ .10 While deviations from this stationary benchmark are to be expected in the data,

1,

these deviations ought not to be too large.

Third, the model predicts that as a firm ages, not only does it acquire more contacts, but
those contacts become increasingly dispersed over space. Let me denote by fK the geographic
distribution of contacts of a firm with K contacts.11 The average (squared) distance from the
contact of a firm with K contacts,
(K) ⌘
where

0

⌘

´

Rx

2g

0 (x) dx

(K), increases with its number of contacts,
ˆ

R

x

2 fK

(x)
dx =
K

0

✓

K
K0

◆

(17)

is the average (squared) distance from a firm’s initial contacts. While

a firm’s initial contacts are some distance away, each wave of new contacts come from firms who
are themselves further away. As a consequence, each wave of new contacts is geographically more
dispersed than the previous one. This eﬀect is compounded by the fact that a firm’s contacts are
also acquiring more and more remote contacts. Since a firm acquires more contacts as it ages, the
more contacts a firm has, the more dispersed these contacts are.
10
Note that this simple model with a constant growth rate of the population and of the number of contacts
corresponds to the Steindl (1965) model of firm growth. More elaborate stochastic models such as Gabaix (1999)
or Luttmer (2007) deliver an invariant size distribution that is close to Zipf’s law in a more general set-up. I choose
to use the simpler Steindl model while adding substantial complexity on the geographic dimension of the model. I
conjecture that including the stochastic elements of Gabaix (1999) or Luttmer (2007) would not change my results.
11
fK is defined as fK = ft(K) where t (K) s.t. Kt(K) = K is the age a firm has to reach to have K contacts.

19

Note that the particular moment
g0 :

0

(K) only depends on two parameters of the distribution

and K0 . For any two economies with diﬀerent g0 and g00 but with the same

0

and K0 ,

the average (squared) distance from a firm’s contact will evolve in the exact same way as a firm
acquires more contacts, no matter how diﬀerent g0 and g00 are otherwise. This result arises for
the same reason that the n-th derivative of the composition of several functions only depends on
their first n derivatives:

(K) is the second moment of the p.d.f. gK = fK /K, which is given by

the second derivative of the moment generating function of gK ; this second derivative does not
depend on any derivative of the moment generating function of g0 above the second one.
I do not need to characterize the geographic distribution of contacts of firms any further to
derive the main proposition of this paper regarding aggregate trade, presented in the next section.
I will however show a particular asymptotic property of this general solution. It will prove useful
for a variety of questions, and in particular to derive precise predictions for the aggregate welfare
cost of trade disruptions which I study in Section 3. The following proposition12 characterizes
the geographic distribution of a firm’s contacts, for a special case for the initial g0 as well as
asymptotically for a large t.
Proposition 1 The distribution of a firm’s contacts,

ft
Kt ,

converges when t grows large to a Laplace

distribution (a 2-sided exponential),
⇣
⌘
p
ft (x)
t/2
⇠ Laplace 0, e
0 /2
Kt t!1
⇣ p
⌘
This property holds exactly for all t’s if g0 ⇠ Laplace 0,
0 /2 .

One can see from this proposition that as a firm grows bigger, the location of its contacts is less

and less aﬀected by distance. The distribution of a firm’s contacts converges to what resembles
a uniform distribution over the entire real line in a strong sense: for any two locations x and y,
no matter how far x is from y, the fraction of contacts in x and in y become equal for t large. In
other words, the world does become “flat” for individual firms as they grow large. But, as I will
show in the next section, this does not mean that the world becomes “flat” in the aggregate.
Having characterized the distribution of contacts for all firms, I analyze next the aggregate
distribution of contacts, and the structure of aggregate trade flows in this economy.
12

I am grateful to Xavier Gabaix for suggesting this extension.

20

2.2

The geography of aggregate trade

Under the simplifying assumption that the share of intermediates in production is a half, all
shipments sizes are the same, and a firm exports one shipment to each of its contacts. The volumes
of trade between two locations, both at the firm and at the aggregate levels, are then simply
proportional to the number of shipments between those locations. I have shown in the previous
section that older firms have more numerous and dispersed contacts. Knowing the distribution
of contacts of each firm, I can characterize the patterns of aggregate trade flows between firms in
any set of locations. The following two propositions show that aggregate trade flows in this model
obey the gravity equation in international trade.
Proposition 2 For any distribution g0 of initial contacts that is symmetric and admits a finite
variance, aggregate trade flows between two countries A and B are approximately proportional
to their respective sizes (GDPA and GDPB ), and inversely related to the distance between them
(DistA,B ),
TA,B /
with ✏ ⌘ 2 min

✓

rate of contacts.

1

◆

,1 ,

GDPA ⇥ GDPB
(DistA,B )1+✏

the population growth rate and

(resp.

) the birth (resp. death)

Proposition 3 If the distribution of export sizes among individual firms is close to Zipf ’s law,
then aggregate trade flows between two countries are approximately proportional to their respective
sizes and inversely proportional to the distance between them. The canonical gravity equation holds,
TA,B /

GDPA ⇥ GDPB
DistA,B

The role of economic size in this model is relatively straightforward, and in essence similar to
the role of size in existing trade models. If an exporting country doubles in size, it has twice as
many firms (each with its own foreign contacts) and aggregate exports double. Symmetrically, if an
importing country doubles in size, its aggregate imports double. Note also that as in traditional
trade models, this argument is exact only for the case of small economies far from each other.
If a country becomes a non-negligible fraction of the world, part of world trade will now take
place within its borders, so that the elasticity of aggregate trade with respect to size eventually
decreases below unity for large countries. In addition, if the size of two countries A and B becomes
21

large relative to the distance between them, then the distance between any to locations in those
countries will no longer be approximately equal to the distance between the two countries, and
one would get the illusion that a (trade enhancing) contiguity eﬀect exists.
The role of distance on the other hand is novel compared to existing trade models.
While the exact intuition behind the precise functional forms in Lemma 2 is mathematically
arduous, a simplified explanation would be as follows. Each cohort has a diﬀerent distribution
of contacts. From Equation (16), the distribution of the number of contacts in the population
is a power law. From Equation (17), the variance of the distributions of contacts of each firm
(the average squared distance from the firm’s contacts) is a power function of the number of
contacts of this firm. So the variances of the various distributions of contacts are themselves
power law distributed. It turns out that the aggregation of a family of distributions with power
law distributed variances is approximately a power law. This result is powerful and holds no
matter what the exact shape of each distribution is. In particular, I do not need to impose any
restriction on how distance aﬀects the formation of contacts.13 The result also holds under fairly
more general conditions that the strict conditions I impose on the above model. For instance, I
can relax the simplifying assumption that newborn firms only meet other newborn firms of the
very same age. As long as newborn firms only meet existing firms (of any age) which themselves
know firms a finite (squared) distance away, no matter how large, Equation (17) will hold, and
the main proposition holds. I show formally in the next section 2.3 that it is robust to relaxing
several simplifying assumptions.
The intuition for why a higher , lower

or higher

increase the exponent on distance in

the gravity equation is more straightforward. The contacts of younger firms are geographically
less dispersed than those of older firms. The faster the population growth rate, i.e. the higher
, the more younger firms there are relative to older ones: aggregate trade declines faster with
distance. The less frequently firms acquire new contacts, i.e. the lower , the fewer chances firms
have to expand their network of contacts towards longer distances: firm level and aggregate trade
declines faster with distance.

plays the opposite role to

: the higher , the faster aggregate

trade declines with distance.
13

While I assume that distance aﬀects the creation of initial contacts, I only impose that new contacts are
symmetric (they are equally likely to be formed “eastward” or “westward”), and they occur on average at a finite
(squared) distance. Beyond these two minimal regularity conditions, the relationship can take any arbitrary shape.

22

Proposition 3 shows that the -1 distance elasticity of aggregate trade is related to Zipf’s law for
the distribution of the size of firm level exports. Formally, it is the same assumption that generates
⌘
⇣
⇡ 1+ that also makes aggregate trade
Zipf’s law for the distribution of firm level exports
⌘
⇣
approximately inversely proportional to distance 1 + 2 /(/( ) ) 1 ⇡ 1+ . In this model, firms

that export a lot, i.e. firms with many contacts, are also firms that export far away. The same
parameter condition that gives the highest share of total exports to large firms, Zipf’s law, also
gives the highest share in aggregate exports to firms that export far away. With exports a power
function of distance, this corresponds to the gravity equation with a -1 distance elasticity of trade.
This result however is not tautological. Zipf’s law describes the distribution of total sales of
individual firms within the population, and the gravity equation describe how much a country
exports at various distances. Zipf’s law has nothing to say about where firms sell their output,
and the gravity equation has nothing to say about which firm sells how much. While Zipf’s law is

a statement about how much diﬀerent firms sell, the gravity equation is a statement about where
diﬀerent countries export.14
On a more conceptual level, this model departs from existing traditional models in its treatment
of distance and trade barriers. In existing models, distance captures or proxies physical trade
barriers. In this model, distance captures informational barriers and the network that transmits
information. As in the Krugman (1980) model, the premise of this model is that if left unhindered,
all firms would export to all countries. In the Krugman (1980) model, trade barriers are the only
impediment to trade; they can be circumvented to the extent that firms can cover those trade costs.
In this model on the other hand, while informational barriers can also be circumvented by paying
some direct cost (the g0 function is a very general reduced form for the direct cost of information
acquisition), more importantly, they can be circumvented indirectly when people interact and share
information. This feature implies that information about potential foreign contacts is transmitted
along individual connections. Advances in transportation or communication technologies aﬀect
physical trade barriers, the direct cost of information (the function g0 ), even the frequency of
interactions, but it does not remove the need for direct interactions. A model that only features
direct costs will fail to explain why distance plays the same role today as it did a century ago.
14

The mathematical properties that generate Zipf’s law and the gravity equation are also diﬀerent. Zipf’s law is
derived as the solution to a diﬀerential equation, while the gravity equation is derived from the regularly-varying
property of a sequence of functions. The only direct connection between both results is that the same stationarity
condition is required to get a -1 coeﬃcient for the power law distribution of firm exports and for the distance
elasticity of trade.

23

In this model on the other hand, the shape of aggregate trade flows is immune to changes in the
g0 function. The patterns of trade at the firm level do change with changes in g0 . But if direct
interactions between people play a role today as they did a century ago, this model predicts that
the role of distance in aggregate trade flows will remain essentially unchanged.

2.3

Robustness

I now discuss how my main result are robust to relaxing some of the simplifying assumptions I
made along the way.
I first show that as long as bigger firms export further away on average than smaller firms, and
as long as Zipf’s law for firm sizes holds, the gravity equation holds for aggregate trade. Second, I
allow an active intensive margin of shipments, allowing for instance larger firms to sell more to each
of their contacts. Third, I show how the simplifying assumption that information spreads only
within cohorts can be substantially relaxed without altering the main results. Finally, I present a
very simple example through which the reader can get an intuitive feel for the main results.
Minimal conditions for the gravity equation.— I have presented in sections 1 and 2 a stylized
model of the dynamic formation of a network of input-output linkages. This explicit model sheds
light on many aspects of both firm level and aggregate trade flows, as well as on the structure of
production along complex vertical production chains. To derive the gravity equation in international trade, it is however suﬃcient to verify that Equations (16) and (17) hold. If some readers
are not satisfied with the entire model I presented so far, or if they only care about the gravity
equation, the following proposition oﬀers minimal conditions under which the gravity equation of
international trade obtains.
Proposition 4 If the distribution of firm sizes is Pareto with shape parameter

and if the average

(squared) distance of exports for firms of size K is proportional to K µ , then aggregate trade flows
between two countries A and B are approximately proportional to their respective sizes (GDPA
and GDPB ), and inversely related to the distance between them (DistA,B ),
TA,B /
with ✏ ⌘ 2

1
µ

GDPA ⇥ GDPB
(DistA,B )1+✏

. Furthermore, if the distribution of firm sizes is close to Zipf ’s law ( ⇡ 1+ ) then

aggregate trade is inversely proportional to distance (✏ ⇡ 0+ ).
24

I prove this proposition in the online appendix15 for the special case where the geographic
distribution of firm level exports is approximately Gaussian, and I conjecture that it holds very
broadly. This proposition says that as long as larger firms export further away on average, and as
long as the distribution of firm sizes is close to Zipf’s law, the gravity equation of aggregate trade
flows holds. Given the the relative stability of the distribution of firm sizes over extended periods
of time, this result explains the surprisingly stable role played by geographic distance in shaping
aggregate trade flows. This proposition also shows that the gravity equation ought to hold in any
model that matches the observed average distance of exports across firms of diﬀerent sizes and the
distribution of firm sizes.
Allowing an active intensive margin of shipments.— I have analyzed the trade patterns of the
model of input-output linkages of section 1 under the simplifying assumption that the share ↵
of intermediate inputs in production is a half. Under this simplifying assumption, the size of a
firm in Equation (8) is simply proportional to the number of contacts it has, and all shipments in
Equation (9) are of equal size irrespective of firm sizes. This is obviously a knife-edge simplifying
assumption. I now prove that the main proposition holds when the share of intermediate inputs
↵ takes arbitrary values in (0, 1).
The dynamic acquisition of contacts remains exactly unchanged. The only change when ↵ 6=

1/2 is that the direct connection between a firm’s contacts, its size and the value of its exports,

is lost. When the share of intermediate inputs ↵ diﬀers from a half, the size of a firm’s shipments
to downstream firms and its total sales including those shipments as well as sales to the local
final goods producer are no longer exactly proportional. Combining Equations (8) on sales, (9) on
shipments and (16) on the distribution of contacts, it is obvious that both are Pareto distributed.
But the Pareto exponent for the sales to downstream firms is

(1 ↵)
(2 3↵)(

for total sales including those to the local final goods producer is
are both exponents the same and equal to

) , while the Pareto exponent
(1 ↵)
↵(
) . Only when ↵ = 1/2

. Since I assume that only intermediate inputs are

traded, while the final goods is only produced with locally sourced inputs, it is the former exponent
(1 ↵)
(2 3↵)(

)

which matters for aggregate exports. Combining Equations (9) on shipments and (17)

on the distance of exports, a firm that sells X dollars to downstream firms sells to firms that are
at an average (squared) distance proportional to X (2

(1 ↵)
3↵)(

)

.

Apart from those changes in exponents, Proposition 2 remains unchanged.
15

See https://sites.google.com/site/thomaschaney/Distance_Appendix.pdf.

25

The gravity

equation holds for aggregate exports even when the share ↵ of intermediate inputs is not a
half. ✓Generally, the
◆ distance elasticity of aggregate trade will be equal to 1 + ✏ with ✏ =
(1 ↵)
1
)
. Once again, if the distribution of total sales to downstream firms obeys
2 min (2 3↵)(
(1 ↵)
(2 ⇣
3↵)(
)
⌘
(1 ↵)
+
Zipf’s law (2 3↵)( ) ⇡ 1 , then aggregate trade is approximately inversely proportional to
geographic distance (✏ ⇡ 0+ ).

Allowing between cohorts communication.— The strongest assumption I made is that newborn
firms only connect to other newborn firms, so that information spreads only within cohorts and
never between them. Relaxing this assumption adds a large amount of complexity to the model,
and would prevent me from deriving most of the intermediate results above. It is however possible
to relax this assumption substantially, allowing firms to communicate between cohorts, while still
keeping essentially unchanged Proposition 2, namely the gravity equation for aggregate trade.
The key simplification that this assumption buys is that at age t, a firm communicates with
other firms of the same age t. So if the contacts of this firm are distributed according to ft ,
then all of its contacts have the same distribution ft , where only the coordinates are shifted. If
a firm communicates with firms of diﬀerent ages, then the contacts of its contacts are no longer
distributed according to the same ft , but according to some distribution Ft which represents a
weighted average of the distributions fs of its contacts of various ages s. The weights of those
various fs ’s themselves evolve endogenously as a function of the state of the entire network.
I prove in the online appendix16 that despite this complication, the average squared distance
of exports of all firms still grows exponentially with age, a result equivalent to Equation (17).
According to Proposition 4, this result, along with the very same distribution of firm sizes as in
Equation (16) warrantees that the gravity equation for aggregate trade still holds. In other words,
firms when they are born may form contacts with any subset of the existing set of plants. The
dynamic network of input-output linkages that emerges from this relaxed assumption is vastly
more complex than the one I have analyzed, but the gravity equation for aggregate trade still
holds.
It should be noted however that I still require one very important condition: when a firm is
born, it must form contacts with other firms that export at a finite (squared) distance on average.
This assumption is not innocuous. For instance, a newborn firm cannot sample from the existing
firms according to the actual population weights. If it did, and if the gravity equation were to
16

See https://sites.google.com/site/thomaschaney/Distance_Appendix.pdf.

26

hold in the aggregate, that would mean that the average distance of exports would have to be
infinite: the function 1/x does not have a finite second moment over any open set [a, +1). This
brings a contradiction. In this special case where a newborn firm meets existing firms according
to the population weights, trade can only be inversely proportional to the square of distance, and
only for the knife-edge combination of parameters

(

) =

.17 But as long as newborn

firms form contacts with existing firms that export at a finite (squared) distance on average, the
essential elements of my model are preserved, and the gravity equation holds.
A very simple closed-form example.— To understand on a more intuitive level why the aggregation of a family of distributions with power distributed variances is approximately a power
law itself, consider the following simplified set up: assume that each of these distributions can
be approximated by a uniform distribution. A firm with K contacts with a variance (K) has
h p
i
p
p
(K) over the interval
2
(K), +2
(K) . Only those
therefore a constant density K/4

firms that have contacts distributed with a standard deviation higher than x/2 will export at a
distance x. The aggregate amount exported at a distance x is then the sum (integral) of the

number (density) of contacts of each of those firms. Since the K’s are power law distributed, and
p
(K) are a power function of K, the amount exported is a power function of x (the integral
the
of a power function is a power function). Formally, using Equation (16) for the distribution of
firm sizes, F (K), and Equation (17) for the link between size and distance of exports,

(K),

the fraction (density) of firms that export at a distance x, which I denote ' (x), is given by the
following expression,
⌘ ˆ
⇣
p
(K) /
' x=2

+1

K

4

p

k
(k)

dF (k) /

1
x

1+2

/(
/(

) 1
)

, 8x

p

2

0

The algebra in this very simple example is straightforward. There is no need to use the Laplace
transform of the ft ’s, nor to use Karamata’s Abelian and Tauberian theorem to characterize the
asymptotic behavior of aggregate trade in '. Everything instead is calculated in closed form.
The gravity equation holds exactly for all distances above some minimum threshold, and not only
asymptotically for long distances. I hope this example provides some intuition to the reader.
17

I am grateful to Michal Fabinger for pointing out this case to me.

27

3

Static and dynamic costs of trade disruptions

In this model, strictly speaking, there are in the long run no welfare or eﬃciency gains from
international trade integration, nor any welfare or eﬃciency losess from trade disruptions. There
are however potentially large welfare costs from trade disruptions in the short run. I will first
briefly discuss the long run properties of this model, and then analyze the short and medium run
response to trade shocks.

3.1

The long run (non-existent) gains from trade

The prediction of no gains from trade in the long run is very stark, and comes from the specific
assumptions of the model. It is however worth discussing briefly.
My model is a direct extension of Krugman (1980), but its predictions regarding the long run
gains from trade diﬀer starkly from the classical Krugman model. While in the Krugman model,
in the absence of trade frictions, consumers would purchase all goods produced worldwide, in my
model, even in the absence of any trade frictions, each firm would only purchase a (potentially
small) subset of all intermediate goods available worldwide. This is due to the adjustment cost
function that prevents firms from using too many intermediates at any point in time. The constraint on the use of new intermediate inputs is not external (trade friction prevent firms from
using foreign intermediates), but rather internal (firms choose not to use all intermediates because
of adjustment costs). In that sense, if a large enough country18 were to move to complete autarky,
the eﬃciency of any one firm, and hence aggregate eﬃciency, would not be aﬀected.
This is of course an extreme prediction. It is likely that part of the adjustment cost of bringing
new suppliers into a firm’s production process corresponds to finding the right supplier. To the
extent that a firm needs specific inputs, there may not be an infinite number of potential suppliers
in every location of every country, as I assume. But more constructively, this prediction only holds
in the long run. In the short and medium run, disrupting existing trade linkages can potentially
entail large aggregate welfare and eﬃciency costs. I now turn to the more interesting short run
prediction of my model.
18

Formally, a country is “large” in my model if it contains a positive measure of locations. A “large” country can
therefore be arbitrarily small compared to the size of the world.

28

3.2

The short and medium run cost from trade disruption

This model features complex production chains that cross national boundaries many times. A
disruption to the international flow of goods would aﬀect those production chains adversely. Moreover, since the process of acquiring upstream suppliers and downstream customers is a timely and
costly process, rebuilding the aﬀected segments of those production chains would take time. I
consider now a simple example of such a disruption to the international flow of goods, and analyze
its impact on aggregate welfare, both in the short and in the medium run.
The full model I build in sections 1 and 2 is complex, and ultimately, my ability to derive
analytical solutions to the model rely on some strong simplifying assumptions. The most important
assumption is that of symmetry: a firm of age t not only is connected only to other firms of age t,
but those other firms have the same geographic distribution of contacts, where only coordinates
are shifted. A generic disruption to the flow of goods would break this symmetry assumption: for
instance, if say a large country (a long interval of the real line) were to move to complete autarky,
then firms that are near the international border of that country (near the bounds of the interval)
would be more severely aﬀected than firms in the center of that country (in the middle of the
interval). Since production chains are infinite, diﬀerent segments of those chains would be aﬀected
diﬀerently by such a move to autarky. While this is an interesting example to consider, the added
complexity would force me to make a series of ad hoc statements on all parameters of the model.
I consider instead a simple example of trade disruption. Most of the intuition for a more complex
type of disruption is contained in that example, but the analysis remains simple.
A simple example of trade disruption.— Consider the following unanticipated shock: at a
given point in time, any contact between two firms at a distance from each other greater than x̄
is severed. This shock is similar to a country of size 2x̄ moving to complete autarky, except that
is preserves the geographic symmetry of the system. The lower x̄ is, the more trade is disrupted.
Because older and larger firms are more likely to export over long distances, those firms are
more likely to lose some of their contacts. This direct eﬀect reduces trade. In addition, with the
loss of contacts, the productivity of a firm goes down, so that it produces lower quantities, which
further reduces trade. This aﬀects not only the firm directly, but with each of the supplier of
the firm losing suppliers themselves, this productivity eﬀect is amplified along all the production
chain. As for the direct eﬀect, older and larger firms are connected to more complex production
chains that span wider geographic ranges, so that production and trade along those more complex

29

production chains is more severely aﬀected by trade disruption.
I now characterize all those eﬀects explicitly.
Aggregate welfare before the shock.— Before the shock, in the symmetric equilibrium I consider
in section 1, a firm with K suppliers only buys from other firms with K suppliers, so that the price
each firm along those K-type production chains is explicitly solved for in Equation (6). Along
a balanced growth path equilibrium, the distribution of the number of contacts across firms is
invariant, and only the overall mass of firms grows. All workers worldwide have the same wage,
and their per period utility U depends on this wage w and the local ideal price index P they face,
U = w/P . Aggregate welfare before the shock is,
Ubefore = w/P = w

✓ˆ

p1!

d!

◆

✓

1
1

=w M

ˆ

1

e

t

0

↵
1 ↵

Kt

dt

◆

1
1

(18)

Note that larger firms (larger K’s) contribute more to aggregate welfare, as in any model with
heterogeneous firms such as Melitz (2003). Those firms also export further away on average, so
they will be harder hit by any trade disruption.
Aggregate welfare after the shock.— After the shock, all trade linkages over a distance x̄ are
severed. Because of the presence of adjustment costs, firms that lose their distant contacts will
not instantaneously rebuild those contacts. So upon impact, a fraction of the suppliers of all firms
are simply lost. Losing those suppliers induces a productivity loss, and ultimately, welfare drops
in every location. Aggregate welfare after the shock is,

Uafter = w M

ˆ

0

1

e

t

✓

Kt

ˆ

0

x̄

gt (x) dx

◆ 1 ↵↵

dt

!

1
1

✓

=w M

ˆ

0

1

e

t

⇣

⇣

Kt 1

e

p
x̄/

t

⌘⌘

(19)

Upon impact of the shock, the measure of firms M does not change, as firms have already paid
the sunk entry cost. Because it is normalized, the nominal wage w does not change either. The
only variable that adjusts is the eﬃciency of various firms, as they lose some suppliers from the
disruption of trade linkages.
A firm with Kt suppliers has suppliers distributed over space according to the p.d.f. gt (x).
After the shock hits, this geographic distribution of suppliers is truncated above x̄ as can be seen in
the first equality of Equation (19). Larger firms have more dispersed suppliers, so they will tend to
have a larger fraction of their suppliers at a distance beyond x̄, and they will tend to lose a larger
fraction of their suppliers. This can be seen explicitly in the second equality of Equation (19),
30

↵
1 ↵

dt

◆

1
1

where I use the special closed-form case g0 ⇠ Laplace from proposition 1. A firm with Kt suppliers
away. The more suppliers a firm has,
⇣
p ⌘
x̄/
t
of suppliers that
,
and
the
smaller
is
the
fraction
1
e
t

has contacts that are at an average (squared) distance
the larger Kt , the larger is

t

are at a distance lower than x̄. Larger firms are therefore more aﬀected by trade disruption than
smaller ones. Obviously, because of the roundabout nature of production chains, the higher the
share of intermediate inputs in production, ↵, the larger the welfare cost of trade disruptions, as
the eﬀect of the disruption of input-output linkages for one firm cascading down to its downstream
suppliers gets magnified.
Transitional dynamics.— After the initial shock, new firms enter, and existing firms gradually
rebuild linkages with new suppliers, under the constraint that no supplier can be at a distance
larger than x̄. Both margins, the entry of new firms, and the growth of existing firms, work
together to bring back the economy to a balanced growth path equilibrium.
Analyzing the free entry condition in Equation (11), the drop in the ideal price index due to
the disruption of trade linkages makes entry more profitable, and induces an influx of new firms
at a rate above its steady state. Analyzing the optimal investment equation in Equations (23)

or (24), the fall in the price index increases firm level profits for all firms (⇡), and the loss of
existing contacts (K) increases further the level of profits per supplier (⇡/K) for all firms. Both
forces increase the investment rate for all firms above its steady state level. Moreover, while
profits increase by the same proportional amount for all firms, larger firms (higher K firms) lose
disproportionately more suppliers, so that the profits per supplier increase more for larger firms,
and those firms invest into acquiring new suppliers at a faster rate than smaller firms.
All those forces together, the higher entry rate of new firms, the higher investment rate into
suppliers of existing firms, and all the more so for larger firms that have been harder hit by the
trade disruption, bring back the economy towards its balanced growth path equilibrium. During
the transition, and compared to the balanced growth path equilibrium, there are too many small
firms, and too few large ones. Because of the convexity of the adjustment cost function, firm
growth cannot restore the economy to its balanced growth path instantaneously, and initially, the
entry margin is the most active.
On a more intuitive level, right after the shock hits the world economy, there are “too many”
workers chasing “too few” firms. The entry of new firms and the growth of existing ones restores
the balance between the size of the labor force and the diversity of firms.

31

This analysis of the dynamic response to a trade disruption is but a simple example. It shows
how the model developed in this paper can be used to study several aspects of the dynamic
response to various shocks of an economy characterized by complex vertical production chains. In
the next section, I empirically test some of the main predictions of the model.

4

Empirics

The theoretical model above predicts that if the distribution of firm level total exports is close
to Zipf’s law, and if the average (squared) distance of a firm’s exports is a power function of this
firm’s number of contacts, then aggregate exports follow the gravity equation. The model also
predicts that any deviation away from Zipf’s law should be associated with systematic deviations
away from the -1 elasticity of aggregate trade to distance. I test those two predictions in turn.

4.1

Aggregate trade: Zipf ’s law and the canonical gravity equation

Proposition 3 predicts that if the distribution of firm sizes follows Zipf’s law, then aggregate trade
is inversely proportional to distance.
I test this prediction using data on firm level exports for France in 1992.
First, I confirm that Zipf’s law for the distribution of firm level aggregate exports holds, at
least for the larger firms. Figure 2 shows the relation between the log of the percentile of a firm,
versus the log of its size. The relationship is very close to Zipf’s law for large exporters, with a
power law exponent of -1.0386.19
Second, I confirm that larger firms export over longer distances on average. Following the
guidance of Chaney (2013), I use the number of countries a firm exports to as a proxy for its
number of contacts, and then compute

(K) as the average (squared) distance of export among

firms that export to K foreign markets. Figure 3 shows the relation between the log of the average
(squared) distance from a firm’s exports,

(K), versus the log of the number of foreign countries it

exports to, K. The relationship between

(K) and K is well approximated by a power function,

with a slope equal to .464 (s.e. 0.0108, adj-R2 =95.02%).20
19

I follow Gabaix and Ibragimov (2011) to estimate the power law exponent for the distribution of aggregate
export sizes among the 5% largest French exporters in 1992. Firms are ranked in decreasing size. I estimate by
OLS,
✓
◆
1
ln Ranki
= constant 1.0386 ln (Sizei ) + ✏i , Adj R2 = 99.24%
(0.00185)
2
20

The fact that the relationship is flatter than a straight line in a log-log scale for small K’s can easily be explained

32

Figure 2: The distribution of firm level total exports is Zipf.
Notes: This graph shows on a log-log scale the fraction (in percentiles of the population) of firms that export more
than x as a function of the value x of a firm’s total exports (in million French Francs). This distribution is well
approximated by Zipf’s law for the largest firms, as shown by the straight fitted line in this log-log scale. The
estimated slope is -1.0386 (s.e. 0.00185, adj-R2 =99.24%). Data: French exporters, 1992.

Third, I confirm that aggregate trade for French firms is approximately inversely proportional
to distance. Here, the theory suggests to estimate the impact of distance on aggregate trade in a
somewhat diﬀerent way than what the empirical trade literature typically does. Specifically, the
model predicts that the fraction of number of French firms that export at a distance D should be
approximately proportional to 1/D. To estimate this prediction, I draw concentric circles around
France that are 500km’s apart. Each country in the world falls into one 500km thick band. I then
calculate the total number of French exporters that export to at least one country in each band.
I also calculate the sum of the GDP of all countries in each band. I then estimate by OLS,
ln (N umberb ) = ↵ +

ln (GDPb )

⇣ ln (Distanceb ) + ✏b

if in addition to meeting the contacts of their contacts, all firms also meet some contacts at random. See Chaney
(2013) for a model that incorporates this additional source of contact formation. For larger firms, the contribution
of this additional source of contacts becomes negligible.

33

Figure 3: Average (squared) distance of exports versus number of export destinations.
Notes: This graph shows on a log-log scale the average (squared) distance of exports,

(K), among firms that

export to K foreign countries, as a function of K. The relationship is close to a straight line in this log-log scale,
suggesting that

(K) is well approximated by a power function of K. Distances are measured in thousand km’s.

Data: all French exporters, 1992.

where each b = 1, · · · , 40 corresponds to a 500km’s wide band centered around France, N umberb

is the number of French exporters that export to at least one country in band b, and GDPb is
the sum of the GDP of countries in band b. I find that ⇣ = 1.16 (s.e. 0.15, adj-R2 =37%). The

results are not sensitive to changing the thickness of each band, nor to measuring the nominal
value of exports instead of the number of exporters. Note also that the distance coeﬃcient ⇣
is not materially diﬀerent from the estimate of a more conventional specification for the gravity
equation, where the log of exports between two countries A and B is regressed on the log of their
respective GDP ’s and on the log of the distance between them. This is due to the fact that there
is approximately as much GDP mass for every distances away from France. In other words, from
the point of view of France, there is not more income at a distance d than at any other distance
d0 . Interestingly, this fact happens to be approximately true for most countries in the world.
According to Proposition 3, the distance elasticity of aggregate trade, ⇣, should be directly
34

related to the power law exponent of the distribution of firms’ exports, and to the elasticity of
the average (squared) distance of exports among firms that export to K countries with respect to
K. The estimated elasticities of these two relationships would predict according to my model that
the number of firms that export at a distance Distb should be proportional to 1/Dist1.17
b . In the
data, it is proportional to 1/Dist1.16
b . The elasticity coming from the theory (1.16) is very close
to the elasticity in the data (1.17), so that the prediction of the theory regarding aggregate trade
holds tightly in the data.21
The reader may be concerned that there is something circular in this statement, as I am using
the same data on French exporters exporting to various distances for both the predicted distance
elasticity and the direct empirical measure of this distance elasticity. In the next section, I test a
stricter prediction from the theory, and I use data from diﬀerent sources, so that any suspicion of
circularity ought to be dispelled.

4.2

Sectoral trade: departures from Zipf and the canonical gravity equation

The prediction from the theory is actually more subtle. Not only does the theory predict that if
Zipf’s law for the distribution of firm sizes holds, then aggregate trade is inversely proportional
to distance, but it also predicts that if Zipf’s law for the distribution of firm sizes does not hold,
then one should expect specific departures from the -1 distance elasticity of aggregate trade. This
more nuanced prediction corresponds to Proposition 2.
To test this stronger prediction, I disaggregate my dataset into industrial sectors. While in
the aggregate, Zipf’s law is a good approximation for the distribution of firm sizes, at least among
the largest firms, there are systematic departures away from Zipf’s law across diﬀerent sectors,
as documented for instance in Helpman, Melitz and Yeaple (2004). Formally, Proposition 2 links
the power law exponent for the distribution of firm sizes in sector s and the distance elasticity of
aggregate trade in sector s as follows,
✓
ln Ranksi
ln

1
2

s
XA,B

◆

⇡c

↵s ln (Sizesi ) + ✏si

⇡ c ⇣s ln DistAB + ✏sAB
GDPA GDPB
) + ↵s + ✏s
) ⇣s ⇡ (1

(20)
(21)
(22)

where I disaggregate the data into 42 manufacturing sectors in the year 1992. I estimate those
three equations in turn.
21

The theory predicts that ⇣ = 1 + 2 1.0386
.464

1

⇡ 1.17, compared to the estimated ⇣ ⇡ 1.16 in the data.

35

First, to estimate the power law coeﬃcient for the distribution of firm sizes in Equation (20), I
only use data on French firms. Following Gabaix and Ibragimov (2011), I estimate the probability
that a firm is larger than a given size by the rank of a firm of such size minus

1
2.

I estimate

Equation (20) using OLS separately for each 42 sectors. I run three diﬀerent specifications: first,
I use data on all firms in sector s; second I only use data on the largest 30% of firms within sector
s (I have only 41 sectors with this restricted sample); and third I use only data on the largest 10%
of firms in sector s. These sets of regressions provide me with three alternative series of estimated
↵
ˆs.
Second, to estimate the distance elasticity of trade in Equation (21), I use only data on bilateral
aggregate trade flows between pairs of countries. The data on nominal trade flows comes from
the NBER,22 the data on nominal GDP comes from the Penn World Tables,23 and the data on
bilateral distance between countries comes from the CEPII.24 In order to avoid any endogeneity
problem, I remove France from my sample of countries. I estimate Equation (21) using OLS
separately for each 42 sectors. These regressions provides me with a series of estimated ⇣ˆs .
Third, with the estimates ↵
ˆ s and ⇣ˆs in hand, I can test the main prediction from the theory in
Equation (22). Before doing so, several observations are in order. First, to avoid any endogeneity
problem, I do not use any data on the elasticity of the average (squared) distance of exports with
respect to the number of contacts of a firm. In other words, the power law exponents ↵
ˆ s are
estimated using only data on the total export sales of French firms, and no geographic information
is used. The distance elasticities ⇣ˆs on the other hand are estimated using only data on aggregate
trade flows between countries other than France, and no data on French firms is used. Second,
my identifying assumption is that variations in the elasticity of the average (squared) distance of
exports with respect to the number of export destinations are orthogonal to variations in the firm
size distribution parameter ↵s . Finally, while any measurement error in the LHS variable ⇣ˆs will
be captured by the error term ✏s in Equation (22), I have to account for the fact that the RHS
variable ↵
ˆ s are estimated, and therefore subject to systematic measurement error. I use a very
reduced form approach to address this measurement error issue, and I weight each observation
ˆ s estimated in
↵
ˆ s by its estimated precision, calculated as the inverse of the standard error of ↵
Equation (20). I conjecture that a more systematic GMM estimation procedure would produce
similar results.
22

See Feenstra et al. (2004).
See http://pwt.econ.upenn.edu/.
24
See Mayer and Zignago (2006).
23

36

Table 1: Firm size distribution and the geography of aggregate trade across sectors.
Dep. var.: ⇣ˆs , distance elasticity of aggregate trade

↵
ˆ s (rank-size)
Constant
N. obs.
R2

all firms
(1)
.546*

top 30%
(2)
.224*

top 10%
(3)
.204**

(0.297)

(0.123)

(0.102)

.386**

.465***

.432***

(0.161)

(0.127)

(0.119)

42
0.08

41
0.08

38
0.10

Notes: This table shows the result of the estimation of Equation (22). The dependent variable ⇣ˆs is the estimated
distance elasticity of trade in sector s in 1992, from Equation (21). The explanatory variable ↵
ˆ s is the estimated
power law exponent for the distribution of the size of aggregate exports for French firms in sector s in 1992, from
Equation (20). Each observation is weighted by the estimated precision (inverse of the estimated s.d.) from
Equation (20). Column (1) uses all French firms in sector s to estimate ↵
ˆ s . Column (2) uses only the largest 30%
firms in sector s. Column (3) uses only the largest 10% firms in sector s. *, ** and *** respectively mean
statistically diﬀerent from zero at the 10%, 5% and 1% level of significance.

The estimation results for Equation (22) are presented in Table 1. In all 3 specifications,
a thicker upper tail for the distribution of firm sizes (a smaller ↵
ˆ s ) tends to be systematically
associated with a milder negative impact of geographic distance on aggregate trade flows (a smaller
⇣ˆs ). This is directly in line with the theory which predicts that when large firms account for a larger
share of sales in a sector, aggregate trade will fall oﬀ with distance at a slower pace. Intuitively,
this is simply due to the fact that large firms tend to export over longer distance, so that when
there are more large firms, there is more trade going to distance places, and distance seems to be
less of an impediment to trade in the aggregate.
In all three specifications, the impact of the power law exponent of the firm size distribution
in a sector on the distance elasticity of aggregate trade in that sector has the expected sign, and
is significant at the 10% level when data on all firms are used, and at the 5% level when on the
larger 30 or 10% firms are used. The distribution of firm sizes is typically well approximated by
a power law in the upper tail, but less so in the lower tail. This explains why the results when
all firms are used are less significant. Note also that the R2 for these regressions are low (around
8-10%), as I abstract from any other sources of variation in the role that distance plays in shaping
aggregate trade flows.
37

Conclusion
This paper oﬀers the first theoretical explanation for the gravity equation in international trade.
I explain not only why trade is proportional to size, but also the mysterious -1 distance elasticity
of trade. In my model, larger firms endogenously export over longer distances. The impact of
distance on aggregate trade therefore depends on the shape of the distribution of firm sizes. If
firm sizes are well approximated by Zipf’s law, as the data suggests, then the distance elasticity of
trade ought to be close to -1. This result holds irrespectively of the precise impact of geographic
distance on firm level trade. Unlike in existing models, my explanation is therefore immune to
the critique that the impact of distance on trade ought to change with changes in the technology
for trading goods, in the types of goods traded, in the political barriers to trade, in the set of
countries involved in trade, etc. As long as the individuals that make up firms engage in direct
communication with their clients and suppliers, and as long as information permeates through
these direct interactions, one ought to expect that aggregate trade is close to proportional to
country size and inversely proportional to distance.

References
Acemoglu, Daron, Vasco M. Carvalho, Asuman Ozdaglar and Alireza Tahbaz-Salehi.
2012. “The Network Origins of Aggregate Fluctuations.” Econometrica, 80(5): 1977-2016.
Ahn, JaeBin, Amit K. Khandelwal and Shang-Jin Wei. Forthcoming. “The Role of Intermediaries in Facilitating Trade,” Journal of International Economics.
Anderson, James E. 1979. “A Theoretical Foundation for the Gravity Equation.” American
Economic Review, 69(1): 106–16.
Anderson, James E., and Eric van Wincoop. 2003. “Gravity with Gravitas: A Solution to the
Border Puzzle,” American Economic Review, 93(1): 170–92.
Arkolakis, Costas, Arnaud Costinot and Andres RodrÌguez-Clare. 2012. “New Trade
Model, Same Old Gains?” American Economic Review, 102(1): 94-130.
Atalay, Enghin, Ali Hortaçsu, James W. Roberts, and Chad Syverson. 2011. “Network
Structure of Production.” Proceedings of the National Academy of Sciences, 108(3): 5199-202.
Barabási, Albert-László and Réka Albert. 1999. “Emergence of Scaling in Random Networks,”
Science, 286: 509-12.

38

Chaney, Thomas. 2008. “Distorted Gravity: The Intensive and Extensive Margins of International Trade,” American Economic Review, 98(4): 1707-21.
Chaney, Thomas. 2013. “The Network Structure of International Trade,” Toulouse School of
Economics, mimeo.
Combes, Pierre-Philippe, Miren Lafourcade and Thierry Mayer. 2005. “The Trade-Creating
Eﬀects of Business and Social Networks: Evidence from France,” Journal of International Economics, 66(1):1-29.
de Haan, Laurens. 1976. “An Abel-Tauber Theorem for Laplace Transforms,” Journal of the
London Mathematical Society, s2-13(3): 537-42.
Disdier, Anne-Célia and Keith Head. 2008. “The Puzzling Persistence of the Distance Eﬀect on
Bilateral Trade,” Review of Economics and Statistics, 90(1): 37-48.
di Giovanni, Julian and Andrei A. Levchenko. 2010. “Firm Entry, Trade, and Welfare in Zipf’s
World,” Journal of International Economics, 89(2): 283-96.
Eaton, Jonathan, Marcela Eslava, C.J. Krizan, Maurice Kugler, and James Tybout. 2010.
“A Search and Learning Model of Export Dynamics,” Penn State University, mimeo.
Eaton, Jonathan and Samuel Kortum. 2002. “Technology, Geography, and Trade,” Econometrica, 70(5): 1741–79.
Eaton, Jonathan, Samuel Kortum, and Sebastian Sotelo. 2010. “International Trade: Linking
Micro and Macro,” University of Chicago, mimeo.
Erdös, Paul and Alfréd Rényi. 1959. “On Random Graphs,” Publicationes Mathematicae, 6:2907.
Feenstra, Robert C., Robert E. Lipsey, Haiyan Deng, Alyson C. Ma, and Hengyong Mo.
2004. “World Trade Flows: 1962-2000,” NBER WP 11040.
Gabaix, Xavier. 1999. “Zipf Law for Cities: an Explanation,” Quarterly Journal of Economics,
114(3): 739-67.
Gabaix, Xavier, and Rustam Ibragimov. 2011. “Rank-1/2: A Simple Way to Improve the OLS
Estimation of Tail Exponents,” Journal of Business Economics and Statistics, 29(1): 24-39.
Halpern, Lázló, Miklós Koren and Adam Szeidl. 2009. “Imported Inputs and Productivity,”
Central European University mimeo.
Hayashi, Fumio. 1982. “Tobin’s Marginal q and Average q: A Neoclassical Interpretation,”
Econometrica, 50:213-24.
Helpman, Elhanan, Marc J. Melitz, and Yona Rubinstein. 2008. “Estimating Trade Flows:
39

Trading Partners and Trading Volumes,” Quarterly Journal of Economics, 123: 441-87.
Helpman, Elhanan, Marc J. Melitz, and Stephen Yeaple. 2004. Export Versus FDI with
Heterogeneous Firms,” American Economic Review, 94(1): 300-16.
Melitz, Marc, Elhanan Helpman, and Stephen Yeaple. 2004. Export Versus FDI with Heterogeneous Firms. American Economic Review 94: 300-316.
Krugman, Paul. 1980. “Scale Economies, Product Diﬀerentiation, and the Patterns of Trade,”
American Economic Review, 70(5): 950-59.
Kummer, Ernst Eduard. 1836. “Über die hypergeometrische Reihe 1 +
↵(↵+1)(↵+2) ( +1)( +2) 3
x
1.2.3. ( +1)( +2)

↵
1.

x+

↵(↵+1) ( +1) 2
1.2. ( +1) x

+

+ etc.” (in German). Journal für die reine und angewandte Mathematik,

15: 39–83.
Lucas, Robert E. Jr. 1967. “Adjustment Costs and the Theory of Supply,” Journal of Political
Economy, 75:321-334.
Luttmer, Erzo G. J. 2007. “Selection, Growth, and the Size Distribution of Firms,” Quarterly
Journal of Economics, 122(3): 1103-44.
Mayer, Thierry, and Soledad Zignago. 2006. “Notes on CEPII’s Distances Measures,” mimeo.
McCallum, John. 1995. “National Borders Matter: Canada-U.S. Regional Trade Patterns,”
American Economic Review, 85(3): 615-623.
McPherson, Miller, Lynn Smith-Lovin, and James M. Cook. 2001. “Birds of a Feather:
Homophily in Social Networks,” Annual Review of Sociology, 27: 414-44
Melitz, Marc J. 2003. “The Impact of Trade on Intra-Industry Reallocation and Aggregate
Industry Productivity,” Econometrica, 71(6): 1695-1725.
Romer, Paul M. 1990. “Endogenous Technological Change,” Journal of Political Economy, 98(5):
S71-S102.
Santos Silva, J.M.C. and Silvana Tenreyro. 2006. “The Log of Gravity,” Review of Economics
and Statistics, 88:641-658.
Slater, Lucy Joan. 1966. Generalized Hypergeometric Functions. Cambridge, UK: Cambridge
University Press.
Solow, Robert M. 1956. “A Contribution to the Theory of Economic Growth,” Quarterly Journal
of Economics. 70 (1): 65–94.
Steindl, Josef. 1965. “Random Processes and the Growth of Firms,” Charles Griﬃn, London.
Tinbergen, Jan. 1962. “An Analysis of World Trade Flows,” in Shaping the World Economy,
edited by Jan Tinbergen. New York, NY: Twentieth Century Fund.
40

APPENDIX
A

Mathematical proofs

A.1

Optimal investment

The firm choses an optimal investment policy so as to maximize a discounted sum of profits as in
(10), taking as given the behavior of other firms. For a generic production function and adjustment
cost function, the Lagrangian associated with the firm’s program is,
ˆ +1
⇣
⇣
max L =
e rt ⇡ (Kt ) pI wIt wC (It , Kt ) + t K̇t
It

It

0

Kt

⌘⌘

dt

where ⇡ is the profit function once the optimal choice of spending on labor and intermediate input
has been made, and where I have omitted the proceeds from selling information, which are not
aﬀected by the firm’s choices. The first order conditions for this program are,
(
@L
=0
t
for all t’s, @I
@L
d @L
= dt
@Kt
@ K̇
t

Those conditions along with ˙ = 0 give the following characterization of the optimal investment
choice,
(pI w + wCI ) ( + r) = ⇡K

(23)

wCK

When both the production function and the adjustment cost functions are homogenous, the solution to Equation (23) is such that the investment rate (I/K) is constant and does not depend on
the level of capital K. It is easy to see this result for the special case of a quadratic adjustment
cost function, and the Cobb-Douglas production function I use in Section 1, where closed form
solutions can be derived. Assume the cost of bringing new suppliers into production is,
C (I, K) =

 I2
2K

Then the investment rate (I/K) simply solves,
◆
✓
⇡
I
( + r) = ↵
w pI + 
K
K


w
2

✓

I
K

◆2

(24)

For a given technology, the investment rate I/K is independent of a firm’s size, scaled by K.
Furthermore, if the share of intermediate inputs is
41

1
2,

then profits ⇡ are proportional to the

number of suppliers, K, so that ⇡/K is constant across all firms, and all firms invest at exact the
same rate.25 If one firm finds it optimal to invest at this rate, in a symmetric equilibrium, all
other firms will also invest at the same rate, and the conditions for ⇡/K to be constant are indeed
satisfied. I call the equilibrium investment rate . The measure of supplier of any firm grows at
a constant rate

A.2

.

Formal proofs of all the propositions in the paper

Proposition 5 The geographic distribution of the contacts of a firm of age t is given by,
"
#
K0 e( )t B [g0 (x)]
1
ft (x) = B
(1 e t ) B [g0 (x)] + e t
where B is the two-sided bilateral Laplace transform,26 B

1

its inverse, K0 is the mass of initial

contacts of a newly born firm, g0 is the p.d.f. of these initial contacts,

(resp. ) is the Poisson

birth (resp. death) rate of new (resp. old) contacts.
Proof. Recognizing a convolution product27 in Equation (14), I can rewrite it in a compact
form,
@ft
=
@t

ft ⇤ f t
Kt

(25)

ft

with initial condition f0 = K0 g0 . I will first solve for Kt , and then solve for ft . Integrating
Equation (25) over R, and using the fact that the integral of the convolution of two functions is
the product of their integrals, I derive an ordinary diﬀerential equation for Kt ,
@Kt
=
@t

Kt ⇥ Kt
Kt

Kt = (

) Kt

with initial condition K0 . This ODE admits the simple solution,
Kt = K0 e(

)t

Plugging this result into Equation (25), taking the two-sided Laplace transform of this equation (I
denote by fˆ the transform of f ), and using the convolution theorem which states that the Laplace
25

Generally, when the share of intermediates diﬀers from 12 , firms with a higher ⇡/K invest at a higher rate. This
corresponds to firms with either more customers, or fewer suppliers.
26
The two-sided Laplace transform is closely related to the moment-generating
For a random variable
⇥ function.
⇤
X with a p.d.f. f , the moment generating function µX is defined as µX (s) = E esX , while the Laplace transform
⇥
⇤
´
B [f ] is defined as B [f ] (s) = E e sX = R e sx f (x) dx, so that µX ( s) = B [f ] (s). This definition extends to
positive functions which are not probability densities.
27
Remember that the p.d.f. of the sum of two random variables is the convolution of their p.d.f.’s.

42

transform of the convolution of two function is the product of their Laplace transforms, I get the
following ordinary diﬀerential equation,
@ fˆt
=
@t

fˆt2
K0 e (

fˆt

)t

with initial condition fˆ0 = K0 ĝ0 . This ODE admits the solution,
fˆt =

K0 e( )t ĝ0
(1 e t ) ĝ0 + e

t

Taking the inverse Laplace transform, I recover the proposed solution for ft .

Corollary Equations (15), (16) and (17) are satisfied,
Kt = K0 e( )t
◆
✓
K
F (K) = 1
K0
✓
◆
K
(K) = 0
K0

for K
for K

K0
K0

Proof.
Equation (15). Using the property of the Laplace transform, the total mass of contacts of a
firm of age t, Kt , is the Laplace transform fˆt (s) evaluated at zero,
Kt = fˆt (0) = K0 e(

)t

where I used the fact that since g0 is a well defined p.d.f. that sums up to 1, ĝ0 (0) = 1.
Equation (16). The formula for Kt provides the following relation between a firm’s number
of contacts and its age,
t

e =

✓

The population grows at an exponential rate
1

e

t

Kt
K0

◆

1

so that the fraction of firms younger than t is

. Since a firm of age t has a total number of contacts Kt , using the above expression

for et , I get the proposed formula for the fraction of firms with fewer than K contacts,
✓
◆
K
F (K) = 1
K0
Equation (17). The average (squared) distance between a firm of age t and its contacts,
t,

is the variance of the p.d.f. ft /Kt of the distribution of this firm’s contacts. Again using
43

the property of the Laplace transform, this variance is simply the second derivative of f\
t /Kt (s)
evaluated at zero. Simple algebra gives this second derivative,
⇣
2ĝ00 (s)2 e
e t ĝ0 ” (s) e t 1 ĝ0 e t
\
ft /Kt ” (s) =
3
((e t 1) ĝ0 (s) e t )

t

1

⌘

Since g0 is a well defined symmetric p.d.f. with finite variance, I can use the following properties
of its Laplace transform: ĝ0 (0) = 1 (a p.d.f. sums up to 1), ĝ00 (0) = 0 (g0 is symmetric) and
ĝ0 ” (0) =

0

(g0 has a finite variance

0 ).

The previous expression evaluated at zero simplifies

into the proposed formula,
t

= f\
t /Kt ” (0) =
1

Plugging the expression et = (Kt /K0 )

0e

t

into the above formula for

t,

I derive the proposed

relationship between a firm’s total number of contacts K and the average (squared) distance from
its contacts,

(K),
(K) =

0

✓

K
K0

◆

Proposition 1 (reminded) The distribution of a firm’s contacts,

ft
Kt ,

converges when t grows

large to a Laplace distribution (a 2-sided exponential),
⇣
⌘
p
ft (x)
⇠ Laplace 0, e t/2
/2
0
Kt t!1
⇣ p
⌘
/2
.
This property holds exactly for all t’s if g0 ⇠ Laplace 0,
0
p

p

Proof. For simplicity, I normalize
0 /2

6= 1.

0 /2

= 1. The proof can trivially be extended to

First consider the special case where g0 is a normalized Laplace distribution, g0 ⇠ Laplace (0, 1).

The Laplace transform of g0 is ĝ0 (s) =
then,
ĝt (s) =

1
.
1+s2

fˆt (s)
=
Kt
(1

e

From Proposition 5, the Laplace transform of g is

ĝ0 (s)
t ) ĝ (s)
0

+e

t

=

where one recognizes the Laplace transform of a Laplace 0, e

1
1+ e
t/2

t/2 s 2

distribution.

Consider now the general case where g0 is not Laplace. I need to prove that,
8
1
<ĝt (s)
/
2
t!1 1+(e t/2 s)
:gt (x)
/ 2e 1t/2 exp
|x| /e t/2
t!1

44

From Equation (25), I derive an ordinary diﬀerential equation for ĝt ,
@
ĝt =
@t

ĝt2

Now postulate that ĝt is of the form ĝt (s) = h e
derive a partial diﬀerential equation for h (y, t),
✓
@
h=
h2
@t
Accepting that limt!1

@
@t h

ĝt
t/2 s, t

. Then from the previous equation I
◆

1 @
h+ y h
2 @y

= 0, h must asymptotically satisfy the following ODE,
1 @
y h=h
2 @y

h2

which admits the solution,
h (y) =

1
1 + y2

This completes the proof.
Proposition 2 (reminded) For any distribution g0 of initial contacts that is symmetric and
admits a finite variance, aggregate trade flows between two countries A and B are approximately
proportional to their respective sizes (GDPA and GDPB ), and inversely related to the distance
between them (DistA,B ),

with ✏ ⌘ 2 min

⇣

rate of contacts.

(

)

⌘
,1 ,

TA,B /

GDPA ⇥ GDPB
(DistA,B )1+✏

the population growth rate and

(resp.

) the birth (resp. death)

Proof. I will prove first that aggregate trade is proportional to economic size, and second that
it is inversely proportional to distance raised to the power (1 + ✏).
Size: In any location x, all firms of the same age t have the same volume of exports towards
and the same volume of import from any other location. For any
of locations (any country) produces

> 0, if a location, or any set

times as much in the aggregate, it will export and import

times as much in the aggregate. Aggregate trade flows between any arbitrary set of locations
(countries) are therefore proportional to the size of the importing and exporting countries.
Distance: Denote by ' (x) the p.d.f. of aggregate exports from the origin towards any location
x 2 R. It is the weighted average of the exports of firms in the origin of all ages towards location

x, normalized to sum up to 1,

' (x) ⌘

+
K0

ˆ

0

45

1

e

t

ft (x) dt

I will prove that ' (x) is equal to 1/x1+✏ for x ! +1, up to a slowly varying function L,28
' (x) = L (x) ⇥

1
x1+✏

Step 1: By virtue of Karamata’s abelian and tauberian theorem, the p.d.f. ' (x) is equal to
1/x1+✏ for x ! +1, up to a slowly varying function i.i.f. its Laplace transform 'ˆ is such that
'ˆ (s) is equal to s✏ for s ! 0, up to a slowly varying function. See for instance de Haan (1976)

1

for an application of Karamata’s theorem to p.d.f.’s. Formally, this means that I need to prove,
lim
s#0

1 'ˆ ( s)
=
1 'ˆ (s)

✏

,8 > 0

Step 2: Taking the two-sided Laplace transform of ' which I denote by ',
ˆ and using the
properties of the Laplace transform, the formula for ft in Proposition 5 and simple algebra, I get,
ˆ 1
+
'ˆ =
e t fˆt dt
K0
0
ˆ 1
K0 e( )t ĝ0
+
=
e t
dt
K0
(1 e t ) ĝ0 + e t
0
ˆ 1
ĝ0
=(
+ )
e ( ⇡+ )t t
dt
e (1 ĝ0 ) + ĝ0
0
⇣
⌘n
ĝ0
1
X
ĝ0 1
+
=
n+(
+ )/
n=1

where I iteratively integrate by part to get the last expression.
Step 3: To save on notations, I introduce ↵ = ( ) so that ✏ = 2 min [↵, 1]. Manipulating
the previous expression ',
ˆ recognizing Gauss’s hypergeometric function 2 F1 , and invoking one
28

A function L is said to be slowly varying around +1 i.i.f.
lim

x!+1

L ( x)
= 1, 8 > 0
L (x)

46

among the hundreds of useful properties of this function,29 I get,
1

'ˆ (s) = 1 + ↵

1
X

⇣

ĝ0 (s)
ĝ0 (s) 1

⌘n

n+↵
✓
◆n
(1)n (↵)n
ĝ0 (s)
=
(1 + ↵)n n! ĝ0 (s) 1
n=0
◆
✓
ĝ0 (s)
= 2 F1 1, ↵, 1 + ↵,
ĝ0 (s) 1
✓
◆
ĝ0 (s)
(↵ 1) (1 + ↵)
=
(↵) (↵)
ĝ0 (s) 1
✓
◆
ĝ0 (s)
(1 ↵) (1 + ↵)
+
(1) (1)
ĝ0 (s) 1
n=1

1
X

✓
◆
(1)k (1 ↵)k
ĝ0 (s)
k!(2 ↵)k
ĝ0 (s) 1
k=0
✓
◆ k
1
↵X
(↵)k (0)k
ĝ0 (s)
k!(↵)k
ĝ0 (s) 1
1
1X

k

k=0

ĝ0 (s)
> 1 and a non-integer ↵
for a suﬃciently small s such that
ĝ0 (s) 1
✓
◆ 1
◆ 1!
✓
ĝ0 (s)
↵
ĝ0 (s)
=
↵, 2 ↵,
+ (1
2 F1 1, 1
↵ 1
ĝ0 (s) 1
ĝ0 (s) 1

↵) (1 + ↵)

✓

ĝ0 (s)
ĝ0 (s) 1

Step 4: The following lemma will prove useful. If g is the p.d.f. of a random variable X
symmetric around the origin and with a finite variance 0 < V ar (X) < +1, then its Laplace
transform ĝ is such that for any

> 0,
1 ĝ( s)
ĝ( s)
lim 1 ĝ(s)
s#0
ĝ(s)

=

2

To prove this lemma, note that g being a well defined p.d.f., ĝ (0) = 1. Using l’Hôpital’s rule,
1 ĝ( s)
ĝ( s)
lim 1 ĝ(s)
s#0
ĝ(s)

= lim
s#0

1 ĝ ( s) ĝ (s)
=
1 ĝ (s) ĝ ( s)

@
@s ĝ ( s)
s#0 @ ĝ (s)
@s

lim

I use the known result that ĝ (k) (0) = ( 1)k µk where µk is X’s k-th moment. Since X is symmetric,
its first moment is zero, and ĝ 0 (0) = µ1 = 0. The limit is again indeterminate. Applying l’Hôpital’s
rule a second time, and by the assumption 0 < V ar (X) = µ2
proposed lemma,
@
ĝ ( s)
lim @s@
s#0
@s ĝ (s)

=

2

@2
ĝ ( s)
@s2
lim @ 2
s#0
ĝ (s)
@s2

=

2 µ2

µ2

µ21 = µ2 < +1, I prove the

=

2

Note that the assumption of finite variance is a suﬃcient but not a necessary condition. For
example, Student’s t-distribution with 2 degrees of freedom satisfies the desired property although
its variance is infinite.
29
See http://functions.wolfram.com/HypergeometricFunctions/Hypergeometric2F1/02/02/ or a modified
version of Kummer’s Theorem (1836), as presented by Slater (1966) in Equation 1.7.1.3 on page 31.

47

◆

↵

⇣
⌘ 1
ĝ0 (s)
0 (s)
Step 5: Let h(s) =
= ĝ0ĝ(s)
'ˆ (0) = 0. Using
ĝ0 (s) 1
1 and note that h(0) = 0 and 1
l’Hôpital’s rule and the above lemma for the penultimate equality, I can now characterize the limit
of interest,
@
'(
ˆ s)
'(
ˆ s)
= lim @s@
s#0
s#0
'ˆ (s)
ˆ
@s '(s)
h
i
@
↵
↵, 2 ↵, h( s)) + 2 ↵↵ h( s)2 F1 (2, 2 ↵, 3 ↵, h( s)) + (1 ↵) (1 + ↵)↵(h( s))↵ 1
@s h( s) ↵ 1 2 F1 (1, 1
h
i
= lim
@
↵
s#0
↵, 2 ↵, h(s)) + 2 ↵↵ h(s)2 F1 (2, 2 ↵, 3 ↵, h(s)) + (1 ↵) (1 + ↵)↵(h(s))↵ 1
@s h(s) ↵ 1 2 F1 (1, 1
(
2
when ↵ > 1 so that the second and third terms vanish
=
2↵
when ↵ < 1 so that the first and second terms vanish

lim

1
1

=

✏

This completes the proof.
Proposition 3 (reminded) If the distribution of export sizes among individual firms is close
to Zipf ’s law, then aggregate trade flows between two countries are approximately proportional to
their respective sizes and inversely proportional to the distance between them. The canonical gravity
equation holds,
TA,B /

GDPA ⇥ GDPB
DistA,B

Proof. From Equation (16), the distribution of export volumes among individual firms is close
to Zipf’s law if

⇡ 1+ . Plugging this condition into Proposition 2, one gets ✏ ⇡ 0+ , so that the

canonical gravity equation holds for aggregate trade flows.

B

Data

Firm level export data: The data on firm level exports come from the French customs, and
are described in greater detail in Eaton, Kortum and Kramarz (2011). Until 1992, all shipments
crossing the French border are reported, either by the owner of the (exporting) firm, or by authorized customs commissioners. Information about the identity of the exporting firm, the value of
the shipment, the industrial sector, and the destination country is recorded. This information is
then aggregated over a year. I use data on all French exporters. A data point is therefore a firm,
year, destination country and value of exports (in French Francs) vector.
Distance data: I use data on bilateral distances between countries collected and constructed
by the CEPII. The distance between two countries is calculated as a weighted arithmetic average
48

of the geodesic distances between the main cities in these countries, where population weights are
used. Data on the location of the main cities in each country (latitude and longitude), as well as
the population of those main cities are used to compute those distances. The construction of the
data is described in further detail by Mayer and Zignago (2006).
Country size data: I use as a measure of a country’s size its nominal GDP (in million US$)
in the current year. The data are collected from the Penn World Tables and are described in
further detail at http://pwt.econ.upenn.edu/.
Bilateral trade flows: To proxy for the intensity of firm level contacts between countries
other than France, I use data on bilateral trade flows between countries. The data correspond to
the nominal value (in US$) of aggregate trade flows between country pairs. The data are collected
from the NBER, and are described in further detail in Feenstra et al. (2004).

49

