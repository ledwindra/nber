NBER WORKING PAPER SERIES

ESTIMATING STATIC MODELS OF
STRATEGIC INTERACTION
Patrick Bajari
Han Hong
John Krainer
Denis Nekipelov
Working Paper 12013
http://www.nber.org/papers/w12013
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2006

The application in this paper is based on an earlier draft, by Bajari and Krainer â€œAn Empirical Model of
Stock Analystsâ€™ Recommendations: Market Fundamentals, Conflicts of Interest, and Peer Effects.â€ Bajari
and Hong would like to thank the National Science Foundation for genereous research support. The views
expressed in this paper are those of the authors and not necessarily those of the Federal Reserve System. We
thank Ulrich Doraszelski and participants at various seminars for helpful comments. The views expressed
herein are those of the author(s) and do not necessarily reflect the views of the National Bureau of Economic
Research.
Â©2006 by Patrick Bajari, Han Hong, John Krainer, and Denis Nekipelov. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including Â© notice, is given to the source.

Estimating Static Models of Strategic Interaction
Patrick Bajari, Han Hong, John Krainer and Denis Nekipelov
NBER Working Paper No. 12013
January 2006
JEL No. L0, L5, C1
ABSTRACT
We propose a method for estimating static games of incomplete information. A static game is a
generalization of a discrete choice model, such as a multinomial logit or probit, which allows the
actions of a group of agents to be interdependent. Unlike most earlier work, the method we propose
is semiparametric and does not require the covariates to lie in a discrete set. While the estimator we
propose is quite flexible, we demonstrate that in most cases it can be easily implemented using
standard statistical packages such as STATA. We also propose an algorithm for simulating the model
which finds all equilibria to the game. As an application of our estimator, we study recommendations
for high technology stocks between 1998-2003. We find that strategic motives, typically ignored in
the empirical literature, appear to be an important consideration in the recommendations submitted
by equity analysts.
Patrick Bajari
Department of Economics
University of Michigan
266 Lorch Hall
611 Tappan Street
Ann Arbor, MI 48109-1220
and NBER
bajari@umich.edu
Han Hong
Duke University
han.hong@duke.edu
John Krainer
Federal Reserve Bank of San Francisco
john.krainer@sf.frb.org
Denis Nekipelov
Duke University
denis.nekipelov@duke.edu

1

Introduction

Game theory is one of the most commonly applied tools in economic theory, with substantive
applications in all major ï¬elds in economics. In some ï¬elds, particularly industrial organization,
game theory has not only transformed the analysis of market interactions, but also serves as an
important basis for policy recommendations. Given the importance of gaming in economic theory,
it is not surprising that the empirical analysis of games has been the focus of a recent literature in
econometrics and industrial organization.
In much of the literature, a discrete game is modeled much like a standard discrete choice
problem, such as the multinomial logit. An agentâ€™s utility is often assumed to be a linear function
of covariates and a random preference shock. However, unlike a discrete choice model, utility
is also allowed to depend on the actions of other agents. A discrete game strictly generalizes a
standard random utility model, but does not impose the often strong assumption that agents act
in isolation. Early attempts at the econometric analysis of such games included Bjorn and Vuong
(1984), Bresnahan and Reiss (1991a), Bresnahan and Reiss (1991b). Other recent examples include
Haile, Hortacsu, and Kosenok (2003), Aradillas-Lopez (2005), Ho (2005), Ishii (2005), Pakes, Porter,
Ho, and Ishii (2005), Augereau, Greenstein, and Rysman (2005), Seim (2005), Sweeting (2005) and
Tamer (2003).
An important insight in the recent literature is that it is often most straightforward to estimate
discrete games in two steps. For examples see Aguirregabiria and Mira (2002), Bajari, Benkard, and
Levin (2004), Berry, Pakes, and Ostrovsky (2003) and Pesendorfer and Schmidt-Dengler (2003).
In a ï¬rst step, the economist estimates the reduced forms implied by the model. This often boils
down to using standard econometric methods to estimate the probability that one, out of a ï¬nite
number of possible choices, is observed conditional on the relevant covariates. In the second step,
the economist estimates a single agent random utility model, including as controls the equilibrium
beliefs about the behavior of others from the ï¬rst step.
In this paper, we propose an estimator that can be applied to static games of strategic interaction. Like the two-step approach discussed above, we estimate the reduced form choice probabilities
in a ï¬rst stage in order to simplify the estimation of the model. The approach that we propose,
however, diï¬€ers from earlier work in four ways. First, much of the earlier literature on two step
estimation considered fully dynamic games. This made it diï¬ƒcult for researchers unfamiliar with
dynamic programming to understand how to estimate a game. Also, we note that to date, the majority of empirical applications of discrete games have been static. Therefore, proposing methods
for static games is of practical importance for many researchers.
Second, the approach that we propose can be done nonparametrically or semiparametrically.

2

Much of the earlier literature on two-step estimation of games considered the case where the set
of regressors was discrete or the ï¬rst stage was a correctly speciï¬ed parametric model. In this
paper, we allow for continuous covariates and a fully nonparametric ï¬rst stage. We establish
two useful properties of this estimator. First, despite the fact the ï¬rst stage is nonparametric
and might converge at a slow rate, the structural parameters estimated in the second stage have
normal asymptotics and converge at a rate proportional to the square root of the sample size.
This follows from arguments based on Newey (1994). Second, we demonstrate in many cases our
model can be estimated, with correct standard errors, using a two stage least squares procedure in
a standard statistical package like STATA. We hope that the simplicity of this approach will make
the estimation of these models accessible to a larger audience of researchers. In Bajari and Hong
(2004) we demonstrate that the ideas in this paper can be generalized to dynamic games. However,
this estimator is more diï¬ƒcult to implement and requires quite distinct econometric arguments.
Third, we consider the problem of identiï¬cation in games with continuous state variables. Our
results, as in Bajari and Hong (2004), show that a suï¬ƒcient condition for identiï¬cation is to
exclude payoï¬€ relevant covariates for a particular player i from the utilities of the other players.
For instance, in an entry model, if the productivity shock of ï¬rm i inï¬‚uences its own entry decision,
but only indirectly inï¬‚uences the entry decisions of other players, then our results imply that the
model is identiï¬ed. An alternative identiï¬cation strategy is to search for events that change which
equilibrium to the game is played, but otherwise do not inï¬‚uence payoï¬€s. Our results can be
interpreted as standard rank conditions for an appropriately deï¬ned linear system. We note that
Pesendorfer and Schmidt-Dengler (2003) demonstrate that exclusion restrictions are suï¬ƒcient for
identiï¬cation in a particular set of entry games with discrete states. Sweeting (2005) demonstrates
that multiplicity of equilibrium can assist with identiï¬cation in a symmetric location game.
Finally, we consider the problem of simulating the model, which is required to study predictions
of the model such as counterfactuals. It is widely known that models of the form that we consider
can generate multiple solutions. However, outside of certain speciï¬c examples (e.g., those studied
in Sweeting (2005)), it is not possible to analytically derive all of the solutions of the model or
even to determine the number of possible solutions. Therefore, we propose an algorithm that can
compute all of the equilibria to the model. This algorithm uses the â€œall solutions homotopyâ€, which
is available in standard numerical libraries such as hompack. Therefore, we can use this to ï¬nd the
entire set of equilibrium actions at our estimated parameter values. We discuss the potential uses
of this algorithm in our application.
As an application of our methods, we model the determination of stock recommendations (e.g.
strong buy, buy, hold, sell) issued by equity analysts for high technology stocks listed in the NASDAQ 100 between 1998 and 2003. The determination of recommendations during this time period
3

is of particular interest in the wake of the sharp stock price declines for technology ï¬rms in 2000.
Recommended stocks underperformed the market as a whole during this period by a wide margin.
Highly-publicized allegations of conï¬‚icts of interest have called into question whether analysts were
more concerned with helping their ï¬rms win investment banking business than with producing
accurate assessments of the prospects for the ï¬rms under scrutiny. While there is a fairly large
literature in ï¬nance on recommendations, we are not aware of any papers that formally consider
the simultaneity of recommendations due to strategic motives.
In our model, recommendations submitted by analysts depend on four factors. First, recommendations must depend on fundamentals and commonly shared expectations about the future
proï¬tability of the ï¬rm. These expectations will be embedded in the stock price. Second, analysts
are heterogeneous, both in terms of talent and perhaps in terms of access to information. We try to
capture an individual analystâ€™s private belief about the stock by looking at the diï¬€erence between
the quarterly earnings forecast submitted by the analyst (or the analystâ€™s brokerage ï¬rm) and the
distribution of forecasts from other ï¬rms. Mindful of the large number of inquiries into possible
conï¬‚icts of interest among research analysts, we include as a third factor a dummy variable for an
investment banking relationship between the ï¬rm and the analystâ€™s employer.
Finally, we consider the inï¬‚uence of peers on the recommendation decision. Peer eï¬€ects can
impact the recommendation in diï¬€erent ways. Individual analysts have incentive to condition their
recommendation on the recommendations of their peers, because even if their recommendations
turn out to be unproï¬table ex-post, performance evaluation is typically a comparison against the
performance of peers. More subtly, recommendations are relative rankings of ï¬rms and are not
easily quantiï¬able (or veriï¬able) objects. As such, ratings scales usually reï¬‚ect conventions and
norms. The phenomenon is similar to the college professorâ€™s problem of assigning grades. If a
professor were to award the average student with a C while other faculty give a B+ to the average
student, the professor might incorrectly signal his views of student performance. Even while there
is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance.
Similarly, analysts might have an incentive to benchmark their recommendations against perceived
industry norms.
The paper is organized as follows. In section 2 we outline the general economic environment.
For purposes of exposition, we develop many of the key formulae within the context of a simple
entry model. In section 3 we discuss the problem of nonparametric identiï¬cation. In section 4 we
show how to derive nonparametric and semiparametric estimates of the structural parameters for
our class of models. Section 5 describes the all solutions homotopy algorithm for simulating the
model. Section 6 contains the empirical application to equity analyst recommendations. Section 7
4

concludes the paper.

2

The model

In the model, there are a ï¬nite number of players, i = 1, ..., n and each player simultaneously
chooses an action ai âˆˆ {0, 1, . . ., K} out of a ï¬nite set. We restrict players to have the same set of
actions for notational simplicity. However, all of our results will generalize to the case where all
players have diï¬€erent ï¬nite sets of actions. Let A = {0, 1, . . ., K}n denote the vector of possible
actions for all players and let a = (a1 , ..., an) denote a generic element of A. As is common in the
literature, we let aâˆ’i = (a1 , ...aiâˆ’1, ai+1 , ..., an) denote a vector of strategies for all players excluding
player i. We will abstract from mixed strategies since in our model, with probability one each player
will have a unique best response.
Let si âˆˆ Si denote the state variable for player i. Let S = Î i Si and let s = (s1 , ..., sn) âˆˆ S
denote a vector of state variables for all n players. We will assume that s is common knowledge to
all players in the game and in our econometric analysis, we will assume that s is observable to the
econometrician. The state variable is assumed to be a real valued vector, but Si is not required to
be a ï¬nite set. Much of the previous literature assumes that the state variables in a discrete games
lie in a discrete set. While this assumption simpliï¬es the econometric analysis of the estimator and
identiï¬cation, it is a strong assumption that may not be satisï¬ed in many applications.
For each agent, there are also K + 1 state variables which we label as i (ai ) which are private information to each agent.

These state variables are distributed i.i.d. across agents and

actions. Let i denote the 1 Ã— (K + 1) vector of the individual i (ai ). The density of i (ai ) will
be denoted as f (i (ai)). However, we shall sometimes abuse notation and denote the density for
Îµi = (Îµi (0), ..., Îµi(K)) as f (i ).
The period utility function for player i is:
ui (a, s, i; Î¸) = Î i (ai , aâˆ’i , s; Î¸) + i (ai ).

(1)

The utility function in our model is similar to a standard random utility model such as a multinomial
logit. Each player i receives a stochastic preference shock, i (ai ), for each possible action ai . In
many applications, this will be drawn from an extreme value distribution as in the logit model.
In the literature, the preference shock is alternatively interpreted as an unobserved state variable
(see Rust (1994)). Utility also depends on the vector of state variables s and actions a through
Î i (ai , aâˆ’i , s; Î¸). For example, in the literature, this part of utility is frequently parameterized as
a simple linear function of actions and states. Unlike a standard discrete choice model, however,
note that the actions aâˆ’i of other players in the game enter into iâ€™s utility. A standard discrete
5

choice model typically assumes that agents i act in isolation in the sense that aâˆ’i is omitted from
the utility function. In many applications, this is an implausible assumption.
In this model, player iâ€™s decision rule is a function ai = Î´i (s, i ). Note that iâ€™s decision does not
depend on the âˆ’i since these shocks are private information to the other âˆ’i players in the game
and hence unobservable to i. Deï¬ne Ïƒi (ai|s) as:

Ïƒi (ai = k|s) = 1 {Î´i (s, i ) = k} f (i )di .

(2)

In the above expression, 1 {Î´i (s, i) = k} is the indicator function that player Ä±Ìâ€™s action is k given
the vector of state variable (s, i ). Therefore, Ïƒi (ai = k|s) is the probability that i chooses action
k conditional on the state variables s that are public information. We will deï¬ne the distribution
of a given s as Ïƒ(a|s) = Î ni=1 Ïƒ(ai|s).
Next, deï¬ne Ï€i (ai, s, i ; Î¸) as:
Ï€i (ai , s, i ; Î¸) =



Î i (ai , aâˆ’i , s; Î¸)Ïƒâˆ’i(aâˆ’i |s) + i (ai )

(3)

where Ïƒâˆ’i (aâˆ’i |s) = Î j=i Ïƒj (aj |s).

(4)

aâˆ’i

In (3), Ï€i (ai , s, i; Î¸) is player iâ€™s expected utility from choosing ai when the vector of parameters is
Î¸. Since i does not know the private information shocks, j for the other players, iâ€™s beliefs about

their actions are given by Ïƒâˆ’i (aâˆ’i |s). The term
aâˆ’i Î i (ai , aâˆ’i , s, Î¸)Ïƒâˆ’i(aâˆ’i |s) is the expected
value of Î i (ai , aâˆ’i , s; Î¸), marginalizing out the strategies of the other players using Ïƒâˆ’i (aâˆ’i |s). The
structure of payoï¬€s in (3) is quite similar to standard random utility models, except that the
probability distribution over other agentsâ€™ actions enter into the formula for agent iâ€™s utility. Note
that if the error term has an atomless distribution, then player iâ€™s optimal action is unique with
probability one. This is an extremely convenient property and eliminates the need to consider
mixed strategies as in a standard normal form game.
We also deï¬ne the deterministic part of the expected payoï¬€ as
Î i (ai , s; Î¸) =



Î i (ai , aâˆ’i , s, Î¸)Ïƒâˆ’i(aâˆ’i |s).

(5)

aâˆ’i

It follows immediately then that the optimal action for player i satisï¬es:

Ïƒi (ai|s) = P rob {i |Î i (ai , s; Î¸) + i (ai ) > Î i (aj , s; Î¸) + i (aj ) for j = i.}

6

(6)

2.1

A Simple Example.

For expositional clarity, consider a simple example of a discrete game. Perhaps the most commonly
studied example of a discrete game in the literature is a static entry game (see Bresnahan and
Reiss (1991a), Bresnahan and Reiss (1991b),Berry (1992), Tamer (2003), Ciliberto and Tamer
(2003), Manuszak and Cohen (2004)). In the empirical analysis of entry games, the economist
typically has data on a cross section of markets and observes whether a particular ï¬rm, i, chooses
to enter a particular market. In Berry (1992) and Ciliberto and Tamer (2003), for example, the
ï¬rms are major U.S. airlines such as American, United and Northwest and the markets are large,
metropolitan airports. The state variables, si might include the population in the metropolitan
area surrounding the airport and measures of an airlineâ€™s operating costs. Let ai = 1 denote the
decision to enter a particular market and ai = 0 denote the decision not to enter the market. In
many applications, Î i (ai , aâˆ’i , s; Î¸) is assumed to be a linear function, e.g.:
s Â· Î² + Î´
Î i (ai , aâˆ’i , s; Î¸) =



1 {aj = 1} if ai = 1
(7)

j=i

0 if ai = 0
In equation (7), the mean utility from not entering is set equal to zero.2 The term Î´ measures the
inï¬‚uence of jâ€™s choice on iâ€™s entry decision. If proï¬ts decrease from having another ï¬rm enter the
market then Î´ < 0. The parameters Î² measure the impact of the state variables on Î i (ai , aâˆ’i , s).
The random error terms Îµi (ai ) are thought to capture shocks to the proï¬tability of entry that
are private information to ï¬rm i. Suppose that the error terms are distributed extreme value.
Then, utility maximization by ï¬rm i implies that:
exp(s Â· Î² + Î´
Ïƒi (ai = 1|s) =



Ïƒj (aj = 1|s))

j=i

1+

exp(s

Â·Î²+Î´



Ïƒj (aj = 1|s))

for i = 1, ..., n

(8)

j=i

In the system of equations above, applying the formula in equation (5) implies that Î i (ai , s; Î¸) =

s Â· Î² + Î´ Ïƒj (aj = 1|s). Since the error terms are distributed extreme value, equation (6) implies
j=i

that the choice probabilities, Ïƒi (ai = 1|s) take a form similar to a single agent multinomial logit
model. We note in passing that it can easily be shown using Brouwerâ€™s ï¬xed point theorem an
equilibrium to this model exists for any ï¬nite s (see McKelvey and Palfrey (1995))).
We exploit the convenient representation of equilibrium in equation (8) in our econometric
analysis. Suppose that the econometrician observes t = 1, ..., T repetitions of the game. Let ai,t
2

We formally discuss this normalization in our section on identiï¬cation.

7

denote the entry decision of ï¬rm i in repetition t and let the value of the state variables be equal
to st . By observing entry behavior in a large number of markets, the econometrician could form a
consistent estimate Ïƒ
i (ai = 1|s) of Ïƒi (ai = 1|s) for i = 1, ..., n. In an application, this simply boils
down to ï¬‚exibly estimating the probability that a binary response, ai is equal to one conditional
on a given set of covariates. This could be done using any one of a number of standard techniques.
We let L(Î², Î´) denote the pseudo-likelihood function deï¬ned as:
â›

L(Î², Î´) =

T 
n

t=1i=1

exp(s Â·Î²+Î´



ÏƒÌ‚j (aj =1|s))

âœ
j=i
âœ
â 1+exp(s Â·Î²+Î´ÏƒÌ‚

j (aj

â1{ai,t =1} â›

âŸ
âŸ
â 
=1|s))

âœ
âœ1 âˆ’
â

j=i

exp(s Â·Î²+Î´



ÏƒÌ‚j (aj =1|s))

j=i
1+exp(s Â·Î²+Î´



ÏƒÌ‚j (aj

â1{ai,t =0}

âŸ
âŸ
â 
=1|s))

j=i

Given ï¬rst stage estimates of Ïƒ
i (ai = 1|s), we could then estimate the structural parameters of the payoï¬€,
Î² and Î´, by maximizing the above pseudo-likelihood function. There are two attractive features of this
strategy. The ï¬rst is that it not demanding computationally. First stage estimates of choice probabilities
could be done using a strategy as simple as a linear probability model. The computational burden of the
second stage is also light since we only need to estimate a logit model. A second attractive feature is that
it allows us to view a game as a generalization of a standard discrete choice model. Thus, techniques from
the voluminous econometric literature on discrete choice models can be imported into the study of strategic
interaction. While the example considered above is simple, it nonetheless illustrates many of the key ideas
that will be essential in what follows.
We can also see a key problem with identiï¬cation in the simple example above. Both the ï¬rst stage
estimates Ïƒ
i (ai = 1|s) and the term s Â· Î² depend on the vector of state variables s. This suggests that we
will suï¬€er from a collinearity problem in order to separately identify the eï¬€ects of Î² and Î´ on the observed
choices. The standard solution to this type of problem in many settings is to impose an exclusion restriction.
Suppose, for instance, a ï¬rm speciï¬c productivity shock is included in s. In most oligopoly models, absent
technology spillovers, the productivity shocks of ï¬rms âˆ’i would not directly enter into ï¬rm iâ€™s proï¬ts. These
shocks only enter indirectly through the endogenously determined actions of ï¬rms âˆ’i, e.g. price, quantity
or entry decisions. Therefore, if we exclude the productivity shocks of other ï¬rms from the term s Â· Î², we
would no longer suï¬€er from a collinearity problem. While this idea is quite simple, as we shall discover in
the next section, similar restrictions are required to identify more general models.

3

Nonparametric Identiï¬cation

In this section, we consider the problem of identifying the deterministic part of payoï¬€s, without making
particular assumptions about its functional form (e.g. that it is a linear index as in the previous example).
In the context of nonparametric identiï¬cation, we let Î¸ be completely nonparametric and write Î i (ai , aâˆ’i , s)
instead of Î i (ai , aâˆ’i , s; Î¸).
Deï¬nition We will say that Î i (ai , aâˆ’i , s) is identiï¬ed if Î i (ai , aâˆ’i , s) = Î i (ai , aâˆ’i , s) for some i = 1, ..., n
implies that for the corresponding equilibrium choice probabilities Ïƒi (ai = 1|s) = Ïƒi (ai = 1|s) for some
i = 1, ..., n.

8

Formally, identiï¬cation requires that diï¬€erent values of the primitives generate diï¬€erent choice probabilities.
If this condition is not satisï¬ed, then it will be impossible for us to uniquely recover the structural parameters
Î i (ai , aâˆ’i , s) (for i = 1, ..., n) from knowledge of the observed choice probabilities, Ïƒi (ai = 1|s).
It is well known that even in a single agent problem, it is not possible to nonparametrically identify both
Î i (ai , aâˆ’i , s) and the joint distribution of the error terms F (i ). To take the simplest possible example,
consider a simple binary response model and assume that the error terms are normally distributed, as in the
probit model. Let Ïƒi (ai = 1|s) denote the probability that the response is equal to one in the data conditional
on s. Deï¬ne Î i (ai = 0|s) = 0 and Î i (ai = 0|s) = F âˆ’1 (Ïƒi (ai = 1|s)) where F âˆ’1 denotes the normal cdf. It
can easily be veriï¬ed that this deï¬nition of Î i perfectly rationalizes any set of choice probabilities Ïƒi (ai = 1|s).
Since our model is not identiï¬ed without a parametric assumption on the error term in even a simple probit
model, assumptions at least as strong will be required in the more general set up that we consider here.
In Bajari, Hong, and Ryan (2004) we demonstrate that when we allow for nonparametric Î i (ai , aâˆ’i , s) an
independence assumption is required to identify our model in even single agent problems. In what follows,
we will typically impose the assumption that the error terms are distributed i.i.d. extreme value since both
an independence and parametric form assumption on the error terms are required for identiï¬cation.
Based on the discussion above, we shall impose the following assumption in order to identify the model.
A1 The error terms i (ai ) are distributed i.i.d. across actions ai and agents i. Furthermore, the parametric
form of the distribution F comes from a known family.
Analogous to the notation in the previous section, deï¬ne Î i (k, s) =


aâˆ’i

Î i (ai = k, aâˆ’i , s)Ïƒâˆ’i (aâˆ’i |s).

It is straightforward to show that the equilibrium in this model must satisfy:
Î´i (s, i ) = k if and only if Î i (k, s) + i (k) > Î i (k  , s) + i (k  ) for all k  = k.

(9)

That is, action k is chosen if and only if the deterministic expected payoï¬€ and error term associated with
action k is greater than the analogous values of k  = k. An implication of (9) is that the equilibrium choice
probabilities Ïƒi (a|s) must satisfy:
Ïƒi (ai |s) = Pr {i (ai ) + Î i (ai , s) âˆ’ Î i (0, s) > i (k) + Î i (k, s) âˆ’ Î i (0, s), âˆ€k = 0, . . . , K, k = ai }

(10)

Equation (10) is a simple consequence of (9) where we can subtract Î i (0, s) from both sides of the inequality.
Suppose we generate i (ai ) from an extreme value distribution as in the logit model. Then (10) implies
that:
exp(Î i (ai , s) âˆ’ Î i (0, s))
Ïƒi (ai |s) = K
k=0 exp(Î i (k, s) âˆ’ Î i (0, s))

(11)

A key insight due to Hotz and Miller (1993) is that equation (11) implies that the equilibrium choice
probabilities, Ïƒi (ai |s), have a one-to-one relationship to the â€œchoice speciï¬c value functionsâ€, Î i (ai , s) âˆ’
Î i (0, s). To see why, note that taking logarithms of both sides of (11) implies that for any k, k  :
log (Ïƒi (k|s)) âˆ’ log (Ïƒi (k  |s)) = Î i (k, s) âˆ’ Î i (k  , s).

9

The one-to-one mapping between choice probabilities and choice speciï¬c value functions holds more
generally than in just the logit model. It is obvious that we should expect it in any model where the
distribution of i has full support. We let Î“ : {0, ..., K} Ã— S â†’ [0, 1] denote the map in general from choice
speciï¬c value functions to choice probabilities, i.e.
(Ïƒi (0|s), ..., Ïƒi(K|s)) = Î“i (Î i (1, s) âˆ’ Î i (0, s), ..., Î i(K, s) âˆ’ Î i (0, s)) .

(12)

We will denote the inverse mapping by Î“âˆ’1 :
(Î i (1, s) âˆ’ Î i (0, s), ..., Î i(K, s) âˆ’ Î i (0, s)) = Î“âˆ’1
i (Ïƒi (0|s), ..., Ïƒi(K|s)) .

(13)

The above analysis implies that we can invert the equilibrium choice probabilities to nonparametrically
recover Î i (1, s) âˆ’ Î i (0, s), ..., Î i(K, s) âˆ’ Î i (0, s). However, the above analysis implies that we will not be
able to separately identify Î i (1, s) and Î i (0, s), we can only identify the diï¬€erence between these two terms.
Therefore, we shall impose the following assumption:
A2 For all i and all aâˆ’i and s, Î i (ai = 0, aâˆ’i , s) = 0.
The above assumption is similar to the â€œoutside goodâ€ assumption in a single agent model where the mean
utility from a particular choice is set equal to zero. In the context of our entry model, this assumption is
satisï¬ed if the proï¬t from not entering the market is equal to zero regardless of the actions of other agents.
Just as in the single agent model, there are alternative normalizations that we could use to identify the
Î i (ai , aâˆ’i , s) just as in a single agent model. However, for expositional simplicity we shall restrict attention
to the normalization A2.
Given assumption A2 and knowledge of the equilibrium choice probabilities, Ïƒi (ai |s), we can then apply
the mapping in (13) to recover Î i (ai , s) for all i, ai and s. Recall that the deï¬nition of Î i (ai , s) implies that:
Î i (ai , s) =



Ïƒâˆ’i (aâˆ’i |s)Î i (ai , aâˆ’i , s), âˆ€i = 1, . . . , n, ai = 1, . . . , K.

(14)

aâˆ’i

Even if we know the values of Î i (ai , s) and Ïƒâˆ’i (aâˆ’i |s) in the above equation, it is not possible to uniquely
determine the values of Î i (ai , aâˆ’i , s). To see why, hold the state vector s ï¬xed, determining the utilities of
all agents involves solving for n Ã— K Ã— (K + 1)nâˆ’1 unknowns. That is, there are n agents, for each action
k = 1, ..., K, utility depends on the (K + 1)nâˆ’1 possible actions of the other agents.
hand side of (14) only contains information about n Ã— (K + 1) scalars holding s ï¬xed.

However, the left
It is clearly not

possible to invert this system in order to identify Î i (ai , aâˆ’i , s) for all i, all k = 1, ...., K and all aâˆ’i âˆˆ Aâˆ’i .
Related nonidentiï¬cation results have been found by Bresnahan and Reiss1991a, 1991c and Pesendorfer and
Schmidt-Dengler (2003) in the context of dynamic games with discrete state spaces.
Obviously, there must be cross-equation restrictions across either i or k in order to identify the system.
One way to identify the system is to impose exclusion restrictions. Partition s = (si , sâˆ’i ), and suppose
Î i (ai , aâˆ’i , s) = Î i (ai , aâˆ’i , si ) depends only on the subvector si . An example of this might be in an entry
model.

In this type of model the state is usually a vector of productivity shocks.

While we might

expect the proï¬t of ï¬rm i to depend on the entry decisions of other agents, it should not depend on the

10

productivity shocks of other agents. See Bajari, Hong, and Ryan (2004) for other examples of possible
exclusion restrictions that can be used in applications. If such an exclusion restriction is possible, we can
then write
Î i (ai , sâˆ’i , si ) =



Ïƒâˆ’i (aâˆ’i |sâˆ’i , si )Î i (ai , aâˆ’i , si ).

(15)

aâˆ’i

Clearly, a suï¬ƒcient identiï¬cation condition is that for each si , there exists (K + 1)nâˆ’1 points in the support
of the conditional distribution of sâˆ’i given si , such that this system of equations form by these (K + 1)nâˆ’1
(K+1)nâˆ’1

points given si is invertible. In other words, Let s1âˆ’i , . . . , sâˆ’i

denote these points, then identiï¬cation

requires that the matrix


Ïƒ(aâˆ’i |sjâˆ’i , si ), aâˆ’i = 1, . . . , (K + 1)nâˆ’1 , j = 1, . . . , (K + 1)nâˆ’1
be nonsingular and invertible. Note that this assumption will be satisï¬ed as long as sâˆ’i contains a continuously distributed variable with Î i (ai , aâˆ’i , si ) suï¬ƒcient variability.
Theorem 1 Suppose that A1 and A2 hold. Also suppose that for each si , there exists (K + 1)nâˆ’1 points in
the support of the conditional distribution of sâˆ’i given si so that (15) is invertible. Then the latent utilities
Î i (ai , aâˆ’i , si ) are identified.
Another approach to identiï¬cation is to exploit the multiplicity of equilibria. Suppose that there is some
state variable z which shifts which equilibrium to the game is played, but otherwise does not enter into the
payoï¬€s. Then we can write the payoï¬€s are Ïƒi (ai |s, z) but the utilities do not directly depend on the variable
z. We shall give a detailed example of such a variable in our application which is due to the intervention
in the market by a regulator which we interpret as shifting the equilibrium to the game but not directly
entering payoï¬€s. This generates variation in the right hand size of (15) which allows us to check similar rank
conditions. We note that Sweeting (2005) has also pointed out that the multiplicity of equilibrium can help
in identifying a special case of the model above.

4

Estimation

In the previous section, we demonstrated that there is a nonparametric inversion between choice probabilities and the choice speciï¬c value functions, Î (ai , s). Furthermore, we demonstrated that the structural
parameters of our model are identiï¬ed if appropriate exclusion restrictions are made on payoï¬€s. In this
section, we exploit this inversion to construct nonparametric and semiparametric estimates of our structural
parameters.

Step 1: Estimation of Choice Probabilities. Suppose the economist has access to data on t =
1, . . . , T repetitions of the game. For each repetition, the economist observes the actions and state variables
i (k|s) of Ïƒi (k|s) using sieve series expansions
for each agent (ai,t , si,t ). In the ï¬rst step we form an estimate Ïƒ
( see Newey (1990) and Ai and Chen (2003)). We note, however, that we could alternatively estimate the ï¬rst
stage using other nonparametric regression methods such as kernel smoothing or local polynomial regressions.

11

Let {ql (s), l = 1, 2, . . .} denote a sequence of known basis functions that can approximate a real valued
measurable function of s arbitrarily well for a suï¬ƒciently large value of l. The sieve could be formed using
splines, Fourier Series or orthogonal polynomials. We let the basis become increasingly ï¬‚exible as the number
of repetitions of the game T becomes large. Let Îº(T ) denote the number of basis functions to be used when
the sample size is T. We shall assume that Îº(T ) â†’ âˆ, Îº(T )/T â†’ 0 at an appropriate rate to be speciï¬ed
below. Denote the 1 Ã— Îº(T ) vector of basis functions as
q Îº(T ) (s) = (q1 (s), . . . , qÎº(T ) (s)),

(16)

and its collection into a regressor data matrix as
QT = (q Îº(T ) (s1 ), . . . , q Îº(T ) (sT ).
One potential sieve estimator for Ïƒ
i (k|s), k = 1, . . . , K is a linear probability model, i.e.:
Ïƒ
i (k|s) =

T


1(ait = k)q Îº(T ) (st )(QT QT )âˆ’1 q Îº(T ) (s).

(17)

t=1

Equation (17) is the standard formula for a linear probability model where the regressors are the sieve
functions Îº(T ) in equation (16). We note that in the presence of continuous state variables, the sieve
âˆš
estimator Ïƒ
i (k|s) will converge to the true Ïƒi (k|s) at a nonparametric rate which is slower than T .

Second Step: Inversion In our second step, we take as given our estimates Ïƒi(k|s) of the equilibrium
choice probabilities. We then form an estimate of the expected deterministic utility functions, Î Ì‚i (k, st ) âˆ’
Î Ì‚i (0, st ) for k = 1, ..., K and t = 1, ..., T .

This can be done by evaluating (13) using Ïƒ
i (k|s) in place of

Ïƒi (k|s). That is:


 i (0, st ), ...Î 
 i(K, st ) âˆ’ Î 
 i (0, st ) = Î“âˆ’1 (
 i (1, st ) âˆ’ Î 
Ïƒi (0|st ), ..., 
Ïƒi(K|st ))
Î 
i

(18)

In the speciï¬c case of the logit model, this inversion would simply be:
Ïƒi (k|st )) âˆ’ log (
Ïƒi (0|st ))
Î Ì‚i (k, st ) âˆ’ Î Ì‚i (0, st ) = log (

(19)

In an alternative model, such as one with normal shocks, we would need to solve a nonlinear system. In
what follows, we shall impose A2 so that Î Ì‚i (0, s) = Î Ì‚i (0, aâˆ’i , s) = 0 for all aâˆ’i .

Third Step: Recovering The Structural Parameters In the ï¬rst step we recovered an estimate
of ÏƒÌ‚i (ai , s) and in the second step we recovered an estimate of the choice speciï¬c value function Î Ì‚i (k, s). In
our third step, we use the empirical analogue of (14) to form an estimate of Î (ai , aâˆ’i , si ). We shall assume
that we have made a suï¬ƒcient number of exclusion restrictions, as discussed in the previous section, so that
the model is identiï¬ed. For a given value of si , for a given a = (ai , aâˆ’i ), we estimate Î i (ai , aâˆ’i , si ) by
minimizing the following weighted least square function
Î i (ai , aâˆ’i , si ), which are taken to be a vector of coeï¬ƒcients:
â2
â›
T


âÎ Ì‚i (ai , sâˆ’it , si ) âˆ’
ÏƒÌ‚âˆ’i (aâˆ’i |sâˆ’it , si ) Î i (ai , aâˆ’i , si )â  w (t, si ) ,
t=1

aâˆ’i

12

(20)

where the nonparametric weights w (t, si ) can take a variety of forms. For example,


 

T
sit âˆ’ si
siÏ„ âˆ’ si
w (t, si ) = k
k
/
h
h
Ï„=1

(21)

uses kernel weights, and other local weights are also possible. The identiï¬cation condition in the previous
section ensures that the regressor matrix in this weighted least square regression is nonsingular asymptotically.

4.1

A Linear Model of Utility

The nonparametric estimation procedure described in the previous section follows the identiï¬cation arguments closely and oï¬€ers the advantage of ï¬‚exibility and robustness against misspeciï¬cation. However, without
a huge amount of data nonparametric estimation methods can be subject to severe curve of dimensionality
when we intend to control for a large dimension of state variables s. Also, in small samples, diï¬€erent implementations of nonparametric procedures may lead to drastically diï¬€erent point estimates. Therefore in the
following we consider a semiparametric estimation where the deterministic utility components Î i (ai , aâˆ’i , s)
are speciï¬ed to be a linear function of a ï¬nite dimensional parameter vector Î¸. This is the typical econometric
speciï¬cation that is commonly used in the empirical literature. In this section we describe a straightforward
estimation and inference procedure for this model.
The deterministic part of the utility is assumed to take the form of


Î i (ai , aâˆ’i , si ) = Î¦i (ai , aâˆ’i , si ) Î¸.

(22)

In the above expression, the deterministic part of utility is a linear combination of a vector of basis functions,
Î¦i (ai , aâˆ’i , si ). For instance, we might let utility be a linear index as in our simple entry game example of the
previous section. Alternatively, we might choose Î¦i (ai , aâˆ’i , si ) to be a standard ï¬‚exible functional form, such
as a high order polynomial, spline function or orthogonal polynomial. The estimator we discuss below can
easily be generalized to allow for the possibility that Î¸ enters the utility nonlinearly. However, the exposition
of the properties of the estimator is facilitated by the linearity assumption. Also, most applications of
discrete choice models and discrete games usually are linear in the structural parameters of interest.
This linearity assumption implies that the choice speciï¬c value function, given ai and s, takes the
convenient form:


Î i (ai , s) = E [Î i (ai , aâˆ’i , si ) |s, ai ] = Î¦i (ai , s) Î¸.

(23)

where Î¦i (ai , s) is deï¬ned as:
Î¦i (ai , s) =
=



E [Î¦i (ai , aâˆ’i , si ) |ai , s]

aâˆ’i Î¦i (ai , aâˆ’i , si )
j=i Ïƒ(aj = kj |s).

(24)

Arguing as in Section 2, it follows that if the error terms are distributed extreme value, the equilibrium
choice probabilities must satisfy:
Ïƒi (ai |s) =


 
exp Î¦i (ai , s) Î¸
.

K
 
1 + k=1 exp Î¦i (k, s) Î¸

13

(25)

More generally, if the error terms are not distributed extreme value, it may not be possible to express the
equilibrium choice probabilities in closed form as above. However, equation (6) implies that each Ïƒi (ai |s)
depends on Ïƒj (aj |s) , j = i through (24). We denote this mapping as:
Ïƒi (ai |s) = Î“i,ai (s, Ïƒj (k|s) , j = i, k = 1, . . . , K) .

(26)

If we deï¬ne Ïƒ (s) to be the stacked vector of choice probabilities Ïƒi (k|s) for all k = 1, . . . , K, i = 1, . . . , n,
then we can collect (26) into a ï¬xed point mapping:
Ïƒ (s) = Î“ (Ïƒ (s)) .

(27)

To emphasize the dependence on the parameter Î¸, we can also write
Ïƒ (s; Î¸) = Î“ (s, Î¸; Ïƒ (s; Î¸)) .

4.2

(28)

Semiparametric Estimation.

Step 1: Estimation of Choice Probabilities. The simple semiparametric procedure we propose
proceeds in two steps. We begin by forming a nonparametric estimate of the choice probabilities, ÏƒÌ‚i (k|s).
We will do this like above using a sieve approach, however, one could alternatively use kernels or a local
polynomial method.

âˆ’1

ÏƒÌ‚i (k|s) = q Îº(T ) (s) (QT QT )

T


q Îº(T ) (sÏ„ )1 (ai = k) .

(29)

Ï„=1

Given our estimates of the choice probabilities, we can then estimate Î¦i (k, s) correspondingly by
Î¦Ì‚i (k, s) =



Î¦i (ai = k, aâˆ’i , si )



ÏƒÌ‚(aj |s)

(30)

j=i

aâˆ’i

For instance, take the example presented in (7). In this example, Î i (ai = 1, aâˆ’i , s) = (s,



1})Â·(Î², Î´) where â€œ Â·â€ denotes an inner product. Thus, in the above formula, Î¦i (ai = 1, aâˆ’i ) = (s,


j=i



1{aj =

j=i 1{aj

=

1}) and Î¸ = (Î², Î´). Then, given our ï¬rst stage estimates of the choice probabilities, Î¦Ì‚ (ai = 1, aâˆ’i ) =

(s, j=i 1{aj = 1}Ïƒj (aj |s)).
Then for each parameter value Î¸, we can evaluate the empirical analogue of (28). For example, in the
multinomial logit case,

Ïƒi




exp Î¦Ì‚i (ai , s) Î¸


ai |s, Î¦Ì‚, Î¸ =
K

1 + k=1 exp Î¦Ì‚i (k, s) Î¸


14

(31)

Step 2: Parameter Estimation. In the second stage a variety of estimators can be used to recover
the value of Î¸. Most of these estimators can be written as GMM estimators with a properly deï¬ned set of
instruments. To describe the second stage, deï¬ne yikt = 1 if ait = k and yikt = 0 otherwise, for k = 0, . . . , K.
Deï¬ne yit = (yi1t , . . . , yiKt ) and the vector

  


Ïƒi st , Î¦Ì‚, Î¸ = Ïƒi k|st , Î¦Ì‚, Î¸ , k = 1, . . . , K

(32)

Furthermore,

 collect yit , i = 1, . . . , n into a long
 vector
 yt with n Ã— K elements, and similarly collect
Ïƒi st , Î¦Ì‚, Î¸ , i = 1, . . . , n into a long vector Ïƒ st , Î¦Ì‚, Î¸ with corresponding n Ã— K elements. Then for
any dimension dim (Î¸) Ã— (nK) matrix of instruments AÌ‚ (st ), a GMM estimator Î¸Ì‚ can be deï¬ned by solving
the sample equations:
T



1 
AÌ‚ (st ) yt âˆ’ Ïƒ st , Î¦Ì‚, Î¸Ì‚ = 0.
T t=1

(33)

The instrument matrix AÌ‚ (st ) may be known as A (st ), may be estimated in the ï¬rst stage (such as two-step
optimally weighted GMM), or may be estimated simultaneously (such as pseudo MLE). For example, with
a pseudo MLE method, Î¸Ì‚ is deï¬ned by maximizing the pseudo likelihood function, which can be written as
the following because of the independent error terms across agents:

K



T 
K
K
n








yikt log Ïƒi k|st , Î¦Ì‚, Î¸ + 1 âˆ’
yikt log 1 âˆ’
Ïƒi k|st , Î¦Ì‚, Î¸
.
t=1 i=1

k=1

k=1

(34)

k=1



In the following we let ÏƒÌ‚ikt (Î¸) = Ïƒi k|st , Î¦Ì‚, Î¸ . The ï¬rst order condition for the â€œpseudoâ€ MLE estimator
is then given by


K
T 
n 
K


yikt âˆ’ ÏƒÌ‚ikt (Î¸)
âˆ‚ 
j=1 (yijt âˆ’ ÏƒÌ‚ijt (Î¸))
+
Ïƒi k|st , Î¦Ì‚, Î¸Ì‚ ,
K
ÏƒÌ‚ikt (Î¸)
âˆ‚Î¸
1 âˆ’ j=1 ÏƒÌ‚ijt (Î¸)
t=1 i=1 k=1

(35)

In term 
of expressing
it as an instrumental variable estimator, this corresponds to (33) with AÌ‚ (st ) equal to

âˆ‚
the âˆ‚Î¸ Ïƒ st , Î¦Ì‚, Î¸Ì‚ Ã— WÌ‚ (st , Î¸), where WÌ‚ (st , Î¸) is the nK Ã— nK diagonal matrix, such that the ith diagonal
block, for i = 1, . . . , n, is given by
â¡
1
â¢
â¢
â£

where ÏƒÌ‚i0t (Î¸) = 1 âˆ’

0

0
..

0

0

ÏƒÌ‚i1t (Î¸)

K

j=1 ÏƒÌ‚ijt (Î¸).

0
.

0

â¤

â¡

â¥ â¢
â¥+â¢
â¦ â£

1
ÏƒÌ‚iKt (Î¸)

1
ÏƒÌ‚i0t (Î¸)

..
.

â¤
â¥
â¥ [1 Â· Â· Â· 1] ,
â¦

(36)

1
ÏƒÌ‚i0t (Î¸)

If we deï¬ne W (st , Î¸) in analog to WÌ‚ (st , Î¸), except with Î¦Ì‚ replaced by
âˆ’1

the true unknown Î¦ in each ÏƒÌ‚ikt (Î¸), then it is easy to verify that W (st , Î¸0 ) = V ar (yt âˆ’ Ïƒ (st , Î¦, Î¸0 ) |st )
where the ith diagonal block of the
â¡
Ïƒi1t
â¢
â¢
â£ 0
0

block diagonal matrix V ar (yt âˆ’ Ïƒ (st , Î¦, Î¸0 ) |st ) is given by
â¤ â¡
â¤
0
0
Ïƒi1t
â¥ â¢ . â¥
..
â¥ â¢
â¥
.
0 â¦ âˆ’ â£ .. â¦ [Ïƒi1t Â· Â· Â· ÏƒiKt ] .
ÏƒiKt
0 ÏƒiKt

15

,

(37)

It is well known that the estimation errors in AÌ‚ (st ) will not aï¬€ect the asymptotic distribution of Î¸Ì‚ deï¬ned
by (33), regardless of whether AÌ‚ (st ) is estimated in a preliminary step or is estimated simultaneously with
Î¸Ì‚. Therefore, the asymptotic distribution of the pseudo MLE is the same as that of an infeasible GMM IV
estimator with an instrument matrix A(st ) which is given by
âˆ‚
Ïƒ (st , Î¦0 , Î¸0 ) Ã— W (st , Î¸0 )
âˆ‚Î¸

(38)

!
!
âˆ‚
âˆ‚
Î“ (st , Î¸1 , Ïƒ (st ; Î¸2 )) !!
Ïƒ (st , Î¦0 , Î¸0 ) =
âˆ‚Î¸
âˆ‚Î¸1
Î¸1 =Î¸2 =Î¸

(39)

Here note that in terms of (28)

Therefore, assuming all Î¦ are known, the MLE corresponds to the eï¬ƒcient choice of instruments AÌ‚ (st )
in (33), under the eï¬ƒciency framework of Newey and McFadden (1994). Therefore, next we will focus on
deriving the large sample properties of Î¸Ì‚ deï¬ned by (33) where A(st ) is known.
The estimator that we consider falls within the class of semiparametric estimators considered by Newey
(1994). A somewhat surprising conclusion is that even though the ï¬rst stage is estimated nonparametrically
âˆš
and can be expected to converge at a rate slower than T , the structural parameters will be asymptotically
âˆš
normal and will converge at a rate of T . Moreover, under appropriate regularity conditions, the second
stage asymptotic variance will be independent of the particular choice of nonparametric method used to
estimate the ï¬rst stage (e.g. sieve or kernel). As a practical matter, these results justify the use of the
bootstrap to calculate standard errors for our model.
In the appendix, we derive the following result, applying the general framework developed by Newey
(1990). Under appropriate regularity conditions, the asymptotic distribution of Î¸Ì‚ deï¬ned in 33 satisï¬es the
following:



âˆš 

d
T Î¸Ì‚ âˆ’ Î¸ âˆ’â†’ N 0, Gâˆ’1Î©Gâˆ’1 ,
where
G = EA (st )

âˆ‚
Ïƒ (st , Î¦0 , Î¸0 ) ,
âˆ‚Î¸

(40)

and Î© is deï¬ned such that
T



1 
d
âˆš
A (st ) yt âˆ’ Ïƒ st , Î¦Ì‚, Î¸0
âˆ’â†’ N (0, Î©) .
T t=1

(41)

In the appendix, we also compare the asymptotic variance of alternative estimators.

4.3

Linear Probability Model

Next, we demonstrate that in many cases it is possible to estimate our model using a simple two stage
least squares method. While the formal econometrics in this section are quite straightforward, we believe
that this observation is useful for researchers. Much of the previous literature on estimating games has
concentrated on the case of fully dynamic models and required an understanding of dynamic programming.

16

In this section, we demonstrate that the methods in their simplest version only require invoking the ivreg
command in STATA.
To simplify notation, we will focus on a binary choice model in the following. The extension to multinomial models is straightforward. Therefore consider a special case of (1) where K = 1, Î i (0, aâˆ’i , s) = i (0) â‰¡




0, Î¸, Î¦i (1, aâˆ’i , s; Î¸) = Î¦1i (si ) Î² + Î¦1i (aâˆ’i , s) Î³ so that




ui (1, aâˆ’i , s; Î¸) = Î¦1i (si ) Î² + Î¦2i (aâˆ’i , s) Î³ + i (1) ,
and i (1) is uniformly distributed on the interval (âˆ’1, 0). The decision rule of agent i is such that action 1
is chosen if and only if
"
#

E [ui (1, aâˆ’i , s; Î¸) |s] = Î¦1i (si ) Î² + E Î¦2i (aâˆ’i , s) |s Î³ + i (1) > 0.
Because of the uniform distribution assumption of i (1), this implies that
"
#

P (ai = 1|s) = Î¦1i (si ) Î² + E Î¦2i (aâˆ’i , s) |s Î³,
which can be written as
"
#

ai = Î¦1i (si ) Î² + E Î¦2i (aâˆ’i , s) |s Î³ + Î·it (1) ,

(42)

such that E (Î·it (1) |st ) = 0.
In this model Î¦1i (si ) and Î¦2i (aâˆ’i , s) are known functions, but Î² and Î³ are unknown parameters.
#
" 2
E Î¦i (aâˆ’i , s) |s needs to be estimated nonparametrically. As before, this can be consistently estimated
by a linear least square regression with a suï¬ƒciently large number of sieve approximating functions in the
ï¬rst step:
T

" 2
#
âˆ’1

Îº(T )

(s) (QT QT )
q Îº(T ) (sÏ„ ) Î¦2i (aâˆ’iÏ„ , sÏ„ ) .
EÌ‚ Î¦i (aâˆ’i , s) |s = q
Ï„=1

In the second step, a linear regression is used to estimate Î² and Î³:


T 


"
# 2
ait âˆ’ Î¦1i (sit ) Î² âˆ’ EÌ‚ Î¦2i (aâˆ’it , st ) |st Î³ .
Î²Ì‚, Î³Ì‚ = arg min
Î²,Î³

t=1

Note that this is precisely a two stage least square estimator. Also note that this is a special case of (33)
where


AÌ‚i (st ) =

Î¦1i (sit )

#
"
EÌ‚ Î¦2i (aâˆ’it , st ) |st


,



"
#

and Ïƒ st , Î¦Ì‚, Î¸Ì‚ = Î¦1i (sit ) Î² + EÌ‚ Î¦2i (aâˆ’it , st ) |st and yit âˆ’ Ïƒi (st , Î¸0 ) = Î·it (1).
In the following we will demonstrate that the ivreg procedure with the robust standard error options in
stata will give correct standard errors for this model, when ai is entered as the dependent variable, Î¦1i (s) is
entered as the exogenous regressor, Î¦2i (aâˆ’i , s) is entered as the endogenous regressor, and q Îº(T ) (s) is used
as the set of instruments to instrument for Î¦2i (aâˆ’i , s). In other words, Î²Ì‚ and Î³Ì‚ are computed as


T
Î²Ì‚
1
Î¸Ì‚ =
AÌ‚i (st ) ait ,
= Aâˆ’1
T
T t=1
Î³Ì‚

17

where
T
1 

AÌ‚i (st ) AÌ‚i (st ) .
AT =
T t=1

Then it follows from a standard manipulation that


T
âˆš
Î²Ì‚ âˆ’ Î²
1 
T
= Aâˆ’1
mÌ‚i (st , Î², Î³) ,
T âˆš
T t=1
Î³Ì‚ âˆ’ Î³
where

"
# 

mÌ‚i (st , Î², Î³) = AÌ‚i (st ) ait âˆ’ Î¦1i (sit ) Î² âˆ’ EÌ‚ Î¦2i (aâˆ’it , st ) |st Î³ .
The asymptotic variance is then a special case of section (C). We will use a slightly diï¬€erent notation here
to facilitate comparison with 2SLS. In particular, it follows from Newey (1994) that
T
T
1 
1 
âˆš
mÌ‚i (st , Î², Î³) = âˆš
mi (st , Î², Î³) + op (1) ,
T t=1
T t=1

where mi (st , Î², Î³) = Ai (st ) (Î·it (1) âˆ’ vit (1) Î³) , and
"
#
vit (1) = Î¦2i (aâˆ’it , st ) âˆ’ E Î¦2i (aâˆ’it , st ) |st .
The asymptotic distribution of the 2SLS estimator is then given by, letting A = EAi (st ) Ai (st ) :
â›
â

âˆš 


d
âœ
âŸ

T Î¸Ì‚ âˆ’ Î¸ âˆ’â†’ N â0, Aâˆ’1 EAi (st ) V ar Î·it (1) âˆ’ vit (1) Î³|st Ai (st ) Aâˆ’1 â  .
$
%&
'
Î£(st )

To obtain a consistent estimate of this asymptotic variance matrix, both A and Î£ (st ) needs to be estimated.
A can be estimated by AT . The key in estimating Î£ (st ) is to estimate Î·it (1) âˆ’ vit (1) consistently. This can
be estimated by




eit =ait âˆ’ Î¦1i (sit ) Î²Ì‚ âˆ’ Î¦2i (aâˆ’it , st ) Î³Ì‚

"
"
#
#

=ait âˆ’ Î¦1i (sit ) Î²Ì‚ âˆ’ E Î¦2i (aâˆ’it , st ) |st Î³Ì‚ âˆ’ Î¦2i (aâˆ’it , st ) âˆ’ E Î¦2i (aâˆ’it , st ) |st Î³Ì‚.


Then EAi (st ) Î£ (st ) Ai (st ) can be consistently estimated by
T
1 

AÌ‚i (st ) eit eit AÌ‚i (st ) .
T t=1

Now note that this is precisely how Stata ivreg calculates robust standard errors for 2SLS estimators.

5
5.1

Fixed eï¬€ect model of unobserved heterogeneity
Nonparametric identiï¬cation

Unobserved heterogeneity can be a potentially important source of misspeciï¬cation if it is not accounted for
in the model. In this section, we discuss how to introduce market speciï¬c ï¬xed eï¬€ects into our model. For

18

each market t = 1, . . . , T , all the players in that market observe a market speciï¬c proï¬t shifter Î±t that is not
observed by the econometrician. We will assume that Î±t is an unknown but smooth function of the state
variables st = (st1 , . . . , stn ) in that market, which we will denote as Î± (st ). In principal, we would prefer a
model where the unobserved heterogeneity was not required to be a function of the observables. However,
in highly nonlinear models, such as ours, similar assumptions are commonly made (see, for example, Newey
(1994)).
This assumption is convenient technically since it implies that the equilibrium choice probabilities, Ïƒi can
still be written as a function of the state st . If the unobserved heterogeneity were not a function of st , then
it would be quite diï¬ƒcult to estimate the choice probabilities, Ïƒi since they would depend on an unknown,
market speciï¬c parameter in a nonlinear manner. There is no obvious method to identify or estimate the
ï¬rst stage in this case.
With the inclusion of a market speciï¬c ï¬xed eï¬€ect, the mean period utility function in (1) for player i
in market t is now modiï¬ed to
Î i (ai , aâˆ’i , s) = Î± (ai , s) + Î Ìƒi (ai , aâˆ’i , s).

(43)

In the above, and what follows, we drop the market speciï¬c subscript t for notational simplicity.
Under the normalization assumption that Î i (0, aâˆ’i , s) â‰¡ 0 for all i = 1, . . . , n, our previous results show
that, as in (14), the choice speciï¬c value functions Î i (ai , s) are nonparametrically identiï¬ed. Note that the
choice speciï¬c value functions must satisfy âˆ€i = 1, . . . , n, ai = 1, . . . , K:
Î i (ai , s) =
=



Ïƒâˆ’i (aâˆ’i |s)Î i (ai , aâˆ’i , s)

Î± (ai , s) + aâˆ’i Ïƒâˆ’i (aâˆ’i |s)Î Ìƒi (ai , aâˆ’i , si ).
aâˆ’i

(44)

Obviously, since Î± (ai , s) is unknown but is the same function across all market participants, they can
be diï¬€erenced out by looking at the diï¬€erence of Î i (k, s) and Î j (k, s) between diï¬€erent players i and j. By
diï¬€erencing (44) between i and j one obtains


Î i (k, s) âˆ’ Î j (k, s) =
Ïƒâˆ’i (aâˆ’i |s) Î Ìƒi (ai , aâˆ’i , si ) âˆ’
Ïƒâˆ’j (aâˆ’j |s) Î Ìƒj (aj , aâˆ’j , sj )
aâˆ’i

aâˆ’j

Here we can treat Î Ìƒi (ai , aâˆ’i , si ) and Î Ìƒj (aj , aâˆ’j , sj ) as coeï¬ƒcients, and Ïƒâˆ’i (aâˆ’i |s) and Ïƒâˆ’j (aâˆ’j |s) as regressors in a linear regression. Identiï¬cation follows as in Theorem 1. As long as there is suï¬ƒcient variation in the
state variables si , sj , the coeï¬ƒcients Î Ìƒi (ai , aâˆ’i , si ) and Î Ìƒj (aj , aâˆ’j , sj ) can be nonparametrically identiï¬ed.
We could nonparametrically estimate Î Ìƒj (aj , aâˆ’j , sj ) using an approach analogous to the nonparametric
approach discussed in section Section 4. However, in practice, semiparametric estimation will typically be a
more useful alternative. Denote the mean utility (less the market speciï¬c ï¬xed eï¬€ect) as:


Î Ìƒi (ai , aâˆ’i , si ) = Î¦i (ai , aâˆ’i , si ) Î¸.

(45)

In practice, we imagine estimating the structural model in two steps. In the ï¬rst step, we estimate
the equilibrium choice probabilities nonparametrically. In the second stage, we estimate Î Ìƒi treating Î± (st )
as a ï¬xed eï¬€ect in a discrete choice model. Estimating discrete choice models with ï¬xed eï¬€ects is quite
straightforward is many cases.

19

For instance, consider a model of entry and suppose that the error terms are distributed extreme value.
In the ï¬rst step, we nonparametrically estimate Î¦Ì‚i (1, sit ), the probability of entry by ï¬rm i when the state is
sit . As in the previous section, we could do this using a sieve linear probability model. In the second stage,
we can form a conditional likelihood function as in Chamberlain (1984)). This allows us to consistently
estimate Î¸ when market speciï¬c ï¬xed eï¬€ects Î± (st ) are present. The likelihood function is then:
 
 n


 n

T






log exp Î¸
log L =
ait Î¦Ì‚i (1, sit )
âˆ’ log
exp Î¸
dit Î¦Ì‚i (1, sit )
t=1

where Bt â‰¡ {dt :

dt âˆˆBt

i=1

n
i=1

dit =

n
i=1

i=1

ait } is the set of actions that give rise to the same number of entrants

as observed in the data. In other words, the likelihood is formulated conditional on the number of entrants.
One can follow similar steps as in previous derivations to prove consistency and demonstrate asymptotic
normality of this semiparametric conditional logit estimator where Î¦Ì‚i (1, sit ) is estimated in the ï¬rst stage
nonparametrically.
We also note that we could estimate this model using a using a panel data rank estimation type procedure
as in (Manski (1987)). While this is a more challenging model computationally, it is free of distributional
assumptions on the error term.

6

Computing Models with Multiple Equilibria.

In the previous sections, we have either assumed that the model has a unique equilibrium (which can be the
case, for example, for a linear probability interaction model), or that only a single equilibrium outcome out of
several possible multiple equilibria is being observed in the data set. However, in many static game models,
multiple equilibria are possible. The importance of multiple equilibria in empirical research is emphasized
by many authors, including Brock and Durlauf (2001) and Sweeting (2005). In the rest of this manuscript
we present a method for estimating parametric models of interactions in the presence of possible multiple
equilibria.
In the previous sections we have considered a model with known distribution F (i ) of the error terms
and a parametric model for the mean utility functions Î i (ai , aâˆ’i , Î¸). At every possible parameter value
Î¸, given the known distribution F (i ), equations (10), (12) and (14) deï¬ned a ï¬xed point mapping in the
conditional choice probabilities:



Ïƒi (ai |s) = Î“i
Ïƒaâˆ’i (aâˆ’i |s) [Î i (k, aâˆ’i , s; Î¸) âˆ’ Î i (0, aâˆ’i , s; Î¸) , k = 1, . . . , K] .

(46)

âˆ’i

For example, under the linear mean utility speciï¬cation (5), this system of ï¬xed point mappings in the choice
probabilities takes the form of
â
â›

Ïƒâˆ’i (aâˆ’i |s)Î¦i (ai , aâˆ’i , s) Î¸, ai = 1, . . . , K â  , i = 1, . . . , n.
Ïƒi (ai |s) = Î“i â

(47)

aâˆ’i

In previous sections, we have assumed that either there is a unique solution to this system of ï¬xed

20

mapping with K Ã— n equations and K Ã— n unknown variables
Ïƒi (ai |s) , âˆ€ai = 1, . . . , K, i = 1, . . . , n,
or that only one particular ï¬xed point of this system gets realized in the observed data. However, this
system of ï¬xed point mapping can potentially have multiple solutions, leading to the possibility of multiple
equilibria.
In the following of this section, we will ï¬rst give a brief introduction to the use of homotopy methods
for ï¬nding multiple solutions to a system of nonlinear equations. We will then discuss how the homotopy
method can be used to compute multiple equilibria for our model of static interactions. In the next section,
we will describe an innovative estimation method that we develop for estimating the parameters in static
interaction models with multiple equilibria. While brief, this section is highly technical. Readers can proceed
to the application in section 7 after reading section 6.1.

6.1

The homotopy method

The homotopy continuation method (which will simply be referred to as the homotopy method in the rest of
the paper) is a well known generic algorithm for looking for a ï¬xed point to a system of nonlinear equations.
Based on the particular nonlinear system of equations to be solved, a well designed homotopy system is
capable of ï¬nding multiple solutions of the nonlinear system, and in some cases, all solutions to the system.
A concise and clear introduction to the homotopy method can be found in the book by Zangwill and Garcia
(1981). Algorithms for implementing the homotopy method can be found in several papers including Watson,
Billups, and Morgan (1987), Kostreva and Kinard (1991), ? and ?.
Our goal is to ï¬nd, for all possible parameter values and realized state variables s, the solutions for the
ï¬xed point system (28):
Ïƒ âˆ’ Î“ (Ïƒ) = 0.
To simplify the notation, we suppress the fact that the choice probabilities depend on the state Ïƒ = Ïƒ (s).
The basic idea behind the homotopy method is to take a system for which we know the solution and
map this system into the system that we are interested in. Under the right conditions, the solution to the
original system will also map into the solution that we are seeking. Formally, a homotopy is a linear mapping
between the two topological spaces of functions of the form
H (Ïƒ, Ï„ ) = Ï„ G (Ïƒ) + (1 âˆ’ Ï„ ) (Ïƒ âˆ’ Î“ (Ïƒ)) ,

Ï„ âˆˆ [0, 1] ,

(48)

where each of H (Ïƒ, Ï„ ) and G (Ïƒ) are vectors of functions with n Ã— K component functions:
Hi,ai (Ïƒ, Ï„ )

and Gi,ai (Ïƒ)

for i = 1, . . . , n and

ai = 1, . . . , K.

H (Ïƒ, Ï„ ) is the homotopy function and Ï„ is the homotopy parameter. As one can see, for Ï„ = 1 we get
H (Ïƒ, 0) = G (Ïƒ) and for Ï„ = 0 we obtain H (Ïƒ, 0) = Ïƒ âˆ’ Î“ (Ïƒ) so varying Ï„ from 1 to 0 maps the function
G (Â·) into the function Î“(Â·). The homotopy method suggests that we start with Ï„ = 1 and choose G (Ïƒ) to

21

be a system for which it is very easy to obtain the solutions to G (Ïƒ) = 0. If for each 0 â‰¤ Ï„ < 1, we can solve
for the nonlinear equations, H (Ïƒ, Ï„ ) = 0, then by moving along the path in the direction of Ï„ = 1 to Ï„ = 0,
at the end of the path we should be able to reach a solution of the original nonlinear equations Ïƒ âˆ’ Î“ (Ïƒ) = 0.
This path then constructs a mapping between a solution of the initial system G (Ïƒ) = 0 and a solution to
the ï¬xed point problem of interest, Ïƒ âˆ’ Î“ (Ïƒ) = 0.
In practice, algorithms for solving diï¬€erential equations can be used to trace the path from Ï„ = 1 to
Ï„ = 0. At each Ï„ , we denote the solution along a particular path by Ïƒ (Ï„ ):
H (Ïƒ (Ï„ ) , Ï„ ) = 0.
By diï¬€erentiating this homotopy function with respect to Ï„ :
d
âˆ‚H
âˆ‚H âˆ‚Ïƒ
H (Ïƒ (Ï„ ) , Ï„ ) =
+
Â·
= 0.
dÏ„
âˆ‚Ï„
âˆ‚Ïƒ âˆ‚Ï„
This deï¬nes a system of diï¬€erential equations for Ïƒ (Ï„ ) with initial condition Ïƒ (1) calculated from the
solution of the (easy) initial system G (Ïƒ (1)) = 0. A number of computer algorithms are available to
compute numerical solutions of nonlinear systems of diï¬€erential equations can then be used to trace this
diï¬€erential equation system to reach an end point in the path of Ï„ = 1 to Ï„ = 0 in order to obtain a solution
Ïƒ (0) of the original system Ïƒ âˆ’ Î“ (Ïƒ) = 0.
A regularity condition is necessary to insure the stability and the proper behavior of the homotopy
diï¬€erential equation system.
Condition 1 (Regularity) Let âˆ‡ (Ï„ ) denote the Jacobian of the homotopy functions with respect to Ïƒ at
the solution path Ïƒ (Ï„ ):
âˆ‡ (Ï„ ) =

!
!
âˆ‚
,
Re{H (Ïƒ, Ï„ )}!!
âˆ‚Ïƒ
Ïƒ=Ïƒ(Ï„)

where Re{H (Ïƒ, Ï„ )} denotes the real component of the homotopy functions. The jacobian âˆ‡ (Ï„ ) has full rank
for almost all Ï„ .
This condition ensures the smoothness and diï¬€erentiability of the paths. It rules out cases of bifurcation,
branching and inï¬nite spiraling. The mapping between G (Ïƒ) and Ïƒ âˆ’ Î“ (Ïƒ) is called a conformal one if the
path that links them is free of these complications. If a homotopy system satisï¬es the regularity condition,
it will either reach a solution or drift oï¬€ to inï¬nity.
Obviously, in applied work where the system of diï¬€erential equations above will be solved numerically, it
will be convenient to work with conformal mappings. A convenient way of generating a conformal mapping,
or a homotopy that satisï¬es the above regularity condition, is to extend the original homotopy into the
complex space. A homotopy, as deï¬ned in equation (48) is extended to the complex space by permitting
the argument Ïƒ to take on complex values, which will result in complex values of the homotopy. When the
real and complex components of Ïƒ are considered two diï¬€erent sets of arguments, and the real and complex
components of the output are considered two diï¬€erent sets of components of the homotopy, this deï¬nes
a real valued homotopy with 2nK inputs and 2nK outputs. If the original homotopy (48) is an analytic

22

function in the complex space, then the Cauchy-Riemann conditions will ensure that the extended real-value
2nK Ã— 2nK homotopy system satisï¬es the regularity condition above.
The all solution homotopy is one where the initial system G (Ïƒ) is chosen such that, if we follow the paths
originating from each of the solutions to G (Ïƒ) = 0, we will reach all solutions of the original system Ïƒ = Î“ (Ïƒ)
at the end of the path. The extension of a real homotopy system into the complex space is essential to the
idea of all-solution homotopy. It is related with the property of the complex space that conformal mappings
in the complex space do not change the algebraic properties of the sets.

3

The concept of conformal mapping

is widely used in complex analysis. It implies that we can conformally map a function with a complicated
set of roots to another function with a simple set of roots, then the results from an analysis of the function
with the simple set of roots should apply to the function with the complicate set of roots. An all solution
homotopy has to satisfy an additional path ï¬niteness condition:
Condition 2 (Path Finiteness) Define H âˆ’1 (Ï„ ) to be the set of solutions Ïƒ (Ï„ ) to the homotopy system
at Ï„ . H âˆ’1 (Ï„ ) is bounded for all 0 â‰¤ Ï„ < 1. In other words, for all Ï„ > 0.
lim H (Ïƒ, Ï„ ) = 0.

||Ïƒ||â†’âˆ

6.2

Multiple equilibria in static discrete games

As we noted in the previous section, the issue of multiple equilibria in static interaction models amounts
to the issue of computing all the ï¬xed points to the system of equations of choice probabilities deï¬ned in
equation (46). Note that the argument to the mapping from expected utility to choice probabilities, Î“ (Â·),
is linear in the choice probabilities of competing agents Ïƒâˆ’i (aâˆ’i |s). Therefore, the question of possible
multiplicity of equilibria depends crucially on the functional form of Î“, which in turn depends exclusively on
the assumed joint distribution of the error terms.
Interestingly, if we are content with the linear probability model where Î“ is a linear function of the
individual choice probabilities, and the model has only two agents, then the equilibrium will be guaranteed
to be unique and the issue of multiple equilibria is not relevant. Î“ is a linear function of the individual
choice probabilities if the underlying utility functions depend linearly on the indicator function of whether
individual competitors make a particular choice or not. For example, this would be the case if the proï¬t
from entering a market depends on the total number of competitors who also enter the market. On the
other hand, if we have nonlinear interactions of the individual choice probabilities in the linear probability
model, or if the joint distribution of the error term in the multinomial choice model is speciï¬ed such that Î“i
is a polynomial function for each i = 1, . . . , n, then all the equilibria can be found by choosing a homotopy
system where the initial system of equations
Gi,ai (Ïƒ) ,
3

i = 1, . . . , n and ai = 1, . . . , K.

The conformal mapping is a mapping in the complex space that does not locally change the argument of a

complex number. It is known that if the function is analytic and does not have stationary points then the associated
mapping is conformal.

23

takes the following simple polynomial form:
qi,ai

Gi,ai (Ïƒ) = Ïƒi (ai )

âˆ’ 1 = 0 for

i = 1, . . . , n and ai = 1, . . . , K,

(49)

where qi,ai is an integer that exceeds the degree of the polynomial of Î“i,ai as a function of Ïƒâˆ’i (aâˆ’i ). This
results in a homotopy mapping
qi,ai

Hi,ai (Ïƒ, Ï„ ) = Ï„ {Ïƒi (ai )

âˆ’ 1} + (1 âˆ’ Ï„ ) (Ïƒi (ai ) âˆ’ Î“i,ai (Ïƒ)) , Ï„ âˆˆ [0, 1].

(50)

For Ï„ = 0 the system (48) coincides with the original system while for Ï„ = 1 it is equal to the â€™simpleâ€™ system
(49).
It is a well known result from complex analysis that there are exactly qi,ai complex roots to Gi,ai (Ïƒ) that
are evenly distributed on the unit circle. It is known that nondegenerate polynomial functions are analytic
and the regularity condition of the resulting homotopy system is automatically satisï¬ed. The particular
choice of qi,ai also ensures the path ï¬niteness property of the homotopy system (c.f. Zangwill and Garcia
(1981)).
While a polynomial model for Î“ (Â·) is convenient for calculating multiple equilibria, it is rarely used in
applied problems because it is not clear what parametric utility speciï¬cation will give rise to a polynomial
choice probability function. The most popular multinomial choice probability function is probably the
multinomial logit, which follows from the assumption of i.i.d. extreme value distributions in the unobserved
component of the latent utilities. The logit choice model is given in (25). Our analysis in the following will
consist of three steps. First we will establish that this model has a ï¬nite number of equilibria represented
by real solutions to (25). Second, we will show that by letting the degree of the initial polynomial system
increase to inï¬nity at an appropriate rate, we will be able to ï¬nd all the equilibria for the multinomial logit
choice model (25) using the homotopy method. We prove it by ï¬rst verifying that the homotopy mapping
is regular in the complex space when the discontinuity points of the original function are isolated, and then
providing a method to make homotopy work in the small vicinity of discontinuity points.
It is not diï¬ƒcult to show that the ï¬xed point system (25) has a ï¬nite number of solutions in the real
line. To see this, note that in general, this function is clearly continuous and inï¬nitely diï¬€erentiable with
nonsingular derivatives. In particular, it is easy to verify this condition for the multinomial logit and probit
models that are commonly used in practice. Consider a compact ball BR in RnK with radius larger than
1. By Sardâ€™s theorem the set of irregular values of Î“ (Â·) has measure zero. In particular, it can be veriï¬ed
by diï¬€erentiation through the implicit function theorem that zero is its regular value. This implies that the
submanifold of Ïƒ satisfying Ïƒ = Î“ (Ïƒ) is compact as a closed subset of this ball BR . Thus it contains a
ï¬nite number of points. This veriï¬es that the set of solutions in BR in ï¬nite. It is also obvious that all the
solutions must satisfy 0 â‰¤ Ïƒi (ai ) â‰¤ 1 because of the choice probability functional form. Therefore there can
not be solutions outside BR .
While we have just shown that there are in general a ï¬nite number of multiple equilibria, to compute
these equilibria we need to make use of an all solution homotopy system. In particular, we choose to use the
all solution homotopy deï¬ned in (50). In the following we will show that there exists a homotopy system
of the form of (50) with a suï¬ƒciently high orders of the initial system qi,ai â€™s, such that we will ï¬nd all the

24

solution to the original system of choice probabilities. As described in the previous subsection, verifying
the validity of the all solution homotopy requires checking the regularity condition and the path ï¬niteness
condition, which in terms require extension of the real homotopy system into the complex space. Verifying
these conditions require us to specify the particular functional form of the joint distribution of the error
terms in the latent utilities. In the following we will focus on the multinomial logit case which is the most
widely used discrete choice model in the empirical literature.
The following Theorem 2 and Theorem 3 formally state this result. In the statement of the theorems,
Ïƒ = {Ïƒr , Ïƒi } denotes more generally a vector of the real part and the imaginary part of complex numbers
which extend the real choice probabilities we considered early into the complex space. Theorem 2 ï¬rst
establishes the regularity properties of the homotopy outside the imaginary subspace.
Theorem 2 Define the sets H âˆ’1 = {(Ïƒr , Ïƒi , Ï„ ) | H(Ïƒr , Ïƒi , Ï„ ) = 0} and
H âˆ’1 (Ï„ ) = {(Ïƒr , Ïƒi ) | H(Ïƒ, Ï„ ) = 0}

for

Ïƒr âˆˆ RnK ,

and

Ïƒi âˆˆ RnK .

Note that H is a homotopy of dimension R2nK that include both real and imaginary parts separately. Also
define, for any small , â„˜ = âˆªi,ai {|Ïƒr,i,ai | â‰¤ } to be the area around the imaginary axis. Then:
1) The set H âˆ’1 âˆ© {R2nK \ â„˜ Ã— [0, 1]} consists of closed disjoint paths.
2) For any Ï„ âˆˆ (0, 1] there exists a bounded set such that H âˆ’1 (Ï„ ) âˆ© R2nK \ â„˜ is in that set.
3) For (Ïƒr , Ïƒi , Ï„ ) âˆˆ H âˆ’1 âˆ©{R2nK \â„˜ Ã—[0, 1]} the homotopy system allows parametrization H(Ïƒr (s), Ïƒi (s), Ï„ (s)) =
0. Moreover, Ï„ (s) is a monotone function.
Remark: Theorem 2 establishes the regularity and path ï¬niteness conditions for the homotopy (50) for
the multinomial logit model in areas that are not close to the pure imaginary subspace in the complex
domain CnK . The homotopy system can become irregular along the pure imaginary subspace, because the
denominator in the system can approach zero and the system will become nonanalytic in the case. However,
the next theorem shows that there exists a sequence q such that homotopies with initial system of order q
will have paths that stay away from the imaginary subspace. Homotopies with these orders will be able to
trace out all the solutions of the original multinomial logit system.
Theorem 3 For given Ï„ one can pick the power qi,ai of the initial function (49) such that the homotopy
system is regular and path finite given some sequence of converging polyhedra â„˜ ,  â†’ 0.
Theorem 3 implies that if we continue to increase the power qi,ai of the initial system (49) of the
homotopy, we will eventually be able to ï¬nd all the solutions to the original multinomial logit system. This
also implies, however, we might lose solutions when we continue to increase qi,ai . But Theorem 3 does
imply that for suï¬ƒciently large qi,ai , no new solutions will be added for larger powers. In the monte carlo
simulation that we will report in the next section, we do ï¬nd this to be the case.

25

6.3

Monte Carlo Analysis

We perform several Monte-Carlo simulations for an entry game with a small number of potential entrants.
Playerâ€™s payoï¬€ functions for each player i were constructed as linear functions of the indicator of the rivalâ€™s
entry (ai = 1), market covariates and a random term:
â
â›

Ui (ai = 1, aâˆ’i ) = Î¸1 âˆ’ Î¸2 â
1(aj = 1)â  + Î¸3 x1 + Î¸4 x2 + i (a), i = 1, . . . , n.

(51)

j=i

The payoï¬€ of staying out is equal to Ui (ai = 0, aâˆ’i ) = i (a), where the i (a) have i.i.d extreme value
distributions across both a and i. The coeï¬ƒcients in the model are interpreted as: Î¸1 is the ï¬xed beneï¬t of
entry, Î¸2 is the loss of utility when one other player enters, Î¸3 , Î¸4 are the sensitivities of the beneï¬t of entry
to market covariates.
The game can be solved to obtain ex-ante probabilities of entry in the market. The solution to this
problem is given by:



Pi =

eÎ¸1 âˆ’Î¸2 (

j=i

Pj )+Î¸3 x1 +Î¸4 x2



1 + eÎ¸1 âˆ’Î¸2 (

j=i

Pj )+Î¸3 x1 +Î¸4 x2

, i = 1, . . . , n.

(52)

Here Pi is the ex-ante probability of entry for the player i, Pi = p (ai = 1|x). Both coeï¬ƒcients of the model
and market covariates were taken from independent Monte-Carlo draws. The parameters of generated
random variables are presented in Table 6.1. The means and variances of parameter values and market
covariates were chosen so to have a fair percentage of cases with more then one equilibrium. For the games
with 3,4 and 5 players 400 independent parameter combinations for every player were taken. The modiï¬cation
of the HOMPACK algorithm was run to solve for all equilibria in each game.
Throughout the Monte-Carlo runs both coeï¬ƒcients and covariates x1 and x2 were changing. So, every
equilibrium was calculated for a speciï¬c set of parameters. Summary statistics for the results of computations
are presented in Table 6.1. It is possible to see from Table 6.1 that in the constructed games the players
have approximately same average parameters in every type of game. This agrees with the symmetric form
of underlying data generating process for the coeï¬ƒcients and market covariates.
Table 6.2 and 6.3 tabulate the frequencies of diï¬€erent number of equilibria that are being observed in the
simulations, classiï¬ed according to the number of players in the market. Interestingly, a dominant number
of simulations have only a single equilibrium. In addition, the frequency of observing multiple equilibria
seems to decrease with the number of players in the market. In other words, we observe a large number of
multiple equilibria in the two player case but only observe a handful of them in the ï¬ve player case.
Table 6.4 tabulates the probability of entry of the ï¬rst player classiï¬ed by the number of equilibria
and the number of players in the market. In general, what we see from this table is that there is no clear
correlation pattern between the entry probability and the numbers of equilibria and players in the market.

26

7

Application to stock market analystsâ€™ recommendations and
peer eï¬€ects

Next, we discuss an application of our estimators to the problem of analyzing the behavior of equity market
analysts and the stock recommendations that they issue (e.g. strong buy, buy, hold sell). There is a fairly
sizeable empirical literature on this topic. However, the literature does not allow for strategic interactions
between analysts. We believe that this is a very strong assumption. Accurate forecasts and recommendations
are highly valued, of course. But the penalty for issuing a poor recommendation depends on whether
competitor analysts also made the same poor recommendation. Therefore, the utility an analyst receives
from issuing a recommendation is a function of the recommendations issued by other analysts. Therefore,
we apply the framework discussed in the previous sections to allow payoï¬€s to be interdependent.
There has been a revival of interest on the determinants of analyst recommendations as researchers
have tried to explain the remarkable behavior of the analysts in the run-up and subsequent collapse of the
NASDAQ in 2000.

4

The focus in this paper is on the recommendations generated for ï¬rms in the high tech

sector, which includes the ï¬rms most aï¬€ected by the excitement surrounding the development of e-commerce
and the spread of the Internet. Given the great uncertainty surrounding the demand for new products and
new business models, the late 1990â€™s would seem to have been the perfect environment for equity analysts to
add value. Yet analyst recommendations were not particularly helpful or proï¬table during this period. For
example, the analysts were extremely slow to downgrade stocks, even as it was apparent that the market
had substantially revised its expectations about the technology sectorâ€™s earnings potential. Barber, Lehavey,
McNichols, and Trueman (2003) show that the least recommended stocks earned an average abnormal return
of 13% in 2000-2001, while the most highly recommended stocks earned average abnormal returns of -7%.
Observations like this have led commentators to wonder whether the analysts had ulterior motives for keeping
their recommendations unjustiï¬ably optimistic, such as the pressure to win investment banking business.
Allegedly, this conï¬‚ict of interest took the form of analysts keeping recommendations on stocks high in order
to appease ï¬rms, who would then reward the analystâ€™s company by granting it underwriting business or
other investment advisory fees.5 Indeed, these suspicions came to a head when New York State Attorney
General Elliot Spitzer launched an investigation into conï¬‚icts of interest in the securities research business.
In this application we develop an empirical model of the recommendations generated by stock analysts
from the framework outlined in section 1. We quantify the relative importance of four factors inï¬‚uencing
the production of recommendations in a sample of high technology stocks during the time period between
1998 and 2003.
4

See for example Barber, Lehavey, McNichols, and Trueman (2003) and Chan, Karceski, and Lakonishok (2003).

Research prior to the NASDAQ collapse includes Womack (1996), Lin and McNichols (1998), and Michaely and
Womack (1999).
5
In 1998, Goldman Sachs estimated that Jack Grubman, a prominent telecommunications industry analyst, would
bring in $100 to $150 million in investment banking fees. This estimate was based on the fees generated by 32 of
the stocks he covered that also had banking relationships with Citigroup, including WorldCom, Global Crossing and
Winstar Communications. (Wall Street Journal, October 11, 2002).

27

First, recommendations must depend on expectations about the future proï¬tability of a ï¬rm. There
should be some systematic component to these expectations common across all analysts and investors that
will be embedded in the current stock price.
Second, analysts are heterogeneous, both in terms of talent and perhaps in terms of access to information.
We try to capture an individual analystâ€™s private belief about the stock by looking at the diï¬€erence between
the quarterly earnings forecast submitted by the analyst (or the analystâ€™s brokerage ï¬rm) and the distribution
of forecasts from other ï¬rms.
Mindful of the large number of inquiries into possible conï¬‚icts of interest among research analysts, we
include as a third factor a dummy variable for an investment banking relationship between the ï¬rm and the
analystâ€™s employer.
Finally, we consider the inï¬‚uence of peers on the recommendation decision. Peer eï¬€ects can impact the
recommendation in diï¬€erent ways. Individual analysts have incentive to condition their recommendation
on the recommendations of their peers, because even if their recommendations turn out to be unproï¬table
ex-post, performance evaluation is typically a comparison against the performance of peers. More subtly,
recommendations are relative rankings of ï¬rms and are not easily quantiï¬able (or veriï¬able) objects. As such,
ratings scales usually reï¬‚ect conventions and norms. The phenomenon is similar to the college professorâ€™s
problem of assigning grades. If a professor were to award the average student with a C while other faculty give
a B+ to the average student, the professor might incorrectly signal his views of student performance. Even
while there is heterogeneity in how individual professors feel about grading, most conform to norms if only
to communicate clearly with students (and their potential employers) about their performance. Similarly,
analysts have an incentive to benchmark their recommendations against perceived industry norms.

7.1

Data

Our data consist of the set of recommendations on ï¬rms that made up the NASDAQ 100 index as of
year-end 2001. The recommendations were collected from Thomson Firstcall. Firstcall is one of the most
comprehensive historical data sources for analystsâ€™ recommendations and earnings forecasts, containing realtime recommendations and forecasts from hundreds of analysts. It is common for analysts to rate ï¬rms on
a 5 point scale, with 1 denoting the best recommendation and 5 denoting the worst. When this is not the
case, Firstcall converts the recommendations to the 5 point scale (see Table 7.1).
We have 12,719 recommendations from analysts at 185 brokerage ï¬rms over this time period (see Table
7.2). The dependent variable in our data set is a recommendation submitted between January of 1998
and June of 2003 for a ï¬rm in the NASDAQ 100. The data set was formed by merging the earnings and
recommendations ï¬les from Firstcall. In a given quarter, for a given stock, we merge a quarterly earnings
forecast with a recommendation from the same brokerage.6 This will allow us to determine if analysts that
are more optimistic than the consensus tend to give higher recommendations. In the Firstcall data, quarterly
earnings forecasts are frequently made more than a year in advance. In order to have a consistent time frame,
6

When there were multiple recommendations by the same analyst within a quarter, we chose to use the last

recommendation in the results that we report.

28

we limit analysis to forecasts that were made within the quarter that the forecast applies.7 Note that not
every recommendation can be paired with an earnings forecast made within the contemporaneous quarter.
Recommendations that could not be paired with an earnings forecast were dropped from the results that
we report. However, qualitatively similar results were found for a data set where this censoring was not
performed. We choose not to report these results in the interests of brevity. The variables in our data
include:
â€¢ REC- Recommendation from 1-5 for a stock listed in the NASDAQ 100 recorded by I/B/E/S.
â€¢ QUARTER- Quarter during which the recommendation was submitted.
â€¢ STOCK-Name of the stock for which the recommendation applies.
â€¢ BROKERAGE-The brokerage employing the analyst.
â€¢ EPS-Earnings per share forecast submitted by the analystâ€™s brokerage associated with the recommendation. Submitted during the same quarter as the recommendation.
â€¢ AEPS-Average of the earnings per share forecasts submitted for that quarter.
â€¢ %DEV-(EPS-APS)/APS, the percent deviation of an individual brokerâ€™s earnings forecast from the
average earningâ€™s forecast.
â€¢ RELATION-A dummy variable that is one if the analystâ€™s brokerage engages in investment banking
business with the company to which the recommendation applies.
â€¢ IBANK-A dummy variable that is equal to one if the brokerage does any investment banking business
with stocks in the NASDAQ 100.
The investment banking relationship was identiï¬ed from several diï¬€erent sources. First, we checked form
424 ï¬lings in the SECâ€™s database for information on the lead underwriters and syndicate members of debt
issues. When available, we used SEC form S-1 for information on ï¬nancial advisors in mergers. We also
gathered information on underwriters of seasoned equity issues from Securities Data Corporationâ€™s Platinum
database. To be sure, transaction advisory services (mergers), and debt and equity issuance are not the only
services that investment banks provide. However, these sources contribute the most to total proï¬tability of
the investment banking side of a brokerage ï¬rm.
The average recommendation in our data set is 2.2, which is approximately a buy recommendation (see
Table 7.2). The mean value of RELATION is 0.035. The mean value of IBANK is 0.81. That is, 3.5 percent of
the analyst-company pairs in our data set were identiï¬ed as having a potential conï¬‚ict of interest due to some
kind of investment banking activity for the stock in question. Eighty-one percent of the recommendations
in our data were generated by ï¬rms engaging in investment banking with some ï¬rm list in the NASDAQ
100. Both of these variables are potentially useful measures of potential conï¬‚ict of interest. The variable
7

We chose to merge the brokerage ï¬eld, instead of the analysts ï¬eld, because the names and codes in the analysts

ï¬eld were not recorded consistently across IBES data sets for recommendations. It was possible to merge at the level
of the brokerage.

29

RELATION is more direct, since it indicates that the brokerage is engaged in investment banking with the
company during the quarter the recommendation was issued. However, brokerages might view any company
it is giving a recommendation to as a potential client, particularly in the NASDAQ 100, where many of the
companies generated considerable investment banking fees.
The variable earnings was formed by merging the recommendations and earnings ï¬les in Firstcall. In a
given quarter, for a given stock, we merge the quarterly earnings forecast with the recommendation from the
same brokerage. This allows us to determine if analysts that are more or less optimistic than the consensus
tend to give higher recommendations. In the Firstcall data, quarterly earnings forecasts are frequently made
more than a year in advance. In order to have a consistent time frame, we limit analysis to forecasts that
were made within the quarter for which the forecast applies. We chose to merge the brokerage ï¬eld, instead
of the analysts ï¬eld, because the names and codes in the analysts ï¬eld were not recorded consistently across
Firstcall data sets for recommendations. It was possible to merge at the level of the brokerage. Note that
not every recommendation can be paired with an earnings forecast made in the contemporaneous quarter.

7.2

Empirical model

An observation is a recommendation submitted for a particular stock during a speciï¬c quarter. We will
let t = 1, ..., T denote a quarter, s = 1, ..., S a stock and and i = 1, ..., I an analyst. We will denote a
particular recommendation by ri,s,t. The recommendation can take on integer values between 1 and 5, where
1 is the highest recommendation and 5 the lowest. Since the dependent variable can be naturally ranked
from highest to lowest, we will assume that the utilities come from an ordered logit. Let x(i, s, t) denote a
set of covariates that inï¬‚uence the recommendation for analyst i for stock s during quarter t. Let x(s, t)
denote a vector of (x(i, s, t)) of payoï¬€ relevant covariates that enter into the utility of all the analysts who
submit a recommendation for stock s during quarter q. Let z(s, t) denote a set of covariates that shift the
equilibrium, but which do not inï¬‚uence payoï¬€s.
Deï¬ne the utility or payoï¬€ to analyst i for a recommendation on stock s in quarter t to be,
yi,s,t = Î²  x(i, s, t) + Î·E(r|x(s, t), z(s, t)) + Îµi,s,t

(53)

In equation (53), the term E(r|x(s, t), z(s, t)) is the expected recommendation for stock s during quarter t
and Îµi,s,t is an error term drawn from an extreme value model. Thus, conforming to the expected actions
of peers enters into an individual analystâ€™s utility. The model would is the familiar ordered logit, where the
probability that a particular recommendation is observed is determined as follows:

30

P (r = 1) = Î¦(âˆ’Î²  x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(54)

P (r = 2) = Î¦(Î¼1 âˆ’ Î²  x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(55)



âˆ’ Î¦(âˆ’Î² x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))


(56)

P (r = 3) = Î¦(Î¼2 âˆ’ Î² x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(57)

âˆ’ Î¦(Î¼1 âˆ’ Î²  x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(58)



P (r = 4) = Î¦(Î¼3 âˆ’ Î² x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(59)

âˆ’ Î¦(Î¼2 âˆ’ Î²  x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(60)

P (r = 5) = 1 âˆ’ Î¦(Î¼3 âˆ’ Î²  x(i, s, t) âˆ’ Î·E(r|x(s, t), z(s, t)))

(61)

In equations (53)-(61), the likelihood that determines the probability that the recommendation is r depends
on the latent estimated covariates Î² and Î· along with the cut points Î¼1 âˆ’ Î¼3 .
The analysis of the previous section suggests that identiï¬cation depends crucially on having appropriate
exclusion restrictions. First, we need covariates that inï¬‚uence the payoï¬€s of one particular agent, but not
other agents. In our analysis, the covariates will include IBANK and RELATION. This assumption would
imply, for instance, that the amount of investment banking done by Merrill Lynch should not directly
inï¬‚uence the recommendations submitted by analysts working for Goldman Sachs. We believe that this is a
reasonable assumption.
In addition, we have attempted to control for unobserved heterogeneity in several ways. First, in many
speciï¬cations, we include a full set of stock and quarter ï¬xed eï¬€ects to control for factors that remain ï¬xed
in a quarter that inï¬‚uence recommendations. Second, we have controlled for unobserved heterogeneity using
both a ï¬xed eï¬€ects and random eï¬€ects speciï¬cation. Equations (53)-(61) imply that the probability of 1 or
a recommendation between 2 and 5 is a binary logit. This implies that we can estimate our model using a
ï¬xed eï¬€ect logit speciï¬cation. We choose to present a random eï¬€ect logit speciï¬cation since almost all of
the coeï¬ƒcient estimates in the ï¬xed eï¬€ects logit model were insigniï¬cant. Given the number of observations
in our data, we believe that the ï¬xed eï¬€ect logit model is too diï¬€usely speciï¬ed. We therefore use random
eï¬€ects instead.

7.3
7.3.1

Results
Fundamentals

The ï¬rst question that we ask is the extent to which recommendations were determined by publicly observable
information about the stocks. In our data, these fundamentals correspond to time ï¬xed eï¬€ects, stock ï¬xed
eï¬€ects and the diï¬€erence between an individual analystâ€™s beliefs about earnings and beliefs in the market as
whole. In Table 7.4, we run an ordered logit to explore these questions. The variable %DEV is the percentage
deviation of an analystâ€™s recommendation from the average recommendation and ABS. DEV is the algebraic
diï¬€erence. In both cases, a more optimistic earnings forecast has the anticipated sign, but is not signiï¬cant

31

at conventional levels in any of the speciï¬cations that we have tried. On the other hand, quarterly and stock
ï¬xed eï¬€ects are almost all statistically signiï¬cant (not reported in this Table). If quarter and stock ï¬xed
eï¬€ects proxy for publicly available information about the stock, then this information is considerably more
important than measures of an individual analystâ€™s optimism. We note, however, that there could be other
interpretations of these variables.
In Table 7.5, we report the estimated quarterly ï¬xed eï¬€ects and compare these estimates to the NASDAQ
Index and NASDAQ 100. The quarterly eï¬€ects are labeled qdum2-qdum22 for the 2nd quarter (1998.Q2)
through the 22nd quarter (2003.Q2) of our data set. Several points emerge. First, the quarterly eï¬€ects
are typically signiï¬cant. Second, the quarterly eï¬€ects are highly correlated with the NASDAQ index and
with the QQQ. We take these results as evidence that the quarterly eï¬€ects can reasonably be interpreted
as reï¬‚ecting publicly observed information about the the ï¬rms that is embedded in the share prices as
opposed to some other latent eï¬€ects. The movement in share prices can explain most of the movement in the
recommendations in the previous tables. In Table 7.6, we regress the quarterly dummies on these indexes.
We ï¬nd that the indexes are statistically signiï¬cant at conventional levels and that the measures of goodness
of ï¬t are quite high.

7.3.2

Conï¬‚icts of Interest

In Table 7.7 we run an ordered logit model of recommendations as a function of our conï¬‚ict of interest
measures. The coeï¬ƒcient on RELATION indicates that potential conï¬‚icts of interest are statistically significant at conventional levels, except for the third column where quarterly and stock ï¬xed eï¬€ects are included,
and the fourth column where the full set of ï¬xed eï¬€ects are included along with the more inclusive IBANK
variable. The coeï¬ƒcient sign on RELATION is also consistent with our a priori beliefs that conï¬‚icts of interest could lead to issuing more favorable recommendations. Consistent with the work of prior researchers
and market regulators, these results do suggest that a potential conï¬‚ict of interest exists when a brokerage
engaged in investment banking business with a company that quarter. However, these results must be interpreted with some caution. Since brokerage ï¬rms are expected to cover companies with whom they have
signiï¬cant investment banking business, the ï¬rms have an incentive to select brokerages that already view
them favorably. It would be hard to imagine that a rational manager would want to hire an investment
banking ï¬rm that views her company in an unfavorable manner.
Interestingly, we note (column 4 of table 7.7) that when we include the IBANK variable denoting that
the brokerage ï¬rm has investment banking relationships with at least one ï¬rm in the index, the coeï¬ƒcient is
positive and signiï¬cant. Evidently, analysts at general investment banking ï¬rm tend to issue slightly more
conservative recommendations. This is consistent with a view of the world that companies tended to select
investment banking ï¬rms that were more favorably disposed towards them. Alternatively, our results could
be interpreted as suï¬€ering from a bias due to some omitted variable.
Our results suggest that even though investment banking relationships may generate potential conï¬‚icts
of interest for equity analysts, the magnitude of the eï¬€ects recommendations may be small in practice. Notice that measures of the goodness of ï¬t are very low when only investment banking is included. Also, the
marginal eï¬€ects of engaging in investment banking are small. In our data, the expected recommendation

32

is -0.08 when we allow for quarterly ï¬xed eï¬€ects, but not stock ï¬xed eï¬€ects. This ï¬nding is not consistent
with the prosecutors belief that â€œunbiasedâ€ research, separate from investment banking, will generate recommendations less tainted by potential conï¬‚icts of interest. However, the behavior of analysts after large
settlements have been paid and signiï¬cant damage has been done to their brokerageâ€™s reputation, in some
cases, may be more conservative.

7.3.3

Peer Eï¬€ects

The ï¬nal question we consider is whether there are peer eï¬€ects in submitting recommendations. We do
this in Tables 7.8-7.10 by using the two stage procedure described in the previous sections. We regress the
recommendations on a broker ï¬xed eï¬€ect, a full set of stock and quarterly dummies, IBANK, RELATION,
and %DEV. In Table 7.8, the regressions are done using linear regression while in the later tables we use
a 3rd order spline. We will let IVBELIEF denote the expected average recommendation, excluding broker
i. If the coeï¬ƒcient on IVBELIEF is positive, this means that broker i has an incentive to conform to the
recommendations of other brokers. If it is negative, it means there is a return from submitting a dissenting
recommendation.
In all of the speciï¬cations that we examine in Table 7.8, peer eï¬€ects seem to be important. An individual
analyst will raise his recommendation proportionally to the recommendation that he expects from other
analysts. This is intuitive. A given recommendation does not make senses in isolation, but only relative to
the recommendations of other analysts. If no one else in the market is issuing recommendations of â€œmarket
underperformâ€ or â€œsellâ€, an individual analysts may give the wrong signal by issuing such a recommendation
even if he believes the recommendation is literally true. It is worth noting that the results for our measure of
peer eï¬€ects are not only statistically signiï¬cant, but peer eï¬€ects also explain the results quite well compared
to the other covariates. The Pseudo-R2 suggests that quarterly dummies, stock dummies and IVBELIEF
explain most of the variation in the data. We note that the presence of the peer eï¬€ect is robust to allowing
for a more ï¬‚exible ï¬rst stage (see Table 7.9). Also, the peer eï¬€ect remains signiï¬cant allowing for unobserved
heterogeneity in the form of a stock/quarter speciï¬c random eï¬€ect in Table 7.10.
With estimates of the modelâ€™s key parameters in hand, it is possible to simulate the model and ï¬nd the
set of equilibria to the analyst recommendation game. In keeping with the static nature of our analysis, we
solve for all possible equilibria at two points in time: the ï¬rst just prior to the regulatory regime change in
2000.Q1, and then again in 2003.Q1 after the Spitzer inquiry was well-underway. These results are based
on assuming that there are two analysts making a recommendation and that the recommendations are
determined as in (53)-(61). All of the variables are set to their sample averages for 2000.Q1 and 2003.Q1
respectively. The parameter values were set equal to the estimates in the last column of Table 7.8. Since we
are interested in the eï¬€ect of investment banking on recommendations, we consider two cases: one is when
IBANK is 0 for both players and the other when it is 1 for both players.
Evidently, the pre-Spitzer era was characterized by two diï¬€erent equilibria (see Table 7.11). These
equilbrium diï¬€er by a roughly uniform, upward shift in the overall recommendation. This is consistent with
our story that there is the possibility of multiple equilibrium in our model, one of which has â€œgrade inï¬‚ationâ€.
In the post-Spitzer era, there was only one equilibrium. Overall, recommendations fall compared to either

33

equilibrium in the pre-Spitzer era. This can be attributed, in large part, to the poor environment for high
technology stocks during this period.
We note that the average recommendation tends to fall when the ï¬rms engage in investment banking
business. This is because the coeï¬ƒcient on IBANK is positive in our estimates. Our model suggests that,
contrary to the allegations made by the prosecutor and in the press, on average, engaging in investment
banking does not tend to generate higher recommendations on average.

8

Conclusion

In this paper we propose a method for estimating static games of incomplete information. The method
we propose is semiparametric and does not require the covariates to lie in a discrete set. Perhaps most
importantly, the method is both ï¬‚exible and easy to implement using standard statistical packages. We also
introduce an algorithm for computing all equilibria to a game, which is useful for policy simulations using
the estimated model.
We apply these methods to the problem of determining the factors that govern the assignment of stock
recommendations by equity analysts for a set of high tech stocks between 1998 and 2003. Two factors seem
to be most important for explaining the production of stock recommendations. First, publicly observable
information about the stocks under recommendation, as reï¬‚ected in our time and quarter dummies, plays
a large role in explaining the distribution of recommendations. As we saw in Table 7.3, these variables
explained a large fraction of the variation in the data and were highly correlated with market indexes such
as the NASDAQ or QQQ. Simply put, recommendations improved in 1999-2000 as the stock market rose.
The second and most important factor for explaining recommendations is the peer group eï¬€ect. Individual
analysts raise their recommendations proportionally to the recommendations they expect from their peers.
Investment banking relationships are shown to be statistically signiï¬cant in the recommendations regressions,
but the economic eï¬€ect of the investment banking relationship is estimated to be small, and the variable
does not add much to the total ï¬t of the model.

References
Aguirregabiria, V., and P. Mira (2002): â€œSequential simulation-based estimation of dynamic discrete
games,â€ Technical Report, Boston University.
Ai, C., and X. Chen (2003): â€œEï¬ƒcient Estimation of Models with Conditional Moment Restrictions
Containing Unknown Functions,â€ Econometrica, 71(6), 1795â€“1843.
Allgower, E. L., and K. Georg (1980): Numerical Continuation Methods. An Introduction. SpringerVerlag.
Aradillas-Lopez, A. (2005): â€œSemiparametric Estimation of a Simultaneous Game with Incomplete Information,â€ working paper, University of California, Berkeley.

34

Augereau, A., S. Greenstein, and M. Rysman (2005): â€œCoordination vs. diï¬€erentiation in a standards
war: 56K modems,â€ working paper, Boston University.
Bajari, P., L. Benkard, and J. Levin (2004): â€œEstimating Dynamic Models of Imperfect Competition,â€
working paper.
Bajari, P., and H. Hong (2004): â€œSemiparametric Estimation of a Dynamic Game of Incomplete Information,â€ working paper, University of Michigan.
Bajari, P., H. Hong, and S. Ryan (2004): â€œIdentiï¬cation and Estimation of Discrete Games of Complete
Information,â€ Working paper, Department of Economics, Duke University.
Barber, B., R. Lehavey, M. McNichols, and B. Trueman (2003): â€œReassessing the Returns To
Analystsâ€™ Stock Recommendations,â€ Financial Analysts Journal.
Berry, S. (1992): â€œEstimation of a model of entry in the airline industry,â€ Econometrica, 60(4), 889â€“917.
Berry, S., A. Pakes, and M. Ostrovsky (2003): â€œSimple estimators for the parameters of dynamic
games (with entry/exit examples),â€ Technical Report, Harvard University.
Bjorn, P. A., and Q. Vuong (1984): â€œSimultaneous Equations Models for Dummy Endogenous Variables:
A Game Theoretic Formulation with an Application to Labor Force Participation,â€ SSWP No. 537,
Caltech.
Bresnahan, T., and P. Reiss (1991a): â€œEmpirical Models of Discrete Games,â€ Journal of Econometrics,
48, 57â€”81.
(1991b): â€œEntry and competition in concentrated markets,â€ Journal of Political Economy, 99,
977â€“1009.
(1991c): â€œEntry and competition in concentrated markets,â€ Journal of Political Economy, 99,
977â€“1009.
Brock, W., and S. Durlauf (2001): â€œDiscrete Choice with Social Interactions,â€ Review of Economic
Studies, 68, 235â€“260.
Chamberlain, G. (1984): â€œPanel Data,â€ in Handbook of Econometrics, Vol. 2, ed. by Z. Griliches, and
M. Intriligator. North Holland.
Chan, L., J. Karceski, and J. Lakonishok (2003): â€œAnalystsâ€™ Conï¬‚ict of Interest and Biases in Earnings
Forecasts,â€ University of Illinois Working Paper.
Ciliberto, F., and E. Tamer (2003): â€œMarket Structure and Multiple Equilibria in Airline Markets,â€
North Carolina State University and Princeton University.

35

Haile, P., A. Hortacsu, and G. Kosenok (2003): â€œOn the Empirical Content of Quantal Response
Equilibrium,â€ working paper, Yale University.
Ho, K. E. (2005): â€œInsurer-Provider Networks in the Medical Care Market,â€ working paper, Columbia
University.
Hotz, J., and R. Miller (1993): â€œConditional Choice Probabilties and the Estimation of Dynamic Models,â€ Review of Economic Studies, 60, 497â€“529.
Ishii, J. (2005): â€œInterconnection Pricing, Compatibility, and Investment in Network Industries: ATM
Networks in the Banking Industry,â€ working paper, Stanford University.
Kostreva, M. M., and L. A. Kinard (1991): â€œA diï¬€erential homotopy approach for solving polynomial
optimization problems and noncoorperative games,â€ Computers and Mathematics with Applications, 21,
135â€“143.
Lin, H., and M. McNichols (1998): â€œUnderwriting Relationships, Analystsâ€™ Earnings Forecasts, and
Investment Recommendations,â€ Journal of Accounting Economics, 25, 1â€“34.
Manski, C. F. (1987): â€œSemiparametric Analysis of Random Eï¬€ect Linear Models from Binary Panel
Data,â€ Econometrica, 55(2), 357â€“362.
Manuszak, M., and A. Cohen (2004): â€œEndogenous Market Structure with Discrete Product Diï¬€erentiation and Multiple Equilibria: An Empirical Analysis of Competition Between Banks and Thrifts,â€ working
paper.
McKelvey, R., and T. Palfrey (1995): â€œQuantal Response Equilibria for Normal Form Games,â€ Games
and Economic Behavior, 10(1), 6â€“38.
Michaely, R., and K. Womack (1999): â€œConï¬‚ict of Interest and Credibility of Underwriter Analyst
Recommendations,â€ Review of Financial Studies, 12, 653â€“686.
Newey, W. (1990): â€œSemiparametric Eï¬ƒciency Bounds,â€ Journal of Applied Econometrics, 5(2), 99â€“135.
(1994): â€œThe Asymptotic Variance of Semiparametric Estimators,â€ Econometrica, 62, 1349â€“82.
Newey, W., and D. McFadden (1994): â€œLarge Sample Estimation and Hypothesis Testing,â€ in Handbook
of Econometrics, Vol. 4, ed. by R. Engle, and D. McFadden, pp. 2113â€“2241. North Holland.
Pakes, A., J. Porter, K. Ho, and J. Ishii (2005): â€œMoment Inequalities and Their Application,â€ working
paper, Harvard University.
Pesendorfer, M., and P. Schmidt-Dengler (2003): â€œIdentiï¬cation and Estimation of Dynamic
Games,â€ NBER working paper No. w9726.

36

Rust, J. (1994): â€œStructural Estimation of Markov Decision Processes,â€ in Handbook of Econometrics, Vol.
4, ed. by R. Engle, and D. McFadden, pp. 3082â€“146. North Holland.
Seim, K. (2005): â€œAn Empirical Model of Firm Entry with Endogenous Product-Type Choices,â€ forthcoming, Rand Journal of Economics.
Sweeting, A. (2005): â€œCoordination Games, Multiple Equilibria and the Timing of Radio Commercials,â€
Northwestern University Working Paper.
Tamer, E. (2003): â€œIncomplete Simultaneous Discrete Response Model with Multiple Equilibria,â€ Review
of Economic Studies, 70(1).
Watson, L. T., S. C. Billups, and A. P. Morgan (1987): â€œAlgorithm 652 HOMPACK: A Suite of
Codes of Globally Convergent Homotopy Algorithms,â€ ACM Transactions on Mathematical Software,
13(3), 281â€“310.
Watson, L. T., M. Sosonkina, R. C. Melville, A. P. Morgan, and H. F. Walker (1997): â€œAlgorithm 777: HOMPACK90: A Suite of Fortran 90 Codes for Globally Convergent Homotopy Algorithms,â€
ACM Transactions on Mathematicsl Software, 23(4), 514â€“549.
Womack, K. (1996): â€œDo Brokerage Analyst Recommendations Have Investment Value,â€ Journal of Finance, 51(1), 137â€“167.
Zangwill, W. I., and C. B. Garcia (1981): Pathways to Solutions, Fixed Points, and Equilibria. PrenticeHall.

A

Proof for Theorem 2

Before we set out to prove the theorem we need to introduce some notations. Collapse the indexation for
i = 1, . . . , n and ai = 1, . . . , K to a single index j = 1, . . . , nK. In other words, each j represents a (i, ai )
pair. First we will rewrite the expression (47) for the case of multinomial choice probability as:
Ïƒj =

1+

exp (Pj (Ïƒ))

,
kâˆˆIi exp (Pk (Ïƒ))

(62)

where Ii = {(i, ai ) , ai = 1, . . . , K} is the set of all indices j = (i, ai ) that corresponds to the set of strategies
available to player i, and Pj (Ïƒ) is the expected utility associated with player i for playing ai when j = (i, ai ):

Pj (Ïƒ) = Pi,ai (Ïƒ) =
Ïƒâˆ’i (aâˆ’i |s) Î¦i (ai , aâˆ’i , s) Î¸,
aâˆ’i

which is in general a polynomial function in Ïƒj . Let P(Â·) denote the vector-function of polynomials of size
nK Ã— 1 that collects all the elements Pj (Â·) for j = 1, . . . , nK. Let Q be the product of the degrees of the
nK
polynomial over all elements of the vector P(Â·). In other words, Q = j=1 Qj where Qj is the degree of
polynomial Pj (Â·). For each complex argument Î¾ âˆˆ CnK the system of polynomials has exactly Q solutions.

37

Because of this, for each Î¾ âˆˆ CnK we can ï¬nd Q vectors Ïƒ âˆ— such that P(Ïƒ âˆ— ) = Î¾. Let us denote each
âˆ’1
(Î¾).
particular vector Ïƒ âˆ— by P(k)

The complex-valued vector P(Â·) of dimension nK Ã— 1 can be transformed into a real-valued vector of
dimension 2nK Ã—1 by considering separately real and complex part of vector P(Â·). Because of the polynomial
âˆ’1
property, each P(k)
(Î¾) is a continuously diï¬€erentiable function of Î¾ for almost all Î¾. It is possible that for

âˆ’1
âˆ’1

(Î¾) and P(k
some range of the argument Î¾, two (or more) solution paths P(k)
 ) (Î¾) for k = k might coincide

with each other. In this case we will relabel the paths k so that the merged paths create a total Q of smooth
âˆ’1
solution paths P(k)
(Î¾).

âˆ’1
(Î¾), which we will just denote by P âˆ’1 (Î¾)
The following analysis will apply to each individual branch P(k)

without explicit reference to thepath
 indice k. For j = 1, . . . , nK introduce the following notations: Î¾j =
yj
xj + iyj , Ïj = Î¾j , Ï•j = arctan xj . Then a homotopy system can be constructed for (62) as:
(
H1j (Î¾, Ï„ ) = {Ïqj cos(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Re{P âˆ’1 (Î¾)}âˆ’
âˆ’ 1+

kâˆˆIi

)

e2xj +exj cos(yj )+ k=j exj +xk cos(yj âˆ’yk )



xk
xk +xl
cos(yk )+ lâˆˆI
cos(yl âˆ’yk )
kâˆˆI e
k=l e

e2xk +2

i

i

and
(
H2j (Î¾, Ï„ ) = {Ïqj sin(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Im{P âˆ’1 (Î¾)}âˆ’
âˆ’ 1+

kâˆˆIi

)

exj sin(yj )+ k=j exk +xj sin(yj âˆ’yk )



xk +xl
e2xk +2 kâˆˆI exk cos(yk )+ lâˆˆI
cos(yl âˆ’yk )
k=l e
i

i

If the system P(Â·) is polynomial, P âˆ’1 (Î¾) is smooth and has a Jacobian of full rank for almost all Î¾.
Therefore, we can locally linearize it so that P âˆ’1 (Î¾) â‰ˆ Î›Î¾ + C. (This expansion is used only for the purpose
of clarity. A suï¬ƒcient fact for the validity of the proof is that there exist Î› and C such that |P âˆ’1 (Î¾)| â‰¤ Î›|Î¾|+C
which is true if P(Â·) is a polynomial.) The homotopy system can then be written as:
(
H1j (Î¾, Ï„ ) = {Ïqj cos(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Î›j xj âˆ’
)

e2xj +exj cos(yj )+ k=j exj +xk cos(yj âˆ’yk )



âˆ’ 1+
2x
x
x
+x
e k +2
e k cos(yk )+
e k l cos(yl âˆ’yk )
kâˆˆIi

kâˆˆIi

lâˆˆIi

(63)

k=l

and
(
H2j (Î¾, Ï„ ) = {Ïqj sin(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Î›j yj âˆ’
âˆ’ 1+

kâˆˆIi

)

exj sin(yj )+ k=j exk +xj sin(yj âˆ’yk )



xk +xl cos(y âˆ’y )
e2xk +2 kâˆˆI exk cos(yk )+ lâˆˆI
l
k
k=l e
i

(64)

i

where Î›j is the jth row of the nK Ã— nK matrix Î›. Without loss of generality we will let C = 0 in subsequent
analysis for the sake of brevity because all the results will hold for any other given C. To simplify notation
we will denote:
Î˜i (x, y) =



e2xk + 2

kâˆˆIi



exk cos(yk ) +



exk +xl cos(yl âˆ’ yk )

lâˆˆIi k=l

kâˆˆIi

Now given some index k âˆˆ {1, . . . , Q}, we consider the solutions of the system {H(x, y, Ï„ )} = 0 for all possible
real values of the vectors of x and y.
Now we set out to prove the statements of Theorem 2. First we will prove statement (2). Deï¬ne Ï = Î¾
to be the Euclidean norm of the entire nK Ã— 1 vector Î¾. We need to prove that there will not be a sequence

38

of solutions along a path where Ï â†’ âˆ. We will show this by contradiction. Consider a path where Ï â†’ âˆ.
Choose the component j of the homotopy system for which Ïqj cos(q Ï•j ) â†’ âˆ at the fastest rate among all
the possible indexes j where Ïj â†’ âˆ.

8

Consider the real part of the homotopy function, H1j (Â·, Â·, Â·). The equation H1j (x, y, Ï„ ) = 0 is equivalent
to the equation

H1j (x,y,Ï„)
Ï„ (Ïqj cos(q Ï•j )âˆ’1)

= 0 for Ïj > 1. The last equation can be rewritten as:

(1 âˆ’ Ï„ )

1+  q
Ï„ Ïj cos(q Ï•j ) âˆ’ 1

*

+

e2xj + exj cos(yj ) + k=j exj +xk cos(yj âˆ’ yk )
Î› xâˆ’
= 0.
1 + Î˜i (x, y)
j

(65)

We will show that the second term in the curly bracket of the previous equation is uniformly bounded from
above in absolute terms:

!
! 2xj
! e + exj cos(yj ) + k=j exj +xk cos(yj âˆ’ yk ) !
!â‰¤C
!
!
!
1 + Î˜i (x, y)

and for a constant C,

(66)

where the constant C can depend on . Therefore the term in the curly bracket in the homotopy (65) will


grow at most at a linear rate |x| â‰¤ CÏj . On the other hand, denominator Ï„ Ïqj cos (qÏ•j ) âˆ’ 1 outside the
curly bracket grows at a much faster polynomial rate for large q. Hence the second term in (65) is close to 0
for large q for large values of Î¾, and equation (65) can not have a sequence of solutions that tends to inï¬nity.
In other words, there exists R0 > 0 such that for any Î¾ = (x, y) outside â„˜ with Î¾ â‰¥ R0 and any
Ï„ âˆˆ (0, 1] we have that H1 (x, y, Ï„ ) = 0, that is, homotopy system does not have solutions. This implies that
Ï„
= {(x, y, Ï„ ) âˆˆ R2nK \ â„˜ Ã— (0, 1] âˆ© Î¾ < R0 }.
H âˆ’1 (Ï„ ) âˆ© â„˜ âŠ‚ BR
0

This proves the statement 2).
Finally, we will prove both statements 1) and 3) of Theorem 2. Again we consider the above homotopy
Ï„
system on the compact set BR
. The homotopy function is analytic in this set so Cauchy - Riehmann
0

theorem holds. This implies that
âˆ‚H1j
âˆ‚H2j
=
âˆ‚xk
âˆ‚yk

and

âˆ‚H1j
âˆ‚H2j
=âˆ’
,
âˆ‚yk
âˆ‚xk

This means that if the Jacobian is considered:
 âˆ‚H
Ji =

1j
âˆ‚x

âˆ‚H2j
âˆ‚x

âˆ‚H1j
âˆ‚y 
âˆ‚H2j
âˆ‚y 

for all j, k = 1, . . . , 2nK.

âˆ‚H1j
âˆ‚Ï„
âˆ‚H2j
âˆ‚Ï„


,


then it contains at least one 2Ã—2 submatrix with nonnegative determinant

âˆ‚H1j
âˆ‚xk

2 
2
âˆ‚H
+ âˆ‚y1j
. Calculating the
k

Ï„
derivatives directly due to the fact that  < Ï < R0 this determinant is strictly positive for all (x, y, Ï„ ) âˆˆ BR
.
0
8

In case when instead of Ïqj cos(q Ï•j ) â†’ âˆ we have that Ïqj sin(q Ï•j ) â†’ âˆ, the proof can be appropriately modiï¬ed

by considering the imaginary part of the j-th element of the homotopy system without any further changes. The logic
of the proof can be seen to hold as long as there is a slower growing element of x or y. In case when all components
of x and y grow at the same rate to inï¬nity in such a way that the second terms inside the curly brackets of (63) and
(64) explode to inï¬nity, one can take a Laurent expansion around the values of yk â€™s such that the denominators are
close to zero. Then one can see that these terms in (63) and (64) explode to inï¬nity at quadratic and linear rates in
1/(y âˆ’ yâˆ— ), respectively. Therefore (63) and (64) can not both be zero simultaneously for large x and y.

39

Therefore, the implicit function theorem veriï¬es that the pair (x, y) can be locally parameterized by Ï„ .
Moreover, this representation is locally unique and continuous. This proves the ï¬rst statement. The same
arguments above, which show that the determinant is positively almost everywhere, also immediately implies
2

the third statement.
Proof of equation (66):

We are to bound the left hand side of equation (66) by a given constant. First of all we can bound the
denominator from below by
,
,
, ,
,
,
, ,




,
,
,
2xk ,
xk
xk +xl
,
e , âˆ’ ,2
e cos(yk ) +
e
cos(yl âˆ’ yk ),
1 + Î˜i (x, y) â‰¥ ,1 +
,,
,
, ,
,
kâˆˆIi

lâˆˆIi k=l

kâˆˆIi

as a + b â‰¥ a âˆ’ b . Then we can continue to bound:
1 + Î˜i (x, y) â‰¥ 1 +


kâˆˆIi

e2xk âˆ’ 2


kâˆˆIi

exk âˆ’




lâˆˆIi

xk +xl
.
k=l e

(67)

The last expression was obtained taking into account the fact that


max 2
exk cos(yk ) +
exk +xl cos(yl âˆ’ yk )
yk , kâˆˆIi

kâˆˆIi

lâˆˆIi k=l

is attained at the point cos(yk ) â‰¡ cos(yk âˆ’ yl ) = 1, âˆ€k, l âˆˆ Ii .
For the same reason, we can bound the numerator from above by
,
,

, 2xj
,
,e + exj cos(yj ) + k=j exj +xk cos(yj âˆ’ yk ), â‰¤ e2xj + exj cos(yj )
,


,
+ k=j exj +xk cos(yj âˆ’ yk ), â‰¤ e2xj + exj + k=j exj +xk .
Recall that j - th component was assumed to be the fastest growing x component as Ï â†’ âˆ. Then from
equation (67) for some small but positive constant Ïˆ we can write:
1 + Î˜i (x, y) â‰¥ 1 + Ïˆe2xj
Collecting terms we have that:

e2xj +exj cos(yj )+ k=j exj +xk cos(yj âˆ’yk )
1+Î˜i (x,y)

â‰¤


1+e2xj +exj + k=j exj +xk
1+Ïˆe2xj

.

which is clearly uniformly bounded from above by a large constant.
The same arguments can be used by looking at the imaginary part of the homotopy system when there
exists a yj that converges to inï¬nity at the fastest rate.

B

2

Proof for Theorem 3

For the clarify of exposition we will present the proof in the case of two strategies for each player. In the
case with more than two strategies for each player, the expansions for the homotopy system will be more

40

complex and will involve more terms in the denominator. But the proof strategy is very similar, except it
involves more points around which expansions have to be taken.
In the two strategy case case, we can rewrite the homopoty system (63) and (64) as
H1j (Î¾, Ï„ ) = {Ïqj cos(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Î›j xj âˆ’

e2xj +exj cos(yj )
1+e2xj +2exj cos(yj )

H2j (Î¾, Ï„ ) = {Ïqj sin(qÏ•j ) âˆ’ 1}Ï„ + (1 âˆ’ Ï„ ) Î›j yj âˆ’

exj sin(yj )
1+e2xi +2exj cos(yj )

.
,

and
.
.

We need to check the presence of solutions in the small vicinity of the imaginary axis. Now consider
positive increments of xj such that xj is equal to some small value . If we linear the above homotopy system
around xj = 0, we can approximate them linearly by
H1j =Ï„ qyjqâˆ’1 âˆ’
H2j =Ï„ yjq


(1 âˆ’ Ï„ )
1
1+Ï„
Î»jk xk (1 âˆ’ Ï„ )
âˆ’
+ Î»jj (1 âˆ’ Ï„ ) +
2
1 + cos(yj )
2

+ (1 âˆ’ Ï„ )


k

k=j

1 âˆ’ Ï„ sin(yj )
Î»jk yk âˆ’
âˆ’Ï„
2 1 + cos(yj )

(68)

where Î»jj is the j, jth element of the Î› matrix.
One can see that these two functions are continuous everywhere except for the set of points {yj =
Ï€ + 2Ï€k, k âˆˆ Z} where cos (yj ) = âˆ’1.
We will prove that for appropriate large values of q this system has no solutions in the vicinity of this
set. First of all note that if we take a second order expansion of 1 + cos (yj ) around some yjâˆ— = Ï€ + 2Ï€k we

2
can approximate 1 + cos (yj ) â‰ˆ 12 yj âˆ’ yjâˆ— . Then we can further linearize these two equations in (68) to:
H1j =Ï„ qyjâˆ— qâˆ’1 âˆ’ Î»jj (1 âˆ’ Ï„ ) +



Î»kj xk (1 âˆ’ Ï„ ) âˆ’

k=j

H2j =Ï„ yjâˆ— q

+ (1 âˆ’

Ï„ )Î»jj yjâˆ—

âˆ’



1+Ï„
(1 âˆ’ Ï„ )
âˆ’
2
(yj âˆ’ yjâˆ— )2

Î»kj yk (1 âˆ’ Ï„ ) âˆ’ Ï„ + (1 âˆ’ Ï„ )

k=j

1
(yi âˆ’ yiâˆ— )

(69)



where we have also used sin (yj ) â‰ˆ âˆ’ yj âˆ’ yjâˆ— .
Now we can construct a sequence of homotopies with the order q increasing to inï¬nity at appropriate
rate such that these homotopies do not have solutions with extraneous solution of |yj | â†’ âˆ. This sequence
of q is constructed by letting q = 1 + 1/, as  â†’ 0. Along this sequence, we will see below that the solutions
yj âˆ’ yjâˆ— to H1j and H2j will be of diï¬€erent orders of magnitude. Therefore there can not solutions yj âˆ’ yjâˆ—
that simultaneously satisfy both equations H1j = 0 and H2j = 0.

 1
âˆ—
To see this, consider the ï¬rst part H1j = 0 of (69). For small  only the ï¬rst term Ï„ qyjâˆ— qâˆ’1 = O yj 

âˆ—
and the last term (y(1âˆ’Ï„)
âˆ— 2 dominate. Therefore the solution yj âˆ’ yj has to have the order of magnitude
j âˆ’yj )

/
1
1 âˆ—âˆ’ 2
. On the other hand, for the second part H2j = 0 of (69). For small  only the ï¬rst term
yj
O
 1
âˆ—
1
Ï„ yjâˆ— q = O yj  and the last term (1 âˆ’ Ï„ ) (yi âˆ’y
dominate. Therefore the solution yj âˆ’ yjâˆ— has to have the
âˆ—
i)

/


1
âˆ—âˆ’ 1
1 âˆ—âˆ’ 2
as  â†’ âˆ. Therefore
yj
order of magnitude O yj  which increases to âˆ much slower than O

41

there can be no solution yj to both H1j and H2j simultaneously for the sequence of q chosen above. This
proves that the homotopy is path ï¬nite along that sequence of q.
The considered homotopy function is analytic outside the balls of ï¬xed radius around the members of
countable set of points {xj = 0, yj = Ï€ + 2Ï€k}, k âˆˆ Z 9 . Therefore a monotone smooth parametrization is
available except for the interior of these balls because the determinant of the Jacobian is strictly positive
everywhere else.
This establishes regularity of the homotopy and concludes the proof.

2

Proof of equation (68): We consider each term individually. First of all
Ï€
Ï€

Ï• = arctan (y/) = âˆ’ arctan (/y) â‰ˆ âˆ’ .
2
2
y
Hence, as long as q is chosen so that qÏ€/2 is 2kÏ€ +

Ï€
2

for some k,


 
Ï€

q
q
cos (qÏ•) = cos (q arctan (y/)) â‰ˆ cos q âˆ’ q
= sin
â‰ˆ .
2
y
y
y

Together with Ïq â‰ˆ yjq , this gives the ï¬rst term in H1j .
Secondly, a ï¬rst order expansion around  = 0 gives
exj sin(yj )
1 1
1
â‰ˆ + 
.
x
2x
j
i
1 + e + 2e cos(yj )
2 2 1 + cos (yj )
Therefore the H1j is proved in (68).
The second part of H2j follows similarly, noting that given the choice of q where sin(qÏ•) = 1, and
Ïqj

â‰ˆ yjq , and the ï¬rst Taylor expansion term for

exj sin(yj )
1+e2xi +2exj cos(yj )

vanishes.

End of proof for equation (68).

C

Semiparametric Variance

To derive Î©, we need to follow Newey (1990) and derive the asymptotic linear inï¬‚uence function of the left
hand side of the above relation. For this purpose, note that
T



1 
âˆš
A (st ) yt âˆ’ Ïƒ st , Î¦Ì‚, Î¸0
T t=1
T
T

 

1 
1 
=âˆš
A (st ) (yt âˆ’ Ïƒ (st , Î¦0 , Î¸0 )) âˆ’ âˆš
A (st ) Ïƒ st , Î¦Ì‚, Î¸0 âˆ’ Ïƒ (st , Î¦0 , Î¸0 ) .
T t=1
T t=1

Since Î¦Ì‚ depends only on the nonparametric estimates of choice probabilities ÏƒÌ‚j (k|s) , j = 1, . . . , n, k =
1, . . . , K in (29) through (24), the second part can also be written as
T
1 
âˆš
A (st ) (Î“ (st , Î¸0 ; ÏƒÌ‚ (s)) âˆ’ Î“ (st , Î¸0 ; Ïƒ0 (s))) ,
T t=1
9

Moreover, it is possible to check that the homotopy system has no solutions when all arguments are purely

imaginary in case if q is an arbitrary odd number

42

where ÏƒÌ‚ (s) is the collection of all ÏƒÌ‚j (k|s) for j = 1, . . . , n and k = 1, . . . , K, and the function Î“ (Â·) is
deï¬ned in (28). Then using the semiparametric inï¬‚uence function representation of Newey (1994), as long
as Î“ (st , Î¸, Ïƒ (s)) is suï¬ƒciently smooth in Ïƒ (s) and as long as the nonparametric ï¬rst stage estimates satisfy
certain regularity conditions regarding the choice of the smoothing parameters, we can write this second
part as
T
1 
âˆš
A (st ) (Î“ (st , Î¸0 ; ÏƒÌ‚ (s)) âˆ’ Î“ (st , Î¸0 ; Ïƒ0 (s)))
T t=1
T
1 
âˆ‚
=âˆš
A (st )
Î“ (st , Î¸0 ; Ïƒ0 (s)) (yt âˆ’ Ïƒ (st , Î¸0 )) + op (1) .
âˆ‚Ïƒ
T t=1

In other words, if we write Î“Ïƒ (s) =

âˆ‚
âˆ‚Ïƒ Î“ (st , Î¸0 ; Ïƒ0 (s)),

we can write

T



1 
âˆš
A (st ) yt âˆ’ Ïƒ st , Î¦Ì‚, Î¸0
T t=1
T
1 
A (st ) (I âˆ’ Î“Ïƒ (st )) (yt âˆ’ Ïƒ (st , Î¸0 )) + op (1) .
=âˆš
T t=1

Therefore we can derive the asymptotic distribution of the two-step semiparametric Î¸Ì‚ deï¬ned through
(33) as
T


âˆš 
âˆ’1 1
T Î¸Ì‚ âˆ’ Î¸0 = âˆ’ (EA (st ) Î“Î¸ (st )) âˆš
A (st ) (I âˆ’ Î“Ïƒ (st )) (yt âˆ’ Ïƒ (st , Î¸0 )) + op (1) .
T t=1

Hence

âˆš 
d
T Î¸Ì‚ âˆ’ Î¸0 âˆ’â†’ N (0, Î£)
where Î£ is equal to
âˆ’1 "

E (A (st ) Î“Î¸ (st ))



#

 âˆ’1
.
EA (st ) (I âˆ’ Î“Ïƒ (st )) Î© (st ) (I âˆ’ Î“Ïƒ (st )) A (st ) E Î“Î¸ (st ) A (st )

In the above, we have deï¬ned

!
!
âˆ‚
Î“ (st , Î¸1 , Ïƒ (st ; Î¸2 )) !!
,
Î“Î¸ (st ) =
âˆ‚Î¸1
Î¸1 =Î¸2 =Î¸0

and
Î© (st ) = V ar (yt âˆ’ Ïƒ (st , Î¸0 ) |st ) .
The eï¬ƒcient choice of the instrument matrix (which can be feasibly estimated in preliminary steps without
aï¬€ecting the asymptotic variance) is then given by


âˆ’1

A (st ) = Î“Î¸ (st ) (I âˆ’ Î“Ïƒ (st ))

âˆ’1

Î© (st )

âˆ’1

(I âˆ’ Î“Ïƒ (st ))

.

With this eï¬ƒcient choice of the instrument matrix, the asymptotic variance of Î¸Ì‚ becomes

âˆ’1

âˆ’1
âˆ’1
âˆ’1
EÎ“Î¸ (st ) (I âˆ’ Î“Ïƒ (st )) Î© (st ) (I âˆ’ Î“Ïƒ (st ))
Î“Î¸ (st )
.

43

(70)

C.1

Eï¬ƒciency Considerations

We present two eï¬ƒciency results in this section. First of all, we show that with the above eï¬ƒcient choice of
the instrument matrix A (st ), the semiparametric two step estimation procedure above is as eï¬ƒcient as the
full maximum likelihood estimator where the ï¬xed point mapping in (28) is solved for every parameter value
Î¸ which is then nested inside maximum likelihood optimization to obtain choice probabilities as a function
of Î¸. Secondly, we show that estimating ÏƒÌ‚ (st ) may even improves eï¬ƒciency over the hypothesis case where
Ïƒ (st ) is known and the pseudo MLE in (34) is used to estimate Î¸ (but using Î¦0 instead of Î¦Ì‚).

C.1.1

Eï¬ƒciency comparison with full maximum likelihood

Consider a full maximum likelihood approach where a ï¬xed point calculation (assuming the solution is
unique) of (28) is nested inside the numerical optimization. For each Î¸, (28) is solved to obtain Ïƒ (st , Î¸) as
a function of Î¸, which is then used to form the likelihood function as in (34). Deï¬ne the total derivative of
(28) as
!
!
d
d
Ïƒ (st , Î¸0 ) =
Î“ (st , Î¸, Ïƒ (st ; Î¸)) !!
dÎ¸
dÎ¸
Î¸=Î¸0
d
=Î“Î¸ (st ) + Î“Ïƒ (st ) Ïƒ (st , Î¸0 )
dÎ¸
which can be used to solve for
d
âˆ’1
Ïƒ (st , Î¸0 ) = (I âˆ’ Î“Ïƒ (st )) Î“Î¸ (st ) .
dÎ¸

(71)

Following the same logic as the discussions of pseudo MLE after (34), but with the pseudo log likelihood
function replaced by the full maximum likelihood function, it is easy to show that the asymptotic distribution
of the full maximum likelihood estimator, which is the same as an iv estimator with the instruments chosen
optimally, satisï¬es

âˆš 
d
T Î¸Ì‚F M LE âˆ’ Î¸0 âˆ’â†’ N (0, Î£F M LE )
where

Î£F M LE =

d

âˆ’1 d

E Ïƒ (st , Î¸0 ) Î© (s)
Ïƒ (st , Î¸0 )
dÎ¸
dÎ¸

âˆ’1
.

Using (71), we can also write

âˆ’1

âˆ’1
âˆ’1
âˆ’1
Î£F M LE = EÎ“Î¸ (st ) (I âˆ’ Î“Ïƒ (st )) Î© (st ) (I âˆ’ Î“Ïƒ (st )) Î“Î¸ (st )
.
This is identical to (70) for the asymptotic variance of the two step semiparametric iv estimator when the
instrument matrix is chosen optimally.

44

C.1.2

Eï¬ƒciency comparison with infeasible pseudo MLE

Consider an infeasible pseudo MLE, which is similar to (34) except with Î¦Ì‚ replaced by the true but unknown
Î¦0 :
K
T 
n


t=1 i=1


yikt log Ïƒi (k|st , Î¦0 , Î¸) +

1âˆ’

k=1

K

k=1





yikt log 1 âˆ’

K



Ïƒi (k|st , Î¦0 , Î¸)

.

(72)

k=1

The asymptotic variance of this estimator is similar to that of Î£F M LE except with


d
dÎ¸ Ïƒ (st , Î¸0 )

replaced by

Î“Î¸ (st ). In other words,

âˆ’1

âˆ’1
.
Î£IP M LE = EÎ“Î¸ (st ) Î© (st ) Î“Î¸ (st )
where IP M LE stands for infeasible pseudo MLE.
The relation between Î£F M LE and Î£IP M LE is obviously ambiguous and depends on the response matrix
Î“Ïƒ (st ). It is clear possible that Î£F M LE < Î£IP M LE , in which case estimating Î¦Ì‚ may improve eï¬ƒciency over
the case where Î¦0 is known.

45

PARAMETER
Î¸1
Î¸2
Î¸3
Î¸4
x1
X2

Table 6.1: Characteristics of the Parameters
MEAN
VARIANCE
2.45
1
5.0
1
1.0
1
-1.0
1
1.0
0.33
1.0
0.33

DISTRIBUTION
Normal
Normal
Normal
Normal
Uniform
Uniform

Table 6.2 (i): Results of Monte-Carlo Simulations, n=3.
PARAMETER
MEAN
STD. DEV
MAX
# of equilibria
1.592
1.175
7
P1
0.366
0.362
0.998
P2
0.360
0.367
0.995
P3
0.363
0.348
0.993

1
0
0
0.003

Table 6.2 (ii): Results of Monte-Carlo Simulations, n=4.
PARAMETER
MEAN
STD. DEV
MAX
# of equilibria
1.292
0.777
5
P1
0.278
0.328
0.981
P2
0.246
0.320
0.981
P3
0.276
0.338
0.999
P4
0.280
0.338
0.987

MIN
1
0.001
0.003
0.001
0.002

Table 6.2 (iii): Results of Monte-Carlo Simulations, n=5.
PARAMETER
MEAN
STD. DEV
MAX
# of equilibria
1.106
0.505
5
P1
0.104
0.201
0.964
P2
0.138
0.252
0.975
P3
0.315
0.338
0.992
P4
0.356
0.385
0.983
P5
0.319
0.344
0.982

1
0
0
0
0
0

MIN

MIN

Table 6.3 (i): Frequencies for the number of equilibria, n=3.
# OF EQUILIBRIA
NUMBER OF CASES
FREQUENCY (%)
n=1
192
47.93
n=3
132
33.06
n=5
64
16.12
n=7
12
2.89
Total
400
1.00
Table 6.3 (ii): Frequencies for the number of equilibria, n=4.
# OF EQUILIBRIA
NUMBER OF CASES
FREQUENCY (%)
n=1
287
71.84
n=3
93
23.30
n=5
20
4.85
Total
400
1.00
Table 6.3 (iii): Frequencies for the number of equilibria, n=5.
# OF EQUILIBRIA
NUMBER OF CASES
FREQUENCY (%)
n=1
373
93.16
n=3
25
6.21
n=5
2
0.62
Total
400
1.00

Table 6.4 (i): Entry Probability of First Player, n=3.
# OF EQUILIBRIA
MEAN
STD
n=1
0.375
0.386
n=3
0.337
0.341
n=5
0.353
0.322
n=7
0.601
0.367
Table 6.4 (ii): Entry Probability of First Player, n=4.
# OF EQUILIBRIA
MEAN
STD
n=1
0.211
0.300
n=3
0.431
0.328
n=5
0.129
0.235
Table 6.4 (iii): Entry Probability of First Player, n=5.
# OF EQUILIBRIA
MEAN
STD
n=1
0.116
0.216
n=3
0.080
0.206
n=5
0.007
0.232

Table 7.1: Recommendation Variables.
RECOMMENDATION
NUMERICAL VALUE RECORDED BY
I/B/E/S
Strong Buy
1
Buy
2
Hold
3
Underperform
4
Sell
5

VARIABLE
Recommendation
Relation
Ibank
Earnings

Table 7.2: Summary Statistics.
MEAN
STD.
MIN.
2.210
0.9168
1
0.0350
0.1839
0
0.8155
0.3878
0
0.1111
0.2439
-3.010

MAX.
5
1
1
1.720

NOBS
12719
12719
12719
12719

Table 7.3: Tabulation of Recommendations by Quarter.
VARIABLE/TIME
Q1 1998
Q1 2000
Q2 2003
PERIOD
% Recs. Equal to 1
30.51
46.73
11.65
% Recs. Equal to 2
30.51
41.46
18.12
% Recs. Equal to 3
37.62
11.81
53.07
% Recs. Equal to 4
1.02
0.00
12.62
% Recs. Equal to 5
0.34
0.00
4.53

Table 7.4 Ordered Logit Estimates of the Effect of Fundamentals.
VARIBLE
COEF.
COEF.
COEF.
COEF.
%DEV
-.0539 (-0.276) -.1030 (-0.519)
ABS. DEV
-.1030 (-0.519)
Log Likelihood
Psueo-R2
Fixed Effects

-16171.589
0.0000
none

-14861.218
0.0810
quarterly,stock

-14861.218
0.0810
quarterly, stock

-14861.352
0.0810
quarterly, stock

In the ordered logit model, the dependent variable is the analystâ€™s recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses. Most
of the quarterly and stock fixed effects are significant in the specifications that we study.

Table 7.5 Quarterly Effects Versus Market Indexes.
COEFFICIENT T-STATISTIC NASDAQ
-0.1865
-1.979
1,770
-0.15266
-1.803
1,509
-0.24117
-2.258
1,928
-0.27011
-3.134
2,207
-0.36868
-4.297
2,467
-0.46412
-5.485
2,752
-0.43603
-5.149
3,341
-0.6408
-7.394
4,732
-0.43113
-4.973
3,471
-0.35704
-3.958
4,252
-0.08381
-1.031
2,664
0.07177
0.955
2,126
0.04712
0.632
2,131
0.063716
0.79
1,802
0.128908
1.671
1,915
0.217669
2.86
1,745
0.349657
4.631
1,613
0.630952
8.753
1,403
1.009163
13.389
1,887
0.572553
7.596
1,345
0.989535
12.45
1,374

VARIABLE
qdum2
qdum3
qdum4
qdum5
qdum6
qdum7
qdum8
qdum9
qdum10
qdum11
qdum12
qdum13
qdum14
qdum15
qdum16
qdum17
qdum18
qdum19
qdum20
qdum21
qdum22

QQQ

Table 7.6 Regression of Dummies on Market Indexes.
VARIABLE
COEFFICIENT
COEFFICIENT
Constant
.8208896 (3.965)
0.6270 (4.3)
Nasdaq Index
-.0003467 (-4.960)
QQQ Price
-0.007 (-4.7)
Nobs
R2

21
0.48

18
0.6830

102.25
103.87
120.12
148.63
214.5
85.19
103
64.06
46.97
85.19
36.51
39.29
34.15
30
26.05
21.07
24.72
26.06

Table 7.7 Ordered Logit Estimates of the Effect of Conflicts of Interest.
VARIBLE
COEF.
COEF.
COEF.
COEF.
RELATION
-.3231 (-6.19)
-.1108 (-2.06)
.05397 (0.94)
.03932 (0.68)
IBANK
.1080 (4.18)
Log Likelihood
Psueo-R2
Fixed Effects

-16152.389
0.0012
none

-15314.605
0.0530
quarterly

-14860.888
0.0811
quarterly, stock

-14855.94
0.0814
quarterly, stock

In the ordered probit model, the dependent variable is the analystâ€™s recommendation as coded by IBES.
This takes on discrete values from one to five. In the table above, t-statistics are included in parentheses.
We do not report ancillary parameters, such as the cut values and values of the fixed effects.

Table 7.8 Ordered Logit Estimates including Peer Effects (Parametric First Stage)
VARIABLE
COEF.
COEF.
COEF.
COEF.
IVBELIEF
1.121982
1.108108
.2531818
.2531353
(24.66)
(7.90)
(5.80)
(5.75)
IBANK

-

-

-

RELATION

-

-

-

%DEV

-

-

-

.0073782
(0.71)

-15113.967
0.0472
none

-14930.088
0.0588
stock

-14823.868
0.0830
quarterly, stock

-14535.476
0.0837
quarterly, stock

Log Likelihood
Psueo- R 2
Fixed Effects

.2938029
(4.41)
-.0879437
(-1.16)

In the ordered logit model, the dependent variable is the analystâ€™s recommendation as coded by IBES. This
takes on discrete values from one to five. In the table above, t-statistics are included in parentheses (the tstatistic for the variable IVBELIEF is corrected using bootstrap). IVBELIEF is constructed by subtracting
the individual fitted values (divided by the number of the other analysts for a specific stock in a specific
quarter) from the conditional expectations of fitted values (conditional on quarter and stock), with these
fitted values being from the parametric first stage regression. Most of the quarterly and stock fixed effects
are significant in the specifications that we study.

Table 7.9 Ordered Logit Estimates including Peer Effects (Semiparametric First Stage)
VARIABLE
COEF.
COEF.
COEF.
COEF.
IVBELIEF
1.121863
1.108009
.2542394
.2540114
(10.73)
(23.20)
(5.95)
(5.90)
IBANK

-

-

-

RELATION

-

-

-

%DEV

-

-

-

-15113.55
0.0472
none

-14929.674
0.0588
stock

-14545.766
0.0830
quarterly, stock

Log Likelihood
Psueo- R 2
Fixed Effects

.2935598
(4.41)
-.0880207
(-1.16)
.0072834
(0.70)
-14535.35
0.0837
quarterly, stock

In the ordered logit model, the dependent variable is the analystâ€™s recommendation as
coded by IBES. This takes on discrete values from one to five. In the table above, t-statistics are included in
parentheses (the t-statistic for the variable IVBELIEF is
corrected using bootstrap). IVBELIEF is constructed by subtracting the individual fitted values (divided by
the number of the other analysts for a specific stock in a specific quarter) from the conditional expectations
of fitted values (conditional on quarter and stock), with these fitted values being from the first stage
semiparametric sieve regression. Most of the quarterly and stock fixed effects are significant in the
specifications that we study.

Table 7.10 Random Effect Estimates including Peer Effects (Semiparametric First Stage)
VARIABLE
COEF.
COEF.
COEF.
COEF.
COEF.
IVBELIEF
.766924
.7631302
.7672082
(11.53)
(11.51)
(10.63)
IBANK

-

RELATION

-

Log
Likelihood

-6454.5547

.6669054
(7.94)
-6687.9966

-

-

-.2539996
(-1.61)

-.1754189
(-1.22)

.6559327
(7.87)
-.2416273
(-1.67)

-6717.4526

-6453.8047

-6423.6011

The dependent variable is equal to zero if the analystâ€™s recommendation is recorded as 1
(i.e. strong buy) in IBES and one otherwise. IVBELIEF is constructed by subtracting the individual fitted
values (divided by the number of analysts for a specific stock in a specific quarter) from the conditional
expectations of fitted values (conditional on quarter and stock), with these fitted values being from the first
stage semiparametric sieve regression. In the table above, t-statistics are included in parentheses (the tstatistic for the variable IVBELIEF is corrected using bootstrap). There was a unique fixed effect for
each stock during each quarter. In the data, 3447 observations were dropped due to all
positive or negative recommendations.

IBANK=0
QUARTER=9
IBANK=1
QUARTER=9
FIRST
EQUILBRIUM
IBANK=1
QUARTER=9
SECOND
EQUILBRIUM
IBANK=0
QUARTER=21
IBANK=1
QUARTER=21

Table 7.11 Equilibrium Simulations.
REC=1
REC=2
REC=3
REC=4

REC=5

0.6353

0.2785

0.08113

0.4650E-03

0.3400E-04

0.06847

0.68742

0.22397

0.014376

0.5753E-02

0.4042

0.4009

0.1821

0.01183

0.87246E-04

0.2096

0.4076

0.3507

0.2967E-02

0.2235E-03

0.09775

0.2936

0.5316

0.7127E-02

0.5653E-03

