                               NBER WORKING PAPER SERIES




                    COMPETING FOR ORDER FLOW IN OTC MARKETS

                                         Benjamin Lester
                                       Guillaume Rocheteau
                                       Pierre-Olivier Weill

                                       Working Paper 20608
                               http://www.nber.org/papers/w20608


                      NATIONAL BUREAU OF ECONOMIC RESEARCH
                               1050 Massachusetts Avenue
                                 Cambridge, MA 02138
                                     October 2014




Pierre Mabille and Semih Uslu provided expert research assistance. We‚Äôd like to thank the participants
of the JMCB-SNB-Uni Bern 2013 Conference on Financial Frictions and Julien Hugonnier for comments
that greatly improved the paper. The views expressed in this paper do not necessarily reflect those
of the Federal Reserve Bank of Philadelphia, the Federal Reserve System, or the National Bureau of
Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

¬© 2014 by Benjamin Lester, Guillaume Rocheteau, and Pierre-Olivier Weill. All rights reserved. Short
sections of text, not to exceed two paragraphs, may be quoted without explicit permission provided
that full credit, including ¬© notice, is given to the source.
Competing for Order Flow in OTC Markets
Benjamin Lester, Guillaume Rocheteau, and Pierre-Olivier Weill
NBER Working Paper No. 20608
October 2014
JEL No. D53,D83,G1,G12

                                            ABSTRACT

We develop a model of a two-sided asset market in which trades are intermediated by dealers and
are bilateral. Dealers compete to attract order flow by posting the terms at which they execute trades‚Äî
which can include prices, quantities, and execution speed‚Äîand investors direct their orders toward
dealers that offer the most attractive terms. We characterize the equilibrium in a general setting, and
illustrate how the model can account for several important trading patterns in over-the-counter markets
which do not emerge from existing models. We then study two special cases which allow us to highlight
the differences between these existing models, which assume investors engage in random search for
dealers and then use ex post bargaining to determine prices, and our model, which utilizes the concept
of competitive search in which dealers post terms of trade. Finally, we calibrate our model, illustrate
that it generates reasonable quantitative outcomes, and use it to study how trading frictions affect the
per-unit trading costs that investors pay in equilibrium.


Benjamin Lester                                    Pierre-Olivier Weill
Research Department                                Department of Economics
Federal Reserve Bank of Philadelphia               University of California, Los Angeles
10 Independence Mall                               Bunche Hall 8283
Philadelphia, PA 19106                             Los Angeles, CA 90095
Benjamin.Lester@phil.frb.org                       and NBER
                                                   poweill@econ.ucla.edu
Guillaume Rocheteau
Department of Economics
University of California at Irvine
3151 Social Science Plaza
Irvine, California 9269
grochete@uci.edu
1       Introduction
Many assets are traded in over-the-counter (OTC) markets, including government, municipal, and
corporate bonds, asset-backed securities, various types of derivatives, and currencies, to name a
few. These markets have not only been growing in size, but also in economic importance: for
example, the market for repurchase agreements has become crucial for the provision of liquidity,
while the markets for credit default swaps and foreign exchange swaps have become essential for
insuring firms and financial intermediaries against various types of shocks. Most often, trade in
these markets is intermediated by dealers who maintain a two-sided market, simultaneously buying
and selling securities on behalf of individual investors.
    A recent literature, building off of the framework in Duffie, GaÃÇrleanu, and Pedersen (2005,
henceforth DGP), has developed theoretical models that capture important features of intermedi-
ated OTC markets, and has used these models to gain a better understanding of the factors that
determine bid and ask prices, allocations, the speed of trade, and overall trading volume. These
models formalize intermediated OTC markets as highly decentralized trading venues in which in-
vestors contact dealers at a constant (exogenously specified) rate, at which time they are able to
trade at a price determined by ex post bargaining.
    While this formalization has generated a number of insights, it is at odds with two important
features of real world OTC markets. First, dealers often post and commit to bid and ask prices,
which are readily available to investors.1 Second, these prices appear to play an important role
in determining the speed at which different investors trade. More specifically, empirical evidence
suggests that investors face a clear trade-off between the terms of trade that they are quoted and
the speed at which their trade will be executed: as Boehmer (2005) writes, ‚Äúhigh execution costs
are systematically associated with fast execution speed, and low costs are associated with slow
execution speed. This relationship holds both across markets and across order sizes.‚Äù2 Hence,
even though empirical evidence suggests that search frictions are an important element of OTC
markets, it remains a challenge to formalize these frictions in a way that (i) incorporates the role of
    1
      As Duffie (2012, pg. 4) writes, ‚ÄúIn some dealer-based OTC markets, especially those with active brokers, a
selection of recently quoted or negotiated prices is revealed to a wide range of market participants. (...) In OTC
markets for U.S. corporate and municipal bonds, regulators have mandated post-trade price transparency through the
publication of an almost complete record of transactions shortly after they occur. (...) In OTC derivatives markets,
such as the market for credit default swaps, clients of dealers can request ‚Äòdealer runs,‚Äô which are essentially lists
of dealers‚Äô prospective bid and offer prices on a menu of potential trades. Dealers risk a loss of reputation if they
frequently decline the opportunity to trade near these indicative prices when contacted soon after providing quotes for
a dealer run.‚Äù
    2
      Similarly, Battalio, Hatch, and Jennings (2003) find that orders obtain better trade prices on the NYSE but faster
executions at Trimark Securities, a Nasdaq dealer. Boehmer, Jennings, and Li (2007) establish that brokers‚Äô routing
decisions take into account the disclosure of quality execution across trading centers: markets with low trading costs
and fast fills were able to attract more orders.


                                                           2
prices in directing order flow; and (ii) generates the observed relationships between the prices that
dealers post, the types of investors who choose those prices, and the speed at which these investors
trade. In this paper, we construct and analyze a model of OTC markets to accomplish these goals.
    Our framework adopts many of the basic building blocks from the literature that has evolved
from DGP, and specifically the generalization by Lagos and Rocheteau (2009, henceforth LR):
investors with endogenously determined asset positions periodically receive idiosyncratic shocks
that affect their private valuations, at which time they attempt to re-balance their portfolios by
trading with dealers in a frictional market. The major point of departure is the way we model these
frictions: in contrast to the existing literature, we assume that dealers post contracts that are readily
observable to all investors, but search frictions remain because each dealer is limited in his capacity
to process multiple orders at once. This equilibrium concept is based on the model of ‚Äúcompetitive
search,‚Äù first introduced by Moen (1997) in the context of the labor market, but here generalized
to a two-sided market where dealers have an active role in executing the trades of both buyers and
sellers on a frictionless inter-dealer market.
    To be more precise, we assume that there is a large mass of competitive dealers posting con-
tracts that specify a quantity that they will buy or sell on the inter-dealer market, along with a fee for
doing so (or, equivalently, a bid-ask spread). Investors, who are heterogeneous with respect to both
their asset positions and their private valuations for the asset, observe these contracts and direct
their order flow to the contract of their choosing. However, dealers are capacity constrained‚Äî
they cannot execute orders instantaneously, but rather orders are processed slowly, at a rate that is
decreasing in the ratio of orders per dealer for this particular contract.
    This formulation of asset market frictions offers several advantages. First, the process of price
formation in the model more closely resembles the protocol in many OTC markets: dealers post
prices, and investors send orders to these dealers with the expectation that their orders will be filled
at the posted price. Second, the model is able to account for several empirical findings that do not
emerge from existing models; for example, investors face the trade-off between the bid-ask spread
and execution speed discussed above and, for some specifications, these bid-ask spreads decrease
with the size of the trade, which is consistent with evidence from certain OTC markets. Third,
the model generates new normative implications as well; for example, in a simple extension of the
benchmark model, we show that welfare is unambiguously increasing in the fraction of investors
who can observe posted contracts and direct their search, thus highlighting a margin through which
transparency in financial markets can improve allocations. Finally, the competitive search setting
offers a number of technical advantages, too: it avoids several inefficiencies that arise from the
Nash bargaining protocol, such as the well-known hold-up problem (see, e.g., Hosios (1990)); it
can easily accommodate the introduction of private information (see, e.g., Guerrieri et al. (2010));


                                                    3
and it also offers a more tractable environment for the analysis of aggregate shocks (see, e.g.,
Menzio and Shi (2011)). Hence, we believe the model provides a useful benchmark for future
modifications and extensions.
     The structure of the paper is as follows. We begin with the most general environment, where
investors are free to hold any (positive) asset position, and they periodically receive idiosyncratic
shocks to their private valuations that are drawn from an arbitrary distribution with finite support.
We provide a full characterization of steady-state equilibria, establish existence, and flesh out a
number of properties of equilibrium prices, allocations, and trading speeds. We show that dealers
design contracts to respond to investors‚Äô trading needs, and investors subsequently sort themselves
across posted contracts according to their private valuations and current asset holdings. In particu-
lar, the investors whose preferences are most severely misaligned with their asset holdings choose
to trade with dealers who offer fast execution times but high trading fees.
     Then, in order to gain additional insights and to compare our model more squarely with the
existing literature, we analyze two special cases in detail. First, we consider an environment in
which agents have one of two private valuations and their asset holdings lie in the set {0, 1}, as
in DGP. These restrictions make each investor‚Äôs choice of asset holdings trivial and allow us to
focus on the asset prices, trading fees, and execution times that prevail in the unique equilibrium.
We show that the equilibrium can be solved in closed form when search frictions are small, as in
Vayanos and Weill (2008) and Weill (2008), which allows for a large set of comparative statics.
Interestingly, we establish that the relationship between intermediation fees and the sellers‚Äô share
of the surplus (or implicit bargaining power) is hump-shaped, whereas bid-ask spreads in DGP
are increasing in the dealers‚Äô exogenous bargaining power. We also show that the price discount,
which indicates the rate at which the asset price falls relative to the Walrasian benchmark due to
search frictions, is non-monotonic with the dealers‚Äô bargaining power.
     For the second special case, we return to the general model with asset holdings in R+ and an
arbitrary number of preference shocks, but we adopt a Leontief specification for the expected exe-
cution time; that is, we assume there is strict complementarity between the measure of dealers and
the measure of orders to be executed. This trading technology generates average execution delays
that are constant across active submarkets, allowing us to focus on the implications of our equi-
librium concept for investors‚Äô endogenous asset holdings. We characterize the equilibrium when
the dealers‚Äô entry cost is small, which serves two purposes. First, the analysis is tractable in this
region of the parameter space, and hence we can study how asset demand, bid-ask spreads, and
trading volume respond to changes in the economic environment. Second, the equilibrium asset
holdings and the inter-dealer prices are the same as in LR when, in their model, the exogenous bar-
gaining power of dealers is equal to zero. Therefore, this class of equilibria is amenable to a direct


                                                  4
comparison with the existing literature. Our analysis reveals that the predictions of the competitive
search model differ markedly from the earlier literature in one dimension: the relationship between
trading costs and trade sizes. In earlier models with random matching and ex post bargaining, such
as that of LR, the trading cost per unit traded increases with the size of the trade. In contrast, under
competitive search, per-unit trading costs decrease with trade sizes.3 This prediction of our model
is in line with the evidence documented by Schultz (2001), Edwards, Harris, and Piwowar (2007),
Green, Hollifield, and SchuÃàrhoff (2007), and Hollifield, Neklyudov, and Spatt (2012) for over-the-
counter markets. Therefore, the structure of the market helps explain the empirical relationship
between trading costs and trade sizes.4
     Finally, in Section 5, we develop a numerical example within the context of our general model.
The purpose is two-fold. First, this exercise illustrates that our model can generate quantitative out-
comes of reasonable magnitude, in term of trade size, execution speed, and trading cost. Second,
we use this calibrated model to perform comparative statics exercises. In particular, we study how
the trading technology, which determines the time it takes for dealers to execute orders, affect the
average per-unit trading cost that investors pay, as well as the elasticity of this per-unit trading cost
to trade size, in the cross section. This analysis suggests that cross-sectional data on transaction
costs could be informative about some important features of the trading technology.

Related literature. Our paper is part of a long tradition in the market micro-structure literature,
starting at least with Ho and Stoll (1983), studying competition between dealers who serve out-
side customers. The description of the asset market that involves search and pairwise meetings
between dealers and investors, where dealers have access to a competitive inter-dealer market, is
based on DGP and LR. Other papers in this literature include Weill (2007), Gavazza (2011), and
Lagos, Rocheteau, and Weill (2011), to name a few. There are also other search-theoretic models
of financial intermediation with price-posting. Spulber (1996) describes an environment with com-
peting price-setting dealers. However, in contrast to our analysis, the contract posted by dealers
(bid and ask prices) can be observed only after a time-consuming search.5 For a more thorough
literature review of the search-theoretic approach to over-the-counter markets, see Rocheteau and
Weill (2011).
     Search-and-matching models offer a natural platform to study the interactions of investors trad-
ing at different speed. Some papers in the literature study asset pricing when speed differences are
   3
     The reason is that dealers reap a constant fraction of the surplus in LR, and the surplus is convex in trade size. In
our competitive search model with Leontief technology, by contrast, the price-setting mechanism implies that investors
pay a fixed trading cost to trade any quantity.
   4
     See Zhang (2012) for a different explanation in a model with ex post bargaining under asymmetric information.
   5
     Hall and Rust (2003) extend Spulber (1996) by introducing a second type of middlemen called market makers.
Each market maker posts publicly observable prices while posted prices of middlemen are not observable.

                                                            5
exogenously given, e.g., FeldhuÃàtter (2012) and Neklyudov (2012). Others are explicit about the
trade-off between execution speed and trading costs. An early contribution is the sequential search
model of block trading by Burdett and O‚ÄôHara (1987). More recent work includes the models
of Melin (2012) and Praz (2012), in which investors can trade simultaneously in a Walrasian and
an OTC market, or that of Pagnotta and Philippon (2011), in which investors can choose between
competing trading platforms that offer different execution speeds. We study the choice of execution
speed using a different approach, based on the the notion of competitive search, initially developed
by Moen (1997). Mortensen and Wright (2002) and Sattinger (2003) interpret this equilibrium
notion as one where competing brokers or market makers set up markets and charge entry fees to
participants. However, in contrast to our model, the brokers in these models do not contribute to
the matching of orders on both sides of the market and do not intermediate trades. Weill (2007,
Appendix IV) offers some preliminary analysis of a competitive search equilibrium without free
entry of dealers; instead, he assumes that the matching technology is concave in the measure of
investors and does not depend on the measure of dealers. Rocheteau and Weill (2011, p. 272)
apply competitive search to a simple model of an over-the-counter market where trades are not
intermediated by dealers and asset holdings are restricted to {0, 1}.
    Competitive search has also been recently applied to asset markets by Guerrieri and Shimer
(2012, 2013) and Chang (2012) in order to study the impact of asymmetric information (about
both common and private values) on liquidity in OTC markets. To do so, these authors build
on Guerrieri et al. (2010) and consider ‚Äúone-sided‚Äù competitive search models with {0, 1} asset
holdings, in which buyers post contracts to attract privately informed sellers; also see Inderst and
MuÃàller (2002), who study a market with durable goods under adverse selection and competitive
search. While we deal only with asymmetric information about private values (see, also, Faig
and Jerez, 2006), we explicitly characterize an equilibrium in a two-sided market, where prices
are posted by dealers who simultaneously buy and sell assets from investors, and we are able to
remove asset-holding restrictions.6 Finally, competitive search has been applied to markets for real
assets, such as housing, by Albrecht et al. (2013), Diaz and Jerez (2013), Lester et al. (2013), and
Stacey (2012). These models do not have dealers making two-sided markets.
   6
     Watanabe (2013) also utilizes a model of competitive search to analyze the role of middlemen in asset markets.
In his model, middlemen are assumed to have a greater capacity to store inventory than ordinary sellers. In contrast to
our assumption of a two-sided asset market, he assumes that middlemen can acquire these inventories‚Äîthat is, they
can purchase assets from sellers‚Äîin a frictionless market, before posting prices and selling to buyers in a market with
search frictions.




                                                          6
2       Environment
Time is continuous and goes on forever. The economy is populated with two types of infinitely-
lived agents: a unit measure of investors and a large measure of dealers. Both types of agents
discount the future at rate r > 0. There is one long-lived asset in fixed supply A ‚àà R+ . There is
also a perishable good, the numeÃÅraire, which is produced and consumed by all agents.

Preferences. The instantaneous utility function of an investor is ui (a)+c, where a ‚àà R+ denotes
the investor‚Äôs asset holdings, c ‚àà R denotes the net consumption of the numeÃÅraire good (with c < 0
if the investor produces more than he consumes), and i ‚àà {1, ..., I} ‚â° I indexes an investor‚Äôs
type, where 1 < I < ‚àû.7 We assume that ui (a) is continuously differentiable, with u0i (a) > 0,
u00i (a) < 0, u0i (0) = ‚àû and u0i (‚àû) = 0 for all i ‚àà I. We also assume that u0i (a) < u0i+1 (a) for
all a > 0 and i < I ‚àí 1, so that investors with higher i have higher demand for the asset. This
condition holds, for example, for the multiplicative specification in LR where ui (a) ‚â° Œµi v(a) for
Œµ1 < Œµ2 . . . < ŒµI .
      An investor‚Äôs preferences change over time according to a Poisson process with arrival rate Œ¥.
Conditional on receiving a preference shock, an investor of type i draws a new type j ‚àà I with
                         P
probability œÄij , where j‚ààI œÄij = 1 for all i ‚àà I. These type-switching processes are assumed
to be independent across investors. Unlike investors, dealers receive no utility flow from holding
an asset, nor can they hold asset inventories.8 Their instantaneous utility is simply c, the net
consumption of the numeÃÅraire good.

Trade. All trades are bilateral and are intermediated by dealers, i.e., they involve one dealer and
one investor. Dealers have continuous access to a competitive inter-dealer market in which they
can trade on behalf of investors.9 In order to attract orders from investors, dealers post (and commit
    7
      The specification for the utility function is borrowed from DGP, where a ‚àà {0, 1}, and LR where a ‚àà R+ . In
the case of a real asset, such as houses or physical capital, then ui (a) is a standard utility or production function.
In the case of a financial asset, ui is a reduced-form utility function that captures the various reasons why investors
may want to hold different quantities of the asset, such as differences in liquidity or hedging needs. The quasi-linear
specification, which is common to both monetary and labor search models, is adopted for tractability. Alternatively,
Duffie, GaÃÇrleanu, and Pedersen (2007), Vayanos and Weill (2008), and GaÃÇrleanu (2009) adopt CARA preferences.
One could also generalize preferences along the lines suggested by Wong (2013) in the context of a monetary search
model.
    8
      The assumption that dealers cannot hold assets is without loss of generality when analyzing steady-state equilibria,
as we do in this paper. See Weill (2007) and Lagos, Rocheteau, and Weill (2011) for dynamic equilibria where dealers
hold positions.
    9
      It should be emphasized that our dealers are different from the market-makers in Moen (1997) and Mortensen and
Wright (2002). In particular, the market-makers in these papers are passive third parties who announce prices in each
submarket; sellers then make an entry decision, buyers search, and the two parties trade directly. In our model, market-
makers play a more active role: they decide whether to enter the market, then trade with buyers and sellers, and finally


                                                            7
to) a publicly observable contract œÉ = (q, œÜ) specifying that the dealer will trade a quantity q at
the prevailing inter-dealer market price p in exchange for an intermediation fee œÜ.10 If q > 0, the
dealer buys the specified amount and delivers it to the investor. If q < 0, the dealer acquires the
asset from the investor and immediately resells it on the inter-dealer market. There is free entry
into the dealer market: dealers can choose to enter by posting a contract at a flow cost Œ≥ > 0,
which captures the ongoing costs of advertising their services to investors, maintaining access to
the inter-dealer market, and so on.11
    On the other side of the market, investors observe the contracts that have been posted and send
their order to one of these contracts. Dealers, however, cannot process these orders instantly. In
reality, there are a variety of factors that can delay either the process by which dealers receive or-
ders, or the process by which they execute them on the inter-dealer market. These factors include:
technological constraints on the ability of computers or communication lines to process orders;
institutional constraints on a dealer‚Äôs ability to execute, clear, settle, and confirm that orders have
been off-loaded in the inter-dealer market; cognitive constraints on a dealer‚Äôs ability to pay atten-
tion to multiple orders at once; and potentially even delays caused by information asymmetries,
such as the requirement that a dealer verifies the quality or value of collateral that has been posted.
In this paper, we do not take a precise stand on the reason why dealers take time to process an
order. Instead, we assume that orders are executed according to some abstract order-processing
technology, at a rate that is decreasing in the ratio of orders per dealer for this particular contract.12
    Formally, suppose that there is a measure d of dealers posting a particular contract, and a
settle these trades on the inter-dealer market. It is in this sense that we generalize the competitive search framework to
a ‚Äútwo-sided market.‚Äù The assumption that the inter-dealer market is frictionless, which was first introduced by DGP, is
a simplification that allows us to focus on the interaction between investors and dealers. In reality, inter-dealer markets
may also be frictional; these additional frictions could be modeled, though the analysis would be more cumbersome.
   10
      Alternatively, one could let dealers post a menu, œÜ(q), that specifies the intermediation fee as a function of the
quantity of assets traded. Anticipating that a submarket will open for each type of investor, it is without loss in
generality that we restrict œÉ to a flat fee contract. For an elaboration on this point in the context of a monetary search
model, see Appendix B in Lagos and Rocheteau (2004). Also, an alternative interpretation of the model is one with
large representative dealer firms composed of a continuum of individual dealers who can be allocated to different
submarkets. In this case the relevant schedule is a list of triples, (q, œÜ, Œ∏).
   11
      Our free-entry of dealers is similar to the one in Lagos and Rocheteau (2009). Similar free-entry conditions have
been used routinely in labor search models (Pissarides, 2000), in monetary search models (Rocheteau and Wright,
2005), and in search models with middlemen (Rubinstein and Wolinsky, 1987; Shevchenko, 2004). Following Moen
(1997), free-entry conditions are also typically assumed in competitive search environments as the entry cost pins
down the value of agents on one side of the market, but one could also consider a competitive search environment with
fixed populations.
   12
      Of course, depending on the precise origin of these frictions, the ratio of orders to dealers might not be sufficient
statistic for execution delays. For example, if the relevant constraints lie in a dealer‚Äôs ability to trade each share on the
inter-dealer market, then the expected delay could potentially depend on the size of the order‚Äîi.e., larger orders could
take longer to fill‚Äîand hence the distribution of quantities that a dealer is asked to fill could be relevant. We leave
these types of extensions, and other modifications to the matching function, for future work.



                                                             8
measure o of orders for this contract. We assume that, at each instant, the flow of orders processed
and executed by dealers is equal to m(d, o), a function which has constant returns-to-scale, is
strictly increasing, strictly concave and twice continuously differentiable with respect to its two
arguments, and satisfies Inada conditions.13 Assuming further that each order is equally likely to
be executed at any point in time, the time it takes to execute any particular order for this contract is
an exponentially distributed random variable with parameter Œ±(Œ∏) ‚â° m(d, o)/o = m(Œ∏, 1), where
Œ∏ ‚â° d/o.14 Symmetrically, a dealer who has posted this contract executes it at an exponentially
distributed time with intensity Œ±(Œ∏)/Œ∏. These assumptions on m(d, o) imply that Œ±(¬∑) is continuous,
strictly increasing, strictly concave, and satisfies Œ±(0) = 0, Œ±(‚àû) = ‚àû, and Œ±(‚àû)/‚àû = 0.
Moreover, the strict concavity of Œ±(¬∑) implies that Œ±(Œ∏)/Œ∏ is strictly decreasing in Œ∏. Finally, if an
investor‚Äôs idiosyncratic valuation changes before a standing order is executed, we assume that he
can cancel the unfilled order at no cost and redirect a new order toward a different contract.


3        Equilibrium
In this section we define and derive conditions for a steady-state equilibrium. These conditions
describe (i) the optimal entry and posting behavior of dealers, taking as given the order flow they
receive from posting any contract and the inter-dealer price; (ii) the optimal order submission
strategy of investors, taking as given prices and the set of contracts that are available to them;
and (iii) the market tightness in each active submarket that is consistent with both a stationary
distribution across investor types and market clearing.


3.1      Definition
Let Œ£ denote the set of all possible contracts and Œ£? the set of contracts offered in equilibrium.
We assume that an investor can always choose not to send any order, so that 0 = (0, 0) ‚àà Œ£? . We
define a submarket as a contract, œÉ ‚àà Œ£, a set of dealers posting this contract, and a set of investors
sending an order for this contract. The dealer-to-investor ratio, or market tightness, prevailing in a
submarket for contract œÉ ‚àà Œ£ is denoted by Œò(œÉ). The function Œò(œÉ) is defined for all possible
contracts, not only those offered in equilibrium. The set of all possible investors‚Äô types, (i, a), is
    13
      Whether or not the order execution technology has constant returns to scale remains an open question in the
context of asset markets. Unfortunately, in contrast to the labor market‚Äîwhere reliable data exists for the number of
unemployed workers, the number of vacancies, and the number of matches that form in a particular labor market‚Äîthe
analogous data for financial markets is elusive.
   14
      Burdett et al. (2001) formally illustrate how capacity constraints can generate a function Œ±(Œ∏) with the proper-
ties we assume. This formulation of meeting frictions is also consistent with the ‚Äútelephone line‚Äù Poisson queueing
processes described in Stevens (2007) and Sattinger (2010).


                                                          9
N ‚â° I √óA. For simplicity we let A = R+ but our formulation and proofs remain identical if there
are asset-holding restrictions. We denote the support of the equilibrium stationary distribution of
investors‚Äô types by N ? ‚äÜ N .

Dealers.   The profits of a dealer who posts a contract œÉ ‚àà Œ£ are denoted by Œ†(œÉ) and solve:

                                                             Œ± [Œò (œÉ)]
                                      rŒ†(œÉ) = ‚àíŒ≥ +                     œÜ.
                                                              Œò (œÉ)

The first term on the right side is the flow cost of posting a contract, while the second term is
the expected fee received by a dealer, i.e., the Poisson rate at which a dealer receives the order,
Œ± [Œò(œÉ)] /Œò(œÉ), times the fee paid by the investor upon execution of the order, œÜ. Therefore, the
zero-profit condition of dealers can be written

                        Œ†(œÉ) ‚â§ 0, with equality if œÉ ‚àà Œ£? and œÉ 6= 0.                              (1)

The expected profits of a dealer are zero in any active submarket, œÉ ‚àà Œ£? , and they are non-positive
in inactive submarkets, œÉ ‚àà Œ£\Œ£? , since otherwise posting a contract in that submarket would be
profitable.

Investors. Let Vi (a, œÉ, Œ∏) denote the expected lifetime payoff of an investor of type (i, a) ‚àà N ?
who sends an order for contract œÉ = (q, œÜ) given market tightness Œ∏:
                                             X
                                ui (a) + Œ¥         œÄij Vj? (a) + Œ±(Œ∏) [Vi? (a + q) ‚àí pq ‚àí œÜ]
                                             j‚ààI
               Vi (a, œÉ, Œ∏) =                                                                  .   (2)
                                                          r + Œ¥ + Œ±(Œ∏)

The first term in the numerator is the investor‚Äôs utility flow; the second term is the investor‚Äôs
expected continuation payoff, conditional on switching types, which occurs with Poisson intensity
Œ¥; and the third term is the continuation payoff when his order is executed, which occurs with
Poisson intensity Œ±(Œ∏). The denominator is the effective discount rate. This investor‚Äôs maximum
attainable utility, which we denote by Vi? (a), is defined as

                                     Vi? (a) = sup Vi [a, œÉ, Œò(œÉ)] .
                                                   œÉ‚ààŒ£?


Market tightness.    We adopt the convention that Œò(0) = 0. For œÉ 6= 0, we assume that:

              Œò(œÉ) = inf {Œ∏ ‚â• 0 : Vi (a, œÉ, Œ∏) > Vi? (a) for some (i, a) ‚àà N ? } ,                 (3)

                                                        10
and Œò(œÉ) = ‚àû if this set is empty. This definition captures the idea that, if a dealer posts a
contract œÉ, then the investors who value it most will direct their order flow to this contract until
they are indifferent between this contract and their best alternative. Put differently, if the market
tightness for contract œÉ were greater than Œò(œÉ), then there would be a positive measure of investors
who would benefit strictly from this contract. Orders sent by these investors would further reduce
tightness until it is equal to Œò(œÉ).15

Market clearing and the distribution of investors‚Äô states. Let ni (da) denote the steady-state
measure of investors over the set of types, N . The measure ni (da) must satisfy the following two
identities:
                                       XZ
                                               ni (da) = 1                                      (4)
                                               i‚ààI       A
                                              XZ
                                                         ani (da) = A.                                             (5)
                                              i‚ààI    A


Equation (4) imposes that the measures of investors add up to one. Equation (5) ensures that
investors hold the entire asset supply and that the inter-dealer market clears.
    The order submission strategy of an investor of type (i, a) can be represented by a probability
measure, Œ∂(dœÉ | i, a), over some support

                                         Œ£?i (a) ‚äÜ arg max? Vi [a, œÉ, Œò(œÉ)] .
                                                             œÉ‚ààŒ£


Then, in a steady-state equilibrium, ni (da) must satisfy
                                X                    Z Z
                            Œ¥         nj (da)œÄji +                       Œ∂(dœÉ | i, a0 )Œ±[Œò(œÉ)]I{a0 +q=a}
                                j‚ààI                      A   Œ£?i (a0 )
                                                     Z
                       = Œ¥ni (da) + ni (da)                    Œ∂(dœÉ | i, a)Œ±[Œò(œÉ)].                                (6)
                                                     Œ£?i (a)


The left side of (6) represents the inflow of investors, while the right side represents the outflow.
On both sides the first term represents the flow due to type switching, and the second term is the
flow due to trade.

Definition 1. A steady-state competitive search equilibrium is a list composed of an inter-dealer
  15
    Note that we are taking the infimum over all Œ∏ that create a strict utility improvement. This is important because
otherwise Œò(œÉ) = 0 for all œÉ: those investors who have no gains from trade, Vi? (a) = Vi (a, 0, 0), would flow into the
submarket in the expectation that they won‚Äôt be able to trade anyway, and thus Œ∏ = 0.


                                                               11
market price, p, a set of open submarkets, Œ£? , a market tightness function, Œò(œÉ), a collection of
value functions, Vi? (a), an order submission strategy Œ∂(dœÉ | i, a) with support Œ£?i (a), and a measure
on the set of investors‚Äô types, ni (da), with support N ? ‚äÜ A √ó I, satisfying (1)-(6).


3.2    Characterization
As is typically true in competitive search models, there is a dual formulation of the problem accord-
ing to which an investor‚Äôs expected utility is maximized with respect to trade size, q, intermediation
fee, œÜ, and market tightness, Œ∏, subject to dealers‚Äô zero-profit condition, [Œ±(Œ∏)/Œ∏]œÜ = Œ≥. This dual
problem can be represented conveniently by the following flow Bellman equation:
                                      X
        rVi? (a, p) = ui (a) + Œ¥            œÄij Vj? (a, p) ‚àí Vi? (a, p)
                                                                      
                                      j‚ààI
                                                                                      
                                                     ?                        ?
                                       + max Œ±(Œ∏) [Vi (a + q, p) ‚àí pq ‚àí œÜ ‚àí Vi (a, p)]
                                            q‚â•‚àía,Œ∏,œÜ

                                      Œ±(Œ∏)
                         subject to        œÜ = Œ≥.
                                       Œ∏

If a utility-maximizing contract, (q, œÜ, Œ∏), was not offered in a candidate equilibrium, a dealer
would have a profitable deviation by offering the same contract with a slightly higher fee, thereby
attracting the type of investors for whom this contract is optimal. Substituting œÜ = Œ∏Œ≥/Œ±(Œ∏) from
the dealer zero-profit condition into the Bellman equation, we obtain the following characterization
for investors‚Äô value functions.

Proposition 1. In any equilibrium, for all (i, a) ‚àà N ? , investors‚Äô value functions solve

                                                             œÄij Vj? (a, p) + Œ±(Œ∏) [Vi? (a + q, p) ‚àí pq] ‚àí Œ≥Œ∏
                                                 P
                                    ui (a) + Œ¥         j‚ààI
   Vi? (a, p)   =       max                                                                                   . (7)
                    (q‚â•‚àía,Œ∏)‚ààQ√óR+                                      r + Œ¥ + Œ±(Œ∏)

Moreover, there exists a unique collection {Vi? (a, p)}i‚ààI , defined over S = I √ó A √ó (0, ‚àû), that
satisfy (7). Each Vi? (a, p) is continuous in (a, p) and strictly increasing in a.

    The proposition offers an alternative representation of the Bellman equations, which is useful
for at least two reasons. First, it allows us to solve for investors‚Äô values at each point in the support
of the distribution of investors‚Äô types, N ? , without having to characterize Œ£? , the set of contracts
offered in equilibrium. Second, it shows that our model is observationally equivalent to one in
which investors directly choose their order-execution intensity, ¬µ ‚â° Œ±(Œ∏), but have to incur a
convex cost Œ≥Œ±‚àí1 (¬µ). Put differently, the outcome of competition and free entry is that dealers



                                                         12
act ‚Äúas if‚Äù they knew investors‚Äô private utility type and were making an optimal search intensity
decision on their behalf.16
    Next, we proceed to establish the existence of an equilibrium. First, note from the right side
of (7) that investors‚Äô post-trade asset holdings belong to arg maxa0 {Vi (a0 , p) ‚àí pa0 }, so they are
independent of a, the investor‚Äôs current asset holdings.17 For simplicity, let us assume for now that
this program has a unique maximizer, which we denote by ai .18 We look for a stationary equilib-
rium in which the support of the distribution of types is I √ó {a1 , . . . , aI }. This is intuitive since,
at his first opportunity to trade, an investor chooses asset holdings in the support {a1 , . . . , aI }, and
then continues to keep his holdings in this support forever after. Let Œ∏i (aj ) be the maximizer of
the Bellman equation, (7), when the investor‚Äôs type is (i, aj ). The inflow-outflow equations for the
steady-state distribution, ni (aj ), are
                               X
                   0 = Œ¥             nk (aj )œÄki ‚àí Œ¥ni (aj ) ‚àí Œ±[Œ∏i (aj )]ni (aj ), if i 6= j;                          (8)
                               k‚ààI
                               X                                 X
                   0 = Œ¥             nk (ai )œÄki ‚àí Œ¥ni (aj ) +         Œ±[Œ∏i (ak )]ni (ak ), if i = j;                   (9)
                               k‚ààI                               k‚ààI
                               X
                   1 =                    ni (aj ).                                                                   (10)
                             (i,j)‚àà‚ààI 2


Since finite-state Markov chains have at least one ergodic distribution, it follows that this system of
equations has at least one solution (see Lemma 4 in the Appendix). Given any solution, we define
                                  P
the aggregate demand as D(p) = i,j ni (aj )aj , and we look for a market-clearing price, i.e. some
p ‚àà R+ such that A ‚àà D(p).

Proposition 2. A stationary equilibrium exists.

    The first part of the proof uses the Intermediate Value Theorem to establish that there exists
a market-clearing price. Having found a candidate market-clearing price, the second part of the
proof constructs the remaining equilibrium objects in such a way that all conditions of Definition
1 are satisfied. The construction goes as follows. We first obtain the equilibrium price by solving
A ‚àà D(p). We then obtain investors‚Äô optimal asset holdings, {ai }i‚ààI , the market tightness in each
  16
      Note, however, that the present competitive search model is not equivalent to a random search model with endoge-
nous search intensities and bargaining. Indeed, under ex post bargaining, the choice of search intensities generates
externalities that are not internalized by the pricing mechanism. In contrast, the outcome of a model with endogenous
search intensities but competitive price posting would typically be constrained efficient. For a model with endogenous
search intensities under ex post bargaining and competitive price posting, see Lagos and Rocheteau (2007).
   17
      As in LR this property of the equilibrium follows from the quasi-linear specification for investors‚Äô utility function.
If zero is an optimal market tightness in (7), then optimal asset holdings can take any value on the real line, so they
don‚Äôt depend on a either.
   18
      Our proof in the appendix deals with the general case in which there may be multiple maximizers.


                                                            13
submarket, {Œ∏i (aj )}(i,j)‚ààI 2 , and the distribution of types, {ni (aj )}. From these conditions, along
with the free-entry condition, (1), we obtain trade sizes and intermediation fees:

                                             qi (aj ) = ai ‚àí aj                                                  (11)
                                                           Œ∏i (aj )
                                             œÜi (aj ) = Œ≥             .                                          (12)
                                                          Œ±[Œ∏i (aj )]

The order submission strategy of an investor in state (i, aj ) is to direct his order flow toward the
submarket œÉi (aj ).19 The set Œ£? is then composed of all œÉi (aj ). The value functions are defined as
the solutions to the Bellman equations:

                                    Vi? (a) = max 2 Vi [a, œÉk (a` ), Œ∏k (a` )] .
                                                k,` ‚àà I


By construction, for (i, aj ) ‚àà N ? , Vi? (aj ) coincides with the solution of our auxiliary Bellman
equation (7) evaluated at (i, aj ). Finally, we let the market tightness associated with any contract
œÉ 6= 0 be defined as in equation (3).
    To conclude this section we recapitulate some key properties of the competitive search equilib-
rium of an OTC market. First, from the free-entry condition of dealers, in any active submarket

                                                    Œ± (Œ∏)
                                                          œÜ = Œ≥.
                                                      Œ∏

From the dual formulation of a competitive search equilibrium, this condition implies that investors
face a trade-off between the cost at which they can readjust their asset holdings, œÜ, and the order
execution time, 1/Œ±(Œ∏).20 As suggested by Boehmer (2005) and others, this trade-off is relevant in
practice across trading venues. Second, from the first-order condition of the dual problem and the
free-entry condition of dealers,

             Œ∏i (aj )Œ±0 [Œ∏i (aj )] ?                                           Œ≥Œ∏i (aj )
                                  [Vi (ai , p) ‚àí p(ai ‚àí aj ) ‚àí Vi? (aj , p)] =             = œÜi (aj ).
                 Œ±[Œ∏i (aj )]                                                   Œ±[Œ∏i (aj )]

The dealer‚Äôs fee is a fraction Œ∏Œ±0 (Œ∏) /Œ± (Œ∏) of the match surplus, where this fraction is equal to the
  19
      Note that the equilibrium price equates aggregate demand and supply, but does not explicitly equate ‚Äúbuy‚Äù and
‚Äúsell‚Äù order flows in the inter-dealer market. As we show in Appendix A.3, this latter condition is actually implied by
the steady-state conditions (8) and (9).
   20
      If Œ± was a function of the size of the trade, q, then the model would predict a more general trade-off between
œÜ, q, and Œ∏. Such an extension of the matching technology in asset markets is left for future research. Pagnotta and
Philippon (2011) also consider a model based on LR where investors face a trade-off between entry fees and speed. In
their model, market-makers set up platforms where investors can access a competitive asset market at a given Poisson
rate in exchange for a fee. In contrast to our model, individual trades are not intermediated and the extent of market
segmentation is restricted.


                                                          14
elasticity of the matching function. This corresponds to the Hosios (1990) condition for efficiency
in markets with search frictions. Relative to models with ex post bargaining, such as those of DGP
and LR, where dealers‚Äô bargaining power is exogenous, here the dealers‚Äô share of the match sur-
plus is endogenous and equal to the contribution of dealers to the matching process. This means
that the externalities associated with dealers‚Äô entry decisions are internalized through the pricing
mechanism. An additional consequence of the competitive search formulation is that investors are
not subject to a holdup problem when choosing asset holdings; in particular, for a given Œ∏, com-
petition between dealers makes it ‚Äúas if‚Äù investors have an un-intermediated access to the market.
So, in terms of policy implications, our model suggests that more transparent OTC markets, in the
sense of contracts being publicly announced and search being directed, have better welfare proper-
ties than opaque markets with purely random search and ex-post bargaining. We come back to this
point in greater detail in the next section. Third, the number of active submarkets will reflect the
endogenous heterogeneity across investors since, according to the dual formulation, each investor
opens a submarket that is optimal given his state (i, aj ) with j 6= i. Hence, our model offers a
rationalization for a high degree of market segmentation.21


4        Liquidity and prices in two special cases
In the remainder of the paper we focus on two special cases: (i) The case where asset holdings are
restricted to A = {0, 1} and the set of investors‚Äô private valuations is I = {`, h}, but the matching
function is general; and (ii) the case where asset holdings are unrestricted in A = R+ and the set
of private valuations is I ‚äÇ N, but the matching function is Leontief. The first case will allow us to
focus on order flows, speeds of execution, and trading costs across markets, taking as given asset
positions. The second case will generate an endogenous distribution of asset holdings, allowing us
to focus on relationship between trade size and trading cost.


4.1      Order flows, speeds of execution, and trading costs
In this section we consider a setting with restricted asset holdings, A = {0, 1}, and two utility
types, I = {`, h}, with respective utility flows for the asset, u` < uh .22 Without loss of generality,
we assume that œÄ`,h = œÄh and œÄh,` = œÄ` . First, we will provide a characterization of equilibrium
    21
     Pagnotta and Philippon (2011) argue that ‚Äúa major feature of the new trading landscape is fragmentation,‚Äù where
market fragmentation corresponds to the phenomenon according to which securities are now traded in multiple markets
with different characteristics in terms of quality of execution and trading costs.
  22
     In order to extend our existence proof to the case with restricted asset holdings, we make two additional as-
sumptions on the finite grid A ‚äÇ R+ . First, to ensure that investors can hold all the asset supply, we assume that
max A > A. Second, to keep prices bounded we assume that u1 (min A) is bounded away from ‚àí‚àû.

                                                        15
objects and show existence and uniqueness. Then, we derive analytical comparative statics for the
limit economy with small search frictions. Finally, for large frictions, we offer comparative statics
by way of a numerical example.

Bellman equations. Let ‚àÜVi ‚â° Vi (1) ‚àí Vi (0) denote the reservation value of an investor of type
i ‚àà {`, h}, i.e., the expected utility of owning the asset minus the expected utility of being without
the asset. From Proposition 1, ‚àÜVh solves the following flow Bellman equation:

               r‚àÜVh = uh + Œ¥œÄ` (‚àÜV` ‚àí ‚àÜVh ) + max {Œ±(Œ∏) (p ‚àí ‚àÜVh ) ‚àí Œ≥Œ∏}
                                                         Œ∏‚â•0
                                                    ‚àí max {Œ±(Œ∏) (‚àÜVh ‚àí p) ‚àí Œ≥Œ∏} .                  (13)
                                                         Œ∏‚â•0


The right side of (13) decomposes the flow reservation value into four terms. The first term, uh ,
is the flow value of owning the asset. The second term captures the fact that, with intensity Œ¥œÄ` ,
a high-valuation investor switches to a low type, in which case his reservation value drops from
‚àÜVh to ‚àÜV` . The third and fourth terms are, respectively, the flow values of searching to sell and
buy. The flow value of searching to sell enters the Bellman equation with a positive sign because
this option is available to the investor only if he already owns the asset. Therefore, it raises the net
utility of owning an asset. By contrast, the flow value of searching to buy enters with a negative
sign because this option is only available to investors who do not own the asset.
    Similarly, the Bellman equation for ‚àÜV` is

               r‚àÜV` = u` + Œ¥œÄh (‚àÜVh ‚àí ‚àÜV` ) + max {Œ±(Œ∏) (p ‚àí ‚àÜV` ) ‚àí Œ≥Œ∏}
                                                         Œ∏‚â•0
                                                    ‚àí max {Œ±(Œ∏) (‚àÜV` ‚àí p) ‚àí Œ≥Œ∏} .                  (14)
                                                         Œ∏‚â•0


Lemma 1. In any equilibrium ‚àÜVh > ‚àÜV` and p ‚àà (‚àÜV` , ‚àÜVh ).

    The first result of Lemma 1 states that high-valuation investors have strictly higher reserva-
tion values than low-valuation investors, which follows from the assumption that their utility flow
from holding the asset is strictly larger. The second result states that the equilibrium price must
lie between the reservation value of high and low types, since otherwise the market would not
clear. A consequence of these two results is that, in equilibrium, low-valuation investors have
strict incentives to sell and high-valuation investors have strict incentives to buy.
    The properties reported in Lemma 1 also hold in DGP, except for one key difference. In DGP,
the inter-dealer market price is, generically, at a corner, p ‚àà {‚àÜV` , ‚àÜVh }. This result arises because
buyers and sellers contact dealers at the same rate, so that p must adjust to make investors on the
long side of the market indifferent between trading and not. If œÄh > A, then buyers are on the

                                                  16
long side and p = ‚àÜVh . Conversely, if œÄh < A, then sellers are on the long side and p = ‚àÜV` .
Such prices, {‚àÜV` , ‚àÜVh }, cannot be the basis of an equilibrium under competition for order flows:
indeed, if investors on one side of the market were indifferent between trading or not at the inter-
dealer price, i.e., p = ‚àÜVi for some i ‚àà {`, h}, then these investors would not be willing to pay
any intermediation fee and dealers would have no incentives to make a market for such investors.
Therefore, under competitive search the price has to lie strictly between ‚àÜV` and ‚àÜVh , so that
dealers can break even with both types and the market can clear.23
     With this result in mind, we define Sh ‚â° ‚àÜVh ‚àí p as the total surplus generated by a purchase,
i.e., the difference between the reservation value of a buyer, ‚àÜVh , and the reservation value of
a dealer, p. The intermediation fee is set so as to share the total surplus between the buyer, who
receives Sh ‚àíœÜh , and the dealer, who receives œÜh . Symmetrically, let S` ‚â° p‚àí‚àÜV` denote the total
surplus generated by a sale. The purchase and sale surpluses solve the following pair of Bellman
equations:

                        rSh = uh ‚àí rp ‚àí Œ¥œÄ` (Sh + S` ) ‚àí max {Œ±(Œ∏)Sh ‚àí Œ≥Œ∏}                                           (15)
                                                                          Œ∏
                        rS` = rp ‚àí u` ‚àí Œ¥œÄh (Sh + S` ) ‚àí max {Œ±(Œ∏)S` ‚àí Œ≥Œ∏} .                                         (16)
                                                                          Œ∏


To solve this system of equations for a given p, we define:

                                   Œì(S) = (r + Œ¥)S + max {Œ±(Œ∏)S ‚àí Œ≥Œ∏} .
                                                                Œ∏


The function Œì(S) is twice continuously differentiable, strictly increasing, strictly convex, and
satisfies Œì(0) = 0 and Œì(‚àû) = 0. Using this function, the system (15)-(16) can be written

                           Œì(Sh ) + Œì(S` ) = uh ‚àí u`                                                                 (17)
                                      Œì(Sh ) = uh ‚àí rp + (1 ‚àí Œ¥œÄ` )Sh ‚àí Œ¥œÄ` S` .                                     (18)

   Equations (17) and (18) implicitly define two strictly decreasing, strictly concave, and contin-
uously differentiable functions Sh = F (S` ) and Sh = G(S` ), respectively. The slopes of these
functions are
                                 r + Œ¥ + Œ±(Œ∏` )                      Œ¥œÄ`
                   F 0 (S` ) = ‚àí                < G0 (S` ) = ‚àí                  ,
                                 r + Œ¥ + Œ±(Œ∏h )                r + Œ¥œÄ` + Œ±(Œ∏h )
  23
     A related result occurs in the model of Gavazza (2011). There is a continuous distribution of private valuations
of the asset across investors, and participation in the market is costly. As a result, there are two thresholds for private
valuations: one above which agents participate as buyers and one below which they participate as sellers. Participation
requires that agents get a positive surplus from a trade. So if trades were intermediated by dealers, as in DGP, the
inter-dealer market price would satisfy the same condition as in our model.



                                                           17
                               Sh



                                                              Sh = Sl
                     -1
                   G (uh - ul )

                                    F (Sl )


                                  G (S l ; p)



                                                                              Sl
                                                          G-1 (uh - ul )



                          Figure 1: The determination of S` and Sh given p.

where Œ∏` and Œ∏h are the maximizers of the programs defining Œì(S` ) and Œì(Sh ), i.e.,

                                      Œ±0 (Œ∏i )Si = Œ≥ for i ‚àà {`, h}.                               (19)

The ranking of these derivatives implies that if a solution to F (S` ) = G(S` ) exists, then it must be
unique. It also implies that F (S` ) crosses G(S` ) from above at any intersection, as illustrated in
Figure 1. Using these results, we now address the issue of existence.

Lemma 2. There exist p` < ph such that the system (15)-(16) has a strictly positive solution,
[S` (p), Sh (p)], if and only if p ‚àà (p` , ph ). This solution is unique. Moreover, S` (p) is strictly
increasing in p, Sh (p) is strictly decreasing in p, and S` (p` ) = Sh (ph ) = 0.

     According to Lemma 2, for a solution to exist the price must be neither too high nor too low,
so that both buy orders and sell orders generate strictly positive surpluses. Moreover, the surplus
from selling the asset is increasing in the price p ‚àà (p` , ph ) while the surplus from buying the asset
is decreasing in p. Recall, from (19), that there is less entry of dealers on a given side of the market
if the corresponding trading surplus is lower. Thus, Œ∏h decreases with p while Œ∏` increases with p.




                                                   18
Market clearing. We now solve for the distribution of investors across types and ensure that
the asset market clears. First, since p ‚àà (‚àÜV` , ‚àÜVh ) from Lemma 1, the equilibrium buy- and
sell-order flows must be equal:
                                    Œ±(Œ∏h )nh (0) = Œ±(Œ∏` )n` (1).                         (20)

The left side is the buy-order flow originating from (h, 0)-type investors‚Äîinvestors with a high
valuation for the asset but who do not own it‚Äîand the right side is the sell-order flow originating
from (`, 1)-type investors‚Äîinvestors who own the asset but have a low valuation for it. We derive
the measure of buyers, nh (0), from the following steady-state condition:

                              Œ¥œÄh n` (0) = Œ¥œÄ` nh (0) + Œ±(Œ∏h )nh (0).                             (21)

The left side is the inflow coming from (`, 0)-investors who change type. The first and second terms
on the right side are the outflows of type (h, 0)-investors who switch to low type with intensity Œ¥œÄ`
or who trade with intensity Œ±(Œ∏h ), respectively. Similarly, the steady-state equation for the measure
of (`, 0)-type investors is
                                 Œ¥œÄ` nh (0) + Œ±(Œ∏` )n` (1) = Œ¥œÄh n` (0),

which, from (20), can be rewritten

                              Œ¥œÄ` nh (0) + Œ±(Œ∏h )nh (0) = Œ¥œÄh n` (0).                             (22)

Equations (21)-(22) can be interpreted as defining the ergodic distribution of a two-state Markov
chain, for which (h, 0)-type investors transition to type (`, 0) at Poisson rate Œ¥œÄ` + Œ±(Œ∏h ), and
(`, 0)-type investors transition to type (h, 0) at Poisson rate Œ¥œÄh . Together with the market-clearing
condition, nh (0) + n` (0) = 1 ‚àí A, these steady-state conditions imply that

                                                         Œ¥œÄh
                                  nh (0) = (1 ‚àí A)               .                                (23)
                                                      Œ¥ + Œ±(Œ∏h )

By symmetry,

                                                      Œ¥œÄ`
                                      n` (1) = A              .                                   (24)
                                                   Œ¥ + Œ±(Œ∏` )

Thus, the equality of order flows, (20), can be rewritten as

                                         Œ¥œÄh Œ±(Œ∏h )    Œ¥œÄ` Œ±(Œ∏` )
                               (1 ‚àí A)              =A            .                               (25)
                                         Œ¥ + Œ±(Œ∏h )    Œ¥ + Œ±(Œ∏` )



                                                   19
Recall from Lemma 2 that Œ∏h decreases with p while Œ∏` increases with p. Therefore, one easily
sees that the left side of (25) is strictly decreasing and equal to zero at p = ph , while the right
side is strictly increasing and equal to zero at p = p` . Consequently, there exists a unique price
p ‚àà (p` , ph ) equating buy- and sell-order flows. Combining these observations with Lemma 1 we
obtain the following result.

Proposition 3. There exists a unique competitive search equilibrium.

    The remaining equilibrium objects can be found using the same steps as in Section 3.2. In
particular, the trading fees are

                                                 Œ∏h Œ±0 (Œ∏h )
                                         œÜh =                Sh
                                                  Œ±(Œ∏h )
                                                 Œ∏` Œ±0 (Œ∏` )
                                          œÜ`   =             S` .
                                                  Œ±(Œ∏` )

One recognizes here the Hosios (1990) condition for efficiency in economies with search frictions.
The trading fee that a dealer charges for a buy-order, œÜh , is equal to the dealer‚Äôs contribution to the
sale surplus, as defined by the elasticity of the matching function. This elasticity determines the
share of the trade surplus that a dealer appropriates, and hence it measures the implicit bargaining
power of dealers when they trade. Note that, unless the matching function has constant elasticity
(such as in the Cobb-Douglas matching function) or unless Œ∏` = Œ∏h , the implicit bargaining power
of dealers will differ depending on whether they trade with buyers or sellers. This asymmetry arises
because intermediation on both sides of the market implies that there are two separate matching
processes: one between dealers and buyers, and one between dealers and sellers. As a result the
Hosios condition must apply separately to each one of them.

Comparative statics near the Walrasian limit. In order to derive analytical comparative statics,
it is useful to study the limiting equilibrium as search frictions vanish. To do this, we first assume
that investors contact dealers at intensity ŒªŒ±(Œ∏), and then we drive the search efficiency parameter,
Œª, to +‚àû. We focus on the case œÄh > A, so that high-valuation investors are on the long side
of the market (a similar analysis applies to œÄh < A). In this case, there are more high-valuation
agents than assets. Hence, in the frictionless benchmark, the price adjusts so that high-valuation
investors are indifferent between buying or not, and the price and allocations are

                                uh
                         p? =      ,   n?h (0) = œÄh ‚àí A,      and   n?` (1) = 0.
                                r



                                                   20
The intermediation fees are implicitly equal to zero. Our main proposition characterizes equilib-
rium objects near this Walrasian limit.

Proposition 4. Let the matching technology be ŒªŒ±(Œ∏) and assume that œÄh > A. As Œª ‚Üí ‚àû, the
price, intermediation fees, and the measures of buyers and sellers admit the following first-order
approximation:

                                                  Œ¥œÄ` s?`
                                                              
                                            ?                  1
                                   p =     p ‚àí            +o                                       (26)
                                                    Œªr         Œª
                                              
                                                1
                                  œÜh =     o                                                       (27)
                                                Œª
                                             ? 0 ?
                                           Œ∏` Œ± (Œ∏` ) s?`
                                                               
                                                               1
                                  œÜ` =            ?
                                                          +o                                       (28)
                                             Œ±(Œ∏` ) Œª          Œª
                                                                  
                                             ?         AŒ¥œÄ`       1
                               nh (0) =    nh (0) +        ?
                                                              +o                                   (29)
                                                      ŒªŒ±(Œ∏` )     Œª
                                                                  
                                                       AŒ¥œÄ`       1
                               n` (1) =    n?` (1) +       ?
                                                              +o     ,                             (30)
                                                     ŒªŒ±(Œ∏` )      Œª

where o(1/Œª) is such that limŒª‚Üí‚àû Œªo(1/Œª) = 0, while s?` = limŒª‚Üí‚àû ŒªS` and Œ∏`? = limŒª‚Üí‚àû Œ∏`
jointly solve maxŒ∏ {Œ±(Œ∏)s?` ‚àí Œ≥Œ∏} = uh ‚àíu` . The market tightness for buyers satisfies limŒª‚Üí‚àû Œ∏h =
0, and the purchase surplus satisfies limŒª‚Üí‚àû ŒªSh = 0.

      As Œª ‚Üí ‚àû, the different components of the competitive search equilibrium converge toward
their Walrasian counterparts. Sellers, who are on the short side of the market, trade almost in-
stantly: market tightness converges to some strictly positive limit, Œ∏`? , so that the average execution
time, 1/ŒªŒ±(Œ∏` ), converges to zero. Buyers, who are on the long side, trade with a non-zero asymp-
totic execution time. This sharp asymmetry in execution times is necessary to keep the buy- and
sell-order flows balanced in the limit.
      Proposition 4 allows for analytical comparative statics of various equilibrium objects of inter-
est. For example, an increase in the gains from trade, uh ‚àí u` , causes the asymptotic sale surplus,
s?` , to increase. As a result, the asymptotic price discount, lim Œª(p? ‚àí p)/p? , increases because
buyers expect that they will lose more utility upon switching to a low type. The increase in the
sale surplus represents a profit opportunity for dealers. By free entry, the supply of intermediation
services, Œ∏`? , increases, which implies that investors can trade faster. As a result, the asymptotic
measures of buyers and sellers, nh (0) and n` (1), decrease. By the same token, when Œ∏`? increases,
intermediaries receive fewer trading opportunities on average, so the zero-profit condition requires
that intermediation fees, œÜ?` = lim ŒªœÜ` , go up.
      An increase in the flow entry cost of dealers, Œ≥, makes dealers more reluctant to post contracts

                                                  21
and hence the asymptotic tightness, Œ∏`? , decreases. As a result, the measures of buyers and sellers
increase, the asymptotic sale surplus s?` increases, and so does the price discount. If the elasticity
of the matching function is constant‚Äîe.g., the Cobb-Douglas case‚Äîintermediation fees increase.
    In response to an increase in the intensity of switching to the low valuation, Œ¥œÄ` , buyers an-
ticipate that they may switch type soon after purchasing the asset. This lowers their willingness
to pay for the asset, so the inter-dealer price decreases. Moreover, when investors switch to the
low valuation more quickly after purchasing the asset, the asymptotic measure of sellers, n` (1),
increases.24
    Next, we consider the relationship between the price discount and the elasticity of the matching
function. For this we focus on the special case of a Cobb-Douglas matching function.

Corollary 1. Suppose Œ±(Œ∏) = Œ∏Œ∑ . Then,
                                                                  Œ∑          1‚àíŒ∑
                                   Œ∑ ‚àÜu                           Œ≥     uh ‚àí u`
                          Œ∏`?   =                and     s?`   =                     .
                                  1‚àíŒ∑ Œ≥                           Œ∑      1‚àíŒ∑

Thus, the asymptotic market tightness for sellers, Œ∏`? , is an increasing function of Œ∑ and the asymp-
totic seller‚Äôs surplus, s?` , is a hump-shaped function of Œ∑. As a consequence, the seller‚Äôs asymptotic
trading fee and the asymptotic price discount are both hump-shaped functions of the matching
elasticity, Œ∑.

   To gain intuition for the effect of the elasticity, Œ∑, note that the equation defining s?` can be
written as
                             u` + max {‚àíŒ≥Œ∏ + Œ±(Œ∏)s} = uh = rp? .
                                            Œ∏

This equation is an asymptotic indifference condition. It states that the asymptotic sale surplus, s?` ,
must adjust so that a seller with a trading opportunity is indifferent between continuing search (on
the left side) and selling his asset (on the right side).
     One sees that, when Œ∑ ‚Üí 0, then Œ±(Œ∏) = Œ∏Œ∑ converges to 1 if Œ∏ > 0 and to zero if Œ∏ = 0. That
is, an arbitrarily small market tightness, Œ∏, is sufficient to attain the maximum search intensity of
1. It is thus intuitive that, in equilibrium, market tightness is approximately zero and dealers incur
almost no contract posting cost, Œ±(Œ∏) is approximately one, and the sale surplus is approximately
equal to uh ‚àí u` .
     When Œ∑ ‚Üí 1, then the search technology becomes approximately linear. The seller‚Äôs surplus
must then converge to the search cost Œ≥: if it were larger, the utility of continuing search would be
  24
    One may have the impression that Proposition 4 implies the counterintuitive result that nh (0) increases with œÄ` .
This, in fact, is not the case because œÄ` also enters the leading term in the expansion: n?h (0) = œÄh ‚àí A = 1 ‚àí œÄ` ‚àí A.
This leading term dictates that an increase in œÄ` decreases nh (0), as intuition suggests.


                                                         22
unbounded, and if it were smaller it would be zero. Note that, to keep the utility of continuing to
search strictly positive, the market tightness must go to infinity.
    We can now discuss comparative statics with respect to Œ∑. By the envelope condition, the
derivative of the utility of continuing to search with respect to Œ∑ is equal to s?` log(Œ∏`? ) (Œ∏`? )Œ∑ , which
is negative for small Œ∏`? and positive for large Œ∏`? . Graphically, an increase in elasticity ‚Äúrotates‚Äù the
search technology around the point (1, 1). It makes it less efficient for small Œ∏ and more efficient
for large Œ∏.
    Now assume that Œ∑ is small. Then in equilibrium Œ∏ is small, implying that an increase in Œ∑
will reduce search efficiency and, by the indifference condition, increase the sale surplus, s?` . Vice
versa, when Œ∑ is large, then in equilibrium Œ∏ is very large, implying that an increase in elasticity, Œ∑,
will increase search efficiency and hence reduce the sale surplus, s?` .

Welfare. Finally, we show that the unique competitive search equilibrium of our economy is
also constrained efficient, i.e., it maximizes society‚Äôs welfare given the trading frictions arising
from the matching technology. We define social welfare as the discounted sum of the utility flows
of all investors net of dealers‚Äô entry costs,
                    Z     +‚àû
              W=               e‚àírt {nh,t (1)uh + n`,t (1)u` ‚àí Œ∏h,t nh,t (0)Œ≥ ‚àí Œ∏`,t n`,t (1)Œ≥} dt,     (31)
                      0


where we are using the fact that a social planner would not find it optimal to assign (costly) dealers
to trade with h-valuation investors who hold assets (since an asset has no better use than in the
hands of a h-type investor) or `-valuation investors who do not hold any asset (since an asset has
no worse use than in the hands of an `-type investor). Intermediation fees do not enter W since
they are pure transfers from investors to dealers that cancel out. The planner maximizes W with
respect to time path for the state variables, ni,t (a), and controls, Œ∏i,t , subject to the laws of motion
for these state variables and to the balanced order flow condition,

                                        Œ±(Œ∏h,t )nh,t (0) = Œ±(Œ∏`,t )n`,t (1).                            (32)

If (32) were not satisfied then the planner could reduce the measure of dealers on the long side
                                                                           P
of the market, thereby saving some entry costs. We omit the condition (i,a) ni,t (a) = 1 as it is
automatically satisfied by the laws of motion for ni,t (a) given (32) and the initial condition.

Proposition 5. The competitive search equilibrium is constrained efficient.

    We establish this proposition in the appendix, where we set up the Hamiltonian corresponding
to this optimal control problem and check that its first-order conditions coincide with the conditions

                                                        23
for a competitive search equilibrium. In particular, the co-state variable associated with ni,t (a),
which represents the marginal social value of an investor of type i with holding a, coincides with
Vi,t (a), the private value of such an investor. The Lagrange multiplier associated with the balanced
order-flow condition coincides with the equilibrium price, p(t).
     The proposition generalizes the welfare theorem for competitive search economies first derived
by Moen (1997) to a two-sided OTC market augmented with a competitive interdealer market. In
order to appreciate the significance of the previous proposition, consider the same economy with
random search and ex-post bargaining, as in DGP or LR. Let ŒΩ ‚àà [0, 1] denote the dealer‚Äôs bargain-
ing power in the Nash bargaining to determine intermediation fees. Comparing the equilibrium
conditions with the first-order conditions of the planner‚Äôs problem (all shown in the appendix) we
obtain:

Corollary 2. The equilibrium of an OTC market with random search and ex-post bargaining is
constraint efficient if and only if

                                     Œ±0 (Œ∏h )Œ∏h   Œ±0 (Œ∏` )Œ∏`
                                                =            =ŒΩ                                 (33)
                                      Œ±(Œ∏h )       Œ±(Œ∏` )

    Constrained efficiency in the opaque economy requires that dealers‚Äô bargaining power is equal
to their contribution to the matching process as measured by the elasticity of the matching function.
This is the generalization of the Hosios (1990) condition for efficiency in a two-sided random
search market. Weill (2007) derived a related result in an economy without free entry but in which
dealers can hold inventories. The Corollary thus establishes that, unless the matching function has
a constant elasticity (as in the Cobb-Douglas matching function) or the two sides of the market have
the same endogenous tightnesses, the Hosios condition (33) will not hold for a single bargaining
power of dealers. So generically, the outcome of the opaque market will be socially inefficient.
    Finally, consider an economy that is segmented into two distinct markets: a transparent market
with a measure œá of investors who can observe contracts posted by dealers and direct their search
accordingly, and an opaque market composed of a measure 1 ‚àí œá of investors who search for
dealers at random (as in Lester (2011)). In contrast to investors who are assigned to a particular
market, dealers are free to enter the transparent market or the opaque market. We call œá the degree
of transparency of the overall economy. From the results above we have the following corollary.

Corollary 3. The optimal degree of transparency is œá = 1.

    Our economy highlights an important welfare-enhancing role of transparency: since investors
essentially choose their trading speed, those investors with the largest gains from trade obtain
fast execution, and those who have less to gain from trade ultimately execute their orders more

                                                 24
slowly. This result provides support for recent regulatory changes (such as the TRACE system)
that promote transparency in OTC markets.


4.2     Asset holdings, market fragmentation, and trading costs
In the previous section, we restricted investors‚Äô asset holdings in order to focus on their choice of
trading speeds and the corresponding trading costs. In this section we adopt a special matching
technology, which implies that market tightness and average execution speeds are equal across ac-
tive submarkets, and we focus on the equilibrium distribution of asset holdings and the relationship
between trade size and trading costs.
    More specifically, we adopt the same environment as the one described in Section 2 but we
suppose that Œ±(Œ∏) = ¬µ min{1, Œ∏}, with ¬µ > 0, so that there is a strict complementarity between
the number of dealers and the number of orders processed. One interpretation of this technological
assumption is that, if Œ∏ > 1, each order must be matched to an individual dealer, and the average
time for a dealer to process an order is 1/¬µ. If Œ∏ < 1, there are not enough dealers to handle all of
the orders. In this case, orders are randomly assigned to dealers, so that each order is matched to
a dealer with probability Œ∏.25 For simplicity, we also assume that œÄi,j ‚â° œÄj for all i, j ‚àà I 2 , with
P
   j‚ààI œÄj = 1, so that preference shocks are i.i.d. across investors.



Active submarkets. When an investor of type i with asset holdings a contacts a dealer and
chooses a new portfolio a0 , the utility gain is

                                 Œõi (a0 , a) = Vi? (a0 ) ‚àí Vi? (a) ‚àí p(a0 ‚àí a),

less any fee charged by the dealer. Therefore, as in the benchmark model, an investor of type i
with asset holdings a chooses a submarket that solves

                                     max
                                      0
                                         {¬µ min{1, Œ∏} [Œõi (a0 , a) ‚àí œÜ]}
                                     Œ∏,a ,œÜ


subject to the free-entry condition of dealers
                                             
                                        1
                               ¬µ min 1,           œÜ ‚â§ Œ≥, with equality if Œ∏ > 0.
                                        Œ∏
   25
      It should be noted that this matching technology does not satisfy the assumptions imposed earlier: it is not
everywhere strictly increasing and continuously differentiable, and Œ±0 (0) = ¬µ < ‚àû. In Appendix A.11, we verify that
the properties of equilibrium reported in Section 3 remain true under this specification.




                                                        25
Substituting the constraint into the objective, the optimal choice of Œ∏ for a type i investor with asset
holdings a is                      Ô£±
                                   Ô£≤ 0
                                   Ô£¥                                <
                                                              0
                          Œ∏i (a) =    [0, 1] if max      Œõi (a , a) = Œ≥/¬µ.                          (34)
                                   Ô£¥                  a0
                                        1                           >
                                   Ô£≥

In words, given the prevailing asset price p, an investor of type i with asset holdings a will rebal-
ance his portfolio in equilibrium if the (maximized) gain from doing so exceeds the expected cost
incurred by a dealer to process the transaction, which is simply the flow cost Œ≥ multiplied by the
average time to execute the order 1/¬µ. Note that dealers‚Äô entry generates no congestion on other
dealers‚Äîtheir matching rate is ¬µ‚Äîas long as Œ∏ ‚â§ 1. As a result, active submarkets will typically
have Œ∏i (a) = 1. In each of these active submarkets, a contract is posted with a fee,

                                                                   Œ≥
                                                    œÜi = œÜ ‚â°         ,                                   (35)
                                                                   ¬µ

which ensures that dealers earn zero profits, along with a quantity qi (a) = a0i ‚àí a, where

                                           ai = arg max
                                                     0
                                                        Œõi (a0 , a).                                     (36)
                                                         a ‚â•0


    Taken together, the results above imply that the Bellman equation for an investor of type i with
asset holdings a can be rewritten as
                                                                                                
                                  X
                                                                                        0       Œ≥
        rVi? (a)   = ui (a) + Œ¥       œÄk [Vk? (a)   ‚àí   Vi? (a)]   + ¬µ max 0, max  Œõi (a , a) ‚àí      .
                                  k
                                                                               a0               ¬µ

From the viewpoint of an investor, it is as if trading opportunities arrive at rate ¬µ, and they can
choose whether or not to trade at a cost œÜ = Œ≥/¬µ. In this sense, our model is formally equivalent to
a model of trade with fixed adjustment costs, as in Lo et al. (2004), though the costs of rebalancing
one‚Äôs portfolio arise endogenously in our model.
    As in most models with adjustment costs, the equilibrium in our environment could involve
‚Äúinaction regions,‚Äù where an investor of type i who holds aj for j 6= i chooses not to submit a trade
order because the fee required to compensate a dealer for executing this order exceeds the expected
gains to the investor. In what follows, we will focus on equilibria in which investors who hold their
optimal portfolio always rebalance their asset holdings after receiving a preference shock. As we
establish below, this allows us to sidestep the calculation of value functions for all a ‚àà R+ , and
instead characterize equilibrium asset holdings using a simple variational argument.



                                                           26
Optimal asset holdings. Before characterizing the asset demand functions in our candidate equi-
librium, we sketch the logic of our approach (formal proofs are in Appendix A.11). Let Ni ‚äÇ R+
denote the inaction region for an investor of type i, i.e., the set of values of a such that an investor
of type i with asset holdings in this set would choose not to trade. Given Œ≥/¬µ sufficiently small,
                       T
we can establish that i‚ààI Ni = ‚àÖ, so that an investor of type i with a ‚àà Ni will surely trade
if he receives a preference shock j 6= i. Given this behavior, there exists a unique ai ‚àà Ni that
maximizes the payoffs of a type i investor.
    To characterize these optimal asset holdings, note that ai is a solution to (36), for each i ‚àà I,
where
                                                       X
                              rVi? (a) = ui (a) + Œ¥          œÄk [Vk? (a) ‚àí Vi? (a)]                               (37)
                                                         k


if a ‚àà Ni and
                                                                                                    
                                           X
                                                                                          0      Œ≥
                 rVi? (a)   = ui (a) + Œ¥       œÄk [Vk? (a)   ‚àí   Vi? (a)]   + ¬µ max Œõi (a , a) ‚àí                  (38)
                                           k
                                                                                 a0              ¬µ

otherwise. One can manipulate (37) and (38) to see that, for all a in the inaction region Ni , the net
benefit to a type i investor from acquiring portfolio a, Vi (a)‚àípa, is a positive affine transformation
of                                                      P
                            (r + ¬µ) [ui (a) ‚àí rpai ] + Œ¥ œÄk [uk (a) ‚àí rpa]
                                                                            .                      (39)
                                         (r + ¬µ) (r + Œ¥) ‚àí Œ¥¬µœÄj
Since any optimal asset holding must belong to the inaction region Ni , it follows that ai must
satisfy the first-order condition for Vi (a) ‚àí pa to be maximized:

                                     (r + ¬µ) u0i (ai ) + Œ¥ œÄk u0k (ai )
                                                          P
                                                                        = rp.                                     (40)
                                                 r+¬µ+Œ¥

Note that this equation uniquely determines the optimal asset holding for an investor of type i,
ai . Studying the left side of (40), we see that the demand of an investor of type i depends on his
current marginal utility and his expected future marginal utility, weighted by the parameters r, ¬µ,
and Œ¥. In particular, an investor places more weight on his current value of marginal utility when
he is impatient, when orders are executed quickly, and when he expects to stay in his current state
for a long time.26
  26
     The asset demand functions characterized in (40) are closely related to the asset demand functions derived in LR,
where investors must bargain with dealers over the quantity to be traded and the corresponding intermediation fee. In
particular, our asset demand functions correspond to those of LR when dealers have zero bargaining power. Inter-
estingly, LR show that investors‚Äô portfolio decisions are socially inefficient whenever dealers have positive bargaining



                                                          27
    Moreover, if u0i (ai ) > k œÄk u0k (ai ), then ‚àÇai /‚àÇ¬µ > 0; that is, the investor‚Äôs demand for the
                              P

asset increases as trading frictions are reduced. Intuitively, when an investor‚Äôs current marginal
utility is relatively high, an increase in trading speed will cause him to take a larger position now
since it will be easier for him to unwind this position in the event of an adverse preference shock.
Conversely, if u0i (ai ) < k œÄk u0k (ai ), i.e., if the investor‚Äôs marginal utility in the current state is
                            P

below average, then ‚àÇai /‚àÇ¬µ < 0. More generally, as in LR, faster trading causes investors to take
more extreme positions, while slower trading gives agents incentives to choose a more moderate
portfolio that will not be too far from the optimal after any preference shock. Finally, as ¬µ goes to
infinity, the optimal portfolio tends to the value of ai that solves u0i (ai ) = rp, which is the portfolio
choice that would prevail in a competitive market where all trades can be executed instantaneously.

The steady-state distribution and market-clearing conditions. Given the results above, asset
holdings in the candidate equilibrium can be described by a list {ai }Ii=1 . Letting nij denote the
measure of agents of type i with asset holdings aj , the steady-state distribution must satisfy
                                         X
                                   Œ¥œÄi         nkj ‚àí Œ¥nij ‚àí ¬µnij = 0, for i 6= j                              (41)
                                         k‚ààI
                                   X               X
                             Œ¥œÄi         nki + ¬µ          nik ‚àí Œ¥nii = 0, for i = j                           (42)
                                   k‚ààI             k6=i
                                                   X
                                                             nij = 1.                                         (43)
                                                 (i,j)‚ààI 2


The first term in equation (41) represents the inflow of agents into state ij, with i 6= j, which only
occurs because of type-switching. The second two terms in equation (41) represent the outflow
from state ij, which occurs because of both type-switching (the second term) and trade (the third
term). Equation (42) is the steady-state condition for investors holding the optimal portfolio. In
this case, inflow can occur either when investors successfully rebalance their portfolio or when
they (luckily) receive a preference shock that corresponds to their current asset holdings. Outflow,
of course, occurs because of type-switching.
                          P          P
    Solving, we find that j nij = j nji = œÄi , so that

                                                  Œ¥œÄi œÄj
                                         nij =           , for j 6= i,                                        (44)
                                                  ¬µ+Œ¥
                                                  Œ¥œÄi2 + ¬µœÄi
                                         nii    =              for j 6= i.                                    (45)
                                                    ¬µ+Œ¥
power. Hence, the competitive search mechanism studied in this paper corrects the inefficiencies that arise from an
environment with random search and bargaining; intuitively, competition between dealers for order flow ensures that
investors receive exactly their marginal gain from readjusting their portfolio.

                                                             28
Note that the distribution of probabilities across states is symmetric, nij = nji . Also, ‚àÇnij /‚àÇ¬µ < 0
and ‚àÇnij /‚àÇŒ¥ > 0 if j 6= i, while ‚àÇnii /‚àÇ¬µ > 0 and ‚àÇnii /‚àÇŒ¥ < 0: the measure of investors who
are matched to their desired portfolio increases with the speed of execution and decreases with the
arrival rate of preference shocks.
    Turning now to the determination of the asset price in the competitive inter-dealer market, we
                                   P                                      P
note that market clearing requires i,j nij ai = A. Using the fact that j nij = œÄi , this condition
reduces to
                                             X
                                                œÄi ai = A.                                         (46)
                                                    i


Equilibrium and comparative statics. An equilibrium such that Œ∏i (aj ) = 1 for all i 6= j can
thus be defined as a list {ai }, {nij }, œÜ, and p that satisfy (35), (40), and (44)-(46). The individual
portfolio choices (aj ) in (40) depend on p, the equilibrium price in the inter-dealer market. The
distribution of investors over portfolios and preference types is given by (44) and (45). Given these
individual demands, the market-clearing condition (46) determines a unique price. Finally, the
choice of Œ∏i (aj ) described in (35) is optimal provided that Œ≥/¬µ is sufficiently small.
    Using these equilibrium conditions, we can explore the model‚Äôs implications for prices, trading
activity, and allocations. For example, although we have disentangled the asset price from the
intermediation fee, one can still compute the effective price that an investor pays (or receives) per
unit of the asset he buys (or sells). Investors with asset position ai who trade quantity aj ‚àí ai
through a dealer, pay (or receive, if aj ‚àí ai is negative)

                                                                œÜ
                                              pÃÇij = p +
                                                             aj ‚àí ai

per unit of the asset. The difference between the prices at which investors buy and sell is sometimes
treated as a measure of market liquidity. Notice that if aj ‚àí ai > 0, then

                                                    2œÜ          2Œ≥
                                  pÃÇij ‚àí pÃÇji =           =              > 0.                                 (47)
                                                  aj ‚àí ai   ¬µ (aj ‚àí ai )

So for this typical ‚Äúround trip‚Äù transaction, investors trade at a higher effective price when they
buy than when they sell. One can notice from (47) that the effective spread decreases with the size
of the order, which is in accordance with the evidence documented by Schultz (2001) and Edwards
et al. (2007) for over-the-counter markets.27
  27
     Similarly, Green, Hollifield, and SchuÃàrhoff (2007) document that dealers earn lower average markups on larger
trades in the market for municipal bonds. By estimating a bargaining model they find that dealer‚Äôs bargaining power
is substantial and it decreases in trade size.



                                                        29
    A decrease in Œ≥, the operating costs for dealers, also causes a decrease in the bid-ask spread.
The effects of a change in ¬µ are less obvious. On the one hand, an increase in ¬µ has a direct effect
in reducing œÜ = Œ≥/¬µ. On the other hand, a change in ¬µ also affects equilibrium asset holdings
and hence the quantity traded, aj ‚àí ai . However, since the distribution of asset holdings spreads
out as ¬µ increases, the quantity of assets traded in many individual trades tends to increase (see
Lagos and Rocheteau (2009)); in the case of I = 2, for example, it can be checked that |a2 ‚àí a1 |
increases with ¬µ, so the bid-ask spread unambiguously decreases with ¬µ.
    The model also has implications for trading volume, which is defined as follows. The flow of
investors who can readjust their portfolios per unit of time is ¬µ. A fraction nij of these investors
readjust their portfolio from ai to aj so that the quantity they trade is |aj ‚àí ai |. Thus, the total
volume of trade is
                                           ¬µX
                                      V=         nij |aj ‚àí ai | .                               (48)
                                           2 i,j

An increase in ¬µ has three distinct effects on trade volume. First, the measure of investors in any
individual state (i, j) ‚àà I 2 who can readjust their portfolios increases, which tends to increase trade
                                        P
volume. Second, the proportion 1 ‚àí i nii of agents who are mismatched to their portfolio‚Äîand
hence the fraction of agents who wish to trade‚Äîdecreases, which tends to reduce trade volume.
Finally, as discussed above, the distribution of asset holdings spreads out, which tends to increase
the quantity of assets traded in many individual trades, and hence increase volume. Given (44) and
(48), it is easy to check that the first two effects combined lead to an increase in V. Therefore,
when the third effect is also positive the total volume of trade unambiguously increases with ¬µ.
    We can also study some limiting cases. First, as ¬µ ‚Üí ‚àû, so that trades are executed instan-
taneously, we see from (35) that intermediation fees go to 0. Moreover, from (40), the individual
demand for the asset converges to the Walrasian demand, u0j (aj ) = rp, and from (44)-(45) all in-
vestors hold their desired portfolios. The same is true as Œ¥ ‚Üí 0, since type never changes. Finally,
as Œ≥ ‚Üí 0, the intermediation fee œÜ ‚Üí 0. However, a decrease in Œ≥ will only have an effect on asset
prices and allocations if it causes a change in the set of active submarkets; if the initial value of Œ≥
was sufficiently small, so that Œ∏i (aj ) = 1 for all i 6= j, then a decrease in Œ≥ has no effect on the
allocation of assets across agents or on asset prices.


5    A numerical example
In this final section, we return to the general environment described in Section 2 and develop a
numerical example to show that our model generates quantitative outcomes of reasonable magni-
tude, in terms of trade size, execution speed, and trading costs. We then use this example to offer


                                                  30
                                                Table 1: Parameter values
                        Parameter                                        Value
                        Asset supply                               A     1
                        Cost of posting contract                   Œ≥     1
                        Contact intensity                          Œª     85 per year
                        Elasticity of matching function            Œ∑     0.7
                        Discount rate                              r     0.05 per year
                        Type switching intensity                   Œ¥     0.7 pear year
                        Elasticity of utility function             œÉ     4.75
                        Number of utility types                    I     30
                        Transition probabilities                   œÄi    1/I
                                                                                     ‚àí1
                        Utility types                              Œµi    e‚àí10+12.3Œ¶ [0.05+0.90(i‚àí1)/I]

                           In the last line of the table, Œ¶‚àí1 (q) is the inverse cumulative function of a standard
                           normal distribution. According to the formula, the grid of {œâi }i‚àà{1,...,I} is made up
                           of 30 percentiles, equally spaced between 0.05 and 0.95, of a log normal distribution
                           with mean ¬µ = ‚àí10 and standard deviation œÉ = 12.3.




some numerical comparative statics. We assume that preference shocks are multiplicative with an
iso-elastic utility function, ui (a) = Œµi v(a) with v(a) = a1‚àíœÉ /(1 ‚àí œÉ), and the matching function
is Cobb Douglas, Œ±(Œ∏) = ŒªŒ∏Œ∑ . The baseline values, shown in Table 1, are chosen as follows.
    First, as is common, we set the discount rate to 5% per year. Second, given that our preference
specification is homogenous, we normalize the asset supply to A = 1.28 Third, with Cobb Douglas
matching, since the unit used to measure market tightness is meaningless in our model, we can
normalize the contract posting cost to 1 (see Shimer, 2005, for a similar argument in his calibration
of the Mortensen‚ÄìPissarides model).
    The contact intensity, Œª, is chosen to generate reasonable trading intensities, measured as fol-
lows. In a stationary equilibrium, the aggregate quantity of assets waiting to be either purchased
                                          P
or sold at any point in time is equal to ij ni (aj )|ai ‚àí aj |. The probability that a randomly chosen
unit waiting to be traded belongs to the order of agent (i, j) is:

                                                               ni (aj )|ai ‚àí aj |
                                            œài (aj ) = P                              .
                                                               k,` nk (a` )|ak ‚àí a` |


Thus, the trading intensity of a randomly chosen unit is ŒªÃÑ = i,j œài (aj )ŒªŒ∏i (aj )Œ∑ . In our numerical
                                                              P

example, the contact intensity, Œª = 85, implies that the average trading intensity is ŒªÃÑ = 286, i.e., it
takes on average 0.87 days to trade one unit of asset.
    We pick the rest of the parameters based on empirical targets from the municipal bond market.
  28
     Up to an appropriate scaling of the contract posting cost, the only effect of scaling A up and down is to scale down
all relevant equilibrium objects by the same constant. Namely, if {p, ai , Œ∏i } is an equilibrium when the asset supply is
A and the contract posting cost is Œ≥, then, for any Œª > 0, {Œª‚àíœÉ p, Œªai , Œ∏i } is an equilibrium when the asset supply is
ŒªA and the contract posting post is Œ≥Œª1‚àíœÉ .

                                                                  31
In our numerical example, the type switching intensity, Œ¥ = 0.7, generates a turnover of about
46% per year, which is in the ballpark of the 56% turnover measured by Green et al. (2007) for
seasoned bonds over the 2000-2004 time period. We adopt a parsimonious parameterization for
the distribution of utility types in order to obtain a rough match of the distribution of relative trade
sizes, as proxied by the distribution of relative sale sizes from customers to dealers reported by the
Fact Book of the Municipal Securities Rulemaking Board (2008). Figure 2 shows the theoretical
distribution generated by the model and compares it to its empirical counterpart.

               Figure 2: Empirical vs. theoretical CDFs of (normalized) trade sizes.
                                    cumulative distribution of normalized trade sizes
                                         1




                                       0.5


                                                                            empirical
                                                                            theoretical
                                         0
                                             0                   0.5                      1


                                                        Normalized Size
                Notes: the red line plots the empirical distribution of normalized trade sizes reported by the Fact Book
                of the Municipal Securities Rulemaking Board (2008). The blue line is the corresponding distribution
                of relative trade sizes generated by our calibrated model.


    Finally, to set the elasticity of the matching function, Œ∑, and the elasticity of the utility function,
œÉ, we consider two empirical targets on transaction costs. The first empirical target is the average
transaction cost per unit traded, which was between 50bp and 100bp during the 2000-2004 period
according to the markup data reported by Green et al. (2007). The average unit transaction cost
that an econometrician would measure in a stationary equilibrium of our model is

                                                    X                   œÜi (aj )
                                                           œÅi (aj )               ,
                                                      ij
                                                                       |aj ‚àí ai |

where

                                                             ni (aj )ŒªŒ∏i (aj )1‚àíŒ∑
                                             œÅi (aj ) = P                         1‚àíŒ∑
                                                             k,` nk (a` )ŒªŒ∏k (a` )


is the probability that a randomly chosen trade originates from an investor of utility type i with
asset holdings aj . In our numerical example, the average unit transaction cost is 38bp, smaller but
comparable to the markups measured in the data. The other empirical target we consider is the

                                                                  32
relationship between transaction cost and trade size. According to the regressions of Harris and
Piwowar (2004), multiplying the trade size by 10 divides the unit transaction cost by 2, correspond-
ing to an elasticity of about ‚àí log(2)/ log(10) = ‚àí0.3. In a stationary equilibrium of our model,
this elasticity can be measured by calculating the theoretical coefficient of a univariate regression
of log unit transaction cost on log trade size:
                                           h                                i
                                                 œÜ (a )
                                        cov log |aji ‚àíaj i | , log(|aj ‚àí ai |)
                                                                                       ,
                                                 var [log(|aj ‚àí ai |)]

where the covariances and variances are calculated based on the probabilities œÅi (aj ). In our nu-
merical example, this elasticity turns out to be ‚àí0.29.

  Figure 3: Impact of Œª and Œ∑ on: (i) average unit fee and (ii) elasticity of unit fee to trade size.
                   Average (bp)              Elasticity
              60                    ‚àí0.2
                                                                   Average (bp)              Elasticity
                                                              60                     0.2



                                                                                       0
              50
                                                              50
                                    ‚àí0.25
                                                                                    ‚àí0.2

              40
                                                              40
                                                                                    ‚àí0.4


              30                    ‚àí0.3
                    60   80   100           60       80   100 30                    ‚àí0.6
                                                               0.4      0.6   0.8      0.4      0.6       0.8

                         Œª                       Œª                      Œ∑                        Œ∑

     We conclude this section with comparative statics of transaction costs with respect to two
parameters: the trading intensity, Œª, and the elasticity of the matching function, Œ∑. From the
left, the first plot in Figure 3 shows that increasing the contact intensity, Œª, reduces the equilibrium
level of transaction costs, which is consistent with the theoretical result we derived earlier in the
model with fixed trade size. The second panel reveals that trading intensity also has an impact
on the elasticity of transaction costs to trade size: as Œª increases, transaction costs respond more
strongly to changes in trade size. The third panel of the figure shows that increasing the elasticity
of the matching function, Œ∑, tends to increase unit trading fees. This is in line with the observation
that, in a competitive search equilibrium, Œ∑ represents the share of the surplus that is appropriated
by dealers. It is natural, then, that a larger Œ∑ is associated with larger transaction costs. The
fourth and last panel shows that there is a sharp negative relationship between the elasticity of
the matching function, Œ∑, and the elasticity of transaction costs to trade size. Together with the
theoretical analysis above, this finding suggests that the empirical relationship between unit fee
and trade size can be useful to infer properties of the matching function.

                                                            33
6    Conclusion
We have developed a model of a two-sided asset market where trades are intermediated by dealers
and involve a time-consuming matching process. In contrast to the description of OTC markets
in much of the existing literature, we assume that dealers post terms of trade in order to attract
order flow, and investors observe these terms of trade and direct their orders to the dealer who
promises the maximum expected payoff. This formulation is a good description of many OTC
markets, where prices, trading costs (e.g., bid-ask spreads), and execution times are either readily
observable or they are made public shortly after trades occur, which enables dealers to achieve
commitment through reputation.
    We characterize the equilibrium in a general setting, and illustrate how the model can account
for several important trading patterns in over-the-counter markets which do not emerge from exist-
ing models. We then study two special cases which allow us to highlight the differences between
our model and the existing literature. Finally, we calibrate our model, illustrate that it generates
reasonable quantitative outcomes, and use it to study how trading frictions affect the per-unit trad-
ing costs that investors pay in equilibrium.




                                                 34
References
James Albrecht, Pieter Gautier, and Susan Vroman. Directed search in the housing market. Work-
  ing Paper, Georgetown University, 2013.
Robert Battalio, Brian Hatch, and Robert Jennings. All else equal? A multidimensional analysis
  of retail, market order execution quality. Journal of Financial Markets, 6(2):143‚Äì162, 2003.
Ekehart Boehmer, Robert Jennings, and Wei Li. Public disclosure and private decisions: Equity
  market execution quality and order routing. Review of Financial Studies, 20:315‚Äì358, 2007.
Ekkehart Boehmer. Dimensions of execution quality: Recent evidence for u.s. equity markets.
  Journal of Financial Economics, 78(3):553‚Äì582, 2005.

Kenneth Burdett and Maureen O‚ÄôHara. Building blocks: An introduction to block trading. Journal
  of Banking and Finance, 11(2):193 ‚Äì 212, 1987.

Kenneth Burdett, Shouyong Shi, and Randall Wright. Pricing and matching with frictions. Journal
  of Political Economy, 109(5):1060‚Äì1085, 2001.

Briana Chang. Adverse selection and liquidity distortion in decentralized markets. Working Paper,
  University of Wisconsin, Madison, 2012.

Antonia Diaz and BeleÃÅn Jerez. House prices, sales, and time on the market: A search-theoretic
  framework. Working Paper, Universidad de Carlos III, 2013.

Darrell Duffie. Dark Markets: Asset Pricing and Information Transmission in Over-the-Counter
  Markets. Princeton University Press, 2012.

Darrell Duffie, Nicolae GaÃÇrleanu, and Lasse H. Pedersen. Over-the-Counter Markets. Economet-
  rica, 73(6):1815‚Äì1847, 2005.

Amy K. Edwards, Lawrence E. Harris, and Michael S. Piwowar. Corporate bond market transac-
 tion costs and transparency. Journal of Finance, 62(3):1421‚Äì1451, 2007.

Miquel Faig and BeleÃÅn Jerez. Inflation, prices, and information in competitive search. The BE
 Journal of Macroeconomics (Advances), 2006.

Peter FeldhuÃàtter. The same bond at different prices: Identifying search frictions and selling pres-
  sures. Review of Financial Studies, 25:1155‚Äì1206, 2012.

Alessandro Gavazza. Leasing and secondary markets: Theory and evidence from commercial
  aircraft. Journal of Political Economy, 119(2):325‚Äì377, 2011.

Richard C. Green, Burton Hollifield, and Norman SchuÃàrhoff. Financial intermediation and the
  costs of trading in an opaque market. Review of Financial Studies, 20:275‚Äì314, 2007.

Veronica Guerrieri and Robert Shimer. Dynamic adverse selection: A theory of illiquidity, fire
  sales, and flight to quality. Working Paper, University of Chicago, 2012.


                                                35
Veronica Guerrieri and Robert Shimer. Markets with multidimensional private information. Work-
  ing Paper, University of Chicago, 2013.
Veronica Guerrieri, Robert Shimer, and Randall Wright. Adverse selection in competitive search
  equilibrium. Econometrica, 78(6):1823‚Äì1862, 2010.
George Hall and John Rust. Middlemen versus market makers: A theory of competitive exchange.
  Journal of Political Economy, 111(2):353‚Äì403, 2003.
Lawrence E. Harris and Michael S. Piwowar. Secondary trading costs in the municipal bond
  market. 2004.
Thomas S. Y. Ho and Hans R. Stoll. The dynamics of dealer markets under competition. Journal
  of Finance, 38(4):1053‚Äì1074, 1983.
Burton Hollifield, Artem Neklyudov, and Chester Spatt. Bid-ask spreads and the pricing of securi-
  tizations: 144a vs. Technical report, registered securitizations. Working Paper, Carnegie Mellon
  University, 2012.
Arthur J. Hosios. On the efficiency of matching and related models of search and unemployment.
  The Review of Economic Studies, 57(2):279‚Äì298, 1990.
Roman Inderst and Holger M. MuÃàller. Competitive search markets for durable goods. Economic
  Theory, 19(3):599‚Äì622, 2002.
Ricardo Lagos and Guillaume Rocheteau. Inflation, output, and welfare. Federal Reserve Bank of
  Cleveland, working paper 04-07, 2004.
Ricardo Lagos and Guillaume Rocheteau. Search in asset markets: Market structure, liquidity, and
  welfare. American Economic Review, 97(2):198‚Äì202, 2007.
Ricardo Lagos and Guillaume Rocheteau. Liquidity in asset markets with search frictions. Econo-
  metrica, 77:403‚Äì426, 2009.
Ricardo Lagos, Guillaume Rocheteau, and Pierre-Olivier Weill. Crises and liquidity in over-the-
  counter markets. Journal of Economic Theory, 146(6):2169‚Äì2205, 2011.
Benjamin Lester. Information and prices with capacity constraints. The American Economic
  Review, 101(4):1591‚Äì1600, 2011.
Benjamin Lester, Ludo Visschers, and Ronald Wolthoff. Competing with asking prices. Federal
  Reserve Bank of Philadelphia working paper series, 2013.
Andrew W Lo, Harry Mamaysky, and Jiang Wang. Asset prices and trading volume under fixed
  transactions costs. Journal of Political Economy, 112(5), 2004.
Lionel Melin. Multi-speed markets. Working paper, University of Chicago, 2012.
Guido Menzio and Shouyong Shi. Efficient search on the job and the business cycle. Journal of
  Political Economy, 119(3):468‚Äì510, 2011.

                                               36
Espen Moen. Competitive search equilibrium. Journal of Political Economy, 105:385‚Äì411, 1997.
Dale T. Mortensen and Randall Wright. Competitive pricing and efficiency in search equilibrium.
  International Economic Review, 43(1):1‚Äì20, 2002.
Municipal Securities Rulemaking Board. Fact Book. 2008.

Artem Neklyudov. Bid-ask spreads and the over-the-counter interdealer markets: Core and periph-
  eral dealers. Working Paper HEC Lausanne, 2012.

Emiliano Pagnotta and Thomas Philippon. Competing on speed. Working Paper, NYU Stern
 School of Business, 2011.

Christopher A Pissarides. Equilibrium unemployment theory. MIT Press Books, 1, 2000.

Remy Praz. Equilibrium asset pricing and portfolio choice in the presence of both liquid and
  illiquid markets. Working paper, EPFL, 2012.

Guillaume Rocheteau and Pierre-Olivier Weill. Liquidity in frictional asset markets. Journal of
  Money, Credit and Banking, 43(7):261‚Äì282, 2011.

Guillaume Rocheteau and Randall Wright. Money in search equilibrium, in competitive equilib-
  rium, and in competitive search equilibrium. Econometrica, 73(1):175‚Äì202, 2005.

Ariel Rubinstein and Asher Wolinsky. Middlemen. The Quarterly Journal of Economics, pages
  581‚Äì594, 1987.

M Sattinger. Queueing and searching. Technical report, Mimeo, 2010.

Michael Sattinger. A search version of the Roy model. Working paper, SUNY Albany, 2003.

Paul Schultz. Corporate bond trading costs: A peak behind the curtain. Journal of Finance, 56(2):
  pp. 677‚Äì698, 2001.

Andrei Shevchenko. Middlemen*. International Economic Review, 45(1):1‚Äì24, 2004.
Robert Shimer. The cyclical behavior of equilibrium unemployment and vacancies. American
  Economic Review, 95:25‚Äì49, 2005.
Daniel F. Spulber. Market making by price-setting firms. The Review of Economic Studies, 63(4):
  559‚Äì580, 1996.
Derek G. Stacey. Information, commitment, and separation in illiquid housing markets. Working
  paper, Queen‚Äôs Economics Department, 2012.

Margaret Stevens. New microfoundations for the aggregate matching function. International
 Economic Review, pages 847‚Äì868, 2007.
Nancy L. Stokey and Robert E. Lucas. Recursive Methods in Economic Dynamics. Harvard
  University Press, 1989.


                                               37
Dimitri Vayanos and Pierre-Olivier Weill. A Search-Based Theory of the On-the-Run Phe-
  nomenon. Journal of Finance, 63(3):1361‚Äì1398, 2008.
Makoto Watanabe. Middlemen: A directed search equilibrium approach. Working Paper, VU
 University Amsterdam, Tinbergen Institute, 2013.
Pierre-Olivier Weill. Leaning against the wind. The Review of Economic Studies, 74(4):1329‚Äì
  1354, 2007.
Pierre-Olivier Weill. Liquidity premia in dynamic bargaining markets. Journal of Economic The-
  ory, 140:66‚Äì96, 2008.
Shengxing Zhang. Liquidity missallocation in an over-the-counter market. Working Paper, NYU,
  2012.




                                             38
A       Proof
A.1      Proof of Proposition 1
We start by noting that Vi (a, œÉ, Œ∏) can be written

                                                 Œ±(Œ∏)
             Vi (a, œÉ, Œ∏) = Vi (a, 0, 0) +               [V ? (a + q) ‚àí pq ‚àí œÜ ‚àí Vi (a, 0, 0)] ,                   (49)
                                             r + Œ¥ + Œ±(Œ∏) i

where
                                                                PI         ?
                                                   ui (a) + Œ¥    j=1 œÄij Vj (a)
                                 Vi (a, 0, 0) =                                   .
                                                                r+Œ¥

Equation (49) shows that the value of submitting an order for contract œÉ when the market tightness is Œ∏ is
the sum of two terms: the first term is the no-trade utility, Vi (a, 0, 0), and the second term is proportional to
                                                                                              Œ±(Œ∏)
the trading surplus, Vi (a + q) ‚àí pq ‚àí œÜ ‚àí Vi (a, 0, 0). The constant of proportionality,   r+Œ¥+Œ±(Œ∏)       ‚â§ 1, captures
the time discounting of trading delays associated with tightness Œ∏. The next result is then immediate.

Lemma 3. In any equilibrium, Vi? (a) ‚â• Vi (a, 0, 0). Moreover the function Œ∏ 7‚Üí Vi (a, œÉ, Œ∏) has the follow-
ing properties:

    1. If Vi? (a + q) ‚àí pq ‚àí œÜ ‚â§ Vi (a, 0, 0), then Vi (a, œÉ, Œ∏) is decreasing in Œ∏.

    2. If Vi? (a + q) ‚àí pq ‚àí œÜ > Vi (a, 0, 0), then Vi (a, œÉ, Œ∏) is strictly increasing in Œ∏.

    The first part of the lemma is clear: since investors can always choose 0, their maximum attainable
utility must be at least equal to Vi (a, 0, 0). The second part of the lemma simply asserts that, if there are
strict gains from trading œÉ, Vi? (a + q) ‚àí pq ‚àí œÜ > Vi (a, 0, 0), then investors have a strict preference for
higher tightness, because it leads to smaller trading delays. Otherwise, they prefer not to send orders for œÉ.
    Now turning to the proof of Proposition 1, we first show that the right-hand side of (7) is an upper bound
for Vi? (a). Indeed, for œÉ = 0, Vi (a, 0, 0) is equal to the right-hand side of (7) evaluated at Œ∏ = 0. For
œÉ ‚àà Œ£? but different from 0, the dealer‚Äôs zero-profit condition writes Œ± [Œò(œÉ)] œÜ = Œ≥Œò(œÉ). Thus:

                                                   œÄij Vj? (a) + Œ±[Œò(œÉ)] [Vi? (a + q) ‚àí pq] ‚àí Œ≥Œò(œÉ)
                                           P
                              ui (a) + Œ¥     j‚ààI
          Vi (a, œÉ, Œò(œÉ)) =                                                                            ,
                                                          r + Œ¥ + Œ±[Œò(œÉ)]

which is clearly less than the right-hand side of (7). Thus, taking the sup over all œÉ ‚àà Œ£? , we find Vi? (a) is
less than the right-hand side of (7).
    Toward a contradiction, suppose that Vi? (a) is strictly less than the right-hand side of (7). Then, there




                                                           39
must be some (Œ∏ÃÇ, qÃÇ) such that

                                                                  œÄij Vj? (a)+Œ±(Œ∏ÃÇ)[Vi? (a+qÃÇ)‚àípqÃÇ ]‚àíŒ≥ Œ∏ÃÇ
                                                            P
                                                 ui (a)+Œ¥
                                     Vi? (a) <              j‚ààI
                                                                       r+Œ¥+Œ±(Œ∏ÃÇ)
                                                                  ?            ?             ?
                                                        j‚ààI œÄij Vj (a)+Œ±(Œ∏ÃÇ)[Vi (a+qÃÇ)‚àípqÃÇ‚àíVi (a)]‚àíŒ≥ Œ∏ÃÇ
                                                        P
                                             ui (a)+Œ¥
                        ‚áê‚áí      Vi? (a) <                              r+Œ¥                              .               (50)

Note, using the lower bound Vi (a, œÉ, Œ∏) ‚â• Vi (a, 0, 0) in inequality (50), that Œ∏ÃÇ > 0. Consider, then, the
                                      Œ≥ Œ∏ÃÇ
contract œÉÃÇ = (qÃÇ, œÜÃÇ), where œÜÃÇ =           + Œµ, for some Œµ small enough so that Vi (a, œÉÃÇ, Œ∏ÃÇ) > Vi? (a). Using again
                                     Œ±(Œ∏ÃÇ)
the lower bound in inequality (50), one sees that Vi? (a + qÃÇ) ‚àí pqÃÇ ‚àí œÜÃÇ > Vi? (a) ‚â• Vi (a, 0, 0). Thus, by
Lemma 3, Vi (a, œÉÃÇ, Œ∏) is strictly increasing in Œ∏. Since it is also continuous, it then follows that Œò(œÉÃÇ) < Œ∏ÃÇ.
Given that Œ±(Œ∏)/Œ∏ is decreasing, we find that Œ†(œÉÃÇ) > 0, which contradicts dealers‚Äô zero-profit condition.
       Finally, for the second part of the proposition, we apply the contraction mapping to the auxiliary Bellman
equation (7). Consider some arbitrary lower and upper bounds for the price, 0 < p < p. If asset holdings are
unrestricted, let a and a be the solutions to u0I (a) = rp and u01 (a) = rp, respectively. Since u0i (a) ‚â§ rp for
all a ‚â• a and all i, and u0i (a)(p) ‚â• rp for all a ‚â§ a and all i and all p ‚àà [p, p], one can show that an investor
will always find it optimal to choose holdings a ‚àà [a, a]. If asset holdings are restricted, we let a = min A
and a = max A: by assumption, asset holdings always lie in the interval [a, a]. To derive bounds on the
choice of Œ∏, note that, up to a positive constant of proportionality, the left derivative with respect to Œ∏ of the
equation to be maximized on the right-hand side of (7) is equal to

                                                                  ui (a) + œÄij Vj? (a)
                                                                         P            
                        0   ‚àí      0 ‚àí            ?
                            
   ‚àí(r + Œ¥)Œ≥ + Œ± (Œ∏ )Œ∏ ‚àí Œ±(Œ∏) Œ≥ + Œ± (Œ∏ )(r + Œ¥) Vi (a + q) ‚àí pq ‚àí                        .
                                                                          r+Œ¥

The first term is strictly negative and independent of Œ∏. The second term is negative because Œ±(Œ∏) is concave.
In the third term, the square bracket is bounded independently of Œ∏ and p ‚àà [p, p].29 Given than Œ±0 (‚àû) = 0,
this implies that there exists some Œ∏ such that, for all Œ∏ > Œ∏, all p ‚àà [p, p], and all (i, a) ‚àà I √ó [a, a], the
left-derivative of equation (7) is strictly negative. Therefore, an investor will always find it optimal to choose
a market tightness Œ∏ ‚àà [0, Œ∏].
       Let S = I √ó [a, aÃÑ] √ó [p, p] when assets are unrestricted, and let S = I √ó A √ó [p, p] when assets are
restricted. Let C (S) be the space of bounded, continuous functions f : S ‚Üí R equipped with the sup norm.
  29
     Indeed Vi (a) ‚â§ maxi‚ààI uir(a) + pa, so that the maximum attainable utility is less than the present value of the
maximum utility flow from holding the maximum quantity of assets, plus the time-zero value of selling the maximum
quantity of assets at the maximum price. To see this, note that the inter-temporal value of an investor has two terms.
The first term is the expected present value of utility flows, ui [a(t)], net of search cost, ‚àíŒ≥Œ∏(t), which is clearly less
than uIr(aÃÑ) . The second term is the expected present value of the benefits of selling minus the costs of buying assets at
                 P‚àû times 0 <T1 < T2 < . . .. For
the random contact                                     given realization of contact times, this present value can be written
a(0)pe‚àírT1 + n=1 pa(Tn ) e‚àírTn+1 ‚àí e‚àírTn . Indeed, the investor resells a(Tn ) at time Tn+1 after buying it at
time Tn . Clearly, the first term is less than paÃÑ, and all terms in the infinite sum are negative.




                                                                40
Notice that C (S) is a complete normed vector space. The right-hand side of (7) defines an operator T :
                                             "                                                                            #
                                                                       œÄij Vj (a) + Œ±(Œ∏)[Vi (a0 ) ‚àí p(a0 ‚àí a)] ‚àí Œ≥Œ∏
                                                              P
                                                 ui (a) + Œ¥      j‚ààI
     T (Vi )(a, p) =         max                                                                                              .   (51)
                       (a0 ,Œ∏)‚àà[a,a]√ó[0,Œ∏]                                   r + Œ¥ + Œ±(Œ∏)

If V ‚àà C (S), then, from the Theorem of the Maximum T (V ) ‚àà C (S). See Theorem 3.6 in Stokey and
                                                                                                             Œ¥+Œ±(Œ∏)
Lucas (1989). Furthermore, T is monotonic and T (f + k)(a, i) ‚â§ T (f )(a, i) +                              r+Œ¥+Œ±(Œ∏)
                                                                                                                     k   for all k ‚â• 0
and all f ‚àà C (S). Therefore, from Blackwell‚Äôs Theorem, T is a contraction on C (S) and it has a unique
fixed point in C (S). See Theorem 3.3 in Stokey and Lucas (1989). Finally, if Vi (a, p) is a strictly increasing
function then T (Vi )(a, p) is also strictly increasing so that the unique fixed point of T is increasing. But since
ui (a) is strictly increasing, the Bellman equation (7) implies that Vi (a) is the sum of a strictly increasing
function and an increasing function, and so is strictly increasing as well. Finally, since we considered
arbitrary lower and upper bounds, p and p, and since a ‚Üí ‚àû as p ‚Üí 0, and a ‚Üí 0 as p ‚Üí ‚àû, the properties
extend by continuity to the domain S = I √ó A √ó (0, ‚àû).


A.2     Proof of Proposition 2
We first note that, by Theorem of the Maximum, the correspondence (ai (a, p), Œ∏i (a, p)) maximizing (51) is
compact valued and upper hemi continuous. Moreover, one sees that ai (a, p) is independent on a: it is equal
to arg maxa0 ‚àà[a,a] Vi (a0 , p) ‚àí pa0 if 0 ‚àà
                                           / Œ∏i (a, p) and to [a, a] otherwise. With this in mind, let

                                   M(p) ‚â° (ai (p), Œ∏j (ai (p), p)), (i, j) ‚àà I 2 .
                                         


The correspondence M(p) contains the collection of candidate equilibrium asset holdings if the price is p.
It is clearly compact valued and is easily shown to be upper hemi continuous. As explained in the text,
we look for an equilibrium in which the distribution of types has a finite support. To deal with potential
non-convexity arising if the Bellman equation has more than one maximizer, we partition the population of
investors into G ‚â• 2 groups of size ¬µg , for some ¬µg in the G-dimensional simplex, ‚àÜG . We assume that
each investor in group g optimally keeps its asset holdings in the support {ag1 , ag2 , . . . , agI } where, for all i
and g, agi is maximizing (7). If the investor has utility type i but asset holding agj , j 6= i, then he sends its
order for a contract with a market tightness Œ∏i (agj ) maximizing (7). Therefore, the inflow-outflow equations
for the steady-state distribution, ngi (aj ), of group g write:

                                                          nk (agj )œÄki ‚àí Œ¥ngi (agj ) ‚àí Œ±[Œ∏i (agj )]ni (agj )
                                                   X
                       if i 6= j    : 0=Œ¥                                                                                         (52)
                                                    k‚ààI

                                                          nk (agi )œÄki ‚àí Œ¥ni (agj ) +         Œ±[Œ∏i (agk )]nk (agi )
                                                   X                                    X
                       if i = j     : 0=Œ¥                                                                                         (53)
                                                    k‚ààI                                 k‚ààI

                                                                ni (agj ).
                                                      X
                                        ¬µg =                                                                                      (54)
                                                   (i,j)‚àà‚ààI 2




                                                                      41
The first step is to establish the following result.

Lemma 4. The system of steady-state equations (52)-(54) has at least one solution.

Proof. The argument is standard. The system (8)-(9) characterizes the ergodic distributions of the continu-
ous time Markov chain induced by the type switching and trading process. Denote the transition intensities
                      P
by Œªk,` , and let Œªk ‚â° ` Œªk,` . The steady-state equations can be rewritten:

                               X                                            X             Œªk,`
         ‚àÄ` :       Œª ` n` =        nk Œªk,`     ‚áê‚áí      ‚àÄ` :     Œª ` n` =       Œª k nk           ‚áê‚áí   œÄ = œÄQ,
                                                                                          Œªk
                                k                                           k

                                       Œª`,k
where œÄk ‚â° Œªk nk and Q`,k =             Œª` .   Thus, a steady-state distribution can be found by solving for an ergodic
distribution, œÄ, of the discrete time Markov chain with transition probabilities Q. Since this discrete time
Markov chain has a finite state space, it follows from Theorem 11.1 of Stokey and Lucas (1989) that such
an ergodic distribution exists.                                                                                      

    Equipped with this result, we can define the aggregate demand correspondence as follows. In matrix
form, the system of steady-state equations of group g, (52)-(54), can be written as Œì(mg )ng = b, where the
entries of Œì(mg ) are continuous in agi and Œ∏i (agj ). Then, we let
          Ô£±                                                                                                  Ô£º
          Ô£≤X                                                                                                 Ô£Ω
 D(p) ‚â°                 ¬µg ni (agj )agj , for ¬µg ‚àà ‚àÜG , mg = (ai , Œ∏i (aj )) ‚àà M(p), and ng s.t. Œì(mg )ng = b .
          Ô£≥                                                                                                  Ô£æ
                g,i,j


Now let us turn to the proof of Proposition 2. By Lemma 4, the aggregate demand correspondence is non-
empty. It is convex by construction. To see that it is compact-valued, consider any sequence of elements of
D(p) generated by some sequences ¬µgk , mgk , and ngk . Because group measures, asset holdings, and steady-
state measures are all bounded, we can extract convergence subsequences ¬µgk` , mgk` , and ngk` . Since the
simplex and M(p) are compact, it follows that lim ¬µgk` ‚àà ‚àÜG and lim mgk` ‚àà M(p). Since Œì(m) is
continuous, it follows that Œì(lim mgk` ) lim ngk` = b. Therefore, the aggregate excess demand generated by
lim ¬µgk` , lim mgk` , and lim ngk` belongs to D(p), and we are done proving compactness. Finally, a similar
reasoning establishes that D(p) is upper hemi continuous. Now, we note that the aggregate demand goes to
zero as p goes to infinity, and to infinity as p goes to zero. An application of the Intermediate Value Theorem
(easily extended for upper hemi continuous, compact, and convex-valued correspondences) establishes the
claim of the proposition.
    The last step is to verify the equilibrium condition for the candidate equilibrium objects shown in the text
after Proposition 2. Without loss of generality at this stage of the analysis, let us assume that G = 1 so that
we can simplify notations and drop the ‚Äúg‚Äù subscript everywhere. We first show that Œò[œÉi (aj )] = Œ∏i (aj ).
First, we prove that

                                         Vi (aj , œÉi (aj ), Œ∏i (aj )) > Vi (aj , 0, 0).

                                                                 42
By construction, we have a weak inequality. Suppose, toward a contradiction, that Vi (aj , œÉi (aj ), Œ∏i (aj )) =
Vi (aj , 0, 0). Expressing this equality using (49) and the dealer‚Äôs zero-profit condition, we have

                             Œ±[Œ∏i (aj )]
                                         [Vi (a + qi (aj )) ‚àí pqi (aj ) ‚àí Vi (a, 0, 0)] = Œ≥.
                              Œ∏i (aj )

Now the right-derivative at Œ∏ = 0 of the right-hand side of (51) is equal to

                              Œ±0 (0) [Vi (a + qi (aj )) ‚àí pqi (aj ) ‚àí Vi (a, 0)] ‚àí Œ≥
                                                                                     >0
                                                       r+Œ¥

using the equality we derived just above and noting that Œ±0 (0) > Œ±(Œ∏)/Œ∏ by strict concavity. Hence, the
right-hand side of the auxiliary Bellman equation (51) cannot be maximized at Œ∏ = 0, which is a contradic-
tion. Thus, we are in case 2 of Lemma 3, Vi (aj , œÉi (aj ), Œ∏i (aj )) is strictly increasing, Œ∏i (aj ) = inf{Œ∏ ‚â• 0 :
Vi (aj , œÉi (aj ), Œ∏) > Vi? (aj )} and so is greater than Œò(œÉi (aj )).
    Suppose, toward a contradiction, that the inequality is strict. Then, by definition of Œò(œÉ), there ex-
ists some Œ∏ ‚àà (0, Œ∏i (aj )) and some (k, `) such that Vk (a` , œÉi (aj ), Œ∏) > Vk? (a` ). Using the definition of
Vk (a, œÉ, Œ∏), we obtain that

                                                                                               Œ∏ (a )
                           œÄkm Vm? (a` ) + Œ±(Œ∏) [Vk? (a` + qi (aj )) ‚àí pqi (aj )] ‚àí Œ≥Œ∏ Œ±(Œ∏) i j
                  P
   uk (a` ) + Œ¥      m‚ààI                                                                Œ∏ Œ±(Œ∏i (aj ))
                                                                                                        > Vk? (a` ).
                                                    r + Œ¥ + Œ±(Œ∏)

Since Œ±(Œ∏)/Œ∏ is decreasing, it follows that the above inequality remains strict when we subtract Œ≥Œ∏ instead
            Œ∏ (a )
of Œ≥Œ∏ Œ±(Œ∏) i j                                  ?
       Œ∏ Œ±[Œ∏i (aj )] , which contradicts that Vk (a) solves the auxiliary Bellman equation (51).
    Finally, we verify the zero-profit conditions of dealers. Suppose there is œÉ = (q, œÜ) such that ‚àíŒ≥ +
Œ±[Œò(œÉ)]
 Œò(œÉ) œÜ > 0. Then Œò(œÉ) < ‚àû and there is some type (i, aj ) and some tightness Œ∏ such that Vi (aj , œÉ, Œ∏) >
Vi? (aj ) and ‚àíŒ≥ + Œ±(Œ∏)                                                                             Œ±(Œ∏)
                    Œ∏ œÜ > 0. Consider then the contract œÉÃÇ, with qÃÇ = q and œÜÃÇ chosen such that Œ≥ = Œ∏ œÜÃÇ.
Because œÜÃÇ < œÜ, we have that Vi (aj , œÉÃÇ, Œ∏) > Vi? (aj ), which can be written

                                        œÄik Vk? (ak ) + Œ±(Œ∏) [Vi? (aj + qÃÇ) ‚àí pqÃÇ] ‚àí Œ≥Œ∏
                                    P
                     ui (aj ) + Œ¥
                                                                                        > Vi? (aj ),
                                                 r + Œ¥ + Œ±(Œ∏)

contradicting that Vi? (a) solves the Bellman equation (51).


A.3      Market clearing in the inter-dealer market
In this section, we confirm that the equilibrium conditions described in Definition 1 ensure that the inter-
dealer market clears, i.e., that
                                             X
                                                    Œ± [Œ∏i (aj )] ni (aj )(ai ‚àí aj ) = 0.                               (55)
                                              i,j




                                                                  43
To start, summing across all i ‚àà I and j 6= i, we can use (8) to get
                                                                                  "                                 #
                      XX                                        XX                    X
                                 Œ± [Œ∏i (aj )] ni (aj )aj = Œ¥                 aj             œÄki nk (aj ) ‚àí ni (aj ) .                   (56)
                      i‚ààI j6=i                                    i‚ààI j6=i            k‚ààI


Adopting the convention that Œ∏i (ai ) = 0, the left-hand side of (56) is equal to
                                                     X
                                                           Œ± [Œ∏i (aj )] ni (aj )aj .                                                    (57)
                                                     i,j


Meanwhile, the right-hand side of (56) can be written
                                                                                            ( "                               #)
                XX                       X               XX                           X            X
            Œ¥               nk (aj )aj         œÄki ‚àí Œ¥             ni (aj )aj ‚àí                Œ¥         nk (ai )œÄki ‚àí ni (ai )    ai
                k‚ààI j‚ààI                  i‚ààI             i‚ààI j‚ààI                      i‚ààI          k‚ààI
                      ( "                                    #)
                X            X
        = ‚àí             Œ¥           nk (ai )œÄki ‚àí ni (ai )         ai                                                                   (58)
                i‚ààI           k‚ààI
            X
        =          Œ± [Œ∏i (aj )] ni (aj )ai ,                                                                                            (59)
             i,j

                                                 P
where the first equality follows from              i œÄki   = 1, while the second equality follows from (9). Hence, (57)
is equal to (59), which ensures that (55) is satisfied.


A.4     Proof of Lemma 1
Let, for i ‚àà {`, h}, Œ∏i (0) ‚â° arg maxŒ∏ {Œ±(Œ∏) (‚àÜVi ‚àí p) ‚àí Œ≥Œ∏} and Œ∏i (1) ‚â° arg maxŒ∏ {Œ±(Œ∏) (p ‚àí ‚àÜVi ) ‚àí Œ≥Œ∏}.
We obtain the inequalities:

  r‚àÜVh ‚â• uh + Œ¥œÄ` (‚àÜV` ‚àí ‚àÜVh ) + Œ±[Œ∏` (1)] (p ‚àí ‚àÜVh ) ‚àí Œ≥Œ∏` (1) ‚àí Œ±[Œ∏h (0)] (‚àÜVh ‚àí p) ‚àí Œ≥Œ∏h (0)
  r‚àÜV` ‚â§ u` + Œ¥œÄh (‚àÜVh ‚àí ‚àÜV` ) + Œ±[Œ∏` (1)] (p ‚àí ‚àÜV` ) ‚àí Œ≥Œ∏` (1) ‚àí Œ±[Œ∏h (0)] (‚àÜV` ‚àí p) ‚àí Œ≥Œ∏h (0).

Taking the difference between the two, all the search costs cancel out and we obtain

                                                               uh ‚àí u`
                                 ‚àÜVh ‚àí ‚àÜV` ‚â•                                         > 0,
                                                     r + Œ¥ + Œ± [Œ∏h (0)] + Œ± [Œ∏` (1)]

which establishes the first part of the claim.
    For the second part, assume toward a contradiction that p ‚â• ‚àÜVh , so that p > ‚àÜV` . Then, it must be the
case that Œ∏h (1) ‚â• 0, Œ∏` (1) > 0, and Œ∏h (0) = Œ∏` (0) = 0. The inflow-outflow equations for nh (1) and n` (1)




                                                                    44
become

                                  Œ¥œÄh n` (1) = Œ¥œÄ` nh (1) + Œ±[Œ∏h (1)]nh (1)
                                  Œ¥œÄ` nh (1) = Œ¥œÄh n` (1) + Œ±[Œ∏` (1)]n` (1),

implying, after some manipulations, that

                                   Œ¥œÄ`             Œ¥œÄh
                                                              n` (1) = n` (1),
                              Œ¥œÄ` + Œ±[Œ∏h (1)] Œ¥œÄh + Œ±[Œ∏` (1)]

so that n` (1) = nh (1) = 0. Thus, the market cannot clear, which is a contradiction. Symmetrically, if
p ‚â§ ‚àÜV` , one finds that n` (0) = nh (0) = 0 so that n` (1) + nh (1) = 1 > A, which also contradicts market
clearing.


A.5      Proof of Lemma 2
                                                                                                h           i
The function F (S` ) is defined over [0, Œì‚àí1 (uh ‚àí u` )] and the function G(S` ) is defined over 0, uhŒ¥œÄ‚àírp
                                                                                                         `
                                                                                                              .
Both functions are zero at the upper bound of their domain. Thus, solving the system of equations (15)-(16)
boils down to solving the one-equation-in-one-unknown problem F (S` ) = G(S` ). We have shown in the
text that, if a solution exists, then the function F (S` ) must cross the function G(S` ) from above. Therefore,
for a strictly positive solution to exist, it is necessary and sufficient that F (S` ) is above G(S` ) at zero, and
is eventually below G(S` ) for S` large enough in the intersection of their domains. The first condition can
be written

                     F (0) > G(0) ‚áê‚áí Œì[F (0)] > uh ‚àí rp and Œì[F (0)] = uh ‚àí u`
                                      ‚áê‚áí Œ¥œÄh F (0) < rp ‚àí u` and Œì[F (0)] = uh ‚àí u`
                                                                
                                                         rp ‚àí u`
                                      ‚áê‚áí uh ‚àí u` < Œì
                                                           Œ¥œÄh
                                                                           
                                                                   rp` ‚àí u`
                                      ‚áê‚áí p > p` s.t. uh ‚àí u` = Œì              .                               (60)
                                                                     Œ¥œÄh

The equivalence on the first line follows from the fact that, in equation (18), the function Œì(S) is strictly
increasing. The equivalence on the second line follows from simple manipulations, using the definition of
Œì(S). The equivalence on the third and fourth lines follow from the fact that Œì(S) is strictly increasing in
S. One sees easily using equations (15)-(16) that the price p` is such that S` = 0: in other words, it is the
lowest price at which a low-valuation investor is willing to sell his asset, knowing that he‚Äôll be able to buy
at this price later when he‚Äôll turn into a high type.
    Next we note that, by definition, F (S` ) and G(S` ) are zero at the upper bound of their respective
domains. Thus, in order for G(S` ) to be below F (S` ) for S` large enough in the intersection of their
domains, it is necessary and sufficient that the upper bound of the domain of G(S` ) is below the upper


                                                        45
bound of the domain of F (S` ). This can be written as
                                                                                   
                                     uh ‚àí rp                              uh ‚àí rp
                 Œì‚àí1 (uh ‚àí u` ) >               ‚áê‚áí uh ‚àí u` > Œì
                                       Œ¥œÄ`                                  Œ¥œÄ`
                                                                                                  
                                                                                        uh ‚àí rph
                                                ‚áê‚áí p < ph s.t. uh ‚àí u` = Œì                             .        (61)
                                                                                           Œ¥œÄ`

As before, one sees easily that the price ph is such that Sh = 0: it is the highest price at which a high type
is willing to buy.
    Finally, we observe that p` < ph . Indeed, from their definitions we have that:

                        uh ‚àí rph   rp` ‚àí u`
                                 =          ‚áí rph œÄh + rp` œÄ` = œÄh uh + œÄ` u` .
                           Œ¥œÄ`       Œ¥œÄh

It thus follows that

                       ph > p` > 0 ‚áê‚áí rœÄ` (ph ‚àí p` ) > 0 ‚áê‚áí rph > œÄh uh + œÄ` u`
                                                             
                                           uh ‚àí œÄh uh ‚àí œÄ` u`
                                   ‚áê‚áí Œì                         > uh ‚àí u`
                                                  Œ¥œÄ`
                                                  
                                           uh ‚àí u`
                                   ‚áê‚áí Œì               > uh ‚àí u` .
                                              Œ¥

One easily verifies that Œì(S/Œ¥) > S, so this inequality holds.


A.6     Proof of Proposition 3
The only thing to show is that the buy-order flow, on the left-hand side of (25), is strictly decreasing in the
price, and that the sell-order flow, on the right-hand side of (25), is strictly increasing in the price. For this we
first note that, since Œ±(Œ∏) is increasing, it follows that the left-hand side is an increasing function of Œ∏h and
the right-hand side is a decreasing function of Œ∏` . Now the first-order condition Œ±0 (Œ∏h )Sh = Œ≥ implies that
Œ∏h is an increasing function of Sh , and thus a decreasing function of p, with Œ∏h = 0 when p = ph . Likewise,
the first-order condition for Œ∏` implies that Œ∏` is an increasing function of S` and thus an increasing function
of p with Œ∏` = 0 when p = p` .


A.7     Proof of Proposition 4
Asymptotic expansion for the price. Let si ‚â° ŒªSi for i ‚àà {`, h}. With this notation, the surplus
equation (17) can be written as

                             r+Œ¥                r+Œ¥
                                 sh + f (sh ) +     s` + f (s` ) = uh ‚àí u` ,
                              Œª                  Œª




                                                         46
where f (s) ‚â° maxŒ∏ {Œ±(Œ∏)s ‚àí Œ≥Œ∏}. Note that f (s) is strictly increasing, with f (0) = 0 and f (‚àû) = ‚àû.
It thus follows that sh and s` are both bounded by the solution of f (s) = uh ‚àí u` . Therefore, as Œª goes
to infinity, (sh , s` ) must have at least one accumulation point, (s?h , s?` ). Since œÄh > A, it follows from the
market-clearing condition that Œ∏h < Œ∏` and so from the first-order condition that sh < s` . Thus s?h ‚â§ s?` .
Suppose that s?h > 0. Then the market tightness solving Œ±0 (Œ∏)s?h = Œ≥ is strictly positive, and going to the
Œª ‚Üí ‚àû limit in the market-clearing condition leads to œÄh = A, which contradicts our assumption that
œÄh > A. Therefore s?h and s?` satisfy

                                                           s?h = 0
                                                      f (s?` ) = uh ‚àí u` .

Thus, (sh , s` ) has a unique accumulation point, which must be its limit. To obtain a first-order approximation
for p we use the second equation (18) to get that

                             r + Œ¥œÄ`                                 s`
                                      sh + f (sh ) = uh ‚àí rp ‚àí Œ¥œÄ` .                                    (62)
                                 Œª                                    Œª

Since sh ‚Üí 0 as Œª ‚Üí ‚àû, the first term on the left-hand side is o Œª1 . To analyze the second term, note from
                                                                   

the market-clearing condition that ŒªŒ±(Œ∏h ) must have a positive limit, equating order flows when sellers can
contact the market infinitely fast. Letting this limit be Œªh we can write
                                                                    
                                       Œªh          1           ‚àí1 Œªh     1
                             f (sh ) =    +o           sh ‚àí Œ≥Œ±       +o      .
                                       Œª           Œª               Œª     Œª

                                                  1
                                                          since sh ‚Üí 0 when Œª ‚Üí ‚àû. Because Œ±‚àí1 (x) is convex, the
                                                      
The first term on the left-hand side is o         Œª
second term can be bounded by
                                                                     
                        ‚àí1       Œªh       1       Œªh     1    ‚àí1 0 Œªh       1
                    Œ±               +o        ‚â§      +o       Œ±           +o
                                 Œª        Œª       Œª      Œª            Œª       Œª
                                                        
                                                  Œªh     1              1
                                              =      +o               h         i .
                                                  Œª      Œª              Œª
                                                             Œ±0 ‚ó¶ Œ±‚àí1 h + o 1       Œª               Œª


Clearly, because of the Inada condition Œ±0 (0) = ‚àû, the upper bound is o                1
                                                                                            
                                                                                        Œª       . We conclude that f (sh ) is
                                  s?
o Œª1 . Finally,we note that sŒª` = Œª` + o Œª1 .
                                          


Asymptotic expansion of the intermediation fee. Consider first the intermediation fee for a seller:

                                                 Œ∏` Œ±0 (Œ∏` )      Œ∏? Œ±0 (Œ∏? )
                                         ŒªœÜ` =               ŒªS` ‚Üí ` ? ` s?` ,
                                                  Œ±(Œ∏` )           Œ±(Œ∏` )




                                                                47
as claimed in the proposition. Let us turn next to the intermediation fee for buyers:

                                                   Œ∏h Œ±0 (Œ∏h )
                                          ŒªœÜh =                ŒªSh ‚Üí 0
                                                    Œ±(Œ∏h )

since the elasticity is bounded above by one and limŒª‚Üí‚àû ŒªSh = 0.


Asymptotic expansion of the distribution of types. From equation (24), given that Œ∏` ‚Üí Œ∏`? , we
have that

                                                              AŒ¥œÄ`
                                             lim Œªn` (1) =
                                             Œª‚Üí‚àû              Œ±(Œ∏`? )

as claimed. To obtain an asymptotic expansion of nh (0), plug the equality of order flows, (20), into the
equation for nh (0), (23). In doing so, keep in mind that, for the asymptotic expansion, all the Œ±(Œ∏) are
multiplied by the search efficiency parameter Œª. We then obtain

              Œ¥œÄh (1 ‚àí A)
  nh (0) =        ŒªŒ±(Œ∏` )n` (1)
                                  ‚áê‚áí Œ¥nh (0) + ŒªŒ±(Œ∏` )n` (1) = (1 ‚àí A)Œ¥œÄh
             Œ¥+     nh (0)
                                  ‚áê‚áí Œ¥ [nh (0) ‚àí (œÄh ‚àí A)] = ‚àíŒªŒ±(Œ∏` )n` (1) + (1 ‚àí A)Œ¥œÄh ‚àí Œ¥(œÄh ‚àí A)
                                                                                  
                                                            Œ¥AœÄ`      Œ¥AœÄ`         1
                                  ‚áê‚áí nh (0) ‚àí (œÄh ‚àí A) =           =      ?  +o       ,
                                                           ŒªŒ±(Œ∏` )   ŒªŒ±(Œ∏` )      Œª

where the last line follows after substituting in expression (24) for n` (1). This establishes the claim.


A.8     Proof of Corollary 1
With a Cobb-Douglas matching function, the asymptotic seller surplus, s?` , and the asymptotic search inten-
sity, Œ∏`? , solve the system of equations:

                                             Œ∏Œ∑ s ‚àí Œ≥Œ∏ = uh ‚àí u`
                                               Œ∑Œ∏Œ∑‚àí1 s = Œ≥.

    The second equation implies that Œ∑Œ∏Œ∑ s?` = Œ≥Œ∏. Together with the first equation, this implies that (1 ‚àí
Œ∑)Œ∏Œ∑ s = uh ‚àí u` . Dividing through by the second equation, the ‚Äús‚Äù cancel out and we obtain the expression
for Œ∏`? . The expression for s?` follows. Clearly, Œ∏`? is increasing in Œ∑. As for s?` we have:

                                                              d log(s?` )
                                                                                         
                              Œ≥                  uh ‚àí u`                           Œ≥(1 ‚àí Œ∑)
        log (s?` ) = Œ∑ log       + (1 ‚àí Œ∑) log             =‚áí             = log                 ,
                              Œ∑                   1‚àíŒ∑             dŒ∑              Œ∑(uh ‚àí u` )

which is strictly decreasing, goes to plus infinity when Œ∑ ‚Üí 0 and to minus infinity when Œ∑ ‚Üí 1.




                                                         48
A.9     Proof of Proposition 5
Let‚Äôs denote œëi (a) the current-value co-state variables associated with ni (a) and Œæ the Lagrange multiplier
associated with the balanced order flow constraint. The current-value Hamiltonian is

              H [Œ∏h , Œ∏` , ni (a), œëi (a), Œæ] = nh (1)uh + n` (1)u` ‚àí Œ∏h nh (0)Œ≥ ‚àí Œ∏` n` (1)Œ≥
                                               +œëh (1) {Œ±(Œ∏h )nh (0) + Œ¥œÄh n` (1) ‚àí Œ¥œÄ` nh (1)}
                                               +œëh (0) {Œ¥œÄh n` (0) ‚àí Œ¥œÄ` nh (0) ‚àí Œ±(Œ∏h )nh (0)}
                                               +œë` (1) {Œ¥œÄ` nh (1) ‚àí Œ¥œÄh n` (1) ‚àí Œ±(Œ∏` )n` (1)}
                                               +œë` (0) {Œ±(Œ∏` )n` (1) + Œ¥œÄ` nh (0) ‚àí Œ¥œÄh n` (0)}
                                               +Œæ {Œ±(Œ∏` )n` (1) ‚àí Œ±(Œ∏h )nh (0)} .

The first-order conditions for Œ∏h and Œ∏` are

                                    Œ±0 (Œ∏h ) [œëh (1) ‚àí œëh (0) ‚àí Œæ] = Œ≥                                    (63)
                                     Œ±0 (Œ∏` ) [œë` (0) ‚àí œë` (1) + Œæ] = Œ≥.                                  (64)

The social cost of assigning a dealer to the buy-side of the market corresponds to the entry cost, Œ≥, the right
side of (63). The social benefit, the left side of (63), is measured by the increase in the number of matches
generated by a dealer, Œ±0 (Œ∏h ), times the social gain from having an additional h-type investor holding an
asset, œëh (1) ‚àí œëh (0), net of the cost of tightening the balanced order flow constraint, Œæ. The ODEs for the
co-state variables are

            rœëh (1) = uh + Œ¥œÄ` [œë` (1) ‚àí œëh (1)] + œëÃáh (1).                                               (65)
            rœëh (0) = Œ±(Œ∏h ) [œëh (1) ‚àí œëh (0) ‚àí Œæ] ‚àí Œ∏h Œ≥ + Œ¥œÄ` [œë` (0) ‚àí œëh (0)] + œëÃáh (0)               (66)
             rœë` (1) = u` + Œ±(Œ∏` ) [œë` (0) ‚àí œë` (1) + Œæ] ‚àí Œ∏` Œ≥ + Œ¥œÄh [œëh (1) ‚àí œë` (1)] + œëÃá` (1)         (67)
             rœë` (0) = Œ¥œÄh [œëh (0) ‚àí œë` (0)] + œëÃá` (0).                                                   (68)

The equations, (65)-(68), admit a standard interpretation as asset pricing conditions for the shadow values
of the state variables.
    It is easy to check that the planner‚Äôs optimality conditions coincide with the conditions for a competitive
search equilibrium when œëi (a) = Vi (a) and Œæ = p. Using that the maximized Hamiltonian is linear
in the state variables, ni (a), the equilibrium path satisfies necessary and sufficient conditions (see Arrow
sufficiency theorem) for a constrained-optimal allocation.




                                                      49
A.10      Proof of Corollary 2
We indicate all equilibrium objects by a subscript o (for opaque). The free-entry conditions for dealers are

                                    Œ±(Œ∏ho )
                                            ŒΩ [Vho (1) ‚àí Vho (0) ‚àí po ] = Œ≥                                          (69)
                                     Œ∏ho
                                    Œ±(Œ∏`o )
                                            ŒΩ [V`o (0) ‚àí V`o (1) + po ] = Œ≥.                                         (70)
                                     Œ∏`o

The left sides of (69) and (70) are the expected flow profits of dealers: a dealer receives an order to execute
with Poisson arrival rate Œ±(Œ∏io )/Œ∏io , in which case he is paid an intermediation fee equal to a fraction ŒΩ of the
match surplus as measured by Vho (1) ‚àí Vho (0) ‚àí po if the investor is a buyer and V`o (0) ‚àí V`o (1) + po if the
investor is a seller. The investors‚Äô value functions in a steady state solve the following Bellman equations:

               rVho (1) = uh + Œ¥œÄ` [V`o (1) ‚àí Vho (1)]                                                               (71)
               rVho (0)   =   Œ±(Œ∏ho )(1   ‚àí   ŒΩ) [Vho (1)   ‚àí   Vho (0)     o
                                                                          ‚àíp ]+   Œ¥œÄ` [V`o (0)   ‚àí   Vho (0)]        (72)
               rV`o (1)   = u` +    Œ±(Œ∏`o )(1    ‚àí ŒΩ) [V` (0) ‚àí V` (1) + p ] +  o
                                                                                      Œ¥œÄh [Vho (1)    ‚àí   V`o (1)]   (73)
               rV`o (0) = Œ¥œÄh [Vho (0) ‚àí V`o (0)] .                                                                  (74)

In (71) and (74) investors hold their desired portfolio and hence the only transition that can happen is when
a preference shock hits with arrival rate Œ¥œÄi . In contrast, in (72) and (73) investors are able rebalance their
portfolio with Poisson arrival rate Œ±(Œ∏io ), in which case they enjoy a fraction 1 ‚àí ŒΩ of the surplus of a match
with a dealer. The result follows by comparing the equilibrium conditions, (69)-(70) and (71)-(74), with the
conditions for a constrained-efficient allocation, (63)-(64) and (65)-(68).


A.11      Formal proofs of the statements in Section 4.2
In this section we characterize an equilibrium for the economy described in Section 4.2, when the posting
cost, Œ≥, is small.


Equilibrium price. We guess and verify that, in this case, the equilibrium price in LR is an equilibrium
price in our environment as well.
    Let Vi? (a, Œ≥) be the solution of the Bellman equation (7) when the contract posting cost is Œ≥ and the
price is equal to the equilibrium price in LR. By an application of the contraction mapping theorem, this
function is continuous in (a, Œ≥). In particular, Vi? (a, 0) coincides with the value function in LR. We know
the following result from their paper.

Lemma 5. In LR, the value net of purchasing cost, Vi? (a, 0)‚àípa, is an increasing and affine transformation




                                                                50
of
                                                            P
                                        (r + ¬µ)ui (a) + Œ¥     j‚ààI   œÄj uj (a)
                             Ki (a) =                                           ‚àí rpa.                          (75)
                                                   r+¬µ+Œ¥

     Note that Ki (a) is strictly concave and it achieves its unique maximum at the asset holding prevailing
in LR‚Äôs equilibrium.
                                                                                 
                                         ? 0             0  Œ≥2     ?
                Ni (Œ≥1 , Œ≥2 ) ‚â° a : max  Vi (a , Œ≥1 ) ‚àí pa ‚àí    < Vi (a, Œ≥1 ) ‚àí pa .
                                     a0                      ¬µ

Lemma 6. The inaction regions Ni (Œ≥, Œ≥) are disjoint for all Œ≥ small enough.

Proof. Note that LR‚Äôs net values, Vi? (a, 0) ‚àí pa, are strictly concave so that the inaction regions Ni (0, Œ≥2 )
are open intervals around the optimal asset holding, arg maxa0 Vi? (a0 , 0) ‚àí pa0 , shrinking monotonically
to LR‚Äôs optimal asset holding when Œ≥2 ‚Üí 0. Consider then some Œ≥2 and Œµ small enough so that all the
Ni (0, Œ≥2 + ¬µŒµ) are disjoint. Noting that maxa0 {Vi? (a0 , Œ≥) ‚àí pa0 } ‚àí Vi? (a, Œ≥) + pa is continuous in (a, Œ≥),
there exists some Œ≥1 such that for all Œ≥10 ‚â§ Œ≥1 and all a ‚àà [a, a]:
           ? 0 0            0              0
                                                            ? 0
      max
       0
           Vi (a , Œ≥1 ) ‚àí pa   ‚àí V i
                                    ?
                                      (a, Œ≥1  ) + pa > max
                                                        0
                                                            Vi (a , 0) ‚àí pa0 ‚àí Vi? (a, 0) + pa ‚àí Œµ.
       a                                                  a


                     / Ni (0, Œ≥2 + ¬µŒµ), we have maxa0 {Vi? (a0 , 0) ‚àí pa0 } ‚àí Œ≥¬µ2 ‚àí Œµ ‚â§ Vi? (a, 0) ‚àí pa. Plugging
In particular, for a ‚àà
this into the right-hand side of the above inequality and rearranging, we obtain

                                          0 0          0   Œ≥2
                                                              ‚â• Vi (a, Œ≥ 0 ) ‚àí pa.
                                  
                              max   V i (a , Œ≥1 ) ‚àí pa   ‚àí
                               a0                          ¬µ

         / Ni (Œ≥10 , Œ≥2 ). By contrapositive, for all Œ≥10 ‚â§ Œ≥1 , we have that Ni (Œ≥10 , Œ≥2 ) ‚äÜ Ni (0, Œ≥2 + ¬µŒµ). Since
Hence, a ‚àà
the sets Ni (0, Œ≥2 + ¬µŒµ) are disjoint by construction, and since the sets Ni (Œ≥10 , Œ≥20 ) are decreasing in Œ≥20 , it
follows that Ni (Œ≥10 , Œ≥20 ) are disjoint for all Œ≥10 ‚â§ Œ≥1 and Œ≥20 ‚â§ Œ≥2 . Letting Œ≥ = min{Œ≥1 , Œ≥2 } we obtain that
the sets Ni (Œ≥, Œ≥) are disjoint for all Œ≥ 0 ‚â§ Œ≥.                                                                  

     Next, following the argument in the text, we find that when Œ≥ is small enough, the net value Vi (a) ‚àí pa
is an increasing affine transformation of Ki (a). Since the optimal asset holding must belong to the interior
of the inaction region, it must satisfy Ki0 (a) = 0, which implies in turn that it must coincide with LR‚Äôs
optimal asset holdings. Since the distribution of type must also coincide with that of LR, which satisfies
market clearing by construction, it follows that LR‚Äôs price is an equilibrium price in our economy as long as
Œ≥ is small enough.


Constructing a competitive search equilibrium. The last thing to do is to verify that the LR price,
which we already know clears the market, is the basis of a competitive search equilibrium. We note that, for
Œ≥ small enough, there are always strict gains from trade when i 6= j and so Œ∏i (aj ) = 1. The equilibrium


                                                         51
objects are then defined in a manner similar to the paragraph following Proposition 3:

                                                                    Œ≥
                             qi (aj ) = ai ‚àí aj ,     œÜi (aj ) =      , and     Œ∏i (aj ) = 1.
                                                                    ¬µ

We let
                                          Vi? (a) = max Vi [a, œÉk (a` ), Œ∏k (a` )] .
                                                       k,`

We will adopt a slightly different definition for market tightness:

         Œò (œÉ) = inf {Œ∏ ‚â• 0 : Vi (a, œÉ, Œ∏) ‚â• Vi? (a) and Vi? (a) > Vi (a, 0, 0) for some i ‚àà I} .

In the case when Œ±(Œ∏) is strictly increasing and strictly concave, this definition is equivalent to the one we
used before. It is stronger in the present Leontief case.
    We proceed to verify that these candidate equilibrium objects form a competitive search equilibrium.
We first show that Œò[œÉi (aj )] = Œ∏i (aj ). First, we note that there are strict gains from trade in LR so, by the
continuity arguments already used above, there must be strict gains from trade in our setup when Œ≥ is small
enough. That is,

                                       Vi (aj , œÉi (aj ), Œ∏i (aj )) > Vi (aj , 0, 0).

Given that Vi (aj , œÉi (aj ), Œ∏i (aj )) = Vi? (aj ), the definition of Œò(œÉ) implies that Œò [œÉi (aj )] ‚â§ Œ∏i (aj ). Sup-
pose, toward a contradiction, that the inequality is strict. Then, by definition of Œò(œÉ), there exists some Œ∏ ‚àà
(0, Œ∏i (aj )) and some (k, `) such that Vk (a` , œÉi (aj ), Œ∏) ‚â• Vk? (a` ) > Vi (a` , 0, 0). Since Vk (a` , œÉi (aj ), Œ∏) >
Vi (a` , 0, 0), one sees easily that Œ∏ 7‚Üí Vk (a` , œÉi (aj ), Œ∏) is strictly increasing in Œ∏ ‚àà (0, Œ∏i (aj )). This im-
plies that Vk (a` , œÉi (aj ), Œ∏i (aj )) > Vk? (a` ), which is a contradiction since Vk? (a` ) is the maximum attainable
utility for this investor.
    Finally, we verify the zero-profit conditions of dealers. For this, we first note that, in the Leontief case,
the alternative representation of Proposition 1 continues to hold (one can verify that proof goes through
almost identically), and so Vi? (aj ) solves the Bellman equation (51). Now suppose that there is œÉ = (q, œÜ)
                    Œ±[Œò(œÉ)]
such that ‚àíŒ≥ +       Œò(œÉ) œÜ > 0. Then Œò(œÉ) < ‚àû and there is some type (i, aj ) and some tightness Œ∏ such
that Vi (aj , œÉ, Œ∏) ‚â• Vi? (aj ) > Vi (a, 0, 0) and ‚àíŒ≥ + Œ±(Œ∏)
                                                         Œ∏ œÜ > 0. Consider then the contract œÉÃÇ, with qÃÇ = q and
                            Œ±(Œ∏)
œÜÃÇ chosen such that Œ≥ = Œ∏ œÜÃÇ. Because œÜÃÇ < œÜ, we have that Vi (aj , œÉÃÇ, Œ∏) > Vi? (aj ), which can be written

                                      œÄik Vk? (ak ) + Œ±(Œ∏) [Vi? (aj + qÃÇ) ‚àí pqÃÇ] ‚àí Œ≥Œ∏
                                  P
                   ui (aj ) + Œ¥
                                                                                      > Vi? (aj ),
                                               r + Œ¥ + Œ±(Œ∏)

contradicting that Vi? (aj ) solves the Bellman equation (51).




                                                               52
