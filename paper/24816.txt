EMPIRICAL PROPERTIES OF DIVERSION RATIOS

Christopher T. Conlon
Julie Holland Mortimer
WORKING PAPER 24816

NBER WORKING PAPER SERIES

EMPIRICAL PROPERTIES OF DIVERSION RATIOS
Christopher T. Conlon
Julie Holland Mortimer
Working Paper 24816
http://www.nber.org/papers/w24816

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
July 2018, Revised September 2020

A pre-cursor to this paper was circulated under the title "An Experimental Approach to Merger
Analysis." We thank Joe Farrell, Phil Haile, Dennis Carlton, Ken Hendricks, Fiona Scott Morton,
Aviv Nevo, Bill Rogerson, Ralph Winter, Dan O'Brien, and seminar participants at: Charles
River Associates, Columbia University, the Department of Justice, NYU Stern, the University of
Western Ontario, the University of Mannheim, the Bates White Antitrust Conference, the
Behavioral Game Theory Workshop, the FTC Microeconomics Conference, 'I.O. Fest' at UC
Berkeley, the Dartmouth Winter IO Conference, the NBER Summer Institute, the Penn State Cornell Econometrics and IO Conference, and the antitrust conference at the University of British
Columbia, for comments. Chitra Marti provided exceptional research assistance. Special thanks
to Jeff Gortmaker for custom updates to PyBLP. Any remaining errors are our own. Financial
support for this research was generously provided through NSF grant SES-0617896. The views
expressed herein are those of the authors and do not necessarily reflect the views of the National
Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
¬© 2018 by Christopher T. Conlon and Julie Holland Mortimer. All rights reserved. Short sections
of text, not to exceed two paragraphs, may be quoted without explicit permission provided that
full credit, including ¬© notice, is given to the source.

Empirical Properties of Diversion Ratios
Christopher T. Conlon and Julie Holland Mortimer
NBER Working Paper No. 24816
July 2018, Revised September 2020
JEL No. L0,L1,L4
ABSTRACT
The diversion ratio for products j and k can be interpreted as the result of an experiment: increase
the price of product j, measure the number of consumers who leave product j, and then measure
the fraction of leavers who switch to a substitute product k. In theory, this is expressed as the
ratio of demand derivatives that enter the multi-product Bertrand-Nash first-order condition for a
firm. In practice, diversion ratios are also measured from second-choice data or customer
switching surveys. We establish a LATE interpretation of diversion ratios, and show how
diversion ratios can be obtained from different interventions (price changes, quality changes,
assortment changes) and how those different measures relate to one another and to the underlying
properties of demand.

Christopher T. Conlon
Department of Economics
New York University
Stern School of Business
Henry Kaufman Management Center
44 W. Fourth St
New York, NY 10012
cconlon@stern.nyu.edu
Julie Holland Mortimer
Department of Economics
Boston College
140 Commonwealth Avenue
Chestnut Hill, MA 02467
and NBER
julie.mortimer.2@bc.edu

1. Introduction
The diversion ratio is one of the best ways economists have for understanding the nature of
competition between sellers. As the price of j increases, some consumers reduce purchases
‚àÇq
k
of j: ‚àÇpjj , and a subset switch to a substitute product k: ‚àÇq
. The diversion ratio is defined
‚àÇpj
‚àÇq

k
as the ratio of these two demand derivatives Djk = ‚àÇq
/ ‚àÇpjj . Diversion ratios are useful
‚àÇpj
because they arise in the first-order conditions for Nash-in-prices games when sellers offer
differentiated products. Two products with a high degree of differentiation face lower diversion and softer price competition, whereas two products with a high degree of similarity to
competing goods face higher diversion and potentially tougher price competition.
Not surprisingly, diversion ratios are a central calculation of interest to antitrust authorities for analyzing horizontal mergers. The current U.S. merger guidelines, released in 2010,
place greater weight on diversion ratios relative to concentration measures more commonly
used to understand competition in settings with homogeneous goods (e.g., the HerfindahlHirschman Index (HHI)).1 In the context of merger reviews, antitrust authorities identify
the concept of ‚Äòunilateral effects‚Äô as being important for understanding the impact of a proposed merger. Unilateral effects of a merger arise when competition between the products
of the merged firm is reduced because the merged firm internalizes substitution between its
jointly-owned products.2 This can lead to an increase in the price of the products of the
merged firm, potentially harming consumers. Diversion ratios are the key statistic of interest
for measuring unilateral effects. The current U.S. merger guidelines, released in 2010, note:

Diversion ratios between products sold by one merging firm and products sold
by the other merging firm can be very informative for assessing unilateral price
effects, with higher diversion ratios indicating a greater likelihood of such effects.
Thus, holding competitive responses (and price-cost margins) fixed, antitrust agencies will
be more concerned about mergers that involve products with higher diversion ratios, because
the scope for price increases due to unilateral effects is thought to be greater.
Although the use of diversion ratios in antitrust policy is well understood theoretically, in
practice, one needs to estimate diversion ratios. The U.S. merger guidelines discuss diversion
1

Researchers have pointed out a number of concerns with using concentration measures or other functions
of market share to capture the strength of competition. One concern is that such measures require one
to define a market; another is that they do not capture the closeness of competition when products are
differentiated, as most products are thought to be.
2
In contrast, the concept of harm via ‚Äòcoordinated effects‚Äô arises if a proposed merger increases the
probability that firms in the industry will be able to successfully coordinate their behavior in an anticompetitive way.

1

ratios as being calculated from an estimated demand system, or observed from consumer
survey data or in a firm‚Äôs course of business. We demonstrate that there is no single measure
of diversion, just as there is no single measure of elasticity. Estimates of both diversion and
elasticity depend on where one evaluates the demand curve. We provide a treatment effects
framework for interpreting different estimates of diversion. For a broad class of discrete
choice models (including both random and deterministic utility), an individual is considered
‚Äútreated‚Äù if they choose not to purchase a particular product j, and the outcome of interest
is whether they choose to purchase the substitute product k. This lets us construct an
alternate definition of diversion ratios as the fraction of treated individuals who choose the
substitute.
We then show how a wide variety of results from the treatment effects literature can
be applied to interpret diversion ratios. Our main theoretical result derives the so-called
LATE Theorem of Imbens and Angrist (1994) in our discrete-choice diversion ratio setting.
We show that a ceteris paribus change in the price of good j identifies a local average of
diversion ratios among a group of ‚Äúcompliers‚Äù or individuals who used to purchase good
j at the original price but no longer do so at the higher price. We then apply several
related results from the LATE toolkit. First, we show that while diversion ratios are defined
in terms of small price price changes, any product characteristic satisfying a monotonicity
requirement can be used to construct an estimate of a diversion ratio. This makes it possible
to identify and estimate diversion ratios in environments where quality (or distance from
the consumer, etc.) varies but prices do not. Second, we show that second-choice data
pertains to a different treatment effect parameter where all individuals who were previously
untreated receive treatment (not purchasing j). This is particularly relevant because it shows
how diversion ratios are related to out of stock events (Conlon and Mortimer, 2013) and the
second-choice survey data already being used by antitrust authorities. A 2017 commentary
on retail mergers released by the UK Competition and Markets Authority (CMA) describes
their use of diversion ratios for screening and analyzing mergers, saying:
Diversion ratios can be calculated in a number of different ways, depending
on the information available in a particular case. In retail mergers, the CMA
has most often used the results of consumer surveys to calculate diversion ratios.
The diversion ratio attempts to capture what customers would do in response to
an increase in prices. However, it can be difficult to survey a sufficiently large
number of customers who would switch in response to a price rise to estimate a
robust diversion ratio. Therefore, the CMA asks customers what they would do
2

in response to the closure of a store (or stores).3
We further analyze diversion ratios using the marginal treatment effects (MTE) framework of Heckman and Vytlacil (2005). We are able to decompose average diversion ratios
into individual diversion ratios, which we show are policy invariant structural parameters,
and weights on individuals (which are independent of the substitute product k). We show
that the former no longer depend on whether prices, quality, or availability is modified, while
the latter do.
This decomposition has several useful applications. One (obvious) implication is that
average diversion ratios are bounded by the range of underlying individual diversion ratios.
A second implication is that assuming constant diversion ratios imposes strong parametric
restrictions on the nature of demand and utility. Only two models exhibit constant diversion:
linear demand, and the plain IIA logit model. Thus treating diversion ratios as constant is
akin to assuming that demand is well described by these models. The third implication is
that we can derive explicit formulas for these weights under the workhorse random coefficients
logit model. This allows us to to show precisely how second choice data, small price changes,
and changes in other product characteristics trace out different subpopulations, and how the
average diversion ratios measured with these interventions relate to one another. This allows
us in principle to answer questions like: ‚ÄúIf I am interested in the diversion ratio from a small
price change, how similar would second choice survey data be?‚Äù or ‚ÄúIf I only have diversion
ratios measured from short run variation in quality? how might this be informative about
what would happen if a product were removed from the market entirely?‚Äù.
We also show how diversion to the outside good Dj0 is closely related to our notion of
consumer welfare in random coefficients logit type models. We provide novel results linking
willingness-to-pay calculations that are commonplace in models of Nash-in-Nash bargaining
(and hospital mergers in particular) to the question: ‚Äúhow many consumers would switch to
the outside option if product j were no longer available?‚Äù. We show that for the logit class
of models these WTP calculations can be simplified even further as a function of individual
own-share sij , and a set of Pareto weights. This is what enables welfare analysis using WTP
calculations, even in settings lacking an outside option (as is common in hospital demand).
We highlight the properties laid out above using the well-known examples of the Berry
et al. (1999) automobile data and the Nevo (2000b) (fake) cereal data. Our empirical examples examine the role of diversion to best substitutes and to the outside good. We show
that capturing both kinds of diversion ratios is important, and can at times be tricky. We
3

See Competition and Markets Authority (2017).

3

also illustrate that different interventions (price changes, quality changes, product removals)
produce different weighting schemes over individual diversion ratios that can at times be
quite different. For example, in the BLP automobile data, second choice diversion understates substitution to the outside good when compared to small price changes by around
30%. Moreover, small changes in parametric specifications can lead to large changes in outside good diversion (as well as markups and welfare) even when own-price elasticities appear
stable. Other commonly employed shortcuts such as estimating a nested logit with all products in a single nest do a good job recovering the outside good diversion but predictably
understate substitution to the closest substitutes.
Taken in total, we recommend that both academic researchers and antitrust practitioners
pay careful attention to diversion to the outside good and to close substitutes, even when
estimating parametric models of demand. Furthermore, we urge researchers to be aware
that the diversion parameter of interest need not coincide with the parameter that is easily
estimated from readily available data (such as consumer switching surveys, etc.) though
these extra data sources when carefully incorporated may substantially improve parametric
demand models.

1.1. Related Literature
A second goal of the paper is to bring together two literatures ‚Äì the applied theoretical
literature that motivates the use of diversion for understanding merger impacts, and an
applied econometric literature that articulates estimation challenges in settings for which
the treatment effect of a policy can vary across individuals and may be measured with error.
By exploring the assumptions required for a credible (quasi)-experimental method of
measuring diversion, we connect directly to the theoretical literature discussing the use and
measurement of the diversion ratio.4 Farrell and Shapiro (2010) suggest that firms themselves
may track diversion in their ‚Äònormal course of business,‚Äô or that diversion ratios may be
uncovered in Hart-Scott-Rodino filings. Hausman (2010) argues that the only acceptable
way to measure a diversion ratio is as the output from a structural demand system. Reynolds
and Walters (2008) examine the use of stated-preference consumer surveys in the UK for
measuring diversion.
In spirit, our approach is similar to Angrist et al. (2000), which shows how a cost shock can
identify a particular local average treatment effect (LATE) for the price elasticity in a single
4

The focus on measuring substitution away from product j (using second-choice data or stock-outs),
rather than on the direct effect of a proposed merger, is more in line with the public finance literature on
sufficient statistics Chetty (2009).

4

product setting. That approach does not extend to a differentiated products setting because
the requisite monotonicity condition may no longer be satisfied. Our results demonstrate
how a ceteris paribus price change can identify substitution patterns in a multi-product
setting. We also highlight the economic content of (even partial) second-choice data, which
have been found to be valuable in the literature on structural demand estimation (e.g., Berry
et al. (2004)).
The paper proceeds as follows. Section 2 introduces the diversion ratio as an economic
object and compares its better known cousin the cross-price elasticity. We establish our
theoretical results linking diversion ratios to treatment effects in Section 3. We highlight the
theoretical properties of diversion ratios with empirical examples using the BLP auto data
and the Nevo (fake) cereal data in Section 4. Section 5 concludes.

2. What is a diversion ratio?
We begin by considering a Bertrand-Nash game where firm f sets the prices of products j ‚àà Jf in order to maximize profits. The firm faces marginal costs cj and demand
curve qj (p) (where p is the vector of prices for all goods) and chooses price pj to solve:
P
arg maxpf ‚ààJf œÄf (p) =
j‚ààJf (pj ‚àí cj ) ¬∑ qj (p). The best responses for each product j are
5
given by:


‚àÇqj
(p)
‚Üí pj = qj (p) ‚àí
‚àÇPj

‚àí1


‚àí1
‚àÇqk
‚àÇqj
+ cj +
(pk ‚àí ck )
(p) ‚àí
(p)
‚àÇPj
‚àÇPj
k‚ààJf \j
|
{z
}
X

Djk (p)

Ô£Æ
pj (p‚àíj ) =

Ô£π

X
1
Ô£∞cj +
(pk ‚àí ck ) ¬∑ Djk (p)Ô£ª .
1 + 1/jj (p)
k‚ààJf \j
|
{z
}

(1)

Markup

The best-response function in (1), shows the usual inverse elasticity jj (Lerner) markup
applied to the marginal cost of j. In multi-product pricing problems this term is augmented
P
by the opportunity cost of selling other products k‚ààJf \j (pk ‚àí ck ) ¬∑ Djk (p) where the opportunity cost depends on the fraction of consumers who leave j for the substitute k (diversion
ratio) and the price cost margins for k. One way to think about what a merger does is that it
raises the opportunity cost of selling j, by incorporating diversion (and price-cost margins)
5

It is common to write the denominator as the absolute value

demand slopes down

‚àÇqj
‚àÇPj

< 0.

5

‚àÇqj
‚àÇPj

‚àÇq

= ‚àí ‚àÇPjj these are equal so long as

to additional products. This is the central idea in Farrell and Shapiro (2010), and is the
reason that diversion features so heavily in the 2010 Horizontal Merger Guidelines.
There is some controversy about whether one should evaluate a merger by solving the
system of best responses defined by (1), as in Nevo (2000a), or by measuring how the merger
shifts the best-response for each product j in isolation.6 A common metric in the latter case
is Upward Pricing Pressure (UPP). This measures how the term in brackets from (1) changes
when f and g merge:
U P Pj = ‚àÜcj +
|{z}
efficiency

X
k‚ààJg

(pk ‚àí ck ) ¬∑ Djk (pj , p‚àíj )
|
{z
}

(2)

‚àÜopp cost

U P P trades off potential marginal cost reductions (efficiency gains) against the increased
opportunity cost that arises from diversion to additional products owned by firm g and
their respective price-cost margins. Only the sign of U P P is directly interpretable, as it
measures the effective change in marginal cost but not price.7 It is common in merger
analysis to compute the ‚Äúcompensating marginal cost reduction‚Äù or the value of ‚àÜcj which
sets U P Pj = 0 for each product j.
Whether one does full-merger simulation like Nevo (2000a) or simply looks at the U P P ,
Diversion ratios are a key feature in the first-order conditions of multi-product firms. In fact,
for any study of multi-product firm behavior, the diversion ratio is one of the most important
deliverables of any demand system. Later, in Section 3.8, we show how the the willingnessto-pay (WTP) measure of Town and Vistnes (2001); Capps et al. (2003), commonly used in
evaluating hospital mergers, and an input into Nash-in-Nash bargaining models (Crawford
and Yurukoglu, 2012) is related to diversion to the outside good. In related work, Katz and
Shapiro (2003) show that the ‚Äúaggregate diversion ratio‚Äù or total diversion to all products
except the outside option is related to the SSNIP and hypothetical monopolist tests that
antitrust authorities use to define relevant markets.
The remainder of the paper focuses on two key aspects of diversion ratios: (1) what
a ceteris paribus change in price or availability can tell us about diversion ratios; (2) what
restrictions are imposed on diversion ratios by parametric models of demand commonly used
6

See, for example, Hausman (2010), Carlton (2010), Schmalensee (2009), Willig (2011), Carlton and Israel
(2010), Gotts (2010), and Farrell and Shapiro (2010).
7
See, for example, Jaffe and Weyl (2013), which incorporates an estimated pass-through rate to map
anticipated opportunity cost effects of a merger into price effects. In related work, Miller et al. (2016) and
Cheung (2011) find that the price effects of a merger, and errors in predicting these effects, depend on the
nature of competition among non-merging firms, and whether prices are strategic substitutes or strategic
complements.

6

by researchers and practitioners.

2.1. How is diversion different from cross-price elasticity?
An important question is whether the diversion ratio actually contains different information
when compared to the more common measure of substitution, the cross-price elasticity.
‚àÇqk pj
and that the ratio of cross and
Recall that the cross price elasticity is defined as: jk = ‚àÇP
j qk
own price elasticities yields:

jk
jj

=

‚àÇqk
‚àÇPj
‚àÇqj
‚àÇPj

qj
qk

s

= ‚àíDjk skj . That is, the diversion ratio can simply

be written as the ratio of cross and own price elasticities multiplied by the respective ratio
in market shares.
Unlike own-price elasticities where there is a natural relationship between the value of the
elasticity and the market power of the firm (Lerner Markup), there is no such relationship
for cross-price elasticities. That is, the cross-price elasticity alone is insufficient to calculate
a compensating marginal cost reduction. Moreover, larger cross-price elasticities may not
even signify closer substitutes. Consider two substitutes: the first has a cross elasticity with
j of jk = 0.03 and sk = 0.1 while the second has a cross-price elasticity of jk0 = 0.01 and
sj = 0.35. More consumers switch to k 0 than to k, even though k has a larger cross-price
elasticity. In order to adjust this calculation, one must incorporate the shares (and implicitly
calculate the diversion ratio).
Perhaps the most important difference is that there may be cases where the diversion ratio
‚àÇqk ‚àÇqj
,
or jk , jj are not separately identified. Indeed,
is identified, but the constituent parts ‚àÇP
j ‚àÇPj
we highlight several hypothetical experiments where the diversion ratio (or some average of
diversion ratios) can be recovered even when the underlying demands or consumer utilities
cannot be.8

3. A Treatment Effects Interpretation of Diversion Ratios
3.1. The Wald (1940) Estimator
Diversion ratios provide a way to answer the question: ‚ÄúWhat can a price change tell us
about substitution patterns?‚Äù We begin by considering a ceteris paribus increase in price of
good j from pj ‚Üí p0j and define the corresponding Wald esimator which compares the ratio
8

The UK CMA survey asking shoppers: ‚ÄúIf this store were closed where would you shop?‚Äù is a prime
example. We could estimate a particular average diversion ratio, but would have no ability to estimate ownor cross-price elasticities.

7

of the change in sales of k to that of j.9 The Wald estimator has the advantage that it is
often readily observed from the data for a particular price change:
Wald(pj , p0j , x) =

qk (p0j , x) ‚àí qk (pj , x)

.
‚àí qj (p0j , x) ‚àí qj (pj , x)

(3)

‚àÇq

‚àÇqk
The diversion ratio Djk (pj , x) ‚â° ‚àÇP
(pj , x)/ ‚àí ‚àÇPjj (pj , x) can be obtained as the limit of
j
the Wald estimator in (3) where the price increase (or decrease) becomes small, so long as
‚àÇq
demand slopes strictly downwards ‚àÇPjj < 0:10
‚àÇqk
(pj , x)
qk (p0j , x) ‚àí qk (pj , x)
‚àÇPj
‚Üí
lim
‚â° Djk (pj , x)
0
‚àÇq
p0j ‚Üípj ‚àí(qj (pj , x) ‚àí qj (pj , x))
‚àí ‚àÇPjj (pj , x)

(4)

A large literature establishes the connection between Wald estimators like (3) and local
average treatment effects (LATE).11

3.2. Discrete Choice and a LATE Theorem
An easy way to see the connection between the Wald estimator and local average treatment
effects is to assume that the demands in (4) are derived from a discrete-choice model of
demand, where consumer i has unit demand and faces prices (pj , p‚àíj ). Consumer i selects
product j from set J (which includes an outside or no-purchase option) in order to maximize
utility. Define dij as an indicator for choosing product j:12
Ô£±
Ô£≤1 u (p , x) > u 0 (p , x) for all j 0 ‚àà J and j 0 6= j.
ij j
ij
j
dij (pj , x) =
Ô£≥0 o.w.
9

Implicitly, x contains all other relevant characteristics including: prices of other goods p‚àíj , product
quality and assortment, etc.. That p0j represents a price increase is arbitrary. We could simply exchange
(pj , p0j ) and consider a price decrease.
10
This is an application of L‚ÄôHoÃÇpital‚Äôs Rule and also requires that qk is differentiable (locally) about (pj , x).
We use Pj to denote the argument and (pj , p0j ) to denote specific values.
E[Yi |Zi =1]‚àíE[Yi |Zi =0]
11
The typical Wald estimator with a binary instrument is E[T
. Much of the literature
i |Zi =1]‚àíE[Ti |Zi =0]
on LATE also establishes the equivalent between the Wald estimator and the linear IV estimator: yi =
Œ± + Œ≤Ti + ui with E[ui |Zi ] = 0. We are not interested in that connection in this paper.
12
This setup includes most RUM‚Äôs including logit and logit variants. It also encompasses a broad class
of both random and deterministic choice models, including a variety of behavioral models where consumers
make ‚Äúmistakes‚Äù or fail to consider all available products. Behavioral models fit into the same framework so
long as we measure only diversion and not consumer welfare.

8

In the discrete choice setting, we can derive an equivalent to the LATE theorem of Imbens
and Angrist (1994). Our main theoretical result shows that under some relatively weak
discrete choice assumptions, a price change can be used to identify the average diversion
ratio among a particular set of consumers (compliers).
Proposition 1 (Analogue to LATE Theorem (Imbens and Angrist, 1994)).
Under the following conditions:
P
(a) Mutually Exclusive and Exhaustive Discrete Choice: dij ‚àà {0, 1} and j‚ààJ dij = 1.
(b) Exclusion: uik (pj , x) = uik (p0j , x) for all k 6= j and any (pj , p0j );
(c) Monotonicity: uij (p0j , x) ‚â§ uij (pj , x) for all i and any (p0j > pj ); and
(d) Existence of a first-stage: P r(dij (pj , x) = 0) 6= P r(dij (p0j , x) = 0) for (p0j > pj );
(e) Random Assignment: (uij (Pj , x), uik (Pj , x)) ‚ä• Pj .
then the Wald estimator from (3):
qk (p0j , x) ‚àí qk (pj , x)
‚àí

qj (p0j , x)

 = E[Djk,i (x)|dij (pj , x) > dij (p0j , x)]
‚àí qj (pj , x)

(Proof in Appendix A.1)

Compliance Type
Always Takers
Never Takers
Compliers
Defiers
Treatment Effects Parameter
Average Treatment Effect
Average Treatment on the Treated
Average Treatment on the Untreated
Local Average Treatment Effect

(dij (pj ), dij (p0j ))
(0, 0)
(1, 1)
(1, 0)
(0, 1)

Description
Don‚Äôt buy j at either price.
Buy j at either price
Only buy j at lower price pj < p0j
Only buy j at higher price p0j > pj

Abbreviation

Expression

ATE
ATT
ATUT
LATE

E[Djk,i (x)]
E[Djk,i (x)|dij = 0]
E[Djk,i (x)|dij = 1]
E[Djk,i (x)|dij (zj ) = 1, dij (zj0 ) = 0]

Table 1: Description of Compliance Types and Treatment Effects Parameters
In words, the proposition says that the Wald estimator identifies the average diversion
ratio among ‚Äúcompliers,‚Äù those individuals who would buy j at pj but no longer buy j
at p0j (holding all else x fixed). In other words, the treatment is defined as ‚Äúnot buying
j‚Äù and define the compliance types in Table 1. To solidify the connection with the quasiexperimental LATE framework, recognize that our hypothetical price change experiment can
be interpreted using the following definitions:
Outcome Yi ‚àà {0, 1} denotes the event that consumer i purchases product k: dik (Pj ) = 1.
9

Treatment Ti ‚àà {0, 1} denotes the event that consumer i does not purchase product j. In
other words Ti = 0 implies dij (Pj ) = 1 and Ti = 1 implies dij (Pj ) = 0.
Instrument Zi = Pj the price of j induces consumers into not purchasing j.
The bottom panel of Table 1 reports the definitions of various treatment effects parameters for the diversion ratio. We note that except under very specific circumstances, these
treatment effects estimates (ATE, ATT, ATUT, LATE) will not agree with one another.
The most common threat to the LATE approach is the presence of ‚Äúdefiers‚Äù who must
be ruled out by the monotonicity assumption. That is less of a concern here, because
monotonicity is guaranteed by the ‚ÄúLaw of Demand.‚Äù The second challenge is the plausibility
of the exclusion restriction. Here this requires that the utility for k is unaffected by the price
of j, which is an uncontroversial feature of most discrete choice utility models.13
The controversial assumption in Proposition 1 is (e) Random Assignment which enables
the price Pj to function as an ‚Äúinstrument‚Äù. What (e) means in words is that the distribution
of consumer utilities as a function of price cannot differ with the observed realizations of
prices (pj , p0j ). This is the usual simultaneity problem in demand and supply that dates
back to Working (1927), and would obviously be violated if an unobservable demand shock
is correlated with both prices and consumer preferences as in Berry (1994). This is also
violated if there is selection that leads to less price sensitive consumers facing higher prices
in data including but not limited to cases of price discrimination.
We are cautious to point out that there is no ‚Äúfree lunch‚Äù here and that LATE estimates
of diversion are not absolved from concerns about price endogeneity. At the same time,
assumption (e) does not present a problem for interpreting diversion ratios as treatment
effects when we analyze a ceteris paribus change in price in the same way that analyzing
the price-elasticity of a demand curve is not complicated by the problems associated with
endogeneity of price that arise in estimation of that elasticity.

3.3. Treatment Effect Heterogeneity
Different consumers are likely to exhibit different diversion ratios. We show how to decompose a local average treatment effects measure into the underlying heterogeneous distribution
and a set of weights in a way that mirrors Heckman and Vytlacil (2005). We begin by re13

A potential violation might be a behavioral model with framing effects such as preferences for the ‚Äúsecond
cheapest‚Äù product.

10

writing the Wald estimator:14
Wald(pj , p0j , x)

Z

p0j

=
pj

Djk (ps , x)w(ps ) ‚àÇ ps with w(ps ) = R p0
j
pj

‚àÇqj (ps ,x)
‚àÇpj
‚àÇqj (pt ,x)
‚àÇpt
‚àÇpj

(5)

This tells us that the average diversion ratio measured is just the weighted average of
diversion ratios at each Djk (ps , x), where the weights correspond to the consumers who
leave j at each price ps as a fraction of all consumers who leave j as the price increases from
(pj ‚Üí p0j ). All things being equal, as demand for j becomes more elastic, this will concentrate
more of the weight w(ps ) towards the diversion ratios measured at prices closer to pj . As
demand becomes less elastic, the weight is spread more evenly across price increments.
We can further decompose the heterogeneity by observing that at each ps , Djk (ps , x)
implicitly integrates over a heterogeneous distribution of individuals as illustrated in Proposition 1:15
Z

p0j

Z
Djk,i (ps , x)wi (ps , x) ‚àÇps ‚àÇFi

(5) =
pj

Z
=

Djk,i (x) wi (pj , p0j , x) ‚àÇFi

with wi (ps , x) =

‚àÇqij (ps ,x)
‚àÇpj

qj (pj , x) ‚àí qj (p0j , x)
qij (pj , x) ‚àí qij (p0j , x)
with wi (pj , p0j , x) =
qj (pj , x) ‚àí qj (p0j , x)

(6)

We‚Äôve now provided two alternatives for decomposing the heterogeneity in diversion ratios.
In (5), we show that the average diversion ratio varies with price, and how Wald estimator/LATE weights diversion ratios at different price increments. In (6), we show that that
the Wald estimator/LATE can be decomposed into diversion ratios of individual consumers
(which are now independent of price Pj ) and a set of individual-specific weights wi (pj , p0j , x)
which depend on realizations of prices (pj , p0j ) but not the substitute k. These weights determine the (conditional) probability than an individual of type i is a complier under a
14

Observe that Djk (ps , x) =

‚àÇqk (ps ,x)
‚àÇpj
‚àÇqj (ps ,x)
‚àÇpj

so that Djk (ps , x)

‚àÇqj (ps ,x)
‚àÇpj

=

‚àÇqk (ps ,x)
.
‚àÇpj

Also notice that the

R p0 ‚àÇq (p ,x)
integral in the denominator of the weights is just the change in sales of j: pjj j‚àÇpjt ‚àÇpt = qj (pj , x) ‚àí
qj (p0j , x).
15
This requires the assumptions
R of Proposition 1 to be satisfied. The second integral arises because at each
ps we can write: Djk (ps , x) = Djk,i (ps , x) ‚àÇFi as the integral over heterogeneous individuals. To exchange
the order of integration we need Fubini‚Äôs Theorem to apply. This is straightforward as Djk (ps , x) ‚â• 0 and
wi (ps , x) ‚â• 0 everywhere. Less obvious is that Djk,i (x) = Djk,i (ps , x) for any ps . This is demonstrated in
Appendix A.2. For discrete choice models we need: P r(uik > maxk0 ‚ààJ \{j,k} uik0 ) ‚ä• pj which is guaranteed
by the exclusion restriction and the random assignment assumption. In words, the price of j is unrelated to
an individual consumer‚Äôs relative ranking of k and some next best alternative.

11

particular intervention (pj , p0j ).
We know that the different ‚Äúinstruments‚Äù measure different LATEs by tracing out different groups of compliers. This means that we can construct some local average measure of
diversion ratios with respect to other characteristics. For example, consider a ceteris paribus
reduction in quality from Œæj ‚Üí Œæj0 , or an arbitrary characteristic zj ‚Üí zj0 .16 This lets us
re-write (6) as:17
Wald(zj , zj0 , x)

Z
=

with wi (zj , zj0 , x) =

Djk,i (x) wi (zj , zj0 , x) ‚àÇFi

qij (zj , x) ‚àí qij (zj0 , x)
(7)
qj (zj , x) ‚àí qj (zj0 , x)

Here we exploit the fact that the individual specific diversion ratios don‚Äôt vary with price
(or even rely on a price change), but rather that the weights vary when we use quality
rather than price as the instrument. Any product characteristic zj is valid, so long as it
satisfies the monotonicity condition uij (zj0 ) ‚â§ uij (zj ) for all i and any (zj0 > zj ).18 This may
seem surprising at first, because we might expect cars to have one elasticity with respect to
price, and a different elasticity with respect to fuel economy. What (6) says is that at the
individual level there is only one diversion ratio and it is a deep structural parameter that
is invariant to whether we change price, quality, or availability. The choice of, or variation
in, the instrument simply determines the weights applied to the individual diversion ratios.
This is consistent with results in Heckman (2010); Heckman and Vytlacil (2005); Carneiro
et al. (2011) on Marginal Treatment Effects (MTE). Any treatment effect parameter from
Table 1 (LATE, ATE, ATT, ATUT, etc.) can be written as the integral of the non-parametric
MTE function (Djk,i (x) in our case) over some set of weights. As an example, the returns
to college attendance at the individual level are fixed and (assumed to be) policy invariant.
However, different policy interventions (instruments) such as merit scholarships, affirmative
action, or financial aid induce different students to attend college (different compliers) and
thus weight the underlying MTEs differently and measure different average effects.

3.4. Special Case: Second Choice Data
An important special case is that of second-choice data. In this case, all individuals are
treated: dij (Pj ) = 0 for all i. In practice, this could be accomplished in one of several ways:
16

Berry and Haile (2014) exploit the idea that quality functions as ‚Äúminus price‚Äù.
Now we treat pj as fixed and contained in x.
18
In a random coefficients logit model, this would require that the sign of Œ≤i on zj is the same for all
individuals. For example, this would rule out cases where some consumers prefer ‚ÄúMushy‚Äù cereal and others
do not.
17

12

(a) by setting pj equal to the choke price qj (pj ) = 0; (b) by reducing the quality (or some
other characteristic) such that no consumers choose j: qj (Œæj , x) = 0; or (c) eliminating the
product j from the choice set J \ j. If we apply Proposition 1, we see that:
Wald(pj , pj , x) =

E[dik (pj , x)] ‚àí E[dik (pj , x)]
= E[Djk,i (x)|dij (pj , x) = 1] = ATUT.
E[dij (pj , x)] ‚àí E[dij (pj , x)]
{z
}
|

(8)

=0

We measure the average diversion ratio for all individuals who would have bought j at the
original price pj . Since our treatment indicator corresponds to ‚Äúnot buying j‚Äù, this is the
average treatment on the untreated (ATUT) and is equivalent to the gain in sales by k divided
by the lost (original) sales of j at pj .19 The instrument we use to obtain second-choice data
is irrelevant as all manners of second-choice data identify the ATUT.20
If we revisit the example of the UK CMA asking customers: ‚ÄúIf this store were to close,
where would you shop instead?‚Äù and ask whether this is useful for their purposes, we now
have a framework to answer that question. The answer depends on whether the ATUT
E[Djk,i (x)|dij (pj , x) = 1] is a good estimate for Djk (Pj , x) at whatever value of Pj they are
interested in (potentially the pre-merger price). This also provides a specific interpretation
for the substitution measured by natural disaster induced hospital closures in Raval et al.
(2019).
This also provides a framework to understand the value of second-choice data in parametric models of demand such as Berry et al. (2004) (microBLP). In microBLP, the authors
have access to the CAMIP survey data on consumers‚Äô second choices. They report finding
extra moments from this second-choice data useful in estimating nonlinear (substitution)
parameters. Our expression in (8) explains why, these second choices are informative about
the average diversion ratios of those surveyed. If the survey is a random sample of buyers of
j, then it is informative about the ATUT, and ‚Äúmicro-moments‚Äù constrain the ATUT of the
parametric model to match that from the survey. Additional information on average diversion
ratios may be particularly useful for researchers if the corresponding counterfactuals (such as
prospective merger evaluation, recovery of implied price-cost margins, or willingness-to-pay
s (p )

19

j
k
As a matter of completeness, the ATT at pj is just 1‚àís
. That is, since being treated is ‚Äúnot buying
j (pj )
j‚Äù the share of people purchasing k among all non j buyers at pj is merely the observed share. This may
look familiar as the rate of substitution from the IIA logit, though no parametric assumptions have been
made beyond those in Proposition 1. As we demonstrate later, the IIA logit exhibits constant treatment
effects and thus has the property that the ATE=ATT=ATUT.
q (x)
20
It is easy to see that wi are equal in (6) and (7) at the ‚Äúchoke price‚Äù and ‚Äúchoke quality‚Äù wij = qijj (x) .

13

calculations) depend on accurate measures of diversion.

3.5. Differences Among Treatment Effects Parameters
Often researchers want to know whether or not a LATE from the Wald estimator is a good
estimate of the ATT, ATE, ATUT, or marginal effect at some x. In the typical problem,
this depends on the heterogeneity in the individual treatment effects (Djk,i (x) in our case)
and the selection into treatment.21 Consider a second-order Taylor expansion of qk around
pj , where we define ‚àÜpj = p0j ‚àí pj :
qk (p0j , x) ‚àí qk (pj , x)
‚àÇqk (pj , x) ‚àÇ 2 qk (pj , x)
‚âà
+
‚àÜpj + O(‚àÜpj )2 .
‚àÜpj
‚àÇpj
‚àÇp2j

(9)

The difference between the Wald estimator or LATE, and its limit at ‚àÜpj ‚Üí 0, defined in
(4) as Djk (pj , x), is given by:
‚àÇ2q

2

Djk (pj , x) ‚àÇp2j + ‚àÇ‚àÇpq2k
qk (p0j , x) ‚àí qk (pj , x)
j
j
0
Wald(pj , pj , x) ‚àí Djk (pj , x) =
‚àí Djk (pj , x) ‚âà ‚àí
‚àÜpj
2q
0
‚àÇ
‚àÇq
j
j
qj (pj , x) ‚àí qj (pj , x)
+ 2 ‚àÜpj
‚àÇpj

‚àÇpj

(10)
As one might expect, as ‚àÜpj becomes larger, the difference between the Wald(pj , p0j , x)
estimator/LATE and Djk (pj , x) grows. As p0j increases, we treat more individuals (and
thus reduce the variance of our Wald estimator) but we begin to average over diversion
ratios at prices further away from pj . This has the effect of changing the weights in (6).
What is unique to diversion vis-a-vis other treatment effects applications is that we can link
differences in measures of diversion ratios to the underlying properties of demand; specifically
to the curvature of demand, which enters the numerator of (10).22 This makes it easy to sign
the difference or derive bounds for well known demand forms. We discuss several common
parametric forms (linear,log-linear, logit, nested logit, and mixed logit) in Appendix A.3.
For some treatment effects parameters, under the discrete-choice assumption (but without
additional parametric assumptions beyond those for Proposition 1) we can derive analytic
expressions. One example that does not depend on the parametric form is the AT T =
s (p ,x)
E[Djk,i (x)|dij (pj , x) = 0] = 1‚àísk j (pj j ,x) . This is just the share of consumers choosing k as a
21

For example, when asking whether the wage effect on the average college attendee is similar to that of
the marginal college attendee, this depends on the unobserved underlying distribution of ‚Äúability‚Äù among
other things.
22
Also notice that we do not need to assume discrete-choice demand for this result.

14

fraction of all those not choosing j. In the case of second-choice data (AT U T ), everyone
who purchased j at pj is treated, and we weight all individuals by wi (pj , x) = sij (pj , x)
(their initial purchase probability for j), although we cannot say anything at all about
Djk,i (x) without additional assumptions.23 Meanwhile the AT E (where everyone is treated)
is AT E = E[Djk,i (x)] = (1 ‚àí sj ) ¬∑ AT T + sj ¬∑ AT U T .24 We expect most practitioners to be
interested in the properties of small price changes under the LATE/Wald estimator and its
limit Djk (Pj , x), or second-choice data (ATUT), so we don‚Äôt spend additional attention on
the other treatment effects parameters (ATE and ATT).

3.6. Special Case: Constant Treatment Effects (Diversion Ratios)
There are some special models for which all of the treatment effects measures coincide, and
thus, whether one considers a small price (or quality) change or uses second-choice data,
one obtains the same diversion ratio. These are cases where the model exhibits constant
treatment effects and all individuals have identical diversion ratios.
Two examples for which the numerator of (10) is equal to zero and produce constant
2
treatment effects (diversion ratios) are: the linear model, for which ‚àÇ‚àÇpq2k = 0 for all (j, k),
j

2

‚àÇ2q

and the logit model, which sets the numerator of (10) to zero: Djk = ‚àí ‚àÇ‚àÇpq2k / ‚àÇp2j .25 This
j
j
has implications in both directions. If we assume linear demand or logit demand, we are
implicitly assuming that diversion ratios do not vary with price or across individuals. If we
treat the diversion ratio as if it were constant, we are implicitly restricting the true demand
system to be consistent with linear demand or IIA logit. Researchers should be just as
nervous about these restrictions as they would be about constant treatment effects in other
contexts such as assuming identical returns to college.
The nested logit model seems like it might have constant diversion ratios (as the product
23
This provides an explanation for the perceived practice of antitrust agencies absent better data: ‚ÄúAssume
diversion ratios are proportional to pre-existing market share.‚Äù This is equivalent to assuming that the ATT
is a good estimate of the ATUT (which more generally implies no selection). In the example of college
attendance, this is akin to assuming that the returns to college attendance are the same for those who
chose to attend and those who chose not to attend. While this resembles the IIA logit, no such parametric
restrictions have been made.
24
The expression is derived from AT E = P r(Ti = 0) ¬∑ AT U T + P r(Ti = 1) ¬∑ AT T where the probability of
sk
being treated (not buying j) is just 1 ‚àí sij (pj , x). Of course (1 ‚àí sj ) √ó AT T = 1‚àís
√ó (1 ‚àí sj ) = sk which is
j
just the share of k and exactly what one would expect.
25
This is derived in the Appendix A.3. An easier way to see constant diversion under the IIA logit is to
sik
sk
observe that Djk,i = 1‚àís
= 1‚àís
for all individuals. One might be concerned that this is not the same
ij
j
diversion ratio that one recovers under linear demand, and think that the ATT expression derived under
sk
discrete choice AT T = 1‚àís
presents a contradiction. However, as is shown in Jaffe and Weyl (2010), linear
j
demand is inconsistent with discrete choice, and thus these measures are allowed to disagree.

15

of two IIA logits) but in fact does not. It fails to satisfy the property in (10) which we show in
Appendix A.3. This means the diversion ratio from a small change in product characteristics
(inclusive of price) is not the same as a diversion ratio obtained from second choice data
(ATUT), a fact we have confirmed in simulations. One way to see this is to observe that
not all ‚Äúindividuals‚Äù have the same diversion ratios, and that diversion ratios vary with the
category of the initial product choice. There are different diversion ratios (for small changes
s Z(œÉ,s )
in the ‚Äúindex‚Äù) for products in the same nest: 1‚àísk|gj|g Z(œÉ,sg g ) and products in separate nests:
sk (1‚àíœÉ)
1‚àísj|g ¬∑Z(œÉ,sg(j) )

where Z(œÉ, sg ) = [œÉ + (1 ‚àí œÉ)sg ].

3.7. Application to Random Coefficients Logit
We show how the results in the previous sections can be applied to the workhorse random
coefficients logit model that is popular in industrial organization and for merger evaluation in
particular (Berry et al., 1995; Nevo, 2001). The random coefficients logit model parametrizes
the utility as:
uij = Œ≤i zj ‚àí Œ±i Pj + Œæj + Œµij with Œµij , ‚àº IID Type 1 EV

(11)

where f (Œ≤i , Œ±i ; Œ∏) is a parametric distribution known up to a parameter Œ∏.26 This class of
models has an ‚Äúindex‚Äù so that an ‚Äúindividual‚Äù (fixing Œ±i , Œ≤i but not Œµi ) does not discriminate
among changes that make (zj , pj , Œæj ) worse so long as they change the index by an equal
number of units. We exploit this index property when computing the integration weights
wij (x). The decomposition from (6) allows us to write any treatment effects parameter for
diversion ratios under the random coefficients logit as:27
Z
Djk (x) =

Z
Djk,i (x)wij (x)‚àÇFi =

sik (x)
wij (x)‚àÇFi =
1 ‚àí sij (x)

Z
sik (x) w
eij (x)‚àÇFi

(12)

We make use of several properties. First, when we integrate out over Œµi , each indivudal‚Äôs
sik (x) 28
diversion ratio follows a (different) logit such that Djk,i (x) = 1‚àís
.
Consistent with
ij (x)
(6) and holding for any discrete-choice model satisfying the assumptions of Proposition 1,
26

The convention in Heckman and Vytlacil (2005) is to consider an ‚Äúindividual agent‚Äù as including the
error term (here Œµi ). Instead, we follow the random coefficient logit convention an treat an ‚Äúindividual‚Äù as
a (Œ≤i , Œ±i ) but integrating over rather than conditioning on Œµi . Writing things the other way would prevent
us from getting analytic expressions.
w (x)
27
Observe that w
eij (x) = 1‚àísijij (x) . We abuse notation and suppress the (p0j , pj ) or (Œæj0 , Œæj ) arguments
because a variety of instruments (or none at all - as in second choice data) could be used.
28
That individual demands follow IIA logit is well-known but a derivation is provided in Appendix A.3.

16

wij (x) ‚àù

w
eij (x) ‚àù

sij (x)

sij (x)
1‚àísij (x)

sij (x) ¬∑ (1 ‚àí sij (x)) ¬∑ |Œ±i |

sij (x) ¬∑ |Œ±i |

sij (x) ¬∑ (1 ‚àí sij (x)) ¬∑ |Œ≤i |

sij (x) ¬∑ |Œ≤i |

second choice data
price change
characteristic change
small quality change

‚àÇ
‚àÇpj
‚àÇ
‚àÇxj
‚àÇ
‚àÇŒæj

sij (x) ¬∑ (1 ‚àí sij (x))

finite price change wi (pj , p0j , x)

|sij (p0j , x) ‚àí sij (pj , x)|

finite quality change wi (Œæj , Œæj0 , x)

|sij (Œæj0 , x) ‚àí sij (Œæj , x)|

willingness to pay (WTP)

=

sij (x)
|Œ±i |¬∑si0 (x)

sij (x)
|sij (p0j ,x)‚àísij (pj ,x)|
1‚àísij (x)
|sij (Œæj0 ,x)‚àísij (Œæj ,x)|
1‚àísij (x)
sij (x)
|Œ±i |¬∑si0 (x)(1‚àísij (x))

Table 2: Weighting of Different Treatment Effects Parameters under RC Logit
P
Note: Weights are used to construct the weighted
R average diversion measure: Ri Djk,i (x)wij (x).
Weights must be normalized to integrate to one wij (x)dFi = 1, but note that w
eij (x)dFi 6= 1.
The weights wij (x) for the WTP measure are as written (do not integrate to one).

individual diversion ratios don‚Äôt depend on Pj . This is because diversion already conditions
on individuals not buying good j.29 Whether one considers changes of prices, quality, or other
characteristics, and whether those changes are large (including second-choice data) or small,
affects only weighting and not individual diversion ratios. At the level of the individual i,
diversion ratios depend only on how i ranks k relative to some alternative k 0 .
sik (x)
.
The second property is that the diversion ratio is always bounded above by maxi 1‚àís
ij (x)
The average diversion ratio can never exceed the largest diversion ratio for any individual. In
practice this means the individual for whom the combination of sik (x) and sij (x) is largest.
Unless we see very large individual choice probabilities sik (x) we should not expect to see
very large diversion ratios, even for highly similar products (such as red and blue buses).
The third property, which is specific to the logit family, allows us to rewrite (12) as the
integral of two terms: i‚Äôs share for the substitute sik (x), and a re-defined weight w
eij (x) =
wij (x)
, which depends on j. In Table 2, we compute the corresponding weights for (6) for
1‚àísij (x)
various treatment effects parameters and instruments. For expositional purposes, we focus
on the right hand side of (12) so that we are always integrating the individual‚Äôs share for
k : sik (x) over the adjusted w
eij (x). We begin by considering a unit change in the index from
(11) which we could accomplish by reducing Œæj . In this case, all individuals are weighted
proportional to their purchase share of the initial good sij (x), which seems intuitive. If
instead, we consider a unit change in a characteristic zj or price pj , we concentrate more
weight on those individuals more sensitive to the characteristic w
eij (x) ‚àù sij (x)|Œ±i |. If all
individuals possess the same Œ±i = Œ± then this drops out and these are identical to weights
29

Note: this is not the same thing as saying that sij (x) or sik (x) wouldn‚Äôt be different at a different value
of (pj , pk ); they definitely would be!

17

on the marginal change in the quality index sij (x). Second-choice data instead weights
s (x)
according to w
eij (x) ‚àù 1‚àísijij (x) . Relative to a small change in the index, it places more weight
on individuals with higher initial shares for sij (x). However, in many cases (such as the BLP
automobile example) individual purchase probabilities are small, so that the denominator
1 ‚àí sij (x) ‚âà 1 and the second-choice weights are nearly identical to those from a marginal
change in product quality.30 When the share sij (x) becomes large, the second-choice weights
diverge from the marginal quality change weights. In practice, this tends to require a small
outside good share (at least for some individuals).
This decomposition highlights the role of random coefficients in diversion ratios. Random
coefficients have two effects: the first is to increase dispersion in the share of the substitute
sik (x)
), and the second is that when we consider
sik (x) (or underlying diversion ratios 1‚àís
ij (x)
diversion ratios estimated from changes in characteristics with random coefficients it places
more weight on the individuals most sensitive to that characteristic. Under the random coefficients logit model, whether or not second choice data (potentially from surveys) produces
an estimate similar to that of a small price change depends on how much sij (x)|Œ±i | differs
from sij (x) and how correlated sik (x) is with those weights. We illustrate these properties
in our empirical examples.

3.8. Relationship to Willingness to Pay
In addition to Upward Pricing Pressure (UPP) and merger simulation, another important
object is the Willingness-to-Pay (WTP) measure of Town and Vistnes (2001) and Capps et al.
(2003). WTP measures the value of including an option j in a consumer‚Äôs choice set, and
is an important input into the analysis of hospital-insurer networks (e.g., Ho (2006, 2009);
Ericson and Starc (2015)) and Nash-in-Nash bargaining between hospitals and insurers (e.g.,
Gowrisankaran et al. (2015); Ho and Lee (2019)). The WTP measure has also been used
outside the hospital-insurer context in the analysis of cable bundles (e.g., Crawford and
Yurukoglu (2012)).
We consider a simple version of the WTP measure under the same random coefficients
logit model as before. Consumer utility is given by (11) which we write as uij = Vij + Œµij .
There are well known results (Manski and McFadden, 1981) which show the expectation of
P
the maximum has a closed form: E[maxk‚ààJ uik ] = log k‚ààJ exp[Vik ]. If we follow Capps
et al. (2003) or Ho (2006) and ask: ‚ÄúWhat is the value to consumer i of including j in the
30

This is not the same thing as saying that sj is small, there may still be ‚Äúindividuals‚Äù with a high purchase
probability for j even if the overall market share sj is small.

18

choice set?‚Äù we obtain:31
!
W T Pi (j) = E[max uik ] ‚àí E[ max
uik0 ] = log
0
k‚ààJ

k ‚ààJ \j

X

Ô£´
‚àí log Ô£≠

exp[Vik ]

Ô£∂
X

exp[Vik ]Ô£∏ (13)

k‚ààJ \j

k‚ààJ

We make use of the following relationships: (1) the individual outside good choice probability si0 (J , x) = P 1exp[Vik ] ; (2) that the outside good choice probability after removing
k‚ààJ
j increases by the individual share of j times the individual diversion ratio from j to the
outside good si0 (J \ j, x) = si0 (J , x) + Dj0,i (x) ¬∑ sij (x); and (3) for members of the logit
si0 (x)
family: Dj0,i (x) = 1‚àís
. This lets us rewrite (13) as:32
ij (x)







si0 (J \ j, x)
Dj0,i (x)sij (x)
si0 (J , x) ¬∑ sij (x)
= log
= log 1 +
= log 1 +
si0 (J , x)
si0 (J , x)
(1 ‚àí sij (x)) ¬∑ si0 (J , x)


sij (x)
sij (x)
= log 1 +
(14)
‚âà
1 ‚àí sij (x)
1 ‚àí sij (x)
At the individual level, the amount i would pay to have j in his or her choice set is related to
the percentage change in the outside good share, or the diversion from j to the outside good
Dj0,i (x). This should be intuitive: products that add the most value are those without close
substitutes, which draw in consumers from the outside option. Perhaps surprising is that this
expression simplifies so that W T Pi (j) can be written solely as a function of the individual
choice probability for j, sij (x). This result is of practical relevance because many hospital
network papers (e.g., Ho (2006, 2009); Capps et al. (2003)) omit the outside good, and (14)
shows us that W T Pi (j) requires only an estimate of the individual choice probability sij (x).
It is common to further aggregate W T P (i, j) across individuals. One convention is
to follow Manski and McFadden (1981) and convert difference in utility to money-metric
equivalent variation (EV) and aggregate across individuals:33
Z
W T P (j) =

1
W T Pi (j)‚àÇFi ‚âà
|Œ±i |

Z

sij (x)
‚àÇFi =
|Œ±i |(1 ‚àí sij (x))

31

Z
Dj0,i (x)

sij (x)
‚àÇFi
|Œ±i | ¬∑ si0 (J , x)
(15)

We simplify by ignoring the probability that consumers face additional ex-ante risk over diagnoses. In
this sense, our version more closely resembles Crawford and Yurukoglu (2012).
32
The approximation arises from the first-order Taylor expansion: ln(1 + x) ‚âà x. This approximation is
valid when sij is small.
33
Many papers do not identify a heterogeneous price coefficient and thus Œ±i becomes a multiplicative
constant in (15).

19

The last expression in (15) results in the same form as (7), in which we integrate diversion
R
from j to the outside good Dj0,i (x)wij (x)‚àÇFi . The difference is that (15) uses a different
s (x)
set of weights wij (x) = |Œ±i |¬∑siji0 (J ,x) . Therefore, we include this as the final example of our
decomposition in Table 2. The connection between second-choice data and WTP is that
s (x)
measures of diversion that use second-choice data integrate sik (x) over w
eij (x) = 1‚àísijij (x) ,
while in the absence of heterogeneous tastes for price, WTP integrates a constant 1 over the
s (x)
same set of weights w
eij (x) = 1‚àísijij (x) .

4. Applications using Nevo (2000) and Berry, Levinsohn, and Pakes (1999)
To illustrate our theoretical results on diversion ratios, we use the two well-known examples
from Nevo (2000b) and Berry et al. (1999). The data in Nevo (2000b) are simulated fake
data meant to mimic the cereal industry from Nevo (2001), and consist of T = 94 markets,
J = 24 products, and N = 2,256 observations.34 The Berry et al. (1999) data are annual
national aggregate automobile sales by make and model for T = 21 markets (each market
is a year),with up to J = 150 products per market and a total of N = 2,217 observations.
An advantage of the BLP data is that product names are attached, which help to interpret
results.35
The specifications of utility in the two models are given by:
pjt
+ Œæjt + Œµijt
uBLP
ijt = xjt (Œ≤ + Œ£ ¬∑ ŒΩi ) ‚àíŒ± ¬∑
| {z }
yit
Œ≤it

uNevo
ijt

= xjt (Œ≤ + Œ£ ¬∑ ŒΩi + Œ† ¬∑ dit ) +dj + ‚àÜŒæjt + Œµijt
|
{z
}
Œ≤it

The main difference between the two specifications is that Nevo (2000b) contains product
fixed effects for each of the 24 brands dj , and allows for interactions between household
income and presence of children with tastes for product characteristics (the Œ† parameters).
In the Berry et al. (1999) example price is interacted with 1/yit where yit is a draw from a
lognormal distribution of income.36
We estimate these parameters using the PyBLP software package of Conlon and Gort34

These data are posted online by the author, and are not the actual data used in Nevo (2001), which are
proprietary.
35
This information is not available for the simulated Nevo (2000b) data.
36
This is better behaved than Œ± ¬∑ log(yi ‚àí pjt ) from Berry et al. (1995). In estimation, Berry et al. (1999)
also includes moment restrictions derived from an oligopolistic price-setting supply-side, which we include
in estimation but do not report.

20

maker (2020). In doing so, we implement the recommended ‚Äúbest practices‚Äù which involve
calculating the nonlinear approximation to the optimal instruments. For the Nevo (2000b)
example, we use the same 20 simulation draws provided in the original data package. For
the Berry et al. (1999) example, the original draws are not available and we use 500 Halton
draws. In addition to the baseline ‚Äúbest practices‚Äù estimates for each model, we consider
three modified models in order to highlight how restrictions on parametric models are related to diversion ratios. In the first case, we eliminate all heterogeneous tastes for price
œÄp = œÉp = 0. In the second case we eliminate all heterogeneous tastes for the constant term
œÉ0 = œÄ0 = 0 (which governs ‚Äúinside‚Äù vs. ‚Äúoutside‚Äù good substitution). We consider these
two examples because many researchers consider these forms of heterogeneity to be among
the most important to capture when modeling demand. In the final case, we rescale the
market shares for all ‚Äúinside‚Äù goods by a factor of three. This is meant to capture researcher
uncertainty about the overall size of the market. In the Nevo (2000b) case we multiply sjt ¬∑ 13
and in the Berry et al. (1999) case we multiply sjt ¬∑ 3.37
We report the parameter estimates in Table 3.38 The top panel reports estimates for
the Berry et al. (1999) example. Best practices estimates are reported in the first column.
The second column reports estimates that omit heterogeneity on the constant term, which
are similar. In the third column, we report estimates that omit heterogeneity on price,
which differ significantly from the estimates in the first two columns. The last column
rescales the market shares of all inside products, simulating a change in the assumed market
size. As expected, the parameter estimates are sensitive to this change too. In the bottom
panel, we perform the same comparisons for the Nevo (2001) example. In this case, we
find that omitting heterogeneity on the price term gives estimates quite similar to ‚Äòbest
practices,‚Äô while omitting heterogeneity on the constant term and rescaling shares both lead
to significantly different estimates.
For later comparisons, we also include a simple nested-logit model with all ‚Äòinside‚Äô products in a single nest. The nested-logit model offers a helpful comparison because, unlike the
plain logit, it allows for a parameter that governs diversion to the outside good. Accordingly,
the nested-logit is often used by researchers or antitrust agencies to provide a ‚Äúfirst cut,‚Äù
or to model demand under time and/or data constraints. There are no random coefficients
37

In the BLP case this can be interpreted as people look for a new car at most once every three years
instead of every year. In the Nevo case this effectively triples the potential number of servings (breakfast,
lunch, and dinner, instead of breakfast only), that a household could consume each period.
38
We only present the nonlinear parameters here. For the mean value of product characteristics consult
Table B.1 in Appendix B.

21

to report for the nested-logit model, so we do not include it in Table 3. The only relevant
parameter is the nesting parameter. In the Berry et al. (1999) example, we estimate the
nesting parameter to be œÅ ‚âà 0.78. For the Nevo (2001) example, we cannot estimate a
nesting parameter because the fake data have the same number of products in all markets,
leaving us without an instrument for the nesting parameter, or any necessary variation for
estimation. Instead, we calibrate the nesting parameter to match the outside good diversion
(œÅ = 0.375).39
In Table 4 we explore the relationship between parametric restrictions on random coefficients logit models and the resulting effects on elasticities and diversion ratios. In both
the Nevo and BLP examples, the median own elasticity is relatively stable across random
coefficients specifications. The BLP and Nevo examples again struggle with different sets
of restrictions, suggesting the models capture important sources of heterogeneity through
different sets of parameters. Overall, the BLP example looks substantially different when
we restrict heterogeneity on prices, and the Nevo example looks substantially different when
we omit heterogeneous tastes for the constant, which governs inside vs. outside good substitution. Absent the key dimension of heterogeneity, diversion to the outside good increases
from around 20% to around 89% in the BLP case, and from 33% to around 42% in the
Nevo case. We see a similar, though less interpretable effect on the aggregate elasticity in
both examples. The challenges with using aggregate elasticity as a diagnostic are highlighted
when we rescale the shares. In the BLP example, we effectively triple the share of inside
goods, which reduces outside good diversion to around 16%; however, the aggregate elasticity doubles (from roughly 9% to 18%) because the outside good share has declined. In
the Nevo example, we effectively triple the share of the outside good, and thus outside good
diversion increases from around 33% to 78%, while the aggregate elasticity falls from about
53% to 38% (even though more consumers are diverted to the outside option). This suggests
that outside good diversion is a more useful diagnostic than the aggregate elasticity. In
general, the lack of stability in the outside good diversion (and aggregate elasticity) across
specifications suggests this might be helped by additional (micro) moments or second-choice
data.40
We also report (sales-weighted) substitution to the top 5 substitutes for each product.
39

This calibration is meant to represent a ‚Äúbest case‚Äù scenario for nested logit, or what we might hope to
estimate if we had access to micro-moments or second choice data.
40
As an example, consider demand for distilled spirits as in Conlon and Rao (2019) or Miravete et al.
(2018). We might also have quasi-experimental estimates (e.g., from a tax change on the total quantity sold
within a particular state), and could use this as additional information.

22

Best Practices

Œ£cons = œÄcons = 0

Œ£p = œÄp = 0

Rescaled Shares

-51.254
(5.847)
2.052
(1.111)
1.785
(2.061)
1.899
(0.439)
0.708
(0.184)
1.126
(0.917)

-49.175
(7.104)
‚Äì
‚Äì
2.661
(1.258)
1.135
(0.522)
0.157
(0.223)
1.554
(0.736)

-0.355
(0.030)
0.024
(35.915)
0.097
(33.495)
0.080
(133.351)
0.003
(14.096)
0.012
(29.555)

-11.277
(2.218)
3.159
(1.364)
1.257
(2.257)
1.408
(0.445)
0.151
(0.361)
0.261
(2.405)

-31.125
(4.700)
2.983
(0.650)
0.217
(0.078)
0.027
(0.007)
0.294
(0.101)
92.746
(89.324)
-5.266
(4.621)
4.056
(2.260)
6.043
(0.538)
0.161
(0.203)
-0.310
(0.035)
0.049
(0.013)
0.982
(0.279)
-0.537
(0.181)

-42.642
(3.627)
1.362
(0.741)
‚Äì
‚Äì
0.055
(0.012)
0.720
(0.339)
49.645
(66.938)
-1.535
(3.492)
0.186
(2.511)
‚Äì
‚Äì
‚Äì
‚Äì
-0.088
(0.030)
0.023
(0.016)
1.193
(0.310)
-0.029
(0.237)

-30.939
(0.913)
‚Äì
‚Äì
0.246
(0.079)
0.055
(0.012)
0.835
(0.302)
‚Äì
‚Äì
‚Äì
‚Äì
‚Äì
‚Äì
4.819
(0.357)
-0.049
(0.200)
-0.245
(0.023)
0.036
(0.016)
0.741
(0.261)
-0.176
(0.230)

-36.280
(2.507)
2.314
(0.537)
0.016
(0.070)
0.028
(0.007)
0.172
(0.089)
214.812
(40.954)
-11.596
(2.143)
3.537
(2.021)
4.071
(0.435)
0.018
(0.194)
-0.287
(0.035)
0.046
(0.015)
0.805
(0.266)
-0.508
(0.180)

BLP
price/inc
œÉcons
œÉHP/weight
œÉair
œÉMP$
œÉsize
Nevo
Œ±price
œÉprice
œÉcons
œÉsugar
œÉmushy
œÄprice√óinc
œÄprice√óinc2
œÄprice√ókids
œÄcons√óinc
œÄcons√óage
œÄsugar√óinc
œÄsugar√óage
œÄmushy√óinc
œÄmushy√óage

Table 3: Parameter Estimates for Berry et al. (1999) and Nevo (2000b).
Best practices refers to estimates with optimal instruments. See Conlon and Gortmaker (2020) for more
details.
BLP example uses 500 Halton draws to approximate the numerical integral and includes supply side.
Nevo (2000b) example uses the same 20 point distribution of heterogeneity included with the (simulated)
data.
Rescaled Shares takes sj √ó 3 for BLP and sj √ó 13 for Nevo.

23

The badly misspecified models (lacking price heterogeneity for BLP, or heterogeneity on the
constant term for Nevo) understate substitution to the closest substitutes relative to the
baseline model. Rescaling the inside shares for BLP leads to a slight increase in diversion to
the best substitutes, and rescaling the outside share for Nevo leads to a substantial reduction
in diversion to the closest substitutes, from about 40% to 13%. In both cases these effects
appear to be related to the change in outside good diversion. Markups (shown in (1) to
be largely a function of own-elasticity and diversion to products of the same owner) appear
to be more stable, but are still sensitive to outside good diversion, with more outside good
diversion being associated with lower markups. As we showed in (15), consumer surplus is
largely a function of three things: own share sij (x), diversion to the outside good Dj0,i (x),
and price sensitivity Œ±i . Thus, it should be unsurprising that specifications that estimate
different outside good diversion, also give wildly different consumer surplus calculations (as
does the BLP model with heterogeneous tastes for price).41
Although the nested-logit model matches the outside good diversion reasonably well in
both examples (by construction in the Nevo example), they do not capture the full extent
of diversion to the top 5 substitutes, because no parameters are left to explain similarities
among pairs of products.42 This also highlights that for these two examples, the ‚Äúflexibility‚Äù
of the random coefficients specification is largely about capturing the inside/outside good
diversion margin rather than similarities across pairs of products, which even for the closest
substitutes are within 10% between the nested logit and baseline specifications.

4.1. Differences Among Treatment Effects Estimates
As we discussed in Section 3.5, different ‚Äúinstruments‚Äù will recover different average measures
of diversion ratios. An important question is how different these measures are from one
another. For example, if the UK CMA were interested in the effect of a horizontal merger
among retail supermarkets and surveyed potential customers asking about their second choice
(e.g., ‚ÄúIf this store were to close, where would you shop?‚Äù), one might want to know the
difference between diversion estimated from a small price change Djk (pj , x) and diversion
estimated from the second-choice survey. As another example, suppose that we wanted to
41

We need to be careful about consumer surplus comparisons because comparing utilities across specifications is not possible. However, these CS calculations are money-metric in that CSi (x) is scaled by Œ±1i for
each individual and then market averages are reported.
42
The BLP nested logit has an additional problem because we omit the supply side. This leads to less
elastic estimates of demand, which also impact markups and consumer surplus. Estimating the nested logit
with all products in one nest and the same supply-side restrictions used by Berry et al. (1999), gives an
estimate of œÅ ‚âà 1.4, which is not necessarily consistent with random utility maximization. (See McFadden
and Train (2000).)

24

Best Practices

Œ£cons = œÄcons = 0

Œ£ p = œÄp = 0

Rescaled Shares

Nested Logit

-3.811
-0.096
0.201
0.182
0.334
2.071

-3.481
-0.095
0.227
0.165
0.359
2.005

-3.098
-0.258
0.892
0.022
0.385
0.323

-2.632
-0.178
0.163
0.191
0.468
14.726

-1.600
-0.033
0.197
0.165
0.936
2.827

-3.654
-0.534
0.329
0.406
0.402
2.946

-3.735
-0.683
0.418
0.334
0.384
3.750

-3.686
-0.558
0.341
0.392
0.402
3.218

-3.622
-0.383
0.780
0.129
0.324
0.628

-3.995
-0.584
0.342
0.385
0.363
3.011

BLP
Median Own-Elasticity
Median Aggregate Elasticity
Median Outside-Good Diversion
Mean Top 5 Diversion
Mean Markup
Median Consumer Surplus
Nevo
Median Own-Elasticity
Median Aggregate Elasticity
Median Outside-Good Diversion
Mean Top 5 Diversion
Mean Markup
Median Consumer Surplus

Table 4: Comparison of Diversion and Elasticities for Berry et al. (1999) and Nevo (2000b).
Mean markup and diversion are sales-weighted.
Nested Logit (BLP): all products in single nest and estimates œÅ = 0.78.
Nested Logit (Nevo): all products in single nest and calibrates œÅ = 0.375 to match outside good diversion.

know how consumers might respond to a reduction in the quality of cellular phone plans, but
we only had information from ‚Äúnumber porting‚Äù data during a period in which consumer
switching was driven largely by price cuts from Sprint and T-Mobile.43
In Section 3.7 and Table 2 we derived expressions for how these different interventions
weighted different groups of individuals. Here we illustrate the implications of these different
weights for the BLP and Nevo examples under the baseline specifications from the prior
section. In our first exercise, we compare the diversion ratios obtained for every product in
every market under the various ‚Äúinstruments‚Äù or interventions (small price changes, small
quality changes, second-choice data, etc.).
In Table 5, we examine substitution to the best substitute for each product and to the
outside good. For the BLP example, we measure diversion ratios for the best substitute for
each vehicle, considering a small change in price or quality, or a product removal. All three
random-coefficient measures are similar for the best substitute. We predict somewhat less
substitution to each product‚Äôs closest substitute with the nested-logit specification. This is
expected, because the nested-logit model lacks parameters that make a Camry similar to
an Accord. The plain logit performs quite poorly, as it cannot properly capture diversion
43

It is true that if we had a fully specified model parametric demand model we could answer these questions.
Though in the first example, it seems unlikely that the CMA could estimate a price parameter or elasticity
given the available data, and in the second example it might be challenging to estimate preferences for
‚Äúquality‚Äù if it were subsumed into provider intercepts.

25

Djk (p)

Small Quality Change

Second Choice

Logit

Nested Logit Djk (p)

Med(Djk )
Mean(Djk )
% Correct

4.53
5.11
100.00

4.62
5.30
97.29

4.63
5.33
97.29

0.46
0.53
95.58

3.85
3.97
95.58

Med(Dj0 )
Mean(Dj0 )

20.08
20.29

14.40
14.95

14.33
14.88

89.26
89.36

19.66
19.71

Med(Djk )
Mean(Djk )
% Correct

13.03
15.29
100.00

12.83
14.79
94.33

12.90
14.90
94.46

8.89
9.84
64.23

12.54
13.82
64.23

Med(Dj0 )
Mean(Dj0 )

32.91
32.88

34.13
34.08

34.00
33.85

54.43
53.46

34.20
33.73

BLP

Nevo

Table 5: Diversion to Best Substitute and Outside Good
The first panel in each set reports diversion to each product-market pair‚Äôs best substitute. The second
panel in each set reports diversion to the outside good.

BLP

Nevo

med(|y ‚àí x|)

mean(y ‚àí x)

med(|y ‚àí x|)

mean(y ‚àí x)

10.57
10.47
19.53
19.06

2.49
2.81
-22.38
-6.48

3.66
3.34
38.80
19.06

-2.73
-2.03
-44.41
-6.48

21.25
21.39
191.18
33.71

27.94
27.85
-170.71
32.73

4.92
4.63
38.64
32.22

-0.55
-0.64
-29.47
8.46

32.62
33.03
149.38
39.28

-31.63
-32.19
168.63
17.46

3.86
3.25
44.63
29.95

5.40
4.35
58.46
12.33

Top 5 Substitutes
Small Quality Change
Second Choice
Logit
Nested Logit Djk (p)
All Products
Small Quality Change
Second Choice
Logit
Nested Logit Djk (p)
Outside Good
Small Quality Change
Second Choice
Logit
Nested Logit Djk (p)

Table 6: Relative % Difference in Diversion Measures
Baseline is small-price change measure: Djk (pj ).
Observations are product-market pairs and are equally weighted.
Median Absolute Deviation med(|y ‚àí x|) and ‚ÄúBias‚Äù E[y ‚àí x] where (x, y) are log-diversion.

26

to the outside good, which in the case of the BLP data is extremely large.44 Diversion to
the outside good is larger when considering a small price change (around 20%) than when
considering a change in quality or second choice data (around 15%). This can be explained by
differences in the weights in Table 2, and theoretically could go in either direction. The only
difference between a marginal change in quality and second-choice data is a factor of 1‚àís1ij (x) ,
but for most products 1‚àís1ij (x) ‚âà 1 because the outside share is so large (often greater than
90%). However, responses to small changes in prices are substantially different because they
place additional weight on more price sensitive consumers (large |Œ±i |). In the BLP example,
Œ±
price sensitivity is quite dispersed because it tracks income (Œ±i = income
), and low-income
i
consumers have much larger outside good shares si0 (x). We illustrate our decomposition of
individual diversion measures and weights in more detail in Section 4.2.
We see a different pattern with the Nevo example. Here measures of diversion to the best
substitute and diversion to the outside good are less sensitive to the particular weighting
scheme that is used. This is despite the fact that there is still quite a bit of heterogeneity in
the price sensitivity Œ±i as demonstrated by the magnitude of œÉprice and œÄprice√óinc and œÄprice√óinc2
from Table 3.45 This result is due to the fact that there is not as much heterogeneity in
the underlying individual diversion ratios Djk,i (x) as demonstrated by two features of this
market. First, the diversion ratios to each product‚Äôs best substitute are similar between
the nested-logit model, which predicts substitution proportional to share, and the randomcoefficients model under any intervention. Second, beyond two discrete types of cereal (i.e.,
mushy and non-mushy), the extent of heterogeneous preferences for other characteristics in
the Nevo application (i.e., sugar) is not very large.
This last point is highlighted by the ‚Äú% Correct,‚Äù which reports the fraction of observations for which each model predicts the same best substitute as the small-price change
measure of diversion Djk (pj , x). For the Nevo example, the three interventions identify the
same best substitute at least 94% of the time, while the nested-logit model does less well,
identifying the top substitute only 64% of the time.46 In the BLP example, nearly all interventions and specifications predict the same substitute for all products; thus, even the plain
logit agrees with Djk (pj , x) 95% of the time. What is perhaps disappointing for the BLP
example is that diversion ratios to best substitutes are generally quite small (around 5%).
This is in part driven by the larger number of products, but also suggests the possibility
44

Berry et al. (1999) defines the market as every household in the United States purchasing up to one
automobile each year.
45
We provide histograms of Œ±i for both BLP and Nevo in Figure B.1 of the Appendix.
46
This is mostly because the nested-logit model cannot distinguish between mushy and non-mushy cereal.

27

that even more random coefficients or demographic interactions might have been helpful.
In Table 6, we provide a standard econometric comparison among the different diversion
measures. We use the small-price change case as our baseline, and compare (on the log-scale)
the discrepancies between average diversion ratios measured using small quality changes,
second-choice data, logit, and nested-logit models. We use two metrics for our comparison,
the mean difference (bias), and the median absolute deviation (dispersion).47 For the BLP
example, we find that diversion to the top 5 substitutes from alternative ‚Äúinstruments‚Äù
(second-choice data and small quality changes) are off by around 10% on average with
some being overstated and others being understated when compared to the small price
change measure. As in Table 5 there are substantial discrepancies among the different
‚Äúinstruments‚Äù for the BLP data with second-choice and small-quality changes predicting
around 30% less diversion to the outside good than a small-price change, and around 27%
more diversion to ‚Äúall inside goods.‚Äù The results are much more similar in the Nevo example,
with the various random coefficients diversion measures all within around 5% of the smallprice change predictions. As expected, the nested-logit model under-predicts substitution to
the top substitutes and over-predicts substitution to ‚Äúthe field‚Äù of all inside goods.48
This raises the question: why do we see substantial discrepancies in diversion measured
using small-price changes versus small changes in quality or second-choice data in the BLP
data, but not in the Nevo (fake) data?

4.2. Decomposition of Diversion Measures
In this section we demonstrate our decomposition from (7) which shows that we can decompose any measure of diversion ratios (second-choice data, small price changes, small quality
changes) into two components: (1) an individual diversion measure Djk,i (x) that does not
depend on the policy instrument; and (2) a set of weights wij (x, zj , zj0 ) that depend on the
policy change, but do not depend on the identity of the substitute. The individual treatment effects (diversion ratios) are considered structural parameters in the sense that they
are policy invariant aspects of consumer preferences, which do not depend on whether we
measure diversion by changing price or product quality (or by how much).
This policy invariance has led objects like Djk,i (x) to be described as marginal treatment
effects in the language of Heckman and Vytlacil (2005), as they can be integrated over
different sets of weights to calculate the well-known treatment effects parameters (ATE,
47
48

In Appendix B we provide a pairwise correlation matrix for these measures.
The nested logit does a good job matching the sales-weighted outside good diversion in Table 5.

28

ATT, ATUT, LATE, etc.).49 To illustrate this connection, we present two sets of plots in
Figure 1 and Figure 2. These are meant to parallel those in Carneiro et al. (2011), which
plot the M T E(x) against the propensity score (i.e., the probability that an individual is
‚Äútreated‚Äù).
sik (x)
for each simulated ‚ÄúindiIn the first panel of each plot, we compute Djk,i (x) = 1‚àís
ij (x)
vidual‚Äù in the Berry et al. (1999) model. We plot this against each individual‚Äôs purchase
probability for product j, sij , because our treatment is ‚Äúnot buying j.‚Äù Figure 1 plots diversion measures from a Honda Accord to two substitutes: Toyota Camry and Cadillac DeVille.
The plots reveal a large number of blue dots near the origin, representing individuals who are
unlikely to purchase either an Accord or a Camry. Indeed, most consumers in the BLP data
don‚Äôt purchase any automobile at all. As we move right across the graph, we find that individuals who are more likely to purchase an Accord are also more likely to purchase a Camry.
To help visualize this relationship, we provide a local linear smoothed line in blue, which
is clearly increasing. This increasing relationship tells us about the covariance between the
individual diversion measures and their weights in (6), and indicates that the products are
close substitutes beyond what would be predicted by share alone. What is also interesting is
that although these products are ‚Äúclose substitutes‚Äù even at the individual level, the highest
diversion ratio we observe is around 8%.
As a contrasting case, in green in Figure 1 we conduct the same exercise but with the bestselling luxury car (the Cadillac DeVille) as the substitute instead. There are some individuals
with diversion ratios as high as 14% between the Accord and the DeVille. However, because
those individuals are on the left of the graph, these are individuals who are unlikely to
buy the Accord in the first place (presumably because they are luxury car buyers, rather
than economy car buyers). Although it is harder to see because of the large number of
non-car buyers towards the bottom of the figure, the smoothed green line slopes downwards,
suggesting that individuals who really like the Accord are less likely to switch to the DeVille.
In the second panel of Figure 1 we plot a histogram for two different sets of weights
across individuals. In blue, we plot the set of weights corresponding to a small price change
wij (x) = |Œ±i |sij (x)(1 ‚àí sij (x)), while in red we plot the weights corresponding to secondchoice data (or product removal) wij (x) = sij (x). For the most part, the resulting histogram
is purple, suggesting that the weights are largely similar for the two interventions. However,
we see that second-choice weights tend to place slightly more weight on ‚Äúmore likely‚Äù Accord
buyers (towards the right of the figure) than the small price change weights do.
49

This is demonstrated in (7).

29

0.10

Diversion Ratios

0.08

0.06

0.04

0.02

0.00

0.02

0.04

0.06

Pr(vi < P(z)) = sij for Honda Accord

Djk, i to Toyota Camry
Djk, i to Cadillac DeVille

0.08

0.10

0.00

Toyota Camry (Second Choice)
Cadillac DeVille (Small Change)
Cadillac DeVille (Second Choice)

Toyota Camry (Small Change)

0.10

0.08

Weighting

0.06

0.04

0.02

0.00

0.02

0.04

0.06

Pr(vi < P(z)) = sij for Honda Accord

30

Marginal Price Change: sij √ó (1 sij) √ó i

0.08

0.10

0.00

Second Choice: sij

Figure 1: Decomposition of Diversion Measures for Honda Accord

0.025

0.020

Diversion Ratios

0.015

0.010

0.005

0.000

0.002

0.004

0.006

0.008

0.010

Pr(vi < P(z)) = sij for BMW 735i

Djk, i to BMW 535i
Djk, i to Mercedes Benz 420s
BMW 535i (Small Change)

0.012

0.014 0.000

BMW 535i (Second Choice)
Mercedes Benz 420s (Small Change)
Mercedes Benz 420s (Second Choice)

0.25

0.20

Weighting

0.15

0.10

0.05

0.000

0.002

0.004

0.006

0.008

Pr(vi < P(z)) = s31
ij for BMW 735i

Marginal Price Change: sij √ó (1 sij) √ó i

0.010

0.012

0.014 0.00

Second Choice: sij

Figure 2: Decomposition of Diversion Measures for BMW 7 Series

The four horizontal lines in the top panel of the figure indicate the average diversion
from Accord to Camry (two lines in grey) and from Accord to Cadillac DeVille (two lines in
black). The two measures for each pair of substitutes use the histograms in the lower panel
to weight observations. The average diversion ratio from Accord to Camry obtained from a
small price change is around 3.2%; measuring the same diversion ratio from second-choice
data gives an estimate of average diversion of around 3.8%. The second-choice measure of
average diversion is higher because the smoothed MTE for the Toyota Camry is upward
sloping, and the histogram of weights for the second-choice measure places more weight on
individuals to the right of the figure (with higher sij ‚Äôs).
Even though there are some individuals with very high diversion ratios from the Accord
to the DeVille, the average diversion ratios from a small price change or second-choice data
are both quite small, < 1%, because the high diversion individuals receive such low weight
(presumably because they represent a tiny fraction of likely Accord buyers).50
We observe a similar pattern in Figure 2, which considers diversion from the BMW
7-series to the BMW 5-series and the Mercedes 420s (three of the most expensive luxury
vehicles in the dataset). Again, the majority of the points are around the origin, indicating
that most simulated individuals don‚Äôt purchase any of these high-end luxury vehicles. There
is an increasing trend for diversion to both substitutes, as both the 5-series and the Mercedes
are close substitutes to the 7-series. However, even among these close substitutes, the largest
individual diversion ratio is less than 2.5%, and the average diversion measures are closer to
1.5% for the BMW 5-series (and 0.5% for the Mercedes).

4.3. Wald Estimates of Diversion Measures
A different way to decompose heterogeneity in the diversion ratio measures is to start with
the same question we began this article with: what would we measure by considering a
ceteris paribus increase in price from pj ‚Üí p0j ? Different Wald estimators will produce
50

We should caution that the figures can still obfuscate some of the underlying heterogeneity. Two individuals may have similar sij ‚Äúpropensity scores‚Äù for the Accord, but for different reasons. The first may
be on the margin of buying a car or not (low income, high price sensitivity). The second may be a buyer
who is primarily shopping for luxury cars. Our figures may place these individuals at the same spot on the
x-axis making this kind of multi-dimensional heterogeneity hard to visualize. This also explains why the
relationship between the Accord and DeVille can be downward sloping but still have second-choice diversion
that is higher than diversion from a small price change.

32

different (local) average diversion ratio measures. Consider the Wald estimate from (3):
Wald(zj , zj0 , x)

=

qk (zj0 , x) ‚àí qk (zj , x)
qj (zj0 , x) ‚àí qj (zj , x)

For this example, we again focus solely on the BLP automobile data because there is less variation in the Nevo data in the underlying individual diversion measures Djk,i (x), and because
the BLP data include product names that make the diversion ratios more interpretable.
We consider an increase in price pj ‚Üí p0j or reduction in quality Œæj ‚Üí Œæj0 and plot the
results for the Honda Accord and the BMW 7-series respectively in Figures 3 and 4, where
the x-axis corresponds to the share of initial Accord (BMW) consumers who continue to
the purchase the Accord (BMW), and the y-axis corresponds to the Wald estimate of the
diversion ratio. As we move toward the right, we consider larger price increases (or quality
reductions) until the fraction of customers still purchasing the Accord or BMW approaches
zero (the choke price). Dots on the graph denote 5% and 10% price increases, and a horizontal
line marks the second-choice average (ATUT) diversion measure.
Figures 3 and 4 illustrate the fact that as we increase price (decrease quality) to the choke
price (quality), the LATE estimates of diversion coincide with the second choice (ATUT)
measure. The figures also show that the second-choice data and Wald estimates using quality
(Œæj ) are more similar to one another than they are to the Wald estimates from price. This
is likely to hold more generally, and is consistent with our findings

 in Table 5 because the
s (x)
2nd choice
weights from Table 2 for a second-choice measure of diversion, w
eij
(x) ‚àù 1‚àísijij (x) ,
quality
and for a quality measure of diversion (w
eij
(x) ‚àù sij (x)) are very similar, whereas the
price
price change intervention places more weight on more price-sensitive individuals (w
eij
(x) ‚àù
|Œ±i |sij (x)).51 In Figures 3 and 4, the average diversion ratio from a finite price change is
smaller than the average diversion ratio obtained from quality changes or second-choice data.
However, for other pairs of products, this pattern could be reversed. Indeed, the relationship
between the LATE for a given finite price change, and a second-choice measure need not even
be monotone (e.g., the measured (local) average diversion ratio may be increasing for small
price changes, but decreasing for larger ones). More generally, the relationship between the
average diversion for a finite price change vs. second-choice data is driven by the covariance
between Œ±i and the corresponding shares (weights) sij (x), as illustrated in the previous
51

s (x)

ij
This is particularly true if 1‚àís
‚âà sij (x) when shares are small. Here ‚Äúprice‚Äù is effectively any
ij (x)
characteristic with a random coefficient and ‚Äúquality‚Äù is the utility index or any ‚Äúvertical‚Äù characteristic
lacking a random coefficient. The correct LATE weights are proportional to q(zj , x) ‚àí q(zj0 , x) rather than
the derivative of qj (Zj , x) at zj .

33

section. Without placing strong restrictions on the underlying heterogeneity, it is impossible
to make statements like: ‚ÄúSmall price changes lead to lower estimates of diversion ratios
than second-choice data.‚Äù52

4.4. Willingness to Pay Measures

log(sjt )

Individual
BLP

BLP

BLP

1.0749*
(0.0001)

1.0519*
(0.0001)
-0.2233*
(0.0005)

log(Dj,0 )
log(kŒ±i k)
R2
Adjusted R2
Observations

0.9951
0.9951
436199

0.9967
0.9967
436199

0.9955*
(0.0000)
-0.0032*
(0.0002)
-1.0113*
(0.0005)
0.9997
0.9997
436199

Aggregate
BLP
Nevo

BLP

Nevo

Nevo

BLP

Nevo

0.9955*
(0.0000)

1.0255*
(0.0002)

1.0353*
(0.0002)
0.1090*
(0.0009)

0.7669*
(0.0087)

0.9265*
(0.0061)
-0.6733*
(0.0114)

1.0144*
(0.0020)

1.0105*
(0.0010)
0.1786*
(0.0022)

-1.0164*
(0.0004)
0.9997
0.9997
436199

0.9975
0.9975
45051

0.9981
0.9981
45051

0.7784
0.7783
2217

0.9139
0.9138
2217

0.9915
0.9915
2256

0.9978
0.9978
2256

Table 7: Correlation with WTP Measure for Nevo (2000b) and Berry et al. (1999).
For individual-draw specifications sijt (x) and Dj0,i (x) are used.
Approximately half of observations for BLP W T P (i, j) are excluded because W T P (i, j) ‚âà 0 to machine
precision.

In Section 3.8, we demonstrate the relationship between the willingness-to-pay (WTP)
measure (often used to analyze bargained outcomes and hospital mergers), the individual
share sij (x), the diversion to the outside good Dj0,i (x), and the individual price sensitivity
R
sij (x)
‚àÇFi =
Œ±i . More specifically, in (15) we showed that W T Pj = W T Pij ‚àÇFi = Dj0,i (x) |Œ±i |¬∑s
i0 (x)
R
sij (x)
‚àÇFi . We can illustrate this relationship by considering the following two (de|Œ±i |(1‚àísij (x))
composition) regressions:
ln W T Pijt = Œ≤0 + Œ≤1 ln sjt,i (x) + Œ≤2 ln Djt0,i (x) + Œ≤3 ln |Œ±it |

+Œµijt

ln W T Pjt = Œ≥0 + Œ≥1 ln sjt (x) + Œ≥2 ln Djt0 (x)

+Œµjt

To run these regressions, we construct the W T P measure for every individual, in every
market, for each product. For example, W T Pijt might represent the willingness to pay of
a particular consumer for having a Honda Accord in his or her choice set in 1990; or it
might represent the willingness to pay to have Apple Cinnamon Cheerios on the shelf of a
supermarket in a particular week. W T Pjt represents the average of the individual measures
over all of the households i.
52

In some sense, this should be obvious because diversion ratios must sum to one, and for one diversion
ratio to go up, others (including the outside good) must go down.

34

Local Average Treatment Effect: Diversion from Honda Accord to Toyota Camry

0.038

0.037

0.036

0.035

0.034

0.033

1.0

0.8

0.6
0.4
Fraction of Initial Share for Honda Accord

0.2

Price
Quality
Second Choice
0.0

0.2

Price
Quality
Second Choice
0.0

Local Average Treatment Effect: Diversion from Honda Accord to Cadillac DeVille

0.013

0.012

0.011

0.010

0.009

0.008

0.007

0.006
1.0

0.8

0.6
0.4
Fraction of Initial Share for Honda Accord

Figure 3: Local Average Diversion Measures from Accord to Camry and Deville

35

Local Average Treatment Effect: Diversion from BMW 735i to BMW 535i

0.0155

0.0150

0.0145

0.0140

0.0135

Local Average Treatment Effect: Diversion from BMW 735i to Mercedes Benz 420s

1.0

0.8

0.6
0.4
Fraction of Initial Share for BMW 735i

0.2

Price
Quality
Second Choice
0.0

0.2

Price
Quality
Second Choice
0.0

0.00625

0.00600

0.00575

0.00550

0.00525

0.00500

0.00475

0.00450
1.0

0.8

0.6
0.4
Fraction of Initial Share for BMW 735i

Figure 4: Local Average Diversion Measures from BMW 7-series to 5-Series and Mercedes

36

We report the regression estimates in Table 7. At the individual level, we are able to
explain over 99% of the variance in the individual level W T Pij measure using just sjt,i (x)
and Djt0,i (x) for both the BLP and Nevo examples. In accordance with (15), the third and
fourth columns demonstrate in the BLP application that once we control for the price sensitivity ln(|Œ±i |), diversion to the outside good at the individual level is no longer economically
meaningful.
What is perhaps more surprising is that we are also able to explain average market-level
willingness to pay. The average willingness to pay for access to a Camry or Cheerios in
the choice set can be explained using only the market level share sjt (x) and outside good
diversion Dj0 (x). In the Nevo (fake) data, we are able to explain 99.1% of the variance
in W T Pj using just sjt (x) and 99.8% of variance once we also include the (market-level)
diversion to the outside good. We see similar results for the BLP data where we explain
roughly 78% of the variance using just sjt (x) and 91.3% of the variance in W T Pj using
sjt (x) and market-level diversion to the outside good Dj0t (x). We should caution that at
the aggregate level, this is neither a sufficient statistic representation nor a decomposition
in the sense that while the coefficient on ln sjt (x) is approximately one, the coefficient on
Dj0t (x) is not easily discerned without running the regression. In fact, it has a different sign
in the Nevo data and the BLP data (because of how it covaries at the individual level with
the price sensitivity |Œ±i |).53
What this does highlight is that estimates of W T P are largely about own share sjt (x),
which is often observed as data at the market level (and possibly at the individual level for
some datasets ‚Äì such as patient discharge data for hospitals). It also highlights the value
of accurately measuring diversion to the outside good, including possibly from additional
(micro) moments. Second-choice data, such as knowing what fraction of consumers would
switch to a hospital outside the geographic market if a particular hospital were to close, may
also be valuable such as in Raval et al. (2019).54

5. Conclusion
We provide a treatment effects interpretation of diversion ratios, and demonstrate how different ceteris paribus interventions (price changes, quality changes, characteristic changes,
53

Individual outside good diversion is positively correlated with Œ±i in the BLP data and negatively correlated with Œ±i in the Nevo data. This may seem surprising at first, but the demographics (kids and income)
and the relationship between price and the constant in the Nevo data induce the negative correlation.
sij (x)
54
Recall that second-choice data integrates sik (x) over the weights 1‚àís
, while WTP integrates |Œ±1i |
ij (x)
over the same set of weights, as demonstrated in Section 3.8.

37

and assortment changes) can be used to identify diversion ratios. While these measures of
diversion ratios will not in general agree with one another, we provide a framework to decompose these average measures into individual diversion ratios (policy invariant structural
parameters) and a set of weights, which vary with the intervention. We provide additional
results showing how willingness-to-pay (WTP) is related to diversion to the outside good,
and individual choice probabilities.
The object of interest may vary with the application. Sometimes the object of interest
is a price change from a merger simulation or UPP calculation for a horizontal merger, in
which case the researcher is likely interested in diversion ratios measured from small price
changes. In other cases the relevant object may be the substitution induced from quality
increases/reductions or from changes in product assortment. In an ideal world, the object of
interest would coincide with the data available to the researcher. In practice, researchers may
have access to additional data from customer surveys, win-loss data, or customer switching
behavior, which may or may not coincide with the diversion measure of interest. When these
measures do not perfectly coincide, our framework provides a way to interpret discrepancies
between different diversion measures.
In many cases researchers may still want to estimate a fully parametric model of demand
(or supply and demand) such as in Berry et al. (1995) or Nevo (2000a). We hope that a
better understanding of diversion ratios can help make the outputs of these models more
interpretable. In simulations, we find that the diversion ratios measured from parametric
models in two applications are perhaps more similar than one might have anticipated. For the
automobile example, second-choice measures of diversion ratios are within 20% of measures
based on small price changes, so that a 5% diversion ratio might be measured in the range
of (4%, 6%). For the simulated cereal data example, the estimated measures are even less
dispersed, so that they are generally within 5% of one another. We caution that these
findings are not guaranteed (or even likely) to hold in all potential examples, and that both
settings have relatively large outside good shares. This is important, because our simulations
also indicate that measures of diversion ratios that rely on parametric models tend to be
sensitive to the specification of the outside good share or market size, indicating a potential
need for additional data or moment restrictions (such as in Berry et al. (2004)) for this class
of models.

38

References
Angrist, J. D., K. Graddy, and G. W. Imbens (2000): ‚ÄúThe interpretation of instrumental variables estimators in simultaneous equations models with an application to the
demand for fish,‚Äù The Review of Economic Studies, 67, 499‚Äì527.
Berry, S. (1994): ‚ÄúEstimating discrete-choice models of product differentiation,‚Äù RAND
Journal of Economics, 25, 242‚Äì261.
Berry, S., J. Levinsohn, and A. Pakes (1995): ‚ÄúAutomobile Prices in Market Equilibrium,‚Äù Econometrica, 63, 841‚Äì890.
‚Äî‚Äî‚Äî (1999): ‚ÄúVoluntary Export Restraints on Automobiles: Evaluating a Trade Policy,‚Äù
American Economic Review, 89, 400‚Äì430.
‚Äî‚Äî‚Äî (2004): ‚ÄúDifferentiated Products Demand Systems from a Combination of Micro and
Macro Data: The New Car Market,‚Äù Journal of Political Economy, 112, 68‚Äì105.
Berry, S. T. and P. A. Haile (2014): ‚ÄúIdentification in Differentiated Products Markets
Using Market Level Data,‚Äù Econometrica, 82, 1749‚Äì1797.
Capps, C., D. Dranove, and M. Satterthwaite (2003): ‚ÄúCompetition and Market
Power in Option Demand Markets,‚Äù The RAND Journal of Economics, 34, 737‚Äì763.
Carlton, D. W. (2010): ‚ÄúRevising the Horizontal Merger Guidelines,‚Äù Journal of Competition Law and Economics, 6, 619‚Äì652.
Carlton, D. W. and M. Israel (2010): ‚ÄúWill the New Guidelines Clarify or Obscure
Antitrust Policy?‚Äù The Antitrust Source, 1‚Äì4.
Carneiro, P., J. J. Heckman, and E. J. Vytlacil (2011): ‚ÄúEstimating Marginal
Returns to Education,‚Äù American Economic Review, 101, 2754‚Äì81.
Chetty, R. (2009): ‚ÄúSufficient Statistics for Welfare Analysis: A Bridge Between Structural
and Reduced-Form Methods,‚Äù Annual Review of Economics, 1, 451‚Äì488.
Cheung, L. (2011): ‚ÄúThe Upward Pricing Pressure Test for Merger Analysis: An Empirical
Examination,‚Äù Working Paper.
Competition and Markets Authority (2017): ‚ÄúRetail Mergers Commentary,‚Äù April
10, https://www.gov.uk/government/publications/retail-mergers-commentary-cma62.
39

Conlon, C. and J. Gortmaker (2020): ‚ÄúBest Practices for Demand Estimation with
pyBLP,‚Äù RAND Journal of Economics.
Conlon, C. and J. H. Mortimer (2013): ‚ÄúDemand Estimation Under Incomplete Product Availability,‚Äù American Economic Journal: Microeconomics, 5, 1‚Äì30.
Conlon, C. and N. Rao (2019): ‚ÄúThe Price of Liquor is Too Damn High,‚Äù Working
Paper.
Crawford, G. S. and A. Yurukoglu (2012): ‚ÄúThe Welfare Effects of Bundling in
Multichannel Television Markets,‚Äù American Economic Review, 102, 643‚Äì85.
Ericson, K. M. and A. Starc (2015): ‚ÄúMeasuring Consumer Valuation of Limited
Provider Networks,‚Äù American Economic Review, 105, 115‚Äì19.
Farrell, J. and C. Shapiro (2010): ‚ÄúAntitrust Evaluation of Horizontal Mergers: An
Economic Alternative to Market Definition,‚Äù The B.E. Journal of Theoretical Economics,
10, 1‚Äì41.
Gotts, I. K. (2010): ‚ÄúAre the New Guidelines Representational Art Or Pop Art in the
End?‚Äù The Antitrust Source, 1‚Äì4.
Gowrisankaran, G., A. Nevo, and R. Town (2015): ‚ÄúMergers When Prices Are
Negotiated: Evidence from the Hospital Industry,‚Äù American Economic Review, 105, 172‚Äì
203.
Hausman, J. A. (2010): ‚Äú2010 Merger Guidelines: Empirical Analysis,‚Äù Working Paper.
Heckman, J. J. (2010): ‚ÄúBuilding Bridges Between Structural and Program Evaluation
Approaches to Evaluating Policy,‚Äù Journal of Economic Literature, 48, 356‚Äì398.
Heckman, J. J. and E. Vytlacil (2005): ‚ÄúStructural Equations, Treatment Effects, and
Econometric Policy Evaluation,‚Äù Econometrica, 73, 669‚Äì738.
Ho, K. (2006): ‚ÄúThe welfare effects of restricted hospital choice in the US medical care
market,‚Äù Journal of Applied Econometrics, 21, 1039‚Äì1079.
‚Äî‚Äî‚Äî (2009): ‚ÄúInsurer-Provider Networks in the Medical Care Market,‚Äù American Economic Review, 99, 393‚Äì430.

40

Ho, K. and R. S. Lee (2019): ‚ÄúEquilibrium Provider Networks: Bargaining and Exclusion
in Health Care Markets,‚Äù American Economic Review, 109, 473‚Äì522.
Imbens, G. W. and J. D. Angrist (1994): ‚ÄúIdentification and Estimation of Local
Average Treatment Effects,‚Äù Econometrica, 62, 467‚Äì475.
Jaffe, S. and E. Weyl (2013): ‚ÄúThe first-order approach to merger analysis,‚Äù American
Economic Journal: Microeconomics, 5, 188‚Äì218.
Jaffe, S. and G. Weyl (2010): ‚ÄúLinear Demand Systems are Inconsistent with Discrete
Choice,‚Äù The B.E. Journal of Theoretical Economics, 10, 52‚Äì52.
Katz, M. L. and C. Shapiro (2003): ‚ÄúCritical Loss: Let‚Äôs Tell the Whole Story,‚Äù Antitrust
Magazine.
Manski, C. and D. McFadden (1981): Structural Analysis of Discrete Data with Econometric Applications, The MIT Press.
Mansley, R., N. Miller, C. Ryan, and M. Weinberg (2019): ‚ÄúNotes on the Nested
Logit Demand Model,‚Äù http://www.nathanhmiller.org/nlnotes.pdf, notes.
McFadden, D. and K. Train (2000): ‚ÄúMixed MNL Models for Discrete Response,‚Äù
Journal of Applied Econometrics, 15, 447‚Äì470.
Miller, N., M. Remer, C. Ryan, and G. Sheu (2016): ‚ÄúPass-Through and the Prediction of Merger Price Effects,‚Äù Journal of Industrial Economics, 64, 684‚Äì709.
Miravete, E. J., K. Seim, and J. Thurk (2018): ‚ÄúMarket Power and the Laffer Curve,‚Äù
Econometrica, 86, 1651‚Äì1687.
Nevo, A. (2000a): ‚ÄúMergers with differentiated products: the case of the ready-to-eat cereal
industry,‚Äù RAND Journal of Economics, 31, 395‚Äì421.
‚Äî‚Äî‚Äî (2000b): ‚ÄúA Practitioner‚Äôs Guide to Estimation of Random Coefficients Logit Models
of Demand (including Appendix),‚Äù Journal of Economics and Management Strategy, 9,
513‚Äì548.
‚Äî‚Äî‚Äî (2001): ‚ÄúMeasuring Market Power in the Ready-to-Eat Cereal Industry,‚Äù Econometrica, 69, 307‚Äì342.

41

Raval, D., T. Rosenbaum, and N. Wilson (2019): ‚ÄúUsing Disaster Induced Closures
to Evaluate Discrete Choice Models of Hospital Demand,‚Äù Working Paper.
Reynolds, G. and C. Walters (2008): ‚ÄúThe use of customer surveys for market definition and the competitive assessment of horizontal mergers,‚Äù Journal of Competition Law
and Economics, 4, 411‚Äì431.
Schmalensee, R. (2009): ‚ÄúShould New Merger Guidelines Give UPP Market Definition?‚Äù
Antitrust Chronicle, 12, 1.
Town, R. and G. Vistnes (2001): ‚ÄúHospital competition in HMO networks,‚Äù Journal of
Health Economics, 20, 733‚Äì753.
Wald, A. (1940): ‚ÄúThe Fitting of Straight Lines if Both Variables are Subject to Error,‚Äù
Ann. Math. Statist., 11, 284‚Äì300.
Willig, R. (2011): ‚ÄúUnilateral Competitive Effects of Mergers: Upward Pricing Pressure,
Product Quality, and Other Extensions,‚Äù Review of Industrial Organization, 39, 19‚Äì38.
Working, E. J. (1927): ‚ÄúWhat Do Statistical ‚ÄùDemand Curves‚Äù Show?‚Äù The Quarterly
Journal of Economics, 41, 212‚Äì235.

42

Appendices
A. Theory Appendix
A.1. Proofs and Derivations
Analogue to LATE Theorem (Imbens and Angrist, 1994)]
Under the following conditions:
P
(a) Mutually Exclusive and Exhaustive Discrete Choice: dij ‚àà {0, 1} and j‚ààJ dij = 1.
(b) Exclusion: uik (pj ) = uik (p0j ) for all k 6= j and any (pj , p0j );
(c) Monotonicity: uij (p0j ) ‚â§ uij (pj ) for all i and any (p0j > pj ); and
(d) Existence of a first-stage: P r(dij (pj ) = 0) 6= P r(dij (p0j ) = 0) for (p0j > pj );
(e) Random Assignment: (uij (Pj ), uik (Pj )) ‚ä• Pj ,
then the Wald estimator from (3):
qk (p0j , x) ‚àí qk (pj , x)

 = E[Djk,i (x)|dij (pj , x) > dij (p0j , x)].
‚àí qj (p0j , x) ‚àí qj (pj , x)
Proof of Proposition 1:
We suppress x because everything is done conditional on x. We begin by observing under
the discrete choice assumption qk = M ¬∑ sk where sk is the market share of good k (including
an outside option) and M is the size of the market:
qk (p0j , x) ‚àí qk (pj , x)

sk (p0j , x) ‚àí sk (pj , x)


=
‚àí qj (p0j , x) ‚àí qj (pj , x)
‚àí sj (p0j , x) ‚àí sj (pj , x)

(A.1)

We also use the definition that sk (Pj , x) = E[dik (Pj ) = 1|x] = E[dik (Pj )|x]. This says
the market share is equal to the average purchase probability when choices are discrete,
exhaustive, and mutually exclusive and follows from (a).
Define ui = maxk0 uik0 for k 0 ‚àà J \ {j, k} (the best product for i other than (j, k)). Notice

43

that ui (pj ) = ui (p0j ) for any (pj , p0j ) (the Exclusion restriction). Consider the numerator:
E[dik (Pj )|Pj = p0j ] = P r(uik (p0j ) > uij (p0j ) ; uik (p0j ) > ui (p0j )|Pj = p0j )
= P r(uik > uij (p0j ) ; uik > ui |Pj = p0j )
= P r(uik > uij (p0j ) ; uik > ui )

by exclusion

by random assignment

E[dik (Pj )|Pj = pj ] = P r(uik (pj ) > uij (pj ) ; uik (pj ) > ui (pj )|Pj = pj )
= P r(uik > uij (pj ) ; uik > ui |Pj = pj )
= P r(uik > uij (pj ) ; uik > ui )

by exclusion

by random assignment

This means we can re-write the numerator:
E[dik (Pj )|Pj = p0j ] ‚àí E[dik (Pj )|Pj = pj ] = P r(uik > uij (p0j ) ; uik > ui ) ‚àí P r(uik > uij (pj ) ; uik > ui )
= P r(uij (p0j ) < uik < uij (pj ) ; uik > ui )

by Monotoncity

= P r(uik > uij (p0j ) ; uij (pj ) > uik ; uik > ui )
= P r(max{uik , ui } > uij (p0j ) ; uij (pj ) > max{uik , ui } ; uik > ui )

by defn dij
= P r uik > ui ; dij (p0j ) = 0 ; dij (pj ) = 1
The denominator, beginning with the exclusion restriction:
E[dij (Pj )|Pj = p0j ] = 1 ‚àí P r(uij (p0j ) > uik (p0j ) ; uij (p0j ) > ui (p0j )|Pj = p0j )

by random assignment
= 1 ‚àí P r uij (p0j ) > max{uik , ui }
E[dij (Pj )|Pj = pj ] = 1 ‚àí P r(uik (pj ) > uij (pj ) ; uik (pj ) > ui (pj )|Pj = pj )
= 1 ‚àí P r (uij (pj ) > max{uik , ui })

by random assignment

And we can re-write the denominator:

E[dij (Pj )|Pj = p0j ] ‚àí E[dij (Pj )|Pj = pj ] = P r (uij (pj ) > max{uik , ui }) ‚àí P r uij (p0j ) > max{uik , ui }

= P r uij (p0j ) < max{uik , ui } < uij (pj )
by Monotoncity

= P r max{uik , ui } > uij (p0j ) ; uij (pj ) > max{uik , ui }

= P r dij (p0j ) = 0 ; dij (pj ) = 1
by defn dij

44

The ratio in (A.1) is:55

P r uik > ui ; dij (p0j ) = 0 ; dij (pj ) = 1
E[dik (p0j , x)] ‚àí E[dik (pj , x)]

=
E[dij (p0j , x)] ‚àí E[dij (pj , x)]
P r dij (p0j ) = 0 ; dij (pj ) = 1

= P r uik > ui | dij (p0j ) = 0 ; dij (pj ) = 1


= E 1[uik > ui ] | dij (p0j ) < dij (pj )


= E Djk,i (x) | dij (p0j , x) < dij (pj , x) .

by Bayes‚Äô Rule

The last line is merely the definition of the individual diversion ratio: that individual i prefers
k to any non j alternative so that i‚Äôs ‚Äútreatment effect‚Äù is given by: Yi (1)‚àíYi (0) = 1[uik > ui ].
Notice this satisfies the ‚ÄúIndependence‚Äù assumption of Imbens and Angrist (1994). That is,
Djk,i (x) = 1[uik (x) > ui (x)] does not depend on the ‚Äúinstrument‚Äù Pj .
In words, the Wald estimator delivers the expected treatment effect on the compliers (ie:
individuals for whom (dij (pj ) = 1, dij (p0j ) = 0). The compliers are the individuals who would
have purchased j at price pj and who do not purchase j at price p0j .

A.2. Link to marginal treatment effect: Derivation of (6)
Because we have a latent index model for the discrete choice problem this is straightforward.
The conventional definition of the marginal treatment effect is literally the treatment effect
for the individual indifferent between treatment and non-treatment:
M T E(vs ) = E[Yi (1) ‚àí Yi (0) | P r(Ti = 1) = ŒΩi ]
= E [1[uik (ŒΩi ) > ui (ŒΩi )] | uij (ŒΩi ) = max{uik (ŒΩi ), ui (ŒΩi )}]
= E [Djk,i (x, ŒΩi ) | uij (ŒΩi ) = max{uik (ŒΩi ), ui (ŒΩi )}]
One possible interpretation of what ŒΩi means is that ŒΩi = Œµij in a random utility model so that
uij = uij + Œµij . That is we could hold all other Œµi,‚àíj fixed (part of x) and integrate out over
just the distribution of unobserved tastes for j. In fact, this would be the convention from
Heckman and Vytlacil (2005). Their idea is to rank all individuals by their propensity score,
the probability of not purchasing j: H(ŒΩi ) = P r[dij (ŒΩi , x) = 1] and to plot the M T E(ŒΩi )
against the propensity score H(ŒΩi ). This becomes awkward with multiple choices because
we consider the marginal distribution with respect to Œµi,j where Œµi,‚àíj is integrated out.
For the random coefficients logit, it is easier to work with the ‚Äúindividuals‚Äù after inte55


This requires the ‚Äúfirst stage‚Äù assumption to avoid division by zero: P r dij (p0j ) = 0 ; dij (pj ) = 1 =
6 0.

45

grating out Œµi since that admits a closed form. In this case:
Djk,i (x) =

‚àÇsik
(x)
‚àÇpj
‚àÇs
‚àí ‚àÇpijj (x)

=

sik (x)
‚àíŒ±i sik (x)sij (x)
=
‚àíŒ±i sij (x)(1 ‚àí sij (x))
1 ‚àí sij (x)

A.3. Diversion Under Common Parametric Demands
This section derives explicit formulas for the diversion ratio under common parametric forms
for demand, focusing on whether or not the diversion ratio implied by a particular parametric form of demand is constant with respect to the magnitude of the price increase. We show
that the IIA logit and linear demands model exhibit this property, while the log-linear and
mixed logit models do not necessarily exhibit this property. We go through several derivations below.

Linear Demand
The diversion ratio under linear demand has the property that it does not depend on the
magnitude of the price increase. We specify linear demand as:
Qk (P1 , . . . , PJ ) = Œ±k +

X

Œ≤kj Pj .

j
k
‚â° Œ≤kj is the increase or decrease in k‚Äôs quantity due to a one-unit increase in
where ‚àÇQ
‚àÇPj
prouct j‚Äôs price.

Djk (P1 , . . . , PJ , x) =

Œ≤kj
Œ≤jj

(A.2)

Thus, for any change in pj from an infinitesimal price increase up to the choke price of j,
the diversion ratio Djk is constant. This also implies that under linear demand, diversion is
a global property. Any magnitude of price increase evaluated at any initial set of prices and
quantities will result in the same measure of diversion.

46

Log-Linear Demand
The log-linear demand model does not exhibit constant diversion with respect to the magnitude of the price increase. The log-linear model is specified as:
ln(Qk ) = Œ±k +

X

k` ln(Pj )

`

As is well known jk =

‚àÇQk Pj
‚àÇPj Qk

and the diversion ratio can be re-written as:
Djk (Pj , x) =

Qk (Pj , x) kj
¬∑
Qj (Pj , x) jj

Under constant elasticity, the diversion ratio depends on where on the demand curve Pj we
are located. (This is similar to the fact that under linear demand, the own-price elasticity
depends where on the demand curve we are located). As an additional challenge, secondchoice data is not interpretable because we cannot expect to set Qj = 0 and take log(Qj ).
IIA Logit Demand
The plain logit model exhibits IIA and proportional substitution, which implies that the
diversion ratio does not depend on the magnitude of the price increase. The logit utility and
market shares qj (Pj , x) = sj (Pj , x) ¬∑ M are given by the well-known formulas:
uij (Pj , x) = Œ≤xj ‚àí Œ±Pj + Œæj + Œµij
Sj (P1 , . . . , Pj , x) =

exp[Œ≤xj ‚àí Œ±Pj + Œæj ]
P
1 + k‚ààJ exp[Œ≤xk ‚àí Œ±Pk + Œæk ]

The logit derivatives also have well known formulas:
‚àÇSj
= Œ±Sj (1 ‚àí Sj )
‚àÇPj
‚àÇ 2 Sj
= Œ±2 (1 ‚àí 2Sj )(Sj ‚àí Sj2 )
‚àÇPj2

‚àÇSk
= ‚àíŒ±Sj Sk
‚àÇPj
‚àÇ 2 Sk
= ‚àíŒ±2 (1 ‚àí 2Sj )Sj Sk
‚àÇPj2

This means that under a logit demand the diversion from an infinitesimal price change is
given by:
‚àÇSk
‚àÇpj
‚àÇSj
‚àÇpj

=

Œ±Sk Sj
Sk
=
Œ±Sj (1 ‚àí Sj )
(1 ‚àí Sj )

47

(A.3)

Meanwhile the diversion ratio exhibits constant treatment effects IFF the numerator in (10)
is zero. This is true if Djk (Pj , x) = ‚àí
‚àÇ 2 qk
‚àÇPj2

‚àí ‚àÇ2q =
j

‚àÇPj2

‚àÇ 2 Qk
‚àÇP 2
j
‚àÇ 2 Qj
‚àÇP 2
j

. This property is easily verified for the logit:

Œ±2 (1 ‚àí 2Sj )Sj Sk
Sk
=
.
2
2
Œ± (1 ‚àí 2Sj )(Sj ‚àí Sj )
1 ‚àí Sj

For second choice data, it is helpful to define exponentiated indirect utility: Vk = exp[Œ≤xj ‚àí
Œ±Pj + Œæj ] and write:
Sk (J , x) ‚àí Sk (J \ j, x)
=
Sj (J , x)
=

1+

P Vk

j 0 ‚ààJ \j

P Vk
1+ j 0 ‚ààJ Vj 0

‚àí

Vj 0

Vj
1+

1+

V
Pk

P

j 0 ‚ààJ

j 0 ‚ààJ

Vj 0

Vj 0

¬∑

!
P
1 + j 0 ‚ààJ Vj 0
Sk (J , x)
1
P
‚àí1
=
1 + j 0 ‚ààJ \j Vj 0
Vj
1 ‚àí Sj (J , x)

In both cases, diversion is the ratio of the change in the marketshare of the substitute good
divided by the share of consumers no longer buying the focal good (under the initial set
of prices and product availability). It does not depend on any of the estimated parameters
sk
. This is also
(Œ±, Œ≤). It is also true that all individual diversion ratios are equal Djk,i = 1‚àís
j
equal to the non-parametric discrete choice AT T = E[Djk,i (x)|dij = 0].
Nested Logit Demand
Recall the estimating equation for the nested logit from Berry (1994):
ln sjt ‚àí ln s0t = xjt Œ≤ ‚àí Œ±pjt + œÉ ln sj|g,t + Œµjt
The derivatives of marketshare with respect to price are given by:56


‚àÇsj
‚àí1
œÉ
= Œ±sj
+
sj|g + sjt
‚àÇpj
1‚àíœÉ 1‚àíœÉ
(
)

œÉ
Œ±sj 1‚àíœÉ sk|g + sk
for (j, k) in same nest
‚àÇsk
=
‚àÇpj
Œ±sj sk
otherwise
56

See Mansley et al. (2019) for derivatives worked out.

48

And second derivatives:



1
œÉ
1
œÉ
‚àÇ 2 sj
2
=Œ±
‚àí
sÃÑj|g ‚àí 2sj
‚àí
sÃÑj|g ‚àí sj sj
‚àÇ 2 pj
1‚àíœÉ 1‚àíœÉ
1‚àíœÉ 1‚àíœÉ

œÉ
‚àí Œ±2
s
sÃÑ
1
‚àí
sÃÑ
j
j|g
j|g
(1 ‚àí œÉ)2



1
‚àÇ 2 sk
2
= Œ± sk sj sj ‚àí
1 ‚àí œÉsÃÑj|g ‚àí (1 ‚àí œÉ)sj
for different groups .
‚àÇ 2 pj
1‚àíœÉ



1
‚àÇ 2 sk
œÉ
2
= ‚àíŒ±
sk 1 ‚àí œÉsÃÑk|g ‚àí (1 ‚àí œÉ)sk sj +
sÃÑj|g
‚àÇ 2 pj
1‚àíœÉ
1‚àíœÉ


œÉ
œÉ
1
2 2
+ Œ± sk sj +
sÃÑj|g + Œ±2
sk sÃÑj|g sÃÑk|g for same groups .
1‚àíœÉ
1‚àíœÉ1‚àíœÉ
It is helpful to define Z(œÉ, sg ) = [œÉ + (1 ‚àí œÉ)sg ] ‚àà (0, 1] and note that Z(0, sg ) = sg and
Z(1, sg ) = 1. When both products are in the same nest, the diversion ratio is given by:
‚àÇsk
‚àÇp
‚àí ‚àÇsjj
‚àÇpj

=‚àí
=

œÉ
s + sk
1‚àíœÉ k|g
œÉ
‚àí1
+ 1‚àíœÉ
sj|g +
1‚àíœÉ

sj

=‚àí

œÉsk|g + sk|g sg (1 ‚àí œÉ)
sk|g [œÉ + (1 ‚àí œÉ)sg ]
=‚àí
‚àí1 + œÉsj|g + (1 ‚àí œÉ)sj|g sg
‚àí1 + sj|g [œÉ + (1 ‚àí œÉ)sg ]

sk|g
sk|g ¬∑ Z(œÉ, sg )
‚àó
= ‚àí1
‚â° Djk
1 ‚àí sj|g ¬∑ Z(œÉ, sg )
Z (œÉ, sg ) ‚àí sj|g

(A.4)

Observe that Z ‚àí1 (œÉ, sg ) ‚â• 1. Also notice that we get diversion ratios proportional to within
group share sk|g .
k
=
If both products are in different nests, we need to re-scale the numerator by œÉ ssk|g
+sk
1‚àíœÉ

sg (1‚àíœÉ)
œÉ+(1‚àíœÉ)sg

= sg (1 ‚àí œÉ)Z ‚àí1 (œÉ, sg ). We must also keep track of which product‚Äôs group share we
are referring to. It is helpful to use the second to last expression in the derivation for the
same nest:
‚àÇsk
‚àÇp
‚àí ‚àÇsjj
‚àÇpj

=

sk|g ¬∑ Z(œÉ, sg(k) )
¬∑ sg(k) (1 ‚àí œÉ)Z ‚àí1 (œÉ, sg(k) )
1 ‚àí sj|g ¬∑ Z(œÉ, sg(j) )

=

sk (1 ‚àí œÉ)
‚àó‚àó
‚â° Djk
1 ‚àí sj|g ¬∑ Z(œÉ, sg(j) )

(A.5)

Notice that we get diversion ratios proportional to overall share sk .
‚àó
We can relate the diversion ratio of two products within the group Djk
to the diversion

49

‚àó‚àó
ratio of two products in different groups Djk
by:

‚àó
‚àó‚àó
¬∑
= Djk
Djk

sg(k) ¬∑ (1 ‚àí œÉ)
Z(œÉ, sg(j) )
s

‚àó
‚àó‚àó
As œÉ ‚Üí 1 everyone stays within the group and Djk
= 1‚àísk|gj|g and Djk
= 0.
sk|g
sg
sk
‚àó
‚àó‚àó
As œÉ ‚Üí 0 we collapse to the logit and Djk = Djk = 1 ‚àís ¬∑ sg = 1‚àísj .
sg

j|g

We can also check the curvature property in (9). We are interested in the ratio (check
for different groups):

‚àí

‚àÇ 2 sk
‚àÇ 2 Œ¥j
‚àÇ 2 sj
‚àÇ 2 Œ¥j


1
sk sj sj ‚àí 1‚àíœÉ
1 ‚àí œÉsÃÑj|g ‚àí (1 ‚àí œÉ)sj
 1


=‚àí 1
œÉ
œÉ
œÉ
‚àí 1‚àíœÉ
sÃÑj|g ‚àí 2sj 1‚àíœÉ
‚àí 1‚àíœÉ
sÃÑj|g ‚àí sj sj ‚àí (1‚àíœÉ)
2 sj sÃÑj|g 1 ‚àí sÃÑj|g
1‚àíœÉ

(1 ‚àí œÉ)sk 1 ‚àí œÉsÃÑj|g ‚àí 2(1 ‚àí œÉ)sj



=
1 ‚àí œÉsÃÑj|g ‚àí 2(1 ‚àí œÉ)sj 1 ‚àí œÉsÃÑj|g ‚àí (1 ‚àí œÉ)sj ‚àí œÉsÃÑj|g 1 ‚àí sÃÑj|g
(1 ‚àí œÉ)sk
=
(A.6)

œÉsÃÑ (1‚àísÃÑj|g )
1 ‚àí œÉsÃÑj|g ‚àí (1 ‚àí œÉ)sj ‚àí 1‚àíœÉsÃÑj|g ‚àí2(1‚àíœÉ)s
(
j)
j|g

If the second term in the denominator were zero, observe that:
‚àó‚àó
Djk
=

(1 ‚àí œÉ)sk

1 ‚àí œÉsÃÑj|g ‚àí (1 ‚àí œÉ)sj

Since the second term is not equal to zero unless sj|g ‚àà {0, 1} the nested logit does not
appear to satisfy the curvature property. This means that diversion ratios do not exhibit
constant treatment effects. We have confirmed via simulation that second choice diversion
ratios are not equal to diversion ratios measured by marginal price changes.
Random Coefficients Logit Demand
Random Coefficients Logit demand relaxes the IIA property of the plain Logit model, which
can be desireable empirically and leads to non-constant treatment effects measures of diversion ratios. That is, a change in price or quality may lead to a different average estimate
of diversion ratios than second choice data. Intuitively, a small price increase might induce
diversion from the most price-sensitive consumers, while a larger price increase might see
substitution from a larger set of consumers. If price sensitivity is correlated with other tastes,
then the diversion ratio could differ with the magnitude of the price increase.

50

We can repeat the same exercise for the logit model with random coefficients, by discretizing a mixture density over i = 1, . . . , I representative consumers, with population
weight wi :
Vijt

}|
{
z
uij = zj Œ≤ + Œæjt +¬µij +Œµij
| {z }
Œ¥j

Using the chain rule (for an arbitrary zj including price) we can write:
‚àÇVijt
‚àÇVijt ‚àÇŒ¥jt ‚àÇVijt ‚àÇ¬µijt
=
¬∑
+
¬∑
‚àÇzjt
‚àÇŒ¥jt ‚àÇzjt ‚àÇ¬µijt ‚àÇzjt
Because the random coefficients model is a single index model, any zj which affects only
the mean utility component Œ¥j and not the unobserved heterogeneity ¬µij yields the same
‚àÇ¬µ
marginal diversion measure. If all agents agree on their preferences for zj : ‚àÇzijj ‚â° 0 and
‚àÇVijt
‚àÇzjt

‚àÇŒ¥

= 1 ¬∑ ‚àÇzjt
= Œ≤z . This has the advantage that the (marginal/infinitesimal) diversion
jt
ratio can be identified in the random coefficients logit model even when a (common) price
parameter Œ± is not identified (as long as pj does not have a random coefficient). This can
be seen in (A.7) which does not depend on ‚àÇVij /‚àÇpj .
‚àÇSk
‚àÇpj
‚àÇSj
‚àÇpj

R
=R

Sk (J , x) ‚àí Sk (J \ j, x)
=
Sj (J , x)

ik
sij sik ‚àÇV
‚àÇpj

sij (1 ‚àí

R
1+

Vik
Pe

‚ÜíR

‚àÇV
sij ) ‚àÇpijj

l‚ààa\j

R

R

‚àí

eVil

‚àí 1+

1+

Vij
Pe

l‚ààa

eVik
P

eVil

l0 ‚ààa

eVil0

1
‚Üí
sj

sij sik
sij (1 ‚àí sij )
Z

sij sik
(1 ‚àí sij )

(A.7)

(A.8)

Even in the case where consumers have homogenous tastes for z so that Œ≤iz = Œ≤z , the
two diversion measures do not agree. Each individual exhibits constant diversion Djk,i =
sik
, but weights on individuals vary depending on how diversion is measures, so that
1‚àísij
diversion is only constant if sij = sj . The more correlated (sij , sik ) are (and especially as
they are correlated with Œ±i ) the greater the discrepancy between the two measures of average
diversion. The various weights are all described in Table 2 in the main text.

B. Additional Empirical Results
In this section we present some additional results from our empirical applications to the
Berry et al. (1999) automobile data and the Nevo (2000b) (fake) cereal data.
51

In Table B.1 we present the mean taste parameters for various product characterisitcs.
These are sometimes referred to as the Œ≤ or Œ≤ parameters. By and large they have the
antcipated signs. In automobiles consumers prefer faster vehicles (more horsepower relative
to weight), air conditioning, and size. In the cereal example, consumers prefer sugary cereals
(on average) and dislike mushy cereals (on average).
In Table B.2 we compute the pairwise correlation between each of the treatment effects
parameters (price change, quality change, second choice data) as well as the simplified models
(Logit/ATT, and Nested Logit). For this exercise we consider diversion among all pairs of
products. As our weights predict, the correlation between the second-choice data and smallquality changes is very high (even higher than correlation with the small price changes).
The correlation between small price change diversion and small quality change diversion is
much higher in the Nevo example than the BLP example and is driven by differences in the
distribution of |Œ±i | which is more dispersed in the BLP example. This is a fact we highlight
below in Figure B.1.
As one might also expect, the correlation between the nested logit and logit models is
high, and the correlation between the nested logit (or logit) models and random coefficients
models (for any treatment effects parameter) is much lower. This is again more pronounced
in the BLP example than the Nevo example where there is less overall heterogeneity in the
Djk,i (x) measures.

52

Best Practices

Œ£cons = œÄcons = 0

Œ£ p = œÄp = 0

Rescaled Shares

-51.254
(5.847)
-5.372
(0.521)
3.739
(0.810)
0.513
(0.332)
-0.005
(0.156)
3.614
(0.423)

-49.175
(7.104)
-5.714
(0.450)
3.070
(0.891)
0.728
(0.282)
0.239
(0.088)
3.567
(0.438)

-0.355
(0.030)
-9.608
(1.577)
4.879
(2.746)
2.682
(10.265)
0.041
(0.157)
2.585
(0.945)

-11.277
(2.218)
-6.551
(0.662)
1.274
(0.770)
-0.050
(0.287)
0.522
(0.113)
4.209
(0.242)

-31.125
(4.700)
-2.925
(0.343)
0.234
(0.035)
-0.886
(0.439)

-42.642
(3.627)
0.373
(0.331)
0.109
(0.035)
-0.970
(0.427)

-30.939
(0.913)
-1.977
(0.342)
0.188
(0.035)
-0.867
(0.436)

-36.280
(2.507)
-4.165
(0.337)
0.211
(0.034)
-0.740
(0.426)

BLP
price/inc
Œ≤cons
Œ≤HP/weight
Œ≤air
Œ≤MP$
Œ≤size
Nevo
Œ±price
Œ≤cons
Œ≤sugar
Œ≤mushy

Table B.1: Linear Utility Demand Parameters

Djk (p)
Small Quality Change
Second Choice
Logit
Nested Logit Djk (p)
Djk (p)
Small Quality Change
Second Choice
Logit
Nested Logit Djk (p)

Djk (p)
1.000
0.912
0.909
0.346
0.329
Djk (p)
1.000
0.990
0.991
0.682
0.676

Small Quality Change
0.912
1.000
0.999
0.399
0.377
Small Quality Change
0.990
1.000
0.999
0.725
0.721

Second Choice
0.909
0.999
1.000
0.394
0.372
Second Choice
0.991
0.999
1.000
0.716
0.712

Logit
0.346
0.399
0.394
1.000
0.916
Logit
0.682
0.725
0.716
1.000
0.981

Nested Logit Djk (p)
0.329
0.377
0.372
0.916
1.000
Nested Logit Djk (p)
0.676
0.721
0.712
0.981
1.000

Table B.2: Pairwise Correlation Among Treatment Effects Parameters

53

0.16

0.14

0.12

0.10

0.08

0.06

0.04

0.02

0.00

0

20

40

60

80

100

Figure B.1: Density of Œ±i for BLP (Blue) and Nevo (Red) Data

54

