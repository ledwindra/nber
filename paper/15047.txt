NBER WORKING PAPER SERIES

PRICING MODEL PERFORMANCE AND THE TWO-PASS CROSS-SECTIONAL
REGRESSION METHODOLOGY
Raymond Kan
Cesare Robotti
Jay Shanken
Working Paper 15047
http://www.nber.org/papers/w15047

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2009

We thank Pierluigi Balduzzi, Christopher Baum, Tarun Chordia, Wayne Ferson, Nikolay Gospodinov,
Ravi Jagannathan, Ralitsa Petkova, Yaxuan Qi, Guofu Zhou, seminar participants at the Board of Governors
of the Federal Reserve System, Concordia University, Federal Reserve Bank of Atlanta, Federal Reserve
Bank of New York, University of Toronto, and participants at the 2009 Meetings of the Association
of Private Enterprise Education, the 2009 CIREQ-CIRANO Financial Econometrics Conference, and
the 2009 FIRS Conference for helpful discussions and comments. Kan gratefully acknowledges financial
support from the National Bank Financial of Canada. The views expressed herein are those of the author(s)
and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2009 by Raymond Kan, Cesare Robotti, and Jay Shanken. All rights reserved. Short sections of
text, not to exceed two paragraphs, may be quoted without explicit permission provided that full credit,
including Â© notice, is given to the source.

Pricing Model Performance and the Two-Pass Cross-Sectional Regression Methodology
Raymond Kan, Cesare Robotti, and Jay Shanken
NBER Working Paper No. 15047
June 2009
JEL No. C1,C12,C13,C4,C52,G12
ABSTRACT
Since Black, Jensen, and Scholes (1972) and Fama and MacBeth (1973), the two-pass cross-sectional
regression (CSR) methodology has become the most popular approach for estimating and testing asset
pricing models. Statistical inference with this method is typically conducted under the assumption
that the models are correctly specified, i.e., expected returns are exactly linear in asset betas. This can be
a problem in practice since all models are, at best, approximations of reality and are likely to be subject
to a certain degree of misspecification. We propose a general methodology for computing misspecificationrobust asymptotic standard errors of the risk premia estimates. We also derive the asymptotic distribution
of the sample CSR R2 and develop a test of whether two competing beta pricing models have the same
population R2. This provides a formal alternative to the common heuristic of simply comparing the
R2 estimates in evaluating relative model performance. Finally, we provide an empirical application
which demonstrates the importance of our new results when applied to a variety of asset pricing models.

Raymond Kan
University of Toronto
105 St. George Street
Toronto, Ontario
Canada M5S 3E6
kan@chass.utoronto.ca
Cesare Robotti
Federal Reserve Bank of Atlanta
Research Department
1000 Peachtree Street N.E.
Atlanta, Georgia 30309-4470
CRobotti@frbatlanta.org

Jay Shanken
Goizueta Business School
Emory University
1300 Clifton Road
Atlanta, GA 30322
and NBER
jay_shanken@bus.emory.edu

I.

Introduction

In the empirical asset pricing literature, the popular two-pass cross-sectional regression (CSR)
methodology developed by Black, Jensen, and Scholes (1972) and Fama and MacBeth (1973) is
often used for estimating risk premia and testing pricing models that relate expected security
returns to security betas on economic factors (beta pricing models). Although there are many
variations of this two-pass methodology, the basic approach always involves two steps. In the
first pass, the betas of the test assets are estimated from ordinary least squares (OLS) time series
regressions of returns on some common factors. In the second pass, the returns on test assets
are regressed on the betas estimated from the first pass. By running this second-pass CSR on a
period-by-period basis, we obtain time series of the intercept and slope coefficients. The average
values of these coefficients are then used as estimates of the zero-beta rate and factor risk premia,
with standard errors computed from these time series as well.
Since the betas are estimated with error in the first-pass time series regressions, an errors-invariables (EIV) problem is introduced in the second-pass CSR. Measurement errors in the betas
cause two problems. The first is that the estimated zero-beta rate and risk premia are biased,
though Shanken (1992) shows they are consistent as the length of the time series increases to
infinity. The second problem is that the usual Fama-MacBeth standard errors for the estimated
zero-beta rate and risk premia are inconsistent. Shanken (1992) addresses this by developing an
asymptotically valid EIV adjustment of the standard errors. Jagannathan and Wang (1998) extend
this asymptotic analysis by relaxing the assumption that returns are homoskedastic conditional on
the factors.1 Finally, the finite sample properties of these two-pass estimators have been studied
by Ahn and Gadarowski (2003), Chen and Kan (2003), and Shanken and Zhou (2007).
Standard inference using the two-pass methodology implicitly assumes that expected returns are
exactly linear in the betas, i.e., the beta pricing model is correctly specified. It is difficult to justify
this assumption when estimating many different models because some (if not all) of the models
are bound to be misspecified. Moreover, since asset pricing models are, at best, approximations of
reality, it is inevitable that we will often, knowingly or unknowingly (because of limited power),
estimate an expected return relation that departs from exact linearity in the betas. The first
contribution of this paper is the development of misspecification-robust asymptotic standard errors
1

Jagannathan, Skoulakis and Wang (2008) provide a synthesis of the two-pass CSR methodology.

1

for the estimated zero-beta rate and risk premia. Our analysis generalizes the results of Hou and
Kimmel (2006) and Shanken and Zhou (2007), which are derived under a normality assumption.
One nice feature of our robust standard errors is that they are applicable whether a model
is correctly specified or not. In addition, under a multivariate elliptical assumption, we provide
simple expressions for the asymptotic variances of the zero-beta rate and risk premia estimates.
In the case of the generalized least squares (GLS) CSR estimators, we prove that the variances
are always larger when the model is misspecified. The difference depends on the extent of model
misspecification as well as on the correlation between the factors and returns. We show that the
misspecification adjustment term can be very large when the underlying factor is poorly mimicked
by asset returns, a situation that typically arises when the factors are macroeconomic variables.
Judgement about the empirical success of a beta pricing model is often based on its crosssectional R2 . A high value is usually considered evidence that the model does a good job of
explaining the cross-section of expected returns. Several papers have analyzed the properties of the
population values of the cross-sectional R2 measures. Although there is an exact linear relation between expected returns and betas when a market index (factor portfolio) is mean-variance efficient,
Roll and Ross (1994) show that there may be no relation at all, i.e., an OLS R2 of zero, even if an
index is nearly efficient. Kandel and Stambaugh (1995) document related limitations of the OLS
R2 and show that there is a direct relation between the GLS R2 and the relative efficiency of an
index. Lewellen, Nagel and Shanken (2009) provide a multifactor generalization of this result, with
mimicking portfolios substituted for non-traded factors. They also argue, as do Jagannathan and
Wang (1996), that the OLS R2 can still be economically meaningful if the objective is to model
the expected returns for a particular set of assets.
Jagannathan, Kubota, and Takehara (1998), Kan and Zhang (1999), Jagannathan and Wang
(2007), and Lewellen, Nagel, and Shanken (2009) employ simulation methods to explore sampling
issues in estimating the cross-sectional R2 .2 However, to our knowledge no attempt has been made
to derive the asymptotic distribution of the sample cross-sectional R2 . Building on our analysis of
parameter estimation under potential model misspecification, the second contribution of this paper
is to characterize the asymptotic distribution of the sample R2, thereby filling a significant gap in
2
In contrast to our paper, Jagannathan, Kubota, and Takehara (1998), Kan and Zhang (1999), and Jagannathan
and Wang (2007) examine the sampling errors of the CSR R2 and risk premia estimates under the assumption that
one of the factors is useless (i.e., independent of returns).

2

the literature.
Finally, although R2 s for competing models are routinely compared in empirical asset pricing
studies, no formal model comparison test has yet been proposed in this context. This is essential
since the R2 statistics are subject to considerable statistical variation. Consequently, a model with
a higher sample R2 may not truly outperform its competitor. The third contribution of this paper
is the introduction of a methodology to formally test whether two beta pricing models have the
same population R2. We find that the asymptotic distribution of the difference in sample R2s
of two models depends on whether the models are correctly specified or not, and on whether the
models are nested or non-nested.
After developing the econometric methodology, we provide an in-depth empirical analysis that
demonstrates the relevance of our new tests. We examine the performance of a variety of unconditional and conditional beta pricing models that have been proposed as refinements of the static
capital asset pricing model (CAPM) and consumption CAPM (CCAPM). We start by investigating whether these models pass a specification test based on the sample cross-sectional R2 and find
that, in many instances, the models are rejected at conventional statistical levels. This provides
compelling motivation to explicitly account for model misspecification in the subsequent empirical
analysis of R2s.
Next, we examine whether model misspecification substantially affects the standard errors of
the zero-beta rate and risk premia estimates. Consistent with our theoretical results, we find that
the t-ratios are about the same under correctly specified and potentially misspecified models when
the underlying factors are returns on well diversified portfolios. However, standard errors can differ
substantially when the underlying factors are not traded, e.g., macroeconomic factors.
Finally, we analyze whether different beta pricing models have significantly different crosssectional R2 measures. It appears that the commonly used returns and factors are sometimes too
noisy to conclude that one model clearly outperforms the others. For example, using the commonly
employed 25 size and book-to-market ranked portfolios as test assets, there is not much statistical
evidence to establish that the five-factor intertemporal capital asset pricing model (ICAPM) of
Petkova (2006) outperforms even the simple unconditional CAPM in terms of cross-sectional R2 .
However, the advantage of the Fama and French (1993) three-factor model over the CAPM is
statistically significant for this metric.
3

The rest of the paper is organized as follows. Section II presents an asymptotic analysis of the
zero-beta rate and risk premia estimates under potentially misspecified models. We also consider an
alternative CSR approach that uses covariances with the factors, rather than (multiple regression)
betas, as the regressors. In addition, we provide an asymptotic analysis of the sample cross-sectional
R2 s under correctly specified and misspecified models. Section III introduces tests of equality of
cross-sectional R2s for two competing models and provides the asymptotic distributions of the test
statistics for different scenarios. Section IV presents an empirical application. The final section
summarizes our findings and the Appendix contains proofs of all propositions.

II.

Asymptotic Analysis under Potentially Misspecified Models
Population Measures of Pricing Errors and Cross-Sectional R2 s

A.

Let f be a K-vector of factors and R a vector of returns on N test assets. We define Y = [f 0 , R0 ]0
and its mean and covariance matrix as
Âµ = E[Y ] â‰¡

V

"

= Var[Y ] â‰¡

Âµ1

#

,
Âµ2
"
#
V11 V12
V21 V22

(1)

,

(2)

where V is assumed to be positive definite.3 The multiple regression betas of the N assets with
âˆ’1
respect to the K factors are defined as Î² = V21V11
. These are measures of systematic risk or the

sensitivity of returns to the factors. In addition, we denote the covariance matrix of the residuals
âˆ’1
of the N assets by Î£ = V22 âˆ’ V21V11
V12.

The proposed K-factor beta pricing model specifies that asset expected returns are linear in
the betas, i.e.,
Âµ2 = XÎ³,

(3)

where X = [1N , Î²] is assumed to be of full column rank, 1N is an N -vector of ones, and Î³ = [Î³0, Î³10 ]0
is a vector consisting of the zero-beta rate (Î³0) and risk premia on the K factors (Î³1).4 When the
3

For most of our analysis, we only need to assume V11 is nonsingular and V21 is of full column rank. For the case
of GLS CSR, we also need to assume V22 is nonsingular.
4
Note that constant portfolio characteristics can easily be accommodated in the CSR without creating any additional complication. The analysis that includes asset characteristics is available upon request.

4

model is misspecified, the pricing-error vector, Âµ2 âˆ’ XÎ³, will be nonzero for all values of Î³. In that
case, it makes sense to choose Î³ to minimize some aggregation of pricing errors. Denoting by W
an N Ã— N symmetric positive definite weighting matrix, we define the (pseudo) zero-beta rate and
risk premia as the choice of Î³ that minimizes the quadratic form of pricing errors:


Î³W,0
Î³W â‰¡
= argminÎ³ (Âµ2 âˆ’ XÎ³)0W (Âµ2 âˆ’ XÎ³) = (X 0W X)âˆ’1 X 0W Âµ2 .
Î³W,1

(4)

The corresponding pricing errors of the N assets are then given by
eW = Âµ2 âˆ’ XÎ³W .

(5)

In addition to aggregating the pricing errors, researchers are often interested in a normalized
goodness-of-fit measure for a model. A popular measure is the cross-sectional R2 . Following Kandel
and Stambaugh (1995), this is defined as
Ï2W = 1 âˆ’

Q
,
Q0

(6)

where
Q0 = min(Âµ2 âˆ’ 1N Î³0)0W (Âµ2 âˆ’ 1N Î³0 ) = Âµ02 W Âµ2 âˆ’ Âµ02 W 1N (10N W 1N )âˆ’1 10N W Âµ2 ,
Î³0

Q = e0W W eW = Âµ02 W Âµ2 âˆ’ Âµ02 W X(X 0W X)âˆ’1 X 0W Âµ2 .

(7)
(8)

In order for Ï2W to be well defined, we need to assume that Âµ2 is not proportional to 1N (the
expected returns are not all equal) so that Q0 > 0. Note that 0 â‰¤ Ï2W â‰¤ 1 and it is a decreasing
function of the aggregate pricing-error measure Q = e0W W eW . Thus, Ï2W is a natural measure of
goodness of fit.
While the betas are typically used as the regressors in the second-pass CSR, there is a potential
issue with the use of multiple regression betas when K > 1: in general, the beta of an asset with
respect to a particular factor depends on what other factors are included in the first-pass timeseries OLS regression. As a consequence, the interpretation of the risk premia Î³1 in the context
of model selection can be problematic (more discussion on this issue later in Section III.A). To
overcome this problem, we propose an alternative second-pass CSR that uses the covariances V21
as the regressors. Let C = [1N , V21] and Î»W be the choice of coefficients that minimizes the
quadratic form of pricing errors:


Î»W,0
Î»W â‰¡
= argminÎ»(Âµ2 âˆ’ CÎ»)0W (Âµ2 âˆ’ CÎ») = (C 0 W C)âˆ’1 C 0 W Âµ2 .
Î»W,1
5

(9)

Given (4) and (9), there is a one-to-one correspondence between Î³W and Î»W :
Î»W,0 = Î³W,0,

âˆ’1
Î»W,1 = V11
Î³W,1 .

(10)

It is easy to see that the pricing errors from this alternative second-pass CSR, eW = Âµ2 âˆ’ CÎ»W , are
the same as those in (5). It follows that the Ï2W for these two CSRs are also identical. However, it
is important to note that unless V11 is a diagonal matrix, Î»W,1i = 0 does not imply Î³W,1i = 0, and
vice versa.5
It should be emphasized that unless the model is correctly specified, Î³W , Î»W , eW , and Ï2W
depend on the choice of W . Popular choices of W in the literature are W = IN (OLS CSR),
âˆ’1
W = V22
(GLS CSR),6 and W = Î£âˆ’1
(weighted least squares (WLS) CSR), where Î£d is a
d

diagonal matrix containing the diagonal elements of Î£. To simplify the notation, we suppress the
subscript W from Î³W , Î»W , eW , and Ï2W when the choice of W is clear from the context.
Sample Measures of Pricing Errors and Cross-Sectional R2 s

B.

Let Yt = [ft0, R0t]0 , where ft is the vector of K proposed factors at time t and Rt is a vector of
returns on N test assets at time t. Throughout the paper, we assume the time series Yt is jointly
stationary and ergodic, with finite fourth moment. Suppose we have T observations on Yt and
denote the sample moments of Yt by
ÂµÌ‚ =

VÌ‚

=

"

ÂµÌ‚1
ÂµÌ‚2

"

VÌ‚11
VÌ‚21

#

T
1X
Yt ,
T
t=1
#
T
VÌ‚12
1X
=
(Yt âˆ’ ÂµÌ‚)(Yt âˆ’ ÂµÌ‚)0.
T
VÌ‚22

=

(11)

(12)

t=1

The popular two-pass method first estimates the betas of the N assets by running the following
multivariate regression:
Rt = Î± + Î²ft + t ,
5

t = 1, . . . , T.

(13)

See Jagannathan and Wang (1998) and Cochrane (2005, Chapter 13.4) for a discussion of this issue. Another
solution to this problem is to use simple regression betas as the regressors in the second-pass CSR, as in Chen, Roll,
and Ross (1986) and Jagannathan and Wang (1996, 1998). Kan and Robotti (2009) provide asymptotic results for
the CSR with simple regression betas under potentially misspecified models.
6
As pointed out by Lewellen, Nagel, and Shanken (2009), Î³W and e0W W eW are the same regardless of whether we
âˆ’1
âˆ’1
or W = Î£âˆ’1 . However, it should be noted that the Ï2W are different for W = V22
and W = Î£âˆ’1 . For
use W = V22
âˆ’1
the purpose of model comparison, it makes sense to use a common W across models, so we prefer to use W = V22
for the case of GLS CSR.

6

âˆ’1
The estimated betas from this first-pass time-series regression are given by the matrix Î²Ì‚ = VÌ‚21VÌ‚11
.

We then run a single CSR of ÂµÌ‚2 on XÌ‚ = [1N , Î²Ì‚] to estimate Î³W in the second pass.7 When the
weighting matrix W is known (say OLS CSR), we can estimate Î³W in (4) by
Î³Ì‚ = (XÌ‚ 0W XÌ‚)âˆ’1XÌ‚ 0W ÂµÌ‚2 .

(14)

Similarly, letting CÌ‚ = [1N , VÌ‚21], we estimate Î»W in (9) by
Î»Ì‚ = (CÌ‚ 0 W CÌ‚)âˆ’1 CÌ‚ 0 W ÂµÌ‚2 .

(15)

In the GLS and WLS cases, the weighting matrix W involves unknown parameters and, therefore,
we need to substitute a consistent estimate of W , say WÌ‚ , in (14) and (15). This is typically the
âˆ’1
corresponding matrix of sample moments, for example, WÌ‚ = VÌ‚22
for GLS and WÌ‚ = Î£Ì‚âˆ’1
d for WLS.

The sample measure of Ï2 is similarly defined as
ÏÌ‚2 = 1 âˆ’

QÌ‚
QÌ‚0

,

(16)

where QÌ‚0 and QÌ‚ are consistent estimators of Q0 and Q in (7) and (8), respectively. When W is
known, we estimate Q0 and Q using
QÌ‚0 = ÂµÌ‚02 W ÂµÌ‚2 âˆ’ ÂµÌ‚02 W 1N (10N W 1N )âˆ’1 10N W ÂµÌ‚2 ,

(17)

QÌ‚ = ÂµÌ‚02 W ÂµÌ‚2 âˆ’ ÂµÌ‚02 W XÌ‚(XÌ‚ 0W XÌ‚)âˆ’1 XÌ‚ 0W ÂµÌ‚2 .

(18)

When W is not known, we replace W with WÌ‚ in the formulas above.
C.

Asymptotic Distribution of Î³Ì‚ under Potentially Misspecified Models

When computing the standard error of Î³Ì‚, researchers typically rely on the asymptotic distribution of Î³Ì‚ under the assumption that the model is correctly specified. Shanken (1992) presents the
asymptotic distribution of Î³Ì‚ under the conditional homoskedasticity assumption on the residuals.
Jagannathan and Wang (1998) extend Shankenâ€™s results by allowing for conditional heteroskedasticity as well as autocorrelated errors.
Two recent papers have investigated the asymptotic distribution of Î³Ì‚ under potentially misspecified models. Hou and Kimmel (2006) derive the asymptotic distribution of Î³Ì‚ for the case of
7
Some studies allow Î²Ì‚ to change throughout the sample period. For example, in the original Fama and MacBeth
(1973) study, the betas used in the CSR for month t were estimated from data prior to that month. We do not study
this case here mainly because the estimator of Î³ from this alternative procedure is generally not consistent.

7

GLS CSR with a known value of Î³0 , and Shanken and Zhou (2007) present asymptotic results for
the OLS, WLS, and GLS cases with Î³0 unknown. However, both analyses are somewhat restrictive,
as they rely on the i.i.d. normality assumption. We now relax this assumption.8
We first present the asymptotic distribution of Î³Ì‚ when W is known.
0 0
Proposition 1. Let H = (X 0W X)âˆ’1 , A = HX 0W , and Î³t â‰¡ [Î³0t, Î³1t
] = ARt. Under a poten-

tially misspecified model, the asymptotic distribution of Î³Ì‚ = (XÌ‚ 0W XÌ‚)âˆ’1 XÌ‚ 0W ÂµÌ‚2 is given by
âˆš

A

T (Î³Ì‚ âˆ’ Î³) âˆ¼ N (0K+1, V (Î³Ì‚)),
where
V (Î³Ì‚) =

âˆ
X

E[hth0t+j ],

(19)

(20)

j=âˆ’âˆ

with
ht = (Î³t âˆ’ Î³) âˆ’ (Ï†t âˆ’ Ï†)wt + Hzt ut ,

(21)

âˆ’1
Ï†t = [Î³0t, (Î³1t âˆ’ ft )0 ]0, Ï† = [Î³0, (Î³1 âˆ’ Âµ1 )0]0, ut = e0 W (Rt âˆ’ Âµ2 ), wt = Î³10 V11
(ft âˆ’ Âµ1 ), and
âˆ’1 0
zt = [0, (ft âˆ’ Âµ1 )0 V11
] . When the model is correctly specified, we have:

ht = (Î³t âˆ’ Î³) âˆ’ (Ï†t âˆ’ Ï†)wt.

(22)

To conduct statistical tests, we need a consistent estimator of V (Î³Ì‚). This can be obtained by
replacing ht with
hÌ‚t = (Î³Ì‚t âˆ’ Î³Ì‚) âˆ’ (Ï†Ì‚t âˆ’ Ï†Ì‚)wÌ‚t + HÌ‚ zÌ‚t uÌ‚t ,

(23)

0 ]0 = (XÌ‚ 0 W XÌ‚)âˆ’1 XÌ‚ 0 W R , Ï†Ì‚ = [Î³Ì‚ , (Î³Ì‚ âˆ’ f )0 ]0 , Ï†Ì‚ = [Î³Ì‚ , (Î³Ì‚ âˆ’ ÂµÌ‚ )0 ]0 , uÌ‚ =
where Î³Ì‚t â‰¡ [Î³Ì‚0t, Î³Ì‚1t
t
t
0t
1t
t
0
1
1
t
âˆ’1
âˆ’1 0
eÌ‚0 W (Rt âˆ’ ÂµÌ‚2 ) with eÌ‚ = ÂµÌ‚2 âˆ’ XÌ‚ Î³Ì‚, wÌ‚t = Î³Ì‚10 VÌ‚11
(ft âˆ’ ÂµÌ‚1 ), HÌ‚ = (XÌ‚ 0W XÌ‚)âˆ’1 and zÌ‚t = [0, (ft âˆ’ ÂµÌ‚1 )0VÌ‚11
].

In particular, if ht is uncorrelated over time, then we have V (Î³Ì‚) = E[hth0t ], and its consistent
estimator is given by
VÌ‚ (Î³Ì‚) =

T
1X
hÌ‚t hÌ‚0t .
T

(24)

t=1

8
For the case of misspecified GMM, White (1994) and Hall and Inoue (2003) provide an asymptotic analysis of the
parameter estimates. However, the two-pass CSR is not a standard GMM procedure that estimates Î² and Î³ jointly.
Instead, the two-pass CSR can be interpreted as a sequential GMM that first estimates Î² from one set of moment
conditions and then estimates Î³ using a different set of moment conditions by plugging in the estimated Î² (see Pagan
(1984) for an analysis of regressions with generated regressors and Newey (1984) for a discussion of sequential GMM).
As a result, the asymptotic analyses of White (1994) and Hall and Inoue (2003) cannot be directly applied to the
two-pass CSR estimator of Î³.

8

When ht is autocorrelated, one can use Newey and Westâ€™s (1987) method to obtain a consistent
estimator of V (Î³Ì‚).
An inspection of (21) reveals that there are three sources of asymptotic variance for Î³Ì‚. The first
term Î³t âˆ’ Î³ measures the asymptotic variance of Î³Ì‚ when the true betas (Î²) are used in the CSR. For
example, if Rt is i.i.d., then Î³t is also i.i.d. and we can use the time series variance of Î³t to compute
the standard error of Î³Ì‚. This coincides with the popular Fama and MacBeth (1973) method.
However, since Î²Ì‚ is used in place of Î² in the actual second-pass CSR, there is an EIV problem.
The second term (Ï†t âˆ’ Ï†)wt is the EIV adjustment term that accounts for the estimation errors
in Î²Ì‚. The first two terms together give us the V (Î³Ì‚) under the correctly specified model.9 When
the model is misspecified (e 6= 0N ), there is a third term Hztut , which we call the misspecification
adjustment term. Traditionally, this term has been ignored by empirical researchers.
To gain a better understanding of the relative importance of the misspecification adjustment
term, in the following lemma we derive an explicit expression for V (Î³Ì‚) under the assumption that
returns and factors are multivariate elliptically distributed.
Lemma 1. When the factors and returns are i.i.d. multivariate elliptically distributed with kurtosis
parameter Îº,10 the asymptotic variance of Î³Ì‚ = (XÌ‚ 0W XÌ‚)âˆ’1 XÌ‚ 0W ÂµÌ‚2 is given by
V (Î³Ì‚) = Î¥w + Î¥w1 + Î¥0w1 + Î¥w2 ,

(25)

âˆ’1
Î¥w = AV22A0 + (1 + Îº)Î³10 V11
Î³1AÎ£A0 ,

(26)

âˆ’1 0 0
Î¥w1 = âˆ’(1 + Îº)H[0, Î³10 V11
] e W V22A0

(27)

âˆ’1
Î¥w2 = (1 + Îº)e0 W V22W eH VÌƒ11
H,

(28)

where

âˆ’1
with VÌƒ11
=

"

0

00K

âˆ’1
0K V11

#

.

Note that when Îº = 0, Lemma 1 collapses to the expression given by Shanken and Zhou (2007)
in their Proposition 1 under normality. For general W , the misspecification adjustment term
9

It can be verified that this expression coincides with the one given by Jagannathan and Wang (1998) in their
Theorem 1, except that our expression is easier to use in practice.
10
The kurtosis parameter for an elliptical distribution is defined as Îº = Âµ4 /(3Ïƒ4 ) âˆ’ 1, where Ïƒ2 and Âµ4 are its
second and fourth central moments, respectively.

9

âˆ’1
Î¥w1 + Î¥0w1 + Î¥w2 is not necessarily positive semidefinite. However, for true GLS with W = V22

or W = Î£âˆ’1 , we have AV22W e = Ae = 0K+1 , so Î¥w1 vanishes, resulting in the following simple
expression for V (Î³Ì‚):
âˆ’1
âˆ’1
V (Î³Ì‚) = H + (1 + Îº)Î³10 V11
Î³1 (X 0Î£âˆ’1 X)âˆ’1 + (1 + Îº)QH VÌƒ11
H,

(29)

âˆ’1
âˆ’1
âˆ’1
where H = (X 0V22
X)âˆ’1 and Q = e0 V22
e. The misspecification adjustment term (1 + Îº)QH VÌƒ11
H
âˆ’1
is positive semidefinite in this case since 1 + Îº > 0 (see Bentler and Berkane (1986)) and V11
is

positive definite. Note that the adjustment term is positively related to the aggregate pricing-error
measure Q and the kurtosis parameter Îº.
We now turn our attention to the asymptotic distribution of Î³Ì‚ when W must be estimated.
Under a correctly specified model, the use of WÌ‚ instead of W does not alter the asymptotic
distribution of Î³Ì‚ (proof is available upon request). However, the asymptotic distribution is affected
when the model is misspecified. In the following proposition, we present the distribution for the
GLS case.11
âˆ’1
âˆ’1
0 0
Proposition 2. Let H = (X 0V22
X)âˆ’1, A = HX 0V22
, and Î³t = [Î³0t, Î³1t
] = ARt . Under a
âˆ’1
âˆ’1
potentially misspecified model, the asymptotic distribution of Î³Ì‚ = (XÌ‚ 0VÌ‚22
XÌ‚)âˆ’1 XÌ‚ 0VÌ‚22
ÂµÌ‚2 is given by

âˆš
A
T (Î³Ì‚ âˆ’ Î³) âˆ¼ N (0K+1, V (Î³Ì‚)),

(30)

where
V (Î³Ì‚) =

âˆ
X

E[hth0t+j ],

(31)

j=âˆ’âˆ

with
ht = (Î³t âˆ’ Î³) âˆ’ (Ï†t âˆ’ Ï†)wt + Hzt ut âˆ’ (Î³t âˆ’ Î³)ut,

(32)

âˆ’1
âˆ’1
Ï†t = [Î³0t, (Î³1t âˆ’ ft )0]0, Ï† = [Î³0, (Î³1 âˆ’ Âµ1 )0]0 , ut = e0 V22
(Rt âˆ’ Âµ2 ), wt = Î³10 V11
(ft âˆ’ Âµ1 ), zt =
âˆ’1 0
[0, (ft âˆ’ Âµ1 )0V11
] . When the model is correctly specified, we have:

ht = (Î³t âˆ’ Î³) âˆ’ (Ï†t âˆ’ Ï†)wt.
11

Various results for the WLS case are available upon request.

10

(33)

Comparing (32) with the expression for ht in (21), we see that there is an extra term in ht
associated with the use of WÌ‚ instead of W . This fourth term vanishes only when the model is
correctly specified.
In order to gain a more concrete understanding of the misspecification adjustment term, in the
following lemma we derive an explicit expression for V (Î³Ì‚) in the GLS case under the multivariate
elliptical assumption.

Lemma 2. When the factors and returns are i.i.d. multivariate elliptically distributed with kurtosis
âˆ’1
âˆ’1
parameter Îº, the asymptotic variance of Î³Ì‚ = (XÌ‚ 0VÌ‚22
XÌ‚)âˆ’1 XÌ‚ 0VÌ‚22
ÂµÌ‚2 is given by

V (Î³Ì‚) = Î¥w + Î¥w2 ,

(34)

âˆ’1
Î¥w = H + (1 + Îº)Î³10 V11
Î³1(X 0Î£âˆ’1 X)âˆ’1,
i
h
âˆ’1
Î¥w2 = (1 + Îº)Q (X 0Î£âˆ’1 X)âˆ’1VÌƒ11
(X 0Î£âˆ’1 X)âˆ’1 + (X 0Î£âˆ’1 X)âˆ’1 ,

(35)

where

with H =

âˆ’1
(X 0V22
X)âˆ’1,

Q=

âˆ’1
e0 V22
e,

and

âˆ’1
VÌƒ11

=

"

0

00K

âˆ’1
0K V11

(36)

#

.

When Q > 0, the misspecification adjustment term Î¥w2 is positive definite since it is the sum
of two matrices, the first positive semidefinite and the second positive definite. In the proof of
Lemma 2, we show that the misspecification adjustment term crucially depends on the variance
of the residuals from projecting the factors on the returns. For factors that have very low correlation with returns (e.g., macroeconomic factors), therefore, the impact of misspecification on the
asymptotic variance of Î³Ì‚1 can be very large.
D.

Asymptotic Distribution of Î»Ì‚ under Potentially Misspecified Models

In the following proposition, we present the asymptotic distribution of Î»Ì‚, the estimated parameters
in the covariance-based model, for various cases. Since the derivation is very similar to the derivation
for Î³Ì‚, we do not provide the proof.12
12

A proof of this proposition is available upon request. The asymptotic distribution of Î»Ì‚ under the i.i.d. multivariate
elliptical distributional assumption is also available upon request.

11

Proposition 3. Under a potentially misspecified model, the asymptotic distribution of Î»Ì‚ is given
by
âˆš

A

T (Î»Ì‚ âˆ’ Î») âˆ¼ N (0K+1, V (Î»Ì‚)),

(37)

where
V (Î»Ì‚) =

âˆ
X

E[hÌƒthÌƒ0t+j ].

(38)

j=âˆ’âˆ

To simplify the expressions for hÌƒt , we define GÌƒt = V21 âˆ’ (Rt âˆ’ Âµ2 )(ft âˆ’ Âµ1 )0, zÌƒt = [0, (ft âˆ’ Âµ1 )0]0,
HÌƒ = (C 0 W C)âˆ’1 , AÌƒ = HÌƒC 0 W , Î»t = AÌƒRt , and ut = e0W (Rt âˆ’ Âµ2 ).
(1) With a known weighting matrix W , Î»Ì‚ = (CÌ‚ 0 W CÌ‚)âˆ’1 CÌ‚ 0 W ÂµÌ‚2 and
hÌƒt = (Î»t âˆ’ Î») + AÌƒGÌƒtÎ»1 + HÌƒ zÌƒt ut .

(39)

âˆ’1
âˆ’1
(2) For GLS, Î»Ì‚ = (CÌ‚ 0 VÌ‚22
CÌ‚)âˆ’1 CÌ‚ 0 VÌ‚22
ÂµÌ‚2 and

hÌƒt = (Î»t âˆ’ Î») + AÌƒGÌƒt Î»1 + HÌƒ zÌƒt ut âˆ’ (Î»t âˆ’ Î»)ut.

(40)

When the model is correctly specified, we have:
hÌƒt = (Î»t âˆ’ Î») + AÌƒGÌƒt Î»1.

E.

(41)

Asymptotic Distribution of the Sample Cross-Sectional R2

The sample R2 (ÏÌ‚2) in the second-pass CSR is a popular measure of goodness of fit for a model.
A high ÏÌ‚2 is viewed as evidence that the model under study does a good job of explaining the
cross-section of expected returns. Lewellen, Nagel, and Shanken (2009) point out several pitfalls in
this approach and explore simulation techniques to obtain approximate confidence intervals for Ï2 .
In this subsection, we provide the first formal statistical analysis of ÏÌ‚2 .
In the following proposition, we show that the asymptotic distribution of ÏÌ‚2 crucially depends on
whether (1) the population Ï2 is 1 (i.e., a correctly specified model), (2) 0 < Ï2 < 1 (a misspecified
model that provides some explanatory power for the expected returns on the test assets), or (3)
Ï2 = 0 (a misspecified model that does not explain any of the cross-sectional variation in expected
returns for the test assets).
12

âˆ’1
Proposition 4. In the following, we set W to be V22
for the GLS case. (1) When Ï2 = 1,

2

T (ÏÌ‚ âˆ’ 1) = âˆ’

T QÌ‚

A

âˆ¼âˆ’

QÌ‚0

N âˆ’Kâˆ’1
X
j=1

Î¾j
xj ,
Q0

(42)

where the xj â€™s are independent Ï‡21 random variables, and the Î¾j â€™s are the eigenvalues of
1

1

P 0 W 2 SW 2 P,

(43)
1

where P is an N Ã— (N âˆ’ K âˆ’ 1) orthonormal matrix with columns orthogonal to W 2 C, S is the
P
asymptotic covariance matrix of âˆš1T Tt=1 Rt yt , and yt = 1âˆ’Î»01(ft âˆ’Âµ1 ) is the normalized stochastic
discount factor (SDF).
(2) When 0 < Ï2 < 1,
âˆš

ï£«

A

T (ÏÌ‚2 âˆ’ Ï2) âˆ¼ N ï£­0,

âˆ
X
j=âˆ’âˆ

ï£¶

E[ntnt+j ]ï£¸ ,

(44)

where


nt = 2 âˆ’ut yt + (1 âˆ’ Ï2)vt /Q0


nt = u2t âˆ’ 2ut yt + (1 âˆ’ Ï2)(2vt âˆ’ vt2 ) /Q0

for known W,

(45)

âˆ’1
for WÌ‚ = VÌ‚22
,

(46)

with e0 = [IN âˆ’ 1N (10N W 1N )âˆ’1 10N W ]Âµ2 , ut = e0 W (Rt âˆ’ Âµ2 ), and vt = e00 W (Rt âˆ’ Âµ2 ).
(3) When Ï2 = 0,
A

T ÏÌ‚2 âˆ¼

K
X
Î¾j
xj ,
Q0

(47)

j=1

where the xj â€™s are independent

Ï‡21

random variables and the Î¾j â€™s are the eigenvalues of

[Î² 0W Î² âˆ’ Î² 0 W 1N (10N W 1N )âˆ’1 10N W Î²]V (Î³Ì‚1),

(48)

where V (Î³Ì‚1) is given in Proposition 1 (for known weighting matrix W ) or Proposition 2 (for GLS).13
The first asymptotic distribution in (42) allows us to perform a specification test of the beta
pricing model. This is an alternative to the various multivariate asset pricing tests that have been
13

In the proof of Proposition 4, we show that Ï2 = 0 if and only if Î³1 = 0K . Therefore, another way to test
H0 : Ï2 = 0 is to test the equivalent hypothesis H0 : Î³1 = 0K , which can be easily performed by using a Wald test.
When computing V (Î³Ì‚1 ) for the test of H0 : Ï2 = 0, we can impose the null hypothesis H0 : Î³1 = 0K and drop the
EIV term (Ï†t âˆ’ Ï†)wt in the expressions for ht in Propositions 1 and 2.

13

developed in the literature.14 Whereas the earlier tests focus on an aggregate pricing-error measure,
the R2 -based test examines pricing errors in relation to the cross-sectional variation in expected
returns. In contrast to these tests, the asymptotic distribution in (47) permits a test of whether
the model has any explanatory power for expected returns, i.e., whether we can reject H0 : Ï2 = 0.
When 0 < Ï2 < 1, the primary case of interest, Proposition 4 shows that asymptotically, ÏÌ‚2
is normally distributed around its true value. From the results of the proposition, we see that nt
approaches zero when Ï2 â†’ 0 or Ï2 â†’ 1. Consequently, se(ÏÌ‚2) tends to be lowest when Ï2 is close
to zero or one, and se(ÏÌ‚2) is not monotonic in Ï2. Note that the asymptotic normal distribution of
ÏÌ‚2 breaks down for the two extreme cases (Ï2 = 0 or 1).15 Intuitively, the normal distribution fails
because, by construction, ÏÌ‚2 will always be above zero (even when Ï2 = 0) and below one (even
when Ï2 = 1).16

III.

Tests for Comparing Two Competing Models

One way to think about model comparison and selection is to ask whether two competing beta pricing models have the same population cross-sectional R2 . In this section, we derive the asymptotic
distribution of the difference between the sample R2s of two models. We show that this distribution
depends on whether the two models are nested or non-nested and whether the models are correctly
specified or not. For model comparison, we focus on the R2 of the CSR with known weighting
âˆ’1
matrix W and on the R2 of the GLS CSR that uses WÌ‚ = VÌ‚22
as the weighting matrix.

Our analysis in this section is related to the model selection tests of Kan and Robotti (2008)
and Li, Xu, and Zhang (2009), which are based on the earlier work of Vuong (1989), Rivers and
Vuong (2002), and Golden (2003). Whereas Kan and Robotti (2008) and Li, Xu, and Zhang
(2009) conduct tests of equality of the Hansen-Jagannathan (1997) distances of two competing
asset pricing models, our objective is to test for equality of the cross-sectional R2s of two models.
The asymptotic distributions of the model selection tests developed here are derived under general
14

See Campbell, Lo, and MacKinlay (1997) or Cochrane (2005) and the included references.
This is because when Ï2 = 1, we have e = 0N and ut = 0, so nt in (45) and (46) becomes zero. Similarly, when
2
Ï = 0, we have yt = 1, e = e0 and ut = vt, so again nt in (45) and (46) vanishes.
16
As a result, we need to use a weighted sum of independent chi-squared random variables with one degree of
freedom to characterize the sampling variation of ÏÌ‚2 for these two extreme cases. The asymptotic distribution of ÏÌ‚2
under the i.i.d. multivariate elliptical distributional assumption is available upon request.
15

14

distributional assumptions.17
We consider two competing beta pricing models. Let f1 , f2 , and f3 be three sets of distinct
factors, where fi is of dimension Ki Ã— 1, i = 1, 2, 3. Assume that model A uses f1 and f2 , while
Model B uses f1 and f3 as factors. Therefore, model A requires that the expected returns on the
test assets are linear in the betas or covariances with respect to f1 and f2 , i.e.,
Âµ2 = 1N Î»A,0 + Cov[R, f10 ]Î»A,1 + Cov[R, f20 ]Î»A,2 = CA Î»A ,

(49)

where CA = [1N , Cov[R, f10 ], Cov[R, f20 ]] and Î»A = [Î»A,0, Î»0A,1 , Î»0A,2]0. Model B requires that
expected returns are linear in the betas or covariances with respect to f1 and f3 , i.e.,
Âµ2 = 1N Î»B,0 + Cov[R, f10 ]Î»B,1 + Cov[R, f30 ]Î»B,3 = CB Î»B ,

(50)

where CB = [1N , Cov[R, f10 ], Cov[R, f30 ]] and Î»B = [Î»B,0, Î»0B,1, Î»0B,3]0.
In general, both models can be misspecified. Following the development in Section II.A, given
a weighting matrix W , the Î»i that maximizes the Ï2 of model i is given by
Î»i = (Ci0 W Ci )âˆ’1 Ci0 W Âµ2 ,

(51)

where Ci is assumed to have full column rank, i = A, B. For each model, the pricing-error vector
ei , the aggregate pricing-error measure Qi , and the corresponding goodness-of-fit measure Ï2i are
all defined as in Section II.
When K2 = 0, model B nests model A as a special case. Similarly, when K3 = 0, model A nests
model B. When both K2 > 0 and K3 > 0, the two models are non-nested. We study the nested
models case in the next subsection and deal with non-nested models in Section III.B.
A.

Nested Models

Without loss of generality, we assume K3 = 0, so that model A nests model B. In this case, the
following lemma shows that Ï2A = Ï2B is equivalent to a restriction on the parameters of model A.
Lemma 3. Ï2A = Ï2B if and only if Î»A,2 = 0K2 .
17

The asymptotic distributions of our model selection tests under the multivariate elliptical distributional assumption are available upon request.

15

Note that Lemma 3 is applicable even when the models are misspecified. By this lemma, to
test whether the models have the same Ï2, one can simply perform a test of H0 : Î»A,2 = 0K2 . Let
âˆš
VÌ‚ (Î»Ì‚A,2) be a consistent estimator of the asymptotic variance of T (Î»Ì‚A,2 âˆ’ Î»A,2 ). Then, under the
null hypothesis,
A

T Î»Ì‚0A,2VÌ‚ (Î»Ì‚A,2)âˆ’1 Î»Ì‚A,2 âˆ¼ Ï‡2K2 ,

(52)

and this statistic can be used to test H0 : Ï2A = Ï2B . If K2 = 1, we can also use the t-ratio associated
with Î»Ì‚A,2 to perform the test. However, it is important to note that, in general, we cannot conduct
this test using the usual standard error of Î»Ì‚, which assumes that model A is correctly specified.
Instead, we need to rely on the misspecification-robust standard error of Î»Ì‚ given in Proposition 3.
Alternatively, in keeping with the common practice of comparing cross-sectional R2s, we can
derive the asymptotic distribution of ÏÌ‚2A âˆ’ ÏÌ‚2B and use this statistic to test H0 : Ï2A = Ï2B . The next
proposition presents the distribution.
0 W C )âˆ’1 as
Proposition 5. Partition HÌƒA = (CA
A
#
"
HÌƒA,11 HÌƒA,12
HÌƒA =
,
HÌƒA,21 HÌƒA,22

(53)

where HÌƒA,22 is K2 Ã— K2. Under the null hypothesis H0 : Ï2A = Ï2B ,
A

T (ÏÌ‚2A âˆ’ ÏÌ‚2B ) âˆ¼

K2
X
Î¾j
xj ,
Q0

(54)

j=1

âˆ’1
where the xj â€™s are independent Ï‡21 random variables and the Î¾j â€™s are the eigenvalues of HÌƒA,22
V (Î»Ì‚A,2 ).

Again, we emphasize that the misspecification-robust version of V (Î»Ì‚A,2) should be used to test
H0 : Ï2A = Ï2B . Model misspecification tends to create additional sampling variation in ÏÌ‚2A âˆ’ ÏÌ‚2B .
Without taking this into account, one might mistakenly reject the null hypothesis when it is true.
In actual testing, we replace Î¾j with its sample counterpart Î¾Ë†j , where the Î¾Ë†j â€™s are the eigenvalues
Ë† âˆ’1 VÌ‚ (Î»Ì‚ ), computed from the consistent estimators HÌƒ
Ë†
of HÌƒ
A,2
A,22 and VÌ‚ (Î»Ì‚A,2 ).
A,22
Before considering the more complicated case of non-nested models, it is worth clarifying a point
about risk premia, which we suspect is not widely understood. Lemma 3 implies that whether the
extra factors f2 improve the cross-sectional R2 depends on whether any of the prices of covariance
risk associated with f2 are nonzero. However, Î»2 = 0K2 does not mean that the usual risk premia
16

(coefficients on the multiple-regression betas) associated with f2 are zero. To see this, let Î³ =
[Î³0, Î³10 , Î³20 ]0 be the zero-beta rate and risk premia for f1 and f2 . Then, using the one-to-one
correspondence between Î» and Î³ in (10), we have:
"
# "
#
#"
Î³1
Var[f1 ]
Cov[f1 , f20 ]
Î»1
=
.
Cov[f2 , f10 ]
Î³2
Var[f2 ]
Î»2

(55)

Hence, the risk premia associated with f2 are Î³2 = Cov[f2 , f10 ]Î»1 when Î»2 is zero. As we see, Î³2
can still be nonzero in this case unless f1 and f2 are uncorrelated.18 Similarly, we can show that
Î³2 = 0K2 does not imply Î»2 = 0K2 unless f1 and f2 are uncorrelated.
In other words, finding a significant t-ratio on a factor risk premium â€” the case of a so-called
â€œpricedâ€ factor â€” need not imply that inclusion of that factor will add to the cross-sectional
explanatory power of a model. Similarly, finding that a factor is not â€œpricedâ€ in the usual sense
need not imply that the factor is unimportant in explaining cross-sectional differences in expected
returns. There is no problem if one simply wants to estimate the parameters of a given pricing
model, as is often the case. Indeed, in some contexts the multiple regression betas and corresponding
risk premia may be of great economic interest. But there is an issue if one is concerned with the
hypothesis of incremental explanatory power for expected returns. We provide some examples to
illustrate these points.
In the first example, we consider two factors with
"
#
15 âˆ’10
V11 =
.
âˆ’10 15

(56)

Suppose there are four assets and their expected returns and covariances with the two factors are
"
#
1 2 3 4
0
Âµ2 = [2, 3, 4, 5] ,
V12 =
.
(57)
3 5 2 1
It is clear that the covariances (or simple regression betas) of the four assets with respect to the
first factor alone can fully explain Âµ2 because Âµ2 is exactly linear in the first row of V12. As a result,
the second factor is irrelevant from a cross-sectional expected return perspective. However, when
we compute the (multiple regression) beta matrix with respect to the two factors, we obtain:
"
#0
0.36
0.64
0.52
0.56
âˆ’1
Î² = V21V11
=
.
(58)
0.44 0.76 0.48 0.44
18

When Î»2 = 0K2 , we see that Î³1 = Var[f1 ]Î»1 . Consequently, the risk premia for f1 stay the same when we add f2
to the model.

17

Simple calculations give Î³ = [1, 15, âˆ’10]0 and Î³2 is nonzero even though f2 is irrelevant.19
In the second example, we change Âµ2 to [10, 17, 14, 15]0. In this case, the covariances (or
simple regression betas) with respect to f1 alone do not fully explain Âµ2 (in fact, the OLS Ï2 for
the model with just f1 is only 28%). However, it is easy to see that Âµ2 is linear in the first column
of the beta matrix, implying that the Ï2 of the full model is 100%. Simple calculations give us
Î³ = [1, 25, 0]0 and Î³2 = 0, even though f2 is needed in the factor model, along with f1 , to explain
Âµ2 .
B.

Non-Nested Models

The test of H0 : Ï2A = Ï2B is more complicated for non-nested models. The reason is that under H0 ,
there are three possible asymptotic distributions for ÏÌ‚2A âˆ’ ÏÌ‚2B , depending on why the two models
have the same cross-sectional R2 . To see this, first let us define the normalized SDFs for models A
and B as
yA = 1âˆ’(f1 âˆ’E[f1])0Î»A,1 âˆ’(f2 âˆ’E[f2])0Î»A,2,

yB = 1âˆ’(f1 âˆ’E[f1])0Î»B,1 âˆ’(f3 âˆ’E[f3])0Î»B,3. (59)

In the Appendix, we show that yA = yB implies that the two models have the same pricing
errors and hence Ï2A = Ï2B . If yA 6= yB , there are additional cases in which Ï2A = Ï2B . A second
possibility is that both models are correctly specified (i.e., Ï2A = Ï2B = 1). This occurs, for example,
if model A is correctly specified and the factors f3 in model B are given by f3 = f2 + , where 
is pure â€œnoiseâ€ â€” a vector of measurement errors with mean zero, independent of returns. In this
case, we have CA = CB and both models produce zero pricing errors. A third possibility is that
the two models produce different pricing errors but the same overall goodness of fit. Intuitively,
one model might do a good job of pricing some assets that the other prices poorly and vice versa,
such that the aggregation of pricing errors is the same in each case (Ï2A = Ï2B < 1). As it turns out,
each of these three scenarios results in a different asymptotic distribution for ÏÌ‚2A âˆ’ ÏÌ‚2B .
1. yA = yB Case
At first sight, it may appear that yA = yB is equivalent to the joint restriction Î»A,1 = Î»B,1,
Î»A,2 = 0K2 and Î»B,3 = 0K3 . The following lemma shows that the first equality is redundant since
19

This suggests that when the CAPM is true, it does not imply that the betas with respect to the other two
Fama-French factors should not be priced. See Grauer and Janmaat (2009) for a discussion of this point.

18

it is implied by the other two.
Lemma 4. For non-nested models, yA = yB if and only if Î»A,2 = 0K2 and Î»B,3 = 0K3 .
Note that Lemma 4 is applicable even when the models are misspecified. It implies that we can
test H0 : yA = yB by testing the joint hypothesis H0 : Î»A,2 = 0K2 , Î»B,3 = 0K3 . Let Ïˆ = [Î»0A,2, Î»0B,3]0
and ÏˆÌ‚ = [Î»Ì‚0A,2 , Î»Ì‚0B,3]0. Arguing, as in the proof of Proposition 3, we can establish that under
H0 : yA = yB , the asymptotic distribution of ÏˆÌ‚ is
âˆš

A

T (ÏˆÌ‚ âˆ’ Ïˆ) âˆ¼ N (0K2+K3 , V (ÏˆÌ‚)),
where
V (ÏˆÌ‚) =

âˆ
X

0
E[qÌƒtqÌƒt+j
],

(60)

(61)

j=âˆ’âˆ

and qÌƒt is a K2 + K3 vector obtained by stacking up the last K2 and K3 elements of hÌƒt for models A
and B, respectively, where hÌƒt is given in Proposition 3.
Let VÌ‚ (ÏˆÌ‚) be a consistent estimator of V (ÏˆÌ‚). Then, under the null hypothesis H0 : Ïˆ = 0K2 +K3 ,
A

T ÏˆÌ‚ 0VÌ‚ (ÏˆÌ‚)âˆ’1 ÏˆÌ‚ âˆ¼ Ï‡2K2 +K3 ,

(62)

and this statistic can be used to test H0 : yA = yB . As in the nested models case, it is important
to conduct this test using the misspecification-robust standard error of ÏˆÌ‚.
Alternatively, we can perform a test based on the popular Ï2 metric, the main focus of this
paper. The following proposition gives the asymptotic distribution of ÏÌ‚2A âˆ’ ÏÌ‚2B given H0 : yA = yB .
0
0
Proposition 6. Let HÌƒA = (CA
W CA )âˆ’1 and HÌƒB = (CB
W CB )âˆ’1 , and partition them as
#
#
"
"
HÌƒA,11 HÌƒA,12
HÌƒB,11 HÌƒB,13
HÌƒA =
,
HÌƒB =
,
HÌƒA,21 HÌƒA,22
HÌƒB,31 HÌƒB,33

(63)

where HÌƒA,11 and HÌƒB,11 are (K1 + 1) Ã— (K1 + 1). Under the null hypothesis H0 : yA = yB ,
T (ÏÌ‚2A

âˆ’

A
ÏÌ‚2B ) âˆ¼

KX
2 +K3
j=1

Î¾j
xj ,
Q0

where the xj â€™s are independent Ï‡21 random variables and the Î¾j â€™s are the eigenvalues of
"
#
âˆ’1
HÌƒA,22
0K2 Ã—K3
V (ÏˆÌ‚).
âˆ’1
0K3 Ã—K2 âˆ’HÌƒB,33
19

(64)

(65)

Note that we can think of the earlier nested models scenario as a special case of testing H0 :
yA = yB with K3 = 0. The only difference is that the Î¾j â€™s in Proposition 5 are all positive whereas
some of the Î¾j â€™s in Proposition 6 are negative. As a result, we need to perform a two-sided test
based on ÏÌ‚2A âˆ’ ÏÌ‚2B in the non-nested model case.20
If we fail to reject H0 : yA = yB , we are finished since equality of Ï2A and Ï2B is implied by this
hypothesis. Otherwise, we need to consider the case yA 6= yB .
2. yA 6= yB Case
As noted earlier, when yA 6= yB , the asymptotic distribution of ÏÌ‚2A âˆ’ ÏÌ‚2B given H0 : Ï2A = Ï2B
depends on whether the models are correctly specified or not. The following proposition presents
a simple chi-squared statistic for testing whether models A and B are both correctly specified. As
this joint specification test focuses on the pricing errors, it can be viewed as a generalization of the
cross-sectional regression test (CSRT) of Shanken (1985), which tests the validity of the expected
return relation for a single pricing model.
Proposition 7. Let nA = N âˆ’ K1 âˆ’ K2 âˆ’ 1 and nB = N âˆ’ K1 âˆ’ K3 âˆ’ 1. Also let PA be an N Ã— nA
1

orthonormal matrix with columns orthogonal to W 2 CA and PB be an N Ã— nB orthonormal matrix
1

with columns orthogonal to W 2 CB . Define
#
"
# "
gAt (Î»A )
Rt yAt
gt(Î¸) =
,
=
gBt(Î»B )
Rt yBt

(66)

where Î¸ = (Î»0A, Î»0B )0, and
Sâ‰¡

"

SAA

SAB

SBA SBB

#

âˆ
X

=

E[gt(Î¸)gt+j (Î¸)0].

(67)

j=âˆ’âˆ

If yA 6= yB and the null hypothesis H0 : Ï2A = Ï2B = 1 holds, then
"
#0 "
#"
#
1
1
1
1
1
1
PÌ‚A0 WÌ‚ 2 eÌ‚A
PÌ‚A0 WÌ‚ 2 SÌ‚AA WÌ‚ 2 PÌ‚A PÌ‚A0 WÌ‚ 2 SÌ‚AB WÌ‚ 2 PÌ‚B
PÌ‚A0 WÌ‚ 2 eÌ‚A A 2
T
âˆ¼ Ï‡nA +nB ,
1
1
1
1
1
1
PÌ‚B0 WÌ‚ 2 eÌ‚B
PÌ‚B0 WÌ‚ 2 SÌ‚BAWÌ‚ 2 PÌ‚A PÌ‚B0 WÌ‚ 2 SÌ‚BB WÌ‚ 2 PÌ‚B
PÌ‚B0 WÌ‚ 2 eÌ‚B

(68)

where eÌ‚A and eÌ‚B are the sample pricing errors of models A and B, and PÌ‚A , PÌ‚B , and SÌ‚ are consistent
estimators of PA , PB , and S, respectively.
20
Following Davidson and MacKinnon (2003, p. 174), the p-value associated with a realized statistic Ï„Ì‚ based on
a possibly asymmetric distribution is computed as p = 2min[F (Ï„Ì‚), 1 âˆ’ F (Ï„Ì‚ )], where F (Ï„Ì‚ ) is the cumulative density
function of the statistic Ï„Ì‚ .

20

An alternative specification test makes use of the cross-sectional R2s. The relevant asymptotic
distribution is given in the following proposition.
Proposition 8. Using the notation in Proposition 7, if yA 6= yB and the null hypothesis H0 : Ï2A =
Ï2B = 1 holds, then
A

T (ÏÌ‚2A âˆ’ ÏÌ‚2B ) âˆ¼

nAX
+nB

Î¾j
xj ,
Q0

j=1

(69)

where the xj â€™s are independent Ï‡21 random variables and the Î¾j â€™s are the eigenvalues of
"

1

1

1

1

âˆ’PA0 W 2 SAA W 2 PA âˆ’PA0 W 2 SAB W 2 PB
1

1

1

PB0 W 2 SBAW 2 PA

#

1

PB0 W 2 SBB W 2 PB

.

(70)

Note that the Î¾j â€™s are not all positive because ÏÌ‚2A âˆ’ ÏÌ‚2B can be negative. Thus, again, we need
to perform a two-sided test of H0 : Ï2A = Ï2B .
If the hypothesis that both models are correctly specified is not rejected, we are finished, as the
data are consistent with H0 : Ï2A = Ï2B = 1. Otherwise, we need to determine whether Ï2A = Ï2B for
some value less than one. As in our earlier analysis for ÏÌ‚2, the asymptotic distribution of ÏÌ‚2A âˆ’ ÏÌ‚2B
changes when the models are misspecified. Proposition 9 presents the appropriate distribution for
this case.
Proposition 9. Suppose yA 6= yB and 0 < Ï2A = Ï2B < 1.21 We have:
ï£«
ï£¶
âˆ
X
âˆš
A
T (ÏÌ‚2A âˆ’ ÏÌ‚2B ) âˆ¼ N ï£­0,
E[dtdt+j ]ï£¸ .

(71)

j=âˆ’âˆ

When the weighting matrix W is known,
dt = 2Qâˆ’1
0 (uBt yBt âˆ’ uAt yAt ),

(72)

âˆ’1
where uAt = e0A W (Rt âˆ’ Âµ2 ) and uBt = e0B W (Rt âˆ’ Âµ2 ). With the GLS weighting matrix WÌ‚ = VÌ‚22
,
2
2
dt = Qâˆ’1
0 (uAt âˆ’ 2uAt yAt âˆ’ uBt + 2uBtyBt ),
âˆ’1
âˆ’1
where uAt = e0A V22
(Rt âˆ’ Âµ2 ) and uBt = e0B V22
(Rt âˆ’ Âµ2 ).
21

Since Ï2A = Ï2B = 0 implies yA = yB = 1, this case is already covered by the test based on Lemma 4.

21

(73)

Note that if yAt = yBt, then uAt = uBt, and hence dt = 0. Or, if yAt 6= yBt, but both models
are correctly specified (i.e., uAt = uBt = 0), then again dt = 0. Thus, the normal test cannot be
used in these cases, consistent with the maintained assumptions in the proposition.22
C.

Discussion

Given the three distinct cases encountered in testing H0 : Ï2A = Ï2B for non-nested models, the
approach we have described above entails a sequential test, as suggested by Vuong (1989). In our
context, this involves first testing H0 : yA = yB using (62) or (64). If we reject H0 : yA = yB , then
we use (68) or (69) to test H0 : Ï2A = Ï2B = 1. Finally, if this hypothesis is also rejected, we use the
normal test in Proposition 9 to test H0 : 0 < Ï2A = Ï2B < 1. Let Î±1, Î±2 , and Î±3 be the significance
levels employed in these three tests. Then the sequential test has an asymptotic significance level
that is bounded above by max[Î±1, Î±2, Î±3].23 Thus, if Î±1 = Î±2 = Î±3 = 0.05, the significance level of
this procedure for testing H0 : Ï2A = Ï2B is asymptotically no larger than 5%.
Another approach is to simply perform the normal test in Proposition 9. This amounts to assuming that yA 6= yB and that both models are misspecified. The first assumption seems reasonable
since most of our models only have the constant term in common. Consequently, by Lemma 4,
yA = yB would imply that the models do not account for any cross-sectional variation in expected
returns, an unlikely scenario. The second assumption is sensible because asset pricing models are
approximations of reality and we do not expect them to be perfectly specified. In the following
empirical application, we conduct both the sequential test and the normal test when comparing
non-nested models.

IV.

Empirical Analysis

We apply our methodology to several models of interest in the asset pricing literature. First, we
describe the data used in the empirical analysis and outline the different specifications of the beta
22

Note that, depending on whether the asymptotic distribution is normal (Proposition 9) or a linear combination
1
of independent chi-squared random variables (Propositions 6 and 8), ÏÌ‚2A âˆ’ ÏÌ‚2B can be either OP (T âˆ’ 2 ) or OP (T âˆ’1 ),
2
2
respectively, under H0 : ÏA = ÏB .
23
For the sequential test to reject Ï2A = Ï2B all three tests must reject. Consider the first scenario, yA = yB .
P(reject Ï2A = Ï2B | yA = yB ) â‰¤ P(test 1 rejects | yA = yB ) = Î±1 . Similarly, the probability that the sequential test
rejects under the second and third scenarios cannot exceed Î±2 and Î±3 , respectively. Under H0 : Ï2A = Ï2B , one of the
three scenarios must hold, so the true probability of rejection cannot exceed the maximum.

22

pricing models considered. Then we present our results.
A.

Data and Beta Pricing Models

The return data are from Kenneth Frenchâ€™s website and consist of the monthly returns on the 25
Fama-French size and book-to-market ranked portfolios. For most of our time series, the data are
from May 1953 to December 2006 (644 monthly observations). The beginning date of our sample
period is dictated by the bond yield data availability from the Board of Governors of the Federal
Reserve System.24
We analyze six asset pricing models. The first model is the simple static CAPM. The crosssectional specification is
Âµ2 = Î³0 + Î²vw Î³vw ,
where vw is the excess return (in excess of the one-month T-bill rate from Ibbotson Associates) on
the value-weighted stock market index (NYSE-AMEX-NASDAQ) from the Center for Research in
Security Prices (CRSP).
The second model (CCAPM) is the unconditional consumption CAPM, which implies
Âµ2 = Î³0 + Î²cg Î³cg ,
where cg is the growth rate in real nondurables consumption (from the Bureau of Economic Analysis). For consumption growth, the monthly data start in February 1959 (575 monthly observations).
The third model (FF3) is the Fama-French (1993) empirical three-factor model with
Âµ2 = Î³0 + Î²vw Î³vw + Î²smb Î³smb + Î²hml Î³hml ,
where vw is the stock market factor, smb is the return difference between portfolios of small and
large stocks and hml is the return difference between portfolios of high and low book-to-market
ratios (from Kenneth Frenchâ€™s website).
The fourth model (C-LAB) is the conditional CAPM of Jagannathan and Wang (1996). The
cross-sectional specification is
Âµ2 = Î³0 + Î²vw Î³vw + Î²lab Î³lab + Î²prem Î³prem ,
24

All bond yield data are from this source unless noted otherwise.

23

where vw is the stock market factor, lab is the growth rate in per capita labor income and prem is
the lagged yield spread between BAA and AAA rated corporate bonds. Per capita labor income,
L, is defined as the difference between total personal income and dividend payments, divided by
the total population (from the Bureau of Economic Analysis). Following Jagannathan and Wang
(1996), we use a two-month moving average to construct the growth rate in per capita labor income,
labt = (Ltâˆ’1 + Ltâˆ’2 )/(Ltâˆ’2 + Ltâˆ’3 ) âˆ’ 1, for the purpose of minimizing the influence of measurement
error.
The fifth model (C-CCAPM) is a conditional CCAPM, with a cross-sectional specification of
the form
Âµ2 = Î³0 + Î²dy Î³dy + Î²cg Î³cg + Î²cgÂ·dy Î³cgÂ·dy ,
where dy, the conditioning variable, is the lagged dividend yield of the NYSE-AMEX-NASDAQ
value-weighted portfolio (from CRSP). This specification is obtained by scaling the constant term
and the cg factor of a linearized CCAPM by a constant and dy. Scaling factors by instruments
is one popular way of allowing factor risk premia and betas to vary over time. Examples of this
type of practice are found in Shanken (1990), Ferson and Schadt (1996), Cochrane (1996), and
Lettau and Ludvigson (2001), among others. We choose the lagged dividend yield as an instrument
because of its frequent use in the literature.
The last model (ICAPM) is the five-factor intertemporal CAPM proposed by Petkova (2006),
which implies
Âµ2 = Î³0 + Î²vw Î³vw + Î²term Î³term + Î²def Î³def + Î²div Î³div + Î²rf Î³rf ,
where vw is the stock market factor, term is the difference between the yields of ten-year and
one-year government bonds, def is the difference between the yields of long-term corporate Baa
bonds and long-term government bonds (from Ibbotson Associates), div is the dividend yield on the
CRSP value-weighted stock market portfolio, and rf is the one-month T-bill yield (from CRSP,
Fama Risk Free Rates). Following Petkova (2006), the factors for term, def , div, and rf are
actually their innovations from a VAR(1) system of seven state variables that also include vw, smb,
and hml.25
25
In contrast to Petkova (2006), we do not orthogonalize the innovations since the R2 of the model is the same
whether we orthogonalize or not. The results for the parameter estimates using the orthogonalized innovations are
available upon request.

24

B.

Results

We start by estimating the sample cross-sectional R2 s of the different pricing models considered.
Then we analyze the impact of potential model misspecification on the statistical properties of the
estimated Î³ and Î» parameters. Finally, we present the results of our pairwise tests of equality of
the cross-sectional R2 s for different models.
1. Sample Cross-Sectional R2s of the Models
One of the main contributions of this paper is to provide the asymptotic distribution of the sample
cross-sectional R2. In Table 1, we report ÏÌ‚2 for each model and use the results in Proposition 4 to
investigate whether the model can do a good job of explaining the cross-section of expected returns.
We denote the p-value of the specification test of H0 : Ï2 = 1 by p(Ï2 = 1), and the p-value of the
test of H0 : Ï2 = 0 by p(Ï2 = 0). The asymptotic standard error of the sample cross-sectional R2
computed under the assumption that 0 < Ï2 < 1 is se(ÏÌ‚2).
In addition, we report a generalized version of the CSRT of Shanken (1985), QÌ‚c = eÌ‚0 VÌ‚ (eÌ‚)+ eÌ‚,
where VÌ‚ (eÌ‚) is a consistent estimator of the asymptotic variance of the sample pricing errors and
VÌ‚ (eÌ‚)+ stands for its pseudo-inverse. When the model is correctly specified (i.e., e = 0N or Ï2 = 1),
A

we have T QÌ‚c âˆ¼ Ï‡2N âˆ’Kâˆ’1 .26 Following Shanken (1985), we also consider an approximate F -test


app.
âˆ’Kâˆ’1
27 The two p-values associated with testing
which is given by QÌ‚c âˆ¼ N
T âˆ’N +1 FN âˆ’Kâˆ’1,T âˆ’N +1 .
H0 : Qc = 0 are p1 (Qc = 0), the asymptotic p-value, and p2 (Qc = 0), the p-value for the approximate
F -test.28 Finally, the number of parameters in each asset pricing model is No. of par.
Table 1 about here
In Panels A and B of Table 1, we provide results for the OLS and GLS CSRs, respectively.
First, we consider the specification tests based on R2s. It turns out that several models are rejected
at the 5% level: three out of six in the OLS case and four out of six using GLS. Consistent with
26

Our QÌ‚c is more general than the CSRT of Shanken (1985) because we can use sample pricing errors from any
CSR, not just the ones from the GLS CSR. In addition, we allow for conditional heteroskedasticity and autocorrelated
errors. Proofs of the results related to QÌ‚c are available upon request.
27
Simulation evidence suggests that this test has better size properties than the asymptotic test, especially when
N is large relative to T .
28
The p-values and standard errors in Table 1 are computed assuming no serial correlation. In a separate set of
results (available upon request), we implement the automatic lag selection procedure without prewhitening of Newey
and West (1994). Overall, accounting for serial correlation in the data has a fairly minor impact on the results.

25

the empirical findings of Petkova (2006), the ICAPM delivers the highest OLS and GLS R2s and
passes the corresponding specification tests.
Interestingly, not all models with high cross-sectional R2s pass the specification test. For example, the FF3 model has the second highest OLS R2 (0.769) but is rejected with p-value 0.000 (it is
also rejected using GLS). This rejection with a modestly smaller R2 may be due in part to greater
precision, as suggested by the smaller standard error estimates (especially GLS) for FF3 compared
to ICAPM. Thus, while the specification tests provide information about the validity of a given
model, they provide little information about model comparison. Formal tests will be needed to
determine whether the ICAPM outperforms the other models.
We note that the C-CCAPM also passes the R2 specification test in the OLS and GLS cases,
while the unconditional CCAPM is strongly rejected. The true R2 s of the conditional model may
indeed be higher, and the pricing errors smaller, because the scaling variable dy allows the price
of risk and betas to vary with the business cycle. However, we must keep in mind that the use
of conditioning variables increases the number of factors and parameters, making the conditional
models better able to fit the average returns in any given sample. Again, we will need a formal test,
in this case to establish whether going from unconditional to conditional models truly improves the
cross-sectional R2 .
In rows five through seven of Table 1, we report the generalized CSRT and corresponding pvalues. The asymptotic and approximate finite sample p-values of the CSRT are close to each other
and fully support the asymptotic findings based on the sample R2s. Out of 12 cases in Panels A
and B, all specification tests reject the same seven models at the 1% and 5% significance levels.
Assuming that 0 < Ï2 < 1, se(ÏÌ‚2) captures the sampling variability of ÏÌ‚2. In Table 1, we observe
that the ÏÌ‚2s of several models are quite volatile, with the C-CCAPM having a se(ÏÌ‚2) of almost 0.45
in the OLS case. This suggests that some of the models pass the specification test simply because
of low power. In fact, for the C-CCAPM and using OLS, not only do we fail to reject H0 : Ï2 = 1,
but also H0 : Ï2 = 0, the hypothesis that the model cannot explain any of the cross-sectional
differences in expected returns on the 25 size and book-to-market ranked portfolios. We fail to
reject H0 : Ï2 = 0 at the 5% level for the CAPM and CCAPM as well in the OLS case and for the
CCAPM and C-LAB using GLS.29 We will see below that high volatility of the Ï2 estimates also
29

In computing the p-value of the test of H0 : Ï2 = 0, we impose the constraint of Î³1 = 0K in the computation of

26

makes it hard to distinguish between models.
To summarize, several observations emerge from the results in Table 1. First, there is strong
evidence of the need to incorporate model misspecification into our statistical analysis. Second,
there is considerable sampling variability in ÏÌ‚2 and so it is not entirely clear whether one model
consistently outperforms the others. Finally, specification test results are sometimes sensitive to
the weighting matrix used, and it is not always the case that models with very high ÏÌ‚2s pass the
specification test.
2. Properties of the Î³ and Î» Estimates under Correctly Specified and Potentially Misspecified
Models
Before turning to model comparison, we investigate whether model misspecification substantially
affects the properties of the Î³ and Î» estimators. As far as we know, all previous empirical asset
pricing studies except the recent paper by Shanken and Zhou (2007) have used standard errors that
assume the model is correctly specified. As we argued in the introduction, it is difficult to justify
this practice because some (if not all) of the models are bound to be misspecified. In this subsection,
we see whether using an asymptotic standard error that is robust to model misspecification can
lead to different inferences.
In Table 2, we focus on the zero-beta rate and risk premia estimates, Î³Ì‚, of the beta pricing
models. For each model, we report Î³Ì‚ and associated t-ratios under correctly specified and potentially
misspecified models.30 For correctly specified models, we give the t-ratios of Fama and MacBeth
(1973), followed by those of Shanken (1992) and Jagannathan and Wang (1998) which account for
estimation error in the betas. Last, are the t-ratios under potentially misspecified models, based
on our results in Propositions 1 and 2. The various t-ratios are identified by subscripts f m, s, jw,
and pm, respectively.

Table 2 about here

Consistent with our theoretical results, we find that the t-ratios under correctly specified and
VÌ‚ (Î³Ì‚1 ). If we do not impose this constraint, then we fail to reject H0 : Ï2 = 0 for more models.
30
The t-ratios are computed by assuming that the errors have no serial correlation. In a separate set of results
(available upon request), we implement the automatic lag selection procedure without prewhitening of Newey and
West (1994). Overall, accounting for serial correlation in the data has a minor impact on the standard errors of Î³Ì‚.

27

potentially misspecified models are similar for traded factors, while they can differ substantially
for factors that have low correlations with asset returns. Included in the latter category are the
macroeconomic factors lab and cg, the financial factors term, def , prem, div, rf , as well as the
factors scaled by dy. Consider, for example, the OLS results for the FF3 model in Panel A. The tratios on Î³Ì‚vw , Î³Ì‚smb and Î³Ì‚hml for correctly specified and potentially misspecified models are generally
very close, as the factors are all mimicked well by the returns on the test assets. For the vw factor,
the t-ratiof m = âˆ’2.96 and the t-ratiopm = âˆ’2.58 are not very different, while the t-ratios for smb
and hml hardly vary at all across methods. The GLS results in Panel B deliver a similar message.
When we consider models with factors that are weakly correlated with asset returns, the picture
changes substantially. For example, for the dy factor of the C-CCAPM in the OLS case (Panel A),
we have t-ratiof m = âˆ’5.30, t-ratios = âˆ’2.71, t-ratiojw = âˆ’2.82, and t-ratiopm = âˆ’1.07, which
shows that the misspecification adjustment can make a real difference. Although not showing
as big a difference, the standard error of Î³Ì‚dy in the GLS case (Panel B) still increases by more
than 40% when we incorporate potential model misspecification. Finally, the ICAPM provides
another example of the different conclusions that one can reach by using misspecification-robust
standard errors. While the t-ratios under correctly specified models in Panel A suggest that Î³Ì‚term
is statistically significant (t-ratiof m = 3.97, t-ratios = 2.50 and t-ratiojw = 2.55), the t-ratio of 1.81
under potentially misspecified models provides much weaker evidence.
To summarize, we find that for factors that are weakly correlated with the returns on the test
assets, all of the t-ratios under potentially misspecified models are smaller (in absolute value) than
the Fama and MacBeth (1973) t-ratios. In addition, most of the misspecification-robust t-ratios are
smaller (in absolute value) than the t-ratios of Shanken (1992) and Jagannathan and Wang (1998).
Finally, the latter two are close to each other and substantially smaller (in absolute value) than the
Fama-MacBeth t-ratios. Thus, both model misspecification and beta estimation error materially
affect inference about the expected return relation.
As discussed in Section III.A, there are issues with testing whether an individual factor risk
premium is zero or not in a multi-factor model. Unless the factors are uncorrelated or simple
regression betas are used, only the price of covariance risk (elements of Î»1) allows us to identify
factors that improve the explanatory power of the expected return model (the usual risk premium
for a given factor does not). To investigate whether the covariance risks of the factors are priced, in
28

Table 3 we present estimation results for Î». Similar to Table 2, we report Î»Ì‚ and associated t-ratios,
with the OLS results in Panel A and the GLS results in Panel B.31 First we have the t-ratios
of Fama-MacBeth (t-ratiof m), then t-ratios that account for estimation error in the covariances
with the model correctly specified (t-ratiocs), and finally the t-ratios under potentially misspecified
models (t-ratiopm). All are based on our results in Proposition 3.32
Table 3 about here
To illustrate our point that risk premia and prices of covariance risk can deliver different messages, consider the FF3 model. In both Panels A and B, Î»Ì‚smb is statistically significant at the 1%
level, as all t-ratios are close to or greater than three. In contrast, Î³Ì‚smb in Table 2 is not significant
at the 5% level using either OLS or GLS, with all t-ratios smaller than 1.7. Hence, by focusing
on the risk premium, one might think that smb is not an important factor in the FF3 model.
However, results for the price of covariance risk, Î»Ì‚smb , imply that smb has explanatory power for
the cross-section of expected returns above and beyond the other factors in the FF3 model.33
To summarize, accounting for model misspecification can often make a qualitative difference in
determining whether estimates of the risk premium or the price of covariance risk are statistically
significant, especially when the factor has low correlation with asset returns. This would typically
be the case with macroeconomic or scaled factors. Unless one is confident about a model, potential
model misspecification should be accounted for when computing standard errors. In addition,
focusing on the Î³Ì‚s, rather than Î»Ì‚s, can lead to erroneous conclusions as to whether or not a factor
is helpful in explaining the cross-section of expected returns.
3. Tests of Equality of the Cross-Sectional R2 s of Two Competing Models
Recall that a p-value is the probability, under the null hypothesis, of obtaining a test statistic at
least as extreme as the one observed. As such, the p-value provides no direct information about
31

The t-ratios are computed by assuming that the errors have no serial correlation. A separate set of results
(available upon request) considers the automatic lag selection procedure without prewhitening of Newey and West
(1994). Overall, accounting for serial correlation in the data has a modest impact on the standard errors of Î»Ì‚.
32
We also examined t-ratios for correctly specified models under the normality assumption. These t-ratios were
usually close to t-ratiocs , which is computed under general distributional assumptions.
33
There are also situations where the opposite happens â€” a risk premium is statistically significant in Table 2,
while the corresponding price of covariance risk is not in Table 3. As expected, for one-factor models, Î³Ì‚1 and Î»Ì‚1 result
in similar inferences. In this case, the t-ratios of the Î³Ì‚1 and Î»Ì‚1 would be identical if we imposed the null hypotheses
of Î³1 = 0 and Î»1 = 0, so that the EIV adjustment terms drop out of the analysis.

29

alternative hypotheses and the extent of deviations from the null. Therefore, p-values from the specification tests do not allow us to formally compare models. In this subsection, we explore relative
goodness of fit by empirically testing whether competing beta pricing models exhibit significantly
different sample cross-sectional R2 s.
In Section III, we showed that the asymptotic distribution of the difference between the sample
cross-sectional R2 s depends on whether the two competing models are correctly specified or not
and whether they are nested or non-nested. For nested models, we use Proposition 5 to test for
equality of cross-sectional R2 s.34 For non-nested models, we use the normal test in Proposition 9
as well as the sequential test described in Section III.C. However, for ease of comparison, we only
present results for the normal test, which produces just one more rejection than the sequential
test.35
In Table 4, we report pairwise tests of equality of cross-sectional R2s for different models, some
nested and others non-nested. Panel A is for the OLS CSR and Panel B is for the GLS CSR. Each
panel shows the differences between the sample cross-sectional R2 s for various pairs of models and
the associated p-values (in parentheses).36
Table 4 about here
The main findings can be summarized as follows. First, the results show that only the unconditional CAPM and CCAPM are often outperformed by other models at the 5% level. Specifically,
the CAPM is dominated by C-LAB and FF3 in Panel A, and by FF3 in Panel B, with R2 differences
around 50 percentage points in the OLS cases. In addition, the FF3 and ICAPM fare better relative
to the CCAPM in Panel A, while only the C-CCAPM outperforms the CCAPM in Panel B.37
Second, there is no strong evidence that conditional models outperform unconditional models.
For example, there is no statistically significant evidence that the ICAPM of Petkova (2006) out34
When computing the misspecification-robust VÌ‚ (Î»Ì‚A,2 ), we impose the null hypothesis H0 : Î»A,2 = 0K2 . However,
the p-values remain virtually unchanged when we do not impose the null hypothesis. Results obtained using the
Wald test in (52) (not reported in the paper) are consistent with the ones shown in Table 4.
35
The sequential test we implement is based on Lemma 4 and Propositions 7 and 9. We also experimented with a
sequential test based on Propositions 6, 8, and 9, and found that both tests reject the same models.
36
Note that in the case of non-nested models, the reported p-values are two-tailed p-values.
37
All the p-values in Table 4 are computed assuming no serial correlation. A separate set of results (available upon
request) considers the automatic lag selection procedure without prewhitening of Newey and West (1994). We find
that most of the p-values of the test statistics become slightly larger and differences between models even harder to
detect. Two of the four rejections of equality in Panel A of Table 4 are reversed at the 5% level.

30

performs the FF3 model in terms of OLS and GLS cross-sectional R2s. Surprisingly, we cannot
even strongly conclude that the ICAPM dominates the simple static CAPM, although the OLS pvalue of 0.064 is suggestive. In addition, out of eight comparisons involving C-LAB and C-CCAPM
and the unconditional models, CAPM and CCAPM, the C-LAB model of Jagannathan and Wang
(1996) dominates the CAPM only in the OLS case (p-value 0.020) and the C-CCAPM outperforms
the CCAPM only in the GLS case (p-value 0.025). Of course, failure to reject may, in some cases,
be due to low power; as we saw earlier, the precision of the C-CCAPM sample R2 is particularly
low.
We also explored the effect of including the three Fama-French factors, along with the 25
portfolios, as test assets in the various model comparisons. For models with one or more of these
traded factors, inclusion requires that the estimated price of risk conform to the corresponding
model restriction (i.e., equal the expected market premium over the zero-beta rate or the expected
spread return for hml and smb) either exactly (GLS) or approximately (OLS), as discussed by
Lewellen, Nagel, and Shanken (2009). For the most part, our inferences are unchanged.38 We
do find, however, that the ICAPM specification can now be rejected (GLS R2 p-value 0.011),
with the price of covariance risk for the term factor no longer significant after allowing for model
misspecification (the GLS t-ratio declines from 2.03 to 1.03).
Finally, since the population R2 depends on the choice of test assets when a model is misspecified, we consider the robustness of our conclusions to an alternative set of asset portfolios â€” 25
size-beta sorted portfolios.39 The main differences in model comparison results are observed in the
OLS case, with the C-CCAPM and ICAPM both outperforming the CAPM and the CCAPM at
the 5% level. Moreover, we find that the ICAPM now outperforms the FF3 model as well, with a
spread in OLS R2 of 0.203 and a p-value of 0.033.

38

In this context, the vector 1N in the X matrix and in Equation (7) is modified to have entries of zero corresponding
to the hml and smb test assets. Adding five industry portfolios (from Kenneth Frenchâ€™s website) as test assets likewise
has little effect on our main conclusions. The results of the analyses with portfolio restrictions and industry portfolios
are available upon request.
39
The 25 portfolios are determined by first forming size quintiles based on market capitalization rankings of all
NYSE-AMEX-NASDAQ common stocks (from CRSP), and then by forming beta quintiles within each size quintile.
This is similar to the approach of Fama and French (1992). We use quintiles, rather than deciles, to mitigate
potential finite-sample issues related to the inversion of a large sample covariance matrix. The results of this analysis
are available upon request.

31

V.

Conclusion

We have provided a systematic analysis of the asymptotic statistical properties of the traditional
cross-sectional regression methodology and the associated R2 goodness-of-fit measure when an
underlying beta pricing model fails to hold exactly. Our misspecification-robust standard errors for
the zero-beta rate and factor risk premia are derived under very general distributional assumptions,
extending the previous results of Shanken and Zhou (2007) derived under normality. A nice feature
of these standard errors is that they can be used whether the model is correctly specified or not.
When factors and returns are multivariate elliptically distributed, we show analytically that with
GLS cross-sectional regressions, the standard errors under model misspecification are always larger
than the standard errors that assume the model is correctly specified. We also show, in the GLS
case, that the misspecification adjustment depends, among other things, on the correlation between
the factor and the test asset returns. This adjustment can be very large when the underlying factor
is poorly mimicked by asset returns.
We also provide a general asymptotic theory for the sample OLS and GLS cross-sectional R2 s.
In particular, we believe our study is the first to consider (in any manner) the important sampling
distribution of the difference between the sample R2 s of two competing models. As we show, the
asymptotic distribution of this difference depends on whether the models are correctly specified
and whether they are nested or non-nested.
Our econometric results are used to analyze a variety of asset pricing models that have been
proposed in the literature, focusing mainly on the commonly employed 25 size and book-to-market
ranked portfolios as test assets. We find that the significance of risk premia for several non-traded
factors is substantially reduced once potential model misspecification is taken into account. For
example, the OLS t-ratio on the risk premium for the lagged dividend yield in a conditional version
of the consumption CAPM goes from âˆ’2.82 to âˆ’1.07, a reduction in magnitude of 60% (the
traditional Fama-MacBeth t-ratio is âˆ’5.30).
Our empirical findings suggest that the sample cross-sectional R2 measure can be too noisy
to permit a conclusion that one model outperforms another, in that very large differences in R2
are sometimes statistically insignificant. The estimated standard errors for the sample OLS R2s
range from 0.099 for the Fama and French (1993) three-factor model to 0.447 for a conditional
32

version of the consumption CAPM. These findings imply that the common approach of informally
relying solely on the sample R2 and ignoring its sampling variability in comparing models can be
dangerous. In this respect, our work reinforces the simulation-based conclusion of Lewellen, Nagel,
and Shanken (2009), while providing a more formal framework to evaluate statistical precision and
conduct inference.
Finally, the intertemporal CAPM of Petkova (2006) and the Fama and French (1993) threefactor model perform best in our model comparison tests, while the CAPM and the unconditional
consumption CAPM are frequently dominated by other models. Furthermore, the intertemporal
CAPM of Petkova (2006), the conditional CAPM of Jagannathan and Wang (1996) and a conditional version of the consumption CAPM are never outperformed at the 5% level.40
Our analysis could be extended in a number of ways. For instance, since we find that the zerobeta rate estimates of all models are unreasonably large, it would be interesting to perform model
comparison under the constraint that the zero-beta rate equals the risk-free rate. Other metrics
for comparing models besides the R2 measure could also be considered. Finally, although we have
made substantial progress in deriving asymptotic results, future research should also address the
small sample properties of the test statistics proposed in this paper.

40

This includes comparisons that employ the 25 size and book-to-market ranked portfolios and the 25 size and beta
ranked portfolios as test assets.

33

Appendix
Proof of Propositions 1 and 2: We only provide the proof of Proposition 2 here, as the proof of
Proposition 1 is very similar. The proof relies on the fact that Î³Ì‚ is a smooth function of ÂµÌ‚ and VÌ‚ .
Therefore, once we have the asymptotic distribution of ÂµÌ‚ and VÌ‚ , we can use the delta method to
obtain the asymptotic distribution of Î³Ì‚. Let
"
#
Âµ
Ï•=
,
vec(V )

Ï•Ì‚ =

"

ÂµÌ‚

#

vec(VÌ‚ )

.

(A1)

We first note that ÂµÌ‚ and VÌ‚ can be written as the GMM estimator that uses the moment conditions
E[rt(Ï•)] = 0(N +K)(N +K+1), where
rt(Ï•) =

"

#

Yt âˆ’ Âµ
vec((Yt âˆ’ Âµ)(Yt âˆ’ Âµ)0 âˆ’ V )

.

(A2)

Since this is an exactly identified system of moment conditions, it is straightforward to verify that
under the assumption that Yt is stationary and ergodic with finite fourth moment, we have:41
âˆš

A

T (Ï•Ì‚ âˆ’ Ï•) âˆ¼ N (0(N +K)(N +K+1), S0),
where
S0 =

âˆ
X

E[rt(Ï•)rt+j (Ï•)0].

(A3)

(A4)

j=âˆ’âˆ

Using the delta method, the asymptotic distribution of Î³Ì‚ under the misspecified model is given by
âˆš

 

âˆ‚Î³ 0
âˆ‚Î³
S0
.
T (Î³Ì‚ âˆ’ Î³) âˆ¼ N 0K+1 ,
âˆ‚Ï•0
âˆ‚Ï•0
A





(A5)

It is straightforward to obtain:
âˆ‚Î³
= 0(K+1)Ã—K ,
âˆ‚Âµ01

âˆ‚Î³
= A.
âˆ‚Âµ02

(A6)

For the derivative of Î³ with respect to vec(V ), we first need to show that

âˆ‚x
âˆ’1 0
= [0K , V11
] , 0(K+1)Ã—N âŠ— [âˆ’Î², IN ],
0
âˆ‚vec(V )
41

(A7)

Note that S0 is a singular matrix as VÌ‚ is symmetric, so there are redundant elements in Ï•Ì‚. We could have written
Ï•Ì‚ as [ÂµÌ‚0 , vech(VÌ‚ )0 ]0 , but the results are the same under both specifications.

34

where x = vec(X). In order to prove this identity, we write:
V11 = [IK , 0KÃ—N ]V [IK , 0KÃ—N ]0,

V21 = [0N Ã—K , IN ]V [IK , 0KÃ—N ]0

(A8)

to obtain
âˆ‚vec(V11)
âˆ‚vec(V )0
âˆ‚vec(V21)
âˆ‚vec(V )0

= [IK , 0KÃ—N ] âŠ— [IK , 0KÃ—N ],

(A9)

= [IK , 0KÃ—N ] âŠ— [0N Ã—K , IN ].

(A10)

With the following identity
âˆ’1
âˆ‚vec(V11
)
0
âˆ‚vec(V )

âˆ’1
) âˆ‚vec(V11)
âˆ‚vec(V11
âˆ‚vec(V11)0 âˆ‚vec(V )0
âˆ’1
âˆ’1
= âˆ’(V11
âŠ— V11
) ([IK , 0KÃ—N ] âŠ— [IK , 0KÃ—N ])

=

âˆ’1
âˆ’1
= [V11
, 0KÃ—N ] âŠ— [âˆ’V11
, 0KÃ—N ],

(A11)

we can use the product rule to obtain
âˆ‚vec(Î²)
âˆ‚vec(V )0

âˆ’1
)
âˆ‚vec(V21)
âˆ‚vec(V11
+
(I
âŠ—
V
)
K
21
0
0
âˆ‚vec(V )
âˆ‚vec(V )
âˆ’1
âˆ’1
= [V11 , 0KÃ—N ] âŠ— [0N Ã—K , IN ] + [V11 , 0KÃ—N ] âŠ— [âˆ’Î², 0N Ã—N ]
âˆ’1
= (V11
âŠ— IN )

âˆ’1
= [V11
, 0KÃ—N ] âŠ— [âˆ’Î², IN ].

(A12)

Finally, using the identity
âˆ‚x
= [0K , IK ]0 âŠ— IN ,
âˆ‚vec(Î²)0

(A13)


âˆ‚x
âˆ‚vec(Î²)
âˆ‚x
âˆ’1 0
=
= [0K , V11
] , 0(K+1)Ã—N âŠ— [âˆ’Î², IN ].
0
0
0
âˆ‚vec(V )
âˆ‚vec(Î²) âˆ‚vec(V )

(A14)

we obtain:

Let Km,n be a commutation matrix (see, e.g., Magnus and Neudecker (1999)) such that Km,n vec(A) =
vec(A0 ) where A is an m Ã— n matrix. In addition, denote Kn,n by Kn . Then, using the product
rule, we obtain:
âˆ’1
âˆ‚Î³
âˆ‚vec(H)
âˆ‚vec(X 0)
0 âˆ’1
0 âˆ’1
0
0 âˆ‚vec(V22 )
=
(Âµ
V
X
âŠ—
I
)
+
(Âµ
V
âŠ—
H)
+
(Âµ
âŠ—
HX
)
. (A15)
K+1
2 22
2 22
2
âˆ‚vec(V )0
âˆ‚vec(V )0
âˆ‚vec(V )0
âˆ‚vec(V )0

The last two terms are given by
âˆ‚vec(X 0)
âˆ‚vec(V )0
âˆ’1
)
âˆ‚vec(V22
(Âµ02 âŠ— HX 0)
0
âˆ‚vec(V )
âˆ’1
(Âµ02 V22
âŠ— H)



âˆ’1 0
âˆ’1
âˆ’1
= [H 0K , V11
, 0(K+1)Ã—N ] âŠ— [âˆ’Âµ02 V22
Î², Âµ02 V22
],

(A16)

âˆ’1
= âˆ’[00K , Âµ02 V22
] âŠ— [0(K+1)Ã—K , A].

(A17)

35

For the first term, we use the chain rule to obtain
âˆ‚vec(H)
âˆ‚vec(V )0
âˆ‚vec(H) âˆ‚vec(H âˆ’1 )
âˆ’1
= (Âµ02 V22
X âŠ— IK+1 )
âˆ‚vec(H âˆ’1)0 âˆ‚vec(V )0

âˆ‚x
âˆ’1
âˆ’1
= âˆ’(Âµ02 V22
X âŠ— IK+1 )(H âŠ— H) (X 0V22
âŠ— IK+1 )KN,K+1
âˆ‚vec(V )0

âˆ’1
âˆ‚x
0
0 âˆ‚vec(V22 )
0 âˆ’1
+ (X âŠ— X )
+ (IK+1 âŠ— X V22 )
âˆ‚vec(V )0
âˆ‚vec(V )0



âˆ’1
âˆ’1
âˆ’1 0
= âˆ’(Î³ 0 âŠ— H) [âˆ’X 0V22
Î², X 0V22
] âŠ— [0K , V11
] , 0(K+1)Ã—N KN +K
âˆ’1
X âŠ— IK+1 )
(Âµ02 V22

âˆ’1
âˆ’1
âˆ’ [0(K+1)Ã—K , X 0V22
] âŠ— [0(K+1)Ã—K , X 0V22
]


âˆ’1 0
âˆ’1
âˆ’1
+ [0K , V11
] , 0(K+1)Ã—N âŠ— [âˆ’X 0V22
Î², X 0V22
]


âˆ’1 0
âˆ’1
âˆ’1
= H[0K , V11
] , 0(K+1)Ã—N âŠ— [Î³ 0X 0V22
Î², âˆ’Î³ 0X 0V22
]
âˆ’1
âˆ’1
+ [00K , Î³ 0X 0V22
] âŠ— [0(K+1)Ã—K , A] âˆ’ [Î³10 V11
, 00N ] âŠ— [âˆ’AÎ², A].

(A18)

âˆ’1
Combining the three terms and using the first order condition Î² 0 V22
e = 0K , we have:

âˆ‚Î³
âˆ‚vec(V )0

=

 

âˆ’1 0
âˆ’1
H[0K , V11
] , 0(K+1)Ã—N âŠ— 00K , e0 V22



 

âˆ’1
âˆ’1
âˆ’ Î³10 V11
âŠ— 0(K+1)Ã—K , A .
, 00N âŠ— [âˆ’AÎ², A] âˆ’ 00K , e0 V22



(A19)

Using the expression for âˆ‚Î³/âˆ‚Ï•0, we can simplify the asymptotic variance of Î³Ì‚ to
âˆ
X

V (Î³Ì‚) =

E[ht(Ï•)ht+j (Ï•)0],

(A20)

j=âˆ’âˆ

where
ht (Ï•) =

âˆ‚Î³
rt(Ï•)
âˆ‚Ï•0

= A(Rt âˆ’ Âµ2 ) + vec

[00K ,

e

0

âˆ’1
V22
][(Yt

0

âˆ’ Âµ)(Yt âˆ’ Âµ) âˆ’ V ]

âˆ’ vec [âˆ’AÎ², A][(Yt âˆ’ Âµ)(Yt âˆ’ Âµ)0 âˆ’ V ]

"

âˆ’1
Î³1
V11

0N
"

âˆ’ vec [0(K+1)Ã—K , A][(Yt âˆ’ Âµ)(Yt âˆ’ Âµ)0 âˆ’ V ]

"

âˆ’1
]H
[0K , V11

0N Ã—(K+1)

#!

0K

#!

#!

âˆ’1
V22
e

âˆ’1 0
âˆ’1
= (Î³t âˆ’ Î³) + H[0K , V11
] (ft âˆ’ Âµ1 )ut âˆ’ A[(Rt âˆ’ Âµ2 ) âˆ’ Î²(ft âˆ’ Âµ1 )](ft âˆ’ Âµ1 )0V11
Î³1
âˆ’1 0
âˆ’1
âˆ’ A(Rt âˆ’ Âµ2 )ut âˆ’ H[0K , V11
] V12V22
e âˆ’ AÎ²Î³1 + AÎ²Î³1 + Ae

= (Î³t âˆ’ Î³) + Hztut âˆ’ (Ï†t âˆ’ Ï†)wt âˆ’ (Î³t âˆ’ Î³)ut.
36

(A21)

âˆ’1
âˆ’1
The last equality follows from the first order condition X 0V22
e = 0K+1 (which implies Î² 0 V22
e = 0K

and Ae = 0K+1 ) and the fact that AÎ² = AX[0K , IK ]0 = [0K , IK ]0 gives us
#
"
0
A(Rt âˆ’ Âµ2 ) âˆ’ AÎ²(ft âˆ’ Âµ1 ) = Î³t âˆ’ Î³ âˆ’
= Ï†t âˆ’ Ï†.
f t âˆ’ Âµ1

(A22)

Note that when the model is correctly specified, we have e = 0N , ut = 0, and ht (Ï•) can be
simplified to
ht (Ï•) = (Î³t âˆ’ Î³) âˆ’ (Ï†t âˆ’ Ï†)wt.

(A23)

This completes the proof.
Proof of Lemma 1: In our proof, we rely on the mixed moments of multivariate elliptical distributions. Lemma 2 of Maruyama and Seo (2003) shows that if (Xi, Xj , Xk , Xl) are jointly multivariate
elliptically distributed and with mean zero, we have:
E[XiXj Xk ] = 0,

(A24)

E[XiXj Xk Xl ] = (1 + Îº)(Ïƒij Ïƒkl + Ïƒik Ïƒjl + Ïƒil Ïƒjk ),

(A25)

where Ïƒij = Cov[Xi, Xj ]. We first note that since Î³t , Ï†t , zt , wt, and ut are all linear functions of Rt
and ft , they are also jointly elliptically distributed. In addition, using (A22), we have Ï†t âˆ’ Ï† = At ,
where t = Rt âˆ’ Âµ2 âˆ’ Î²(ft âˆ’ Âµ1 ), which is uncorrelated with ft . Using this result, we can easily
show that
Var[Î³t] = AV22A0,

(A26)

Var[Ï†t ] = AÎ£A0,

(A27)

âˆ’1
Var[zt ] = VÌƒ11
,

(A28)

âˆ’1
Var[wt] = Î³10 V11
Î³1 ,

(A29)

Var[ut ] = e0W V22 W e,

(A30)

Cov[Ï†t, zt0 ] = 0(K+1)Ã—(K+1),

(A31)

Cov[Ï†t, wt] = 0K+1 ,

(A32)

Cov[Ï†t , ut] = AÎ£W e = AV22W e,

(A33)

âˆ’1
Cov[wt, zt0 ] = [0, Î³10 V11
],

(A34)

Cov[zt , ut] = 0K+1 ,

(A35)

Cov[wt, ut] = 0.

(A36)

37

Using these second moments, we can then apply (A24) and (A25) to obtain
E[(Î³t âˆ’ Î³)(Ï†t âˆ’ Ï†)0wt] = 0(K+1)Ã—(K+1) ,

(A37)

E[(Î³t âˆ’ Î³)zt0 ut] = 0(K+1)Ã—(K+1) ,

(A38)

âˆ’1
E[ztzt0 u2t ] = (1 + Îº)e0 W V22W eVÌƒ11
,
âˆ’1
E[(Ï†t âˆ’ Ï†)zt0 wt ut] = (1 + Îº)AV22W e[0, Î³10 V11
],
âˆ’1
E[(Ï†t âˆ’ Ï†)(Ï†t âˆ’ Ï†)0wt2] = (1 + Îº)Î³10 V11
Î³1 AÎ£A0.

(A39)
(A40)
(A41)

Using these results and the i.i.d. assumption, we can now write:
V (Î³Ì‚) = E[hth0t ]
= Var[Î³t] âˆ’ E[(Î³t âˆ’ Î³)(Ï†t âˆ’ Ï†)0wt ] + E[(Î³t âˆ’ Î³)zt0 ut ]H
+ E[(Ï†t âˆ’ Ï†)(Ï†t âˆ’ Ï†)0wt2 ] âˆ’ E[(Ï†t âˆ’ Ï†)(Î³t âˆ’ Î³)0wt] âˆ’ E[(Ï†t âˆ’ Ï†)zt0 wtut ]H
+ HE[ztzt0 u2t ]H + HE[zt(Î³t âˆ’ Î³)0ut ] âˆ’ HE[zt(Ï†t âˆ’ Ï†)0 ut wt]
âˆ’1
âˆ’1
= AV22A0 + (1 + Îº)(Î³10 V11
Î³1 )AÎ£A0 + (1 + Îº)e0 W V22W eH VÌƒ11
H
âˆ’1
âˆ’1 0 0
âˆ’ (1 + Îº)AV22W e[0, Î³10 V11
]H âˆ’ (1 + Îº)H[0, Î³10 V11
] e W V22A0 .

(A42)

This completes the proof.
Proof of Lemma 2: Under the i.i.d. assumption, the expression for V (Î³Ì‚) is given by
E[hth0t ] = Var[Î³t] âˆ’ E[(Î³t âˆ’ Î³)(Ï†t âˆ’ Ï†)0 wt] + E[(Î³t âˆ’ Î³)zt0 ut ]H âˆ’ E[(Î³t âˆ’ Î³)(Î³t âˆ’ Î³)0ut ]
+ E[(Ï†t âˆ’ Ï†)(Ï†t âˆ’ Ï†)0 wt2] âˆ’ E[(Ï†t âˆ’ Ï†)(Î³t âˆ’ Î³)0wt] âˆ’ E[(Ï†t âˆ’ Ï†)zt0 wt ut]H
+ E[(Ï†t âˆ’ Ï†)(Î³t âˆ’ Î³)0wtut ] + HE[ztzt0 u2t ]H + HE[zt(Î³t âˆ’ Î³)0ut ]
âˆ’ HE[zt(Ï†t âˆ’ Ï†)0ut wt] âˆ’ HE[zt(Î³t âˆ’ Î³)0u2t ] + E[(Î³t âˆ’ Î³)(Î³t âˆ’ Î³)0u2t ]
âˆ’ E[(Î³t âˆ’ Î³)(Î³t âˆ’ Î³)0ut] + E[(Î³t âˆ’ Î³)(Ï†t âˆ’ Ï†)0wt ut] âˆ’ E[(Î³t âˆ’ Î³)zt0 u2t ]H.

(A43)

Following the proof of Lemma 1, we have:
Var[Î³t] = H,

(A44)

E[(Î³t âˆ’ Î³)(Ï†t âˆ’ Ï†)0 wt] = 0(K+1)Ã—(K+1) ,

(A45)

E[(Î³t âˆ’ Î³)zt0ut ] = 0(K+1)Ã—(K+1) ,

(A46)

âˆ’1
E[ztzt0 u2t ] = (1 + Îº)QVÌƒ11
,

(A47)

38

E[(Ï†t âˆ’ Ï†)zt0 wtut ] = 0(K+1)Ã—(K+1) ,

(A48)

âˆ’1
E[(Ï†t âˆ’ Ï†)(Ï†t âˆ’ Ï†)0 wt2] = (1 + Îº)Î³10 V11
Î³1(X 0Î£âˆ’1 X)âˆ’1,

(A49)

E[(Î³t âˆ’ Î³)(Î³t âˆ’ Î³)0ut ] = 0(K+1)Ã—(K+1) ,

(A50)

E[(Ï†t âˆ’ Ï†)(Î³t âˆ’ Î³)0wtut ] = 0(K+1)Ã—(K+1) ,

(A51)

E[(Î³t âˆ’ Î³)(Î³t âˆ’ Î³)0u2t ] = (1 + Îº)QH,
"
E[zt(Î³t âˆ’ Î³)0u2t ] = (1 + Îº)Q

By partitioning H as
H=

"

H11 H12
H21 H22

#

0

00K

0K

IK

#

(A52)
.

,

(A53)

(A54)

where H11 is the (1, 1) element of H, and using (A44)â€“(A53), we can write:
âˆ’1
âˆ’1
E[hth0t ] = H + (1 + Îº)Î³10 V11
Î³1(X 0Î£âˆ’1 X)âˆ’1 + (1 + Îº)QH VÌƒ11
H
"
#
"
#
0 00K
0 00K
âˆ’ (1 + Îº)QH
+ (1 + Îº)QH âˆ’ (1 + Îº)Q
H
0K IK
0K IK
#!
"
0
0
H
11
K
âˆ’1
= Î¥w + (1 + Îº)Q H VÌƒ11
H+
0K âˆ’H22
#
"
âˆ’1
âˆ’1
H21 + H11
H12V11
H22
H12 V11
.
(A55)
= Î¥w + (1 + Îº)Q
âˆ’1
âˆ’1
H22V11
H21
H22V11
H22 âˆ’ H22
#
"
0
0
0
K
By applying the identity (X 0Î£âˆ’1 X)âˆ’1 = H âˆ’ VÌƒ11, where VÌƒ11 =
, we can verify that
0K V11
the expression of Î¥w2 in Lemma 2 is the same as the second term in (A55) as follows:42
âˆ’1
âˆ’1
(X 0Î£âˆ’1 X)âˆ’1VÌƒ11
(X 0Î£âˆ’1 X)âˆ’1 + (X 0Î£âˆ’1 X)âˆ’1 = (H âˆ’ VÌƒ11)VÌƒ11
(H âˆ’ VÌƒ11) + H âˆ’ VÌƒ11
#
"
0
0
H
11
K
âˆ’1
.
(A56)
= H VÌƒ11
H+
0K âˆ’H22

In particular, the misspecification adjustment term for V (Î³Ì‚1) is
âˆ’1
(1 + Îº)Q(H22V11
H22 âˆ’ H22)
âˆ’1
âˆ’1
âˆ’1
= (1 + Îº)QH22V11
(V11 âˆ’ V11H22
V11)V11
H22
âˆ’1
âˆ’1
âˆ’1
âˆ’1
âˆ’1
âˆ’1
= (1 + Îº)QH22V11
[V11 âˆ’ V12V22
V21 + V12V22
1N (10N V22
1N )âˆ’1 10N V22
V21]V11
H22, (A57)
42
By comparing V (Î³Ì‚) for the estimated GLS case with the V (Î³Ì‚) for the true GLS case in (29), it is easy to see that
âˆ’1
âˆ’1
instead of V22
as weighting matrix increases the asymptotic variance of Î³Ì‚0 but reduces the asymptotic
the use of VÌ‚22
variance of Î³Ì‚1 .

39

âˆ’1
where the last equality is obtained by writing H22
as
âˆ’1
âˆ’1
âˆ’1
âˆ’1
âˆ’1
H22
= Î² 0 V22
Î² âˆ’ Î² 0V22
1N (10N V22
1N )âˆ’110N V22
Î².

(A58)

This completes the proof.
Proof of Proposition 4: (1) Ï2 = 1: We first derive the asymptotic distribution of
T QÌ‚ = T (ÂµÌ‚02 WÌ‚ ÂµÌ‚2 âˆ’ ÂµÌ‚02 WÌ‚ XÌ‚(XÌ‚ 0WÌ‚ XÌ‚)âˆ’1 XÌ‚ 0WÌ‚ ÂµÌ‚2 )

(A59)

a.s.

under H0 : Ï2 = 1, where WÌ‚ âˆ’â†’ W (this includes the known weighting matrix case as a special
case). This can be accomplished by using the GMM results of Hansen (1982). Let Î¸ = (Î¸10 , Î¸20 )0 ,
where Î¸1 = (Î±0 , vec(Î²)0)0 and Î¸2 = Î³. Define
"
# "
#
g1t(Î¸1 )
l t âŠ— t
gt (Î¸) â‰¡
=
,
g2t(Î¸)
Rt âˆ’ XÎ³

(A60)

where lt = [1, ft0 ]0 and t = Rt âˆ’ Î± âˆ’ Î²ft . When the model is correctly specified, we have
E[gt(Î¸)] = 0p+N , where p = N (K + 1). The sample moments of gt (Î¸) are given by
" PT
#
1
t=1 g1t (Î¸1 )
T
gÌ„T (Î¸) =
.
PT
1
g
(Î¸)
2t
t=1
T

(A61)

Let Î¸Ì‚ = (Î¸Ì‚10 , Î¸Ì‚20 )0 , where Î¸Ì‚1 = (Î±Ì‚0, vec(Î²Ì‚)0)0 is the OLS estimator of Î± and Î², and
Î¸Ì‚2 = Î³Ì‚ = (XÌ‚ 0WÌ‚ XÌ‚)âˆ’1 XÌ‚ 0WÌ‚ ÂµÌ‚2

(A62)

is the second-pass CSR estimator of Î³. Note that Î¸Ì‚ is the solution to the following first order
condition
BT gÌ„T (Î¸) = 0p+K+1 ,
where
BT =

"

Ip

0pÃ—N

0(K+1)Ã—p XÌ‚ 0WÌ‚

#

a.s.

âˆ’â†’

"

Ip

(A63)

0pÃ—N

0(K+1)Ã—p X 0W

#

â‰¡ B.

(A64)

Writing
lt âŠ— t = vec(t lt0 ) = (lt âŠ— IN )vec(t ),
t = Rt âˆ’ Î± âˆ’ Î²ft = Rt âˆ’ (lt0 âŠ— IN )Î¸1 ,
Î²Î³1 = (Î³10 âŠ— IN )vec(Î²),
40

(A65)
(A66)
(A67)

we have:
âˆ‚g1t(Î¸1 )
âˆ‚Î¸10
âˆ‚g1t(Î¸1 )
âˆ‚Î¸20
âˆ‚g2t(Î¸)
âˆ‚Î¸10
âˆ‚g2t(Î¸)
âˆ‚Î¸20

= âˆ’ltlt0 âŠ— IN ,

(A68)

= 0pÃ—(K+1),

(A69)

= [0, âˆ’Î³10 ] âŠ— IN ,

(A70)

= âˆ’X.

(A71)

Let
DT

=
=
a.s.

âˆ’â†’

âˆ‚gÌ„T (Î¸)
0
" âˆ‚Î¸

1
T

âˆ’

"



PT

[0,

0
t=1 lt lt âŠ— IN
âˆ’Î³10 ] âŠ— IN

âˆ’E[ltlt0 ] âŠ— IN
[0,

âˆ’Î³10 ]

0pÃ—(K+1)

0pÃ—(K+1)

âŠ— IN

#

âˆ’X
#

â‰¡ D.

âˆ’X

(A72)

Hansen (1982, Lemma 4.1) shows that when the model is correctly specified, we have:
âˆš

A

T gÌ„T (Î¸Ì‚) âˆ¼ N (0p+N , [Ip+N âˆ’ D(BD)âˆ’1 B]S[Ip+N âˆ’ D(BD)âˆ’1 B]0 ),

where
S=

âˆ
X

(A73)

E[gt(Î¸)gt+j (Î¸)0 ].

(A74)

j=âˆ’âˆ

Using the partitioned matrix inverse formula, it is easy to verify that
#
"
âˆ’1
âˆ’1
Âµ1 âˆ’Âµ01 V11
1 + Âµ01 V11
0 âˆ’1
E[ltlt] =
.
âˆ’1
âˆ’1
âˆ’V11
Âµ1
V11

(A75)

It follows that
BD =
(BD)âˆ’1 =
D(BD)âˆ’1 B =
IN âˆ’ D(BD)âˆ’1 B =

"
"
"
"

âˆ’E[ltlt0 ] âŠ— IN

0pÃ—(K+1)

[0, âˆ’Î³10 ] âŠ— X 0W

âˆ’H âˆ’1

#

,

âˆ’E[ltlt0 ]âˆ’1 âŠ— IN

0pÃ—(K+1)

âˆ’1
âˆ’1
[âˆ’Î³10 V11
Âµ1 , Î³10 V11
]âŠ—A

âˆ’H

Ip

(A76)
#

,

0pÃ—N

(A77)
#

âˆ’1
âˆ’1
[âˆ’Î³10 V11
Âµ1 , Î³10 V11
] âŠ— (IN âˆ’ XA) âˆ’XA

0pÃ—p

,

0pÃ—N

âˆ’1
âˆ’1
[Î³10 V11
Âµ1 , âˆ’Î³10 V11
] âŠ— (IN âˆ’ XA) IN âˆ’ XA

41

(A78)
#

.

(A79)

We now provide a simplification of the asymptotic distribution of gÌ„2T (Î¸Ì‚). From (A73), we have:
âˆš

A

T gÌ„2T (Î¸Ì‚) âˆ¼ N (0N , Vq ),
where
Vq =

âˆ
X

(A80)

E[qt(Î¸)qt+j (Î¸)0 ],

(A81)

j=âˆ’âˆ

and
qt (Î¸) = [0N Ã—p, IN ](IN âˆ’ D(BD)âˆ’1 B)gt (Î¸)
âˆ’1
= âˆ’(IN âˆ’ XA)t Î³10 V11
(ft âˆ’ Âµ1 ) + (IN âˆ’ XA)(Rt âˆ’ XÎ³)
âˆ’1
= (IN âˆ’ XA)[Rt âˆ’ Rt Î³10 V11
(ft âˆ’ Âµ1 )]

= [IN âˆ’ X(X 0W X)âˆ’1X 0W ]Rtyt
1

1

1

1

1

1

= W âˆ’ 2 [IN âˆ’ W 2 X(X 0W X)âˆ’1X 0W 2 ]W 2 Rtyt
1

1

= W âˆ’ 2 [IN âˆ’ W 2 C(C 0 W C)âˆ’1 C 0 W 2 ]W 2 Rtyt
1

1

= W âˆ’ 2 P P 0 W 2 R t yt ,

(A82)

âˆ’1
where yt = 1âˆ’Î³10 V11
(ft âˆ’Âµ1 ) = 1âˆ’Î»01(ft âˆ’Âµ1 ) follows from (10). The second equality holds because

Î± = Âµ2 âˆ’ Î²Âµ1 = 1N Î³0 + Î²(Î³1 âˆ’ Âµ1 ) = XÏ† when the model is correctly specified and Î² = X[0K , IK ].
Therefore, Î± + Î²ft vanishes when premultiplied by IN âˆ’ XA and we have
(IN âˆ’ XA)t = (IN âˆ’ XA)(Rt âˆ’ Î± âˆ’ Î²ft ) = (IN âˆ’ XA)Rt.

(A83)

With this expression of qt , we can write Vq as
1

1

1

1

Vq = W âˆ’ 2 P P 0 W 2 SW 2 P P 0 W âˆ’ 2 ,
where S is the asymptotic covariance matrix of

âˆš1
T

PT

t=1 Rt yt .

(A84)
Having derived the asymptotic

distribution of gÌ„2T (Î¸Ì‚), the asymptotic distribution of QÌ‚ is given by
A

T QÌ‚ = T gÌ„2T (Î¸Ì‚)0WÌ‚ gÌ„2T (Î¸) âˆ¼

N âˆ’Kâˆ’1
X

Î¾j x j ,

(A85)

j=1

where the xj â€™s are independent Ï‡21 random variables, and the Î¾j â€™s are the N âˆ’ K âˆ’ 1 nonzero
eigenvalues of
1

1

1

1

W 2 Vq W 2 = P P 0 W 2 SW 2 P P 0 .
42

(A86)

1

1

a.s.

Equivalently, the Î¾j â€™s are the eigenvalues of P 0 W 2 SW 2 P . Since QÌ‚0 âˆ’â†’ Q0 > 0, we have:
T (ÏÌ‚2 âˆ’ 1) = âˆ’

N âˆ’Kâˆ’1
X Î¾j
T QÌ‚ A
âˆ¼âˆ’
xj .
Q0
QÌ‚0
j=1

(A87)

(2) 0 < Ï2 < 1: The proof uses the same notation and delta method employed in Propositions 1
and 2 to obtain the asymptotic distribution of ÏÌ‚2 as
ï£«
ï£¶
âˆ
X
âˆš
A
T (ÏÌ‚2 âˆ’ Ï2) âˆ¼ N ï£­0,
E[ntnt+j ]ï£¸ ,

(A88)

j=âˆ’âˆ

where
nt =

âˆ‚Ï2
rt(Ï•).
âˆ‚Ï•0

(A89)

Obtaining an explicit expression for nt requires computing âˆ‚Ï2/âˆ‚Ï•0. For both the known weighting matrix case and the estimated GLS case, we have:
âˆ‚Ï2
âˆ‚Âµ1
âˆ‚Ï2
âˆ‚Âµ2

= 0K ,

(A90)

2
= 2Qâˆ’1
0 W [(1 âˆ’ Ï )e0 âˆ’ e].

(A91)

Equation (A90) follows because Ï2 does not depend on Âµ1 . For (A91), using the first order conditions
10N W e0 = 0 and X 0W e = 0K+1 and letting Q0 = e00 W e0 , we have:
âˆ‚Q0
= 2W e0,
âˆ‚Âµ2

âˆ‚Q
= 2W e.
âˆ‚Âµ2

(A92)

It follows that
âˆ‚Ï2
âˆ‚Q
âˆ‚Q0
âˆ’2
âˆ’1
2
= âˆ’Qâˆ’1
+ Qâˆ’2
= âˆ’2Qâˆ’1
0
0 Q
0 W e + 2QQ0 W e0 = 2Q0 W [(1 âˆ’ Ï )e0 âˆ’ e].
âˆ‚Âµ2
âˆ‚Âµ2
âˆ‚Âµ2

(A93)

The expression for âˆ‚Ï2/âˆ‚vec(V )0 , however, depends on whether we use a known W or an estimate
of W , say WÌ‚ , as the weighting matrix. We start with the known weighting matrix W case.
Differentiating Q = e0 W e with respect to vec(V ), we obtain:


âˆ‚Q
âˆ‚(Âµ2 âˆ’ XÎ³)
âˆ‚x
âˆ‚Î³
0
0
0
.
= 2e W
= âˆ’2e W (Î³ âŠ— IN )
+X
âˆ‚vec(V )0
âˆ‚vec(V )0
âˆ‚vec(V )0
âˆ‚vec(V )0

(A94)

Note that the second term vanishes because of the first order condition X 0W e = 0K+1 . Using (A7)
for the first term and the fact that Î² 0 W e = 0K gives


âˆ‚Q
âˆ’1
âˆ’1
= âˆ’2e0 W [Î³10 V11
, 00N ] âŠ— [âˆ’Î², IN ] = âˆ’2 [Î³10 V11
, 00N ] âŠ— [00K , e0 W ] .
0
âˆ‚vec(V )
43

(A95)

Since Q0 = e00 W e0 does not depend on V , we have:
 0 âˆ’1 0   0

âˆ‚Ï2
âˆ‚Q
Î³1V11 , 0N âŠ— 0K , e0W .
= âˆ’Qâˆ’1
= 2Qâˆ’1
0
0
0
0
âˆ‚vec(V )
âˆ‚vec(V )

(A96)

Therefore, for the known weighting matrix W case, nt is given by
âˆ‚Ï2
rt(Ï•)
âˆ‚Ï•0
âˆ’1 0
2 0
0
0 âˆ’1
= 2Qâˆ’1
0 [(1 âˆ’ Ï )e0 âˆ’ e ]W (Rt âˆ’ Âµ2 ) + 2Q0 e W (Rt âˆ’ Âµ2 )(ft âˆ’ Âµ1 ) V11 Î³1

nt =

2
= 2Qâˆ’1
0 [âˆ’ut yt + (1 âˆ’ Ï )vt ].

(A97)

âˆ’1
âˆ’1
We now turn to the WÌ‚ = VÌ‚22
case. Differentiating Q = e0V22
e with respect to vec(V ), we

obtain:
âˆ‚Q
âˆ‚vec(V )0

âˆ’1
âˆ‚(Âµ2 âˆ’ XÎ³)
0
0 âˆ‚vec(V22 )
+
(e
âŠ—
e
)
âˆ‚vec(V )0
âˆ‚vec(V )0


0 âˆ’1
0
0
0 âˆ’1
âˆ’1
âˆ’1
= âˆ’2 [Î³1V11 , 0N ] âŠ— [0K , e V22 ] âˆ’ (e0 âŠ— e0) [0N Ã—K , V22
] âŠ— [0N Ã—K , V22
]
âˆ’1
= 2e0 V22

âˆ’1
âˆ’1
âˆ’1
= âˆ’[2Î³10 V11
, e0V22
] âŠ— [00K , e0 V22
].

(A98)

Similarly, we have:
âˆ‚Q0
âˆ’1
âˆ’1
= âˆ’[00K , e00 V22
] âŠ— [00K , e00 V22
].
âˆ‚vec(V )0

(A99)

It follows that
âˆ‚Ï2
âˆ‚vec(V )0

âˆ‚Q
âˆ‚Q0
= âˆ’Qâˆ’1
+ Qâˆ’2
0
0 Q
âˆ‚vec(V )0
âˆ‚vec(V )0
 0 âˆ’1 0 âˆ’1   0

âˆ’1
2Î³1V11 , e V22 âŠ— 0K , e0 V22
= Qâˆ’1
0
  0

 0
2
0 âˆ’1
âˆ’1
âˆ’ Qâˆ’1
âŠ— 0K , e00 V22
.
0 (1 âˆ’ Ï ) 0K , e0 V22

(A100)

Therefore, we have:
âˆ‚Ï2
rt(Ï•)
âˆ‚Ï•0
2 0
0
âˆ’1
âˆ’1 0 âˆ’1
0 âˆ’1
= 2Qâˆ’1
0 [(1 âˆ’ Ï )e0 âˆ’ e ]V22 (Rt âˆ’ Âµ2 ) + Q0 e V22 (Rt âˆ’ Âµ2 )[2Î³1 V11 (ft âˆ’ Âµ1 )

nt =

âˆ’1
âˆ’1
âˆ’1
2
0 âˆ’1
2
2
+ e0 V22
(Rt âˆ’ Âµ2 )] âˆ’ Qâˆ’1
0 (1 âˆ’ Ï )[e0 V22 (Rt âˆ’ Âµ2 )] âˆ’ Q0 Q + Q0 (1 âˆ’ Ï )Q0
2
2
2
= Qâˆ’1
0 [ut âˆ’ 2ut yt + (1 âˆ’ Ï )(2vt âˆ’ vt )].

44

(A101)

(3) Ï2 = 0: We start by rewriting Q0 âˆ’ Q as
Q0 âˆ’ Q = Âµ02 W X(X 0W X)âˆ’1 X 0W Âµ2 âˆ’ Âµ02 W 1N (10N W 1N )âˆ’1 10N W Âµ2
"
#
0
âˆ’1
0
(1
W
1
)
0
N
N
K
= Âµ02 W X(X 0W X)âˆ’1 X 0W Âµ2 âˆ’ Âµ02 W X
X 0 W Âµ2
0K
0KÃ—K
#
"
(10N W 1N )âˆ’1
00K
0
0
0
0
(X 0W X)Î³
= Î³ (X W X)Î³ âˆ’ Î³ (X W X)
0K
0KÃ—K
"
#
10N W 1N
10N W Î²
0
0
0
= Î³ (X W X)Î³ âˆ’ Î³
Î³
Î² 0 W 1N Î² 0 W 1N (10N W 1N )âˆ’1 10N W Î²
= Î³10 [Î² 0W Î² âˆ’ Î² 0 W 1N (10N W 1N )âˆ’1 10N W Î²]Î³1.

(A102)

The matrix in the middle is positive definite because X is assumed to be of full column rank, so
the necessary and sufficient condition for Q0 = Q (i.e., Ï2 = 0) is Î³1 = 0K . Note that (A102) also
holds for its sample counterpart, so we can write ÏÌ‚2 as
ÏÌ‚2 = 1 âˆ’

Î³Ì‚ 0 [Î²Ì‚ 0 WÌ‚ Î²Ì‚ âˆ’ Î²Ì‚ 0 WÌ‚ 1N (10N WÌ‚ 1N )âˆ’1 10N WÌ‚ Î²Ì‚]Î³Ì‚1
QÌ‚
QÌ‚0 âˆ’ QÌ‚
=
= 1
.
QÌ‚0
QÌ‚0
QÌ‚0

(A103)

Under the null hypothesis H0 : Î³1 = 0K , we have:
âˆš
A
T Î³Ì‚1 âˆ¼ N (0K , V (Î³Ì‚1)),

(A104)
a.s.

where V (Î³Ì‚1) is the asymptotic variance of Î³Ì‚1 obtained under the misspecified model. As QÌ‚0 âˆ’â†’
Q0 > 0 and
a.s.

Î²Ì‚ 0WÌ‚ Î²Ì‚ âˆ’ Î²Ì‚ 0 WÌ‚ 1N (10N WÌ‚ 1N )âˆ’1 10N WÌ‚ Î²Ì‚ âˆ’â†’ Î² 0 W Î² âˆ’ Î² 0 W 1N (10N W 1N )âˆ’1 10N W Î²,
it follows that

K
X
Î¾j
T ÏÌ‚ âˆ¼
xj ,
Q0
2 A

(A105)

(A106)

j=1

where the xj â€™s are independent Ï‡21 random variables and the Î¾j â€™s are the eigenvalues of
[Î² 0W Î² âˆ’ Î² 0 W 1N (10N W 1N )âˆ’1 10N W Î²]V (Î³Ì‚1).

(A107)

This completes the proof.
Proof of Lemma 3: Partition CA = [CAa , CAb ], where CAa is the first K1 + 1 columns of CA and
CAb is the last K2 columns of CA . Using the fact that CAa = CB , we can write the difference
45

between QB and QA as
0
0
0
0
W CA )âˆ’1 CA
W Âµ2 âˆ’ Âµ02 W CB (CB
W CB )âˆ’1 CB
W Âµ2
QB âˆ’ QA = Âµ02 W CA (CA
"
#
âˆ’1
0
(CAa W CAa )
0(K1 +1)Ã—K2
0
0
âˆ’1 0
0
0
CA
= Âµ2 W CA (CA W CA ) CA W Âµ2 âˆ’ Âµ2 W CA
W Âµ2
0K2 Ã—(K1 +1)
0K2Ã—K2
#
"
0
W CAa )âˆ’1 0(K1+1)Ã—K2
(CAa
0
0
0
0
0
(CA
= Î»A (CA W CA )Î»A âˆ’ Î»A (CA W CA )
W CA )Î»A
0K2 Ã—(K1 +1)
0K2 Ã—K2
0
0
0
0
= Î»0A,2 [CAb
W CAb âˆ’ CAb
W CAa (CAa
W CAa )âˆ’1 (CAa
W CAb )]Î»A,2
âˆ’1
= Î»0A,2 HÌƒA,22
Î»A,2 ,

(A108)

where HÌƒA,22 is the lower right K2 Ã— K2 submatrix of HÌƒA . Since CA is assumed to be of full column
âˆ’1
rank, HÌƒA,22
is a positive definite matrix. It follows that QA = QB if and only if Î»A,2 = 0K2 . This

completes the proof.
Proof that yA = yB implies eA = eB : Using the first order conditions for model A, we obtain:
0 = 10N W eA = 10N W Âµ2 âˆ’ 10N W 1N Î»A,0 âˆ’ 10N W Cov[R, f10 ]Î»A,1 âˆ’ 10N W Cov[R, f20 ]Î»A,2.

(A109)

This implies that the (pseudo) zero-beta rate of model A is
Î»A,0 = (10N W 1N )âˆ’1 10N W (Âµ2 âˆ’ Cov[R, f10 ]Î»A,1 âˆ’ Cov[R, f20 ]Î»A,2) = (10N W 1N )âˆ’110N W E[RyA],
(A110)
and the pricing errors of model A can be written as
eA = [IN âˆ’ 1N (10N W 1N )âˆ’1 10N W ]E[RyA].

(A111)

Similarly, the pricing errors of model B can be written as
eB = [IN âˆ’ 1N (10N W 1N )âˆ’1 10N W ]E[RyB ].

(A112)

Therefore, when yA = yB , we have eA = eB . This completes the proof.
Proof of Lemma 4: Given that yA = yB if and only if Î»A,1 = Î»B,1, Î»A,2 = 0K2 , and Î»B,3 = 0K3 , it
suffices to show that Î»A,2 = 0K2 and Î»B,3 = 0K3 imply Î»A,1 = Î»B,1. For model A, premultiplying
0 W C , we obtain:
both sides of (51) by CA
A

"

0 WC
CAa
Aa
0
CAb W CAa

0 WC
CAa
Ab
0
CAb W CAb

#

ï£®

Î»A,0

ï£¹

ï£º
ï£¯
ï£° Î»A,1 ï£» =
Î»A,2

46

"

0 WÂµ
CAa
2
0
CAb
W Âµ2

#

.

(A113)

When Î»A,2 = 0K2 , the first block of this equation gives us
#
"
Î»A,0
0
0
= (CAa
W CAa )âˆ’1 CAa
W Âµ2 .
Î»A,1

(A114)

Similarly for model B, when Î»B,3 = 0K3 , we have:
"
#
Î»B,0
0
0
= (CBa
W CBa )âˆ’1 CBa
W Âµ2 ,
Î»B,1

(A115)

0 ]],
where CBa is the first K1 +1 columns of CB . Since CAa and CBa are both equal to [1N , Cov[Rt, f1t

we have Î»A,0 = Î»B,0 and Î»A,1 = Î»B,1. This completes the proof.
Proof of Propositions 5 and 6: Since Proposition 5 is a special case of Proposition 6 when K3 = 0,
we only provide the proof of Proposition 6 here. We first derive a simplified expression for QB âˆ’QA .
The aggregate pricing-error measure for model A is given by
0
0
QA = e0A W eA = Âµ02 W Âµ2 âˆ’ Âµ02 W CA (CA
W CA )âˆ’1 CA
W Âµ2 .

(A116)

We now introduce a model M that uses only f1 as factors. The aggregate pricing-error measure for
model M is given by
0
0
QM = e0M W eM = Âµ02 W Âµ2 âˆ’ Âµ02 W CM (CM
W CM )âˆ’1 CM
W Âµ2 ,

(A117)

where CM = [1N , Cov[R, f10 ]]. Using the fact that the CAa = CBa = CM and (A108), we can write
the difference between QM and QA as
âˆ’1
QM âˆ’ QA = Î»0A,2HÌƒA,22
Î»A,2.

(A118)

âˆ’1
QM âˆ’ QB = Î»0B,3HÌƒB,33
Î»B,3.

(A119)

Similarly, we have:

Subtracting (A119) from (A118), we obtain:
Q B âˆ’ QA =

âˆ’1
Î»0A,2 HÌƒA,22
Î»A,2

âˆ’

âˆ’1
Î»0B,3HÌƒB,33
Î»B,3

=Ïˆ

0

"

âˆ’1
HÌƒA,22

0K2 Ã—K3

0K3 Ã—K2

âˆ’1
âˆ’HÌƒB,33

#

Ïˆ,

(A120)

where Ïˆ = [Î»0A,2, Î»0B,3]0. This equation also holds for its sample counterpart, and under the null
âˆš
1
A
hypothesis H0 : Ïˆ = 0K2 +K3 , we have T V (ÏˆÌ‚)âˆ’ 2 ÏˆÌ‚ âˆ¼ N (0K2+K3 , IK2+K3 ). It follows that
A

T (QÌ‚B âˆ’ QÌ‚A ) âˆ¼

KX
2 +K3
j=1

47

Î¾j x j ,

(A121)

where the xj â€™s are independent Ï‡21 random variables and the Î¾j â€™s are the eigenvalues of
"
#
âˆ’1
HÌƒA,22
0K2 Ã—K3
V (ÏˆÌ‚).
âˆ’1
0K3 Ã—K2 âˆ’HÌƒB,33

(A122)

a.s.

Since ÏÌ‚2A âˆ’ ÏÌ‚2B = (QÌ‚B âˆ’ QÌ‚A )/QÌ‚0 and QÌ‚0 âˆ’â†’ Q0 > 0, we have
A

T (ÏÌ‚2A âˆ’ ÏÌ‚2B ) âˆ¼

KX
2 +K3
j=1

Î¾j
xj .
Q0

(A123)

This completes the proof.
Proof of Propositions 7 and 8: In the proof of Proposition 4, we show that when model A is correctly
specified,
âˆš

A

T eÌ‚A âˆ¼ N (0N , VqA ),
where

âˆ
X

VqA =

(A124)

0
E[qAtqA,t+j
],

(A125)

j=âˆ’âˆ

with
1

1

1

1

qAt = W âˆ’ 2 PA PA0 W 2 RtyAt = W âˆ’ 2 PA PA0 W 2 gAt .

(A126)

A similar result holds for model B. Stacking up the pricing errors of the two models, we have:
#
"
âˆš
eÌ‚A A
T
âˆ¼ N (02N , Vq ),
(A127)
eÌ‚B
where

âˆ
X

Vq =

0
E[qtqt+j
],

(A128)

j=âˆ’âˆ

and
qt =

"

#

qAt
qBt

=

"

âˆš
z=

T

"

1

1

1

W âˆ’ 2 PB PB0 W 2 gBt

We can simplify Vq as
"
1
1
1
1
W âˆ’ 2 PA PA0 W 2 SAA W 2 PA PA0 W âˆ’ 2
Vq =
1
1
1
1
W âˆ’ 2 PB PB0 W 2 SBA W 2 PA PA0 W âˆ’ 2
It follows that

1

W âˆ’ 2 PA PA0 W 2 gAt

#

.

(A129)

1

1

1

1

1

1

1

1

W âˆ’ 2 PA PA0 W 2 SAB W 2 PB PB0 W âˆ’ 2
W âˆ’ 2 PB PB0 W 2 SBB W 2 PB PB0 W âˆ’ 2

1

PÌ‚A0 WÌ‚ 2 eÌ‚A

#

1
2

PÌ‚B0 WÌ‚ eÌ‚B
48

A

âˆ¼ N (0nA +nB , Vz ),

#

.

(A130)

(A131)

where
Vz =

"

1

1

1

1

PA0 W 2 SAA W 2 PA

1

1

1

1

PA0 W 2 SAB W 2 PB

#

PB0 W 2 SBA W 2 PA PB0 W 2 SBB W 2 PB

.

(A132)

Then, we have:
A

z 0VÌ‚zâˆ’1 z âˆ¼ Ï‡2nA +nB .

(A133)

This completes the proof of Proposition 7.
0 WÌ‚ 0 eÌ‚ = 0
Using the first order condition CÌ‚A
A
K1 +K2 +1 , we can write:
1

1

1

1

0
0
T QÌ‚A = T eÌ‚0A WÌ‚ 2 [PÌ‚A PÌ‚A0 + WÌ‚ 2 CÌ‚A (CÌ‚A
WÌ‚ CÌ‚A )âˆ’1 CÌ‚A
WÌ‚ 2 ]WÌ‚ 2 eÌ‚A
1

1

= T eÌ‚0A WÌ‚ 2 PÌ‚A PÌ‚A0 WÌ‚ 2 eÌ‚A
0
= zA
zA ,

(A134)

0
where zA is the first nA elements of z. Similarly, T QÌ‚B = zB
zB , where zB is the last nB elements

of z. Let QÎQ0 be the eigenvalue decomposition of
"
#
1
1
âˆ’I
0
n
n
Ã—n
A
A
B
Vz2
Vz2 ,
0nB Ã—nA
In B

(A135)

where Î = Diag(Î¾1, Â· Â· Â· , Î¾nA +nB ) is a diagonal matrix of the eigenvalues of (A135) or, equivalently,
âˆ’1

A

of the eigenvalues of (70). Writing zÌƒ = Q0 Vz 2 z âˆ¼ N (0nA+nB , InA+nB ), we have:
"
#
nAX
+nB
1
1
âˆ’I
0
n
n
Ã—n
A
A
B
0
0 âˆ’2
0 âˆ’2
0
T (QÌ‚B âˆ’ QÌ‚A ) = z
z = z Vz QÎQ Vz z = zÌƒ ÎzÌƒ =
Î¾j x j ,
0nB Ã—nA
In B
j=1

(A136)

A

where xj = zÌƒj2 âˆ¼ Ï‡21 , j = 1, . . ., nA + nB , and they are asymptotically independent of each other.
a.s.

Since ÏÌ‚2A âˆ’ ÏÌ‚2B = (QÌ‚B âˆ’ QÌ‚A )/QÌ‚0 and QÌ‚0 âˆ’â†’ Q0 > 0, we have:
T (ÏÌ‚2A

âˆ’

A
ÏÌ‚2B ) âˆ¼

nAX
+nB
j=1

Î¾j
xj .
Q0

(A137)

This completes the proof of Proposition 8.
Proof of Proposition 9: We start from the known weighting matrix case. Using the results of
Proposition 4, we obtain the following expressions for models A and B:
 2 0
âˆ‚ÏA
2
nAt (Ï•) =
rt(Ï•) = 2Qâˆ’1
0 [âˆ’uAt yAt + (1 âˆ’ ÏA )vt ],
âˆ‚Ï•
 2 0
âˆ‚ÏB
2
nBt(Ï•) =
rt(Ï•) = 2Qâˆ’1
0 [âˆ’uBt yBt + (1 âˆ’ ÏB )vt ].
âˆ‚Ï•
49

(A138)
(A139)

Now, using the delta method and equations (A1)â€“(A4), the asymptotic distribution of ÏÌ‚2A âˆ’ ÏÌ‚2B
when both models are misspecified is given by


âˆš
A
T (ÏÌ‚2A âˆ’ ÏÌ‚2B âˆ’ (Ï2A âˆ’ Ï2B )) âˆ¼ N

âˆ‚(Ï2A âˆ’ Ï2B )
0,
âˆ‚Ï•

0

S0



âˆ‚(Ï2A âˆ’ Ï2B )
âˆ‚Ï•

!

âˆš
With the analytical expressions of nAt (Ï•) and nBt(Ï•), the asymptotic variance of
be written as

âˆ
X

E[dt(Ï•)dt+j (Ï•)],

.

(A140)

T (ÏÌ‚2A âˆ’ ÏÌ‚2B ) can

(A141)

j=âˆ’âˆ

where
dt(Ï•) =



âˆ‚Ï2A âˆ‚Ï2B
âˆ’
âˆ‚Ï•
âˆ‚Ï•

0

rt (Ï•) = nAt (Ï•) âˆ’ nBt(Ï•).

(A142)

Under H0 : Ï2A = Ï2B , we have:
dt(Ï•) = 2Qâˆ’1
0 (uBt yBt âˆ’ uAt yAt ).

(A143)

âˆ’1
Using the same type of proof for the GLS case with WÌ‚ = VÌ‚22
, we obtain:
2
2
dt(Ï•) = Qâˆ’1
0 (uAt âˆ’ 2uAt yAt âˆ’ uBt + 2uBt yBt ).

This completes the proof.

50

(A144)

References
Ahn, Seung C., and Christopher Gadarowski. 2003. â€œTwo-Pass Cross-Sectional Regression of
Factor Pricing Models: Minimum Distance Approach.â€ Working Paper, Arizona State University.
Bentler, Peter M., and Maia Berkane. 1986. â€œGreatest Lower Bound to the Elliptical Theory
Kurtosis Parameter.â€ Biometrika 73: 240â€“241.
Black, Fischer, Michael C. Jensen, and Myron Scholes. 1972. â€œThe Capital Asset Pricing Model:
Some Empirical Findings.â€ In Jensen, M.C. (Ed.), Studies in the Theory of Capital Markets.
Praeger, New York.
Campbell, John Y., Andrew W. Lo, and A. Craig MacKinlay. 1997. The Econometrics of Financial Markets. Princeton University Press, Princeton.
Chen, Nai-Fu, Richard Roll, and Stephen A. Ross. 1986. â€œEconomic Forces and the Stock
Market.â€ Journal of Business 59: 383â€“404.
Chen, Robert, and Raymond Kan. 2003. â€œFinite Sample Analysis of Two-Pass Cross-Sectional
Regressions.â€ Working Paper, University of Toronto.
Cochrane, John H. 1996. â€œA Cross-Sectional Test of an Investment-Based Asset Pricing Model.â€
Journal of Political Economy 104: 572-621.
Cochrane, John H. 2005. Asset Pricing. Princeton University Press, Princeton.
Davidson, Russell, and James D. MacKinnon. 2003. Econometric Theory and Methods. Oxford
University Press, New York.
Fama, Eugene F., and James D. MacBeth. 1973. â€œRisk, Return and Equilibrium: Empirical
Tests.â€ Journal of Political Economy 71: 607-636.
Fama, Eugene. F., and Kenneth R. French. 1992. â€œThe Cross-Section of Expected Stock Returns.â€
Journal of Finance 47: 427â€“466.
Fama, Eugene. F., and Kenneth R. French. 1993. â€œCommon Risk Factors in the Returns on
Stocks and Bonds.â€ Journal of Financial Economics 33: 3â€“56.
51

Ferson, Wayne E., and Rudi W. Schadt. 1996. â€œMeasuring Fund Strategy and Performance in
Changing Economic Conditions.â€ Journal of Finance 51: 425â€“461.
Golden, Richard M. 2003. â€œDiscrepancy Risk Model Selection Test Theory for Comparing Possibly
Misspecified or Nonnested Models.â€ Psychometrika 68: 229â€“249.
Grauer, Robert R., and Johannus A. Janmaat. 2009. â€œOn the Power of Cross-Sectional and
Multivariate Tests of the CAPM.â€ Journal of Banking and Finance, forthcoming.
Hall, Alastair R., and Atsushi Inoue. 2003. â€œThe Large Sample Behaviour of the Generalized
Method of Moments Estimator in Misspecified Models.â€ Journal of Econometrics 114: 361â€“
394.
Hansen, Lars P. 1982. â€œLarge Sample Properties of Generalized Method of Moments Estimators.â€
Econometrica 50: 1029â€“1054.
Hansen, Lars P., and Ravi Jagannathan. 1997. â€œAssessing Specification Errors in Stochastic
Discount Factor Models.â€ Journal of Finance 52: 557â€“590.
Hou, Kewei, and Robert Kimmel. 2006. â€œOn the Estimation of Risk Premia in Linear Factor
Models.â€ Working Paper, Ohio State University.
Jagannathan, Ravi, and Zhenyu Wang. 1996. â€œThe Conditional CAPM and the Cross-section of
Expected Returns.â€ Journal of Finance 51: 3â€“53.
Jagannathan, Ravi, and Zhenyu Wang. 1998. â€œAn Asymptotic Theory for Estimating BetaPricing Models Using Cross-Sectional Regression.â€ Journal of Finance 53: 1285â€“1309.
Jagannathan, Ravi, Keiichi Kubota, and Hitoshi Takehara. 1998. â€œRelationship Between LaborIncome Risk and Average Return: Empirical Evidence From the Japanese Stock Market.â€
Journal of Business 71: 319â€“348.
Jagannathan, Ravi, and Yong Wang. 2007. â€œLazy Investors, Discretionary Consumption, and the
Cross-Section of Stock Returns.â€ Journal of Finance 62: 1623â€“1661.
Jagannathan, Ravi, Georgios Skoulakis, and Zhenyu Wang. 2008. â€œThe Analysis of the Cross
Section of Security Returns.â€ Handbook of Financial Econometrics, forthcoming.
52

Kan, Raymond, and Cesare Robotti. 2008. â€œModel Comparison Using the Hansen-Jagannathan
Distance.â€ Review of Financial Studies, forthcoming.
Kan, Raymond, and Cesare Robotti. 2009. â€œA Note on the Estimation of Asset Pricing Models
Using Simple Regression Betas.â€ Working Paper, University of Toronto.
Kan, Raymond, and Chu Zhang. 1999. â€œTwo-Pass Tests of Asset Pricing Models with Useless
Factors.â€ Journal of Finance 54: 203â€“235.
Kandel, Shmuel, and Robert F. Stambaugh. 1995. â€œPortfolio Inefficiency and the Cross-Section
of Expected Returns.â€ Journal of Finance 50: 157â€“184.
Lettau, Martin, and Sydney C. Ludvigson. 2001. â€œResurrecting the (C)CAPM: A Cross-Sectional
Test when Risk Premia are Time-Varying.â€ Journal of Political Economy 109: 1238â€“1287.
Lewellen, Jonathan W., Stefan Nagel, and Jay Shanken. 2009. â€œA Skeptical Appraisal of AssetPricing Tests.â€ Journal of Financial Economics, forthcoming.
Li, Haitao, Yuewu Xu, and Xiaoyan Zhang. 2009. â€œEvaluating Asset Pricing Models Using the
Second Hansen-Jagannathan Distance.â€ Journal of Financial Economics, forthcoming.
Magnus, Jan R., and Heinz Neudecker. 1999. Matrix Differential Calculus with Applications in
Statistics and Econometrics. Wiley, New York.
Maruyama, Yosihito, and Takashi Seo. 2003. â€œEstimation of Moment Parameter in Elliptical
Distributions.â€ Journal of the Japan Statistical Society 33: 215â€“229.
Newey, Whitney K. 1984. â€œA Method of Moments Interpretation of Sequential Estimators.â€
Economics Letters 14: 201â€“206.
Newey, Whitney K., and Kenneth D. West. 1987. â€œA Simple Positive Definite Heteroskedasticity
and Autocorrelation Consistent Covariance Matrix.â€ Econometrica 55: 703â€“708.
Newey, Whitney K., and Kenneth D. West. 1994. â€œAutomatic Lag Selection in Covariance Matrix
Estimation.â€ Review of Economic Studies 61: 631â€“653.
Pagan, Adrian. 1984. â€œEconometric Issues in the Analysis of Regressions with Generated Regressors.â€ International Economic Review 25: 221â€“247.
53

Petkova, Ralitsa. 2006. â€œDo the Fama-French Factors Proxy for Innovations in Predictive Variables?â€ Journal of Finance 61: 581â€“612.
Rivers, Douglas, and Quang H. Vuong. 2002. â€œModel Selection Tests for Nonlinear Dynamic
Models.â€ Econometrics Journal 5: 1â€“39.
Roll, Richard, and Stephen A. Ross. 1994. â€œOn the Cross-sectional Relation between Expected
Returns and Betas.â€ Journal of Finance 49: 101â€“121.
Shanken, Jay. 1985. â€œMultivariate Tests of the Zero-Beta CAPM.â€ Journal of Financial Economics 14: 327â€“348.
Shanken, Jay. 1990. â€œIntertemporal Asset Pricing: An Empirical Investigation.â€ Journal of
Econometrics 45: 99â€“120.
Shanken, Jay. 1992. â€œOn the Estimation of Beta-Pricing Models.â€ Review of Financial Studies
5: 1â€“33.
Shanken, Jay, and Guofu Zhou. 2007. â€œEstimating and Testing Beta Pricing Models: Alternative
Methods and their Performance in Simulations.â€ Journal of Financial Economics 84: 40â€“86.
Vuong, Quang H. 1989. â€œLikelihood Ratio Tests for Model Selection and Non-Nested Hypotheses.â€
Econometrica 57: 307â€“333.
White, Halbert L. 1994. Estimation, Inference and Specification Analysis. Cambridge, New York.

54

TABLE 1
Sample Cross-Sectional R2 s and Specification Tests of the Models
Panel A: OLS

2

ÏÌ‚
p(Ï2 = 1)
se(ÏÌ‚2)
p(Ï2 = 0)
QÌ‚c
p1 (Qc = 0)
p2 (Qc = 0)
No. of par.

CAPM

CCAPM

FF3

C-LAB

C-CCAPM

ICAPM

0.213
0.000
0.236
0.099
0.091
0.000
0.000
2

0.036
0.000
0.118
0.545
0.113
0.000
0.000
2

0.769
0.000
0.099
0.004
0.070
0.002
0.004
4

0.691
0.102
0.156
0.007
0.036
0.327
0.378
4

0.526
0.211
0.447
0.367
0.021
0.935
0.947
4

0.793
0.209
0.115
0.004
0.029
0.480
0.527
6

Panel B: GLS

ÏÌ‚2
p(Ï2 = 1)
se(ÏÌ‚2)
p(Ï2 = 0)
QÌ‚c
p1 (Qc = 0)
p2 (Qc = 0)
No. of par.

CAPM

CCAPM

FF3

C-LAB

C-CCAPM

ICAPM

0.127
0.000
0.085
0.004
0.089
0.000
0.000
2

0.045
0.000
0.076
0.228
0.108
0.000
0.000
2

0.336
0.001
0.114
0.000
0.071
0.001
0.003
4

0.158
0.000
0.106
0.244
0.084
0.000
0.000
4

0.388
0.423
0.229
0.004
0.037
0.445
0.501
4

0.389
0.226
0.189
0.030
0.039
0.156
0.194
6

Note.â€“The table presents the sample cross-sectional R2 (ÏÌ‚2 ) and the generalized CSRT (QÌ‚c ) of six beta
pricing models. The models include the unconditional CAPM (CAPM), the consumption CAPM (CCAPM),
the Fama and French (1993) three-factor model (FF3), the conditional CAPM (C-LAB) of Jagannathan and
Wang (1996), the conditional CCAPM (C-CCAPM), and the intertemporal CAPM (ICAPM) of Petkova
(2006). The models are estimated using monthly returns on the 25 Fama-French size and book-to-market
ranked portfolios. Most of the data are from May 1953 to December 2006 (644 observations), but the data
for the CCAPM and C-CCAPM start in February 1959 (575 observations). p(Ï2 = 1) is the p-value for the
test of H0 : Ï2 = 1. se(ÏÌ‚2 ) is the standard error of ÏÌ‚2 under the assumption that 0 < Ï2 < 1. p(Ï2 = 0) is
the p-value for the test of H0 : Ï2 = 0. p1(Qc = 0) is the p-value for the asymptotic test of H0 : Qc = 0.
p2 (Qc = 0) is the p-value for the approximate F -test of H0 : Qc = 0. No. of par. is the number of parameters
in the model.

55

TABLE 2
Estimates and t-ratios of Zero-Beta Rate and Risk Premia under
Correctly Specified and Misspecified Models
Panel A: OLS
CAPM
Î³Ì‚0
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

1.90
5.53
5.47
5.28
4.97

CCAPM

Î³Ì‚vw
âˆ’0.66
âˆ’1.72
âˆ’1.70
âˆ’1.67
âˆ’1.60

Î³Ì‚0

Î³Ì‚cg

1.00
4.85
4.75
4.80
3.86

0.15
0.70
0.69
0.70
0.58

FF3
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

C-LAB

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚smb

Î³Ì‚hml

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚lab

Î³Ì‚prem

2.01
6.94
6.69
6.72
5.91

âˆ’0.99
âˆ’2.96
âˆ’2.87
âˆ’2.85
âˆ’2.58

0.15
1.22
1.22
1.22
1.23

0.43
3.86
3.86
3.87
3.86

1.95
5.79
3.44
3.46
3.48

âˆ’1.08
âˆ’2.96
âˆ’1.89
âˆ’1.94
âˆ’1.97

0.11
0.94
0.56
0.58
0.52

0.54
4.31
2.58
2.78
3.21

C-CCAPM
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

ICAPM

Î³Ì‚0

Î³Ì‚dy

Î³Ì‚cg

Î³Ì‚cgÂ·dy

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚term

Î³Ì‚def

Î³Ì‚div

Î³Ì‚rf

1.33
6.82
3.47
3.56
3.13

âˆ’1.61
âˆ’5.30
âˆ’2.71
âˆ’2.82
âˆ’1.07

0.50
2.94
1.51
1.47
0.53

0.01
2.47
1.27
1.26
0.65

1.21
3.91
2.44
2.06
1.73

âˆ’0.16
âˆ’0.47
âˆ’0.32
âˆ’0.28
âˆ’0.25

0.26
3.97
2.50
2.55
1.81

âˆ’0.11
âˆ’2.37
âˆ’1.50
âˆ’1.29
âˆ’1.18

âˆ’0.01
âˆ’0.54
âˆ’0.35
âˆ’0.26
âˆ’0.20

âˆ’0.48
âˆ’3.77
âˆ’2.38
âˆ’2.19
âˆ’1.96

56

TABLE 2 (Continued)
Estimates and t-ratios of Zero-Beta Rate and Risk Premia under
Correctly Specified and Misspecified Models
Panel B: GLS
CAPM
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

CCAPM

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚0

Î³Ì‚cg

1.90
8.98
8.80
8.63
7.51

âˆ’0.85
âˆ’3.17
âˆ’3.14
âˆ’3.10
âˆ’2.84

1.27
8.93
8.56
8.49
7.61

0.21
1.92
1.85
1.85
1.19

FF3
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

C-LAB

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚smb

Î³Ì‚hml

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚lab

Î³Ì‚prem

1.88
7.40
7.17
7.22
6.11

âˆ’0.84
âˆ’2.77
âˆ’2.71
âˆ’2.70
âˆ’2.37

0.20
1.68
1.68
1.69
1.69

0.40
3.61
3.61
3.62
3.61

1.82
8.41
8.00
7.64
6.57

âˆ’0.78
âˆ’2.84
âˆ’2.75
âˆ’2.67
âˆ’2.32

âˆ’0.07
âˆ’0.93
âˆ’0.89
âˆ’0.89
âˆ’0.44

0.06
0.83
0.80
0.76
0.40

C-CCAPM
Estimate
t-ratiof m
t-ratios
t-ratiojw
t-ratiopm

ICAPM

Î³Ì‚0

Î³Ì‚dy

Î³Ì‚cg

Î³Ì‚cgÂ·dy

Î³Ì‚0

Î³Ì‚vw

Î³Ì‚term

Î³Ì‚def

Î³Ì‚div

Î³Ì‚rf

1.18
8.18
5.29
4.89
4.69

âˆ’0.97
âˆ’5.02
âˆ’3.30
âˆ’3.85
âˆ’2.64

0.50
4.03
2.66
2.61
2.08

0.02
3.98
2.62
2.52
2.06

1.61
5.94
4.33
3.90
3.08

âˆ’0.52
âˆ’1.67
âˆ’1.31
âˆ’1.23
âˆ’1.01

0.21
3.99
2.94
2.97
2.01

âˆ’0.08
âˆ’2.10
âˆ’1.55
âˆ’1.47
âˆ’1.09

0.01
0.53
0.39
0.34
0.25

âˆ’0.22
âˆ’2.06
âˆ’1.52
âˆ’1.46
âˆ’1.10

Note.â€“The table presents the estimation results of six beta pricing models. The models include the unconditional CAPM (CAPM), the consumption CAPM (CCAPM), the Fama and French (1993) three-factor
model (FF3), the conditional CAPM (C-LAB) of Jagannathan and Wang (1996), the conditional CCAPM
(C-CCAPM), and the intertemporal CAPM (ICAPM) of Petkova (2006). The models are estimated using
monthly returns on the 25 Fama-French size and book-to-market ranked portfolios. Most of the data are
from May 1953 to December 2006 (644 observations), but the data for the CCAPM and C-CCAPM start
in February 1959 (575 observations). We report parameter estimates Î³Ì‚ (multiplied by 100), the Fama
and MacBeth (1973) t-ratios under correctly specified models (t-ratiof m ), the Shanken (1992) and the
Jagannathan and Wang (1998) t-ratios under correctly specified models that account for the EIV problem
(t-ratios and t-ratiojw, respectively), and our model misspecification-robust t-ratios (t-ratiopm ).

57

TABLE 3
Estimates and t-ratios of Zero-Beta Rate and Prices of Covariance Risk
under Correctly Specified and Misspecified Models
Panel A: OLS
CAPM

Estimate
t-ratiof m
t-ratiocs
t-ratiopm

CCAPM

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚0

Î»Ì‚cg

1.90
5.53
5.28
4.97

âˆ’3.66
âˆ’1.72
âˆ’1.69
âˆ’1.61

1.00
4.85
4.80
3.86

28.96
0.70
0.70
0.58

FF3

Estimate
t-ratiof m
t-ratiocs
t-ratiopm

C-LAB

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚smb

Î»Ì‚hml

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚lab

Î»Ì‚prem

2.01
6.94
6.72
5.91

âˆ’5.43
âˆ’2.49
âˆ’2.39
âˆ’2.13

4.66
3.09
2.95
2.90

3.96
2.12
2.02
1.92

1.95
5.79
3.46
3.48

âˆ’7.70
âˆ’3.83
âˆ’2.41
âˆ’2.46

31.48
0.44
0.26
0.23

318.91
4.50
2.84
3.29

C-CCAPM
Î»Ì‚0
Estimate
t-ratiof m
t-ratiocs
t-ratiopm

1.33
6.82
3.56
3.13

Î»Ì‚dy
âˆ’156.29
âˆ’5.38
âˆ’2.74
âˆ’1.35

ICAPM

Î»Ì‚cg

Î»Ì‚cgÂ·dy

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚term

Î»Ì‚def

Î»Ì‚div

âˆ’58.35
âˆ’0.71
âˆ’0.33
âˆ’0.11

4471.67
1.65
0.77
0.35

1.21
3.91
2.06
1.73

âˆ’9.87
âˆ’1.13
âˆ’0.54
âˆ’0.38

286.90
2.60
1.80
1.15

âˆ’278.89
âˆ’3.05
âˆ’1.56
âˆ’1.41

âˆ’275.39
âˆ’0.90
âˆ’0.42
âˆ’0.28

58

Î»Ì‚rf
âˆ’91.95
âˆ’2.22
âˆ’1.22
âˆ’1.17

TABLE 3 (Continued)
Estimates and t-ratios of Zero-Beta Rate and Prices of Covariance Risk
under Correctly Specified and Misspecified Models
Panel B: GLS
CAPM

Estimate
t-ratiof m
t-ratiocs
t-ratiopm

CCAPM

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚0

Î»Ì‚cg

1.90
8.98
8.63
7.51

âˆ’4.73
âˆ’3.17
âˆ’3.15
âˆ’2.81

1.27
8.93
8.49
7.61

40.53
1.92
1.83
1.18

FF3

Estimate
t-ratiof m
t-ratiocs
t-ratiopm

C-LAB

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚smb

Î»Ì‚hml

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚lab

Î»Ì‚prem

1.88
7.40
7.22
6.11

âˆ’4.66
âˆ’2.36
âˆ’2.28
âˆ’1.97

4.95
3.41
3.26
3.21

4.04
2.24
2.20
2.08

1.82
8.41
7.64
6.57

âˆ’4.98
âˆ’3.30
âˆ’3.19
âˆ’2.77

âˆ’55.12
âˆ’1.12
âˆ’1.07
âˆ’0.54

43.60
1.04
0.96
0.52

C-CCAPM

Estimate
t-ratiof m
t-ratiocs
t-ratiopm

ICAPM

Î»Ì‚0

Î»Ì‚dy

Î»Ì‚cg

Î»Ì‚cgÂ·dy

Î»Ì‚0

Î»Ì‚vw

Î»Ì‚term

Î»Ì‚def

Î»Ì‚div

Î»Ì‚rf

1.18
8.18
4.89
4.69

âˆ’96.74
âˆ’5.24
âˆ’3.76
âˆ’2.72

âˆ’49.83
âˆ’0.72
âˆ’0.49
âˆ’0.36

4369.36
2.03
1.34
1.02

1.61
5.94
3.90
3.08

âˆ’4.58
âˆ’0.59
âˆ’0.38
âˆ’0.27

345.64
3.81
2.83
2.03

âˆ’155.28
âˆ’2.16
âˆ’1.45
âˆ’1.10

âˆ’9.08
âˆ’0.03
âˆ’0.02
âˆ’0.01

4.51
0.14
0.09
0.07

Note.â€“The table presents the estimation results of six beta pricing models. The models include the unconditional
CAPM (CAPM), the consumption CAPM (CCAPM), the Fama and French (1993) three-factor model (FF3),
the conditional CAPM (C-LAB) of Jagannathan and Wang (1996), the conditional CCAPM (C-CCAPM), and
the intertemporal CAPM (ICAPM) of Petkova (2006). The models are estimated using monthly returns on the
25 Fama-French size and book-to-market ranked portfolios. Most of the data are from May 1953 to December
2006 (644 observations), but the data for the CCAPM and C-CCAPM start in February 1959 (575 observations).
We report parameter estimates Î»Ì‚ (with Î»Ì‚0 multiplied by 100), the Fama and MacBeth (1973) t-ratios under
correctly specified models (t-ratiof m ), the t-ratios under correctly specified models that account for the EIV
problem (t-ratiocs), and model misspecification-robust t-ratios (t-ratiopm ).

59

TABLE 4
Tests of Equality of Cross-Sectional R2 s
Panel A: OLS

CAPM

CCAPM

FF3

C-LAB

C-CCAPM

ICAPM

0.135
(0.686)

âˆ’0.555
(0.000)

âˆ’0.478
(0.020)

âˆ’0.355
(0.457)

âˆ’0.580
(0.064)

âˆ’0.747
(0.029)

âˆ’0.585
(0.129)

âˆ’0.490
(0.321)

âˆ’0.803
(0.023)

0.078
(0.608)

0.256
(0.558)

âˆ’0.024
(0.792)

0.095
(0.849)

âˆ’0.102
(0.543)

CCAPM
FF3
C-LAB
C-CCAPM

âˆ’0.313
(0.470)
Panel B: GLS

CAPM
CCAPM

CCAPM

FF3

C-LAB

C-CCAPM

ICAPM

0.067
(0.588)

âˆ’0.209
(0.001)

âˆ’0.031
(0.735)

âˆ’0.275
(0.256)

âˆ’0.261
(0.256)

âˆ’0.283
(0.058)

âˆ’0.092
(0.502)

âˆ’0.342
(0.025)

âˆ’0.296
(0.151)

0.178
(0.163)

âˆ’0.059
(0.802)

âˆ’0.053
(0.778)

âˆ’0.250
(0.318)

âˆ’0.230
(0.268)

FF3
C-LAB
C-CCAPM

0.047
(0.871)

Note.â€“The table presents pairwise tests of equality of the OLS and GLS cross-sectional
R2 s of six beta pricing models. The models include the unconditional CAPM (CAPM), the
consumption CAPM (CCAPM), the Fama and French (1993) three-factor model (FF3), the
conditional CAPM (C-LAB) of Jagannathan and Wang (1996), the conditional CCAPM
(C-CCAPM), and the intertemporal CAPM (ICAPM) of Petkova (2006). The models are
estimated using monthly returns on the 25 Fama-French size and book-to-market ranked
portfolios. Most of the data are from May 1953 to December 2006 (644 observations), but the
data for the CCAPM and C-CCAPM start in February 1959 (575 observations). We report
the difference between the sample cross-sectional R2s of the models in row i and column
j, ÏÌ‚2i âˆ’ ÏÌ‚2j , and the associated p-value (in parentheses) for the test of H0 : Ï2i = Ï2j . The
p-values are computed under the assumption that the models are potentially misspecified.

60

