                               NBER WORKING PAPER SERIES




     TESTS FOR PRICE ENDOGENEITY IN DIFFERENTIATED PRODUCT MODELS

                                           Kyoo il Kim
                                           Amil Petrin

                                       Working Paper 19011
                               http://www.nber.org/papers/w19011


                     NATIONAL BUREAU OF ECONOMIC RESEARCH
                              1050 Massachusetts Avenue
                                Cambridge, MA 02138
                                     May 2013




The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.

NBER working papers are circulated for discussion and comment purposes. They have not been peer-
reviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.

¬© 2013 by Kyoo il Kim and Amil Petrin. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ¬© notice,
is given to the source.
Tests for Price Endogeneity in Differentiated Product Models
Kyoo il Kim and Amil Petrin
NBER Working Paper No. 19011
May 2013
JEL No. C3,L0

                                           ABSTRACT

We develop simple tests for endogenous prices arising from omitted demand factors in discrete choice
models. Our approach only requires one to locate testing proxies that have some correlation with the
omitted factors when prices are endogenous. We use the difference between prices and their predicted
values given observed demand and supply factors. If prices are exogenous, these proxies should not
explain demand given prices and other explanatory variables. We reject exogeneity if these proxies
enter significantly in utility as additional explanatory variables. The tests are easy to implement as
we show with several Monte Carlos and discuss for three recent demand applications.


Kyoo il Kim
Department of Economics
University of Minnesota
4-129 Hanson Hall
1925 4th Street South
Minneapolis, MN 55455
kyookim@umn.edu

Amil Petrin
Department of Economics
University of Minnesota
4-101 Hanson Hall
Minneapolis, MN 55455
and NBER
petrin@umn.edu
1       Introduction
Characteristic-based models of demand are widely used for estimating elasticities and substitution
patterns in differentiated product markets. When relevant product attributes are not observed by
the practitioner, price can be correlated with the unobserved portion of consumers‚Äô utility for that
product: producers charge more and consumers are willing to pay more for products with more
of the omitted attribute, holding all else constant. The positive correlation between price and the
unobserved portion of utility biases estimates of price elasticities upwards. This problem arises for
both aggregate (i.e., market-level) data and disaggregate (i.e., customer-level) data, and has been
documented empirically for CAT scanners (Trajtenberg (1989)), automobiles (Berry, Levinsohn, and
Pakes (1995) and Petrin (2002)), cable television choices (Goolsbee and Petrin (2004) and Crawford
(2000)), cereals (Nevo (2001)), yogurt and ketchup (Villas-Boas and Winer (1999)), and margarine
and orange juice (Chintagunta, Dube, and Goh (2005)).
     The literature has responded to these findings in three distinct ways. The first is to integrate
out the unobserved attributes. The challenge here is that one must specify the distribution of the
demand errors conditional on observed characteristics and price. This is generally regarded as a
difficult object to model.
     The second has been to invert out the demand errors and then directly condition on them.
Usually this is done by inverting the market share equations (Berry (1994), Berry et al. (1995),
Gandhi, Kim, and Petrin (2011)). A drawback for these inversions is that they are computationally
complex to program and time-consuming, and are also subject to propagated numerical errors from
the inversion (see e.g. Dube, Fox, and Su (2012) and Knittel and Metaxiglou (2008)). One can also
invert the demand error from the pricing equation but this requires stronger assumptions (Petrin
and Train (2010), Kim and Petrin (2010)).
     The final approach is to assert that there is no endogeneity problem conditional on the set of
observed controls. For example, in some applications researchers observe household-level panels
repeatedly choosing from the same choice sets over time. In this case one can include fixed effects
directly in the estimation for goods whose physical characteristics are not changing over time. In
some data sets many of the promotional activities are also known, like when the product is on
display or promotion. Conditional on all of these factors some researchers then proceed as if there
were no problem or that it is so small given the observed factors that it is not empirically relevant.1
     In this paper we develop a class of asymptotic tests that are easy to implement in standard
regression packages and have reasonable power against the ‚Äúexogenous prices‚Äù hypothesis. Our
approach tests for an unobserved attribute by constructing a proxy for it that exploits the attribute‚Äôs
correlation with price, which is the source of the econometric problem (Petrin and Train (2010)).
We develop control function type tests in the spirit of Smith and Blundell (1986), Rivers and Vuong
    1
    See Chintagunta, Dube, and Goh (2005) for suggestive evidence that even data with this detail still suffers from
omitted attributes.




                                                         2
(1988), and Villas-Boas and Winer (1999).2
    A major advantage of our testing approaches is their simplicity. In the simplest format, all of
the tests use least squares (or nonparametric regression) in an initial stage to obtain the proxies
that enter the control functions. The proxies are calculated as the difference between product price
and its predicted value given the relevant demand and/or supply factors that the econometrician
observes. Our procedure then includes the controls directly in the maximization of the likelihood
function and tests their significance, rejecting ‚Äúexogenous prices‚Äù if they enter significantly. The
controls can enter additively or interactions between price and the controls can be included to look
for non-separability.
    Our Monte Carlo results build in correlation between price and the unobserved attribute by
setting prices according to the standard inverse-elasticity rule, where demand depends in part on
the unobserved attribute. Our simplest test specifications correctly identify the price endogeneity
problem in almost every case.
    We describe approaches to implementing the tests for three of the recent demand exercises
mentioned above, where prices are shown to be endogenous. Each of these exercises uses a different
kind of data, including aggregate (market-level) data (BLP), household-level cross-sectional data
(Goolsbee and Petrin (2004)), and household-level panel data (CDG). Our empirical application
applies the test to the cable and satellite dish demand specification from Goolsbee and Petrin
(2004) and rejects price exogeneity.3
    Our work is related to recent developments in nonparametric identification of the unobserved
attribute in the discrete choice demand models (see Berry and Haile (2010) and Berry, Gandhi,
and Haile (2011)). One could develop a test for price endogeneity by using this nonparametrically
recovered unobserved attribute and combining it with more recent conditional mean tests or speci-
fication tests in general. There have been two main approaches in the literature. One approach is
to use smoothed conditional mean functions (e.g. H√§rdle and Mammen (1993), Fan and Li (1996),
Horowitz and Spokoiny (2001), Kitamura, Tripathi, and Ahn (2004) among others) and a second
approach is to formulate a conditional mean restriction as a dense set of unconditional mean restric-
tions (e.g. Bierens (1990) and his other works, Stinchcombe and White (1998), Andrews (1997),
Chen and Fan (1999), Li, Hsiao, and Zinn (2003), Song (2010) among others). These approaches
may have better power properties and also be less sensitive to parametric assumptions. We leave
them as future research and in this paper we focus on the classical tests based on parametric demand
model settings that are most commonly used by practitioners, such as the random coefficient logit
demand model.
    The paper proceeds as follows. Sections 2 describes differentiated products demand models
and the endogeneity problem. Sections 3-5 describes the theory of the tests and their empirical
   2
     The linear control function case is described in Heckman (1978) and Hausman (1978). The first use of the term
‚Äúcontrol function‚Äù of which we are aware is in Heckman and Robb (1985) in the context of selection models.
   3
     In the separate work (Kim and Petrin (2010)) we effectively run a variant of this test for the automobile demand
specification from BLP and the margarine demand specification from CDG.



                                                         3
implementation. Sections 6-7 includes the Monte Carlos and the empirical example. Then we
conclude in Section 8. Technical details are added in Appendix.


2       Demand and Omitted Attributes
The problem of omitted attributes arises naturally within characteristics-based demand approxima-
tions. At the core of these approaches is a desire for parsimony; an unrestricted constant-elasticity-
of-demand system with J goods can have J 2 or more parameters (for example). Characteristics‚Äô
based approaches achieve parsimony in two ways. They assume that demands for J goods can be
approximated by K << J characteristics of the goods, where the K factors serve as the basis for
utility. They also assume that consumers only derive utility from the characteristics of the actual
good that they purchase.
    We analyze the specification problem that arises when the K factors used by the econometrician
exclude relevant characteristics. We operate in the generalized random coefficients setting from
Gandhi, Kim, and Petrin (2011) that allows for a non-separable error, with utility that consumer i
derives from product j in market m is given as
                       XK                                      XK
        Uimj = cij +          xmjk Œ≤ik ‚àí Œ±i pmj + Œ≤iŒæ Œæmj +              Œ≥ik xmjk Œæmj + Œ≥ip pmj Œæmj + «´imj ,   (1)
                        k=1                                        k=1

with xmjk and pmj being characteristics and price and the outside good 0 normalized to Uim0 =
«´im0 .4 In this setup coefficients are varying across individual observations according to (e.g.)
                                                     XL
                                     cij   = cj0 +             cjl dil + œÉc œâic
                                                       l=1
                                                      XL
                                     Œ≤ik = Œ≤k0 +      Œ≤kl dil + œÉk œâik
                                                  l=1
                                                XL
                                      Œ±i = Œ±0 +      Œ±l dil + œÉp œâip
                                                         l=1

where a vector of characteristics di (L √ó 1) can include demographics or other observed charac-
teristics of i and œâi = (œâic , œâi1 , . . . œâiK , œâip ) denotes a vector of unobserved consumer tastes for
the characteristics and the price (i.e., random shocks that generate the random coefficients), which
follows a known distribution such as standard normals.5 The idiosyncratic consumer-product spe-
cific shock «´im = («´im1 , «´im2 , . . . , «´imJ )‚Ä≤ is independent across individuals i = 1, 2, . . . , N with joint
distribution denoted by f«´ (¬∑) that is known up to a finite vector of parameters.
     Œæmj is a product-specific characteristic known to both consumers and producers in the market
but unobserved to the econometrician. We isolate it from the other characteristics because the
specification question asks whether Œæmj enters utility for product j (i.e. whether Œ≤iŒæ 6= 0, Œ≥ik 6= 0,
    4
      Gandhi, Kim, and Petrin (2011) show that in the automobile data from Berry, Levinsohn, and Pakes (1995)
allowing for these interactions leads to an increase in price elasticities of 60% on average.
    5
      The market index m can index for the same market observed repeatedly over time, a cross-section of markets at
a given point in time, or a combination of the two.




                                                        4
or Œ≥ip 6= 0). For notational simplicity let Œ∏ collect all the parameters in the model (1).6 Letting
(X, p) be the J √ó (K + 1) matrix of the entire set of characteristics with arbitrary row (Xj‚Ä≤ , pj ),
Œæ = (Œæ1 , . . . , ŒæJ )‚Ä≤ , and Pimj (Œ∏) the probability of i choosing j conditional on (X, p, Œæ, d), and assuming
that «´ and œâ are independent each other and from (X, p, Œæ, d), the choice probability Pimj (Œ∏) is given
by                                    ÀÜ
                       Pimj (Œ∏) =        1{Uimj > Uimk ‚àÄk 6= j|X, p, Œæ, di , Œ∏}dF«´ («´)dFœâ (œâ)                                (2)

where F«´ (¬∑) and Fœâ (¬∑) denote the distributions of «´ and œâ, respectively.
   The error term in utility is given by
                                        XK
                       eimj = Œ≤iŒæ Œæmj +        Œ≥ik xmjk Œæmj + Œ≥ip pmj Œæmj + «´imj .
                                                      k=1

When price is in part determined by the omitted attribute, which one can think of as the product-
market demand error, price is endogenous if Œ≤iŒæ 6= 0. For example, if sellers charge higher prices when
their products have more desirable omitted characteristics, the price will be positively correlated
with the demand error, biasing price elasticities upwards. When the interaction terms Œ≥ik 6= 0 or
Œ≥ip 6= 0, the econometric problem becomes more complicated, as there are two or more terms in the
error that are not independent of price.7
     There have been two main approaches in estimation to deal with an unobserved demand attribute
that is correlated with price. We illustrate them with the conditional likelihood function for this
problem, given as

                                                      1 XM XNm XJ
                     log LN (Y |X, p, Œæ, d, Œ∏) =                     Yimj log Pimj (Œ∏),
                                                      N  m=1 i=1 j=0
             P
where N = M     m=1 Nm and Yimj is an indicator variable that equals one if i is observed to choose j
at a market m.8 The first approach is to integrate out the unobserved attribute. This requires one
to specify the distribution of the demand errors conditional on observed characteristics and price -
FŒæ|X,p (Œæ|X, p) - and then integrate them out in the calculation of the choice probability given in (2).
The challenge is in the specification of FŒæ|X,p (Œæ|X, p). It requires that one first know Fp|X,Œæ (p|X, Œæ),
the distribution of the vector of market prices conditional on all observed and unobserved product
characteristics, and then that one be able to recover FŒæ|X,p (Œæ|X, p) from Fp|X,Œæ (p|X, Œæ).
    The second approach is to condition directly on the unobserved vector Œæ by inverting it out
of the demand equations following Berry, Levinsohn and Pakes (1995) (or the generalization of it
in Gandhi, Kim, and Petrin (2011) when Œ≥ik 6= 0 or Œ≥ip 6= 0). While these approaches allow the
   6
      For fixed parameter models (the coefficients do not vary across i), we have Œ∏ = (c‚Ä≤ , Œ≤ ‚Ä≤ , Œ±, Œ≤Œæ , Œ≥ ‚Ä≤ , Œ≥p )‚Ä≤ and for
heterogeneous coefficients models in addition to these (mean) parameters, Œ∏ also includes the standard deviations (œÉ =
(œÉc , œÉ1 , . . . , œÉK , œÉp )) of the random coefficients and other coefficients on demographics or other observed characteristics
of households.
    7
      Here we focus on the endogeneity of price but other observable attributes can also be correlated with the unob-
served demand factor. Indeed the rejection of the price exogeneity in our test can arise due to the endogeneity of
other attributes. We view all of these as an evidence for the endogeneity or the omitted attribute.
    8
      When only the aggregate (market-level) data is available, we replace Yimj with smj , the market share of product
j at a market m and let Pmj (Œ∏) be the choice probability.


                                                               5
researcher to avoid specifying FŒæ|X,p (Œæ|X, p), they are computationally complex to program and
time-consuming, and are also subject to propagated numerical errors from the inversion, which can
lead to non-convergence in the estimation step, as noted recently in the literature (e.g. Dube, Fox,
and Su (2012) and Knittel and Metaxiglou (2008)). We now turn to explaining our computationally
fast and simple tests which inform the researcher if he/she needs to worry about the presence of an
unobserved demand attribute.


3       Using Proxies to Test if Unobserved Attributes Enter Utility
In this section we develop test statistics - Wald and LM tests - that use proxies for the unobserved
attributes to test for their presence in utility. Our testing philosophy is easiest to understand if we
start by treating the unobserved attribute as if it were observed but omitted from the specification.
For expositional convenience we assume that the taste for the omitted attribute is common across
individuals, so Œ≤iŒæ = Œ≤Œæ , Œ≥i = Œ≥, and Œ≥ip = Œ≥p for all i.9
    We refer to our test as the price endogeneity test because the null hypothesis presumes Œæ does
not enter utility either in an additive and non-additive utility manner:

                                        H0 : Œ≤Œæ = 0, Œ≥ = 0, and Œ≥p = 0.                                          (3)

We then deem prices as exogenous if this null hypothesis is true.10 Both the Wald and the LM
formulation of the test of either hypothesis would be consistent under the alternative. In the former
case the terms related to the omitted attribute would be statistically significant in the unconstrained
specification. In the latter case where the constrained model is estimated without the omitted
attribute terms, the residual (Yimj ‚àí Pimj (Œ∏)) from this setup would be significantly correlated with
these omitted terms.11
    Since the omitted attribute is not observed, we propose feasible tests that are analogs to the
aforementioned tests but are instead based on using a proxy for the unobserved attribute. Letting
ŒæÃÉmj denote the proxy for Œæmj , consistency of the tests only requires that - under the alternative -
there is some dependence between Œæmj and ŒæÃÉmj ‚Ä≤ for at least one j ‚Ä≤ , typically for j ‚Ä≤ = j.
    We exploit the source of the endogeneity problem to develop a proxy that should satisfy this
condition. Specifically, letting Zm = (Xm , Z2m ), where Z2m denotes the supply-side factors observ-
able to econometrician, equilibrium prices pmj are in part determined by the demand shocks Œæm
conditional on Zm :
                                       Cov(pmj , Œæmj ‚Ä≤ |Zm ) 6= 0                                    (4)
    9
     Extensions allowing for the heterogeneous coefficients on the omitted attribute and/or the interaction terms are
straightforward using more parameters.
  10
     If one only wanted to test for unobserved attributes that entered utility linearly then this null would become
  1
H0 : Œ≤Œæ = 0.
  11
     For the test of (3) with observed Œæ one can use classical asymptotic tests such as Wald, LM, conditional mean
tests in nonlinear models, see e.g. Newey (1985) and Newey and McFadden (1994).




                                                         6
where the covariance is typically largest for j ‚Ä≤ = j. For our proxies we use the mean-squared
projection residuals of pmj on Zm :

                                            ŒæÃÉmj = pmj ‚àí E[pmj |Zm ],                                              (5)

as ŒæÃÉm = (ŒæÃÉm1 , . . . , ŒæÀúmJ )‚Ä≤ from (5) will not generally be independent of Œæmj .12 In Section 5.1, we
provide a more technical discussion of the conditions under which the tests are consistent.
    Our approach then replaces the unobserved Œæmj in utility with some chosen functions of ŒæÃÉm ,
denoted as vj (ŒæÃÉm ), where vj (¬∑) can be a vector function and v(¬∑) = (v1 (¬∑), . . . , vJ (¬∑))‚Ä≤ . In practice
one can let vj (ŒæÃÉm ) = ŒæÀúmj , or one can include ŒæÀúmj as the leading term when vj (¬∑) is a vector.
We approximate ŒæÃÉmj with ŒæÃÇmj , the difference between pmj and the estimated EÃÇ[pmj |Zm ]: ŒæÀÜmj =
pmj ‚àí EÃÇ[pmj |Zm ], j = 1, . . . , J. We then replace Œæmj with a function of ŒæÀÜm , vj (ŒæÃÇm ) (in the simplest
case we choose vj (ŒæÃÇm ) = ŒæÃÇmj ). We discuss estimation of E[pmj |Zm ] for a variety of data generating
processes in Section 4.

3.1    The Wald test
The Wald test includes the controls directly in the estimated specification. Letting Œª denote the
parameter on the controls, the utility is specified for estimation as
               XK                                       XK
 UÃÉimj = cij +      xmjk Œ≤ik ‚àí Œ±i pmj + Œª‚Ä≤j vj (ŒæÃÉm ) +      ek‚Ä≤ vj (ŒæÃÉm )xmjk + Œ≥
                                                             Œ≥                   ep‚Ä≤ vj (ŒæÃÉm )pmj + «´imj , (6)
                    k=1                                              k=1

with vj (ŒæÃÉm ) as the control functions. Under the null hypothesis of exogenous prices the coefficients
Œª = (Œª‚Ä≤1 , . . . , Œª‚Ä≤J )‚Ä≤ ,13 Œ≥    Œ≥1‚Ä≤ , . . . , Œ≥
                              e = (e             eK‚Ä≤ )‚Ä≤ , and Œ≥
                                                              ep are equal to zero because ŒæÃÉm does not affect the
demand given (xm , pm , di ). Therefore we test for the price endogeneity due to the unobserved
attribute by testing the null hypotheses

                                          e 0 : Œª = 0, Œ≥e = 0, and Œ≥ep =0.
                                          H                                                                        (7)

This is the feasible version of the test in (3).
    For the formulation of the Wald statistic let Œ∏e = (œë‚Ä≤ , Œª‚Ä≤ , Œ≥
                                                                  e‚Ä≤ , Œ≥ep‚Ä≤ )‚Ä≤ , where œë denotes all parameters
excluding (Œª‚Ä≤ , Œ≥    ep‚Ä≤ )‚Ä≤ , and write the sample ML objective function that is used to estimate Œ∏e as
                e‚Ä≤ , Œ≥
                                         XM       XNm XJ
                                   e =
                     log LN (ŒæÃÉm , Œ∏)                                                        e
                                                                     Yimj log Pimj (v(ŒæÃÉm ), Œ∏)/N .
                                            m=1      i=1       j=0

                                                     b
Then we obtain the unconstrained parameter estimates Œ∏eU that solve the sample analog equations
                              b                                                b
              ‚àÇ log LN (ŒæÃÇm , Œ∏eU )   1 XM XNm XJ         ‚àÇ log Pimj (v(ŒæÃÇm ), Œ∏eU )
                                    ‚â°                Yimj                            =0
                     ‚àÇ Œ∏e             N  m=1 i=1 j=0                ‚àÇ Œ∏e
  12
      If the dependence of pmj on Œæm conditional on Zm is not reflected in their conditional covariance - if they are
related by higher moments - then the test using the simple proxy (control) ŒæÀúm may not reject the null even when
the price is endogenous. If one suspected this were there are alternative ways of obtaining the controls robust to this
situation (e.g., Matzkin (2003), Altonji and Matzkin (2005), and Imbens and Newey (2003)).
   13
      One can restrict Œª1 = . . . = ŒªJ depending on applications.


                                                           7
where the conditional choice probability Pimj (v(ŒæÃÇm ), Œ∏) e is obtained based on the specification of
                                                                                                        ‚Ä≤ ‚Ä≤ ‚Ä≤
                                                                                                b‚Ä≤ , Œ≥b
utility in (6) but with v(ŒæÃÇm ) replacing v(ŒæÃÉm ). The Wald tests ask whether the coefficients (Œª        b
                                                                                                      e ,Œ≥
                                                                                                         ep )
      b
from Œ∏eU are statistically different from zero. The test statistic is
                                                        ‚Ä≤ ‚Ä≤    ‚àí1 b‚Ä≤ b‚Ä≤ b‚Ä≤ ‚Ä≤
                                                      b
                                                 b‚Ä≤ , Œ≥
                                      TeM,N = N (Œª       b
                                                         ep )VeM,N
                                                      e ,Œ≥              e ,Œ≥
                                                                   (Œª , Œ≥  ep )

where VeM,N is a consistent estimator of the asymptotic variance matrix of the ML estimator
        ‚Ä≤ ‚Ä≤ ‚Ä≤
      b
      e , Œ≥b
 b‚Ä≤ , Œ≥
(Œª         ep ) that accounts for the estimated controls. TeM,N follows the asymptotic œá2 distribu-
tion with the degree of freedom equal to the dimension of (Œª‚Ä≤ , Œ≥         ep‚Ä≤ )‚Ä≤ . We derive the asymptotic
                                                                     e‚Ä≤ , Œ≥
distribution of the test statistics in Section 5. For definition of VeM,N see Theorem 5.1.
     The Wald approach is attractive for three reasons. The test statistic is easy to compute, requir-
ing no additional calculation beyond standard likelihood function output, and significance of the
coefficients is equivalent to rejecting price exogeneity. The resulting estimates may be suggestive of
the direction and magnitude of the bias arising from the price endogeneity. Finally, the point esti-
mates can be used as starting values for the more complicated correction approaches. Good starting
values can be helpful when the objective function is non-linear in parameters, there are a large num-
ber of parameters, or there are possibly multiple local maxima, which are often characteristics of
these alternative approaches.

3.2    The LM test: Constrained Approach
The LM test imposes Œª = 0, Œ≥        e = 0, and Œ≥ ep = 0 during estimation and then tests to see if the score
function, which is the derivative of the likelihood with respect to the parameter Œ∏-       e evaluated at the
constrained estimates -, is large in absolute value. From a practical standpoint the LM test is useful
because it does estimation in the constrained case, which can reduce the computational cost when
the number of parameters being tested is large. We start with the test for the price endogeneity
and then develop the test for non-additivity.
    Again let Œ∏e = (œë‚Ä≤ , Œª‚Ä≤ , Œ≥e‚Ä≤ , Œ≥
                                    ep‚Ä≤ )‚Ä≤ and let D = dim((Œª‚Ä≤ , Œ≥    ep‚Ä≤ )). Then let Œ∏eR be the constrained
                                                                 e‚Ä≤ , Œ≥
parameter Œ∏eR = (œë‚Ä≤ , 0‚Ä≤D )‚Ä≤ where 0D denotes a D √ó 1 vector of zeros. The maximum likelihood
estimator in the constrained case uses the sample analogs to the D population moments
                                     XJ                   ‚àÇ log Pimj (v(ŒæÃÉm ), Œ∏eR )
                                   E[              Yimj                              ] = 0.
                                           j=0                     ‚àÇœë
                                    b
The constrained parameter estimates Œ∏eR = (œëÃÇ‚Ä≤ , 0‚Ä≤D )‚Ä≤ solve the sample analog equations
                             b                                                b
             ‚àÇ log LN (ŒæÃÇm , Œ∏eR )   1 XM XNm XJ         ‚àÇ log Pimj (v(ŒæÃÇm ), Œ∏eR )
                                   ‚â°                Yimj                            = 0.                            (8)
                    ‚àÇœë               N  m=1 i=1 0=1               ‚àÇœë
The LM test is based on the average value of the derivative of the likelihood with respect to Œ∏e
evaluated at the constrained parameter estimates:
                               e
                ‚àÇ log LN (ŒæÃÇm ,Œ∏)              1   PM       PNm PJ                                   e
                                                                                 ‚àÇ log Pimj (v(ŒæÃÇm ),Œ∏)
                                           ‚â°        m=1        i=1    j=0 Yimj                                  .
                        e
                       ‚àÇŒ∏         e b
                                  Œ∏= Œ∏eR       N                                          ‚àÇŒ∏e             b
                                                                                                        Œ∏=Œ∏eR


                                                                8
                                                                b
                                                 ‚àÇ log LN (ŒæÃÇm ,Œ∏eR )                        e
                                                                              ‚àÇ log LN (ŒæÃÇm ,Œ∏)
With abuse of notation, we often write                    e             =                       e b
                                                                                                         and also others similarly.
                                                        ‚àÇŒ∏                           ‚àÇ Œ∏e       Œ∏= Œ∏eR
   Now construct a nonrandom matrix H (with the number of rows equal to the dimension of
(Œª‚Ä≤ , Œ≥     such that H Œ∏e = 0 becomes the null hypothesis of the price exogeneity (7). Then by
      e‚Ä≤ , Œ≥ep‚Ä≤ )‚Ä≤ )
                       b               e = ‚àí ‚àÇ log LN (ŒæÃÇm ,Œ∏ÃÉ) . Then the LM test statistic for price
construction we have H Œ∏eR = 0. Let Œì(
                                    b Œ∏)
                                                                      e Œ∏e‚Ä≤
                                                                    ‚àÇ Œ∏‚àÇ
endogeneity is given by
                                             b                                                    b
                  g          ‚àÇ log LN (ŒæÃÇm , Œ∏eR ) b be ‚àí1 ‚Ä≤ e ‚àí1 be      b be ‚àí1 ‚àÇ log LN (ŒæÃÇm , Œ∏eR )
                  LM M,N = N                       Œì(Œ∏ R ) H VM,N (Œ∏ R )H Œì(Œ∏R )
                                    ‚àÇ Œ∏e‚Ä≤                                                ‚àÇ Œ∏e
             b                                                                   ‚àö                             be
                                                                                     bb
where VeM,N (Œ∏eR ) is a consistent estimator of the asymptotic variance matrix of NH Œì(Œ∏eR )‚àí1 ‚àÇ log LN (eŒæÃÇm ,Œ∏R ) .
                                                                                                      ‚àÇŒ∏
   Under the null hypothesis of (7), LM  g M,N follows the same asymptotic œá2 distribution with the
corresponding Wald test statistic. See Theorem 5.2 below for this result and also for the construction
          b
of VeM,N (Œ∏eR ).


4       Proxy Estimation Across Data Generating Processes
The purpose of estimating E[pmj |Zm ] is to recover the proxy ŒæÀÜmj = pmj ‚àí EÃÇ[pmj |Zm ]. This step can
be done by least squares using polynomials of Zm as regressors or by nonparametric series estimation
(e.g. Newey (1997)). For the Wald test to have power vj (ŒæÃÇm ) cannot be perfectly collinear with
Xmj and pmj . For the LM test to have power the score associated with the coefficients on vj (ŒæÃÇm )
should not be perfectly collinear with the scores associated with the coefficients on Xmj and pmj .
A sufficient condition is that a variable excluded from Xmj in the instruments set is correlated with
prices (e.g., either characteristics of other products if they are assumed to be exogenous or other
observed supply-side factors).
    The power of the test is increasing in Cov(Œæmj , vj (ŒæÃÇm )), which is determined by the variation that
is used to estimate E[pmj |Zm ] and the restrictions placed on E[pmj |Zm ] during estimation. This
variation comes from one or more of the following sources: within market at a given time, across
markets at a given time, or within/across markets over time. To make the discussion concrete,
we illustrate specification and estimation of E[pmj |Zm ] with recent demand applications that make
use of different sources of variation: Goolsbee and Petrin (2004), who look at cable and satellite
television demand, Berry, Levinsohn, and Pakes (1995), who look at automobiles, and Chintagunta,
Dube, and Goh (2005), who look at margarine.
    In Goolsbee and Petrin (2004), almost 30,000 households are observed in over 300 geographically
distinct television markets, and four alternatives are available to households in every market: (1)
antenna only, (2) expanded basic cable service, (3) expanded basic cable with a premium service
added, such as HBO, and (4) satellite dish. The price endogeneity problem arises because unobserved
factors like service or average channel quality are correlated with price but not observed by the
authors. With over 300 variants of each type of product, e.g. expanded basic cable, one can
separately estimate E[pmj |Zm ] for each product using the cross-market variation (allowing the

                                                               9
coefficients of each function to differ for each type of product). Zm includes Xmj and may include
all of the other characteristics of other products in the market, and any other relevant demand and
cost factors.
     Berry, Levinsohn, and Pakes (1995) observe over 100 market-level observations on prices, quan-
tities, and characteristics of automobiles sold in the U.S. for every year from 1971 to 1990. The price
endogeneity problem arises because, with only five included characteristics, additional unobserved
quality (e.g.) is correlated with price. With the automobile data, very few observations are avail-
able on the same nameplate (i.e. the same product) over time, because cars enter, exit, and change
quickly. Unlike the television case, this means some restrictions on E[pmj | Zm ] across vehicles will
be necessary. Some possibilities include restricting parameters to be the same across: all products
and all years, all products within the same year, similar products within a year, or similar products
across years.
     A second difference with the television case is that the number of potential arguments entering
E[ pmj | Zm ] may be quite large; in one extreme case, every product‚Äôs characteristics may affect
every product‚Äôs price. In a multi-product multi-competitor market Pakes (1994) suggests a parsi-
monious approach that includes three regressors for each characteristic: the characteristic itself, the
sum of the characteristic across own-firm products (excluding that product), and the sum of the
characteristic across rival firm products.
     Chintagunta, Dube, and Goh (2005) (CDG) observe weekly purchase histories of 992 households
between January 1993 and March 1995 collected using checkout-counter scanners. The market for
margarine is similar to that for television in the sense that there are only four choices in their
data: Blue Bonnet, I Can‚Äôt Believe It‚Äôs Not Butter, Parkay, and Shedd‚Äôs. However, unlike television
demand, the physical characteristics of the products are not changing over time. Instead, the price
endogeneity problem arises because weekly retail prices covary with demand-shifting marketing-mix
variables which may not be observed by the econometrician, including: whether the product is
on display, whether it is featured, changes in its shelf-space, the availability of coupons (in-store
or not), or promotions in complementary or substitute categories. CDG observe wholesale prices,
which affect retail prices but do not enter into consumer utility conditional on the retail price. Thus
one could use the residual from the regression of product‚Äôs retail price at time t on an intercept
and its wholesale price at time t. If Cov(pmj , Œæmj |Zm ) > 0, a large residual is suggestive of more
marketing-mix activities.


5    Asymptotic Distributions of Test Statistics
In this section we derive the asymptotic distributions of the Wald test and the LM test statistics.
Our asymptotic experiment is mainly in the number of markets M as M ‚Üí ‚àû while Nm (the
number of individuals in each market) can be finite or tend to infinity. In both cases note, however,
           P
that N = M    m=1 Nm also tends to infinity as M ‚Üí ‚àû. We derive the asymptotic distribution of




                                                  10
the Wald test statistic accounting for the estimated controls.14 The controls ŒæÃÇm are obtained from
regressions of Pm on Zm as
                                 ŒæÀúmj = pmj ‚àí Z‚Ä≤ œÄj , j = 1, . . . , J
                                                             m

where Zm = Zm or Zm can also include higher order terms of Zm . We can also extend this
(and results below) to nonparametric series estimation but the estimated standard errors under the
parametric regression will be equivalent to those that would be obtained under the nonparamet-
ric regression given approximation anyway (e.g. Newey (1997)), so we present our results in the
parametric flexible regression context.
               ‚àö                   1 PM        ‚Ä≤ ‚àí1 ‚àö1
                                                        PM      ‚Ä≤ ŒæÃÉ
                                                                                   ‚àö
    Note that M (b  œÄj ‚àí œÄj0 ) = ( M  m=1 Zm Zm )    M    m=1 Z m    mj and we let      œÄj ‚àí œÄj0 ) ‚Üíd
                                                                                     M (b
Ãüj where (Ãü1 , . . . , ÃüJ ) follow a joint normal distribution. We write ŒæÃÉmj (œÄ) = pmj ‚àí Z‚Ä≤m œÄj , ŒæÃÇmj =
ŒæÃÉmj (œÄÃÇ), and ŒæÃÉmj = ŒæÀúmj (œÄ0 ) for j = 1, . . . , J.
     The regularity conditions below that validate the asymptotic distributions and the consistency
of the variance matrix estimators are fairly standard (see Newey and McFadden (1994) for example).
We collect a set of sufficient conditions that render the asymptotic œá2 distribution of TeM,N here and
                                                                       p
also that of LMg M,N . We let œÄ = (œÄ ‚Ä≤ , . . . , œÄ ‚Ä≤ )‚Ä≤ and let ||A|| = tr(A‚Ä≤ A) for a matrix or a vector A.
                                         1           J
                                1 PM              ‚Ä≤                        1 PM       2      ‚Ä≤
Also let Œ£ZZ = plimM ‚Üí‚àû M            m=1 Zm Zm and Œ£ŒæÃÉ 2 ZZ = plimM ‚Üí‚àû M        m=1 ŒæÃÉmj Zm Zm .
                                                                 j



Assumption 5.1 (i) {pm , Zm }m‚â§M are independently distributed across m and {Yim1 , . . . , YimJ , di }m‚â§M
                                                                                                       i‚â§Nm
are independently and identically distributed across i and are independently distributed across m;
(ii) E[||ŒæÃÉm ||4 ] < ‚àû and E[||Zm ||4 ] < ‚àû for all m; (iii) Œ£ZZ is nonsingular.
                                 ‚àö
   Then under Assumption 5.1 M (b     œÄj ‚àí œÄj0 ) ‚Üíd Ãüj ‚àº N (0, Œ£‚àí1           ‚àí1
                                                                ZZ Œ£ŒæÃÉj2 ZZ Œ£ZZ ) for all j by the
Lindeberg-Feller CLT. We let Œ∏e0 denote the true value of Œ∏.
                                                          e

                              b              b
Assumption 5.2 (i)(a) Œ∏eU ‚Üíp Œ∏e0 , (b) Œ∏eR ‚Üíp Œ∏e0 under the null (7); (ii) Œ∏e0 is in the interior of Œò;             e
                     e is twice continuously differentiable in Œ∏e on some neighborhood Œò
(iii) Pimj (v(ŒæÃÉm ), Œ∏)                                                                          e 0 of Œ∏e0 (Œò
                                                                                                             e 0 ‚äÇ Œò);
                                                                                                                   e
                                                           ‚àÇ 2 log P     (v(ŒæÃÉ  (œÄ)), e
                                                                                      Œ∏)
                     e is Lipschitz in ŒæÃÉm for all j; (v)
(iv) Pimj (v(ŒæÃÉm ), Œ∏)                                               imj      m
                                                                                         is continuous in (Œ∏, e œÄ) for
                                                                              e Œ∏e‚Ä≤
                                                                            ‚àÇ Œ∏‚àÇ
                                            ‚Ä≤ , p‚Ä≤ , ŒæÀú‚Ä≤ , d )‚Ä≤ and E[ ‚àÇ log LN (Œæem ,Œ∏e0 ) ] is nonsingular
                                    fmi = (Xm
all w ‚àà W, W denotes the support of W            m m i                        e e‚Ä≤                 ‚àÇ Œ∏‚àÇ Œ∏
                                                                                 e
                                                          ‚àÇ log Pimj (v(ŒæÃÉm (œÄ)),Œ∏)
for all M large enough; (vi) E[supŒ∏‚àà         e 0 ,œÄ‚ààŒ†0 ||
                                           e Œò                       e Œ∏e‚Ä≤
                                                                   ‚àÇ Œ∏‚àÇ
                                                                                    ||] < ‚àû for all j and m where Œ†0
                                                                                                e 4
                                                                        ‚àÇ log Pimj (v(ŒæÃÉm (œÄ)),Œ∏)
denotes some neighborhood of œÄ0 ; (vii) E[supŒ∏‚àà        e Œò e 0 ,œÄ‚ààŒ†0 ||            ‚àÇŒ∏e            || ] < ‚àû for all j and m;
        2                     e
       ‚àÇ log Pimj (v(ŒæÃÉm (œÄ)),Œ∏)                                                                          2                 e 2
(viii)                                              e œÄ) for all w ‚àà W and E[ sup || ‚àÇ log Pimj (v(ŒæÃÉm (œÄ)),Œ∏)
                                 is continuous in (Œ∏,                                                                        || ]   <
               e
             ‚àÇ Œ∏‚àÇvj ‚Ä≤ (ŒæÃÉm )                                                                                  e
                                                                                                            ‚àÇ Œ∏‚àÇvj ‚Ä≤ (ŒæÃÉm )
                                                                                         e Œò
                                                                                         Œ∏‚àà e 0 ,œÄ‚ààŒ†0
‚àû for all j, j ‚Ä≤ , and m.

    To obtain the asymptotic distribution of the Wald test statistic we first derive the asymptotic
distribution of the unconstrained ML estimator that uses the estimated controls.
  14
     Our asymptotic distributions here do not include simulation errors to approximate (e.g.) the distribution of
random coefficients. If one uses simulations to approximate the distribution of random coefficients, one can add an
additional variance term that arises from the simulation as in BLP.



                                                             11
Lemma 5.1 Suppose Assumptions 5.1 and 5.2 hold.
      ‚àö b                                                                                       ‚àÇ log LN (ŒæÃÉm ,Œ∏e0 )
Then M (Œ∏eU ‚àí Œ∏e0 ) ‚Üíd N (0, Œì‚àí1              M          ‚àí1
                               0 (Œì0 ¬∑limM ‚Üí‚àû N +V1 )Œì0 ) where Œì0 = limM ‚Üí‚àû E[‚àí                        e Œ∏e‚Ä≤        ],
     P                                                                                                ‚àÇ Œ∏‚àÇ
                            ‚Ä≤                             N,M e Àú
V1 = j,k Œõ0j Cov(Ãüj , Ãük )Œõ0k , and Œõ0j = limM ‚Üí‚àû E[Œõj (Œ∏0 , Œæm )]
                                                                              e ‚àÇv (ŒæÃÉ ) ‚àÇ ŒæÃÉ
           e ŒæÀúm ) ‚â° PM PNm PJ‚Ä≤‚Ä≤ Y ‚Ä≤‚Ä≤ PJ‚Ä≤
                                                     ‚àÇ 2 log Pimj ‚Ä≤‚Ä≤ (v(ŒæÃÉm ),Œ∏)
with ŒõN,M                                                                         j‚Ä≤ m       mj
      j   (Œ∏,         m=1     i=1  j =0   imj   j =1         e                   ‚àÇ ŒæÃÉ     ‚àÇœÄj /N.
                                                                    ‚àÇ Œ∏‚àÇvj ‚Ä≤ (ŒæÃÉm )      mj


See Appendix A.1 for the proof.
                                                                                                     b
    To obtain a consistent estimator of the variance matrix, we use Œì      b = ‚àí ‚àÇ log LN (ŒæÃÇm ,Œ∏eU ) for Œì0 and
                                                                                         e Œ∏e‚Ä≤
                                                                                       ‚àÇ Œ∏‚àÇ
     P      N,M   b                    N,M   b
Vb1 = j,k Œõj (Œ∏eU , ŒæÀÜm )Cov(Ãü
                         d j , Ãük )Œõ
                                       k    (Œ∏eU , ŒæÀÜm ) for V1 where Cov(Ãü
                                                        ‚Ä≤                 d j , Ãük ) is obtained from

                      XM                    X                               X
                                                     M                             M
     d
     Cov(Ãüj , Ãük ) = (            ‚Ä≤
                              Zm Zm /M ) ‚àí1                             ‚Ä≤
                                                          ŒæÃÇmj ŒæÃÇmk Zm Zm /M (           Zm Z‚Ä≤m /M )‚àí1 .
                             m=1                         m=1                               m=1

When one assumes homoskedasticity across m and zero correlations of ŒæÃÉmj across products j 6= k,
                       P
V1 can simplify to V1 = Jj=1 Œõ0j (Œ£ZZ )‚àí1 E[ŒæÃÉmj
                                              2 ]Œõ‚Ä≤ .
                                                  0j
   Next we derive the asymptotic distribution of the Wald test statistic.

Theorem 5.1 Suppose Assumptions 5.1 and 5.2 (i)(a) and (ii)-(viii) hold. Then for the Wald
                                    ‚Ä≤ ‚Ä≤    ‚àí1 b‚Ä≤ b‚Ä≤ b‚Ä≤ ‚Ä≤
statistic we have TeM,N = N (Œª    b
                             b‚Ä≤ , Œ≥  b
                                     ep )VeM,N
                                  e ,Œ≥                 ep ) ‚Üíd œá2 (dim((Œª‚Ä≤ , Œ≥
                                                    e ,Œ≥
                                               (Œª , Œ≥                             ep‚Ä≤ )‚Ä≤ )) with VeM,N = H Œì
                                                                             e‚Ä≤ , Œ≥                        b‚àí1 (Œì+
                                                                                                                b
Vb1 )Œì
   N
   M
       b H where
        ‚àí1   ‚Ä≤


                                      be
                b = ‚àí ‚àÇ log LN (ŒæÃÇm , Œ∏ U ) ,
                Œì
                              e Œ∏e‚Ä≤
                            ‚àÇ Œ∏‚àÇ
                     X N,M
          Vb1 (Œ∏ÃÉ) =                    d j , Ãük )ŒõN,M (Œ∏ÃÉ, ŒæÀÜm )‚Ä≤ , VÃÇ1 = Vb1 (b
                        Œõj (Œ∏ÃÉ, ŒæÀÜm )Cov(Ãü                                      Œ∏eU ),
                                                   k
                     j,k
                   XM XNm XJ                      XJ ‚àÇ 2 log Pimj ‚Ä≤‚Ä≤ (v(ŒæÃÉm ), Œ∏) e ‚àÇvj ‚Ä≤ (ŒæÃÉm ) ‚àÇ ŒæÃÉmj
 ŒõN,M  e ŒæÃÉm ) = 1
      (Œ∏,                                Y imj ‚Ä≤‚Ä≤                                                       , and
  j                                                                e j ‚Ä≤ (ŒæÃÉm )
                 N   m=1   i=1   j ‚Ä≤‚Ä≤ =0             j ‚Ä≤ =1      ‚àÇ Œ∏‚àÇv               ‚àÇ ŒæÃÉmj ‚àÇœÄj
                  XM                 X                                X
                                            M                                   M
 d
 Cov(Ãüj , Ãük ) = (        ‚Ä≤
                      Zm Zm /M )‚àí1                              ‚Ä≤
                                                  ŒæÃÇmj ŒæÃÇmk Zm Zm /M (             Zm Z‚Ä≤m /M )‚àí1 .
                           m=1                       m=1                               m=1


   Proof. Note that we use the nonrandom matrix H such that H Œ∏e = 0 represents the null
hypothesis of the price exogeneity (7). Then with the variance-covariance matrix estimator of
‚àö     b
  N H Œ∏eU as VeM,N = H Œì
                       b‚àí1 (Œì
                            b + Vb1 N )Œì
                                       b ‚àí1 H ‚Ä≤ , we obtain
                                         M
                                                                                   ‚àí1
                 b ‚Ä≤ b‚Ä≤ b‚Ä≤ e ‚àí1 b‚Ä≤ b‚Ä≤ b‚Ä≤ ‚Ä≤             be ‚Ä≤     ‚àí1 b M                    b
       e             e ,Œ≥
       TM,N = N (Œª , Œ≥  ep )VM,N (Œª , Œ≥                       b
                                         ep ) = M ¬∑ (H Œ∏U ) H Œì (Œì
                                      e ,Œ≥                               b   b ‚àí1 ‚Ä≤
                                                                       + V1 )Œì H        H Œ∏eU .
                                                                     N

Therefore, by the continuous mapping theorem, TeM,N ‚Üíd œá2 with the degree of freedom equal
to the dimension of (Œª‚Ä≤ , Œ≥
                          e‚Ä≤ , Œ≥
                               ep‚Ä≤ )‚Ä≤ (i.e. the number of rows in H) because Lemma 5.1, Œì          b ‚Üíp Œì 0 ,
                               ‚àö       n                            o ‚àí1/2   b
and Vb1 ‚Üíp V1 implies Z ‚â° M H Œì                 b M + Vb1 )Œì
                                           b‚àí1 (Œì
                                                  N
                                                           b ‚àí1 H ‚Ä≤        H Œ∏eU ‚Üíd N (0, I) and TeM,N is the
quadratic function of Z.
    Next we show that the LM test statistic has the same asymptotic distribution of the correspond-
ing Wald test statistic.

                                                          12
Theorem 5.2 Suppose Assumptions 5.1 and 5.2(i)(b) and (ii)-(viii) hold. Then for the LM statistic
we have
                           b                                                    b
g          ‚àÇ log LN (ŒæÃÇm , Œ∏eR ) b be ‚àí1 ‚Ä≤ e ‚àí1 be      b be ‚àí1 ‚àÇ log LN (ŒæÃÇm , Œ∏eR )
LM M,N = N                       Œì(Œ∏ R ) H VM,N (Œ∏ R )H Œì(Œ∏R )                        ‚Üíd œá2 (dim((Œª‚Ä≤ , Œ≥
                                                                                                       e‚Ä≤ , Œ≥
                                                                                                            ep‚Ä≤ )‚Ä≤ ))
                  ‚àÇ Œ∏e‚Ä≤                                                ‚àÇ Œ∏e
             b         bb         bb             b N b be ‚àí1 ‚Ä≤
where VeM,N (Œ∏eR ) = H Œì(Œ∏eR )‚àí1 (Œì(Œ∏eR ) + Vb1 (Œ∏eR ) M )Œì(Œ∏ R ) H .

    See Appendix A.2 for the proof.

5.1     Test Consistency
Here we further discuss the test consistency of price endogeneity. The Wald test is consistent as long
                      ‚Ä≤ ‚Ä≤ ‚Ä≤
as plimM ‚Üí‚àû (Œªb‚Ä≤ , Œ≥b  b
                       ep ) 6= 0 under the alternative against (7) i.e. plimM ‚Üí‚àû TeM,N = ‚àû under the
                    e ,Œ≥
alternative. Therefore the Wald test is consistent under the alternative as long as the unobserved
attribute that is correlated with price enters utility and the proxy is correlated with the unobserved
attribute.
    The LM test is more involved. To understand the consistency of the LM test, we first need to re-
                                                  P            e = 1 implies PJ Pimj (¬∑, Œ∏)                      e
                                                                                                 e ‚àÇ log Pimj (¬∑,Œ∏)
formulate the LM statistic as below. Note that Jj=0 Pimj (¬∑, Œ∏)                   j=0                      e        =
                                                                                                          ‚àÇŒ∏
                                       e       P
                                               M NP m PJ                                  e
                                                                          e ‚àÇ log Pimj (¬∑,Œ∏)
0. We therefore can write ‚àÇ log LeN (¬∑,Œ∏) = N1           (Yimj ‚àí Pimj (¬∑, Œ∏))       e        . Define
                                     ‚àÇŒ∏             m=1 i=1 j=0                                      ‚àÇŒ∏


                                                  e = Yimj ‚àí Pimj (¬∑, Œ∏)
                                            uimj (Œ∏)                  e

                   b                               b
and also let uimj (Œ∏eR ) = Yimj ‚àí Pimj (v(ŒæÃÇm ), Œ∏eR ) with abuse of notation. Then                          the LM test statistic
can be written as
                                                                            !
                           P
                           M NP m P
                                  J                       be
                                                                       b
                 N 1
                                     ‚àÇ log P imj (v(ŒæÃÇm ), Œ∏ R )              bb
                                                                 uimj (Œ∏eR ) Œì(Œ∏eR )‚àí1 H ‚Ä≤ Ve ‚àí1
                                                                                                         be     b be ‚àí1
                          N                        ‚àÇ Œ∏e‚Ä≤                                            M,N (Œ∏ R )H Œì(Œ∏ R )
      g M,N =                 m=1 i=1 j=0
      LM                                                                                             !
                                                  P P
                                                  M N m P
                                                        J
                                                                      b ‚àÇ log Pimj (v(ŒæÃÇm ),bŒ∏eR )
                                       √ó    1
                                            N                   uimj (Œ∏eR )         e                    .
                                                m=1 i=1 j=0                               ‚àÇŒ∏


                                                             ‚àÇ log Pimj (v(ŒæÃÉm ),Œ∏e0 )
Recall that Œ∏e0 denotes the true value of Œ∏.
                                          e Then                                         must be uncorrelated with uimj (Œ∏e0 )
                                                                      ‚àÇ Œ∏e
because Œ∏e0 solves the moment condition
                                                       M Nm X
                                                            J
                        ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )        1 XX                 ‚àÇ log Pimj (v(ŒæÃÉm ), Œ∏e0 )
               0 = E[                         ] = E[          uimj (Œ∏e0 )                            ]                         (9)
                               ‚àÇ Œ∏e                  N     m=1 i=1 j=0             ‚àÇ Œ∏e

and this is not equal to zero for any Œ∏e 6= Œ∏e0 . Therefore the LM statistic looks at the covariance
                              b
          ‚àÇ log Pimj (v(ŒæÃÇm ),Œ∏eR )
between               e             and uimj (Œ∏eÃÇR ) to detect the violation of this moment condition, which
                   ‚àÇŒ∏
plays the role of an evidence against the null hypothesis.
                                P                         e
                                      ‚àÇ log Pimj (v(ŒæÃÉm ),Œ∏)                                 e = 1 P P E[him (v(ŒæÃÉm ), Œ∏)].
                                                                   e and let E[him (v(ŒæÃÉm ), Œ∏)]
                                                                                                   M Nm
                                                                                                                       e
    Let him (v(ŒæÃÉm ), Œ∏ÃÉ) = Jj=0                 e           uimj (Œ∏)                            N
                                             ‚àÇŒ∏                                                                  m=1 i=1
                                e = 0 when Œ∏e = Œ∏e0 , so the LM test uses him (v(ŒæÃÉm ), Œ∏ÃÉ) to detect a
Again note that E[him (v(ŒæÃÉm ), Œ∏)]

                                                              13
violation of Œ∏e = Œ∏e0 , which is equivalent to the violation of the population moment condition (9).
                                   be
Further denote Œ∏eR A = plim
                             M ‚Üí‚àû Œ∏ R under the alternative hypothesis against (7). Then, the main
substantive condition for test consistency as we show in Theorem A.1 in Appendix A.3 is that we
require
                                      lim ||E[him (v(ŒæÃÉm ), Œ∏eR
                                                              A
                                                                     6 0
                                                                )]|| =                         (10)
                                            M ‚Üí‚àû

for some function v(ŒæÃÉm ) when prices are endogenous (i.e., the alternative hypothesis is true).15 This
means that for the test consistency v(ŒæÃÉm ) should be chosen such that it can detect the nonzero
                     ‚àÇ log Pimj (v(ŒæÃÉm ),Œ∏eR
                                           A)
correlation between                           and uimj (Œ∏eA ) under the alternative hypothesis. Theorem A.1
                                                                  R
                                    ‚àÇ Œ∏e
in Appendix A.3 spells out the exact conditions under which the LM test is consistent.
Remark 1 To further understand how the LM test works, without loss of generality, let the 0-th
good                                                                                     e =
  PJbe the outside good (i.e., Œæm0 = 0, xm0 = 0, pm0 = 0, and Uim0 = «´im0 ). From uim0 (Œ∏)
            e it follows that
‚àí j=1 uimj (Œ∏),
 XJ                        e
            ‚àÇ log Pimj (¬∑, Œ∏)            XJ ‚àÇ log Pimj (¬∑, Œ∏)
                                                           e             XJ ‚àÇ log Pim0 (¬∑, Œ∏)
                                                                                           e
                                    e =
                              uimj (Œ∏)                              e ‚àí
                                                              uimj (Œ∏)                              e
                                                                                              uimj (Œ∏)
      j=0          ‚àÇ Œ∏e                   j=1      ‚àÇ Œ∏e                     j=1     ‚àÇ Œ∏e
                                         XJ ‚àÇ log(Pimj (¬∑, Œ∏)/P
                                                            e im0 (¬∑, Œ∏))
                                                                       e
                                       =                                        e
                                                                          uimj (Œ∏).
                                          j=1             ‚àÇ Œ∏e
Define the part of the mean utility for the product j that is common across consumers as Œ¥mj (ŒæÃÉm ).
Then in particular we have
XJ                               b                 J
                                                   X                  b                    b
          ‚àÇ log Pimj (v(ŒæÃÇm ), Œ∏eR )       be        ‚àÇ{Pimj (v(ŒæÃÇm ), Œ∏eR )/Pim0 (v(ŒæÃÇm ), Œ∏eR )}/‚àÇŒ¥mj
                                     uimj (Œ∏ R ) =                                                                          (11)
    j=0        ‚àÇ(Œª‚Ä≤ , Œ≥
                      e‚Ä≤ , Œ≥
                           ep‚Ä≤ )                                         b                    b
                                                    j=1  P (v(ŒæÃÇ ), Œ∏e )/P (v(ŒæÃÇ ), Œ∏e )
                                                                      imj   m       R   im0      m        R
                                                                                                                              b
                                                 √ó {vj (ŒæÃÇm ) , xmj1 vj (ŒæÃÇm ) , . . . , xmjK vj (ŒæÃÇm ) , pmj v(ŒæÃÇm )‚Ä≤ }uimj (Œ∏eR ),
                                                              ‚Ä≤                 ‚Ä≤                     ‚Ä≤


which is the sum of the products of the omitted attributes (including interaction terms) and the
residuals scaled by ‚Äúhazard rates‚Äù (normalized w.r.t. the outside good) of purchases with respect to
the mean utilities. Therefore the LM test rejects if the omitted attribute can significantly account for
any of the purchase decision residual (i.e., if their correlation is significant). Indeed (11) simplifies to
PJ ‚àÇ log Pimj (v(ŒæÃÇm ),bŒ∏eR )       b        P                                                                                 b
   j=0     ‚àÇ(Œª‚Ä≤ ,e
                 Œ≥ ‚Ä≤ ,e
                      Œ≥p‚Ä≤ )   uimj (Œ∏eR ) = Jj=1 {vj (ŒæÃÇm )‚Ä≤ , xmj1 vj (ŒæÃÇm )‚Ä≤ , . . . , xmjK vj (ŒæÃÇm )‚Ä≤ , pmj v(ŒæÃÇm )‚Ä≤ }uimj (Œ∏eR )
for the multinomial choice logit model (i.e., «´ follows the type I extreme value distribution) without
random coefficients. Therefore in the simple logit case the LM test seeks the correlation between
                                                                                                b
the controls {vj (ŒæÃÇm )‚Ä≤ , xmj1 vj (ŒæÃÇm )‚Ä≤ , . . . , xmjK vj (ŒæÃÇm )‚Ä≤ , pmj v(ŒæÃÇm )‚Ä≤ } and uimj (Œ∏eR ) to detect a violation
of the moment condition (9).


6     Monte Carlo Experiments
We construct Monte Carlo data for different situations with an unobserved attribute correlated with
price. A product is sold in each of several markets and its attributes and price vary by markets.
   15
      Note that in (10) we allow for non-identically distributed data (e.g., the distributions of prices and/or
the unobserved attributes are different across markets). If the data is iid across i and m, (10) simplifies to
||E[him (v(ŒæÀúm ), Œ∏R
                   A
                     )]|| 6= 0.


                                                                  14
Each consumer lives in one market and either buys or does not buy the product offered in that
market. The utility that consumer i who lives in market m obtains from the product is

                               Uim = Œ≤0 + Œ≤i xm + Œ≤Œæ Œæm ‚àí Œ±pm + «´im ,

where xm is a product attribute that is observed by the researcher, Œæm is a product attribute that
is not observed by the researcher, and pm is the price of the product. Œ≤i , the random coefficient on
xm , is distributed N (Œ≤x , œÉx2 ), and «´i is distributed as logit. Given these assumptions the share of
consumers buying the product in market m is given by

                                       exp(Œ≤0 + Œ≤i xm + Œ≤Œæ Œæm ‚àí Œ±pm )
                                   ÀÜ
                          sm =                                           dF (Œ≤i )
                                     1 + exp(Œ≤0 + Œ≤i xm + Œ≤Œæ Œæm ‚àí Œ±pm )

where F (Œ≤i ) denotes the distribution function of the random coefficient.
   We first examine four different monte carlo cases with only the specification for marginal cost
varying across the cases (we add two cases of exogenous prices later). They are designed to generate
a wide range of correlations between price and the unobserved factor while maintaining a reasonable
range of prices and market shares. Price is set at a markup over marginal cost based on static profit
maximization:
                                                        sm
                                       pm = mcm ‚àí             .
                                                     ‚àÇsm /‚àÇpm
In all specifications below xm enters marginal cost, as do two other variables which do not affect
demand: wm , which is a cost-shifter observed by the researcher, and am , which is a cost shock that
is not observed. Cases 1-4, in order, are given as:

                            [1] mcm = 10 + xm + Œæm + wm + am
                            [2] mcm = 10 + xm + wm + am
                            [3] mcm = 10 + exp(xm + Œæm + wm + am )
                            [4] mcm = 10 + exp(xm + wm + am ).

In two of the four specifications Œæm does not enter marginal costs, which unambiguously lowers
Corr(pm, Œæm ). In two cases cost factors enter marginal costs linearly, and in two cases they enter
exponentially. Each of the random variables xm , Œæm , wm , and am is assumed to be an i.i.d. N (0, 0.5)
deviate. All parameters of the utility and cost functions are set equal to 1, except for the intercepts,
which equal 10, and the variance in taste for xm , which is equal to 0.5.
     To evaluate whether the Wald test does not overreject the hypothesis of the exogenous price
when the null hypothesis is true, we also generate the demand data without an unobserved attribute
(i.e. Œ≤Œæ = 0). We consider two additional specifications of the marginal costs:

                               [5] mcm = 10 + xm + wm + am
                               [6] mcm = 10 + exp(xm + wm + am ).


                                                  15
    The researcher is assumed to observe 20 purchase decisions per market for 200 markets, which
are used to construct the estimate for sm . The researcher does not observe Œæm and am in each
market, instead seeing only xm , wm , and pm , and OLS is used to estimate the residuals ŒæÃÇm =
pm ‚àí EÃÇ[pm |xm , wm ]. While it makes the test less powerful we assume the researcher mistakenly adds
a random coefficient, which is typical in many specifications. This adds a new parameter œÉ, the s.d.
of the additional error term, and leads to estimation of the utility function given by
                            UÃÉim = Œ≤0 + Œ≤i xm + ŒªŒæÃÇm ‚àí Œ±pm + œÉŒπm + «´im ,                            (12)
where Œπm is distributed N (0, 1).
    The demand parameters are estimated using maximum likelihood in two ways. First we exclude
ŒæÃÇm from the specification to see how much bias the price endogeneity generates. We then follow
the Wald approach from Section 3.1, including ŒæÃÇm directly in the likelihood function and testing
its coefficient Œª for significance. For the standard errors from the Wald approach we bootstrap,
repeating estimation 500 times (that is, on 500 different datasets, each with 200 markets) and
using the variance of the parameter estimates across these 500 cases to construct estimates of the
distribution of parameters under the null and alternative hypotheses.
    Table 1 summarizes the Monte Carlo data. Reported statistics are calculated for each sample
of 200 markets, and then are averaged over the 500 iterations. The first four columns are the
endogenous price specifications and the last two columns are the exogenous price specifications.
Prices range from approximately 10 to 14. For the linear marginal cost specifications the 10%-90%
range for shares is from 0.11 to 0.38 and for the exponential specifications they range from 0.02 to
0.19. Corr(pm , Œæm ) is respectively 0.55, 0.15, 0.40, and 0.03 for endogenous prices and 0 for the
exogenous price cases. The correlations are substantially higher in specifications 1 and 3 where the
unobserved demand attribute affects costs.
    Table 2 reports the parameter estimates for the approach without ŒæÃÇm and for the Wald-type test
specification from Section 3.1. The average of the parameter estimates and their standard deviation
across the 500 iterations are reported first for the specification without ŒæÃÇm . Next, the six parameters
associated with the Wald test specification are reported, where the two new parameters are œÉ, the
standard deviation of the additional error term, and Œª, the coefficient on ŒæÃÇm . Test results for the
null hypothesis that Œª = 0 are reported at the bottom. We discuss each case in turn.

6.1     Endogenous Prices
6.1.1    Case 1: Linear marginal costs

Case 1 has marginal costs linear in all of the demand and cost factors. The average correlation
between price and the unobserved attribute is 0.55. The constrained approach is severely biased
downward, with the price coefficient estimated to be 0.51, half of the true value of 1 (the standard
deviation is 0.03). The other estimates are similarly biased down to almost half of their true values.
   When ŒæÃÇm is included in the specification, Œª enters with a coefficient of 0.62 and a standard
deviation of 0.10. The test rejects the null hypothesis in every one of the 500 replications at a size

                                                   16
of 0.01. The average estimate of the price coefficients across the iterations is equal to 0.99, with a
standard deviation 0.09. The other averaged point estimates are similarly close to their true values.

6.1.2    Case 2: Unobserved demand attribute does not affect (linear) marginal cost

Case 2 has linear marginal costs, but Œæm excluded, lowering the correlation between price and Œæm
to 0.15. The constrained model continues to perform poorly, with the point estimate for the price
coefficient on average equal to 0.74 (with standard deviation 0.06). Other parameter estimates are
similarly biased down. Œª enters with a coefficient that is on average equal to 0.39, and the test
rejects in over 99% of the 500 cases at the 0.01 significance level.

6.1.3    Case 3: Exponential marginal costs

Case 3 defines marginal cost to be exponential in all demand and cost factors. Since the cost
variables do not enter utility, in some markets the high prices lead to very low demand; on average
7% of markets have demand shares less than 1%. The non-linearity causes the correlation between
price and the unobserved demand attribute to fall to 0.40 (relative to the linear case of 0.55).
    The constrained estimates are again severely biased downward. The average point estimate on
price is 0.63 and the standard deviation is 0.03, and other coefficients exhibit similar problems. The
Wald-type test again easily identifies the specification problem, rejecting at 0.01 significance level
in over 99% of cases. The Wald estimate for the price coefficient is on average 0.81 with standard
deviation 0.09.

6.1.4    Case 4: Unobserved demand attribute does not affect (exponential) marginal
         cost

Case 4 defines marginal cost to be exponential in demand and cost factors with Œæm excluded. With
non-linearity in costs this exclusion causes the correlation between price and the unobserved demand
attribute falls to 0.03.
    The price coefficient in the constrained approach is again biased down. The test continues to
identify the unobserved attribute problem, rejecting at significance level 0.01 in 85% of cases and
at 0.10 level 93% of cases. The Wald-test specification has a price coefficient of 0.94 vs. 1, and the
other coefficients are respectively 9.2 vs 10, 1.0 vs 1.0, and 0.41 vs 0.5.

6.2     Exogenous Prices
6.2.1    Case 5: Linear marginal costs

In this case both estimation approaches produce estimates very close to their true values. Thus,
the Wald-type test does not reject the price exogeneity as expected. Here we are interested in the
actual size of the test. Table 2 shows that the size of test is very close to the significance level.
Under the null hypothesis (our DGP), the Wald-type test shows 1.2 % rejection of 500 cases with



                                                 17
0.01 significance level and 9.4 % rejection with 0.10 significance level. Therefore the Wald-type test
does not overreject the null when the null hypothesis is true.

6.2.2     Case 6: Exponential marginal costs

In this case too both estimation approaches produce all estimates very close to their true values.
Under the null hypothesis, the Wald-type test has 1.2 % rejection of 500 cases with 0.01 signifi-
cance level and 9.0 % rejection with 0.10 significance level. Therefore the Wald-type test does not
overreject in this case too.


7        Demand for Television
Our empirical application applies the test to the model of demand for households‚Äô choice among
television reception options from Goolsbee and Petrin (2004), who emphasize the importance of
omitted attributes. We estimate both the constrained model (without the attribute) and the Wald-
type test specification described in Section 3.1, where ŒæÀÜm are included directly as new regressors in
the likelihood function.

7.1      Data and Demand Specification
The data and specification are very similar to Goolsbee and Petrin (2004) and Petrin and Train
(2010). The data come from two sources: Forrester Technographics 2001 and Warren Publishing‚Äôs
2001 Cable and Television Factbook. We restrict our analysis to a subsample of the 30,000 house-
holds from the original work, using 11,810 households that reside in 172 geographically distinct
television markets. Each market contains only one cable franchise, and four alternatives are avail-
able to households: (1) antenna only, (2) expanded basic cable service, (3) expanded basic cable
with a premium service added, such as HBO, and (4) satellite dish.
    Estimated utility is given as
                                  X5
                UÃÉimj = Œ±pmj +              Œ∏g pmj 1ig + Œ≤0‚Ä≤ xmj + Œ≥j‚Ä≤ di + œÉŒπi cj + Œªj ŒæÃÇmj + «´imj .
                                      g=2


xmj are the observed characteristics of the product and includes a product intercept term. ŒæÀÜmj is
the proxy and has Œªj as its coefficient. The price effect varies across five income groups, with the
lowest income group taken as the base and the binary variable 1ig indicating whether household i is
in income group g.16 Demographic variables for household i are given by di and enter each choice
j with a separate coefficient vector Œ≥j . A random coefficient is included to allow for correlation
in unobserved utility over the three non-antenna alternatives: cj = 1 if j is one of the three non-
antenna alternatives and cj = 0 otherwise, Œπi is an i.i.d. standard normal deviate, and œÉ is its
    16
     The price coefficient for a household in the lowest income group is Œ± while that for a household in group g > 1
is Œ± + Œ∏g .




                                                         18
standard deviation, reflecting the degree of correlation among the non-antenna alternatives. «´imj is
i.i.d. extreme value.17
     In the Forrester survey, respondents reported the type of television medium that they have.18
The Forrester survey also provides the demographic information they use, including family income,
household size, education, and type of living accommodations. Finally, the survey includes an
identifier for the household‚Äôs television market, which links households to their cable franchise
provider (whether they subscribe to cable or not).
     The cable system information comes from Warren Publishing‚Äôs 2001 Television and Cable Fact-
book. The attributes we include, which vary over markets, are the channel capacity of a cable
system, the number of pay channels available, whether pay per view is available from that cable
franchise, the price of expanded basic service, the price of premium service, and the number of over-
the-air channels available. Many of the cable operators are owned by multiple system operators
(MSO‚Äôs) like AT+T and Time-Warner, and we include MSO dummy variables, one for each of the
two cable choices for each operator. Satellite prices do not vary geographically, and the price of
antenna-only is assumed to be zero.19 More complete details are provided in Goolsbee and Petrin
(2004).

7.2    Estimation of the control
We estimate the controls product by product using the cross-market variation from the 172 different
observations on each product. However, since price does not vary across geographic location for
antenna-only and satellite, we do not construct proxies for these products. We obtain the control
term for expanded basic by regressing its price on all of the product attributes listed above for
the product choices available in the market. In addition we include Hausman (1997)-type price
instruments, one for expanded basic and premium each. The price instrument for market m is
calculated as the average price in other markets that are served by the same multiple system
operator as market m, and is intended to reflect common costs of the multiple system operator.
The premium control term is constructed in a similar manner.
  17
     The error specification in Goolsbee and Petrin (2004) is more flexible; they use a multivariate normal specification
in place of the logit error.
  18
     Specifically, they report whether they have cable or satellite, and the amount they spend on premium television.
Respondents are classified as having premium if they reported that they have cable and spend more than $10 per
month on premium viewing, which is the average price of the most popular premium channel, HBO. We classified
respondents as choosing expanded basic if they reported that they have cable and they spend less than $10 per month
on premium viewing.
  19
     For the price of satellite, we use $50 per month plus an annual $100 installation and equipment cost.




                                                           19
7.3    Results
Table 3 gives the estimated parameters and standard errors for the two approaches.20 The first
column of Table 3 gives the constrained model while the second column includes ŒæÀÜmj as new regres-
sors. The coefficients on the expanded basic and premium controls are reported first, followed by
the base price coefficient. Both controls enter significantly (i.e. we reject exogenous prices) and with
a positive sign, identifying the price endogeneity problem and suggesting that products with large
proxies possess desirable attributes omitted from the specification. Inclusion of the controls also
raises the magnitude of the estimated base price coefficient by 500%, from -0.02 to -0.09, consistent
with bias associated with a positive correlation between the unobserved attributes and prices.


8     Conclusion
In applications of differentiated product models all of the relevant product attributes may not be
observed by the econometrician. In this case price may be positively correlated with the unobserved
portion of consumers‚Äô utility for that product: producers charge more and consumers are willing
pay more for products with more of the omitted attribute, holding all else constant. This positive
correlation biases estimates of price elasticities upwards, and evidence of it has been found in many
applications spanning a wide range of markets and differing data types. The problem can be
exacerbated when the interaction of price and the omitted attribute enters the consumer utility.
    In this paper we develop a class of asymptotic tests for the price endogeneity. Our tests can
allow for the non-additive separability between price and the omitted attribute. They are easy
to implement in standard regression packages and have reasonable power against the ‚Äúexogenous
prices‚Äù hypothesis. The tests include control function type tests of specification.
    A major advantage of our testing approaches is their simplicity. They all use least squares or
nonparametric regression in an initial stage to obtain the proxies, followed by a second stage of
likelihood function maximization. The control function test includes the controls directly in the
maximization of the likelihood function and tests for their significance.
    We describe approaches to implementing the tests for three of the recent demand exercises
mentioned above, where prices are shown to be endogenous. Each of these exercises uses a dif-
ferent kind of data, including aggregate (market-level) data (Berry, Levinsohn, and Pakes (1995)),
household-level cross-sectional data (Goolsbee and Petrin (2004)), and household-level panel data
   20
      We bootstrap to account for the additional variance from estimating the expected price. Specifically, we add
a new term to the standard estimate of variance of the parameters. We calculate the new term by first drawing a
bootstrapped sample of prices and observed demand and supply factors from the 172 markets. We then estimate
EÃÇ[pmj |Zm ] and calculate the implied (new) controls, and then re-estimate the model with these controls. We repeat
this process and then compute the the variance in parameter estimates over the bootstrapped price samples, adding
this variance to the traditional formulas. The adjustment is important for the standard errors of the base price
coefficient, the coefficients for the residuals, and the coefficients of the product attributes, which increase between
50-100%. Karaca-Mandic and Train (2002) provide a formula for the asymptotic standard errors in this type of
two-step estimation; they find that in our application the formula gives standard errors that are very similar to those
obtained with the bootstrap procedure.



                                                          20
(Chintagunta, Dube, and Goh (2005)). Our Monte Carlos draw on a formulation where prices are set
according to a non-linear in characteristics, inverse-elasticity rule. Our simplest test specifications
identify the price endogeneity problem in almost every case.




                                                  21
                                                Table 1
                            Summary of Data Generated in Monte Carlo Samples
                               True values: Œ± = 1, Œ≤0 = 10, Œ≤x = 1, œÉx = 0.5
 Case                        [1]          [2]           [3]            [4]                [5]           [6]
 Price Range
    Mean                    11.31          11.33             12.75         12.57         11.32         12.57
    10%-90%              10.17-12.45    10.36-12.28       11.41-14.60   11.49-14.03   10.37-12.27   11.49-14.03

 Share Range
   Mean                       0.22          0.23              0.09          0.10          0.23          0.10
   10%-90%                 0.11-0.34     0.10-0.38         0.01-0.16     0.02-0.19     0.12-0.35     0.02-0.17
   % of markets with
       shares < 0.01         0.0%         0.0%              7.4%          5.7%           0.0%         5.4%
       shares < 0.10         5.8%         10.0%             57.1%         53.5%          5.8%         51.0%

 Corr(pm , Œæm )              0.55          0.15              0.40          0.03          0.00          0.00
 Marginal Costs
   Linear                    Yes           Yes               No            No            Yes           No
   Exponential               No            No                Yes           Yes           No            Yes
   Include Œæm                Yes           No                Yes           No            No            No
Cases [1]-[4] are with an omitted attribute (Œ≤Œæ = 1) and Cases [5]-[6] are with no omitted attribute
(Œ≤Œæ = 0). Reported numbers are the statistics for each of the samples with 200 markets averaged over the
500 Monte Carlo iterations.




                                                     22
                                                Table 2
            Constrained Model and Wald-type Test Specification for Monte Carlo Data
                       200 markets, 20 observations per market, 500 iterations
                          True values: Œ± = 1, Œ≤0 = 10, Œ≤x = 1, œÉx = 0.5
      Case                                  [1]       [2]    [3]       [4]       [5]     [6]
        Constrained Model
        Œ±                                  0.51     0.74    0.63      0.86      1.00    1.00
                                         (0.03)    (0.06)  (0.03)    (0.05)    (0.01)  (0.01)
        Œ≤0                                 4.56     7.17    5.52      8.40      9.97    9.98
                                         (0.38)    (0.69)  (0.43)    (0.66)    (0.09)  (0.09)
        Œ≤x                                 0.51     0.74    0.65      0.88      1.00    1.00
                                         (0.06)    (0.09)  (0.07)    (0.09)    (0.02)  (0.02)
        œÉx                                 0.23     0.24    0.12      0.22      0.34    0.44
                                         (0.45)    (0.49)  (0.33)    (0.41)    (0.25)  (0.13)
        Wald Test/Control Function
        Œ±                                  0.99     1.01    0.81      0.94      1.00    1.00
                                         (0.09)    (0.26)  (0.08)    (0.09)    (0.01)  (0.01)
        Œ≤0                                 9.90     10.13   7.69      9.20      9.98    9.98
                                         (1.11)    (2.48)  (0.95)    (1.02)    (0.12)  (0.09)
        Œ≤x                                 0.99     1.01    0.99      1.00      1.00    1.00
                                         (0.12)    (0.25)  (0.13)    (0.14)    (0.02)  (0.02)
        œÉx                                 0.44      0.52   0.26      0.41      0.41    0.45
                                         (0.23)    (0.40)  (0.19)    (0.25)    (0.11)  (0.09)
        œÉ                                  0.28      0.53   0.55      0.60      0.05    0.05
                                         (0.20)    (0.69)  (0.35)    (0.45)    (0.04)  (0.04)
        Test statistic: Œª                  0.62     0.39    0.25      0.08      0.00    0.00
                                         (0.10)    (0.15)  (0.07)    (0.07)    (0.01)  (0.01)
        Rejection rate at:
        size=0.01                         100%     99.2%   99.6%     85.2%      1.2%    1.2%
        size=0.10                         100%     99.4%   99.6%     93.2%      9.4%    9.0%
Cases [1]-[4] are with an omitted attribute (Œ≤Œæ = 1) and Cases [5]-[6] are with no omitted attribute
(Œ≤Œæ = 0). Average parameter estimate and standard deviation (in parentheses) across 500 iterations.
For the size of tests, 500 iterations are used to estimate the distribution of Œª under the null hypothesis
(estimates not reported here).




                                                   23
                                                Table 3
                                         TV Reception Choice
                       Constrained Approach and the Wald-type Test Specification
     Alternatives: 1. Antenna only, 2. Expanded Basic cable, 3. Premium cable, 4. Satellite Dish
     Variables enter alternatives in parentheses and are zero in other alternatives.
     Explanatory variable                                   Constrained              Wald-type Test
                                                              Approach                 Specification
                                                              (Standard errors in parentheses)
     Control for expanded-basic cable price (2)                                        .0805 (.0416)
     Control for premium cable price (3)                                               .0873 (.0418)
     Price, in dollars per month (1-4)                    -.0202 (.0047)              -.0969 (.0400)
     Price for income group 2 (1-4)                        .0149 (.0024)               .0150 (.0025)
     Price for income group 3 (1-4)                        .0246 (.0030)               .0247 (.0031)
     Price for income group 4 (1-4)                        .0269 (.0034)               .0269 (.0035)
     Price for income group 5 (1-4)                        .0308 (.0036)               .0308 (.0038)
     Number of cable channels (2,3)                       -.0023 (.0011)               .0026 (.0029)
     Number of premium channels (3)                        .0375 (.0163)               .0448 (.0233)
     Number of over-the-air channels (1)                   .0265 (.0090)               .0222 (.0111)
     Whether pay per view is offered (2,3)                 .4315 (.0666)               .5813 (.1104)
     Education level of household (2)                     -.0644 (.0220)              -.0619 (.0221)
     Education level of household (3)                     -.1137 (.0278)              -.1123 (.0280)
     Education level of household (4)                     -.1965 (.0369)              -.1967 (.0372)
     Household size (2)                                   -.0494 (.0240)              -.0518 (.0241)
     Household size (3)                                    .0160 (.0286)               .0134 (.0287)
     Household size (4)                                    .0044 (.0357)               .0050 (.0358)
     Household rents dwelling (2-3)                       -.2471 (.0867)              -.2436 (.0886)
     Household rents dwelling (4)                         -.2129 (.1562)              -.2149 (.1569)
     Single family dwelling (4)                            .7622 (.1523)               .7649 (.1523)
     Alternative specific constant (2)                     1.119 (.2668)               2.972 (1.057)
     Alternative specific constant (3)                     .1683 (.3158)               2.903 (1.487)
     Alternative specific constant (4)                    -.2213 (.4102)               4.218 (2.386)
     Error components, standard deviation (2-4)            .5087 (.6789)               .5553 (.8567)
     Log likelihood at convergence                             -14660.84                   -14635.47
     Number of observations: 11810
For each of the seven largest multiple system operators we include separate indicators for expanded
basic and for premium.




                                                24
                                                          Appendix

A     Asymptotic Distributions of Test Statistics
A.1     Proof of Lemma 5.1
                                                                                                                b
                                                                                                 ‚àÇ log LN (ŒæÃÇm ,Œ∏eU )
Proof. The unconstrained ML estimator solves the first order condition                                                  = 0. Define
                                                                                                        ‚àÇ Œ∏e
                                  e                                                     e
   e œÄ) =
b Œ∏,
Œì(          ‚àí ‚àÇ log LNe(ŒæÃÉem‚Ä≤ (œÄ),Œ∏)         e œÄ) =
                                       , Œì0 (Œ∏,         limM ‚Üí‚àû E[‚àí ‚àÇ log LNe(ŒæÃÉem‚Ä≤ (œÄ),Œ∏) ],      e = Œì(
                                                                                                b Œ∏)
                                                                                                Œì(        e œÄÃÇ), and Œì0 =
                                                                                                       b Œ∏,
                     ‚àÇ Œ∏‚àÇ Œ∏                                                ‚àÇ Œ∏‚àÇ Œ∏
                                                         ‚àö
                                                         b
Œì0 (Œ∏e0 , œÄ0 ). The asymptotic distribution of M (Œ∏eU ‚àí Œ∏e0 ) is obtained from the asymptotic expansion
of
                              (                                                                               )
‚àö b                             ‚àö ‚àÇ log LN (ŒæÃÉm , Œ∏e0 ) ‚àö      ‚àÇ log L N  (ŒæÃÇ m , e0 ) ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )
                                                                                  Œ∏
   M (Œ∏eU ‚àíŒ∏e0 ) = Œì  b (Œ∏e )
                       ‚àí1   ‚àó
                                  M                     + M(                          ‚àí                      ) +op (1),
                                            ‚àÇ Œ∏e                       ‚àÇ Œ∏e                   ‚àÇ Œ∏e
                                                                                                                (13)
which is obtained from the element-by-element mean value expansions of the first order condition
               b                                             b
‚àÇ log LN (ŒæÃÇm ,Œ∏eU )
                     = 0 around Œ∏e0 where Œ∏e‚àó lies between Œ∏eU and Œ∏e0 . Therefore the asymptotic variance
         ‚àÇ Œ∏e
    ‚àö b
of M (Œ∏eU ‚àí Œ∏e0 ) contains two variance terms that are from (i) the ML estimation and (ii) the
estimation of the controls.
     Note that under Assumptions 5.1, 5.2 (i)(a), (v), and (vi), by the uniform law of large numbers
and the continuity, we obtain
                                                   b Œ∏e‚àó ) ‚Üíp Œì0
                                                   Œì(                                                           (14)

because

                 b Œ∏e‚àó ) ‚àí Œì0 ‚â§ Œì(
                 Œì(             b Œ∏e‚àó ) ‚àí Œì0 (Œ∏e‚àó , œÄÃÇ) + Œì0 (Œ∏e‚àó , œÄÃÇ) ‚àí Œì0

                                   ‚â§          sup      Œì( e œÄ) ‚àí Œì0 (Œ∏ÃÉ, œÄ) + Œì0 (Œ∏e‚àó , œÄÃÇ) ‚àí Œì0 = op (1)
                                                       b Œ∏,                                                                    (15)
                                        e Œò
                                        Œ∏‚àà e 0 ,œÄ‚ààŒ†0


where the first term in (15) converges to zero by the uniform LLN under Assumption 5.2 (vi) and the
second term in (15) converges to zero because of the continuity of Œì0 (which is implied by Assumption
5.2 (v) and (vi) due to the dominated convergence theorem) and because (Œ∏e‚àó , œÄÃÇ) ‚Üíp (Œ∏e0 , œÄ0 ).
    To derive the variance term due to the second term inside {¬∑} bracket in (13), we approximate
the second term in (13) using a first order mean value expansion,
                                                          !
      ‚àö       ‚àÇ log LN (ŒæÃÇm , Œ∏e0 ) ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )
        M                          ‚àí                                                              (16)
                     ‚àÇ Œ∏e                  ‚àÇ Œ∏e
         M Nm XJ          J                                        J
       1 XX              X  ‚àÇ 2 log Pimj ‚Ä≤‚Ä≤ (v(ŒæÃÉm (œÄÃÇ ‚àó )), Œ∏e0 ) X ‚àÇvj ‚Ä≤ (ŒæÃÉm (œÄÃÇ ‚àó )) ‚àÇ ŒæÃÉmj (œÄÃÇ ‚àó ) ‚àö
  =              Yimj ‚Ä≤‚Ä≤                                                                                     œÄj ‚àí œÄj0 )
                                                                                                          M (b
       N                               e j ‚Ä≤ (ŒæÃÉm )
                                     ‚àÇ Œ∏‚àÇv                                 ‚àÇ ŒæÃÉmj            ‚àÇœÄj
          m=1 i=1 j =0
              ‚Ä≤‚Ä≤         ‚Ä≤             j =1                                  j=1
       +op (1)

where œÄÃÇ ‚àó lies between œÄÃÇ and œÄ0 .

                                                                25
                 e ŒæÀúm ) =              PM     PNm PJ                         PJ                                  e ‚àÇv ‚Ä≤ (ŒæÃÉm ) ‚àÇ ŒæÃÉm
                                                                                         ‚àÇ 2 log Pimj ‚Ä≤‚Ä≤ (v(ŒæÃÉm ),Œ∏)
    Define ŒõN,M
            j   (Œ∏,                 1
                                    N    m=1      i=1       j ‚Ä≤‚Ä≤ =0 Yimj ‚Ä≤‚Ä≤     j ‚Ä≤ =1            e
                                                                                                                      j
                                                                                                                     ‚àÇ ŒæÃÉmj      ‚àÇœÄj
                                                                                                                                     j
                                                                                                                                         . Then
                                                                                                ‚àÇ Œ∏‚àÇv ‚Ä≤ (ŒæÃÉm )
                                                                                                     j
we can rewrite (16) as
                ‚àö        ‚àÇ log LN (ŒæÃÇm , Œ∏e0 ) ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )
                    M(                        ‚àí                      )
                                ‚àÇ Œ∏e                  ‚àÇ Œ∏e
                J
                X                                                             X
            =          ŒõN,M
                        j   (Œ∏e0 , ŒæÀúm (œÄÃÇ ‚àó ))Ãüj + op (1) ‚Üíd N (0,                  Œõ0j Cov(Ãüj , Ãük )Œõ‚Ä≤0k ) = N (0, V1 )
                 j=1                                                          j,k

where Œõ0j = limM ‚Üí‚àû E[ŒõN,M       j    (Œ∏e0 , ŒæÃÉm )] and the asymptotic normality result holds by the continuous
mapping theorem and by the Lindeberg-Feller CLT under Assumption 5.1. In the above we can
show ŒõN,M
       j  (Œ∏e0 , ŒæÀúm (œÄÃÇ ‚àó )) ‚Üíp Œõ0j by following similar steps to (14) under Assumptions 5.1 and 5.2.
             ‚àö                     e
   Then by M ‚àÇ log LNe(ŒæÃÉm ,Œ∏0 ) ‚Üíd N (0, Œì0 ¬∑ limM ‚Üí‚àû M           N ) (due to the Lindeberg-Feller CLT under
                             ‚àÇŒ∏
Assumption 5.2 (vii)), (14), the Slutsky theorem, and the continuous mapping theorem, from (13)
we obtain
                             ‚àö b                                          M
                                M (Œ∏eU ‚àí Œ∏e0 ) ‚Üíd N (0, Œì‚àí1  0 (Œì0 ¬∑ lim     + V1 )Œì‚àí1
                                                                                    0 ).                   (17)
                                                                    M ‚Üí‚àû N




A.2     Asymptotic Distribution of the LM test
Proof. We show that the feasible LM test statistic has the same asymptotic distribution with the
corresponding Wald test statistic.
                                                               be
    Element-by-element mean value expansions of ‚àÇ log LN (ŒæÃÇm ,Œ∏R ) around Œ∏e0 yield
                                                                              ‚àÇ Œ∏e

     ‚àö ‚àÇ log LN (ŒæÃÇm , b      Œ∏eR ) ‚àö ‚àÇ log LN (ŒæÃÇm , Œ∏e0 ) ‚àÇ log LN (ŒæÃÇm , Œ∏e‚àó ) ‚àö be
        M                          = M                      +                      M (Œ∏R ‚àí Œ∏e0 ) + op (1)     (18)
                         ‚àÇ Œ∏e                   ‚àÇ Œ∏e                 e Œ∏e‚Ä≤
                                                                   ‚àÇ Œ∏‚àÇ
                               b                         b
where Œ∏e‚àó lies between Œ∏eR and Œ∏e0 . Note that H(Œ∏eR ‚àí Œ∏e0 ) = 0 by construction of H. Write Œì(           b Œ∏e‚àó ) =
                    e‚àó
                                                b Œ∏e‚àó )‚àí1 to both sides of (18), it follows that
‚àí ‚àÇ log LNe (eŒæÃÇ‚Ä≤m ,Œ∏ ) . Then by multiplying H Œì(
       ‚àÇ Œ∏‚àÇ Œ∏

                                                    b
                ‚àö
                        b Œ∏e‚àó )‚àí1   ‚àÇ log LN (ŒæÃÇm , Œ∏eR )
                    M H Œì(
                                           ‚àÇ Œ∏e
                ‚àö
                        b Œ∏e‚àó )‚àí1   ‚àÇ log LN (ŒæÃÇm , Œ∏e0 )           ‚àö            ‚àÇ log LN (ŒæÃÇm , Œ∏e0 )
           =        M H Œì(                                  + op (1) =M HŒì‚àí1   0                        + op (1)
                                           ‚àÇ Œ∏e                                         ‚àÇ Œ∏e            !
                ‚àö                ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )    ‚àÇ log LN (ŒæÃÇm , Œ∏e0 ) ‚àÇ log LN (ŒæÃÉm , Œ∏e0 )
           =        M HŒì0‚àí1                            +(                      ‚àí                       ) + op (1)
                                        ‚àÇ Œ∏e                     ‚àÇ Œ∏e                   ‚àÇ Œ∏e
by the similar argument with (14) and the Slutsky theorem. Therefore, under the null hypotheses
    ‚àö                               b                                                  ‚àö
(7), M H Œì(b Œ∏e‚àó )‚àí1 ‚àÇ log LN (ŒæÃÇm ,Œ∏eR ) follows the same asymptotic distribution with M H(b
                                                                                            Œ∏eU ‚àí Œ∏e0 ) and
                            ‚àÇ Œ∏e
we obtain from (17)
                                               b
                ‚àö
                     bb        ‚àÇ log LN (ŒæÃÇm , Œ∏eR )                       M
                 M H Œì(Œ∏eR )‚àí1                       ‚Üíd N (0, HŒì‚àí1
                                                                0  (Œì0 lim   + V1 )Œì‚àí1 ‚Ä≤
                                                                                    0 H )                                                  (19)
                                      ‚àÇ Œ∏e                            M ‚Üí‚àû N


                                                                 26
by the Lindeberg-Feller CLT and the continuous mapping theorem and because Œì(   bbŒ∏eR ) ‚Üíp Œì0 , Œì(
                                                                                                b Œ∏e‚àó ) ‚Üíp
                   bb
Œì0 . Then by (19), Œì(
                                         b
                      Œ∏eR ) ‚Üíp Œì0 , Vb1 (Œ∏eR ) ‚Üíp V1 , and the continuous mapping theorem it follows
that
                            b                                                         b
 g          ‚àÇ log LN (ŒæÃÇm , Œ∏eR ) b be ‚àí1 ‚Ä≤ e ‚àí1 be        b be ‚àí1 ‚àÇ log LN (ŒæÃÇm , Œ∏eR )
 LM M,N = N                       Œì(Œ∏R ) H VM,N (Œ∏ R )H Œì(Œ∏R )
                   ‚àÇ e‚Ä≤
                     Œ∏                                                         ‚àÇ Œ∏e
          Ô£±                                         Ô£º‚Ä≤
          Ô£≤‚àö                                   b Ô£Ω                                                       ‚àí1
                   b  be ‚àí1 ‚àÇ log LN (ŒæÃÇm , Œ∏eR )          b be ‚àí1 b be M             b   be b be ‚àí1 ‚Ä≤
        =     M H Œì(Œ∏R )                               ¬∑ H Œì(Œ∏R ) (Œì(Œ∏ R )          + V1 (Œ∏ R ))Œì(Œ∏ R ) H
          Ô£≥                            ‚àÇ Œ∏e         Ô£æ                          N
          Ô£±                                         Ô£º
          Ô£≤‚àö                                  be Ô£Ω
                   bb         ‚àÇ log LN (ŒæÃÇm , Œ∏ R )
        √ó    M H Œì(  Œ∏eR )‚àí1                          ‚Üí œá2 (dim((Œª‚Ä≤ , Œ≥
                                                                      e‚Ä≤ , Œ≥
                                                                           ep‚Ä≤ )‚Ä≤ )).
          Ô£≥                           ‚àÇ Œ∏e          Ô£æ d

               g M,N follows the same asymptotic distribution of the Wald test statistic TeM,N
   Therefore, LM
under the null hypothesis of the price exogeneity.

A.3     Consistency of the LM test

                      e =   1   PM     PNm                                         e           1   P P
                                                                                                   M N m
                                                                                                                             e
Define hM,N (v(ŒæÃÉm ), Œ∏)    N    m=1     i=1 him (v(ŒæÃÉm ), Œ∏ÃÉ) and E[him (v(ŒæÃÉm ), Œ∏)] =       N             E[him (v(ŒæÃÉm ), Œ∏)].
                                                                                                   m=1 i=1
Assume the following to show the consistency of the LM test.

                       b
Assumption A.1 (i) Œ∏eR ‚Üíp Œ∏eR  A under the alternative hypothesis against (7); (ii)-(viii) each corre-

sponding Assumption 5.2 (ii) to (viii) holds replacing Œ∏e0 with Œ∏eR     e 0 with Œò
                                                                  A and Œò        e A where Œò
                                                                                           e A denotes
a neighborhood of Œ∏eR
                    A.


                                                                   g M,N is consistent
Theorem A.1 Suppose Assumptions 5.1 and A.1 hold. Then the LM test LM
                                eA      6 0.
under limM ‚Üí‚àû ||E[him (v(ŒæÃÉm ), Œ∏R )]|| =

   Proof. Under the alternative hypothesis against (7), using a mean value expansion, we obtain
                                          M Nm                                                   ‚àö
       ‚àö                 b            1 XX                                                        M
        M hM,N (v(ŒæÃÇm ), Œ∏eR ) =     ‚àö                           eA                     eA
                                                  (him (v(ŒæÃÉm ), Œ∏R ) ‚àí E[him (v(ŒæÃÉm ), Œ∏R )]) √ó ‚àö         (20)
                                       N m=1 i=1                                                   N
                                       ‚àö
                                     + M (hM,N (v(ŒæÃÇm ), Œ∏eRA
                                                              ) ‚àí hM,N (v(ŒæÃÉm ), Œ∏eR
                                                                                   A
                                                                                     ))                    (21)
                                       ‚àÇhM,N (v(ŒæÃÇm ), Œ∏e ) ‚àö be
                                                         A‚àó                    ‚àö
                                     +           ‚Ä≤
                                                              M (Œ∏R ‚àí Œ∏eRA
                                                                           ) + M E[him (v(ŒæÃÉm ), Œ∏eR A
                                                                                                       )], (22)
                                              ‚àÇŒ∏
                        b
where Œ∏eA‚àó lies between Œ∏eR and Œ∏eR
                                  A . Now we analyze each term one by one below.

   For (21) applying the mean value expansion around œÄ0 , we obtain

          ‚àö                                                  ‚àÇhM,N (v(ŒæÃÉm (œÄ ‚àó )), Œ∏eR
                                                                                     A) ‚àö
           M (hM,N (v(ŒæÃÇm ), Œ∏eR
                               A
                                 ) ‚àí hM,N (v(ŒæÃÉm ), Œ∏eR
                                                      A
                                                        )) =                                 œÄ ‚àí œÄ0 )
                                                                                          M (b                       (23)
                                                                      ‚àÇœÄ ‚Ä≤
                                                               ‚àÇhM,N (v(ŒæÃÉm (œÄ ‚àó )),Œ∏eR
                                                                                      A)
where œÄ ‚àó lies between œÄ
                       b and œÄ0 . Let ŒìœÄA = limM ‚Üí‚àû E[                  ‚àÇœÄ               ].   We then have

                                                      27
                             ‚àö
                                 M (hM,N (v(ŒæÃÇm ), Œ∏eR
                                                     A
                                                       ) ‚àí hM,N (v(ŒæÃÉm ), Œ∏eR
                                                                            A
                                                                              )) = Œì‚Ä≤œÄA Ãü + op (1)
                                                            ‚àÇhim (v(ŒæÃÉm (œÄ)),Œ∏eR
                                                                               A)
by Assumption 5.1 and because under E[supœÄ‚ààŒ†0 ||                    ‚àÇœÄ            ||2 ] < ‚àû for m (which holds
                                           ‚àÇh              ‚àó   eA
                                                  (v(ŒæÃÉm (œÄ )),Œ∏R )
under Assumption A.1 (viii)), we have M,N ‚àÇœÄ                        ‚Üíp ŒìœÄA by the uniform Law of Large
                      ‚àÇh               eA
                            (v(ŒæÃÉ (œÄ)),Œ∏R )
numbers and because E[ M,N ‚àÇœÄm              ] is continuous at œÄ = œÄ0 (which is implied by Assumption
A.1 (viii) due to the dominated convergence theorem).
   Next to analyze the first term in (22) let the inverse of the asymptotic variance matrix of
                                b
the unconstrained estimator Œ∏eU be B = Œì0 (Œì0 ¬∑ limM ‚Üí‚àû M            ‚àí1
                                                             N + V1 ) Œì0 and define a matrix M =
I ‚àí B ‚àí1/2 H ‚Ä≤ (HB ‚àí1 H ‚Ä≤ )‚àí1 HB ‚àí1/2 . Then the asymptotic distribution of the constrained estimator
be               ‚àö b
Œ∏R is given by M (Œ∏eR ‚àí Œ∏eA ) ‚Üíd N (0, B ‚àí1/2 MB ‚àí1/2 ) ‚â° Z2A (see p. 2217-2220 of Newey and
                                          R
McFadden (1994)). Then we obtain

                                   ‚àÇhM,N (v(ŒæÃÇm ), Œ∏eA‚àó ) ‚àö be
                                                           M (Œ∏ R ‚àí Œ∏eR
                                                                      A
                                                                        ) = Œì‚Ä≤Œ∏A Z2A + op (1)
                                          ‚àÇŒ∏e‚Ä≤

          ‚àö b                                        ‚àÇhM,N (v(ŒæÃÇm ),Œ∏eA‚àó )
where      M (Œ∏eR ‚àí Œ∏eR
                      A) ‚Üí Z
                          d  2A and ŒìŒ∏A = limM ‚Üí‚àû E[          e            ] because under Assumption
                                                                               ‚àÇŒ∏
                                   ‚àÇhM,N (v(ŒæÃÇm ),Œ∏eA‚àó )
A.1 (vi)-(v), we have                                      ‚Üíp ŒìŒ∏A by the uniform Law of Large numbers, because
                                          ‚àÇ Œ∏e
     ‚àÇhM,N (v(ŒæÃÉm (œÄ)),Œ∏eR )
E[                    is continuous at Œ∏eR = Œ∏eR
                             ]                 A and œÄ = œÄ (which is implied by Assumption A.1
                                                          0
             ‚àÇ Œ∏e
(vi)-(v) due to the dominated convergence theorem), and because Œ∏eA‚àó ‚Üíp Œ∏eR     A and œÄÃÇ ‚Üí œÄ .
                                                                                          p 0
                                                                         eA    4
    Next we consider the term in (20). Note that under E[||him (v(ŒæÃÉm ), Œ∏R )|| ] < ‚àû for all m (which
holds under Assumption A.1 (vii)), by the Lindeberg-Feller CLT, we have

               XM         X Nm                                                        ‚àö
                                       (him (v(ŒæÃÉm ), Œ∏eR
                                                        A
                                                          ) ‚àí E[him (v(ŒæÃÉm ), Œ∏eR
                                                                                A
                                                                                  )])/ N ‚Üíd Z1A ‚â° N (0, VhA )
                    m=1          i=1
                               P     PNm                    eA                     eA                      eA
where VhA = limM ‚Üí‚àû N1 M         m=1   i=1 E[{him (v(ŒæÃÉm ), Œ∏R ) ‚àí E[him (v(ŒæÃÉm ), Œ∏R )]} ¬∑ {him (v(ŒæÃÉm ), Œ∏R ) ‚àí
E[him (v(ŒæÃÉm ), Œ∏eR
                  A )]}‚Ä≤ ]. Combining these results, we obtain

                                         ‚àö
     ‚àö                      be             M                            ‚àö
       M hM,N (v(ŒæÃÇm ), Œ∏ R ) = Z1A ‚àö + Œì‚Ä≤œÄA Ãü + Œì‚Ä≤Œ∏A Z2A + M E[him (v(ŒæÃÉm ), Œ∏eR             A
                                                                                                )] + op (1)
                                           N
                                             ‚àö
                                 = Op (1) + M E[him (v(ŒæÃÉm ), Œ∏eR  A
                                                                     )].
                         ‚àö               b
Therefore, we obtain || M hM,N (v(ŒæÃÇm ), Œ∏eR )|| ‚Üí ‚àû if limM ‚Üí‚àû ||E[him (v(ŒæÃÉm ), Œ∏eR
                                                                                    A )]|| =
                                                                                           6 0 under the
alternative against (7). This implies LM M,N ‚Üí ‚àû under the alternative if limM ‚Üí‚àû ||E[him (v(ŒæÃÉm ), Œ∏eR
                                      g                                                                 A )]|| =
                                                                                                               6
0. Therefore the LM test for price endogeneity is consistent.




                                                                  28
References
Altonji, J., and R. Matzkin (2005), ‚ÄúCross Section and Panel Data Estimators for Nonseparable
Models with Endogenous Regressors,‚Äù Econometrica, 73, 1053-1102.

Andrews, D. (1997), ‚ÄúA Conditional Kolmogorov Test,‚Äù Econometrica, 65, 1097-1128.

Berry, S. (1994), ‚ÄúEstimating Discrete Choice Models of Product Differentiation,‚Äù RAND Journal
of Economics, 25, 242-262.

Berry, S., A. Gandhi, and P. Haile (2011), ‚ÄúConnected Substitutes and Invertibility of Demand,‚Äù
Working Paper.

Berry, S., and P. Haile (2010), ‚ÄúIdentification in Differentiated Products Markets Using Market
Level Data,‚Äù Working Paper.

Berry, S., J. Levinsohn, and A. Pakes (1995), ‚ÄúAutomobile Prices in Market Equilibrium,‚Äù Econo-
metrica, 63, 841-889.

Bierens, H. (1990), ‚ÄúA Consistent Conditional Moment Test of Functional Form,‚Äù Econometrica, 58,
1443-1458.

Chen, X., and Y. Fan (1999), ‚ÄúConsistent Hypothesis Testing in Semiparametric and Nonparametric
Models for Econometric Time Series,‚Äù Journal of Econometrics, 91, 373-401.

Chintagunta, P., J. Dube, and K. Goh (2005), ‚ÄúBeyond the endogeneity bias: The effect of unmea-
sured brand characteristics on household-level brand choice models,‚Äù Management Science, 51(5),
832-849.

Crawford, G. (2000), ‚ÄúThe Impact of the 1992 Cable Act on Household Demand and Welfare,‚Äù
RAND Journal of Economics, 31, 422-449.

Dub√©, J.P., J. Fox, and C.L. Su (2012), ‚ÄúImproving the Numerical Performance of Static and
Dynamic Aggregate Discrete Choice Random Coefficients Demand Estimation,‚Äù Econometrica,
80(5), 2231-2267.

Fan, Y., and Q. Li (1996), ‚ÄúConsistent Model Specification Tests: Omitted Variables, Parametric
and Semiparametric Functional Forms,‚Äù Econometrica, 64, 865-890.

Gandhi, A., K. Kim, and A. Petrin (2011), ‚ÄúIdentification and Estimation in Discrete Choice Demand
Models when Endogenous Variables Interact with the Error,‚Äù Working Paper.

Goolsbee, A., and A. Petrin (2004), ‚ÄúThe Consumer Gains from Direct Broadcast Satellites and the
Competition with Cable TV,‚Äù Econometrica, 72(2), 351-382.



                                               29
Hardle, W., and E. Mammen (1993), ‚ÄúComparing Nonparametric versus Parametric Regression
Fits,‚Äù Annals of Statistics, 21, 1926-1947.

Hausman, J. (1978), ‚ÄúSpecification Tests in Econometrics,‚Äù Econometrica, 46, 1251-1272.

Hausman, J. (1997), ‚ÄúValuation of New Goods under Perfect and Imperfect Competition,‚Äù in The
Economics of New Goods, ed. by R. Gordon, and T. Bresnahan. University of Chicago Press,
Chicago.

Heckman, J. (1978), ‚ÄúDummy Endogenous Variables in a Simultaneous Equation System,‚Äù Econo-
metrica, 46, 931-959.

Heckman, J., and R. Robb (1985), ‚ÄúAlternative Methods for Evaluating the Impacts of Interventions:
An Overview,‚Äù Journal of Econometrics, 30, 239-267.

Horowitz, J., and V. Spokoiny (2001), ‚ÄúAn Adaptive, Rate Optimal Test of a Parametric Mean
Regression Model against a Nonparametric Alternative,‚Äù Econometrica, 69, 599-631.

Imbens, G., and W. Newey (2003), ‚ÄúIdentification and Estimation of Triangular Simultaneous Equa-
tions Models Without Additivity,‚Äù Working Paper.

Karaca-Mandic, P., and K. Train (2002), ‚ÄúStandard Error Correction in Two-Step Estimation with
Nested Samples,‚Äù Working Paper, Department of Economics, University of California, Berkeley.

Kim, K., and A. Petrin (2010), ‚ÄúControl Function Corrections for Unobserved Factors in Differen-
tiated Product Models,‚Äù Working Paper.

Kitamura, Y., G. Tripathi, and H. Ahn (2004), ‚ÄúEmpirical Likelihood-based Inference in Conditional
Moment Restriction Models,‚Äù Econometrica, 72, 1667-1714.

Knittel, C. R. and K. Metaxoglou (2008), ‚ÄúEstimation of Random Coefficient Demand Models:
Challenges, Difficulties and Warnings,‚Äù Working Paper, MIT.

Li, Q., C. Hsiao, and J. Zinn (2003), ‚ÄúConsistent Specification Tests for Semiparametric/ Nonpara-
metric Models Based on Series Estimation Methods,‚Äù Journal of Econometrics, 112, 295-325.

Matzkin, R. (2003), ‚ÄúNonparametric Estimation of Nonadditive Random Functions,‚Äù Econometrica,
71.

Nevo, A. (2001), ‚ÄúMeasuring Market Power in the Ready-to-Eat Cereal Industry,‚Äù Econometrica,
69, 307-342.

Newey, W. (1997), ‚ÄúConvergence Rates and Asymptotic Normality of Series Estimators,‚Äù Journal
of Econometrics, 79, 147-168.



                                               30
Newey, W., and D. McFadden (1994), ‚ÄúLarge Sample Estimation and Hypothesis Testing,‚Äù The
Handbook of Econometrics, Volume 4, Elsevier.

Newey, W. K. (1985), ‚ÄúMaximum Likelihood Specification Testing and Conditional Moment Tests,‚Äù
Econometrica, 53(5), 1047-1070.

Pakes, A. (1994), ‚ÄúDynamic structural models, problems and prospects: mixed continuous discrete
controls and market interaction,‚Äù in Advances in Econometrics, Sixth World Congress, Volume II,
ed. by C. Sims, pp. 171-259, New York. Cambridge.

Petrin, A. (2002), ‚ÄúQuantifying the Benefits of New Products: The Case of the Minivan,‚Äù Journal
of Political Economy, 110, 705-729.

Petrin, A., and K. Train (2010), ‚ÄúA Control Function Approach to Endogeneity in Consumer Choice
Models,‚Äù Journal of Marketing Research, 47, 370-379.

Rivers, D., and Q. Vuong (1988), ‚ÄúLimited Information Estimators and Exogeneity Tests for Simul-
taneous Probit Models,‚Äù Journal of Econometrics, 39, 347-366.

Smith, R., and R. Blundell (1986), ‚ÄúAn Exogeneity Test for a Simultaneous Equation Tobit Model
with an Application to Labor Supply,‚Äù Econometrica, 54, 679-686.

Song, K. (2010), ‚ÄúTesting Semiparametric Conditional Moment Restrictions Using Conditional Mar-
tingale Transforms,‚Äù Journal of Econometrics, 154, 74-84.

Stinchcombe, M., and H. White (1998), ‚ÄúConsistent Specification Testing When the Nuisance Pa-
rameters Present Only Under the Alternative,‚Äù Econometric Theory, 14, 295-325.

Trajtenberg, M. (1989), ‚ÄúThe Welfare Analysis of Product Innovations, with an Application to
Computed Tomography Scanners,‚Äù Journal of Political Economy, 97, 444-479.

Villas-Boas, J., and R. Winer (1999), ‚ÄúEndogeneity in Brand Choice Models,‚Äù Management Science,
45, 1324-1338.




                                              31
