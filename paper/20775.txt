NBER WORKING PAPER SERIES

DEMAND ANALYSIS USING STRATEGIC REPORTS:
AN APPLICATION TO A SCHOOL CHOICE MECHANISM
Nikhil Agarwal
Paulo Somaini
Working Paper 20775
http://www.nber.org/papers/w20775
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
December 2014

We are grateful to Parag Pathak for sharing data on admissions in Cambridge Public Schools and for
several helpful discussions. We thank Dan Ackerberg, Steve Berry, Eric Budish, Phil Haile, and Mike
Whinston for several helpful discussions, and Susan Athey, Lanier Benkard, Victor Chernozhukov,
William Diamond, Liran Einav, Glenn Ellison, Aviv Nevo, Whitney Newey, Ariel Pakes, Larry Samuelson,
Joe Shapiro, Allan Collard-Wexler, and Frank Wolak for their comments. Vivek Bhattacharya and
Abigail Ostriker provided outstanding research assistance. Both authors thank the Cowles Foundation
of Economic Research and the Department of Economics at Yale University for their generous hospitality.
Support from the National Science Foundation (SES-1427231) is gratefully acknowledged.The views
expressed herein are those of the authors and do not necessarily reflect the views of the National Bureau
of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2014 by Nikhil Agarwal and Paulo Somaini. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including Â© notice,
is given to the source.

Demand Analysis using Strategic Reports: An application to a school choice mechanism
Nikhil Agarwal and Paulo Somaini
NBER Working Paper No. 20775
December 2014, Revised October 2017
JEL No. C50,D47,I20
ABSTRACT
Several school districts use assignment systems that give students an incentive to misrepresent their
preferences. We find evidence consistent with strategic behavior in Cambridge. Such strategizing can
complicate preference analysis. This paper develops empirical methods for studying random utility
models in a new and large class of school choice mechanisms. We show that preferences are non-parametrically
identified under either sufficient variation in choice environments or a preference shifter. We then
develop a tractable estimation procedure and apply it to Cambridge. Estimates suggest that while 82%
of students are assigned to their stated first choice, only 72% are assigned to their true first choice
because students avoid ranking competitive schools. Assuming that students behave optimally, the
Immediate Acceptance mechanism is preferred by the average student to the Deferred Acceptance
mechanism by an equivalent of 0.08 miles. The estimated difference is smaller if beliefs are biased,
and reversed if students report truthfully.
Nikhil Agarwal
Department of Economics, E52-460
MIT
77 Massachusetts Ave
Cambridge, MA 02139
and NBER
agarwaln@mit.edu
Paulo Somaini
Stanford Graduate School of Business
Knight Management Center
655 Knight Way E372D
Stanford, CA 94305
and NBER
soma@stanford.edu

A data appendix is available at http://www.nber.org/data-appendix/w20775

1

Introduction

Admissions to public schools throughout the world is commonly based on assignment mechanisms that use reported rankings of various schooling options (Abdulkadiroglu and Sonmez,
2003). The design of such school choice mechanisms has garnered significant attention in the
theoretical literature (Abdulkadiroglu, 2013). Although mechanisms that incentivize truthful revelation of preferences have been strongly advocated for in the theoretical literature (see
Pathak and Sonmez, 2008; Azevedo and Budish, 2017, for example), with rare exceptions,
real-world school choice systems are susceptible to gaming. Table I presents a partial list of
mechanisms in use at school districts around the world. To our knowledge, only Boston and
Amsterdam currently employ mechanisms that are not manipulable.
The widespread use of manipulable school choice systems poses two important questions. First, what are the costs and benefits of manipulable mechanisms from the student
assignment perspective? Theoretical results on this question yield ambiguous answers. Abdulkadiroglu et al. (2011) use a stylized model to show that strategic choice in the Immediate
Acceptance mechanism, also known as the (old) Boston mechanism, can effectively elicit cardinal information on preferences and can improve average student welfare. However, this
potential benefit comes at a cost of violating notions of fairness and stability of the final
assignments. Second, how does one interpret and analyze administrative data on reported
rankings generated by these mechanisms if the reports cannot be taken as truthful? Information on preferences can be useful for academic research on the effects of school choice on
student welfare (Abdulkadiroglu et al., 2017a), student achievement (Hastings et al., 2009),
and school competition (Nielson, 2013). Additionally, student preference information can
also be useful for directing school reforms by identifying which schools are more desirable
than others.1 However, ignoring strategic incentives for such purposes can lead to incorrect
conclusions and mis-directed policies.2
This paper addresses these two questions by developing a general method for estimating
the underlying distribution of student preferences for schools using data from manipulable
mechanisms and by applying these techniques to data from elementary school admissions
1

School accountability and improvement programs and district-wide reforms often use stated rank-order
lists as direct indicators of school desirability or student preferences. Bostonâ€™s Controlled Choice Plan
formally used the number of applications to a school as an indicator of school performance in an improvement
program. Similarly, Glenn (1991) argues that school choice caused improvements in the Boston school system
based on observing an increase in the number of students who were assigned to their top choice.
2
Previous empirical work has typically assumed that observed rank-order lists are a truthful representation
of the studentsâ€™ preferences (Hastings et al., 2009; Abdulkadiroglu et al., 2017a; Ayaji, 2017), allowing a direct
extension of discrete choice demand methods. The assumption is usually motivated by arguing that strategic
behavior may be limited in the specific environment. A handful of contemporaneous papers discussed below
allow for agents to be strategic (He, 2014; Calsamiglia et al., 2017; Hwang, 2016).

1

in Cambridge, MA. We make several methodological and empirical contributions. First, we
document strategic behavior to show that student reports respond to the incentives present
in the mechanism. Second, we propose a new revealed preference method for analyzing the
reported rank-order lists of students. We use this technique to propose a new estimator for
the distribution of student preferences and to derive its limit properties. These technical
results are applicable to a broad class of school choice mechanisms that includes the systems
listed on Table I, except for the Top Trading Cycles mechanism. Third, we derive conditions
under which the distribution of preferences is non-parametrically identified. Finally, we
apply these methods to estimate the distribution of preferences in Cambridge, which uses
an Immediate Acceptance mechanism. These preference estimates can then be used to
analyze how often students are assigned to their true first choice school and to compare the
outcomes under the current mechanism to an alternative that uses the student-proposing
Deferred Acceptance mechanism.
Interpreting observed rank-order lists requires a model of agent behavior. Anecdotal
evidence from Boston (Pathak and Sonmez, 2008) and laboratory experiments (Chen and
Sonmez, 2006; Calsamiglia et al., 2010) suggest that strategic behavior may be widespread in
manipulable school choice systems. Indeed, our analysis of ranking behavior for admissions
into public elementary schools in Cambridge indicates significant gaming. There are strong
incentives for behaving strategically in Cambridge. Because Cambridge uses an Immediate
Acceptance Mechanism, some schools are rarely assigned to students who rank it second,
while others have spare capacity after all students have been considered. Students therefore
may lose their priority at a competitive school if they do not rank it first. We investigate
whether students appear to respond to these incentives by using a regression discontinuity
design based on the fact that students receive proximity priority at the two closest schools.
We find that student ranking behavior changes discontinuously with the change in priority.
This result is not consistent with a model in which students rank schools in order of their
true preferences if residential decisions are not made in consideration of proximity priority.
Reassuringly, we do not find evidence that aggregate residential decisions or house prices are
affected by this priority.
Therefore, instead of interpreting reported rank-order lists as true preferences, we assume
that the report corresponds to an optimal choice of a lottery over assignments to various
schools. The lottery implied by a rank-order list consists of the probabilities of getting
assigned to each of the schools on that list. These probabilities depend on the studentâ€™s
priority type and report, a randomly generated tie-breaker, and the reports and priorities
of the other students. Given a belief for the assignment probabilities corresponding to each
rank-order list, the expected utility from the chosen lottery must be greater than other
2

lotteries the agent could have chosen. We begin by assuming that students best respond
to the strategies of other students. This rational expectations assumption is an important
baseline that accounts for strategic behavior. However, we also consider models in which
students have less information or have biased beliefs. First, we consider a model in which
agents are unaware of the fine distinctions in the mechanism between various priority and
student types. Second, we consider a model with adaptive expectations in which beliefs are
based on the previous year. In an extension, we also estimate a mixture model with both
naÄ±Ìˆve and sophisticated players.
Once a model of strategic behavior has been assumed, it is natural to ask whether it can
be used to learn about the distribution of preferences using a typical dataset. To address this
question, we study identification of a flexible random utility model that allows for student and
school unobservables (see Block and Marshak, 1960; McFadden, 1973; Manski, 1977). Under
the models of agent beliefs discussed above, estimates of assignment probabilities obtained
from the data can be substituted for the studentsâ€™ beliefs. As we discuss later, consistent
estimates of the assignment probabilities (as a function of reports and priority types) can
be obtained using the data and the knowledge of the mechanism. Our results show that,
given estimated assignment probabilities, two types of variation can be used to learn about
the distribution of preferences. The first is variation in choice environments that may arise
when two identical populations of students face different mechanisms or a different number
of school seats. We characterize the identified set of preference distributions under such
variation. The second form of variation assumes the availability of a special regressor that is
additively separable in the indirect utility function. Such a regressor can be used to â€œtraceoutâ€ the distribution of preferences (Manski, 1985; Matzkin, 1992; Lewbel, 2000). Similar
assumptions are commonly made to identify preferences in discrete choice models. In our
application, we use distance to school as a shifter of preferences. Our empirical specification
therefore rules out within-district residential sorting based on unobserved determinants of
school preferences. This assumption is commonly made in the existing empirical work on
school choice and models of joint schooling and residential decisions is left for future work.3
This analysis naturally suggests a two-step estimation procedure for estimating the distribution of preferences. In a first step, we estimate the lottery over school assignments
associated with each report and priority type. In a second step, we estimate the parameters
3

We investigated whether house prices or the fraction of residential units occupied by Cambridge elementary school students is higher on the side of a priority zone boundary where priority is accorded at a
better performing school. Our results suggest that priorities are not a strong enough driver of residential
decisions to generate differences in house prices or the aggregate number of families locating in an area.
These findings are consistent with families not paying attention to the details of the admissions system at
the time of choosing where to live. Details available upon request.

3

governing the distribution of preferences using a likelihood based method. Specifically, we
implement a Gibbsâ€™ sampler adapted from McCulloch and Rossi (1994). This procedure is
convenient in our setting because the set of utility vectors for which a given report is optimal can be expressed in terms of linear inequalities, and it allows us to avoid computing or
simulating the likelihood that a report is optimal given a parameter vector. In an appendix,
we prove that our estimator is consistent and asymptotically normal. The primary technical
contribution is a limit theorem for the estimated lotteries. This result requires a consideration of dependent data because assignments depend on the reports of all students in the
market. That school choice mechanisms are usually described in terms of algorithms rather
than functions with well-known properties further complicates the analysis. We solve this
problem for a new and large class of school choice mechanisms that includes all mechanisms
in table I, except the Top Trading Cycles mechanism.
We then apply our methods to estimate student preferences in Cambridge in order to address a wide range of issues. First, we investigate the extent to which students avoid ranking
competitive schools in order to increase their chances of assignment at less competitive options. Prevalence of such behavior can result in mis-estimating the attractiveness of certain
schools if stated ranks are interpreted at face value. Ignoring strategic behavior may therefore result in inefficient allocation of public resources for improving school quality. Further,
a large number of students assigned to their first choice may not be an indication of student
satisfaction or heterogeneity in preferences. We therefore also report on whether strategic
behavior results in fewer students being assigned to their true first choice as compared to
their stated first choice.
Second, we study the welfare effects of switching to the student proposing Deferred Acceptance mechanism. The theoretical literature supports strategy-proof mechanisms on the
basis of their simplicity, robustness to information available to participants, and fairness
(see Azevedo and Budish, 2017, and references therein). However, it is possible that ordinal
strategy-proof mechanisms compromise student welfare by not screening students based on
the intensity of their preferences (Miralles, 2009; Abdulkadiroglu et al., 2011). We quantify
student welfare from the assignment under these two mechanisms under alternative models of agent beliefs and behavior. This approach abstracts away from potential costs of
strategizing and acquiring information, which are difficult to quantify given the available
data. Nonetheless, allocative efficiency is a central consideration in mechanism choice, along
with other criteria such as differential costs of participating, fairness, and strategy-proofness
(Abdulkadiroglu et al., 2009).
Our baseline results, which assume equilibrium behavior, indicate that the average student prefers the assignments under the Cambridge mechanism to the Deferred Acceptance
4

mechanism. Interestingly, this difference is driven by paid-lunch students, who face stronger
strategic incentives than free-lunch students because of quotas based on free-lunch eligibility.
A cost of improved assignments in Cambridge is that some students (2-10% depending on the
specification and the student group) have justified envy.4 We then evaluate the mechanisms
assuming that agents have biased beliefs about assignment probabilities. These estimates
suggest that biased beliefs may mitigate the screening benefits of the Cambridge mechanism
because mistakes can be costly in some cases.
Finally, we evaluate a mixture model with naÄ±Ìˆve and sophisticated agents to assess the
distributional consequences across agents who vary in their ability to game the mechanism.
We estimate that about a third of paid-lunch and free-lunch students report their preferences
sincerely even if it may not be optimal to do so. Although naÄ±Ìˆve agents behave suboptimally,
we find that the average naÄ±Ìˆve student prefers the assignments under the Cambridge mechanism. This occurs because naÄ±Ìˆve students rank their most preferred school first and gain
priority at this school at the cost of sophisticates who avoid ranking these schools. The cost
of not receiving their true second or third choices turns out to be smaller than this benefit.
Related Literature
These empirical contributions are closely related to a handful of recent papers that estimate
preferences for schools using manipulable mechanisms (He, 2014; Calsamiglia et al., 2017;
Hwang, 2016). He (2014) proposes an estimator based on theoretically deriving properties of
undominated reports using specifics of the school choice implementation in Beijing.5 Hwang
(2016) proposes a subset of restrictions on agent behavior based on simple rules to derive
a bounds-based estimation approach. Compared to our procedure, these approaches avoid
using restrictions that are implied if agents have information about which schools are more
competitive than others. Calsamiglia et al. (2017) estimates a mixture model in which
strategic agents solve for the optimal report in an Immediate Acceptance mechanism using
backwards-induction from lower- to higher-ranked choices.
There are a few other general distinguishing features from the aforementioned papers
worth noting. First, most papers mentioned above use approaches that are specifically
tailored to the school choice mechanism analyzed, and it may be necessary for a researcher
to modify the ideas before applying them elsewhere. In contrast, we allow analysis for a more
general class of mechanisms, including mechanisms with student priority groups. Second,
Student i has justified envy if another student i0 is assigned to a school j that student i prefers to her
assignment and student i has (strictly) higher priority at j than student i0 .
5
The estimators proposed in He (2014) that do not assume optimal play are based on a limited number of
restrictions implied by rationality, the specific number of schools and ranks that can be submitted in Beijing
based on the fact that the school district treats all agents symmetrically.
4

5

results on identification and large market properties of the estimator are not considered in
the papers mentioned above. Finally, our empirical exercise investigates the consequences of
specific forms of subjective beliefs on the comparison between mechanisms.
Our technical results on the large sample properties of our estimator use results from the
work on large matching markets by Azevedo and Leshno (2016) and Azevedo and Budish
(2017). The results on identification build on work on discrete choice demand (Manski, 1985;
Matzkin, 1992; Lewbel, 2000; Berry and Haile, 2010). While the primitives are similar, unlike
discrete choice demand, the probability of assignment to a schools may not be 0 or 1. This
feature is similar to estimation of preference models under risk and uncertainty (Cardon and
Hendel, 2001; Cohen and Einav, 2007; Chiappori et al., 2012). Cardon and Hendel (2001)
and Cohen and Einav (2007) model uncertainty in outcomes within each insurance contract
rather than uncertainty over which option is ultimately allocated. Chiappori et al. (2012)
focuses on risk attitudes rather than the value of underlying prizes.
Our paper provides an empirical complement to the large theoretical literature that has
taken a mechanism design approach to the student assignment problem (Gale and Shapley,
1962; Shapley and Scarf, 1974; Abdulkadiroglu and Sonmez, 2003). A significant literature debates the trade-offs between manipulable and non-manipulable mechanisms (Ergin
and Sonmez, 2006; Pathak and Sonmez, 2008; Miralles, 2009; Abdulkadiroglu et al., 2011;
Featherstone and Niederle, 2016; Troyan, 2012; Pathak and Sonmez, 2013). Theoretical results from this literature have been used to guide redesigns of matching markets (Roth and
Peranson, 1999; Abdulkadiroglu et al., 2006, 2009).
A growing literature is interested in methods of analyzing preferences in matching markets, usually using pairwise stability (Choo and Siow, 2006; Fox, 2010, 2017; Chiappori et al.,
2017; Agarwal, 2015; Diamond and Agarwal, 2016). In some cases, estimates are based on
the strategic decision to engage in costly courting decisions (Hitsch et al., 2010). Similar
considerations are important when applying to colleges (Chade and Smith, 2006).
The proposed two-step estimator uses insights from the industrial organization literature,
specifically the estimation of empirical auctions (Guerre et al., 2000; Cassola et al., 2013),
single agent dynamic models (Hotz and Miller, 1993; Hotz et al., 1994), and dynamic games
(Bajari et al., 2007; Pakes et al., 2007; Aguirregabiria and Mira, 2007). As in the methods
used in those contexts, we use a two-step estimation procedure where the distribution of
actions from other agents is used in a first step estimator.
Overview
Section 2 describes the Cambridge Controlled Choice Plan and presents evidence that students are responding to strategic incentives provided by the mechanism. Sections 3 and 4
6

present the model and the main insight on how to use submitted rank-order lists. Section
5 and Section 6 discuss identification and estimation. A reader solely interested in the empirical application instead of the econometric techniques may skip these sections. Section 7
applies our techniques to the dataset from Cambridge, MA.

2

Evidence on Strategic Behavior

2.1

The Controlled Choice Plan in Cambridge, MA

We use data from the Cambridge Public Schoolsâ€™ (CPS) Controlled Choice Plan for the
academic years 2004-2005 to 2008-2009. Elementary schools in the CPS system assigns
about 41% of the seats through partnerships with pre-schools or an appeals process for
special needs students. We focus on the remaining seats that are assigned through a school
choice system that takes place in January for students entering kindergarten.
Table II summarizes the students and schools. The system has 13 schools and about
400 students participating per year. One of the schools, Amigos, was divided into bilingual
Spanish and regular programs in 2005. Bilingual Spanish speaking students are considered
only for the bilingual program, and non-bilingual students are considered only for the regular
program.6 King Open OLA is a Portuguese immersion school open to all students. Tobin, a
Montessori school, divided admissions for four- and five-year olds starting in 2007.
An explicit goal of the Controlled Choice Plan is to achieve socio-economic diversity
by maintaining the proportion of students who qualify for the federal free/reduced lunch
program in each school close to the district-wide average. Only for the purposes of the assignment mechanism, all schools except Amigos are divided into paid-lunch and free/reduced
lunch programs. Students eligible for federal free or reduced lunch are only considered for
the corresponding program.7 About 34% of the students are on free/reduced lunch. Each
program has a maximum number of seats, and the overall school capacity may be lower than
the sum of the seats in the two programs. Our dataset contains both the total number of
seats in the school as well as the seats available in each of the programs.
The Cambridge Controlled Choice Mechanism
We now describe the process used to place students at schools. It prioritizes students based
on two criteria:
6

A student voluntarily declares whether she is bilingual on the application form.
Households with income below 130% (185%) of the Federal Poverty line are eligible for free (reduced)
lunch programs. For a household size of 4, the annual income threshold was approximately $27,500 ($39,000)
in 2008-2009.
7

7

(i) Students with siblings who are attending that school get the highest priority.
(ii) Students receive priority at the two schools closest to their residence.
Students can submit a ranking of up to three programs at which they are eligible. Cambridge
uses an Immediate Acceptance mechanism and assigns students as follows:
Step 0: Draw a single tie-breaker for each student
Step k = 1,2,3: Each school considers all students who have not been previously assigned
and have listed it in the k-th position. Students are sorted in order of priority, breaking
ties using a random tie-breaker. Each student is considered sequentially for the paidlunch program if she is not eligible for a federal lunch subsidy and for the free/subsidized
lunch program otherwise. She is assigned to the corresponding program unless,
(a) There are no seats available in the program, or
(b) There are no seats available in the school.
If either of the conditions above are satisfied, the student is rejected.
There are a few notable features of this mechanism. First, the mechanism prioritizes
students at higher-ranked options. The effective priority therefore depends on the report
of the student. Second, there is a cutoff for each program/school, and all students with an
effective priority below that cutoff are rejected. This cutoff is set so that the number of
students assigned to the program/school does not exceed its capacity. Finally, students are
assigned to the highest-ranked option for which their effective priority is above the cutoff.
These features of the Cambridge Controlled Choice Plan are shared with a large class
of mechanisms that we will formally introduce below. There are two clear reasons why
there may be strategic incentives in such mechanisms. First, the dependence of the effective
priority on the report provides incentives to skew ranking towards options where priority
is most valuable. Second, if the length of the list is limited, students should avoid ranking
too many schools where their priority is likely to be below the cutoff. We now describe the
ranking behavior and document strategic decision-making in response to these incentives in
Cambridge.

2.2

Evidence on Ranking Behavior and Strategic Incentives

Panels A and D in table III show that over 80% of the students rank the maximum allowed
number of schools and over 80% of the students are assigned to their top-ranked choice in a
8

typical year. Researchers in education have interpreted similar statistics in school districts
as indicators of student satisfaction and heterogeneity in student preferences. For instance,
Glenn (1991) argues that school choice caused improvements in the Boston school system
based on an observed increase in the number of students who were assigned to their top
choice.8 Similarly, Glazerman and Meyer (1994) interpret a high fraction of students getting
assigned to their top choice in Minneapolis as indicative of heterogeneous student preferences.
Conclusions based on interpreting stated preferences as truthful are suspect when a mechanism provides strategic incentives for students. For example, it is tempting to conclude from
ranking patterns in panels E and F that students have extremely strong preferences for attending a nearby school or the same school as their sibling. However, such behavior can also
be driven by strategic incentives if a student â€œloses her priorityâ€ when a school is not ranked
at the top of the list in an Immediate Acceptance Mechanism (Ergin and Sonmez, 2006).
Indeed, table IV shows that the incentive to â€œcash the priorityâ€ is strong. While there
is significant heterogeneity in their competitiveness, panel A shows that Baldwin, Haggerty,
Amigos, Morse, Tobin, Graham & Parks, and Cambridgeport have many more students
ranking them than there is capacity. A typical student would be rejected in these schools if
she does not rank it as her top choice. Indeed, Graham & Parks rejected all non-priority paid
lunch students even if they had ranked it first in each of the five years. Additionally, panels
B and C show that the competitiveness of schools differs by paid-lunch status. Graham &
Parks, for instance, did not reject any free/reduced lunch students who applied to it in a
typical year. Overall, a larger number of schools are competitive for paid-lunch students
than for free-lunch students.
There are two other features that are worth highlighting. First, most schools either reject
all students who did not rank them first or do not reject any students. Therefore, students
must rank competitive school first in order to gain admission but may rank non-competitive
schools at any position. This suggests that, at least in Cambridge, considering which school
to rank first is important. Second, table IV shows that several paid-lunch students rank
competitive schools as their second or third choice. This may appear hard to rationalize
as optimal behavior. However, it should be noted that these choices are often not pivotal
because an extremely large number of students are assigned to their top choice. Another
possibility is that these students count on back-up schools, either at the third-ranked school
or at a private or charter school, in case they remain unassigned. Finally, students may
simply believe that there is a small chance of assignment even at competitive schools. We
further discuss these issues when we present our estimates.
8

The argument is based on ranking and assignment data generated when Boston used a manipulable
assignment system.

9

2.3

Strategic Behavior: A Regression Discontinuity Approach

We now study whether students are ranking schools strategically. Our empirical strategy
is based on the assignment of proximity priority in Cambridge. A student receives priority
at the two closest schools to her residence. We can therefore compare the ranking behavior
of students who are on either side of a geographical boundary where the proximity priority
changes. If students are not behaving strategically and the distribution of preferences are
continuous in distance to school, we would not expect the ranking behavior to change discretely at this boundary. On the other hand, the results in table IV indicate that a student
may lose her proximity priority at competitive schools if she does not rank it first. Therefore, some students may find it optimal to manipulate their reports in order to avoid losing
proximity priority. Strategic students may rank a competitive school at which they have
priority as their first choice instead of their most preferred school.
Figure I and table V present the results of this discontinuity design. The figure plots the
probability of ranking a school in a particular position against the distance from a proximity
priority boundary. Specifically, let di2 and di3 be the second and third closest schools to
student i. For any school j, the horizontal axis is the difference âˆ†dij = dij âˆ’ 12 (di2 + di3 ).
Because Cambridge assigns a student priority at the two closest schools, âˆ†dij is negative
if student i has priority at school j and positive otherwise. The vertical line represents
this boundary of interest where we assess ranking behavior. The black dashed lines are
generated from a local linear regression of the ranking outcome yij on the distance from this
boundary, âˆ†dij , estimated separately using data on either side of the boundary. The black
points represent a bin-scatter plot of these data, with a 95% confidence interval depicted with
the bars. The gray points control for school fixed effects. Table V presents the estimated
size of the discontinuity using the procedure recommended by Imbens and Kalyanaraman
(2011) and their test of whether the outcome studied changes discontinuously at a priority
boundary.
Figure I(i) shows that the probability that a student ranks a school first decreases discontinuously at the proximity boundary. Further, the response to distance to school is also
higher to the left of the boundary, probably reflecting the preference to attend a school closer
to home. The jump at the boundary may be attenuated because a student can rank only one
of the two schools where she has priority as her top choice.9 In contrast to figure I(i), I(ii)
and I(iii) do not show a large jump in the probability that a school is ranked second or third.
This should be expected because we saw earlier that oneâ€™s priority is unlikely to be pivotal
in the second or third choices. Further, the probability of ranking a school that is extremely
9

Figure D.I(i) in the appendix focuses on the second and third closest schools and shows that the discontinuity is still discernible.

10

close to a studentâ€™s home in the second or third position is low because students tend to
rank nearby schools first. Table V presents the estimated size of this discontinuity. The
first column shows that the probability that a school is ranked first drops by 5.75% at the
boundary where the student loses proximity priority. This effect is statistically significant
at the 1% level. Further, panels B and C of the table show that this change is larger for
paid lunch students than for free lunch students. This is consistent with the theory that
paid lunch students are responding to the stronger strategic incentives as compared to free
lunch students. The next two columns present these estimates for the second- and thirdranked choices. As expected, the estimated effects here are smaller and often not statistically
significant.
Strategic pressures to rank a school first may be particularly important if the school is
competitive. Figures I(iv) and I(v) investigate the differential response to proximity priority
by school competitiveness. We split the schools based on whether they rejected some students
in a typical year or not as delineated in table IV. Consistent with strategic behavior, figure
I(iv) shows that the probability of ranking a competitive school first falls discontinuously at
the boundary but less so in figure I(v), which focuses on non-competitive schools. Indeed,
the fourth and fifth columns of table V confirm that the estimated drop in the probability
of ranking a competitive schools first is 7.27%, which is larger than the overall estimate.
Additionally, panels B and C of table V shows that the estimated response to proximity
priority is larger for paid-lunch students at 11.07% as compared to 1.47% for free-lunch
students.10 Non-competitive schools, in stark contrast, have an statistically insignificant estimated drop of only 2.06%, which is consistent with strategic pressures being less stringent.
However, we view the estimated effects at non-competitive schools for free-lunch students
as inconclusive because the point estimates are large but imprecise. The findings are therefore consistent with paid-lunch students responding to significant strategic pressures in the
Cambridge mechanism, but not free-lunch students because of the lower strategic pressure
they face.
Finally, we consider a placebo test in which we repeat the analysis assuming that proximity priority is only given at the closest school. Figure I(vi) shows no discernible difference
in the ranking probability at this placebo boundary. The estimated size of the discontinuity,
presented in the last column of table V, is only 0.07% and statistically indistinguishable from
zero. Figure D.I(iv) in the appendix presents a second placebo boundary, dropping the two
closest schools and constructing priorities at the two closest remaining schools. As expected,
we do not find a discontinuous response at this placebo boundary.
Taken together, these results strongly suggest that ranking behavior is discontinuous at
10

Figures D.I (ii) and D.I(iii) in the appendix show the corresponding plots by free-lunch status.

11

the boundary where proximity priority changes. However, there are two important caveats
that must be noted before concluding that agents in Cambridge are behaving strategically.
First, the results do not show that all students are responding to strategic incentives in
the mechanism or that their expectations are correct. We therefore consider models with
biases in beliefs and non-optimal behavior in addition to a rational expectations model.
Second, it is possible that the response is driven in part by residential choices, with parents
picking a home so that the student receives priority at a more preferred school. While the
previous literature has found evidence of residential sorting across school districts (Black,
1999; Bayer et al., 2007), we are not aware of any research on the effects of priorities on the
housing market within a unified school district. A boundary discontinuity design similar to
Black (1999) suggests that neither house prices nor the aggregate number of families in an
area are related to priorities.11 A more thorough analysis of this issue or a full model that
considers the joint residential and school choice decision is left for future research.
These results contrast with Hastings et al. (2009), who find that the average quality of
schools ranked did not respond to a change in the neighborhood boundaries in the year the
change took place. As suggested by Hastings et al. (2009), strategic behavior may not be
widespread if the details of the mechanism and the change in neighborhood priorities are
not well advertised. Note that the Charlotte-Mecklenburg school district did not make the
precise mechanism clear. In contrast, Cambridgeâ€™s Controlled Choice Plan is published on
the school districtâ€™s website and has been in place for several years. These institutional
features may account for the differences in the student behavior.

3

Model

We consider school choice mechanisms in which students are indexed by i âˆˆ {1, . . . , n},
programs indexed by j âˆˆ {0, 1, . . . , J} = J , and schools are indexed by s âˆˆ S. Program
0 denotes being unmatched. Each program or school, k âˆˆ J âˆª S, has n Ã— qkn seats, with
P
qkn âˆˆ (0, 1) and q0 = 1.12 The school capacities are such that qsn â‰¤ {j:sj =s} qjn , where s âˆˆ S
and sj is the school corresponding to program j. We now describe how students are assigned
to these seats, their preferences over assignments, and assumptions on behavior.
11

Details available upon request. Note that the proximity priority system for kindergarten admission is
not used for higher grades in Cambridge.
12
This convention will be convenient because we will be considering limits as n â†’ âˆž, in which qkn â†’ qk âˆˆ
(0, 1).

12

3.1

Utilities and Preferences

We assume that student iâ€™s utility from assignment into program j is given by V (zij , Î¾j , i ),
where zij is a vector of observable characteristics that may vary by program or student or
both, and Î¾j and i are (vector-valued) unobserved characteristics. Let vi = (vi1 , . . . , viJ ) be
the random vector of indirect utilities for student i with conditional joint density fV (vi1 , . . . , viJ |Î¾, zi ),
where Î¾ = (Î¾1 , . . . , Î¾J ) and zi = (zi1 , . . . , ziJ ). We normalize the utility of not being assigned
through the assignment process, vi0 , to zero. Therefore, vi0 is best interpreted as the inclusive
value of remaining unassigned and participating in the post-assignment wait-list.
This formulation allows for heterogeneous and non-additive preferences conditional on
observables. The primary restriction thus far is that a studentâ€™s indirect utility depends
only on her own assignment and not on the assignments of other students. This rules out
preferences for peer groups or for conveniences that carpool arrangements may afford.
Except when explicitly noted, we assume that the set of observables zij âˆˆ RKz can be
partitioned into zij2 âˆˆ RKz âˆ’1 and zij1 âˆˆ R. The indirect utility function is additively separable
in zij1 :
V (zij , Î¾j , i ) = U (zij2 , Î¾j , i ) âˆ’ zij1 .
(1)
1
1
), which implies that any unobserved characteristics that
, . . . , ziJ
We assume that i âŠ¥ (zi1
affect the taste for schools is independent of z 1 . This representation normalizes the scale of
utilities by setting the coefficient on zij1 to âˆ’1. The model is observationally equivalent to one
with student-specific tastes, Î±i , for zij1 as long as it is negative for all i. The term zij1 in this
representation is sometimes referred to as a special regressor (Manski, 1985; Matzkin, 1992;
Lewbel, 2000). The combination of the additively separable form and the independence of
i is the main restriction in this formulation.
In the school choice context, this assumption needs to be made on a characteristic that
varies by student and school. We follow a common approach in the school choice literature
by assuming that distance to school is additively separable and independent of unobserved
student preferences (see Abdulkadiroglu et al., 2017a, for instance). The independence assumption is violated if unobserved determinants of student preferences simultaneously determine residential choices. As mentioned earlier, we do not find evidence that school choice
incentives in Cambridge affect house prices or aggregate residential decisions. Nonetheless,
the potential for interactions between school and residential choice warrants further research.
Our empirical approach will include fixed-effects for whether a student has priority at a school
as a determinant of preference to partially control for residential choice.
While our identification results do not make parametric assumptions on utilities, we

13

specify student iâ€™s indirect utility for school j in the empirical application as
vij =

K
X

Î²kj zijk âˆ’ dij + Îµij

(2)

k=1

vi0 = 0,
where dij is the road distance between student iâ€™s home and school j; zijk are studentschool specific covariates; Î²kj are school-specific parameters to be estimated; and Îµi =
(Îµi1 , . . . , ÎµiJ ) âˆ¼ N (0, Î£) independently of z, d.13 The scale normalization is embedded in
the assumption that the coefficient on dij is âˆ’1. Our estimated specification constructs zijk
by interacting indicators of student paid-lunch status, sibling priority, proximity priority,
ethnicity, home-language, and a constant with school-specific dummies.14

3.2

Assignment Mechanisms

School choice mechanisms typically use submitted rank-order lists and student priority types
to determine final assignments. Let Ri âˆˆ Ri be a rank-order list, where jRi j 0 indicates that
j is ranked above j 0 .15 Students, if they so choose, may not submit a report in which the
most preferred schools are ranked in order of true preferences. Let student iâ€™s priority type
be denoted ti âˆˆ T . In Cambridge, ti is defined by the free-lunch type, the set of schools
where the student has proximity priority, and whether or not the student has a sibling in
the school.16
A mechanism is usually described as an outcome of an algorithm that takes these rankorder lists and priorities as inputs. It will be convenient for our analysis to define a mechanism
as a function that depends on the number of students n.
n
Definition 1. A mechanism is a function Î¦n : Rn Ã— T n â†’ âˆ†J such that for all (Ri , ti ),
Râˆ’i = (R1 , . . . , Riâˆ’1 , Ri+1 , . . . , Rn ) and Tâˆ’i = (t1 , . . . , tiâˆ’1 , ti+1 , . . . , tn ), Î¦nij ((Ri , ti ), (Râˆ’i , Tâˆ’i ))
denotes the probability that i is assigned to program j.
Therefore, the assignment probabilities for each student depends on her report, her pri13

Our specification allows for heteroskedastic errors Îµij and arbitrary correlation between Îµij and Îµij 0 . This
specification relaxes homoskedastic and independent preference shocks commonly used in logit specifications.
14
The school-specific dummies interacted with the constant subsume the unobservable Î¾j .
15
The set Ri may depend on the studentâ€™s priority type ti and may be constrained. For example, students
in Cambridge can rank up to three schools, and programs are distinguished by paid-lunch status of the
student.
16
We assume that students take their priority type as given. Cambridge verifies residence and free-lunch
eligibility using documentary evidence. Because most schools are less competitive for free-lunch students
and the classes of instruction are not split by free-lunch status, it is unlikely that not declaring free-lunch
eligibility is beneficial for an eligible student.

14

ority type as well as the reports and priority types of the other students. In addition, the
final outcome depends on a random number used to break ties between students. As we
demonstrate below, a student can face uncertainty about both the reports of other students
as well as the tie-breaker.
In Cambridge, Î¦n ((Ri , ti ), (Râˆ’i , Tâˆ’i )) is determined by a cutoff rule and the effective
priority of the student, which depends on her report. Specifically, the priority of student i
at school j is
tij + Î½i
3 âˆ’ Ri (j) +
4 ,
eij = fj (Ri , ti , Î½i ) =
3
where Î½i âˆˆ [0, 1] is student iâ€™s draw of the random tie-breaker, Ri (j) is the position of school
j in the rank-order list Ri ,17 and tij is respectively 0, 1, 2 or 3 if the student has no priority,
proximity priority only, sibling priority only, or both proximity and sibling priority. The
function f chosen for Cambridge ensures that students who rank a school higher than other
students are given precedence, with ties broken first by proximity and/or sibling priority,
and then by the random tie-breaker.
Given the priorities eij above, let pj be the highest priority student who was rejected at
program j. The algorithm described in Section 2.1 places student i in program j if eij > pj
and student i ranks program j above any other program j 0 , with eij 0 > pj 0 . Hence, the
(R ,t ,Î½ )
algorithm assigns student i to program j if Dj i i i (p) = 1, where
(Ri ,ti ,Î½i )

Dj

(p) = 1{eij > pj , jRi 0}

Y

1{jRi j 0 or eij 0 â‰¤ pj 0 }

j 0 6=j

and eij = fj (Ri , ti , Î½i ).
The total fraction of students who would be assigned to program j if the cutoffs were p
1 P (Ri ,ti ,Î½i )
(p). Because the number of students assigned to
is therefore given by Dj (p) =
D
n i j
program j (likewise school s) cannot exceed the number of available seats n Ã— qjn (likewise
n Ã— qsn ), it is easy to verify that the cutoffs determined by the algorithm in Section 2.1 have
the following property.
Definition 2. The vector of cutoffs p âˆˆ [0, 1]J is market clearing for (D(p), q n ), if, for
each program j âˆˆ J ,
Dj (p) âˆ’ qjn â‰¤ 0,
17

Ri (j) is set to 4 if school j is not ranked.

15

with equality if pj > min{pj 0 : j 0 6= j, sj 0 = sj },18 and for each school s âˆˆ S,
X

Dj (p) âˆ’ qsn â‰¤ 0,

{j:sj =s}

with equality if min{pj : sj = s} > 0.
The first constraint ensures that program j has a cutoff larger than the other programs in
the same school only if a student was rejected because the program has exhausted its capacity.
The second constraint ensures that the lowest cutoff in the school is strictly positive only if
the school has exhausted its total capacity.
In fact, this representation of the assignments in terms of the market clearing cutoffs
and a priority that depends on a studentâ€™s report is not unique to Cambridge. Many school
choice mechanisms prioritize students based on their rank-order list and implement a cutoff
rule that rejects all students below a program/school specific threshold. We now formally
define a large class of mechanisms for which such a representation is valid.
Definition 3. The mechanism Î¦n is a Report-Specific Priority + Cutoff mechanism
if there exists a function f : R Ã— T Ã— [0, 1]J â†’ [0, 1]J and a measure Î³Î½ over [0, 1]J such that
(i) Î¦nj ((Ri , ti ), (Râˆ’i , tâˆ’i )) is given by
Z

Z
...

D(Ri ,ti ,Î½i ) (pn )dÎ³Î½1 . . . dÎ³Î½n ,

where f (Ri , ti , Î½i ) is the eligibility score vector for student i,
(ii) pn are market clearing cutoffs for (D(p), q n ), where D(p) =

1 P (Ri ,ti ,Î½i )
(p).
D
n i j

(iii) fj (Ri , ti , Î½i ) is strictly increasing in Î½ij and does not depend on Î½ij 0 for j 0 6= j.19
The representation highlights two ways in which these mechanisms can be manipulable.
First, the report of an agent can affect her eligibility score. Even with a fixed cutoff, agents
may have the direct incentive to make reports that may not be truthful. Second, even if
eligibility does not depend on the report, an agent may (correctly) believe that the cutoff
for a school will be high, making it unlikely that she will be eligible. If the rank-order list is
constrained in length, she may choose to omit certain competitive schools.20
We use the convention that min{pj 0 : j 0 6= j, sj 0 = sj } = 0 if {j 0 6= j, sj 0 = sj } = âˆ….
We can allow for a single tie-breaker (as in Cambridge) by ensuring that Î½ij and Î½ij 0 are perfectly
correlated.
20
The representation extends the characterization of stable matchings by Azevedo and Leshno (2016) in
18

19

16

Table I presents a partial list of school choice mechanisms currently used around the
world. As we show in Appendix B.1, all mechanisms in table I, except for the Top Trading
Cycles mechanism, belong to this class of cutoff-based mechanisms.21 A remarkable feature
is that these mechanisms differ essentially by the choice of f . The techniques we develop
below are applicable to this entire class.

3.3

Agent Beliefs and Best Responses

Evidence presented in Section 2 suggests that agents are responding to strategic incentives in
the Cambridge mechanism. To model this strategic behavior, we assume that agents submit
rank-order lists that are optimal given a set of beliefs about the probability of assignment at
various schools. We assume that agents have private information about their preferences, vi .
For an agent with priority type ti , let the lottery LÏƒRi ,ti âˆˆ âˆ†J consist of the believed assignment probabilities at various schools when other agents in the market follow the strategy Ïƒ
and she reports Ri . Because agents do not know the preferences of others in the market,
these beliefs do not depend directly on the preferences of others, vâˆ’i , or on the (realized)
reports of others, Râˆ’i . Instead, we specify these beliefs as a function of the mechanism and
the strategies of the other agents in the mechanism but will drop the dependence on these
objects for notational simplicity.
Given a preference vector vi âˆˆ RJ and priority type ti , the agentâ€™s expected utility from
reporting Ri is therefore vi Â· LRi ,ti .22 By choosing different rank-order lists, this agent can
choose lotteries in the set Lti = {LRi ,ti : Ri âˆˆ Ri } . Therefore, this agent reports Ri only if
vi Â· LRi ,ti â‰¥ vi Â· LRi0 ,ti , for all Ri0 âˆˆ Ri .

(3)

It is important to emphasize that optimality of Ri is with respect to the agentâ€™s belief about
her assignment probabilities, which may or may not be the true assignment probabilities
generated by the mechanism. In our application, we consider specifications with three alterterms of demand-supply and market clearing to discuss mechanisms. Particularly, we can use the framework
to consider mechanisms that produce matchings that are not stable. The representation may therefore be
of independent theoretical and empirical interest. For example, Abdulkadiroglu et al. (2017b) use a related
cutoff-based approach for evaluating achievement gains from attending various types of schools for the case
of the Deferred Acceptance Algorithm. Our representation suggests that it may be possible to extend their
techniques to the entire class of RSP+C mechanisms.
21
Leshno and Lo (2017) derive a cutoff representation for the Top Trading Cycles mechanism that does
not belong to the class of RSP+C mechanisms.
22
Although our model incorporates social interactions through L, it differs from a multinomial version of
Brock and Durlauf (2001) because we do not specify an idiosyncratic payoff shock for each possible report
Ri . Instead, we micro-found the expected utility of a report Ri through preferences for schools incorporated
in vi .

17

native forms of beliefs below.
3.3.1

Rational Expectations

Our baseline model assumes that agents have correct beliefs about the probabilities of assignments given their own type (v, t), the population distribution of types and the ranking
strategies used in the district. Specifically, let Ïƒ : RJ Ã— T â†’ âˆ†|R| be a (symmetric) mixed
strategy used by the students in the district.23 The first argument of Ïƒ is the vector of utilities over the various schools, and the second argument is the priority type of the student.
Each student believes that the lottery when she reports Ri âˆˆ Ri is given by
LRi ,ti = EÏƒ [Î¦n ((Ri , ti ), (Râˆ’i , Tâˆ’i ))|Ri , ti ]
X
Y
fÏƒ (Rk , tk )
=
Î¦n ((Ri , ti ), (Râˆ’i , Tâˆ’i ))

(4)

k6=i

(Râˆ’i ,Tâˆ’i )

where EÏƒ [Â·] denotes expectations taken over the random variable (Ri0 , ti0 ) for i0 6= i drawn
R
iid with probability fÏƒ (R, t) = fT (t) ÏƒR (V, t)dFV |T =t , and FV,T is the joint distribution of
preference and priority types in the population. As a reminder, the dependence of L on the
mechanism, Î¦n and the strategy, Ïƒ, have been suppressed for notational simplicity.
In this model of beliefs, the perceived probability of assignment depends on both the
tie-breaker in the mechanism and the distribution of reports by the other students in the
district. Therefore, a student perceives uncertainty due to both the reports submitted by
other students as well the uncertainty in the lotteries within in the mechanism. This contrasts
with models of complete information about the reports submitted by the other students,
where the latter form of uncertainty is not present.24 We believe that this model is more
realistic than a complete information model because students are unlikely to be aware of all
the reports that will be submitted by others. This assumption is commonly made in the
analysis of other non-dominant strategy mechanisms, for example, in empirical analysis of
auctions (Guerre et al., 2000; Cassola et al., 2013, among others).25
23

Note that when the distribution of utilities admits a density, a unique pure strategy is optimal except
for a measure zero set of types.
24
Complete information Nash Equilibrium models are common in the literature on assignment mechanisms
(see Ergin and Sonmez, 2006, for example). Results based on assuming that agents have knowledge of Râˆ’i
are both quantitatively and qualitatively similar to the ones presented here and are available on request.
25
Indeed, when all agents optimally respond to such beliefs, the behavior is consistent with a Bayesian
Nash Equilibrium:
âˆ—

âˆ—

Definition 4. The strategy Ïƒ âˆ— is a type-symmetric Bayesian Nash Equilibrium if vi Â·LÏƒRi ,ti â‰¥ vi Â·LÏƒR0 ,ti
âˆ—

Ïƒâˆ—
Ri0 ,ti

âˆ—
for all Ri0 âˆˆ Ri whenever ÏƒR
(vi , ti ) > 0, where LÏƒRi ,ti and L
i

18

i

are given by equation (4).

It is important to note that agents need not have beliefs over a very high dimensional
object in Report-Specific Priority + Cutoff Mechanisms in order to compute the assignment
probabilities and best responses. It is sufficient for agents to form beliefs over the distribution
of cutoffs for the various programs. Our empirical approach will use this feature to reduce
the dimension of the problem.26
3.3.2

Adaptive Expectations

Assuming rational expectations implies a strong degree of knowledge and sophistication.
One may reasonably argue that the primary source of information for parents may be based
on prior year information. We address this concern by considering the following alternative
model of agent beliefs:
LRi ,ti = EÏƒâˆ’1 [Î¦âˆ’1,n ((Ri , ti ), (Râˆ’i , Tâˆ’i ))|Ri , ti ]

(5)

where the notation âˆ’1 indicates the use of previous year quantities rather than the current
year. Specifically, we assume that the agents have knowledge about the previous year strategy
Ïƒ âˆ’1 , believe the school/program capacities are the same as the previous year, and that the
distribution of other student types are the same as the previous year as well.
Such beliefs may arise if agents form expectations about the competitiveness of various
schools based on the experiences of parents that participated in the previous year. Agents,
in this case, may be systematically mis-informed, for example, about increases or decreases
in capacity. Estimates from this model will be used to investigate whether the potential
screening benefits of manipulable mechanisms hinge crucially on agents forming rational
expectations.
3.3.3

Coarse Expectations

Another form of mis-information in the mechanism may be about the specific use of priorities
and the program quotas based on free/reduced lunch status. If agents are not informed about
these details of the mechanism, their expected probability of assignment given report Ri will
not depend on their priority type, ti . For example, beliefs that are based only on aggregate
information about the number of applicants and capacities at each school would have this
property.
26
Kapor et al. (2017) use a survey of students in New Haven to construct estimates of studentsâ€™ beliefs over
these cutoffs. They then extend our methods to estimate the preference distribution using these estimated
beliefs.

19

To address the possibility that beliefs are coarse, we consider a model in which an agent
believes that the lotteries are given by
L Ri =

X

EÏƒ [Î¦n ((Ri , ti ), (Râˆ’i , Tâˆ’i ))|Ri , ti ]f (ti ),

(6)

ti âˆˆT

where Ïƒ is the strategy used by the students in the district. Such beliefs may have distributional consequences and may undo some of the goals of the Controlled Choice Plan
of maintaining a diverse student mix within programs. It is possible that schools that are
popular among paid-lunch students, such as Graham & Parks, may be under-subscribed by
free/reduced lunch students because of such coarse beliefs.

4

A Revealed Preference Approach

This section illustrates the key insight that allows us to learn about the preferences of
students from their (potentially manipulated) report and presents an overview of our method
for estimating preferences. Equation (3) reveals that a studentâ€™s optimal choice, given her
priority type, depends on the assignment probabilities a student believes she can achieve by
altering her report. The choice of a report by a student is, therefore, a choice from the set
of lotteries,
L = {LRi : Ri âˆˆ Ri } ,
where the dependence on ti is dropped for simplicity. The various forms of beliefs described
in Section 3.3 specify particular values for LRi .
Assume, for the moment, that a studentâ€™s belief for the assignment probabilities is known
to the analyst, and consider her decision problem. Figure II illustrates an example with
two schools and an outside option. Each possible report corresponds to a probability of
assignment into each of the schools and a probability of remaining unassigned. Figure II(i)
depicts three lotteries LR , LR0 , LR00 corresponding to the reports R, R0 and R00 respectively
on a unit simplex.27 The dashed lines show the linear indifference curves over the lotteries for
an agent with a utility vector parallel to the vector a. A student with a utility vector parallel
to aR will therefore find LR optimal (figure II(ii)). A student who is indifferent between LR
and LR0 must have indifference curves that are parallel to the line segment connecting the
two points and, therefore, a utility vector that is parallel to aR,R0 (figure II(ii)). Likewise,
students with a utility vector parallel to aR,R00 are indifferent between LR and LR00 . In fact,
LR is optimal for all students with utility vectors that are linear combinations of aR,R0 and
27

The simplex is often referred to as the Marschak-Machina triangle.

20

aR,R00 with positive coefficients. A similar reasoning can be applied to LR0 and LR00 , resulting
in the vector aR0 ,R00 depicted in figure II(iii). We now turn our attention to utility space in
figure II(iv). The rays starting from the origin and parallel to each of these vectors partition
this space. As argued above, LR is optimal for students with utility vectors v âˆˆ CR , for
example if v is parallel to aR . In symbols, for any J and set of lotteries L, choosing LR is
optimal if and only if the utility vector belongs to the cone:
CR = {v âˆˆ RJ : v Â· (LR âˆ’ LR0 ) â‰¥ 0 for all R0 âˆˆ R}.

(7)

For all values of v in this cone, the expected utility from choosing R is at least as large as
choosing any other report.28 Similarly, reports R, R0 , and R00 are only optimal for students
with utility vectors in the regions CR , CR0 , and CR00 respectively. Further, these regions may
intersect only at their boundaries and together cover the utility space. The choice of report
therefore reveals the region in utility space to which a studentâ€™s preference vector belongs.
Remarkably, a partition of this form is implied for all school choice mechanisms that
use tie-breakers if a studentâ€™s belief for assignment probabilities is identified. The argument
does not rely on uniqueness of equilibria as long as agent beliefs are identified and can be
estimated using the data. Further, these inequalities use all the restrictions on preferences
given the beliefs of the agents and the mechanism. We can use this insight to construct the
likelihood of observing a given choice as a function of the distribution of utilities:
Z
P(R|z, Î¾) = P(R = arg max
v Â· LR |z, Î¾; f ) =
0
R âˆˆR

1{v âˆˆ CR }fV |z,Î¾ (v|z, Î¾)dv.

(8)

This expression presents a link between the observed choices of the students in the market and
the distribution of the underlying preferences, and it is the basis of our empirical approach.
It presents rich information about utilities because the number of regions is equal to the
number of reports that may be submitted to a mechanism.29
There are three remaining issues to consider. First, we need to show that agent beliefs
over assignment probabilities can be consistently estimated so that the regions CR used
to construct the likelihood can be determined. The objective is to justify an approximation to ex-ante student beliefs using a realized sample of reports. Section 6.1 shows that
assignment probabilities for the strategies used by students observed in the data can be
consistently estimated in all RSP+C mechanisms. Therefore, our procedure is robust to the
We allow for the possibility that LR = LR0 for two reports R and R0 . This may occur if the student lists
a school she is sure to be assigned to as her first choice. In such cases, our revealed preference method does
not deduce any preference information from later ranked choices.
29
There are a total of 1,885 elements in R because students in Cambridge can rank up to three programs
from 13.
28

21

possibility of multiple equilibria in case one wishes to assume that students play equilibrium
strategies.30 Second, Section 5 provides conditions under which the distribution of utilities
is non-parametrically identified. We can obtain point identification by â€œtracing outâ€ the
distribution of utilities with either variation in lottery sets faced by students or by using
an additively separable student-school specific observable characteristic. Third, Section 6.2
proposes a computationally tractable estimator that can be used to estimate the parameters
of the preference distribution. Here, we use a first step estimate of assignment probabilities.

5

Identification

Section 4 showed that the choice of report by a student allows us to determine the cone,
CR âŠ† RJ for R âˆˆ R, that contains her utility vector v. The argument required knowledge of
studentâ€™s beliefs for assignment probabilities that constitute LR,t . Knowledge of the mechanism and the joint distribution of reports and types directly identifies the forms of beliefs
specified in equations (4)-(6).31 This section presents our results on identification of the distribution of indirect utilities. Knowledge of this distribution is sufficient for positive analysis
of various types. For example, it allows for analysis of assignments under counterfactual
mechanisms and a determination of the fraction of students who are assigned to their true
first choice. Additionally, certain forms of normative analysis that involve comparing the
proportion of students who prefer one mechanism over another can also be conducted.32
We now show what one can learn about the distribution of utilities using equation (8):
Z
P(R âˆˆ R|z, t, Î¾, b) =

1{v âˆˆ Cb,R,t }fV |z,t,Î¾ (v|z, t, Î¾)dv,

where b is a market subscript and the dependence on t has been reintroduced for notational
clarity. This expression shows that two potential sources of variation that can be used to
â€œtrace outâ€ the densities fV |T,z,Î¾ (v|z, t, Î¾). The first results from choice environments with
different values of Cb,R,t . The second results from variation in the observable characteristic
z. We consider each of these below. As is standard in the identification literature, we treat
the assignment probabilities and the fraction of students who choose any report as observed.
30

We avoid common issues in deriving a likelihood in games with multiple equilibria (Ciliberto and Tamer,
2009; Galichon and Henry, 2011, for example) because we are able to identify and estimate agent beliefs.
31
Section 6.1 presents a consistent estimator for LR,t as defined by each of the forms of beliefs.
32
Solving the social plannerâ€™s problem or comparing mechanisms using a Kaldor-Hicks criterion requires
additional assumptions on the transferability of utility or a choice of Pareto weights.

22

5.1

Identification Under Varying Choice Environments

In some cases, researchers may be willing to exclude certain elements of the priority structure, t, from preferences, or they may observe data from multiple years in which the set of
schools are the same but capacities vary across years. Such variation in choice environments
can result in rich information about preferences. Our arguments in this sub-section will
therefore relax the additive separability assumption made in equation (1) by allowing V (Â·)
to have a general functional form. Because utilities can be determined only up to positive
affine transformations, we instead normalize the scale as kvi k = 1 for each student i. This
normalization is without loss of generality. Hence, it is sufficient to consider the case when
vi has support only on the unit circle.
To gain intuition, assume that a researcher has data from two years with one school adding
a classroom in the second year. If we assume that school capacity can be excluded from the
distribution of preferences, i.e. v|z, Î¾, t, b âˆ¼ v|z, Î¾, t, bÌƒ for the years indexed by b and bÌƒ, we
effectively observe students with the same distribution of preferences facing two different
lottery choice sets. For example, let the choice sets faced by students be L = {LR , LR0 , LR00 }
and LÌƒ = {LR , LÌƒR0 , LR00 } respectively. Figure III(i) illustrates these choice sets. The change
from LR0 to LÌƒR0 affects the set of utilities for which the various choices are optimal. The
set of types for which LR is optimal now also includes the dotted cone. The utilities in
this cone can be written as linear combinations of aÌƒR,R0 and aR,R0 with positive coefficients.
Observing the difference in likelihood of reporting R for students with the two types allows
us to determine the weight on this region:
Z
P(R|bÌƒ) âˆ’ P(R|b) =

(1{v âˆˆ CÌƒR } âˆ’ 1{v âˆˆ CR })fV (v)dv,

where explicit conditioning on the vector (z, t, Î¾) is dropped because it is held fixed. Figure
III(ii) illustrates that this variation allows us to determine the weight on the arc hÌƒR âˆ’ hR .
Carvalho et al. (2017) independently developed a similar identification argument in the
case where there are only two programs (i.e. J = 2) and there is rich variation in the
choice environment. Appendix C.2 proves a result for the general case and characterizes the
identified set even when the variation in choice environments is limited.
The discussion suggests that enough variation in the set of lotteries faced by individuals
with the same distribution of utilities can be used to identify the preference distribution.
The arc above traces the density of utilities along the circle when such variation is available.
However, typical school choice systems have only a small number of priority types and
datasets typically cover a small number of years. Therefore, due to limited support, we will
typically partially identify fV . While this source of variation may not be rich enough for a
23

basis for non-parametric identification, it makes minimal restrictions on the distribution of
utilities. In particular, the result allows for the preference distribution to depend arbitrarily
on residential locations through z. Although beyond the scope of this paper, this framework
may be a useful building block for a model that incorporates both residential and schooling
choices.

5.2

Identification With Preference Shifters

This subsection drops the scale normalization, kvi k = 1, made in the previous section and
reverts back to the additive separable form with the scale normalization in equation (1). We
describe how variation in z 1 within a market, fixing Î¾ and z 2 , can be used to learn about
the distribution of indirect utilities. The objective is to identify the joint distribution of
uij = U (zij2 , Î¾j , i ) given (Î¾, z 2 ), where we drop this conditioning for simplicity of notation.
Because i is independent of zij1 , we have that
fV |Z 1 (v|z 1 ) = g(v + z 1 )
where g is the density of u and z 1 is observed on a set Î¶. Therefore, our goal is to identify
g.33
Consider the lottery set faced by a set of students and the corresponding region, CR , of
the utility space that rationalizes choice R (figure II). A student with zi1 = z chooses R if
v = uâˆ’z âˆˆ CR . The values of u that rationalize this choice are given by z +Î±1 aR,R0 +Î±2 aR,R00
for any two positive coefficients Î±1 and Î±2 . Figure IV illustrates the values of u that make
R optimal. As discussed in Section 4, observing the choices of individuals allows us to
determine the fraction of students with utilities in this set. Similarly, by focusing on the set
of students with zi1 âˆˆ {z 0 , z 00 , z 000 }, we can determine the fraction of students with utilities in
the corresponding regions (see Figure IV). By appropriately adding and subtracting these
fractions, we can learn the fraction of students with utilities in the parallelogram defined
by (z, z 0 , z 000 , z 00 ). This allows us to learn the total weight placed by the distribution g on
such parallelograms of arbitrarily small size. It turns out that we can learn the density of
g around any point z in the interior of Î¶ by focusing on variation in the neighborhood of z.
The next result formalizes this intuition.
33

In recent work, Allen and Rehbeck (2017) study identification in a general class of demand models and
1
consider the case where vij = uij âˆ’ h(zij
). Specifically, they study the identification of h(Â·) and show that
it can be identified up to scale and location without knowledge of the distribution of uij . Our goal is to
identify the distribution of indirect utilities, which requires knowledge of uij . It may be possible to combine
1
these results to relax the restriction that (indirect) utilities are linear in zij
.

24

Theorem 1. If CR is spanned by J linearly independent vectors {aR,R1 , . . . , aR,RJ }, where
R1 , . . . , RJ belong to R\{R}, then g(Â·) is identified in the interior of Î¶. Hence, fV (v|z 1 ) =
g(v + z 1 ) is identified for all v such that v + z 1 is in the interior of Î¶.
Proof. Let AR = [aR,R1 , . . . , aR,RJ ] and note that CR = {v : v = AR x for some x â‰¥ 0}. Assume, wlog, |det AR | = 1. Evaluate hCR (z) = P(v âˆˆ CR |z) at AR x:
Z
1{u âˆ’ AR x âˆˆ CR }g (u) du

hCR (AR x) =
ZR

J

Z

âˆž

1{AR (y âˆ’ x) âˆˆ CR }g(AR y)dy =

=
RJ

Z

âˆž

...
x1

g (AR y) dy,
xJ

where the second equality follows from a change of variables, u = AR y, and the third equality
follows because AR (y âˆ’ x) âˆˆ CR â‡â‡’ y â‰¥ x. Therefore,
âˆ‚ J hCR (AR x)
= g (AR x) .
âˆ‚x1 . . . âˆ‚xJ
âˆ‚J h

(A x)

In particular, for any z 1 in the interior of Î¶, g(z 1 ) is given by âˆ‚xC1R...âˆ‚xRJ evaluated at
1
x = Aâˆ’1
R z . The derivative is identified on the interior of Î¶ because hCR (Â·) is observed on
Î¶.
Intuitively, zi1 shifts the distribution of indirect utilities. For example, when zij1 denotes
the distance to school j, then all else equal, students closer to a particular school should
have stronger preferences for attending that school. These students should be more likely
to rank it on their list. The extent to which students who are closer to a given school are
more likely to rank it is indicative of the importance of distance relative to other factors that
affect preferences that are captured by U (Â·).34
One drawback of the formal result above is that it places a restriction on CR , which is
a non-primitive object. However, the condition can be verified in the data because CR is
identified. Moreover, Theorem C.3 in Appendix C.3 shows that we can identify g under
weaker conditions on CR if g has exponentially decreasing tails and Î¶ = RJ . The proof
is based on Fourier-deconvolution techniques because the distribution of v is given by a
location family parametrized by z 1 . The conditions on g are quite weak and are satisfied for
commonly used distributions with additive errors such as normal distributions, generalized
34

The nature of this identification result articulates the fact that identification of the density at a point
does not rely on observing extreme values of z 1 . Of course, identification of the tails of the distribution of u
will rely on support of extreme values of z 1 . Also note that our identification result requires only one convex
cone generated by a lottery and, therefore, observing additional lotteries with simplicial cones generates
testable restrictions on the assumption that z 1 is a special regressor.

25

extreme value distributions, or if u has bounded support.35
When zij1 is assumed to be the road or walking distance from student iâ€™s residence to
school j, then the support of z 1 will be limited by geographical constraints. In this case, such
variation provides partial information on fV . Our estimator, which is described in the next
section, will use variation from this source in addition to variation in choice environments in
a parametric specification.

6

Estimating Assignment Probabilities and Preference
Parameters

We estimate our preference parameters, Î¸ = (Î², Î£), using a two-step estimator. In the
first step, we estimate the assignment probabilities for each lottery, LR,t . The second step
estimates Î¸ taking the estimate from the first step LÌ‚, as given. Although it may be possible
to estimate these two sets of parameters jointly, the two-step procedure is computationally
tractable, albeit at potential efficiency costs. Theorems 2.1 and 6.1 of Newey and McFadden
(1994) show conditions under which a two-step estimator is consistent and asymptotically
normal. These results require that the first-step is consistent and asymptotically normal, and
the second-step is reasonably well-behaved. Our second-step estimator will be equivalent to a
maximum likelihood estimator. The main challenge, therefore, is to show that our first-step
is consistent and asymptotically normal.
The asymptotic framework assumes that the number of students n grows large in a single
year and the number of programs is held fixed. The capacity of the programs, nÃ—qjn , increases
proportionally to the number of students, i.e. qjn â†’ qj âˆˆ (0, 1). These limits are meant to
capture an environment, such as the one in Cambridge, where the number of students is
large relative to the number of schools.36 It is sufficient for the researcher to observe data
from a single year of the mechanism with many students for consistency and asymptotic
normality of the estimator. In our application, the parameters governing the distribution of
preferences given the observables, Î¸, is held constant across years and multiple years of data
to improve the precision of Î¸Ì‚. For simplicity of notation, we omit the dependence of L on
the application year.
35

We do not require that g has a non-vanishing characteristic function. Further, when u has bounded
support, we can allow for Î¶ to be a corresponding bounded set.
36
Azevedo and Leshno (2016) use similar limits to analyze properties of stable matchings in a large market.

26

6.1

First Step: Estimating Assignment Probabilities

The first step requires us to estimate the probabilities in equation (4) for each value of
(Ri , ti ). The equation highlights two sources of uncertainty facing the student when forming
this expectation. First, at the time of submitting the report, the student does not know
the realization of (Râˆ’i , Tâˆ’i ). The agents form expectations for this realization based on
population distribution of types and the forecast strategy Ïƒ. The second source of uncertainty
is within Î¦n because of the random tie-breaker used to determine assignments. Even with
rational expectations, these two sources of uncertainty imply that the realized empirical
assignment probabilities differ from the agentâ€™s expectations.
We approximate the first source of uncertainty using a resampling procedure because
the data consists of a large sample of reports and priorities drawn from the population
distribution. For the second source of uncertainty, we can use the fact that Cambridge
uses a mechanism with a Report-Specific Priority + Cutoff (RSP+C) representation. For
each draw of (Râˆ’i , Tâˆ’i )b and tie-breakers Î½âˆ’i,b , we compute a market clearing cutoff pnâˆ’1
by
b
37
simulating the mechanism. The assignment for a student with priority type ti , report Ri ,
and a draw of the random tie-breaker Î½i is given by D(Ri ,ti ,Î½i ) (pnâˆ’1
), where ei = f (Ri , ti , Î½i ).
b
This reasoning suggests the following estimator, LÌ‚, for the rational expectations case:
LRi ,ti

B
1 X n
Î¦ ((Ri , ti ), (Râˆ’i , Tâˆ’i )b ),
â‰ˆ
B b=1
B Z
1 X
D(Ri ,ti ,ei ) (pnâˆ’1
â‰ˆ
)dÎ³Î½i
b
B b=1

= LÌ‚Ri ,ti ,

(9)

where (Râˆ’i , Tâˆ’i )b is the b-th sample of n âˆ’ 1 reports and priority types and Î³Î½i is the CDF
of the tie-breaker. The estimator therefore incorporates information on all the submitted
applications, data on school capacities in each year, and knowledge of the assignment mechto compute assignment probabilities
anism. Further, it uses a single set of draws for pnâˆ’1
b
for all values of (Ri , ti ). This makes the computation tractable even with a large number of
possible rank-order lists.38
37

Our estimator approximates the cutoffs by ignoring the report of agent i because, in a large market, any
single agent has a negligible impact on the cutoffs. That the resulting approximation error is negligible is
formalized in Appendix B, where we show that the approximation error in using only the other n âˆ’ 1 agents
is of order 1/n.
38
One may instead use observed assignment frequencies conditional on priorities and the rank-order lists
in this step. However, this approach is likely to yield poor estimates due to the curse of dimensionality unless
there are many students relative to the number of rank-order list and priority combinations. In Cambridge,
there are just under 2,000 feasible rank-order lists for each priority type. Our sample consists of 2,129

27

Our estimator for the adaptive expectations case is analogous. We draw (Râˆ’i , Tâˆ’i )b
from the observed reports in the previous year and calculate pnâˆ’1
using the previous yearâ€™s
b
capacity. The estimate for LRi in the coarse expectations case uses the estimate LÌ‚Ri ,ti for
the rational expectations case and averages it for each Ri using the empirical distribution of
ti .
The equation above highlights why the RSP+C representation is useful for estimating
assignment probabilities, a potentially complicated task for general mechanisms. Because
mechanisms are usually described in terms of algorithms that use the reports and priority
types of all the students in the district, there are few a priori restrictions that prevent them
from being ill-behaved. A small change in studentsâ€™ reports could potentially have large
effects on the assignment probabilities.39 Moreover, our objective is to estimate assignment
probabilities simultaneously for all priority-types and each possible rank-order list that can
be submitted by a student. The RSP+C representation allows us to obtain results on the
limiting distribution of LÌ‚ by examining the limit behavior of the cutoffs, pnâˆ’1
.
b
Theorem 2. Suppose that Î¦n is an RSP+C mechanism with a random tie-breaker Î½ij =
Î½ij 0 = Î½i that is drawn from the uniform distribution on [0, 1].
(i) If pâˆ— is the unique market clearing cutoff for (E[D(p)], q), where q = lim q n , then for
p
each (R, t), |LÌ‚R,t âˆ’ LR,t | â†’ 0.
(ii) Further, if pâˆ—j > 0 for all j, kq n âˆ’ qk = op (nâˆ’1/2 ) and âˆ‡p E[D(pâˆ— )] is invertible, then
for each each (R, t),
âˆš
d
n(LÌ‚R,t âˆ’ LR,t ) â†’ N (0, â„¦âˆ— )
where â„¦âˆ— is given in Theorem B.1.
Proof. The result is a special case of Theorem B.1 in the Appendix B, which relies on less
restrictive assumptions on Î³Î½ and does not assume that pâˆ—j > 0.
This result is based on showing that the cutoffs determining the eligibility thresholds
are close to pâˆ— if the number of students is large and then analyzing the limit distribution
âˆš
of n(pnâˆ’1
âˆ’ pâˆ— ). As discussed in Appendix B, the uniqueness of the cutoff pâˆ— is a generic
b
students. The knowledge of the mechanism and administrative data on capacities and submitted reports is
helpful in reducing the dimension of the problem to the number of cutoffs, which is equal to the number of
programs.
39
Two pathological examples allowed by Definition 1 are instructive. The first example is one in which
the assignment of all students depends only on student 1â€™s report. The second is an algorithm that depends
on whether an odd or even number of students apply to schools. It is easy to see why the conclusions of
Theorem 2 will not apply in these cases.

28

property.40 Uniqueness of pâˆ— in the Cambridge mechanism follows if for all j, Dj (Â·) is strictly
decreasing in pj (see Proposition B.5 in the Appendix). Results on pnâˆ’1
can be translated to
b
LÌ‚ using smoothness imparted by the non-degenerate distribution of Î½. Finally, as formalized
in Proposition B.6, our results also imply convergence of finite market equilibria to largemarket limits.

6.2

Second Step: Preference Estimates

The second step is defined as a maximum likelihood estimator and it takes the estimate LÌ‚
from the first step as given. Specifically, equation (8) implies that the maximum likelihood
estimator is given by
Î¸Ì‚ = arg max
Î¸âˆˆÎ˜

Pn

i=1

log P(Ri = arg maxRâˆˆRi vi Â· LÌ‚R,ti |zi , ti ; Î¸),

(10)

where Ri is the report submitted by student i, zi is the vector of observables that the
distribution of vi depends on, ti is the priority type of agent i, and Î¸ parametrizes the
distribution of v as given in Section 3.1.
Unfortunately, our model does not yield a simple closed-form solution for this likelihood.
Further, the relatively large number of potential rank-order lists implies that a simulated
maximum likelihood with enough draws to avoid bias is computationally burdensome.41 To
solve this problem, we adapt the Gibbsâ€™ sampler used by McCulloch and Rossi (1994) to
estimate a discrete choice model. It offers a computationally convenient likelihood-based
method for estimating parameters in some cases when an analytic form for the likelihood
function is not available. The Gibbsâ€™ sampler obtains draws of Î² and Î£ from the posterior
distribution by constructing a Markov chain of draws from any initial set of parameters
Î¸0 = (Î² 0 , Î£0 ). The invariant distribution of the resulting Markov chain is the posterior given
the prior and the data. The posterior mean of this sampler is asymptotically equivalent to
the maximum likelihood estimator (see van der Vaart, 2000, Theorem 10.1 (Bernstein-vonMises)).
As in the discrete choice case, we first use data augmentation to pick a utility vector for
each agent consistent with their choice. Here, we initialize vi0 âˆˆ CRi for each student i, where
Ri is the report chosen by agent i. We set vi0 by using a linear programming solver to find
40

Specifically, we use results from Azevedo and Leshno (2016) to show that market clearing cutoffs are
generically unique. Using techniques from Berry et al. (2013) and Berry and Haile (2010), we can also derive
stronger conditions for global uniqueness of the market clearing cutoffs.
41
There are 1,885 possible ways to rank up to 3 schools from 13. This is the potential number of rank-order
list for each student priority type.

29

a solution to the constraints vi0 Â· (LÌ‚Ri ,ti âˆ’ LÌ‚R0 ,ti ) â‰¥ 0 for all R0 âˆˆ R.42
The chain is then constructed by sampling from the conditional posteriors of the parameters and the utility vectors given the previous draws. The sampler iterates through the
following sequence of conditional posteriors:
Î² s+1 | vis , Î£s
Î£s+1 | vis , Î² s+1
vis+1 | vis , CRi , Î² s+1 , Î£s+1
The first two steps update the parameters Î² and Î£ in equation (2) using standard procedures (see McCulloch and Rossi, 1994, and Appendix D.1 for details). The last step, which
draws vis+1 for each student, differs slightly from McCulloch and Rossi (1994). Specifically,
we need to condition on the regions CRi and sample from the following conditional posteriors:
s+1
s+1
s
s
vijs+1 |vi1
, . . . , vijâˆ’1
, vij+1
, . . . , viJ
, Î² s+1 , CRi , Î£s+1 .

This requires us to draw from a (potentially two-sided) truncated normal distribution with
mean, variance, and truncation points determined by Î² s+1 , Î£s+1 , CRi and vi,âˆ’j .43 We can
ensure that vis+1 âˆˆ CRi for every student i in every step by calculating the bounds on vijs+1
conditional on vi,âˆ’j defined by the restriction vis+1 Â· (LRi âˆ’ LR ) â‰¥ 0 for all R âˆˆ R.
We specify independent and diffuse conjugate prior distributions according to standard
practice. These details and other implementation issues are described in Appendix D.1.
Standard errors in our case also need to account for estimation error in the first step. We
do this using the bootstrap procedure described in Appendix D.2.

7
7.1

Application to Cambridge
Assignment Probabilities and Preference Parameters

Table VI presents the assignment probabilities for various schools averaged over various
student subgroups.44 As in table IV, the estimates indicate considerable heterogeneity in
school competitiveness. The typical student isnâ€™t guaranteed assignment at one of the more
competitive schools even if she ranks it first. On the other hand, several schools are sure
42

A linear programming solver can be used to eliminate linearly dependent constraints with positive
coefficients in order to further simplify the later stages of the Gibbsâ€™ sampler.
43
The standard discrete choice model only involves sampling from one-sided truncated normal distributions.
44
Table D.I provides an estimate for standard errors of LÌ‚ constructed by bootstrapping the estimator.

30

shots for students who rank them first. The probability of not getting assigned to a school
also differs with paid-lunch status. A comparison of estimates in panel A with those in
panels D and E indicates that having priority at a school significantly improves the chances
of assignment. The differential is larger if the school is ranked first.
Panel A of table VII presents the (normalized) mean utility for various schools net of
distance by student group for four specifications. The first specification treats the agent reports as truthful, while the second, third, and fourth specifications assume that students best
respond to beliefs given by rational expectations, adaptive expectations, and coarse beliefs
respectively.45 In each of these specifications, we find significant heterogeneity in willingness
to travel for the various schooling options. Paid-lunch students, for instance, place a higher
value on the competitive schools as compared to the non-competitive schools. Although not
presented in the mean utilities, Spanish- and Portuguese-speaking students disproportionately value schools with bilingual and immersion programs in their home language. Students
also place a large premium on going to school with their siblings.
A comparison between the first column and the others suggests that treating stated
preferences as truthful may lead to underestimates of the value of competitive schools relative
to non-competitive schools. This differential is best illustrated using Graham & Parks as
an example. Treating stated preferences as truthful, we estimate that paid-lunch students
have an estimated mean utility that is an equivalent of 1.29 miles higher than the average
public school option. This is an underestimate relative to the models that assume students
correctly believe that Graham & Parks is a competitive school. In contrast, the value of
Graham & Parks for free-lunch students is over-estimated by the truthful model relative to
both the rational expectations and adaptive expectations model. The difference is due to
the fact that Graham & Parks is not competitive for free-lunch students and therefore, the
low number of applications it receives indicates particular dislike for the school.
Overall, estimates based on modeling expectations as adaptive are strikingly similar
to those from assuming rational expectations. In part, this occurs because the relative
competitiveness of the various schooling options in Cambridge is fairly stable even though
there is some annual variation in assignment probabilities across schools. This result is
comforting and suggestive of the robustness of our estimates to small mis-specifications of
agent beliefs. Estimates that endow agents with coarse beliefs continue to indicate that
treating reports as truthful underestimates the relative preference for the most competitive
schools such as Graham & Parks, Haggerty, Baldwin, and Morse. The results are more
mixed for the less desirable schools. As in the models that treat preferences as truthfully
45

The underlying parameter estimates for the two baseline specifications, rational expectations and truthful
reporting, are presented in tables D.III and D.II.

31

reported, free-lunch and paid-lunch students are in broad agreement on the relative ranking
of the various schools.
Another significant difference between the estimates that treat agents as truthful and
those that do not is in the number of schools students find preferable to the outside option.
Panel B shows that estimates that treat stated preferences as truthful suggest that about half
the students have five or more schools where assignment is preferable to the outside option.
On the other hand, treating agents as best responding to one of the three forms of beliefs
studied here suggests that about half the students find at most two schools in the system
preferable to the outside option. To understand these results, note that treating preferences
as truthful extrapolates from the few students (about 13%) that do not have complete rankorder lists. On the other hand, the model that treats students as being strategic interprets
the decision to rank long-shots in the second and third choices as evidence of dislike for the
remaining schools relative to the outside option.
These results should be viewed in light of Cambridgeâ€™s thick after-market. About 92% of
the students who are not assigned through the school choice process are assigned to one of the
schools in the system. Only a quarter of unassigned students are placed at their top-ranked
school through a wait-list that is processed after the assignment process in Cambridge. Most
of the remaining unassigned students are placed in an unranked school. Cambridge also has
charter and private school options that unassigned students may enroll in. The value of the
outside option is therefore best interpreted in terms of the inclusive value of participating in
this after-market.46
These specifications estimated the preference parameters using the set of students who
submitted a rank-order list consistent with optimal play (i.e. submitted a list corresponding
to an extremal lottery). For the rational expectations model, a total of 2,071 students (97.3%
of the sample) submitted a rationalizable list.47 The large fraction of students with rationalizable lists may initially appear surprising. However, theorem C.1 in the appendix indicates
that the lists that are not rationalized are likely the ones where assignment probabilities for
one of the choices is zero. Our estimates in table VI suggest that this is rare, except for a few
schools. Most of the students with lists that cannot be rationalized listed Graham & Parks
46

Students who are assigned through the process can later enroll in other schools with open seats, approximately 91% of the students register at their assigned school. Some differences between assignments
and registrations can be caused by changed in student preferences or the arrival of new information (Narita,
2016). Because the wait-list process in Cambridge allows students to choose a set of schools at which to apply,
we explored whether this feature results in significant bias. Specifically, we estimated the probability that a
student is able to ultimately register at a school where she was rejected during the main application process.
Beliefs based on these probabilities resulted in quantitatively similar results to our baseline specifications.
We therefore avoid modeling the after-market.
47
One student was dropped because the recorded home address data could not be matched with a valid
Cambridge street address.

32

as their second choice. Indeed, the reports can be rationalized as optimal if agents believe
that there is a small but non-zero chance of assignment at these competitive schools. One
concern with dropping students with lists that cannot be rationalized is that we are liable
to underestimate the desirability of competitive schools. Although not reported, estimates
that add a small probability of assignment to each of the ranked options yield very similar
results.

7.2

Ranking Behavior, Out-of-Equilibrium Truthtelling and Assignment to Top Choice

In this section, we investigate the ranking strategy of agents, whether they would suffer
large losses from out-of-equilibrium truth-telling, and how strategic manipulation may affect
student welfare.
Table VIII presents the fraction of students who find truthful reporting optimal and
losses from truthful behavior relative to optimal play as estimated using the two polar
assumptions on student behavior and beliefs. The first three columns are based on the
assumption that the observed reports are truthful and analyze the losses as a result of such
naÄ±Ìˆvete. These estimates can be interpreted as analyzing the true loss to students from
not behaving strategically if they are indeed out-of-equilibrium truth-tellers. The estimates
suggest that the truthful report is optimal for 57% of the students. The average student
suffers a loss equal to 0.18 miles by making a truthful report, or 0.42 miles conditional on
regretting truthful behavior. We also estimate heterogeneous losses across student groups.
Free-lunch students, for instance, suffer losses from truthful play less often and suffer lower
losses conditional on any losses. This reflects the fact that the Cambridge school system is
not competitive for these students because of the seats specifically reserved for this group.
The last three columns use estimates based on rational expectations and tabulate losses
from non-strategic behavior.48 Again, these estimates suggest that about half the students,
and disproportionately paid-lunch students, have strategic incentives to manipulate their
reports. Together, the observations suggest that markets where students face large competitive pressures are precisely the markets where treating preferences as truthful may lead to
biased assessments of how desirable various schools are.
The estimated losses using both specifications may seem small on first glance, but can
be explained by noting that whenever a student has a strong preference for a school, she will
rank it as her first choice in her optimal report (and potentially manipulate lower-ranked
48

These estimates differ from the ones based of truthful reporting only because of differences in preference
parameters.

33

choices). The priority given to the first-ranked choice results in a low chance that the student
is not assigned to this highly desired school. This fact significantly lowers the potential of
large losses from truthful reporting.
Our estimates that about half the students find it optimal to behave truthfully is likely
to affect our assessment of how many students are assigned to their top choice. Table IX
presents this fraction by student paid-lunch status. The last column indicates that 85.2% of
the students rank their top choice first. This occurs because many students avoid ranking
competitive schools as their top rank in favor of increasing the odds of assignment to a less
preferred option. As a result, fewer students rank Graham & Parks as their top choice,
instead favoring Haggerty or Baldwin. We therefore see over-subscription to Haggerty and
Baldwin by paid-lunch students relative to the true first choice. The last column indicates
that while 83.4% were assigned to their stated first choice, only 72.3% were assigned to
their true first choice. This pattern is particularly stark for paid-lunch students, who are
assigned to their true first choice only 64.6% of the time. Table VI indicates that assignment
to competitive schools is less likely for paid-lunch students. Together, these results suggest
that calculations of whether students are assigned to their preferred options based on stated
preferences may be misleading and differentially so by student demographics.

7.3

Evaluating Assignments under Alternative Mechanisms

A central question in the mechanism design literature is whether an Immediate Acceptance
mechanism is worse for student welfare compared to strategy-proof mechanisms such as the
Deferred Acceptance mechanism. This question has been debated in the theoretical literature
with stylized assumptions on the preference distribution (see Miralles, 2009; Abdulkadiroglu
et al., 2011; Featherstone and Niederle, 2016). The Immediate Acceptance mechanism exposes students to the possibility that they are not assigned to their top listed choices, which
can harm welfare when they strategically choose not to report their most preferred schools.
However, this possibility has a countervailing force that agents with particularly high valuations for their top choice will find it worthwhile listing competitive schools on top. Hence,
the mechanism screens agents for cardinal preferences and can result in assignments with
higher aggregate student welfare. Additionally, assignments under an Immediate Acceptance
mechanism may be preferable under a utilitarian criterion because they need not eliminate
justified envy (equivalently, they may not be stable). These are situations in which a student
envies the assignment of another student even though the envied student has lower priority
at that school.
Table X presents a quantitative comparison between the Cambridge mechanism and

34

the Student Proposing Deferred Acceptance mechanism49 using the preference estimates
presented earlier. Because the Deferred Acceptance mechanism is strategy-proof, evaluating
the counterfactual market with this mechanism is relatively straightforward because it does
not involve hurdles in computing an equilibrium.50
An approach that treats agentsâ€™ stated preferences as truthful finds that the average welfare is higher in the Deferred Acceptance mechanism. Panels A and B show that although
Cambridge assigns more students to their top choice due to the additional priority awarded
to students at schools that are ranked first, Deferred Acceptance does better at assigning
students to less preferable options, including fourth and fifth choices. Recall that estimates
from this specification indicated that many students prefer these options to remaining unassigned (see table VII). However, estimates assuming optimal behavior showed that the
vast majority find less than three schools in Cambridge preferable to remaining unassigned.
Therefore, the conclusion that Deferred Acceptance improves on average student welfare
may be incorrect if strategic behavior is widespread.
In contrast to estimates assuming truthful behavior, results that treat agents as responding to strategic incentives indicate that the assignments produced by the Cambridge
mechanism are preferable to those produced by the Deferred Acceptance mechanism. The
fraction of students assigned to their true first choice remains higher under the Cambridge
mechanism but, interestingly, the mechanism also places students at their true second choices
with high probability if agents are strategic. This occurs because some students report their
true second choice as their top choice. Indeed, panel C shows that more students prefer the
Cambridge mechanismâ€™s assignments to the Deferred Acceptance mechanismâ€™s assignments
than the other way around. Although the mechanism is effectively screening based on cardinal utilities, the average student prefers the assignments under the Cambridge mechanism by
only an equivalent of 0.08 miles. The table also illustrates differences across student groups.
Paid-lunch students prefer the Cambridge assignments more than free/reduced lunch students, perhaps due to strategic pressures. The estimated effects are of similar magnitude to
the difference between Deferred Acceptance and Student Optimal Stable Matching (SOSM)
as measured in New York City High Schools by Abdulkadiroglu et al. (2017a). Unlike SOSM,
49
We construct a Deferred Acceptance mechanism by adapting the Cambridge Controlled Choice Plan.
Schools consider students according to their priority + tie-breaking number. A paid-lunch studentâ€™s application is held if the total number of applications in the paid-lunch category is less than the number of available
seats and if the total number of applications at the school is less than the total number of seats. Free-lunch
student applications are held in a similar manner. We allow students to rank all available choices.
50
To evaluate the Cambridge mechanism, we use the beliefs estimated for each model to determine choices
and compute outcomes using the estimated assignment probabilities. Alternatively, it may be possible to
solve for the equilibria of manipulable Report-Specific Priority + Cutoff mechanisms because only equilibrium
cutoffs need to be obtained. These cutoffs can then be used to compute assignment probabilities and beliefs.

35

however, the Cambridge mechanism need not result in a Pareto improvement relative to the
Deferred Acceptance mechanism.
Specifications with biased beliefs indicate that the cardinal screening benefits of an Immediate Acceptance mechanism may be further diminished and instances of justified envy
may be larger if beliefs are not well aligned with true assignment probabilities. In the models with biased beliefs, free-lunch students tend to prefer the assignment produced by the
Deferred Acceptance mechanism relative to the one produced by the Cambridge mechanism.
Further, the benefits to paid-lunch students are lower than the model that treats agents as
having rational expectations. The significant aggregate benefits to free-lunch students under the Deferred Acceptance mechanism is driven, in part, by the large fraction of students
assigned to their top two choices. Paid-lunch students continue to prefer assignments in the
Cambridge mechanism to the strategy-proof counterpart.
Finally, a potential undesirable feature of the Cambridge mechanism is that it may result
in instances of justified envy. Panel C shows that there are few instances of justified envy
if agents have rational expectations, only about 2.5%, because students are often assigned
at one of the top two choices. Under truthful reporting the estimated instances of justified
envy is higher, just under 8%. The other specifications yielded intermediate results.
Our quantitative results contribute to the debate in the theoretical literature about the
welfare properties of an Immediate Acceptance mechanism, which is similar to the Cambridge
mechanism. The results are different in spirit from Ergin and Sonmez (2006), which suggests
that full-information Nash equilibria of an Immediate Acceptance mechanism are Pareto
inferior to outcomes under Deferred Acceptance. This difference stems from our focus on
beliefs that account for ex-ante uncertainty faced by the students. Our results provide a
quantitative counterpart to the theoretical claims in Abdulkadiroglu et al. (2011). They
argue that an Immediate Acceptance mechanism can effectively screen for the intensity of
preferences and can have better welfare properties than the Deferred Acceptance mechanism.
Troyan (2012) shows that the theoretical results in this literature that are based on notions
of interim efficiency are not robust to students having priorities, and he advocates for an
ex-ante comparison such as the one performed in this paper.
Given the small benefits of the Cambridge mechanism, it is important to note that agents
may face costs of strategizing because students may need to gather additional information
about the competitiveness of various schools before formulating ranking strategies. These
costs may weigh against using an Immediate Acceptance mechanism for school assignment.
Additionally, there may be distributional consequences if agents vary in their ability to strategize (Pathak and Sonmez, 2008). While we cannot quantify the direct costs of strategizing
and gathering information with our data, we extend our model to address distributional
36

consequences of heterogeneous sophistication and biased beliefs in the next section.

7.4

Extension: Heterogeneous Agent Sophistication

The specifications presented above have modeled a homogeneous population of agents who
make optimal reports given beliefs consistent with the data. However, agents may differ in
their information about the competitiveness of various schools or may vary in their understanding of the mechanism. The difficulty in empirically analyzing extremely flexible models
of heterogeneously sophisticated agents stems from the fact that a researcher has to disentangle heterogeneity in sophistication from preference heterogeneity while only observing the
actions of the agents. Theorem C.1 in the appendix shows it is typically possible to rationalize any rank order list as optimal for some vector of utilities. Simultaneously identifying
preferences and heterogeneity in sophistication will therefore require restricting behavioral
rules and parametric assumptions.
We estimate a stylized model with heterogeneous agent sophistication based on Pathak
and Sonmez (2008).51 They theoretically compare the Deferred Acceptance mechanism to
the Immediate Acceptance mechanism using a model with two types of agents: naÄ±Ìˆve and
sophisticated. NaÄ±Ìˆve agents report their preferences sincerely by ranking the schools in order
of their true preferences. Sophisticated agents, on the other hand, recognize that truthful
reporting is not optimal because schools differ in the extent to which they are competitive
and because of the details of the mechanism. Reports made by sophisticated agents are
optimal given the reports of the other agents.
We model a population with a mixture of sophisticated and naÄ±Ìˆve agents who have the
same distribution of preferences but differ in their behavior. Naifs report their preferences
truthfully while sophisticated agents report optimally given their (correct) beliefs about the
probability of assignment at each option given their report. The distribution of preferences is
parametrized as in equation (2). In addition to parametric assumptions, the model embeds
two strong restrictions. First, it is a mixture of two extreme forms of agent behavior: perfect
sophistication and complete naÄ±Ìˆvete. Second, the distribution of preferences does not depend
on whether the agent is sophisticated. These simplifications allow us to keep the estimation
procedure tractable. Appendix D.1.2 details the Gibbsâ€™ sampler for this model, which needed
to be modified. We use estimates of the beliefs in the rational expectations model for the
sophisticated agents.
Table XI presents the estimated mean utilities and the fraction of agents who are naÄ±Ìˆve.
The estimated mean utilities are similar to the estimates in the other specifications, and
51
See Calsamiglia et al. (2017) for another empirical model of agents that are heterogeneous in their
sophistication.

37

usually in between the specifications treating agents as either truthful or fully sophisticated (table VII). Panel B shows that about a third of paid-lunch and free-lunch students
are estimated to be naÄ±Ìˆve. These results contrast from estimates obtained by Calsamiglia
et al. (2017) in Barcelona, where they estimate that over 94% of households are strategic in
their decisions. One potential reason driving this difference is that the 93% of students in
Barcelona are assigned to their top-ranked choice, while in Cambridge, this number is only
84%.
Table XII describes the differences between outcomes in the Cambridge and the Deferred
Acceptance mechanisms. Because Deferred Acceptance is strategy-proof, both naÄ±Ìˆves and
sophisticates report their preferences truthfully. Therefore, their outcomes are identical.
The fractions of students assigned to their first, second, and third choices are similar to the
results presented previously. We also see a similar overall increase in the fraction of students
assigned to their top choice school in the Cambridge mechanism and a decrease in fractions
assigned at lower-ranked choices. Interestingly, the probability of a student assigned to their
top choice under the Cambridge mechanism is larger for naÄ±Ìˆve agents than for sophisticated
agents even though they have identical preferences (78.4% vs 76.2%). This relatively larger
probability of assignment at the top choice is at the cost of a significantly lower probability of
assignment at the second choice, which is 6.5% for naifs and 12.3% for sophisticates. These
differences are particularly stark for the paid-lunch students, who face a more demanding
strategic environment. Our estimates suggest that, relative to sophisticates, naÄ±Ìˆve students
effectively increase their chances of placement at their top choice school at the cost of losing
out at less preferred choices.
These results can be explained by the difference between the propensity of naifs and
sophisticates for ranking popular schools. While naÄ±Ìˆve students disregard a schoolâ€™s competitiveness, sophisticates are likely to avoid ranking competitive schools. Therefore, naifs
effectively gain priority at their first choice school relative to sophisticated students with the
same true first choice if the school is competitive. For example, Graham & Parks is estimated
to be the top choice for 17.7% of students, but about a third of the sophisticated students for
whom it is the top choice avoid ranking it first. Consequently, naive students are more likely
to be assigned to Graham & Parks if it is their first choice. Qualitatively similar patterns
hold for the other competitive schools such as Haggerty, Baldwin, and Morse. This increase
in assignment probability at the top choice comes at the cost of a reduction in the probability
of assignment at the second choice. For example, while 14.7% of sophisticated paid-lunch
students are assigned to their second choice school, only 6.6% of naÄ±Ìˆve paid-lunch students
get placed at their second choice. As Pathak and Sonmez (2008) pointed out, naÄ±Ìˆve students
effectively â€œlose priorityâ€ at their second and lower choice schools to sophisticated students
38

who rank the school first. It is therefore not surprising that the instances of justified envy are
largest amongst naÄ±Ìˆve students, and particularly paid-lunch naifs. About 17% of paid-lunch
naifs remain unassigned while about 6% of paid-lunch sophisticates are unassigned. Further,
of the 27.6% paid-lunch naifs who are not assigned to their top choice, just under a third
have justified envy for another studentâ€™s assignment.
The aggregate welfare effects for naÄ±Ìˆve students therefore depend on whether the benefits
of an increased likelihood of assignment at the top choice outweighs the lost priority at less
preferred options. Although the naÄ±Ìˆve agents are making mistakes in the Cambridge mechanism, our comparison of assignments under the Deferred Acceptance mechanism to those
under the Cambridge mechanism in panel B of table X shows that only 23.2% of the naÄ±Ìˆve
paid-lunch students prefer the Deferred Acceptance mechanism to the Cambridge mechanism. This compares with 9.4% for paid-lunch sophisticates and less than 22% for free-lunch
naifs and free-lunch sophisticates. Overall, we find that the average naÄ±Ìˆve student prefers
assignments under the Cambridge mechanism by an equivalent of 0.024 miles. Because sophisticates are optimally responding to incentives in their environment, their estimated value
for the assignments in the Cambridge mechanism is larger, at an equivalent of 0.094 miles.

8

Conclusion

We show that students in Cambridge respond to the strategic incentives in the mechanism.
Specifically, students who reside on either side of the boundary where proximity priority
changes have observably different ranking behavior. This finding weighs against the assumption that agents are ranking schools in order of true preferences if proximity priority is
not a significant driver of residential choice.
Motivated by these results, we develop a general method for analyzing preferences from
reports made to a single unit assignment mechanism that may not be truthfully implementable. The approach views the choice of report as an optimal choice from available
assignment probabilities. We show that these probabilities can be consistently estimated
for a broad class of school choice mechanisms, including the Immediate Acceptance and the
Deferred Acceptance mechanisms. We consider models in which agents have biased beliefs
in addition to a rational expectations model. Further, we characterize the identified set of
preference distributions and propose a computationally tractable estimator.
Our empirical results indicate that treating preferences as truthful is likely to result in
biased estimates in markets where students face stiff competition for their preferred schools.
The stated preferences therefore exaggerate the fraction of students assigned to their true
top choice. We then evaluate changes in the design of the market, where we find that the
39

typical student prefers the Cambridge mechanismâ€™s assignment to the Deferred Acceptance
mechanismâ€™s assignment by an equivalent of 0.08 miles. These losses are concentrated for
the paid-lunch students, for whom the scarcity of seats at desirable programs results in the
highest advantage from screening based on intensity of preferences. Free-lunch students, on
the other hand, face a less complex strategic environment in the Cambridge mechanism, and
the average student is close to indifferent between the two mechanisms.
Estimates from models in which agents have biased beliefs about assignment probabilities
have a less optimistic view on the cardinal screening benefits of the Cambridge mechanism.
A model with heterogeneously sophisticated agents finds that the Cambridge mechanism is
preferable to naÄ±Ìˆve students because they gain priority at their top choice. Across specifications, we find relatively few instances of justified envy in the Cambridge mechanism due
to the significant majority of students who are assigned to their top choice in this school
district.
The relatively small welfare advantage of the Cambridge mechanism should be weighed
against potential costs and distributional consequences of strategizing. Quantifying these effects may be difficult without directly observing differences in information acquisition activities across mechanisms. More broadly, our results motivate further research on mechanisms
that use the intensity of student preferences in allocation more directly without some of the
potential costs of strategic behavior.
Our methods can be extended to many other settings. Within school choice systems, the
study of mechanisms that use finer priorities or exams is left for future research. Another
important setting where agents make similar trade-offs is when they apply to college. A
challenge in directly extending our approach is that collegesâ€™ admission decisions may be
based on unobserved factors. Also closely related are multi-unit assignment mechanisms
such as course allocation mechanisms. These settings, however, will require a richer space of
preferences with complementarities over objects.
It is worth re-emphasizing that our approach to school assignment is predicated on two
important assumptions that deserve further research. First, we assume that families do
not make residential decisions in response to latent tastes for schools. Future research that
investigates potential sources of residential sorting in unified school districts and jointly
models residential and school choice would be valuable. Second, we infer beliefs based
on observed ranking behavior and assume optimal responses. Further work that directly
measures beliefs and ranking behavior in the field and develops appropriate models can help
us better understand how agents interact with assignment mechanisms.

40

References
Abdulkadiroglu, A. (2013). School Choice. In Vulkan, N., Roth, A. E., and Neeman, Z.,
editors, The Handbook of Market Design, chapter 5, pages 138â€“169. Oxford University
Press, Cambridge, UK.
Abdulkadiroglu, A., Agarwal, N., and Pathak, P. A. (2017a). The Welfare Effects of Coordinated School Assignment: Evidence from the NYC High School Match. American
Economic Review, forthcoming.
Abdulkadiroglu, A., Angrist, J., Narita, Y., and Pathak, P. A. (2017b). Research Design
Meets Market Design: Using Centralized Assignment for Impact Evaluation. Econometrica, forthcoming.
Abdulkadiroglu, A., Che, Y.-K., and Yasuda, Y. (2011). Resolving Conflicting Preferences
in School Choice: The Boston Mechanism Reconsidered. American Economic Review,
101(1):399â€“410.
Abdulkadiroglu, A., Pathak, P. A., and Roth, A. E. (2009). Strategy-proofness versus Efficiency in Matching with Indifferences: Redesigning the NYC High School Match. American Economic Review, 99(5):1954â€“1978.
Abdulkadiroglu, A., Pathak, P. A., Roth, A. E., and Sonmez, T. (2006). Changing the
Boston School Choice Mechanism. NBER Working Papers 11963.
Abdulkadiroglu, A. and Sonmez, T. (2003). School Choice: A Mechanism Design Approach.
The American Economic Review, 93(3):729 â€“ 747.
Agarwal, N. (2015). An Empirical Model of the Medical Match. American Economic Review,
105(7):1939â€“78.
Aguirregabiria, V. and Mira, P. (2007). Sequential Estimation of Dynamic Discrete Games.
Econometrica, 75(1):1â€“53.
Allen, R. and Rehbeck, J. (2017). Identification of Average Demand Models.
Ayaji, K. (2017). School Choice and Educational Mobility: Lessons from Secondary School
Applications in Ghana.
Azevedo, E. M. and Budish, E. (2017). Strategyproofness in the large. NBER Working
Paper, No. 23771.

41

Azevedo, E. M. and Leshno, J. (2016). A Supply and Demand Framework for Two-Sided
Matching Markets. Journal of Political Economy, 124(5):1235â€“1268.
Bajari, P., Benkard, C. L., and Levin, J. (2007). Estimating Dynamic Models of Imperfect
Competition. Econometrica, 75(5):1331â€“1370.
Bayer, P., Ferreira, F., and McMillan, R. (2007). A Unified Framework for Measuring
Preferences for Schools and Neighborhoods. Journal of Political Economy, 115(4):588â€“
638.
Berry, S. T., Gandhi, A., and Haile, P. A. (2013). Connected Substitutes and Invertibility
of Demand. Econometrica, 81(5):2087â€“2111.
Berry, S. T. and Haile, P. A. (2010). Nonparametric Identification of Multinomial Choice
Demand Models with Heterogeneous Consumers.
Black, S. E. (1999). Do Better Schools Matter? Parental Valuation of Elementary Education.
The Quarterly Journal of Economics, 114(2):577â€“599.
Block, H. and Marshak, J. (1960). Random Orderings and Stochastic Theories of Responses.
In Olkin, I., Ghurye, S., Hoeffding, W., Mado, W., and Mann, H., editors, Contributions
to Probability and Statistics: Essays in Honor of Harold Hotelling. Stanford University
Press.
Bowman, A. W. and Azzalini, A. (1997). Applied Smoothing Techniques for Data Analysis : The Kernel Approach with S-Plus Illustrations: The Kernel Approach with S-Plus
Illustrations. OUP Oxford.
Brock, W. A. and Durlauf, S. N. (2001). Discrete Choice with Social Interactions. The
Review of Economic Studies, 68:235â€“260.
Calsamiglia, C., Fu, C., and Guell, M. (2017). Structural Estimation of a Model of School
Choices: the Boston Mechanism vs. Its Alternatives.
Calsamiglia, C. and Guell, M. (2017). The Illusion of School Choice: Empirical Evidence
from Barcelona.
Calsamiglia, C., Haeringer, G., and Klijn, F. (2010). Constrained School Choice: An Experimental Study. American Economic Review, 100(4):1860â€“74.

42

Cardon, J. H. and Hendel, I. (2001). Asymmetric Information in Health Insurance: Evidence from the National Medical Expenditure Survey. The RAND Journal of Economics,
32(3):408â€“427.
Carvalho, J. R., Magnac, T., and Viong, Q. (2017). College Choice, Selection and Allocation
Mechanisms: A Structural Empirical Analysis.
Cassola, N., HortacÌ§su, A., and Kastl, J. (2013). The 2007 Subprime Market Crisis Through
the Lens of European Central Bank Auctions for Short Term Funds. Econometrica,
81(4):1309â€“1345.
Chade, H. and Smith, L. (2006). Simultaneous Search. Econometrica, 74(5):1293â€“1307.
Chen, Y. and Kesten, O. (2013). From Boston to Chinese parallel to deferred acceptance:
Theory and experiments on a family of school choice mechanisms. Discussion Papers,
Research Unit: Market Behavior.
Chen, Y. and Sonmez, T. (2006). School choice: an experimental study. Journal of Economic
Theory, 127(1):202â€“231.
Chiappori, P.-A., Salanie, B., Salanie, F., and Gandhi, A. (2012). From Aggregate Betting
Data to Individual Risk Preferences.
Chiappori, P.-A., SalanieÌ, B., and Weiss, Y. (2017). Partner Choice and the Marital College
Premium. American Economic Review, 107(8):2109â€“67.
Choo, E. and Siow, A. (2006). Who Marries Whom and Why. Journal of Political Economy,
114(1):175â€“201.
Ciliberto, F. and Tamer, E. (2009). Market Structure and Multiple Equilibria in Airline
Markets. Econometrica, 77(6):1791â€“1828.
Cohen, A. and Einav, L. (2007). Estimating Risk Preferences from Deductible Choice.
American Economic Review, 97(3):745â€“788.
de Haan, M., Gautier, P. A., Oosterbeek, H., and van der Klaauw, B. (2016). The Performance of School Assignment Mechanisms in Practice.
Diamond, W. and Agarwal, N. (2016). Latent Indices in Assortative Matching Models.
Quantitative Economics, forthcoming.
Ergin, H. and Sonmez, T. (2006). Games of school choice under the Boston mechanism.
Journal of Public Economics, 90(1-2):215â€“237.
43

Featherstone, C. and Niederle, M. (2016). Improving on Strategy-proof School Choice Mechanisms: An Experimental Investigation. Games and Economic Behavior, 100:353â€“375.
Fox, J. T. (2010). Identification in matching games. Quantitative Economics, 1(2):203â€“254.
Fox, J. T. (2017). Estimating Matching Games with Transfers. Quantitative Economics,
forthcoming.
Gale, D. and Shapley, L. S. (1962). College admissions and the stability of marriage. The
American Mathematical Monthly, 69(1):9â€“15.
Galichon, A. and Henry, M. (2011). Set Identification in Models with Multiple Equilibria.
The Review of Economic Studies, 78(4):1264â€“1298.
Glazerman, S. and Meyer, R. H. (1994). Public school choice in Minneapolis, midwest
approaches to school reform. Proceedings of a Conference Held at the Federal Reserve
Bank of Chicago.
Glenn, C. L. (1991). Controlled choice in Massachusetts public schools. Public Interest,
103:88â€“105.
Guerre, E., Perrigne, I., and Vuong, Q. (2000). Optimal Nonparametric Estimation of FirstPrice Auctions. Econometrica, 68(3):525â€“574.
Hastings, J. S., Kane, T. J., and Staiger, D. O. (2009). Heterogeneous Preferences and the
Efficacy of Public School Choice.
He, Y. (2014). Gaming the Boston School Choice Mechanism in Beijing. Toulouse School of
Economics, mimeo.
Hitsch, G. J., HortacÌ§su, A., and Ariely, D. (2010). Matching and Sorting in Online Dating.
American Economic Review, 100(1):130â€“163.
Hotz, V. J. and Miller, R. A. (1993). Conditional Choice Probabilities and the Estimation
of Dynamic Models. Review of Economic Studies, 60(3):497â€“529.
Hotz, V. J., Miller, R. A., Sanders, S., and Smith, J. (1994). A Simulation Estimator for
Dynamic Models of Discrete Choice. Review of Economic Studies, 61(2):265â€“89.
Hwang, S. I. M. (2016). A Robust Redesign of High School Match.
Imbens, G. and Kalyanaraman, K. (2011). Optimal Bandwidth Choice for the Regression
Discontinuity Estimator. The Review of Economic Studies, 79(3):933â€“959.
44

Kapor, A., Neilson, C., and Zimmerman, S. (2017). Heterogeneous Beliefs and School Choice.
Leshno, J. and Lo, I. (2017). The Simple Structure of Top Trading Cycles in School Choice.
Lewbel, A. (2000). Semiparametric qualitative response model estimation with unknown
heteroscedasticity or instrumental variables. Journal of Econometrics, 97(1):145â€“177.
Manski, C. F. (1977). The structure of random utility models. Theory and Decision,
8(3):229â€“254.
Manski, C. F. (1985). Semiparametric analysis of discrete response. Journal of Econometrics,
27(3):313â€“333.
Matzkin, R. L. (1992). Nonparametric and Distribution-Free Estimation of the Binary
Threshold Crossing and the Binary Choice Models. Econometrica, 60(2):239â€“70.
McCulloch, R. and Rossi, P. E. (1994). An exact likelihood analysis of the multinomial
probit model. Journal of Econometrics, 64(1-2):207â€“240.
McFadden, D. (1973). Conditional Logit Analysis of Qualitative Choice Behavior. pages 105
â€“ 142.
Miralles, A. (2009). School Choice: The Case for the Boston Mechanism.
Narita, Y. (2016). Match or Mismatch: Leaning and Inertia in School Choice.
Newey, W. K. and McFadden, D. (1994). Large sample estimation and hypothesis testing.
Handbook of Econometrics, 4:2111â€“2245.
Nielson, C. (2013). Targeted Vouchers, Competition Among Schools, and the Academic
Achievement of Poor Students.
Pakes, A., Ostrovsky, M., and Berry, S. (2007). Simple estimators for the parameters of
discrete dynamic games (with entry/exit examples). The RAND Journal of Economics,
38(2):373â€“399.
Pathak, P. A. and Sonmez, T. (2008). Leveling the Playing Field: Sincere and Sophisticated
Players in the Boston Mechanism. American Economic Review, 98:1636â€“1652.
Pathak, P. A. and Sonmez, T. (2013). School Admissions Reform in Chicago and England:
Comparing Mechanisms by Their Vulnerability to Manipulation. American Economic
Review, 103(1):80â€“106.

45

Pennell, H., West, A., and Hind, A. (2006). Secondary School Admissions in London.
Roth, A. E. and Peranson, E. (1999). The Redesign of the Matching Market for American
Physicians: Some Engineering Aspects of Economic Design. American Economic Review,
89(4):748â€“780.
Shapley, L. and Scarf, H. (1974). On cores and indivisibility. Journal of Mathematical
Economics, 1(1):23â€“37.
Troyan, P. (2012). Comparing school choice mechanisms by interim and ex-ante welfare.
Games and Economic Behavior, 75(2):936â€“947.
van der Vaart, A. W. (2000). Asymptotic Statistics. Cambridge University Press.

46

Table I: School Choice Mechanisms
Mechanism
Immediate Acceptance

Manipulable
Y

Examples
Barcelona1 , Beijing2 , Boston (pre 2005),
Charlotte-Mecklenberg3 , Chicago (pre 2009),
Denver, Miami-Dade, Minneapolis,
Seattle (pre 1999 and post 2009),
Tampa-St. Petersburg.

Deferred Acceptance
w/ Truncated Lists

Y

New York City4 , Ghanian Schools,
various districts in England (since mid â€˜00s)
Boston (post 2005), Seattle (1999-2008),
Amsterdam (post 2015)5

w/ Unrestricted Lists
Serial Dictatorships
w/ Truncated Lists
First Preferences First
Chinese Parallel
Cambridge
Pan London Admissions
Top Trading Cycles
w/ Truncated Lists
New Haven Mechanism

N

Y
Y
Y
Y
Y

Chicago (2009 onwards)
various districts in England (before mid â€˜00s)
Shanghai and several other Chinese provinces6
Cambridge7
London8

Y
Y

New Orleans9
New Haven10

Notes: Source Table 1, Pathak and Sonmez (2008) unless otherwise stated. See several references therein
for details. Other sources: 1 Calsamiglia and Guell (2017); 2 He (2014); 3 Hastings et al. (2009);
4
Abdulkadiroglu et al. (2009); 5 de Haan et al. (2016); 6 Chen and Kesten (2013); 7 â€œControlled Choice
Planâ€ CPS, December 18, 2001; 8 Pennell et al. (2006);
9
http://www.nola.com/education/index.ssf/2012/05/new orleans schools say new pu.html
accessed May 20, 2014. 10 Kapor et al. (2017)

47

Table II: Cambridge Elementary Schools and Students
Year
Schools
Programs
Seats
Students
Free/Reduced Lunch
Paid Lunch

2004
13
24
473
412
32%
68%

White
Black
Asian
Hispanic

47%
27%
17%
9%

English
Spanish
Portuguese

72%
3%
0%

2005
2006
2007
2008
Panel A: District Characteristics
13
13
13
13
25
25
27
27
456
476
508
438
432
397
457
431
38%
37%
29%
32%
62%
63%
71%
68%
Panel B: Student's
47%
45%
22%
24%
18%
15%
11%
10%

Ethnicity
49%
22%
13%
9%

Average
13
25.6
470
426
34%
66%

49%
23%
18%
9%

47%
24%
16%
10%

Panel C: Language spoken at home
73%
73%
78%
81%
4%
4%
4%
3%
1%
1%
1%
1%

76%
3%
1%

Panel D: Distances (miles)
Closest School
0.43
0.67
0.43
0.47
0.45
0.49
Average School
1.91
1.93
1.93
1.93
1.89
1.92
Notes: Students participating in the January Kindergarten Lottery. Free/Reduced lunch based
on student's application for Federal lunch subsidy.

48

Table III: Cambridge Elementary Schools and Students
Year

2004

2005
2006
2007
2008
Panel A: Round of assignment
84%
85%
83%
75%
3%
4%
7%
5%
2%
2%
2%
4%
11%
9%
8%
16%

Average

First
Second
Third
Unassigned

81%
8%
5%
6%

First
Second
Third
Unassigned

Panel B: Round of assignment: Paid Lunch Students
80%
77%
78%
79%
68%
5%
4%
5%
8%
5%
6%
3%
4%
2%
3%
9%
16%
14%
11%
24%

76%
5%
4%
15%

First
Second
Third
Unassigned

Panel C: Round of assignment: Free Lunch Students
85%
95%
98%
94%
89%
14%
1%
2%
4%
6%
2%
1%
0%
1%
4%
0%
4%
0%
2%
1%

92%
5%
1%
1%

One
Two
Three

2%
5%
93%

Sibling Priority at 1st Choice
Sibling Priority at 2nd Choice
Sibling Priority at 3rd Choice

Panel E: Students with Priority at Ranked Schools
38%
34%
32%
24%
34%
4%
3%
1%
2%
2%
0%
2%
1%
1%
0%

32%
2%
1%

Proximity at 1st Choice
Proximity at 2nd Choice
Proximity at 3rd Choice

53%
42%
22%

52%
34%
24%

52%
37%
21%

51%
36%
23%

Ranked first
All ranked schools
Assigned School

1.19
1.37
1.10

Panel F: Mean Distance (miles)
1.18
1.24
1.29
1.19
1.41
1.38
1.40
1.34
1.01
1.07
1.12
0.92

1.22
1.38
1.04

Panel D: Number of Programs Ranked
6%
9%
5%
12%
6%
9%
7%
7%
89%
82%
88%
81%

50%
37%
24%

51%
33%
25%

82%
5%
3%
10%

7%
7%
87%

Notes: Sibling and proximity priority as reported in the Cambridge Public School assignment files.
Students with older siblings enrolled in CPS receive priority at their sibling's school. Students also
receive proximity priority at their two closest schools. Percentages, where reported, are based on
the total number of applicants each year.

49

40
56
33
128
27
1-R

Ranked First
Ranked Second
Ranked Third
Ranked Anywhere
Capacity
First Rejected

9
13
10
29
25
NR

12
8
4
24
23
NR

12
7
9
25
26
NR

King Open Ola

45
28
29
95
27
1-R

MLK

49
60
47
152
29
1-P

Kenn Long

Ranked First
Ranked Second
Ranked Third
Ranked Anywhere
Capacity
First Rejected

Panel A: All Students
37
34
33
31
18
44
39
38
19
44
37
32
75 113 114 105
41
27
51
48
1-R
1-R
NR
NR

Flet Mayn

47
25
31
102
42
1-R

Tobin

53
66
46
166
41
1-R

Peabody

Morse

56
37
33
120
41
1-R

King Open

Baldwin

60
72
56
192
41
1-P

Cambridgeport

Haggerty

Ranked First
Ranked Second
Ranked Third
Ranked Anywhere
Capacity
First Rejected

Amigos

Graham Parks

Table IV: School Popularity and Competitiveness

25
17
20
64
35
1-R

18
10
15
48
38
NR

16
18
16
54
41
NR

12
20
15
51
37
NR

5
0
0
6
15
NR

29
14
19
60
29
1-R

Panel B: Paid Lunch Students
25
24
25
17
13
12
29
23
27
10
15
34
24
18
11
51
87
70
65
33
41
18
36
34
29
1-R
1-R
NR
NR
3-R

4
3
4
9
35
NR

7
6
8
21
34
NR

4
6
10
20
27
NR

2
0
0
3
15
NR

17
11
10
40
26
1-R

Panel C: Free Lunch Students
12
11
13
10
12
5
12
17
12
8
4
12
13
13
9
20
36
44
38
31
41
17
33
31
19
1-R
2-P
NR
NR
1-R

16
8
10
36
18
NR

10
14
11
34
26
NR

9
11
4
25
24
NR

2
0
0
2
15
NR

Notes: Median number of applicants and seats over the years 2004-2008. First rejected is the round and
priority of the first rejected student, e.g., 1-P indicates that a student with proximity priority was rejected in
the first round. S: Sibling priority, PS: both proximity and sibling priority, R: regular/no prioirity, and NR: no
student was rejected in any round. Free/Reduced lunch based on student's application for Federal lunch
subsidy.

50

Table V: Regression Discontinuity Estimates
Competitive
School

Baseline
Rank First
Estimate
t-statistic

Estimate
t-statistic

Rank Second

-5.75%
(0.013)
-4.54

-2.38%
(0.012)
-2.02

Rank Third
Rank First
Panel A: All Students
-0.86%
-7.27%
(0.011)
(0.018)
-0.80
-3.96

-7.44%
(0.016)
-4.64

-2.65%
(0.014)
-1.90

Panel B: Paid Lunch Students
-0.68%
-11.07%
(0.015)
(0.025)
-0.46
-4.45

NonCompetitive
School
Rank First

Placebo
Boundary
Rank First

-2.06%
(0.019)
-1.10

0.07%
(0.024)
0.03

-1.22%
(0.018)
-0.67

1.88%
(0.031)
0.61

Panel C: Free Lunch Students
-3.55%
-2.59%
-3.15%
-1.47%
-5.23%
-3.55%
(0.022)
(0.021)
(0.022)
(0.031)
(0.031)
(0.033)
t-statistic
-1.60
-1.22
-1.43
-0.47
-1.67
-1.06
Notes: Regression discontinuity estimates based bandwidth selection rule proposed by Imbens and Kalyaraman
(2011). All estimates use rankings by 2,128 students. Competitive schools are Graham & Parks, Haggerty,
Baldwin, Morse, Amigos, Cambridgeport and Tobin. Placebo boundary at the mid-point of the two-closest
schools. Standard errors clustered at the student level in parenthesis.
Estimate

51

52

MLK

Kenn Long

Fletcher Maynard

Tobin K5

Tobin K4

Peabody

King Open

Cambridgeport

Amigos Bilingual

Amigos

Morse

Baldwin

Haggerty

Graham Parks

Ranked

First
Second
Third

0.43
0.24
0.21

0.59
0.25
0.19

0.63
0.23
0.18

0.57
0.20
0.10

0.73
0.35
0.25

0.98
0.94
0.83

Panel A: All Students
0.60
1.00
0.94
0.85
0.31
0.34
0.92
1.00
1.00
1.00
0.18
0.92
0.83
0.74
0.04
0.14
0.86
1.00
0.99
1.00
0.10
0.67
0.61
0.66
0.02
0.08
0.77
0.90
0.90
0.89
Panel B: Paid Lunch
First
0.22
0.45
0.49
0.54
0.73
1.00
0.51
1.00
0.94
0.93
0.32
0.36
1.00
1.00
1.00
1.00
Second
0.00
0.05
0.03
0.16
0.35
1.00
0.08
0.89
0.82
0.76
0.03
0.16
1.00
1.00
1.00
1.00
Third
0.00
0.01
0.00
0.06
0.24
0.85
0.01
0.56
0.56
0.64
0.01
0.09
0.89
0.89
0.89
0.87
Panel C: Free/Reduced Lunch
First
0.82
0.87
0.90
0.64
0.74
0.97
0.77
1.00
0.94
0.72
0.31
0.29
0.76
1.00
1.00
1.00
Second
0.71
0.65
0.61
0.26
0.35
0.90
0.39
0.98
0.86
0.71
0.07
0.08
0.59
0.99
0.99
1.00
Third
0.62
0.56
0.52
0.18
0.27
0.83
0.28
0.87
0.70
0.68
0.03
0.05
0.53
0.92
0.92
0.94
Panel D: Proximity Priority
First
0.63
0.97
0.95
0.89
0.95
0.99
0.94
1.00
1.00
0.92
0.55
0.54
0.95
1.00
1.00
1.00
Second
0.12
0.21
0.15
0.24
0.38
0.97
0.30
0.97
0.84
0.76
0.07
0.16
0.80
1.00
1.00
1.00
Third
0.10
0.11
0.06
0.12
0.28
0.84
0.16
0.76
0.66
0.67
0.02
0.12
0.72
0.89
0.90
0.88
Panel E: No Priority
First
0.37
0.55
0.60
0.52
0.71
0.97
0.55
1.00
0.94
0.85
0.28
0.33
0.92
1.00
1.00
1.00
Second
0.28
0.25
0.23
0.19
0.34
0.96
0.17
0.92
0.83
0.75
0.03
0.14
0.88
1.00
1.00
1.00
Third
0.25
0.20
0.18
0.10
0.24
0.85
0.10
0.66
0.60
0.66
0.02
0.08
0.78
0.90
0.90
0.89
Note: Average estimates weighted by number of students of each type. Probabilities estimated using B=1,000. Ranks and priority
types of opposing students are drawn with replacement from the observed data. Second and third rank assignment probabilities
are conditional on no assignment to higher ranked choices, averaged across feasible rank order lists.

Tobin

Table VI: Estimated Assignment Probabilities
King Open Ola

53

1.29
[0.06]
1.39
[0.07]
1.26
[0.05]
0.66
[0.07]
-0.01
[0.13]
0.77
[0.06]
0.65
[0.06]
0.22
[0.08]
-0.49
[0.11]
-1.30
[0.14]
-0.19
[0.09]
-0.66
[0.10]
-3.60
[0.35]
-2.08
[0.10]

0.40
[0.08]
0.72
[0.11]
0.50
[0.09]
0.70
[0.08]
-0.38
[0.15]
0.18
[0.08]
0.40
[0.07]
0.48
[0.09]
0.64
[0.12]
-0.05
[0.10]
0.47
[0.07]
0.08
[0.09]
-4.13
[0.39]
-1.44
[0.09]

Free Lunch
1.93
[0.27]
1.45
[0.16]
1.36
[0.14]
0.77
[0.12]
0.13
[0.18]
0.60
[0.14]
0.58
[0.10]
0.06
[0.12]
-0.92
[0.21]
-2.03
[0.42]
-0.40
[0.20]
-1.14
[0.23]
-2.39
[0.53]
-0.55
[0.08]

Paid Lunch

Paid Lunch
-0.19
[0.52]
0.89
[0.31]
-0.14
[0.37]
0.78
[0.33]
-0.43
[0.32]
0.25
[0.26]
0.37
[0.18]
0.52
[0.20]
0.39
[0.30]
0.12
[0.22]
0.08
[0.21]
0.16
[0.22]
-2.79
[0.93]
-0.74
[0.13]

Free Lunch

Adaptive Expectations

Panel A: Mean Utility
-0.20
1.89
[0.33]
[0.36]
0.69
1.41
[0.24]
[0.20]
0.70
1.05
[0.16]
[0.17]
0.97
0.61
[0.17]
[0.18]
-0.29
0.05
[0.27]
[0.22]
0.29
0.41
[0.18]
[0.21]
0.27
0.44
[0.13]
[0.13]
0.30
0.03
[0.15]
[0.16]
0.38
-0.83
[0.26]
[0.25]
-0.14
-1.67
[0.23]
[0.32]
0.11
-0.54
[0.17]
[0.27]
-0.28
-0.82
[0.19]
[0.22]
-2.79
-2.01
[0.67]
[0.62]
-0.92
-0.64
[0.08]
[0.09]

Free Lunch

Rational Expectations

1.85
[0.12]
1.56
[0.13]
1.57
[0.10]
0.82
[0.14]
-0.11
[0.19]
0.91
[0.12]
0.52
[0.10]
0.05
[0.11]
-0.74
[0.18]
-2.21
[0.30]
-0.51
[0.18]
-1.24
[0.18]
-2.47
[0.47]
-0.49
[0.06]

Paid Lunch

0.47
[0.16]
0.68
[0.18]
0.72
[0.15]
0.8
[0.16]
-0.64
[0.27]
0.21
[0.16]
0.24
[0.12]
0.31
[0.15]
0.28
[0.21]
-0.3
[0.18]
0.25
[0.15]
-0.27
[0.17]
-2.75
[0.63]
-0.73
[0.07]

Free Lunch

Coarse Beliefs

Panel B: Percentage of Acceptable Schools
up to 1
10%
20%
24%
14%
23%
19%
16%
21%
up to 2
16%
30%
61%
40%
61%
45%
58%
51%
up to 3
23%
40%
85%
62%
86%
69%
84%
74%
up to 4
34%
51%
95%
79%
95%
85%
95%
89%
up to 5
44%
61%
98%
91%
99%
95%
99%
96%
Notes: Average estimated utility for each school, normalizing the mean utility of the inside options to zero. Utilities calculated by averaging the
predicted utility given the non-distance covariates. Bootstrap standard errors in brackets, except for Truthful reporting where we present the
standard deviation of the posterior. Adaptive Expectations based on reported lists from 2005, 2006 and 2008 with assignment probabilites
estimated using data from 2004, 2005 and 2007 respectively. This specification drops data from 2007 in preference estimates since Tobin split
by entering age in that year. The fraction of students with rationalizable lists is 97.3%, 96.8%, and 99.3% for the Rational Expectations,
Adaptive Expectations and Coarse Beliefs specifications respectively.

Outside Option

King Open Ola

MLK

Kenn Long

Fletcher Maynard

Tobin

Peabody

King Open

Cambridgeport

Amigos

Morse

Baldwin

Haggerty

Graham Parks

Paid Lunch

Truthful

Table VII: Estimated Mean Utilities

54

Rational Expectations
No Loss
Mean Loss
Std Loss
mean
s.e.
mean
s.e.
mean
s.e.
46%
0.01
0.07
0.01
0.26
0.03
62%
0.02
0.01
0.00
0.07
0.03
38%
0.01
0.10
0.01
0.31
0.04
56%
0.02
0.04
0.01
0.19
0.05
46%
0.03
0.07
0.02
0.25
0.06
51%
0.03
0.04
0.01
0.18
0.06
40%
0.02
0.09
0.01
0.30
0.04
39%
0.05
0.08
0.04
0.24
0.09

Notes: Estimated loss from reporting preferences truthfully, relative to optimal report in distance units (miles).

All
Free Lunch
Paid Lunch
Black
Asian
Hispanic
White
Other Race

Truthful
No Loss
Mean Loss
Std Loss
mean
s.e.
mean
s.e.
mean
s.e.
57%
0.01
0.18
0.02
0.53
0.05
68%
0.02
0.01
0.00
0.09
0.03
51%
0.01
0.26
0.03
0.64
0.06
65%
0.02
0.06
0.02
0.30
0.07
56%
0.03
0.19
0.04
0.56
0.09
60%
0.04
0.10
0.03
0.36
0.09
52%
0.01
0.24
0.03
0.62
0.06
47%
0.06
0.20
0.07
0.51
0.15

Table VIII: Losses from Truthful Reports

55

9.0
8.9
6.7
8.6
7.9
8.3
32.6
20.0
18.8
18.9
11.0
11.7

Preferred School
Ranked #1 (simul)
Ranked #1 (data)
Preferred and Ranked #1
Preferred and Assigned
Ranked #1 and Assigned

Preferred School
Ranked #1 (simul)
Ranked #1 (data)
Preferred and Ranked #1
Preferred and Assigned
Ranked #1 and Assigned

Haggerty
13.3
14.6
14.6
11.5
8.9
11.1

8.1
8.5
8.3
8.0
7.5
7.9

11.6
12.6
12.6
10.4
8.5
10.1

Baldwin
10.9
13.9
13.4
9.2
7.0
10.2

6.5
6.8
8.0
6.4
6.0
6.4

9.4
11.6
11.9
8.2
6.6
9.0

Morse
8.7
10.4
10.6
8.2
6.9
8.6

12.5
12.7
12.2
12.2
10.7
11.1

10.0
11.2
11.0
9.6
8.2
9.5

Peabody

King Open

Cambridgeport

Panel A: All Students
6.1
7.2
6.1
5.4
8.0
8.6
7.0
4.9
7.7
8.2
7.8
5.7
5.8
7.2
6.1
4.6
5.1
7.2
6.0
3.8
6.8
8.6
6.9
4.2
Panel B: Free Lunch Students
6.9
6.8
7.2
7.9 10.7
6.9
7.1
7.2
8.2
9.0
7.8
6.4
7.7
9.0
8.5
6.7
6.6
7.2
7.8
8.9
6.0
6.1
7.2
7.8
7.1
6.2
6.5
7.2
8.1
7.2
Panel C: Paid Lunch Students
8.6
5.7
7.3
5.3
2.7
9.3
8.3
9.3
6.5
2.9
9.5
7.9
8.7
7.2
3.7
8.1
5.3
7.3
5.3
2.4
7.3
4.6
7.3
5.2
2.2
8.3
6.9
9.3
6.4
2.7

Amigos
7.9
8.4
8.8
7.5
6.8
7.6

Fletcher Maynard
0.6
0.6
1.2
0.6
0.6
0.6

10.8
10.6
10.8
10.3
9.3
9.5

4.0
3.9
4.4
3.9
3.5
3.6

Kenn Long
1.8
1.8
2.2
1.8
1.8
1.8

7.1
7.2
7.1
7.1
7.1
7.2

3.6
3.6
3.8
3.6
3.6
3.6

MLK
1.1
1.1
1.3
1.1
1.1
1.1

4.6
4.7
5.5
4.6
4.6
4.7

2.2
2.3
2.7
2.2
2.2
2.3

0.7 99.3
0.7 99.3
0.9 100.0
0.7 80.2
0.7 64.6
0.7 79.4

1.6 99.5
1.6 99.5
2.0 100.0
1.6 96.1
1.6 88.8
1.6 91.9

1.0 99.3
1.0 99.3
1.2 100.0
1.0 85.2
1.0 72.3
1.0 83.4

King Open Ola

Notes: Unless otherwise noted, table presents averages over 1,000 simulations from the posterior mean of the parameters
estimated from the rational expectations model.

24.8
16.2
14.3
15.3
9.9
10.4

Graham Parks

Preferred School
Ranked #1 (simul)
Ranked #1 (data)
Preferred and Ranked #1
Preferred and Assigned
Ranked #1 and Assigned

Tobin

Table IX: Ranking and Assignment of Top Choice

Total

56

Assigned
Assigned
Assigned
Assigned

to
to
to
to

First Choice
Second Choice
Third Choice
Fourth Choice

(1.9)
27.4
(1.5)
44.6
(2.1)

(1.6)
32.4
(1.2)
41.5
(1.8)

(2.4)
42.4
(2.0)
35.4
(2.5)

-0.008
(0.008)
0.044
22.2

1.3
0.0
0.0

87.7
5.9

0.1

84.8
8.7
1.4
0.3

Free
Lunch
86.4
10.0
1.5
0.2

70.4
12.3
4.9
1.8

0.3
0.0
0.4
0.6
Panel B: Cambridge Mechanism
63.9
88.8
73.9
67.3
18.1
7.9
10.2
11.1

58.4
18.7
7.1
1.9

62.0
14.1
6.8
2.6

Paid
Lunch

Coarse Beliefs
All
Students

Panel A: Deferred Acceptance

Free
Lunch

(1.8)
31.2
(1.2)
51.5
(2.0)

-0.078
(0.009)
0.109
17.3
(2.2)
28.0
(1.5)
56.4
(2.4)

-0.107
(0.012)
0.120
15.6
(2.4)
37.5
(2.0)
41.9
(2.7)

-0.021
(0.009)
0.046
20.6

(1.5)
32.1
(1.2)
42.8
(1.7)

-0.035
(0.009)
0.095
25.2

(1.8)
28.2
(1.4)
47.2
(2.0)

-0.052
(0.012)
0.104
24.6

3.9
5.1
1.3
3.5
4.6
1.0
1.4
0.3
1.5
2.1
0.2
0.2
0.0
0.4
0.5
Panel C: Deferred Acceptance vs Cambridge

72.3
14.7

0.2

67.8
15.8
5.2
1.3

Paid
Lunch

Rational Expectations
All
Students

(2.2)
39.7
(1.9)
34.0
(2.4)

-0.001
(0.011)
0.061
26.3

1.5
0.3
0.0

86.9
8.3

0.0

86.9
8.8
1.1
0.1

Free
Lunch

(2.7)
31.6
(1.7)
43.5
(2.8)

-0.032
(0.025)
0.178
25.0

3.6
1.2
0.2

72.2
11.9

0.2

68.9
13.8
5.1
1.5

(3.5)
26.3
(1.9)
50.3
(3.7)

-0.069
(0.033)
0.124
23.4

4.7
1.7
0.3

63.0
15.1

0.4

58.0
17.3
7.2
2.3

Paid
Lunch

(3.4)
41.0
(2.8)
31.2
(3.5)

0.033
(0.032)
0.233
27.8

1.5
0.3
0.1

88.9
6.1

0.0

88.4
7.5
1.3
0.2

Free
Lunch

Adaptive Expectations
All
Students

7.7
10.4
2.4
2.5
2.7
2.3
5.0
5.8
3.4
3.8
4.2
2.9
(0.5)
(0.7)
(0.4)
(0.2)
(0.3)
(0.4)
(0.3)
(0.4)
(0.4)
(0.7)
(1.0)
(0.6)
Notes: Panels A and B present percentages of students assigned to true k-th choice. Panel C compares the expected utility difference between Deferred Acceptance
and Cambridge Mechanism. Simulations of the Deferred Acceptance mechanism draw other student reports using the estimated utility distribution. We say DA â‰ˆ
Cambridge if the expected utility is within 10 -5 miles. Point estimates use the estimated parameters and 1,000 simulations of the mechanisms. Bootstrap standard
errors using 250 draws of the parameters in parentheses, except for Truthful reporting, where we use the 1,000 draws from the posterior distribution.

Percent with Justified Envy

Percent DA < Cambridge

Percent DA â‰ˆ Cambridge

Std. Utility DA - Cambridge
Percent DA > Cambridge

0.102
(0.027)
0.168
28.0

4.0
0.0
0.0

74.5
6.8

2.5

64.0
13.6
7.0
4.4

Paid
Lunch

Truthful

0.065
(0.019)
0.149
26.1

3.1
0.0
0.0

Percent Assigned to Third Choice
Percent Assigned to Fourth Choice
Percent Assigned to Fifth Choice

Mean Utility DA - Cambridge

78.9
6.5

1.7

71.0
12.0
5.1
3.0

Percent Assigned to First Choice
Percent Assigned to Second Choice

Percent Assigned to Fifth Choice

Percent
Percent
Percent
Percent

All
Students

Table X: Deferred Acceptance vs Cambridge

Table XI: Estimated Mean Utilities using a Mixture Model

Mixture Model
All Students

Paid Lunch

Panel A: Mean Utility
1.19
1.53
[0.11]
[0.12]
1.27
1.53
[0.14]
[0.13]
1.25
1.45
[0.10]
[0.10]
0.74
0.68
[0.11]
[0.11]
-0.12
0.00
[0.21]
[0.19]
0.56
0.68
[0.11]
[0.11]
0.48
0.57
[0.09]
[0.10]
0.08
0.03
[0.13]
[0.13]
-0.45
-0.81
[0.16]
[0.18]
-1.02
-1.52
[0.24]
[0.30]
-0.07
-0.23
[0.14]
[0.16]
-0.68
-0.97
[0.14]
[0.17]
-3.23
-2.96
[0.40]
[0.43]
-1.11
-1.03
[0.09]
[0.09]

Graham Parks
Haggerty
Baldwin
Morse
Amigos
Cambridgeport
King Open
Peabody
Tobin
Flet Mayn
Kenn Long
MLK
King Open Ola
Outside Option

Free Lunch
0.52
[0.15]
0.76
[0.22]
0.84
[0.13]
0.86
[0.13]
-0.38
[0.30]
0.31
[0.15]
0.32
[0.12]
0.16
[0.16]
0.26
[0.23]
-0.04
[0.18]
0.24
[0.15]
-0.10
[0.15]
-3.77
[0.46]
-1.26
[0.11]

Panel B: Agent Behavior
0.378
0.316
[0.0079]
[0.0079]
Notes: Panel A presents the average estimated utility for each school,
normalizing the mean utility of the inside options to zero. Utilities calculated by
averaging the predicted utility given the non-distance covariates. Panel B reports
the estimated fraction of naive agents by free-lunch status. Bootstrap standard
errors in brackets.
Fraction NaÃ¯ve

57

58

to
to
to
to
to

First Choice
Second Choice
Third Choice
Fourth Choice
Fifth Choice

72.4
6.6
4.1
0.0
0.0

69.5
14.7
5.9
2.6
0.8

90.2
6.3
1.7
0.0
0.0

89.6
7.6
1.3
0.3
0.1

Sophisticated
68.4

Panel C: Deferred Acceptance vs Cambridge
NaÃ¯ve
Sophisticated
NaÃ¯ve
Sophisticated
NaÃ¯ve
Sophisticated
-0.024
-0.094
-0.029
-0.13
-0.014
-0.023
(0.010)
(0.010)
(0.014)
(0.013)
(0.008)
(0.007)
0.096
0.125
0.112
0.137
0.047
0.046
22.5
12.8
23.2
9.4
21.0
19.4
(1.6)
(1.6)
(2.0)
(1.8)
(2.2)
(2.3)
30.4
30.6
26.6
26.7
38.1
38.2
(1.2)
(1.2)
(1.4)
(1.4)
(2.0)
(2.0)
47.1
56.7
50.2
63.9
40.9
42.4
(1.6)
(1.6)
(1.9)
(1.9)
(2.5)
(2.6)
6.4
2.5
8.3
2.7
2.6
2.3
(0.4)
(0.2)
(0.6)
(0.3)
(0.4)
(0.4)

76.2
12.3
4.3
1.8
0.5

NaÃ¯ve
31.6

86.3
10.3
1.7
0.3
0.1

Free Lunch

Notes: Panels A and B present percentages of students assigned to true k-th choice. Panel C compares the expected utility
difference between Deferred Acceptance and Cambridge Mechanism. Simulations of the Deferred Acceptance mechanism draw
other student reports using the estimated utility distribution. We say DA â‰ˆ Cambridge if the expected utility is within 10 -5
miles. Bootstrap standard errors in brackets.

Percent with Justified Envy

Percent DA < Cambridge

Percent DA Cambridge

Std. Utility DA - Cambridge
Percent DA > Cambridge

Mean Utility DA - Cambridge

Assigned
Assigned
Assigned
Assigned
Assigned

78.4
6.5
3.3
0.0
0.0

First Choice
Second Choice
Third Choice
Fourth Choice
Fifth Choice

Percent
Percent
Percent
Percent
Percent

to
to
to
to
to
NaÃ¯ve
35.7

Assigned
Assigned
Assigned
Assigned
Assigned

Percent of Students

Percent
Percent
Percent
Percent
Percent

Paid Lunch
Panel A: Deferred Acceptance
70.0
61.8
13.1
14.5
5.8
7.8
2.8
4.0
0.9
1.4
Panel B: Cambridge Mechanism
Sophisticated
NaÃ¯ve
Sophisticated
64.3
37.8
62.2

All Students

Table XII: Deferred Acceptance vs Cambridge using a Mixture Model

Figure I: Effect of Proximity Priority on Ranking Behavior

(i) First Rank

(ii) Second Rank

(iii) Third Rank

(iv) Competitive schools

Contâ€™d...

59

Figure I: Effect of Proximity Priority on Ranking Behavior (contâ€™d)

(v) Non-competitive schools

(vi) Placebo at prioritized schools

Notes: The graphs are bin-scatter plots (based on distance) with equally sized bins on either side of the
boundary. For each student, we construct a boundary distance, dÂ¯i , based on her distance to the schooling
options. For a given school-student pair, the horizontal axis represents dij âˆ’ dÂ¯i . The vertical axis is the
probability that a student ranks the school in the relevant distance bin. Range plots depict 95% confidence
intervals. Black plot points are based on the raw data, while the grey points control for school fixed effects.
Dashed lines represent local linear fits estimated on either side of the boundary based on bandwidth
selection rules recommended in Bowman and Azzalini (1997) (page 50). Panels (a) through (e) use the
average distance between the second and third closest schools as the boundary. A student is given
proximity priority at the schools to the left of the boundary and does not receive priority at schools to the
right. Competitive schools considered in panel (d) are Graham & Parks, Haggerty, Baldwin, Morse,
Amigos, Cambridgeport and Tobin. The remaining schools are considered non-competitive in panel (e).
Panel (f) considers only the two closest schools and uses the average distance between the closest and
second closest schools. Only the two schools where students have proximity priority are considered. Panels
(a), (d), (e) and (f) plot the probability that a school is ranked first. Panels (b) and (c) plot the
probability that a school is ranked second and third respectively. Distances as calculated using ArcGIS.
Graphs are qualitatively similar when using only students with consistent calculated and recorded
priorities. Details in data appendix.

60

Figure X

Figure X
Figure II: A Revealed Preference
Argument

ð‘2
1

ð‘†ð‘—

ð‘2
1

ð‘Ž

ð‘†ð‘—
ð‘Žð‘…,ð‘…â€²

ð¿ð‘…â€²

ð‘Žð‘…

ð¿ð‘…â€²

ð¿ð‘…

ð‘†ð‘—

ð¿ð‘…

ð¿ð‘…â€²â€²
ð‘†ð‘—

ð‘†ð‘—

0

ð‘Žð‘…,ð‘…â€²â€²
ð¿ð‘…â€²â€²

1

ð‘†ð‘—

ð‘1

(i) Indifference curves for utility vectors
parallel
to a, and choices over three lotFigure
X
1
0
teries
ð‘2
1

ð‘—
ð‘†ð‘†
ð‘—

0

(ii) LR
Figure X
Î±1 aR,R0
1

ð‘†ð‘—

1

ð‘1

is optimal for aR if aR =
ð‘—
+ Î±2 aR0 ,R00 for Î±1 , Î±2 ð‘†>
0
0
ð‘£2

ð‘†ð‘—

ð‘†ð‘—
ð¶ð‘…
ð‘Žð‘…,ð‘…â€²

ð¶ð‘…â€²

ð‘Žð‘…,ð‘…â€²â€²

ð‘†ð‘—
ð‘†ð‘—

ð‘Žð‘…,ð‘…â€²

ð‘Žð‘…,ð‘…â€²

ð¿ð‘…â€²

ð‘Žð‘…â€² ,ð‘…â€²â€²
ð¶ð‘…ð‘†â€²â€²ð‘—

ð¿ð‘…

ð‘Žð‘…,ð‘…â€²â€²

ð‘†ð‘—

ð¿ð‘…â€²â€²

ð‘Žð‘…â€² ,ð‘…â€²â€²

ð‘†ð‘—
ð‘†ð‘—

ð‘Žð‘…â€² ,ð‘…â€²â€²
ð‘†ð‘—ð‘†ð‘—

1

ð‘1

ð‘†ð‘—
ð‘†

ð‘—
(iv) Lottery choice reveals utility
region

(iii) Normal cones for eachð‘†lottery
ð‘—

1

ð‘†ð‘—
ð‘†ð‘—

ð‘†ð‘—

ð‘†ð‘—

ð‘†
ð‘†ð‘— ð‘—

0

ð‘£1

(0,0)

0

ð‘†ð‘—

61

Figure X

Figure X

ð‘2
1
ð‘£2

ð‘ŽÌƒð‘…,ð‘…â€²

â„ŽÌƒð‘… âˆ’ â„Žð‘…
ð‘Žð‘…,ð‘…â€²

ð‘†ð‘—

ð‘Žð‘…,ð‘…â€²â€²
ð‘ŽÌƒð‘…,ð‘…â€²
ð¿ð‘…â€²
ð¿Ìƒð‘…â€²

ð‘†ð‘—

ð‘Žð‘…,ð‘…â€²

ð¿ð‘…

ð‘Žð‘…â€² ,ð‘…â€²â€²

ð‘Žð‘…,ð‘…â€²â€²

ð‘†ð‘—

ð¿ð‘…â€²â€²

ð‘£1

(0,0)ð‘†
ð‘—
ð‘†ð‘—
ð‘†ð‘—

ð‘†ð‘—
0

ð‘†ð‘—
ð‘†ð‘—

ð‘†ð‘—
1

ð‘†ð‘—

ð‘†ð‘—

ð‘1
ð‘†ð‘—

(i) Variation in the assignment
probað‘†ð‘—
bilities induces variation in the normal
1
0
cones

(ii) Allows identifying the density of
utility distribution on the unit circe

Figureð‘†ð‘— III: Variation in Lotteries

Figure X

ð‘¢2
ð‘Žð‘…,ð‘…â€²

ð‘†ð‘—

ð‘§â€²â€²

ð‘†ð‘—

ð‘§â€²â€²â€²
ð‘Žð‘…,ð‘…â€²â€²

ð‘§

ð‘§2

ð‘§â€²
ð‘Žð‘…â€² ,ð‘…â€²â€²

ð‘†ð‘—

ð‘†ð‘—

ð‘§1

(0,0)

ð‘†ð‘—

ð‘¢1
ð‘†ð‘—

ð‘†ð‘—
Figure ð‘†IV:
Local variation
in z identifies the density of u
ð‘—
ð‘†ð‘—

1
ð‘†ð‘—
ð‘†ð‘—

62

ð‘†ð‘—

