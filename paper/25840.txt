NBER WORKING PAPER SERIES

EQUILIBRIUM TRADE IN AUTOMOBILE MARKETS
Kenneth Gillingham
Fedor Iskhakov
Anders Munk-Nielsen
John P. Rust
Bertel Schjerning
Working Paper 25840
http://www.nber.org/papers/w25840

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
May 2019

We dedicate this paper to James A. Berkovec whose contributions to the development of microfounded equilibrium models of the auto market was far ahead of his time and so inspirational
to our own work on this subject. His untimely death at age 52 in 2009 remains a huge loss
to the economics profession. The authors would like to acknowledge funding from the IRUC
research project, financed by the Danish Council for Independent Research. Rust acknowledges
financial support from the Gallagher Family Chair in Economics at Georgetown University.
The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2019 by Kenneth Gillingham, Fedor Iskhakov, Anders Munk-Nielsen, John P. Rust, and Bertel
Schjerning. All rights reserved. Short sections of text, not to exceed two paragraphs, may be
quoted without explicit permission provided that full credit, including © notice, is given to the
source.

Equilibrium Trade in Automobile Markets
Kenneth Gillingham, Fedor Iskhakov, Anders Munk-Nielsen, John P. Rust, and Bertel Schjerning
NBER Working Paper No. 25840
May 2019
JEL No. L9,L98,Q4,Q5,R4
ABSTRACT
We introduce a computationally tractable dynamic equilibrium model of the automobile market
where new and used cars of multiple types (e.g. makes/models) are traded by heterogeneous
consumers. Prices and quantities are determined endogenously to equate supply and demand for
all car types and vintages, along with the ages at which cars are scrapped. The model allows for
transactions costs, taxes, flexible specifications of car characteristics, consumer preferences, and
heterogeneity. We apply the model to two examples: a revenue-neutral replacement of the new
vehicle registration tax with a higher fuel tax and a hypothetical “merger to monopoly” in an
oligopolistic new car market. We show substantial gains in consumer welfare from the tax policy
change, as well as important effects on government revenues, automobile prices, driving, fuel
consumption and CO2 emissions, while the merger leads to substantial welfare losses.

Kenneth Gillingham
School of Forestry and Environmental Studies
Yale University
195 Prospect Street
New Haven, CT 06511
and NBER
kenneth.gillingham@yale.edu
Fedor Iskhakov
Australian National University
Research School of Economics
H.W. Arndt Building
25a Kingsley Pl.
Acton ACT 2601
Australia
fedor.iskhakov@anu.edu.au
Anders Munk-Nielsen
University of Copenhagen
Department of Economics
Oster Farimagsgade 5, 26.3.01
DK-1353 Copenhagen K, Denmark
superpronker@gmail.com

John P. Rust
Georgetown University
583 Intercultural Center
Washington, DC 20057
jr1393@georgetown.edu
Bertel Schjerning
Department of Economics
University of Copenhagen
Øster Farimagsgade 5, building 26
DK-1353 Copenhagen K.
bertel.schjerning@econ.ku.dk

1

Introduction

We present a computationally tractable dynamic equilibrium model of the automobile market
where new and used vehicles of multiple types (e.g. makes and models) are traded by heterogeneous consumers. The prices and quantities of used cars are determined endogenously
to equate supply and demand for all car types and traded vintages, and the ages at which cars
are scrapped are also determined endogenously as part of the equilibrium. The model allows
for transactions costs, taxes, and flexible specifications of car characteristics, consumer preferences, and heterogeneity, allowing for a rich analysis of a suite of research questions that
involve both primary and secondary markets for vehicles.
Our approach is based on a dynamic discrete choice model of ownership and trading of
automobiles where a key aspect of our specification of consumer heterogeneity is the inclusion
of additive idiosyncratic extreme value components to the utilities from the different possible
choices individuals face. Such preference shocks have a clear economic motivation, since they
can represent the idiosyncratic random components of the cost of maintaining an existing car,
as well as idiosyncratic aspects of the costs of search, prices of cars, and transactions costs.
These shocks constitute a fundamental source of gains from trade that rationalize the existence
of secondary markets. By varying the scale of these additive extreme value preference shocks,
we show how reductions in consumer heterogeneity reduce gains from trade and ultimately kill
off secondary markets when there are sufficiently large trade frictions.
An advantage of our framework is that the extreme value specification results in convenient functional forms for the conditional choice probabilities for the decisions to keep or trade
different types and ages of vehicles. Thus, we have the flexibility to match rich patterns of
trading, including consumers who choose not to own cars (i.e. who choose the “outside good”)
and “brand loyalty” and “brand switching” behaviors. We show that the choice probabilities
are smooth functions of car prices, and thus excess demands are also smooth functions of
prices. This allows us to use a robust and efficient algorithm, Newton’s Method, to solve for
consumers’ dynamic trading strategies as well as equilibrium prices.
We formulate our model and define equilibrium in an infinite horizon stationary environment. We use the machinery of Markov processes to describe trading behavior and characterize the vehicle holdings of different types of consumers as invariant distributions to certain
Markov chains. These Markov chains reflect the trading of vehicles, their aging and the im-

1

pact of stochastic accidents that result in premature scrappage of some vehicles. Our stationary
equilibrium concept results in a very compact and elegant description of equilibrium, but it
can also be extended to non-stationary environment (e.g. with macroeconomic shocks) or an
“overlapping generations” framework with finite individual lifespans. Since it is substantially
more complicated to define and calculate equilibrium in these various extensions, we introduce
our approach in the stationary, infinite horizon setting where we can define and characterize the
equilibrium more elegantly and simply.
The primary contribution of this paper is methodological: we develop a new framework
for computing equilibrium in the primary and secondary automobile markets. To demonstrate
the usefulness of our model, we examine two stylized examples. The first is motivated by the
new vehicle registration taxes in Denmark, which are some of the highest in the world: for the
majority of new vehicles sold today, it is as high as 150%.1 The registration tax discourages
new vehicle purchases, and leads to a fleet of older vehicles on the road. Thus, there has
been great policy interest in alternatives. Using data from Denmark, we calibrate the model to
the Danish economy and solve for the counterfactual equilibrium following a revenue-neutral
reform that reduces the new vehicle registration tax and increases the fuel tax. We examine
the effects on government revenues, automobile prices over the age distribution of vehicles,
driving, CO2 emissions and consumer welfare, and find substantial gains in consumer welfare
from the tax change, but also a substantial increase in fuel consumption and CO2 emissions due
to extensive margin responses in car ownership and vehicle size.
For our second stylized example, we endogenize new vehicle prices, allowing us to examine
a hypothetical “merger to monopoly” where two firms in a Bertrand-Nash equilibrium merge.
We show existence of the unique duopoly Bertrand-Nash equilibrium and then examine how
prices, profits, and consumer surplus change when the two firms merge. After the merger, the
monopolist dramatically increases prices, which decreases sales and increases firm profits but
at the expense of consumer and total surplus, which are nearly halved.
These two examples highlight the power of our approach. This framework has potential
to be useful for understanding the full equilibrium effects of many policies, including vehicle registration fees, gasoline taxes, per-kilometer usage charges, and low-emissions vehicle
mandates. Moreover, the flexibility and tractability of the model makes it promising for use in
1 Denmark

also imposes fuel taxes and vehicle ownership taxes, but the registration tax is by far the largest revenue-raiser,
bringing in between 30 and 50 billion kroner (DKK) annually.

2

structural estimation, potentially allowing for a wide range of policy analyses.2
A starting point of any discussion of the literature on equilibrium models of automobile
markets is the well-known BLP model (Berry, Levinsohn and Pakes, 1995). This influential
work focuses on the primary market for new vehicles, and ignores the presence of the secondary market and the substitution possibilities it offers consumers. Rust (1985c) and Esteban
and Shum (2007) were the first to tackle the challenging problem of solving for a full equilibrium in both the primary and secondary markets for automobiles. Rust studied the simultaneous
determination of price and durability by a monopolist new vehicle producer, while Esteban and
Shum studied oligopolistic pricing of competing new vehicle producers. To make progress,
both of these studies assumed stationarity and zero transaction costs, which implies that consumer trade each period for their most preferred vehicle in the entire market.3
We introduce a dynamic equilibrium model of automobile trading in the primary and secondary markets for automobiles with heterogeneous consumers and transactions costs. In equilibrium, consumers will “buy and hold” and only an endogenously determined subset of consumers will buy new vehicles each period. An important feature of our model is that we can
characterize the subset of consumers who are most likely to trade, as well as the characteristics
of the subsets of the population most likely to buy and hold different types of vehicles.
We build on a substantial literature focused on modeling equilibrium in secondary markets
for automobiles, taking the price of new vehicles as given. The earliest work that we are
aware of in this literature is a series of papers by Manski (1980), Manski and Sherman (1980),
and Manski (1983). These papers introduced theoretical models of equilibrium in secondary
markets for cars that could be numerically solved for prices and quantities and used for policy
forecasting of a wide range of policies of interest.
Another important early contribution was Berkovec (1985), who microeconometrically estimated and numerically solved a large-scale equilibrium model of the new and used vehicle
markets using a nested logit model. He defined “expected excess demand” by summing estimated discrete choice probabilities for cars of each age and class, net of scrappage.4 Berkovec
2 In related on-going work, Gillingham, Iskhakov, Munk-Nielsen, Rust and Schjerning (2019) are structurally estimating an
overlapping generations model using a similar framework.
3 Esteban and Shum (2007) also assume quality ladder preferences, which further simplifies the choice problem.
4 Berkovec used a probabilistic model of vehicle scrappage from Manski and Goldin (1983), where the probability a vehicle
is scrapped is a decreasing function of the difference between the second-hand price of the vehicle (net of any repair costs)
and an exogenously specified scrap value for the vehicle. This implies that, except for random accidents, there is very little
chance that new vehicles are scrapped, but the probability a used vehicle is scrapped increases monotonically with the age of
the vehicle.

3

computed equilibrium prices using Newton’s method to find a zero to a system of 131 nonlinear
equations representing the excess demand for the vehicles in his model.5
The contributions of Manski, Sherman, and Berkovec were extremely advanced given the
computing power at the time, and in many respects represent the closest point of departure for
our own work. However, their work was based on short run, static equilibrium holding models
of the market. Implicit in the static discrete choice formulation is the assumption that consumers only keep their vehicle for a single period, so that at the end of each period consumers
trade their current vehicle for their most preferred vehicle. Rust (1985b) formulated the first
dynamic model of automobile trading. He assumed the state of a vehicle is captured by its
odometer reading xt , which evolves according to an exogenous Markov process representing
variable usage of cars with transition probability Φ(xt+1 |xt ) that reflects stochastic usage and
deterioration of vehicles.6

When there are no transaction costs and the economy is in a stationary equilibrium (i.e. no
macroeconomic shocks or other time-varying factors altering the market), the optimal trading
strategy involves trading every period for the most preferred age/condition of vehicle x∗ (τ),
where τ indexes potentially heterogeneous preferences over “newness” of vehicles. However,
the assumption of zero transactions costs is unrealistic, and so is the excessive trading behavior
it implies. When there are transactions costs (which are distinct from trading costs, i.e. the
difference between the price of a car x a consumer wishes to buy, P(x), less the price P(x0 ) of
the car x0 that the consumer wishes to sell), the optimal trading strategy involves less frequent
trading and consumers will generally keep cars for multiple periods. The optimal strategy then
takes the form of an “(S, s) rule” reminiscent of optimal inventory theory: trade is characterized
by two thresholds (x∗ (τ), x∗ (τ)), where x∗ (τ) < x∗ (τ) and x∗ (τ) is the state of the optimal
replacement vehicle whenever the consumer trades in for a new one. x∗ (τ) is the replacement
threshold or odometer threshold where it is optimal to trade the current car in condition x for a
replacement car in condition x∗ (τ). Of course, when transactions costs are zero, then x∗ (τ) =
x∗ (τ) = x∗ (τ) and it is optimal to trade for the optimal car x∗ (τ) every period. However, in a
homogeneous agent economy, transaction costs will completely kill off trading in the secondary
market, so that all consumers follow an extreme version of a “buy and hold” strategy: they buy a
5 Berkovec

showed that the Jacobian matrix had special structure he called “identity outer product” that enabled him to
invert the Jacobian via inverting a smaller 48 × 48 matrix and doing some additional matrix vector multiplications.
6 Since x fully captures the state of a car and is observable by both parties in a transaction, Rust’s analysis avoided “lemons
t
problem” information asymmetries of the type analyzed in the seminal work of Akerlof (1970) that can potentially kill off the
secondary markets for cars.

4

new vehicle whenever they trade (i.e. x∗ (τ) = 0) and scrap their existing one when its odometer
reaches the replacement threshold x∗ (τ). This too is unrealistic.
Moving to a heterogeneous agent economy can allow for more flexible strategies, but establishing the existence of a stationary equilibrium in such an economy in the presence of transactions costs is challenging. Consider a consumer of type τ who desires to buy a vehicle with
x∗ (τ) > 0. When there are transactions costs there is no guarantee that some other consumer τ0
is willing to sell their vehicle at x∗ (τ). Using advanced methods from functional analysis (e.g.
the Fan-Glicksburg fixed point theorem), Konishi and Sandfort (2002) established the existence
of a stationary equilibrium in the presence of transactions costs under certain conditions. Their
proof shows that it is possible for the equilibrium price function P(x) to adjust to prevent such
coordination failures. However to our knowledge, there has been no work actually calculating
equilibria with transactions costs in this infinite-dimensional setting.
Stolyarov (2002) advanced the literature by assuming that the state of a vehicle can be
summarized by its age a, which can take only a finite number of values, a = 0, 1, 2, . . . , ā,
where ā scrappage age. Stolyarov introduced a continuous uni-dimensional parameterization of
consumer heterogeneity with quasi-linear preferences, and computed equilibria in the presence
of stochastic transactions costs using a fixed point formulation of the problem. Gavazza, Lizzeri
and Roketskiy (2014) extended Stolyarov’s approach by allowing households to own up to
two vehicles using a two-dimensional specification of consumer heterogeneity. They find that
transaction costs have a large effect on equilibrium trade.
Our model can be thought of as combining Stolyarov (2002) with the earlier work by Manski and Berkovec by using a multi-dimensional extreme value specification of consumer heterogeneity. We use a hierarchical specification of heterogeneity that includes both time-varying
idiosyncratic preference shocks (i.e. the extreme value error terms in the model) as well as
flexible specifications for time-invariant heterogeneity or types τ. The extreme value distribution allows for continuous formulas for choice probabilities even in the case where there is no
other time-invariant heterogeneity, and this continuity permits us to demonstrate the existence
of equilibrium via the Brouwer fixed point theorem. More importantly, we show that the excess
demand function for used cars in our model, ED(P), is a continuously differentiable function of
P that enables us to rapidly and accurately calculate equilibrium prices by solving the system of
nonlinear equations ED(P) = 0 by Newton’s method. This makes our approach very attractive
for use in empirical work and policy modeling.
5

There is a close connection between models of automobile trading that incorporate transactions costs and models that emphasize information asymmetries, such as Akerlof (1970).
There are “lemons laws” in many countries that require sellers to compensate buyers for defects or problems in a car that were not disclosed and negotiated on at the time of sale. Dealers
typically perform inspections and repair cars before selling, and often provide a limited term
warranty, all of which mitigate the informational asymmetries and result in transactions costs
that are often borne by the dealer. As a result, it is not clear that informational asymmetries
seriously inhibit trade in used vehicles, but they would be expected to show up in transaction
costs. Hendel and Lizzeri (1999) study equilibria in auto markets with and without asymmetric
information and find that adverse selection does not necessarily kill off the secondary market.
They find it difficult to empirically distinguish between predictions of models with asymmetric
information and those with transaction costs, and argue that, for Fords and Hondas at least, the
evidence does not support adverse selection as the primary reason for steeper price declines of
Fords as the vehicles age. In light of this, we move forward in using transaction costs to capture
trade frictions in auto markets.
In the next several sections we build up the computational framework for modeling the
automobile market. In Section 2 we set up the basic model with one car type and idiosyncratic
consumer heterogeneity. In Section 3 we consider persistent consumer heterogeneity to study
equilibrium sorting of cars between different consumer types. In Section 4 we extend the
model to consider a market with multiple car makes/models. Section 5 calibrates this model
to the Danish setting for a stylized exploration into the change in Danish tax policy. Finally,
in Section 6 we consider Bertrand competition between multiple-product car producers, thus
endogenizing the new car prices and allowing us to analyze the effects of a hypothetical “merger
to monopoly” counterfactual. Section 7 concludes.

2

Equilibrium with Idiosyncratic Consumer Heterogeneity

In this section we introduce a dynamic model of equilibrium trade at the automobile market. We
consider a stationary equilibrium in an infinite horizon economy where aging cars are traded in
both new and used car markets, and where consumers make replacement, trading and ownership
decisions to maximize expected discounted utility with a common discount factor β ∈ (0, 1).
For simplicity, we initially consider a single car type j = 1 so that cars differ only by their

6

age a ∈ {1, . . . , ā} and a unit mass of idiosyncratically heterogeneous consumers who differ by
their preferences over these cars as well as the outside option of not owning a car. We adopt
an extreme value specification of time-varying consumer heterogeneity that results in a logit
specification for choice probabilities similar to Berkovec (1985) that allows for both tractable
and realistic modeling of equilibrium trade in an economy with both transaction costs and the
outside option not owning a car.
2.1

The model and key assumptions

We focus on the stationary environment, and do not allow any “macro shocks” such as timevarying fuel price or price of new cars. We use the concept of stationary equilibrium from
Rust (1985b) and adapt it to our discrete product market setting. Under this concept there is
a time invariant price function P(a) satisfying P(0) = P, P(a) = P for a ≥ ā, and for each
a ∈ {1, . . . , ā − 1}, P(a) equates the supply of cars of age a sold by existing consumers in the
secondary market to the demand for cars of age a by other consumers in the economy. We
initially treat the model as a “small open economy” where new car prices are determined in the
world market with an infinitely elastic supply of new cars at price P. We also assume there is
an infinitely elastic demand for cars for their scrap value P such that P(a) ≥ P.
Similar to Rust (1985b), the scrap age ā is endogenously determined in equilibrium as
the smallest age where P(a) equals P. In Appendix A we show that the key results from the
continuum of goods setting of Rust (1985b) extend to our finite good setting, including the
result that in equilibrium the scrappage age ā coincides with the optimal replacement threshold
to a social planner’s problem, and is therefore welfare maximizing. We show how to compute
ā together with equilibrium prices P(a) through an iterative search algorithm that finds the
maximum value of ā that can be supported in equilibrium.7
We assume that the marginal utility of an additional car is sufficiently small such that no
consumer would want to own more than a single car.8 We further assume that make/model
j ∈ {1, . . . , J} reflects all persistent differences between the car types, and that car age a ∈
{1, . . . , A} reflects all of its time-varying characteristics. Until Section 4 we set J = 1 (and omit
7 We

can interpret the equilibrium outcome with highest supported ā as the outcome of a decentralized trading process
where the used price P(a) is bid up whenever there is an excess demand for a car of age a, and conversely P(a) falls whenever
there is an excess supply for cars of age a.
8 This is a reasonable assumption for a country like Denmark, where most households only own a single car. It also greatly
simplifies notation and the presentation of our model. The assumption could be relaxed to extend the model to countries like
the United States, where most households own multiple cars.

7

j to simplify notation), and the unit mass of cars in the economy is distributed among ā ≤ A
age groups (vintages), where A is an upper bound on the age of cars of any make/model due to
their physical breakdown.
Following the literature, we assume that the net idiosyncratic component consumers’ preferences are characterized by a common quasi-liner utility function u(a) − µ(trade costs) where
the first term captures the utility of owning a car of age a and the second term accounts for
the monetary costs of trade. Trade costs consist of the difference in prices of traded cars, with
the addition of transaction costs (to be specified below). The parameter µ > 0 is a simple way
to capture income/wealth effects in this model. High values of µ can be interpreted as “being
poor” because the cost of buying a new car will involve a high opportunity cost in terms of
forgone consumption of other goods. Thus, µ will constitute a crucial parameter governing a
consumer’s willingness to pay for a car. A non-increasing function u(a) captures the utility of
from driving (utilization) as well as the expected cost of maintaining a car of age a. We assume
that u(a + 1) ≤ u(a) for a ∈ 0, . . . , A.
Let transactions cost be given by an arbitrary function T (P, a, d), dependent on the existing
car of age a to be traded for a different car of age d. For example, a combination of proportional transactions costs on the net trade ρ ≥ 0 and a lump sum fee T leads to a specification
T (P, d, a) = T + ρ[P(d) − P(a)]. We assume that transactions costs are borne by the buyer, including sales or new cars where transaction cost also includes taxes charged by the government.
The state of a consumer is given by the vector (a, ε) where a ∈ {1, . . . , ā} denotes the age
of the current car that the consumer owns and a = ø if a consumer does not currently own a car.
The cars in the model age deterministically, but in addition to normal aging with probability
α(a) ∈ [0, 1) a car may be involved in a stochastic accident that results in a total loss and
subsequent scrappage. We model this event as a stochastic transition to the scrappage age ā.
The random component ε is a vector with the number of elements equal to the number
of state dependent discrete choices a consumer has. It captures idiosyncratic time-varying
phenomena such as maintenance expenditures, search costs, and variability in the prices of
traded cars that reflect idiosyncratic features of used cars that the buyer and seller observe
that cause transaction prices to deviate from the average price P(a). We assume that ε has
a multivariate extreme value distribution and that its elements are identically distributed and
independent across choices, consumers, and time periods.
We assume that at the start of each period a consumer who owns a car of age a can choose
8

whether to trade or keep their car, which we denote by d ∈ D(a) where D(a) is a set of feasible
trading choices we describe below. We assume trades take place instantaneously, so the car
each consumer chooses is the one that is utilized during that period, and it might experience an
accident during that time. At the start of the next period the chosen car is one year older, or
in case of a major accident its condition transits to ā since it is no longer drivable and must be
scrapped. With this timing convention, it is impossible to start the period with a brand new car,
so the state variable a only takes values in {ø, 1, . . . , ā}. However consumers can trade their old
car for a new one, so the set of feasible choices is {0, . . . , ā − 1} which includes new cars. In
addition, it is always possible to choose the outside option d = ø of having no car at all.
The set of feasible choices for a consumer whose car state is a is thereby summarized as
follows. If the consumer has no car (a = ø) they can choose to remain in the no-car state (d = ø),
buy a new car (d = 0), or one of the ages of cars available for sale in the secondary market,
so D(ø) = {ø, 0, 1, . . . , ā − 1}. If the consumer already owns a car of age a < ā, they have the
option of keeping it (d = κ) so D(a) = {κ, ø, 0, 1, . . . , ā − 1}. However, once a car reaches the
scrappage age ā we assume the consumer cannot keep their car so that d = κ is eliminated from
the choice set, i.e. D(ā) = {ø, 0, 1, . . . , ā − 1} = D(ø).
Let V (a, ε) be the value function for a consumer in state (a, ε), a ∈ {ø, 1, . . . , ā}. The Bellman equation for a consumer who does not own a car is




V (ø, ε) = max v(ø, ø) + ε(ø),
max
v(ø, d) + ε(d) ,
d∈{0,1,...,ā−1}


v(ø, d) = u(d) − µ P(d) + T (P, d, ø) + β(1 − α(d))EV (d + 1) + βα(d)EV (ā),

(1)

v(ø, ø) = u(ø) + βEV (ø),
where ε(·) denotes an element of the vector ε, and EV (a) is the conditional expectation of the
value function V (a, ε) for a consumer whose car state is a. Similarly, the Bellman equation for
a consumer who owns a car of age a is given by:

V (a, ε) = max v(a, ø) + ε(ø), v(a, κ) + ε(κ),

max
d∈{0,1,...,ā−1}




v(a, d) + ε(d) ,

v(a, d) = u(d) − µ[P(d) − P(a) + T (P, d, a)] + β(1 − α(d))EV (d + 1) + βα(d)EV (ā),
v(a, κ) = u(a) + β(1 − α(a))EV (a + 1) + βα(a)EV (ā),
v(a, ø) = u(ø) + µP(a) + βEV (ø),

9

(2)

where d = κ denotes the decision to keep the existing car a, which is different from the decision
d = a because in the latter case the transaction cost has to be paid. We assumed above that this
option is not available when a = ā. The owner of car a also has the option d = ø to sell the
current car and move to the outside good state.
When ε is distributed as IID Type I extreme value with mean normalized to zero and scale
parameter σ, we can use the max-stability property of the extreme value distribution (see (McR

Fadden, 1981)) to derive the well-known “log-sum” expressions for EV (a) ≡ V (a, ε)dF(ε),
a ∈ {1, . . . , ā − 1} in equations (1) and (2) to get:
!
EV (a) = σ log

∑

exp{v(a, d)/σ}

(3)

d∈D(a)

where the sum over feasible state-dependent choices D(a) in equation (3) reflects the constraints that consumers in state a = {ø, ā} are not allowed to keep.
We can stack equations (3) into a system of nonlinear equations for the (ā + 1) × 1 vector

of expected value functions EV = EV (ø), EV (1), . . . , EV (ā) as
EV = Γ(EV, P)

(4)

where Γ is the smoothed Bellman operator. Rust (1987, 1994) shows that Γ is a contraction
mapping in EV and hence has a unique fixed point EV (P) for each value of P.9
The excess demand function ED(P) in the model is defined in terms of choice probabilities,
where Π(d|a, P) is the probability that a consumer in state a chooses option d from the set of
available options given the prices P(a). Under the extreme value assumption for F(ε) it is well
known that Π(d|a, P) is given by the standard multinomial logit formulas, which we can write
as functions of EV (a) defined by (3):
Π(d|a, P) = exp{[v(a, d, P) − EV (a, P)]/σ},

(5)

where we include P in the notation for v(a, d, P) and EV (a, P) to emphasize that these functions
depend on prices P(a), a ∈ {0, . . . , ā}.
9 Note

that using (1)-(2) and (3) we could formulate an equivalent fixed point problem in terms of choice specific functions
v(a, d). However, working with EV (a) has a huge computational advantage in our case, because the fixed point has to be found
in Rā+1 space rather than in R(ā+1)(ā+2) .

10

2.2

Equilibrium with idiosyncratic consumer heterogeneity

Let 0 ≤ q(a) ≤ 1 denote the fraction of cars of age a in the economy such that the (row) vector

q ∈ Rā represents the age distribution of the car fleet. Following (Rust, 1985a) we refer to q
as the holdings distribution and it summarizes the distribution of cars at the start of the period
before trading. Thus, new cars have zero mass in this distribution: though new cars may have
been bought in the previous period, none will be brand new at the start of this period.
To account for the outside good we introduce the notation p to denote the ownership distribution, whose first ā components provide the fraction of the population who owns cars of ages
{1, . . . , ā} and the last component provides the fraction of the population, q(ø), that has no car:

p = q[1 − q(ø)], q(ø) ∈ Rā+1 .

(6)

In a stationarity equilibrium, both q and p will be time invariant. To be able to derive the
equilibrium conditions in convenient matrix form we combine the choice probabilities from (5)
into two (ā + 1) × (ā + 1) matrices, ∆T (P) and ∆K (P), for transitions due to cars that are traded
and kept, respectively. The two matrices are defined as follows:


Π(1|1, P) Π(2|1, P) . . . Π(ā − 1|1, P) Π(0|1, P) Π(ø|1, P)





 Π(1|2, P) Π(2|2, P) . . . Π(ā − 1|2, P) Π(0|2, P) Π(ø|2, P) 




.
.
.
.
.
T

..
..
..
..
..
∆ (P) = 




 Π(1|ā, P) Π(2|ā, P) . . . Π(ā − 1|ā, P) Π(0|ā, P) Π(ø|ā, P) 


Π(1|ø, P) Π(2|ø, P) . . . Π(ā − 1|ø, P) Π(0|ø, P)
0

(7)

and


∆K (P) = diag Π(κ|1, P), . . . , Π(κ|ā − 1, P), 0, Π(ø|ø, P) ,

(8)

where diag(·) denotes a diagonal matrix with given values on the main diagonal. Note that
column ā of ∆T (P) does not represent the probability of buying a car of age ā, which is zero,
since cars of this age can only be scrapped. Instead, this column is the probability of buying a
new car: the reasons for doing this will become evident below.
Let ∆(P) ≡ ∆T (P) + ∆K (P) combine the trading and holding behavior transitions. By construction ∆(P) reflects the choice restrictions at each state a introduced above, and forms a
stochastic matrix which rows add up to 1. We refer to ∆(P) as the trade transition probability

11

matrix. Given the distribution of consumers p at the start of the period, the matrix product
p∆T (P) represents the distribution of consumers after instantaneous trading has taken place.
The matrices (7) and (8), allow us to express supply S(P) ∈ Rā−1 and demand D(P) ∈ Rā−1
for cars of ages a ∈ {1, . . . , ā − 1}, and thus excess demand ED(P) = D(P) − S(P). Given our
assumption of infinitely elastic demand for cars as scrap and infinitely elastic supply of new
cars, there are only ā − 1 free prices to clear the markets. Given the ownership distribution, p,
supply and demand are defined by:
p∆T (P) =



D(P), D(0, P), D(ø, P)

p(I − ∆K (P)) =



S(P),

S(ā, P),


,

S(ø, P)
,

(9)

where I is the identity matrix of the appropriate size and D(0, P), D(ø, P), S(ā, P), and S(ø, P)
are four scalars which denote respectively the fraction of consumers who choose to buy a new
car, the fraction of consumers who choose not to have a car, the fraction of owners who scrap
cars, and the fraction of consumers without a car who wish to buy one. Thus, excess demand
is given by
p(∆(P) − I) =




ED(P), D(0, P) − S(ā, P), D(ø, P) − S(ø, P) .

(10)

The right hand side of (10) is an 1 × (ā + 1) vector, whose first ā − 1 components are the excess
demand of cars of ages a ∈ {1, . . . , ā − 1}. The last two components equal the difference in the
fraction of new and scrapped cars, and the difference in the fraction of consumers choosing the
outside good, respectively. In a stationary equilibrium, the market clearing condition, ED(P) =
(0, . . . , 0), holds, but the latter two differences must equal zero as well.
Note that the condition D(ø, P) − S(ø, P) = 0 identifies the fraction of consumers q(ø) who
choose not to have a car conditional on the holdings distribution q. Combining (6) with (7) and
(8), we get the following linear equation for q(ø, P):
"
[1 − q(ø, P)]

#

ā

∑ Π(ø|a, P)q(a)

a=1

− q(ø, P)Π(ø|ø, P) = 0.

(11)

In addition to the ownership dynamics captured by transition matrix ∆(P), cars age and
may get involved in accidents. The stationary equilibrium also has to account for the physical
evolution of the car fleet. Dynamics of the car age distribution q are governed in the model

12

by the ā × ā Markov transition matrix Q which we refer to as physical transition matrix. It
reflects the deterministic aging of cars as well as stochastic accidents that manifest themselves
as transitions to the terminal age ā, and subsequent scrappage:


0







Q=






1 − α(1)

0
..
.

0
..
.

0

0

0

0

0

0

1 − α(0)

0

0

···

0

1 − α(2) · · ·
..
..
.
.

0
..
.

0

α(1)









.
· · · 1 − α(ā − 2) α(ā − 2) 



···
0
1

···
0
α(0)
α(2)
..
.

(12)

The typical element of transition matrix Q denoted qi j is interpreted as the probability of a
car age i to become age j in the next period, independent of whether it was traded. Therefore,
given the holdings distribution q in one period, qQ is the distribution of ages of all cars in the
economy in the beginning of the following period, irrespective of the change of the ownership
of these cars during current period trade.
Recall our convention that the holding distribution q is the distribution of car ages at the
start of the period before the trading occurs. When trade occurs, if the economy is in flow
equilibrium, the fraction of cars that are scrapped will equal the fraction of new car sales. Thus,
from the point of view of age transitions, all cars of age ā “reappear” next period as new cars.
This explains the non-zero first element in the last row of matrix Q in (12). The cars entering
the period as age ā are replaced during the trading phase, and therefore experience accidents
during the period with probability α(0). Owners do not have the option of keeping cars of age
ā, so they sell them for their scrap value P, and return to the market to buy a replacement car (or
choose the outside good). The stationary equilibrium condition D(0, P) − S(ā, P) = 0 discussed
above ensures flow equilibrium, so that the overall stock of cars does not change over time.
However in a stationary equilibrium the entire holdings distribution cannot change over
time, so we must have qQ = q. When α(a) = 0 for all ages, it is easy to see that the holdings
distribution is uniform, with q(a) = 1/ā, a ∈ {1, . . . , ā}. With α(a) > 0 for at least some ages,
there is a unique time invariant distribution q compatible with transition probability Q. In both
cases, the following formulas give the analytic solution for the stationary holdings distribution

13

for a ∈ {1, . . . , ā − 1}:
a−1

q(a) = q(ā) ∏ (1 − α(i)),
i=0


ā−1 a−1
−1
q(ā) = 1 + ∑ ∏ 1 − α(i)
.

(13)

a=1 i=0

We are now in position to give a formal definition of equilibrium in the automobile market
that extends the stationary equilibrium concept of Rust (1985b) to economies with positive
transactions costs. This definition will form the basis for various extensions of the model that
we will consider in subsequent sections of this paper.
Definition D1 (Stationary equilibrium in the automobile market). Stationary equilibrium in the

market for new and used cars is given by the tuple ā, P(a), q(P, ā) such that the following
conditions are satisfied:
(a) The price function P(a) satisfies the infinite elasticity assumption for supply of new cars
and demand of scrapped cars, so it holds P ≤ P(a) ≤ P = P(0) for all a ∈ {1, . . . , ā − 1},
and P(a) = P for all a ∈ {ā, . . . , A};
(b) The stationary holdings distribution q(P, ā) constitutes a fixed point of the physical transition matrix Q, so it holds q(P, ā) = q(P, ā)Q;
(c) Consumers follow their optimal trading strategies that follow from the solution of the dynamic problem (1)-(2);
(d) The market clearing conditions ED(P) = (0, . . . , 0) are satisfied for cars of ages between
1 and ā − 1, as well as for the outside option, D(ø, P) = S(ø, P), and the demand for new
cars equals the supply of scrapped cars D(0, P) = S(ā, P).
Given the simple relationship (6) between the holdings distribution q and the ownership
distribution p, it is convenient to introduce the equivalent of the physical transition matrix Q
for p. To reflect the natural constraint that a consumer who does not own a car once trading is
over will also not own a car at the beginning of the next period, a constant 1 has to be added on
the diagonal which leads to the following (ā + 1) × (ā + 1) block diagonal Markov transition
matrix:
Ω = diag(Q, 1).

(14)

Unlike Q, Ω is not irreducible and it is easy to see that the distribution of the form (qr, 1 − r)
where q is the fixed point of Q and r ∈ [0, 1] is an invariant distribution of Ω.

14

Theorem 1 (Existence of equilibrium with idiosyncratic heterogeneity). The stationary equilibrium for the automobile economy with the idiosyncratically heterogeneous consumers defined in Definition D1, exists, and in equilibrium it holds
p(P, ā) = p(P, ā)∆(P) = p(P, ā)Ω = p(P, ā)∆(P)Ω,

(15)

where the ownership distribution p(P, ā) is given by (6) and (11), and Ω is defined in (14).
Proof. Proof is provided in the Appendix B.1 (page 56).
The logic under the “double fixed point” characterization results of Theorem 1 is the following. Given (10), conditions (c)-(d) in D1 are satisfied if the ownership distribution is a
fixed point of the trade transition matrix ∆(P). This is ensured by the first equality in (15).
Stationarity of the holdings distribution (b) in D1 is given by the second equality of (15). The
third equality is a simple substitution of one fixed point condition into the second, which has
a straightforward interpretation as the steady state ownership distribution in the economy. The
product of the two (ā + 1) × (ā + 1) Markov transition probability matrices ∆(P) and Ω is another Markov transition probability matrix that represents the evolution of the age distribution
of cars in the economy. That is, for a given initial ownership distribution p in the beginning of the period (where the first ā components represent fractions of ownership of cars of
age a ∈ {1, . . . , ā}, and the last component represents the fraction of consumers without cars),
the product p∆(P) represents the distribution of holdings immediately after trading. Note that
according to the structure of (7), the ā-th column of the matrix enforces the flow equilibrium restriction that scrapped cars are replaced by new cars, and therefore the ā-th element of p∆(P) is
the fraction of new cars. When we multiply this by the physical transition matrix Ω, p∆(P)Ω,
we obtain the holdings distribution at start of the next period. Similarly, the structure of the
trade transition matrix ∆(P) and the last column of the physical transition matrix Ω ensure that
the last component of the holdings distribution represents the steady state fraction of consumers
not owning a car.
Note that Theorem 1 only establishes the existence of the stationary equilibrium, but is
silent about its uniqueness. In fact, our numerical exercises show that it is possible to find
equilibrium price functions and holdings distributions with different values of ā, up to a certain
level of scrappage age. With our assumption on non-increasing utility u(a), there is an upper
bound on the scrappage age ā beyond which it becomes impossible to satisfy the condition
15

(a) of Definition D1 with the price vector that satisfies (15). As discussed above, if cars are
forced (by the matrix Q) to remain in the economy for too long, their owners have to be offered
a premium in the form of “negative” price to compensate for the low level of utility from
car utilization. We refer to the equilibrium with the highest ā that satisfies Definition D1 as
the maximal equilibrium. Based on our calculations, and the analogy with the homogeneous
consumer economy case where we are able to provide analytic proofs in Appendix A, we form
the following conjecture:
Conjecture J1. Out of all stationary equilibria in the automobile economy that satisfy Definition D1, the one with maximum scrappage age ā achieves the maximum welfare.
2.3

Computational algorithm

Theorem 1 serves as a simple characterization of the stationary equilibrium as a solution to
a system of non-linear equation given by (15). There are ā independent equations (one is
automatically satisfied because the elements of p(P, ā) add up to one), and ā unknowns, namely
ā − 1 prices P(a) for a ∈ {1, . . . , ā − 1}, and the share with the outside good q(ø, P), given by
(11).
Our computational approach to solving for the stationary equilibrium is based on the iterative solution of system (15) equilibrium prices conditional on the scrappage age ā. The solution
of the system is itself a nested loop computation, because for each trial value of price vector,
the dynamic programming problem given by (1)-(2) has to be solved in order to form ∆(P). To
ensure high computational performance, we apply Newton’s method both on the inner loop for
solving the dynamic programming problem, and the outer loop for solving for the equilibrium
prices. The following lemma establishes the needed smoothness properties of the objects in the
model:
Lemma L1 (Smoothness). The unique fixed point EV of the smoothed Bellman operator in (4),
the choice-specific value functions v(·) in (1) and (2), the choice probabilities Π(d|a, P) in (5),
and trade transition probability matrix ∆(P) are continuously differentiable functions of P.
Proof. Proof is provided in the Appendix B.2 (page 56).
The smoothed Bellman equation (4) can be solved by successive approximation by repeated
application of the operator Γ to compute a series of approximations to the fixed point EV (P)
given by EVk+1 = Γ(EVk , P) for some initial EV0 . But for maximum computational efficiency
16

we rely on the method of policy iteration (Howard, 1960) which is mathematically equivalent
to the use of Newton’s method to solve for EV as a zero of the mapping H(EV, P) = EV −
Γ(EV, P) = 0. It is easy to see from the definition of the smoothed Bellman operator Γ that
this is a continuously differentiable function of EV so its gradient ∇EV Γ(EV, P) exists and is a
continuous function of EV for any P. Then the policy iteration (Newton’s method) algorithm
provides a sequence of approximations {EVk } to the zero H(EV, P) = 0 given by
EVk+1 = EVk − [I − ∇EV Γ(EVk , P)]−1 [EVk − Γ(EVk , P)].

(16)

Policy iteration typically converges after a small number of iterations to a highly accurate approximation of the true fixed point. In addition, the following lemma establishes a convenient
analytic form for the derivative of the Bellman operator:
Lemma L2 (Derivative of Bellman operator). Let EV be the unique fixed point of the smoothed
Bellman operator Γ in (4), and let ∇EV Γ(EV, P) be the Jacobian matrix of Γ with respect to
EV . The following holds:
∇EV Γ(EV, P) = β∆(P)Ω,

(17)

where ∆(P) is the transition probability matrix given by the sum of (7) and (8), and Ω is the
transition probability matrix given in equation (14).
Proof. Proof is provided in the Appendix B.3 (page 57).
The following algorithm finds the maximal stationary equilibrium:
1. Compute accurate starting values for the equilibrium search problem by solving for the
homogeneous consumer economy equilibrium for the case of no transaction costs using
the algorithm described in the Appendix A.10
2. Set ā equal to the equilibrium scrappage age found in step 1, and initialize the price vector
at the computed equilibrium prices.
3. Solve for the stationary holdings distribution q(ā) as an invariant distribution of Q.
4. Using Newton’s method, solve for the equilibrium prices as a solution to the system of
non-linear equations given by (15). In particular, for each trial value of price vector:
(a) Solve the Bellman equation (4) for the fixed point EV using Newton’s method;
10 This is the limiting case with σ → 0, and therefore provides excellent starting values for both prices and scrappage age.
Conjecture J1 is also proven for that case, following Rust (1985b).

17

Figure 1: Example stationary equilibrium
(a) Equilibrium prices

(b) Post-trade ownership distribution

200
Heterogeneous
Homogeneous

550

0.1

150

(c) Expected values of cars

0.08

Initial
Maximal

500

0.06

100

0.04

50

450

0.02

0

4

8

12

0
New

Age of car

400
4

8

No car

Car age

1

3

5

7

9

11 12

Age of car

Notes: The optimal scrappage age in heterogeneous equilibrium is 12 years (10 in the homogeneous consumer economy).
Post-trade ownership distribution in panel (b) is computed as p∆(P).

(b) Form the trade transition matrix ∆(P) using (7)-(8), and compute q(ø) using (11);
(c) Compute the ownership distribution p(P, ā) using (6);
(d) Compute excess demand ED(P) using (10);
5. If the resulting price vector which solves (15) satisfies condition (a) in Definition D1,
increase ā by one, and repeat step 3.
6. If the resulting price vector which solves (15) does not satisfy condition (a) in Definition D1, decrease ā by one, and repeat step 3.
7. Algorithm terminates when it finds such ā that equilibrium condition (a) in Definition D1
are satisfied, but the same condition is not satisfied for ā + 1. The maximal stationary
equilibrium is then given by ā as well as price function and the holdings distribution
corresponding to this scrappage age.
2.4

Illustrative example: Equilibrium trade with transactions cost

The virtue of our computational approach is that we can compute equilibria for different ā to
confirm Conjecture J1. Figure 1 illustrates a computed maximal equilibrium for an example
where P = 200, P = 1, β = 0.95, σ = 5 and T (P, a, d) = 1.5 + 0.03P(d). Preferences are given
by the utility function u(a) = 60 − 5a, and the marginal utility of money is µ = 1. We compute
the scrappage threshold and shadow prices from the social planner’s problem described in Appendix A, as shown in panels (a) and (c) for comparison, and use this equilibrium as our initial
guess for ā and P. In the maximal equilibrium ā = 12, whereas the initial guess is ā = 10.
There are several points to notice from the example equilibrium in Figure 1. First the
18

homogeneous no transaction cost economy equilibrium is definitely not irrelevant: we see from
panel (a) that the shadow prices arising from the optimal stopping social planning problem
(Rust, 1985b) provide a good initial guess for the prices in the heterogeneous agent maximal
equilibrium with transactions costs.
Panel (b) presents the stationary ownership distribution measured right after the instantaneous trading phase, so we term it post-trade ownership distribution. It is computed as p∆(P).
Due to non-zero accident probability, namely α(a) = 0.01 + 0.02a, the age distribution of cars
has a realistic downward sloping shape. Given our normalization of the utility of the outside
good u(ø) = 0, nearly the entire population owns a car in steady state. Panel (c) of Figure 1
plots EV (a) for a ∈ {1, . . . , ā} to show the welfare gains in maximal equilibrium compared to
the heterogeneous equilibrium computed with ā = 10. The plots show a strict Pareto improvement. Even the small fraction of consumers without cars experience welfare gain because the
EV (ø) goes up in this example by 2.5% as well.
Thus, even though transactions costs inhibit trade, the gains from trade resulting from consumer heterogeneity more than compensate for the dampening effect of transactions costs and
cars actually live longer in the heterogeneous agent maximal equilibrium.

3

Equilibrium with Persistent Consumer Heterogeneity

The economy with idiosyncratically heterogeneous consumers analyzed in the previous section is sufficient to support trade in presence of transactions costs. However, to assess the
full gains from trade between consumers and to analyze equilibrium sorting of cars between
different types of consumers, we now extend the framework to allow for persistent consumer
heterogeneity.
3.1

Equilibrium with time invariant heterogeneity

We introduce the symbol τ to denote consumers of different types and assume that the type of a
consumer does not change over time. Assume there are a finite number of types τ ∈ {1, . . . , Nτ }
where f (τ) denotes the fraction of consumers of type τ. The structure of the consumer decision problem (1)-(2) is identical for all consumers, but due to differences in preferences, the
solution of this problem becomes type specific. The differences in demands and supplies are
reconciled in the market equilibrium, where under assumption of stationarity, consumers end
19

up “specializing” in their holdings of different ages of automobiles, reflecting the difference in
their underlying preferences.
Let uτ (a) be the utility for owning a car of age a by consumers of type τ.11 Solving the
Bellman equations (1)-(2) separately for each type, we obtain the decision-specific value functions vτ (a, d), expected value functions EVτ (a), and choice probabilities Πτ (d|a, P), for each
consumer type τ, for all states a ∈ {1, . . . , ā, ø} and for all choices d ∈ D(a) subject to the same
choice restrictions as in the previous section.
For a given value of ā, consumer heterogeneity does not change the variety of cars traded on
the market. Therefore, the holdings distribution of cars is still given by the 1 × ā vector q ∈ Rā ;
as in the case without time invariant heterogeneity. The same applies for the physical transition
matrix Q defined in (12), and as before the stationarity of equilibrium requires the holdings
distribution to be an invariant distribution with respect to aging and accidents, so q = qQ in any
stationary equilibrium.
However, the ownership distribution p now has a completely different structure compared to
(6) due to the sorting of different types of consumers into particular ages of the cars. Thus, each
type has its own ownership distribution that we denote by pτ , and a corresponding holdings
distribution qτ . Let qτ (ø) be the fraction of type τ consumers who choose not to have a car.
Analogous to (6), the ownership distribution of type τ is given by:

pτ = qτ [1 − qτ (ø)], qτ (ø) ∈ Rā+1

(18)

The overall ownership distribution in the heterogeneous consumer economy is given by:


p = f (1)p1 , . . . , f (Nτ )pNτ ∈ RNτ (ā+1) .

(19)

Note that because f (τ), τ ∈ {1, . . . , Nτ } is a well defined probability distribution, the vector p
is also a probability distribution.
Let ∆Tτ (P) and ∆K
τ (P) be the ownership transfer and keep transitions matrices (7)-(8) for
a particular consumer type τ. To form the overall trade transition probability matrix we stack
11 Throughout

this section, we denote the type-specific variables with the τ subscript.

20

∆Tτ (P) and ∆K
τ (P) vertically before adding them to obtain the trade transition matrix ∆(P):



∆(P) = 






∆T1 (P)

∆1 (P)
 
 
..
..
=
.
.
 
∆Nτ (P)
∆TNτ (P)





 
 
+
 

∆K
1 (P)
..
.

∆K
Nτ (P)




,


(20)

It is straightforward to verify that excess demand in the secondary market ED(P) and the
outside good D(ø, P) − S(ø, P), as well as the imbalance between the new and scrapped cars
D(0, P)−S(ā, P) are given by an equation equivalent to (10), where identity matrix I is replaced
by the Nτ (ā + 1) × (ā + 1) matrix obtained by stacking Nτ identity matrices vertically:




I
 



 .. 
p ∆(P) −  . 
=
ED(P), D(0, P) − S(ā, P), D(ø, P) − S(ø, P) .
 
I

(21)

It is immediately clear from (21) that unlike in the idiosyncratic case, the equilibrium holdings distribution in the economy with time-invariant consumer heterogeneity does not constitute
a fixed point of the trade transition matrix ∆(P) in equilibrium when the right hand side of (21)
only contains zeros.
Theorem 2 (Existence of equilibrium with time invariant heterogeneity). The stationary equilibrium for the automobile economy with time invariant heterogeneous consumers defined in
D1, exists, and the equilibrium holdings distribution q(P, ā) is given by
Nτ

q(P, ā) =

∑ qτ(P, ā) f (τ),

(22)

τ=1

where qτ (P, ā) is an internal part of the type-specific owner distribution pτ (P, ā) as per (18).
The latter constitutes the invariant distribution of the transition probability matrix ∆τ (P)Ω
defined in (14) and (20):
pτ (P, ā) = pτ (P, ā)∆τ (P)Ω, τ ∈ {1, . . . , Nτ }.

(23)

Proof. Proof is provided in the Appendix B.4 (page 57).
Note that it is generally the case that qτ (P, ā) 6= qτ (P, ā)∆τ (P), even in stationary equilib21

rium. For example, excess demand for a given consumer type τ is generally not zero, since there
can be net trade between different types of consumers in the economy. The only requirement
that equilibrium imposes is that aggregate demand (for all types) equals the aggregate supply
for a = 1, . . . , ā − 1. There may be a net excess demand or supply of cars by different types of
consumers reflecting patterns of specialization and gains from trade across different types of
consumers. For example, poor consumers may choose to specialize in holding older cars while
rich consumers specialize in holding newer cars, as we illustrate below.
Our computational approach to solving for an equilibrium in the economy with time invariant heterogeneity differs only slightly from the algorithm laid out in Section 2. The key
difference is the calculation of the holdings distribution q(P, ā): without persistent heterogeneity it follows directly from the physical transition matrix Q and does not depend on prices,
whereas in the heterogeneous case it is computed from invariant distributions of ∆τ (P)Ω for
each type (per Theorem 2), and therefore depends on prices. The following lemma establishes
the prerequisite smoothness properties of the qτ (P, ā) in P, which is crucial for the successful application of Newton’s method for solve for equilibrium prices. It shows that pτ (P, ā)
computed as a fixed point (23) is a well-defined implicit function of P that is continuously
differentiable in P. This is not immediately evident, since a straightforward application of the
Implicit Function Theorem would involve writing pτ (P, ā) as a zero of the following system of
equations:


qτ (P, ā) I − ∆τ (P)Ω = 0

(24)

However, since ∆τ (P)Ω is a transition probability matrix, it is easy to see that a vector of ones
satisfies the equation. Hence, the matrix [I −∆τ (P)Ω] is singular, which violates a key condition
needed for the application of the Implicit Function Theorem.
Lemma L3 (Smooth invariant distribution). For all τ the unique invariant distribution of the
transition probability matrix ∆τ (P)Ω is a continuously differentiable function of P.
Proof. Proof is provided in the Appendix B.5 (page 57).
We do not explicitly spell out the solution algorithm for the heterogeneous consumer economy for space considerations. It is completely analogous to the algorithm in Section 2 except
for the calculation of type specific components in step 4 of the algorithm, needed to construct
the overall ownership distribution p as per (18)-(19) and compute the excess demand ED(P)
as per (21). As mentioned above, this requires the computation of the type specific holdings
22

distribution as a fixed point (23) for each trial vector of prices, thus step 3 of the algorithm in
Section 2 has to be incorporated into step 4 as well. All other steps remain exactly the same.
3.2

Equilibrium with time varying heterogeneity

The intermediate case between the idiosyncratic heterogeneity in Section 2 and time-invariant
heterogeneity considered above is also of interest. Here we introduce an additional exogenously evolving Markovian state variable which denotes a time varying “class” of consumers.
It appears that this case is closer to the idiosyncratic rather than to the persistent heterogeneous
setting. Therefore to avoid repetition we present it in brief.
To fix ideas, let the additional state variable y denote consumer level of income which could
enter the utility of owning a car u(a, y), or could enter the marginal utility of money µ(y). We
assume that y takes values from a finite set {y, . . . , y}, and evolves as an exogenous Markov
process. Let π denote the invariant distribution of this process, and let π(y) be the invariant
probability for this variable to take value y.
We do not repeat the Bellman equations (1)-(2) to conserve space: it is straightforward to
generalize them to account for potentially changing next period y by additional integration over
it. In general, income will affect the values of different choices in different states, and this
will induce different choice probabilities. Consequently, we add an additional argument to the
model entities that become dependent on y choice specific values v(a, y, d) and add subscript
y to income specific trade transition matrices ∆y (P) and equilibrium holdings and ownership
distributions py (P) and qy (P) etc. The trade transition matrix ∆(P) and physical transition
matrix Ω are exactly as in the time invariant setting, while the structure of the ownership and
holdings distributions mirrors their time invariant counterparts with τ replaced by y and f (τ)
replaced by π(y):


p = π(y)py , . . . , π(y)py ,


py = qy [1 − qy (ø)], qy (ø) ∈ Rā+1 .

(25)

Theorem 3 (Existence of equilibrium with time varying heterogeneity). The stationary equilibrium for the automobile economy with time varying heterogeneity among consumers defined
in D1, exists, and the equilibrium holdings distribution q(P, ā) is given by:
q(P, ā) = ∑ qy (P, ā)π(y),
y

23

(26)

where qy (P, ā) is an internal part of the income specific owner distribution py (P, ā) as per (25),
and is given by:


py (P, ā) = q(P, ā)[1 − q(ø)], q(ø) ∆y (P)Ω,

(27)

where q(ø) = ∑y qy (ø)π(y) denotes the overall fraction of consumers without cars, and Ω is
defined in (14).
Proof. Proof is provided in the Appendix B.6 (page 58).
Note that unlike in Theorem 2 the income specific ownership distribution py (P, ā) does not
constitute an invariant distribution, but is instead simply computed from the overall holdings
distribution q(P, ā) per (27). In other words, in a stationary equilibrium the “mixing” between
consumers of different incomes generates a stationarity in overall holdings even though we
see in every time period differences in the holdings of cars of rich and poor consumers. With
time-invariant heterogeneity instead, a consumer who is type τ in one period remains a type
τ consumer in the next period, and thus the relevant distribution of holdings for consumers of
each type τ is the same in both periods, explaining its description as an invariant distribution of
the relevant transition probability matrix. The same does not happen here.
Note further that if instead of stacked ∆y (P) as per (20) the trade transition matrix was
defined by ∆(P) = ∑y ∆y (P)π(y), the combination of (26) and (27) would lead to the “double
fixed point” result as in Theorem 1. Thus, the case of time varying heterogeneity is equivalent
to the case of idiosyncratic heterogeneous consumers once the trade transition matrices, as well
as the holding and ownership distributions, are averaged over with invariant income transition
probabilities. The computational algorithm for the stationary equilibrium in the economy with
time varying heterogeneity is therefore the same as in Section 2.
Based on the analogy to the idiosyncratic case, further extension of the framework that
would allow for the combination of time-invariant and time varying heterogeneity is therefore
also possible. It is also clear that the dynamics of time varying heterogeneity could then be
made type-specific without any additional cost.
3.3

Illustrative example: Gains from trade and equilibrium sorting

Figure 2 illustrates some of the equilibria in a heterogeneous agent economy with two types of
consumers. The difference between this heterogeneous example and the example presented in
Section 2.4 is the addition of a second consumer type with the same discount factor and utility
24

Figure 2: Equilibrium price functions in a two consumer type economy
(a) Normal transaction costs

(b) High transaction costs

200

200
Heterogeneous
Homogeneous type 1
Homogeneous type 2

150

150

100

100

50

50

0

4

8

12

Heterogeneous
Homogeneous type 1
Homogeneous type 2

16

0

Age of car

10

15

Age of car

Notes: Both panels show the equilibrium price functions of the heterogeneous agent economy as well as homogeneous
economies without transaction costs where all consumers are of either type. The heterogeneous equilibrium scrappage age
is 16 in panel (a) and 13 in panel (b).

function u(a), but different in their marginal utility of money, in that µ2 = 1.75 > 1.0 = µ1 .
Thus, the first type of consumers who have a lower marginal utility of money µ1 = 1 are the
rich consumer in the economy, while the second type are poor consumers. The utility of the
outside good is set to 0 for both types. The heterogeneous agent equilibrium has 50% rich
consumers and 50% poor consumers.
Thus it seems reasonable to conjecture that in equilibrium the fist type of consumers would
be more likely to own newer more expensive cars. However it is not clear a priori what relative
fractions of the two types of consumers will select into what fractions of the new and used
cars, and which fraction choose to have no car at all. Therefore these questions as well as
how transaction costs influences these distributions are of interest and can be answered by
equilibrium calculation.
Figure 2 plots two equilibrium prices: one for the case where transactions costs are held at
the same level as in example in Section 2.4, and the other for a much higher transaction cost,
namely where the intercept of the cost function is increased to from 1.5 to 10. Both panes (a)
and (b) plot the heterogeneous agent equilibrium prices together with homogeneous equilibria
without transaction costs where the economy is populated by the consumers of each type. When
transactions costs are low there is an equilibrium with ā = 16, but when transaction costs are
high the maximum supportable equilibrium has ā = 13. Thus the higher transactions costs have
succeeded in partially “killing off” the market for used cars.

25

Figure 3: Equilibrium ownership in a two consumer type economy
(a) Normal transaction costs

(b) High transaction costs

0.08

0.06
Rich consumers
Poor consumers

0.06

Rich consumers
Poor consumers

0.04

0.04

0.02

0.02
0
New

4

8

12

No car

Car age

0
New

4

8

12

No car

Car age

Notes: The total area of the bars in each panel adds up to one, presenting both the distribution of consumers over car ages, and
the share of outside good. There are equal numbers of consumers of each type. Both panels show the post-trade ownership
distributions. Since the density in the no-car state is much higher than each car-by-age category, we have split the no-car bar
into several bars placed horizontally next to each other.

There is clear evidence of sorting of consumers into the ages of the car in panel (a) of
Figure 3, which shows the post-trade ownership distribution. The rich consumers hold the
newer cars and in particular are much more likely to buy new cars than the poor consumers.
In addition, the fraction of poor consumers who do not to own a car is much higher. Overall,
we see that poor consumers are driven out of the market to a much larger extent than the rich
consumers when transactions cost increase.
These findings support specialization in holdings that enables gains from trade between the
two types of consumers: the rich consumers buy brand new cars and hold them for several years
and then sell them to poor consumers who also hold them for several years, trading the cars over
a succession of poor owners until the car is scrapped. Thus, in this example the rich consumers
are net suppliers of older cars, and the poor consumers are net demanders of older cars. Most
of the trade between rich and poor consumers occurs for cars of roughly middle ages: the rich
supply their middle aged cars to the poor consumers, and market clears in aggregate, but not
type-by-type.

4

Equilibrium with Multiple Automobile Makes/Models

We now extend the equilibrium to J > 1 different makes/models with corresponding new car
prices P j , and scrap prices P j , j = 1, . . . , J. We continue to treat new car prices P j as fixed,
26

consistent with the small open economy framework. In Section 6 we endogenize new vehicle
prices in a multiproduct oligopoly model of the new car market.
4.1

Substitution patterns with multiple models of cars

As emphasized by Berry, Levinsohn and Pakes (1995), the independence of the random preference shocks between choices can result in an undesirable pattern of equal cross-elasticities that
are unrealistic in multi-product automobile markets. However many of these undesirable patterns are a consequence of a static choice model and would not hold in a dynamic model even
under the multinomial logit specification for choice probabilities analyzed in the previous sections. We can accommodate even richer substitution patterns between different makes/models
of cars via a generalized extreme value specification for idiosyncratic heterogeneity which leads
to nested logit (NMNL) choice probabilities similar to Berkovec (1985) where we can control
the variability and correlation of the random preference shocks to reflect natural patterns of
similarity between different alternatives, such as similar unobserved attributes of different ages
of the same make/model of car. This allows for a higher degree of persistence in choices for
different makes/models of cars reflecting “brand loyalty.” However we emphasize that a nested
logit specification is not required to obtain brand loyalty: it can appear in the ordinary multinomial logit specification when consumers value one make/model of car sufficiently higher than
others.
The pattern of correlation in the idioysncratic preference shocks in a NMNL specification
can be illustrated by a “choice tree” where the upper level branches correspond to the choice
of keeping the existing car ( j = κ), choosing the outside good ( j = ø), or trading the existing car for another one. If the car is traded, correlation in preference shocks across different
makes/models is reflected in a “subtree” with branches indexed by the different makes/models
j. The lowest branches correspond to the choice of different car ages a given a choice of a
specific make/model j, as illustrated in Figure 4.
The NMNL choice tree results from the assumption that the multivariate distribution for
the vector of idiosyncratic shocks to consumer utility ε is a member of the generalized extreme
value (GEV) family introduced by McFadden (1981). Each of the elements of vector ε corresponds to the different discrete choices a consumer can make. The choice set for consumers

who does not own a car is D(ø) = ø, {( j, d) : j = 1, . . . , J, d = 0, . . . , ā j − 1} , where the
choice j = ø corresponds to remaining in the no car state, and the choice ( j, d) corresponds to
27

Figure 4: Choice trees for alternative nested logit specifications of the GEV distribution for ε

j=κ

j=ø

j=1

d=0

...

j ∈ {1 . . . J}
...

j=2

d = a1 − 1

d=0

j=J

...

d = aJ − 1

buying a car of type j and age d. Similarly, the choice set for an individual who owns a car (i, a)

is given by D(i, a) = ø, κ, {( j, d) : j = 1, . . . , J, d = 0, . . . , ā j − 1} , where j = ø corresponds
to the decision to purge their current car and own no car next period, j = κ corresponds to the
decision to keep their current car and the choice pair ( j, d) corresponds to the decision to trade
their current car for another car of type j and age d.
The joint GEV distribution of the shocks ε is described in detail in Appendix D. The
variability of choice at each nest of the nested decision tree in Figure 4 is controlled by the
J + 2 scale parameters σ, σ j>0 and σ j correspondingly at the top level choice, intermediate
level choice between car types, and the choice between new and used cars in each of the J
makes/models. By choosing any of the scale parameters to be sufficiently small, we can reduce
the effects of random shocks in current utility on choices at each respective level of the decision
tree. The additional J + 1 parameter compared to the single car type setting we have considered
so far, provide helpful flexibility in modeling complex substitution patterns among many ages
and makes/models of cars.12 By equating the scales of random shocks at different levels of the
decision tree, i.e. σ = σ j>0 , its layers collapse, and if σ = σ j>0 = σ j for all j, the nested choice
specification reverts to the original MNL specification in Section 2.
Allowing for J > 1 car types in the model introduces a new state variable j interpreted as the
make/model of the existing (in the beginning of a period) car. Consequently, the expressions
for the value function and choice probabilities have to be adjusted to take this into account.
Building on the notation of Section 3 we also allow for the multiple consumer types indexed
12 The

flexibility of the presented approach raises some concern about the identification of the scale parameters, as for
example an alternative explanation with transaction costs can be offered to explain the dynamics of car switching behavior.

28

with τ. For the consumer who does not own a car we have the following Bellman equation:




Vτ (ø, ε) = max vτ (ø, ø) + ε(ø),
max
vτ (ø, j, d) + ε( j, d) , (28)
j∈{1,...,J}, d∈{0,1,...,ā j −1}


vτ (ø, j, d) = uτ ( j, d) − µτ P( j, d) + T (P, j, d, ø)
+β(1 − α( j, d))EVτ ( j, d + 1) + βα( j, d)EVτ ( j, ā j ),
vτ (ø, ø) = uτ (ø) + βEVτ (ø),
where vτ (ø, j, d) is the value of leaving the no car state to buy a car of type j age d, vτ (ø, ø) is
the value of of remaining in the no car state, and an addition of index/argument j signifies that
the corresponding entity is car make/model specific. Similarly we extend the Bellman equation
for the consumer who owns a car (i, a):
h
Vτ (i, a, ε) = max vτ (i, a, ø) + ε(ø), vτ (i, a, κ) + ε(κ),

i
max
vτ (i, a, j, d) + ε( j, d) ,

(29)

j∈{1,...,J}, d∈{0,1,...,ā j −1}

vτ (i, a, j, d) = uτ ( j, d) − µτ [P( j, d) − P(i, a) + T (P, j, d, i, a)]
+β(1 − α( j, d))EVτ ( j, d + 1) + βα( j, d)EVτ ( j, ā j ),
vτ (i, a, κ) = uτ (i, a) + β(1 − α(i, a))EVτ (i, a + 1) + βα(i, a)EVτ (āi ),
vτ (i, a, ø) = uτ (ø) + µτ P(i, a) + βEVτ (ø),
where vτ (i, a, ø) is the value of purging one’s current car of type j age a, vτ (i, a, κ) is the value
of keeping the current car (i, a), and vτ (i, a, j, d) is the value of trading one’s current car (i, a)
for another car ( j, d).
When ε is a vector of GEV preference shocks, the expected value functions EVτ ( j, d) and
the conditional choice probabilities have more complicated formulas than the ones given in
equations (3) and (5). Computing the choice probabilities requires not only the choice specific
values v(·, ·) but also the “inclusive values” equal to the expected maximum utility from the
choice on the lower levels of the nested choice structure. However, the choice probabilities are
still given by analytical expressions that can be computed directly using the formulas provided
in full detail in Appendix D.
Even though EVτ ( j, d) has a more complicated form, all the contraction mapping theory
applies to the dynamic programming problem set out in (28) and (29) in exactly the same way

29

as before. Moreover, the results in Lemmas L1, L2 and L3 continue to apply, making possible
the use of Newton’s method for finding EVτ as the fixed point of the Bellman operator (4) and
the equilibrium prices – similar to the model with only one type of car.
4.2

Stationary equilibrium in the market with multiple types of cars

The introduction of the multiple car types into the model has surprisingly little effect on the
equilibrium definition or computational algorithm, other than increasing the dimensionality of
the problem. The results of Sections 2 and 3 apply with minimal adjustments after we redefine
the holdings and ownership distributions q and p, and correspondingly the trading and physical
transition matrices ∆(P) and Ω for the case J > 1.
With multiple types of cars j =∈ {1, . . . , J}, both the accident probability α( j, a), and more
importantly the scrappage age ā j may vary by j. Thus, we have the J secondary markets each
trading ā j − 1 used cars of different ages. It is convenient to define the total number of car
age-types as:
J

ā ≡

∑ ā j ,

(30)

j=1

so that the total number of goods traded on the secondary market is ā − J. We let P =
(P1 , P2 , . . . , PJ ) ∈ Rā−J be the concatenated vector of prices for all traded used cars in the economy that must be determined in a stationary equilibrium of the model.
Like prices, the holdings distribution of the cars of all makes/models is also a concatenated
vector of the form:

q = q1 η1 , . . . , qJ ηJ ∈ Rā ,

(31)

where q j ∈ Rā j gives the age distribution of cars of type j, and the elements of η = η1 , . . . , ηJ



are the market shares of the cars of different types. In stationary equilibrium for each j the age
distribution q j has to constitute an invariant distribution of the type-specific physical transition
matrix Q j defined by (12) as before, i.e. q j = q j Q j . The structure of the ownership distribution
p ∈ RNτ (ā+1) is inherited from the heterogeneous consumer model, so the formulas (18) and
(19) continue to hold. In combination with (31), the type specific ownership distribution is
given by:
pτ =





qτ,1 η1 , . . . , qτ,J ηJ [1 − qτ (ø)], qτ (ø) ∈ Rā+1 .

(32)

The extended physical transition matrix Ω as before describes the aging and stochastic

30

scrappage of cars, as well as the trivial transition of the outside good, but has to incorporate all
J types of cars. It takes the following block-diagonal structure:
Ω = diag{Q1 , . . . QJ , 1},

(33)

where each of the car type-specific ā j × ā j transition matrices Q j is given by (12). For a
holdings distribution q at one time period, irrespective of changes in ownership, qQ gives the
holdings distribution in the following time period. It follows from the block-diagonal structure
of Ω that (similar to the case with only one type of car) there is a continuum of invariant distributions satisfying pΩ = p, however there are J − 1 additional free parameters in constructing
these invariant distributions. More precisely, any combination of the invariant distributions q j

(such that q j = q j Q j ) of the form q1 ω1 , . . . , qJ ωJ , 1 − ∑ j ω j constitutes an invariant distribution of Ω for the appropriately defined weights ω. In equilibrium, these weights are jointly
determined by the market shares η j as well as the share of the outside good q(ø).
To describe the market clearing conditions as well as the flow equilibrium conditions we
follow the same scheme as in Section 3. In the presence of multiple car types, the structure of
the trade transition matrix ∆(P) is still given by (20), but its consumer type-specific component
∆τ (P) has to be redefined as a ā + 1 × ā + 1 transition matrix of the form:


 ∆τ (1|1, P)

..

.
∆τ (P) = 

 ∆τ (1|J, P)

∆τ (1|ø, P)



. . . ∆τ (J|1, P) ∆τ (ø|1, P) 

..
..
...

.
.
.

. . . ∆τ (J|J, P) ∆τ (ø|J, P) 

. . . ∆τ (J|ø, P) Πτ (ø|ø, P)

(34)

There are four types of components in (34): (a) square ā j × ā j matrices ∆τ ( j| j, P) are the
counterparts of the trade transition matrices ∆τ (P) = ∆Tτ (P) + ∆K
τ (P) given in (7)-(8) with the

exception that the last row and last column corresponding to the outside option are dropped;
(b) potentially non-square āi × ā j matrices ∆τ ( j|i, P) are composed of the type i cars owners’
choice probabilities Πτ ( j, d|i, a, P) to trade for cars of type j; (c) 1 × ā j row vectors ∆τ ( j|ø, P)
are composed of choice probabilities of consumers who don’t own a car to purchase type j car,
and (d) āi × 1 column vectors ∆τ (ø|i, P) are composed of choice probabilities of the owners of
type i cars to purge their cars.
With this notation, the market clearing conditions can be expressed using ∆τ (P) transition
31

matrix similar to the way it is done in Sections 2 and 3. In particular, in the single consumer
type case when Nτ = 1, the invariant distribution of ∆τ (P) (34) is market clearing distribution
for given prices, which by Theorem 1 constitutes one of the conditions for the equilibrium in
this case. When Nτ > 1, the results of Theorem 2 also hold with the Ω matrix and ∆τ (P) defined
respectively by (33) and (34) above. When Nτ > 1, the analog of formulas (10) and (21) can
easily be derived, but the right hand side is somewhat more complicated:



I
 



 . 
p ∆(P) −  .. 
=
ED1 (P), . . . , EDJ (P), D(ø, P) − S(ø, P) ,
 
I

(35)


where ED j (P) = D j (P) − S j (P), D j (0, P) − S j (ā j , P) is the 1 × ā j vector of excess demands
on the secondary market including the flow equilibrium condition D j (0, P) − S j (ā j , P) for car
of type j, and I denotes a ā + 1 × ā + 1 identity matrix. With some matrix algebra it is possible
to show using (32) that the flow equilibrium condition for each car type j, D j (0, P) = S j (ā j , P),
can be expressed as
Nτ

0

=

∑
τ=1


J
f (τ) [1 − qτ (ø)] ∑ ηi
i=1

āi


q
(a)Π(
j,
0|i,
a,
P)
+
q
(ø)Π(
j,
0|ø,
P)
. (36)
τ
∑ τ,i

a=1

Equations (36) for j ∈ {1, . . . , J} form a linear system of J equations that allow us to compute
J unknown market shares η j , j ∈ {1, . . . , J}, conditional on prices. Because the elements of
(32) have to sum up to one, it follows that once market shares are determined, the share of the
outside good for each consumer type τ can be found as a residual.
Theorem 4 (Existence of equilibrium with multiple car types). The stationary equilibrium for
the automobile economy with multiple car types defined in D1, exists, and is given by:
(a) The conditions of Theorem 1 in the case of a single consumer type, Nτ = 1;
(b) The conditions of Theorem 2 in the case of time-invariant consumer heterogeneity; and
(c) The conditions of Theorem 3 in the case of time-variant consumer heterogeneity.
The required holdings and ownership distributions are given by (31) and (32), physical transition matrix is given by (33), and the trade transition matrix by (34).
Proof. Proof is provided in the Appendix B.7 (page 58).
The solution algorithm for the case of multiple car and consumer types is completely analo32

Figure 5: Stationary equilibrium with 2 car types and 2 consumer types
(a) Equilibrium prices

250

(b) Post-trade ownership distribution

Car type 1
Car type 2

200

0.06

150

Rich consumers
Poor consumers

0.04

100

0.02
50
0

4

8

12

16

20 22

Age of car

0
New 4

8 12 New 4

8 12 16 20No car

Car age

Notes: Panel (b) shows post-trade ownership distribution computed by p∆(P) for each car type. The sum of the area of all bars
adds up to one. Equilibrium scrappage age is 16 year for normal and 22 year for luxury car types.

gous to the algorithm in Section 3 with the redefined transition matrices as per Theorem 4, and
an additional step to compute the market shares of different types of cars by solving a linear
system (36). It is possible to show that the analogs of Lemmas L2 and L3 hold in the multiple
car type case, and it is easy to see that (36) define the market shares as an implicit function of
prices whose gradient can be calculated analytically. Hence, Newton’s method can be used to
solve for the fixed point of Γ(EVτ ) and for the zero of ED(P) for the equilibrium prices P.
Similar to the single car case, we define a maximal equilibrium as the largest vector of scappage ages for the J cars, (ā1 , . . . , āJ ) that support the price functions that satisfy the assumptions
on infinite elastic supply of new cars and demand for scrap cars. The only adjustment to the
algorithm from Section 2 for the multiple types of cars is that validity of equilibrium prices is
checked one by one for all j ∈ {1, . . . , J} types of cars while keeping the scrappage ages of the
other types fixed. When we are no longer able to individually increment the scrappage ages of
any of the J car types without violating the price constraint, then the algorithm terminates and
returns the last estimate of the maximal equilibrium as the stationary equilibrium for the auto
market.

33

4.3

Illustrative example: Equilibrium with two car models and two consumer types

Figure 5 illustrates an example equilibrium with J = 2 car types and 2 consumer types. The parameters of the consumer preferences and the first type of the car are the same as in Sections 2.4
and 3.3. The second car type in the economy is a luxury car with higher price P = 260 (30%
higher), higher scrap value P = 5. The luxury car is also more desirable for the consumers of
both types, i.e. u(a) = 65 − 4.75a, while the normal car delivers the utility of u(a) = 60 − 5a.
Both cars have the same transaction costs and accident probabilities.
We would expect that consumers not only sort themselves into newer and older cars by their
marginal utility of money, but also own different types of cars in equilibrium. Indeed, in the
computed maximal equilibrium we can see strong sorting in both types of cars and ages of cars,
see panel (b) in Figure 5. The rich consumers mostly buy new cars of both types, and almost
exclusively the new luxury cars. The holding behavior also differs by both consumer and car
type. The rich consumers hold normal cars for about 5-7 years, and then sell them to a sequence
of poor consumers who hold these car until considerable longer until scrappage. The luxury
cars, even though their market share is significantly lower, are kept for much longer, and as a
result, their equilibrium scrappage age is 22 years while for normal cars it is only 16 years.

5

Analysis of Danish Car Tax Policy

In this section we illustrate the use of the model for policy analysis. We conduct a stylized
analysis of various tax reforms that have been under discussion in Denmark, which has one of
the highest marginal tax rates on new vehicles in the world: 180% prior to 2016 and 150% after
2016 on all new vehicles whose price exceeds about K = 81, 000 DKK. The total tax revenue
from cars, including registration taxes, annual fees, and fuel taxes, make up about approximately 4 to 7 percent of annual tax revenue, so it is important to have accurate predictions of
the fiscal impacts of tax reforms. We consider a revenue-neutral counterfactual policy change
that reduces marginal tax rates for the vehicle registration tax by 50% and increases fuel taxes
to make up for the lost revenue. We extend our framework to also include driving decisions to
illustrate its suitability for analyzing the effects of this policy change. This also allows us to
study the environmental and congestion impacts of policy changes.

34

5.1

Utility specification: adding driving choice

In this section we extend the model to endogenize driving, which is essential for analyzing how
consumers would react to a substantial increase in the gas tax. Obviously, a main reason to
have a car is to drive it and the development of our model so far has ignored this key aspect of
a car. Let x denote the number of kilometers a consumer chooses to travel in a period, and let
Pxj denote the price per kilometer traveled for a car of type j. This equals the price of fuel (e.g.
kroner per liter) divided by the car’s fuel efficiency (kilometers per liter of fuel) for car type j.
Let uτ ( j, a, x) be the utility a consumer of type τ obtains from owning a car of type j and age
a and driving it x kilometers during the period. We assume that the probability of an accident
and other physical deterioration in an automobile is independent of driving, x, and is instead
only a function of car age a. The benefit of this rather strong assumption is that driving becomes
a static sub-problem of the consumer’s overall dynamic optimization problem. Without it,
continuous driving choice has dynamic consequences, and the consumer must consider the
effect of current driving on the future physical status of their car.
With this assumption, driving choices become independent of the trading decisions, and
thus the optimal amount of driving xτ ( j, a, Pxj ) solves the static sub-problem of maximizing
the driving utility net of monetary cost, uτ ( j, a, x) − µτ xPxj . Substituting xτ ( j, a, Pxj ) back into
the utility function uτ ( j, a, x) we obtain the indirect utility uτ ( j, a) for owning a car of age a
that incorporates the individual’s optimal choice of driving. Assuming Pxj is time-invariant, the
resulting model falls within the specification of Section 4.
To model the discrepancy between the theoretical optimal amount of driving and actual data
on kilometers traveled by different cars between (bi-annual) inspections in Denmark, we treat
xτ ( j, a, Pxj ) as planned driving. Actual driving responds to the unexpected needs for driving that
cannot be predicted exactly. Consider the following utility specification that leads to a simple
econometric model, which we estimate using Danish data:

uτ ( j, a, x) = γ( j, τ) + ξ x − φ2 x2 , γ( j, τ) = γ j + γτ + γ1 a + γ2 a2 .

(37)

We assume that ξ is a random variable that represents various unobserved needs for driving.
Taking into account the cost of driving µτ xPxj , the optimal level of driving xτ ( j, a, Pxj ) implied

35

by this structure is:
xτ ( j, a, Pxj ) =

1
φ



− µτ Pxj + γ j + γτ + γ1 a + γ2 a2 + ξ
type

= −βPτ Pxj + βcar
j + βτ



+ βa1 a + βa2 a2 + ξ.

(38)

Using a simple linear regression we estimate coefficients of (38), and given the marginal utility
of money µτ compute the parameters of the utility function (37), to perform the counterfactual
policy simulation.13
5.2

Calibration and policy simulations

To assess heterogeneous effects of the reform, we set up the model with J = 2 car types and
Nτ = 2 types of consumers, rich and poor, depending on whether their income is above or below
the median. The two car types j = {1, 2} are defined by dividing the Danish car-fleet in two
groups based on weight, where j = 1 refers to a smaller, cheaper and slightly more fuel efficient
car and j = 2 refers to a larger, more durable and expensive car. We use the Danish micro data
from Gillingham and Munk-Nielsen (2019) to estimate the reduced-form driving equation (38)
to obtain coefficients: βP = (−2.6447, −5.9003), βcar = (0, 3.0267), βtype = (20.134, 20.818),

βa1 = −0.19906, and βa2 = 0.0029431. Given the reduced-form driving estimates, we then
calibrated the marginal utility of money µτ and an additional car type specific fixed effect in the
utility function u( j, a) to match the total fraction of cars, the fractions of new cars owned by
consumers of different types, and the fraction of cars older that 15 years in the overall car age
distribution.14
Using this specification we analyzed the effects of a revenue neutral reform that reduces
registration tax rates for new vehicles by half and simultaneously increases the fuel tax rate by
about 12% (from 100% to 112%) to keep the policy change revenue neutral.15 The results of
the counterfactual simulation are presented in Figure 6 and Table 1.
The top panels of Figure 6 illustrate the equilibrium prices and holdings under the tax sys13 We

ignore the restriction x( j, a, Pxj , ξ) ≥ 0 which implies that ξ must be a truncated normal distribution. Also, because
marginal utility of money µτ differs by consumer type, technically all coefficients of the utility function (37) become type
specific. For notation simplicity we do not add additional τ subscripts to reflect this dependence.
14 Details on data and estimation results are available upon request.
15 The registration taxes are given by a piecewise linear tax rule with two major brackets, such that new car prices after value
0
0
0
added tax are given by P = (P + T (P )) where, P is the price of a new car including 25% VAT but before other taxes, and
0
0
0
0
T (P ) is the vehicle registration tax T (P ) = t1 min(P , K) + t2 max(P , 0). The top marginal tax rate, t2 , was reduced from
1.8 to 1.5 in 2016, and t1 was reduced from 1.05 to 0.85 in 2019.

36

Figure 6: Counterfactual simulation of automobile taxation reform in Denmark.
(a) Equilibrium prices (baseline)
350

200
150
100
50
4

8

12

16

0.5
Rich consumers
Poor consumers

0.04

250

0

20

0.3

0.02

0.2

0.01

0.1

0
New 4

8

12

2

6

10 14 18 No car

Car type 1
Car type 2

200

(e) Ownership (sim)

50

0.01

5

10

Age of car

15

0
New

2

Fuel tax

0.5
0.4

150
0.02

1

Rich consumers
Poor consumers

0.6

0.05

100

2

(f) Tax revenue (sim)

0.06

0.03

1

New car tax

0.04

0

0

Car age

(d) Equilibrium prices (sim)

Rich consumers
Poor consumers

0.4

0.03

Age of car

250

(c) Tax revenue (baseline)

0.05

Car type 1
Car type 2

300

(b) Ownership (baseline)

Rich consumers
Poor consumers

0.3
0.2
0.1

4

8

New

4

8

12

16
No car

Car age

0

1

2

New car tax

1

2

Fuel tax

Notes: Panels (a) to (c) show the base line economy, panels (d) to (f) show the counterfactual equilibrium with taxes on new
cars reduced by half, but the tax on fuel increased from about 100% to 112%. The equilibrium scrappage ages are 13 and 21
in panel (a), and 11 and 17 in panel (e). Panels (b) and (e) plot post-trade ownership distributions. Panels (c) and (f) display
the composition of tax revenue across car types (1 and 2), consumer types and two sources (new car tax and fuel tax).

tem with up to 180% registration tax on new vehicles. Panel (a) shows the baseline equilibrium
prices of a new vehicles which are P = (183.12, 380.25) (in thousands of DKK), with the implied before tax prices (74.02, 130.34). The secondary market adjusts to the high new car prices
by raising the prices of used cars. Consumers respond by keeping their cars longer in aggregate,
so cars are not scrapped until they are 13 and 21 years old. Panel (b) illustrates the equilibrium
ownership distribution in the baseline. Poor consumers are affected by the high registration tax
more: 8.32% of them do not own cars compared to 4.4% of rich consumers. These correspond
to the observed shares of the outside good, and are calibrated together with the market shares of
each car type. It easy to see from panel (b) that as expected, rich consumers sort into the higher
quality car type and into newer cars of both types. The tax revenue in the baseline amounts to
18,016 DKK per household, or approximately 45.04 billion DKK in total. Its composition is
shown in panel (c) of Figure 6. About 67.67% of all revenue comes from the sales tax, with
more than two thirds of this part from the more expensive cars.
37

Now consider the effect of reducing the registration tax rates by half. We use a calibrated
version of the model to predict the impact of this change on equilibrium prices and scrappage
ages, ownership distribution, driving, fuel consumption and CO2 emissions. Together with the
decrease in the registration tax for new cars, in the counterfactual simulation we increase the
fuel tax in order to keep the policy revenue-neutral. Taking all of the effects into account, we
find that increasing the fuel tax by 12% is sufficient to compensate for the lost registration tax
revenue.
The effects of the reform are presented in the bottom panels of Figure 6. There is a large
reduction in the price of new vehicles visible in panel (a): after tax prices in the counterfactual
economy are 137.82 and 271.59 thousand DKK which is a 24.7% and 28.6% reduction in price
compared to the baseline case. The reduction in the cost of buying new cars has a significant
effect on the longevity of car fleet: compared to the baseline, in the counterfactual economy
the scrappage age falls by 2 years for the small car and by 4 years for the bigger car. Panel (e)
shows that in the counterfactual simulation nearly all consumers own cars (the share of the
outside good is 1.28%), and there is a massive substitution away from the cheaper cars. This
effect can be explained by the much higher utility provided by the type 2 cars. Even though
these cars are significantly more expensive, they are also more durable, and the car-specific
utility calibrated to match the baseline market shares is almost twice the level of the cheaper
car. Evidently, in the baseline economy the high registration taxes made type 2 cars out of
reach for a large fraction of the population, who substitute away from the cheaper car when the
reduction in registration taxes cause new car prices to fall. Panel (f) presents the composition
of tax revenue under the new policy. We can see that bigger cars becomes the dominant source
of revenue, following the shift of ownership evident from panel (e). In addition, the share of
fuel tax revenue increased from about 21% to 40%, reflecting the higher total driving in the
economy.
Table 1 provides more details on the effects of the tax rule changes. In particular, we can
see that even though the average driving per person increases by about 16.4%, the effect comes
largely from the extensive margin. The estimated parameters do imply a moderate response
to fuel prices with driving elasticities with respect to the fuel price in the range −0.1 to −0.3

(depending on consumer and car type).16 As a result of the relatively inelastic response in total
16 Gillingham

and Munk-Nielsen (2019) estimated a constant fuel price elasticity of −0.3 in their log specification which
includes many additional controls and fixed effects. They show that the price elasticity is fairly robustly estimated across
different specifications.

38

Table 1: Effects on fuel consumption, driving and emissions
Market/ownership
shares

Driving
(1000 km/person)

Fuel consumption
(1000 liter/person)

CO2 emissions
(ton/person)

baseline

baseline

baseline

baseline

sim

sim

sim

Avg. elasticity
of driving

sim

baseline

sim

2.69
3.53

-0.10
-0.10

-0.11
-0.11

-0.25
-0.26

-0.27
-0.28

Consumers with income above the median
Light cars (1)
Heavy cars (2)
No car

0.16
0.30
0.04

0.05
0.45
0.00

17.47
19.86

17.47
19.90

1.12
1.47

1.13
1.48

2.69
3.52

Consumers with income below the median
Light cars (1)
Heavy cars (2)
No car

0.18
0.24
0.08

0.06
0.43
0.01

15.78
17.61

15.70
17.62

1.02
1.31

1.01
1.31

2.43
3.12

2.42
3.12

Total

1.00

1.00

15.70

18.28

1.11

1.34

2.65

3.20

Notes: The table shows the effects on the Danish automobile market from a reduction of the new car (registration) tax
by half with simultaneous increase of the fuel tax rate by 12% to maintain the same amount of tax revenue before and
after the policy change. The last column of the table shows the elasticity of driving with respect to fuel price, averaged
over the holdings of the cars of different ages.

kilometers driven, the required increase in the fuel tax necessary for the tax change to be revenue neutral is comparatively moderate. However there are environmental costs to this policy
change: the increase in driving results in higher total fuel consumption and CO2 emissions.17
To assess the welfare effects of the reform, we computed the expected value of the automobile fleet using EV (a) values that follow from the solution of the consumer utility maximization
problem, and the stationary ownership distribution p(ā, P). The 50% reduction of the registration tax which is accompanied by a moderate 12% increase in price of fuel has a large positive
effect on consumer welfare. In aggregate, the change in tax regime generates an annual welfare gain of approximately 9,302 DKK per capita or 23.3 billion DKK in total. Moreover,
the welfare improvement is uniform across the types of consumers: the effect of the reform is
equivalent to an annual lump sum payment of 4,606 DKK for the rich consumer, and 4,695
DKK for the poor consumer.
Of course, several caveats are in order from this stylized analysis, which was only crudely
calibrated to approximate the Danish automobile market. First, the welfare gains mentioned
above do not account for the substantial increase in CO2 emissions of 0.55 ton per person per
year, corresponding to an 9% increase in total per capita CO2 emission in Denmark. If we were
to consider a CO2 -neutral policy change rather than a revenue neutral one, it would result in
a much larger increase in fuel taxes. Second, there may be other effects from the tax change,
such as increased road congestion, travel times, air pollution, and the effect on climate. We do
17 CO

2

emissions are calculated based on the 2.392kg/l conversion rule.

39

not take these into account. Our policy example should best be seen as a first cut illustration to
demonstrate the potential usefulness of the model for policy analyses, and much deeper analysis
would be required to reach any definitive conclusions on the desirability of this particular tax
reform for Denmark.

6

Equilibrium in the Primary Market for Automobiles

We now extend our equilibrium framework to allow for endogenous determination of new
vehicle prices. New car producers need to consider the effect of their pricing on both the new
and used car markets and its effect on scrappage and equilibrium sorting of heterogeneous
consumers into different types and ages of cars. We use this model to examine a stylized
“merger to monopoly” counterfactual.
6.1

Bertrand price competition between multi-product vehicle producers

We make the common assumption of a Bertrand-Nash equilibrium, but allow new vehicle producers take into account the equilibrium in the secondary market including the endogenous
determination of scrappage ages. Firms produce multiple vehicle types and internalize the effect of changing own car prices on not just competitor market shares, but also the composition
of own sales.
As before, let j ∈ {1, . . . , J} index the set of all vehicles that could potentially be produced
by F firms which we index as f ∈ {1, . . . , F}. Let the sets (O1 , O2 , . . . , OF ) be a partition of the
set of possible vehicle types {1, . . . , J}, so that O f denotes the set of vehicle types that could be
produced by firm f . We can think of O f as a collection of production plans that firm f owns,
but whether it actually produces all O f vehicles is determined in equilibrium.
Let c f (~q f ) denote the cost function of be firm f , where ~q f = {q j : j ∈ O f } is the vector of
quantities of the vehicles that firm f produces, normalized as shares of the population that buy
these new vehicles in stationary equilibrium. We allow for very flexible patterns of production
interdependencies, such as economies of scale and economies of scope due to central production of shared underlying vehicle components (e.g. engines, car bodies, etc).18 We take the
set of vehicles O f (and their characteristics) as given, and assume there is common knowledge
18 For simplicity, we ignore the higher level product R&D investments that firms use to introduce new vehicle types into the
market.

40

by all automakers about how different types of consumers perceive different types of vehicles. That is, we assume that there is common knowledge of consumer preferences uτ ( j, a) and
consumer marginal utilities of money, µτ by all firms.
Let P f = {P j : j ∈ O f } be the vector of new vehicle prices that firm f charges for its own
vehicles types j ∈ O f in a stationary equilibrium, and let P− f denote the new vehicle prices of
firm f competitors. In a Bertrand-Nash equilibrium, firm f prices will be set as a best response
P f = Ψ f (P− f ) to the prices charged by its competitors:
Ψ f (P− f ) = argmax
Pf

h

∑

j∈O f

P j q ā j (P f , P− f ), j, P f , P− f



i
− c f {q(ā j (P f , P− f ), j, P f , P− f ) : j ∈ O f } . (39)
Equation (39) states that firm f chooses the prices of its vehicles, P f , to maximize its profits,
taking the prices of its competitors P− f as given, while considering the effect of the prices on
the overall equilibrium in the new and secondary market, including the possibility of cannibalization of sales of its own vehicles (“internal competition”). Though equation (39) provides
only single period profits, in a stationary equilibrium if firm f discounts future profits with
discount factor β f ∈ (0, 1), then discounted profits equal the right hand side of (39) scaled up
by 1/(1 − β f ) which does not affect the definition of Ψ f .
In equation (39), q(ā j (P f , P− f ), j, P f , P− f ) represents the new vehicle sales of type j ∈ O f
in a stationary equilibrium of the model which is determined by the invariant ownership distribution q(P) given in (22), see Theorem 2. The prices of all used vehicles will be implicit
functions of (P f , P− f ) as described in Section 4. Thus, though each firm takes its competitor
prices as given, each firm is presumed to have a sophisticated understanding of the equilibrium
in the overall market, including prices, sales, scrappage ages, the stationary holdings distribution, and the effect of prices on the share of consumers who choose not to own a vehicle.
∗

∗

A Bertrand-Nash equilibrium is then any fixed point (P1 , . . . , PF ) to the system of best
response correspondences for the F firms in this market:
∗

∗

∗

∗

(P1 , . . . , PF ) ∈ (Ψ1 (P−1 ), . . . , ΨF (P−F )).

41

(40)

Figure 7: Bertrand-Nash Equilibrium in the new car market
(a) Demands as function type 1 car price

(b) Market share of outside good

Demand functions for new cars as a function of new car 1 price

Market share of outside good as a function of new car 1 price

Demand for car type 1
Demand for car type 2

0.08

0.55
0.5
0.45
0.4

0.06

0.35
0.05

Share)

Demand (market share)

0.07

0.04

0.3
0.25
0.2

0.03

0.15
0.02
0.1
0.01
0.05

150

160

170

180

190

200

210

220

150

160

170

Price of new car of type 1

(c) Scrappage age of type 1 car

18

180

190

200

210

220

Price of new car of type 1

(d) Best response functions

Endogenous scrappage age for car 1 as a function of its price

190

Betrand Nash Duopoly Equilibrium in the Primary Market for Cars

185

17

180

Price of new type 1 car

Scrappage age for 1 (in maximal equilibrium)

Firm 1 best response
Firm 2 best response

17.5

16.5

16

15.5

170

165

15

160

14.5

155

14
150

160

170

180

190

200

210

150
170

220

Price of new car of type 1

6.2

175

175

180

185

190

195

200

205

210

215

Price of new type 2 car

Illustration: analysis of new car duopoly and impact of merger to monopoly

Consider a market with J = 2 types of vehicles and F = 2 firms and assume the market is
initially a Bertrand-Nash duopoly. Panels (a) to (c) of Figure 7 show how the Bertrand-Nash
equilibrium depends on the price of new car of type 1, P1 . Panel (a) plots the demand for both
car types when firm 1 changes the price of its vehicle P1 , while firm 2 keeps its vehicle price
fixed at P2 = 220. We see, as expected, that new car 1 demand is a downward sloping function
of its own price, whereas the demand for new cars of type 2 is an increasing function of the
price of type 1, reflecting a market-level substitution effect. Notice that demand for vehicle
type 2 only arises when P1 ≥ 180. When P1 rises to 220 (and thus equal to P2 ), demand for
vehicle type 1 falls to zero, and the demand for vehicle type 2 peaks at a little over 3% of the
population.
Panels (b) and (c) of Figure 7 provide insight into the complexity of demand when all
relevant avenues of consumer substitution are considered. It follow from panel (c) that when

42

Table 2: Welfare analysis of the hypothetical merger to monopoly
Monopoly
Price of new car
Fraction of new cars, %
Scrappage age

Duopoly

car type 1

car type 2

car type 1

car type 2

374.91
1.5 ×10−4
18

386.93
1.5
20

151.84
0.9
15

186.27
6.7
18

Rich consumers
Fraction owning no car, %
Distribution of cars held, %
Average age held
Consumer surplus

2.4
7×10−3
7.80
0.002

0.0
97.6
7.85
32.54

11.5
2.00
2.66

88.5
2.15
26.33

Poor consumers
Fraction owning no car, %
Distribution of cars held, %
Average age held
Consumer surplus

96.8
0
17.15
0.0004

Profits
Consumer surplus
Total social surplus

0.04
3.2
18.27
6.69

3.35
39.24
42.59

10.5
8.8
3.23

89.1
9.9
42.26
1.11
74.48
75.59

P1 rises, the secondary market adjusts and the scrappage age ā1 (P1 , P2 ) increases from 14 to
18. The increase in the scrappage age reduces new vehicle demand and contributes to the price
elasticity of demand for new vehicles. Panel (b) shows an additional margin of substitution:
an increasing share of consumers choosing not to own vehicles as P1 rises from nearly zero to
about 60% when P1 approaches the price of vehicle 2, P2 = 220. Essentially all of these are in
the 80% of the population who are poor, i.e. have the higher marginal utility of money µτ = 2
compared to µτ = 1 for the rich consumers.
Panel (d) of Figure 7 illustrates the existence of a unique duopoly Bertrand-Nash equilibrium in this model by plotting the two best response functions Ψ1 and Ψ2 as a function of the
competitor’s price. We assume that the two firms have constant marginal costs of production
given by c1 = 150 for vehicle type 1 and c2 = 170 for vehicle type 2. The reaction functions
∗

∗

cross at the pair (P1 , P2 ) = (151.84, 186.27). In this equilibrium, vehicle type 1 is actually the
“inferior good” in the sense that even though it has a lower marginal cost of production and a
∗

lower price, both consumer types prefer vehicle type 2 at the higher price of P2 = 186.27. The
markup for vehicle type 1 is only 1.84 whereas the markup for vehicle type 2 is 16.27. The
higher utility provided by vehicle type 2 makes it relatively more valuable to consumers despite
its higher price.
Table 2 summarizes key statistics from a “merger to monopoly” counterfactual where firms
1 and 2 merge. The table shows that allowing such a merger would have devastating impact

43

on the car market: the prices of cars 1 and 2 more than double. The monopolist endogenously
“overprices” vehicle type 1, causing its market share to fall nearly to zero. In response to the
high prices charged by the monopolist, nearly 78% of the population chooses to forgo owning
a car after the merger. Though firm profits triple after the merger, consumer surplus is nearly
cut in half and total social surplus (consumer surplus plus total profits) falls by 44%. Since
consumer surplus is vastly greater than firm profits, it seems that allowing a merger would be a
very bad idea in this stylized economy.

7

Discussion and Conclusions

We have introduced a computationally tractable model of equilibrium in the primary and secondary markets for automobiles that allows for flexible specifications of preferences and consumer heterogeneity and transactions costs. Our work was inspired by the early static discrete
choice models of equilibrium in the automobile market pioneered by Manski, Sherman, and
Berkovec and the subsequent efforts to extend their models to include dynamics and transactions costs and model equilibrium price setting in the primary market by Rust, Stolyarov,
Gavazza, Lizzeri and Roketskiy, and Esteban and Shum. We believe that our framework is
promising for empirical applications and policy analysis, and in future work we plan to further
extend and apply it in a number of directions.
One of these directions is ongoing work (Gillingham, Iskhakov, Munk-Nielsen, Rust and
Schjerning, 2019) to structurally estimate an “overlapping generations” version of our model
using Danish register data to allow for a realistic counterfactual analysis of vehicle tax reform
in Denmark. Another direction is to develop alternatives to the Berry, Levinsohn and Pakes
(1995) approach for estimating consumer preferences and analyzing equilibrium, by analyzing
the identification of parameters in the context of a realistic dynamic model of the primary and
secondary automobile markets. A third direction would relax the assumption of stationarity
and extend out concept of equilibrium to allow for macroeconomic shocks that can capture
the pronounced “waves” often found in the age distribution of vehicles (Adda and Cooper,
2000). We are comparing different solution concepts in terms of computational tractability
and empirical realism, including the “temporary equilibrium” concept of Grandmont (1977),
the “sufficient statistic” approach of Krusell and Smith (1998), as well as a full blown rational
expectations equilibrium that takes into account the entire holdings distribution of cars as a

44

component of the “state variables” that consumers use to predict future prices as in Cao (2016).
A very challenging extension of our model would endogenize the characteristics of vehicles
by allowing firms to invest in R&D to produce new vehicle designs. Longer-run competition on
attributes will likely require a fundamentally non-stationary framework and raises questions of
consumer expectations over future products. Very promising headway into this sort of analysis
has been done in the pioneering work of Goettler and Gordon (2011), and it may be possible to
adapt this approach into a more evolutionary model of the automobile market. A final challenging extension would be to incorporate asymmetric information in a more detailed treatment of
the “microstructure” of trade in the automobile market, including endogenous intermediation of
trade by car dealers as well as direct consumer transactions. Recent studies such as Biglaiser,
Li, Murry and Zhou (2019) have provided new empirical insights into the microstructure of
trade that are not modeled in our framework, but represent important directions to pursue in the
development of more detailed and realistic models of trade in automobile markets.

References
A DDA , J.

AND

R. C OOPER (2000): “Balladurette and Juppette: A Discrete Analysis of Scrap-

ping Subsidies,” Journal of Political Economy, 108(4), 778–806.
A KERLOF, G. A. (1970): “The Market for ‘Lemons’: Quality Uncertainty and the Market
Mechanism,” Quarterly Journal of Economics, 84, 488–500.
B ERKOVEC , J. (1985): “New Car Sales and Used Car Stocks: A Model of the Automobile
Market,” RAND Journal of Economics, 16(2), 195–214.
B ERRY, S., J. L EVINSOHN

AND

A. PAKES (1995): “Automobile Prices in Market Equilib-

rium,” Econometrica, 63(4), 841–890.
B IGLAISER , G., F. L I , C. M URRY

AND

Y. Z HOU (2019): “Middlemen as Information Inter-

mediaries: Evidence from Used Car Markets,” manuscript, Stony Brook University.
C AO , D. (2016): “Recursive Equilibrium in Krusell and Smith (1998),” manuscript.
E STEBAN , S. AND M. S HUM (2007): “Durable-goods Oligopoly with Secondary Markets: The
Case of Automobiles,” RAND Journal of Economics, 38(2), 332–354.

45

G AVAZZA , A., A. L IZZERI AND N. ROKETSKIY (2014): “A Quantitative Analysis of the UsedCar Market,” American Economic Review, 104(11), 3668–3700.
G ILLINGHAM , K., F. I SKHAKOV, A. M UNK -N IELSEN , J. RUST AND B. S CHJERNING (2019):
“A Dynamic Model of Vehicle Ownership, Type Choice, and Usage,” manuscript.
G ILLINGHAM , K.

AND

A. M UNK -N IELSEN (2019): “A tale of two tails: Commuting and the

fuel price response in driving,” Journal of Urban Economics, 109, 27–40.
G OETTLER , R. L.

AND

B. R. G ORDON (2011): “Does AMD Spur Intel to Innovate More?,”

Journal of Political Economy, 119(6), 1141–1200.
G RANDMONT, J. M. (1977): “Temporary General Equilbrium Theory,” Econometrica, 45(3),
535–572.
H ENDEL , I.

AND

A. L IZZERI (1999): “Adverse Selection in Durable Goods Markets,” Ameri-

can Economic Review, 89(5), 1097–1115.
H OWARD , R. A. (1960): Dynamic Programming and Markov Processes. MIT Press, Cambridge, MA.
I SKHAKOV, F., J. RUST

AND

B. S CHJERNING (2015): “Recursive Lexicographical Search:

Finding All Markov Perfect Equilibria of Finite State Directional Dynamic Games,” The
Review of Economic Studies, 83(2), 658–703.
KONISHI , H. AND M. S ANDFORT (2002): “Existence of Stationary Equilibrium in the Markets
for New and Used Durable Goods,” Journal of Economic Dynamics and Control, 26(6),
1029–1052.
K RUSELL , P.

AND

T. S MITH (1998): “Income and Wealth Heterogeneity in the Macroecon-

omy,” Journal of Political Economy, 106(5), 867–896.
M ANSKI , C. (1980): “Short Run Equilibrium in the Automobile Market,” Falk Institute Discussion Paper 8018, Hebrew University of Jerusalem.
(1983): “Analysis of Equilibrium Automobile Holdings in Israel with Aggregate Discrete Choice Models,” Transportation Research, 17B (5), 373–389.
M ANSKI , C. AND E. G OLDIN (1983): “An Econometric Analysis of Vehicle Scrappage,” Transportation Science, 17 (4), 365–375.
46

M ANSKI , C. AND L. S HERMAN (1980): “Forecasting Equilibrium Motor Vehicle Holdings by
Means of Disaggregate Models,” Transportation Research Record, 764, 96–103.
M C FADDEN , D. (1981): “Econometric Models of Probabilistic Choice,” in Structural Analysis
of Discrete Data, ed. by C. Manski and D. McFadden, pp. 198–272. MIT Press, Cambridge,
Massachusetts.
RUST, J. (1985a): “Equilibrium holdings distributions in durable asset markets,” Transportation Research B, 19(4), 331–345.
(1985b): “Stationary Equilibrium in a Market for Durable Assets,” Econometrica,
53(4), 783–806.
(1985c): “When is it Optimal to Kill Off the Market for Used Durable Goods?,”
Econometrica, 54(1), 65–86.
(1987): “Optimal Replacement of GMC Bus Engines: An Empirical Model of Harold
Zurcher,” Econometrica, 55(5), 999–1033.
(1994): “Structural estimation of markov decision processes,” vol. 4 of Handbook of
Econometrics, pp. 3081 – 3143. Elsevier.
S TOLYAROV, D. (2002): “Turnover of Used Durables in a Stationary Equilibrium: Are Older
Goods Traded More?,” Journal of Political Economy, 110(6), 1390–1413.

47

Appendix
A

Homogeneous Consumer Economy (replication of Rust 1985b)

In this appendix we replicate the results from Rust (1985b) for our case of discrete product
market. This is a limiting case for the general framework that we incrementally build in the
main part of the paper which admits a simple numerical solution that constitutes the source of
precise starting values for the main solution algorithm.
Model setup
Consider the model set up in Section 3, with the simplification that (i) transaction costs are zero,
(ii) there is no outside option, and most importantly (iii) there are no extreme value preference
shocks.
Denote V (a) the value function for the owner of car of age a ∈ {1, . . . , A − 1}. Consumer’s
decision making process is given by the following Bellman equation:
n
o
V (a) = max v(a, κ);
max
v(a, d) ,
(41)
d∈{0,...,γ? −1}

v(a, κ) = u(a) + β 1 − α(a) V (a + 1) + βα(a)V (A),
(42)



v(a, d) = u(d) − µ P(d) − P(a) + β 1 − α(d) V (d + 1) + βα(d)V (A),
(43)
where v(a, ·) is the choice specific value function, and d = κ denotes the choice of keeping the
existing car. For the owners of the maximum age car, a = A, the keep choice is not available,
and thus the first component in the right hand side of (41) disappears.
Note the timing convention underlying the Bellman equation given by (41)-(43). We assume
that the consumer enter the period with a car of age a, and makes the trading/keeping choice
immediately at the start of the period. The car that consumer ends up with after trading is the
one that is utilized in the period, and that can be involved in the accident during that time. By
the start of the next period this car is one year older, or in case of an accident reaches the upper
bound of age A and can not be kept any longer (must be scrapped). With this timing convention,
it is impossible to start the period with a brand new car, thus the state variable a can only take
values from {1, . . . , A}. In the same time, cars that can be acquired during trading can have
ages {0, . . . , γ? − 1} which includes the new cars of age zero.
Theorem A.T1 (Consumer choice in absence of transaction cost). Suppose the price of the new
car is given by P(0) = P and P(a) = P for a ≥ γ? for some γ? ≤ A. With no transaction costs,
the optimal policy a? (a) in the car replacement problem (41)-(43) for a ∈ {1, . . . , γ? − 1, A}
does not depend on a, i.e. a? (a) = a? , and provided that a? ∈ {0, . . . , γ? − 2}, it holds:
i
 ?
u(a? )
µβ h ?
?
?
V (a ) =
−
P(a ) − 1 − α(a ) P(a + 1) − α(a )P ,
1−β 1−β


V (a) = V (a? ) − µ P(a? ) − P(a) .
?

(44)
(45)

In the special case of a? = γ? − 1 an additional
condition
applies: if for V (a? ) = V (γ? − 1)


defined by (44) it holds V (a? ) −V (γ? ) < µ P(γ? − 1) − P , V (γ? − 1) is instead given by:
V (γ? − 1) =

i
u(γ? − 1)
1 − α(γ? − 1)
µα(γ? − 1)β h ?
?
+
β
V
(γ
)
−
P(γ
−
1)
−
P
. (46)
1 − α(γ? − 1)β
1 − α(γ? − 1)β
1 − α(γ? − 1)β
48

Proof. First, note that for a ∈ {1, . . . , γ? − 1} the value of keeping represented by the first component in the outer maximization operator in (41) is in fact included into the inner maximization
in the second component. This does not hold for a ∈ {γ? , . . . , A − 1} because the cars of these
ages are not traded on the market. Yet, the same does hold for A because the option to keep is
simply not available for the cars of maximum age. 
To shorted notation, define EV (d) = 1 − α(d) V (d + 1) + α(d)V (A).
Consider cars of ages a ∈ {1, . . . , γ? − 1, A}. Because the choice set in (41) is finite, there
exist an optimal replacement car a? (a) for every existing car. Suppose that for some a 6= a0 we
have a? (a) 6= a? (a0 ). From the definition of a? (a) applied at point a it follows:
 


 


u a? (a) −µ P(a? (a))−P(a) +βEV a? (a) ≥ u a? (a0 ) −µ P(a? (a0 ))−P(a) +βEV a? (a0 ) .
In the same time from the definition of a? (a0 ) applied at point a0 it follows:
 


 


u a? (a0 ) −µ P(a? (a0 ))−P(a0 ) +βEV a? (a0 ) ≥ u a? (a) −µ P(a? (a))−P(a0 ) +βEV a? (a) .
Because both P(a) and P(a0 ) cancel out in the inequalities above, we have a contradiction.
Thus, a? (a) = a? is independent of a.
Next, consider a ∈ {1, . . . , γ? − 1}, a? ∈ {1, . . . , γ? − 2}. From (41) and (43) we have

V (a? ) = u(a? ) + βEV (a? ) = u(a? ) + β 1 − α(a? ) V (a? + 1) + βα(a? )V (A),


V (a) = u(a? ) − µ P(a? ) − P(a) + βEV (a? )


= V (a? ) − µ P(a? ) − P(a) , ∀a ∈ {1, . . . , γ? − 1, A},


V (a? + 1) = u(a? ) − µ P(a? ) − P(a? + 1) + βEV (a? ),


V (A) = u(a? ) − µ P(a? ) − P + βEV (a? ), and then combining with the first line
 ?
 ?

1  ?
?
?
?
u(a ) − µ P(a ) − 1 − α(a ) P(a + 1) − α(a )P .
EV (a ) =
1−β
Plugging the last line into the first gives (44).
The case of a? = γ? − 1 is special because we have not excluded the possibility for the
choice to keep to be optimal for a? + 1 = γ? , and so the expression for V (a? + 1) above does
not hold. In this case the maximum in (41) is attained
at the first component and thus it holds

V (γ? ) > u(γ? − 1) + βEV (γ? − 1) − µ P(a? ) − P , where EV (a? ) = EV (γ? − 1) is defined in
the last equation above. Formula (46) is then obtain by substituting V (A) and simplifying the
expression for V (a? ):

V (γ? − 1) = u(γ? − 1) + β 1 − α(γ? − 1) V (γ? ) + βα(γ? − 1)V (A).
This completes the proof of Theorem A.T1.
According to equation (44) the value of owning (and perpetual switching back to) the optimal car a? is given by the infinite discounted stream of utilities u(a? ) plus the infinite discounted
stream of monetary costs to replace, which is paid from the next period (thus additional β) and
take into account the possibility of accident. The maximum utility of the owner of an arbitrary
car a given by (45) equals the monetary cost of replacing the existent car with the optimal one,
and following the strategy of perpetual switching back to it.
Even though Theorem A.T1 does not go as far as providing the exact formula for the
optimal replacement policy for the problem (41)-(43) as a function of model fundamentals

49

{u(·), β, α(·), P(·)}, it provides all the necessary components. Plugging (44) and (45) into (43)
to compute choice specific values v(a, d) for d ∈ {0, . . . , γ? − 1} is sufficient to calculate the
optimal replacement choice. The first statement of Theorem A.T1 ensures that doing this calculation once for a = 1 is sufficient. The special case arises when the optimal car is just one
year before the scrap age, and its market price is sufficiently higher than the scrap value P: to
the extent that it becomes optimal to keep it for at least one extra year. This is equivalent to
V (γ? ) given by (41) to attain maximum at the first component of the maximum operator. The
value function V (γ? ) can be found numerically in A − γ? + 1 steps of backward recursion over
car age a, starting from V (A) which is given by (45).19
Note that outside of the special case, Theorem A.T1 is silent about the solution at points
a ∈ {γ? , . . . , A − 1}. However, as it will be clear below, there results are sufficient to analytically
characterize the equilibrium in the economy with homogeneous consumers.

Definition A.D1. A stationary equilibrium is given by the triplet q(·, ζ? ), P(·), ζ? where q ∈
RA and P ∈ RA+1 are vectors, and ζ? ∈ {1, . . . , A − 1} is a constant, which satisfy:
1. The new car price is given by P(0) = P;
2. The scrap value is given by P = P(a) for all a ≥ ζ? ;
3. q(ζ? ) is a stationary holdings distribution which constitutes a fixed point of the linear
operator defined in (A) by the physical transition matrix Q, so it holds q(ζ? ) = q(ζ? )Q;
4. Each consumer follows a replacement policy d ? (a) : {1, . . . , A} → {κ, 0, . . . , A − 1}, such
that for all a it returns an element of the set of maximizers of the Bellman equation (41),
so it holds ∀a ∈ {1, . . . , A} d ? (a) ∈ argmaxd∈{κ,0,...,A−1} v(a, d), where v(a, d) is defined
in (42)-(43);
5. The policy functions d ? (a) satisfies the market clearing condition:
A

∑ q(ζ?, a)1{d ?(a) = a0} = 1 − 1{d ?(a0) = κ}, ∀a0 ∈ {1, . . . , A − 1}.

(47)

a=1

Welfare maximizing car replacement
Before proceeding to the characterization of the equilibrium we have to consider problem (41)
in the absence of used car market. In this specification consumers are not able to trade on the
secondary market, and so in every period they only have to decide whether to keep their old car
of age a or to replace it with a brand new one. Solution to this problem will have a major role
for determining the equilibrium in the homogeneous consumer economy.
As before the price of the new car is P(0) = P, and set the value of a car of age a > 0 to be
P(a) = P. The Bellman equation for a ∈ {0, . . . , A − 1} is given by
n

W (a) = max u(a) + β 1 − α(a) W (a + 1) + βα(a)W (A);
o


u(0) − µ P − P + β 1 − α(0) W (1) + βα(0)W (A) , (48)
where the first component under the maximization operator corresponds to the decision to keep
(d = κ), and the second to replace (d = 0). At the terminal age cars can only be replaced, thus
W (A) = u(0) − µ P − P + βW (1).
19 In fact, all value functions V (a), a ∈ {γ? , . . . , − 1} will be computed by the described procedure which is an application
A
of the state recursion algorithm (Iskhakov, Rust and Schjerning, 2015).

50

In the economy with identical consumers which therefore does not generate any gains from
trade, the value function W (a) captures the maximum attainable welfare of the consumer owning car of age a. Thus, the problem (48) can be interpreted as the problem faced by a social
planner who must choose optimal replacement policy to maximize consumer welfare.
Denote W (0) the value stemming from the endowment
 of a new car in period zero. Evaluating (48) at a = 0 we have W (0) = u(0) + β 1 − α(0) W (1) + βα(0)W (A), corresponding to
the decision to keep. With this, the second component in (48) can be interpreted as the value
of new car net of trade cost, which is independent of a. Then, given our assumption of a nonincreasing utility function, i.e. u(a + 1) ≤ u(a) for a ∈ 0, . . . , A, it is easy to show by backward
induction on car age that W (a) is a non-increasing function of a. This ensures the existence of
car age δ? such that W (δ? − 1) in (48) is equal to the first component, and W (δ? ) to the second
component under maximum. In other words, δ? is the smallest age of a car that is replaced
under the optimal policy, i.e.


δ? = min a ∈ {1, . . . , A} : W (a) = W (0) − µ P − P .
(49)
The socially optimal replacement policy is then given by “keep” when a < δ? and “replace”
when a ≥ δ? . The optimal threshold δ? can be calculated numerically using (49) once the value
function W (a) is computed. Standard dynamic programming technique applies: the Bellman
operator defined by (48) is a contraction mapping, and so W (a) is a unique fixed point of this
operator. As it will be clear in the next section, both object are crucial for market equilibrium.
Characterization of equilibrium in the homogeneous consumer economy
Theorem A.T2
 (Equilibrium in homogeneous consumer economy). The unique stationary
equilibrium q(γ? ), P(a), γ? in the economy with homogeneous consumers whose decision
process is given by (41)-(43), is composed of:
1. Scrappage age γ? equal to the optimal replacement age in problem (48), as defined in
(49), so it holds γ? = δ? ;
2. Non-increasing price function P(a) defined by


P − 1µ W (0) −W (a) , a ∈ {1, . . . , γ? − 1},
(50)
P(a) =
P,
a ∈ {γ? , . . . , A},
where W (a) is the unique fixed point of the Bellman operator (48);
3. Holding distribution q(γ? ) which is unique invariant distribution corresponding to the
transition matrix Q(γ? ), so it holds q(γ? ) = q(γ? )Q(γ? ). Q(γ? ) is given by (A), but with
row i = γ? replaced with vector (1 − α(γ? ), 0, . . . , 0, α(γ? )).
Proof. Let the scrappage age γ? equal to the optimal replacement age δ? defined in (49).
Following the definition of the stationary equilibrium A.D1 (page 50), first observe that
from (50) in follows P(0) = P and, due to (49), P(γ? ) = P. Thus, the first two conditions of
A.D1 are satisfied.
Because the optimal choice a? is independent of existing car age a (by Theorem A.T1), any
stationary age distribution when A > 1, and cars are changing age, requires that consumers are
indifferent between all replacement options. Therefore, next we show that price function P(a)
defined by (50) guarantees this property, which also ensures that conditions 4 and 5 in A.D1
are satisfied.

51

Recall that for a ∈ {1, . . . , γ? − 1} the decision to keep is optimal, thus:

W (a) = u(a) + β 1 − α(a) W (a + 1) + βα(a)W (A).

(51)


Subtracting this equation component-wise from W (0) = (1 − β)W (0) + β 1 − α(a) W (0) +
βα(a)W (0), and combining with the definition of price function (50) we get



 


µ P − P(a) = (1 − β)W (0) − u(a) + β 1 − α(a) µ P − P(a + 1) + βα(a)µ P − P ,

u(a) − (1 − β)W (0)
P(a) =
+ (1 − β)P + β 1 − α(a) P(a + 1) + βα(a)P.
µ
Plugging the last equation into (45) and using (50) again, we have
V (a) =

i
u(a? )
µ h u(a? ) − (1 − β)W (0)
−
+ (1 − β)P + µP(a) =
1−β 1−β
µ
= W (0) − µP + µP(a) = W (a). (52)

From (43) it follows then for a ∈ {1, . . . , γ? − 1} and d ∈ {0, . . . , γ? − 2}:

v(a, d) = u(d) −W (d) +W (a) + β 1 − α(d) W (d + 1) + βα(d)W (A) = W (a),

(53)

where we again use (51) and the definition of price function (50). Equations (52) and (53)
together show that the maximum expected discounted utility V (a) = W (a) of the owner of car
of age a is attained by choosing any d ∈ 0, . . . , γ? − 2. Because in the terms of Theorem A.T1
a? < γ? − 1, the special case does not apply. Therefore equation (53) holds for a = γ? , and
d = γ? − 1 as well. It is also straightforward to verify that V (γ? ) = W (γ? ).
We have thus shown that in the considered equilibrium the consumers who own a car of age
a ∈ {1, . . . , γ? } are indifferent between replacing to any car of age d ∈ {0, . . . , γ? − 1}, and the
maximum attainable utility is given by V (a) = W (a).
The non-increasing property of the price function (50) follows directly from the non-increasing
property of W (a). Given our assumption of a non-increasing utility function, u(a + 1) ≤ u(a)
for a ∈ 0, . . . , A, this can in
 turn be established by mathematical induction starting from W (A) =
?
· · · = W (γ ) = W (0) − µ p − P and going backwards in a.
The stationary holdings distribution follows from direct application of the condition 3 in
A.D1. The definition of equilibrium physical transition matrix Q(γ? ) reflects the fact that no
cars are kept past scrappage age γ? under the optimal replacement strategy described above.
When α(a) = 0 for all ages, the unique invariant distribution q(γ? ) is uniform with the unit
mass distributed equally between points a ∈ {1, . . . , γ? }. With positive probability of accidents,
invariant distribution is unique under assumption of irreducibility of the Markov chain implied
by the physical transition matrix Q, which is satisfied when 0 ≤ α(a) < 1 for every a.
The uniqueness of the stationary equilibrium in the homogeneous consumer economy of
automobiles follows from the uniqueness of the invariant fleet age distribution.
Corollary A.C1. In the equilibrium in the homogeneous consumer economy with no transaction costs defined in Theorem A.T2, consumers are indifferent between replacing their existing
car with the car of any age available in the economy. This holds for owners of all ages of cars
with positive shares in the stationary fleet age distribution.
Corollary A.C2. The equilibrium in the homogeneous consumer economy with no transaction
costs defined in Theorem A.T2 is welfare maximizing, in particular the discounted expected
52

utility of all consumers is equal to maximum attainable welfare, V (a) = W (a), for all cars with
positive shares in the stationary fleet age distribution.
Proof. The statements of both corollaries are proven as part of the proof of Theorem A.T2.
Theorem A.T2 shows how closely the optimal car replacement problem (48) is connected
to the optimal holding/trading problem (41). The optimal replacement problem provides both
the equilibrium scrappage threshold γ? and the price function P(a) defined as shadow prices of
what happens to be equivalent to the welfare maximizing social planner’s problem.
With the adjustment of the physical transition matrix Q introduced in Theorem A.T2, the
stationary holdings distribution q(γ? ) takes the form

q(γ? ) = q(1), . . . , q(γ? ), 0, . . . , 0, q(A) ,
(54)
where no cars of age a ∈ {γ? + 1, . . . , A − 1} exist the economy. The stationary age distribution
q(γ? ) can be computed by successive approximations by taking transition matrix Q(γ? ) to a
large power, or by solving linear system as explained in Appendix C. When the model does
not allow for accidents, α(a) = 0, ∀a, Q(γ? ) is periodic, leading to the failure of successive
approximations method in this case.
Theorem A.T2 provides a way to compute the equilibrium of the homogeneous consumer
economy numerically. The straightforward approach amounts to first solving the optimal replacement problem (48) using successive approximations or policy (Newton-Kantorovich) iterations (Rust, 1987). The dimension (number of points in the state space) of this problem
is A. Afterwards, all necessary components of the equilibrium can be computed from W (a)
following Theorem A.T2. There is, however, a much more efficient numerical algorithm for
finding the equilibrium of the homogeneous consumer economy which does not require fixed
point solution, and instead amounts to solving a series of linear equation systems of a lower
than A dimension.
We conclude the section with the presentation of the fast algorithm for finding stationary
equilibrium in the homogeneous consumer economy defined in Theorem A.T2. The main idea
of the algorithm is to express the indifference condition from Corollary A.C1 as the system of
γ? − 1 linear equations to determine the unrestricted prices P(a), a ∈ {1, . . . , γ? − 1}.
Because by Corollary A.C1 consumers are effectively indifferent between any dynamic
trading strategies, the strategy of perpetual replacing an existing car of age a results in the
maximum attainable expected discounted utility V (a). We have for a ∈ {1, . . . , γ? − 1}




1
V (a) = 1−β
u(a) − βµ P(a) − 1 − α(a) P(a + 1) − α(a)P .
(55)
Let V (0) denote the value of having a new car which is measured right after trading instead of
the beginning of the period. Then (55) also holds for a = 0, and V (0) = W (0). Thus, using
V (a) −V (a + 1) = W (a) −W (a + 1) and the definition of the price function (50), we have for
a ∈ {0, . . . , γ? − 2}
V (a) − µP(a) = V (a + 1) − µP(a + 1),
(56)
which leads to the following linear equation in prices (P(a), P(a + 1), P(a + 2)):


µP(a) + µ α(a)β − β − 1 P(a + 1) + µβ 1 − α(a + 1) P(a + 2) =


= u(a) − u(a + 1) + βµP α(a) − α(a + 1) . (57)

53

The collection of equations (57) for a ∈ {0, . . . , γ? −2} forms the system of γ? −1 equations with
γ? − 1 unknowns, and can be easily solved numerically under our assumption that u(a + 1) ≤
u(a) for a ∈ 0, . . . , A. The system be written in matrix form as
X · P = Y,

(58)

where P is the column vector of prices {P(a)}a∈{1,...,γ? −1} ,




X =



α(0)β − β − 1
1
0
0
0
..
.
0
0

β − α(1)β
α(1)β − β − 1
1
0
0
..
.
0
0




Y =


0
β − α(2)β
α(2)β − β − 1
1
0
..
.
0
0

0
0
β − α(3)β
α(3)β − β − 1
1
..
.
0
0

···
···
···
···
···
..
.
···
···

0
0
0
0
0
..
.
?
α(γ − 3)β − β − 1
1



u(0) − u(1) /µ
 + βP α(0) − α(1) −
P
u(1) − u(2)/µ + βP α(1) − α(2)
u(2) − u(3) /µ + βP α(2) − α(3)
..
.


u(γ? − 3) − u(γ? − 2) /µ +
βP α(γ? − 3) − α(γ? −
 2)

?
?
?
u(γ − 2) − u(γ − 1) /µ + βP α(γ − 2) − 1

0
0
0
0
0
..
.
β − α(γ? − 2)β
α(γ? − 2)β − β − 1





,






.


Note that the dimension of the system (58) is dependent on the equilibrium scrappage age
γ? . Consequently, it has to be known beforehand to solve for the equilibrium prices. Yet, by
Theorem A.T2 it is only determined as part of the solution of the replacement problem (48),
which the fast algorithm is aiming to avoid. The alternative approach requires an iterative calculation, where the system is solved for various values of γ? until the equilibrium is found.
Because solving a system of linear equations implies much lower computational cost than finding a fixed point of Bellman operator (41), and in particular because the dimensionality of the
latter problem (A) is larger than that of the linear system, the proposed algorithm is more computationally efficient. In the next Section, as it will be clear, there is no corresponding optimal
replacement problem, and our computational approach relies on the same algorithm.
Note that system (58) is well defined for any γ? ∈ {2, . . . , A}, and consequently an equilibrium price vector P(a, γ? ) can be computed for any value of the optimal scrappage age.
Therefore it is necessary to establish the formal condition for the iterative algorithm to identify
the equilibrium solution.
Lemma A.L1 (Conditions for equilibrium computation). Let P(a, ζ) be the solution to the
system of linear equations (57) for a ∈ {0, . . . , ζ − 2}, for some ζ ∈ {2, . . . , A}. The necessary
and sufficient condition for P(a) and ζ to constitute equilibrium price function and scrappage
age defined in Theorem A.T2, is that the following two statements hold simultaneously:
∀a ∈ {1, . . . , ζ − 1} : P ≤ P(a, ζ) ≤ P,
∃ a ∈ {1, . . . , ζ} : P(a, ζ + 1) < P.

(59)
(60)

Proof. Consider the policy-specific value function w(a, ζ) of the optimal replacement problem
(48). It can be derived by induction starting from the case a = ζ where w(ζ, ζ) = W (0) − µ[P −
P] = W (γ? ). Here γ? = δ? defined in (49) is the optimal replacement age that coincides with
equilibrium scrappage age by Theorem A.T2. By definition of δ? it also holds that W (γ? ) =
W (a) for a ∈ {γ? , . . . , A} where replacement choice is optimal. For a ∈ {0, . . . , ζ − 1} function
54

w(a, ζ) is given by:
ζ−a−1

w(a, ζ) =

∑
k=0

i
k h
βk 1 − α(a + k − 1) u(a + k) + α(a + k)βW (A) +
ζ−a
+ βζ−a 1 − α(a − 1)
W (γ? ). (61)

The way that the system (58) is constructed establishes a one-to-one correspondence between its solution P(a, ζ) for given ζ and the policy-specific value functions w(a, ζ) given by:


(62)
P(a, ζ) = P − 1µ W (0) − w(a, ζ) ,
where we excluded the case of immediate replacing of a new car, so ζ > 0 and w(0, ζ) =
W (0). It is easy to verify that prices given by (62) for a fixed ζ constitute a solution to the
corresponding system of equations, and conversely the solution of the system gives rise to
w(a, ζ) that is consistent with the solution of the optimal replacement model (48), such that
(61) is satisfied.
We are now in position to prove the statement of the lemma. Necessity follows from, first,
observing that when ζ = γ? , w(a, ζ) = W (a) and condition (59) is satisfied due to monotonicity
of W (a). Next, computing (61) at the point a = γ? , ζ = γ? + 1 we obtain:

w(γ? , γ? + 1) = u(γ? ) + β 1 − α(γ? ) W (γ? + 1) + α(γ? )βW (A) < W (0) − µ[P − P],
where the last inequality follows directly from the definition of γ? as the optimal replacement
threshold. Combing this inequality with (62) leads to (60) which is satisfied for a = γ? .
To prove sufficiency first note that conditions (59) and (60) can be reformulated in terms of
policy-specific values computed by inverse of (62) from the solution of the linear system, as:
∀a ∈ {1, . . . , ζ − 1} : W (γ? ) ≤ w(a, ζ) ≤ W (0),
∃ a ∈ {1, . . . , ζ} :
w(a, ζ + 1) < W (γ? ).

(63)
(64)

We need to prove that if (63) and (64) hold, ζ constitutes the optimal replacement age. In this
case then w(a, ζ) = W (a) for all a and the computed prices indeed coincide with equilibrium
prices due to the similarity between (62) and (50). Again, evaluating w(ζ, ζ + 1) we establish
from (64) that replacement rather than keeping is the optimal choice in the problem (48) at age
ζ. From the first inequality in (63) if follows that the opposite is true for ζ − 1. Thus, ζ satisfies
definition of the optimal replacement age (49).
Lemma A.L1 states that the market equilibrium is determined by the solution P(a, γ? ) with
maximum scrappage age γ? such that all prices are located between the scrap value and the
price of the new car. An increase of the scrappage age by one year to γ? + 1 would result in at
least one price dipping below the scrap value. The intuition for this results is straightforward: if
the cars are forced to stay in the economy longer than their optimal renewal age, an additional
monetary compensation (“negative” price below scrap value) must be provided for the owners
of those cars that are excessively old.
Lemma A.L1 provides a clear stopping rule for the iterative equilibrium computation algorithm: different values of γ? should be tried until the pair (γ? , γ? + 1) that satisfies conditions
(59) and (60) is found. An efficient binary search algorithm would require the number of iterations on the order of log2 A to find the equilibrium. Therefore, it is beneficial to adjust A
55

according to the model parameters. For example, solving the static equivalent of the optimal
replacement problem (with β = 0) necessarily results in higher optimal replacement threshold
than the dynamic version, and thus provides a reasonable upper bound.

B
B.1

Proofs
Proof of Theorem 1 (page 14)

Proof. We start by constructing the ownership distribution p(P, ā) such that (15) is equivalent
to the conditions (b)-(d) in equilibrium definition D1 for any {ā, P(a)}.
Let q(ā, P) be invariant distribution of Q given by (12), such that condition (b) in D1 is
satisfied. Then the corresponding p(ā, P) given by (6) is an invariant distribution of Ω defined
in (14) for any {ā, P(a)} which follows from its non-irreducibility. Therefore, it holds that
p = pΩ and the second equality in (15) is satisfied. Further, it follows from (10) that conditions
(c) and (d) in D1 can be expressed as a fixed point of matrix ∆(P), corresponding to the first
equality in (15). The final equality in (15) is simple substitution of the first one into the second.
It is now left to show the existence of scrappage age ā and a price vector P(a), a ∈
{1, . . . , ā − 1} such that both (a) in D1 and market clearing conditions are satisfied given the
above p(ā, P). Then all equalities in (15) hold, and due to equivalence shown above, D1 is
completely fulfilled.
For a fixed ā, define a mapping Λ(P) : Rā−1 → Rā−1 by Λ(P) = P + ED(P), where Rn+
denotes the positive orthant of Rn and ED(P) is defined in (10). From Lemma L1 it follows
that ED and thus Λ is a continuous mapping from Rā−1 → Rā−1 . Note also that for any P
the components of ED(P) lie in the interval [−1, 1]. Thus, when prices are sufficiently high,
a vanishing number of consumers will wish to buy any new car but nearly all consumers will
want to sell their cars, so ED(P) will be close to a vector with all its components equal to −1.
Similarly, for a sufficiently low set of prices (possibly negative), nearly all consumers will wish
to buy used cars and very few will want to sell their vehicles at such low prices. So for such
prices ED(P) will be close to a vector with all of its components equal to +1. It follows that
we can define a compact box B in Rā−1 where Λ satisfies an “inward pointing” property on the
boundaries of this box, so it follows that Λ : B → B. Since Λ is a continuous mapping and B is a
compact, convex set, the Brouwer fixed point theorem implies that a fixed point of Λ exists, and
it is clear that any such fixed point satisfies ED(P) = 0. Using this set of prices, the fraction of
consumers without cars is given by (11), and the condition D(0, P) = S(ā, P) in D1 is satisfied
due to the normalization of the choice probabilities in supply of scrap cars and demand of new
cars. Finally, it is possible to show that for small enough ā conditions (a) of D1 are always
satisfied, whereas when ā is too big, the corresponding price function may violate them.
B.2

Proof of Lemma L1 (page 16)

Proof. This follows from the implicit function theorem provided we can show that 1) Γ is a
continuously differentiable function of P, and 2) the (ā + 1) × (ā + 1) matrix I − ∇EV Γ(EV, P)
is nonsingular for any P where EV = Γ(EV, P), where ∇EV denotes the gradient operator with
respect to EV . However by Lemma L2 we have ∇EV Γ(EV, P) = β∆(P)Ω. This implies that
I − ∇EV Γ(EV, P) is nonsingular with inverse equal to
−1

[I − β∆(P)Ω]

∞

=

∑ βt [∆(P)Ω]t

t=0

56

(65)

where the latter series is convergent due to the assumption that β ∈ (0, 1) and k∆(P)Ωk = 1. It
is easy to show that ∇P Γ(EV, P) exists and is continuous in EV and P using the formulas for Γ
in equation (3). Thus, by the implicit function theorem EV (P) is a continuously differentiable
function of P with gradient given by ∇P EV (P) = [I − β∆(P)Ω]−1 ∇P Γ(EV, P).
B.3

Proof of Lemma L2 (page 17)

Proof. This can be shown via algebra after differentiating the Γ operator with respect to EV in
equations (1)-(3) and expressing the result as a matrix product.
B.4

Proof of Theorem 2 (page 21)

Proof. The proof is analogous to B.1. We show that the conditions (22) and (23) are equivalent
to the the conditions (b)-(d) in equilibrium definition D1 for any {ā, P(a)}, and then apply
the Brouwer fixed point theorem in the same way (the latter step is skipped here for space
considerations).
First, allow qτ (ø) be chosen such that it holds D(ø, P) − S(ø, P). This can be achieved by
applying formula (11) for each particular consumer type τ. Then (23) has exactly one invariant
distribution, which structure is given by (18) and which therefore defines qτ .
Next, to show that the collection of qτ form the overall holdings distribution that satisfy
(22), note that with the structure of ownership distribution p given in (18)-(25) equation (21)
can be written as:
Nτ

∑
τ=1


 
f (τ)pτ (P, ā) ∆τ (P) − I = ED(P), D(0, P) − S(ā, P), D(ø, P) − S(ø, P) .

(66)

In equilibrium ED(P) = (0, . . . , 0), D(ø, P) = S(ø, P) due to how qτ (ø) was chosen above, and
the last component of the righ hand side of (66) is zero because the choice probabilities add up
to one. It follows:
Nτ

∑

Nτ

f (τ)pτ (P, ā)∆τ (P) =

τ=1

∑ f (τ)pτ(P, ā).

(67)

τ=1

Multiplying both side of (67) with matrix Ω on the right, and using the fact that pτ (P, ā) is a
fixed point of ∆τ (P)Ω in the left hand side, gives:
Nτ

∑

Nτ

f (τ)pτ (P, ā) =

τ=1





∑ f (τ)pτ(P, ā) Ω.
τ=1

τ
Thus, ∑N
τ=1 f (τ)pτ (P, ā) is an invariant distribution of Ω, which implies that q(P, ā) in (22) is
an invariant distribution of Q due to (14).

B.5

Proof of Lemma L3 (page 22)

Proof. The uniqueness of the invariant distribution qτ (P) = qτ (P)∆τ (P)Ω established in Section B.4 enables us to write qτ (P) as the solution to a system of linear equations that is related
to, but distinct from the linear system (24) with the key difference being that the matrix in this
related system of linear equations is invertible for each P. This means that we can write qτ (P)
explicitly in terms of the inverse of this matrix, which can be shown by inspection to be a function of P since it depends on P only via the matrix ∆τ (P) which is continuously differentiable
57

in P by Lemma L1. Hence, using matrix calculus we can write an explicit formula for the gradient ∇P qτ (P) which we use to implement Newton’s method to solve the system of equations
ED(P) = 0. The details of this are contained in Appendix C.
B.6

Proof of Theorem 3 (page 23)

Proof. The proof is analogous to B.1 and B.4. We show that the conditions (26) and (27) are
equivalent to the the conditions (b)-(d) in equilibrium definition D1 for any {ā, P(a)}, and then
apply the Brouwer fixed point theorem in the same way (again, the latter step is skipped here
for space considerations).
Similar to B.4, first allow qy (ø) be chosen such that it holds D(ø, P) − S(ø, P). This can be
achieved by applying formula (11) for each income level y. Then, together with holdings distribution q(ā, P) which we take to be invariant distribution of Q given by (12), the equilibrium
ownership distribution is completely characterized by (25). With this ownership distribution
condition (b) in D1 is satisfied.
Next, repeating the argument from B.4, we can characterize the market clearing conditions
using the equation:

 
∑ π(y)py(P, ā) ∆y(P) − I = ED(P), D(0, P) − S(ā, P), D(ø, P) − S(ø, P) . (68)
y

In order to show that the right hand side only contains zeros with the chosen ownership distribution, multiply the left hand side by ΩΩ−1 to get the expression:
h

i
∑ π(y)py(P, ā)∆y(P)Ω − ∑ π(y)py(P, ā)Ω Ω−1 =
y

y

h


 i
q(P, ā)[1 − q(ø)], q(ø) ∑ π(y) − q(P, ā)[1 − q(ø)], q(ø) Ω Ω−1 =
y





−1
0, . . . , 0 Ω = 0, . . . , 0 . (69)
The expression is simplified using (26) and (27) and the fact that the (income specific) chosen
ownership probabilities constitute the fixed points of the physical transition matrix Ω.
B.7

Proof of Theorem 4 (page 32)

Proof. The holdings and ownership distributions given by (31) and (32), physical transition
matrix is given by (33), and the trade transition matrix by (34) are appropriate generalizations of
the same objects in the three cases the theorem is addressing. It is straightforward to check that
the proofs of all three theorems follow through with these redefined distributions and transition
matrices, taking into account the argument about the only significant change having to do with
additional J − 1 unknowns (market shares) determined in J − 1 additional equations given in
(36).

C

Gradient Of Invariant Distribution

In this appendix we consider the general problem of calculating the derivative of an invariant
distribution with respect to parameters affecting a Markov transition matrix. Let the parameters
58

be θ (in our application θ is a vector of prices of cars in a secondary market equilibrium) and
consider a Markov transition probability matrix P(θ) that depends on these parameters in a
continuously differentiable fashion. Thus, we assume that the mapping ∇θ P(θ) from Rk to
Rk∗n∗n (where the latter can be interpreted as the space of k-tuples of n × n matrices) exists
and is a continuous function of θ. To make things easier to understand, assume initially that
k = 1 so we are considering P(θ) and q(θ) as functions of a single parameter θ. If θ has k
components (i.e. θ ∈ Rk ) we simply “stack” the formulas we provide below in the univariate
case into a k-tuple.
We are interested in determining the conditions under which q(θ), the unique invariant distribution of P(θ), is a continuously differentiable function of θ and, if so, to find an expression
for ∇θ q(θ). The invariant distribution q(θ) satisfies the equation
q(θ) = q(θ)P(θ),

(70)

which can be recast as q(θ) being a left zero of the matrix I − P(θ), q(θ)[I − P(θ)] = 0. The
usual application of the Implicit Function Theorem applies when q(θ) can be written as a zero
of some continuously differentiable nonlinear mapping F(q, θ) = 0 with the added condition
that ∇q F(q, θ) is nonsingular at a zero of F. Then the Implicit Function Theorem guarantees
that there is a continuously differentiable function q(θ) in a neighborhod of this zero, and we
have
∇θ q(θ) = −[∇q F(q(θ), θ)]−1 ∇θ F(q(θ), θ).
(71)
However this usual application of the Implicit Function Theorem is inapplicable because in this
case ∇q F(q, θ) = I − P(θ) and this matrix is singular (note that if e is a vector of ones, then
[I − P(θ)]e = 0 where 0 is a vector of zeros). Thus, we have to approach this problem from a
different angle.
When the invariant distribution is unique, it can be shown that q(θ)0 , the n × 1 transpose of
q(θ), is the unique solution to the expanded (n + 1) × (n + 1) linear system given by


  
I − P(θ)0 e
q(θ)0
e
=
(72)
0
e
1
1
2
where e is an n × 1 vector all of whose elements equal 1. Thus, the matrix on the right hand
side of equation (72) is invertible and we can write

 
−1  
q(θ)0
I − P(θ)0 e
e
=
.
(73)
0
1
e
1
2
Let A(θ) be the (n + 1) × (n + 1) matrix on the right hand side of equation (72). Then we
have that ∇θ q(θ)0 is the upper left n × n submatrix of the product of ∇θ A−1 (θ) times the vector
(e0 2)0 . Further, we use the following formula for the gradient of A−1 (θ) with respect to θ
∇θ A−1 (θ) = −A−1 (θ) [∇θ A(θ)] A−1 (θ).

59

(74)

D

NMNL Choice Probabilities And Expected Value Functions

We assume that the multivariate distrubtion of ε is generalized extreme value family and thus
has joint CDF of the form
F(ε1 , . . . , εn ) = exp{−G(e−ε1 , . . . , e−εn )}

(75)

where the function G maps the positive orthant of Rn into the positive real line, and satisfies
several properties, including homogeneity of degree µ for some µ > 0. Note that the CDF of
a collection of IID Type 1 extreme value random variables is a special case of equation (75)
when G(y1 , . . . , yn ) = ∑ni=1 yi .
In the auto problem, we index the arguments of the joint CDF as (εκ , ε0 , {εd, j }). Thus,
F(ε0/ , ε0 , {εd, j }) is the CDF of these preference shocks and we assume it has the representation
F(εø , εκ , {εd, j }) = exp{−G(e−εø , e−εκ , {e−εd, j })}

(76)

where the function G(yø , y0 , {yd, j }) is given by

1
σ

J

1
σ


G(yø , y0 , {yd, j }) = yø + y0 +  ∑

j=1

ā j −1

∑ yd, j

d=0

1
σj

! σσ j

 σ j>0
σ

j>0




.

(77)

where σ, σ j>0 and {σ j }, j = 1, . . . , J are J + 2 “scale/similarity parameters” of the GEV distribution that implies the nesting structure outlined i Figure 4.
Note that the parameter σ controls the level of variability of the preference shocks in the top
level of the choice tree. As σ → 0 the overall scale of the preference shocks tend to zero due to
the inequalities
σ ≥ σ j>0 ≥ σ j ≥ 0 j = 1, . . . , J
(78)
that must be satisfied for F to be a valid CDF. Hence, the similarity parameter σ j>0 scaling the
shocks at the upper level of this subtree, as well as the car type specific similarity parameters
σ j discussed above. If we impose the restriction that σ = σ j>0 , then the three level NMNL
choice tree collapses to the two level choice tree structure similar to Figure 4 where the scale
parameters preference shocks for the top level choices are the same, and we only allow different
scale parameters σ j to reflect correlation/similarity in different ages of the them type j of car. If
we further restrict that σ = σ j>0 = σ j for j = 1, . . . , J, then the NMNL collapses to a standard
MNL model, where there is a common scale parameter σ for all preference shocks, but these
shocks are IID.
When ε is a vector of IID GEV preference shocks, taking the expectation of both sides of
(28), and using max-stability property of the generalized extreme value distribution
(McFadden,
R
1981), leads to the well known nested ”log-sum” expression for EV (a) ≡ V (a, ε)dF(ε), a ∈
{1, . . . , ā − 1}:

EVτ (ø) = σ log exp{vτ (ø, ø)/σ} + exp{I j>0 (ø)/σ}

(79)

where I j>0 (ø) is the inclusive value or ex ante expected maximized utility corresponding to
the choice of moving out of the no car state and buying some car (d, j) that provides the
consumer the ex post highest discounted utility after observing the preference shocks for each

60

(d, j) alternative, and is given by
J

!

∑ exp{I j (ø)/σJ>0}

I j>0 (ø) = σ j>0 log

.

(80)

j=1

where I j (ø) is the inclusive value or expected maximal discounted utility associated with the
choice of a particular car type j by an individual who does not own a car, and is given by
!
ā −1
j

I j (ø) = σ j log

∑ exp{vτ(d, j, ø)/σ j }

.

(81)

d=0

The expected value of state (a, j) is EVτ (a, j) given by


σ log exp{vτ (ø, a, j)/σ} + exp{I j>0 (a, j)/σ}
 if a = ā j
EVτ (a, j) =
σ log exp{vτ (ø, a, j)/σ} + exp{vτ (κ, a, j)/σ} + exp{I j>0 (a, j)/σ} otherwise
(82)
where the first equation for EVτ (a, j) in (82) is for the case where the current car is at the
scrappage age threshold, a = ā j , so keeping this car is no longer an option, and the second
formula is for the case where a < ā j so the consumer has the additional option to choose to
keep the current car (a, j) rather than trade it, which has the value vτ (κ, a, j). The inclusive
value for the decision to trade for another car is I j>0 (a, j) given by
!
J

exp{I j0 (a, j)/σ j>0 }
∑
0

I j>0 (a, j) = σ j>0 log

(83)

j =1

where I j0 (a, j) is the inclusive value associated with the decision to trade the current car (a, j)
for some car (d 0 , j0 ) of car type j0 given by


I j0 (a, j) = σ j0 log 

ā j0 −1

exp{vτ (d 0 , j0 , a, j)/σ j0 } .

∑
0

d =0

(84)

For notational simplicity, we suppressed the dependence of the value functions on the set
of car prices. However, to describe equilibrium it is now necessary to make the dependence on
prices P explicit when deriving the nested logit choice probabilities below. First consider the
probability that the person chooses to remain in the no car state
Πτ (ø|ø, P) =

exp{vτ (ø, ø)/σ}
exp{vτ (ø, ø)/σ} + exp{I j>0 (ø)/σ}

(85)

Let Πτ (d, j|ø, P) be the probability that the consumer chooses to buy a car (d, j). This is given
by the product of “transition probabilities” reflecting the three level choice tree
Πτ (d, j|ø, P) = Πτ (d| j, ø, P)Πτ ( j| j > 0, ø, P)Πτ ( j > 0|ø, P)

(86)

where Πτ ( j > 0|ø, P) denotes the probability that the consumer chooses some type of car,
Πτ ( j > 0|ø, P) = 1 − Πτ (ø|ø, P) =

exp{I j>0 (ø)/σ}
,
exp{vτ (ø, ø)/σ} + exp{I j>0 (ø)/σ}

61

(87)

and Πτ ( j| j > 0, ø, P) is the probability the consumer chooses car type j given the decision to
choose some type of car,
Πτ ( j| j > 0, ø, P) =

exp{I j (ø)/σ j>0 }
J
∑ j0 =1 exp{I j0 (ø)/σ j>0 }

(88)

and Πτ (d| j, ø, P) is the probability the consumer chooses a car of age d given that they chose a
car of type j
exp{vτ (d, j, ø, P)/σ j }
Πτ (d| j, ø, P) = ā −1
.
(89)
j
∑d 0 =0 exp{vτ (d 0 , j, ø, P)/σ j }
Now consider a consumer who has a car (a, j) of age a and type j. The probability of the choice
d = ø (i.e. to sell their current car and not replace it with another one) is given by

exp{vτ (ø,a, j,P)/σ}

exp{vτ (ø,a, j,P)/σ}+exp{vτ (κ,a, j,P)/σ}+exp{I j>0 (a, j)/σ} if a < ā j
Πτ (ø|a, j, P) =
(90)
exp{vτ (ø,a, j,P)/σ}

if a = ā j
exp{vτ (ø,a, j,P)/σ}+exp{I j>0 (a, j)/σ}
which reflects the constraint that for any car type j a consumer who holds the oldest possible
age a = ā j is forced to scrap it, so we have
(
exp{vτ (κ,a, j,P)/σ}
exp{vτ (ø,a, j,P)/σ}+exp{vτ (κ,a, j,P)/σ}+exp{I j>0 (a, j)/σ} if a < ā j
(91)
Πτ (0|a, j, P) =
0
if a = ā j
Since there are only three possible choices at the top level of the choice tree in Figure 4, it
follows that the probability of choosing to trade the current car (a, j) for some other car (d, j0 )
is given by
Πτ ( j > 0|a, j, P) = 1 − Πτ (ø|a, j, P) − Πτ (0|a, j, P)
(92)

which is valid for any value of a ∈ {1, . . . , ā j }. Let Πτ (d, j0 |a, j, P) be the probability the
consumer trades their current car (a, j) for some other car (d, j0 ). Similar to the probability
Πτ (d, j0 |ø, P) given in equation (86) above, this probability can be written as a product of three
“transition probabilities”
Πτ (d, j0 |a, j, P) = Πτ (d| j0 , a, j, P)Πτ ( j0 | j > 0, a, j, P)Πτ ( j > 0|a, j, P)

(93)

where the probability of choosing to trade the current car (a, j) for some other age and type
of car is Πτ ( j > 0|a, j, P) given in equation (92), and Πτ ( j0 | j > 0, a, j, P) is the probability the
consumer chooses car type j0 given the decision to trade,
Πτ ( j0 | j > 0, a, j, P) =

exp{I j0 (a, j, P)/σ j>0 }
,
J
∑ j0 =1 exp{I j0 (a, j, P)/σ j>0 }

(94)

and Πτ (d| j0 , a, j, P) is the probability that the consumer chooses a car of age d given the choice
of type of car j0
exp{vτ (d, j0 , a, j, P)/σ j0 }
Πτ (d| j0 , a, j, P) = ā 0 −1
.
(95)
j
0
0
0
exp{v
(d
,
j
,
a,
j,
P)/σ
}
∑d 0 =0
τ
j

62

