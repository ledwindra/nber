NBER WORKING PAPER SERIES

SOLVING MODELS WITH EXTERNAL HABIT
Jessica A. Wachter
Working Paper 11559
http://www.nber.org/papers/w11559
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2005

I am grateful to John Campbell, Thomas Cosimano, Motohiro Yogo, and Harold Zhang for helpful
comments. The views expressed herein are those of the author(s) and do not necessarily reflect the views
of the National Bureau of Economic Research.
©2005 by Jessica A. Wachter. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to the
source.

Solving Models with External Habit
Jessica A. Wachter
NBER Working Paper No. 11559
August 2005
JEL No. G1
ABSTRACT

Habit utility has been the focus of a large and growing body of literature in financial economics.
This study investigates ways of accurately and efficiently solving the Campbell and Cochrane (1999)
external habit model. Solutions for this model based on a grid of values for the state variable are
shown to converge as the grid becomes increasingly fine. Convergence is substantially faster if the
price-dividend ratio is computed as a series of ``zero-coupon equity'' claims rather than as the fixedpoint of the Euler equation. Fitting the model to the term structure as well as to equity moments (as
in Wachter (2005)) also results in faster convergence.

Jessica A. Wachter
The Wharton School
University of Pennsylvania
3620 Locust Walk
Philadelphia, PA 19104
and NBER
jwachter@wharton.upenn.edu

Introduction
Habit utility has been the focus of a large and growing body of literature in financial economics.
Constantinides (1990) and Sundaresan (1989) show that habit preferences, which assume an agent’s
previous consumption affects his utility from current consumption, can help explain the high equity
premium documented by Mehra and Prescott (1985). Abel (1990) shows that preferences where
the agent evaluates consumption relative to past aggregate consumption (“catching up with the
Joneses”) can also help resolve the equity premium puzzle. In both types of models, consumption is
evaluated relative to a time-varying reference point, however, in the Abel model this reference point
is external in that the agent’s current consumption choice does not affect future utility. For this
reason, “catching up with the Joneses” preferences are sometimes referred to as external habit formation. Building on these contributions, Campbell and Cochrane (1999) show that a model where
utility is a function of consumption minus external habit is capable of reconciling the low standard
deviation of consumption growth with a high equity premium, high volatility of returns, and a low
and smooth riskfree rate. Recently, external habit models have been extended to address a broad
range of phenomena (see, e.g., Abel (1999), Brandt and Wang (2003), Buraschi and Jiltsov (2003),
Campbell and Cochrane (2000), Chan and Kogan (2002), Dai (2000), Lettau and Uhlig (2000),
Menzly, Santos, and Veronesi (2004), Pastor and Veronesi (2004), Wachter (2005)), and tested in
a variety of ways (see, e.g., Chen and Ludvigson (2003), Duffee (2004), Gomes and Michaelides
(2003), Korniotis (2005), Li (2001), Tallarini and Zhang (2004)). Given the enduring interest in
external habit models, it is important to investigate ways of solving such models accurately and
efficiently.
This study focuses on the external habit model of Campbell and Cochrane (1999) and its
extension in Wachter (2005). Both papers solve for the price-dividend ratio by iterating on a grid
of values for the state variable. While choosing a grid that is too coarse can lead to inaccuracies, this
study shows that for both calibrations of the model (Campbell and Cochrane; Wachter), the solution
for the price-dividend ratio converges as the grid becomes finer. Convergence is substantially faster
if the price-dividend ratio is computed as a series of “zero-coupon equity” claims, rather than as
the fixed-point of the Euler equation. Fitting the model to the term structure as well as to equity
moments (as in Wachter (2005)) also results in faster convergence.
The remainder of this paper is organized as follows. Section 1 briefly describes the model for
the representative agent and the aggregate endowment. Section 2 describes the solution techniques
explored in this paper, Section 3 the calibration, and Section 4 the results. Extensions to the basic
2

model are considered in the Appendix.

1

Model

This section briefly describes the external habit model of Campbell and Cochrane (1999) and its
extension in Wachter (2005). Identical investors are assumed to have utility over consumption
relative to a reference point Xt :
E

∞
X
t=0

δt

(Ct − Xt )1−γ − 1
,
1−γ

(1)

where δ > 0 is the time preference parameter and γ > 0 is a curvature parameter. Habit, Xt , is
defined through surplus consumption St , where
St ≡

Ct − Xt
.
Ct

It is assumed that st = ln St follows the process
st+1 = (1 − φ)s̄ + φst + λ(st )(∆ct+1 − E(∆ct+1 )),

(2)

where s̄ is the unconditional mean of st , φ is the persistence, and λ(st ) is the sensitivity to changes
in consumption. In what follows, s̄ and λ(st ) will be specified in terms of the primitive parameters.
Aggregate consumption Ct follows a random walk:
∆ct+1 = g + vt+1 ,

(3)

where ct = ln Ct and vt+1 is a N (0, σv2 ) shock that is independent across time.
The process for st is heteroscedastic and perfectly conditionally correlated with innovations in
f
consumption growth. The sensitivity function λ(st ) is specified so that rt+1
is linear and that for

st ≈ s̄, xt is a deterministic function of past consumption. These considerations imply that
p
λ(st ) = (1/S̄) 1 − 2(st − s̄) − 1
r
γ
,
S̄ = σv
1 − φ − b/γ

(4)
(5)

where b is a preference parameter that determines the behavior of the riskfree rate. In order that
the quantity within the square root remain positive, λ(st ) is set to be 0 when st > smax , for
smax = s̄ +

¢
1¡
1 − S̄ 2 .
2
3

(6)

In Campbell and Cochrane (1999), b is chosen to be zero to produce a constant real riskfree rate.
Wachter (2005) shows that values of b > 0 allow the model to capture aspects of the term structure
of interest rates.
Because habit is external, the investor’s intertemporal marginal rate of substitution is given by
µ
¶
St+1 Ct+1 −γ
Mt+1 ≡ δ
.
(7)
St Ct
Any asset return Rt+1 must satisfy
Et [Mt+1 Rt+1 ] = 1.

(8)

f
f
f
Let Rt+1
denote the one-period real riskfree rate between t and t + 1, and rt+1
= ln Rt+1
. Because
f
is known at t, applying (8) implies
Rt+1
f
rt+1
= ln (1/Et [Mt+1 ])

(9)

= − ln δ + γg + γ(1 − φ)(s̄ − st ) −

γ 2 σv2
2

(1 + λ(st ))2 .

(10)

Strictly speaking, (10) is an approximation, as it assumes there is a zero probability of st rising
above smax . Because st > smax occurs very rarely for relevant parameter values, the approximation
in (10) is highly accurate, as shown in what follows. Substituting the equation for λ(st ) into (10)
produces the equation
f
rt+1
= − ln δ + γg −

γ(1 − φ) − b
+ b(s̄ − st ).
2

(11)

Thus (4) implies a riskfree rate that is linear in st .
The aggregate market is represented as the claim to the future consumption stream. If Pt
denotes the ex-dividend price of this claim, then (8) implies that in equilibrium Pt satisfies
µ
·
¶¸
Pt+1 + Ct+1
=1
Et Mt+1
Pt
which can be rewritten as
µ
·
¶
¸
Pt+1
Ct+1
Pt
Et Mt+1
+1
=
.
Ct+1
Ct
Ct

(12)

Because Ct is the dividend paid by the aggregate market, Pt /Ct is the price-dividend ratio.1
1

It is possible to model aggregate dividends as separate from aggregate consumption. Campbell and Cochrane
(1999) introduce a dividend process Dt , where dt = ln Dt and explore a model with
∆dt+1 = g + wt+1

4

The model is simulated by drawing from the consumption process (3), feeding these draws
through (2) to obtain draws for st , and then using the st values to obtain draws for the riskfree
rate and the price-dividend ratio. Returns on the aggregate market are simulated using
m
Rt+1
=

(Pt+1 /Ct+1 ) + 1 Ct+1
.
Pt /Ct
Ct

(13)

Whatever difficulties lie in solving the model lie in solving (12) for the price-dividend ratio as a
function of st , and, to a lesser extent, solving (9) for the riskfree rate.

2

Solution methods

The riskfree rate can be computed directly by solving the expectation in (9), where
Z ∞
−γ(g+(1−φ)(s̄−st ))
p(v)e−γ(λ(st )+1)v dv,
Et [Mt+1 ] = δe

(14)

−∞

and p(v) is the probability density function of a normal distribution with mean zero and standard
deviation σv .2 Computing the price-dividend ratio is less straightforward. One method, used by
Campbell and Cochrane (1999) and referred to here as the fixed-point method, involves solving (12)
recursively. Conjecturing a solution G0 (st ), G1 (st ) is obtained on a grid of values for st as
¸
·
¡ 0
¢ Ct+1
1
G (st ) = Et Mt+1 G (st+1 ) + 1
Ct
Z ∞
¡
¢
= δe(1−γ)g−γ(1−φ)(s̄−st )
p(v)e(1−γ)v−γλ(st )v G0 ((1 − φ)s̄ + φst + λ(st )v) + 1 dv.
(15)
−∞

More generally, given Gk , Gk+1 satisfies
Z ∞
³
´
k+1
(1−γ)g−γ(1−φ)(s̄−st )
G (st ) = δe
p(v)e(1−γ)v−γλ(st )v Gk ((1 − φ)s̄ + φst + λ(st )v) + 1 dv.
−∞

The procedure is repeated until Gk+1 and Gk differ by at most 10−4 . The resulting fixed point is
the solution G(st ) to (12). Chen, Cosimano, and Himonas (2004) show that this recursive definition

where wt+1 and vt+1 are correlated processes. Wachter (2000), following Campbell (1986) and Abel (1999), allows
dividends to be a levered claim on consumption:
Dt = Ctθ .
Prices for these claims can be determined by straightforward modifications to (12). Both have the potential disadvantage that the consumption-dividend ratio is non-stationary: either the claim to dividends or the claim to consumption
eventually takes over the economy. An alternative is to assume that consumption and dividends are co-integrated.
Appendix A shows how to modify (12) to such a model.
2
Solving this integral requires a choice of bounds on the shock, as well as a choice of numerical integration routine.
Here, and in the rest of this paper, Gauss-Legendre 40-point quadrature is used, and the integral is bounded by −8
and +8 standard deviations. Increasing the number of standard deviations in the integral has a negligible effect on
the results.

5

of the price-dividend ratio is well-defined, continuous, and smooth in a wide interval. Each step
in this recursion requires computing the function obtained in the previous step at a set of points
{(1 − φ)s̄ + φst + vj } (where {vj } is determined by the numerical integration routine) for each value

of st . These points generally lie outside of the grid. To evaluate Gk at these points, Campbell

and Cochrane (1999) use log-linear interpolation. That is, they assume that ln Gk is approximately
linear in ln st .
A second way of solving for the price-dividend ratio also takes (12) as the starting point.
Iterating (12) N times produces






n
N
N
Y
Y
X
Ct+n 
Ct+N 0
Mt+j 
Mt+j 
Et 
+ Et 
GN (st ) =
G (st+N ) ,
Ct
Ct
n=1

where Mt+j ≡ δ

³

j=1

Ct+j
St+j
St+j−1 Ct+j−1

´−γ

for j ≥ 1. Assuming one has chosen an initial G0 such that


lim Et 

N →∞

(16)

j=1

N
Y

j=1



Mt+j 



Ct+N 0
G (st+N ) = 0,
Ct

(16) implies a convenient characterization of the price-dividend ratio as an infinite sum of expectations:
G(st ) ≡ lim GN (st ) =
N →∞

∞
X

n=1



Et 

n
Y

j=1



Mt+j 



Ct+n 
Ct

(17)

Each term in (17) is the time-t price of a claim to the aggregate dividend n periods from now
divided by the dividend today. This can be thought of as “zero-coupon equity” with maturity n.
Equation (17) suggests another way of solving for the price-dividend ratio: computing each
expectation on the right-hand side of (17), or at least enough terms so that what remains is
sufficiently small. This can be done recursively, using the Euler equation (8). Let Fn (st ) denote
the nth term in this expectation:


Fn (st ) = Et 

n
Y

j=1



Mt+j 



Ct+n 
.
Ct

(18)

Fn (st )Ct is then the price of zero-coupon equity that matures in n periods. Because this security
pays no dividends, its one-period return equals
Rn,t+1 =

Fn−1 (st+1 )Ct+1
Fn (st )Ct

6

and (8) implies
Fn (st ) = Et

·

¸
Ct+1
Fn−1 (st+1 ) .
Mt+1
Ct

(19)

Finally, when the equity matures it pays the aggregate dividend. Therefore F0 (st ) = 1.3 Finally,
G(st ) =

∞
X

Fn (st ).

n=1

Similar computations to solve for the aggregate price-dividend ratio have been employed in Ang
and Liu (2003), Bekaert, Engstrom, and Grenadier (2004), and Lettau and Wachter (2005).
Iterating on (19) (using F0 (st ) = 1 to start the process), and summing the terms is a second
method of solving for the price-dividend ratio of the aggregate market. I call this the series
method. Like the fixed-point method, the series method must also be implemented numerically.
The recursion (19) has no closed-form solution, and is solved on a grid of values for st . Given
Fn−1 (st ),
(1−γ)g−γ(1−φ)(s̄−st )

Fn (st ) = δe

Z

∞
−∞

p(v)e(1−γ)v−γλ(st )v Fn−1 ((1 − φ)s̄ + φst + λ(st )v) dv

As in the fixed-point method, Fn−1 ((1−φ)s̄+φst +v) is found by interpolating between grid points.
These calculations rely on numerical methods to evaluate the solution for the price-dividend
ratio. Having a closed-form solution would obviate the need for these methods, but such a solution
is not apparent. The lack of an explicit expression does not arise from the assumption of discrete
time, as Appendix B shows. While the stochastic discount factor Mt+1 , as well as the riskfree
f
share certain similarities with continuous-time, affine term structure models of the Cox,
rate rt+1

Ingersoll, and Ross (1985) form they are in fact quite different. In continuous time, a version of the
formula (10) for the riskfree rate is exact rather than approximate. However, this is a minor gain,
as the discussion below makes clear. The solution for zero-coupon claims satisfies a differential
equation in st and the maturity, but this differential equation does not have an exponential-affine
solution.4

3

Calibration

To address the accuracy of the fixed-point and series methods, it is necessary to choose reasonable
parameter values. Two sets of parameter values are considered. The first set is from Campbell
3

These relations can also be derived directly from (18).
Menzly, Santos, and Veronesi (2004) specify a different process for surplus consumption St . In their specification,
it is possible to find a closed-form solution in continuous time.
4

7

and Cochrane (1999). Campbell and Cochrane choose this set of parameters to fit the mean and
volatility of consumption growth, the average riskfree rate, the Sharpe ratio, and the persistence of
the price-dividend ratio in annual data from 1947 until 1995. The parameter b is set to zero, and
therefore the (real) riskfree rate is constant. Campbell and Cochrane calculate the price-dividend
ratio using the fixed-point method, simulate the model at a monthly frequency, and aggregate the
data to an annual frequency.
The second set of parameters is from Wachter (2005). Wachter (2005) chooses this set to fit the
same equity moments as in Campbell and Cochrane, but in quarterly data from 1952 until 2004. A
more important difference is that b is allowed to differ from zero to match the upward-sloping yield
curve for nominal Treasury bonds. This choice of parameters is shown to account for features of
the term structure of interest rates. This model is simulated at a quarterly frequency. Parameter
values for both calibrations are reported in Table 1.

4

Results

To assess the accuracy of the fixed-point and series methods, I first calculate the solution under each
method using three different grids, and under both the Campbell and Cochrane (1999) and Wachter
(2005) calibrations. The first grid (“Grid 1”) is identical to that used by Campbell and Cochrane.
To form this grid, 12 points are chosen at equally spaced intervals between 0 and Smax . Smax is
included in the grid for a total of 13 points. Zero is not included because log-linear interpolation
requires taking the log of St . To capture non-linear behavior of the price-dividend ratio near Smax ,
additional points are added at intervals of 0.01, for a total of 17 grid points.5
The second grid (“Grid 2”) starts with Grid 1 and extends it to values of St closer to zero by
adding points 0.0005, 0.0015, 0.0025, 0.0035, and 0.0045. Finally, the third grid (“Grid 3”) is finer
and includes values much closer to zero. This grid is constructed in two parts, an upper segment
and a lower segment. The upper segment consists of 101 equally spaced points St between 0 and
Smax with Smax included. The lower segment consists of 900 logarithmically spaced points between
the lowest point in the upper segment (e.g. ln .0072 for the Campbell and Cochrane parameter
values), and -300.
Figure 1 illustrates the solution for the price-dividend ratio computed using each method (fixedpoint or series) and each grid. The top panel shows results for Campbell and Cochrane (1999)
5

For example, for the Campbell and Cochrane calibration, the values St included in Grid 1 are [0.0072 0.0144
0.0217 0.0289 0.0361 0.0433 0.0506 0.0578 0.0650 0.0722 0.0794 0.0867 0.0902 0.0911 0.0920 0.0930 0.0939].

8

parameter values and the bottom panel shows results for Wachter (2005) parameter values. Triangles denote the solution obtained with the fixed-point method; circles denote the solution obtained
with the series method. Symbols are decreasing in size from the coarsest grid (Grid 1) to the finest
grid (Grid 3). For the Campbell and Cochrane parameter values, the solution is the same for the
fixed-point or the series method as long as the finest grid is used. However, the coarser grids produce solutions for the price-dividend ratio that are different from one another, and different from
the solution produced by the finest grid. These differences are substantially smaller for the series
method as compared to the fixed-point method.
The bottom panel of Figure 1 shows analogous results for parameter values from Wachter (2005).
Once again, the solution is the same whether one uses the fixed-point or series method as long as
the finest grid is used. Moreover, the series method produces accurate solutions for all three grids
at these parameter values. Slight inaccuracies are present for the fixed-point method when Grids
1 and 2 are used, but on the whole the differences for the solutions across grids and methods are
small.
Figure 1 shows that the solution for the price-dividend ratio depends on the choice of grid.
Tables 2 and 3 show the consequences of this dependence for statistics in simulated data. For both
sets of parameters, I simulate 100,000 years of data. Table 2 reports results for the Campbell and
Cochrane (1999) calibration: the equity premium E(rm − rf ), where rm = ln Rm , the standard

deviation of rm − rf and the Sharpe ratio (the equity premium divided by the standard deviation).
This table also reports the skewness and kurtosis of returns, the mean of the riskfree rate, and the
mean, standard deviation, and persistence of the log of the price-dividend ratio.
As Table 2 shows, the differences in the price-dividend ratio across grids lead to noticeable
differences in simulated data. The first column contains results using Grid 1 and the fixed-point
method.6 The Sharpe ratio is 0.44, the equity premium is 6.6% per annum and the volatility of
excess returns is 15%. The standard deviation of the price-dividend ratio is 0.27. When Grid 3 is
used with the fixed-point method, the Sharpe ratio is 0.47, the equity premium is 3.9%, and the
volatility is 8.2%. The standard deviation of the price-dividend ratio is 0.13.
Table 2 also shows that results in simulated data are virtually identical for the fixed-point and
series methods, as long as the finest grid (Grid 3) is used. As in Figure 1, the series method gives
more accurate results than the fixed-point method. Using Grid 1, for example, the equity premium
under the series method is 4.4%, close to 3.9%, its value under Grid 3. Although differences in grids
6

Slight differences from Campbell and Cochrane (1999) are due to simulation noise.

9

imply differences in equity moments, they do not result in differences for the riskfree rate. Under
the Campbell and Cochrane (1999) calibration, the riskfree rate is constant, so the mean of the
riskfree rate is identically equal to its value. As Table 2 shows, this value is always 0.94, regardless
of which method or grid is used (indeed, 0.94 is also the value produced by the approximation
(10)). It is not surprising that the choice of grid and method matters for the computation of the
price-dividend ratio and not for the riskfree rate. The riskfree rate is computed using only one
integral, while the price-dividend ratio is computed iteratively. This iterative procedure allows
small errors to compound.
Table 3 contains analogous results for the Wachter (2005) calibration. The series method is
again more accurate than the fixed-point method, and in fact the results are indistinguishable
across all three grids when the series method is applied. At these parameter values, the model can
match the equity premium, return volatility, and the volatility of the price-dividend ratio. Wachter
shows that these parameter values also enable the model to capture important aspects of the term
structure of interest rates. However, as noted by Tallarini and Zhang (2004), this type of model
produces returns that are skewed in the opposite direction as returns in the data, and that exhibit
less kurtosis than in the data.
I now turn to the question of whether the solution for the price-dividend ratio converges as the
grid becomes increasingly fine. This is important in establishing both that Grid 3 is sufficiently
fine (i.e. constructing an even finer grid would not produce a substantially different solution), and
as a means of determining how coarse the grid can be without producing unacceptable errors.
To address the question of convergence, grids are varied along three dimensions. These dimensions are suggested by the construction of Grid 3. As described above, Grid 3 has an upper and a
lower segment. The upper segment consists of equally spaced points between 0 and Smax . The lower
segment consists of logarithmically spaced points between a minimum value and the natural log of
the lowest point in the upper segment. When viewed as a grid on St , the resulting grid is evenly
spaced in the upper segment, and more dense in the lower segment, with the density increasing as
St declines to zero. When viewed as a grid on st = ln St , the grid is evenly spaced in the lower
segment, and more dense in the upper segment, with the density increasing as st rises toward smax .
To assess convergence, the grids are varied by decreasing the minimum value, increasing the density
of the lower segment, and increasing the density of the upper segment. For each grid and method,
the solution for the price-dividend ratio is compared to the solution computed using Grid 3 and
the corresponding method. More precisely, the solution is subtracted from the solution computed

10

using Grid 3. This quantity is divided by the solution computed using Grid 3 and multiplied by
100. For the purposes of comparison, the solutions are evaluated at smax . Repeating the exercise
using s̄ rather than smax yields results that are nearly identical; they are omitted for brevity.
Figure 2 shows the results of altering the minimum value, keeping other aspects of the grid the
same as in Grid 3 (the number of points in the upper segment is maintained at 100 and the number
of points in the lower segment is set at three times the minimum value, so that the density remains
constant even as the minimum value changes). The least fine grid has a minimum value of zero,
so there are no points in the lower segment. The finest grid has a minimum value of -300, and so
is equal to Grid 3. The top graph shows results for the Campbell and Cochrane (1999) parameter
values and the bottom graph shows results for the Wachter (2005) parameter values. The x-axis
is in terms of the log of the minimum value. This figure shows that the solution converges to
its Grid-3 value as the minimum value approaches -300 for both calibrations and methods. This
convergence is faster for the series method than for the fixed-point method, and for the Wachter
(2005) calibration, the errors are negligible for all grids under the series method.
Figures 3 and 4 display results for altering the the density in the lower segment and the upper
segment respectively. In both cases, the log of the minimum value is kept at -300. For Figure 3, the
number of points in the upper segment is maintained at 100, while for Figure 4, the number of points
in the lower segment is maintained at 900. In both cases, the price-dividend ratio converges to the
Grid-3 value. The convergence is faster for the Wachter (2005) parameter values, and the series
method again results in substantially faster convergence as compared to the fixed-point method.

5

Conclusion

This paper has investigated two related methods of solving for the equilibrium price-dividend ratio
in the Campbell and Cochrane (1999) model and its extension in Wachter (2005). Both methods
involve solving for the price-dividend ratio of the consumption claim on a grid of values. The
series method computes the price-dividend ratio as a sum of claims to individual future dividend
payments. The fixed-point method computes the price-dividend ratio as a fixed point of the investor’s Euler equation. If each method could be applied without error, they give identical solutions.
However, because both methods involve numerical approximations, there may be differences. This
paper has shown that the two methods indeed give the same answer if the grid used in the approximation is sufficiently fine. Moreover, the solution is shown to converge for both methods as the
grid becomes finer. The speed of this convergence is shown to depend on the calibration: when the
11

model is calibrated to the term structure of interest rates as well as equity moments (as in Wachter
(2005)), the solution converges more quickly. For both calibrations, the series method leads to
substantially faster convergence and greater accuracy for any given grid.

12

Appendix A
This Appendix solves the model in the case of cointegrated consumption and dividends. Let
zt = ct − dt , the consumption-dividend ratio, and assume that
zt+1 = (1 − ψ)z̄ + ψzt + wt+1 ,
where wt+1 is iid and jointly normally distributed with vt+1 . Let ρ denote the correlation between
vt+1 and wt+1 and σw the standard deviation. The ex-dividend price of the claim to dividends, P d ,
satisfies
Et

"

P d + Dt+1
Mt+1 t+1
Pt

#

= 1.

d
d that satisfy
Pt+1
can be expressed as the sum of claims to individual dividends Pnt
"
#
d
d
Pn−1,t+1
Dt+1
Pnt
= Et Mt+1
Dt
Dt+1
Dt
"
#
d
Pn−1,t+1
eg+vt+1 −∆zt+1 ,
= Et Mt+1
Dt+1

(20)

with boundary condition
d
P0,t
= 1.
Dt

The presence of zt adds a complication, as in principle the integration for the recursion (20)
d can be written as
must be done over two variables. However, it turns out that Pnt
d
Pn,t
= Fnd (st ) exp {An + Bn zt } ,
Dt

(21)

where F d satisfies the one-dimensional recursion
i
h
σw
d
(st+1 ) ,
Fnd (st ) = Et Mt+1 eg+(1+(Bn −1)ρ σv )vt+1 Fn−1

(22)

with boundary condition F0d (st ) = 1.

I now verify equations (21) and (22) by substituting (21) into (20) and using the law of iterated
expectations. A similar argument is used to obtain expressions for nominal bonds in Wachter
d
(2005). Substituting in for Pn−1,t+1
/Dt+1 inside the expectation yields
d
Pnt
Dt

h
i
d
(st+1 ) exp {An−1 + Bn−1 zt+1 } exp {g + vt+1 − ∆zt+1 }
= Et Mt+1 Fn−1

= exp {An−1 + (Bn−1 − 1)(1 − ψ)z̄ + (Bn−1 ψ − ψ + 1)zt }
h
h
ii
d
× Et Mt+1 eg+vt+1 Fn−1
(st+1 )E e(Bn−1 −1)wt+1 | vt+1 .
13

(23)

Conditional on vt+1 , (Bn−1 − 1)wt+1 is normally distributed:
¶
µ
σw
2 2
2
(Bn−1 − 1)wt+1 |vt+1 ∼ N (Bn−1 − 1)ρ vt+1 , (Bn−1 − 1) σw (1 − ρ ) ,
σv
so the inner expectation in (23) can be written as
¾
½
i
h
1
σw
2 2
2
(Bn−1 −1)wt+1
E e
| vt+1 = exp (Bn−1 − 1)ρ vt+1 + (Bn−1 − 1) σw (1 − ρ ) .
σv
2
Define recursions
1
2
(1 − ρ2 )
An = An−1 + (Bn−1 − 1)(1 − ψ)z̄ + (Bn−1 − 1)2 σw
2
Bn = Bn−1 ψ − ψ + 1,

(24)
(25)

and let A0 = B0 = 0. By induction, it follows that (21) is satisfied. Equation (25) and the boundary
condition imply
Bn = (1 − ψ)

1 − ψn
.
1−ψ

Using the decomposition (21), it is possible to solve this model using the series method described
in Section 2. The recursion (22) is solved iteratively using quadrature. For any values of the state
variables, a price-dividend ratio can be produced by interpolating to find the correct Fnd (st ), and
multiplying by eAn +Bn zt . The price-dividend ratio for the aggregate market is equal to
∞

Ptd X d
=
Fn (st ) exp {An + Bn zt } .
Dt
n=1

Note that a decomposition analogous to (21) does not hold for the market price-dividend ratio, and
thus solving this model would be quite difficult with the fixed-point method.

Appendix B
This Appendix describes a continuous-time version of the economy in Section 1. Let Zt be a
one-dimensional Brownian motion, and assume that the log of consumption follows:
dct = g dt + σv dZt .
Log surplus consumption st = ln[(Ct − Xt )/Ct ] is assumed to follow the process
dst = (1 − φ)(s̄ − st ) dt + λ(st )σv dZt .

14

Let ζt denote the pricing kernel in this economy (see Duffie (1996, Chapter 6)), which will be
determined endogenously in equilibrium. The pricing kernel follows the process
dζt
= −rtf dt − ηt dZt ,
ζt
where rtf is the instantaneous riskfree rate (the continuous-time analogue to the one-period riskfree
rate in Section 1), and ηt is the price of risk.
Identical agents maximize
Z

E
subject to

∞

δt

0

E

·Z

(Ct − Xt )1−γ
dt
1−γ

∞

¸

ζt Ct = W0 ,

0

(26)

where W0 is the initial wealth in the economy. The condition for equilibrium equates marginal
utility with a constant multiplied by the pricing kernel (see Duffie (1996, Chapter 10)):
δ t (St Ct )−γ = kζt .

(27)

The constant k adjusts such that (26) is satisfied . Applying Ito’s Lemma to the left hand side of
(27) and equating drift and diffusion terms implies
ηt = γσv (1 + λ(st )),
and
rtf = − ln δ + γg + γ(1 − φ)(s̄ − st ) −

γ 2 σv2
(1 + λ(st ))2 .
2

(28)

Unlike (10), (28) does not require an approximation.
Specifying λ(st ) as
p
λ(st ) = (1/S̄) 1 − 2(st − s̄) − 1

implies that (28) reduces to (11). In the continuous-time set-up, there is no need to require that
λ(st ) be identically zero above smax , as this will never occur.
To solve for the price of the consumption claim, note that any risky asset with price P that
follows the process
dPt
= µP,t dt + σP,t dZt
Pt
must satisfy the no-arbitrage condition
µP,t − rtf = σP,t ηt .
15

(29)

As in Section 2, conjecture that the price of a zero-coupon consumption claim maturing at date
t + τ takes the form
P (Ct , st , τ ) = Ct F (st , τ )

(30)

for some smooth function F . Applying Ito’s Lemma to (30) and substituting into (29) indicates
that (30) is satisfied, and that F solves the following partial differential equation:
Fs
Fτ
1 Fss
Fs
1
+
λ(st )2 σv2 + λ(st )σv2 − rtf
g + σv2 + (1 − φ)(s̄ − st ) −
2
F
F
2 F
Fµ
¶
Fs
= σv + σv λ(st ) (1 + λ(st ))γσv , (31)
F
where Fs , Fτ , Fss denote appropriate first and second derivatives of F . Equation (31) thus characterizes prices of zero-coupon equity and provides an alternative route to a solution for the model
in Section 1.

16

References
Abel, Andrew, 1990, Asset prices under habit formation and catching up with the Joneses, American
Economic Review Papers and Proceedings 80, 38–42.
Abel, Andrew, 1999, Risk premia and term premia in general equilibrium, Journal of Monetary
Economics 43, 3–33.
Ang, Andrew, and Jun Liu, 2003, How to discount cash flows with time-varying expected returns,
forthcoming, Journal of Finance.
Bekaert, Geert, Eric Engstrom, and Steve Grenadier, 2004, Stock and bond returns with moody
investors, Working paper, Columbia University, Stanford University, and University of Michigan.
Brandt, Michael W., and Kevin Q. Wang, 2003, Time-varying risk aversion and unexpected inflation, Journal of Monetary Economics 50, 1457–1498.
Buraschi, Andrea, and Alexei Jiltsov, 2003, Term structures of interest rates in a monetary economy
with habit formation, Working paper, London Business School.
Campbell, John Y., 1986, Bond and stock returns in a simple exchange model, Quarterly Journal
of Economics 101, 785–803.
Campbell, John Y., and John H. Cochrane, 1999, By force of habit: A consumption-based explanation of aggregate stock market behavior, Journal of Political Economy 107, 205–251.
Campbell, John Y., and John H. Cochrane, 2000, Explaining the poor performance of consumptionbased asset pricing models, Journal of Finance 55, 2863–2878.
Chan, Y. Lewis, and Leonid Kogan, 2002, Catching up with the Joneses: Heterogeneous preferences
and the dynamics of asset prices, Journal of Political Economy 110, 1255–1285.
Chen, Xiaohong, and Sydney C. Ludvigson, 2003, Land of addicts? An empirical investigation of
habit-based asset pricing models, Working paper, New York University.
Chen, Yu, Thomas F. Cosimano, and Alex A. Himonas, 2004, By force of habit: An exploration of
asset pricing models using analytic methods, Working paper, University of Notre Dame.
Constantinides, George M., 1990, Habit formation: A resolution of the equity premium puzzle,
Journal of Political Economy 98, 519–543.
17

Cox, John C., Jonathan C. Ingersoll, and Stephen A. Ross, 1985, A theory of the term structure
of interest rates, Econometrica 53, 385–408.
Dai, Qiang, 2000, From equity premium puzzle to expectations puzzle: A general equilibrium
production economy with stochastic habit formation, Working paper, New York University.
Duffee, Gregory R., 2004, Time-variation in the covariance between stock returns and consumption
growth, forthcoming, Journal of Finance.
Duffie, Darrell, 1996, Dynamic Asset Pricing Theory. (Princeton University Press Princeton, NJ).
Gomes, Francisco, and Alexander Michaelides, 2003, Portfolio choice with internal habit formation:
A life-cycle model with uninsurable labor risk, Review of Economic Dynamics 6, 729–766.
Korniotis, Georege M., 2005, The unconditional equity premium with external habit and incomplete
markets, Working paper, University of Notre Dame.
Lettau, Martin, and Harald Uhlig, 2000, Can habit formation be reconciled with business cycle
facts?, Review of Economic Dynamics 3, 79–99.
Lettau, Martin, and Jessica A. Wachter, 2005, Why is long-horizon equity less risky? A durationbased explanation of the value premium, NBER working paper # 11144.
Li, Yuming, 2001, Expected returns and habit persistence, Review of Financial Studies 14, 861–899.
Mehra, Rajnish, and Edward Prescott, 1985, The equity premium puzzle, Journal of Monetary
Economics 15, 145–161.
Menzly, Lior, Tano Santos, and Pietro Veronesi, 2004, Understanding predictability, Journal of
Poitical Economy 112, 1–47.
Pastor, Lubos, and Pietro Veronesi, 2004, Rational IPO Waves, forthcoming, Journal of Finance.
Sundaresan, Suresh M., 1989, Intertemporally dependent preferences and the volatility of consumption and wealth, Review of Financial Studies 2, 73–88.
Tallarini, Thomas D., and Harold H. Zhang, 2004, External habit and the cyclicality of stock
returns, Forthcoming, Journal of Business.
Wachter, Jessica A., 2000, Essays in Financial Economics, Ph.D. thesis Harvard University.
18

Wachter, Jessica A., 2005, A consumption-based model of the term structure of interest rates,
forthcoming, Journal of Financial Economics.

19

Table 1: Parameter Choices
This table reports the assumed parameters in Campbell and Cochrane (1999) (CC) and
Wachter (2005). The CC specification is simulated at a monthly frequency while the
Wachter specification is simulated at a quarterly frequency. Parameters are annualized,
√
e.g. 12g, 12σ, φ12 and δ 12 for the CC values, and 4g, 2σ, φ4 and δ 4 for the Wachter
values.

Parameters

CC Value

Wachter Value

Mean consumption growth (%) g

1.89

2.20

Standard deviation of consumption growth (%) σv

1.50

0.86

Utility Curvature γ

2.00

2.00

0

0.011

Habit persistence φ

0.87

0.89

Discount rate δ

0.90

0.93

Coefficient on −st in the riskfree rate b

20

Table 2: Simulation Results: Campbell and Cochrane (1999) calibration
100,000 years of artificial data are simulated based on the Campbell and Cochrane
calibration in Table 1 for the fixed-point and series methods, and for Grids 1 (coarse),
2, and 3 (fine) as described in Section 4. The model is simulated at a monthly frequency
and results are aggregated to an annual frequency. Data moments are calculated using
annual data from 1947 to 1995.

Fixed Point

Series

Data

Moment/Grid

1

2

3

1

2

3

E(rm − rf ),%

6.59

5.18

3.89

4.44

4.19

3.90

6.69

σ(rm − rf ),%

15.05

11.80

8.23

9.51

9.00

8.25

15.70

Sharpe Ratio

0.44

0.44

0.47

0.47

0.47

0.47

0.43

Skewness

0.26

0.12

0.04

0.07

0.06

0.04

-0.53

Kurtosis

4.58

3.87

3.37

3.49

3.44

3.37

3.35

E(rf ),%

0.94

0.94

0.94

0.94

0.94

0.94

0.94

exp{E(p − d)}

18.62

24.35

34.66

29.30

31.43

34.52

24.70

σ(p − d)

0.27

0.21

0.13

0.16

0.15

0.13

0.26

Corr(p − d)

0.86

0.85

0.84

0.84

0.84

0.84

0.87

21

Table 3: Simulation Results: Wachter (2005) calibration
400,000 quarters of artificial data are simulated based on the Wachter calibration in
Table 1 for the fixed-point and series methods, and for Grids 1 (coarse), 2, and 3 (fine)
as described in Section 4. The model is simulated at a quarterly frequency. Results
are reported in annual terms (expected returns are multiplied by 4, and the standard
deviation of returns is multiplied by 2). Data moments are calculated using quarterly
data from 1952 to 2004.

Fixed Point

Series

Data

Moment/Grid

1

2

3

1

2

3

E(rm − rf ),%

5.86

5.43

5.64

5.65

5.64

5.65

5.21

σ(rm − rf ),%

17.24

16.07

16.10

16.14

16.11

16.14

15.93

Sharpe Ratio

0.34

0.34

0.35

0.35

0.35

0.35

0.33

Skewness

0.33

0.32

0.33

0.33

0.33

0.33

-0.95

Kurtosis

4.04

3.86

3.83

3.83

3.83

3.83

4.91

E(rf ),%

1.47

1.47

1.47

1.47

1.47

1.47

1.46

exp{E(p − d)}

20.68

22.31

21.39

21.34

21.35

21.33

31.50

σ(p − d)

0.34

0.31

0.31

0.31

0.31

0.31

0.33

Corr(p − d)

0.97

0.97

0.97

0.97

0.97

0.97

0.97

22

Campbell and Cochrane (1999) Parameter Values
45
40
35

P/D

30
25
20
Gr.1, FP
Gr.1, Ser.
Gr.2, FP
Gr.2, Ser.
Gr.3, FP
Gr.3, Ser.

15
10
5
0
0

0.02

0.04
0.06
0.08
Surplus consumption ratio St

0.1

Wachter (2005) Parameter Values
35
30
25

P/D

20
15

Gr.1, FP
Gr.1, Ser.
Gr.2, FP
Gr.2, Ser.
Gr.3, FP
Gr. 3, Ser.

10
5
0
0

0.01

0.02
0.03
0.04
0.05
Surplus consumption ratio S

0.06

0.07

t

Figure 1: The price-dividend ratio as a function of surplus consumption St under Grids 1 (coarse),
2, and 3 (fine). FP denotes the fixed-point method and Ser. denotes the series method.

23

Campbell and Cochrane (1999) Parameter Values
0
−5
FP method
Series method

% Error in P/D

−10
−15
−20
−25
−30

0

50

100
150
200
Negative log minimum value

250

300

Wachter (2005) Parameter Values
0

% Error in P/D

−0.2

FP method
Series method

−0.4

−0.6

−0.8

−1

0

50

100
150
200
Negative log minimum value

250

300

Figure 2: Percent difference in the price-dividend ratio between the grid with the lowest minimum
value and grids with greater minimum values. Lines with triangles denote computations with
the fixed-point (FP) method, lines with circles denote computations with the series method. The
number of grid points in the lower segment is equal to three times the minimum value. The number
of grid points in the upper segment is equal to 100. The difference is evaluated at Smax . The y-axis
scale differs for the upper and lower graphs.
24

Campbell and Cochrane (1999) Parameter Values
10
FP method
Series method

% Error in P/D

8

6

4

2

0
0

0.5
1
1.5
2
2.5
3
Density of lower grid (units of log minimum value)

Wachter (2005) Parameter Values
10
FP method
Series method

% Error in P/D

8

6

4

2

0
0

0.5
1
1.5
2
2.5
3
Density of lower grid (units of log minimum value)

Figure 3: Percent differences in the price-dividend ratio between the grid with the most density in
the lower segment and grids with less density in the lower segment. Lines with triangles denote
computations with the fixed-point (FP) method, lines with circles denote computations with the
series method. The minimum value is equal to -300. The number of grid points in the upper
segment is equal to 100. The difference is evaluated at Smax .
25

Campbell and Cochrane (1999) Parameter Values
10
FP method
Series method

% Error in P/D

8

6

4

2

0

20

40
60
80
Number of grid points in upper grid

100

Wachter (2005) Parameter Values
10
FP method
Series method

% Error in P/D

8

6

4

2

0

20

40
60
80
Number of grid points in upper grid

100

Figure 4: Percent difference in the price-dividend ratio between the grid with the most points in
the upper segment and grids with fewer points in the upper segment. Lines with triangles denote
computations with the fixed-point (FP) method, lines with circles signs denote computations with
the series method. The minimum value is equal to -300. The number of grid points in the lower
segment is equal to 900. The difference is evaluated at Smax .
26

