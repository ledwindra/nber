NBER WORKING PAPER SERIES

AN ECONOMETRIC MODEL OF LINK FORMATION WITH DEGREE HETEROGENEITY
Bryan S. Graham
Working Paper 20341
http://www.nber.org/papers/w20341

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
July 2014
The first draft of this paper dates to March 2014 and was titled “An empirical model of network
formation: detecting homophily when agents are heterogenous”. A Python 2.7.11 module
implementing the methods described in this paper is available for download from my web page. I
thank Jinyong Hahn for sharing an unpublished appendix of Hahn and Newey (2004), Joachim
De Weerdt for generously making his Nyakatoke dataset available, Eric Auerbach, Peter Bickel,
Stephane Bonhomme, Jesus Carro, Gary Chamberlain, Xiaohong Chen, Nicholas Christakis, Ivan
Fernandez-Val, Jim Heckman, Yuichi Kitamura, Elena Manresa, Costas Meghir, Roger Moon,
Jong-Myun, Matt Shum, Martin Weidner and Bin Yu for numerous helpful suggestions. This
paper has also benefited from the reactions of audiences at the 2014 Seattle-Vancouver
Econometrics Conference, the 2014 All California Econometrics Conference, the 2015
Econometrics Journal Conference on Networks, the 2016 BeNet Conference at UCL/CORE, as
well as from participants in seminars and workshops at New York University, UC Berkeley, the
Toulouse School of Economics, Oxford, Cambridge, St. Gallen, CEMFI, the Yale Institute of
Network Sciences, Stanford, USC, UCSD, Chicago, Michigan, Brown and Harvard-MIT. This
revision incorporates many useful suggestions made by the co-editor, Elie Tamer, and four
anonymous referees. Finally, I am especially grateful for helpful conversations and suggestions
from my three immediate colleagues in the Economics Department at Berkeley: Michael Jansson,
Demian Pouzo and Jim Powell. Financial support from NSF grant SES #1357499 is gratefully
acknowledged. All the usual disclaimers apply. The views expressed herein are those of the
author and do not necessarily reflect the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2014 by Bryan S. Graham. All rights reserved. Short sections of text, not to exceed two
paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.

An econometric model of link formation with degree heterogeneity
Bryan S. Graham
NBER Working Paper No. 20341
July 2014, Revised February 2017
JEL No. C31,C35
ABSTRACT
I introduce a model of undirected dyadic link formation which allows for assortative matching on
observed agent characteristics (homophily) as well as unrestricted agent level heterogeneity in
link surplus (degree heterogeneity). Like in fixed effects panel data analyses, the joint distribution
of observed and unobserved agent-level characteristics is left unrestricted. Two estimators for the
(common) homophily parameter, β0, are developed and their properties studied under an
asymptotic sequence involving a single network growing large. The first, tetrad logit (TL),
estimator conditions on a sufficient statistic for the degree heterogeneity. The second, joint
maximum likelihood (JML), estimator treats the degree heterogeneity {Ai 0 }iN1 as additional
(incidental) parameters to be estimated. The TL estimate is consistent under both sparse and
dense graph sequences, whereas consistency of the JML estimate is shown only under dense
graph sequences.

Bryan S. Graham
University of California - Berkeley
530 Evans Hall #3880
Berkeley, CA 94720-3880
and NBER
bgraham@econ.berkeley.edu

A online appendix is available at http://www.nber.org/data-appendix/w20341

Homophily, the tendency of individuals to form connections with those like themselves, is a
widely-observed feature of real world social and economic networks (e.g., McPherson et al.,
2001). Equally common is degree heterogeneity: variation in the number of links (i.e., degree)
across individuals. In particular, the conjunction of many low degree individuals with few
links, and a handful of high degree “hub” individuals with many links, characterizes many
networks (e.g., Barabási and Albert, 1999). The presence and magnitude of homophily and
degree heterogeneity has implications for how information diﬀuses, the spread of epidemics,
as well as the speed and precision of social learning (e.g., Pastor-Satorras and Vespignani,
2001; Jackson and Rogers, 2007; Golub and Jackson, 2012; Jackson and López-Pintado,
2013).1
This paper formulates and studies a model of link formation that flexibly accommodates
both homophily and degree heterogeneity. To motivate the model, as well as heuristically
introduce some of the identification issues involved, consider the small network depicted in
Figure 1. This network consists of two observable types of agents, colored “Berkeley Blue”
(dark) and “California Gold” (light) in the figure. There are also three “hub” agents in
the network (the larger nodes in the center of the graph). Whether an agent is a hub or
not is unobserved by the researcher. This network is a random draw from a population
characterized by a strong structural taste for homophily (see Section 1 below and the notes
to the figure for details). Although homophily underlies the network formation process, half
of all links – specifically eight out of sixteen – are heterophilic (i.e., between agents of a
diﬀerent type/color). Since the frequency of links across (homphilous) dyads of the same
type is identical to that across (heterophilous) dyads of diﬀering types a researcher fitting
common models of link formation to these data might fail to conclude that preferences are,
in fact, homophilic. The presence of hub agents, who form many links irrespective of type,
eﬀectively attenuates measured homophily.
The model outlined below is designed to help researchers avoid this type of inferential mistake. It augments a standard dyadic model of link formation, as used by, for example,
Fafchamps and Gubert (2007), Lai and Reiter (2000), Apicella et al. (2012) and Attanasio
et al. (2012), with agent-specific unobserved degree heterogeneity. Specifically agents freely
vary in the generic surplus they generate when forming a match. The surplus associated
with any given match may further vary with observable characteristics of the dyad. For example surplus may be systematically higher between agents who are close in age (homophily
on age). Unlike prior work incorporating degree heterogeneity (e.g., van Duijn et al., 2004;
Krivitsky et al., 2009), the joint distribution of the unobserved degree heterogeneity and
1
Apicella et al. (2012) even study the relationship between homophily and the emergence of cooperation
in hunter-gatherer societies.

1

Figure 1: Homophily and degree heterogeneity

Notes: See Section 1 below for additional details on the construction of the figure as well as notational definitions. The figure shows a simulated network with both correlated degree heterogeneity
and homophilous link formation. California Gold (light) and Berkeley Blue (dark) shaded nodes
respectively denote X = −1 and X = 1 agents. Smaller nodes denote “low degree agents” (with
A = a) and larger nodes “high degree” or “hub” agents (with A = ā). Heterophilic and homophilic
links are depicted with, respectively, dashed and solid lines. Links form according to equation (1)
of Section 1 with Pr (X = −1, A = a) = 0.4, Pr (X = −1, A = ā) = 0.1, Pr (X = 1, A = a) = 0.3
and Pr (X = 1, A = ā) = 0.2, β0 = 1, Wij = Xi Xj and a and ā chosen such that a (X = −1, A = a)
to (X = 1, A = a) link occurs with probability 0.025 and a (X = −1, A = ā) to (X = 1, A = ā) link
occurs with probability 0.8.

observed agent attributes is left unrestricted. The treatment here is a “fixed eﬀects” one
(Chamberlain, 1980, 1985). This allows for settings similar to that depicted in Figure 1,
where dark “Berkeley Blue” agents are more likely to be hubs than light “California Gold”
ones.2
In the model each agent i = 1, . . . , N has an individual-specific “degree eﬀect”, Ai . If these
eﬀects are treated as (incidental) parameters, then the dimension of the parameter vector
grows with the number of agents in the network. This makes the estimation problem nonstandard. Textbook results on the large sample properties of maximum likelihood estimates
(MLEs) do not apply (e.g., Neyman and Scott, 1948). In this paper I introduce and study
two fixed eﬀects estimators of the common parameters characterizing homophily. The first
estimator implicitly conditions on a suﬃcient statistic for the degree eﬀects. The second
estimates the degree eﬀects jointly with the common parameters.
2

De Weerdt (2004, Column 3, Table 7) fits the JML estimator described below to a risk sharing network
from Tanzania. He does not analyze the asymptotic sampling properties of the JMLE.

2

The first estimator is based on a standard application of minimal suﬃciency in exponential
families (Andersen, 1973). Similar results form the basis of conditional maximum likelihood
estimators in nonlinear panel data models (Cox, 1958; Chamberlain, 1980). Recently, in
independent work, Charbonneau (2014) uses suﬃciency arguments to develop conditional
estimators for nonlinear models with multiple fixed eﬀects. Her analysis is inspired by
empirical studies of international trade, where the introduction of importer and exporter
eﬀects is common (e.g., Santos Silva and Tenreyro, 2006). While not explicitly formulated
as such, the implicit network structure of her model is one with directed edges (“does country
i export to country j?”). In contrast, the results presented here apply to undirected networks.
Charbonneau (2014) does not characterize the large sample properties of her estimator.3
The conditional estimator I introduce below is based on the relative frequency of diﬀerent
types of subgraphs, each consisting of four agents (called tetrads). I call this estimator the
tetrad logit (TL) estimator. The tetrad logit criterion function is related to the class of UProcess minimizers studied by Honoré and Powell (1994) among others. Unfortunately, these
prior results do not apply to the TL estimator. Although the TL criterion function consists
( )
of a sum over all N4 quadruples of agents, analogous to a 4th order U-process, its kernel
includes random variables defined at both the agent and dyad level. The criterion function
is therefore not a U-statistic, conventionally defined. Nevertheless I adapt various tools from
the literature on U-Statistics to characterize the asymptotic properties of the TL estimator.
Specifically, the tetrad logit “score” vector behaves similarly to a fourth order degenerate
U-statistic. A Hoeﬀding (1948) variance decomposition indicates that this degeneracy is of
order one such that the leading variance term is inversely proportional to the number of
def ( )
dyads in the network, n = N2 = 12 N (N − 1), not the number of agents, N .4 This score
vector is asymptotically equivalent to a certain projection which involves summation over
dyads (not agents). This projection, however, is not a sum of independent components.
Fortunately its summands have a particular conditional independence structure, which I
exploit to demonstrate asymptotic normality by adapting a construction due to Chatterjee
(2006).
The second estimator jointly estimates the common and incidental parameters by maximum
likelihood. I call this estimator the joint maximum likelihood (JML) estimator. The key insight is that, although the number of parameters is of order N , the number of conditionally
independent log-likelihood components is of order N 2 . Each dyad contributes for a total
of n = 21 N (N − 1) = O (N 2 ) log-likelihood components. Since the amount of “data” is
3

In a recent paper, which builds, in part, on the results presented below, Jochmans (2016a) formalizes
the approach of Charbonneau (2014) and provides large sample results.
4
This statement only applies exactly to dense network sequences, the sparse case is more complicated, as
detailed below.

3

increasing at a rate faster than the dimension of the parameter, the joint maximum likelihood estimates of the common parameters are consistent, however, their limit distribution
is biased. Accurate inference therefore requires bias-correction. This analysis parallels recent findings from the non-linear panel data literature under large-N, large-T asymptotics
(e.g., Hahn and Newey, 2004; Arellano and Hahn, 2007). Dzemski (2014), in related work,
studies the properties of joint maximum-likelihood applied to the directed network model of
Charbonneau (2014). His analysis builds on Fernández-Val and Weidner’s (2016) study of
non-linear panel data models with both individual- and time-eﬀects. In contrast, the technical details of the analysis presented here draws from Chatterjee et al.’s (2011) analysis of
the β-model of network formation (cf., Yan and Xu, 2013)5 and Hahn and Newey (2004).
I demonstrate consistency and asymptotic normality of the TL and JML estimators under
diﬀering regularity conditions. In both cases results are established under an asymptotic
sequence involving a single network which grows in size. To my knowledge, the two estimators
introduced here represent the first frequentist analyses of an econometric model of link
formation under “single network asymptotics”.6 The TL estimate is shown to be consistent
under both sparse graph sequences, where the number of links per agent is bounded, as well
as dense graph sequences, where the number of links per agent is proportional to the total
number of agents in the limit. The JML estimate is only shown to be consistent under dense
graph sequences. This diﬀerence is likely to be consequential in ways relevant to empirical
researchers. Many social and economic networks are “sparse”, in the sense that only a small
fraction of all possible links are present, the JML estimator may have poor finite sample
properties in such settings (a conjecture I explore through a series Monte Carlo experiments
summarized in the Supplemental Materials). An advantage of the JML estimator, relative to
the TL one, is that it produces estimates of the incidental as well as the common parameters.
This allows for computation of marginal eﬀects and counterfactuals. The two estimators are
complementary, with the TL estimator being applicable to a wider class of problems, but
the JML estimator providing consistent estimates of more features of the network generating
process.
5

This work is, in turn, closely connected to an older literature on the Bradley-Terry model of paired
comparisons (e.g., Simons and Yao, 1998, 1999).
6
Prior empirical work based on a single network has generally taken a Bayesian approach (e.g., van Duijn
et al., 2004; Krivitsky et al., 2009; Christakis et al., 2010; Mele, 2013; Goldsmith-Pinkham and Imbens, 2013).
Extant frequentists analyses involve asymptotic sequences based upon an increasing number of independent
networks (e.g., Miyauchi, 2016; Sheng, 2014). Chandrasekhar and Jackson (2015) do work under single
network asymptotics, but in the context of a rather diﬀerent model from the one considered here. Leung
(2015) also develops some tools for frequentist inference based on a single large network. Since the initial
draft of this paper was circulated, several additional working papers have appeared building on various results
presented below, as well as prior work by others; these papers include those by Dzemski (2014); Candelaria
(2016); Jochmans (2016b,a); Nadler (2015) and Yan et al. (2016).

4

An important limitation of the analysis presented here is that it rules out interdependent link
preferences, whereby agents’ preferences over a link may vary with the presence or absence
of links elsewhere in the network. The study of network formation in the presence of interdependent preferences is one theme of recent theoretical research on networks (e.g., Jackson and
Wolinsky, 1996; Bala and Goyal, 2000; Jackson and Watts, 2002). Christakis et al. (2010);
Mele (2013); Goldsmith-Pinkham and Imbens (2013); Graham (2013, 2016); Menzel (2016)
and de Paula et al. (2015) are some recent attempts to study econometric models of network
formation with interdependent preferences under various assumptions. None of these papers,
with the exception of Goldsmith-Pinkham and Imbens (2013) and Graham (2013, 2016), incorporate correlated unobserved agent heterogeneity into their modeling frameworks, as is
done here. In Section 3 I discuss how to extend the results presented below to incorporate
interdependent preferences in link formation (at least of a certain limited type) when the
network is observed for two or more periods.
Section 1 formally introduces a dyadic model of link formation with degree heterogeneity
and presents a baseline set of maintained assumptions. Section 2 presents the tetrad logit
(TL) and joint maximum likelihood (JML) estimators and characterizes their large sample
properties. Section 3 sketches several extensions of the basic model. Proofs associated with
the tetrad logit estimate can be found in Appendix A. All remaining proofs, as well as a
Monte Carlo analysis of the two estimators finite sample properties, can be found in the
Supplemental Materials.
Notation
In what follows random variables are denoted by capital Roman letters, specific realizations
by lower case Roman letters and their support by blackboard bold Roman letters. That
is Y , y and Y respectively denote a generic random draw of, a specific value of, and the
support of, Y . If B is an N × N matrix with (i, j)th element bij , then ∥B∥max = supi,j |bij |,
∑n [∑m
∑
2 ]1/2
. I use ιN to denote a N × 1
∥B∥∞ = supi N
i=1 |bij |
j=1
j=1 |bij |, and ∥B∥2,1 =
∑
vector of ones and IN the N × N identity matrix. The notation i<j<k is a shorthand for
∑N ∑N
∑N
i=1
j=i+1
k=j+1 . A “0” subscript on a parameter denotes its population value and may
be omitted when doing so causes no confusion.

1

Model and baseline assumptions

Consider a large population of potentially connected agents. Depending on the context
agents may be individuals, households, firms, or nation-states (among many other types of
5

possible actors). Let i = 1, . . . , N index a random sample of size N from this population.
def ( )
Each of the n = N2 = 12 N (N − 1) pairs of sampled agents constitute a dyad. For each ij
dyad let Dij = 1 if i and j are connected and zero otherwise.7 Connections are undirected
(i.e., Dij = Dji ) and self-ties are ruled out (i.e., Dii = 0). The N × N matrix D, with ij th
element Dij , is called the adjacency matrix. This matrix is binary and symmetric, with zeros
on its main diagonal. The adjacency matrix encodes the structure of links across all sampled
agents. It what follows I will refer to a set of such links as, equivalently, a network or graph.
∑
An agent’s degree equals the number of links she has: Di+ = j̸=i Dij (the “+” denotes
“leave-own-out” summation over the replaced index). The row (or column) sums of the
adjacency matrix, denoted by the N × 1 vector D+ = (D1+ , . . . , DN + )′ , give the network’s
degree sequence.
The econometrician also observes Xi , a vector of agent-level attributes. These agent-level
attributes are used to construct the K × 1 dyad-level vector Wij = g (Xi , Xj ). The function
g (·, ·) is symmetric in its arguments so that Wij = Wji . As an example if X1i and X2i
(
)1/2
are location coordinates, then Wij = (X1i − X1j )2 + (X2i − X2j )2
equals the distance
between i and j.
Agents i and j form a link if the total surplus from doing so is positive:
(
)
Dij = 1 Wij′ β0 + Ai + Aj − Uij ≥ 0 ,

(1)

where 1 (•) denotes the indicator function. Link surplus consists of three components:
1. a systematic component which varies with observed dyad attributes, Wij′ β0 (homophily),
2. a component which varies with the unobserved agent-level attributes {Ai }N
i=1 , (degree
heterogeneity) and
3. an idiosyncratic component, Uij = Uji , assumed independently and identically distributed across dyads.
Because links are undirected, the surplus function is specified to ensure that the linking rule
for Dij coincides with that for Dji . This requires, as noted above, that Wij = Wji , but also
that Ai and Aj enter (1) symmetrically. Finally, observe that any components of surplus
linear in Xi and Xj will be absorbed by the degree heterogeneity terms {Ai }N
i=1 .
Implicit in rule (1) is the presumption that utility is transferable across directly linked
agents; all links with positive net surplus form (Bloch and Jackson, 2007). Rule (1) re7

Connections may be equivalently referred to as links, ties, friendships, or edges depending on the context.

6

sults in a complete and coherent model of network formation. For a given draw of U =
(U12 , U13 , . . . , UN −1N )′ the network is uniquely determined.

Baseline assumptions
Let X be the N × dim (X) matrix of observed agent attributes and A0 the N × 1 vector
of unobserved agent-level degree heterogeneity terms. All of the results presented below
maintain the following three assumptions, with additional assumptions made for specific
results.
Assumption 1. (Likelihood) The conditional likelihood of the network D = d is
Pr ( D = d| X, A0 ) =

∏

Pr ( Dij = d| Xi , Xj , Ai0 , Aj0 )

i<j

with
[

1
)
( ′
Pr ( Dij = d| X, A0 ) =
1 + exp Wij β0 + Ai0 + Aj0

]1−d [

(
) ]d
exp Wij′ β0 + Ai0 + Aj0
)
(
1 + exp Wij′ β0 + Ai0 + Aj0

for all i ̸= j.
Assumption 1 implies that the idiosyncratic component of link surplus, Uij , is a standard
logistic random variable that is independently and identically distributed across dyads. The
logistic assumption is important for the tetrad logit (TL) estimator, but less so for the joint
maximum likelihood (JML) estimator (although my proof strategy does make use of the logit
structure extensively in both cases).
Assumption 1 also implies that links form independently conditional on X and A0 . Consider
the agents i, j and k. Conditional on these agents’ observed and unobserved characteristics,
respectively Xi , Xj , Xk and Ai , Aj , Ak , the events “i and j are connected”, “i and k are
connected” and “j and k are connected” are independent of one another.
Importantly independence is conditional on the latent agent attributes {Ai }N
i=1 . Unconditionally on these attributes, independence does not hold. For example, conditioning on
Xi , Xj , Xk , but not on Ai , Aj , Ak , observing that “i and j are connected” increases the ex
ante probability placed on the event “i and k are connected”. Dependence of this type is
generated by the presence of Ai in both the ij and ik linking rules. This type of dependence
is analogous to that allowed for by a strict exogeneity assumption in a single agent static
panel data model (e.g., Chamberlain, 1984).
7

The assumption that links form independently of one another conditional on agent attributes
will be plausible in some settings, but not in others. Specifically, rule (1) and Assumption 1
are appropriate for settings where the drivers of link formation are predominately bilateral in
nature, as may be true in some types of friendship and trade networks as well as in models
of (some types of) conflict between nation-states (e.g., Santos Silva and Tenreyro, 2006;
Fafchamps and Gubert, 2007; Lai and Reiter, 2000). In such settings, as outlined below,
the inclusion of unobserved agent attributes in the link formation model is a significant, and
useful, generalization relative to many commonly-used models.
In other settings, however, link decisions may have strong strategic aspects. For example,
Apple may prefer that its supply-chain not overlap with Samsung’s (in order to protect
manufacturing know-how). In such settings the events “firm A supplies Samsung” and “firm A
supplies Apple” will not be independent. With strategic interaction, the presence or absence
of a link in one part of the network may structurally influence the returns to link formation in
other parts of the network. Such interdependencies generate interesting challenges that are
not addressed here. The surveys by Graham (2015) and de Paula (2016) provide additional
discussion as well as references.
The approach taken here is to study identification and estimation issues when links form
according to rule (1) and Assumption 1. This setting both covers a useful class of empirical
examples, and represents a natural starting point for formal econometric analysis. An analogy with single agent discrete choice panel data models is perhaps useful. In that setting
early methodological work focused on introducing unobserved correlated heterogeneity into
static models of choice (e.g., Chamberlain, 1980; Manski, 1987). Later work subsequently
incorporated a role for state dependence in choice (e.g., Chamberlain, 1985; Honoré and
Kyriazidou, 2000). Section 3 sketches some extensions of the framework developed here to
incorporate certain types of interdependencies in link formation.
Assumption 2. (Compact Support)
(i) β0 ∈ int (B), with B a compact subset of RK .
(ii) the support of Wij is W, a compact subset of RK .
Part (i) of Assumption 2 is standard in the context of nonlinear estimation problems. Together with part (ii) it implies that the observed component of link surplus, Wij′ β0 will have
bounded support. This simplifies the proofs of the main Theorems, especially those of the
JML estimator, as will be explained below. For the tetrad logit estimator part (ii) could be
relaxed by assuming, instead, that Wij has a suﬃcient number of bounded moments.
Assumption 3. (Random Sampling) Let i = 1, . . . , N index a random sample of agents
8

from a population satisfying Assumptions 1 and 2. The econometrician observes (Dij , Wij )
for i = 1, . . . , N , j < i (i.e., for all sampled dyads).
Network data can be diﬃcult and expensive to collect, consequently many analyses in the
social sciences are based on incomplete graphs (e.g., Banerjee et al., 2013). One implication
of Assumption 3 is that estimation and inference may be based upon only a subset of the
full network.8

2

Estimation

Tetrad logit (TL) estimation
The tetrad logit estimator is based on an identifying implication of the model defined by
(1) and Assumptions 1 through 3 that is invariant to {Ai0 }N
i=1 . To derive this implication
rewrite the conditional likelihood of the event D = d given (X, A0 ), as

Pr ( D = d| X, A0 ) =

∏

[

i<j

]1−dij
) ]dij [
(
exp Wij′ β0 + Tij′ A0
1
(
(
)
)
,
1 + exp Wij′ β0 + Tij′ A0
1 + exp Wij′ β0 + Tij′ A0

where Tij is an N × 1 vector with a one for its ith and j th elements and zeros elsewhere
such that Tij′ A0 = A0i + A0j . After some manipulation this likelihood can be put into the
exponential family form
(
)
(
)
Pr ( D = d| X, A0 ) = c (X; β0 , A0 ) exp S1 (d, X)′ β0 exp S2 (d)′ A0
where
S1 (d, X) =

N ∑
∑

(
dij Wij , S2 (d) =

d1+ · · ·

)′
dN +

(2)

.

i=1 j<i

Inspection of (2) indicates that D+ = (D1+ , . . . , DN + )′ , the network’s degree sequence, is a
suﬃcient statistic for A0 .
An important strand of network research takes the degree sequence as its primary object of
interest, since many other topological features of networks are fundamentally constrained by
it (e.g., Albert and Barabási, 2002).9 For example, Graham (2015) shows that the mean and
8

Shalizi and Rinaldo (2013) call this property “consistency under sampling”.
Faust (2007) develops this point empirically using a large database of social networks. Newman (2010)
refers to the degree distribution as one of the “...most fundamental of network properties...” (p. 243).
9

9

variance of a network’s degree sequence can be expressed as a function of its triad census
(i.e., the number of triads with no links, one link, two links and three links).10
Let Ds denote the set of all feasible network adjacency matrices with degree sequence D+ =
d+ :
Ds = {v : v ∈ D, S2 (v) = S2 (d)} .
N
Here D denotes the set of all 2( 2 ) undirected binary adjacency matrices. Solving for the
conditional probability of the observed network given its degree sequence yields

)
′
d
W
β
ij 0
j<i ij
(∑ ∑
),
Pr ( D = d| X, A0 , S2 (D) = S2 (d)) = ∑
N
′
exp
v
W
β
ij 0
v∈Ds
i=1
j<i ij
exp

(∑

N
i=1

∑

(3)

which does not depend on A0 .
The model defined by (1) and Assumptions 1 to 3 allows for arbitrary degree sequences and
hence can replicate many types of network structures. A loose intuition, implicit in the form
of the conditional likelihood (3), is that the heterogeneity parameters {A0i }N
i=1 tie down the
degree distribution of the network (i.e., how many ones/links are present in each row (or
column) of D). The precise location of each link within a given row/column is then driven
by variation in Wij′ β0 .
Even for small networks, consisting of say a few dozen agents, the set Ds will typically be far
too large to enumerate such that (3) cannot be exactly evaluated. Blitzstein and Diaconis
(2011) derive a method for sampling uniformly from Ds , which could be used to estimate
(3) via simulation. The analysis of the resulting simulated conditional maximum likelihood
estimate of β0 would be an interesting topic for future research. Here I instead form an
estimator based on the relative probability of diﬀerent types of subgraph configurations.
While this approach is unlikely to be as eﬃcient as one based directly on (3), it has the
advantage of yielding a criterion function that is easy to evaluate and maximize.
Figure 2 depicts two tetrad configurations. In the first (left) subgraph the ij and kl edges
are present, but the ik and jl ones are not. In the second (right) subgraph the opposite
configuration is observed. Edges il and jk, depicted as dashed lines in the figure, may
or may not be present. However, if they are present, they are assumed to be so in both
subgraphs. The two subgraphs, when the dashed edges are omitted, share identical degree
sequences of (1, 1, 1, 1)′ . Because a rewiring from the left-hand subgraph to the right-hand
subgraph leaves its degree sequence unchanged, the relative probability of observing one
10

Holland and Leinhardt (1976) develop this point more comprehensively in the context of directed networks or digraphs.

10

Figure 2: Edge Swaps and the Definition of Sij,kl

Notes: The figure depicts tetrad configurations consistent with the events Sij,kl = 1 (left) and
Sij,kl = −1 (right). Solid lines denote required edges, dashed lines denote edges, the presence or
absence of which, do not aﬀect the value of Sij,kl . However, if they are present, they are assumed
to be so in both subgraphs.

subgraph or the other – conditional on observing one of them – will not depend on A0 . The
tetrad logit estimator is constructed from this implication.
To be precise, let Sij,kl = 1 if we observe the edges ij and kl, but not ik and jl, −1 if we
observe the opposite, and zero otherwise (see Figure 2). We can construct Sij,kl from the
adjacency matrix as
Sij,kl = Dij Dkl (1 − Dik ) (1 − Djl ) − (1 − Dij ) (1 − Dkl ) Dik Djl .

(4)

Since subgraph configurations with Sij,kl = 1 and Sij,kl = −1 share the same (subgraph)
degree sequence, the conditional probability
(
Pr ( Sij,kl = 1| X, A0 , Sij,kl ∈ {−1, 1}) =

exp

′
W̃ij,kl
β0

)

(
),
′
1 + exp W̃ij,kl
β0

(5)

with W̃ij,kl = Wij + Wkl − (Wik + Wjl ), does not depend on Ai0 , Aj0 , Ak0 or Al0 . The
form of (5) accords with the heuristic intuition given above. The contribution of unobserved
heterogeneity to total net surplus is the same for the two subgraphs shown in Figure 2,
hence the (conditional) frequency with which each is observed depends only on the amount
′
of “observable” surplus associated with each. If W̃ij,kl
β0 > 0, then the observable surplus
associated with configuration one (Sij,kl = 1) exceeds that associated with configuration two
(Sij,kl = −1):
(Wij + Wkl )′ β0 > (Wik + Wjl )′ β0 ,

11

and hence the left-hand configuration in Figure 2 is observed more frequently than the righthand one.
The index in (5) takes an “increasing diﬀerence” form, highlighting the close connection
between homophily in matching and structural complementarity in preferences (cf., Fox,
2010; Graham, 2011).
The conditional log-likelihood associated with configuration Sij,kl is
{
[
(
)]}
′
′
lij,kl (β0 ) = |Sij,kl | Sij,kl W̃ij,kl β0 − ln 1 + exp Sij,kl W̃ij,kl β0
.

(6)

Object (6) is not invariant to permutations of its indices. To impose symmetry I sum lij,kl (β)
across all possible permutations of its indices, yielding
gijkl (β) =

1 ∑
lπ π ,π π (β) ,
4! π∈Π 1 2 3 4

(7)

4

with Π4 the group of all 4! = 24 permutations of a 4 element vector. The kernel gijkl (β)
is symmetric in its arguments. Averaging across permutations to induce index symmetry is
common in the literature on U-Statistics (e.g., Ferguson, 2005).
( )
The tetrad logit criterion function consists of a summation of contributions (7) over all N4
distinct tetrads in the network. That is β̂TL maximizes
( )−1 ∑
N
gijkl (β) .
LN (β) =
4
i<j<k<l

(8)

This estimate satisfies the first order condition
(

∇β LN β̂TL

)

( )−1 ∑
(
)
N
=
sijkl β̂TL = 0,
4
i<j<k<l

(9)

def

where sijkl (β) = ∇β gijkl (β).

The anatomy of the tetrad logit criterion function
A tetrad can be wired in up to 26 = 64 diﬀerent ways. Each of these wirings belong to one
of the 11 isomorphism classes shown in Figure 3. Forty six of the 64 possible wirings, falling
into 8 of the 11 isomorphism classes, are completely determined by their (subgraph) degree
sequence. Four example, there are four isomorphisms of the three star configuration ( )
each with a degree sequence equal to (a permutation of) (3, 1, 1, 1)′ .
12

The remaining 18 possible wirings share their degree sequence with at least one other wiring.
These wirings fall into either the two edge ( ), four path ( ), or four cycle ( ) isomorphism classes. All three two edge isomorphisms share the degree sequence (1, 1, 1, 1)′ . There
are a total of 12 diﬀerent four path isomorphisms. For each of the six unique permutations of
the degree sequence (2, 2, 1, 1)′ there are two feasible wirings, for 12 wirings in total. Finally,
there are three isomorphisms of the four cycle configuration, all with a degree sequence of
(2, 2, 2, 2)′ . The tetrad {i, j, k, l} only makes a non-zero contribution to the tetrad logit criterion function (8) if it is wired in one of the 18 ways associated with a non-unique degree
sequence. These are the only tetrads which can be used to identify β0 , since all other tetrads
have no variation in structure conditional on their degree sequence.
Although there are 24 possible permutations of the index set {i, j, k, l}, it is straightforward,
although tedious, to verify that the summand in the tetrad kernel gijkl (β) takes, at most,
three diﬀerent values. This follows since, for example, lij,kl (β) = lik,jl (β) = lji,lk (β) =
ljl,ik (β) = lkl,ij (β) = lki,lj (β) = llk,ji (β) = llj,ki (β). This gives the simplified kernel
gijkl (β) =

1
[lij,kl (β) + lij,lk (β) + lik,lj (β)]
3

(10)

for lij,kl (β) as defined in (6). If {i, j, k, l} belongs to either the two edge ( ), four path ( ),
or four cycle ( ) isomorphism class, then at least one component of (10) will be non-zero
and hence the tetrad will make a non-trivial contribution to the tetrad logit estimate.

Large sample properties of β̂TL
As asserted in the introduction, one attractive feature of β̂TL is that it remains consistent and
asymptotically normal under sequences of networks that are sparse in the limit. Developing
this claim requires additional notation. For a network of size N , the marginal probability of
a randomly sampled dyad linking is given by
ρN = Pr (Dij = 1) = E [Pr ( Dij = 1| X, AN 0 )] .
Indexing this probability by N accommodates sequences of degree heterogeneity {Ai }N
i=1
which induce networks with varying degrees of sparsity in the limit. This notation presupposes that the probability distribution of the data may depend on N . It what follows I assume
that this dependence reflects a possible relationship between the distribution of the degree
heterogeneity and network size (although similar results would hold under more complex
sequences of DGPs). For example the distribution of Ai may be such that inf Ai → −∞
1≤i≤N

13

Figure 3: Tetrad isomorphisms

Notes: The gijkl (β) kernel function entering the tetrad logit criterion function (8) is only nonzero when {i, j, k, l} belongs to either the two edge ( ), four path ( ), or four cycle ( )
isomorphism class. All 18 subgraphs with non-unique degree sequences are isomorphic to one of
these three configurations. If {i, j, k, l} belongs to any of the other 8 isomorphism classes depicted
above it will not contribute to (8). The degree sequences associated with non-unique subgraphs are
(1, 1, 1, 1)′ , (2, 2, 2, 2)′ , (2, 2, 1, 1)′ , (2, 1, 2, 1)′ , (2, 1, 1, 2)′ , (1, 2, 2, 1)′ , (1, 2, 1, 2)′ and (1, 1, 2, 2)′ . The
first two are associated with three possible wirings each and the remainder with two wirings each.

as N → ∞, inducing greater sparsity in links as the graph grows in size. The speed at which
ρN approaches zero is restricted below, and also aﬀects the rate of convergence of β̂TL .
Next define
{
Tijkl =

1, Sij,kl ∈ {−1, 1} ∨ Sij,lk ∈ {−1, 1} ∨ Sik,lj ∈ {−1, 1}
,
0, otherwise

which equals 1 when the tetrad {i, j, k, l} makes a non-zero contribution to the tetrad logit
criterion function and zero otherwise. Let
αq,N = Pr (Ti1 i2 i3 i4 = 1, Tj1 j2 j3 j4 = 1)

(11)

be the probability that tetrads {i1 , i2 , i3 , i4 } and {j1 , j2 , j3 , j4 } both take an identifying configuration when they share q = 0, 1, 2, 3 or 4 agents in common. The properties of αq,N as
N → ∞ feature in the asymptotic analysis.
The probability that a randomly chosen tetrad contributes to (8) equals α4,N . Consistency
( )
of β̂TL therefore requires that N4 α4,N → ∞ as N → ∞, ensuring that the number of non14

trivial terms entering the criterion function grows large (cf., Chamberlain, 1980, pp. 229
- 230). Under sequences of networks where ρN tends toward zero, the probability that a
tetrad contributes to (8) is of order ρ2N , since any contributing tetrad must contain at least
two edges (see Figures 2 and 3). Letting
λN = (N − 1) ρN

(12)

( )
denote average degree we have that N4 α4,N = O (N 2 λ2N ); consistency of β̂TL for β0 therefore
requires that N λN → ∞ as N grows large. This condition holds even in the sparse graph case
where λN = O (1) . For technical reasons, I also assume that λN = Ω (1) (i.e., λN ≥ λ0 > 0
for large enough N ). Assuming that average degree is bounded from below by a positive
constant implies that the network is not empty in the limit.
An explicit (
identification
condition is also needed: the (normalized) Hessian matrix of (8),
)
−1
α4,N
∇ββ LN β̂TL must converge to a finite non-singular matrix.
Assumption 4. (Conditional Fixed Effects Identification)
(i) N λN → ∞ as N → ∞,
(ii) λN = Ω (1),
−1
(iii) Γ0 = lim α4,N
∇ββ LN (β0 ) is a finite non-singular matrix.
N →∞

Part (i) of Assumption 4, which ensures the number of identifying tetrads grows with the
order of the network, accommodates degree heterogeneity sequences that induce both sparse,
λN = O (1) , and dense λN = O (N ) , limiting networks. The rate of convergence of β̂TL to β0
varies across these two regimes, as detailed further below. Part (ii), as noted above, ensures
that the network is non-empty in the limit. To better understand part (iii) of Assumption
4, observe that the scaled Hessian matrix consists of three terms, each of the form
( )−1 ∑
)(
(
))
(
N
1
′
|Sij,kl | qij,kl β̂TL 1 − qij,kl β̂TL W̃ij,kl W̃ij,kl
3α4,N 4
i<j<k<l

(13)

for the three non-redundant index permutations appearing in (10) above,
[

(

qij,kl (β) = 1 + exp

′
−W̃ij,kl
β

)]−1

p

and qij,kl = qij,kl (β0 ). If we apply iterated expectations to (13) and assume that β̂TL → β0
and the distribution of W̃ij,kl given Sij,kl = {−1, 1} tends to some limit, we get
[
]
′
Γ0 = E qij,kl (1 − qij,kl ) W̃ij,kl W̃ij,kl
Sij,kl = {−1, 1} Pr ( Sij,kl = {−1, 1}| Tijkl = 1)
15

which
[ suggests the more familiar
] requirement for identification in binary choice models that
′
E W̃ij,kl W̃ij,kl
Sij,kl = {−1, 1} is a finite non-singular matrix (e.g., Amemiya, 1985, p. 270).
Here expectations are with respect to the limiting conditional distribution of W̃ij,kl given
Sij,kl = {−1, 1} .
Assumptions 1 through 4 are suﬃcient to prove consistency. They also suﬃce for showing
asymptotic normality, however the argument is more involved. The key challenge in demonstrating normality involves characterizing the sampling properties of the score vector (9).
Let UN equal (9) evaluated at β0 . I begin with the observation that UN , while not formally
a U-Statistic, shares many similarities with one. This suggests a three step approach to
demonstrating asymptotic normality. While these steps parallel textbook demonstrations
of asymptotic normality of U-Statistics, additional complications arise at each stage due
to the more complex structure of dependence across the summand in (9) and because UN
exhibits degeneracy of order 1. First I calculate the√variance of UN using Hoeﬀding (1948)
−1
type arguments. Second I show that the statistic nα2,N
UN is asymptotically equivalent
to a Hajek-type projection. The projection takes the form of a summation across dyads
not agents. Consequently it does not consist of independent components. It does have a
special conditional independence structure which I exploit to verify that it, appropriated
studentized, obeys a CLT.
To state Theorem 1 I need two more pieces of notation. First, define the projection
def

s̄ij (β) = E [sijkl (β)| Xi , Xj , Ai , Aj , Uij ] .
Second, I require an index notation for dyads. Recall that i = 1, 2, . . . indexes the N
( )
sampled agents. Let the boldface indices i = 1, 2, . . . index the n = N2 dyads among them
(in arbitrary order). In an abuse of notation, also let i denote the set {i1 , i2 }, where i1 and
i2 are the indices for the two agents which comprise dyad i. Using this notation we have, for
example, Di = Di1 i2 .
Theorem 1. (Large Sample Properties of β̂TL ) Under Assumptions 1, 2, 3 and 4:
p
(i) β̂TL → β0
√
c′ (β̂TL −β0 ) D
α4,N nα−1
√ 2,N
→ N (0, 36)
(ii)
−1
˜
c′ Γ−1
0 ∆ N Γ0 c
˜ N = 1 ∑n ∆
˜ i = α−1 E [ s̄i s̄′ | Xi1 , Xi2 , Ai1 , Ai2 ].
˜ i , and ∆
for any K×1 vector of real constants c, ∆
i
2,N
i=1
n
Proof. See Appendix A.
Theorem 1 follows from the asymptotically linear representation (see equation (35) of Ap-

16

pendix A):
√

(

[

)

1
−1
nα2,N
α4,N β̂TL − β0 = −6Γ−1
√
0
nα2,N

N
∑

]
(14)

s̄ij (β0 ) + op (1) .

i<j

The components of the sum in (14) are not independent of one another, however they are
conditionally independent of each other given X and A. This conditional independence
structure is used to show asymptotic normality by adapting an argument used by Chatterjee
(2006) to prove his Theorem 1.1 (which is stated in a form which is not directly applicable
here).11
A somewhat more evocative, albeit heuristic, way of presenting the result follows by defining
[
]
Ωq = E si1 i2 i3 i4 (β0 ) sj1 j2 j3 j4 (β0 )′ Ti1 i2 i3 i4 = 1, Tj1 j2 j3 j4 = 1
to equal the conditional covariance of the score summands si1 i2 i3 i4 (β0 ) and sj1 j2 j 3 j4 (β0 ) when
the 4-tuples {i1 , i2 , i3 , i4 } and {j1 , j2 , j3 , j4 } have q = 0, 1, 2, 3, 4 indices in common and both
˜ N = Ω2 I get
tetrads take an identifying configuration. If lim ∆
N →∞

√

(
)
(
)
D
−1
−1
nα2,N
.
α4,N β̂TL − β0 → N 0, 36Γ−1
0 Ω2 Γ0

In Appendix A I show that the probability that any two tetrads, sharing two agents in
common, both take an identifying configuration, α2,N , is of order ρ3N . The probability that
a random
identifying configuration, α4,N , is of order ρ2N . These two results
√ tetrad takes an
√
√ −3/2 4/2
√
−1
give nα2,N
α4,N = O( nρN ρN ) = O( nρN ) = O( N λN ) from which a Corollary to
Theorem 1 follows.
˜N =
Corollary 1. (Rate of Convergence) Under Assumptions 1, 2, 3 and 4, if lim ∆
N →∞

p

Ω2 , then β̂TL → β0 at rate
(i) Dense case: n−1/2 if ρN → ρ0 > 0 as N → ∞;
(ii) Sparse Case: n−1/4 if λN = (N − 1) ρN → λ0 > 0 as N → ∞.

Under dense graph sequences β̂TL convergences at the usual parametric rate (Recall that
√(the)
(N )
√
N
likelihood consists of n = 2 conditionally independent components and hence n =
2
is the usual rate). When average density tends toward zero as the graph grows large, the
rate of convergence slows. In the sparse case, corresponding to a bounded average degree in
11

Jochmans (2016b), in an extension of the results presented here to directed networks, uses a CLT due
to Rao (2009).

17

the limit, the rate of convergence is n−1/4 , which is considerably slower than the parametric
rate.12
Empirical implementation
From the vantage of an empirical researcher, estimation and inference proceed identically
in the sparse and dense cases. Specifically, β̂TL can be calculated using a conventional logit
estimation program:
( )
1. For all N4 sampled tetrads calculate Sπi πj ,πk πl and W̃πi πj ,πk πl for all three non-redundant
permutations of the agent-level indices entering kernel (10);
( )
2. Stack these three replicates on top of one another, generating a dataset with 3 N4 rows
and 1 + K columns;
3. Drop all rows with Sπi πj ,πk πl = 0;
(
)
4. Use the retained rows to compute the logit fit of 1 Sπi πj ,πk πl = 1 onto W̃πi πj ,πk πl . The
coeﬃcient on W̃πi πj ,πk πl equals β̂TL .
Inference can be based upon the approximation
approx

β̂TL ∼ N
where
Ĥ =

(N )−1

N
∑

4
i<j<k<l

(

)
36 −1 ˆ
−1
β0 , Ĥ ∆2,N Ĥ
,
n

)
(
∂ gijkl β̂TL
2

∂β∂β ′

) (
)′
1∑ (
ˆ
ˆ
ˆ
, ∆2,N =
s̄ij β̂TL s̄ij β̂TL
n i<j

∑
with s̄ˆij (β) = n−2(N1−1)+1 k<l,{i,j}∩{k,l}=⊘ sijkl (β). This is the covariance estimator used in
(
)
the Monte Carlo experiments. Note that n − 2 (N − 1) + 1 coincides with the N2−2 tetrads
that each dyad belongs to.
The actual computation of β̂TL is quite quick, even with medium-sized networks. However
the pre-processing of the network data described in steps 1 to 3 above can be computationally
expensive. For covariance matrix estimation, the Ĥ matrix can be recovered from the output
ˆ 2,N is more expensive. This is because
of a logit estimation program. The computation of ∆
for each of the n dyads an average of O (n) elements must be computed first (for a total of
O(N 4 ) operations in a naive brute force implementation).13
12

Olhede and Wolfe (2014, Theorem
√ 1) find that the mean integrated squared error of their network
histogram estimator decays at rate 1/ N λN .
13
The Python code used for the Monte Carlo results reported in the Supplemental Materials incorporates

18

Joint maximum likelihood (JML) estimation
Let AN denote an N × 1 vector of degree heterogeneity values and A0N the corresponding
vector of true values. The N subscript is used in this sub-section where it is helpful to
emphasize that the dimension of the incidental parameter vector grows with the sample size.
For what follows it is also convenient to define the notation
(
)
exp Wij′ β + Ai + Aj
def
(
).
pij (β, Ai , Aj ) =
1 + exp Wij′ β + Ai + Aj
The joint maximum likelihood estimator chooses β̂JML and ÂN simultaneously in order to
maximize the log-likelihood function
lN (β, AN ) =

∑

{Dij ln pij (β, Ai , Aj ) + (1 − Dij ) ln [1 − pij (β, Ai , Aj )]} .

(15)

i<j

Some insight in β̂JML is provided by outlining a method of computation. For this purpose it
is convenient to note that β̂JML also maximizes the concentrated likelihood
c
lN

(

N ∑
) ∑
(
)
[
(
)]
β, Â (β) =
Dij Wij′ β + Tij′ ÂN (β) − ln 1 + exp Wij′ β + Tij′ ÂN (β)
(16)
i=1 j<i

where ÂN (β) = arg max lN (β, A) .
A⊂RN

By adapting Theorem 1.5 of Chatterjee et al. (2011) I show that ÂN (β), when it exists, is
the unique solution to the fixed point problem
(
)
AˆN (β) = φ ÂN (β)
where


ln D1+ − ln r1 (β, A, W1 )

def 
..
,
φ (A) = 
.


ln DN + − ln rN (β, A, WN )

(17)



(18)

a number of computational speed-ups by keeping careful track of non-contributing tetrads as estimation
proceeds (hence calculations which are known to be zero are omitted). Nevertheless to use tetrad logit on
large graphs would require parallelization and/or approximation. Bhattacharya and Bickel (2015) introduce
ˆ 2,N based
a subsampling procedure for subgraph counts, which might be adapted to produce an estimate of ∆
on subsampling.

19

)′
(
with Wi = Wi1 , . . . , Wi(i−1) , Wi(i+1) , , WiN and
ri (β, A (β) , Wi ) =

∑
j̸=i

(

(
)
exp Wij′ β
(
).
exp (−Aj (β)) + exp Wij′ β + Ai (β)

)

That ÂN (β) = φ ÂN (β) can be directly verified by rearranging the sample score of (15).
That iteration using (17) converges to ÂN (β) = arg max lN (β, A) – when the solution
A∈AN

exists – is a direct implication of Lemma 4 in the Supplemental Materials.
The fixed point representation of ÂN (β) shows that, while the incidental parameters {Ai }N
( ) i=1
are agent-specific, their concentrated MLEs are jointly determined using all n = N2 dyad
observations. To see this observe that if we perturb Âi , then all values of Âj for i ̸= j
will change. This diﬀers from joint fixed eﬀects estimation in a nonlinear panel data model
without time eﬀects. In those models, conditional on the common parameter, the value of
Âi (β) is a function of only the T observations specific to unit i (e.g., Hahn and Newey, 2004;
Arellano and Hahn, 2007). The joint determination of the components of ÂN (β) is a direct
consequence of the multi-agent nature of the network formation problem and complicates
the asymptotic analysis of β̂JML .
To characterize the large sample properties of the JML estimates I require some additional
notation and an identification condition. It is useful to begin by observing that the population
problem is
max E [lN (b, aN )| X, A0N ] ,
b∈B,aN ∈AN

where it is easy to show that
E [lN (β, AN )| X, A0N ] = −

∑

DKL ( pij ∥ pij (β, Ai , Aj )) −

i<j

∑

S (pij ) ,

i<j
def

where DKL (pij ∥ pij (β, Ai , Aj )) is the Kullback-Leibler divergence of pij (β, Ai , Aj ) from pij =
pij (β0 , Ai0 , Aj0 ) and S (pij ) is the binary entropy function. It is clear that (β0 , A0N ) is a maximizer of the population criterion function. The following assumption ensures that it is the
unique maximizer (and also that this maximizer exists for large enough N ).
Assumption 5. (Joint FE Identification)
(i) For i = 1, 2, . . . the support of Ai0 is A, a compact subset of R.
(ii) E [lN (b, aN )| X, A0N ] is uniquely maximized at b = β0 and aN = A0N for large enough
N.

20

Part (i) of the assumption implies, in combination with Assumption 2, that
pij (β, Ai , Aj ) ∈ (κ, 1 − κ)

(19)

for some 0 < κ < 1 and for all (Ai , Aj ) ∈ A × A and β ∈ B. Condition (19) implies that in
large networks the number of observed links per agent will be proportional to the number of
sampled agents. Put diﬀerently it implies a dense sequence of graphs. It might be possible
to relax part (i) to accommodate sequences of {A0i }N
i=1 that diverge at some (slow enough)
rate (e.g., sup |A0i | = O (log log N )), but the structure of the proofs of Theorems 2, 3 and
1≤i≤N

4 suggest that any feasible sequence will still result in a non-sparse graph (i.e., agents will
have a large number of links in the limit).14 This contrasts sharply with the tetrad logit
estimator, where consistency under sparse graph sequences was established.
Part (ii) of Assumption 5 is an identification condition. It will generally hold if there is
(
)′
suﬃcient variance in each column of Wi = Wi1 , . . . , Wi(i−1) , Wi(i+1) , , WiN .
The first theorem establishes consistency of β̂JML .
Theorem 2. Under Assumptions 1, 2, 3 and 5
p

β̂JML → β0 .
Proof. See the Supplemental Materials.
A simple intuition for Theorem 2 is as follows. Rearranging the likelihood yields
(

)
pij (β, Ai , Aj )
lN (β, AN ) =
(Dij − pij ) ln
1 − pij (β, Ai , Aj )
i<j
∑
∑
−
DKL ( pij ∥ pij (β, Ai , Aj )) −
S (pij )
∑

i<j

(20)

i<j

(

pij (β,Ai ,Aj )
1−pij (β,Ai ,Aj )

)

An implication of (19) is that (Dij − pij ) ln
is a bounded random variable.
This fact and Hoeﬀding’s (1963) inequality can be used to show that the first component of
n−1 lN (β, A) is op (1) uniformly in β ∈ B and AN ∈ AN . The last term in (20) is constant
in β. In large samples a maximizer of lN (β, A) will therefore be close to a minimizer of the
sum of the n Kullback-Leibler measures of divergence of pij (β, Ai , Aj ) from pij across all
dyads. From part (ii) of Assumption 5 this minimizer is unique.15
14

In a recent working paper, Yan et al. (2016) explore such an extension for a directed network analog of
the model studied here.
15
The argument is close to that of a standard M-estimator consistency proof (e.g., Amemiya 1985, pp.

21

A more involved argument shows that it is possible to estimates the elements of A0N with
uniform accuracy.
Theorem 3. With probability 1 − O (N −2 )
(√
sup Âi − Ai0 < O
1≤i≤N

ln N
N

)
.

Proof. See the Supplemental Materials.
Chatterjee et al. (2011) show uniform consistency of Âi in the model with no dyad-level
covariates. Theorem 3 follows from a combination of Theorem 2 above and an adaptation
of their results. It is also closely related to Simons and Yao’s (1999) analysis of the BradleyTerry model of paired comparisons.
The key intuition is as follows. Under dense graph sequences we eﬀectively observe N − 1
linking decisions per agent. That is we observe whether agent i links with j for all j ̸= i.
This feature of the problem allows for consistent estimation of Ai0 for each agent. The
argument is complicated by the fact that agents i′ s and agent j ′ s sequences of link decisions
are dependent. However this dependence is weak, only arising via the presence of Dij in
both link sequences.16
Establishing asymptotic normality of β̂JML is also involved. This is because the sampling
properties of β̂JML are influenced by the estimation error in ÂN . This influence generates
bias in the limit distribution of β̂JML . This bias is similar to that which arises in largeN, large-T joint fixed eﬀects estimation of nonlinear panel data models (Hahn and Newey,
2004; Arellano and Hahn, 2007). An additional challenge here, not present in the panel data
problem, is to characterize the probability limit of the (suitably normalized) Hessian matrix
of the concentrated log-likelihood. This matrix depends on the inverse of the N × N block
of the full likelihood’s Hessian associated with the incidental parameters. This sub-matrix,
unlike in the corresponding panel data problem, is not diagonal due to the weak dependence
across diﬀerent agents’ link sequences. The inverse of this sub-matrix is not available in
closed form and hence must be approximated.17
N

106 - 107). The presence of the incidental parameters {Ai }i=1 complicates the argument. This handled by
“concentrating them out” of the problem.
16
Lemma 6 in the Supplemental Materials additionally establishes asymptotic normality of any sub-vector
of Â of fixed length:
(
(
))
)
√ (
1
1
D
N Â − A
→ N 0, diag
,...,
.
E [p1j (1 − p1j )]
E [pLj (1 − pLj )]
1:L
17

In the proof I use some matrix approximation results originally developed in the context of the Bradley-

22

To state the form of the limit distribution define
(
)
2 c
∂
l
β
,
Â
(β
)
0
0
( )−1 N
I0 (β) = lim − N2
,
N →∞
∂β∂β ′
and also

1 ∑
B0 = − lim √
N →∞ 2 n
i=1
N

1
N −1

∑

j̸=i pij (1 − pij ) (1 − 2pij ) Wij
∑
.
1
j̸=i pij (1 − pij )
N −1

(21)

(22)

Theorem 4. Under Assumptions 1, 2, 3 and 518
I −1 (β)B
(i) β̂JML = β0 + 0 √n 0 + op (1)
√ ′
nc (β̂JML −β0 )−c′ I0−1 (β)B0 D
(ii) ′ −1
1/2 → N (0, 1) ,
(c I0 (β)IN (β)I0−1 (β)c)
or any K × 1 vector of real constants c and IN (β) as defined in the Supplemental Materials.
Proof. See the Supplemental Materials.
Empirical implementation
Computation of β̂JML is possible by computing the logit fit of Dij onto Wij and Tij . The
dimension of the latter vector is N , and hence the concentration approach outlined above
will be more reliable in practice. For small and/or sparse networks β̂JML may not exist.
p
Inference, noting that IN (β) → I0 (β), may be based on the approximation
β̂JML

(
)
I0−1 (β) B0 I0−1 (β)
√
∼ N β0 +
,
.
n
n

approx

Hence the standard errors reported by a conventional logit command will be valid (alternatively a sandwich estimator may be used).
Although conventional logit standard errors will be valid, confidence intervals computed using
them with not be, due to the bias in the limit distribution. Consequently, for inference it is
important to bias-correct β̂JML . There are many possible approaches to bias correction (cf.,
Hahn and Newey, 2004; Fernández-Val and Weidner, 2016). I use the iterated bias correction
procedure outlined in Hahn and Newey (2004) in the Monte Carlo experiments summarized
in the Supplemental Materials. In this procedure β̂JML is used to replace β0 in the sample
Terry model for paired comparisons (cf., Simons and Yao, 1998). Fernández-Val and Weidner (2016) encounter a related problem in their extension of Hahn and Newey (2004) to include time eﬀects.
18
To relate Theorem 4 to analogous results from the large-N, large-T non-linear panel data literature
observe that for each agent we observe √
N − 1 linking decisions; corresponding to “T ” in the panel data case.
The bias term is thus O (1/N ) = O (1/ n) , analogous to the O (1/T ) bias term in the panel data case (e.g.,
Hahn and Newey (2004)).

23

analogs of (21) and (22), yielding Î1 and B̂1 . Next compute β̂BC,1 as β̂BC,1 = β̂JML −
Î −1 B̂

Î1−1 B̂1
√
.
n

Plug this estimate of β0 back into (21) and (22) and compute β̂BC,2 = β̂BC,1 − 2√n 2 . Repeat
)
√ (
def
until β̂BC,b = β̂BC,b+1 = β̂BC . In principle the limiting variance of n β̂BC − β0 need not
coincide with the one given in Theorem 4, although the results of Hahn and Newey (2004)
and others suggest it should.

3

Areas for further work

As noted in the introduction, one limitation of the model studied here is that it excludes
interdependencies in link preferences. This omission raises two natural questions. First, can
one construct a test for the assumption of no interdependencies in link formation? Second,
can one augment the model to include such interdependencies?
Consider the testing problem first. A natural way to include interdependencies in preferences
is to posit that links form according to
( (
Dij = 1 δ0

N
∑

)
Dik Djk

)
+

Wij′ β0

+ Ai + Aj − Uijt ≥ 0

(23)

k=1

so that an ij link is more likely if i and j share many friends in common. Transitivity in link
structure is predicted by many models of strategic network formation (see Graham (2015) and
de Paula (2016) for discussion and references). Link rule (23) results in an incomplete model
of network formation: for a given draw of U there will generally be multiple equilibrium
network configurations consistent with (23) (cf., Tamer, 2003). However, under the null of
δ0 = 0 the model coincides with the one analyzed here, which suggests a Score/LM test
for neglected transitivity (cf., Hahn et al., 2016). The TL estimator may be especially
convenient for this purposes, since its “score” vector does not depend on {Ai }N
i=1 . The study
of this approach to specification testing (and other approaches) would be an interesting topic
for future research. Dzemski (2014) develops a diﬀerent approach to testing for neglected
transitivity.
Turning to the second question, if the econometrician observes a network for two periods,
then the incorporation of interdependencies in link formation, albeit of a particular kind, is
possible. Assume that individuals i and j form a period t link, for i = 1, . . . , N and j < i,
according to the rule, for example,
(
Dijt = 1 γDijt−1 + δ

N
∑

(

)′

)

∗
Dikt−1 Djkt−1 + Wijt
β ∗ + Ai + Aj − Uijt ≥ 0 ,

k=1

24

(24)

where Uijt is iid across pairs and over time as well as logistic. This model allows the probability of a period t ij link to depend on (i) whether i and j were linked in the prior period
and (ii) on the number of friends they shared in common in the prior period. It incorporates
both state-dependence and a taste for transitivity in links.
In the two period case (t = 0, 1), both the tetrad logit and joint maximum
likelihood esti(
( ∗ )′ ) ′
∑N
mates remain valid, with outcome Dij = Dij1 , regressor vector Wij = Dij0 , k=1 Dik0 Djk0 , Wij1
,
(
)
′
and coeﬃcient vector β = γ, δ, (β ∗ )′ (see Nadler (2015) for a closely related empirical illustration). This observation hinges critically on the way in which agent-level heterogeneity
is modeled. For example, the conditional estimator is based on within-agent variation in
a given network; over time contrasts are not used. If Ai + Aj were replaced with, say,
Aij = Bi + Bj + h (Ci , Cj ) for Bi and Ci agent-specific heterogeneity and h (•, •) symmetric
but otherwise arbitrary, then identification of β would need to rely on (over-time) withindyad variation and a variant of the initial condition problem that occurs in single agent
dynamic panel data analysis would arise. Graham (2013; 2016) studies models of this type.

A
A.1

Tetrad logit
Part 1: Consistency
p

To show that β̂TL → β0 I verify the conditions of Theorem 4.1.1 in Amemiya (1985, pp. 106 107) (see also Theorem 2.1 of Newey and McFadden (1994)). The main diﬃculty is finding a
normalization of the objective function that can accommodate sequences of data generating
processes where ρN → 0 as N → ∞ (cf., Newey and McFadden, 1994, p. 2123). Recall that
gijkl (β) = lij,kl (β) + lij,lk (β) + lik,lj (β) for lij,kl (β) as defined in (6). The expected value of
the tetrad logit criterion function, normalized by α4,N , therefore equals
[

]
LN (β)
1
E
=
α4,N
3 Pr (Tijkl = 1)
{Pr (Sij,kl ∈ {−1, 1}) E [lij,kl (β)| Sij,kl ∈ {−1, 1}]
+ Pr (Sij,lk ∈ {−1, 1}) E [ lij,lk (β)| Sij,lk ∈ {−1, 1}]
+ Pr (Sik,lj ∈ {−1, 1}) E [lik,lj (β)| Sik,lj ∈ {−1, 1}]}
By exchangeability each of the three terms to the right of the equality in the expression
above are equal to one another. We may therefore consider only the first without loss of

25

[
(
)]−1
′
generality. Recall that qij,kl (β) = 1 + exp −W̃ij,kl
β
, qij,kl = q (β0 ) and define
Q (β) = −E [DKL ( qij,kl ∥ qij,kl (β)) + S (qij,kl )| Sij,kl ∈ {−1, 1}] ,
where DKL ( qij,kl ∥ qij,kl (β)) is the Kullback-Leibler divergence of qij,kl (β) from qij,kl , S (qij,kl )
is the binary entropy function, and the expectation is with respect to the limiting conditional
distribution of W̃ij,kl given Sij,kl ∈ {−1, 1}. Using (6) and the equality
Pr ( Sij,kl = {−1, 1}| Tijkl = 1) =

Pr (Sij,kl = {−1, 1})
,
Pr (Tijkl = 1)

I get
[

]
LN (β)
lim E
= Q (β) Pr ( Sij,kl = {−1, 1}| Tijkl = 1)
N →∞
α4,N

(25)

Q (β) · O (1)
since Pr (Sij,kl ∈ {−1, 1}) and Pr (Tijkl = 1) are of the same order.
By the properties of the Kullback-Leibler divergence, β0 is a maximizer of Q (β) . Uniqueness
of this maximum follows from part (iii) of Assumption 4, which implies global concavity of
Q (β) in β. Consistency of β̂TL for β0 then follows if
p

−1
α4,N
LN (β) → Q (β) Pr ( Sij,kl = {−1, 1}| Tijkl = 1)

uniformly in β ∈ B.
To show uniform convergence I use a Hoeﬀding (1948) variance decomposition to calculate
V (LN (β)) =

4
(N )−2 ∑
(N )(4)(N −4)
4

4

q

4−q

ξq,N (β)

(26)

q=0

for ξq,N (β) = C (gi1 i2 i3 i4 (β) , gj1 j2 j 3 j4 (β)) when the 4-tuples {i1 , i2 , i3 , i4 } and {j1 , j2 , j3 , j4 }
have q = 0, 1, 2, 3, 4 indices in common. The first, q = 0, term in (26) is zero by Assumption
1, which implies that links form independently conditional on X and A. To determine the
order of the remaining terms in (26) I calculate the frequency with which both gi1 i2 i3 i4 (β)
and gj1 j2 j 3 j4 (β) are non-zero conditional on the event that they share q = 1, 2, 3, 4 indices
in common. Recall that, for {i1 , i2 , i3 , i4 } and {j1 , j2 , j3 , j4 } the index sets associated with
two tetrads, αq,N = Pr (Ti1 i2 i3 i4 = 1, Tj1 j2 j3 j4 = 1) equals the probability that both tetrads
contribute to the tetrad logit criterion function (8) (when they share q = 0, 1, 2, 3, 4 agents

26

Figure 4: Tetrad stitching with q = 1 agents in common

Notes: Depiction of the single non-isomorphic way to join two
tetrads, each with degree
sequences of (1, 1, 1, 1), such that they share exactly one agent in common. Edges in tetrad
{1, 2, 3, 4} are depicted with solid dark (Berkeley Blue) lines, while those in tetrad {1, 5, 6, 7}
are depicted by solid light (Lawrence colored) lines. Any such joining results in a subgraph
with four edges. Observe that a joining of a two edge ( ) and, say, a four path ( ),
such that they share one node in common, results in a subgraph with five edges. Similar
reasoning indicates that α1,N is of order ρ4N .
in common). To get the order of {αq,N }q=1,2,3,4 we need only consider the sparsest identifying
tetrad configuration: a two edge ( ), with degree sequence (1, 1, 1, 1). Figure 4 depicts the
single way, up to isomorphisms, that two
isomorphisms can be joined such that they share
a single agent in common. This join requires four edges so that ξ1,N (β) = O (α1,N ) = O (ρ4N ).
By reference to Figures 5 and 6, we further have that ξ2,N (β) = ξ3,N (β) = O (ρ3N ). Finally
both ξ4,N (β) and α4,N are O (ρ2N ). These facts give
(
V

LN (β)
α4,N

)

(
)
(
)
(
)
(
)
−2
−3
−4
= O N −1 + O ρ−1
+ O ρ−1
+ O ρ−2
N N
N N
N N
)
(
(
)
(
)
( )
1
1
1
1
+O
+O
+O
,
=O
N
N λN
N 2 λN
N 2 λ2N

with λN = (N − 1) ρN . This variance converges to zero as long as N λN → ∞ as N → ∞ as
−1
is asserted by part (i) of Assumption 4. We therefore have that α4,N
LN (β) convergences in
)
(
mean square to Q (β) at rate max N1 , N λ1 N . By concavity of LN (β) in β this convergence
is uniform in β ∈ B. Since conditions A, B and C of Theorem 4.1.1 in Amemiya (1985, pp.
106 - 107) hold, part (i) of the Theorem 1 follows.

27

Figure 5: Tetrad stitching with q = 2 agents in common

Notes: Depiction of the three non-isomorphic way to join two
tetrads, each with degree
sequences of (1, 1, 1, 1), such that they share exactly two agents in common. Edges shared
by both tetrads are depicted with dashed (Rose Garden colored) lines. Edges in tetrad
{1, 2, 3, 4} are depicted with solid dark (Berkeley Blue) lines, while those in tetrad {1, 2, 5, 6}
are depicted by solid light (Lawrence colored) lines. Moving from left-to-right, the first figure
shows a joining which requires only three edges in total, one shared by both tetrads. The
second and third joinings involve no shared edges and hence each require four edges in total.

A.2

Part II: Asymptotic normality

A Taylor expansion of the first order condition of the tetrad logit criterion function yields,
after re-arrangement and re-scaling,
√

)
(
[ −1
( )]+ √ −1
−1
∇ββ LN β̄
nα2,N
α4,N β̂TL − β0 = − α4,N
× nα2,N UN

with β̄ a mean value between β̂TL and β0 which may vary from row to row, the + superscript
denoting a Moore-Penrose inverse, and
UN

( )−1 ∑
N
sijkl (β0 ) = 0,
=
4
i<j<k<l

def

equal to the ‘score’ vector of the TL criterion function.
For what follows it is helpful to note, once again, that α0,N = O (ρ4N ), α1,N = O (ρ4N ),
α2,N = O (ρ3N ), α3,N = O (ρ3N ) and α4,N = O (ρ2N ) (see Figures 4, 5 and 6). To demonstrate
[ −1
( )]+ p −1
asymptotic normality I proceed by (a) showing that α4,N
∇ββ LN β̄
→ Γ0 for Γ0 defined
√
−1
)
in part (iii) of Assumption 4 of the main text, (b) verifying that UN (scaled by nα2,N
obeys a central limit theorem and (c) combining the (a) and (b) to show the final result.
( )
−1 N −1
Demonstrating part (a) requires, as in the proof of consistency, verifying that α4,N
is
4
the appropriate scaling of the Hessian matrix (allowing for sparse network sequences). An

28

Figure 6: Tetrad Stitching (q = 3)

Notes: Depiction of the single non-isomorphic way to join two
tetrads, each with degree
sequences of (1, 1, 1, 1), such that they share exactly three agents in common. Edges shared
by both tetrads are depicted with dashed (Rose Garden colored) lines. Edges in tetrad
{1, 2, 3, 4} are depicted with solid dark (Berkeley Blue) lines, while those in tetrad {1, 2, 3, 5}
are depicted by solid light (Lawrence colored) lines.
application of Lemma 2.9 of Newey and McFadden (1994, p. 2138) then gives
p

−1
sup α4,N
∇ββ LN (β) − Γ0 → 0.
β∈B

Finally, non-singularity of Γ0 and the continuous mapping theorem, yields the required result.
The approach to showing part (b) is as described in the main text immediately before the
statement of the Theorem.
Step 1, Hessian convergence
Calculation gives a Hessian matrix of
( )−1 ∑
N
1{
′
∇ββ LN (β) =
|Sij,kl | qij,kl (β) (1 − qij,kl (β)) W̃ij,kl W̃ij,kl
4
3
i<j<k<l
′
+ |Sij,lk | qij,lk (β) (1 − qij,lk (β)) W̃ij,lk W̃ij,lk
}
′
|Sik,lj | qik,lj (β) (1 − qik,lj (β)) W̃ik,lj W̃ik,lj
.

(27)

Next recall the definition of the L2,1 norm:

∥A∥2,1 =

[ m
n
∑
∑
j=1

i=1

29

]1/2
|aij |

2

.

(28)

Applying this norm to ∇ββ LN (β)−∇ββ LN (β∗ ), the mean value inequality, and compatibility
of the Fronbenius matrix norm with the Euclidean vector norm, gives
∥∇ββ LN (β) − ∇ββ LN (β∗ )∥2,1

{
( )}
∂ 2 LN β̄
∂
≤
∥β − β∗ ∥2
∂β ′
∂βp ∂β
p=1
F
(
)
K
−1
{
∑ N
∑ 1
′
≤
|Sij,kl | W̃ij,kl W̃ij,kl
W̃p,ij,kl
4
3
p=1
i<j<k<l
K
∑

′
′
+ |Sij,lk | W̃ij,lk W̃ij,lk
W̃p,ij,lk + |Sik,lj | W̃ik,lj W̃ik,lj
W̃p,ik,lj

}
F

× ∥β − β∗ ∥2 ,
with the second inequality following from the fact that
∂
∂β ′

{

∂ 2 lij,kl (β)
∂βp ∂β

}
′
= |Sij,kl | qij,kl (β) (1 − qij,kl (β)) (1 − 2qij,kl (β)) W̃ij,kl W̃ij,kl
W̃p,ij,kl ,

for p = 1, . . . , K and 0 ≤ |qij,kl (β) (1 − qij,kl (β)) (1 − 2qij,kl (β))| ≤ 1. Since the B and W are
( )−1 ∑
2
both compact subsets of RK (Assumption 2), and N4
i<j<k<l Tijkl = O (ρN ) = O (α4,N ),
we have, after re-scaling the Hessian,
−1
−1
α4,N
∇ββ LN (β) − α4,N
∇ββ LN (β∗ )

2,1

≤ O (1) ∥β − β∗ ∥2 .

(29)

Condition (29) allows for an application Lemma 2.9 of Newey and McFadden (1994, p. 2138).
Step 2a, Calculating the variance of UN
def

For sijkl = sijkl (β0 ) let
∆q,N = C (si1 i2 i3 i4 , sj1 j2 j 3 j4 )

(30)

equal the covariance of si1 i2 i3 i4 (β0 ) and sj1 j2 j 3 j4 (β0 ) when the 4-tuples {i1 , i2 , i3 , i4 } and
{j1 , j2 , j3 , j4 } have q = 0, 1, 2, 3, 4 indices in common. A Hoeﬀding (1948) variance decomposition gives
V (UN ) =

(N )−1 (4)(N −4)
4

2

4−2

∆2,N +

(N )−1 (4)(N −4)
4

3

4−3

∆3,N +

(N )−1 (4)(N −4)
4

4

4−4

∆4,N ,

(31)

where I use the fact that C (si1 i2 i3 i4 , sj1 j2 j3 j4 ) = 0 whenever the tetrads {i1 , i2 , i3 , i4 } and
{j1 , j2 , j3 , j4 } share zero or one agents in common (i.e., ∆0,N = ∆1,N = 0). That ∆1,N = 0
indicates that UN exhibits degeneracy of order 1. To understand this degeneracy consider

30

the ANOVA decomposition
C (si1 i2 i3 i4 , sj1 j2 j3 j4 ) = E [C ( si1 i2 i3 i4 , sj1 j2 j3 j4 | X, A)] + C (E [si1 i2 i3 i4 | X, A] , E [ sj1 j2 j3 ,i4 | X, A])
= E [C ( si1 i2 i3 i4 , sj1 j2 j3 j4 | X, A)]
with the second equality following from the conditional mean zero property of the score
function. Next observe that since edges form independently conditional on X and A, the
covariance to the right of the second equality will be zero unless the two tetrads share at
least one dyad in common (i.e., q ≥ 2).
Now consider the case where the two tetrads share two indices (i.e., a dyad) in common (i.e.,
∆2,N ). Recalling the discussion given in the consistency proof above, we have that ∆2,N is
O (αN,2 ) = O (ρ3N ). Proceeding analogously we have that ∆3,N = O (ρ3N ) and ∆4,N = O (ρ2N ).
Putting these calculations together we have that
V

(√

)
−1
nα2,N
UN

( )( )
( )( )
−1
−1 N N −1
−1 N N −1
∆4,N
≃ α2,N
36∆2,N + α2,N
16∆3,N + α2,N
2
3
2
4
( )
(
)
1
1
+O
= O (1) + O
N
N λN

(32)

The first term in (32) dominates if N λN → ∞ as N → ∞.
Step 2b, Projection:
Consider the link structure of two tetrads, {i, j, k, l} and {i, j, m, p}, sharing the dyad {i, j}
in common. By virtue of conditional independence of link decisions, and Assumption 3, the
configurations of {i, j, k, l} and {i, j, m, p} are independent conditional on Xi , Xj , Ai , Aj and
Uij giving
[
]
E sijkl (β0 ) sijmp (β0 )′ Xi , Xj , Ai , Aj , Uij = s̄ij (β0 ) s̄ij (β0 )′
def

for s̄ij (β0 ) = E [sijkl (β0 )| Xi , Xj , Ai , Aj , Uij ]. Iterated expectations then implies that, for
[
]
∆q,N as defined in (30) above, ∆2,N = E s̄ij (β0 ) s̄ij (β0 )′ . Projecting UN onto an arbitrary
function of (Xi , Xj , Ai , Aj , Uij ) then yields
( )−1
N
E [UN | Xi , Xj , Ai , Aj , Uij ] =
4
k

∑

E [sk1 k2 k3 k4 (β0 )| Xi , Xj , Ai , Aj , Uij ] .

(33)

1 <k2 <k3 <k3

The expectation in the summand of (33) is, by iterated expectations and conditionally
independent link formation, zero if {i, j} ⊈ {k1 , k2 , k3 , k4 } and equals s̄ij (β0 ) if {i, j} ⊆

31

{k1 , k2 , k3 , k4 }. Since dyad {i, j} appears in a total of

(N −2)
2

of the

(N )
4

tetrads we get that

( )−1
(N −2)
N
12
6
E [UN | Xi , Xj , Ai , Aj , Uij ] =
=
s̄ij (β0 ) = s̄ij (β0 ) .
2
4
N (N − 1)
n
Next observe that E [ s̄ij (β0 )| Xk , Xl , Ak , Al , Ukl ] = 0 for all {i, j} ̸= {k, l} (importantly this
mean independence result holds true even if {i, j} and {k, l} share one index in common).
In then follows that the Hajek Projection is (cf., van der Vaart, 2000, Lemma 11.10, p. 157)
UN∗ =

6∑
s̄ij (β0 ) .
n i<j

(34)

√
√
−1
−1
Asymptotic equivalence of nα2,N UN and nα2,N
UN∗ follows if
[
]
−1
−1
−1
−1
nα2,N
E (UN∗ − UN )2 = nα2,N
V (UN ) + nα2,N
V (UN∗ ) − 2nα2,N
C (UN , UN∗ )
is op (1). If N λN → ∞, then the first term to the right of the equality in the expression above
converges in probability to a constant since ∆2,N = O (α2,N ). Next observe that while the the
random variables {s̄ij (β0 )}i<j entering the sum in (34) are not independently and identically
distributed, they are uncorrelated. This is an implication of conditionally independent edge
−1
formation given X and A. This gives V (UN∗ ) = 36
∆2,N and hence that nα2,N
V (UN∗ ) has the
n
−1
same probability limit as nα2,N
V (UN ). All that remains is to evaluate the covariance term:
−1
−1
nα2,N
C (UN , UN∗ ) = nα2,N
E [UN UN∗ ]
−1
−1
= nα2,N
E [(UN − UN∗ ) UN∗ ] + nα2,N
E [UN∗ UN∗ ]
36
∆2,N ,
=
α2,N

[
]
−1
giving nα2,N
E (UN∗ − UN )2 → 0 as N → ∞.
Step 2c, CLT:
Putting the above results together we have that
√

(

−1
nα2,N
α4,N β̂TL − β0

)

[

( ) ]+ √
( )−1 ∑
2
∂
g
β̄
N
ijkl
−1
−1
= − α4,N
UN
× nα2,N
′
4
∂β∂β
i<j<k<l
[
]
N
∑
1
= −6Γ−1
s̄ij (β0 ) + op (1)
√
0
nα2,N i<j
32

(35)

∑
The main result follows if we can demonstrate asymptotic normality of √nα12,N N
i<j s̄2,ij .
This can be established by adapting an argument used by Chatterjee (2006) in the proof of
his Theorem 1.1.
( )
Recall that the boldface subscripts i = 1, 2, . . . index the n = N2 dyads in arbitrary or˜ i = α−1 E [ s̄i s̄′ | Xi1 , Xi2 , Ai1 , Ai2 ] denote the scaled conditional variance of the
der. Let ∆
i
2,N
projection s̄i = E [sijkl | Xi , Xj , Ai , Aj , Uij ]. Observe that, by independence of Uij and (X, A)
(Assumption 1) and random sampling (Assumption 3), we have that
˜ i = α−1 E [ s̄i s̄′i | Xi1 , Xi2 , Ai1 , Ai2 ] = α−1 E [ s̄i s̄′i | X, A] .
∆
2,N
2,N
˜ i is bounded away from zero for any fixed N (by Assumptions 2 and 4.iii).
Furthermore ∆
Next let c be a vector of real constants and define
( √
)
s̄i / α2,N
c′ Γ−1
0
Ri = √ −1
,
c′ Γ0 ∆N Γ−1
0 c

(36)

˜ i . By the conditional mean zero property of the score function we get
˜ N = 1 ∑n ∆
where ∆
i=1
n
˜ −1
c′ Γ−1
0 ∆ i Γ0 c
that E [Ri | X, A] = 0 and, by the arguments sketched above, that E [ Ri2 | X, A] = c′ Γ−1
˜ N Γ−1 c
∆
0
0
˜ N is a function of X and A). Let Y be a n × 1 random vector with in(observe that ∆
(
)
˜ −1
c′ Γ−1
0 ∆ i Γ0 c
dependent non-identically distributed normal components Yi ∼ N 0, c′ Γ−1
. Let
−1
˜
0 ∆ N Γ0 c
CM denote the class of functions f : R → R that are three times continuously diﬀerenr f (x)
< Lr (f ) < ∞ for r = 1, 2, 3. The proof proceeds by showing that
tiable with sup ∂ ∂x
r
[ ( ∑ x )]
[ ( ∑
)]
n
n
1
1
√
√
E f
→ E f
as N → ∞ for each f in the class CM . Since
i=1 Ri
i=1 Yi
n
n
∑
∑n
D
n
√1
√1
i=1 Yi ∼ N (0, 1) by construction, this implies that
i=1 Ri → N (0, 1) (e.g., Poln
n
lard, 2002, Lemma 16, p. 177).
To show this result I begin, as in Chatterjee (2006, p. 2065), by defining
Zi = (R1 , . . . , Ri , Yi+1 , . . . , Yn ) and Z0i =(R1 , . . . , Ri−1 , 0, Yi+1 , . . . , Yn ),

33

(
and observe that we can re-write the diﬀerence f
(
f

1 ∑
√
Ri
n i=1
n

)

(
−f

1 ∑
√
Yi
n i=1
n

(
A third-order Taylor expansion of f
(
f

)

√1 Z′ ι
n i

(

f

)
( ∑
)
n
√1
R
−
f
Y
as
i
i
i=1
i=1
n

∑n

[ i
])
n
∑
1 ∑
=
Rj +
f √
Yj
n
j=1
i=1
j=i+1
[ i−1
])
(
n
∑
1 ∑
Rj +
Yj
−f √
n j=1
j=i
)
(
)
(
n
∑
1 ′
1 ′
=
f √ Zi ι − f √ Zi−1 ι .
n
n
i=1
(

n
∑

(37)

)
about Ri = 0 gives

)
(
(
)
)
1 ′
1 ( 0 )′
1 ( 0 )′
1 ′
√ Zi ι − f √ Zi ι − √ f √ Zi ι Ri
n
n
n
n
(
)
1 ( 0 )′
|R3 | L3 (f )
1 1 ′′
√ Zi ι Ri2 ≤ i 3/2
− f
2n
6n
n

for i = 1, . . . , n. A second expansion of f
(

√1
n

(38)

)

√1 Z′ ι
n i−1

about Yi = 0 similarly gives

)
(
(
)
)
1 ′
1 ( 0 )′
1 ( 0 )′
1 ′
√ Zi−1 ι − f √ Zi ι − √ f √ Zi ι Yi
n
n
n
n
(
)
1 1 ′′
1 ( 0 )′
|Y 3 | L3 (f )
√ Zi ι Yi2 ≤ i 3/2
− f
2n
6n
n

(39)

also for for i = 1, . . . , n.
Since Ri is independent of Rj for i ̸= j conditional on X and A and the the Yi′ s are independent by construction we have that
[

(

1
E (Ri − Yi ) √ f ′
n

1 ( )′
√ Z0i ι
n

)]
= 0.

(40)

)]
1 ( 0 )′
√ Zi ι
=0
n

(41)

Similarly, we have that
E

[
(

Ri2

−

Yi2

) 1 ′′
f
n

(

Equations (38), (39), (40) and (41) imply
)]
[ (
)]
[ (
1 ′
E [|Ri3 | + |Yi3 |]
1 ′
≤
E f √ Zi ι − E f √ Zi−1 ι
L3 (f )
6n3/2
n
n

34

Summing over i = 1, . . . , n and using (37) we therefore have
[ (
E f

1 ∑
√
Ri
n i=1
n

)]
− E [f (Z)] ≤

1 M3
√ L3 (f )
6 n

[
]
with M3 = maxi E |Ri |3 (which is bounded by Assumption 2 and 4.iii; note also that
[
]
E |Yi |3 = 0 by normality) and Z a standard normal random variable.
Using this result, (35) and (36) I get
√
α4,N

(
)
−1 ′
nα2,N
c β̂TL − β0
√
˜ −1
c′ Γ−1
0 ∆N Γ0 c



(
)
√
N
′ −1
∑
c Γ0 s̄ij / α2,N
1
 + op (1)
√
= 6 √
n i<j
−1
−1
˜ N Γ0 c
c′ Γ0 ∆
[
]
n
1 ∑
Ri + op (1)
= 6 √
n i=1
D

→ N (0, 36)
as claimed.

References
Albert, R. and Barabási, A.-L. (2002). Statistical mechanics of complex networks. Review
of Modern Physics, 74(1):47 – 97.
Amemiya, T. (1985). Advanced Econometrics. Harvard University Press.
Andersen, E. B. (1973). Conditional inference for multiple-choice questionnaires. British
Journal of Mathematical and Statistical Psychology, 26(1):31 – 44.
Apicella, C. L., Marlowe, F. W., Fowler, J. H., and Christakis, N. A. (2012). Social networks
and cooperation in hunter-gatherers,. Nature, 481(7382):497 – 501.
Arellano, M. and Hahn, J. (2007). Advances in Economics and Econometrics: Theory and
Applications, volume 3, chapter Understanding bias in nonlinear panel models: some recent
developments, pages 381 – 309. Cambridge University Press., Cambridge.
Attanasio, O., Barr, A., Cardenas, J. C., Genicot, G., and Meghir, C. (2012). Risk pooling,
risk preferences, and social networks. American Economic Journal: Applied Economics,
4(2):134 – 167.

35

Bala, V. and Goyal, S. (2000). A noncooperative model of network formation. Econometrica,
68(5):1181 – 1229.
Banerjee, A., Chandrasekhar, A. G., Dulfo, E., and Jackson, M. O. (2013). The diﬀusion of
microfinance. Science, 341(6144):363 – 370.
Barabási, A.-L. and Albert, R. (1999). Emergence of scaling in random networks. Science,
286(5439):509 – 512.
Bhattacharya, S. and Bickel, P. J. (2015). Subsampling bootstrap of count features of
networks. Annals of Statistics, 43(6):2384 – 2411.
Billingsley, P. (1995). Probability and Measure. John Wiley & Sons, Inc., New York, 3rd
edition.
Blitzstein, J. and Diaconis, P. (2011). A sequential importance sampling algorithm for
generating random graphs with prescribed degrees. Internet Mathematics, 6(4):489 – 522.
Bloch, F. and Jackson, M. O. (2007). The formation of networks with transfers among
players. Journal of Economic Theory, 113(1):83 – 110.
Candelaria, L. E. (2016). A semiparametric network formation model with multiple linear
fixed eﬀects. Duke University.
Chamberlain, G. (1980). Analysis of covariance with qualitative data. Review of Economic
Studies, 47(1):225 – 238.
Chamberlain, G. (1984). Handbook of Econometrics, volume 2, chapter Panel Data, pages
1247 – 1318. North-Holland, Amsterdam.
Chamberlain, G. (1985). Longitudinal Analysis of Labor Market Data, chapter Heterogeneity,
omitted variable bias, and duration dependence, pages 3 – 38. Cambridge University Press,
Cambridge.
Chandrasekhar, A. G. and Jackson, M. O. (2015). A network formation model based on
subgraphs. Working paper, Stanford University.
Charbonneau, K. B. (2014). Multiple fixed eﬀects in binary response panel data models.
Technical Report Working Paper 2014-17, Bank of Canada.
Chatterjee, S. (2006). A generalization of the lindeberg principle. Annals of Probability,
34(6):2061 – 2076.
36

Chatterjee, S., Diaconis, P., and Sly, A. (2011). Random graphs with a given degree sequence.
Annals of Applied Probability, 21(4):1400 – 1435.
Christakis, N. A., Fowler, J. H., Imbens, G. W., and Kalyanaraman, K. (2010). An empirical
model for strategic network formation. NBER Working Paper 16039, National Bureau of
Economic Research.
Cox, D. R. (1958). The regression analysis of binary sequences. Journal of the Royal Statistical Society B, 20(2):215 – 242.
de Paula, Á. (2016). Econometrics of network models. Technical Report CeMMAP Working
Paper CWP06/16, CeMMAP.
de Paula, Á., Richards-Shubik, S., and Tamer, E. (2015). Identification of preferences in
network formation games. CeMMAP Working Paper CWP29/15, CeMMAP.
De Weerdt, J. (2004). Insurance Against Poverty, chapter Risk-sharing and endogenous
network formation, pages 197 – 216. Oxford University Press, Oxford.
Dzemski, A. (2014). An empirical model of dyadic link formation in a network with unobserved heterogeneity. University of Mannheim.
Fafchamps, M. and Gubert, F. (2007). Risk sharing and network formation. American
Economic Review, 97(2):75 – 79.
Faust, K. (2007). Very local structure in social networks. Sociological Methodology, 37(1):209
– 256.
Ferguson, T. S. (2005). U-statistics. University of California - Los Angeles.
Fernández-Val, I. and Weidner, M. (2016). Individual and time eﬀects in nonlinear panel
data models with large n, t. Journal of Econometrics, 192(1):291 – 312.
Fox, J. T. (2010). Identification in matching games. Quantitative Economics, 1(2):203 – 254.
Goldsmith-Pinkham, P. and Imbens, G. W. (2013). Social networks and the identification
of peer eﬀects. Journal of Business and Economic Statistics, 31(3):253 – 264.
Golub, B. and Jackson, M. O. (2012). How homophily aﬀects the speed of learning and
best-response dynamics. Quarterly Journal of Economics, 127(3):1287 – 1338.

37

Graham, B. S. (2011). Handbook of Social Economics, volume 1, chapter Econometric methods for the analysis of assignment problems in the presence of complementarity and social
spillovers, pages 965 – 1052. North-Holland, Amsterdam.
Graham, B. S. (2013). “comment on “social networks and the identification of peer eﬀects”
by paul goldsmith-pinkham and guido w. imbens. Journal of Business and Economic
Statistics, 31(3):266 – 270.
Graham, B. S. (2015). Methods of identification in social networks. Annual Review of
Economics, 7(1):465–485.
Graham, B. S. (2016). Homophily and transitivity in dynamic network formation. NBER
Working Paper 22186, National Bureau of Economic Research.
Hahn, J., Moon, H. R., and Snider, C. (2016). Lm test of neglected correlated random eﬀects
and its application. University of California - Los Angeles.
Hahn, J. and Newey, W. K. (2004). Jackknife and analytical bias reduction for nonlinear
panel data models. Econometrica, 72(4):1295 – 1319.
Hillar, C. J., Lin, S., and Wibisono, A. (2013). Inverses of symmetric, diagonally dominant
positive matrices and applications. Technical Report arXiv:1203.6812v2, University of
California - Berkeley.
Hoeﬀding, W. (1948). A class of statistics with asymptotically normal distribution. Annals
of Mathematical Statistics, 19(3):293 – 325.
Hoeﬀding, W. (1963). Probability inequalities for sums of bounded random variables. Journal
of the American Statistical Association, 58(301):13 – 30.
Holland, P. W. and Leinhardt, S. (1976). Local structure in social networks. Sociological
Methodology, 7:1 – 45.
Honoré, B. E. and Kyriazidou, E. (2000). Panel data discrete choice models with lagged
dependent variables. Econometrica, 68(4):839 – 874.
Honoré, B. E. and Powell, J. L. (1994). Pairwise diﬀerence estimators of censored and
truncated regression models. Journal of Econometrics, 64(1-2):241 – 278.
Horn, R. A. and Johnson, C. R. (2013). Matrix Analysis. Cambridge University Press,
Cambridge, 2nd edition.

38

Jackson, M. O. and López-Pintado, D. (2013). Diﬀusion and contagion in networks with
heterogeneous agents and homophily. Network Science, 1(1):49 – 67.
Jackson, M. O. and Rogers, B. W. (2007). Relating network structure to diﬀusion properties
through stochastic dominance. B.E. Journal of Theoretical Economics, 7(1):(Advances)
Article 6.
Jackson, M. O. and Watts, A. (2002). The evolution of social and economic networks. Journal
of Economic Theory, 106(2):265 – 295.
Jackson, M. O. and Wolinsky, A. (1996). A strategic model of social and economic networks.
Journal of Economic Theory, 71(1):44 – 74.
Jochmans, K. (2016a). Modified-likelihood estimation of fixed-eﬀect models for dyadic data.
Technical Report Working Paper 1, Sciences Po. Sciences Po.
Jochmans, K. (2016b). Semiparametric analysis of network formation. Technical Report
Working Paper 2, Sciences Po.
Krivitsky, P. N., Handcock, M. S., Raftery, A. E., and Hoﬀ, P. D. (2009). Representing degree
distributions, clustering, and homophily in social networks with latent cluster random
eﬀects models. Social Networks, 31(2):204 – 213.
Lai, B. and Reiter, D. (2000). Democracy, political similarity, and international alliances,
1816-1992. Journal of Conflict Resolution, 44(2):203 – 227.
Leung, M. (2015). A random-field approach to inference in large models of network formation.
Mimeo, Stanford University.
Manski, C. F. (1987). Semiparametric analysis of random eﬀects linear models from binary
panel data. Econometrica, 55(2):357 – 362.
McPherson, M., Smith-Lovin, L., and Cook, J. M. (2001). Birds of a feather: homophily in
social networks. Annual Review of Sociology, 27(1):415 – 444.
Mele, A. (2013). A structural model of segregation in social networks. John Hopkins University.
Menzel, K. (2016). Strategic network formation with many agents. New York University.
Miyauchi, Y. (2016). Structural estimation of a pairwise stable network with nonnegative
externality. Journal of Econometrics, 195(2):224 – 235.
39

Nadler, C. (2015). Networked inequality: evidence from freelancers. University of California
- Berkeley.
Newey, W. K. and McFadden, D. (1994). Handbook of Econometrics, volume 4, chapter Large
sample estimation and hypothesis testing, pages 2111 – 2245. North-Holland, Amsterdam.
Newman, M. E. J. (2010). Networks: An Introduction. Oxford University Press, Oxford.
Neyman, J. and Scott, E. L. (1948). Consistent estimates based on partially consistent
observations. Econometrica, 16(1):1 – 32.
Olhede, S. C. and Wolfe, P. J. (2014). Network histograms and universality of blockmodel
approximation. Proceedings of the National Academy of Sciences, 11(41):14722 – 14727.
Pastor-Satorras, R. and Vespignani, A. (2001). Epidemic spreading in scale-free networks.
Physical Review Letters, 86(14):3200 – 3203.
Pollard, D. (2002). A User’s Guide to Measure Theoretic Probability. Cambridge University
Press, Cambridge.
Rao, B. L. S. P. (2009). Conditional independence, conditional mixing and conditional
association. Annals of the Institute of Statistical Mathematics, 61(2):441 – 460.
Santos Silva, J. and Tenreyro, S. (2006). The log of gravity. Review of Economics and
Statistics, 88(4):641 – 658.
Shalizi, C. R. and Rinaldo, A. (2013). Consistency under sampling of exponential random
graph models. Annals of Statistics, 41(2):508 – 535.
Sheng, S. (2014). A structural econometric analysis of network formation games. Mimeo,
University of California - Los Angeles.
Simons, G. and Yao, Y.-C. (1998). Approximating the inverse of a symmetric positive definite
matrix. Linear Algebra and its Applications, 281(1-3):97 – 103.
Simons, G. and Yao, Y.-C. (1999). Asymptotics when the number of parameters tends to
infinity in the bradley-terry model for paired comparisons. Annals of Statistics, 27(3):1041
– 1060.
Tamer, E. (2003). Incomplete simultaneous discrete response model with multiple equilibria.
Review of Economic Studies, 70(1):147 – 165.
van der Vaart, A. W. (2000). Asymptotic Statistics. Cambridge University Press, Cambridge.
40

van Duijn, M. A. J., Snijders, T. A. B., and Zijlstra, B. J. H. (2004). p2: a random eﬀects
model with covariates for directed graphs. Statistica Neerlandica, 58(2):234 – 254.
Yan, T., Jiang, B., Fienberg, S. E., and Leng, C. (2016). Statistical inference in a directed
network model with covariates. arxiv 1609.04558, University of Warwick.
Yan, T. and Xu, J. (2013). A central limit theorem in the β-model for undirected random
graphs with a diverging number of vertices. Biometrika, 100(2):519 – 524.

41

