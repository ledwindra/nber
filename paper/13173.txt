NBER WORKING PAPER SERIES

PORTFOLIO CHOICES WITH NEAR RATIONAL AGENTS:
A SOLUTION OF SOME INTERNATIONAL-FINANCE PUZZLES
Pierpaolo Benigno
Working Paper 13173
http://www.nber.org/papers/w13173

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
June 2007

I am grateful to Anastasios Karantounias, Salvatore Nisticó, Matteo Pignatti and Laura Veldkamp
for helpful discussions and comments and to seminar partecipants at EIEF, Universitá Bocconi, Universitat
Pompeu Fabra and at the NBER IFM Meeting. The views expressed herein are those of the author(s)
and do not necessarily reflect the views of the National Bureau of Economic Research.
© 2007 by Pierpaolo Benigno. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including © notice, is given to
the source.

Portfolio Choices with Near Rational Agents: A Solution of Some International-Finance Puzzles
Pierpaolo Benigno
NBER Working Paper No. 13173
June 2007, Revised January 2008
JEL No. F41,G11,G15
ABSTRACT
A dynamic model of consumption and portfolio decisions is analyzed in which agents seek robust
choices against some misspecification of the model probability distribution. This near-rational environment
can at the same time explain an imperfect international portfolio diversification and break the link
between cross-country consumption correlation and real exchange rate as it is usually implied by standard
preference specifications. Portfolio decisions imply moment restrictions on asset prices that are useful
to extract information on the degree of near-rationality present in the data.

Pierpaolo Benigno
Dipartimento di Scienze Economiche e Aziendali
Luiss Guido Carli
Viale Romania 32
00197 Rome - Italy
and NBER
pbenigno@luiss.it

Home bias in equities is one of the most consistent observation in international
finance. Investors hold a disproportionate share of their wealth in domestic securities more than what would be dictated by the share of these securities in the world
market.1 Per se, this is not a puzzle. A growing body of the literature has proposed portfolio models that can account for a partially diversified portfolio. The
current explanations range from the existence of information frictions to trade costs
in goods and asset markets, home bias in consumption, sticky prices, terms of trade
movements.2 Absence of diversification in portfolio choices does not imply lack of
international risk sharing. Indeed, these analyses start from the complete-market
allocation and build the optimal portfolio shares to mimic that allocation. However,
full risk sharing implies a strong connection between stochastic discount factors and
the nominal exchange rate and, given standard preference specification, a counterfactual relation between cross-country consumption diﬀerentials and real exchange rates.
The model implies consumption to fall in one country relative to the other while the
real exchange rate appreciates. In the data cross-country consumption diﬀerential
and real exchange rate are weakly correlated. This is the Backus-Smith anomaly.3
In his Ohlin Lecture Obstfeld (2006) has pointed out that portfolio theories that
explain the international home bias should be also consistent with the right correlation
between real exchange rate and cross-country consumption diﬀerential.4 Needless to
say, preference specifications currently used, in general and partial equilibrium openeconomy models, are unable to match other asset price moments as the high and
volatile returns on equities and the shape and volatility of the yield curve.
This paper attempts to solve the home-bias puzzle in a near-rational environment
without falling in the Backus-Smith anomaly. Near rationality is modelled as the
possibility that decision makers fear some misspecification of the model probability distribution like in the robustness literature developed by Hansen and Sargent
(2005).5 The degree of irrationality is bounded by the fact that the model distrust is
statistically diﬃcult to distinguish in finite sample.
1

See Bertaut and Grever (2004).
An incomplete list of successful papers includes: Coeurdacier (2005), Coeurdacier et al. (2007),
Cole and Obstfeld (1991), Devereux and Sutherland (2006), Engel and Matsumoto (2006), Heatcote
and Perri (2004), Kollmann (2006), Pesenti and van Wincoop (2002), Tille and van Wincoop (2006),
Uppal (1993).
3
Backus and Smith (1993).
4
See also Obstfeld and Rogoﬀ (2001).
5
I borrow the term near rationality from Woodford (2006) for it captures in a better way the
economic content of the application that I am interested in.
2

1

I write down a simple two-country two-asset representative agent model, in which
near-rational decision makers choose optimally their intertemporal consumption profile together with the portfolio allocation. I start with the limiting case of rational
expectations and log-consumption utility: the model implies complete portfolio diversification. By equally investing in the two securities agents can completely share
the movements in their nominal expenditure once evaluated in the same currency
achieving the full risk-sharing allocation. Near rationality allows a departure from
this allocation whose direction towards home bias is a question of empirical relevance
of certain covariances and variances. Near rationality modifies the stochastic discount
factor by a multiplicative term that translates the fears of misspecification in fears
of bad news on the expected discounted value of consumption. In this case, there
is a close parallel with the stochastic discount factor of non-expected utility models
discussed in Hansen et al. (2005) and Piazzesi and Schneider (2006).6
The reasons for why the model with near-rational agents generates home bias in
portfolio choices can be understood in the following way. News on current and future
real exchange rate appreciation are bad news for the expected consumption profile.
Investors would like to invest more in securities that provide a good hedge against
this risk. If this happens to be the case for the return on the domestic asset, investors
would desire to hold more of this asset.
I extend the analysis to general isoelastic consumption utility and to the case
of asymmetries in the cross-country degrees of near rationality. In the latter case,
the model implies cross-country asymmetries in the exposure to global risk so that
investors would like to hold more of home assets when they are a good hedge.
The multiplicative component, that near-rationality adds to the nominal discount
factor, serves for the purpose of breaking the link between cross-country consumption
diﬀerentials and the real exchange rate as it happens when there is a preference shock,
with the important diﬀerence that this is now observable. I perform a test similar to
the one used by Kocherlakota and Pistaferri (2007) to evaluate whether this preference
specification can survive to the Backus-Smith anomaly. The model is successful for
a wide range of parameter values.
Having expressed the stochastic discount factor as a function of observable variables, I can estimate the degree of near-rationality embedded in the moment restrictions that characterize the portfolio decisions of investors. With an intertemporal
6

See Barillas et al. (2006) for an equivalent mapping in terms of indirect utility.

2

elasticity of substitution below but close to the unitary value, the estimates are consistent with explaining a good degree of home bias and imply preferences that are
not rejected by the Kocherlakota-Pistaferri test.
Finally, this paper uses recent approximation techniques, developed by Devereux
and Sutherland (2006) and Tille and van Wincoop (2006), to solve for the optimal
portfolio allocation and shows that a rich model with robust preferences can be solved
in a tractable way. In a standard closed-economy model, robust choices have only
second-order eﬀects on the equilibrium allocation. In particular they just aﬀect asset
prices. In an international context (or in an heterogenous-agent model), I show
that first-order perturbations to the stochastic discount factors, due to the possible
model misspecification, have also first-order eﬀects on the cross-country (cross-agent)
consumption diﬀerentials and wealth distribution through the direct eﬀect on the
steady-state portfolio allocations.
I work in discrete time. There is a related continuos-time literature on portfolio choices under ambiguity. Maenhout (2004, 2006) develops a modification of the
continuos-time robust-control literature to study portfolio and consumption choices
in a partial-equilibrium dynamic model. To get a closed-form solution he adopts a
transformation of the objective function of the decision makers that changes the penalization of entropy from a constant Lagrange multiplier into a function of the value
function. This modification deeply changes the nature of the approach proposed by
Hansen and Sargent (2005) in a way that it is not comparable with the one proposed
here.7 Uppal and Wang (2003) and Epstein and Miao (2005) are related papers
that instead use ambiguity aversion based on recursive multiple priors. In particular,
Epstein and Miao (2005) develop a two-country continuos-time dynamic general equilibrium model. In contrast to this paper, they focus on a complete-market allocation.
Most important, their conclusion for asset home bias depends on imposing the external assumption that agents have more ambiguity in the foreign asset’s return. Van
Nieuwerburgh and Veldkamp (2007) model an economy with imperfect information
in which agents can learn and acquire better information on domestic and foreign
stocks. However, to get home bias they have to assume that each home investor has
prior information about home asset’s payoﬀ which is slightly more precise than the
prior information foreigners have. Instead, in this paper, near rationality creates a
departure from full portfolio diversification that can go in either directions, to justify
7

See the discussion in Pathak (2002).

3

more or less home bias without necessarily assuming that home agents have more
ambiguity or less information with respect to foreign asset’s return. The results of
this paper depends instead on the sign of data covariances.
This work is structured as follows. Section 1 presents the model under rational
expectations. Section 2 discusses the near-rationality model while Section 3 approximates its solution. Section 4 studies whether the data validate the theory proposed.
Section 5 discusses the Backus-Smith anomaly while Section 6 estimates the degree
of near-rationality. Section 7 concludes.

1

Model

In this section, I describe the model under rational expectations. I consider two countries, home and foreign. The representative agent in the home economy maximizes
the expected present discounted value of the utility flow
(∞
)
X
(1)
β t−t0 ln Ct
Et0
t=t0

where β is the discount factor, with 0 < β < 1. The utility flow is logarithmic in a
consumption basket C. Later, I will relax this assumption. Preferences are similar for
the representative agent in the foreign economy, except for the fact that variables are
denoted with an asterisk.8 In both countries agents can invest their nominal wealth
in two risky assets denominated respectively in each of the two currencies. There
are no transaction costs. With St I denote the nominal exchange rate as the price of
foreign currency in terms of domestic currency. At time t each asset has a price in
the respective currency of denomination given by Vt and Vt∗ and delivers dividends
Dt and Dt∗ .
The flow budget constraint for the agent in the domestic economy is given by
Vt xt + St Vt∗ yt = (Vt + Dt )xt−1 + St (Vt∗ + Dt∗ )yt−1 − Pt Ct

(2)

where xt and yt denote respectively the shares of the domestic and foreign assets held
by the home agent at time t; Pt is the price of the domestic consumption good. The
8

For the analysis that follows, I do not need to specify the composition of the consumption basket
nor I need to detail the diﬀerences between the two countries. I follow a partial-equilibrium analysis,
althought the results would be consistent with a properly written general equilibrium model.

4

flow budget constraint of the foreign agent is given by
Vt ∗
(Vt + Dt ) ∗
∗
xt + Vt∗ yt∗ =
xt−1 + (Vt∗ + Dt∗ )yt−1
− Pt∗ Ct∗ ,
St
St
where Pt∗ is the price of the foreign consumption good. I assume that there can
be deviations from purchasing power parity and thus real exchange rate movements,
but for what follows I do not need to specify the sources.9 Equilibrium in the asset
markets requires portfolio shares to sum to one
xt + x∗t = 1,

(3)

yt + yt∗ = 1,

(4)

for each of the two assets. I define the assets return as Rt ≡ (Vt + Dt )/Vt−1 and Rt∗ ≡
∗
(Vt∗ + Dt∗ )/Vt−1
. Starting with the home agent I write a more compact representation
of the budget constraint by defining total nominal wealth, Wt , as
Wt ≡ Vt xt + St Vt∗ yt

(5)

where the shares of wealth invested in the domestic and foreign assets are defined by
Vt xt
,
Wt

(6)

St Vt∗ yt
,
Wt

(7)

α1,t ≡
and
α2,t ≡

respectively.
Given these definitions I can write the flow budget constraint (2) as
Wt = Rp,t Wt−1 − Pt Ct

(8)

where the domestic-currency portfolio return is defined as
Rp,t ≡ α1,t−1 Rt + α2,t−1

St ∗
R.
St−1 t

(9)

Given an initial condition on wealth, Wt0 −1 , and the sequence of asset returns, the
home agent chooses consumption and portfolio shares to maximize (1) under the flow
budget constraint (8), given (9) and an appropriate no-Ponzi game condition.
9

See Rogoﬀ (1996) for a discussion of the possible explanations of the deviations from purchasing
power parity.

5

Similar steps for the foreign investor deliver a flow budget constraint of the form
∗
∗
Wt−1
− Pt∗ Ct∗
Wt∗ = Rp,t

where

Vt ∗
xt + Vt∗ yt∗ ,
St
St−1
≡ α∗1,t−1 Rt
+ α∗2,t−1 Rt∗ .
St
Wt∗ ≡

∗
Rp,t

(10)

This rewriting implies that equation (3) is equivalent to
α1,t Wt + α∗1,t St Wt∗ = Vt ,

(11)

while (4) is equivalent to
Wt
+ α∗2,t Wt∗ = Vt∗ .
(12)
St
The optimization problem for the home and foreign agents has a simple solution. Logarithmic utility implies that nominal expenditure is proportional to nominal wealth
α2,t

Pt Ct =

(1 − β)
Wt ,
β

Pt∗ Ct∗ =

(1 − β) ∗
Wt ,
β

(13)

where nominal wealth evolves according to
∗
∗
Wt∗ = βRp,t
Wt−1
,

Wt = βRp,t Wt−1

(14)

for the home and foreign agent, respectively. Optimal portfolio decisions replicate the
complete-market allocation and imply full portfolio diversification.10 First, consider
∗
the nominal discount factors given by Mt+1 and Mt+1
Mt+1 = β

Pt Ct
Pt+1 Ct+1

∗
Mt+1
=β

Pt∗ Ct∗
.
∗
∗
Pt+1
Ct+1

(15)

The complete-market allocation requires to equate the nominal stochastic discount
factors to the between-period changes in the nominal exchange rate
Mt+1
St
=
.
∗
Mt+1
St+1
10

These two characteristics do not have necessarily to coincide.

6

(16)

Using (13), (14) and (15), condition (16) implies equal portfolio returns once evaluated
in the same currency
St+1
∗
Rp,t+1 = Rp,t+1
.
St
By inspection of (9) and (10), this requirement is satisfied with symmetric portfolio
choices, i.e. α1,t = α∗1,t and α2,t = α∗2,t . Portfolio decisions are fully diversified
and complete markets achieved. In this model agents would like to share the risks of
movements in their nominal expenditures, once equated in the same currency. Indeed
(16) implies that Pt Ct ∼ St Pt∗ Ct∗ at each point in time which is then achievable by
taking identical portfolio choices. The model with near-rational agents, which is going
to be detailed in the next sections, diﬀers in a slight but non-innocuous way. It will
be shown that nominal stochastic discount factors are given by
Mt+1 = β

Pt Ct
gt+1
Pt+1 Ct+1

∗
Mt+1
=β

Pt∗ Ct∗ ∗
gt+1
∗
∗
Pt+1
Ct+1

(17)

where the additional terms gt and gt∗ are functions, in a log-linear approximation, of
the revisions in the expected consumption path as follows
ln gt+1
and
∗
ln gt+1

1X j
=−
β (Et+1 ln Ct+j+1 − Et ln Ct+j+1 )
θ j=0
∞

∞
1 X j
∗
∗
=− ∗
β (Et+1 ln Ct+j+1
− Et ln Ct+j+1
).
θ j=0

The parameters θ and θ∗ measure the departures from rational expectations which
are nested under the assumption that θ and θ∗ approach infinity. Even in the nearrational environment, (16) represents the risk-sharing objective. However, nominal
stochastic discount factors are now perturbed by an additional term. Agents would
like to share not only the risk of idiosyncratic movements in nominal expenditure
but also that of shocks revealing bad or good news for the expected consumption
path. Inspection of equilibrium conditions (13) and (14) shows that prices and real
exchange rate developments are important in creating idiosyncratic diﬀerences in the
consumption path across countries. In their portfolio decisions agents would like to
invest in assets that hedge against such idiosyncratic movements. This is the motif
for the lack of full portfolio diversification in the model with near-rational investors
whose theoretical construction and empirical validity will be the subject of the next
sections.
7

2

The model with near-rational agents

I analyze departures from rational expectations in the form of a distrust that the
agent has with respect to the model probability distribution. Agents fear model
misspecification and surround the true model with a set of perturbations that are
statistically diﬃcult to distinguish in finite samples. I borrow this apparatus from
the literature on robustness developed in economics by Hansen and Sargent (2005).
The distorted probability distributions are built using martingale representations.
Let It be the information set of a generic agent at time t and Gt a non-negative
It -measurable martingale. Define gt+1 ≡ Gt+1 /Gt if Gt > 0 and gt+1 = 1 if Gt = 0,
then Gt+1 = gt+1 Gt . It follows that Et (gt+1 ) ≡ E(gt+1 |It ) = 1. Hansen and Sargent
(2005, 2006) use Gt to generate a distorted probability measure under which the
expectation of a generic random variable Xt+1 is given by ÊXt+1 = EGt+1 Xt+1 while
the distorted conditional expectation is given by Êt Xt+1 = Et gt+1 Xt+1 .
Preferences of near-rational agents are assumed to be of the form
(∞
)
(∞
)
X
X
Ut0 ≡ Et0
β t−t0 Gt ln Ct + θEt0
β t−t0 Gt βEt (gt+1 ln gt+1 ) .
(18)
t=t0

t=t0

The utility of the decision maker is composed by the sum of two present discounted
values. The first one is the “traditional” present discounted value of the utility
from consumption (in expected terms) which is now perturbed by nearby probability
distributions using the martingale distortion The second term represents a discounted
measure of entropy (see Hansen and Sargent, 2005, for a formal discussion). The
distrust that the agent has in the model probability distribution is penalized by the
expected log likelihood ratios (or relative entropies) of the alternative models.11 The
parameter θ, with θ > 0, measures departures from rational expectations. In the
literature on robust control agents seek decisions which are robust with respect to
the possible model misspecification and in particular with respect to the worst-case
misspecified scenario. The model misspecification is parametrized by the choice of
the sequence {gt } while the agent is choosing sequences of consumption and portfolio
shares {Ct , α1,t , α2,t } taking as given prices and returns {Pt , St , Rt , Rt∗ }. The nearrational agent is going to choose consumption and portfolio choices in a “robust” way
11

Althought entropy is additive in the overall utility, why it is a penalization is going to be clarified
later in the text.

8

to solve the following problem
max

min Ut0 .

{Ct ,α1,t ,α2,t } {gt }

This maxminimizer allocation can be obtained as a part of a Nash equilibrium of
a two-player game with commitments.12 In this game on one side the “traditional”
agent maximizes (18) under the flow budget constraint (8) by choosing the sequences
of consumption and portfolio shares {Ct , α1,t , α2,t } taking as given the choice of the
other agent in terms of the sequence {gt } for given prices and returns {Pt , St , Rt , Rt∗ };
on the other side the “malevolent” agent minimizes the same utility by choosing the
stochastic sequence {gt } given the constraint
Gt+1 = gt+1 Gt

(19)

Et gt+1 = 1,

(20)

with Gt0 = 1 and
considering as given the choices of the “traditional” agent in terms of the sequence
{Ct , α1,t , α2,t }. When θ → ∞ the objective is minimized when gt = 1 for each t from
which the rational expectations model follows.
Starting with the problem of the “traditional” agent, preferences for robustness
do not change the implication that, with logarithmic preferences, the consumptionwealth ratio is constant. Note that the consumption Euler equation requires
½
¾
1
1
= βEt gt+1 Rp,t+1
Pt Ct
Pt+1 Ct+1
which is indeed satisfied by (13) and (14) given (20). The above equation is equivalent
to the condition
(21)
Et {Mt+1 Rp,t+1 } = 1.
In a similar way, I can write
∗
∗
Rp,t+1
} = 1,
Et {Mt+1

(22)

for the foreign country where the nominal discount factors M and M ∗ are defined in
(17).
Robustness does matter for the consumption and wealth profiles of the agents
since it aﬀects the portfolio return through the endogenous portfolio allocations. I
now move to analyze how portfolio choices are taken.
12

See Osborne and Rubinstein (1994).

9

2.1

Optimal portfolio decisions

The optimal allocation of wealth between the two assets depends on standard noarbitrage conditions. With respect to the domestic asset, these conditions imply
that
Et {Mt+1 Rt+1 } = 1,
(23)
½
¾
St
∗
= 1,
(24)
Rt+1
Et Mt+1
St+1

for the domestic and foreign agent, respectively.
With respect to the foreign asset, they instead require
½
¾
∗ St+1
= 1,
Et Mt+1 Rt+1
St
∗
∗
Et {Mt+1
Rt+1
} = 1,

(25)
(26)

for the domestic and foreign agent, respectively.
The equilibrium restrictions (21)—(26) are equivalent to the set of equilibrium
conditions composed by (21) and (22) together with
α1 + α2 = 1

(27)

α∗1 + α∗2 = 1
½µ
¶µ
¶¾
St
∗
∗ St+1
Mt+1 − Mt+1
Rt+1 − Rt+1
= 0.
Et
St+1
St

(28)
(29)

In particular (29) is an orthogonality condition between the return diﬀerential in
domestic currency and the diﬀerence in the nominal stochastic discount factors evaluated in the same currency. When markets are complete, condition (16) replaces
(29). Finally, note that (23) and (26) imply
Vt = Et {Mt+1 (Vt+1 + Dt+1 )}

(30)

∗
∗
∗
(Vt+1
+ Dt+1
)}
Vt∗ = Et {Mt+1

(31)

which determine asset prices for given nominal stochastic discount factors and dividend processes.

10

2.2

Decisions of the “malevolent” agent

I endogeneize the path of gt which has been considered as given so far. To this purpose
I analyze the optimal choice of the “malevolent” agent which commits to choose the
sequence {gt } in order to minimize (18) under the constraints (19) and (20) taking as
given the optimal choice of the other agent in terms of the sequences {Ct , α1,t , α2,t }.
The first-order conditions of this problem require that
ln Ct + βθEt gt+1 ln gt+1 + λt − βEt {λt+1 gt+1 } = 0

(32)

βθGt (1 + ln gt+1 ) + µt − βλt+1 Gt = 0,

(33)

where λt is the Lagrange multiplier associated with the constraint (19) and µt the
Lagrange multiplier associated with (20).

3

Approximated solution

While it is possible to solve for the consumption path and the dynamic of wealth
in closed form for given portfolio returns, analytical solutions are not available for
portfolio shares. The problem can be solved using approximations around the steady
state. In the deterministic steady state, there is no concern for a possible misspecification of the model so that gt = Gt = 1. I assume that steady-state inflation rates
are zeros in both countries. Moreover Mt = Mt∗ = β and Rt = Rt∗ = β −1 while
C̄ = (1 − β)β −1 W̄ /P̄ and C̄ ∗ = (1 − β)β −1 W̄ ∗ /P̄ ∗ . The steady-state Lagrange multipliers are given by λ̄ = (1 − β)−1 ln C̄ and µ̄ = β λ̄ − βθ. Furthermore Rt = Rt∗ = β −1
implies that V̄ /D̄ = V̄ ∗ /D̄∗ = (1 − β)−1 β in equations (30) and (31). In the steady
state, equation (11) implies that
ᾱ1 W̄ + ᾱ∗1 S̄ W̄ ∗ = V̄ .

(34)

However, the initial distribution of wealth is not determined, as it is usually the case
in open-economy models. I choose W̄ and W̄ ∗ to be equalized once evaluated in the
same currency W̄ = S̄ W̄ ∗ . I can further normalize D̄ and D̄∗ in a way that V̄ = W̄
and V̄ = W̄ ∗ . It follows that S̄ = V̄ /V̄ ∗ = W̄ /W̄ ∗ . Equation (34) implies that
ᾱ1 + ᾱ∗1 = 1

11

(35)

which together with (27) and (28) represent a set of three independent equations.13
This is not enough to determine the steady-state portfolio shares. I follow Devereux
and Sutherland (2006) to obtain, by continuity from the stochastic model, the last
restriction needed.14 Equilibrium condition (29) holds in a non-stochastic steady
state as well as in the neighborhood of the deterministic steady state. In the limiting
case when the randomness vanishes, variances and covariances vanish at the same
rate in a way to still imply a restriction on the steady-state portfolio shares. This is
a bifurcation point, as discussed in Judd and Guu (2001). To obtain this restriction,
one needs to take a second-order approximation of (29) obtaining
∗
∗
covt (M̂t+1 − M̂t+1
+ ∆Ŝt+1 , R̂t+1
+ ∆Ŝt+1 − R̂t+1 ) = 0,

(36)

where variables with hats represent log-deviations of the respective variable with
respect to the steady state and the operator ∆(·) applied to a generic variable x
is such that ∆xt = xt − xt−1 . To evaluate (36) it is suﬃcient to take a first-order
approximation of the equilibrium conditions in which the portfolio shares appear as
a subset of the coeﬃcients in the linear expansion. The derivations are left to the
appendix. As a first step, note that, under near rationality and log-consumption
utility, a log-linear approximation of the nominal discount factor of the home agent
reads as
M̂t+1 = Ĉt − Ĉt+1 − π t+1 −

X
1
β j (Et+1 ∆Ĉt+j+1 − Et ∆Ĉt+j+1 ).
θ(1 − β) j=0
∞

(37)

Since the nominal discount factor measures the appetite for receiving nominal wealth
in future states of nature, it would be more desirable to have such wealth either when
future nominal expenditure is low or when there are bad news on future consumption
growth. With logarithmic utility, the discount factor with near-rational agents is
equivalent to that obtainable when agents treat diﬀerently the intertemporal distribution of risk as in the recursive utility representation of Kreps and Porteus (1978),
Epstein and Zin (1989) and Weil (1989). This mapping has been already expounded
in Barillas et al. (2006) and Hansen and Sargent (2006) where it has been related
to the stochastic discount factor of Tallarini (2000) which features additional terms
13

Note that the normalization used in the steady state implies that ᾱ1 = x̄, ᾱ2 = ȳ, ᾱ∗1 = x̄∗ and
ᾱ∗2 = ȳ ∗ .
14
See also Tille and Van Wincoop (2006).

12

expressed in terms of indirect utility. Here I show a direct relation with the stochastic
discount factor derived in Hansen et al. (2005), Piazzesi and Schneider (2006) and
Restoy and Weil (2004) in which the additional terms are expressed in terms of observable variables.15 The parallel is one-to-one if the parameter θ is related to their
risk-aversion coeﬃcient γ as follows
θ=

1
.
(1 − β)(γ − 1)

(38)

However, the interpretation is substantially diﬀerent. With Kreps-Porteus preferences γ is a measure of the agent aversion toward risk. Instead, with near-rational
agents θ measures (in an inverse way) the departure from the rational expectations
environment and in particular the diﬃculties to distinguish the near-rational allocation from the true model. As discussed in Barillas et al. (2006) relatively high values
of γ, low values of θ, are associated with relatively low detection error probabilities
which depend on the model true probability distribution. In what follows, I replace
θ with γ using (38).
I first assume that the degree of near-rationality is the same in the two countries,
i.e. γ = γ ∗ . Under this assumption together with log-utility I show in the appendix
that (36) implies
1 1 γ − 1 covt (St+1 ∆Q̂t+1 , ert+1 )
ᾱ2 = −
,
(39)
2 2 γ
vart (ert+1 )
which then determines the home share of foreign assets.1617 In (39), Qt is the real
exchange rate, defined as Q ≡ SP ∗ /P . I have also defined the excess return between
the two assets evaluated in domestic currency as
∗
+ ∆Ŝt+1 − R̂t+1 )
ert+1 = (R̂t+1

and the operator St+1 applied to a generic variable xt+1 as
St+1 xt+1 ≡
15

∞
X
j=0

β j (Et+1 xt+j+1 − Et xt+j+1 ),

Note that in Hansen et al. (2006) and Piazzesi and Schneider (2006), there are additional terms
not present in my analysis since they are of second-order magnitude. They will be evaluated in later
sections when needed.
16
Home bias for the home agent corresponds to home bias for the foreign agent, since ᾱ∗1 = ᾱ2 .
17
Conditional variances and covariances are indipendent of time in a second-order approximation
so that (39) indeed determines a steady-state portfolio share. However, it is still appropriate to keep
the notation as in (39) to distinguish conditional from unconditional covariances.

13

which captures the surprises at time t+1 in the expectations of the present discounted
value of the variable x.
The rational expectations model follows directly when θ → ∞ or γ = 1 where I
have shown in Section 1 that there is full international portfolio diversification. Near
rationality permits an important departure from this result even in the direction of
implying home bias in portfolio choices— the empirical relevant case. This is possible
if the excess return between the two investment opportunities evaluated in domestic
currency covaries in a positive way with the surprises in the real exchange rate. Given
a positive covariance, the higher is the degree of misspecification the higher is the
home bias. As discussed in Section 1 there are now two reasons for risk sharing.
The first one is the traditional desire to insure nominal expenditure as discussed in
the previous section. The second additional motif depends on the possible model
misspecification feared by the agent. This is captured by the fact that agents would
like to insure themselves against receiving bad news on future consumption as it is
shown in (37). For a given path of asset returns, an increase in the domestic price
level relative to the foreign, i.e. an appreciation of the real exchange rate or a fall in
Q, is a bad news for future domestic consumption because reduces current and future
real wealth. Domestic assets are a good hedge with respect to this risk insofar as they
pay well when those bad news are received. A positive relation between the above
defined excess return and the surprises in the real exchange rate serves indeed for
this interest. The relevance of this explanation is then a matter of empirical analysis.
Since (39) can be expressed in terms of observable variables, in the next section I will
use data for these variables to study its significance.18 At a first look using US-UK
data, the covariance of the real exchange rate and the excess return is positive which
goes in the right direction for the model to explain part of the observed home bias.
The home-bias result does not depend on assuming that one country is more
irrational than the other. However, logarithmic utility is an important assumption
behind (39). An appreciation of the real exchange rate produces a negative income
eﬀect on home consumption relative to foreign consumption. However, if the real
exchange rate is expected to fall, there is an incentive for the domestic consumer to
anticipate consumption expenditures: a positive substitution eﬀect. With logarithmic
18

Van Wincoop and Warnock (2006) have criticized current general equilibrium models that explain portfolio home bias since they rely on variances and covariances which are not data consistent.

14

utility, income and substitution eﬀects cancel out. Instead, when the elasticity of
substitution is low, the income eﬀect dominates and domestic agents would like to
hedge this risk using domestic assets if their return relative to the foreign assets is
high when the real exchange rate appreciates. Indeed, in the appendix I show that
when agents are perfectly rational and consumption preferences are isoelastic with
intertemporal elasticity of substitution ψ as in
⎧
⎫
1
1− ψ
∞
⎨X
⎬
C
Ut0 ≡ Et0
β t−t0 t 1
⎩t=t
1− ψ⎭
0

the optimal portfolio allocation implies that
ᾱ2 =

covt (St+1 ∆Q̂t+1 , ert+1 )
1 1
− (1 − ψ)
.
2 2
vart (ert+1 )

(40)

A positive covariance between excess returns and real exchange rate surprises and a
low elasticity of substitution can account for a low share of wealth invested in foreign
assets.19 At a first look, near-rationality seems an unnecessary assumption because
the hedging motif behind (39) and (40) is the same . However, estimates of the
intertemporal elasticity of substitution are not very far from the unitary value, as
discussed in Vissing-Jœrgensen and Attanasio (2003). Moreover, when ψ > 1, the
covariance between real exchange rate surprises and excess returns should be negative
to be able to generate home bias. Furthermore, as it will be discussed in the next
sections, isoelastic utility cum rational expectations implies a counterfactual relationship between the real exchange rate and cross-country consumption diﬀerential— the
Backus-Smith anomaly.
In the general case in which preferences are near rational and the elasticity of
substitution is allowed to be diﬀerent from the unitary value, the utility of the home
agent is given by
⎧
⎫
(∞
)
1
1− ψ
∞
⎨X
⎬
X
C
Ut0 ≡ Et0
β t−t0 Gt t 1 + θEt0
β t−t0 Gt βEt (gt+1 ln gt+1 )
⎩t=t
1− ψ⎭
t=t
0

0

19

Note that when PPP holds so that the real exchange rate does not move, I get the result of
Obstfeld and Rogoﬀ (1996, pp. 286-287) that there is always full diversification no matter the value
assumed by the intertemporal elasticity of substitution, when agents have rational expectations.

15

which implies the following stochastic nominal discount factor
M̂t+1

X
1
1
= (Ĉt − Ĉt+1 ) − π t+1 −
β j (Et+1 ∆Ĉt+j+1 − Et ∆Ĉt+j+1 ).
ψ
θ(1 − β) j=0
∞

Near-rational preferences no longer coincide with the recursive non-expected utility
models of Kreps and Porteus (1978) and Epstein and Zin (1989). I show in the
appendix that the optimal share of foreign assets held by the home agent is given by
³
´
cov
∆
Q̂
,
er
S
t
t+1
t+1
t+1
1 1 [1 − ψ + ψ(γ − 1)]
ᾱ2 = −
,
(41)
2 2 [1 + ψ(γ − 1)]
vart ert+1
where I maintain the definition of γ given by (38) with the caveat that, unless ψ = 1, γ
does not coincide anymore with the risk aversion coeﬃcient of Epstein-Zin utility. For
a positive covariance between the real exchange rate surprises and the excess return,
near-rationality can now magnify the implications of (40), when the intertemporal
elasticity of substitution is below the unitary value, and can overturn the result of
(40), when ψ > 1.
So far, I have maintained the assumption that the degree of misspecification is
equal across countries for the purpose of clarifying that the home-bias result does
not depend on assuming that one country fears more the model misspecification and
consequentially holds more of its own assets. I can now generalize the previous results
to the case in which γ 6= γ ∗ . I show in the appendix that the share of foreign assets
held by the home agent is now

ᾱ2

where

³
´
¤
£
ψ
∗
1 1 1 − ψ + 2 (γ − 1 + γ − 1) covt St+1 ∆Q̂t+1 , ert+1
¤
£
−
=
+
2 2
vart ert+1
1 + ψ2 (γ − 1 + γ ∗ − 1)
³
´
W
W
(
R̂
−
π
),
er
cov
S
∗
t
t+1
t+1
t+1
t+1
(γ − γ )
ψ
¤
− £
,
2 1 + ψ2 (γ − 1 + γ ∗ − 1)
vart ert+1

(42)

1
1 ∗
∗
R̂tW − π W
t ≡ (R̂t − π t ) + (R̂t − π t ).
2
2
Previous results are all nested in this formula. The second line of (42) shows an
additional factor that depends on the diﬀerent degrees of near-rationality across investors. Interestingly, a degree of irrationality higher in the home country than in
16

the foreign country does not necessarily imply less holdings of foreign assets. Instead,
the total eﬀect depends on how excess returns covary with surprises in global real
returns. Indeed when γ is higher than γ ∗ the home agent fears more the possible
model misspecification and then cares more about consumption risk. Consumption
risk depends on a “relative” component which is captured by the surprises in the real
exchange rate and on a “global” component that depends on the surprises in the real
return of the world portfolio (a weighted average of the home and foreign real stockmarket returns). The implications of the “relative” component have been already
discussed in (39), (40) and (41). On top of that, holding more domestic assets is a
good hedge with respect to global risk when these assets pay well when the return of
the world portfolio goes down. This is the case when the covariance in the second line
of (42) is positive. Next section elaborates more on the estimation of the covariances
and variances involved in (42).

4

A look at the data

In the previous section, I have shown that departures from rational expectations can
justify home bias in portfolio choices depending on the relationship between some
observable variables. In this section I investigate more the empirical support for
the theory. I look at data for two countries United Kingdom and United States to
analyze the bilateral relation UK-US where I consider the US as the home country.
Data are described in the appendix. They are at a quarterly frequency for the sample
1970:Q1 to 2005:Q4 and corresponds to the following variables ∆c, ∆c∗ , π, π ∗ , r, r∗ ,
∆s, where small-case variables represent the log of the capital-case variables of the
∗
previous section and π t ≡ ln Pt /Pt−1 , π ∗t ≡ ln Pt∗ /Pt−1
. This set of variables is also
suﬃcient to build a data analogous for the excess return, er, and the real exchange
rate changes, ∆q.
To evaluate (42) conditional moments should be evaluated so that a forecasting
model is needed. Piazzesi and Schneider (2006) have used a simple state-space representation for consumption growth and inflation to match empirical moments of the
US term structure with Krep-Porteus stochastic discount factor. A minimalist twocountry replica of their model requires using the following variables, ∆c, ∆c∗ , π, π ∗ ,
∆q where the real exchange rate matters for capturing relative price adjustments. I
further enlarge this set of variables by including the real returns for each of the stock
17

markets, r−π and r∗ −π ∗ to obtain a reasonable forecasting model with the minimum
set of variables needed to evaluate (42). As in Piazzesi and Schneider (2006), having
defined the vector zt ≡ (∆ct , ∆c∗t , π t , π ∗t , ∆qt , rt − π t , rt∗ − π∗t ), I assume a state-space
model of the form
zt+1 = µz + xt + ξ t+1
xt+1 = Φxt + Γξ t+1
where ξ t+1 ∼ N(0, Ω) and where x and ξ are vectors of the same dimension as z, µz
is a vector and Φ and Γ are matrices. Conditional on this representation, I build the
present discounted value of the revisions in the expected path of real exchange rate
changes as well as the other conditional moments of interest in (42).20 I evaluate (42)
20

I assume β = 0.995 as in Barillas et al. (2006).

18

by varying γ and ψ. Results are presented in Table 1.
Table 1: Home share of foreign equities
ψ = 0.8

γ = 1 γ = 2 γ = 4 γ = 8 γ = 10 γ = 50

γ∗
γ∗
γ∗
γ∗
γ∗
γ∗

0.48
0.49
0.49
0.50
0.50
0.51

0.42
0.44
0.46
0.48
0.48
0.50

0.37
0.39
0.42
0.45
0.46
0.50

0.34
0.35
0.38
0.40
0.42
0.48

0.32
0.34
0.36
0.39
0.41
0.47

0.29
0.29
0.31
0.32
0.32
0.40

0.50
0.50
0.50
0.51
0.51
0.51

0.43
0.45
0.47
0.48
0.49
0.50

0.37
0.40
0.42
0.45
0.46
0.50

0.33
0.35
0.38
0.41
0.42
0.48

0.32
0.34
0.36
0.40
0.41
0.47

0.29
0.30
0.31
0.32
0.33
0.40

0.52
0.51
0.51
0.51
0.51
0.51

0.43
0.45
0.47
0.49
0.49
0.50

0.37
0.40
0.42
0.45
0.46
0.50

0.33
0.35
0.37
0.41
0.42
0.48

0.32
0.34
0.36
0.40
0.41
0.47

0.29
0.30
0.31
0.32
0.33
0.40

=1
=2
=4
=8
= 10
= 50

ψ=1
γ∗
γ∗
γ∗
γ∗
γ∗
γ∗

=1
=2
=4
=8
= 10
= 50

ψ = 1.2
γ∗
γ∗
γ∗
γ∗
γ∗
γ∗

=1
=2
=4
=8
= 10
= 50

Table 1 is divided in three blocks, depending on the assumption of the parameter ψ.
I assume ψ = 0.8 in the top block of the table, ψ = 1 in the middle block and ψ = 1.2
in the block at the bottom. Values in the close neighborhood of the unitary value
are indeed consistent with the estimates of Vissing-Jœrgensen and Attanasio (2003).
19

When γ = γ ∗ = 1, the model collapses to the rational expectations case in which (40)
is valid. A low elasticity of substitution is able to reduce the share of foreign assets
held by the home agent, because the estimated conditional covariance of the realexchange-rate surprises and the excess return is positive. However, a value ψ = 0.8
is not suﬃcient to generate enough home bias, the share indeed just falls to 0.48.
When ψ = 1 and γ = γ ∗ = 1 I get the full diversification case analyzed in Section 1.
Along the diagonal of each block, in which γ = γ ∗ , condition (41) holds. Since real
exchange rate surprises are positively correlated with the excess return, an increase
in the degrees of near-rationality delivers more home bias. However, the model is
more successful when there are asymmetries in the degrees of near-rationality and in
particular when γ > γ ∗ . This depends on the fact that the conditional covariance
between the surprises in the world-portfolio real return covaries in a positive way with
the excess return. (see equation 41) In this case, home equity is a good hedge with
respect to world consumption risk, so that the home country, US, would like to hold
more of its assets when it fears more the model misspecification. The model with
near rational agents is successful to reduce the share of foreign assets held to values
less than 0.33 and up to 0.29 while the model with rational expectations can at most
achieve a value of 0.4 when ψ is assumed to be unrealistically equal to zero.

5

Backus-Smith anomaly

When asset markets are complete there is a unique and positive stochastic discount
factor that enables the pricing of the securities. Discount factors of securities denominated in diﬀerent currencies are related through the condition (16). When discount
factors are derived from preferences, then (16) has strong implications for the relationship between observable macro variables. Assuming agents with rational expectations
and isoelastic utility, (16) implies that the consumption-growth diﬀerential should be
proportional to the changes in the log of the real exchange rate
∆ct+1 − ∆c∗t+1 = ψ∆qt+1 ,

(43)

where the factor of proportionality is given by the intertemporal elasticity of substitution in consumption. Condition (43) has strong implications for the data: 1) the mean
and 2) the volatility of the consumption growth diﬀerential should be proportional

20

to the mean and volatility, respectively, of the real exchange rate; 3) consumption
growth diﬀerential should be perfectly correlated with real exchange rate movements.
Table 2: Some data moments (annual rates)
US-UK

µ(∆c − ∆c∗ )
µ(∆q)
µ(∆c − ∆c∗ − ∆q)
sd(∆c − ∆c∗ )
sd(∆q)
sd(∆c − ∆c∗ − ∆q)
corr(∆c − ∆c∗ , ∆q)

0.54%
1.35%
-0.81%
4.75%
19.65%
20.3%
-0.11

µ(·) = mean
sd(·) = standard deviation
corr(·) = correlation
Table 2 shows the relevant statistics in percent and at annual rates for the US-UK
relationship. The mean of the changes in the real exchange rate is three times higher
than the mean of the consumption-growth diﬀerential. Real exchange rate changes
are more volatile than the consumption-growth diﬀerential in the order of four times.
The correlation between the consumption growth diﬀerential and the real exchange
rate is slightly negative. There is no evidence of relation (43) holding in the data.
This is the Backus-Smith anomaly.
Incomplete markets, instead, represent an important departure for why (43) might
not hold. When assets markets are incomplete, the nominal discount factor is not
unique but there exists a unique projection of the nominal stochastic discount factors
on the space generated by the asset payoﬀs.21 These projections are not necessarily
positive but are such that (16) does hold. The nominal stochastic discount factor
derived from preferences coincides with this unique projection having included an
21

See Brandt et al. (2005) and Cochrane (2001) for a discussion.

21

additional component of uninsurable risk. In particular, with rational expectations
and isoelastic consumption utility, (43) still holds with the addition of a component
υ t+1 such that Et υ t+1 = 0
∆ct+1 − ∆c∗t+1 = ψ∆qt+1 + υ t+1 .
Properties of υ t+1 in relation with the other observable variables can explain the data.
The failure of condition (43) points toward several explanations: i) measurement
and sampling errors; ii) incompleteness of financial markets; iii) incorrect preference
specification; iv) a combination of i) − iii). Recently Kocherlakota and Pistaferri
(2007) have proposed a test for the joint hypothesis of complete markets and correct
preference specification. By defining the variable χt as
χt ≡ ∆qt −

1
(∆ct − ∆c∗t ),
ψ

they suggest that a regression of χt on ∆qt should have a slope equal to zero for the
null hypothesis to be true. Repeating their test with logarithmic utility, I confirm a
rejection of the standard model, because the slope coeﬃcient is 1.02 with a standard
deviation of 0.02 and the constant in the regression is -0.001 with a standard deviation
of 0.0009. Kocherlakota and Pistaferri (2007) proposes a model with heterogeneity of
consumers at the country level to pass this test. A similar test can be also performed
for the model presented in this paper having defined
1
χt (γ, γ ∗ ) ≡ ∆qt − (∆ct − ∆c∗t ) + ln gt (γ) − ln gt∗ (γ ∗ ),
(44)
ψ
where in the appendix I show how to evaluate ln gt and ln gt∗ up to a second-order
approximation obtaining
µ
¶
1
1
1
ln gt (γ) = −(γ − 1)St ∆ct − (γ − 1)(1 − β) 1 −
St c2t − (γ − 1)2 vart−1 (St ∆ct ),
2
ψ
2
(45)
and
¶
µ
1
1 ∗
∗
∗
∗ 1
∗
2
∗
ln gt (γ ) = −(γ −1)St ∆ct − (γ −1)(1−β) 1 −
St c∗2
t − (γ −1) vart−1 (St ∆ct ).
2
ψ
2
(46)
∗
∗
I regress χt (γ, γ ) on ∆qt for diﬀerent values of γ and γ and ψ. Figure 1 (for ψ = 0.8),
Figure 2 (for ψ = 1) and Figure 3 (for ψ = 1.2) report the p-values of a Wald test in
which the null hypothesis is that both the coeﬃcient and the slope of the regression
are zeros for a wide range of the parameters γ and γ ∗ .
22

0.3
0.3

14

0 .3

0 .5

0 .5

0.7

8
0.6
0.7
0 .8

0 .9

0 .1

0.
6

6

0.5
0.4

3
0.

0.
2

4

2

0 .5
0.6

0 .6
4
.
5
.
0
00 0 8.7
4
6

5
0.

4
0. .2
01
0.

0.3

4
00. ..12
0

0.3

0. 0.1
3

2
0.

2

0. 0
7 .8

γ∗

2
0.
0.1

0.6

10

0.
3

0.4

0.4

12

0.3

0.4

8
γ

10

12

14

Figure 1: p-value of the Wald test on the null hypothesis that the intercept and
slope of the regression of χt (γ, γ ∗ ) (defined in 44) on ∆qt are both zeros. ψ = 0.8.
First, note that with rational expectations the test is always rejected. With near
rationality, it is instead possible to find values of γ and γ ∗ such that the test is not
‘easily’ rejected. In particular when ψ = 0.8, there is a wide range of parameters for
which the test is accepted which are also consistent with the home-bias result of Table
1 for the region in which γ > γ ∗ . Instead when ψ = 1 or ψ = 1.2, the acceptance
regions require γ ∗ > γ.

23

14

12

6

0 1 .10.14
0. 00..00
02 .068 2

γ∗

8

2
0.0

10

0.
04

04
0.

4

2
2

4

6

8
γ

10

12

14

Figure 2: p-values of the Wald test on the null hypothesis that the intercept and
slope of the regression of χt (γ, γ ∗ ) (defined in 44) on ∆qt are both zeros. ψ = 1.

24

γ∗

2
0.

0.7

10
0.8

2
0.

1
0.

1
0.

0.
5 0. 0
6 .7

6

4

0.4

0 .6

12

8

5
0.

0.5

0.
3

0.

2

1
0.

0 . 0. 6
5
0.
4
0.
3

14

4 .3
0. 0
1
0.

2
2

4

6

8
γ

10

12

14

Figure 3: p-values of the Wald test on the null hypothesis that the intercept and
slope of the regression of χt (γ, γ ∗ ) (defined in 44) on ∆qt are both zeros. ψ = 1.2.

6

Estimation of the degree of near-rationality

The results described in the previous sections depend critically on the values assumed
by the parameters γ and γ ∗ and their relationship. With a unitary elasticity of substitution, robust preferences coincide with Epstein-Zin preferences so that I could use
in principle the results of the latter literature to calibrate the parameters of interest.
However, Barillas et al. (2007) have shown that γ and γ ∗ are related to detection
error probabilities and vary as the ‘true’ model probability distribution changes. Here
I observe that under the ‘true’ probability distribution, the portfolio model presented
in the previous sections provides some important moment restrictions on asset returns
that can be estimated to get inference on the degree of near-rationality. In particular
25

the moment restrictions of interest are given by equations (23), (24), (25) and (26) in
which the degree of near-rationality acts as a perturbation to the standard stochastic
discount factor. Let Γ = (γ, γ ∗ ). Starting with (23) I note that I can write
1

Et [βe− ψ ∆ct+1 −πt+1 +ln gt+1 +rt+1 ] = 1
where all the variables are observable except for ln gt+1 . However, I have shown that
g can be approximated and expressed in terms of observable variables, the higher the
order of approximations the better is the approximation of g. I choose a second-order
approximation as in (45) and (46). The forecasting model of the previous section can
be used to compute gt . I can then write more compactly
Et p(Γ, ψ, β, yt+1 ) = 0
for an appropriate vector yt+1 of observable variables and an appropriate function
p(·). In a similar way, I can write the other arbitrage restrictions (24), (25) and (26)
in a way to obtain a set of moment restrictions of the form
Et {p(Γ, ψ, β, yt+1 ) ⊗ dt } = 0
for an appropriate vector of functions p(·) and set of instruments d, where dt = [∆ct
π t ∆c∗t π ∗t , rt rt∗ ]. I assume β equal across countries and such that β = 0.995 as in
Barillas et al. (2007). I perform two kinds of GMM estimation: one in which I use
the identity weighing matrix and the other using the “eﬃcient” matrix.22 Table 3
shows the results for three assumptions on ψ: ψ = 0.8, ψ = 1, ψ = 1.2.23
22

As discussed in Cochrane (2001), it is not obvious that the eﬃcient estimate should be preferred
when asset returns are considered.
23
The initial value for the parameters in the GMM estimation is obtained by grid search on
the minimum of the GMM objective function when the weighing matrix is the identity matrix.
Moments are de-meaned, the eﬃcient matrix is computed using the Newey-West method, with lags
T 1/3 . Results are similar with no de-meaned moments except for lower values for the J statistics.

26

Table 3: GMM estimation
ψ = 0.8
(1)
(2)

γ
γ∗

5.76

(3.52)

2.46

(1.01)

ψ=1
(1)
(2)

5.73

9.17

(0.21)

(6.31)

2.37

6.84

(0.07)

(4.22)

6.83

(1.21)

5.41

(0.73)

ψ = 1.2
(1)
(2)

3.38

(3.22)

3.28

(0.84)

2.90

(0.33)

2.77

(0.28)

J − stat 29.85 48.46 40.42 40.40 35.96 36.25

(1) One-step GMM with identity weighing matrix
(2) Two-step GMM with eﬃcient weighing matrix

In general γ and γ ∗ depends on the assumption of ψ, but γ is always above γ ∗ .
This is consistent with the range of values in which the model is more successful in
explaining home bias according to Table 1. However, I have shown in the previous
section that only when ψ = 0.8 the model is also robust to the Backus-Smith anomaly.
It is now interesting to add that the point estimates of γ and γ ∗ when ψ = 0.8 are
in the region of passing the Backus-Smith anomaly with a high p-value, as shown in
Figure 1.

7

Conclusion

This paper has shown that a model in which agents are near-rational can explain
an imperfect degree of international portfolio diversification. At the same time this
environment breaks the tight link between cross-country consumption diﬀerentials
and the real exchange rate implied by standard preference specifications explaining
27

the Backus-Smith anomaly. There are other puzzling features of the data that perhaps
can be explored within this framework. Brandt et al. (2005), have argued that
standard preferences fail to account for the high correlation of stochastic discount
factors that would be implied by the prices of financial assets. Colacito and Croce
(2006) using Kreps-Porteus preferences have provided an explanation of this anomaly.
Since there is a parallel between Kreps-Porteus preferences and the near-rational
preferences of this paper with a unitary elasticity of substitution, it might be possible
that this model can be also successful in this direction. I leave this analysis for
future research. The model presented here enriches the stochastic discount factor
with additional terms that have been found to be critical in explaining the equity
premium puzzles (see Barillas et al, 2006) and the shape of yield curve (see Piazzesi
and Schneider, 2006). It is possible that this model can reconcile other puzzling
features of the data of the macro-finance literature in open economies.

28

References
[1] Barillas, Francisco, Hansen Lars and Thomas Sargent (2006), “Doubts or Variability?” unpublished manuscript, New York University.
[2] Bertaut, Carol C. and William L. Griever (2004), “Recent Developments in
Cross-Border Investment in Securities,” Federal Reserve Bulletin (Winter): 1931.
[3] Brandt, MW, Cochrane, John and Pedro Santa-Clara (2005), “International
Risk-Sharing is Better than You Think (or Exchange Rates are Much Too
Smooth),” Journal of Monetary Economics, 53, 671-698.
[4] Campbell, John (1999), “Asset Prices, Consumption, and the Business Cycle,”
chapter 10 in John Taylor and Michael Woodford (eds), Handbook of Macroeconomics, Vol. 1, North-Holland, Amsterdam.
[5] Cochrane, John (2001), Asset pricing, Princeton: Princeton University Press.
[6] Coeurdacier, Nicolas (2005), “Do Trade Costs in Goods Market Lead to Home
Bias in Equities?” unpublished manuscript.
[7] Coeurdacier, Nicolas, Philippe Martin and Robert Kollmann (2007), “International Portfolio Choices with Supply, Demand and Redistributive Shocks,” unpublished manuscript.
[8] Colacito, Riccardo and Massimiliano Croce (2006), “Risks for the Long Run and
the Real Exchange Rate,” unpublished manuscript, New York University.
[9] Cole, Harold and Maurice Obstfeld (1991), “Commodity Trade and International
Risk Sharing: How Much Do Financial Markets Matter?” Journal of Monetary
Economics, Vol. 28, pp. 3-24.
[10] Devereux, Michael B. and Alan Sutherland (2006), “Solving for Country Portfolios in Open Economy Macro Models,” unpublished manuscript.
[11] Engel, Charles and Akito Matsumoto (2006), “Portfolio Choice in a Monetary
Open-Economy DSGE Model,” NBER working paper No. 12214.

29

[12] Epstein, Larry and Jianjun Miao (2003), “A Two-Person Dynamic Equilibrium
under Ambiguity,” Journal of Economic Dynamics and Control 27, 1253-1288.
[13] Epstein, L. and S. Zin (1989), “Substitution, Risk Aversion and the Temporal Behavior of Consumption and Asset Returns: A Theoretical Framework,”
Econometrica 57, pp. 937-969.
[14] Hansen, L.P., J.C. Heaton, and N. Li (2005), “Consumption strikes back? Measuring Long Run Risk,” unpublished manuscript, University of Chicago.
[15] Hansen, Lars and Thomas Sargent (2005), “Robust Estimation and Control under Commitment,” Journal of Economic Theory 124, 258-301.
[16] Hansen, Lars and Thomas Sargent (2006), Robustness, unpublished manuscript.
[17] Heatcote, Jonathan and Fabrizio Perri (2004), “The International Diversification
Puzzle is Not as Bad as You Think,” unpublished manuscript.
[18] Judd, Kenneth and Sy-Ming Guu (2001), “Asymptotic methods for asset market
equilibrium analysis,” Economic Theory, 18(1), 127-157.
[19] Kocherlakota, Narayana and Luigi Pistaferri (2007), “Household heterogeneity
and real exchange rates,” The Economic Journal 117, C1-25.
[20] Kollmann, Robert (2006), “International Portfolio Equilibrium and the Current
Account,” unpublished manuscript, University of Paris XII.
[21] Kreps, D. M. and E. L. Porteus (1978), “Temporal Resolution of Uncertainty
and Dynamic Choice,” Econometrica 46: 185-200.
[22] Maenhout, Pascal J. (2004), “Robust Portfolio Rules and Asset Pricing,” The
Review of Financial Studies, Vol. 17, 951-983.
[23] Maenhout, Pascal J. (2006), “Robust Portfolio Rules and Detection-Error Probabilities for a Mean-Reverting Risk Premium,” Journal of Economic Theory,
Vol. 128, 136-163.
[24] Osborne, Martin and Ariel Rubinstein (1994), A Course in Game Theory.

30

[25] Obstfeld, Maurice (2006), “International Risk Sharing And the Costs of Trade,
” The Ohlin Lectures, unpublished manuscript.
[26] Obstfeld, Maurice and Kenneth Rogoﬀ (1996), Foundations of International
Macroeconomics, The MIT Press.
[27] Obstfeld, Maurice and Kenneth Rogoﬀ (2001), “The Six Major Puzzles in International Macroeconomics: Is There a Common Cause?” NBER Macroeconomics
Annual, Vol. 15 pp. 339-390.
[28] Pathak, Parag (2002), “Notes on Robust Portfolio Choice,” unpublished manuscript.
[29] Pesenti, Paolo and Eric van Wincoop (2002), “Can Non-Tradables Generate
Substantial Home Bias,?” Journal of Money, Credit and Banking 34(1), 25-50.
[30] Piazzesi, Monika and Martin Schneider (2006), “Equilibrium Yield Curve,” forthcoming in NBER Macroeconomic Annual 2006.
[31] Restoy, Fernando and Philippe Weil (2004), “Approximate Equilibrium Asset
Prices,” unpublished manuscript, ULB.
[32] Rogoﬀ, Kenneth (1996), “The Purchasing Power Parity Puzzle,” Journal of Economic Literature, vol. 34(2), 647-668.
[33] Tallarini (2000), “Risk-Sensitive Real Business Cycle,” Journal of Monetary Economics 45: 507-532.
[34] Tille, Cedric and Eric van Wincoop (2006), “International Capital Flows,” unpublished manuscript, University of Virginia.
[35] Uppal, R. (1993), “A General Equilibrium Model of International Portfolio
Choice,” Journal of Finance 48(2), 529-553.
[36] Uppal, R. and T.Wang (2003), “Model misspecification and underdiversification”, Journal of Finance 58, 2465—2486.
[37] Van Nieuwerburgh, Stijn and Laura Veldkamp (2007), “Information Immobility
and the Home Bias Puzzle,” unpublished manuscript, New York University.
31

[38] Van Wincoop, Eric and Francis Warnock (2006), “Is Home Bias in Assets Related
to Home Bias in Goods?” unpublished manuscript, University of Virginia.
[39] Vissing-Jœrgensen, Annette and Orazio P. Attanasio (2003), “Stock-Market Participation, Intertemporal Substitution and Risk-Aversion,” American Economic
Review. Vol. 93(2): 383-391.
[40] Weil, Philippe (1990), “Nonexpected Utility in Macroeconomics,” Quarterly
Journal of Economics 105(1): 29-42.
[41] Woodford, Michael (2006), “Robustly Optimal Monetary Policy with NearRational Expectations,” unpublished manuscript, Columbia University.

8

Appendix

Derivation of equation (39).
With general isoelastic preferences, the domestic and foreign stochastic discount
factors are given by
Mt+1 = β

µ

Ct+1
Ct

¶− ψ1

Pt
gt+1
Pt+1

Mt+1 = β

µ

∗
Ct+1
Ct∗

¶− ψ1

Pt∗ ∗
gt+1 .
∗
Pt+1

I am interested in evaluating (36) and in particular
1
∗
∗
∗
+ ∆Ŝt+1 = − [(Ĉt+1 − Ĉt ) − (Ĉt+1
− Ĉt∗ )] + ∆Q̂t+1 + ĝt+1 − ĝt+1
,
M̂t+1 − M̂t+1
ψ
where variables with hats represent log-deviations of the respective variables with
respect to the steady state. A first-order approximation to (21) and (22) implies
respectively that
1
Et ∆Ĉt+1 = Et (R̂p,t+1 − π t+1 ),
(47)
ψ
1
∗
∗
Et ∆Ĉt+1
= Et (R̂p,t+1
− π ∗t+1 ),
(48)
ψ

32

∗
∗
since to a first-order Et ĝt+1 = Et ĝt+1
= 0, where π t ≡ ln Pt /Pt−1 and π ∗t ≡ ln Pt∗ /Pt−1
.
By taking the diﬀerence between (47) and (48) I obtain that

1
∗
Et (∆Ĉt+1 − ∆Ĉt+1
) = Et ∆Q̂t+1 ,
ψ

(49)

∗
since Et (R̂p,t+1 − R̂p,t+1
− ∆Ŝt+1 ) = 0 to a first order approximation.
Consider the flow budget constraint of the home economy given by

Wt
Wt−1 Pt−1
= Rp,t
− Ct
Pt
Pt−1 Pt
and its first-order approximation
β ŵt = ŵt−1 + R̂p,t − π t − (1 − β)Ĉt

(50)

where wt ≡ Wt /Pt and
R̂p,t = (1 − ᾱ2 )R̂t + ᾱ2 (R̂t∗ + ∆Ŝt ).
As well, consider the flow budget constraint of the foreign economy given by
∗
St Wt∗
∗ St−1 Wt−1 St Pt−1
= Rp,t
− Ct Qt
Pt
Pt−1 St−1 Pt

and its first-order approximation
∗
∗
β ŵt∗ = ŵt−1
+ R̂p,t
− π t + ∆Ŝt − (1 − β)(Ĉt∗ + Q̂t )

(51)

where wt∗ ≡ St Wt∗ /Pt and
∗
= ᾱ2 (R̂t − ∆Ŝt ) + (1 − ᾱ2 )R̂t∗ .
R̂p,t

Note that in equilibrium wt + wt∗ = 0. The diﬀerence between equations (50) and (51)
implies
R
β ŵtR = ŵt−1
− (1 − 2ᾱ2 )ert − (1 − β)(ĈtR − Q̂t ),
(52)
where a variable with a upper-script R denotes the diﬀerence between the home and
foreign variables. I can combine (49) and (52) in a system of the form
Ã
! "
#Ã
!
" #
" #
1 0
zt+1
zt
1
(1 − 2ᾱ2 ) 0
= β−1 1
−(1 −ψ)
Et ∆Q̂t+1 −
ert ,
Et
R
β
0
1
ŵtR
ŵt−1
β
β
33

where I have defined zt ≡ (ĈtR − Q̂t ). A stable solution is given by

R
ŵtR = ŵt−1
−

∞
X

β j ∆Q̂t+j − (1 − 2ᾱ2 )ert

(53)

X
1−β
β j ∆Q̂t+j − (1 − 2ᾱ2 )ert .
(1 − ψ)Et
β
j=1

(54)

R
(ĈtR − Q̂t ) = ŵt−1
+ (1 − ψ)Et

j=1

∞

To complete the evaluation of the nominal discount factor, I need to specify how
departures from rational expectations aﬀect it. In particular I need to solve for the
optimal paths of gt and gt∗ . To evaluate (36), it is just suﬃcient a first-order approximation of gt and gt∗ . Since Sections 5 and 6 use also a second-order approximation, I
directly solve for the second-order approximation and use the first-order approximation when needed.
A second-order approximation of (32) implies that
µ
¶
µ
¶
¡
¢
1
1
1 2
2
1−
λ̃t = −Ĉt −
Ĉ + β λ̄Et ĝt+1 + ĝt+1 − βθEt ĝt+1 + ĝt+1
2
ψ
2
+βEt λ̃t+1 + βEt λ̃t+1 ĝt+1

where λ̃t = λt − λ̄ and I have normalized steady-state consumption to one. Since
Et gt+1 = 1, it follows that
µ
¶
1 2
Et ĝt+1 + ĝt+1 = 0.
2
I can then simplify the above expression to
µ
¶
1
1
βθ
2
1−
λ̃t = −Ĉt −
+ βEt λ̃t+1 + βEt λ̃t+1 ĝt+1 .
Ĉt2 − Et ĝt+1
2
ψ
2
A second-order approximation of (33) implies that
¶
µ
1 2
βθĝt+1 + β(θ − λ̄) Ĝt + Ĝt + βθĜt ĝt+1 + µ̃t = β λ̃t+1 + β Ĝt λ̃t+1 .
2

(55)

(56)

By subtracting from (56) its expected value, I obtain that
1
ĝt+1 − Et ĝt+1 = (λ̃t+1 − Et λ̃t+1 )
θ
or

1
1
ĝt+1 = (λ̃t+1 − Et λ̃t+1 ) − vart ĝt+1 .
θ
2
34

(57)

Using (57) into (55), I obtain that
µ
¶
1
1
βθ
1−
λ̃t = −Ĉt −
Ĉt2 + vart ĝt+1 + βEt λ̃t+1
2
ψ
2
Note that the conditional variance are independent of time. After iterating forward
the above equation, it follows that
µ
¶ ∞
∞
X
1
1 X j
j
2
β (Et+1 − Et )Ĉt+1+j −
β (Et+1 − Et )Ĉt+1+j
1−
λ̃t+1 − Et λ̃t+1 = −
2
ψ j=0
j=0
from which I can get
X
1
β j (Et+1 − Et )∆Ĉt+1+j +
θ(1 − β) j=0
µ
¶ ∞
1 X j
11
2
β (Et+1 − Et )Ĉt+1+j
1−
−
2θ
ψ j=0
Ã∞
!
X
1
j
− 2
vart
β (Et+1 − Et )∆Ĉt+1+j
2θ (1 − β)2
j=0
∞

ĝt+1 = −

or
ĝt+1 = −(γ − 1)

∞
X
j=0

β j (Et+1 − Et )∆Ĉt+1+j +

µ
¶ ∞
1 X j
1
2
β (Et+1 − Et )Ĉt+1+j
− (γ − 1)(1 − β) 1 −
2
ψ j=0
Ã∞
!
X
1
− (γ − 1)2 vart
β j (Et+1 − Et )∆Ĉt+1+j .
2
j=0
A similar expression holds for the foreign economy
∗
= −(γ ∗ − 1)
ĝt+1

∞
X
j=0

∗
β j (Et+1 − Et )∆Ĉt+1+j
+

¶ ∞
µ
1 X j
1 ∗
∗2
β (Et+1 − Et )Ĉt+1+j
− (γ − 1)(1 − β) 1 −
2
ψ j=0
Ã∞
!
X
1 ∗
j
∗
.
− (γ − 1)2 vart
β (Et+1 − Et )∆Ĉt+1+j
2
j=0
35

To a first-order approximation the stochastic discount factors are given by
M̂t+1
∗
M̂t+1

∞
X
1
= − (Ĉt+1 − Ĉt ) − π t+1 − (γ − 1)
β j (Et+1 − Et )∆Ĉt+1+j
ψ
j=0

∞
X
1 ∗
∗
∗
∗
∗
= − (Ĉt+1 − Ĉt ) − π t+1 − (γ − 1)
β j (Et+1 − Et )∆Ĉt+1+j
.
ψ
j=0

It follows that when γ = γ ∗
∗
+ ∆Ŝt+1
M̂t+1 − M̂t+1

∞
X
1 R
R
R
= − (Ĉt+1 − Ĉt ) + ∆Q̂t+1 − (γ − 1)
β j (Et+1 − Et )∆Ĉt+1+j
.
ψ
j=0

(58)

Note that by using (53) and (49), I can get that
∞
X
j=0

R
β j (Et+1 − Et )∆Ĉt+1+j
=

∞
X
j=0

β j (Et+1 − Et )∆Q̂t+1+j − (1 − 2ᾱ2 )ert+1 .

(59)

Moreover from (53) it follows that
(ĈtR

− ψ Q̂t ) =

R
ŵt−1

+ (1 − ψ)Et

from which
R
Ĉt+1

−

ĈtR

− ψ(Q̂t+1 − Q̂t ) =

∞
X
j=0

ŵtR

β j ∆Q̂t+j + (1 − ψ)Q̂t−1 − (1 − 2ᾱ2 )ert

+ (1 − ψ)Et+1

∞
X

β j ∆Q̂t+1+j + Q̂t +

j=0

−(1 − 2ᾱ2 )ert+1 − ĈtR
∞
X
R
= ŵt + (1 − ψ)
β j (Et+1 − Et )∆Q̂t+1+j
j=0

+Q̂t − (1 − 2ᾱ2 )ert+1 +
∞
X
β j ∆Q̂t+1+j .
−ĈtR + (1 − ψ)Et

(60)

j=0

Combining (60) and (59) into (58), I can finally obtain that
ψ(M̂t+1 −

∗
M̂t+1

+ ∆Ŝt+1 ) = −[1 − ψ + ψ(γ − 1)]

∞
X
j=0

β j (Et+1 − Et )∆Q̂t+1+j +

+[1 + ψ(γ − 1)](1 − 2ᾱ2 )ert+1 − ĈtR
∞
X
R
+ŵt + Q̂t + (1 − ψ)Et
β j ∆Q̂t+1+j .
j=0

36

I can now evaluate (36) to get
Ã∞
!
X
−[1−ψ+ψ(γ−1)]covt
β j (Et+1 − Et )∆Q̂t+1+j , ert+1 +[1+ψ(γ−1)](1−2ᾱ2 )vart ert+1 = 0
j=0

from which the steady-state share of home holdings of foreign assets is obtained as
³P
´
∞
j
j=0 β (Et+1 − Et )∆Q̂t+1+j , ert+1
1 1 [1 − ψ + ψ(γ − 1)] covt
ᾱ2 = −
2 2 [1 + ψ(γ − 1)]
vart ert+1
The result is equation (41), whereas (39) and (40) follow as special cases when respectively ψ = 1 and γ = 1.
When γ 6= γ ∗ , I can write
1 R
∗
M̂t+1 − M̂t+1
+ ∆Ŝt+1 = − (Ĉt+1
− ĈtR ) + ∆Q̂t+1 +
ψ
∞
X
1
∗
R
β j (Et+1 − Et )∆Ĉt+1+j
− (γ − 1 + γ − 1)
2
j=0
∗

−(γ − γ )

∞
X
j=0

W
β j (Et+1 − Et )∆Ĉt+1+j
.

(61)

Taking a weighted average of (50) and (51), it follows that
ĈtW =

1 1
1
(R̂t − π t + R̂t∗ − π ∗t + ∆Q̂t ) − Q̂t
21−β
2

from which
(1 − β)

∞
X
j=0

j

β (Et+1 −

W
Et )Ĉt+1+j

1X j
∗
=
β (Et+1 − Et )(R̂t+1+j − π t+1+j + R̂t+1+j
− π ∗t+1+j )
2 j=0
∞

=

∞
X
j=0

W
β j (Et+1 − Et )∆Ĉt+1+j
.

37

Using this result into (61), I can obtain
ψ(M̂t+1 −

∗
M̂t+1

∙

¸X
∞
ψ
∗
+ ∆Ŝt+1 ) = − 1 − ψ + (γ − 1 + γ − 1)
β j (Et+1 − Et )∆Q̂t+1+j +
2
j=0
¸
∙
ψ
+ 1 + (γ − 1 + γ ∗ − 1) (1 − 2ᾱ2 )ert+1 − ĈtR
2
∞
X
R
+ŵt + Q̂t + (1 − ψ)Et
β j ∆Q̂t+1+j −
j=0

∞
X

ψ
∗
(γ − γ ∗ )
β j (Et+1 − Et )(R̂t+1+j − π t+1+j + R̂t+1+j
− π ∗t+1+j )
2
j=0

from which equation (42) follows.
Data
The data used are constructed at quarterly frequency and on the sample 1970:Q1—
2005:Q4. Consumption data are taken from DATASTREAM. Real consumption corresponds to the mnemonic USCNPER.D (US personal consumption expenditure) for
the US and to UKCNHLD.D (UK final consumption expenditure) for the UK. The
variables ∆c and ∆c∗ are obtained after taking the log-diﬀerence of the respective
series. Inflation data are from DATASTREAM. Price indexes are obtained by taking the ratio of nominal and real consumption (USCNPER.B and USCNPER.D for
US and UKCNHLD.B and USCNPER.D for UK). The variables π and π ∗ are obtained by taking the log-diﬀerence of the price index data. Data on portfolio returns
are constructed as in Campbell (1999). For the UK, the source is Morgan Stanley
Capital Perspective and data have monthly frequency. Denoting with P It∗ the stock
market price index in local currency at time t, and with RIt∗ the return index. I con∗
∗
struct the dividend yield as DYt∗ = (RIt∗ /RIt−1
)/(P It∗ /P It−1
) − 1 and the dividend
∗
∗
∗
as Dt = 1.33 · DYt · P It where 1.33 enters because of a tax credit system of 33%;
∗
∗
∗
∗
the quarterly return is computed as rt−3,t
= (Dt∗ + Dt−1
+ Dt−2
+ Pt∗ )/Pt−3
− 1. I use
∗$
the UK stock-market price index in dollars (P It ) to build the dollar-pound nominal
exchange rate as St = P It∗$ /P It∗ , the variable ∆st corresponds to the log-diﬀerence of
the nominal exchange rate on a quarterly frequency. For the US stock market, data
are from CRSP using the mnemonic WRETD and WRETX on a monthly frequency.
The US stock-market price index is constructed as P It = P It−1 · (W RET Xt + 1)
38

with initial condition P I0 = 100, while the dividend yield corresponds to DYt =
(1 + W RET Dt )/(1 + W RET Xt ) − 1. Dividends are computed as Dt = DYt · P It and
the US stock-market return is computed as rt−3,t = (Dt + Dt−1 + Dt−2 + Pt )/Pt−3 − 1.
The excess return is computed as ert = rt∗ + ∆st − rt and the real exchange rate
as ∆qt = ∆st + π∗t − πt . Short-term interest rates are taken from the International
Financial Statistics of the IMF and they corresponds to the mnemonic 11260C..ZF...
for the UK and 11160C..ZF... for the US. Data are taken at quarterly frequency to
construct the variables rtf and rtf ∗ .

39

