NBER WORKING PAPER SERIES

GRAVITY, PRODUCTIVITY AND THE PATTERN OF PRODUCTION AND TRADE
James E. Anderson
Working Paper 14642
http://www.nber.org/papers/w14642

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
January 2009

I am grateful to Christian Broda for helpful comments on the first version of this paper at the NBER
ITI Summer Institute, 2007. I thank participants in seminars at Drexel University, Brandeis University
and Oxford University for comments on earlier versions, and Susanto Basu for helpful discussions
of productivity. The views expressed herein are those of the author(s) and do not necessarily reflect
the views of the National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
Â© 2009 by James E. Anderson. All rights reserved. Short sections of text, not to exceed two paragraphs,
may be quoted without explicit permission provided that full credit, including Â© notice, is given to
the source.

Gravity, Productivity and the Pattern of Production and Trade
James E. Anderson
NBER Working Paper No. 14642
January 2009, Revised October 2009
JEL No. D24,F10
ABSTRACT
The effects of geography and productivity on the global pattern of production are captured here in
a specific factors gravity model. Simple enough for sharp results, the model is yet rich enough to contain
the high dimensional productivity frictions in production and distribution of a many country world.
The starting point is the international incidence of productivity frictions inferred from gravity. Sellersâ€™
and buyersâ€™ incidence both reduce real income. Sellersâ€™ incidence shocks reduce sectoral skill premia.
Bigger sellersâ€™ incidence by country (sector) reduces equilibrium shares of world (national) GDP.
In contrast to the generalized Ricardian gravity model of Eaton and Kortum (2002), relative factor
endowments play a role and import-competing production and wage premia in exporting are featured.

James E. Anderson
Department of Economics
Boston College
Chestnut Hill, MA 02467
and NBER
james.anderson.1@bc.edu

Geography obviously has big effects on the global pattern of income and production. But
geography has been difficult to capture in models simple enough to apply yet rich enough
to reflect the high dimensionality of distribution frictions in a many country world. A key
difficulty is that frictions in the productivity of both distribution and production impact
production and expenditure patterns through their incidence on buyers and sellers. This
paper applies the incidence measures of the structural gravity model to a many-countriesmany-goods specific factors general equilibrium model of resource allocation. It provides a
very sharp characterization of the effect of gravityâ€™s incidence on on production patterns,
real incomes and internal income distribution.
The structural gravity model yields convenient operational measures of buyersâ€™ and sellersâ€™ incidence of productivity frictions in distribution, aggregated over trade partners at the
sectoral level. See Anderson and Yotov (2008) for details and evidence on the incidence of
trade costs of 2 digit sectors in Canadaâ€™s provinces.1 Their evidence shows that buyersâ€™ or
sellersâ€™ incidence is weakly, sometimes negatively correlated with Total Factor Productivity
(TFP) type measures, so the latter may be very misleading when the purpose of the analysis
requires incidence. Incidence falls mostly (3 to 5 times more) on the supply side and its variation is large across countries and across sectors within countries. Most strikingly, sellersâ€™
incidence falls over time (1992-2003) despite constant gravity coefficients, due to changing
shipment shares. This finding suggests the importance of modeling causation running from
incidence to shipment shares, the focus of this paper.
The model features the incidence of TFP frictions that combine sectoral distribution
frictions with Hicks neutral productivity frictions in production. In contrast to TFP, which
is defined at constant prices, incidence decomposes TFP into its impact on buyersâ€™ and
sellersâ€™ prices throughout the global economy. The applied literature has by default used
partial equilibrium TFP measures of the effects of geography. For example, Redding and
Venables (2004) link the pattern of production to TFP-type measures in distribution while
1
See Anderson (1979) and Anderson and van Wincoop (2003, 2004) for further discussion of the structural
gravity model.

the large literature on openness and comparative performance has used measures that at
best (e.g., land-lockedness) instrument for TFP in distribution.
The main focus of the paper is the effect of sellersâ€™ incidence on resource allocation.
Resource allocation across sectors in each national economy can be modeled without regard
to distribution over trade partners within sectors under trade separability (Anderson and van
Wincoop, 2004): national varieties form separable groups in preferences and technology in
each sector, and distribution requires resources in the same proportions as does production
(iceberg trade costs). Full general equilibrium arises when the intra- and inter-sectoral
modules are mutually consistent.
Standard general equilibrium production theory yields only weak results in the form
of a positive correlation between sellersâ€™ prices and sectoral output. The specific factors
production model developed here provides much sharper results in closed form solutions
that provide intuitive insight into how geography shapes economic outcomes. In addition to
this modeling advantage, specific factors provide descriptive realism in that export intensity
is correlated in the model with sectoral wage premia.
There are two factors of production in the main version of the model. Unskilled labor
is intersectorally mobile. Skilled labor is mobile prior to production as well, but it acquires
sector specific attributes between allocation and use in production. After sector specific skills
are acquired, productivity shocks are realized, the ex post efficient allocation of unskilled labor occurs, resulting in production and consumption at world market clearing prices. Neither
factor of production is internationally mobile. The market structure is competitive in the
main body of the paper; monopolistic competition is treated in the Appendix. The tractability of the model makes it suitable for adaptation to empirical work on the one hand and to
theoretical refinement on the other hand. Extensions of the basic model here to many specific factors, intermediate goods, selection to exporting and monopolistic competition retain
the main qualitative properties of the simpler model.
The equilibrium (multi-) factoral terms of trade are negatively related across countries to

2

country size and to the sellersâ€™ incidence of TFP, and positively related to allocative efficiency.
Effective country size is the ratio of potential GDP to aggregate sellersâ€™ incidence of TFP
frictions, as if frictions melt away a portion of potential GDP. Equilibrium Gross Domestic
Product (GDP) is increasing in effective country size with elasticity between zero and one,
due to the terms of trade effect of country size. Real incomes are additionally reduced by
the buyersâ€™ incidence of TFP. Looking across sectors within a country, the sector specific
skill premium is reduced by high sellersâ€™ incidence of productivity frictions. Equilibrium
production shares are increasing in sector specific factor endowments and goods/variety
taste parameters, and decreasing in the equilibrium sellersâ€™ incidence of TFP frictions.
The efficient ex ante allocation of skilled labor is characterized under risk neutrality.
Looking across countries, given ex ante efficiency, higher variance of the incidence of productivity shocks lowers ex post production efficiency, as is intuitive. It is plausible that the
national variance of the incidence rises with the mean, implying that ex post inefficiency
is larger for economies with higher average trade costs. Within countries, higher sectoral
variance raises ex ante efficient skill allocations under risk neutrality because sector specific
factor returns are convex in productivity.
The closest related model is that of Eaton and Kortum (2002). They embed gravity
in a Ricardian model of trade featuring productivity differences resulting from draws from
nationally differing Frechet distributions. In equilibrium the model is observationally equivalent to the one good/many varieties gravity model (see Anderson and van Wincoop, 2004).
Costinot and Komunjer (2007) extend the Eaton-Kortum framework to a multi-good setting.
The specific gravity model here nests the Costinot-Komunjer model as a special case when
the efficient allocation of skilled labor is made after the realization of productivity draws.2
The specific factors model has several advantages in descriptive power relative to the
generalized Ricardian model. First, unlike the Ricardian model it is consistent with importcompeting production, action on the intensive margin and the attendant political economy
2

Inessentially, the nesting applies to a monopolistic competition version of the Eaton-Kortum-CostinotKomunjer models and the specific gravity model.

3

of protection. Second, it features an empirically realistic income distribution. Ex post specificity combines with productivity shocks to generate the well documented phenomenon of
sectorally heterogeneous returns to otherwise identical skilled labor, positively correlated
with export intensity.3 Finally, the model allows a role for relative factor endowment differences in explaining the pattern of production and trade. An important aspect is the ex ante
allocative efficiency of he ex post specific factor. Other advantages not exploited here include
linkage to the interest group political economy model of trade policy. The tractability of the
model suggests that it is a useful platform for future development, especially for empirical
applications.
A less closely related recent literature that seeks to explain the pattern of production by
international differences in endowments and technology lacks an appropriate general treatment of trade costs. Davis and Weinstein (2001) use the multi-cone Heckscher-Ohlin continuum of products model, but effectively assume that all the incidence of trade costs is on the
demand side. Romalis (2004) considers the role of uniform trade costs in resource allocation
using the multi-cone Heckscher-Ohlin continuum model, but in a North-South model with
M identical countries in each half of the world. Trade costs disappear from his empirical
work via a substitution that is valid only using the high degree of uniformity of the model.
Treflerâ€™s HOV model (1995) allows for technology differences and home bias in preferences,
but the home bias is not connected with gravity.
Section 1 sets the stage by describing and distinguishing between TFP and its incidence
in a global economy. It describes how the supply side incidence of trade and productivity
frictions fit into a standard general model of production, yielding the usual weak correlation
relationship between sellersâ€™ incidence and production patterns. Section 2 sets out the specific
factors model of production. Section 3 derives and characterizes the world equilibrium
3

Anderson (2009) applies the specific factors production model to the two country homogeneous products
case with uniform trade costs, focusing on the comparative static effect of globalization on income distribution. The present paper applies the same production model to many countries and differentiated products
with differentiated trade costs and focuses on characterizing cross section production and trade patterns as
well as income distribution. The general equilibrium comparative statics of the specific gravity model are
complex and left to future research.

4

reduced form pattern of production and trade. Section 4 analyzes efficient ex ante allocation
of specific factors facing random productivity draws in the world economy. Section 5 extends
the discussion to treat intermediate products trade and the implications of selection into
exporting. Section 6 concludes. The Appendix develops the endogenous determination of
varieties in monopolistic competition, and fills out the connection of the model with the
Costinot-Komunjer model. It also reviews selection into exporting.

1

TFP Frictions, Incidence and General Equilibrium

Each country produces and distributes goods to its trading partners. Production for given
resources is reduced from its maximal potential by a (Hicks neutral) productivity deflator
ajk â‰¥ 1 for product k in country j. Thus for product k in country j, ajk âˆ’ 1 more factors are
used than needed with the ideal practice. Distribution to destination h requires additional
factors to be used, in the proportion Tkjh âˆ’ 1 to their use in production: the metaphor of
iceberg-melting distribution costs.
j jh j
The cost at destination h is given by pjh
ek , where pejk is the unit cost of production
k = ak Tk p

using ideal practice, or the â€˜efficiency unit costâ€™. The aâ€™s and T â€™s thus combine in a bilateral
j jh
productivity friction measure tjh
k â‰¡ ak Tk that contains both distribution and productivity

frictions. This useful simplification is exploited everywhere in what follows.4
The TFP friction in each sector k for each origin j is the appropriate aggregator of {tjh
k }
across destinations for delivery h. Let ykjh denoted delivered product k from j to destination
h. The appropriate aggregator tÌ„jk is derived as follows. Let g j (e
pj , v j ) be the maximum value
Gross Domestic Product (GDP) function for country j, defined as:

max
{ykjh }

X
h,k

jh
pejk tjh
k yk |

X

jh
j
j
tjh
k yk = fk ({vk })âˆ€k,

h,k

X

vkj = v j ,

k

4
The decomposition of t into T â€™s and aâ€™s is always available, but mostly a distraction here. The metaphor
of iceberg melting trade costs extends to productivity frictions that â€˜meltâ€™ resources before the shipments
begin their journey to market.

5

where v j is the endowment vector, fkj is a degree one homogeneous concave production
function and vkj is the vector of inputs in sector k. The first order conditions imply that
the tâ€™s disappear as active arguments in the GDP function. Sectoral TFP friction is defined by the uniform friction that preserves the value of sectoral shipments at destination
P
jh
jh P
prices: tÌ„jk = h tjh
k yk /
h yk . Aggregate TFP friction for country j is similarly given by
P
j j jh P
ek yk / k,h pejk ykjh . This is equal to the ratio of GDP at delivered prices to the value
k,h tÌ„k p
of output at factory gate efficiency unit prices.
TFP measurement takes efficiency unit prices pejk as given. While conceptually clean
and useful for analyzing productivity, TFP is misleading for purposes of understanding
comparative economic performance and the pattern of production and trade. Proposition
1 below shows that real incomes depend on aggregate sellersâ€™ incidence while Proposition 3
shows that sectoral GDP shares are decreasing in sectoral sellersâ€™ incidence.
The key building block is incidence decomposition and aggregation at the sectoral level
using the properties of the structural gravity model. Like sectoral TFP friction tÌ„jk , bilateral
frictions are aggregated, but using only their sellersâ€™ incidence portion. Buyersâ€™ incidence
of bilateral frictions is similarly aggregated. The standard partial equilibrium one good
incidence analysis breaks the trade friction t into sellersâ€™ incidence Î  and buyersâ€™ incidence
P with t = Î P . The decomposition uses the hypothetical frictionless equilibrium price pâˆ—
such that with actual equilibrium volume and buyersâ€™ price p and sellersâ€™ price pe, peÎ  = pâˆ—
and p = pâˆ— P .
The structural gravity model yields a set of Î jk â€™s and Pkh â€™s such that if the actual trade
j h
costs were replaced by hypothetical trade costs {tÌ„jh
k = Î k Pk }, all total shipments at delivered

value Ykj and all total expenditures at delivered value Ekh would remain constant while the
bilateral shipments would shift to their frictionless equilibrium values (given the Y â€™s and
Eâ€™s). It is thus a proper generalization of the partial equilibrium incidence analysis. The
Appendix reviews the details.
With efficiency unit production cost pejk in country j, it is as if there was an average
6

(â€˜worldâ€™) destination price for goods k delivered from j, pjk = pejk Î jk . Similarly, on the demand
side it is as if a single composite good k shipped to h from a world market at markup
Pkh . Anderson and van Wincoop (2004) call Î â€™s and P â€™s outward and inward multilateral
resistances, respectively.
Total shipments and expenditures are taken as given in the calculation of Î â€™s and P â€™s in
conditional general equilibrium. The full general equilibrium requires that the allocations of
resources (resulting in Y â€™s) and expenditure at the upper level (Eâ€™s) for given incidences be
consistent with the allocations (Y â€™s and Eâ€™s) that generate those same incidences in the lower
level. The separation into intra-sectoral and inter-sectoral modules is valid if the structure
is trade separable.
Trade separability requires a separable structure on demand and supply sides of the
world economy along with iceberg trade costs. On the demand side, each product group
k has a natural aggregator with aggregate price index Pkh for country h. Pkh is used for
the price index as well as the buyersâ€™ incidence here because in equilibrium they are the
h
same. Expenditure across groups is allocated with the expenditure function e(P1h , ..., PM
, uh ),

concave and homogeneous of degree one in the P â€™s. On the supply side, aggregate production
in each sector is allocated across trade partners with perfect substitutability, so each sectorâ€™s
P
product forms a natural separable group ykj = h ykjh .5 On the demand side, Ekh = ehk Pkh .
On the supply side, Ykj = pejk gkj = sjk g j where sjk is the GDP share in j accounted for by good
k and gkj â‰¡ âˆ‚g j /âˆ‚ pejk .
The balanced trade budget constraint

P

k

Ykj =

P

k

Ekj is given by

j
g(e
pj , v j ) = ej (P1j , ..., PM
, uj )âˆ€j.

(1)

Given the prices, (1) is solved for the real incomes uj , âˆ€j.
General equilibrium requires meeting the system of budget constraints (1), the consis5

This assumption can be relaxed to allow imperfect substitutability among the destinations, but this
relaxation is inessential for present purposes.

7

tency requirements between upper and lower level allocations Ykj = pejk gkj , âˆ€k, j and Ekj =
ehk Pkh , âˆ€(k, h), and the sectoral market clearance requirements imposed in Appendix equations (24)-(25).
Impose CES preferences on the sub-expenditure functions, consistent with the structural
gravity model. The CES price index Pkh for goods class k in location h is defined by
Pkh â‰¡

X

1âˆ’Ïƒk 1/(1âˆ’Ïƒk )
]
,
[(Î²kj pejk tjh
k )

(2)

j

where (Î²kj )1âˆ’Ïƒk is a quality parameter for goods from j in class k 6 and Ïƒk is the elasticity of
substitution parameter for class k.
The expenditure share for class k in h, by Shephardâ€™s Lemma, is given by
âˆ‚Pkh pjh
k
h
âˆ‚pjh
k Pk

=

n Î² j pej tjh o1âˆ’Ïƒk
k k k
Pkh

.

The share of expenditure on k from all origins at destination h is given by

Î¸kh = ePkh

Pkh
.
eh

It simplifies the model inconsequentially to assume the upper level preferences are CobbDouglas, so that Î¸kh = Î¸k âˆ€h, a parameter. Expenditure on k in h is given by Ekh = ePkh Pkh ,
equal to Î¸k eh in the Cobb-Douglas case.
Market clearance with balanced trade requires that at delivered prices excess supply is
equal to zero:
sjk g j

âˆ’

X
h

Î¸k

n Î² j pej tjh o1âˆ’Ïƒk
k k k
Pkh

g h = 0,

(3)

âˆ€k, j. Substituting in (2), (3) determines the set of efficiency unit costs, pejk , one for each k
and j. (3) is homogeneous of degree zero in peâ€™s, understanding that the P â€™s are homogeneous
In monopolistic competition models, (Î²kj )1âˆ’Ïƒk is endogenous, equal to the proportion of all varieties of
class k that are produced by j. See the Appendix for a full treatment.
6

8

of degree one in the unit costs in their representation as CES cost of living indexes. Thus
relative unit costs only are determined.
Using the structural gravity methods of the Appendix, incidence is inferred from observed
Eâ€™s, Y â€™s and tâ€™s. Connecting (3) to structural gravity expressions, sjk g j = Ykj while Î¸k g h = Ekh
(imposing balanced trade). Connecting from gravity back to (3), the Appendix shows that
the complex second term on the left hand side of (3) that describes the actual allocation of
goods to destinations can be replace with a much simpler term representing a hypothetical
shipment of k from j to a world market at the uniform trade cost Î jk . Using Appendix
equation (22),
Ykj = (Î²kj pejk Î jk )1âˆ’Ïƒk Yk ,
where Yk â‰¡

P

k

Ykj . (Î²kj pejk Î jk )1âˆ’Ïƒk is recognized as the CES share equation for a hypothetical

world market where buyers face a uniform markup on pejk , and the adding up constraint on
P j j j 1âˆ’Ïƒ
the shares imposes a normalization on the Î â€™s for given peâ€™s:
ek Î k ) k = 1. Since
j (Î²k p
P
P
P
Yk = h Ekh , replace Yk with Î¸k h g h . Then substitute (Î²kj pejk Î jk )1âˆ’Ïƒk Î¸k h g h for the second
P
P
term on the left of (3) and divide through by j g h . Define Ï‰ j â‰¡g j / j g j , the world GDP
share of country j. Then (3) is re-written as:

sjk Ï‰ j = (Î jk )1âˆ’Ïƒk (Î²kj pejk )1âˆ’Ïƒk Î¸k .

(4)

(4) implies that sellersâ€™ incidence of TFP frictions on average reduces the equilibrium
efficiency unit prices pejk . The global equilibrium decomposes into a set of national equation
systems (4). g j is convex in pej . It can be shown that pej is negatively associated with Î j ,
in the sense that pej 0 [d ln pej + ((Ïƒk âˆ’ 1)/Ïƒk ))d ln Î j ] = 0.7 Pushing the interpretation of the
preceding expression harder, the â€˜averageâ€™ elasticity of peâ€™s with respect to Î â€™s is between 0
and âˆ’1, as it would be in a partial equilibrium analysis of (4). Finally, the convexity of the
7

P
Impose the normalization of prices j g j = 1. (4) can be rewritten using Hotellingâ€™s Lemma as gpj k (Â·) =
(Î jk )1âˆ’Ïƒk (Î²kj )1âˆ’Ïƒk (e
pjk )âˆ’Ïƒk Î¸k . Differentiate this system totally with respect to pej and Î j . Multiplying the
j
differential vector by pej and utilizing homogeneity properties of g j , pej 0 gpp
= 00 . Then the inner product
yields the expression above.

9

GDP function implies that dy j Â· de
pj â‰¥ 0, so higher sellersâ€™ incidence Î  tends in some loose
average way to induce lower supply looking across sectors.
In contrast to the very limited insight available from general technology, something like
partial equilibrium reasoning is valid in a special case of the specific factors model that may
stand in for approximate validity in a wider class of neoclassical production models for which
the full effects of simultaneous determination of prices in (4) precludes sharp results.

2

The Specific Factors Model

Unskilled labor is intersectorally mobile but in fixed supply to the economy. The sector
specific factor can be regarded for all purposes of analysis in this section and the next as an
aggregate of many types of factors that form a separable group in the production function,
including a variety of skilled labor types and capital. But for simplicity of exposition, reduce
this aggregate to a single factor, skilled labor. Skilled workers are in fixed total supply to the
economy prior to their acquisition of sector specific skills, after which they are in fixed supply
to each sector. Section 4 treats the allocation decision. Both factors are internationally
immobile. Deliveries are to final demand only until Section 5 introduces intermediate goods.
To ease notational clutter, the country superscript is suppressed where possible.
Supply is defined as the activity ykj needed to achieve delivered output vector (ykj1 , ..., ykjN ).
P
jh
Thus ykj = h tjh
k yk . Turning to the technology, supply in class k is given by
ykj = f kj (Ljk , Kkj ), âˆ€k,
where f kj is a concave homogeneous of degree one potential production function giving the
activity level of the ideal technology. Labor Ljk is mobile across sectors while Kkj is the
specific skill endowment.
More restrictive production functions serve several important modeling purposes. Assuming identical production functions across sectors and countries (up to a productivity scalar
10

a) ensures that the fully efficient equilibrium will be Ricardian (because the equilibrium
relative factor intensities will be identical), and thus the model will nest the Eaton-Kortum
and Costinot-Komunjer models. Imposing Cobb-Douglas structure on f (Â·) results in a closed
form solution for g with very convenient properties. First, aggregate factor shares are stable,
consistent with observed nearly constant shares across periods of time when the composition
of GDP has altered tremendously. Second, Stolper-Samuelson forces are shut down: the average skill premium is independent of international forces in the model. This is analytically
convenient for thinking about a world in which skill premia seem to be rising simultaneously in both rich and poor countries. Third, the GDP function has a constant elasticity of
transformation. Finally, when extending the interpretation to include many types of sector
specific factors it is more natural to impose that the natural aggregator is the same in each
sector. Temporarily, it eases notation to drop the country superscript.
P
Let K = k Kk and let fk = LÎ±k Kk1âˆ’Î± where Î± is the parametric share parameter for
labor. Then
g = LÎ± K 1âˆ’Î± G

(5)

X

(6)

where G is given by
G=[

Î»k (e
pk )1/(1âˆ’Î±) ]1âˆ’Î± ,

k

and Î»k = Kk /K, the proportionate allocation of specific capital to sector k.8 GDP is the
product of real activity in production and distribution R = LÎ± K 1âˆ’Î± and the real activity
deflator G. G is convex and homogeneous of degree one in the efficiency unit costs, the peâ€™s.
The elasticity of transformation is equal to Î±/(1âˆ’Î±), the ratio of laborâ€™s share to capitalâ€™s
share.9 The GDP share for any good k is given by:
1/(1âˆ’Î±)

Î»k pe
sk = pek yk /g = P k 1/(1âˆ’Î±) .
ek
k Î»k p
8

(7)

Solve the labor market clearance condition for the equilibrium wage, then use the Cobb-Douglas property
wL/Î± = g.
9
The CET form is commonly used in applied general equilibrium modeling. The micro-foundations
provided here may prove useful in this context.

11

3

World Trade Equilibrium

The equilibrium is solved for the specific factors Cobb-Douglas case by using (7) to substitute
for sjk in the market clearance equations (4).

3.1

Equilibrium Prices

Solve for the equilibrium efficiency unit costs as:

pejk

=

Dkj
Ï‰ j Î»jk (Î jk )Ïƒk âˆ’1

!(1âˆ’Î±)/Î·k
(Gj )1/Î·k

(8)

1âˆ’Ïƒk
where Dkj â‰¡ Î²kj
Î¸k and Î·k â‰¡ Î± + Ïƒk (1 âˆ’ Î±) > 1 in the empirically relevant case Ïƒk > 1.

(8) implies that equilibrium efficiency unit costs are increasing in the demand side driver
Dkj and decreasing in the supply side drivers Ï‰ j Î»jk (Î jk )Ïƒk âˆ’1 . Intuitively, bigger country size
Ï‰ j and bigger sectoral allocations of specific factors Î»jk reduce unit costs. Also, the higher
the incidence of productivity frictions Î jk , the lower must the unit cost be to compensate.
The GDP deflator Gj in the general equilibrium is the (multi-) factoral terms of trade. A
rise in the factoral terms of trade raises unit cost, all else equal.
The demand shifter Dkj is the product of a k specific component Î¸k reflecting tastes in
1âˆ’Ïƒk
the global economy for good k and a national origin â€˜qualityâ€™ parameter Î²kj
reflecting

tastes within goods class k for varieties from origin j. In monopolistic competition, Î²kj is
endogenously determined by the entry of firms in zero profit equilibrium.
The factoral terms of trade Gj are solved based on the equilibrium peâ€™s. The equilibrium
GDP shares are expressed as â€˜reduced formâ€™ equations in the international equilibrium using
(8) in (7).
sjk = Î»jk

Dkj
Î»jk (Î jk )Ïƒk âˆ’1 Ï‰ j

!1/Î·k
(Gj )(1âˆ’Ïƒk )/Î·k .

(9)

Use the adding up condition on the shares (9). Next, define the parametric â€˜real potential

12

GDPâ€™ Rj â‰¡ (Lj )Î± (K j )1âˆ’Î± , and note that Ï‰ j = Rj Gj /

1=

X

P

j

Rj Gj . Then

X
Gj Rj )1/Î·k , âˆ€j.
Î»jk [Dkj /Î»jk (Î jk )Ïƒk âˆ’1 Rj ]1/Î·k (Gj )âˆ’Ïƒk /Î·k (
j

k

The natural normalization for the price system is

P

j

Gj Rj = 1. Subject to the normalization

there is a unique solution because the right hand side of the sum of shares equation above
is decreasing in Gj .
The solution has a closed form when Ïƒk = Ïƒ, âˆ€k:
Gj = (Î›j /Rj )1/Ïƒ ,

(10)

where
j

Î› â‰¡

nX
k

Î»jk

n

o1/Î· oÎ·
Dkj
.
(Î jk )Ïƒâˆ’1 Î»jk

(11)

Î›j is an efficiency measure analyzed further below. Gj is decreasing in Rj interpreted as
relative country size.10 In contrast, Gj is increasing in both absolute and relative Î›j .11
Î›j decomposes into two intuitive components: a measure of harm from jâ€™s incidence of
TFP frictions and a measure of jâ€™s efficiency of skill allocation, the Î»â€™s. Aggregate incidence
of TFP friction is derived by equating the right hand side of (11) with the same function
evaluated at a uniform value of Î Ì„j and solving for Î Ì„j .

j

Î Ì„ =

Î›j ({Î jk })
Î›j (1)

!1/(1âˆ’Ïƒ)

where Î›j (1) denotes evaluation with Î jk = 1, âˆ€k : Î›j (1) = [
10

P

k

Î»jk (Dkj /Î»jk )1/Î· ]Î· .12 Then the

P
If the normalization is not imposed, (10) should be multiplied by [ k (Î›j /Rj )1/Ïƒ Rj ]1/(Ïƒâˆ’1) . This form
of the right hand sid of (10) implies that the equilibrium Gj is homogeneous of degree zero in {Rj } â€” a
scalar expansion of the world economy leaves all prices and shares unchanged.
11
Extending the same analysis as in the previous footnote, Gj is homogeneous of degree 1/Ïƒ 2 (Ïƒ âˆ’ 1) in
the Î›â€™s. All Gâ€™s and thus GDPâ€™s rise in proportion with a uniform rise in efficiency.
12 j
Î Ì„ contrasts with aggregate TFP friction tÌ„j because sectoral incidence differs from sectoral TFP frictions
and because the implicit functions differ. Locally there is a close relationship because âˆ‚ ln Î Ì„i /âˆ‚ ln Î ik = sik =
âˆ‚ ln tÌ„i /âˆ‚ ln tÌ„ik .

13

efficiency measure Î›j decomposes into:

Î›j ({Î jk }) = (Î Ì„j )1âˆ’Ïƒ Î›j (1).

The first term on the right implies, intuitively, that efficiency falls as the incidence of TFP
frictions rises. Î›j (1) measures the efficiency of matching Î»â€™s to Dâ€™s relative to a frictionless
equilibrium. The equilibrium allocation of skilled labor to sectors analyzed in Section 4
implies that the hypothetical equilibrium ex post allocation of Î»â€™s maximizes Î›j subject
P j
to
k Î»k = 1. With no productivity shocks, frictionless trade and efficient allocation,
Î»jk = Dkj and hence Î›j = 1. Ex ante allocations however determined will generally not satisfy
Î»jk = Dkj , so Î›j (1) < 1. How far Î›j (1) falls below 1 reflects aspects of possibly efficient ex
ante allocation facing uncertain Î â€™s as well as the deviations of realized productivity draws
from expected draws. Thus the decomposition above is arbitrary in assigning an efficiency
meaning to Î›j (1). Nevertheless, Î›j has an unambiguous efficiency interpretation and Î Ì„j
also has a clear interpretation as an efficiency measure.

3.2

Equilibrium Income Patterns

The model yields strikingly simple links from the incidence of productivity frictions to the
equilibrium cross section pattern of aggregate real incomes, income distribution and the
pattern of production and trade.
Proposition 1 (a) The factoral terms of trade Gj is decreasing in the sellersâ€™ incidence
of TFP frictions, increasing in the relative efficiency of allocation Î›j (1) and decreasing in
real potential GDP Rj :
j

G =



Î›j (1)
Rj (Î Ì„j )Ïƒâˆ’1

1/Ïƒ
.

(b) Real national income is increasing in effective potential GDP Rj /Î Ì„j and in the efficiency

14

of allocation of Î»â€™s; and it is decreasing in national average buyersâ€™ incidence PÌ„ h :

h

h

u = Î› (1)

1/Ïƒ



Rh
Î Ì„h

1âˆ’1/Ïƒ

1
.
PÌ„ h

Gj is decreasing in relative Rj due to the familiar effect of country size on the terms of
trade. Real income is less-than-unit elastic in effective country size Rh /Î Ì„h for the same reason. Also intuitive, allocative efficiency improves the factoral terms of trade. In equilibrium,
sellersâ€™ and buyersâ€™ incidences tend to be negatively correlated, so comparative static shifts
in their product are damped.
Proposition 1 suggests that gravity plays a powerful and previously unappreciated role in
accounting for comparative national economic performance. Incidence varies across countries
in ways that cannot be captured by partial equilibrium measures of geography. Sellersâ€™
and buyersâ€™ incidences each matter. Over time, even though geography is constant, its
incidence is endogenously shifting. Evidence from Anderson and Yotov (2008) suggests
weak or even negative correlation between buyersâ€™ and sellersâ€™ incidence and between the
incidence measures and TFP type measures of distribution frictions. Over time, Anderson
and Yotov report significant changes in incidence despite constant gravity coefficients, with
real income impact averaging around 1/3 of measured TFP over the same period.
Considering the effect of unequal elasticities, something like Proposition 1 should continue
to hold. Î Ì„j is solved from
X

Î»jk [Dkj /(Î»jk Î Ì„j )1âˆ’Ïƒk Rj ]1/Î·k (Gj )âˆ’Ïƒk /Î·k =

k

X

Î»jk [Dkj /(Î»jk Î jk )1âˆ’Ïƒk Rj ]1/Î·k (Gj )âˆ’Ïƒk /Î·k

k

where Gj is the equilibrium factoral terms of trade solved from adding up (9). Intuitively,
higher Î â€™s reduce G and less efficient allocation of Î»â€™s reduce G. These effects carry through
to real incomes as in Proposition 1(b).
Equilibrium wages have simple patterns in the model. The unskilled wage (using w = gL )
15

is given by wj = Î±(Rj /Lj )Gj . In the equal elasticity case,

j

w =Î±



Kj
Lj

1âˆ’Î± 

Î›j
Rj

1/[1+(Ïƒâˆ’1)Î·]
, âˆ€j.

j
The national average return to skills is rÌ„j = gK
. Based on the preceding discussion,

Proposition 2 (a) Unskilled wages are increasing in the skilled to unskilled endowment
ratio. The average skill returns are decreasing in the same ratio. Both factor incomes are
increasing in the relative efficiency of sector specific allocations, and decreasing in country
size. (b) The average skill premium rÌ„j /wj âˆ’ 1 = [(1 âˆ’ Î±)/(Î±)](K j /Lj )Î±âˆ’1 âˆ’ 1 is independent
of international forces.
The preceding algebra does not require nonzero bilateral trade flows.13 For present purposes, this property means that substitution on the extensive margin between traded and
nontraded goods plays no central role but occurs in the background.
Proposition 2 (b) is a useful neutrality property of the model with respect to income
distribution. In contrast, the distribution of sector specific factor incomes is powerfully
affected by international forces. Sector specific factor returns are given by rkj = gÎ»j j /K j . Use
k

the properties of the special Cobb-Douglas GDP function to yield

rkj = rÌ„j

sjk
.
Î»jk

The properties of the national average returns to skill, rÌ„j , are given above. The sector specific
part of the preceding expression will be developed following the analysis of equilibrium
production shares.
13

Section 5 validates this claim in the presence of traded inputs and selection into trade.

16

3.3

Equilibrium Production and Trade Patterns

In the equal case Ïƒk = Ïƒ the reduced form production share equations simplify to
sjk =

Î»jk (Dkj /Î»jk (Î jk )Ïƒâˆ’1 )1/Î·
.
(Î›j )1/Î·

(12)

As compared to (9), (12) eliminates the effect of country size on the equilibrium pattern of
production. Replacing Î›j with Î›j (1)(Î Ì„j )1âˆ’Ïƒ in (12):
Proposition 3 In the equal elasticities case (with Ïƒ > 1) and uniform Cobb-Douglas
production functions, the equilibrium production share is
1. increasing in the capital allocation share Î»jk ;
2. increasing in the demand â€˜parameterâ€™ Dkj ; and
3. decreasing in the relative sectoral incidence of inverse TFP Î jk /Î Ì„j .
The negative association between shipment shares and Î â€™s of Proposition 3.3 helps explain
the same empirical finding of Anderson and Yotov. They offer complementary causation
flowing from given shares to the Î â€™s for the special case of uniform border barriers.
Sector specific factor returns can now be characterized drawing on Proposition 3. Using
(12) and rkj = rÌ„j sjk /Î»jk yields

[Dkj /Î»jk (Î jk )Ïƒâˆ’1 ]1/Î·
rkj
=
.
rÌ„j
(Î›j )1/Î·

(13)

Then using Î›j = Î›j (1)Î Ì„1âˆ’Ïƒ :
Proposition 2 (c)-(d) Sector specific factor returns are increasing in the national labor
to human capital endowment ratio, decreasing in the sector specific allocation, decreasing
in the relative sectoral incidence of TFP frictions and increasing in the sectoral demand
parameter. (d) The distribution of skill premia is more dispersed the more inefficient is the
sectoral allocation of human capital.
(13) summarizes the properties of the inequality of specific factor returns in global equilibrium. Technology shocks affect the Î â€™s primarily (exclusively under Cobb-Douglas upper
17

level preferences so that Dkj is parametric.) Then for given allocations of skills, more dispersion of the incidence of productivity induces more ex post inequality.
The reduced form unit cost equations simplify when Ïƒk = Ïƒ. Using (11) in (10), substituting into (8) and simplifying yields

pejk =

(Dkj /Î»jk (Î jk )Ïƒâˆ’1 )(1âˆ’Î±)/Î· j âˆ’(1âˆ’Î±+Î±/Ïƒ)/Î·
(R )
.
(Î›j )Î±/Î·Ïƒ

(14)

Using the decomposition Î›j = Î›j (1)(Î Ì„j )1âˆ’Ïƒ , the implications of (14) for equilibrium â€˜competitivenessâ€™ in the cross section, interpreted as determinants of pejk â€™s, are intuitive and sharp:
Proposition 4 In the uniform elasticities case:
1. larger specific endowments lower costs;
2. larger world demand for a good raises its cost;
3. higher quality costs more;
4. higher sectoral sellers incidence of TFP frictions lowers unit costs;
5. bigger countries have lower costs.
6. higher national average sellersâ€™ incidence raises unit costs while better efficiency of
allocation lowers unit costs.
Proposition 4.3 states that in general equilibrium, higher quality goods have higher unit
costs, all else equal. This is less obvious than it might seem. The CES model of preferences
implies that some of each variety will be demanded, so it is not true that lower quality must
have a lower price to be purchased by anyone.14
With unequal elasticities, (8) applies. Proposition 4 still applies for given Gj , with
additional effects arising through effects of the exogenous variables on Gj . Compared to
1âˆ’Ïƒk
The interpretation of Î²kj
as a quality parameter is natural from examining the sub-utility function that
lies behind the CES expenditure function: starting from equal consumption of each variety, the consumerâ€™s
1âˆ’Ïƒk
willingness to pay is higher the larger is Î²kj
.
14

18

(8), the special case (14) implies that larger countries have uniformly lower unit production
costs.
The model yields strong restrictions on the equilibrium pattern of trade. The ratio of
net exports to GDP is given by sjk âˆ’ Î¸k in the Cobb-Douglas preferences case. Gross exports
are more interesting. Production is given by sjk g j . Own demand is given by (26). The ratio
of gross exports to GDP in the special case of equal elasticities of substitution is given by

sjk

o1âˆ’Ïƒ
E j n tjj
k
1âˆ’ k
Yk Î jk Pkj

!
.

Imposing Cobb-Douglas upper level preferences, Ekj /Yk is replaced with Ï‰ j . Using Ï‰ j =
(Î›j /Rj )1/Ïƒ Rj this reduces to

sjk

1 âˆ’ Î›j (1)



Rj
Î Ì„j

1âˆ’1/Ïƒ n

o1âˆ’Ïƒ
tjj
k
Î jk Pkj

!
.

(15)

Then:
Proposition 5 With equal elasticities the ratio of sectoral gross exports to GDP is increasing in sjk , which moves according to Proposition 3. For given sjk , sectoral gross exports
n jj o1âˆ’Ïƒ
t
and global GDP share Ï‰ j which
to GDP is decreasing in Constructed Home Bias Î jkP j
k

k

itself is
1. increasing in allocative efficiency Î›j (1) and
2. increasing in effective relative country size Rj /Î Ì„j .
The term Constructed Home Bias is coined by Anderson and Yotov (2008). It summarizes
the implications of gravity for the prominent empirical regularity called home bias.
Proposition 5 combined with Proposition 2 (c) implies that export intensity is positively
correlated with sectoral earnings premia, a well documented empirical regularity in rich and
poor countries alike. For sharper results in a specific factors continuum model, see Anderson
(2009).
19

4

Equilibrium Specific Factor Allocation

The specific factor allocations are presumably determined by optimizing behavior. Investments in sectors become specific once made, but are allocated from a given stock K so as
to equalized anticipated returns. It is useful to consider the fully efficient equilibrium before
proceeding to the more realistic equilibrium where investments are ex ante efficient but ex
post inefficient due to the realizations of the productivity draws. This section concludes with
discussion of allocation of multiple sector specific factors.

4.1

Fully Efficient Equilibrium

An instructive benchmark is the special case model when the specific factors are fully efficiently allocated. This arises if the specific factor becomes mobile; or equivalently, if the
incidence of trade and productivity frictions is perfectly anticipated by agents selecting the
specific factor investments. The identical Cobb-Douglas production function structure assumed here makes the production set effectively Ricardian when capital allocation adjusts
efficiently.15 Due to the love of variety structure of preferences, prices adjust in equilibrium
to support diversification, avoiding the corner solutions that otherwise arise with Ricardian
production.
The long run general equilibrium GDP shares reduce to16

sjk

=

Î»jk

Dkj (Î jk )1âˆ’Ïƒ
.
=P j j
1âˆ’Ïƒ
k Dk (Î k )

(16)

Supply adjusts to meet demand in absence of trade and productivity frictions. Trade and
productivity frictions captured by the Î â€™s redistribute sales through a CES structure, but
the mechanism of an essentially demand driven equilibrium pattern of production remains.
15

The Ricardian production set is the outer envelope of specific factor production sets for fixed sectoral
allocations.
P
P
16
Using (12) for sjk , sjk /Î»jk = 1 can be solved for Î»jk = Dkj (Î jk )1âˆ’Ïƒ / k [Î»jk (Dkj /Î»jk (Î jk )Ïƒâˆ’1 )1/Î· ]Î· . k Î»jk = 1
P
P
implies that k [Î»jk (Dkj /Î»jk (Î jk )Ïƒâˆ’1 )1/Î· ]Î· = k Dkj (Î jk )1âˆ’Ïƒ . This yields the solution in the text.

20

Paralleling this feature, with efficient allocation the unit costs of (14) become invariant to
P
k: pejk = pÌ„j , âˆ€k, where pÌ„j = (Î›j )(1âˆ’Î±âˆ’Î±/Ïƒ)/Î· (Rj )âˆ’(1âˆ’Î±+Î±)/Î· and Î›j = k Dkj (Î jk )1âˆ’Ïƒ . The equilibrium national shares of world sales in each sector k are given by Ykj /Yk = (pÌ„j )1âˆ’Ïƒ (Î²kj Î jk )1âˆ’Ïƒ .
The specific gravity model takes the Î²â€™s as given, while the Eaton-Kortum model endogenizes them. The connection between the two models is seen as follows. Using the preceding
equation to obtain Ykj /Yk (Î jk )1âˆ’Ïƒ and substituting back into the gravity equation (26), the
bilateral trade flows are given by

h 1âˆ’Ïƒk
.
Xkjh = (Î²kj )1âˆ’Ïƒk Ekh (pÌ„j )1âˆ’Ïƒk (tjh
k /Pk )

For any sector, the Eaton-Kortum assumptions result in equilibrium Î²â€™s such that the right
hand side above is replaced with a gravity expression equivalent to (26), only with 1 âˆ’ Ïƒ
replaced by âˆ’Î½ where Î½ is the dispersion parameter of the Frechet distribution. (See Eaton
and Kortum, equation (11).) Demand side forces in the Eaton-Kortum model disappear into
a constant term that cancels in equilibrium trade shares. Substitution is all on the extensive
margin. In contrast, the Armington structure forces diversified production in each country
by assuming that goods are differentiated by place of origin. Substitution is on the intensive
margin. The distribution of the productivity penalties, the aâ€™s, is unrestricted.
The Costinot-Komunjer extension of Eaton-Kortum to combine deterministic sector/country
productivity with variety specific productivity draws from Frechet distributions results in the
assignment of proportions of varieties within sectors as in Eaton-Kortum along with the assignment of sectoral allocations. The Appendix expands on the connection between the
generalized Ricardian and specific factors models by analyzing monopolistic competition
equilibrium when skill allocation is subsequent to productivity realizations.
The difference between the specific gravity and Eaton-Kortum/Costinot-Komunjer models is the specificity of skilled labor. Frechet distributions of productivity draws do not yield
closed form predictions when factors are specific. Nevertheless, as preceding sections show,

21

useful predictions about the pattern of production and trade can be made taking the Î»â€™s and
Î²â€™s as given.
Suppose that the productivity of distribution and production is random.17 Investments
in sectors must be made prior to the realization of the random variables, at which time the
realized sector specific returns differ. Ex ante efficient equilibrium with risk neutral agents
is characterized by equal expected rates of return.18
The ratio of the realized rate of return in sector k to the average realized rate of return
is given by
sjk
rkj
=
j j
j.
Î»
Î»
r
k
k k k

P

Simplify by assuming Cobb-Douglas preferences for choice between sectors, hence Dkj is a
parameter. For any pair of sectors k, k 0 in j, equal expected returns implies
Î»jk /Dkj
j
j 1âˆ’Ïƒ
].
j
j = E[(Î k /Î k0 )
Î»k0 /Dk0
Here E denotes the expectation operator. Combined with the adding up constraint on Î»â€™s
this implies:
Dj E[(Î j )1âˆ’Ïƒ ]
Î»jk = P k j k j
, âˆ€k, j.
1âˆ’Ïƒ ]
k Dk E[(Î k )

(17)

Note that since the right hand side is convex in Î , riskier sectors receive more investment all
else equal, by Jensenâ€™s Inequality. Intuitively, this occurs because rkj is inversely related to
Î jk and thus is increased in expected value by mean preserving spreads in the distribution of
Î jk . Of course, considerations of risk aversion, risk sharing and covariation of the Î â€™s modify
any such conclusions based on (17).
An empirically tractable form of the share equation emerges from considerations of ex
Evidence from Anderson and Yotov (2008) indicates that bilateral trade costs Tkjh are remarkably stable
over time, while in contrast the sectoral productivity penalties ajk and the multilateral resistances Î jk appear
to have significant randomness.
18
There are important resource allocation implications of risk aversion, but these carry much additional
complexity. Helpman and Razin (1978) develop the implications of international trade in securities in this
setting when there is aggregate risk.
17

22

ante efficiency in monopolistic competition equilibrium. Realized Dâ€™s differ from ex post
efficient equilibrium (including rational expectations) Dâ€™s by a white noise error term. The
Appendix shows that realized shares are given by

sjk

1/Î·
Î»jk dk dj jk (Î jk )1âˆ’Ïƒ
=P
 ,
j
j 1âˆ’Ïƒ 1/Î·
j
d
d

(Î 
)
Î»
k
j
k
k
k k

(18)

where the dâ€™s are fixed effects and the â€™s are realizations of a unit mean random error that
is orthogonal to the other terms. The orthogonality property is due to the assumption of ex
ante efficient allocation.
Now consider the implications of randomness for the efficiency of allocation given ex
ante efficiency.Taking expectations of (11), the convexity of Î› in Î  guarantees that riskier
incidence lowers efficiency for a given allocation. Moving to a risk-reducing allocation helps
to offset this but cannot fully do so. Moreover, variance plausibly rises with the mean, in
which case higher average incidence of trade and productivity frictions imposes an added
burden through greater expected ex post inefficiency of allocation. In empirical exercises
the Î»âˆ— â€™s can be calculated and compared to actual Î»â€™s to decompose the inefficiency due to
randomness into its avoidable and unavoidable components.
The full rational expectations equilibrium of the model requires that the expectations of
Î â€™s be equal to the expectations of the realized Î â€™s obtained from (24)-(25) subject to (23).
Multiple specific factors introduce no new elements, with the minor exception that there
may be differences in the efficiency of allocation of the different factors. The multiple specific
factors form a natural aggregate, a concave and homogeneous of degree one function Ï†:
K = Ï†(K 1 , ..., K M ) where the superscript now refers to the specific factor type. Sectoral
M
allocations yield Ï†k = Ï†(Î»1k K 1 , ..., Î»M
k K ). Then Î»k K = Kk = Ï†k as before with Î»k being

the exact index of allocations Î»k â‰¡ Ï†k /Ï†. If all M specific factor types follow the same
allocation rules, then multiple goods make no difference at all. But it is plausible that some
factors follow different allocation rules (e.g., risk neutrality may be appropriate for some

23

types of plant and equipment investment but implausible for human capital), in which case
the structure of the index Î»k plays a role. Multiple specific factors of course also introduce
richer ex post income distributions.

5

Intermediate Inputs and the Extensive Margin

Intermediate products trade comprises a large and growing share of world trade. A simple
extension of the specific factors model of production encompasses intermediate products
trade.
Vertical disintegration is apparent â€” an increasing share of components are imported,
meaning some formerly potential trade becomes active. In the multi-country context, similar
shifts in the qualitative pattern of trade arise as more of the potential bilateral trade links
are activated by the choice of firms to initiate trade. The action on the extensive margin of
trade introduced here also applies to final goods trade.

5.1

Specific Factors Production with Intermediates

Intermediate products enter for simplicity as just a single intermediate product, potentially
produced as a variety at each location.19 The CES aggregate of the varieties is an input into
production of all final goods and the intermediate good at each location. To ease notation,
suppress country indexes. The production function for product k in the Cobb-Douglas case
is given by
fk = LÎ±k Kk1âˆ’Î±âˆ’Î½ MkÎ½ /ak
where Mk is the quantity of the CES aggregate intermediate input used in sector k and
sector m is the intermediate goods production sector.
Let Pm denote the price of the intermediate input used by the home country, a CES
aggregate of the intermediate products purchased from all trading origins. Cost mini19

The methods used here readily scale up to any number of intermediate product classes.

24

mization combines with the labor market clearance condition to yield the GDP function
g(e
p, Pm , L, K, {Î»k }) with a closed form given by
X
1/(1âˆ’Î±âˆ’Î½) 1âˆ’Î±âˆ’Î½ âˆ’Î½ 1/(1âˆ’Î½)
{LÎ± K 1âˆ’Î± [(
Î»k pek
)
Pm ]}
c.

(19)

k

Here, c is a constant term combining the parameters, while pek is the â€˜efficiency unit costâ€™ of
output in sector k. For some sector k = m, pem is the efficiency unit price of the intermediate
product from sector m produced in the home country.
Pmj is the buyersâ€™ incidence in j of intermediate goods, a CES price aggregate for country
i
j of the elements of the vector {e
pim tij
m /Î m }. All the earlier procedures for multilateral

resistance apply. Higher buyersâ€™ incidence of TFP in intermediate inputs lowers GDP while
lower sellersâ€™ incidence of intermediate products raises GDP.
Due to the separability of the GDP function, the reduced form equilibrium efficiency
prices and production shares are independent of the incidence of trade costs on intermediate
inputs Pm . This separability implies that all the production, trade and income distribution
pattern results of Section 3 apply in the presence of intermediate goods.
Aggregate incidence of inverse TFP with intermediate products of the type modeled here
is measured based on substituting for peâ€™s using (8) in the price term of the GDP function
(19):
n
X
[(
Î»k (e
pk )1/(1âˆ’Î±âˆ’Î½) )1âˆ’Î±âˆ’Î½ Pmâˆ’Î½ ]1/(1âˆ’Î½) .
k=1

Evaluate this expression with the reduced form peâ€™s of (8) evaluated at the actual Î â€™s and
at a uniform Î Ì„ that yields the same value of the expression. The equilibrium inverse TFP
incidence measure has the same form as in Proposition 1 except that Î± is replaced with
Î±0 = Î± + Î½. A rise in buyerâ€™s incidence for the intermediate goods Pm lowers productivity
with elasticity âˆ’Î½/(1 âˆ’ Î½) given by the expression above. The key property is that final and
intermediate productivity frictions decompose neatly due to the Cobb-Douglas structure of
the model.
25

5.2

The Extensive Margin, Productivity and Trade Patterns

The production function for each industry k is comprised of the production functions of
those firms that earn non- negative profits. The firms choose to enter production, commit
a skilled labor force and then receive a Hicks-neutral productivity draw from a probability
distribution. Those firms unlucky enough to receive draws too low to allow breaking even exit
from production. The average productivity in industry k, 1/aÌ„k , is determined by the cutoff
productivity of the marginal firm in combination with the parameters of the productivity
draw distribution. Average productivity is for present purposes taken as given.
Profits are earned by inframarginal firms, and form part of the rents earned by the sector
specific factors.20 The average productivity is associated with an average price, a constant
markup over the the average unit cost of extant firms. See Melitz (2003) for details. The
Melitz model differs in having only one factor of production, but the essentials remain the
same, illustrated in the Appendix development of the monopolistic competition model. This
setup allows aggregation of the heterogeneous firm model into a representative firm model
easily linked to the general equilibrium production theory of preceding sections.
The second key contribution of Melitz is to introduce a second cutoff due to fixed costs
of exporting. Expanding the iceberg metaphor, part of the iceberg shears off and is lost as
it leaves the home glacier, the remainder melting as it travels to its destination. There are
two consequences for the allocation of trade and a further consequence for the allocation
of resources. As for trade, some (many in practice) trade links are shut down completely
because no firm exports, and secondly, firm selection contributes to trade volume in active
links. As for resource allocation, firms choosing to export must hire additional unskilled
workers to meet the fixed cost.21 The resulting rise in the wage raises the cost of production
for all firms. Now the conditions of trade have an effect on average productivity: lowering
20

The division of rents between â€˜ownersâ€™ and skilled workers is irrelevant to present purposes.
If skilled workers are not completely firm specific, firms can also hire skilled workers within their sector
with some loss of skills. The implications of this Darwinian force in the sectoral skilled labor market is
developed further in Anderson (2009).
21

26

the variable cost of trade induces more firms to incur the fixed cost of trade and raises the
average productivity of all surviving firms.
Helpman, Melitz and Rubinstein (2008) develop the implications of fixed costs of export
for bilateral trade and the gravity model. For present purposes, note that the effect of action
on the extensive margin is isolated in the multilateral resistance terms, Î jk for outputs and
Pmj for inputs in country j and sector k. The Appendix develops the implications of their
model for multilateral resistance.

6

Conclusion

This paper provides a framework for integrating buyersâ€™ and sellersâ€™ incidence measures
of TFP in production and distribution into a many country general equilibrium model.
Differences in the incidence of TFP across goods and countries impact the cross section
pattern of production and trade, with sharp results for the special case of the specific factors
model.
Given buyersâ€™ and sellersâ€™ incidence measures for an appropriately disaggregated set of
goods, countries (and possibly years) the specific factors model has testable implications for
the pattern of production and trade. Deviations from predicted values may give useful clues.
The paper also points to future theoretical refinement. The model links trade frictions to
income distribution, and points toward political economy, a link that appears worth exploring
in light of concerns about globalization causing inequality. The model also points toward
dynamics, as specific factors adjust.
The extreme simplicity of the model buys strong results, while hinting that the results
hold in less restrictive cases. The restrictive assumptions about distribution are especially
important to relax. The convention of gravity modeling is that the seller provides all the
distribution services, so these accrue as income to the seller and form part of the income
side of the budget constraint above. In reality, some distribution services are provided by

27

buyers, hence GDP as modeled in this paper does not equal measured GDP. Moreover,
gravity measurement picks up trade costs that are implicit and thus do not correspond to
directly measurable trade costs, hence national product accounting deviates further from
the theoretical model here. A tractable alternative approach that preserves the qualitative
features of the present model is to treat distribution services as an intermediate input. More
general treatments may still be tractable.
Finally, the analysis reveals important channels through which technology shocks in production and in distribution in one country are transmitted to the incidence of productivity in
all trading partners. The specific factors structure suggests gradual adjustment to long run
equilibrium. Future research might profitably explore these channels for their implications
about inference of productivity and about the international transmission of shocks.

28

7

References

Anderson, James E. (1979), â€A Theoretical Foundation for the Gravity Equation,â€ American
Economic Review, 69, 106-16.
Anderson, James E. and Eric van Wincoop (2003), â€œGravity with Gravitas: A Solution
to the Border Puzzleâ€, American Economic Review, 93, 170-92.
Anderson, James E. and Eric van Wincoop (2004), â€œTrade Costsâ€, Journal of Economic
Literature, 42, 691-751.
Anderson, James E. and Yoto V. Yotov (2008), â€œThe Changing Incidence of Geographyâ€,
NBER Working Paper No. 14423; American Economic Review, forthcoming.
Anderson, James E. (2009), â€œGlobalization and Income Distribution: A Specific Factors
Continuum Approachâ€, NBER Working Paper No. 14643.
Costinot, Arnaud and Ivana Komunjer (2007), â€œWhat Goods Do Countries Trade? New
Ricardian Predictionsâ€, UC-San Diego.
Davis, Donald and David Weinstein (2001), â€œAn Account of Global Factor Tradeâ€, American Economic Review, 91, 1423-53.
Eaton, Jonathan and Samuel Kortum (2002), â€œTechnology, Geography and Tradeâ€,
Econometrica, 70(5), 1741-1779.
Eaton, Jonathan, Samuel Kortum and Francis Kramarz (2004), â€œAn Anatomy of International Trade: Evidence from French Firmsâ€, mimeo, New York University.
Helpman, Elhanan, Marc J. Melitz and Yonah Rubinstein (2008), â€œTrading Partners and
Trading Volumesâ€, Quarterly Journal of Economics, 123: 441-487.
Helpman, Elhanan and Assaf Razin (1978), A Theory of International Trade under Uncertainty, Academic Press.
Melitz, Marc J. (2003), â€œThe Impact of Trade on Intra-Industry Reallocations and Aggregate Industry Productivityâ€, Econometrica, 71(6), 1695-1725.
Redding, Stephen and Anthony J. Venables (2004) â€œEconomic Geography and International Inequalityâ€, Journal of International Economics, 62(1), 53-82.
29

Romalis, John (2004), â€œFactor Proportions and the Structure of Commodity Tradeâ€,
American Economic Review, 94, 67-97.
Trefler, Daniel (1995), â€œThe Case of the Missing Trade and Other Mysteriesâ€, American
Economic Review, 85, 1029-1046.

30

8

Appendix

8.1

Sectoral Incidence

On the supply side, for the moment take as given the national output of each sector, and
its allocation to all destinations. The value of shipments at delivered prices from origin h in
product class k is Ykh .
Market clearance requires:

Ykj

=

X n Î² j pej tjh o1âˆ’Ïƒk
k k k
Pkh

h

Ekh .

(20)

Now solve (20) for the quality adjusted efficiency unit costs {Î²kj pejk }:
Ykj

(Î²kj pejk )1âˆ’Ïƒk = P

jh
h 1âˆ’Ïƒk h
Ek
h (tk /Pk )

.

(21)

Based on the denominator in (21), define

(Î jk )1âˆ’Ïƒk â‰¡

X n tjh o1âˆ’Ïƒk
k

h

Pkh

Eh
P k h.
h Ek

Divide numerator and denominator of the right hand side of (21) by total shipments of k
and use the definition of Î , yielding:

(Î²kj pejk Î jk )1âˆ’Ïƒk = Ykj /

X

Ykj .

(22)

j

The right hand side is the global expenditure share for class k goods from country j. The
left hand side is a â€˜global behavioral expenditure shareâ€™, understanding that the CES price
index is equal to one due to the normalization implied by summing (22):
X

(Î²kj pejk Î jk )1âˆ’Ïƒk = 1.

j

31

(23)

The implication of (22) is that effectively each origin j ships to a world market with
incidence of trade costs Î jk . The incidence of trade costs to sellers being given by the Î â€™s,
j
the incidence of bilateral trade costs on the buyersâ€™ side of the market is given by tjh
k /Î k ,

taking away the sellersâ€™ incidence. The average incidence of all bilateral costs to h from the
various origins j is given by the buyersâ€™ price index Pkh . The buyersâ€™ incidence is obtained
by substituting for quality adjusted efficiency unit costs from (21) in the definition of the
true cost of living index, using the definition of the Î â€™s:

(Pkh )1âˆ’Ïƒk =

X n tjh o1âˆ’Ïƒk Y j
k
P k j.
j
Î k
j Yk
j

(24)

Collect this with the definition of the Î â€™s:

(Î jk )1âˆ’Ïƒk

=

X n tjh o1âˆ’Ïƒk
k

h

Pkh

Eh
P k h.
h Ek

(25)

These two sets of equations jointly determine the inward multilateral resistances, the P â€™s
and the outward multilateral resistances, the Î â€™s, given the expenditure and supply shares
and the bilateral trade costs, subject to the normalization (23). A normalization of the Î â€™s is
needed to determine the P â€™s and Î â€™s because (24)-(25) determine them only up to a scalar.22
See Anderson and Yotov (2008) for analysis of the properties of multilateral resistance.
Bilateral trade flows are given by the gravity equation

Xkjh =

n tjh o1âˆ’Ïƒk Y j E h
k
Pk kj .
j h
Î k P k
j Yk

(26)

This follows from the CES expenditure setup using (22) to substitute for (Î²kj pejk )1âˆ’Ïƒk . The
P
interpretation of (26) reveals that trade frictions modify the frictionless flow Ykj Ekh / j Ykj
by a power transform of the relative incidence of trade costs.
The relationship between the incidence of trade frictions and productivity frictions in the
22

If {Pk0 , Î 0k } is a solution to (24)-(25), then so is {Î»Pk0 , Î 0k /Î»} for any positive scalar Î»; where Pk denotes
the vector of P â€™s and the superscript 0 denotes a particular value of this vector, and similarly for Î k .

32

cross section is clarified by analyzing the special limiting case of frictionless trade, where
j
1
23
tjh
is
k = ak , âˆ€k, j. The solution to (24)-(25) under the convenient normalization Pk = 1

Î jk = ajk , âˆ€k, j, and Pkh = 1, âˆ€k, h. All the incidence of productivity is borne on the supply
side. The reason is that in conditional general equilibrium the expenditure Ekj on good
k from source j is given. With a fall in ajk , market clearance is achieved with a rise in
the efficiency unit cost, so that all the benefit accrues to suppliers of k from j. The further
implication is that sectoral TFP is decomposable into a Hicks neutral production component
and an equilibrium distribution incidence component. It is important to keep in mind that
the comparative static incidence of a productivity improvement is still shared between buyer
and seller; this decomposition applies in the cross section.

8.2

Monopolistic Competition

The special form of monopolistic competition and trade that is the focus of most of the
literature has essentially no effect on the equilibrium of the model for given allocations of
the specific factor. Endogenizing the allocation of the specific factor has the additional
important effect of endogenizing the expenditure share parameters.
The CES preferences in each sector now contain a very large number of potential brands
produced by firms in each country. Each firm is a monopolistic competitor, marking up price
over cost by a constant proportion Ïƒ/(Ïƒ âˆ’ 1). The GDP shares have exactly the same form
as in the text because differing elasticities act on the model exactly like differing technology
frictions and become part of the Î â€™s while common elasticities cancel out.
The development of a brand takes F units of skilled labor. The allocation of skilled labor
P
is subject to the constraint K j = F k njk + Kkj where njk is the number of firms in sector
k and country j. The allocation share of skilled labor net of development requirements is
P
given for each sector k by Î»jk = Kkj /(K j âˆ’ F k njk ).
The number of brands is determined in fully efficient equilibrium by the zero profit
23

For allocations within sectors, only the relative multilateral resistances are relevant for allocation, so
allocation is invariant to the normalization.

33

condition rj (F njk + Kkj ) + wLjk = pjk ykj . Using the marginal revenue product functions
for skilled and unskilled labor for the Cobb-Douglas production function in the zero profit
condition and simplifying yields

njk

Sum and solve for

P

k

Kj
= k
F



P j

j
Ïƒ
jK âˆ’F
k nk
âˆ’ 1 = Î»k
.
Ïƒâˆ’1
F (Ïƒ âˆ’ 1)

njk , then substitute back into the right hand expression to yield
njk

=

Î»jk

Kj
F (Ïƒ âˆ’ 1)



1
1âˆ’
(Ïƒ âˆ’ 1)(1 + F )


.

(27)

The supply of labor net of development requirements is in equilibrium given by

K

j



1
1
+
1âˆ’
2
Ïƒ âˆ’ 1 (Ïƒ âˆ’ 1) (1 + F )



Thus the GDP function remains exactly the same as in the text, with the understanding
that K j is replaced by the expression above for net skilled labor and Î»â€™s are defined as shares
of net skilled labor.
Now consider the implications for the demand side of the model. For each sector k, the
demand â€˜parameterâ€™ is
Dkj = Î¸k njk /

X

njk

(28)

j

based on the Dixit-Stiglitz structure.
The efficient allocation in a frictionless world is Î»jk = Î¸k , âˆ€j, k. This follows from solving
(16) with the Î â€™s equal to one.
For a world with trade frictions the equilibrium allocation is solved from Î»jk = sjk , using
(12) for sjk and then replacing Dkj with a function of Î»â€™s by using (27) in (28).
Dkj

Î»jk K j
= Î¸k P j ,
Î»Ì„k j K

34

(29)

where Î»Ì„k â‰¡

P

j

Î»jk K j /

P

j

K j . Substituting in (12) and simplifying using sjk = Î»jk yields, for

goods that are produced,
Î¸k /Î»Ì„k (Î jk )Ïƒ
j Ïƒ.
j
Î¸
/
Î»Ì„
(Î 
Î»
k
k
k)
k k

1= P

(30)

(30) only holds (goods are produced) for goods with the same Î â€™s. The Î â€™s being endogenous, describing the equilibrium is difficult.
Eaton and Kortum resolve this difficulty by imposing a Frechet distribution on the aâ€™s
that differs nationally by a location parameter but has a common dispersion parameter.
Eaton and Kortum predict the proportion of varieties that will be produced and exported
in equilibrium by each country to each partner as a gravity equation. (See their equation
(11).) Costinot and Komunjer extend the Eaton-Kortum approach by adding a deterministic
country/sector specific component to productivity. Now the gravity model describes bilateral
trade patterns in any sector while the country/sector productivity component shifts the
country/sector production shares. Thus this generalized Ricardian approach is nested in the
specific gravity approach when the specific factor is allocated after the productivity draws.
Admitting productivity shocks that are not revealed prior to the allocation of skilled
labor, the efficient allocation is solved from using (27) in (28) and then substituting the
result into (17). The pattern of production and trade predictions of the model remain those
of the text for given Î»â€™s and Dâ€™s, while the explantion of the Î»â€™s and Dâ€™s is deeply implicit. An
empirically tractable form of the share equation nevertheless emerges from considerations of
ex ante efficiency. Realized Dâ€™s differ from ex post efficient equilibrium (including rational
expectations) Dâ€™s by a white noise error term. Substituting the right hand side of (29)
augmented by white noise into (12) yields

sjk

1/Î·
Î»jk fk fj jk (Î jk )âˆ’Ïƒ
=P
 ,
j âˆ’Ïƒ 1/Î·
j
j
)
Î»
f
f

(Î 
k j k
k
k k

(31)

where the f â€™s are fixed effects and the â€™s are realizations of a unit mean random error that
is orthogonal to the other terms. The orthogonality property is due to the assumption of ex
35

ante efficient allocation.

8.3

Selection to Trade

Helpman, Melitz and Rubinstein (2008) derive the gravity model with selection. The exposition below reviews their model, and reformulates it to highlight the role of multilateral
resistance in both intensive and extensive margins. It eases notational clutter to suppress
the separate accounting for each goods class k, and to move the location indexes to the
subscript position.
The model of the preceding subsection applies to determine the number of firms that
enter, taken here as given along with the other variables of conditional general equilibrium.
The cost of a firm to serve its own market (assuming that tii = 1 for simplicity) is given
by pei times ai , the inverse of the firmâ€™s productivity draw. The aggregate expenditure at
destination j is Ej and the CES expenditure system allocates expenditure across origins.
Sales by i to country j 6= i are profitable only if ai â‰¤ aij where aij is defined by the zero
profit condition:
tij pei aij
Pkj

Ïƒ âˆ’Ïƒ (Ïƒ âˆ’ 1)Ïƒâˆ’1

!1âˆ’Ïƒ
Ej = fij .

Here, fij denotes the fixed bilateral export cost. Extending the iceberg metaphor, f is
measured in uinits of the good, as if a chunk sheared off and was lost as the berg separated
from the mother glacier. Note that the markup cancels in the numerator and denominator
of the demand function facing the firm.
Define the selection variable Vij (aij ) where
Z

aij

a1âˆ’Ïƒk dF (a)

Vij =
aL

for aij â‰¥ aL while
Vij = 0

36

otherwise. Here, F is the cumulative density function. The value of shipments to all destinations from location i is denoted Yi .
Now derive the gravity model. The bilateral import value of shipments is given by

Xij =

pei tij
Pj

1âˆ’Ïƒ
Ej ni Vij .

The total value of shipments is

Yi =

X

Xij = pei1âˆ’Ïƒ ni

j

X tij
( )1âˆ’Ïƒ Vij Ej .
Pj
j

First, solve market clearance for pe1âˆ’Ïƒ
:
i
pe1âˆ’Ïƒ
=
i

yi /Y
.
Î 1âˆ’Ïƒ
i

Here, yi denotes the shipments of the average firm in country i, Yi /ni and Y =
P
j Ej , while
X tij
Î 1âˆ’Ïƒ
â‰¡
( )1âˆ’Ïƒ Vij Ej /Y
i
Pj
j

(32)

P

i

Yi =

(33)

Substitution yields the bilateral flows as:

Xij = (

tij 1âˆ’Ïƒ
) Vij Yi Ej /Y,
P j Î i

Pj1âˆ’Ïƒ =

X tij
( )1âˆ’Ïƒ Vij Yi /Y.
Î i
i

where
(34)

The normalization condition for the Î â€™s follows from manipulating (32) and summing:
X

ni (Î i pei )1âˆ’Ïƒ = 1.

(35)

i

The selection equation can be restated to highlight the role of multilateral resistance.
37

Selection is controlled by:

Ïƒ âˆ’Ïƒ (Ïƒ âˆ’ 1)Ïƒâˆ’1 (

aij tij 1âˆ’Ïƒ
) Ej yi /Y = fij .
P j Î i

(36)

There are three implications. First, notice that the gravity model with selection combines
the effects of trade costs on the intensive margin with their effects on the extensive margin
acting through Vij . Higher fixed costs reduce volume while larger markets draw more entrants. Second, Ïƒ plays a role in selection. Incorporating variation across goods class, lower
elasticity (higher markup) goods classes will have more firms selected into exporting, all
else equal. Third, most importantly, the multilateral resistance variables incorporate both
the productivity penalty imposed by the incidence of trade costs and the productivity gain
garnered by the incidence of selection into trade.
The formal model is completed by specifying a distribution function for G. With the
Pareto distribution used by Helpman, Melitz and Rubinstein, let the Pareto parameter be
Îº. Then
Vij =

ÎºaÎºâˆ’Ïƒ+1
L
Wij
(Îº âˆ’ Ïƒ + 1)(aH âˆ’ aL )

Wij = max[(aij /aL )Îºâˆ’Ïƒ+1 âˆ’ 1, 0].
Helpman, Melitz and Rubinstein estimate selection with a Probit regression, then use these
estimates to control for selection in the second stage gravity model regression with positive
trade flows.

38

