NBER WORKING PAPER SERIES

MINIMIZING JUSTIFIED ENVY IN SCHOOL CHOICE:
THE DESIGN OF NEW ORLEANS' ONEAPP
Atila Abdulkadiroglu
Yeon-Koo Che
Parag A. Pathak
Alvin E. Roth
Olivier Tercieux
Working Paper 23265
http://www.nber.org/papers/w23265

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
March 2017
We are grateful to Neil Dorosin, Gabriela Fighetti, and John White for assistance with this study.
Thanks also to seminar participants at the 2016 ASSA meetings for helpful comments. Vira
Semenova provided excellent research assistance. Pathak is grateful to the W. T. Grant
Foundation and the National Science Foundation for support. This paper supersedes “The Role of
Priorities in Assigning Indivisible Objects: A Characterization of Top Trading Cycles” cited by
others as Abdulkadiroglu, Atila and Yeon-Koo Che (2010) or Abdulkadiroglu, Atila, Yeon-Koo
Che, and Olivier Tercieux (2010). Abdulkadiroglu, Pathak, and Roth are members of the
scientific advisory board of the Institute for Innovation in Public School Choice. IIPSC was
involved in designing OneApp in New Orleans. Abdulkadiroglu, Pathak, and Roth also advised
Boston Public Schools and New York City's Department of Education on designing their student
assignment systems, discussed herein. This article does not represent the views of the New
Orleans Recovery School District or any other school district. The views expressed herein are
those of the authors and do not necessarily reflect the views of the National Bureau of Economic
Research.
At least one co-author has disclosed a financial relationship of potential relevance for this
research. Further information is available online at http://www.nber.org/papers/w23265.ack
NBER working papers are circulated for discussion and comment purposes. They have not been
peer-reviewed or been subject to the review by the NBER Board of Directors that accompanies
official NBER publications.
© 2017 by Atila Abdulkadiroglu, Yeon-Koo Che, Parag A. Pathak, Alvin E. Roth, and Olivier
Tercieux. All rights reserved. Short sections of text, not to exceed two paragraphs, may be quoted
without explicit permission provided that full credit, including © notice, is given to the source.

Minimizing Justified Envy in School Choice: The Design of New Orleans' OneApp
Atila Abdulkadiroglu, Yeon-Koo Che, Parag A. Pathak, Alvin E. Roth, and Olivier Tercieux
NBER Working Paper No. 23265
March 2017
JEL No. D47,I20
ABSTRACT
In 2012, New Orleans Recovery School District (RSD) became the first U.S. district to unify
charter and traditional public school admissions in a single-offer assignment mechanism known
as OneApp. The RSD also became the first district to use a mechanism based on Top Trading
Cycles (TTC) in a real-life allocation problem. Since TTC was originally devised for settings in
which agents have endowments, there is no formal rationale for TTC in school choice. In
particular, TTC is a Pareto efficient and strategy-proof mechanism, but so are other mechanisms.
We show that TTC is constrained-optimal in the following sense: TTC minimizes justified envy
among all Pareto efficient and strategy-proof mechanisms when each school has one seat. When
schools have more than one seat, there are multiple possible implementations of TTC. Data from
New Orleans and Boston indicate that there is little difference across these versions of TTC, but
significantly less justified envy compared to a serial dictatorship.
Atila Abdulkadiroglu
Department of Economics
Duke University
213 Social Sciences Building
Durham, NC 27708
and NBER
atila.abdulkadiroglu@duke.edu

Alvin E. Roth
Department of Economics
Stanford University
579 Serra Mall
Stanford, CA 94305
and NBER
alroth@stanford.edu

Yeon-Koo Che
Columbia University
420 W. 118th Street, 1029 IAB
New York, NY 10027
yc2271@columbia.edu

Olivier Tercieux
Paris School of Economics
48 boulevard Jourdan
75014 Paris
France
tercieux@pse.ens.fr

Parag A. Pathak
Department of Economics, E52-426
MIT
77 Massachusetts Avenue
Cambridge, MA 02139
and NBER
ppathak@mit.edu

1

Introduction

Research on priority-based resource allocation focuses on two central mechanisms: one based on
Gale and Shapley (1962)’s deferred-acceptance (DA) algorithm and the other based on Gale’s
top trading cycles (TTC) algorithm (Shapley and Scarf 1974). This focus is due in part to
the fact that both mechanisms are strategy-proof as direct mechanisms: truthful reporting is a
weakly dominant strategy for the proposing side in DA and for individuals in TTC. The main
difference between the mechanisms is that DA produces an outcome that is not Pareto efficient
but eliminates justified envy. An allocation eliminates justified envy if there is no blocking pair;
that is, if no individual prefers another assignment over her assignment and has a higher priority
at the preferred assignment. TTC is Pareto efficient but does not eliminate justified envy. There
is no mechanism that is both Pareto efficient and eliminates justified envy.1
Abdulkadiroğlu and Sönmez (2003) proposed resolving this trade-off in school assignment
mechanism design as follows: if the designer prefers the elimination of justified envy over efficiency, then use DA. If the designer prefers efficiency over elimination of justified envy, then use
TTC.2 Since Gale and Shapley (1962) showed that DA produces a justified envy-free matching that is not Pareto dominated by any other justified envy-free matching, the argument for
DA rests on a firm foundation. DA is constrained-optimal in the sense that it weakly Pareto
dominates any other matching with no justified envy.
Without a similar constrained-optimality result for TTC, the formal argument for TTC is not
on as solid footing. In particular, there are other strategy-proof and Pareto efficient mechanisms
for priority-based resource allocation. For example, a serial dictatorship mechanism, which
assigns each student in a given order to her most preferred choice among the remaining schools,
is strategy-proof and Pareto efficient. Importantly, priorities have no role in this mechanism, in
the sense that changing priorities does not alter the outcome for a given ordering of students.
Under DA, priorities have a clear role since there is no justified envy. However, the role of
priorities in TTC is much less clear, since TTC allows for justified envy but uses priorities to
compute allocations.
In this paper, we provide a constrained optimality result for TTC that is analogous to the
result for DA. To compare efficient allocations, we measure the extent to which two allocations
eliminate justified envy. Our approach is inspired by recent literature examining problem-wise
1

This fact is a consequence of Roth (1982a), who shows that an allocation that is free of justified envy need
not be Pareto efficient. Kesten (2010) shows a related result: there is no Pareto efficient and strategy-proof
mechanism that selects the Pareto efficient and justified-envy-free allocation whenever it exists. Ergin (2002)
characterizes situations where there is no conflict between elimination of justified envy and Pareto efficiency.
2
Abdulkadiroğlu and Sönmez (2003) state (p. 732): “... the choice between these two competing mechanisms
depends on the structure and interpretation of the priorities. In some applications, policy makers may rank
complete elimination of justified envy before full efficiency, then Gale-Shapley student optimal stable mechanism
can be used in those cases. Efficiency may be ranked higher by others, and the top trading cycles mechanism can
be used in such applications.”

2

comparisons to contrast mechanisms.3 We say that mechanism ϕ1 has less justified envy
than mechanism ϕ2 if, for any problem, the set of blocking pairs of mechanism ϕ1 is a subset
of the set of blocking pairs of mechanism ϕ2 . Our main result states that there is no Pareto
efficient and strategy-proof mechanism that has less justified envy than TTC, when each school
has one seat. When minimizing justified envy is second only to efficiency, this result provides
the missing foundation for recommending TTC.
Lack of a rigorous understanding of the roles priorities and preferences play in TTC may
also explain its limited use in practice. For instance, from 2003 to 2005, a Student Assignment
Task force in Boston, led by civic leaders, evaluated possible improvements to the school choice
system. As part of their review, the task force recommended TTC over DA, and provided the
following statement, which indicates how they perceived the mechanisms after reviewing the
academic literature (Landsmark, Dajer and Gonsalves 2014):
[T]he Gale-Shapley algorithm [...] cuts down on the amount of choice afforded to families.
The Top Trading Cycles algorithm also takes into account priorities while leaving some
room for choice. [...] [C]hoice was very important to many families who attended
community forums...
Based on this report and further consultation with the community and academic experts, the
final recommendation was for DA (Abdulkadiroğlu, Pathak, Roth and Sönmez 2005a). TTC was
faulted for allowing students to trade as stated in the final school committee report (BPS 2005):
[TTC’s] trading shifts the emphasis onto the priority and away from the goals BPS is
trying to achieve by granting these priorities in the first place.
The OneApp assignment system used for all public school children in New Orleans’ Recovery
School District (RSD) was based on TTC in its initial year in 2012 (Vanacore 2012). To the
best of our knowledge, the RSD is the only place that TTC has been used in practice, in school
assignment or elsewhere.4,5 However, after one year, officials abandoned TTC in favor of DA,
3

For examples in different contexts, see Chen and Kesten (2016), Kesten (2006), Maskin (2016), and Pathak
and Sönmez (2013).
4
A team of economists led by Muriel Niederle and Clayton Featherstone proposed a TTC system for school
choice for San Francisco, and the school board approved it in March 2010 (see San Francisco Unified School District
(2010), Board Approves New Student Assignment System for San Francisco Schools, Press Release, March 10,
2010, https://web.archive.org/web/20100331064212/http://portal.sfusd.edu/data/news/pdf/3%2010%2010%20
SF%20School%20Board%20Approves%20New%20Student%20Assignment%20System.pdf). However, it appears
that the district staff never implemented the Board’s decision; in any event, the school district has declined to
make public its current algorithm. For a blow-by-blow description of events, browse the posts at Roth, Alvin E.,
Market Design blog, http://marketdesigner.blogspot.com/search?q=Francisco+AND+school.
5
A version of TTC was initially proposed as a way to organize kidney exchange (see Roth, Sönmez and Ünver
(2004)) but was never used in practice due in part to the difficulty of implementing long cycles. Instead, an
incremental process has led to the use of long chains and cycles identified through integer programming (see
Anderson, Ashlagi, Gamarnik and Roth (2015)).

3

in part due to its treatment of priorities. Motivated by these developments, we use data from
New Orleans and Boston to report on how TTC compares to other efficient mechanisms and to
DA. The empirical comparison also shows the relevance of our results when schools have more
than one seat.
This paper is related to several other papers on axiomatic mechanism design characterizing
strategy-proof mechanisms. The most closely related result is Ma (1994), who characterizes TTC
as the unique strategy-proof, Pareto efficient, and individually rational mechanism in the housing
market model of Shapley and Scarf. (Strategy-proofness was established in Roth (1982b)).
In Section 5, we show how our main result generalizes Ma (1994). Pápai (2000) introduces
and characterizes a wide class of mechanisms, known as hierarchical exchange rules, by Pareto
efficiency, group strategy proofness, and re-allocation proofness. TTC is a hierarchical exchange
rule defined by the school priority lists but Pápai (2000) does not make explicitly reference any
specific priority and therefore is silent on how TTC respects priorities. In a similar vein, Pycia
and Ünver (2016) introduce and characterize trading cycles with brokers and owners by Pareto
efficiency and group strategy-proofness.6 Dur (2013) and Morrill (2015a) each characterize TTC
by relying on additional axioms, which are distinct from our result. Following the circulation of
Abdulkadiroglu and Che (2010), Morrill (2015a) developed a characterization of TTC based on
a new fairness concept that he terms “just.” Essentially, this approach amounts to excluding
some incidences of justified envy from the fairness consideration.7 By contrast, we consider all
incidents of justified envy in our fairness consideration.
There are other notable characterizations of mechanisms used for school assignment. Alcalde and Barberá (1994) show that student-proposing DA is the only mechanism that eliminates justified-envy, is individually rational, is non-wasteful, and is strategy-proof. Balinski and
Sönmez (1999) show that DA is the only matching mechanism that eliminates justified-envy, is
individually rational, is non-wasteful, and respects improvements. Kojima and Manea (2010)
characterize DA using Maskin monotonicity.
This paper also aligns with more recent studies motivated by TTC mechanisms’ fairness
implications. Hakimov and Kesten (2014) and Morrill (2015b) propose TTC variants that
improve fairness under some circumstances; we shall discuss these extensively. Che and Tercieux
(2016a), Che and Tercieux (2016b) and Leshno and Lo (2017) study Top Trading Cycles in large
economies under different asymptotics.8 They show that the amount of justified envy entailed
6

See also Bade (2016). Pycia and Ünver (2011) extend their characterization when each discrete resource can
be represented by a copy.
7
Specifically, Morrill (2015a) declares a mechanism to be unjust (only) if i has justified envy toward j at j’s
assignment s and reassigning j could potentially lead to a “change” of assignment for some student k who has a
higher priority at s than i. Importantly, this notion makes no distinction whether the “change” makes student k
better or worse off.
8
Che and Tercieux (2016a) and Che and Tercieux (2016b) consider a setting in which the number of students
and the number of schools grow large, whereas Leshno and Lo (2017) study a setting in which the number of
students and the number of seats at each school grow large while the number of schools remains fixed and finite.

4

by TTC does not vanish as the economy grows large.
The rest of this paper is organized as follows. Section 2 introduces the model and our method
of comparing mechanisms in terms of their sets of blocking pairs. Section 3 describes a simple
example we use to demonstrate our main theorem. Section 4 defines TTC and states our main
result. Section 5 describes extensions when schools have multiple seats, when priorities are not
strict, and for the housing market model of Shapley and Scarf. Section 6 uses data from New
Orleans and Boston to compare assignment mechanisms and reviews design issues that led to
the adoption of DA after one year in New Orleans. Section 7 concludes.

2

The Model

2.1

Notation

We define a priority-based resource allocation problem in terms of school assignment, following
Abdulkadiroğlu and Sönmez (2003). There are a number of students, each of whom should be
assigned a seat at one of a number of schools. Each student has a strict preference ordering over
all schools as well as remaining unassigned, and each school has a strict priority ranking of all
students. Each school also has a maximum capacity.
Formally, a school choice problem consists of:
1. a set of students I = {i1 , ..., in },
2. a set of schools S = {s1 , ..., sm },
3. a capacity vector q = (qs1 , ..., qsm ),
4. a list of strict student preferences P = (Pi1 , ..., Pin ), and
5. a list of strict school priorities = (s1 , ..., sm ).
For any student i, Pi is a strict preference relation over S ∪ {i} where sPi i means student
i strictly prefers a seat at school s to being unassigned. For any student i, let Ri denote the
“at least as good as” relation induced by Pi . For any school s, s is a complete, irreflexive
and transitive binary priority relation over I.9 Thus, i s j means that i has strictly higher
priority at s than j. The model assumes that priorities are strict, and we examine the weak
priority case in Section 5. Priority rankings are determined by the school district, and schools
have no control over them. We also use the following shorthand notation: P−I 0 = (Pi )i∈I−I 0 and
−S 0 = (s )s∈S−S 0 .
We fix the set of students, the set of schools and the capacity vector throughout the paper;
hence the pair (P, ) denotes a school choice problem (or simply an economy).
9

Our results follow under a more general assumption that s is a complete, irreflexive and transitive binary
priority relation over I ∪ {s}, where i s s s j means that i is eligible for a seat at s and j is not eligible.

5

The outcome of a school choice problem is a matching. Formally, a matching µ : I → S ∪ I
is a function such that
1. µ(i) 6∈ S ⇒ µ(i) = i

for any student i, and

2. |µ−1 (s)| ≤ qs

for any school s.

We refer µ(i) as the assignment of student i under matching µ.
A matching µ Pareto dominates a matching ν, if µ(i)Ri ν(i) for all i ∈ I and µ(i)Pi ν(i)
for some i ∈ I. A matching is Pareto efficient if it is not Pareto dominated by any other
matching.
A matching µ eliminates justified envy if
1. it is individually rational in the sense that there is no student i who prefers remaining
unassigned to her assignment µ(i), and
2. there is no student-school pair (i, s) such that,
(a) student i prefers s to her assignment µ(i), and
(b) either school s has a vacant seat under µ or there is a lower priority student j who
nonetheless received a seat at school s under µ.
If there is a student i who violates the first condition, we say the matching is blocked by
an individual. If there is student-school pair (i, s) that violates the second condition, we say
that student i has justified envy and (i, s) form a blocking pair. A matching eliminates
justified envy if it is not blocked by either any individual or any pair. Eliminating justified envy
is mathematically the same as stability for the college admissions model (Gale and Shapley 1962),
when colleges have responsive and acceptant preferences (Roth 1985).10 The main difference
involves interpretation: in college admissions, each school is a strategic agent, so stability has
strategic implications, whereas in priority-based resource allocation eliminating justified envy is
motivated by fairness considerations.
A mechanism selects a matching for each economy. If ϕ is a mechanism, let ϕ(P, ) denote
the matching selected by ϕ. Let ϕ(P, )(i) denote the assignment of i in matching ϕ(P, ). A
mechanism is Pareto efficient if it only selects Pareto efficient matchings, i.e., for any problem
(P, ), the matching ϕ(P, ) is Pareto efficient. Similarly, a mechanism eliminates justified
envy if it only selects justified envy-free matchings. Finally, a mechanism ϕ is strategy-proof if
reporting true preferences is a dominant strategy for every individual in the preference revelation
game induced by ϕ; that is, for all P , , i and Pi0
ϕ(P, )(i)Ri ϕ(Pi0 , P−i , )(i).
10

A college’s preferences are responsive if there is a linear order of the students according to which it wishes to
fill its seats (up to its quota). Its preferences are acceptant if it would accept any student if a seat is available;
i.e., it finds no student unacceptable.

6

2.2

Mechanisms

We describe three mechanisms for priority-based resource allocation. The simplest is a serial
dictatorship, which is defined through a priority ordering of agents. For a given preference P , a
serial dictatorship assigns the highest priority agent her first choice, the second highest priority
agent her top choice among schools with remaining capacity, and so on. This mechanism is
strategy-proof and Pareto efficient (see, e.g., Roth (1982a), Abdulkadiroğlu and Sönmez (1998),
and Svensson (1999)).
Abdulkadiroğlu and Sönmez (2003) adapt Gale’s TTC for settings with priorities. Given a
problem (P, ), TTC finds a matching via the following algorithm:
• Step 1 : Assign each school a counter that keeps track of how many seats are still available
at the school. Initially set the counters equal to the capacities of the schools. Each student
points to her favorite school under her announced preferences. If a student has no acceptable school, they are removed from the market. Each school points to the student who has
the highest priority for the school. Since the numbers of students and schools are finite,
there is at least one cycle. A cycle c = {sk , ik }k=1,...,K is an ordered list of schools and
individuals such that sk points to ik and ik points to sk+1 for every k where sK+1 = s1 .
Moreover, each school can be part of at most one cycle. Similarly, each student can be part
of at most one cycle. Every student in a cycle is assigned a seat at the school she points
to and is removed. Each school’s counter reduces by one in each cycle, and if the counter
reduces to zero, the school is also removed. All other schools’ counters stay put.
In general, at
• Step k : Each remaining student points to her favorite school among the remaining schools.
If a student has no acceptable school, they are removed from the market. Each remaining
school points to the student with highest priority among the remaining students. There is
at least one cycle. Every student in a cycle is assigned a seat at the school that she points
to and is removed. Each school’s counter reduces by one in each cycle, and if the counter
reduces to zero, the school is also removed. All other schools’ counters stay put.
The algorithm terminates when no more students can be assigned seats. We denote the outcome
of this mechanism as T T C(P, ). This algorithm trades priorities of students among themselves
starting with students with highest priorities. Abdulkadiroğlu and Sönmez (2003) show this
mechanism is strategy-proof and Pareto efficient.
The last mechanism we define is based on Gale and Shapley’s (1962) celebrated DA algorithm,
which assigns student as follows:
• Step 1 : Each student proposes to her first choice. Each school tentatively assigns its seats
to its proposers one at a time, following their priority order. Any remaining proposers are
rejected.
7

In general, at
• Step k : Each student who was rejected in the previous step proposes to her next choice.
Each school considers the students it has been holding together with its new proposers and
tentatively assigns its seats to these students one at a time, following their priority order.
Any remaining proposers are rejected.
The algorithm terminates when there are either no new proposals or each student has exhausted
her rank order list. Dubins and Freedman (1981) and Roth (1982a) show that DA is strategyproof. Gale and Shapley (1962) show that it Pareto dominates any other mechanism that
eliminates justified envy. DA is widely used in school choice systems, including in New York
City (Abdulkadiroğlu, Pathak and Roth 2005b, Abdulkadiroğlu, Pathak and Roth 2009), London
and elsewhere (see, e.g., Pathak and Sönmez (2013) and Pathak (2011)).

2.3

Comparing Mechanisms

To isolate the way in which TTC uses priorities over other efficient and strategy-proof mechanisms, we need a way to compare efficient allocations based on other properties. A recent
literature examines problem-wise comparisons to rank mechanisms by properties that are not
satisfied for each problem (see, e.g., Chen and Kesten (2016), Kesten (2006), Maskin (2016),
and Pathak and Sönmez (2013).) We follow this approach with our definition:
Definition 1. A mechanism ϕ has less justified envy than ψ at , if for any P and studentschool pair (i, s), if pair (i, s) blocks ϕ(P, ), then pair (i, s) blocks ψ(P, ).
When we compare mechanisms for a given problem, this definition is not equal to a comparison of the count of blocking pairs across mechanisms. Rather, the concept involves a subset
relationship: the set of individuals and schools that are in blocking pairs is at least as large
under ψ as under for ϕ for each problem.
Two mechanisms can have less justified envy than each other if they have the same blocking
pairs for each problem. Our next definition rules this out:
Definition 2. A mechanism ϕ has strictly less justified envy than ψ if ϕ has less envy than
ψ, but ψ does not have less envy than ϕ.
Since the concept of less justified envy defines a preorder, our last definition describes the
minimal element of that order.11
Definition 3. Given a class of mechanisms C, ϕ is justified envy minimal in C if there is
no other mechanism ψ in C that has strictly less envy than ϕ.
11

The concept of less justified envy does not define a partial order since the preorder it defines violates antisymmetry. To see this, let ψ and ψ 0 be two distinct, justified envy-free mechanisms. Clearly, ψ has less justified
envy than ψ 0 , and ψ 0 has less justified envy than ψ. However, ψ 6= ψ 0 .

8

These definitions compare the sets of students who have justified envy under two different
mechanisms. As will be clear, we shall perform this comparison within the class of mechanisms
that are Pareto efficient and strategy-proof. In the rest of the paper, when not specified, the
class of mechanisms, C, are Pareto efficient and strategy-proof mechanisms.
Our problem-wise comparison is related to similar ideas for different contexts. The most
closely related notion was examined by Chen and Kesten (2016), who say that a mechanism ϕ is
more stable than φ if at any problem where φ is stable, ϕ is also stable, and there is a problem
where φ is stable and ϕ is not.12 This concept cannot be used to compare mechanisms that
do not produce stable outcomes for any problem, while our notion does allow for comparisons
in those cases. In that respect, our notion allows for more refined comparisons: if ϕ has less
justified envy than φ, then ϕ is more stable than φ.13

3

Motivating Example

We begin with an example illustrating the tradeoff between efficiency and eliminating justified
envy.14 Suppose there are three students I = {i1 , i2 , i3 } and three schools S = {s1 , s2 , s3 }, each
with one seat. Preferences and priorities are given by
Pi1

P i2

P i3

s1

s2

s3

s2

s1

s1

i1

i2

i3

s1

s2

s2

i3

i3

i2

s3

s3

s3

i2

i1

i1

.

DA produces matching
i1 i2 i3
s1 s2 s3

!
,

which eliminates justified envy but is Pareto inefficient. In particular, it is Pareto dominated by
another matching:
!
i1 i2 i3
,
s2 s1 s3
which is Pareto efficient. TTC, by letting students i1 and i2 trade their top priorities respectively
at s1 and s2 , implements this outcome. The trade leaves i3 justifiably envying students i1 and
i2 , as her priorities at s1 and s2 are violated.
12

Hakimov and Kesten (2014) use this idea to compare the stability of two versions of TTC in a problem with
two schools.
13
Variations on problem-wise comparisons used to compare mechanisms by their vulnerability to manipulation
proposed by Pathak and Sönmez (2013) are examined in Andersson, Ehlers and Svensson (2014), and Arribillaga
and Massó (2016a) and Arribillaga and Massó (2016b). Aside from preference manipulation, Kesten (2006) shows
that given a priority structure, if DA is not consistent for an economy, neither is TTC.
14
As we already mentioned in the introduction, this tradeoff is well known. See, for instance, Roth (1982a) and
Abdulkadiroğlu and Sönmez (2003).

9

In short, TTC uses priorities but does not protect all students’ priorities. At the same time,
it does protect the priorities of students i1 and i2 , as they are no worse off than their respective
top priority schools. Our main question is whether it is possible to further reduce justified envy
without sacrificing efficiency or strategy-proofness? Put simply, the answer is no. Consider any
mechanism ψ 6= T T C, and suppose ψ does not match i1 with s2 . (The argument will be the
same if ψ matches i2 differently from TTC.) For student i1 to remain free of justified envy under
ψ, however, he cannot be assigned s3 , so she must match with s1 . Given this, student i2 must
match with s2 , or else i2 will have justified envy. Hence, the only way to reduce the amount
of justified envy produced by TTC is to match students according to the DA matching above,
which is Pareto inefficient.15 Summing up, if one requires Pareto efficiency, strategy-proofness,
and respect for i1 and i2 ’s priorities, just as in the above assignment, then the matching must
coincide with the TTC matching. This illustrates the “envy-minimizing role” of TTC in its use
of priorities.
Take serial dictatorship, which is another prominent efficient and strategy-proof mechanism.
If we require the priorities of i1 and i2 to be respected, the serial order must be either i1 − i2 − i3
or i2 − i1 − i3 ; both cases result in the same matching as the TTC matching. But if preferences
were different, serial dictatorship would typically do worse than TTC under either serial order.
Suppose the students’ preferences are now:
P i1

Pi2

P i3

s3

s2

s3

s2

s3

s2

s1

s1

s1

(Their priorities are the same as before.) TTC will now assign
!
i1 i2 i3
,
s1 s2 s3
which is not only efficient but also free of justified envy; note that all students are assigned to
their top priority schools. Under either of two serial orders, however, the serial dictatorship
mechanism assigns:
!
i1 i2 i3
,
s3 s2 s1
which violates i3 ’s priority.
Next, we will formalize the sense in which TTC “economizes” on the incidence of justified envy and showing that its main contender, serial dictatorship, fails to to economize, both
theoretically and empirically.
15

This argument shows that if ψ has less justified envy than TTC, then the two mechanisms must coincide at
the preference profile we are considering. Our proof of Theorem 1 builds on this argument but must also use
strategy-proofness to show that ψ and TTC actually coincide at other preference profiles.

10

4

TTC as Justified Envy Minimizer

4.1

Main result

Pareto efficiency and eliminating justified envy are two conflicting concepts since there is no
mechanism that satisfies both properties. Our main result states the following constrainedoptimality property of TTC:
Theorem 1. Suppose each school has one seat. Let ϕ be a Pareto efficient and strategy-proof
mechanism. If ϕ has less justified envy than T T C at , then ϕ(·, ) = T T C(·, ).
This result implies that TTC is justified envy-minimal in the class of Pareto efficient and
strategy-proof mechanisms. The proof, provided in the Appendix, proceeds by contradiction.
We first posit that there is an efficient mechanism ϕ with less justified envy than TTC. That is,
there is a problem where ϕ produces an efficient allocation that has less justified envy than the
allocation produced by TTC. By comparing the outcome of ϕ to the steps of TTC, the proof
shows that ϕ cannot have less justified envy than the TTC allocation without contradicting
either the Pareto efficiency or strategy-proofness of ϕ.
We do not claim TTC to be the only justified-envy minimal mechanism in the class of Pareto
efficient and strategy-proof mechanisms. However, we can identify a well-known mechanism in
this class that is not justified-envy minimal. For each school s, let fs :s →s be an arbitrary function that transforms its priority into another (possibly same or distinct) priority. Let
f = (fs )s . Consider a class of mechanisms ϕ(·, ) = T T C(·, f ()). In other words, the new
mechanism is obtained by running a TTC under priorities that may differ from true priorities.
Observe that ϕ is Pareto efficient and strategy-proof. A well-known mechanism in this class is
serial dictatorship, which is obtained if for some ordering  over students, fs (s ) = for any
s and s.
Proposition 1. Suppose fs (s ) 6=s for some school s. Then, the mechanism ϕ(·, ) =
T T C(·, f ()) is not justified-envy minimal.
Proof. Assume 0s := fs (s ) 6=s . This must mean that there are at least two students i1 and
i2 such that i1 s i2 , but i2 0s i1 . Consider an environment where school s is the only school.
Clearly, in this environment, there is trivially a strategy-proof, Pareto efficient, and justified
envy-free mechanism. For instance, TTC is one such mechanism. Further assume that students
i1 and i2 are the only students ranking school s as acceptable. It is obvious that in such a
case, the “distorted” TTC fails to select an envy-free assignment. Hence, it cannot be justified
envy-minimal.16
16

While it may look obvious that running TTC with the “wrong” priorities will fail to be justified envy-minimal,
we provide an example in Appendix C showing that, if we are allowed more fine-tuning (for instance, if the priority
modifications are allowed to depend on the preferences) a modified version of TTC can be justified envy-minimal
in the class of strategy-proof and Pareto-efficient mechanisms.

11

This result shows that the envy-minimality of TTC is nontrivial. It also highlights the roles
played by the priorities in economizing on justified envy: the envy-minimality fails even with
minimally modified priorities.

4.2

“Tightness” of Theorem

Our characterization is tight in the sense that relaxing any of the assumptions yields a mechanism
with less justified envy and the remaining properties. Indeed, when we drop the efficiency
requirement, TTC does not minimize envy in the class of strategy-proof mechanisms. In that
class, TTC produces matchings allowing for justified envy, while DA does not. Therefore, DA
minimizes justified envy in that class.
In addition, TTC does not minimize envy in the class of Pareto efficient mechanisms, when
we drop the strategy-proofness requirement. The following example provides a mechanism that
is Pareto efficient and has strictly less justified envy than TTC.
Example 1 (A Pareto efficient but not strategy-proof mechanism with less justified envy than
TTC). Suppose there are three students I = {i1 , i2 , i3 } and three schools S = {s1 , s2 , s3 }. Preferences and priorities are given by
P i1

P i2

P i3

s1

s2

s3

s2

s1

s1

i1

i2

i3

s3

s2

s2

i3

i3

i2

s1

s3

s3

i2

i1

i1

.

T T C yields the matching
µ=

i1 i2 i3
s2 s1 s3

!
.

Matching µ is blocked by the pair (i3 , s1 ) and the pair (i3 , s2 ). The following matching is Pareto
efficient and justified envy-free:
ν=

i1 i2 i3
s3 s2 s1

!
.

We build the mechanism ϕ as follows: for any problem other than the one considered above,
let ϕ pick the same matching as T T C. For the above problem, ϕ picks ν, the efficient and
justified envy-free matching. Clearly, ϕ is Pareto efficient and ϕ has less justified envy than
TTC. Our main result implies that mechanism ϕ is not strategy-proof. Indeed, if the preferences
are given as in the above instance, student i1 is assigned to school s3 . However, if i1 misreports
his preferences by switching school s3 and s1 , then we obtain the TTC outcome: i1 is matched
to s2 and is better off.
Another assumption in our characterization result is that each school has a single seat. We
discuss the case with multiple school seats in detail in the next section.
12

5

Extensions

5.1

Multiple school seats

When schools may have more than one seat, there are multiple possible implementations of
TTC. We refer to the version defined in Section 2.2 as TTC-Counters, since each school starts
with a counter.
Morrill (2015b) introduces a TTC variation known as TTC-Clinch and Trade. This
mechanism is motivated by the idea that TTC-Counters allows an applicant i to use her priority
at another school to “trade” into a school even when the applicant is among the highest qs
priority students at school s. These trades may lead to unnecessary situations of justified envy,
which can be avoided by “clinching” or assigning applicants in this highest-priority group before
forming and executing cycles. The mechanism works as follows:
• Step 1 :
1a) For each i ∈ I, if it is one of the qs highest ranked students at i’s most preferred
school s, then assign i to s, remove i, and set qs = qs − 1. Whenever we remove
a student, we adjust the rankings of all schools accordingly. This is called clinching
a school. Iterate the clinching procedure until no student has one of the qs highest
priorities at her most preferred school s.
1b) Have each student that remains point to her most preferred school that has capacity
greater than zero. Have each school with available capacity point to the highest ranked
student. Note that a cycle must exist. For every cycle that exists, assign the student
to the school to which she is pointing, remove the student, and reduce the capacity of
the school by one.
• Step k :
ka) If the school to which i was pointing in Round k − 1 still has available capacity, then
i continues to point to the same school. For the students whose favorite school was
removed in the previous round, iterate the clinching process until no student has one
of the qs highest priority at her most preferred school s unless she was pointing to s
at the end of round k − 1.
kb) Have each remaining student point to her most preferred school that has capacity
greater than zero. Have each school with available capacity point to the highest priority
student. A cycle must exist. For every cycle that exists, assign the student to the
school to which she is pointing, remove the student, and reduce the capacity of the
school by one.

13

The algorithm terminates when all students are assigned a seat. Morrill (2015b) shows that
Clinch and Trade is strategy-proof and efficient.
Another TTC variation is motivated by the fact that in TTC-Counters, the highest priority
student has “ownership” over all slots of a school. That is, in TTC-Counters, there are at most
|S| participants in each round, and the market may be made thickened by considering all school
seats. Hakimov and Kesten (2014) define Equitable TTC, which assigns all slots of school s to
all the qs students with the highest priority, giving one seat to each student and endowing them
with equal trading power. The key part of this extension requires specifying who can point to
whom. The mechanism works as follows:
• Step 1: For each school, all available slots are assigned to students one by one, following
their priority order, to form student-school pairs. Each student-school pair (i, s) points to
the student-school pair (i0 , s0 ) such that (i) school s0 is the best choice of student i, and
(ii) student i0 is the student with the highest priority for school s among the students who
are assigned to a slot from school s0 . If student i is already assigned to one slot from her
best choice school, then all student-school pairs containing her point to that student-school
pair. There is at least one cycle. In each cycle, corresponding trades are performed, and
all student-school pairs that participate in a cycle are removed. It is possible that studentschool pairs containing the same student, say student i, appear in either the same or in
different cycles. In such a case, student i is placed in her best choice, and the other slots
of that school (to which the student-school pairs containing her are pointing in those other
cycles) remain to be inherited. For each student-school pair (i, s) that participates in a
cycle, the slots assigned to student i in other student-school pairs that do not participate
in a cycle also remain to be inherited.
• Step k :
ka) Inheritance: For each school s, such that (i) there are slots at school s that remain to
be inherited from previous steps, and (ii) there are no existing pairs that were assigned
to a slot at school s in previous steps of the algorithm, the slots that remained to be
inherited from previous steps are assigned to the remaining students one by one,
following the priority order for school s to form new student-school pairs.
kb) Pointing: Each student-school pair (i, s) points to the student-school pair (i0 , s0 ) such
that (i) school s0 is the best choice of student i, and (ii) student i0 is the student with
the highest priority for school s among the students who are assigned to a slot from
school s0 . If student i is already assigned to one slot from her best choice school, then
all student-school pairs containing her point to that student-school pair. There is at
least one cycle. In each cycle, corresponding trades are performed, and all studentschool pairs that participate in a cycle are removed. It is possible that student-school
pairs containing the same student, say student i, appear in the same cycle or in
14

different cycles. In such a case, student i is placed in her best choice, and the other
slots of that school (to which the student-school pairs containing her are pointing in
those other cycles) remain to be inherited. For each student-school pair (i, s) that
participates in a cycle, the slots assigned to student i in other student-school pairs
that do not participate in a cycle also remain to be inherited.
Hakimov and Kesten (2014) shows Equitable TTC is Pareto efficient and strategy-proof.
They also show that if there are two schools, if Equitable TTC selects an allocation with justified
envy for a problem, then TTC also selects an allocation with justified envy, but the converse is
not necessarily true.
To understand the differences between these variations on TTC, consider the following example.
Example 2. [Variations on TTC] Suppose there are three students I = {i1 , i2 , i3 } and two
schools S = {s1 , s2 }, with qs1 = 2 and qs2 = 1. The preferences and priorities are given by
P i1

P i2

P i3

s1

s2

s2

s1

s2

i1

i2

s1

s2

s1

i2

i3

i3

i1

.

TTC produces:
i1 i2 i3
s2 s1 s1

!
,

where during TTC, i2 forms a cycle with i1 that assigns her to s1 , even though she has high
enough priority to be assigned to s1 without being in a cycle with another student. TTC-Clinch
and Trade as well as Equitable TTC avoid this cycle and produce the efficient and justified
envy-free matching:
!
i1 i2 i3
.
s1 s1 s2
This example might suggest other possible mechanisms that have strictly less justified envy
than TTC. However, TTC-Clinch and Trade and TTC-Counters are not generally comparable in
terms of justified envy in general, since the set of blocking pairs are non-empty and disjoint for
both mechanisms. Roughly speaking, by clinching, an applicant obtains her top choice, resulting
in other applicants improving their priority. These priority improvements, in turn, generate new
trading opportunities that can result in justified envy.
None of TTC-Counters, TTC-Clinch and Trade, or Equitable-TTC is constrained-optimal
with multi-unit capacity, as we next show.
Proposition 2. Suppose there is a school with more than one seat. Then,

15

i) TTC-Counters, TTC-Clinch and Trade, and Equitable TTC are not justified-envy minimal
within the set of Pareto efficient and strategy-proof mechanisms.
ii) For each of the three mechanisms, there exists a justified envy minimal, Pareto efficient,
and strategy-proof mechanism that has strictly less justified envy than that mechanism.
The proof of the first part of this result constructs a Pareto efficient and strategy-proof
mechanism ϕ that produces the same outcome as TTC-Counters for nearly all problems. We
define it to produce a different outcome than TTC-Counters in a problem that always has a
Pareto efficient and justified envy-free matching. For instance, coming back to Example 2, one
can check that the priorities satisfy the conditions identified in Ergin (2002); for any set of
preferences, there will be a matching that is Pareto efficient and justified envy-free. Hence,
in this economy, the strategy-proof student-proposing deferred acceptance mechanism selects
a matching satisfying those two properties. Recall, however, that TTC-Counters produces a
matching that is not justified envy-free in this example. Hence, we can build a mechanism that
selects the outcome of the student-proposing deferred acceptance mechanism when priorities
are given as in Example 2 and otherwise coincides with TTC-Counters. This mechanism is
strategy-proof and Pareto efficient and has strictly less justified envy than TTC-Counters. The
full argument for TTC-Counters—as well as TTC-Clinch and Trade and Equitable TTC—is
provided in Appendix.
The second part of this result follows from the finiteness of I and S: for fixed number
of schools, students, and school capacities, the number of Pareto efficient and strategy-proof
mechanisms is finite, since the number of priorities and preferences is also finite. Hence, starting
from any mechanism in this class, one can iteratively find a mechanism improving in the justified
envy (which is a transitive order) until one reaches a justified-envy minimal mechanism in finite
steps. While the existence of justified-envy minimal mechanisms can be shown, no simple
constructive algorithm has been found so far. Whether such an algorithm exists remains an
open question.
These observations motivate the empirical analysis in Section 6, which evaluates the performance of three variations of TTC compared to serial dictatorship and deferred acceptance.

5.2

Weak Priorities

The school choice problem was defined with strict priorities. In practice, priorities are often
defined via coarse categories in practice, such as having a sibling enrolled at the school or
residing in the school’s geographic catchment area. In this section, we relax the assumption that
priorities are strict. Let % be a profile of weak priority relations, where each element is complete
and transitive but need not be irreflexive or anti-symmetric.
An assignment mechanism ϕ selects a matching for each problem (P, %). For example, one
possible mechanism is to convert the weak priorities into strict priorities using a tie-breaker and

16

then apply one of the mechanisms described in Section 2.2. Formally, a tie-breaker rs at school
s is a function rs : I → N that assigns each student a number. Under %s , when two students
have equal priority the tie-breaker constructs s by giving higher priority to the student with
the lower value of the tie-breaker. Let τ be a collection of tie-breakers for each school; that is,
τ = (rs )s∈S . T T Cτ is a mechanism that applies the tie-breaker τ to construct the strict priority
order, and then applies TTC to the resulting problem. That is, given (P, %), T T Cτ first applies
tie-breaker τ to % to construct τ and then computes T T C(P, τ ).
For any given τ , T T Cτ is Pareto efficient and strategy-proof. However, even when each
school has one seat, it is possible to show that T T Cτ does not minimize justified envy among
Pareto efficient and strategy-proof mechanisms.
Example 3 (T T Cτ does not minimize justified envy for problem (P, %)). There are three
students I = {i1 , i2 , i3 } and two schools S = {s1 , s2 }, where qs1 = qs2 = 1. School s1 has
strict priorities given by i1 s1 i2 s1 i3 , while s2 ranks i2 last and is indifferent between i1 and
i3 . Consider the tie-breaker τ , where r(·) is the same for each school and is defined by r(i1 ) = 2,
r(i2 ) = 3, and r(i3 ) = 1. With this tie-breaker, τ is given by:
s1

s2

i1

i3

i2

i1

i3

i2

.

Suppose that preferences are as follows:
P1

P2

P3

s2

s1

s1 .

s1

s2

s2

TTC yields the following matching
i1 i2 i3
s2 i2 s1

!
,

where i2 is unassigned. In problem (P, %), the pair (i2 , s1 ) blocks this matching.
Consider student-proposing DA with some other tie-breaking rule τ̂ , where each school’s tiebreaker is given by r̂(·) with r̂(1) = 1, r̂(2) = 2, and r̂(3) = 3. The corresponding priorities τ̂
are given by:
s1 s2
i1

i1

i2

i3

i3

i2

.

It is easy to check that this satisfies the acyclicity condition in Ergin (2002). Therefore, DA
applied to (P, τ̂ ) is Pareto efficient.
17

To show that T T Cτ does not minimize envy in the class of Pareto efficient and strategy-proof
mechanisms for problems (P, %), we build ϕ which applies student-proposing DA with tie-breakers
τ̂ applied to % whenever the priorities are given as above and applies TTC with tie-breaker τ
applied to % for any other priority relation. The resulting mechanism ϕ is Pareto efficient and
strategy-proof and has less justified envy than T T Cτ .
A potentially unusual aspect of this example is that the tie-breaking rule depends on which
mechanism we use. It may be more natural to compare mechanisms holding fixed the way
tie-breakers are selected by the mechanism. For a mechanism ϕ for problem (P, ), we can
define ϕτ for problem (P, %) as the mechanism that applies tie-breaking τ to % to construct τ
and then computes the outcome of ϕ for (P, τ ). With this definition in hand, the following
proposition is an immediate consequence of our main theorem:
Proposition 3. Suppose that each school has one seat. Let τ be a tie-breaking rule and ϕτ be
a Pareto efficient and strategy-proof mechanism. If ϕτ has less justified envy than T T Cτ , then
ϕτ = T T Cτ
Proof. Suppose that ϕτ has less justified envy than T T Cτ . Then there exists (P, %) such that
ϕτ (P, %) has less justified envy than T T Cτ (P, %). Consider (P, τ ), and observe
ϕ(P, τ ) = ϕτ (P, %)

and

T T C(P, τ ) = T T Cτ (P, %).

Therefore, ϕ(P, τ ) has less justified envy than T T C(P, τ ), which contradicts Theorem 1 which
states that if ϕ has less justified envy than T T C, ϕ must equal T T C.

5.3

The Shapley-Scarf Housing Market Model

As noted above, Gale initially proposed the TTC algorithm for the housing market model of
Shapley and Scarf (1974). In the housing market model, the number of individuals is equal to
the number of objects or “houses.” Each individual has a complete strict ranking over houses
and is endowed with a house. Roth and Postlewaite (1977) showed that the market’s unique
core is found via Gale’s TTC algorithm, since in each cycle an individual points to the owner of
his most preferred house among the remaining houses. (Recall that for priority-based resource
allocation, a cycle consists of individuals pointing to objects and objects pointing to individuals.)
For this model, an allocation is individually rational if every individual is assigned a house that
she weakly prefers to her initial endowment. Roth (1982b) shows that TTC is strategy-proof in
this model, and Ma (1994) shows that Gale’s TTC is the only Pareto efficient, strategy-proof,
and individually rational mechanism for this problem.
If we re-interpret the Shapley-Scarf economy such that the agent endowed with a house is first
in that house’s priority relation, while all other agents have the equivalent priority just below
the owner, then we can consider this setting as equivalent to our model with weak priorities.
Let % be as described above. A pair (i, s) blocks a matching µ in economy (P, %) if and only if
18

sPi µ(i), where s is the unique school at which i has top priority, which means that individual
rationality is violated. Thus, if a Pareto efficient and strategy-proof mechanism is individually
rational in a Shapley-Scarf economy, it must be that this mechanism has less justified envy than
T T C at %. Theorem 1 therefore implies the following17
Corollary 1 (Ma (1994)). In a Shapley-Scarf economy, a mechanism is Pareto efficient, strategyproof, and individually rational if and only if it is T T C.

6

Comparing Mechanisms in New Orleans and Boston

In this section, we use data from New Orleans and Boston to compare Pareto efficient and
justified envy-free allocations in practice.

6.1

New Orleans

The New Orleans Recovery School District was formed in 2003 to facilitate state control of
schools in New Orleans. The RSD’s role expanded considerably following Hurricane Katrina in
2005, and by 2011-12, the district came to oversee the majority of schools in New Orleans. In
2011-12, the RSD included a total of 73 schools: 13 district-run and 60 charter schools. In 201112, the district launched a pioneering unified enrollment process known as OneApp, in an effort
to make the process easier to navigate and improve the efficiency of the previous decentralized
application process.18
Early on, officials identified three major priority groups: students with siblings currently
enrolled in a school, students currently enrolled in schools that are closing, and students who
live in the school’s geographic area. More background on OneApp is presented in Vanacore
(2011), Vanacore (2012), and Harris, Valant and Gross (2015). There was little concern that
RSD schools would form blocking pairs and try to enroll pupils from other RSD schools, as might
motivate a strategic rationale for eliminating blocking pairs. When deciding on the assignment
mechanism, the RSD relied on the Boston experience, whose school priority structure was most
similar to New Orleans. At the time, Boston had a sibling and walk zone priority (see, e.g.,
Abdulkadiroğlu et al. (2005a) and Pathak and Sönmez (2008)).19 New York City’s experience
with a new centralized assignment system was also relevant because the superintendent and
17

Theorem 1 is proved for strict priorities. However, it is easily checked that it extends to the weak priorities
considered in this section. Indeed, the proof of the theorem goes through as long as, when a school s points to a
student i at some step of TTC, i s j for any individual j who remains at this step. Under the priority relations
considered in this section, this property is satisfied.
18
16 schools managed by the Orleans Parish Board, a second school district in New Orleans were not part of
the OneApp process in its first year, nor were five charter schools authorized by the state’s Board of Elementary
and Secondary Education (BESE).
19
In 2013, Boston Public Schools eliminated walk zones, and the current system only has a sibling priority. See
Dur, Kominers, Pathak and Sönmez (2016) for more details.

19

many other RSD staffers had worked in New York City’s Department of Education when it
adopted a new mechanism.
The discussion centered on the trade-off between efficiency and eliminating justified envy,
and there were concerns about how to explain TTC to the public. Officials eventually sided with
efficiency and selected TTC-Counters based on the desire for “as many students as possible get
into their top choice school” (RSD 2012). Other versions of TTC had not yet been systematically
investigated at the time of the decision and so were not considered. To address the concerns
about explaining the algorithm, staff were trained in the basics of how the algorithm worked,
and promotional materials were released to the public to provide an overview of the algorithm
before it was used (see, e.g., the newspaper descriptions in the New Orleans Times-Picayune
referenced in Vanacore (2011) and Vanacore (2012)).20
We use data from elementary and high school applicants in grade PK and 9 in the 2011-12
school year, and report on the performance of five mechanisms: TTC-Counters, TTC-Clinch and
Trade, Equitable TTC, Serial Dictatorship, and DA. Applicants are asked to rank up to eight
choices; in practice, less than 5% of applicants rank all eight choices, so it seems reasonable to
run the alternative algorithms without taking any behavioral response into account since truthtelling is a weakly dominant strategy in each mechanism without a constraint.21 We draw 100
sets of lottery numbers, one for each child, and ran the assignment algorithms for each lottery
draw. For the serial dictatorship, we order students according to the realized lottery order.
Table 1 reports the average across lottery draws and two grades.
Our analysis shows that all three versions of TTC produce nearly identical aggregate rank
distributions and similar amounts of justified envy. Roughly 65% of applicants are assigned to
their top choice, and 19% are unassigned. Of those who obtain their first choice across lottery
draws, the standard deviation is 5.2, so there is virtually no difference once we account for
simulation uncertainty. Across the three versions of TTC, about 13% of students and 10% of
schools are involved in a blocking pair. Here again, the differences between columns are much
smaller than the standard deviation across lottery draws. Likewise, the differences in the count
of blocking pairs and instances of justified envy are similar for each version of TTC.22
20

School choice design comprises not only algorithms but also communication packages.
Strictly speaking, when there is a constraint on the number of choices an applicant can rank, none of the
mechanisms is strategy-proof. But for the 95% of applicants who ranked fewer than eight choices, they could have
ranked an additional choice, and so there is little reason to strategize among the choices they submitted. Haeringer
and Klijn (2009), Calsamiglia, Haeringer and Kljin (2010), and Pathak (2016) provide additional analysis and
discussion of constrained rank order lists.
22
Note that this conclusion differs from some of the simulations performed by Hakimov and Kesten (2014) and
Morrill (2015b), which show substantial differences across TTC variants. One way to interpret the difference is
that the simulation environments (e.g., the distribution of preferences and priorities) considered by these authors
do not approximate real-world markets such as New Orleans and Boston. Another possibility is that the difference
across different TTC variants may diminish in large markets; for instance, Leshno and Lo (2017) reach a conclusion
consistent with our empirical findings, showing that in a large market the TTC-Clinch and Trade may not perform
better (and sometimes considerably worse) than the TTC-Counters in terms of justified envy.
21

20

Further, each of the three TTC mechanisms has less justified envy than Serial Dictatorship.23 About 18% of students have justified envy, and five more schools trigger justified envy
under Serial Dictatorship compared to TTC. These differences are larger than the corresponding standard deviation due to lottery draws. Moreover, the number of blocking pairs is roughly
40% greater under Serial Dictatorship than under TTC. This evidence suggests that the forces
identified in Theorem 1 and Proposition 1 carry through (even) when schools can have more
than one seat; namely, TTCs (of different variants) perform well in terms of “economizing” on
justified envy when schools have more than one seat. It is worth noting that the aggregate rank
distribution under the Serial Dictatorship is similar to that under TTC, indicating that, based
on this metric, there may be little cost to minimizing blocking pairs.
In 2012-13, the RSD switched to DA, citing three main reasons. First, there were on-going efforts to encourage participation from a broader set of schools in New Orleans, including screened
schools in the Orleans Parish School Board (OPSB). OPSB schools include those that audition
applicants for specialized music, arts, and specialized athletic programs, in which eliminating
blocking may be valuable for strategic reasons.24 Second, TTC was perceived as difficult for
participants to understand and for staff to explain why a child was assigned a seat over a child
who was not. Under DA, officials could explain that an applicant did not obtain an assignment
at a higher ranked seat because another applicant with higher priority was assigned to that
seat. Such an explanation was not available for TTC. Finally, eligible families were allowed to
apply for non-public schools participating in Louisiana’s Scholarship Program (LSP), a voucher
program that allows low-income students in low-performing schools to apply for private schools
(for more details on this program, see Abdulkadiroglu, Pathak and Walters (2016)). The LSP
expanded statewide during Year 2 of OneApp due to a state law, Act 2. The Louisiana Department of Education interpreted blocking pairs created by TTC as being potentially subject to
legal challenge under Act 2.
The last column of Table 1 suggests that the switch to DA may have had little impact on
the overall aggregate rank distribution of choices received by applicants. Slightly fewer students
are assigned to their top choice under DA. The difference between DA and TTC-Counters is
10 students, which is greater than the standard deviation of first choice under TTC-Counters,
which was 5.2. Slightly more students are assigned their second choice, and DA has somewhat
fewer students unassigned. The benefit of this small reduction in top choice assignment is that
no student is involved in a blocking pair.
23

Note also that Serial Dictatorship entails similar aggregate rank distribution as each TTC mechanism. The
finding that all four Pareto efficient mechanisms perform similarly in aggregate rank distribution is consistent
with Che and Tercieux (2017), who establish approximate payoff equivalence of Pareto efficient mechanisms in
large allocation problems.
24
Direct-run OPSB schools participated in OneApp in 2012-13, but OPSB charter schools and charter schools
run directly by the state under the purview of OPSB did not. In December 2012, the OPSB passed an amendment
requiring charter schools to participants in OneApp when their contracts are reauthorized. The RSD encouraged
all OPSB charters to participate.

21

6.2

Boston

Boston Public Schools operates a school choice process wherein applicants can apply to any
school in their zone for elementary and middle school and city-wide for high school. Like in New
Orleans, students are prioritized based on sibling and walk zone status, so that students with
siblings at a school who reside in the walk zone have highest priority, students with siblings at
a school have the next highest priority, and students in the walk zone have the next highest
priority. Within each priority, students are ordered using their random number.25 We work
with data from four years, from 2009-2010 through 2012-2013, when the district employed the
student-proposing deferred acceptance algorithm.26 We focus on main round applicants for the
elementary (grade K1 and K2), middle (Grade 6), and high school (Grade 9) transition points.
For each applicant, we observe the priority of the choices they ranked.27 Since the mechanism is
based on DA, applicants can rank as many schools as they wish, and BPS advises families to list
schools in order of true preference (BPS 2012), we simulate the outcome of other mechanisms
holding the submitted preferences fixed.
Table 2 shows that the patterns in Boston parallel those in New Orleans. Namely, there is
little difference across the three versions of TTC in terms of the aggregate rank of choices assigned
and amount of justified envy. Furthermore, TTC has significantly less justified envy than the
Serial Dictatorship and a similar aggregate rank distribution. Finally, DA assigns slightly fewer
students to their first choice and has a small number who are unassigned. This difference is
far smaller than the difference in the number of students with justified envy under TTC. These
facts suggest our results may be relevant for other cities with similar priority structures as New
Orleans and Boston.

7

Conclusion

This paper provided a formal basis for recommending TTC over other Pareto efficient and
strategy-proof mechanisms for priority-based resource allocation. Our main result is a counterpart to the constrained-optimality result for DA and shows that there is a formal justification for
resolving the trade-off between Pareto efficiency and the elimination of justified envy as initially
envisioned by Abdulkadiroğlu and Sönmez (2003).
Using data from New Orleans and Boston, we investigated three TTC variations for settings
where schools may have more than one seat. The aggregate rank distribution and set of blocking
25

Appendix E of Dur et al. (2016) provides additional details on the priority structure, and describes how the
mechanism applies walk zone priority for only one-half of school seats.
26
Boston continues to employ DA, but changed the configuration of its schools zones after our time-period (see,
e.g., Dur et al. (2016) for more details).
27
To implement TTC, it is necessary to compute the priority of choices that are not ranked. We impute sibling
priority at unranked schools using a list of schools that siblings attend and walk zone priority using information
linking residential locations to the set of walk zone schools.

22

pairs are similar across these versions of TTC. Further, all TTC variations have significantly less
justified envy than a serial dictatorship, thereby providing an empirical analogue to our main
result.
In the field, there is growing momentum in favor of DA over TTC (see, e.g., Pathak and
Sönmez (2013) and Pathak (2016)). This trend may be driven by a first-mover advantage of
DA, since New York City and Boston adopted DA in 2003 and 2005, and its familiarity as the
core of the National Residency Matching Program for U.S. doctors (Roth and Peranson 1999).
Our paper shows that the aggregate rank distribution of choices assigned under DA and TTC
are similar in Boston and New Orleans, which may further shift the balance in favor of DA for
markets similar to these two areas.28
Moreover, officials in New Orleans echoed a theme in Boston: TTC seems harder to explain
and participate in compared to DA. It remains to be seen whether there will be another setting
where TTC is used for school assignment in the field. Part of the challenge in advocating for
TTC is explaining how it reflects priorities, a difficulty that may be easier to surmount with our
formal result. It’s possible that TTC would have been selected in other settings with knowledge
of this result, and at the very least, advocates now have a new argument in favor of TTC.

28

New York City high school assignment exhibits a more discernible difference between TTC and DA in aggregate rank distribution of assigned choices (see Abdulkadiroğlu et al. (2009) and Che and Tercieux (2016b)), and
the pattern of difference is consistent with a theoretical result of Che and Tercieux (2016b) for a large-market
model. New York City school assignment is unique in size (it involves more than 80,000 applicants annually)
and variety of programs (it includes more than 750 programs of differing in types, including screened, limited
unscreened, and Ed-opt, etc.). The extent to which differences in market characteristics affect the performance
of alternative matching mechanisms is worth further investigation.

23

Table 1. Comparison of Mechanisms in New Orleans for Main Transition Grades (PK and Grade 9)

1
2
3
4
5+
Unassigned
Total

TTC-Counters
(1)

TTC-Clinch and
Trade
(2)

772
126
46
18
11
222
1196

770
129
47
18
11
221
1196

Equitable TTC Serial Dictatorship
(3)
(4)
A. Choice Assigned
771
777
127
121
47
44
18
17
11
8
222
228
1196
1196

StudentProposing
Deferred
Acceptance
(5)
762
137
51
19
10
217
1196

B. Statistics on Blocking Pairs
Students with justified envy
158
157
159
213
0
Schools involved in blocking pairs
7
7
7
12
0
Blocking pairs (i,s)
228
224
215
308
0
0
Instances of justified envy (i, (j,s))
1111
1086
1100
6546
Notes: The main transition grades are PK and Grade 9 for 2012. TTC-counters defined in Abdulkadiroglu and Sonmez (2003). TTCClinch and Trade defined in Morrill (2015). Equitable-TTC defined in Hakimov and Kesten (2014). Students with justified envy
means there exists a school s where (i,s) is a blocking pair. School involved in blocking pairs means there is a school s such that
there exists student i such that (i,s) is a blocking pair. Blocking pairs (i,s) means there exists at least one applicant j such that (i,(j,s))
is a blocking instance. Instance of justified envy (i,(j,s)) means student i complains about student j's assignment at s. The
numbers represent averages of 100 different lottery draws for each grade, which are then averaged over grades PK and 9. The
standard deviation across lottery draws in column 1 for first choice assigned is 5.2, for unassigned is 5.2, for students with justified
envy is 8.5, for schools involved in blocking pairs is 0.4, for blocking pairs is 20.2, and for instances of justified envy is 110.7.
Standard deviations are similar for the other columns.

Table 2. Comparison of Mechanisms in Boston for Main Transition Grades (K1, K2, 6, and 9)

1
2
3
4
5+
Unassigned
Total

TTC-Counters
(1)

TTC-Clinch and
Trade
(2)

1240
322
134
56
39
102
1893

1240
323
134
55
39
101
1893

Equitable TTC Serial Dictatorship
(3)
(4)
A. Choice Assigned
1240
1236
323
315
134
132
55
51
53
34
101
124
1893
1893

StudentProposing
Deferred
Acceptance
(5)
1227
336
138
57
40
96
1893

B. Statistics on Blocking Pairs
Students with justified envy
129
126
125
280
0
0
Schools involved in blocking pairs
18
18
18
44
Blocking pairs (i,s)
160
156
157
369
0
Instances of justified envy (i, (j,s))
768
711
696
3650
0
Notes: Data cover four school years from 2009-2010 through 2012-13. TTC-counters defined in Abdulkadiroglu and Sonmez
(2003). TTC-Clinch and Trade defined in Morrill (2015). Equitable TTC defined in Hakimov and Kesten (2014). Instance of justified
envy (i,(j,s)) means student i complains about student j's assignment at s. Blocking pair (i,s) means there exists at least one
applicant j such that (i,(j,s)) is a blocking instance. Students with justified envy means there exists a school s where (i,s) is a
blocking pair. Schools involved in blocking pairs means there is a school s such that there exists student i such that (i,s) is a
blocking pair. BPS precedence implemented as Walk-Open. The numbers represent averages of 100 different lottery draws for
each grade, which are then averaged over grades K1, K2, 6, and 9. The standard deviation across lottery draws in column 1 for first
choice assigned is 6.8, for unassigned is 5.2, for students with justified envy is 16.9, for schools involved in blocking pairs is 2.4, for
blocking pairs is 21.6, and for instances of justified envy is 98.6. Standard deviations are similar for the other columns.

A

Proof of Theorem 1

Proof. Let ϕ be a Pareto efficient and strategy-proof mechanism that has less justified envy than
T T C at the profile of priority relations . To the contrary, suppose that there exists P such
that
ϕ(P, ) 6= T T C(P, ).
The proof will proceed by induction on the steps of T T C. Let Ik (P, ) be the set of individuals
who are matched in step k of T T C(P, ).
Claim 1: For all i ∈ I1 (P, ),
ϕ(P, )(i) = T T C(P, )(i).
Proof. Suppose that for some i ∈ I1 (P, ),
ϕ(P, )(i) 6= T T C(P, )(i).
Let c = {sk , ik }k=1,...K be the cycle in which i is matched with T T C(P, )(i) and i = iK . We
will abuse notation and say that i ∈ c for some i if i = i1 , ..., iK . Note that every ik trades sk
for sk+1 , which is ik ’s first choice.
Consider the alternative preference relation:
Pi0K : s1 , sK , ...
Since we’ve only altered the preferences of individuals in c and each obtains her first choice, the
T T C matching remains the same:
T T C(Pi0K , P−{iK }, ) = T T C(P, ).
Since s1 is iK ’s first choice and
ϕ(P, )(iK ) 6= T T C(P, )(iK ),
{z
}
|
=s1

we obtain
s1 PiK ϕ(P, )(iK ).

(1)

Also, since sK points to iK , by construction of T T C, we know that
T T C(Pi0K , P−{iK } , )(iK )Ri0 K sK .
Therefore, (iK , sK ) does not block T T C(Pi0K , P−{iK } , ).
Since ϕ has less justified envy than T T C at , (iK , sK ) also does not block ϕ(Pi0K , P−{iK } , ).
In addition, since sK points to iK in cycle c, for all j 6= iK , we have
iK sK j
26

so that
ϕ(Pi0K , P−{iK } , )(iK ) ∈ {s1 , sK }
must hold. Then equation (1) and strategy-proofness of ϕ imply
ϕ(Pi0K , P−{iK } , )(iK ) = sK ,
for otherwise iK would be able to manipulate ϕ in economy (P, ) by submitting Pi0K to obtain
s1 . As a result, iK obtains her second choice under Pi0K .
Next, consider iK−1 and the alternative preference
Pi0K−1 : sK sK−1 ...
As before, the TTC matching remains the same:
T T C(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , ) = T T C(Pi0K , P−{iK } , ) = T T C(P, ).
Since sK is iK−1 ’s first choice and
ϕ(Pi0K , P−{iK } , )(iK−1 ) 6= T T C(Pi0K , P−{iK } , )(iK−1 ),
{z
}
|
=sK

we obtain
sK PiK−1 ϕ(Pi0K , P−{iK } , )(iK−1 ).

(2)

Also, since sK−1 points to iK−1 , by construction of T T C, we know that
T T C(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−1 )Ri0 K−1 sK−1 ,
it must be the case that (iK−1 , sK−1 ) does not block T T C(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , ). Since ϕ
has less justified envy than T T C at , (iK−1 , sK−1 ) does not block ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , ).
In addition, since sK−1 points to iK−1 in cycle c, for all j 6= iK−1 , we have
iK−1 sK−1 j.
Thus, using the fact that (iK−1 , sK−1 ) does not block ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , ), as before,
we obtain
ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−1 )Ri0 K−1 sK−1 ,
so that
ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−1 ) ∈ {sK , sK−1 }.
By strategy-proofness of ϕ and by (2), it must be that
ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−1 ) = sK−1 .

27

Then
ϕ(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−2 ) 6= T T C(Pi0K−1 , Pi0K , P−{iK−1 ,iK } , )(iK−2 ) .
{z
}
|
=sK−1

Repeating the argument recursively for iK−2 , and for every individual in the cycle c, we
obtain that
ϕ(Pc0 , P−c , )(ik ) = sk ,
where Pc0 = {Pi0k }ik ∈c and Pi0k : sk+1 , sk , ....
To see this, note that at the last step of the recursive argument, we know that
ϕ(Pc0 , P−c , )(i1 ) = s1 .
This implies that
ϕ(Pc0 , P−c , )(iK ) ∈ {sK , ∅}.
Now since
T T C(Pc0 , P−c , )(iK )Ri0 K sK ,
we know that (iK , sK ) does not block T T C(Pc0 , P−c , ) and because ϕ has less justified envy
than TTC, it does not block ϕ(Pc0 , P−c , ). Since, by definition of TTC, for all j 6= i,
iK sK j,
we must have
ϕ(Pc0 , P−c , )(iK )Ri0 K sK .
Therefore,
ϕ(Pc0 , P−c , )(iK ) = sK .
Applying the argument recursively, we get that ϕ(Pc0 , P−c , )(ik ) = sk for all k. But this
contradicts Pareto-efficiency of ϕ because every individual in the cycle will be better off if every
ik is matched with sk+1 without changing the matching of individuals in I − c.
Therefore, we have established Claim 1: for all i ∈ I1 (P, ),
ϕ(P, )(i) = T T C(P, )(i).

Now, assume that
ϕ(P, )(i) = T T C(P, )(i)
for all i that is matched in the first m − 1 steps of T T C, i.e. i ∈

S
l=1,...,m−1

Claim 2. For all i ∈ Im (P, ),
ϕ(P, )(i) = T T C(P, )(i).
28

Il (P, ).

Proof. Suppose to the contrary that for some i ∈ Im (P, ),
ϕ(P, )(i) 6= T T C(P, )(i).
Let c = {sk , ik }k=1,...,K be the cycle in which i is matched with T T C(P, )(i) in step m of
T T C(P, ) and i = iK .
Note that every ik trades sk for sk+1 which is her first choice among remaining objects at
step m of T T C(P, ). Consider the alternative preference relation:
Pi0K : s1 , sK , ...
By construction, the T T C matching remains the same, i.e.
T T C(Pi0K , P−{iK } , ) = T T C(P, ).
Since s1 is iK ’s first choice among remaining objects at step m of T T C(P, ); that is,
ϕ(P, )(iK ) 6= T T C(P, )(iK ) = s1 .
By our inductive hypothesis, under ϕ(P, ), all schools s assigned before step m of T T C(P, )
have been assigned to
ϕ(P, )(s) = T T C(P, )(s).
That is, all schools assigned before step m are assigned to a student not in Im (P, ). Therefore,
iK does not receive any such schools s under ϕ(P, ), i.e.
ϕ(P, )(iK ) 6= s
for all schools s assigned before step m of T T C(P, ). This yields
s1 PiK ϕ(P, )(iK ).

(3)

Also, by construction of T T C, we know that
T T C(Pi0K , P−{iK } , )(iK )Ri0 K sK ,
so it must be the case that (iK , sK ) does not block T T C(Pi0K , P−{iK } , ). Since ϕ has less
justified envy than T T C at , (iK , sK ) does not block ϕ(Pi0K , P−{iK } , ).
In addition, by construction of T T C, we know that for all j that are not yet eliminated at
step m of T T C,
iK sK j.
Note that
ϕ(Pi0K , P−{iK } , )(sK )

29

is not eliminated at step m of T T C. To see this, note that if ϕ(Pi0K , P−{iK } , )(sK ) had been
eliminated in T T C before step m, we would have by the inductive hypothesis
ϕ(Pi0K , P−{iK } , )(sK ) = T T C(Pi0K , P−{iK } , )(sK ) = iK−1 ,
meaning that iK−1 would have been eliminated before step m in T T C(Pi0K , P−{iK } , ), a contradiction.
Thus, since ϕ(Pi0K , P−{iK } , )(sK ) is not eliminated at step m of T T C and iK sK j for all
j that are not eliminated yet at step m of T T C, we obtain that either
ϕ(Pi0K , P−{iK } , )(sK ) = iK
or
iK sK ϕ(Pi0K , P−{iK } , )(sK ).
Thus, because (iK , sK ) does not block ϕ(Pi0K , P−{iK } , ), in each of these cases, we must have
that
ϕ(Pi0K , P−{iK } , )(iK )Ri0 K sK ,
so that
ϕ(Pi0K , P−{iK } , )(iK ) ∈ {s1 , sK }.
By strategy-proofness of ϕ and (3), it must be that
ϕ(Pi0K , P−{iK } , )(iK ) = sK .
Then,
ϕ(Pi0K , P−{iK } , )(iK−1 ) 6= T T C(Pi0K , P−{iK } , )(iK−1 ) .
{z
}
|
=sK

As above, we repeat these arguments to arrive a contradiction with Pareto-efficiency of ϕ, which
completes the proof of the claim.

Claim 2 shows the inductive step. As a result, if ϕ has less justified envy than T T C at ,
then ϕ = T T C, completing the proof.

B

Proof of Proposition 2

The example below shows that TTC-Counters, TTC-Clinch and Trade, and Equitable-TTC do
not minimize justified envy in the class of Pareto efficient and strategy-proof mechanisms, when
schools have multiple seats.
Consider TTC-Counters (as will become clear, the argument is similar for TTC-Clinch and
Trade or Equitable-TTC). We build a Pareto efficient and strategy-proof mechanism ϕ that
allows for strictly less justified envy than TTC-Counters. Suppose ϕ selects the same matching
30

as TTC-Counters except for the following instance: there are four individuals i1 , i2 , i3 , and i4 and
three schools s1 , s2 , s3 , where qs1 = 1 and qs2 = qs3 = 3. In this instance, ϕ selects a matching
that is free of justified envy and Pareto efficient, which can be computed by student-proposing
DA.
Ergin (2002) characterizes priorities under which, for any individual preference, there exists
a matching that is Pareto efficient and justified envy-free. Priorities must be such that there is
no Ergin-cycle. A profile  has an Ergin-cycle if there are three individuals i1 , i2 , and i3 and
two schools s1 and s2 such that the two conditions are satisfied:
1. Loop condition. i1 s1 i2 s1 i3 and i3 s2 i1 ,
2. Scarcity condition. There are (possibly empty) disjoint sets Ns1 and Ns2 ⊆ I\{i1 , i2 , i3 }
s.t. Ns1 ⊆ Us1 (i2 ) and Ns2 ⊆ Us2 (i1 ) and |Ns1 | = qs1 − 1 and |Ns2 | = qs2 − 1 where Us1 (i2 ) and
Us2 (i1 ) are the strict upper contour set of i2 and i1 , respectively (i.e., Us1 (i2 ) := {` : ` s1 i2 }
and Us2 (i1 ) := {` : ` s2 i1 }).
In the instance described above, the scarcity condition in the definition of an Ergin-cycle can
never be satisfied. To see this, observe that for a school s ∈ {s2 , s3 },
|Ns | = 3 − 1 = 2,
while Ns ⊆ I\{i1 , i2 , i3 } implies that
|Ns | ≤ 1,
since |I| = 4. Therefore, sets satisfying the scarcity condition do not exist. Hence, any profile
of priority relations is Ergin-acyclic.
Finally, it is enough for our purpose to build some (P, ) where the set of blocking pairs of
ϕ is a proper subset of the set of blocking pairs of TTC-Counters. Since ϕ eliminates justified
envy, we only need to show that there is (P, ) under which TTC-Counters does not eliminate
justified envy.
Consider the following profile of preferences and priority relations:
P i1

P i2

P i3

Pi4

s1

s2

s3

s3

s1

s1

s2

i1

i1

i3

i4

i3

i4

i2

i2

i2

i3

i4

i1

s3

TTC-Counters produces:
i1 i2 i3 i4
s3 s3 s1 s2

!
,

where (i2 , s1 ) is a blocking pair.
This completes the argument for TTC-Counters. It is easy to check that TTC-Counters,
TTC-Clinch and Trade, and Equitable TTC coincide to produce the same assignment for the
31

above profile of preferences and priority relations. Hence, the same argument can be used for
TTC-Clinch and Trade and Equitable TTC.

C

Another justified envy-minimal mechanism

When each school has a single seat, we build a mechanism different from TTC that is strategyproof, Pareto-efficient, and justified envy-minimal. The mechanism is identical to TTC except
at the following instance of priorities: we have three students i1 , i2 and i3 and two schools s1
and s2 each with a single seat. Priorities are given by
s1

s2

i2

i1

i3

i3

i1

i2

.

In essence, the mechanism will rank i3 on top of each school’s ranking and run standard
TTC on these modified priorities (except for some preference profiles where there is a unique
efficient and stable allocation where the original priorities will still be used to run TTC). This
mechanism will be denoted TTC∗ . Let us describe it precisely. For the instance of priorities
described above and for each profile of preferences P , TTC∗ selects a matching as follows.
Case A.
If under P there is an individual who ranks all schools as unacceptable then run TTC.
Case B.1.
If under P both i1 and i2 rank s1 first and i1 finds s2 unacceptable then run TTC
Case B.2.
If under P both i1 and i2 rank s2 first and i2 finds s1 unacceptable then run TTC
Case C.
If none of the above cases apply, move i3 to the top of each school’s ranking. Run TTC on the
modified priorities.
Clearly, TTC∗ is Pareto efficient. We prove below that it is strategy-proof.
Proposition 4. TTC∗ is strategy-proof.
Proof. Fix P falling into case A. If some student i deviates to Pi0 , this cannot be profitable if
we remain into case A or fall into Case B.1 or B.2 (since TTC is strategy-proof). Therefore,
consider the case where we fall into Case C after i’s deviation. After the deviation, all individuals
rank at least one school acceptable (since we are not in Case A anymore). Since at least one
individual must rank all schools unacceptable before the deviation and since we are looking at
32

a single deviation by individual i, we conclude that Pi ranks all schools unacceptable. Hence,
under TTC∗ , i is unmatched under P and since Pi ranks all schools unacceptable, there cannot
be any profitable deviation.
Fix P falling into case B.1 (and not in case A). If some student i deviates to Pi0 , this cannot
be profitable if we remain into case B.1 or fall into Case A or B.2 (since TTC is strategy-proof).
Therefore, consider the case where we fall into Case C after i’s deviation. This must mean that
before deviation both i1 and i2 rank s1 first and i1 finds s2 unacceptable, though this is not the
case anymore after deviation. Note that this must mean that i is either i1 or i2 . Further, since P
falls into Case B.1, TTC∗ runs standard TTC. Hence, i2 gets matched to her top choice s1 and
so i2 has no incentive to deviate (recall that each individual finds at least one school acceptable
since we are not in Case A). Hence, let us consider i = i1 . The only way to reach (by a deviation
of i1 ) Case C is for i1 to claim that s2 is acceptable (while s2 is not acceptable to i1 under
the original preferences Pi ). Now, to complete the argument, we distinguish two cases. First,
assume that i3 ranks s2 first. Then, since we fall into Case C after deviation, TTC∗ (Pi0 , P−i ) is
given by
!
i1 i2 i3
.
i1 s1 s2
In particular, i1 cannot get s1 (the only acceptable school under Pi ) so the deviation to Pi0
cannot be profitable. Similarly, in the other case where i3 ranks s1 first, TTC∗ (Pi0 , P−i ) is given
by
!
i1 i2 i3
.
s2 i2 s1
Here again, i1 fails to obtain s1 and so the deviation is not profitable. The case under which P
falls into Case B.2 can be treated in the same way.
Fix P falling into case C. If some student i deviates to Pi0 , this cannot be profitable if we
remain into case C (since TTC is strategy-proof). Therefore, consider the case where we fall
into Case A. This must mean that Pi0 ranks all schools unacceptable. Since TTC∗ is individually
rational, i’s deviation cannot be profitable. So consider the case where after deviation we fall
into Case B.1 (and not into Case A). This must mean that before deviation, either i1 or i2 does
not rank s1 first, or i1 finds s2 acceptable while after deviation both i1 and i2 rank s1 first
and i1 finds s2 unacceptable. This must mean that i is either i1 or i2 . If i = i1 , this means
that, i2 ranks s1 first (recall that before and after deviation, each individual has at least one
acceptable school since we do not fall into Case A before and after deviation). So, in particular,
after deviation, i1 cannot get s1 (s1 will be allocated to i2 ). Since after deviation, i1 finds s2
unacceptable, i1 will not get s2 either, and so she will remain unmatched. So the deviation
cannot be profitable to i1 .
Now, consider the other case where deviator i = i2 . This means that i1 ranks s1 first and
ranks s2 unacceptable. This also means that before deviation, i2 ranks s2 first while after
deviation i2 ranks s1 first. To complete the proof, we distinguish two cases. First, assume
33

that i3 ranks s2 first. Then, at P , i2 gets s1 if she finds s1 acceptable or remains unmatched.
After deviation, i2 ranks s1 on top and i2 must be getting s1 after deviation, so this cannot be
profitable. In the other case where i3 ranks s1 first, before deviation, i2 is getting s2 , which
is her top choice. So the deviation cannot improve on this. The same reasoning holds if the
deviation falls into Case B.2.
We fix any Pareto efficient and strategy-proof mechanism ϕ with less justified envy than
TTC∗ . We claim that ϕ = TTC∗ .
Proposition 5. Fix any P that falls into Case A, B.1 or B.2. ϕ(P ) = TTC∗ (P ).
Proof. Fix any P falling into Case A. Some individual must rank all schools as unacceptable.
It is easy to check that, in such a case, there is a unique efficient and stable allocation that is
selected by TTC (with only two students, priorities are trivially Ergin-acyclic). Hence, because
ϕ has less justified envy than TTC∗ , ϕ must also select the unique efficient and stable allocation,
and we obtain ϕ(P ) = TTC∗ (P ).
Now, fix any P falling into Case B.1. Both i1 and i2 rank s1 first, and i1 finds s2 unacceptable.
Here again, one can check that TTC selects the unique efficient and stable allocation, and we
obtain ϕ(P ) = TTC∗ (P ). A similar reasoning holds for any P falling into Case B.2.
Proposition 6. Fix any P that falls into Case C. ϕ(P ) = TTC∗ (P ).
Proof. We assume that P falls into Case C and prove the above proposition in the four following
claims.
Claim 1. Assume that s1 Pi1 s2 and s2 Pi2 s1 .
ϕ(P ) = T T C ∗ (P ).
Proof. Clearly, under TTC∗ , i3 is never part of any blocking pair. Hence, because ϕ has less
justified envy than TTC∗ , we must have that i3 is never part of any blocking pair under ϕ
as well. Assume wlog that s1 is i3 ’s top choice (recall that because P falls into Case C, each
individual finds at least one school acceptable).
In the sequel, we claim that i3 is assigned its top choice s1 under matching ϕ(P ). If i3 is not
assigned its top choice s1 under ϕ, then in order to ensure that (i3 , s1 ) does not block ϕ(P ), we
must have that i2 is matched to s1 under ϕ(P ). Now, consider two cases. First, i3 is matched
to s2 under ϕ(P ). In that case, i2 and i3 would be better off switching their assignments, a
contradiction with Pareto efficiency of ϕ. In the other case, i3 must be unmatched under ϕ(P ).
If i1 gets matched to s2 under ϕ(P ), allowing i2 and i1 to switch their assignments would be
beneficial to both of them, again a contradiction with Pareto efficiency of ϕ. If i1 is not matched
to s2 under ϕ(P ) then s2 is unmatched, and by assigning it to i2 we Pareto-improve on ϕ(P ),
a contradiction.
34

Thus, we proved that ϕ(P )(i3 ) = s1 = TTC∗ (P )(i3 ). Now, let us complete the argument
and show that ϕ(P ) = TTC∗ (P ). First, consider the case where i1 finds s2 acceptable. TTC∗
yields the following matching
!
i1 i2 i3
.
s2 i2 s1
If under ϕ(P ), i1 remains unmatched, then (i1 , s2 ) would block ϕ(P ) while it does not block
TTC∗ (P ), a contradiction with our assumption that ϕ has less justified envy than TTC∗ . Thus,
ϕ(P )(i1 ) = s2 = TTC∗ (P )(i1 ) and so we conclude that ϕ(P ) = TTC∗ (P ). Now, consider the
second case where i1 finds s2 unacceptable. Recall that s2 must be acceptable to i2 , and so
TTC∗ yields the following matching
!
i1 i2 i3
.
i1 s2 s1
Clearly, since we showed that i3 gets matched to s1 under ϕ(P ), i1 remains unmatched under
ϕ(P ). So by Pareto efficiency of ϕ, it must be that ϕ(P )(i2 ) = s2 = TTC∗ (P )(i2 ). We conclude
that ϕ(P ) = TTC∗ (P ).

Claim 2. Assume that s1 Pi1 s2 and s1 Pi2 s2 .
ϕ(P ) = T T C ∗ (P ).
Proof. There are two cases.
Case 1. s1 Pi3 s2 . Because P falls into Case C, each individual ranks at least one school
acceptable (since P does not fall into Case A) and i1 finds s2 acceptable (since P does not fall
into Case B.1). Thus, TTC∗ yields the following matching
!
i1 i2 i3
.
s2 i2 s1
We first claim that under ϕ(P ), i2 must remain unmatched. Indeed, if i2 is matched under
ϕ(P ), then consider the new preference profile where s2 Pi02 s1 Pi02 i2 . Note that (Pi02 , P−{i2 } ) falls
into the cases considered in Claim 1. Hence, by Claim 1, we know that ϕ(Pi02 , P−{i2 } )(i3 ) =
TTC∗ (Pi02 , P−{i2 } )(i3 ) = s1 and ϕ(Pi02 , P−{i2 } )(i2 ) = TTC∗ (Pi02 , P−{i2 } )(i2 ) = i2 . Thus, from
profile (Pi02 , P−{i2 } ), i2 can misreport her preference profile as Pi2 . In turn, she gets matched
and is strictly better-off, which contradicts the strategy-proofness of ϕ. Hence, under ϕ(P ),
i2 must be unmatched. Next, we claim that i3 is assigned s1 under ϕ(P ). Indeed, if i3 is
not assigned s1 under ϕ(P ), then i1 must be assigned s1 since it is acceptable to her (and we
already know that i2 must be unmatched). But then (i3 , s1 ) would block ϕ(P ) but does not
block TTC∗ (P ), which contradicts our assumption that ϕ has less justified envy than TTC∗ .
To conclude, under ϕ(P ), i3 gets s1 , i2 is unmatched, and so, since s2 is acceptable to i1 , i1 gets
matched to s2 . Thus, ϕ(P ) = TTC∗ (P ).
35

Case 2. s2 Pi3 s1 . TTC∗ yields the following matching
!
i1 i2 i3
.
i1 s1 s2
We first claim that ϕ(P ) matches i3 to her top choice s2 . Indeed, if i3 is not matched to s2
under ϕ(P ) then in order for (i3 , s2 ) not to block ϕ(P ), i1 must match to s2 . But then, in order
for (i2 , s1 ) not to block ϕ(P ), which is necessary since it does not block TTC∗ (P ), i2 must also
match s1 . So if i3 is not matched to s2 under ϕ(P ) the only candidate for ϕ(P ) is
!
i1 i2 i3
.
s2 s1 i3
Now, let us assume that i3 ranks s1 acceptable under Pi3 . Next, consider the preference
profile (Pi03 , P−{i3 } ) where s1 Pi03 s2 Pi03 i3 . Note that (Pi03 , P−{i3 } ) falls into Case 1 considered just
above. Hence, we know that ϕ(Pi03 , P−{i3 } ) = TTC∗ (Pi03 , P−{i3 } ) and so i3 is matched to s1
under ϕ(Pi03 , P−{i3 } ). Since i3 is unmatched under ϕ(P ), because we assumed that i3 ranks s1
acceptable under Pi3 , we found a profitable deviation for i3 , a contradiction with the strategyproofness of ϕ. Thus, provided that Pi3 ranks s1 as acceptable, we obtained ϕ(Pi3 , P−{i3 } )(i3 ) =
TTC∗ (Pi3 , P−{i3 } )(i3 ) = s2 .
Let us now assume that i3 ranks s1 unacceptable under Pi3 . Consider a deviation of i3 to
0
Pi3 satisfying s2 Pi03 s1 Pi03 i3 , i.e., where s1 is ranked as acceptable. We just saw that, in such
a case, ϕ(Pi03 , P−{i3 } )(i3 ) = TTC∗ (Pi03 , P−{i3 } )(i3 ) = s2 and so i3 gets matched to s2 under
ϕ(Pi03 , P−{i3 } ). Here again, we find a profitable deviation for i3 , which contradicts the strategyproofness of ϕ.
We conclude that ϕ(P ) matches i3 to her top choice s2 . Now, TTC∗ (P ) matches i2 with s1 ,
and, in order not have the blocking pair (i2 , s1 ) under ϕ(P ), i2 and s1 must also be matched
together under ϕ(P ). We conclude that ϕ(P ) = TTC∗ (P ).

Claim 3. Assume that s2 Pi1 s1 and s2 Pi2 s1 .
ϕ(P ) = T T C ∗ (P ).
Proof. The proof is similar to that of Claim 2.



Claim 4. Assume that s2 Pi1 s1 and s1 Pi2 s2 .
ϕ(P ) = T T C ∗ (P ).
Proof. Without loss of generality, assume that s2 Pi3 s1 (the same argument applies when s1 Pi3 s2 ).
TTC∗ yields the following matching
!
i1 i2 i3
.
i1 s1 s2
36

If, under ϕ(P ), i3 is not matched to her top choice s2 , then in order for (i3 , s2 ) not to block ϕ(P )
(which is necessary, since it does not block TTC∗ (P )), i1 must be matched to s2 under ϕ(P ).
But then for (i2 , s1 ) not to block ϕ(P ) (which is necessary since it does not block TTC∗ (P )), i2
must be matched to s1 . Thus, if i3 is not matched to her top choice s2 , the only candidate for
ϕ(P ) is
!
i1 i2 i3
.
s2 s1 i3
Now, consider Pi01 such that s1 Pi01 s2 Pi01 i1 . Since i1 ranks s2 acceptable under Pi01 , (Pi01 , P−{i1 } )
falls in to the profile of preferences considered in Claim 2. Hence, ϕ(Pi01 , P−{i1 } ) and TTC∗ (Pi01 , P−{i1 } )
both yield the same matching given by
!
i1 i2 i3
.
i1 s1 s2
Now, if the true preference profile is (Pi01 , P−{i1 } ) and i1 misreports to Pi1 , then i1 gets matched
to s2 under ϕ(Pi1 , P−{i1 } ). Hence, the misreport Pi1 is profitable to i1 , which contradicts the
strategy-proofness of ϕ.
We conclude that under ϕ(P ), i3 must be matched to her top choice s2 . But now, if i2 is
not matched to s1 under ϕ(P ) then (i2 , s1 ) blocks ϕ(P ) but does not block TTC∗ (P ), which is
a contradiction. Hence, i2 must be matched to s1 , and we conclude that ϕ(P ) = TTC∗ (P ). 
These four claims together establish the proposition.

37

References
Abdulkadiroglu, Atila and Yeon-Koo Che, “The Role of Priorities in Assigning Indivisible
Objects: A Characterization of Top Trading Cycles,” 2010. Working Paper, Columbia
University.
, Parag Pathak, and Christopher Walters, “Free to Choose: Can School Choice
Reduce Student Achievement?,” 2016. Forthcoming, American Economic Journal: Applied
Economics.
Abdulkadiroğlu, Atila and Tayfun Sönmez, “Random Serial Dictatorship and the Core
from Random Endowments in House Allocation Problems,” Econometrica, 1998, 66(3),
689–701.
and
, “School Choice: A Mechanism Design Approach,” American Economic Review,
2003, 93, 729–747.
, Parag A. Pathak, Alvin E. Roth, and Tayfun Sönmez, “The Boston Public School
Match,” American Economic Review, Papers and Proceedings, 2005, 95, 368–371.
,
, and
, “The New York City High School Match,” American Economic Review,
Papers and Proceedings, 2005, 95, 364–367.
,
, and
, “Strategy-proofness versus Efficiency in Matching with Indifferences:
Redesigning the New York City High School Match,” American Economic Review, 2009,
99(5), 1954–1978.
Alcalde, José and Salvador Barberá, “Top dominance and the possibility of strategy-proof
stable solutions to matching problems,” Economic Theory, 1994, 4, 417–435.
Anderson, Ross, Itai Ashlagi, David Gamarnik, and Alvin E. Roth, “Finding long
chains in kidney exchange using the traveling salesmen problem,” Proceedings of the National Academy of Sciences of the United States of America, 2015, 112(3), 663–668.
Andersson, Tommy, Lars Ehlers, and Lars-Gunnar Svensson, “Budget-Balance, Fairness and Minimal Manipulability,” Theoretical Economics, 2014, 9, 753–777.
Arribillaga, R. Pablo and Jordi Massó, “Comparing generalized median voter schemes
according to their manipulability,” Theoretical Economics, 2016, pp. 547–586.
and
, “Comparing Voting by Committees According to their Manipulability,” 2016.
, American Economic Journal: Microeconomics.
Bade, Sophie, “Random Serial Dictatorship: The One and Only,” Working Paper, Department
of Economics, Royal Holloway College, 2016.
38

Balinski, Michel and Tayfun Sönmez, “A Tale of Two Mechanisms: Student Placement,”
Journal of Economic Theory, 1999, 84, 73–94.
BPS, “Recommendation to Implement a New BPS Assignment Algorithm,” 2005. Presentation
to the Boston School Committee by Carleton Jones, May 11.
, “Introducing the Boston Public Schools 2012,” 2012. Boston Public Schools, Available
at: http://www.bostonpublicschools.org/register.
Calsamiglia, C., Guillaume Haeringer, and Flip Kljin, “Constrained School Choice: An
Experimental Study,” American Economic Review, 2010, 100, 1860–1874.
Che, Yeon-Koo and Olivier Tercieux, “An Analysis of Top Trading Cycles in Two-Sided
Matching Markets,” 2016. Columbia University and PSE, Unpublished mimeo.
and
, “Efficiency and Stability in Large Matching Markets,” 2016. Columbia University and PSE, Unpublished mimeo.
and
, “Payoff Equivalence of Efficient Mechanisms in Large Markets,” 2017. Columbia
University and PSE, Unpublished mimeo.
Chen, Yan and Onur Kesten, “Chinese College Admissions and School Choice Reforms: A
Theoretical Analysis,” 2016. Forthcoming, Journal of Political Economy.
Dubins, Lester E. and David A. Freedman, “Machiavelli and the Gale-Shapley algorithm,”
American Mathematical Monthly, 1981, 88, 485–494.
Dur, Umut, “A Characterization of the Top Trading Cycles Mechanism for the School Choice
Problem,” 2013. Working paper, NC State.
, Scott Kominers, Parag Pathak, and Tayfun Sönmez, “Reserve Design: Unintended
Consequences and The Demise of Walk Zones in Boston,” 2016. Working paper, MIT.
Ergin, Haluk, “Efficient Resource Allocation on the Basis of Priorities,” Econometrica, 2002,
70, 2489–2498.
Gale, David and Lloyd S. Shapley, “College Admissions and the Stability of Marriage,”
American Mathematical Monthly, 1962, 69, 9–15.
Haeringer, Guillaume and Flip Klijn, “Constrained School Choice,” Journal of Economic
Theory, 2009, 144, 1921–1947.
Hakimov, Rustamdjan and Onur Kesten, “The Equitable Top Trading Cycles Mechanism
for School Choice,” 2014. WZB Discussion Paper 2014-210.

39

Harris, Douglas, Jon Valant, and Betheny Gross, “The New Orleans OneApp,” Education
Next, 2015, 15(4).
Kesten, Onur, “On two competing mechanisms for priority-based allocation problems,” Journal of Economic Theory, 2006, 127, 155–171.
, “School Choice with Consent,” Quarterly Journal of Economics, 2010, 125(3), 1297–1348.
Kojima, Fuhito and Mihai Manea, “Axioms for Deferred Acceptance,” Econometrica, 2010,
78, 633–653.
Landsmark, Ted, Helen Dajer, and Lisa Gonsalves, “Report and Recommendations of
the Boston Public Schools Student Assignment Task Force,” 2014. Report to the Boston
School Committee, September 22.
Leshno, Jacob and Irene Lo, “The Simple Structure of Top Trading Cycles in School Choice:
A Continuum Model,” 2017. Columbia Univeresity.
Ma, Jinpeng, “Strategy-Proofness and the Strict Core in a Market with Indivisibilities,” International Journal of Game Theory, 1994, 23, 75–83.
Maskin,
Eric,
“Elections and Strategic Voting:
Condorcet and Borda,”
2016.
NBER Conference on Mathematical Economics,
Johns Hopkins,
http://www.econ2.jhu.edu/conferences/mathecon2016/papers/Maskin.pdf.
Morrill, Thayer, “Making Just School Assignments,” Games and Economic Behavior, 2015,
92, 18–27.
, “Two Simple Variations of Top Trading Cycles,” Economic Theory, 2015, pp. 123–140.
Pápai, Szilazi, “Strategyproof Assignment by Hierarchical Exchange,” Econometrica, 2000,
68, 1403–1433.
Pathak, Parag A., “The Mechanism Design Approach to Student Assignment,” Annual Reviews, 2011, 3, 513–536.
, “What Really Matters in Designing School Choice Mechanisms,” 2016. Advances in
Economics and Econometrics, 11th World Congress of the Econometric Society, eds. Larry
Samuelson.
and Tayfun Sönmez, “Leveling the Playing Field: Sincere and Sophisticated Players in
the Boston Mechanism,” American Economic Review, 2008, 98(4), 1636–1652.
and
, “School Admissions Reform in Chicago and England: Comparing Mechanisms
by their Vulnerability to Manipulation,” American Economic Review, 2013, 103(1), 80–106.

40

Pycia, Marek and Utku Ünver, “Trading Cycles for School Choice,” 2011. Working paper.
and
, “Incentive Compatible Allocation and Exchange of Discrete Resources,” 2016.
Forthcoming, Theoretical Economics.
Roth, Alvin E., “The Economics of Matching: Stability and Incentives,” Mathematics of
Operations Research, 1982, 7, 617–628.
, “Incentive Compatibility in a Market with Indivisible Goods,” Economics Letters, 1982,
9(2), 127–132.
, “The College Admission Problem is not Equivalent to the Marriage Problem,” Journal of
Economic Theory, 1985, 36, 277–288.
and Andrew Postlewaite, “Weak Versus Strong Domination in a Market with Indivisible
Goods,” Journal of Mathematical Economics, 1977, 4, 131–139.
and Elliott Peranson, “The Redesign of the Matching Market for American Physicians:
Some Engineering Aspects of Economic Design,” American Economic Review, 1999, 89,
748–780.
, Tayfun Sönmez, and Utku Ünver, “Kidney Exchange,” Quarterly Journal of Economics, 2004, 119, 457–488.
RSD, “Overview of the New Public School Enrollment Process,” 2012. Recovery School District
Presentation to Public.
Shapley, Lloyd and Herbert Scarf, “On Cores and Indivisibility,” Journal of Mathematical
Economics, 1974, 1, 23–28.
Svensson, Lars-Gunnar, “Strategy-proof Allocation of Indivisible Goods,” Social Choice and
Welfare, 1999, 16.
Vanacore, Andrew, “Recovery School District chief plans central enrollment system, technical
training, more,” 2011. September 6, New Orleans Times-Picayune.
, “Centralized enrollment in Recovery School District gets first tryout,” 2012. April 16,
New Orleans Times-Picayune.

41

