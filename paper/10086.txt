NBER WORKING PAPER SERIES

DOES THE FAILURE OF THE EXPECTATIONS HYPOTHESIS
MATTER FOR LONG-TERM INVESTORS?
Antonios Sangvinatsos
Jessica A. Wachter
Working Paper 10086
http://www.nber.org/papers/w10086
NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
November 2003

The authors are grateful for helpful comments from Utpal Bhattacharya, Michael Brennan, John Campbell,
Jennifer Carpenter, Qiang Dai, Ned Elton, Blake LeBaron, Anthony Lynch, Lasse Pedersen, Matthew
Richardson, Luis Viceira, an anonymous referee, and seminar participants at Brandeis University, the
Norwegian School of Economics and Business, the Norwegian School of Management, University of
California at Los Angeles, University of Indiana at Bloomington, the Spring 2003 NBER Asset Pricing
meeting and the 2003 CIRANO Conference on Portfolio Choice. The views expressed herein are those of the
authors and not necessarily those of the National Bureau of Economic Research.
©2003 by Antonios Sangvinatsos and Jessica A. Wachter. All rights reserved. Short sections of text, not to
exceed two paragraphs, may be quoted without explicit permission provided that full credit, including ©
notice, is given to the source.

Does the Failure of the Expectations Hypothesis Matter for Long-Tern Investors?
Antonios Sangvinatsos and Jessica A. Wachter
NBER Working Paper No. 10086
November 2003
JEL No. G1
ABSTRACT
We consider the consumption and portfolio choice problem of a long-run investor when the term
structure is affine and when the investor has access to nominal bonds and a stock portfolio. In the
presence of unhedgeable inflation risk, there exist multiple pricing kernels that produce the same
bond prices, but a unique pricing kernel equal to the marginal utility of the investor. We apply our
method to a three-factor Gaussian model with a time-varying price of risk that captures the failure
of the expectations hypothesis seen in the data. We extend this model to account for time-varying
expected inflation, and estimate the model with both inflation and term structure data. The estimates
imply that the bond portfolio for the long-run investor looks very different from the portfolio of a
mean-variance optimizer. In particular, the desire to hedge changes in term premia generates large
hedging demands for long-term bonds.

Antonios Sangvinatsos
Stern School of Business
New York University
44 West Fourth Streeet
Suite 9-190
New York, NY 10012-1126
asangvin@stern.nyu.edu
Jessica A. Wachter
Stern School of Business
New York University
44 West Fourth Streeet
Suite 9-190
New York, NY 10012-1126
and NBER
jwachter@stern.nyu.edu

1

Introduction

The expectations hypothesis of interest rates states that the premium on long-term bonds over
short-term bonds is constant over time. According to this hypothesis, there are no particularly
good times to invest in long-term bonds relative to short-term bonds, nor are there particularly
bad times. Long-term bonds will always offer the same expected excess return. 1
While the expectations hypothesis is theoretically appealing, it has consistently failed in U.S.
postwar data. Fama and Bliss (1987) and Campbell and Shiller (1991), among others, show that
expected excess returns on long-term bonds (term premia) do vary over time, and moreover, it
is possible to predict excess returns on bonds using observables such as the forward rate or the
term spread. This paper explores the consequences of the failure of the expectations hypothesis for
long-term investors.
We estimate a three-factor affine term structure model similar to that proposed in Dai and Singleton (2002a) and Duffee (2002) that accounts for the fact that excess bond returns are predictable.
We then solve for the optimal portfolio for an investor taking this term structure as given. Bond
market predictability will clearly affect the mean-variance efficient portfolio, but the consequences
for long-horizon investors go beyond this. Merton (1971) shows that when investment opportunities are time-varying, a mean-variance efficient portfolio is generally sub-optimal. Long-horizon
investors wish to hedge changes in the investment opportunity set; depending on the level of risk
aversion, the investor may want more or less wealth when investment opportunities deteriorate than
when they improve. As we will show, investors gain by hedging time-variation in the term premia.
Thus the investor’s bond portfolio looks different from that dictated by mean-variance efficiency.
Despite the obvious importance of bonds to investors, as well as the strength of the empirical
findings mentioned above, recent literature on portfolio choice has focused almost exclusively on
predictability in stock returns. As shown by Fama and French (1989) and Campbell and Shiller
(1988), the price-dividend ratio predicts excess stock returns with a negative sign. Based on this
finding, a number of studies (e.g. Balduzzi and Lynch (1999), Barberis (2000), Brandt (1999),
Brennan, Schwartz, and Lagnado (1997), Campbell and Viceira (1999), Liu (1999) and Wachter
1

The expectations hypothesis, as we refer to it, should be distinguished from the pure expectations hypothesis
which states that term premia are not just constant but equal to zero. Cox, Ingersoll, and Ross (1981) examine
variants of the pure expectations hypothesis in the context of continuous-time equilibrium theory, and find that they
are inconsistent with each other, and that several imply arbitrage opportunities (see however Longstaff (2000a)).
Campbell (1986) shows that these inconsistencies do not occur with the more general expectations hypothesis, which
does not require term premia to be zero. In fact, it is the expectations hypothesis, as opposed to the pure expectations
hypothesis, which is typically examined in the empirical literature (see Bekaert and Hodrick (2001) for a discussion
of recent empirical work testing the expectations hypothesis).

1

(2002a)) document gains from timing the stock market based on the price-dividend ratio, and from
hedging time-variation in expected stock returns. One result of this literature is that when investors
have relative risk aversion greater than one, hedging demands dictate that their allocation to stock
should increase with the horizon. A natural question to ask is whether the same mechanism is
at work for bond returns. Just as stock prices are negatively correlated with increases in future
risk premia on stocks, bond prices are negatively correlated with increases in future risk premia on
bonds.2 This intuition suggests that time-variation in risk premia would cause the optimal portfolio
allocation to long-term bonds to increase with horizon.
In the case where the investor allocates wealth between a long and a short-term bond, we show
that this intuition holds. Hedging demands induced by time-variation in risk premia more than
double the investor’s allocation to the long-term bond. Moreover, we find large horizon effects. The
investor with a horizon of twenty years holds a much greater percentage of his wealth in long-term
bonds than an investor with a horizon of ten years. In the case of multiple long-term bonds, the
mean-variance efficient portfolio often consists of a long and short position in long-term bonds. This
occurs because of the high positive correlation between bonds of different maturities implied by
the model and found in the data. Hedging demands induced by time-varying risk premia generally
make the allocation to long-term bonds more extreme. We find that following a myopic strategy
and, in particular, failing to hedge time variation in risk premia carries a high utility cost for the
investor.
Our framework generalizes previous studies of portfolio choice when real interest rates vary over
time and there is inflation. Brennan and Xia (2002) and Campbell and Viceira (2001) estimate a
two-factor Vasicek (1977) term structure model and determine optimal bond portfolios. Both of
these studies assume that risk premia on bonds and stocks are constant.3 Our study also relates to
that of Campbell, Chan, and Viceira (2002) who estimate a vector-autoregression (VAR) including
the returns on a long-term bond, a stock index, the dividend yield and the yield spread. Campbell
et al. derive an approximate solution to the optimal portfolio choice problem when asset returns
are described by the VAR. The advantage of the VAR approach is that it captures predictability in
2

We consider U.S. government bonds that are not subject to default risk. Nonetheless, we use risk premia and
term premia interchangeably, as we do not take a stand on the source of the premia.
3
Other work on bond returns and portfolio choice includes Brennan and Xia (2000) and Sorensen (1999), who
assume that interest rates are Vasicek, and Liu (1999) and Schroder and Skiadas (1999) who assumes general affine
dynamics. These studies assume that bonds are indexed, or equivalently, that there is no inflation. Xia (2002)
examines the welfare consequences of limited access to nominal bonds under a Vasicek model. Wachter (2002b)
shows under general conditions that as risk aversion approaches infinity, the investor’s allocation approaches 100%
in a long-term indexed bond. None of these papers explore the consequences of bond return predictability.

2

bond and stock returns in a relatively simple way. The disadvantage is that the term structure is not
well-defined; it is necessary to assume that the investor only has access to those bonds included in
the VAR. Moreover, estimating bond returns using a VAR gives up the extra information resulting
from the no-arbitrage restriction on bonds, namely that bonds have to pay their (nominal) face
value when they mature.
Rather than modeling bond return predictability using a VAR, we follow the affine bond pricing
literature (e.g. Dai and Singleton (2000, 2002a) and Duffee (2002)) and specify a nominal pricing
kernel.4 The drift and diffusion of the pricing kernel is driven by three underlying factors which
follow a multivariate Ornstein-Uhlenbeck process. The price of risk is a linear function of the state
variables. Thus the model is in the “essentially affine” class proposed by Duffee (2002), and shown
by Dai and Singleton (2002a) to capture the pattern of bond predictability in the data.
As a necessary step to showing the implications of affine term structure models for investors,
we show how parameters of the inflation process can be jointly estimated with term structure
parameters. This joint estimation produces a series for expected inflation that explains 37% of the
variance of realized inflation. This result has implications not only for portfolio choice problems,
but for the estimation of term structure models more generally.
The remainder of the paper is organized as follows. Section 2 describes the general form of an
economy where nominal bond prices are affine, and there exists equity and unhedgeable inflation.
Section 3 derives a closed-form solution for optimal portfolio choice when the investor has utility
over terminal wealth and over intermediate consumption. When inflation is introduced, the pricing
kernel that determines asset prices is not unique; from the point of view of the investor it is not
well-defined. As He and Pearson (1991) show, there is a unique pricing kernel that gives the
marginal utility process for the investor.5 We derive a closed-form expression for this pricing kernel
when incompleteness results from inflation. This expression holds regardless of the form of the
term structure. Section 4 uses maximum likelihood to estimate the parameters of the process, and
demonstrates that the model provides a good fit to term structure data and to inflation. Section 5
discusses the properties of the optimal portfolio for the parameters we have estimated and calculates
utility costs resulting from sub-optimal strategies.
4

For recent surveys of this literature, see Dai and Singleton (2002b) and Piazzesi (2002).
Liu and Pan (2002) also associate the pricing kernel in the economy with the pricing kernel for the investor. In
Liu and Pan’s model markets are complete, so a unique pricing kernel exists.
5

3

2

The Economy

As in the affine term structure literature, we specify an exogenous nominal pricing kernel. Because
our purpose is modeling predictability in excess bond returns and, as Dai and Singleton (2002a)
and Duffee (2002) show, a Gaussian model is best suited for this purpose, we will assume that all
variables are homoscedastic.6
Let dz denote a d×1 vector of independent Brownian motions. Let r(t) denote the instantaneous
nominal riskfree rate. We assume that
r(X(t), t) = δ0 + δX(t),

(1)

where X(t) is an m × 1 vector of state variables that follow the process
dX(t) = K(θ − X(t)) dt + σX dz(t),

(2)

under the physical measure. The matrix of loadings on the Brownian motions, σ X , is m × d, K is
m × m, and θ is m × 1. Suppose there exists a price of risk Λ̄(t) that is linear in X(t):
Λ̄(t) = λ̄1 + λ̄2 X(t),

(3)

where λ̄1 is d × 1 and λ̄2 is d × m. When λ̄2 = 0d×m , the price of risk is constant and the model
is a multifactor version of Vasicek (1977). Given a process for the interest rate r and the price of
risk Λ̄, the pricing kernel is given by:
dφ̄(t)
= −r(t) dt − Λ̄(t)> dz.
φ̄(t)

(4)

The pricing kernel determines the price of an asset based on its nominal payoff.
In this economy, bond yields are affine in the state variables X(t). Let P (X(t), t, s) denote the
price of such a bond maturing at s > t. Then P equals the present discounted value of the bond
payoff, namely $1:
£
¤
P (X(t), t, s) = φ̄(t)−1 Et φ̄(s)

As shown by Duffie and Kan (1996) nominal bond prices take the form:
P (X(t), t, s) = exp {A2 (s − t)X(t) + A1 (s − t)} ,
6

(5)

Fisher (1998) shows that a two-factor Gaussian model can partially replicate the failure of the expectations
hypothesis, but does not make comparisons across models. Bansal and Zhou (2002) show that a regime-switching is
also successful at capturing the failure of the expectations hypothesis in the data. Ahn, Dittmar, and Gallant (2002)
discuss an affine-quadratic class of models which, as Brandt and Chapman (2002) show, is also capable of accounting
for the failure of the expectations hypothesis. Extensions of the results in this paper to quadratic models and models
with regime shifts will be considered in future work.

4

where A2 (τ ) and A1 (τ ) solve a system of ordinary differential equations given in Appendix A. Bond
yields are given by
1
log P (X(t), t, s)
s−t
1
(A2 (s − t)X(t) + A1 (s − t))
= −
s−t

y(X(t), t, s) = −

(6)

The dynamics of bond prices follow from Ito’s lemma:
½
¾
dP (t)
1
>
>
0
0
= −A2 (τ )X(t) − A1 (τ ) + A2 (τ )K(θ − X(t)) + A2 (τ )σX σX A2 (τ )
dt
P (t)
2
+ A2 (τ )σX dz. (7)
The expression for the drift of bond prices can be simplified by applying the expressions for A 2 and
A1 given in Appendix A:
dP (t)
= (A2 (τ )σX Λ̄(t) + r(t)) dt + A2 (τ )σX dz.
P (t)
Equation (7) shows that bond prices vary with the state variables X(t). The correlation between
bond prices and state variables depends on the maturity of the bond through the function A 2 (τ ).
With slight abuse of notation, we let P (t) denote a vector of m bond prices, with A 2 the m × m
matrix with rows equal to the corresponding values of A2 (τ ).
Our framework allows for the existence of other assets besides bonds. For concreteness, we
assume there exists a stock portfolio with price dynamics
dS(t)
= (σS Λ̄ + r) dt + σS dz,
S(t)

(8)

The row vector σS is assumed to be linearly independent of the rows of σX , so that the stock is
not spanned by bonds. We can then group the existing assets into the vector process:
µ
¶
µ
¶
dP (t)
P
= diag
(µ(t) dt + σ dz),
dS(t)
S

(9)

where
σ=
and µ is such that

µ

A2 σX
σS

¶

(µ − ιr) = σ Λ̄

,

(10)

(11)

with ι equal to an (m+1)×1 vector of ones. Because we have assumed there exist m non-redundant
bonds, and because the stock is not redundant, the variance-covariance matrix of the assets, σσ >
is invertible.
5

Equation (11) shows why this specification allows for predictable excess returns. Because Λ̄ is
a function of the state variables X(t), the instantaneous expected excess return µ − r will also be
a function of X(t). The structure of λ̄2 will determine how quantities that are correlated with the
state variables, such as the yield spread, predict asset returns.
So far, we have described the nominal economy. Because we are interested in the strategies
for an investor who cares about real wealth, it is necessary to define a process for the price level.
Define a stochastic price level Π(t) such that
dΠ(t)
= π(X(t), t) dt + σΠ dz.
Π(t)

(12)

It is assumed that the drift π(t) is affine in the state variables:7
π(t) = ζ0 + ζX(t).

(13)

To a first approximation, π(t) equals expected inflation. The approximation becomes exact as the
time interval approaches zero.
In what follows, we will not require that there exist an asset that is riskfree in real terms. In
nominal terms, such an asset would have diffusion proportional to σΠ dz; thus the existence of a
real riskfree asset is equivalent to the existence of a portfolio that perfectly hedges Π(t). As long as
markets are incomplete (no real riskfree asset exists), there are more sources of risk than there are
independent risky assets: there are m + 1 risky assets (m bonds and one stock), but m + 2 sources
of risk (m state variables, the stock and the price level). As a consequence, the price of risk and
the pricing kernel are not unique. Any process Λ that satisfies
σΛ = µ − rι

(14)

is a valid price of risk. Because (14) is a system of m + 1 equations in m + 2 unknowns, the solution
is not unique. In what follows, Λ̄ will denote the price of risk that is specified in (3), while Λ will
denote a (generic) solution to (14).
Of special interest is the unique price of risk, Λ∗ , that both prices and is spanned by the
underlying assets. Λ∗ can be found by projecting Λ̄ onto these assets:
³
´−1
³
´−1
³
´−1
Λ∗ = σ > σσ >
σ Λ̄ = σ > σσ >
σΛ = σ > σσ >
(µ − rι).

(15)

7
It is sufficient for the portfolio choice results to require that r(t) − π(t) is an affine function. However, (1) is
required to achieve affine bond prices.

6

The last two equalities hold for any price of risk satisfying (14). Because we have assumed homoscedasticity, Λ∗ has the same functional form as Λ̄, with
λ∗1 = σ > (σσ > )−1 σ λ̄1

(16)

λ∗2 = σ > (σσ > )−1 σ λ̄2 .

(17)

replacing λ̄1 and λ̄2 in (3).
The price of risk Λ∗ is of interest for several reasons. First, the Cauchy inequality implies:
(Λ∗ )> Λ∗
σΛ∗
=p
max √
=
σ
(Λ∗ )> Λ∗
σσ >

q

(Λ∗ )> Λ∗ ,

thus the norm of Λ∗ equals the maximal Sharpe ratio. The maximal Sharpe ratio is always positive,
even if Λ∗ is not; this is because an investor can take both short and long positions in any asset.
Second, any price of risk Λ can be written as a sum of Λ∗ and a process that is orthogonal to σ.
That is,
Λ=σ

>

³

σσ

>

´−1

µ
¶
´−1
³
>
>
σΛ + Λ − σ σσ
σΛ = Λ∗ + ν.

(18)

The second term, ν, satisfies σν = 0, and thus is orthogonal to the underlying assets. This term
completely determines Λ: there is a one-to-one mapping between valid prices of risk Λ and processes
ν orthogonal to σ. We denote the pricing kernel associated with Λ ∗ (t) by φ∗ (t), and the pricing
kernel associated with Λ∗ (t) + ν(t) by φν (t), where
dφ∗ (t)
= −r(t) dt − (Λ∗ (t))> dz,
φ∗ (t)

(19)

dφν (t)
= −r(t) dt − (Λ∗ (t) + ν(t))> dz.
φν (t)

(20)

and

While we started by defining a pricing kernel for nominal assets, we could have equivalently
defined payoffs in real terms, and defined a pricing kernel for real assets. Any nominal pricing
kernel φν (t) is associated with a “real” pricing kernel. For an asset with nominal value V (s) at
time s, the price at time t (assuming the asset pays no dividends between t and s) equals
¸
·
φν (s)
V (t) = Et
V (s) .
φν (t)
It follows directly from (21) that for the real payoff V (s)/Π(s),
·
µ
¶¸
V (t)
φν (s)Π(s) V (s)
.
= Et
Π(t)
φν (t)Π(t) Π(s)
7

(21)

(22)

Therefore φν (t)Π(t) is a valid pricing kernel when asset prices are expressed in real terms. This
also follows from the interpretation of φν (t) as a system of Arrow-Debreu state prices. Normalizing
φν (0) = 1 and Π(0) = 1, φν (t) is a ratio of units of consumption at time 0 to dollars at time t. Then
φν (t)Π(t) is a ratio of consumption at time 0 to consumption at time t. We choose to model prices
in nominal rather than real terms for ease of comparison to the affine term structure literature.
The connection between incomplete markets and the lack of a real riskfree rate can also be seen
from the real pricing kernel associated with the nominal kernel φν (t). It follows from Ito’s Lemma
that
d(φν (t)Π(t))
= (−r(t) + π(t) − σΠ (Λ∗ (t) + ν(t))) dt + (σΠ − Λ∗ (t) − ν(t)) dz
φν (t)Π(t)

(23)

If a real riskfree rate were to exist, its real return must equal r(t) − π(t) + σ Π (Λ∗ (t) + ν(t)), the

drift of the real pricing kernel. While π(t), r(t) and σΠ Λ∗ (t) are observable (note that Λ∗ (t) can
be inferred from asset prices using equation (15)), σΠ ν(t) is not. In particular, any choice of ν
satisfying σν = 0 is consistent with the same asset prices, but will imply different values of σ Π ν,
and thus different riskfree rates.
To summarize, the investor has access to an asset with riskless nominal return r, and m+1 risky
assets whose nominal price dynamics are described by (9), (10), and (11). Nominal markets are
complete in that there exists a full term structure of nominal bonds.8 However, real markets may
be incomplete, because there may not exist a combination of assets spanning unexpected inflation.
Equivalently, there may not exist an asset that is riskfree in real terms.

3

Optimal portfolio choice

In this section, we derive the optimal portfolio allocation for an investor who takes bond and stock
prices as given. Section 3.1 describes the general form of the solution when there is unexpected
inflation. Section 3.2 specializes to the case of an affine term structure.

3.1

Complete nominal markets: General results

We first solve the portfolio choice problem for an investor with power utility over terminal wealth
at date T , and then generalize to the case of consumption withdrawal. We assume that the investor
solves:
max Et

W (T )>0

"

#
(W (T )/Π(T ))1−γ
,
1−γ

8

(24)

Below we will also consider cases where the investor has access to only a subset of the bonds (incomplete nominal
markets).

8

such that W (T ) can be achieved by taking positions in the underlying assets with initial wealth
W (0):
dW (t)
= w(t)> (µ(t) − r(t)ι) dt + r(t) dt + w(t)> σ(t) dz
(25)
W (t)
where w(t) is an (m + 1) × 1 vector of portfolio weights that satisfies integrability conditions. To
disallow doubling strategies, we require that W (t) > 0 for all t (see Dybvig and Huang (1988)).
To solve this problem, it is convenient to use the martingale technique of Cox and Huang (1989),
Karatzas, Lehoczky, and Shreve (1987) and Pliska (1986) generalized to the case of incomplete
markets by He and Pearson (1991).9 Cox and Huang (1989) show that when markets are complete,
the dynamic budget constraint (25) can be replaced by a static budget constraint analogous to the
no-arbitrage condition (5) that determines bond prices. That is
E [φ(T )W (T )] = W (0).

(26)

for the unique pricing kernel φ(t). When markets are incomplete, however, wealth, like any tradeable asset, must satisfy
E [φν (T )W (T )] = W (0).

(27)

for any pricing kernel φν . In general, optimizing with respect to (27) for a particular pricing kernel
will produce an incorrect answer because it will not be possible to replicate the resulting process
for wealth by trading in the underlying assets.
The insight of He and Pearson (1991) is that it suffices to verify (27) with respect to a single
pricing kernel φν ∗ . As He and Pearson show, the incomplete-markets problem can be recast as a
complete-markets problem by “adding” sufficient assets to complete the market, but setting the
return process on these assets so that their weight in the investor’s optimal portfolio is zero. In
other words, it suffices to chose ν such that in the complete market with (unique) pricing kernel
φν , the “additional” assets are not traded by the investor. The resulting pricing kernel φ ν ∗ is called
the minimax kernel because it is the pricing kernel φν such that when wealth is maximized with
respect to (27), the investor’s utility is minimized. This is intuitive; the “worst” way to add assets
from the point of view of the investor is to set their return processes such that the investor does
not want to trade them.
Thus the incomplete-markets case can be solved like the complete markets case if φ ν ∗ , given by
dφν ∗ (t)
= −r(t) dt − (Λ∗ (t) + ν ∗ (t))> dz,
φν ∗ (t)
9

(28)

Recently, Schroder and Skiadas (1999, 2002) extend this work to a broader class of stochastic processes for the
state variables and to a broader class of utility functions, including recursive utility.

9

is used as the pricing kernel. Precisely, the investor optimizes wealth with respect to
E [φν ∗ (T )W (T )] = W (0).

(29)

For some Lagrange multiplier l, the investor’s first-order condition equals
W (T )−γ
= lφν ∗ (T ),
Π(T )1−γ
and the optimal terminal wealth policy is given by
¡
¢− 1
W (T ) = lφν ∗ (T )Π(T )1−γ γ .

(30)

Substituting back into (29) gives the expression for l.10 Given φν ∗ , (30) describes optimal wealth.
Given optimal wealth, and hence an optimal portfolio rule, φν ∗ is determined by setting the demand
for the non-traded assets to zero.
The investor’s terminal wealth policy has an economic interpretation. Rearranging,
W (T )
−1
= (lφν ∗ (T )Π(T )) γ .
Π(T )

(31)

The left hand side is equal to real wealth. The term inside parenthesis on the right hand side
is proportional to φν ∗ (T )Π(T ). This equals the real pricing kernel corresponding to the nominal
kernel φν ∗ . Thus (31) states that the greater the price of a given state, the less the agent will
consume in that state. The lower the risk aversion (γ), the more the agent adjusts terminal wealth
in response to changes in the state-price density. Note however, that φ ν ∗ is also implicitly a function
of γ.
The optimal portfolio allocation is derived using (30). Define a new state variable equal to the
real wealth of the log utility investor if the unique price of risk were φν ∗ . In our environment with
inflation, this state variable equals:
Z(t) = (lφν ∗ (t)Π(t))−1 .

(32)

No-arbitrage implies that wealth at time t must equal the present discounted value of wealth at
time T , where the discounting is accomplished by the minimax pricing kernel:
i
h
1
W (t) = φν ∗ (t)−1 Et φν ∗ (T )Π(T )Z(T ) γ
i
h
1
−1
= Π(t)Z(t)Et Z(T ) γ
.

The next theorem characterizes the optimal wealth and portfolio weights.
10

Solving (29) for l implies

³ ³
´´ γ
1− 1
1− 1
l = W (0)−γ E φν ∗ (T ) γ Π(T ) γ
.

10

(33)

Theorem 1 Assume that the investor has utility over terminal wealth with coefficient of relative
risk aversion γ. At time t, optimal wealth takes the form
1

W (t) = Π(t)Z(t) γ F (X(t), t, T ),

(34)

where Z(t) is given by (32). The minimax pricing kernel equals
dφν ∗
= −r dt − (Λ∗ + ν ∗ )> dz,
φν ∗
with
³
´>
ν ∗ = (1 − γ) σΠ − (σΠ σ > )(σσ > )−1 σ .

(35)

The function F satisfies the partial differential equation
µ
¶
1
γ−1
1−γ
∗
∗
>
(r − π)F + FX K(θ − X) + σX (Λ + ν ) +
σX σΠ + F t +
γ
γ
γ
µ
³
´¶
1 11−γ
∗
∗ >
∗
∗
>
>
((Λ + ν ) (Λ + ν ) + σΠ σΠ )F + tr FXX σX σX
=
2 γ γ
γ−1
σΠ (Λ∗ + ν ∗ )F + FX σX (Λ∗ + ν ∗ ), (36)
γ
with boundary condition F (X(T ), T, T ) = 1.11 The optimal portfolio allocation equals
¶
µ
1
1
>
> 1
> −1
(σσ > )−1 (σσΠ
) + (σσ > )−1 (σσX
) (FX )> .
w(t) = (σσ ) (µ − ιr) + 1 −
γ
γ
F

(37)

The remainder of the investor’s wealth, 1 − w(t)> ι, is invested in the nominal riskfree asset.
The proof is given in Appendix B. The minimax price of risk equals the price of risk spanned by
the existing assets plus ν ∗ , which equals 1 − γ times the unhedgeable part of inflation risk. Thus
ν ∗ can be interpreted as an investor-specific measure of market incompleteness.

Equation (37) shows that the investor can be viewed as investing in m + 2 “funds”. The first
fund is the portfolio that is instantaneously mean-variance efficient. It is straightforward to check
p
that this portfolio achieves the maximum Sharpe ratio (Λ∗ )> Λ∗ . The second fund adjusts for

the fact that the first fund is mean-variance efficient in nominal rather than real terms. Together,

these portfolios constitute what is known as “myopic demand”, namely the optimal allocation if
the investor ignores the future investment opportunity set.
It is the last term in (37) that is the focus of this study. This term represents the sum of the
m hedge portfolios:
> −1

(σσ )

>
(σσX
)

M
1 X
1
>
>
(σσ > )−1 (σσX
)FXj
(FX ) =
j
F
F
j=1

11

tr(·) denotes the trace. FXX is the m × m matrix of second derivatives.

11

Hedge portfolio j is formed by projecting state variable j onto the available assets. Scaling the
¢>
¡
portfolio is the sensitivity of wealth to state variables j, F1 FXj . If increases in state variable j

increase wealth in the future, then the investor allocates a positive amount to the hedge portfolio
> ), a negative amount if the effect on wealth is negative. Because we have assumed
(σσ > )−1 (σσX
j

that there are as many non-redundant bonds as state variables, it is possible to completely hedge
the state variables by trading in the underlying assets. Moreover, hedging demand for bonds will
be nonzero. Because bonds are the discounted value of $1, their prices covary with the variables
that affect the investment opportunity set, namely X(t).
Also of interest is the investor’s indirect utility. Cox and Huang (1989) show that it is possible
to derive indirect utility from the expression for wealth. Corollary 2 generalizes this result to the
case where there is unexpected inflation (and specializes to the case of power utility):
Corollary 2 Define the investor’s indirect utility function as follows:
"
µ
¶ #
W (T ) 1−γ
1
J(W (t), Π(t), X(t), t, T ) = Et
1 − γ Π(T )

(38)

Then J(W, Π, X, t, T ) takes the form
1
J(W (t), Π(t), X(t), t, T ) =
1−γ

µ

W (t)
Π(t)

¶1−γ

F (X(t), t, T )γ

where F (X(t), t, T ) is defined in Theorem 1.
The proof of Corollary 2 can be found in Appendix B.
These results generalize to the case where the investor has utility over consumption between
times 0 and T . At each time, besides allocating wealth among assets, the investor also decides what
proportion of wealth to consume. The investor solves
¸
·Z T
(c(t)/Π(t))1−γ
dt
max E
e−ρt
1−γ
0

(39)

³
´
s.t. dW (t) = w(t)> (µ(t) − r(t) ι) + r(t) W (t) dt + w(t)> σW (t) dz − c(t) dt
W (T ) ≥ 0

As shown in Wachter (2002a), computing the solution to this case does not require solving a
new partial differential equation.12 As in the case of terminal wealth, the dynamic problem can
12

While the results in Wachter (2002a) assumed that markets were complete, the same reasoning can be applied
here because the adjustment for incomplete markets in the minimax pricing kernel (35) takes a particularly simple
form.

12

be recast as static problem for an endogenous pricing kernel. Using arguments similar to those
in the proof of Theorem 1, it can be shown that, when the only market incompleteness comes
from inflation, the investor-specific pricing kernel (φν ∗ ) for the case of intermediate consumption
takes the same form as the investor-specific pricing kernel for terminal wealth. The static budget
constraint is therefore equal to:
E

·Z

T

¸

c(t)φν ∗ (t) dt = W (0)
0

(40)

The following corollary describes the form of the investor’s consumption policy, optimal wealth,
and portfolio allocation.
Corollary 3 The optimal consumption policy c(t) satisfies:
c(t)
−1 −ρt
= (lφν ∗ (t)Π(t)) γ e γ ,
Π(t)

(41)

where l is the Lagrange multiplier that allows (40) to hold. Optimal wealth is given by
1

W (t) = Z(t) γ Π(t)

Z

T

F (X(t), t, s)e

− γρ (s−t)

ds,

(42)

t

where Z(t) is defined by (32), and F satisfies the partial differential equation (36) The optimal
RT
− ρ (s−t)
portfolio weights are given by (37) with F replaced by t F e γ
.
Theorem 1 generalizes the well-known result that the price of risk and the riskfree rate are

sufficient statistics for the investment opportunity set when markets are complete. In the setting of
unhedgeable inflation risk, the minimax price of risk (Λ∗ + ν ∗ ), the difference between the nominal
interest rate and expected inflation r−π, and the volatility of inflation σΠ are sufficient statistics for
the investment opportunity set. As (36) shows, assuming that all of these are constants results in
a function F that is identically 1, and a myopic portfolio rule. Moreover, if two economies have the
same processes for these quantities, the optimal consumption and wealth process for the investor
will be the same, even though the weights will depend on the specific assets that trade.
In the homoscedastic setting of this paper, σΠ and ν ∗ are constant by assumption. Therefore
the sources of time-variation in the investment opportunity set are Λ∗ and r −π (note (ν ∗ )> Λ∗ = 0).
For convenience, we will abuse terminology slightly and refer r − π as the real riskfree rate, keeping

in mind that there may not exist an asset that is riskfree in real terms.13
13

Indeed, the results in Section 2 show that this will only be the real riskfree rate if markets are completed such
that the price of inflation risk is zero.

13

3.2

Portfolio allocation when the nominal term structure is affine

Theorem 1, Corollary 2, and Corollary 3 do not require that bond yields be affine. They hold
generally, as long as the investor has power utility over terminal wealth. The following corollary
explicitly solves for the portfolio weights, given the assumptions on Λ̄, r, and π.
Corollary 4 Assume Λ̄ and r−π are linear in the state variables X(t), and that inflation and asset
prices are homoscedastic, and the investor has utility over terminal wealth given by (24). Then F
takes the form:
½ µ
¶¾
1 1
>
F (X(t), t, T ) = exp
X(t) B3 (τ )X(t) + B2 (τ )X(t) + B1 (τ )
,
γ 2

(43)

where τ = T − t and the matrix B3 , the vector B2 , and the scalar B1 satisfy a system of ordinary
differential equations. The optimal portfolio rule equals:
w(t) =

γ−1
1
>
(σσ > )−1 (µ − ιr) +
(σσ > )−1 (σσΠ
)+
γ
γ
µ
¶
B3 (τ ) + B3 (τ )>
1
> −1
>
>
(σσ ) (σσX )
X(t) + B2 (τ )
. (44)
γ
2

The remainder of the investor’s wealth, 1 − w(t)> ι, is invested in the nominal riskfree asset.
The proof of Corollary 4 and the differential equations for B3 , B2 , and B1 can be found in Appendix B. A noteworthy special case arises when risk premia are constant. Then B 3 (τ ) = 0, as can
be checked by setting λ∗2 = 0 into the differential equation (61). The optimal portfolio allocation is
constant, and F is exponential-affine. A two-factor version of this case is considered by Brennan
and Xia (2002).
Why do time-varying risk premia produce a functional form that is exponential-quadratic? As
Campbell and Viceira (1999) discuss, the reason is that the investor can profit both when risk
premia σΛ∗ are especially high and positive, and when they are especially low and negative. A
function for wealth that is quadratic in X(t) captures this quality. Note that exponential-quadratic
wealth implies a portfolio rule that is linear in the state variables.
Using Corollary 3, it is also possible to write down an explicit formula for the optimal portfolio
for an investor with utility over consumption.
Corollary 5 Assume Λ̄ and r − π are linear in the state variables X(t), and that inflation and
asset prices are homoscedastic. Suppose the investor has utility over consumption. The optimal

14

portfolio weights equal:
w(t) =

1
γ−1
>
(σσ > )−1 (µ − ιr) +
(σσ > )−1 (σσΠ
)+
γ
γ
³
´ ρ

R T
−γτ
>
>
1
(B
(τ
)
+
B
(τ
)
)X(t)
+
B
(τ
)
dτ
F
(t,
t
+
τ
)
e
3
3
2
2
1
>  t

(σσ > )−1 (σσX
)
RT
−ρτ
γ
F (t, t + τ )e γ dτ
t

The results above show that wealth, indirect utility, and the optimal allocation are available
in closed form up to the solution of ordinary differential equations. In the following sections, we
estimate the parameters of the model and evaluate the implications for portfolio choice.

4

Estimation

The previous sections described optimal portfolio choice when the nominal term structure is affine
and the investor has access to stock as well as bonds. In this section we estimate a three-factor term
structure model that has been shown to perform well in out-of-sample forecasting (Duffee (2002)),
and in replicating the failure of the expectations hypothesis seen in the data (Dai and Singleton
(2002a))14 . Our estimation differs from the estimation in these studies in that we incorporate data
on equity returns, and most importantly, on inflation.15
There are five sources of risk in the model. The first three are due to the state variables X
defined by (2), the fourth is due to the stock price S defined in (8), and the fifth is due to the price
level Π defined in (12). Thus dz is a 5 × 1 vector of independent Brownian motions, σ X is a 3 × 5
matrix, and σS and σΠ are 1 × 5 vectors. Without loss of generality, we order the elements of dz
so that when σX , σS and σΠ are stacked, the resulting 5 × 5 matrix is lower triangular:


σX(1,1)
0
0
0
0


 σX(2,1) σX(2,2)
0
0
0 
σX


 σS  =  σX(3,1) σX(3,2) σX(3,3)
0
0 


 σS(1)
σΠ
σS(2)
σS(3) σS(4)
0 
σΠ(1)
σΠ(2)
σΠ(3) σΠ(4) σΠ(5)

Thus dz1 is the risk arising from X1 , dz2 is risk arising from X2 that is orthogonal to the risk in
X1 , dz3 is risk arising from X3 that is orthogonal to the risk in X1 and X2 , etc.
14

In the notation of these papers, the model we estimate is known as A0 (3), because it contains three factors and
no square root processes.
15
There is a substantial literature on using yields on nominal bonds to extract expected inflation. This includes
Boudoukh, Richardson, and Whitelaw (1994), Fama (1975), Fama and Gibbons (1982), and Mishkin (1981) who
use a regression approach, and Ang and Bekaert (2003), Boudoukh (1993), Pennacchi (1991), and Sun (1992), who
estimate expected inflation within a term structure framework that precludes the existence of arbitrage.

15

In the estimation, we seek to identify
Λ∗ (t) = λ∗1 + λ∗2 X(t)
the unique price of risk that is within the span of the underlying assets. Given the ordering for dz,
it follows that λ∗1 and λ∗2 take the form:
λ∗1 = [ λ∗1(1) . . . λ∗1(4) 0 ]>
and




λ∗2 = 


λ∗2(1,1) . . . λ∗2(1,3)
..
..
.
.
λ∗2(4,1) . . . λ∗2(4,3)
0
0
0







λ∗1 and λ∗2 have zeros in the fifth row because both bonds and stocks load only on the first four
Brownian motions. Otherwise, λ∗1 and λ∗2 would not be within the span of σ as required.16
As Dai and Singleton (2000) discuss, the processes for X, Λ∗ and r have too many degrees of
freedom to be identified by the data. For example, it is not possible to simultaneously identify θ
and δ0 . Following Dai and Singleton (2000) and Duffee (2002) we set θ = 0 3×1 , and specify that K
is lower triangular. Further, we set
σX =

£

I3×3 03×2

¤

(45)

analogously to Dai and Singleton and Duffee who set σX equal to the identity.
With the restrictions described above, all of the parameters in the model can, in principle,
be identified. In practice, the large number of parameters in such models has led to concerns of
over-fitting. We follow Duffee (2002) in further restricting the matrix K and the price of risk λ ∗2 in
order that the estimation be more reliable. Given the form of σX (and because bonds load only on
the state variables), the first three rows of λ∗1 and λ∗2 are determined by risk premia on bonds and
can be identified from term structure data. We place the same restrictions on these elements of λ ∗2
as does Duffee (2002). In addition, we restrict the fourth row of λ ∗2 so that the equity premium is
constant. We set this requirement because of the difficulty in identifying three separate sources of
variation in the equity premium that all arise from the term structure, and because the focus of
this paper is on bond return, rather than stock return, predictability. Because σ S is determined
16

Below we also consider the case of incomplete nominal markets. For these cases, Λ ∗ must be adjusted further so
that it is within the span of the existing assets.

16

from the variance-covariance matrix of bond and stock returns, and because the first three and fifth
rows of λ∗1 and λ∗2 are determined, the equation for the equity premium
σS (λ∗1 + λ∗2 X(t)) = η0

(46)

is a system of four equations in four unknowns. Rather than estimate the fourth row of λ ∗1 and λ∗2
directly, we estimate η0 and back out λ∗1 and λ∗2 using (46).
Our bond data consist of monthly observations on zero-coupon yields for 3 month, 6 month, 1,
2, 5, and 10 year U.S. government bonds. The bond data is available from the website of Gregory
Duffee. Monthly observations on the CPI and on returns on a broad stock index are available from
CRSP. The sample begins in 1952 and ends in 1998. Following Duffee (2002), we assume that
prices on the 3 month, 1 year, and 5-year bonds are measured with normally distributed errors.
The model implies that state variables, stock returns, and realized inflation are jointly normally
distributed. The parameters are thus δ0 , δ, ζ0 , ζ, K, λ∗1 , λ∗2 , σS , σΠ , and η0 , and the variancecovariance matrix of the errors. We estimate the model using maximum likelihood, an alternative
to the Generalized Method of Moments approach of Gibbons and Ramaswamy (1993). Details are
contained in Appendix E.
Tables 1, 2 and 3 describes the results from our estimation. Because the yields are in annual
terms, time is in years. As shown in Table 1, the parameters ζ0 and δ0 equal the sample means
of inflation and the nominal interest rate. Both of these parameters equal their sample means
from the data. While this may seem like a natural property, as Campbell and Viceira (2001)
discuss, it is not guaranteed that the models fit the time series mean. In fact, the affine models
investigated by Duffee (2002) all result in a sample mean for the nominal interest rate that is too
low.17 Surprisingly, including inflation in the estimation helps to estimate this parameter.
Table 2 describes the elements of σS and σΠ . The first and third elements of σS are negative,
consistent with a positive correlation between bond and stock returns (indeed, as Table 4 shows,
the correlation is positive). The fourth element of σS (by far the largest) represents the component
of stock returns orthogonal to bond returns. The third and fourth elements of σ Π are negative and
significant, consistent with a negative correlation between unexpected changes in the price level
and bond and stock returns. The volatility of the orthogonal component of σ Π is 0.91% per annum.
This is close to, but smaller than the volatility of realized inflation in the data (1.17%). This makes
sense; the state variables add information and thus reduce the volatility.
17

Duffee ends his sample in 1994. This does not account for the difference however. We estimate the A 0 (3) model
without inflation, and find δ0 = 4.4%, even when we include the last four years of the sample.

17

Other than δ0 described above, the parameters that we estimate for the term structure are very
close to those found by Duffee (2002).18 Table 3 shows that the components of λ∗1 are estimated
to be negative. Because bond prices load negatively on the state variables, negative values of λ ∗1
imply positive average risk premia on bonds. The estimates of λ∗2 imply that two factors determine
time-varying risk premia on bonds. The first is given by the transitory factor X 2 , while the second
is a linear combination of X1 , X2 and X3 , and hence is more persistent. Table 3 also shows that
the estimated equity premium equals 7.5%, approximately its mean from the data.
Figures 1-3 illustrate the implications of the model for average yield spreads, standard deviations
of yield spreads, and Campbell-Shiller long-rate regressions. Each figure plots the values in the data
(“sample”) and the values implied by the model. Following Dai and Singleton (2002a), we construct
95% confidence bands by simulating 500 sample paths from our model with length equal to the
sample path in the data. Figures 1 and 2 show that the model implies average yield spreads and
standard deviations of yield spreads close to those found in the data. The confidence bands reflect
the well-known result that means are estimated much more imprecisely than variances. In both
cases, the data falls well within the error bands implied by the model. We conclude that the model
does a reasonable job of fitting the cross-sectional moments of bond yields. Because the model must
fit cross-sectional and time-series moments together, the fit to the cross-section is not automatic.
Because our aim is to study the implications of the expectations puzzle for investors, it is
especially important to determine whether the model accounts for the expectations puzzle found
in the data. To do so, we follow the approach of Dai and Singleton (2002a) and check whether the
model replicates the empirical findings of Campbell and Shiller (1991). Dai and Singleton explain
the connection between the Campbell-Shiller regressions and time-variation in risk premia in detail.
Figure 3 plots the slope coefficients from regressions of quarterly changes in yields on the scaled
yield spread, as described in Campbell and Shiller (1991). If the expectations hypothesis held, the
coefficients would be identically equal to 1. Instead, Campbell and Shiller find coefficients that are
negative and decrease with maturity. Figure 3 replicates this result in our data, and shows that
the model captures both the negative coefficients and the downward slope. Except for values at
the very short end of the term structure, the data falls within the 95% confidence bands implied
by the model. It is apparent from Figure 3 that the model captures the failure of the expectations
hypothesis found in the data. To the extent that the failure of the expectations hypothesis is
a bit less extreme in the model than the data, we may understate the implications for long-run
18

The variance covariance matrix for the errors, which we do not report, is nearly identical to that found by Duffee
(2002).

18

investors.19
Figure 4 plots the time series of monthly realized inflation, and our expected inflation series
constructed from the state variables using the relationship
π(t) = ζ0 + ζX(t),
where values for ζ0 and ζ come from the maximum likelihood estimation described above, and
are given in Table 1. Our joint estimation procedure allows inflation to influence the dynamics of
state variables. In practice, however, this effect is small, and except for the effect on δ 0 described
above, our parameter values are close to what we would find by first estimating the term structure
model, and then regressing realized inflation on the factors. This latter strategy would, of course,
understate the standard errors on ζ.
Figure 4 shows that our expected inflation series does indeed forecast realized inflation. In fact,
expected inflation accounts for 37% of the variance of realized inflation. It is worth emphasizing
that these results come about even though the factors X(t) are linear combinations of yields alone.
Thus long-term bond yields contain substantial information about future inflation.
Figure 5 plots the time series for the nominal interest rate r(t) implied by the model. While
not shown in the graph, r(t) is essentially equal to the three-month yield. The difference between
the nominal interest rate r(t) and π(t), which we informally refer to as the real interest rate, is also
shown on the graph. This series is positive through nearly the entire sample. Thus the expected
inflation and real riskfree rate implied by the model have reasonable time-series properties.
The results in Section 3 show that the real interest rate r − π and the price of risk Λ ∗ are
the important quantities for investors. Figure 6 plots the time series of risk premia (a linear
transformation of Λ∗ ) for the one, five, and ten year bonds implied by the model. As Figure 6 shows,
risk premia are highly volatile, especially in the latter half of the sample. Table 3 implies that there
are two factors driving risk premia: the first is the highly transitory second state variable, the second
is a linear combination of all three state variables that is much more persistent. Nonetheless, all
three risk premia appear to move closely together. This is consistent with the findings of Cochrane
19

Expectations hypothesis regressions are subject to small-sample biases that could go in either direction (Bekaert,
Hodrick, and Marshall (1997, 2001) , Stambaugh (1999), Volkanov (1998)). Longstaff (2000b) finds that tests fail
to reject the expectations hypothesis at the short end of the term structure and argues that the failure of the
expectations hypothesis may be due to a liquidity premium in Treasury Bill rates. Bekaert and Hodrick (2001) argue
that standard tests tend to reject the expectations hypothesis even when it is true. They find, however, that the data
remain inconsistent with the expectations hypothesis, even after adjusting for small-sample properties. Accounting
for these biases within the investment decision is beyond the scope of this manuscript, but will be pursued in future
work.

19

and Piazzesi (2002), who show that a single factor can explain much of the time-variation in
expected excess returns on bonds.
Taking the results in this section together, we conclude that our model succeeds in capturing important features of the term structure and of inflation. The next section considers the implications
of our parameter estimates for portfolio choice.

5

Portfolio allocation under the failure of the expectations hypothesis

This section combines the theoretical results from Section 3 with the parameter estimates from
Section 4 to evaluate the implications of the failure of the expectations hypothesis for long-horizon
investors. The failure of the expectations hypothesis could affect the optimal portfolio in two
ways. First, the myopic portfolio,

1
> −1
γ (σσ ) (µ

− ιr) +

γ−1
> −1
>
γ (σσ ) (σσΠ ),

depends directly on

risk premia. If risk premia vary, so will myopic demand. Second, time-varying risk premia imply
that investment opportunities vary over time (as long as changes in risk premia are not directly
offset by changes in volatility). As Merton (1971) shows, the investor hedges these changes in the
investment opportunity set, implying that the optimal allocation is not mean-variance efficient.
Hedging demand causes the optimal portfolio for a long-horizon investor to differ from the optimal
portfolio for an investor with a short horizon. Both effects are present in theory. The question is,
are they economically significant?

5.1

Optimal allocation between a long-term bond, stock, and the nominal riskfree asset

To investigate the effect of time-varying risk premia on optimal portfolios, we first consider the case
where the investor has access to a single long-term bond, stock, and a nominally riskfree asset. This
case allows us to temporarily abstract from questions pertaining to the optimal composition of the
bond portfolio, and focus on the horizon properties taking the composition as given. 20 The results
in Theorem 1 apply only to the case where nominal markets are complete, namely when there are
the same number of long-term bonds as state variables. However, they are easily modified for the
case of incomplete nominal markets. Optimal wealth and allocation to long-term bonds still take
the same form as in Corollary 4. Theorem 1 and Corollary 4 are extended to the incomplete-market
20
Note however that there is a cost to restricting the maturity of the bond. Brennan and Xia (2002) show in a
related setting that, if the investor is allowed to trade only one bond, the optimal maturity of the bond depends on
the investor’s horizon.

20

case in Appendix C.21
Figure 7 plots the optimal allocation for the investor who allocates wealth between a five-year
bond, stock, and the nominally riskfree asset. The investor is assumed to have utility over wealth
at the end of the horizon. In the left panel, risk aversion γ = 4, in the right panel γ = 10. Both
myopic demand and hedging demand depend on the current premia on bonds over the riskfree rate.
Thus the optimal allocation is a function of the state as well as horizon. In order to understand how
the optimal portfolio varies with the state, we plot the optimal allocation when the state variables
are equal to their long-run mean of zero, and then we vary each state variable by two unconditional
standard deviations. The results are similar in each case, so we discuss only the effects of varying
X1 .

22

The risk premium on the five-year bond equals 2% per annum when the state variables are at
their long-run mean, 6% when X1 is two standard deviations below its long-run mean, and -3%
when X1 is two standard deviations above its long-run mean. The negative relationship between
the risk premium on the five-year bond and X1 is implied by the parameter estimates in Table 3 and
the correlation between the five-year bond and the state variables in Table 5. In particular, Table 3
shows that λ2(3,1) > 0 and λ2(i,1) = 0 for i = 1, 2. This means that the price of risk associated with
the third Brownian motion is increasing and the price of risk for the first two Brownian motions is
constant in X1 . Because state variables can be exactly identified with Brownian motions, the price
of X3 -risk is increasing in X1 . Because bond prices load negatively on X3 , risk premia on bonds
are decreasing in X1 . Note that the equity premium is constant in X1 by construction: the fourth
row of λ∗2 is set so that σS λ∗2 = 0.
The top panel in Figure 7 shows the optimal allocation when X1 is two standard deviations
below its long-run mean (risk premium = 6%), the middle panel shows the allocation when X 1 is
at its long-run mean (risk premium = 2%), and the bottom panel shows the allocation when X 1 is
two standard deviations above its long-run mean (risk premium = -3%). The myopic allocation is
equal to the y-intercept, because, under power utility, it is independent of horizon. Not surprisingly,
the the lower is X1 (and the greater are risk premia), the greater is the myopic allocation to the
five-year bond. When risk premia are at their long-run mean, the optimal allocation to bonds is
21

The results for utility over consumption (Corollary 5) have no straightforward extension.
The unconditional variance-covariance matrix of the state variables can be calculated using the results of Appendix E. The unconditional standard deviation is 0.93 for X1 , 0.39 for X2 , and 3.0 for X3 . Varying X3 has smaller
effects on myopic demand, which can be seen by comparing 0.93λ∗2 (3, 1) to 3λ∗2 (3, 3). Because X3 is a more persistent
variable, the effects on hedging demand are larger. By contrast, X2 has a larger effect on risk premia, and thus on
myopic demand. However, its effects on hedging demand are smaller because it is much less persistent.
22

21

positive. When risk premia are negative, the optimal allocation involves taking a short position in
the long-term bond. Because of the positive correlation between the five-year bond and the stock,
an increase in the risk premium on the five-year bond leads to a lower allocation to the stock. A
comparison between the panels shows that the investor with risk aversion γ = 4 times the market
more aggressively than the investor with risk aversion equal to 10.
There are strong horizon effects for long-term bonds.23 For values of X1 implying positive bond
premia, the allocation to the five-year bond rises steadily with the horizon. When bond premia are
negative, the optimal allocation initially falls, but then rises after a horizon of about one year. The
difference between short-horizon and long-horizon investors is economically large. For example,
when X1 is at its long-run mean, the myopic investor with γ = 10 allocates 20% of his wealth to
the long-term bond. An investor with γ = 10 and a horizon of 20 years, by contrast, allocates over
100% of his wealth to the long-term bond. While hedging demand for γ = 4 is smaller than that for
γ = 10 as a proportion of myopic demand, it is still economically large. When the state variables
are at their long-run mean, hedging demand more than doubles the allocation to the five-year bond
for the γ = 4 investor.
What drives the horizon effects seen in Figure 7? As discussed in Section 3, hedging demand
arises from two sources. One is time-variation in risk premia, the other is time-variation in the
real riskfree rate, r − π. To separate out these two effects, Figure 8 plots the allocation when the
investor has the correct myopic demand but hedges only time variation in the real riskfree rate
(plain lines) and the allocation when the investor has the correct myopic demand but hedges only
time variation in risk premia (lines with circles).
Suppose first that the investor hedges only time variation in the real riskfree rate. This allocation
is given by (44), the same equation that defines the optimal allocation, but with λ ∗2 set equal to
zero in the equations for B3 (τ ), B2 (τ ) and B1 (τ ). Figure 8 shows that hedging demand induced
by time-variation in the real riskfree rate is positive and increasing in the horizon, though it is
substantially smaller than the full hedging demand shown in Figure 7.
Hedging demand resulting from the real riskfree rate is positive because long-term bond prices
and the real riskfree rate are negatively correlated (Table 5). A multiperiod investor chooses the
optimal portfolio not only to maximize the Sharpe ratio, but also so that future wealth has the
“right” correlation with future investment opportunities. If γ > 1, the investor has lower marginal
utility of wealth when the real riskfree rate is high; the income effect dominates (a higher riskfree
23
Relative to the long-term bond, stocks have a low correlation with the investment opportunity set and thus
negligible horizon effects.

22

rate makes him richer, he can afford a lower payoff in those states). If γ < 1, the investor has lower
marginal utility of wealth when the riskfree rate is low; the substitution effect dominates (wealth
is more valuable when the riskfree rate is higher because it can be invested at a higher rate). Thus
the investor with γ > 1 will invest more than the mean-variance efficient allocation in assets that
have a negative covariance with changes in the riskfree rate. These assets pay off when the riskfree
rate is low, giving the investor more wealth when marginal utility for wealth is highest.
All of the reasoning above goes through regardless of the level of risk premia. Indeed, Figure 8
shows that hedging demand coming from the real riskfree rate does not depend on the value of the
state variables. Mathematically, this follows from the fact that B3 (τ ) ≡ 0 when λ∗2 = 0, as noted
in Section 3. When the investor only hedges changes in the real interest rate, hedging demand is
non-stochastic.
A number of studies (e.g. Brennan and Xia (2000), Sorensen (1999), Wachter (2002b)) have
argued that a time-varying riskfree rate leads investors with longer horizons to allocate a greater
percentage of their portfolio to long-term bonds. According to this argument, long-term bonds are
negatively correlated with the riskfree rate, and thus should be over-weighted in the portfolios of
investors with risk aversion greater than one. The limitation with this argument is that it requires
bonds to be real. Nominal bonds are negatively correlated with the nominal riskfree rate, but the
investor desires to hedge the real riskfree rate r − π, and nominal bonds may not be negatively
correlated with the real riskfree rate. For our calibration, long-term bonds are indeed negatively
correlated with the real riskfree rate, though it is important to note that this is an empirical, not
a theoretical result. Thus the investor with risk aversion greater than one chooses to increase her
allocation to long-term bonds relative to the myopic portfolio. Because changes in the real riskfree
rate are persistent, the longer the investor’s horizon, the greater the effect of the riskfree rate on
indirect utility, and the larger is hedging demand.
We now consider the optimal allocation when the investor hedges bond premia, but not the
riskfree rate. This is calculated by setting ζ = δ in the equations for B3 , B2 , and B1 . This
allocation is shown in Figure 8 and marked with circles. Hedging demand induced by time-varying
bond premia is positive and increasing in horizon when bond premia are positive. When bond
premia are negative, hedging demand is negative at short horizons and positive at long horizons.
Consider first the case where risk premia on long-term bonds are positive. A rise in risk premia
counts as an improvement in investment opportunities, while a fall in risk premia counts as a
deterioration. The same reasoning that applied in the case of a time-varying riskfree rate applies

23

here too. When the income effect dominates (γ > 1), hedging demand is positive for assets that are
negatively correlated with bond premia. As shown in Table 5, bond prices and bond risk premia
are negatively correlated. This explains why hedging demand for long-term bonds induced by timevariation in risk premia is positive. Moreover, changes in risk premia are persistent, as are changes
to the real riskfree rate. Thus the longer is the investor’s horizon, the greater is hedging demand,
and the larger is the total allocation to the long-term bond.
This reasoning also explains why hedging demand for the long-term bond can be negative.
Figure 8 shows that when risk premia are negative, hedging demand arising from time-variation in
risk premia causes the allocation to fall in the horizon before increasing again. When the investor is
short the long-term bond, decreases in the risk premium represent improvements in the investment
opportunity set. In order to hedge these changes, the investor has a more negative allocation
to long-term bonds than the myopic investor. However, rather than steadily decreasing in the
horizon, hedging demand begins to increase after a horizon of about two years, and eventually
becomes positive.
Campbell and Viceira (1999) and Kim and Omberg (1996) noted the same effect for the case
where the investor allocates wealth between a riskfree asset and a stock with a time-varying risk
premium. They found that when the equity premium was negative but close to zero, hedging
demand was nonetheless positive. This counter-intuitive result arose because the average equity
premium in these studies is positive, as are average bond premia here. Because the risk premium
reverts to its long-term mean, a risk premium that is negative in the present implies that in the
future, the risk premium is likely to pass through zero. A long-horizon investor cares not only about
the risk premium today, but also about the risk premium at all future points in time. Zero is the
least advantageous value for the investor because neither a short nor a long position is profitable
in expectation. All else equal, a long-term investor would prefer a positive risk premium because
it is more likely to stay positive, than a negative risk premium is to stay negative. Figure 8 shows
that this effect is operative in the case of bonds as well.
Returning to Figure 7, it is clear that optimal hedging demand is not simply a sum of hedging
demand when only the real riskfree rate varies and hedging demand when only risk premia vary. It
arises from a nonlinear interaction between the two. Because the investor uses the long-term bond
to hedge time-variation in the real riskfree rate, she has an additional reason to prefer positive risk
premia in the long run. This induces her to hedge risk premia to a greater extent than she would
if the riskfree rate were constant.

24

This effect contributes to making hedging demand positive, even when risk premia are negative.
When risk premia are small and negative, the investor with a sufficiently long horizon would prefer
it to become positive, rather than more negative. To hedge the possibility that risk premia fall
further, the investor allocates more wealth to the long-term bond; hedging demands are positive.
Mathematically, this can be seen from the equation for B2 (τ ) in Appendix B. From (37), it follows
that if B2 (τ ) were zero, then the hedging demand as a function of X1 would be symmetric around
zero. This is not the case because λ∗1 > 0, namely because the mean risk premium is not zero but
positive, and because δ − ζ 6= 0, namely that the real interest rate is time-varying. Thus because
risk premia are positive on average, and because bond returns are negatively correlated with the
real interest rate, hedging demand may be positive even when myopic demand is negative.
This section has shown that accounting for time-variation in the risk premia on long-term
bonds has two effects on the investor’s optimal portfolio. First, it induces investors to time the
bond market. A lower risk premium on a long-term bond leads the investor to allocate less wealth
to the bond at all horizons. The second effect arises from the investor’s wish to hedge changes
in the risk premium. This causes the optimal portfolio to increase dramatically with the horizon.
Thus the failure of the expectations hypothesis “matters” for long-term investors, at least in the
case where the investor has access to a single long-term bond. The following section generalizes
these results to the case where the investor has access to multiple long-term bonds.

5.2

Optimal allocation to multiple long-term bonds

Figure 9 plots the optimal allocation when the investor has access to a three-year bond, a ten-year
bond, stock, and a nominally riskless asset. As in the previous section, we determine the optimal
allocation for the long-run mean of the state variables, and for the state variables plus and minus
one standard deviation. We report only the effects of varying X1 .
For all three values of the state variable, the myopic portfolio consists of a short position in at
least one of the bonds. These leveraged positions arise because of the correlation structure of bond
returns implied by the model (and found in the data). Table 4 shows the implied correlations in
bond returns (Panel A), and correlations of monthly log bond returns from the data (Panel B). 24 As
Table 4 shows, bonds at all maturities are highly correlated. Thus any estimated difference in the
risk-return trade-off between the three and ten-year bond leads the investor to leverage the bonds
24

Because yield data is unavailable for all maturities, the correlations in Panel B rely on approximating the yield
on the 9 year, 11-month bond with the yield on the ten-year bond. Thus the correlations in Panel B are essentially
correlations between changes in yields.

25

off one another. In the context of a time-varying real interest rate, Brennan and Xia (2002) and
Campbell and Viceira (2001) also find that the investor takes highly levered positions in long-term
bonds.
When risk premia are high and positive, the investor takes a leveraged position in the ten-year
bond, financed by a short position in the three-year bond and the riskfree asset. In this case, hedging
demand makes the myopic allocation more extreme. Because the investor has a long position in
the ten-year bond, decreases in the risk premium on the ten-year bond reflect deteriorations in the
investment opportunity set. The investor hedges these changes in risk premia by allocating more
to the ten-year bond. Because the investor has a short position in the three-year bond, increases in
the risk premium reflect deteriorations in the investment opportunity set. Thus the investor takes
a greater short position in the three-year bond.
When risk premia are positive but closer to zero, the optimal allocation changes. Now the
risk-return trade-offs are such that the myopic portfolio consists of a positive fraction of wealth in
the three-year bond and a negative fraction in the ten-year bond. Hedging demands also reverse
in sign. For short horizons, hedging demand is positive for the three-year bond and negative for
the ten-year bond. At long horizons, however, hedging demand is positive for both the ten and the
three year bonds.
Finally, when risk premia are negative, the investor holds a positive position in the three-year
bond and a negative position in the ten-year bond. Hedging demands cause these positions to
become more extreme. Investment opportunities deteriorate when the risk premium on the tenyear bond rises or the risk premium on the three-year bond falls. The investor chooses the optimal
portfolio so that wealth is higher when this occurs. That is, the investor increases her weight in
the three-year bond and decreases her weight in the ten-year bond.
Figure 10 examines the case where the investor has access to three long-term bonds, stock, and
the riskfree asset. Because the nominal market is complete in this last case, it does not matter for
the investor’s utility or wealth which three bonds are chosen. Thus without loss of generality, we
assume that the investor has access to a one, five, and a ten-year bond. Moreover, the investment
opportunity set can be fully hedged by trading in bonds, thus hedging demand for stock will be
identically zero. The caveat stated for the case where the investor has access to two bonds applies
to an even greater extent in this case. Because the three bonds are so highly correlated, the investor
can achieve (perceived) high Sharpe ratios while taking on less risk than when he had access to
fewer bonds. This leads to a highly leveraged myopic portfolio.

26

The results in this case have much in common with the result from the two-bond case. In general,
hedging demand causes the optimal portfolio to be more extreme than the myopic portfolio. When
risk premia are positive, the myopic allocation consists of a positive position in the ten-year bond
and a negative position in the five-year bond. Hedging demand increases in horizon for the ten-year
bond and decreases for the five-year bond. When risk premia are negative, the myopic allocation for
the ten-year bond is below that for the five-year bond.25 Hedging demand takes the opposite sign
as when risk premia are positive: it is negative for the ten-year bond and positive for the five-year
bond. In one sense, the three-bond case is more complicated. The investor always takes a long
position in the one-year bond, regardless of the risk premium. Hedging demand for the one-year
bond is generally opposite in sign to that of the ten-year bond; it does not depend on whether the
investor is long or short the one-year bond. The one-year bond may help the investor isolate the
component of the ten and five-year bonds that are correlated with future expected returns, rather
than hedge time-variation in the one-year bond itself.

5.3

Utility costs of sub-optimal strategies

In order to assess the economic importance of the failure of the expectations hypothesis, we calculate
utility costs under strategies that fail to take it into account. Three sub-optimal strategies are
considered. For the first (and least) sub-optimal strategy, the investor times the bond-market
optimally (the mean-variance efficient portfolio varies over time) and optimally hedges the real
interest rate. However, the investor does not hedge time-varying risk premia. As discussed in
Section 5.1, the optimal portfolio rule when the investor follows this strategy takes the form
ŵ(t) = α0 + α1 X(t)

(47)

where
α0 =
α1 =

1
γ−1
1
>
>
(σσ > )−1 σλ∗1 +
(σσ > )−1 (σσΠ
) + (σσ > )−1 (σσX
)B2∗ (τ )>
γ
γ
γ
1
(σσ > )−1 σλ∗2
γ

where B2∗ (τ ) is given by (62) in the case of complete nominal markets and (66) in the case of
incomplete nominal markets, with λ∗2 set equal to zero. Note that B3 (τ ) = 0 if λ∗2 = 0. For this
strategy, myopic demand is a function of the state variables, but hedging demand is non-stochastic.
25

For the parameter values we consider, they are both negative. When risk premia become more negative, however,
the allocation to the ten-year bond is negative and the five-year bond is positive

27

For the second strategy we consider, the investor fails to hedge both time-varying risk premia
and the time-varying riskfree rate, but follows the optimal myopic strategy. This strategy also takes
the form (47), where
α0 =
α1 =

1
γ−1
>
(σσ > )−1 σλ∗1 +
(σσ > )−1 (σσΠ
)
γ
γ
1
(σσ > )−1 σλ∗2
γ

We refer to this as the conditional myopic strategy.
Finally, we consider a static mean-variance investor. This investor’s allocation equals the unconditional mean-variance portfolio, namely (47), with
γ−1
1
>
(σσ > )−1 σλ∗1 +
(σσ > )−1 (σσΠ
)
γ
γ
= 03×3

α0 =
α1

This investor neither hedges time-variation in the investment opportunity set, nor times the bond
market. We refer to this as the unconditional myopic strategy.
To calculate utility costs, we solve for indirect utility (38) when the investor follows a strategy
of the form (47). Because indirect utility is an expectation of future direct utility, it is a martingale
and thus has zero drift. From the Markov property it is a function of wealth, the price level, X(t),
and the horizon. Thus indirect utility corresponding to the strategy ŵ(t) must satisfy the partial
differential equation:
Jt + LJ = 0

(48)

where L is the infinitesimal generator of J given by
LJ = JW W (ŵ> (µ − rι) + r) + JX µX + JΠ Ππ +
>
>
JW X W σX σ > ŵ(t) + JW Π W ΠŵσσΠ
+ JXΠ ΠσX σΠ
1
1
1
>
>
+ JW W W 2 ŵ> σσ > ŵ + JΠΠ Π2 σΠ σΠ
+ tr(JXX σX σX
) (49)
2
2
2

For the cases where the allocation is linear in X(t), the solution of (48) takes the same form as
indirect utility when an investor follows an optimal strategy. Namely, when γ > 1: 26
ˆ (t), Π(t), X(t), t, T ) =
J(W
26

1
1−γ

µ

W (t)
Π(t)

¶1−γ

The form of the value function for γ = 1 is discussed in Appendix D.

28

Ĥ(X(t), t, T ),

where Ĥ(X(t), t, T ) is exponential quadratic. The coefficients for Q̂ solve ordinary differential
equations given in Appendix D.
We measure the utility costs of following a suboptimal strategy by calculating the percent of
wealth the suboptimal investor would be willing to give away in return for being “allowed” to follow
the optimal strategy. In other words, we solve for the quantity ℘ such that
1
1−γ

µ

W (0)
Π(0)

¶1−γ

Ĥ(X(0), 0, T ) =

1
1−γ

µ

W (0)(1 − ℘(X(0), 0, T ))
Π(0)

¶1−γ

H(X(0), 0, T )

(50)

The left hand side is the time-0 indirect utility of the investor who follows a sub-optimal strategy
and starts with wealth W (0). The right-hand side is the time-0 indirect utility of the investor who
follows an optimal strategy and starts with wealth W (0)(1 − ℘). Note that while ℘ measures utility
cost, the units are fractions of wealth, not utils.
It follows from (50) that
℘(X(0), 0, T ) = 1 −

"

H(X(0), 0, T )
Ĥ(X(0), 0, T )

#

1
γ−1

When γ > 1, H < Ĥ, implying that the investor would be willing to give up a positive percent of
wealth in order to follow the optimal strategy. Because H and Ĥ are positive, ℘ lies between 0
and 1. The closer ℘ is to 1, the more wealth the investor would be willing to give up to follow the
optimal strategy, and thus the greater the cost to following the sub-optimal strategy.
Figure 11 plots the percent of wealth (100 × ℘ )an investor following a sub-optimal strategy
would be willing to give up in order to follow an optimal strategy when a five-year bond, the stock,
and the nominal riskfree asset are available. Utility costs are plotted for risk aversion equal to 1, 4,
10, and 25. The top panel plots the cost of following the unconditional myopic strategy, the middle
panel the cost of following the conditional myopic strategy, and the lower panel the cost of hedging
only the riskfree rate. For γ > 1, the costs fall as the strategies come closer to the optimum; the
unconditional myopic strategy is more costly than the conditional myopic strategy, which is in turn
more costly than only hedging the riskfree rate. For the log utility investor (γ = 1) it is optimal
to do no hedging at all. Therefore the cost of the conditional myopic strategy and the strategy of
hedging only the riskfree rate are zero.
The cost of the unconditional myopic strategy very high. For γ = 1, an investor with a horizon
of twenty years is willing to give up nearly 100% of wealth in order to follow the optimal strategy.
The cost of this strategy falls as risk aversion rises. However, even the investor with risk aversion

29

of 25 is willing to give up 40% of wealth in order to follow the optimal strategy. Failure to time
the bond market clearly results in a large utility loss for the investor.
Failure to hedge time-variation in investment opportunities is also costly. A highly risk averse
investor (γ = 25) with a horizon of 20 years is willing to give up 20% of wealth in order to switch
from the conditional myopic strategy to the optimal strategy. The cost of failing to hedge is lower,
the lower is risk aversion. An investor with risk aversion equal to 4 is willing to give up 6% of wealth.
Switching from a the strategy that hedges only the riskfree rate to the fully optimal strategy is
worth 6% of wealth for the investor with risk aversion of 25, and 4% of wealth for the investor with
risk aversion of 4. The cost of failing to hedge risk premia falls off more slowly with risk aversion
than the overall cost of failing to hedge. This is because less risk averse investors allocate a greater
percentage of their wealth to the long-term bond so they are more exposed to time-variation in risk
premia.
Figure 12 shows the utility cost of suboptimal strategies when the investor has access to a threeyear and a ten-year bond, the stock, and the nominal riskfree asset. The utility costs of suboptimal
strategies when two long-term bonds are available are higher than those when one long-term bond
is available for all strategies and all investors. In particular, the costs of failing to hedge are much
higher than before, and are no longer increasing in risk aversion. The investor with γ = 4 and
a horizon of twenty years would give up 26% of wealth to switch from the conditional myopic
strategy to the optimal strategy. The investor with γ = 25 would be willing to give up 24% of
wealth to switch. Failure to hedge risk premia is nearly as costly as failure to hedge completely.
The investor with γ = 4 is willing to give up 24% of wealth to switch from the strategy of hedging
only the riskfree rate to the fully optimal strategy. In the case of two long-term bonds, there is
greater scope for taking advantage of time-variation in risk premia. Because time-variation in risk
premia is a more important component of hedging demand, and because less risk averse investors
are particularly affected by time-variation in risk premia, the failure to hedge is costly even for
investors with low risk aversion.
Figure 13 shows the utility cost of suboptimal strategies when the investor has access to three
long-term bonds, a stock, and a riskfree asset. Here the costs of sub-optimal strategies are larger
still, with the cost of failing to hedge risk premia nearly equal to the cost of not hedging at all.
This section has shown that following the unconditional myopic strategy, while optimal in the
case where investment opportunities are constant, carries high utility costs when they are timevarying. The utility costs are large even when the investor allocates wealth between the nominally

30

riskfree asset, one long-term bond and the stock; the effect does not rely on the investor taking
large offsetting positions in bonds if different maturities. Moreover, following a conditional myopic
strategy is also costly, as is following a conditional myopic strategy but hedging only the riskfree
rate (rather than both the riskfree rate and risk premia). Thus the failure of the expectations
hypothesis is important for long-term investors: treating risk premia as if they are constant results
in economically significant costs.

6

Conclusion

We have shown that the failure of the expectations hypothesis has potentially important consequences for the portfolios of long-term investors. For an investor who allocates wealth between a
long and a short-term bond, time-variation in risk premia induces hedging demand that is large and
positive. We find that long horizon investors should hold a greater fraction of their portfolio in the
long-term bond; an effect that persists beyond a horizon of twenty years. When the investor has
access to multiple long-term bonds, hedging demands make the optimal allocation more extreme.
We find that failing to hedge time-variation in return predictability carries large utility costs for
the long-term investor.
We establish these results by extending the affine term structure literature to account for expected inflation. Jointly estimating a process for inflation and bond prices produces a series for
expected inflation that can account for a large portion of the variance of realized inflation, even
though it is constructed from bond yields alone.
Our framework is rich enough to include time-variation in the real interest rate, in risk premia on
stock returns, and in expected inflation, but at the same time admits explicit solutions in near-toclosed form. Multiple extensions of our model are possible. For example, it is possible to extend our
empirical results to allow for state variables other than those extracted from bond yield. We could
examine the relative importance of these state variables, as in Ait-Sahalia and Brandt (2001). We
could also modify our model to allow for parameter uncertainty, as in Barberis (2000), or learning,
as in Xia (2002). Clearly there are important aspects of the portfolio choice problem that we do
not address. Transaction costs, parameter uncertainty, and non-expected utility preferences have
all been fruitfully explored in the context of stock-return predictability. Bonds present a similar,
yet richer framework to explore these same issues.

31

Appendix
A

Bond Prices

Following Cox, Ingersoll, and Ross (1985), we assume that bond prices are smooth functions of the
state variables X(t) and of time. That is, P (X(t), t, T ) ∈ C 2,1 (RM × [0, ∞]). No-arbitrage implies
that P satisfies
´
1 ³
>
+ Pt − r(t)P = PX σX Λ̄(t)
PX K(θ − X(t)) + tr PXX σX σX
2

(51)

with boundary condition P (X(t), t, t) = 0. Equation (51) follows from equating the instantaneous
expected excess return to the volatility multiplied by the price of risk.
Conjecture that
P (X(t), t, T ) = exp {A2 (τ )X(t) + A1 (τ )} ,

(52)

where τ = T − t. Substituting back into (51) and matching coefficients on X(t) and the constants,
produces the following system of ordinary differential equations for the row vector A 2 (τ ) and the
scalar A1 (τ ):
¢
¡
A02 (τ ) = −A2 (τ ) K + σX λ̄2 − δ
¢ 1
¡
A01 (τ ) = A2 (τ ) Kθ − σX λ̄1 + A2 (τ )σX σX > A2 (τ )> − δ0
2

(53)
(54)

The boundary conditions are A2 (0) = 01×m and A1 (0) = 0.

B

Optimal portfolio allocation

Proof of Theorem 1:
It follows from the Markov property of (Π, Z, X) that wealth may be written as
G(Π(t), Z(t), X(t), t, T ) = W (t)
1

= Π(t)Z(t) γ F (X(t), t, T )
Because wealth is an asset, it satisfies a no-arbitrage differential equation analogous to that of
bonds. Applying Ito’s lemma to G and matching the instantaneous expected excess return on
wealth to its volatility times the price of risk produces:27

27

´
³
LG + Gt − rG = GZ Z((Λ∗ + ν ∗ )> − σΠ ) + GΠ ΠσΠ + GX σX (Λ∗ + ν ∗ ),

From Ito’s lemma we can write

dZ(t) = µZ dt + σZ dz

32

(55)

>
LG = ZGZ µZ + GΠ Ππ + GX K(θ − X) + ZGZX σX σZ> + ΠGΠX σX σΠ
+
³
³
´´
1
>
>
Z 2 GZZ σZ σZ> + Π2 GΠΠ σΠ σΠ
+ tr GXX σX σX
,
2

with boundary condition
1

G(Π(T ), Z(T ), X(T ), T, T ) = Π(T )Z(T ) γ .
Note that the no-arbitrage relationship for G only holds for the min-max pricing kernel φ ν ∗ , while
the bond pricing equation (51) holds for any pricing kernel. Substituting (34) into (55) results in
the partial differential equation for F given in the text.
In order that optimal wealth satisfy the dynamic budget constraint (25), the diffusion terms
from the two processes must match. Therefore the price of risk and the optimal portfolio must
jointly satisfy:
γ−1
FX
1 ∗
(Λ + ν ∗ )> +
σΠ +
σX = w> σ,
γ
γ
F

(56)

where α is the N ×1 vector of portfolio weights. The left-hand side follows from Ito’s lemma applied
to G. Inflation risk σΠ is not spanned by the row vectors of σ, thus for general ν, this equation
will not have a solution.
We need to find ν ∗ so that the unhedgeable part of σΠ drops out.28 This is equivalent to setting
the demand on the non-traded assets to zero. Rewrite σΠ as
³
´
σΠ = (σΠ σ > )(σσ > )−1 σ + σΠ − (σΠ σ > )(σσ > )−1 σ .

(57)

The first term is the projection of σΠ onto the traded assets. The second term is orthogonal to the
traded assets. In order for (56) to have a solution, ν ∗ must satisfy
´
1 ∗ > 1−γ ³
(ν ) =
σΠ − (σΠ σ > )(σσ > )−1 σ
γ
γ
Therefore,
³
´>
>
>
.
ν ∗ = (1 − γ) σΠ
− σ > (σσ > )−1 σσΠ

with
µZ

=

σZ

=

³

(58)

´
>
r(t) − π(t) + (Λ∗ + ν ∗ )> (Λ∗ + ν ∗ ) + σΠ σΠ
+ σΠ Λ̄ Z(t)

((Λ∗ + ν ∗ )> − σΠ )Z(t)

28 ∗

ν does not have to cancel out the unhedgeable parts of Λ∗ , because the columns of Λ∗ are spanned by the rows
of σ. In fact, this is the reason for defining Λ∗ as a projection of Λ̄ onto the available assets.

33

Because ν ∗ is orthogonal to the basis assets, (Λ∗ + ν ∗ ), where Λ∗ is given by (15), is indeed a valid
price of risk.
Substituting (58) back into (56) produces29
γ−1
1
1
(µ − ιr)> (σσ > )−1 σ +
(σΠ σ > )(σσ > )−1 σ + FX (σX σ > )(σσ > )−1 σ = w> σ.
γ
γ
F
The equation for the optimal allocation (37) follows from multiplying both sides of the equation by
σ > (σσ > )−1 and taking the transpose. This completes the proof of Theorem 1. 2

Proof of Corollary 2:
The argument follows that of Cox and Huang (1989), generalized to the case of unexpected inflation.
The investor’s problem at time 0 can equivalently be written as
max E0 [J(W (t), Π(t), X(t), t, T )]

W (t)>0

subject to the static budget constraint. The first order condition is given by
JW (t) = lφν̂ (t)−1
where φν̂ (t) is the min-max pricing kernel. We do not know a priori that φν̂ = φν ∗ . As is wellknown, the solution to (38) takes the form:
1
J(W (t), Π(t), X(t), t, T ) =
1−γ

µ

W (t)
Π(t)

¶1−γ

H(X(t), t, T ).

(59)

Our goal is to prove the relationship between the functions H and F .
Define Ẑ analogously to (32) as:
Ẑ(t) = (lφν̂ (t)Π(t))−1 .
Then the investor’s first-order condition can be re-written as
JW (t) = Ẑ(t)−1 Π(t)−1
Substituting in from (59) implies that
1

1

W (t) = Ẑ(t) γ Π(t)H(X(t), t, T ) γ .
29

(60)

Because σX is spanned by the rows of σ,
σX = (σX σ > )(σσ > )−1 σ

This is the only place in the argument where we need that the rows of σ span σX . If we drop this assumption, then
we have two layers of market incompleteness. We could use similar arguments, except that η would be endogenous.

34

Because W (t) is an asset, it must satisfy partial differential equation (55). Comparing (60) with
1

(34), it follows that H γ and ν̂ must jointly satisfy the partial differential equations (36) and (56).
1

Therefore, ν̂ must equal ν ∗ and H γ must equal F . 2

Proof of Corollary 4:
To solve for F , we conjecture the form of it and then we verify. Our conjecture is that
½ µ
¶¾
1 1 >
F (X(t), t, T ) = exp
X B3 (τ )Xt + B2 (τ )Xt + B1 (τ )
γ 2 t
where τ = T − t, B1 (τ ) is a matrix, B2 (τ ) is a row vector, and B3 (τ ) is a scalar. Plugging the

hypothesized solution back into the PDE (36) and matching coefficients on X t> [ · ] Xt , Xt , and the
constant terms, leads to a system of ordinary differential equations:
B30 (τ ) = (B3 (τ ) + B3 (τ )> )

·µ

¶
¸
1
− 1 σX λ∗2 − K
γ

1
+ ( (B3 (τ ) + B3 (τ )> )σX σX > (B3 (τ ) + B3 (τ )> ) +
4γ

B20 (τ )

B10 (τ )

C

µ

¶
1
− 1 λ∗2 > λ∗2 (61)
γ

·µ

¶
¸
1
1
∗
>
>
= B2 (τ )
− 1 σ X λ2 − K +
σX σX (B3 (τ ) + B3 (τ ) ) +
γ
2γ
¶
µ
·
µ
¶
¸
1
1
1 > >
∗>
>
>
− 1 λ1 σ X + 1 −
θ K +
σΠ σX (B3 (τ ) + B3 (τ )> )
2
γ
γ
µ
¶
1
+ (1 − γ)(δ − ζ) +
− 1 λ∗1 > λ∗2 + (γ − 1)σΠ λ∗2 (62)
γ

¶
¸
¶
µ
1
1
>
∗
σX σΠ
= B2 (τ ) Kθ +
− 1 σ X λ1 + 1 −
γ
γ
´
1 ³
1
B2 (τ )σX σX > B2 (τ )> + tr (B3 (τ ) + B3 (τ )> )σX σX >
+
2γ
4
¶
µ
γ
1 1
>
− 1 (λ∗1 > λ∗1 + ν ∗ > ν ∗ ) + σΠ σΠ
+
2 γ
2
+ (1 − γ)σΠ λ∗1 + (1 − γ)(δ0 − ζ0 ) (63)
·

µ

Optimal portfolio allocation under incomplete nominal markets

This Appendix modifies the results above to the case where the investor has fewer bonds than state
variables. In this case, nominal markets are incomplete. To determine the minimax price of risk in
35

this case we start from the equation:
γ−1
FX
1 ∗
(Λ + ν ∗ )> +
σΠ +
σX = w> σ,
γ
γ
F

(64)

We then project σΠ and σX on the available assets:
σΠ = (σΠ σ > )(σσ > )−1 σ + (σΠ − (σΠ σ > )(σσ > )−1 σ)
σX = (σX σ > )(σσ > )−1 σ + (σX − (σX σ > )(σσ > )−1 σ).
It is useful to define the residual of the projections as
(σΠ ⊥ ) = σΠ − (σΠ σ > )(σσ > )−1 σ
(σX ⊥ ) = σX − (σX σ > )(σσ > )−1 σ

Following the same reasoning as before we find that ν ∗ takes the form
³
´> F >
³
´>
X
− γ σX − (σX σ > )(σσ > )−1 σ
ν ∗ = (1 − γ) σΠ − (σΠ σ > )(σσ > )−1 σ
.
F
Substituting into the PDE for F in Theorem 1 we find the following ODE’s:
B30 (τ )

={

}+

µ

1
−1
γ

¶µ

¶
1
>
>
⊥
⊥ >
(B3 (τ ) + B3 (τ ) )(σX )(σX ) (B3 (τ ) + B3 (τ ) )
4
¶µ
¶
µ
1
1
⊥ >
>
>
−1
(B3 (τ ) + B3 (τ ) )σX (σX ) (B3 (τ ) + B3 (τ ) )
(65)
−
γ
2

B20 (τ ) = { } +
¶µ
¶
µ
1−γ
1
>
>
⊥ >
⊥ >
−1
(σΠ )σX (B3 (τ ) + B3 (τ ) ) − B2 (τ )σX (σX ) (B3 (τ ) + B3 (τ ) )
γ
2
µ
¶µ
¶
1
1
>
⊥
⊥
⊥ >
+
−1
(B2 (τ )(σX ) − (1 − γ)(σΠ ))(σX ) (B3 (τ ) + B3 (τ ) )
γ
2
γ−1
σΠ (σX ⊥ )(B3 (τ ) + B3 (τ )> ) (66)
+
2
¶
³
´>
1
− 1 B2 (τ )σX (1 − γ)(σΠ ⊥ ) − (σX ⊥ )B2 (τ ) +
γ
µ
¶
1
11−γ
>
⊥
⊥ >
>
B2 (τ )(σX )(σX ) B2 (τ ) −
− 1 (1 − γ)B2 (τ )(σX ⊥ )(σΠ ⊥ ) +
2 γ
γ

B10 (τ ) = {

}+

µ

>

(γ − 1)σΠ (σX ⊥ ) B2 (τ )> (67)

36

The terms {

} represents the quantity on the right hand side of equations (61), (62), and (63)

respectively.
Note that when markets are complete, the new terms on the right hand side of (65), (66), and
> = 0 because σ > is now within the span of σ.
(67) reduce to zero. In particular, (σΠ ⊥ )σX
X

D

Indirect utility for sub-optimal strategies.

It follows from the partial differential equation (48) that indirect utility takes the form:
1
J(W (t), Π(t), X(t), T ) =
1−γ

µ

W (t)
Π(t)

¶1−γ

H(X(t), t, T ).

where H(X(t), t, T ) satisfies the partial differential equation
³
´
Ht + (1 − γ)H w(t)> (µ(t) − ιr(t)) + r(t) − π(t)

γ−2
>
HσΠ σΠ
2
³
´ 1
>
>
) = 0. (68)
+ tr(HXX σX σX
+ HX K(θ − X(t)) + (1 − γ)σX σ > w(t) − (1 − γ)σX σΠ
2
>
− γHw(t)> σσ > w(t) − (1 − γ)Hw(t)> σσΠ
−

Suppose that the strategy of interest can be expressed as
w(t) = α0 + α1 X(t),

(69)

for some constant scalar α0 and vector α1 . When the trading strategy can be expressed as (69), it
follows from (68) that H(X(t), t, T ) is exponential quadratic:
n
o
H(X(t), t, T ) = exp X(t)> Γ3 X(t) + Γ2 X(t) + Γ1 .
where Γ3 , Γ2 , and Γ1 satisfy the following system of ordinary differential equations:
h
i Γ + Γ>
>
3
> Γ3 + Γ 3
>
3
σX σX
Γ03 = (Γ3 + Γ>
3 ) (1 − γ)σX σ α1 − K +
2
2
+ 2(1 − γ)α1> σλ∗2 − γ(1 − γ)α1> σσ > α1 (70)
Γ02

·

>

= Γ2 (1 − γ)σX σ α1 + σX σX

> Γ3

+ Γ>
3
−K
2

¸

h
i
>
>
> Γ3 + Γ 3
+ θ> K > + (1 − γ)α0> σσX
− (1 − γ)σΠ σX
2
h
i
>
∗
∗ > >
2
>
+ (1 − γ) α0 σλ2 + δ − ζ + (λ1 ) σ α1 − (1 − γ) σΠ σ α1 − γ(1 − γ)α0> σσ > α0 (71)
37

i 1
h
Γ01 = Γ2 Kθ + (1 − γ)σX σ > α0 − (1 − γ)σX σΠ > + Γ2 σX σX > Γ>
2
2
γ(1 − γ) > >
α0 σσ α0
+ (1 − γ)(α0> σλ∗1 + δ0 − ζ0 ) − (1 − γ)2 σΠ σ > α0 −
2
µ
¶
Γ3 + Γ >
(1 − γ)(γ − 2)
1
>
>
3
−
σΠ σΠ + tr
σX σX
(72)
2
2
2
For γ = 1 the indirect utility function takes the form:
µ
¶
W (t)
J(W (t), Π(t), X(t), T ) = log
+ Q(X(t), t, T ).
Π(t)
where Q(X(t), t, T ) satisfies the partial differential equation
³
´ 1
1
>
Qt + w(t)> (µ(t) − ιr(t)) + r(t) − π(t) − w(t)> σσ > w(t) + σΠ σΠ
2
2

1
>
+ QX (K(θ − X(t))) + tr(QXX σX σX
) = 0. (73)
2

It follows from (73) that Q(X(t), t, T ) is quadratic:
Q(X(t), t, T ) = X(t)> ∆3 X(t) + ∆2 X(t) + ∆1 ,
and that ∆3 , ∆2 , and ∆1 satisfy:
>
∗
>
>
∆03 = −(∆3 + ∆>
3 )K + 2α1 σλ2 − α1 σσ α1
∆3 + ∆ >
3
∆02 = −∆2 K + θ > K >
+ α0> σλ∗2 + δ − ζ + (λ∗1 )> σ > α1 − α0> σσ > α0
2
µ
¶
∆3 + ∆ >
1
1
1
>
3
σX σX
∆01 = ∆2 Kθ + (α0> σλ∗1 + δ0 − ζ0 − α0> σσ > α0 ) + σΠ σΠ > + tr
2
2
2
2

E

Estimation

This section extends the results of Duffee (2002) to include inflation and stock return data in the
estimation of bond yields. For convenience, it is assumed that the state variables are Gaussian (as
in the body of the paper). Duffee’s quasi-maximum likelihood results for square-root models can
be extended in a similar fashion. In what follows, let eM denote the matrix exponential of M , let
(xi )i denote the diagonal matrix with diagonal elements xi , and let (xi,j )i,j denote the matrix with
the (i, j) element equal to xi,j . It is assumed that K is diagonalizable.
Let Y (t) denote the vector of perfectly observed yields at time t. Namely


y(X(t), t, τ1 )


..
Y (t) = 

.
y(X(t), t, τm )
38

for maturities (τ1 , · · · , τm ), where y is defined in (6). Let Ỹ denote the vector of yields which are
observed imperfectly. From (5), it follows that the perfectly observed yields can be inverted to find
the state variables:
X(t) = L−1
1 (Y (t) − L0 ) .
where L1 is an m × m matrix with row i given by −A2 (τi )/τi , and L0 is a vector with elements
−A1 (τi )/τi . Let f (· | ·) denote (with slight abuse of notation), the conditional likelihood function.
Then the likelihood function for yields can be related to the likelihood function for the state variables
by
f (Y (t + 1), Π(t + 1), S(t + 1) | Y (t), Π(t), S(t)) =
1
f (X(t + 1), Π(t + 1), S(t + 1) | X(t), Π(t), S(t)). (74)
det [L1 ]
Let ²(t) denote the observation errors on the yields that are not perfectly observed. We assume
that ²(t) is independent of innovations to the state variables or to inflation. Under this assumption,
the full likelihood is given by:
lt (Θ) = log f (Y (t), Π(t), S(t) | Y (t − 1), Π(t − 1), S(t − 1)) +
log f (Ỹ (t) | Y (t), Π(t), S(t))
= log f (Y (t), Π(t), S(t) | Y (t − 1), Π(t − 1), S(t − 1)) + log f (²(t) | Y (t))
It therefore suffices to specify f (X(t + 1), Π(t + 1) | X(t), Π(t)).
We show that f (log Π(t+1), X(t+1), log S(t+1) | log Π(t), X(t), log S(t)) is multivariate normal,
and calculate the mean and variance. Consider the augmented state vector


X(t)
X̂(t) =  log S(t) 
log Π(t)

The continuous time dynamics of this vector are defined by

dX̂(t) = (κ1 X̂ + κ2 )dt + σX̂ dz,
where

(75)






Kθ
σX
03×1 −K 03×1
 , σ =  σS 
η+δ
0  , κ2 =  ζ0 − 21 σΠ σΠ >
κ1 =  0
X̂
1
>
σΠ
0
ζ
0
η0 + δ 0 − 2 σS σS


Applying Ito’s lemma to the process e−κ1 t X̂t , it follows that:
Z T
Z T
κ1 (T −t)
κ1 (T −s)
X̂(T ) = e
X̂t +
e
κ2 ds +
eκ1 (T −s) σX̂ dw(s).
t

t

39

(76)

Which shows that X̂T is normally distributed conditional on X̂t .
Assume that κ1 is diagonalizable. Let U be such that
κ1 = U DU −1 ,

D diagonal.

From the definition of the matrix exponential and (76), it follows that
Et (X̂(T )) = e

κ1 (T −t)

X̂(t) +

µZ

T

Ue

D(T −s)

U

−1

¶

ds κ2 .

t

¡
¢
Note that eD(T −t) = edi (T −t) i . Performing the integration element-by-element produces:
Et (X̂(T )) = eκ1 (T −t) X̂t + U (f (di , T − t))i U −1 κ2 .

where
f (di , T − t) =

½

− d1i (1 − edi (T −t) ) di 6= 0
T −t
di = 0

This completes the derivation of the conditional mean.
From (76), the conditional variance satisfies:
Vart (X̂(T )) = Et

"µZ

T

e

κ1 (T −u)

t

= Et

σX̂ dwu

·Z

T

e

¶ µZ

T

e
t

κ1 (T −u)

t

κ1 (T −u)

σX̂ dwu

¶> #

> κ1 (T −u) >
σX̂ σX̂
e
du

=

Z

T
t

¸

=

=

³
´>
>
eκ1 (T −u)
du.
eκ1 (T −u) σX̂ σX̂

> (U −1 )> . Integrating the above equation element-by-element produces:
Let Ω = U −1 σX̂ σX̂

Vart (X̂(T )) =

Z

T

U eD(T −u) ΩeD(T −u) U > du

t

= U [g(di , dj , T − u)Ωi,j ]i,j U > ,
where
g(di , dj , T − t) =

(

1
− di +d
(1 − e(di +dj )(T −t) ) di 6= 0 or dj 6= 0
j
T −t
di = dj = 0

This completes the derivation of the conditional variance-covariance matrix.

40

References
Ahn, Dong-Hyun, Robert F. Dittmar, and A. Ronald Gallant, 2002, Quadratic Term Structure
Models:Theory and Evidence, Review of Financial Studies 15, 243–288.
Ait-Sahalia, Yacine, and Michael Brandt, 2001, Variable Selection for Portfolio Choice, Journal of
Finance 56, 1297–1351.
Ang, Andrew, and Geert Bekaert, 2003, The term structure of real rates and expected inflation,
working paper, Columbia University.
Balduzzi, Pierluigi, and Anthony W. Lynch, 1999, Transaction Costs and Predictability: Some
Utility Cost Calculations, Journal of Financial Economics 52, 47–78.
Bansal, Ravi, and Hao Zhou, 2002, Term Structure of Interest Rates with Regime Shifts, Journal
of Finance 57, 1997–2044.
Barberis, Nicholas, 2000, Investing for the Long Run when Returns are Predictable, Journal of
Finance 55, 225–264.
Bekaert, Geert, and Robert J. Hodrick, 2001, Expectations hypothesis tests, Journal of Finance
56, 1357–1394.
Bekaert, Geert, Robert J. Hodrick, and David A. Marshall, 1997, On biases in tests of the expectations hypothesis of the term structure of interest rates, Journal of Financial Economics 44,
309–348.
Bekaert, Geert, Robert J. Hodrick, and David A. Marshall, 2001, Peso problem explanations for
term structure anomolies, Journal of Monetary Economics 48, 241–270.
Boudoukh, Jacob, 1993, An equilbrium model of nominal bond prices with inflation-output correlation and stochastic volatility, Journal of Money, Credit, and Banking 25, 636–665.
Boudoukh, Jacob, Matthew Richardson, and Robert F. Whitelaw, 1994, Industry returns and the
Fisher effect, Journal of Finance 49, 1595–1615.
Brandt, Michael W., 1999, Estimating portfolio and consumption choice: A conditional Euler
equations approach, Journal of Finance 54, 1609–1645.

41

Brandt, Michael W., and David A. Chapman, 2002, Comparing multifactor models of the term
structure, Manuscript, University of Texas and the Wharton School.
Brennan, Michael J., Eduardo S. Schwartz, and Ronald Lagnado, 1997, Strategic Asset Allocation,
Journal of Economic Dynamics and Control 21, 1377–1403.
Brennan, Michael J., and Yihong Xia, 2000, Stochastic interest rates and the bond-stock mix,
European Finance Review 4, 197–210.
Brennan, Michael J., and Yihong Xia, 2002, Dynamic Asset Allocation under Inflation, Journal of
Finance 57, 1201–1238.
Campbell, John Y., 1986, A defense of traditional hypotheses about the term structure of interest
rates, Journal of Finance 41, 183–193.
Campbell, John Y., Yeung Lewis Chan, and Luis M. Viceira, 2002, A multivariate model of strategic
asset allocation, forthcoming, Journal of Financial Economics.
Campbell, John Y., and Robert J. Shiller, 1988, The dividend-price ratio and expectations of future
dividends and discount factors, Review of Financial Studies 58, 495–514.
Campbell, John Y., and Robert J. Shiller, 1991, Yield spreads and interest rate movements: A
bird’s eye view, Review of Economic Studies 58, 495–514.
Campbell, John Y., and Luis Viceira, 2001, Who should buy long-term bonds?, American Economic
Review 91, 99–127.
Campbell, John Y., and Luis M. Viceira, 1999, Consumption and Portfolio Decisions when Expected
Returns are Time-varying, Quarterly Journal of Economics 114, 433–495.
Cochrane, John, and Monika Piazzesi, 2002, Bond Risk Premia, NBER Working Paper # 9178.
Cox, John C., and Chi-Fu Huang, 1989, Optimal Consumption and Portfolio Policies when Asset
Prices Follow a Diffusion Process, Journal of Economic Theory 39, 33–83.
Cox, John C., Jonathan C. Ingersoll, and Stephen A. Ross, 1981, A Re-examination of traditional
hypotheses about the term tructure of interest rates, Journal of Finance 36, 769–799.
Cox, John C., Jonathan C. Ingersoll, and Stephen A. Ross, 1985, A theory of the term structure
of interest rates, Econometrica 53, 385–408.
42

Dai, Qiang, and Kenneth Singleton, 2000, Specification analysis of affine term structure models,
Journal of Finance 55, 1943–1978.
Dai, Qiang, and Kenneth Singleton, 2002a, Expectations puzzles, time-varying risk premia, and
affine models of the term structure, Journal of Financial Economics 63, 415–442.
Dai, Qiang, and Kenneth Singleton, 2002b, Term structure dynamics in theory and reality, forthcoming, Review of Financial Studies.
Duffee, Gregory R., 2002, Term premia and interest rate forecasts in affine models, Journal of
Finance 57, 369–443.
Duffie, Darrell, and Rui Kan, 1996, A yield-factor model of interest rates, Mathematical Finance
6, 379–406.
Dybvig, Philip H., and Chi-Fu Huang, 1988, Nonnegative wealth, absence of arbitrage, and feasible
consumption plans, Review of Financial Studies 1, 377–401.
Fama, Eugene F., 1975, Short-term interest rates as predictors of inflation, American Economic
Review 65, 269–282.
Fama, Eugene F., and Robert R. Bliss, 1987, The information in long-maturity forward-rates,
American Economic Review 77, 680–692.
Fama, Eugene F., and Kenneth R. French, 1989, Business conditions and expected returns on stocks
and bonds, Journal of Financial Economics 29, 23–49.
Fama, Eugene F., and Michael R. Gibbons, 1982, Inflation, real returns, and capital investment,
Journal of Monetary Economics pp. 297–323.
Fisher, Mark, 1998, A simple model of the failure of the expectations hypothesis, Working paper,
Federal Reserve Bank of Atlanta.
Gibbons, Michael R., and Krishna Ramaswamy, 1993, A test of the Cox, Ingersoll, Ross model of
the term structure, Review of Financial Studies 6, 619–658.
He, Hua, and Neil D. Pearson, 1991, Consumption and Portfolio Policies with Incomplete Markets
and Short-sale Constraints: The Infinite Dimensional Case, Journal of Economic Theory 54,
259–304.
43

Karatzas, Ioannis, John P. Lehoczky, and Steven E. Shreve, 1987, Optimal Portfolio and Consumption Decisions for a Small Investor on a Finite Horizon, SIAM Journal of Control and
Optimization 25, 1557–1586.
Kim, Tong Suk, and Edward Omberg, 1996, Dynamic Nonmyopic Portfolio Behavior, Review of
Financial Studies 9, 141–161.
Liu, Jun, 1999, Portfolio Selection in Stochastic Environments, unpublished paper, Stanford University.
Liu, Jun, and Jun Pan, 2002, Dynamic Derivative Strategies, Forthcoming, Journal of Financial
Economics.
Longstaff, Francis A., 2000a, Arbitrage and the expectations hypothesis, Journal of Finance 55,
989–994.
Longstaff, Francis A., 2000b, The term structure of very short-term rates: New evidence for the
expectations hypothesis, Journal of Financial Economics 58, 397–415.
Merton, Robert C., 1971, Optimum Consumption and Portfolio Rules in a Continuous-time Model,
Journal of Economic Theory 3, 373–413.
Mishkin, Frederic S., 1981, The real rate of interest: An empirical investigation, Carnegie-Rochester
series on public policy 15, 1951–200.
Pennacchi, George G., 1991, Identifying the dynamics of real interest rates and inflation: Evidence
using survey data, Review of Financial Studies pp. 53–86.
Piazzesi, Monika, 2002, Affine Term Structure Models, forthcoming Handbook of Financial Econometrics.
Pliska, Stanley R., 1986, A Stochastic Calculus Model of Continuous Trading: Optimal Portfolios,
Mathematics of Operations Research 11, 239–246.
Schroder, Mark, and Costis Skiadas, 1999, Optimal Consumption and Portfolio Selection with
Stochastic Differential Utility, Journal of Economic Theory 89, 68–126.
Schroder, Mark, and Costis Skiadas, 2002, Optimal Lifetime Consumption-Portfolio Strategies under Trading Constraints and Generalized Recursive Preferences, Kellogg School of Management,
Working Paper No. 285.
44

Sorensen, Carsten, 1999, Dynamic asset allocation and fixed income management, Journal of Financial and Quantitative Analysis 34, 513–532.
Stambaugh, Robert, 1999, Predictive regressions, Journal of Financial Economics 54, 375–421.
Sun, Tong-Sheng, 1992, Real and nominal interest rates: A discrete-time model and its continuoustime limit, Review of Financial Studies 5, 581–611.
Vasicek, Oldrich, 1977, An equilibrium characterization of the term structure, Journal of Financial
Economics 5, 177–188.
Volkanov, Rossen, 1998, The term structure with highly persistent interest rates, working paper,
University of California, Los Angeles.
Wachter, Jessica A., 2002a, Portfolio and consumption decisions under mean-reverting returns: An
exact solution for complete markets, Journal of Financial and Quantitative Analysis 37, 63–91.
Wachter, Jessica A., 2002b, Risk aversion and allocation to long-term bonds, forthcoming, Journal
of Economic Theory.
Xia, Yihong, 2002, Long-Term Bond Markets and Investor Welfare, Working Paper, The Wharton
School.

45

Table 1: Processes for the Riskfree Rate and Expected Inflation
The three-factor model described in Section 3 is estimated using monthly data on bond yields, inflation,
and stock returns from 1952-1998. The nominal interest rate r(t) = δ0 + δ1 X1 (t) + δ2 X2 (t) + δ3 X3 (t),
expected inflation equals π(t) = ζ0 + ζ1 X1 (t) + ζ2 X2 (t) + ζ3 X3 (t). The process for X is given by dX(t) =
−KX(t) dt + σX dz(t) where σX is shown in Table 2. Outer product standard errors are given in parentheses.
Parameter values are annual and in natural units.

Panel A: Constant terms
δ0
0.056
(0.034)

ζ0
0.040
(0.026)

Panel B: Coefficients on state variables

ζi
δi
K1,i
K2,i
K3,i

X1
0.018
( 0.002)
0.018
(0.0003)
0.576
(0.027)
0
-0.421
(0.170)

X2
0.018
( 0.004)
0.007
(0.0009)
0

X3
0.007
(0.0005)
0.010
(0.0003)
0

3.343
(0.210)
0

0

46

0.083
(0.055)

Table 2: Volatility Matrix
Estimates of loadings on the Brownian motions. For example, the unpredictable component of the stock
price is given by σS (1)dz1 + σS (2)dz2 + σS (3)dz3 + σS (4)dz4 + σS (5)dz5 . σX and the last entry of σS cannot
be identified from the data; they are set equal to the values below without loss of generality. Outer product
standard errors are in parentheses.

σX
σS (×100)
σΠ (×100)

dz1

dz2

dz3

dz4

dz5

1
0
0
-1.255
(0.578)
0.001
(0.042)

0
1
0
0.572
(0.592)
-0.011
(0.042)

0
0
1
-2.946
(0.632)
0.133
(0.042)

0
0
0
14.277
(0.304)
-0.084
(0.042)

0
0
0
0
0.911
(0.024)

Table 3: Prices of Risk
Estimates of the price of risk Λ∗ = λ∗1 + λ∗2 X(t) and of the equity premium. The first three rows of λ∗1 and λ∗2
control risk premia on bonds (because σX takes the form shown in Table 2). zi (t) is the ith Brownian motion.
The fourth row is determined by the equity premium σS Λ∗ = η0 . The fifth row is zero by construction.
Outer product standard errors are in parentheses. Parameter values are annual and in natural units.

Equity premium η0

.075
(.025)

Source of risk

λ∗1
X1

z1 (t)

z4 (t)

-0.563
(0.212)
-0.245
(0.078)
-0.219
(0.052)
0.440

zt (5)

0

z2 (t)
z3 (t)

47

0

λ∗2
X2

X3

0.537
(0.174)
0.111

1.754
(0.078)
-1.815
(0.169)
0.376
(0.117)
0.305

-0.082
(0.055)
-0.017

0

0

0

0

0
0

Table 4: Asset Correlations
The first panel shows conditional correlations of asset prices implied by the parameter values in Tables 1, 3,
and 2. The second panel shows unconditional correlations from the data.

Panel A: Model

1-year
5-year
10-year
Stock

1-year Bond

5-year Bond

10-year Bond

Stock

1.000

0.878
1.000

0.741
0.950
1.000

0.191
0.208
0.212
1.000

Panel B: Data

1-year
5-year
10-year
Stock

1-year Bond

5-year Bond

10-year Bond

Stock

1.000

0.853
1.000

0.734
0.932
1.000

0.190
0.192
0.214
1.000

48

Table 5: Correlations between Assets, Inflation, and the Investment Opportunity Set
Panel A shows conditional correlations between asset prices and unexpected inflation (Π), expected inflation
(π), the nominal interest rate (r) and the “real” interest rate (r − π) implied by the parameter values in
Tables 1, 3, and 2. Panel B shows conditional correlations between asset returns and the risk premia on the
one-year, five-year and ten-year bonds. Panel C shows conditional correlations between asset returns and
the state variables.

Panel A: Interest Rate and Inflation

Π
π
r
r−π

1-year Bond

5-year Bond

10-year Bond

Stock

-0.085
-0.459
-0.779
-0.477

-0.118
-0.112
-0.478
-0.704

-0.137
-0.117
-0.418
-0.570

-0.117
-0.087
-0.148
-0.091

Panel B: Risk Premia

µ1 − r
µ5 − r
µ10 − r

1-year Bond

5-year Bond

10-year Bond

Stock

-0.213
-0.157
-0.034

-0.471
-0.445
-0.380

-0.341
-0.336
-0.319

-0.031
-0.026
-0.015

Panel C: State Variables

X1
X2
X3

1-year Bond

5-year Bond

10-year Bond

Stock

-0.764
0.313
-0.564

-0.366
0.512
-0.777

-0.143
0.345
-0.927

-0.086
0.039
-0.201

49

0.03
Sample
Population
Monte Carlo Mean
Monte Carlo 95% Confidence Bands

Yield Spread Means

0.025

0.02

0.015

0.01

0.005

0

1

2

3

4
5
6
Maturity (years)

7

8

9

10

Figure 1: Model-implied yield spread means. Bond yields are in annual terms, and defined as in
Equation (6). The short-term yield has maturity of 3 months. “Sample” refers to yield spreads
calculated using data from 1953-1998 on bonds of selected maturities.

Yield Spreads Standard Deviations

0.03
Sample
Population
Monte Carlo Mean
Monte Carlo 95% Confidence Bands

0.025

0.02

0.015

0.01

0.005

0

1

2

3

4
5
6
Maturity (years)

7

8

9

10

Figure 2: Model-implied yield spread standard deviations. Yields are in annual terms, and defined
as in (6). The short-term yield has maturity of 3 months. “Sample” refers to yield spreads calculated
using data from 1953-1998 on bonds of selected maturities.

50

Campbell−Shiller Regression Coefficients

3
Sample
Population
Monte Carlo Mean
Monte Carlo 95% Confidence Bands

2
1
0
−1
−2
−3
−4

1

2

3

4
5
6
Maturity (years)

7

8

9

10

Figure 3: Model-implied coefficients on Campbell-Shiller (1991) long-rate regressions. Quarterly
changes in yields, y(t, s) − y(t + 14 , s), are regressed on the spread between the (s − t) -year bond,
and the 3-month bond, scaled by 1/(4(s − t) − 1). “Sample” refers to yield spreads calculated using
data from 1953-1998 on bonds of selected maturities.

51

2
Expected inflation π(t)
Realized inflation log Π(t+1)−log Π(t)

Inflation, % per month

1.5

1

0.5

0

−0.5

−1

1955

1960

1965

1970

1975

1980

1985

1990

1995

Figure 4: Changes in log CPI (from data) and expected inflation π(t) implied by the model and
parameter estimates in Table 1.

18
16

Nominal interest rate r(t)
"Real" interest rate r(t)−π(t)

Interest rate, % per year

14
12
10
8
6
4
2
0
−2
1950

1955

1960

1965

1970

1975

1980

1985

1990

1995

2000

Figure 5: The nominal and real riskfree rate implied by the model and parameter estimates in
Table 1.

52

30
1−yr bond
5−yr bond
10−yr bond

20

Risk premia, %

10

0

−10

−20

−30
1950

1955

1960

1965

1970

1975

1980

1985

1990

1995

2000

Figure 6: Risk premia (in annual percentages) on long-term bonds implied by the model.

53

Premium = 6%, γ = 4

Premium = 6%, γ = 10

8

3
5−yr
stock

2

4

Allocation

Allocation

5−yr
stock

0

1
0
−1

−4
0

10
Horizon (years)

20

0

Premium = 2%, γ = 4

20

Premium = 2%, γ = 10

8

3
5−yr
stock

5−yr
stock

2

4

Allocation

Allocation

10
Horizon (years)

0

1
0
−1

−4
0

10
Horizon (years)

20

0

Premium = -3%, γ = 4

20

Premium = -3%, γ = 10

8

3
5−yr
stock

5−yr
stock

2

4

Allocation

Allocation

10
Horizon (years)

0

1
0
−1

−4
0

10
Horizon (years)

20

0

10
Horizon (years)

Figure 7: Optimal allocation as a function of horizon for an investor with utility over terminal
wealth and access to a 5-year bond the stock market, and the nominal riskfree asset. Shown are
the allocations to the bond and the stock; the allocation to the riskfree asset is one minus the sum
of these quantities. X2 and X3 are set equal to zero while X1 is set equal to minus one standard
deviation (1.9) in the top panel, 0 in the middle panel, and plus one standard deviation in the
bottom panel. “Premium” refers to the risk premium on the 5-year bond implied by each value of
X = (X1 , X2 , X3 ). Risk aversion γ = 4 (left panel) or 10 (right panel).

54

20

Premium = 12%, γ = 4

Premium = 12%, γ = 10

8

3
2

4

Allocation

Allocation

6

2
0
−2
−4
0

5−yr
stock
10
Horizon (years)

1
0

20

0

Premium = 2%, γ = 4
5−yr
stock
Allocation

Allocation

5−yr
stock

2

4
2
0
−2

1
0
−1

10
Horizon (years)

20

0

Premium = -8%, γ = 4

10
Horizon (years)

20

Premium = -8%, γ = 10

8

3
5−yr
stock

6

5−yr
stock

2

4

Allocation

Allocation

20

3

6

2
0
−2
−4
0

10
Horizon (years)

Premium = 2%, γ = 10

8

−4
0

5−yr
stock

−1

1
0
−1

10
Horizon (years)

20

0

10
Horizon (years)

Figure 8: Allocation when the investor hedges only the real riskfree rate (plain lines) and when
the investor hedges only risk premia (lines with circles) as a function of horizon. The investor has
utility over terminal wealth and access to a 5-year bond the stock market, and the nominal riskfree
asset. Shown are the allocations to the bond and the stock; the allocation to the riskfree asset is
one minus the sum of these quantities. For the stock, the two allocations lie on top of each other.
X2 and X3 are set equal to zero while X1 is set equal to minus one standard deviation (1.9) in the
top panel, 0 in the middle panel, and plus one standard deviation in the bottom panel. “Premium”
refers to the risk premium on the 10-year bond implied by each value of X = (X1 , X2 , X3 ). Risk
aversion γ = 4 (left panel) or 10 (right panel).
55

20

Premium = 12%, γ = 4
3−yr
10−yr
stock

4
0
−4
0

2
0
−2

10
Horizon (years)

20

0

Premium = 2%, γ = 4

Allocation

Allocation

0
−4

2
0
−2

10
Horizon (years)

20

0

Premium = -8%, γ = 4

10
Horizon (years)

20

Premium = -8%, γ = 10
3−yr
10−yr
stock

3−year
10−year
stock

4
Allocation

8
Allocation

20

3−year
10−year
stock

4

4

4
0
−4
0

10
Horizon (years)

Premium = 2%, γ = 10
3−yr
10−yr
stock

8

0

3−year
10−year
stock

4
Allocation

8
Allocation

Premium = 12%, γ = 10

2
0
−2

10
Horizon (years)

20

0

10
Horizon (years)

Figure 9: Optimal allocation as a function of horizon for an investor with utility over terminal
wealth and access to a 3-year and 10-year bond, the stock market, and the nominal riskfree asset.
Shown are the allocations to the bonds and the stock; the allocation to the riskfree asset is one
minus the sum of these quantities. X2 and X3 are set equal to zero while X1 is set equal to
minus one standard deviation (1.9) in the top panel, 0 in the middle panel, and plus one standard
deviation in the bottom panel. “Premium” refers to the risk premium on the 10-year bond implied
by each value of X = (X1 , X2 , X3 ). Risk aversion γ = 4 (left panel) or 10 (right panel).

56

20

Premium = 12%, γ = 4
1−yr
5−yr
10−yr
stock

10
0

4
0
−4

−10
−20
0

10
Horizon (years)

−8
0

20

Premium = 2%, γ = 4

Allocation

Allocation

0

4
0
−4

−10
10
Horizon (years)

−8
0

20

Premium = -8%, γ = 4

10
Horizon (years)

20

Premium = -8%, γ = 10
1−yr
5−yr
10−yr
stock

1−yr
5−yr
10−yr
stock

8
Allocation

20
Allocation

20

1−yr
5−yr
10−yr
stock

8

10

10
0

4
0
−4

−10
−20
0

10
Horizon (years)

Premium = 2%, γ = 10
1−yr
5−yr
10−yr
stock

20

−20
0

1−yr
5−yr
10−yr
stock

8
Allocation

20
Allocation

Premium = 12%, γ = 10

10
Horizon (years)

20

−8
0

10
Horizon (years)

Figure 10: Optimal allocation as a function of horizon for an investor with utility over terminal
wealth and access to a 1, 5, and 10-year bond, the stock market, and the nominal riskfree asset.
Shown are the allocations to the bonds and the stock; the allocation to the riskfree asset is one
minus the sum of these quantities. X2 and X3 are set equal to zero while X1 is set equal to
minus one standard deviation (1.9) in the top panel, 0 in the middle panel, and plus one standard
deviation in the bottom panel. “Premium” refers to the risk premium on the 10-year bond implied
by each value of X = (X1 , X2 , X3 ). Risk aversion γ = 4 (left panel) or 10 (right panel).

57

20

Optimal vs. Unconditional Myopic
100

γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

80
60
40
20
0
0

10
Horizon (years)

20

Optimal vs. Conditional Myopic
γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

15

10

5

0
0

10
Horizon (years)

20

Optimal vs. Riskfree-rate only Hedge
γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

15

10

5

0
0

10
Horizon (years)

20

Figure 11: Utility costs, measured as the percent of wealth an investor following a sub-optimal
strategy would be willing to give up in order to follow an optimal strategy. The top panel shows the
cost of following the unconditional myopic strategy. The middle panel shows the cost of following
the conditional myopic strategy. The bottom panel shows the cost of following the conditional
myopic strategy and hedging only the riskfree rate. The investor is assumed to have access to a
5-year bond, the stock market, and a nominal riskfree asset. γ refers to relative risk aversion.
58

Optimal vs. Unconditional Myopic
100

γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

80
60
40
20
0
0

10
Horizon (years)

20

Optimal vs. Conditional Myopic
γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

25
20
15
10
5
0
0

10
Horizon (years)

20

Optimal vs. Riskfree-rate only Hedge
γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

25
20
15
10
5
0
0

10
Horizon (years)

20

Figure 12: Utility costs, measured as the percent of wealth an investor following a sub-optimal
strategy would be willing to give up in order to follow an optimal strategy. The investor is assumed
to have access to two long-term bonds, the stock market, and a nominal riskfree asset. The top
panel shows the cost of following the unconditional myopic strategy. The middle panel shows the
cost of following the conditional myopic strategy. The bottom panel shows the cost of following the
conditional myopic strategy and hedging only the riskfree rate. γ refers to relative risk aversion.
59

Optimal vs. Unconditional Myopic
100

γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

80
60
40
20
0
0

10
Horizon (years)

20

Optimal vs. Conditional Myopic
50

γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

40
30
20
10
0
0

10
Horizon (years)

20

Optimal vs. Riskfree-rate only Hedge
50

γ=1
γ=4
γ = 10
γ = 25

Percent of wealth

40
30
20
10
0
0

10
Horizon (years)

20

Figure 13: Utility costs, measured as the percent of wealth an investor following a sub-optimal
strategy would be willing to give up in order to follow an optimal strategy. The top panel shows the
cost of following the unconditional myopic strategy. The middle panel shows the cost of following
the conditional myopic strategy. The bottom panel shows the cost of following the conditional
myopic strategy and hedging only the riskfree rate.The investor is assumed to have access to three
long-term bonds, the stock market, and a nominal riskfree asset. γ refers to relative risk aversion.
60

